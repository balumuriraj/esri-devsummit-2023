import{_ as G}from"./preload-helper-3bce6601.js";import{e as h,y as p,s as qr,n as D,l as mt,t as Ft,m as ue,a as Ree,b as o7,x as r5,A as wd,u as l7,v as c7,o as Aee,c as uw,d as Rt,f as n5,g as eI,h as Q$,i as fc,r as h7,j as Zt,k as Cm,p as ZR,q as Oee,w as aT,z as Mee,F as Iee,B as s5,C as Lee}from"./cast-fcb46737.js";import{g as jc}from"./Graphic-f0e54e86.js";import{i as au,l as $ee}from"./Clonable-545593ce.js";import{s as Z$,r as Sm,i as dw,o as Dee}from"./Cyclical-151bcc41.js";import{a as ce,b as _o,l as ls,m as Ct,g as YR,j as Fee,A as Nee,D as kee,h as dt,v as U0,N as tu,i as Y$,F as tI,c as pw}from"./mathUtils-b4bb77e2.js";import{t as S,r as y,s as Te,u as Px,o as co,e as ct,f as Vee,h as Os,p as iu,q as en,i as je,w as Qi,a as Me,b as Np,c as Uee,l as zee,y as u7,A as d7,d as p7,n as v_,C as Bee,v as m7,g as K$,j as Gee,k as iI,m as Hee,M as jee,x as qee}from"./typedArrayUtil-4d7bb04c.js";import{w as Ne,r as Cs,o as Dl,R as _P,E as Bm,a as ui,k as Qt,I as f7,p as g7,b as _7,c as y7,d as Wee,M as J$,e as Xee,x as Qee,P as Rx,s as Ax,f as a5,g as rI,h as Zee,A as PE,S as $v,i as RE,u as Yee,T as v7,j as Kee}from"./Extent-da876e26.js";import{a as kp,t as oT,r as Jee,T as nI,b as Ox,n as Er,S as ete,e as Fl}from"./ArrayPool-a8ee9378.js";import{i as b7}from"./geometry-b7901087.js";import{v as AE,s as tte,l as ite,u as rte,y as nte,f as w7,c as x7}from"./jsonUtils-229211af.js";import{j as pt,E as o5}from"./Collection-910b6f71.js";import{l as mw}from"./CollectionFlattener-8f4d518b.js";import{s as J,a as K,b as Sg}from"./Error-ec6249b9.js";import{n as z0,h as St,y as Rr,o as KR}from"./string-a318751c.js";import{E as Yo,i as Ol,g as Rb,U as B0,j as yo,b as ste,L as ate,f as xi,A as T7,a as ts,v as Em,p as Ec,C as Mx,t as yP,D as Ix,w as ote,d as lte,r as cte}from"./promiseUtils-1e54421e.js";import{l as z,h as Qe,a as wr,f as cs,U as ri,j as Pm,w as Oi,P as hte}from"./reactiveUtils-4dabbb80.js";import{c as Ps,i as zi,x as is,p as G0,d as Dh,u as Sa,e as sI,s as C7}from"./screenUtils-410d12c0.js";import{l as S7}from"./workers-6e30d081.js";import{e as fw,A as pv,r as Dd,t as vP,u as OE,_ as ute,R as Eg,y as dte,g as bn,j as ss,d as Rm,x as Ma,Z as xd,p as pte,v as bP,a as E7,H as P7,P as mte,f as Dv}from"./projection-290b739f.js";import{p as fte,j as Ab}from"./TileInfo-b0eb8c90.js";import{i as aI,e as _n,M as Hn,n as F,v as ME,h as l5,f as zh,p as gte,k as _te,a as IE,t as R7,w as yte,b as eD,r as c5,c as A7,o as h5,g as vte}from"./widget-fb292a2f.js";import{c as mv,a as Lx,d as tD}from"./HandleOwner-9b396af1.js";import{s as gc}from"./intl-65a3e389.js";import{s as oI,t as bte}from"./byteSizeEstimations-f0cab514.js";import{O as wte,E as wP,J as xte,K as Tte,R as Cte,$ as Gm,a as Ste,u as Yt,L as Ete}from"./unitUtils-45d1147c.js";import{m as xP,L as LE,u as Pte,S as O7}from"./number-27cf8195.js";import{a as Rte,s as JR}from"./executeQueryJSON-2fe748db.js";import{c as u5,d as lI}from"./RelationshipQuery-0dda77ad.js";import{x as Ate,h as Ote,i as Mte}from"./fieldUtils-7f54c4b1.js";import{u as Ite,i as Lte,c as M7,a as $te,I as Dte,b as I7,d as Fte,e as Nte,f as $x,g as kte,h as Vte}from"./PopupTemplate-40f3c9aa.js";import{i as iD,o as Ute}from"./arcadeOnDemand-281a01eb.js";import{a as cI,n as zte}from"./assets-8d3e737a.js";import"./LegendOptions-010d0873.js";import{j as b_,x as eA,M as Bte,N as Gte,g as Hte}from"./utils-6786b611.js";import{l as ei}from"./Color-fb64d77d.js";import{S as jte,p as qte,d as L7,l as $7,i as rD,j as Wte,h as Xte,a as Qte,b as Zte}from"./symbols-f8232671.js";import{a as Yte}from"./jsonUtils-f5674613.js";import{U as Wh,y as Kte,Q as Jte,n as D7,I as nD,j as hI,a as eie,X as tie,S as iie}from"./request-6fc81c4c.js";import{m as rie,x as Ob}from"./Query-b96bcde0.js";import{n as nie}from"./featureConversionUtils-03a03f40.js";import{i as sie,v as Hm,c as aie,m as oie,u as F7,a as N7,o as lie,b as cie}from"./Polyline-ff2d7c6b.js";import{r as d5,s as hie,i as L1,f as uie,a as die,o as pie}from"./normalizeUtils-27e29a72.js";import"./pbf-0e99a620.js";import"./FeatureSet-d32b0eb8.js";import"./TopFeaturesQuery-cad97c37.js";import{l as mie}from"./locale-30120714.js";import k7 from"./FeatureLayer-041050b6.js";import{s as sD,i as TP}from"./Identifiable-bfe1ff30.js";import{n as nn}from"./Evented-a45c8b0f.js";import{b as uI}from"./Layer-5ffe0eda.js";import{h as fie,c as V7,f as U7,e as aD,i as $E,M as gie,r as z7,n as _ie}from"./mat2d-2bbb5feb.js";import{e as p5}from"./Queue-b7d3cd48.js";import{t as yie,I as dr,y as oD,a as Fh,F as CP,g as vie}from"./Scheduler-540208b6.js";import{s as m5,x as dI}from"./Basemap-af7f62f8.js";import{n as B7}from"./collectionUtils-803d9ba8.js";import{o as bie,n as Pa}from"./compilerUtils-18d58939.js";import{m as Am}from"./Loadable-268c900a.js";import{n as G7}from"./loadAll-b5bfa7ab.js";import{r as Ra}from"./enumeration-3a03bd31.js";import{r as wie,n as xie}from"./opacityUtils-1f7f5126.js";import{l as Tie,d as Cie,t as Sie}from"./TablesMixin-bc97d131.js";import{T as H0}from"./TimeExtent-23e282b9.js";import{j as Dx,b as gw,c as lD}from"./asyncUtils-437defc4.js";import{m as cD,_ as Eie}from"./Promise-376ab9f6.js";import{l as Pie,i as H7,a as pI}from"./GraphicsCollection-c37a9ffd.js";import{v as Fx}from"./HeightModelInfo-5d01231e.js";import{m as mI,j as Rie}from"./arcgisLayerUrl-c09f09b4.js";import{l as Se,a as tA,o as f5}from"./ViewingMode-5d7d590b.js";import{t as fI,r as Aie,I as xl}from"./enums-0fc02184.js";import{r as SP,a as hD}from"./common-c186b691.js";import{o as Pc,v as j0,y as Oie,j as Fr,q as gI,C as j7,l as qs,r as Je,z as Yu,g as q7,a as wn,s as yc,m as q0,L as jy,A as Xf,k as Mie,E as Iie,b as g5,H as Lie,_ as _5}from"./vec2-528adfe4.js";import{r as Xt,n as be,f as Pg,t as lT,e as $ie}from"./vec2f64-30dc1443.js";import{s as _I,r as W7,M as yI,h as X7,i as uD,o as qc,c as Q7,u as Zg,a as Td,g as Die,f as Z7,p as Fie}from"./mat3-3fc68e72.js";import{e as cm,r as Nie}from"./mat3f32-d3d088e8.js";import{t as Vp,n as kie}from"./vec2f32-461e65a9.js";import"./TileStrategy-a90cd1af.js";import{d as Vie,h as Uie}from"./TileStore-00ac650f.js";import"./TileKey-5aef17b6.js";import{g as Q,o as Z,S as Nl,z as he,P as me,_ as nt,s as _e,u as oe,A as Bn,e as ne,r as q,x as Ii,H as Yg,F as Oc,O as Ce,v as Ml,M as zie,J as tl,G as Rg,p as Bl,Z as y5,X as Y7,j as Aa,U as K7,c as Bie,q as v5,Y as jd,E as Gie,V as b5}from"./vec3-e93e648f.js";import{l as Hie}from"./capabilities-302cf20d.js";import{r as Nn,o as jie}from"./context-util-a4ce3a7b.js";import{n as qie}from"./BlendLayer-20d0571b.js";import{t as Wie}from"./ScaleRangeLayer-4be07229.js";import{u as $t,c as _w,f as J7,b as eG,H as Xie,D as Uc,z as DE,s as Nh,l as Om,h as hm,E as EP,M as vI,a as yw,m as dD,p as pD,o as tG,d as Qie,K as Zie,q as Yie,I as mg,U as bI,R as w5,y as iG,w as Kie,g as x5}from"./aaBoundingRect-193543b5.js";import{o as Jie}from"./BoundsStore-b9fa27cc.js";import{e as Or}from"./mat3f64-c6305894.js";import{n as R,r as Ge,t as as,b as ere,e as Tl,f as Gl,l as em,i as tre}from"./vec3f64-2f9cef06.js";import{s as mD,c as ze,b as ire,f as Mb,n as tm,E as rre,$ as nre,p as zc,z as PP,q as sre,d as oo,h as are,k as wI,Y as RP,O as fD,W as gD,r as ore,a as rG,e as lre,R as ou,F as cre,g as _D,C as hre,w as ure,i as nG,T as sG}from"./sphere-2af0d852.js";import{h as kn,o as yD,g as Bc,n as pn,k as dre,Q as vD,u as Hr,m as vw,f as kl,r as Ag,b as bw,l as bD,A as pre,B as mre,R as fre,c as ru,F as aG,x as oG,s as lG,i as cG,C as gre,v as _re}from"./mat4-44a0988f.js";import{e as ve,t as hG,o as rn,r as _S}from"./mat4f64-1e28eae0.js";import{v as fv,A as T5,M as wD,b as fg,k as uG}from"./lineSegment-10422ca0.js";import{p as fr,E as yre,A as dG,O as ww,F as vre,q as Kg,x as bre,U as wre,z as pG,H as xre,Y as Ia,L as xI,_ as xw,R as tr,T as mG,P as TI,j as Bh,b as Tre,K as C5}from"./plane-b575face.js";import{o as Cre,r as Sre}from"./scaleUtils-93ad8d0c.js";import{s as CI,c as Ere,t as Ib,i as fG,r as S5,n as E5,o as P5,l as Pre}from"./layerUtils-f4d08f94.js";import{h as Rre,t as Are}from"./ElevationSamplerData-b87e0e50.js";import{s as lo,t as Ore,e as Mre}from"./Ellipsoid-89682c5e.js";import{n as _i,e as Ire,r as Bi,t as xD,_ as Rc,l as w0}from"./vec4f64-e407da96.js";import{r as Qs,w as sd,a as im,D as SI,b as R5,l as TD,s as Lre,G as gG,j as $re}from"./vec4-790471c0.js";import{o as AP,d as Mm,a as OP,m as Dre,b as zr,r as Fre,s as Tw,e as CD,c as SD,v as _G,f as Nre,t as kre,x as Vre,h as yG,n as vG}from"./PhysicallyBasedRendering.glsl-d457fff5.js";import{a as Og}from"./ReadLinearDepth.glsl-9c87a54a.js";import{e as ED,v as Ure,I as PD,c as zre,i as Bre,E as Kr,r as Ih,a as ba,R as RD,n as FE,b as Gre,_ as Hre,d as jre}from"./WaterSurface.glsl-c64cb8f1.js";import{e as Zs,f as Bt,i as Ko,u as bG,a as il,r as Nx}from"./Texture2DPassUniform-753de459.js";import{e as Ys,a as Rs,v as qre,d as A5,c as Wre,o as Xre,b as O5}from"./View.glsl-3ce196d4.js";import{e as Xh}from"./Float4PassUniform-d7bdbc81.js";import{o as Tt}from"./FloatPassUniform-68d54f51.js";import{o as Yi,n as O,t as Ir,i as Jg,a as AD}from"./ShaderBuilder-a7d0da4e.js";import{O as P}from"./VertexAttribute-9c5c630d.js";import{e as ti,o as Jt,W as Ke,l as Gn,_ as ht,t as ii,s as lu,L as iA,r as wG,n as Qre,i as xG,c as Zre,a as nl,P as TG,b as Yre,h as OD,p as NE,d as Kre,f as Jre,u as CG,M as ene}from"./EvaluateSceneLighting.glsl-189abc15.js";import{E as ai,u as La,A as kx,r as nu,a as MP,d as Fd,o as tne,f as SG,b as M5,L as ine,c as cr,e as EG,g as gv,h as EI,i as PI,j as Vx,v as PG,x as MD,l as rne,s as RG,k as nne,U as sne,p as ane,m as ID,O as AG,n as OG,q as one,t as rd,V as MG,w as lne,y as IG,z as cne,N as hne,B as Mg,C as une,D as dne,F as I5}from"./VisualVariablePassParameters-d460182b.js";import{R as de,I as hs,E as Dt,T as Cw,Y as Vn,M as vi,P as yt,G as qt,D as si,L as Kt,F as di,V as rs,_ as Ai,C as um,B as pne,U as yS,N as tg,S as LG,O as x0,t as Lb,A as Mt,X as rA,n as Kl,W as mne,r as L5,f as fne}from"./enums-64ab819c.js";import{e as N,t as $a}from"./ShaderTechniqueConfiguration-9f5b4555.js";import{t as gne}from"./PiUtils.glsl-db6418ee.js";import{e as $G,o as Ht}from"./TransparencyPassType-a11868d2.js";import{a as e_}from"./RgbaFloatEncoding.glsl-52af7fcf.js";import{r as gi,a as _ne,n as Xi,t as $5}from"./vec3f32-c9aa289f.js";import{o as Nd}from"./ScreenSpacePass-d5e48a9b.js";import{o as RI,i as IP,a as yne,t as D5,b as F5,d as DG,F as vS,c as vne,W as bne,e as N5}from"./ForwardLinearDepth.glsl-56affafd.js";import{x as yn,n as Ws,E as hi,R as FG,a as NG,u as kE,b as Gc,s as wne,i as k5}from"./FramebufferObject-a3b9c52c.js";import{s as xne,c as Tne,p as Im,a as mu}from"./HUD.glsl-d3a072ad.js";import{o as Cne,n as AI}from"./MultipassTerrainTest.glsl-bb236672.js";import{E as ae,d as jr,u as Sne,y as V5,j as Ac,A as jm,a as Ene,h as kG,o as Pne,b as LD,B as VG,c as UG,e as Sw,f as Rne,t as t_,g as Hl,l as i_,i as LP,k as Cd,m as Ig,n as r_,_ as $D,s as VE,p as zG,q as BG,P as GG,r as DD,v as FD,w as ND,x as kD,S as VD,C as Ew,z as Ane,D as Fv,F as One,G as Mne,Y as Ine,H as U5,I as Lne,J as $ne,L as Dne,K as Fne,V as Nne,M as kne,N as Vne}from"./objectResourceUtils-d556a033.js";import{s as cu}from"./DefaultTechniqueConfiguration-588e5ab2.js";import{r as HG}from"./Transform.glsl-6d2e2fd9.js";import{o as Wc,m as Une,A as OI,a as MI,f as zne,e as Bne,u as z5,T as B5,d as Gne,w as Hne}from"./edgeProcessing-f733ce76.js";import{T as sn}from"./InterleavedLayout-984d67b2.js";import{a as Fc,u as Lg,l as UE,i as zE,O as bS,n as tn,c as UD,C as Ho,N as vr,t as $b,D as Pw}from"./basicInterfaces-19ed850e.js";import{u as zD,m as jne,n as qne}from"./DefaultMaterial_COLOR_GAMMA-fe26fda8.js";import{e as it,i as G5,g as Wne,l as Xne,k as Qne,m as Zne,M as jG,f as Yne,s as w_,u as cT,h as Kne}from"./Util-a48361c6.js";import{E as Gi,n as Ca,a as qd}from"./Texture-243be4d7.js";import{a as Jne,q as H5,g as j5,R as ese,v as tse,j as ise,V as rse,k as nse}from"./projection-a69d43d0.js";import{h as k,e as qG}from"./Matrix3PassUniform-ad9f953b.js";import{H as Rw,u as BE,s as WG,l as Ti,I as sse,L as ase,i as $P,P as ose,m as lse,p as XG,k as cse,G as Mc,U as hr,v as hse}from"./Octree-0a267ea2.js";import{S as use}from"./quat-3d5eec2d.js";import{e as dse}from"./quatf64-7fd38d64.js";import{a as Ms,A as Mi,p as Ic,P as BD,B as GD,c as W0,f as X0,I as QG,N as HD,y as ZG,d as pse,q as mse,V as YG,E as jD,w as qD,D as fse,l as gse,M as Jo,R as Lc,h as _se,g as KG,F as hT,u as II,k as yse}from"./aaBoundingBox-657a9b82.js";import{x as Lm,T as $m,i as Dm,u as JG,b as q5,l as Aw,h as vse,c as Sd,d as W5,a as eH}from"./BufferView-903d1848.js";import{V as bse,H as X5}from"./HUDMaterial.glsl-32cf019c.js";import{v as kd,J as wse,w as xse}from"./dehydratedFeatures-0557137d.js";import{createLabelFunction as Tse}from"./labelFormatUtils-d25d1d9e.js";import{r as Cse,n as Sse}from"./ElevationInfo-215614d8.js";import{A as _t,a as Ese,f as tH,U as Pse,J as Rse,F as Q5,O as Ase,W as Ose}from"./I3SUtil-f31a4571.js";import{u as Mse}from"./LineCallout.glsl-358ef89b.js";import{x as Ow}from"./earcut-58237617.js";import{t as iH,r as GE,e as rH}from"./vec33-e98769e8.js";import{t as Ise,e as Z5}from"./SnappingCandidate-970faec6.js";import{N as nH}from"./UniqueValueRenderer-08f8851c.js";import{l as DP,c as Q0,g as Lse,a as $se,e as nA}from"./MeshComponent-a43522cc.js";import{d as Dse,i as Fse}from"./TextureOnly.glsl-1ec9a9ef.js";import{s as sH,a as Nse,p as sA,f as kse}from"./MarkerSizing.glsl-566261cc.js";import{A as Vse,s as Use,r as T0,j as zse}from"./RibbonLine.glsl-0f7c2bbc.js";import{c as Bse,f as Gse,o as Hse,i as Il,e as jse,a as qse,b as C0,n as aH,t as Wse}from"./MixExternalColor.glsl-ab0706f7.js";import{i as Xse,s as Qse,h as Zse,r as Yse}from"./MemCache-18a255ed.js";import{u as oH}from"./LineStipple.glsl-ed22a88b.js";import{i as Kse}from"./callExpressionWithFeature-55effb7b.js";import{m as Y5}from"./lengthUtils-fa751420.js";import{e as K5,o as Jse,a as eae}from"./sdfPrimitives-9858c36d.js";import{L as FP}from"./Texture-46c8c2cb.js";import{d as tae}from"./CIMSymbol-539bd447.js";import{M as iae}from"./LineMarker.glsl-8166d610.js";import{n as rae,o as lH,r as HE}from"./symbolColorUtils-b2b55883.js";import{v as nae}from"./NativeLine.glsl-742e9e29.js";import{c as sae,t as aA}from"./symbolLayerUtils3D-76acc268.js";import{i as ho}from"./Normals.glsl-76f97814.js";import{_ as aae,p as oae}from"./Path.glsl-9f6bab44.js";import{f as lae}from"./ColorMaterial.glsl-3a70e4a7.js";import{a as Up,T as cae}from"./Pattern.glsl-67f4595b.js";import{r as Z0,a as hae,c as uae,_ as dae,p as pae,T as mae,E as fae,m as gae,l as J5,n as ek,h as _ae,b as yae}from"./DefaultVertexAttributeLayouts-2bcf3941.js";import{j as $1}from"./Portal-2bb189b3.js";import{n as vae}from"./RefreshableLayer-7f154951.js";import{n as bae,h as wae}from"./LercDecoder-4c9b29b3.js";import{e as tk}from"./config-1337d16e.js";import{u as cH,p as xae}from"./Slice.glsl-3b39b1f7.js";import{o as LI}from"./OutputDepth.glsl-470c8e2a.js";import{a as hH,i as Tae}from"./OutputHighlight.glsl-fbac199a.js";import{r as Cae}from"./NormalUtils.glsl-c12729bf.js";import{o as $I,r as uH}from"./floatRGBA-9ad35d39.js";import{u as NP,o as dH,f as WD}from"./Texture2DDrawUniform-053796dc.js";import{e as pH}from"./VertexColor.glsl-8c022fa8.js";import{c as Sae}from"./DefaultMaterial.glsl-885671b3.js";import{t as Eae,o as Pae}from"./AlphaCutoff-96178e0d.js";import{n as XD}from"./SSAO.glsl-980b3771.js";import{D as uT}from"./workerHelper-e756ac3a.js";import{t as QD}from"./VertexElementDescriptor-2925c6af.js";import{O as mH,S as fH}from"./MultiOriginJSONSupport-aae3bc0c.js";import{i as Rae}from"./originUtils-1469eeaf.js";import{t as dT}from"./deprecate-035b199e.js";import{d as Aae}from"./EditBusLayer-e750b15b.js";import jE from"./PortalItem-bb7e98a6.js";import{s as Vd}from"./jsonMap-7b8332c9.js";import{c as xo,i as x_,s as Nv,f as ZD}from"./portalItemUtils-2ccd793f.js";import{l as gH}from"./TimeInfo-1d30dc7c.js";import{y as Oae}from"./writeUtils-e686bd33.js";import{i as _H}from"./fieldType-f31285f7.js";import{r as Mae}from"./Version-2946cc03.js";import"./nextTick-3ee5a785.js";import"./typeUtils-35750739.js";import"./SimpleObservable-23231131.js";import"./Connection-9a1cf8da.js";import"./zscale-89472cba.js";import"./uuid-73213768.js";import"./messages-2289086c.js";import"./query-694f7287.js";import"./pbfQueryUtils-4adda2cc.js";import"./OptimizedFeature-4ab8d380.js";import"./OptimizedFeatureSet-1d1ac4b9.js";import"./queryZScale-1481fa99.js";import"./parser-498c8be0.js";import"./colorUtils-639f4d25.js";import"./mat4f32-77b3d8ac.js";import"./ItemCache-fd3aceaf.js";import"./Symbol-f93ed9fd.js";import"./persistableUrlUtils-5f719c3b.js";import"./Symbol3DAnchorPosition2D-5726d999.js";import"./DictionaryLoader-1cbfea53.js";import"./LRUCache-64ec42ee.js";import"./heatmapUtils-aaea3f32.js";import"./Field-61ec9870.js";import"./LayerFloorInfo-54b916a2.js";import"./FeatureLayerBase-ad5cfa1a.js";import"./OperationalLayer-97084f13.js";import"./editsZScale-6a661299.js";import"./APIKeyMixin-a0a8917a.js";import"./ArcGISService-21dc1d06.js";import"./CustomParametersMixin-47aab0a6.js";import"./FeatureReductionLayer-d69dae71.js";import"./labelingInfo-607e66b8.js";import"./labelUtils-3108e8d7.js";import"./defaultsJSON-59981e75.js";import"./jsonUtils-0ff4ff96.js";import"./sizeVariableUtils-d4870b0d.js";import"./OrderedLayer-af7a6030.js";import"./PortalLayer-b2643f87.js";import"./PortalUser-659cc1d2.js";import"./PortalGroup-8e41557a.js";import"./TemporalLayer-61549309.js";import"./FeatureTemplate-c1d0bb70.js";import"./FeatureType-34d71ade.js";import"./fieldProperties-e2eeb1d5.js";import"./FieldsIndex-f104cc5f.js";import"./versionUtils-fd91f55f.js";import"./styleUtils-a989c0af.js";import"./popupUtils-86dc6b94.js";import"./rbush-8e36784a.js";import"./quickselect-322ec8e1.js";import"./PooledRBush-3e149119.js";import"./SSAOBlur.glsl-8bf33b65.js";import"./VerticalOffset.glsl-87cbb2e3.js";import"./devEnvironmentUtils-5002a058.js";import"./RealisticTree.glsl-b6cc03f2.js";import"./VisualVariables.glsl-2b937327.js";import"./deduplicate-03981d62.js";import"./types-e1c0a5bf.js";import"./ObjectAndLayerIdColor.glsl-ad468647.js";import"./quantizationUtils-4dd81f85.js";import"./I3SBinaryReader-f4829435.js";import"./diffUtils-68b89c71.js";import"./colorRamps-9dac42c1.js";import"./styleUtils-22b14a8b.js";import"./DiscardOrAdjustAlphaBlend.glsl-73258f38.js";import"./multiOriginJSONSupportUtils-c978f4c3.js";function Iae(i,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const n in r)if(n!=="default"&&!(n in i)){const s=Object.getOwnPropertyDescriptor(r,n);s&&Object.defineProperty(i,n,s.get?s:{enumerable:!0,get:()=>r[n]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(n){if(n.ep)return;n.ep=!0;const s=t(n);fetch(n.href,s)}})();var ik=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Lae(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var qE={},$ae={get exports(){return qE},set exports(i){qE=i}},kP={},Pe={},Dae={get exports(){return Pe},set exports(i){Pe=i}},oi={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ux=Symbol.for("react.element"),Fae=Symbol.for("react.portal"),Nae=Symbol.for("react.fragment"),kae=Symbol.for("react.strict_mode"),Vae=Symbol.for("react.profiler"),Uae=Symbol.for("react.provider"),zae=Symbol.for("react.context"),Bae=Symbol.for("react.forward_ref"),Gae=Symbol.for("react.suspense"),Hae=Symbol.for("react.memo"),jae=Symbol.for("react.lazy"),rk=Symbol.iterator;function qae(i){return i===null||typeof i!="object"?null:(i=rk&&i[rk]||i["@@iterator"],typeof i=="function"?i:null)}var yH={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},vH=Object.assign,bH={};function _v(i,e,t){this.props=i,this.context=e,this.refs=bH,this.updater=t||yH}_v.prototype.isReactComponent={};_v.prototype.setState=function(i,e){if(typeof i!="object"&&typeof i!="function"&&i!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,i,e,"setState")};_v.prototype.forceUpdate=function(i){this.updater.enqueueForceUpdate(this,i,"forceUpdate")};function wH(){}wH.prototype=_v.prototype;function YD(i,e,t){this.props=i,this.context=e,this.refs=bH,this.updater=t||yH}var KD=YD.prototype=new wH;KD.constructor=YD;vH(KD,_v.prototype);KD.isPureReactComponent=!0;var nk=Array.isArray,xH=Object.prototype.hasOwnProperty,JD={current:null},TH={key:!0,ref:!0,__self:!0,__source:!0};function CH(i,e,t){var r,n={},s=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)xH.call(e,r)&&!TH.hasOwnProperty(r)&&(n[r]=e[r]);var o=arguments.length-2;if(o===1)n.children=t;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];n.children=l}if(i&&i.defaultProps)for(r in o=i.defaultProps,o)n[r]===void 0&&(n[r]=o[r]);return{$$typeof:Ux,type:i,key:s,ref:a,props:n,_owner:JD.current}}function Wae(i,e){return{$$typeof:Ux,type:i.type,key:e,ref:i.ref,props:i.props,_owner:i._owner}}function eF(i){return typeof i=="object"&&i!==null&&i.$$typeof===Ux}function Xae(i){var e={"=":"=0",":":"=2"};return"$"+i.replace(/[=:]/g,function(t){return e[t]})}var sk=/\/+/g;function oA(i,e){return typeof i=="object"&&i!==null&&i.key!=null?Xae(""+i.key):e.toString(36)}function wS(i,e,t,r,n){var s=typeof i;(s==="undefined"||s==="boolean")&&(i=null);var a=!1;if(i===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(i.$$typeof){case Ux:case Fae:a=!0}}if(a)return a=i,n=n(a),i=r===""?"."+oA(a,0):r,nk(n)?(t="",i!=null&&(t=i.replace(sk,"$&/")+"/"),wS(n,e,t,"",function(c){return c})):n!=null&&(eF(n)&&(n=Wae(n,t+(!n.key||a&&a.key===n.key?"":(""+n.key).replace(sk,"$&/")+"/")+i)),e.push(n)),1;if(a=0,r=r===""?".":r+":",nk(i))for(var o=0;o<i.length;o++){s=i[o];var l=r+oA(s,o);a+=wS(s,e,t,l,n)}else if(l=qae(i),typeof l=="function")for(i=l.call(i),o=0;!(s=i.next()).done;)s=s.value,l=r+oA(s,o++),a+=wS(s,e,t,l,n);else if(s==="object")throw e=String(i),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function pT(i,e,t){if(i==null)return i;var r=[],n=0;return wS(i,r,"","",function(s){return e.call(t,s,n++)}),r}function Qae(i){if(i._status===-1){var e=i._result;e=e(),e.then(function(t){(i._status===0||i._status===-1)&&(i._status=1,i._result=t)},function(t){(i._status===0||i._status===-1)&&(i._status=2,i._result=t)}),i._status===-1&&(i._status=0,i._result=e)}if(i._status===1)return i._result.default;throw i._result}var Da={current:null},xS={transition:null},Zae={ReactCurrentDispatcher:Da,ReactCurrentBatchConfig:xS,ReactCurrentOwner:JD};oi.Children={map:pT,forEach:function(i,e,t){pT(i,function(){e.apply(this,arguments)},t)},count:function(i){var e=0;return pT(i,function(){e++}),e},toArray:function(i){return pT(i,function(e){return e})||[]},only:function(i){if(!eF(i))throw Error("React.Children.only expected to receive a single React element child.");return i}};oi.Component=_v;oi.Fragment=Nae;oi.Profiler=Vae;oi.PureComponent=YD;oi.StrictMode=kae;oi.Suspense=Gae;oi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Zae;oi.cloneElement=function(i,e,t){if(i==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+i+".");var r=vH({},i.props),n=i.key,s=i.ref,a=i._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=JD.current),e.key!==void 0&&(n=""+e.key),i.type&&i.type.defaultProps)var o=i.type.defaultProps;for(l in e)xH.call(e,l)&&!TH.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=t;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];r.children=o}return{$$typeof:Ux,type:i.type,key:n,ref:s,props:r,_owner:a}};oi.createContext=function(i){return i={$$typeof:zae,_currentValue:i,_currentValue2:i,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},i.Provider={$$typeof:Uae,_context:i},i.Consumer=i};oi.createElement=CH;oi.createFactory=function(i){var e=CH.bind(null,i);return e.type=i,e};oi.createRef=function(){return{current:null}};oi.forwardRef=function(i){return{$$typeof:Bae,render:i}};oi.isValidElement=eF;oi.lazy=function(i){return{$$typeof:jae,_payload:{_status:-1,_result:i},_init:Qae}};oi.memo=function(i,e){return{$$typeof:Hae,type:i,compare:e===void 0?null:e}};oi.startTransition=function(i){var e=xS.transition;xS.transition={};try{i()}finally{xS.transition=e}};oi.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};oi.useCallback=function(i,e){return Da.current.useCallback(i,e)};oi.useContext=function(i){return Da.current.useContext(i)};oi.useDebugValue=function(){};oi.useDeferredValue=function(i){return Da.current.useDeferredValue(i)};oi.useEffect=function(i,e){return Da.current.useEffect(i,e)};oi.useId=function(){return Da.current.useId()};oi.useImperativeHandle=function(i,e,t){return Da.current.useImperativeHandle(i,e,t)};oi.useInsertionEffect=function(i,e){return Da.current.useInsertionEffect(i,e)};oi.useLayoutEffect=function(i,e){return Da.current.useLayoutEffect(i,e)};oi.useMemo=function(i,e){return Da.current.useMemo(i,e)};oi.useReducer=function(i,e,t){return Da.current.useReducer(i,e,t)};oi.useRef=function(i){return Da.current.useRef(i)};oi.useState=function(i){return Da.current.useState(i)};oi.useSyncExternalStore=function(i,e,t){return Da.current.useSyncExternalStore(i,e,t)};oi.useTransition=function(){return Da.current.useTransition()};oi.version="18.2.0";(function(i){i.exports=oi})(Dae);const Mw=Lae(Pe),DI=Iae({__proto__:null,default:Mw},[Pe]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yae=Pe,Kae=Symbol.for("react.element"),Jae=Symbol.for("react.fragment"),eoe=Object.prototype.hasOwnProperty,toe=Yae.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ioe={key:!0,ref:!0,__self:!0,__source:!0};function SH(i,e,t){var r,n={},s=null,a=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)eoe.call(e,r)&&!ioe.hasOwnProperty(r)&&(n[r]=e[r]);if(i&&i.defaultProps)for(r in e=i.defaultProps,e)n[r]===void 0&&(n[r]=e[r]);return{$$typeof:Kae,type:i,key:s,ref:a,props:n,_owner:toe.current}}kP.Fragment=Jae;kP.jsx=SH;kP.jsxs=SH;(function(i){i.exports=kP})($ae);const Lt=qE.jsx,nd=qE.jsxs;var FI={},NI={},roe={get exports(){return NI},set exports(i){NI=i}},ol={},kI={},noe={get exports(){return kI},set exports(i){kI=i}},EH={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(i){function e($,B){var W=$.length;$.push(B);e:for(;0<W;){var te=W-1>>>1,ie=$[te];if(0<n(ie,B))$[te]=B,$[W]=ie,W=te;else break e}}function t($){return $.length===0?null:$[0]}function r($){if($.length===0)return null;var B=$[0],W=$.pop();if(W!==B){$[0]=W;e:for(var te=0,ie=$.length,Y=ie>>>1;te<Y;){var se=2*(te+1)-1,Ee=$[se],Re=se+1,Ie=$[Re];if(0>n(Ee,W))Re<ie&&0>n(Ie,Ee)?($[te]=Ie,$[Re]=W,te=Re):($[te]=Ee,$[se]=W,te=se);else if(Re<ie&&0>n(Ie,W))$[te]=Ie,$[Re]=W,te=Re;else break e}}return B}function n($,B){var W=$.sortIndex-B.sortIndex;return W!==0?W:$.id-B.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;i.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();i.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,d=null,m=3,f=!1,_=!1,g=!1,x=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w($){for(var B=t(c);B!==null;){if(B.callback===null)r(c);else if(B.startTime<=$)r(c),B.sortIndex=B.expirationTime,e(l,B);else break;B=t(c)}}function T($){if(g=!1,w($),!_)if(t(l)!==null)_=!0,V(E);else{var B=t(c);B!==null&&X(T,B.startTime-$)}}function E($,B){_=!1,g&&(g=!1,b(M),M=-1),f=!0;var W=m;try{for(w(B),d=t(l);d!==null&&(!(d.expirationTime>B)||$&&!U());){var te=d.callback;if(typeof te=="function"){d.callback=null,m=d.priorityLevel;var ie=te(d.expirationTime<=B);B=i.unstable_now(),typeof ie=="function"?d.callback=ie:d===t(l)&&r(l),w(B)}else r(l);d=t(l)}if(d!==null)var Y=!0;else{var se=t(c);se!==null&&X(T,se.startTime-B),Y=!1}return Y}finally{d=null,m=W,f=!1}}var C=!1,A=null,M=-1,I=5,L=-1;function U(){return!(i.unstable_now()-L<I)}function j(){if(A!==null){var $=i.unstable_now();L=$;var B=!0;try{B=A(!0,$)}finally{B?re():(C=!1,A=null)}}else C=!1}var re;if(typeof v=="function")re=function(){v(j)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,H=ee.port2;ee.port1.onmessage=j,re=function(){H.postMessage(null)}}else re=function(){x(j,0)};function V($){A=$,C||(C=!0,re())}function X($,B){M=x(function(){$(i.unstable_now())},B)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function($){$.callback=null},i.unstable_continueExecution=function(){_||f||(_=!0,V(E))},i.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<$?Math.floor(1e3/$):5},i.unstable_getCurrentPriorityLevel=function(){return m},i.unstable_getFirstCallbackNode=function(){return t(l)},i.unstable_next=function($){switch(m){case 1:case 2:case 3:var B=3;break;default:B=m}var W=m;m=B;try{return $()}finally{m=W}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function($,B){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var W=m;m=$;try{return B()}finally{m=W}},i.unstable_scheduleCallback=function($,B,W){var te=i.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?te+W:te):W=te,$){case 1:var ie=-1;break;case 2:ie=250;break;case 5:ie=1073741823;break;case 4:ie=1e4;break;default:ie=5e3}return ie=W+ie,$={id:u++,callback:B,priorityLevel:$,startTime:W,expirationTime:ie,sortIndex:-1},W>te?($.sortIndex=W,e(c,$),t(l)===null&&$===t(c)&&(g?(b(M),M=-1):g=!0,X(T,W-te))):($.sortIndex=ie,e(l,$),_||f||(_=!0,V(E))),$},i.unstable_shouldYield=U,i.unstable_wrapCallback=function($){var B=m;return function(){var W=m;m=B;try{return $.apply(this,arguments)}finally{m=W}}}})(EH);(function(i){i.exports=EH})(noe);/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var PH=Pe,sl=kI;function ge(i){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+i,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+i+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var RH=new Set,Iw={};function n_(i,e){Y0(i,e),Y0(i+"Capture",e)}function Y0(i,e){for(Iw[i]=e,i=0;i<e.length;i++)RH.add(e[i])}var Ed=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),VI=Object.prototype.hasOwnProperty,soe=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,ak={},ok={};function aoe(i){return VI.call(ok,i)?!0:VI.call(ak,i)?!1:soe.test(i)?ok[i]=!0:(ak[i]=!0,!1)}function ooe(i,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function loe(i,e,t,r){if(e===null||typeof e>"u"||ooe(i,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Fa(i,e,t,r,n,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=n,this.mustUseProperty=t,this.propertyName=i,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var Is={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){Is[i]=new Fa(i,0,!1,i,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var e=i[0];Is[e]=new Fa(e,1,!1,i[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(i){Is[i]=new Fa(i,2,!1,i.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){Is[i]=new Fa(i,2,!1,i,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){Is[i]=new Fa(i,3,!1,i.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(i){Is[i]=new Fa(i,3,!0,i,null,!1,!1)});["capture","download"].forEach(function(i){Is[i]=new Fa(i,4,!1,i,null,!1,!1)});["cols","rows","size","span"].forEach(function(i){Is[i]=new Fa(i,6,!1,i,null,!1,!1)});["rowSpan","start"].forEach(function(i){Is[i]=new Fa(i,5,!1,i.toLowerCase(),null,!1,!1)});var tF=/[\-:]([a-z])/g;function iF(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var e=i.replace(tF,iF);Is[e]=new Fa(e,1,!1,i,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var e=i.replace(tF,iF);Is[e]=new Fa(e,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(i){var e=i.replace(tF,iF);Is[e]=new Fa(e,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(i){Is[i]=new Fa(i,1,!1,i.toLowerCase(),null,!1,!1)});Is.xlinkHref=new Fa("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(i){Is[i]=new Fa(i,1,!1,i.toLowerCase(),null,!0,!0)});function rF(i,e,t,r){var n=Is.hasOwnProperty(e)?Is[e]:null;(n!==null?n.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(loe(e,t,n,r)&&(t=null),r||n===null?aoe(e)&&(t===null?i.removeAttribute(e):i.setAttribute(e,""+t)):n.mustUseProperty?i[n.propertyName]=t===null?n.type===3?!1:"":t:(e=n.attributeName,r=n.attributeNamespace,t===null?i.removeAttribute(e):(n=n.type,t=n===3||n===4&&t===!0?"":""+t,r?i.setAttributeNS(r,e,t):i.setAttribute(e,t))))}var Ud=PH.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,mT=Symbol.for("react.element"),qy=Symbol.for("react.portal"),Wy=Symbol.for("react.fragment"),nF=Symbol.for("react.strict_mode"),UI=Symbol.for("react.profiler"),AH=Symbol.for("react.provider"),OH=Symbol.for("react.context"),sF=Symbol.for("react.forward_ref"),zI=Symbol.for("react.suspense"),BI=Symbol.for("react.suspense_list"),aF=Symbol.for("react.memo"),zp=Symbol.for("react.lazy"),MH=Symbol.for("react.offscreen"),lk=Symbol.iterator;function kv(i){return i===null||typeof i!="object"?null:(i=lk&&i[lk]||i["@@iterator"],typeof i=="function"?i:null)}var Mr=Object.assign,lA;function D1(i){if(lA===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);lA=e&&e[1]||""}return`
`+lA+i}var cA=!1;function hA(i,e){if(!i||cA)return"";cA=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(i,[],e)}else{try{e.call()}catch(c){r=c}i.call(e.prototype)}else{try{throw Error()}catch(c){r=c}i()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var n=c.stack.split(`
`),s=r.stack.split(`
`),a=n.length-1,o=s.length-1;1<=a&&0<=o&&n[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(n[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||n[a]!==s[o]){var l=`
`+n[a].replace(" at new "," at ");return i.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",i.displayName)),l}while(1<=a&&0<=o);break}}}finally{cA=!1,Error.prepareStackTrace=t}return(i=i?i.displayName||i.name:"")?D1(i):""}function coe(i){switch(i.tag){case 5:return D1(i.type);case 16:return D1("Lazy");case 13:return D1("Suspense");case 19:return D1("SuspenseList");case 0:case 2:case 15:return i=hA(i.type,!1),i;case 11:return i=hA(i.type.render,!1),i;case 1:return i=hA(i.type,!0),i;default:return""}}function GI(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case Wy:return"Fragment";case qy:return"Portal";case UI:return"Profiler";case nF:return"StrictMode";case zI:return"Suspense";case BI:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case OH:return(i.displayName||"Context")+".Consumer";case AH:return(i._context.displayName||"Context")+".Provider";case sF:var e=i.render;return i=i.displayName,i||(i=e.displayName||e.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case aF:return e=i.displayName||null,e!==null?e:GI(i.type)||"Memo";case zp:e=i._payload,i=i._init;try{return GI(i(e))}catch{}}return null}function hoe(i){var e=i.type;switch(i.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=e.render,i=i.displayName||i.name||"",e.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return GI(e);case 8:return e===nF?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Fm(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function IH(i){var e=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function uoe(i){var e=IH(i)?"checked":"value",t=Object.getOwnPropertyDescriptor(i.constructor.prototype,e),r=""+i[e];if(!i.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var n=t.get,s=t.set;return Object.defineProperty(i,e,{configurable:!0,get:function(){return n.call(this)},set:function(a){r=""+a,s.call(this,a)}}),Object.defineProperty(i,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){i._valueTracker=null,delete i[e]}}}}function fT(i){i._valueTracker||(i._valueTracker=uoe(i))}function LH(i){if(!i)return!1;var e=i._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return i&&(r=IH(i)?i.checked?"true":"false":i.value),i=r,i!==t?(e.setValue(i),!0):!1}function WE(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function HI(i,e){var t=e.checked;return Mr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??i._wrapperState.initialChecked})}function ck(i,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=Fm(e.value!=null?e.value:t),i._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function $H(i,e){e=e.checked,e!=null&&rF(i,"checked",e,!1)}function jI(i,e){$H(i,e);var t=Fm(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&i.value===""||i.value!=t)&&(i.value=""+t):i.value!==""+t&&(i.value=""+t);else if(r==="submit"||r==="reset"){i.removeAttribute("value");return}e.hasOwnProperty("value")?qI(i,e.type,t):e.hasOwnProperty("defaultValue")&&qI(i,e.type,Fm(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(i.defaultChecked=!!e.defaultChecked)}function hk(i,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+i._wrapperState.initialValue,t||e===i.value||(i.value=e),i.defaultValue=e}t=i.name,t!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,t!==""&&(i.name=t)}function qI(i,e,t){(e!=="number"||WE(i.ownerDocument)!==i)&&(t==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+t&&(i.defaultValue=""+t))}var F1=Array.isArray;function S0(i,e,t,r){if(i=i.options,e){e={};for(var n=0;n<t.length;n++)e["$"+t[n]]=!0;for(t=0;t<i.length;t++)n=e.hasOwnProperty("$"+i[t].value),i[t].selected!==n&&(i[t].selected=n),n&&r&&(i[t].defaultSelected=!0)}else{for(t=""+Fm(t),e=null,n=0;n<i.length;n++){if(i[n].value===t){i[n].selected=!0,r&&(i[n].defaultSelected=!0);return}e!==null||i[n].disabled||(e=i[n])}e!==null&&(e.selected=!0)}}function WI(i,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ge(91));return Mr({},e,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function uk(i,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(ge(92));if(F1(t)){if(1<t.length)throw Error(ge(93));t=t[0]}e=t}e==null&&(e=""),t=e}i._wrapperState={initialValue:Fm(t)}}function DH(i,e){var t=Fm(e.value),r=Fm(e.defaultValue);t!=null&&(t=""+t,t!==i.value&&(i.value=t),e.defaultValue==null&&i.defaultValue!==t&&(i.defaultValue=t)),r!=null&&(i.defaultValue=""+r)}function dk(i){var e=i.textContent;e===i._wrapperState.initialValue&&e!==""&&e!==null&&(i.value=e)}function FH(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function XI(i,e){return i==null||i==="http://www.w3.org/1999/xhtml"?FH(e):i==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var gT,NH=function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,n){MSApp.execUnsafeLocalFunction(function(){return i(e,t,r,n)})}:i}(function(i,e){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=e;else{for(gT=gT||document.createElement("div"),gT.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=gT.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;e.firstChild;)i.appendChild(e.firstChild)}});function Lw(i,e){if(e){var t=i.firstChild;if(t&&t===i.lastChild&&t.nodeType===3){t.nodeValue=e;return}}i.textContent=e}var Db={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},doe=["Webkit","ms","Moz","O"];Object.keys(Db).forEach(function(i){doe.forEach(function(e){e=e+i.charAt(0).toUpperCase()+i.substring(1),Db[e]=Db[i]})});function kH(i,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||Db.hasOwnProperty(i)&&Db[i]?(""+e).trim():e+"px"}function VH(i,e){i=i.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,n=kH(t,e[t],r);t==="float"&&(t="cssFloat"),r?i.setProperty(t,n):i[t]=n}}var poe=Mr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function QI(i,e){if(e){if(poe[i]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ge(137,i));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ge(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ge(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ge(62))}}function ZI(i,e){if(i.indexOf("-")===-1)return typeof e.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var YI=null;function oF(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var KI=null,E0=null,P0=null;function pk(i){if(i=Gx(i)){if(typeof KI!="function")throw Error(ge(280));var e=i.stateNode;e&&(e=GP(e),KI(i.stateNode,i.type,e))}}function UH(i){E0?P0?P0.push(i):P0=[i]:E0=i}function zH(){if(E0){var i=E0,e=P0;if(P0=E0=null,pk(i),e)for(i=0;i<e.length;i++)pk(e[i])}}function BH(i,e){return i(e)}function GH(){}var uA=!1;function HH(i,e,t){if(uA)return i(e,t);uA=!0;try{return BH(i,e,t)}finally{uA=!1,(E0!==null||P0!==null)&&(GH(),zH())}}function $w(i,e){var t=i.stateNode;if(t===null)return null;var r=GP(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(i=i.type,r=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!r;break e;default:i=!1}if(i)return null;if(t&&typeof t!="function")throw Error(ge(231,e,typeof t));return t}var JI=!1;if(Ed)try{var Vv={};Object.defineProperty(Vv,"passive",{get:function(){JI=!0}}),window.addEventListener("test",Vv,Vv),window.removeEventListener("test",Vv,Vv)}catch{JI=!1}function moe(i,e,t,r,n,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(t,c)}catch(u){this.onError(u)}}var Fb=!1,XE=null,QE=!1,e3=null,foe={onError:function(i){Fb=!0,XE=i}};function goe(i,e,t,r,n,s,a,o,l){Fb=!1,XE=null,moe.apply(foe,arguments)}function _oe(i,e,t,r,n,s,a,o,l){if(goe.apply(this,arguments),Fb){if(Fb){var c=XE;Fb=!1,XE=null}else throw Error(ge(198));QE||(QE=!0,e3=c)}}function s_(i){var e=i,t=i;if(i.alternate)for(;e.return;)e=e.return;else{i=e;do e=i,e.flags&4098&&(t=e.return),i=e.return;while(i)}return e.tag===3?t:null}function jH(i){if(i.tag===13){var e=i.memoizedState;if(e===null&&(i=i.alternate,i!==null&&(e=i.memoizedState)),e!==null)return e.dehydrated}return null}function mk(i){if(s_(i)!==i)throw Error(ge(188))}function yoe(i){var e=i.alternate;if(!e){if(e=s_(i),e===null)throw Error(ge(188));return e!==i?null:i}for(var t=i,r=e;;){var n=t.return;if(n===null)break;var s=n.alternate;if(s===null){if(r=n.return,r!==null){t=r;continue}break}if(n.child===s.child){for(s=n.child;s;){if(s===t)return mk(n),i;if(s===r)return mk(n),e;s=s.sibling}throw Error(ge(188))}if(t.return!==r.return)t=n,r=s;else{for(var a=!1,o=n.child;o;){if(o===t){a=!0,t=n,r=s;break}if(o===r){a=!0,r=n,t=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===t){a=!0,t=s,r=n;break}if(o===r){a=!0,r=s,t=n;break}o=o.sibling}if(!a)throw Error(ge(189))}}if(t.alternate!==r)throw Error(ge(190))}if(t.tag!==3)throw Error(ge(188));return t.stateNode.current===t?i:e}function qH(i){return i=yoe(i),i!==null?WH(i):null}function WH(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var e=WH(i);if(e!==null)return e;i=i.sibling}return null}var XH=sl.unstable_scheduleCallback,fk=sl.unstable_cancelCallback,voe=sl.unstable_shouldYield,boe=sl.unstable_requestPaint,Jr=sl.unstable_now,woe=sl.unstable_getCurrentPriorityLevel,lF=sl.unstable_ImmediatePriority,QH=sl.unstable_UserBlockingPriority,ZE=sl.unstable_NormalPriority,xoe=sl.unstable_LowPriority,ZH=sl.unstable_IdlePriority,VP=null,Qh=null;function Toe(i){if(Qh&&typeof Qh.onCommitFiberRoot=="function")try{Qh.onCommitFiberRoot(VP,i,void 0,(i.current.flags&128)===128)}catch{}}var Nc=Math.clz32?Math.clz32:Eoe,Coe=Math.log,Soe=Math.LN2;function Eoe(i){return i>>>=0,i===0?32:31-(Coe(i)/Soe|0)|0}var _T=64,yT=4194304;function N1(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function YE(i,e){var t=i.pendingLanes;if(t===0)return 0;var r=0,n=i.suspendedLanes,s=i.pingedLanes,a=t&268435455;if(a!==0){var o=a&~n;o!==0?r=N1(o):(s&=a,s!==0&&(r=N1(s)))}else a=t&~n,a!==0?r=N1(a):s!==0&&(r=N1(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&n)&&(n=r&-r,s=e&-e,n>=s||n===16&&(s&4194240)!==0))return e;if(r&4&&(r|=t&16),e=i.entangledLanes,e!==0)for(i=i.entanglements,e&=r;0<e;)t=31-Nc(e),n=1<<t,r|=i[t],e&=~n;return r}function Poe(i,e){switch(i){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Roe(i,e){for(var t=i.suspendedLanes,r=i.pingedLanes,n=i.expirationTimes,s=i.pendingLanes;0<s;){var a=31-Nc(s),o=1<<a,l=n[a];l===-1?(!(o&t)||o&r)&&(n[a]=Poe(o,e)):l<=e&&(i.expiredLanes|=o),s&=~o}}function t3(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function YH(){var i=_T;return _T<<=1,!(_T&4194240)&&(_T=64),i}function dA(i){for(var e=[],t=0;31>t;t++)e.push(i);return e}function zx(i,e,t){i.pendingLanes|=e,e!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,e=31-Nc(e),i[e]=t}function Aoe(i,e){var t=i.pendingLanes&~e;i.pendingLanes=e,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=e,i.mutableReadLanes&=e,i.entangledLanes&=e,e=i.entanglements;var r=i.eventTimes;for(i=i.expirationTimes;0<t;){var n=31-Nc(t),s=1<<n;e[n]=0,r[n]=-1,i[n]=-1,t&=~s}}function cF(i,e){var t=i.entangledLanes|=e;for(i=i.entanglements;t;){var r=31-Nc(t),n=1<<r;n&e|i[r]&e&&(i[r]|=e),t&=~n}}var Li=0;function KH(i){return i&=-i,1<i?4<i?i&268435455?16:536870912:4:1}var JH,hF,ej,tj,ij,i3=!1,vT=[],dm=null,pm=null,mm=null,Dw=new Map,Fw=new Map,Xp=[],Ooe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function gk(i,e){switch(i){case"focusin":case"focusout":dm=null;break;case"dragenter":case"dragleave":pm=null;break;case"mouseover":case"mouseout":mm=null;break;case"pointerover":case"pointerout":Dw.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Fw.delete(e.pointerId)}}function Uv(i,e,t,r,n,s){return i===null||i.nativeEvent!==s?(i={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:s,targetContainers:[n]},e!==null&&(e=Gx(e),e!==null&&hF(e)),i):(i.eventSystemFlags|=r,e=i.targetContainers,n!==null&&e.indexOf(n)===-1&&e.push(n),i)}function Moe(i,e,t,r,n){switch(e){case"focusin":return dm=Uv(dm,i,e,t,r,n),!0;case"dragenter":return pm=Uv(pm,i,e,t,r,n),!0;case"mouseover":return mm=Uv(mm,i,e,t,r,n),!0;case"pointerover":var s=n.pointerId;return Dw.set(s,Uv(Dw.get(s)||null,i,e,t,r,n)),!0;case"gotpointercapture":return s=n.pointerId,Fw.set(s,Uv(Fw.get(s)||null,i,e,t,r,n)),!0}return!1}function rj(i){var e=ig(i.target);if(e!==null){var t=s_(e);if(t!==null){if(e=t.tag,e===13){if(e=jH(t),e!==null){i.blockedOn=e,ij(i.priority,function(){ej(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){i.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}i.blockedOn=null}function TS(i){if(i.blockedOn!==null)return!1;for(var e=i.targetContainers;0<e.length;){var t=r3(i.domEventName,i.eventSystemFlags,e[0],i.nativeEvent);if(t===null){t=i.nativeEvent;var r=new t.constructor(t.type,t);YI=r,t.target.dispatchEvent(r),YI=null}else return e=Gx(t),e!==null&&hF(e),i.blockedOn=t,!1;e.shift()}return!0}function _k(i,e,t){TS(i)&&t.delete(e)}function Ioe(){i3=!1,dm!==null&&TS(dm)&&(dm=null),pm!==null&&TS(pm)&&(pm=null),mm!==null&&TS(mm)&&(mm=null),Dw.forEach(_k),Fw.forEach(_k)}function zv(i,e){i.blockedOn===e&&(i.blockedOn=null,i3||(i3=!0,sl.unstable_scheduleCallback(sl.unstable_NormalPriority,Ioe)))}function Nw(i){function e(n){return zv(n,i)}if(0<vT.length){zv(vT[0],i);for(var t=1;t<vT.length;t++){var r=vT[t];r.blockedOn===i&&(r.blockedOn=null)}}for(dm!==null&&zv(dm,i),pm!==null&&zv(pm,i),mm!==null&&zv(mm,i),Dw.forEach(e),Fw.forEach(e),t=0;t<Xp.length;t++)r=Xp[t],r.blockedOn===i&&(r.blockedOn=null);for(;0<Xp.length&&(t=Xp[0],t.blockedOn===null);)rj(t),t.blockedOn===null&&Xp.shift()}var R0=Ud.ReactCurrentBatchConfig,KE=!0;function Loe(i,e,t,r){var n=Li,s=R0.transition;R0.transition=null;try{Li=1,uF(i,e,t,r)}finally{Li=n,R0.transition=s}}function $oe(i,e,t,r){var n=Li,s=R0.transition;R0.transition=null;try{Li=4,uF(i,e,t,r)}finally{Li=n,R0.transition=s}}function uF(i,e,t,r){if(KE){var n=r3(i,e,t,r);if(n===null)xA(i,e,r,JE,t),gk(i,r);else if(Moe(n,i,e,t,r))r.stopPropagation();else if(gk(i,r),e&4&&-1<Ooe.indexOf(i)){for(;n!==null;){var s=Gx(n);if(s!==null&&JH(s),s=r3(i,e,t,r),s===null&&xA(i,e,r,JE,t),s===n)break;n=s}n!==null&&r.stopPropagation()}else xA(i,e,r,null,t)}}var JE=null;function r3(i,e,t,r){if(JE=null,i=oF(r),i=ig(i),i!==null)if(e=s_(i),e===null)i=null;else if(t=e.tag,t===13){if(i=jH(e),i!==null)return i;i=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;i=null}else e!==i&&(i=null);return JE=i,null}function nj(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(woe()){case lF:return 1;case QH:return 4;case ZE:case xoe:return 16;case ZH:return 536870912;default:return 16}default:return 16}}var rm=null,dF=null,CS=null;function sj(){if(CS)return CS;var i,e=dF,t=e.length,r,n="value"in rm?rm.value:rm.textContent,s=n.length;for(i=0;i<t&&e[i]===n[i];i++);var a=t-i;for(r=1;r<=a&&e[t-r]===n[s-r];r++);return CS=n.slice(i,1<r?1-r:void 0)}function SS(i){var e=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&e===13&&(i=13)):i=e,i===10&&(i=13),32<=i||i===13?i:0}function bT(){return!0}function yk(){return!1}function ll(i){function e(t,r,n,s,a){this._reactName=t,this._targetInst=n,this.type=r,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in i)i.hasOwnProperty(o)&&(t=i[o],this[o]=t?t(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?bT:yk,this.isPropagationStopped=yk,this}return Mr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=bT)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=bT)},persist:function(){},isPersistent:bT}),e}var yv={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},pF=ll(yv),Bx=Mr({},yv,{view:0,detail:0}),Doe=ll(Bx),pA,mA,Bv,UP=Mr({},Bx,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:mF,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Bv&&(Bv&&i.type==="mousemove"?(pA=i.screenX-Bv.screenX,mA=i.screenY-Bv.screenY):mA=pA=0,Bv=i),pA)},movementY:function(i){return"movementY"in i?i.movementY:mA}}),vk=ll(UP),Foe=Mr({},UP,{dataTransfer:0}),Noe=ll(Foe),koe=Mr({},Bx,{relatedTarget:0}),fA=ll(koe),Voe=Mr({},yv,{animationName:0,elapsedTime:0,pseudoElement:0}),Uoe=ll(Voe),zoe=Mr({},yv,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Boe=ll(zoe),Goe=Mr({},yv,{data:0}),bk=ll(Goe),Hoe={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},joe={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},qoe={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Woe(i){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(i):(i=qoe[i])?!!e[i]:!1}function mF(){return Woe}var Xoe=Mr({},Bx,{key:function(i){if(i.key){var e=Hoe[i.key]||i.key;if(e!=="Unidentified")return e}return i.type==="keypress"?(i=SS(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?joe[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:mF,charCode:function(i){return i.type==="keypress"?SS(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?SS(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Qoe=ll(Xoe),Zoe=Mr({},UP,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),wk=ll(Zoe),Yoe=Mr({},Bx,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:mF}),Koe=ll(Yoe),Joe=Mr({},yv,{propertyName:0,elapsedTime:0,pseudoElement:0}),ele=ll(Joe),tle=Mr({},UP,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),ile=ll(tle),rle=[9,13,27,32],fF=Ed&&"CompositionEvent"in window,Nb=null;Ed&&"documentMode"in document&&(Nb=document.documentMode);var nle=Ed&&"TextEvent"in window&&!Nb,aj=Ed&&(!fF||Nb&&8<Nb&&11>=Nb),xk=String.fromCharCode(32),Tk=!1;function oj(i,e){switch(i){case"keyup":return rle.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function lj(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Xy=!1;function sle(i,e){switch(i){case"compositionend":return lj(e);case"keypress":return e.which!==32?null:(Tk=!0,xk);case"textInput":return i=e.data,i===xk&&Tk?null:i;default:return null}}function ale(i,e){if(Xy)return i==="compositionend"||!fF&&oj(i,e)?(i=sj(),CS=dF=rm=null,Xy=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return aj&&e.locale!=="ko"?null:e.data;default:return null}}var ole={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ck(i){var e=i&&i.nodeName&&i.nodeName.toLowerCase();return e==="input"?!!ole[i.type]:e==="textarea"}function cj(i,e,t,r){UH(r),e=e2(e,"onChange"),0<e.length&&(t=new pF("onChange","change",null,t,r),i.push({event:t,listeners:e}))}var kb=null,kw=null;function lle(i){bj(i,0)}function zP(i){var e=Yy(i);if(LH(e))return i}function cle(i,e){if(i==="change")return e}var hj=!1;if(Ed){var gA;if(Ed){var _A="oninput"in document;if(!_A){var Sk=document.createElement("div");Sk.setAttribute("oninput","return;"),_A=typeof Sk.oninput=="function"}gA=_A}else gA=!1;hj=gA&&(!document.documentMode||9<document.documentMode)}function Ek(){kb&&(kb.detachEvent("onpropertychange",uj),kw=kb=null)}function uj(i){if(i.propertyName==="value"&&zP(kw)){var e=[];cj(e,kw,i,oF(i)),HH(lle,e)}}function hle(i,e,t){i==="focusin"?(Ek(),kb=e,kw=t,kb.attachEvent("onpropertychange",uj)):i==="focusout"&&Ek()}function ule(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return zP(kw)}function dle(i,e){if(i==="click")return zP(e)}function ple(i,e){if(i==="input"||i==="change")return zP(e)}function mle(i,e){return i===e&&(i!==0||1/i===1/e)||i!==i&&e!==e}var Hc=typeof Object.is=="function"?Object.is:mle;function Vw(i,e){if(Hc(i,e))return!0;if(typeof i!="object"||i===null||typeof e!="object"||e===null)return!1;var t=Object.keys(i),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var n=t[r];if(!VI.call(e,n)||!Hc(i[n],e[n]))return!1}return!0}function Pk(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Rk(i,e){var t=Pk(i);i=0;for(var r;t;){if(t.nodeType===3){if(r=i+t.textContent.length,i<=e&&r>=e)return{node:t,offset:e-i};i=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=Pk(t)}}function dj(i,e){return i&&e?i===e?!0:i&&i.nodeType===3?!1:e&&e.nodeType===3?dj(i,e.parentNode):"contains"in i?i.contains(e):i.compareDocumentPosition?!!(i.compareDocumentPosition(e)&16):!1:!1}function pj(){for(var i=window,e=WE();e instanceof i.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)i=e.contentWindow;else break;e=WE(i.document)}return e}function gF(i){var e=i&&i.nodeName&&i.nodeName.toLowerCase();return e&&(e==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||e==="textarea"||i.contentEditable==="true")}function fle(i){var e=pj(),t=i.focusedElem,r=i.selectionRange;if(e!==t&&t&&t.ownerDocument&&dj(t.ownerDocument.documentElement,t)){if(r!==null&&gF(t)){if(e=r.start,i=r.end,i===void 0&&(i=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(i,t.value.length);else if(i=(e=t.ownerDocument||document)&&e.defaultView||window,i.getSelection){i=i.getSelection();var n=t.textContent.length,s=Math.min(r.start,n);r=r.end===void 0?s:Math.min(r.end,n),!i.extend&&s>r&&(n=r,r=s,s=n),n=Rk(t,s);var a=Rk(t,r);n&&a&&(i.rangeCount!==1||i.anchorNode!==n.node||i.anchorOffset!==n.offset||i.focusNode!==a.node||i.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(n.node,n.offset),i.removeAllRanges(),s>r?(i.addRange(e),i.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),i.addRange(e)))}}for(e=[],i=t;i=i.parentNode;)i.nodeType===1&&e.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)i=e[t],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var gle=Ed&&"documentMode"in document&&11>=document.documentMode,Qy=null,n3=null,Vb=null,s3=!1;function Ak(i,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;s3||Qy==null||Qy!==WE(r)||(r=Qy,"selectionStart"in r&&gF(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Vb&&Vw(Vb,r)||(Vb=r,r=e2(n3,"onSelect"),0<r.length&&(e=new pF("onSelect","select",null,e,t),i.push({event:e,listeners:r}),e.target=Qy)))}function wT(i,e){var t={};return t[i.toLowerCase()]=e.toLowerCase(),t["Webkit"+i]="webkit"+e,t["Moz"+i]="moz"+e,t}var Zy={animationend:wT("Animation","AnimationEnd"),animationiteration:wT("Animation","AnimationIteration"),animationstart:wT("Animation","AnimationStart"),transitionend:wT("Transition","TransitionEnd")},yA={},mj={};Ed&&(mj=document.createElement("div").style,"AnimationEvent"in window||(delete Zy.animationend.animation,delete Zy.animationiteration.animation,delete Zy.animationstart.animation),"TransitionEvent"in window||delete Zy.transitionend.transition);function BP(i){if(yA[i])return yA[i];if(!Zy[i])return i;var e=Zy[i],t;for(t in e)if(e.hasOwnProperty(t)&&t in mj)return yA[i]=e[t];return i}var fj=BP("animationend"),gj=BP("animationiteration"),_j=BP("animationstart"),yj=BP("transitionend"),vj=new Map,Ok="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function qm(i,e){vj.set(i,e),n_(e,[i])}for(var vA=0;vA<Ok.length;vA++){var bA=Ok[vA],_le=bA.toLowerCase(),yle=bA[0].toUpperCase()+bA.slice(1);qm(_le,"on"+yle)}qm(fj,"onAnimationEnd");qm(gj,"onAnimationIteration");qm(_j,"onAnimationStart");qm("dblclick","onDoubleClick");qm("focusin","onFocus");qm("focusout","onBlur");qm(yj,"onTransitionEnd");Y0("onMouseEnter",["mouseout","mouseover"]);Y0("onMouseLeave",["mouseout","mouseover"]);Y0("onPointerEnter",["pointerout","pointerover"]);Y0("onPointerLeave",["pointerout","pointerover"]);n_("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));n_("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));n_("onBeforeInput",["compositionend","keypress","textInput","paste"]);n_("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));n_("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));n_("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var k1="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),vle=new Set("cancel close invalid load scroll toggle".split(" ").concat(k1));function Mk(i,e,t){var r=i.type||"unknown-event";i.currentTarget=t,_oe(r,e,void 0,i),i.currentTarget=null}function bj(i,e){e=(e&4)!==0;for(var t=0;t<i.length;t++){var r=i[t],n=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var a=r.length-1;0<=a;a--){var o=r[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&n.isPropagationStopped())break e;Mk(n,o,c),s=l}else for(a=0;a<r.length;a++){if(o=r[a],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&n.isPropagationStopped())break e;Mk(n,o,c),s=l}}}if(QE)throw i=e3,QE=!1,e3=null,i}function ar(i,e){var t=e[h3];t===void 0&&(t=e[h3]=new Set);var r=i+"__bubble";t.has(r)||(wj(e,i,2,!1),t.add(r))}function wA(i,e,t){var r=0;e&&(r|=4),wj(t,i,r,e)}var xT="_reactListening"+Math.random().toString(36).slice(2);function Uw(i){if(!i[xT]){i[xT]=!0,RH.forEach(function(t){t!=="selectionchange"&&(vle.has(t)||wA(t,!1,i),wA(t,!0,i))});var e=i.nodeType===9?i:i.ownerDocument;e===null||e[xT]||(e[xT]=!0,wA("selectionchange",!1,e))}}function wj(i,e,t,r){switch(nj(e)){case 1:var n=Loe;break;case 4:n=$oe;break;default:n=uF}t=n.bind(null,e,t,i),n=void 0,!JI||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(n=!0),r?n!==void 0?i.addEventListener(e,t,{capture:!0,passive:n}):i.addEventListener(e,t,!0):n!==void 0?i.addEventListener(e,t,{passive:n}):i.addEventListener(e,t,!1)}function xA(i,e,t,r,n){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var o=r.stateNode.containerInfo;if(o===n||o.nodeType===8&&o.parentNode===n)break;if(a===4)for(a=r.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===n||l.nodeType===8&&l.parentNode===n))return;a=a.return}for(;o!==null;){if(a=ig(o),a===null)return;if(l=a.tag,l===5||l===6){r=s=a;continue e}o=o.parentNode}}r=r.return}HH(function(){var c=s,u=oF(t),d=[];e:{var m=vj.get(i);if(m!==void 0){var f=pF,_=i;switch(i){case"keypress":if(SS(t)===0)break e;case"keydown":case"keyup":f=Qoe;break;case"focusin":_="focus",f=fA;break;case"focusout":_="blur",f=fA;break;case"beforeblur":case"afterblur":f=fA;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=vk;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=Noe;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=Koe;break;case fj:case gj:case _j:f=Uoe;break;case yj:f=ele;break;case"scroll":f=Doe;break;case"wheel":f=ile;break;case"copy":case"cut":case"paste":f=Boe;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=wk}var g=(e&4)!==0,x=!g&&i==="scroll",b=g?m!==null?m+"Capture":null:m;g=[];for(var v=c,w;v!==null;){w=v;var T=w.stateNode;if(w.tag===5&&T!==null&&(w=T,b!==null&&(T=$w(v,b),T!=null&&g.push(zw(v,T,w)))),x)break;v=v.return}0<g.length&&(m=new f(m,_,null,t,u),d.push({event:m,listeners:g}))}}if(!(e&7)){e:{if(m=i==="mouseover"||i==="pointerover",f=i==="mouseout"||i==="pointerout",m&&t!==YI&&(_=t.relatedTarget||t.fromElement)&&(ig(_)||_[Pd]))break e;if((f||m)&&(m=u.window===u?u:(m=u.ownerDocument)?m.defaultView||m.parentWindow:window,f?(_=t.relatedTarget||t.toElement,f=c,_=_?ig(_):null,_!==null&&(x=s_(_),_!==x||_.tag!==5&&_.tag!==6)&&(_=null)):(f=null,_=c),f!==_)){if(g=vk,T="onMouseLeave",b="onMouseEnter",v="mouse",(i==="pointerout"||i==="pointerover")&&(g=wk,T="onPointerLeave",b="onPointerEnter",v="pointer"),x=f==null?m:Yy(f),w=_==null?m:Yy(_),m=new g(T,v+"leave",f,t,u),m.target=x,m.relatedTarget=w,T=null,ig(u)===c&&(g=new g(b,v+"enter",_,t,u),g.target=w,g.relatedTarget=x,T=g),x=T,f&&_)t:{for(g=f,b=_,v=0,w=g;w;w=T_(w))v++;for(w=0,T=b;T;T=T_(T))w++;for(;0<v-w;)g=T_(g),v--;for(;0<w-v;)b=T_(b),w--;for(;v--;){if(g===b||b!==null&&g===b.alternate)break t;g=T_(g),b=T_(b)}g=null}else g=null;f!==null&&Ik(d,m,f,g,!1),_!==null&&x!==null&&Ik(d,x,_,g,!0)}}e:{if(m=c?Yy(c):window,f=m.nodeName&&m.nodeName.toLowerCase(),f==="select"||f==="input"&&m.type==="file")var E=cle;else if(Ck(m))if(hj)E=ple;else{E=ule;var C=hle}else(f=m.nodeName)&&f.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(E=dle);if(E&&(E=E(i,c))){cj(d,E,t,u);break e}C&&C(i,m,c),i==="focusout"&&(C=m._wrapperState)&&C.controlled&&m.type==="number"&&qI(m,"number",m.value)}switch(C=c?Yy(c):window,i){case"focusin":(Ck(C)||C.contentEditable==="true")&&(Qy=C,n3=c,Vb=null);break;case"focusout":Vb=n3=Qy=null;break;case"mousedown":s3=!0;break;case"contextmenu":case"mouseup":case"dragend":s3=!1,Ak(d,t,u);break;case"selectionchange":if(gle)break;case"keydown":case"keyup":Ak(d,t,u)}var A;if(fF)e:{switch(i){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else Xy?oj(i,t)&&(M="onCompositionEnd"):i==="keydown"&&t.keyCode===229&&(M="onCompositionStart");M&&(aj&&t.locale!=="ko"&&(Xy||M!=="onCompositionStart"?M==="onCompositionEnd"&&Xy&&(A=sj()):(rm=u,dF="value"in rm?rm.value:rm.textContent,Xy=!0)),C=e2(c,M),0<C.length&&(M=new bk(M,i,null,t,u),d.push({event:M,listeners:C}),A?M.data=A:(A=lj(t),A!==null&&(M.data=A)))),(A=nle?sle(i,t):ale(i,t))&&(c=e2(c,"onBeforeInput"),0<c.length&&(u=new bk("onBeforeInput","beforeinput",null,t,u),d.push({event:u,listeners:c}),u.data=A))}bj(d,e)})}function zw(i,e,t){return{instance:i,listener:e,currentTarget:t}}function e2(i,e){for(var t=e+"Capture",r=[];i!==null;){var n=i,s=n.stateNode;n.tag===5&&s!==null&&(n=s,s=$w(i,t),s!=null&&r.unshift(zw(i,s,n)),s=$w(i,e),s!=null&&r.push(zw(i,s,n))),i=i.return}return r}function T_(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function Ik(i,e,t,r,n){for(var s=e._reactName,a=[];t!==null&&t!==r;){var o=t,l=o.alternate,c=o.stateNode;if(l!==null&&l===r)break;o.tag===5&&c!==null&&(o=c,n?(l=$w(t,s),l!=null&&a.unshift(zw(t,l,o))):n||(l=$w(t,s),l!=null&&a.push(zw(t,l,o)))),t=t.return}a.length!==0&&i.push({event:e,listeners:a})}var ble=/\r\n?/g,wle=/\u0000|\uFFFD/g;function Lk(i){return(typeof i=="string"?i:""+i).replace(ble,`
`).replace(wle,"")}function TT(i,e,t){if(e=Lk(e),Lk(i)!==e&&t)throw Error(ge(425))}function t2(){}var a3=null,o3=null;function l3(i,e){return i==="textarea"||i==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var c3=typeof setTimeout=="function"?setTimeout:void 0,xle=typeof clearTimeout=="function"?clearTimeout:void 0,$k=typeof Promise=="function"?Promise:void 0,Tle=typeof queueMicrotask=="function"?queueMicrotask:typeof $k<"u"?function(i){return $k.resolve(null).then(i).catch(Cle)}:c3;function Cle(i){setTimeout(function(){throw i})}function TA(i,e){var t=e,r=0;do{var n=t.nextSibling;if(i.removeChild(t),n&&n.nodeType===8)if(t=n.data,t==="/$"){if(r===0){i.removeChild(n),Nw(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=n}while(t);Nw(e)}function fm(i){for(;i!=null;i=i.nextSibling){var e=i.nodeType;if(e===1||e===3)break;if(e===8){if(e=i.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return i}function Dk(i){i=i.previousSibling;for(var e=0;i;){if(i.nodeType===8){var t=i.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return i;e--}else t==="/$"&&e++}i=i.previousSibling}return null}var vv=Math.random().toString(36).slice(2),kh="__reactFiber$"+vv,Bw="__reactProps$"+vv,Pd="__reactContainer$"+vv,h3="__reactEvents$"+vv,Sle="__reactListeners$"+vv,Ele="__reactHandles$"+vv;function ig(i){var e=i[kh];if(e)return e;for(var t=i.parentNode;t;){if(e=t[Pd]||t[kh]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(i=Dk(i);i!==null;){if(t=i[kh])return t;i=Dk(i)}return e}i=t,t=i.parentNode}return null}function Gx(i){return i=i[kh]||i[Pd],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function Yy(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(ge(33))}function GP(i){return i[Bw]||null}var u3=[],Ky=-1;function Wm(i){return{current:i}}function mr(i){0>Ky||(i.current=u3[Ky],u3[Ky]=null,Ky--)}function ir(i,e){Ky++,u3[Ky]=i.current,i.current=e}var Nm={},Ks=Wm(Nm),po=Wm(!1),$g=Nm;function K0(i,e){var t=i.type.contextTypes;if(!t)return Nm;var r=i.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var n={},s;for(s in t)n[s]=e[s];return r&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=e,i.__reactInternalMemoizedMaskedChildContext=n),n}function mo(i){return i=i.childContextTypes,i!=null}function i2(){mr(po),mr(Ks)}function Fk(i,e,t){if(Ks.current!==Nm)throw Error(ge(168));ir(Ks,e),ir(po,t)}function xj(i,e,t){var r=i.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var n in r)if(!(n in e))throw Error(ge(108,hoe(i)||"Unknown",n));return Mr({},t,r)}function r2(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||Nm,$g=Ks.current,ir(Ks,i),ir(po,po.current),!0}function Nk(i,e,t){var r=i.stateNode;if(!r)throw Error(ge(169));t?(i=xj(i,e,$g),r.__reactInternalMemoizedMergedChildContext=i,mr(po),mr(Ks),ir(Ks,i)):mr(po),ir(po,t)}var Ku=null,HP=!1,CA=!1;function Tj(i){Ku===null?Ku=[i]:Ku.push(i)}function Ple(i){HP=!0,Tj(i)}function Xm(){if(!CA&&Ku!==null){CA=!0;var i=0,e=Li;try{var t=Ku;for(Li=1;i<t.length;i++){var r=t[i];do r=r(!0);while(r!==null)}Ku=null,HP=!1}catch(n){throw Ku!==null&&(Ku=Ku.slice(i+1)),XH(lF,Xm),n}finally{Li=e,CA=!1}}return null}var Jy=[],e0=0,n2=null,s2=0,El=[],Pl=0,Dg=null,ad=1,od="";function Sf(i,e){Jy[e0++]=s2,Jy[e0++]=n2,n2=i,s2=e}function Cj(i,e,t){El[Pl++]=ad,El[Pl++]=od,El[Pl++]=Dg,Dg=i;var r=ad;i=od;var n=32-Nc(r)-1;r&=~(1<<n),t+=1;var s=32-Nc(e)+n;if(30<s){var a=n-n%5;s=(r&(1<<a)-1).toString(32),r>>=a,n-=a,ad=1<<32-Nc(e)+n|t<<n|r,od=s+i}else ad=1<<s|t<<n|r,od=i}function _F(i){i.return!==null&&(Sf(i,1),Cj(i,1,0))}function yF(i){for(;i===n2;)n2=Jy[--e0],Jy[e0]=null,s2=Jy[--e0],Jy[e0]=null;for(;i===Dg;)Dg=El[--Pl],El[Pl]=null,od=El[--Pl],El[Pl]=null,ad=El[--Pl],El[Pl]=null}var rl=null,el=null,br=!1,wc=null;function Sj(i,e){var t=Vl(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=i,e=i.deletions,e===null?(i.deletions=[t],i.flags|=16):e.push(t)}function kk(i,e){switch(i.tag){case 5:var t=i.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(i.stateNode=e,rl=i,el=fm(e.firstChild),!0):!1;case 6:return e=i.pendingProps===""||e.nodeType!==3?null:e,e!==null?(i.stateNode=e,rl=i,el=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=Dg!==null?{id:ad,overflow:od}:null,i.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Vl(18,null,null,0),t.stateNode=e,t.return=i,i.child=t,rl=i,el=null,!0):!1;default:return!1}}function d3(i){return(i.mode&1)!==0&&(i.flags&128)===0}function p3(i){if(br){var e=el;if(e){var t=e;if(!kk(i,e)){if(d3(i))throw Error(ge(418));e=fm(t.nextSibling);var r=rl;e&&kk(i,e)?Sj(r,t):(i.flags=i.flags&-4097|2,br=!1,rl=i)}}else{if(d3(i))throw Error(ge(418));i.flags=i.flags&-4097|2,br=!1,rl=i}}}function Vk(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;rl=i}function CT(i){if(i!==rl)return!1;if(!br)return Vk(i),br=!0,!1;var e;if((e=i.tag!==3)&&!(e=i.tag!==5)&&(e=i.type,e=e!=="head"&&e!=="body"&&!l3(i.type,i.memoizedProps)),e&&(e=el)){if(d3(i))throw Ej(),Error(ge(418));for(;e;)Sj(i,e),e=fm(e.nextSibling)}if(Vk(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ge(317));e:{for(i=i.nextSibling,e=0;i;){if(i.nodeType===8){var t=i.data;if(t==="/$"){if(e===0){el=fm(i.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}i=i.nextSibling}el=null}}else el=rl?fm(i.stateNode.nextSibling):null;return!0}function Ej(){for(var i=el;i;)i=fm(i.nextSibling)}function J0(){el=rl=null,br=!1}function vF(i){wc===null?wc=[i]:wc.push(i)}var Rle=Ud.ReactCurrentBatchConfig;function _c(i,e){if(i&&i.defaultProps){e=Mr({},e),i=i.defaultProps;for(var t in i)e[t]===void 0&&(e[t]=i[t]);return e}return e}var a2=Wm(null),o2=null,t0=null,bF=null;function wF(){bF=t0=o2=null}function xF(i){var e=a2.current;mr(a2),i._currentValue=e}function m3(i,e,t){for(;i!==null;){var r=i.alternate;if((i.childLanes&e)!==e?(i.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),i===t)break;i=i.return}}function A0(i,e){o2=i,bF=t0=null,i=i.dependencies,i!==null&&i.firstContext!==null&&(i.lanes&e&&(uo=!0),i.firstContext=null)}function ql(i){var e=i._currentValue;if(bF!==i)if(i={context:i,memoizedValue:e,next:null},t0===null){if(o2===null)throw Error(ge(308));t0=i,o2.dependencies={lanes:0,firstContext:i}}else t0=t0.next=i;return e}var rg=null;function TF(i){rg===null?rg=[i]:rg.push(i)}function Pj(i,e,t,r){var n=e.interleaved;return n===null?(t.next=t,TF(e)):(t.next=n.next,n.next=t),e.interleaved=t,Rd(i,r)}function Rd(i,e){i.lanes|=e;var t=i.alternate;for(t!==null&&(t.lanes|=e),t=i,i=i.return;i!==null;)i.childLanes|=e,t=i.alternate,t!==null&&(t.childLanes|=e),t=i,i=i.return;return t.tag===3?t.stateNode:null}var Bp=!1;function CF(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Rj(i,e){i=i.updateQueue,e.updateQueue===i&&(e.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function fd(i,e){return{eventTime:i,lane:e,tag:0,payload:null,callback:null,next:null}}function gm(i,e,t){var r=i.updateQueue;if(r===null)return null;if(r=r.shared,pi&2){var n=r.pending;return n===null?e.next=e:(e.next=n.next,n.next=e),r.pending=e,Rd(i,t)}return n=r.interleaved,n===null?(e.next=e,TF(r)):(e.next=n.next,n.next=e),r.interleaved=e,Rd(i,t)}function ES(i,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=i.pendingLanes,t|=r,e.lanes=t,cF(i,t)}}function Uk(i,e){var t=i.updateQueue,r=i.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var n=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var a={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?n=s=a:s=s.next=a,t=t.next}while(t!==null);s===null?n=s=e:s=s.next=e}else n=s=e;t={baseState:r.baseState,firstBaseUpdate:n,lastBaseUpdate:s,shared:r.shared,effects:r.effects},i.updateQueue=t;return}i=t.lastBaseUpdate,i===null?t.firstBaseUpdate=e:i.next=e,t.lastBaseUpdate=e}function l2(i,e,t,r){var n=i.updateQueue;Bp=!1;var s=n.firstBaseUpdate,a=n.lastBaseUpdate,o=n.shared.pending;if(o!==null){n.shared.pending=null;var l=o,c=l.next;l.next=null,a===null?s=c:a.next=c,a=l;var u=i.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==a&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(s!==null){var d=n.baseState;a=0,u=c=l=null,o=s;do{var m=o.lane,f=o.eventTime;if((r&m)===m){u!==null&&(u=u.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var _=i,g=o;switch(m=e,f=t,g.tag){case 1:if(_=g.payload,typeof _=="function"){d=_.call(f,d,m);break e}d=_;break e;case 3:_.flags=_.flags&-65537|128;case 0:if(_=g.payload,m=typeof _=="function"?_.call(f,d,m):_,m==null)break e;d=Mr({},d,m);break e;case 2:Bp=!0}}o.callback!==null&&o.lane!==0&&(i.flags|=64,m=n.effects,m===null?n.effects=[o]:m.push(o))}else f={eventTime:f,lane:m,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=f,l=d):u=u.next=f,a|=m;if(o=o.next,o===null){if(o=n.shared.pending,o===null)break;m=o,o=m.next,m.next=null,n.lastBaseUpdate=m,n.shared.pending=null}}while(1);if(u===null&&(l=d),n.baseState=l,n.firstBaseUpdate=c,n.lastBaseUpdate=u,e=n.shared.interleaved,e!==null){n=e;do a|=n.lane,n=n.next;while(n!==e)}else s===null&&(n.shared.lanes=0);Ng|=a,i.lanes=a,i.memoizedState=d}}function zk(i,e,t){if(i=e.effects,e.effects=null,i!==null)for(e=0;e<i.length;e++){var r=i[e],n=r.callback;if(n!==null){if(r.callback=null,r=t,typeof n!="function")throw Error(ge(191,n));n.call(r)}}}var Aj=new PH.Component().refs;function f3(i,e,t,r){e=i.memoizedState,t=t(r,e),t=t==null?e:Mr({},e,t),i.memoizedState=t,i.lanes===0&&(i.updateQueue.baseState=t)}var jP={isMounted:function(i){return(i=i._reactInternals)?s_(i)===i:!1},enqueueSetState:function(i,e,t){i=i._reactInternals;var r=Oa(),n=ym(i),s=fd(r,n);s.payload=e,t!=null&&(s.callback=t),e=gm(i,s,n),e!==null&&(kc(e,i,n,r),ES(e,i,n))},enqueueReplaceState:function(i,e,t){i=i._reactInternals;var r=Oa(),n=ym(i),s=fd(r,n);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=gm(i,s,n),e!==null&&(kc(e,i,n,r),ES(e,i,n))},enqueueForceUpdate:function(i,e){i=i._reactInternals;var t=Oa(),r=ym(i),n=fd(t,r);n.tag=2,e!=null&&(n.callback=e),e=gm(i,n,r),e!==null&&(kc(e,i,r,t),ES(e,i,r))}};function Bk(i,e,t,r,n,s,a){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(r,s,a):e.prototype&&e.prototype.isPureReactComponent?!Vw(t,r)||!Vw(n,s):!0}function Oj(i,e,t){var r=!1,n=Nm,s=e.contextType;return typeof s=="object"&&s!==null?s=ql(s):(n=mo(e)?$g:Ks.current,r=e.contextTypes,s=(r=r!=null)?K0(i,n):Nm),e=new e(t,s),i.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=jP,i.stateNode=e,e._reactInternals=i,r&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=n,i.__reactInternalMemoizedMaskedChildContext=s),e}function Gk(i,e,t,r){i=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==i&&jP.enqueueReplaceState(e,e.state,null)}function g3(i,e,t,r){var n=i.stateNode;n.props=t,n.state=i.memoizedState,n.refs=Aj,CF(i);var s=e.contextType;typeof s=="object"&&s!==null?n.context=ql(s):(s=mo(e)?$g:Ks.current,n.context=K0(i,s)),n.state=i.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(f3(i,e,s,t),n.state=i.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(e=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),e!==n.state&&jP.enqueueReplaceState(n,n.state,null),l2(i,t,n,r),n.state=i.memoizedState),typeof n.componentDidMount=="function"&&(i.flags|=4194308)}function Gv(i,e,t){if(i=t.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(ge(309));var r=t.stateNode}if(!r)throw Error(ge(147,i));var n=r,s=""+i;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var o=n.refs;o===Aj&&(o=n.refs={}),a===null?delete o[s]:o[s]=a},e._stringRef=s,e)}if(typeof i!="string")throw Error(ge(284));if(!t._owner)throw Error(ge(290,i))}return i}function ST(i,e){throw i=Object.prototype.toString.call(e),Error(ge(31,i==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":i))}function Hk(i){var e=i._init;return e(i._payload)}function Mj(i){function e(b,v){if(i){var w=b.deletions;w===null?(b.deletions=[v],b.flags|=16):w.push(v)}}function t(b,v){if(!i)return null;for(;v!==null;)e(b,v),v=v.sibling;return null}function r(b,v){for(b=new Map;v!==null;)v.key!==null?b.set(v.key,v):b.set(v.index,v),v=v.sibling;return b}function n(b,v){return b=vm(b,v),b.index=0,b.sibling=null,b}function s(b,v,w){return b.index=w,i?(w=b.alternate,w!==null?(w=w.index,w<v?(b.flags|=2,v):w):(b.flags|=2,v)):(b.flags|=1048576,v)}function a(b){return i&&b.alternate===null&&(b.flags|=2),b}function o(b,v,w,T){return v===null||v.tag!==6?(v=MA(w,b.mode,T),v.return=b,v):(v=n(v,w),v.return=b,v)}function l(b,v,w,T){var E=w.type;return E===Wy?u(b,v,w.props.children,T,w.key):v!==null&&(v.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===zp&&Hk(E)===v.type)?(T=n(v,w.props),T.ref=Gv(b,v,w),T.return=b,T):(T=IS(w.type,w.key,w.props,null,b.mode,T),T.ref=Gv(b,v,w),T.return=b,T)}function c(b,v,w,T){return v===null||v.tag!==4||v.stateNode.containerInfo!==w.containerInfo||v.stateNode.implementation!==w.implementation?(v=IA(w,b.mode,T),v.return=b,v):(v=n(v,w.children||[]),v.return=b,v)}function u(b,v,w,T,E){return v===null||v.tag!==7?(v=_g(w,b.mode,T,E),v.return=b,v):(v=n(v,w),v.return=b,v)}function d(b,v,w){if(typeof v=="string"&&v!==""||typeof v=="number")return v=MA(""+v,b.mode,w),v.return=b,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case mT:return w=IS(v.type,v.key,v.props,null,b.mode,w),w.ref=Gv(b,null,v),w.return=b,w;case qy:return v=IA(v,b.mode,w),v.return=b,v;case zp:var T=v._init;return d(b,T(v._payload),w)}if(F1(v)||kv(v))return v=_g(v,b.mode,w,null),v.return=b,v;ST(b,v)}return null}function m(b,v,w,T){var E=v!==null?v.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return E!==null?null:o(b,v,""+w,T);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case mT:return w.key===E?l(b,v,w,T):null;case qy:return w.key===E?c(b,v,w,T):null;case zp:return E=w._init,m(b,v,E(w._payload),T)}if(F1(w)||kv(w))return E!==null?null:u(b,v,w,T,null);ST(b,w)}return null}function f(b,v,w,T,E){if(typeof T=="string"&&T!==""||typeof T=="number")return b=b.get(w)||null,o(v,b,""+T,E);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case mT:return b=b.get(T.key===null?w:T.key)||null,l(v,b,T,E);case qy:return b=b.get(T.key===null?w:T.key)||null,c(v,b,T,E);case zp:var C=T._init;return f(b,v,w,C(T._payload),E)}if(F1(T)||kv(T))return b=b.get(w)||null,u(v,b,T,E,null);ST(v,T)}return null}function _(b,v,w,T){for(var E=null,C=null,A=v,M=v=0,I=null;A!==null&&M<w.length;M++){A.index>M?(I=A,A=null):I=A.sibling;var L=m(b,A,w[M],T);if(L===null){A===null&&(A=I);break}i&&A&&L.alternate===null&&e(b,A),v=s(L,v,M),C===null?E=L:C.sibling=L,C=L,A=I}if(M===w.length)return t(b,A),br&&Sf(b,M),E;if(A===null){for(;M<w.length;M++)A=d(b,w[M],T),A!==null&&(v=s(A,v,M),C===null?E=A:C.sibling=A,C=A);return br&&Sf(b,M),E}for(A=r(b,A);M<w.length;M++)I=f(A,b,M,w[M],T),I!==null&&(i&&I.alternate!==null&&A.delete(I.key===null?M:I.key),v=s(I,v,M),C===null?E=I:C.sibling=I,C=I);return i&&A.forEach(function(U){return e(b,U)}),br&&Sf(b,M),E}function g(b,v,w,T){var E=kv(w);if(typeof E!="function")throw Error(ge(150));if(w=E.call(w),w==null)throw Error(ge(151));for(var C=E=null,A=v,M=v=0,I=null,L=w.next();A!==null&&!L.done;M++,L=w.next()){A.index>M?(I=A,A=null):I=A.sibling;var U=m(b,A,L.value,T);if(U===null){A===null&&(A=I);break}i&&A&&U.alternate===null&&e(b,A),v=s(U,v,M),C===null?E=U:C.sibling=U,C=U,A=I}if(L.done)return t(b,A),br&&Sf(b,M),E;if(A===null){for(;!L.done;M++,L=w.next())L=d(b,L.value,T),L!==null&&(v=s(L,v,M),C===null?E=L:C.sibling=L,C=L);return br&&Sf(b,M),E}for(A=r(b,A);!L.done;M++,L=w.next())L=f(A,b,M,L.value,T),L!==null&&(i&&L.alternate!==null&&A.delete(L.key===null?M:L.key),v=s(L,v,M),C===null?E=L:C.sibling=L,C=L);return i&&A.forEach(function(j){return e(b,j)}),br&&Sf(b,M),E}function x(b,v,w,T){if(typeof w=="object"&&w!==null&&w.type===Wy&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case mT:e:{for(var E=w.key,C=v;C!==null;){if(C.key===E){if(E=w.type,E===Wy){if(C.tag===7){t(b,C.sibling),v=n(C,w.props.children),v.return=b,b=v;break e}}else if(C.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===zp&&Hk(E)===C.type){t(b,C.sibling),v=n(C,w.props),v.ref=Gv(b,C,w),v.return=b,b=v;break e}t(b,C);break}else e(b,C);C=C.sibling}w.type===Wy?(v=_g(w.props.children,b.mode,T,w.key),v.return=b,b=v):(T=IS(w.type,w.key,w.props,null,b.mode,T),T.ref=Gv(b,v,w),T.return=b,b=T)}return a(b);case qy:e:{for(C=w.key;v!==null;){if(v.key===C)if(v.tag===4&&v.stateNode.containerInfo===w.containerInfo&&v.stateNode.implementation===w.implementation){t(b,v.sibling),v=n(v,w.children||[]),v.return=b,b=v;break e}else{t(b,v);break}else e(b,v);v=v.sibling}v=IA(w,b.mode,T),v.return=b,b=v}return a(b);case zp:return C=w._init,x(b,v,C(w._payload),T)}if(F1(w))return _(b,v,w,T);if(kv(w))return g(b,v,w,T);ST(b,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,v!==null&&v.tag===6?(t(b,v.sibling),v=n(v,w),v.return=b,b=v):(t(b,v),v=MA(w,b.mode,T),v.return=b,b=v),a(b)):t(b,v)}return x}var ev=Mj(!0),Ij=Mj(!1),Hx={},Zh=Wm(Hx),Gw=Wm(Hx),Hw=Wm(Hx);function ng(i){if(i===Hx)throw Error(ge(174));return i}function SF(i,e){switch(ir(Hw,e),ir(Gw,i),ir(Zh,Hx),i=e.nodeType,i){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:XI(null,"");break;default:i=i===8?e.parentNode:e,e=i.namespaceURI||null,i=i.tagName,e=XI(e,i)}mr(Zh),ir(Zh,e)}function tv(){mr(Zh),mr(Gw),mr(Hw)}function Lj(i){ng(Hw.current);var e=ng(Zh.current),t=XI(e,i.type);e!==t&&(ir(Gw,i),ir(Zh,t))}function EF(i){Gw.current===i&&(mr(Zh),mr(Gw))}var Sr=Wm(0);function c2(i){for(var e=i;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===i)break;for(;e.sibling===null;){if(e.return===null||e.return===i)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var SA=[];function PF(){for(var i=0;i<SA.length;i++)SA[i]._workInProgressVersionPrimary=null;SA.length=0}var PS=Ud.ReactCurrentDispatcher,EA=Ud.ReactCurrentBatchConfig,Fg=0,Ar=null,Ln=null,es=null,h2=!1,Ub=!1,jw=0,Ale=0;function $s(){throw Error(ge(321))}function RF(i,e){if(e===null)return!1;for(var t=0;t<e.length&&t<i.length;t++)if(!Hc(i[t],e[t]))return!1;return!0}function AF(i,e,t,r,n,s){if(Fg=s,Ar=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,PS.current=i===null||i.memoizedState===null?Lle:$le,i=t(r,n),Ub){s=0;do{if(Ub=!1,jw=0,25<=s)throw Error(ge(301));s+=1,es=Ln=null,e.updateQueue=null,PS.current=Dle,i=t(r,n)}while(Ub)}if(PS.current=u2,e=Ln!==null&&Ln.next!==null,Fg=0,es=Ln=Ar=null,h2=!1,e)throw Error(ge(300));return i}function OF(){var i=jw!==0;return jw=0,i}function Ah(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return es===null?Ar.memoizedState=es=i:es=es.next=i,es}function Wl(){if(Ln===null){var i=Ar.alternate;i=i!==null?i.memoizedState:null}else i=Ln.next;var e=es===null?Ar.memoizedState:es.next;if(e!==null)es=e,Ln=i;else{if(i===null)throw Error(ge(310));Ln=i,i={memoizedState:Ln.memoizedState,baseState:Ln.baseState,baseQueue:Ln.baseQueue,queue:Ln.queue,next:null},es===null?Ar.memoizedState=es=i:es=es.next=i}return es}function qw(i,e){return typeof e=="function"?e(i):e}function PA(i){var e=Wl(),t=e.queue;if(t===null)throw Error(ge(311));t.lastRenderedReducer=i;var r=Ln,n=r.baseQueue,s=t.pending;if(s!==null){if(n!==null){var a=n.next;n.next=s.next,s.next=a}r.baseQueue=n=s,t.pending=null}if(n!==null){s=n.next,r=r.baseState;var o=a=null,l=null,c=s;do{var u=c.lane;if((Fg&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:i(r,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=d,a=r):l=l.next=d,Ar.lanes|=u,Ng|=u}c=c.next}while(c!==null&&c!==s);l===null?a=r:l.next=o,Hc(r,e.memoizedState)||(uo=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=l,t.lastRenderedState=r}if(i=t.interleaved,i!==null){n=i;do s=n.lane,Ar.lanes|=s,Ng|=s,n=n.next;while(n!==i)}else n===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function RA(i){var e=Wl(),t=e.queue;if(t===null)throw Error(ge(311));t.lastRenderedReducer=i;var r=t.dispatch,n=t.pending,s=e.memoizedState;if(n!==null){t.pending=null;var a=n=n.next;do s=i(s,a.action),a=a.next;while(a!==n);Hc(s,e.memoizedState)||(uo=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,r]}function $j(){}function Dj(i,e){var t=Ar,r=Wl(),n=e(),s=!Hc(r.memoizedState,n);if(s&&(r.memoizedState=n,uo=!0),r=r.queue,MF(kj.bind(null,t,r,i),[i]),r.getSnapshot!==e||s||es!==null&&es.memoizedState.tag&1){if(t.flags|=2048,Ww(9,Nj.bind(null,t,r,n,e),void 0,null),os===null)throw Error(ge(349));Fg&30||Fj(t,e,n)}return n}function Fj(i,e,t){i.flags|=16384,i={getSnapshot:e,value:t},e=Ar.updateQueue,e===null?(e={lastEffect:null,stores:null},Ar.updateQueue=e,e.stores=[i]):(t=e.stores,t===null?e.stores=[i]:t.push(i))}function Nj(i,e,t,r){e.value=t,e.getSnapshot=r,Vj(e)&&Uj(i)}function kj(i,e,t){return t(function(){Vj(e)&&Uj(i)})}function Vj(i){var e=i.getSnapshot;i=i.value;try{var t=e();return!Hc(i,t)}catch{return!0}}function Uj(i){var e=Rd(i,1);e!==null&&kc(e,i,1,-1)}function jk(i){var e=Ah();return typeof i=="function"&&(i=i()),e.memoizedState=e.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:qw,lastRenderedState:i},e.queue=i,i=i.dispatch=Ile.bind(null,Ar,i),[e.memoizedState,i]}function Ww(i,e,t,r){return i={tag:i,create:e,destroy:t,deps:r,next:null},e=Ar.updateQueue,e===null?(e={lastEffect:null,stores:null},Ar.updateQueue=e,e.lastEffect=i.next=i):(t=e.lastEffect,t===null?e.lastEffect=i.next=i:(r=t.next,t.next=i,i.next=r,e.lastEffect=i)),i}function zj(){return Wl().memoizedState}function RS(i,e,t,r){var n=Ah();Ar.flags|=i,n.memoizedState=Ww(1|e,t,void 0,r===void 0?null:r)}function qP(i,e,t,r){var n=Wl();r=r===void 0?null:r;var s=void 0;if(Ln!==null){var a=Ln.memoizedState;if(s=a.destroy,r!==null&&RF(r,a.deps)){n.memoizedState=Ww(e,t,s,r);return}}Ar.flags|=i,n.memoizedState=Ww(1|e,t,s,r)}function qk(i,e){return RS(8390656,8,i,e)}function MF(i,e){return qP(2048,8,i,e)}function Bj(i,e){return qP(4,2,i,e)}function Gj(i,e){return qP(4,4,i,e)}function Hj(i,e){if(typeof e=="function")return i=i(),e(i),function(){e(null)};if(e!=null)return i=i(),e.current=i,function(){e.current=null}}function jj(i,e,t){return t=t!=null?t.concat([i]):null,qP(4,4,Hj.bind(null,e,i),t)}function IF(){}function qj(i,e){var t=Wl();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&RF(e,r[1])?r[0]:(t.memoizedState=[i,e],i)}function Wj(i,e){var t=Wl();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&RF(e,r[1])?r[0]:(i=i(),t.memoizedState=[i,e],i)}function Xj(i,e,t){return Fg&21?(Hc(t,e)||(t=YH(),Ar.lanes|=t,Ng|=t,i.baseState=!0),e):(i.baseState&&(i.baseState=!1,uo=!0),i.memoizedState=t)}function Ole(i,e){var t=Li;Li=t!==0&&4>t?t:4,i(!0);var r=EA.transition;EA.transition={};try{i(!1),e()}finally{Li=t,EA.transition=r}}function Qj(){return Wl().memoizedState}function Mle(i,e,t){var r=ym(i);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},Zj(i))Yj(e,t);else if(t=Pj(i,e,t,r),t!==null){var n=Oa();kc(t,i,r,n),Kj(t,e,r)}}function Ile(i,e,t){var r=ym(i),n={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(Zj(i))Yj(e,n);else{var s=i.alternate;if(i.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,t);if(n.hasEagerState=!0,n.eagerState=o,Hc(o,a)){var l=e.interleaved;l===null?(n.next=n,TF(e)):(n.next=l.next,l.next=n),e.interleaved=n;return}}catch{}finally{}t=Pj(i,e,n,r),t!==null&&(n=Oa(),kc(t,i,r,n),Kj(t,e,r))}}function Zj(i){var e=i.alternate;return i===Ar||e!==null&&e===Ar}function Yj(i,e){Ub=h2=!0;var t=i.pending;t===null?e.next=e:(e.next=t.next,t.next=e),i.pending=e}function Kj(i,e,t){if(t&4194240){var r=e.lanes;r&=i.pendingLanes,t|=r,e.lanes=t,cF(i,t)}}var u2={readContext:ql,useCallback:$s,useContext:$s,useEffect:$s,useImperativeHandle:$s,useInsertionEffect:$s,useLayoutEffect:$s,useMemo:$s,useReducer:$s,useRef:$s,useState:$s,useDebugValue:$s,useDeferredValue:$s,useTransition:$s,useMutableSource:$s,useSyncExternalStore:$s,useId:$s,unstable_isNewReconciler:!1},Lle={readContext:ql,useCallback:function(i,e){return Ah().memoizedState=[i,e===void 0?null:e],i},useContext:ql,useEffect:qk,useImperativeHandle:function(i,e,t){return t=t!=null?t.concat([i]):null,RS(4194308,4,Hj.bind(null,e,i),t)},useLayoutEffect:function(i,e){return RS(4194308,4,i,e)},useInsertionEffect:function(i,e){return RS(4,2,i,e)},useMemo:function(i,e){var t=Ah();return e=e===void 0?null:e,i=i(),t.memoizedState=[i,e],i},useReducer:function(i,e,t){var r=Ah();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:e},r.queue=i,i=i.dispatch=Mle.bind(null,Ar,i),[r.memoizedState,i]},useRef:function(i){var e=Ah();return i={current:i},e.memoizedState=i},useState:jk,useDebugValue:IF,useDeferredValue:function(i){return Ah().memoizedState=i},useTransition:function(){var i=jk(!1),e=i[0];return i=Ole.bind(null,i[1]),Ah().memoizedState=i,[e,i]},useMutableSource:function(){},useSyncExternalStore:function(i,e,t){var r=Ar,n=Ah();if(br){if(t===void 0)throw Error(ge(407));t=t()}else{if(t=e(),os===null)throw Error(ge(349));Fg&30||Fj(r,e,t)}n.memoizedState=t;var s={value:t,getSnapshot:e};return n.queue=s,qk(kj.bind(null,r,s,i),[i]),r.flags|=2048,Ww(9,Nj.bind(null,r,s,t,e),void 0,null),t},useId:function(){var i=Ah(),e=os.identifierPrefix;if(br){var t=od,r=ad;t=(r&~(1<<32-Nc(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=jw++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=Ale++,e=":"+e+"r"+t.toString(32)+":";return i.memoizedState=e},unstable_isNewReconciler:!1},$le={readContext:ql,useCallback:qj,useContext:ql,useEffect:MF,useImperativeHandle:jj,useInsertionEffect:Bj,useLayoutEffect:Gj,useMemo:Wj,useReducer:PA,useRef:zj,useState:function(){return PA(qw)},useDebugValue:IF,useDeferredValue:function(i){var e=Wl();return Xj(e,Ln.memoizedState,i)},useTransition:function(){var i=PA(qw)[0],e=Wl().memoizedState;return[i,e]},useMutableSource:$j,useSyncExternalStore:Dj,useId:Qj,unstable_isNewReconciler:!1},Dle={readContext:ql,useCallback:qj,useContext:ql,useEffect:MF,useImperativeHandle:jj,useInsertionEffect:Bj,useLayoutEffect:Gj,useMemo:Wj,useReducer:RA,useRef:zj,useState:function(){return RA(qw)},useDebugValue:IF,useDeferredValue:function(i){var e=Wl();return Ln===null?e.memoizedState=i:Xj(e,Ln.memoizedState,i)},useTransition:function(){var i=RA(qw)[0],e=Wl().memoizedState;return[i,e]},useMutableSource:$j,useSyncExternalStore:Dj,useId:Qj,unstable_isNewReconciler:!1};function iv(i,e){try{var t="",r=e;do t+=coe(r),r=r.return;while(r);var n=t}catch(s){n=`
Error generating stack: `+s.message+`
`+s.stack}return{value:i,source:e,stack:n,digest:null}}function AA(i,e,t){return{value:i,source:null,stack:t??null,digest:e??null}}function _3(i,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var Fle=typeof WeakMap=="function"?WeakMap:Map;function Jj(i,e,t){t=fd(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){p2||(p2=!0,P3=r),_3(i,e)},t}function eq(i,e,t){t=fd(-1,t),t.tag=3;var r=i.type.getDerivedStateFromError;if(typeof r=="function"){var n=e.value;t.payload=function(){return r(n)},t.callback=function(){_3(i,e)}}var s=i.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){_3(i,e),typeof r!="function"&&(_m===null?_m=new Set([this]):_m.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),t}function Wk(i,e,t){var r=i.pingCache;if(r===null){r=i.pingCache=new Fle;var n=new Set;r.set(e,n)}else n=r.get(e),n===void 0&&(n=new Set,r.set(e,n));n.has(t)||(n.add(t),i=Zle.bind(null,i,e,t),e.then(i,i))}function Xk(i){do{var e;if((e=i.tag===13)&&(e=i.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return i;i=i.return}while(i!==null);return null}function Qk(i,e,t,r,n){return i.mode&1?(i.flags|=65536,i.lanes=n,i):(i===e?i.flags|=65536:(i.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=fd(-1,1),e.tag=2,gm(t,e,1))),t.lanes|=1),i)}var Nle=Ud.ReactCurrentOwner,uo=!1;function wa(i,e,t,r){e.child=i===null?Ij(e,null,t,r):ev(e,i.child,t,r)}function Zk(i,e,t,r,n){t=t.render;var s=e.ref;return A0(e,n),r=AF(i,e,t,r,s,n),t=OF(),i!==null&&!uo?(e.updateQueue=i.updateQueue,e.flags&=-2053,i.lanes&=~n,Ad(i,e,n)):(br&&t&&_F(e),e.flags|=1,wa(i,e,r,n),e.child)}function Yk(i,e,t,r,n){if(i===null){var s=t.type;return typeof s=="function"&&!UF(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,tq(i,e,s,r,n)):(i=IS(t.type,null,r,e,e.mode,n),i.ref=e.ref,i.return=e,e.child=i)}if(s=i.child,!(i.lanes&n)){var a=s.memoizedProps;if(t=t.compare,t=t!==null?t:Vw,t(a,r)&&i.ref===e.ref)return Ad(i,e,n)}return e.flags|=1,i=vm(s,r),i.ref=e.ref,i.return=e,e.child=i}function tq(i,e,t,r,n){if(i!==null){var s=i.memoizedProps;if(Vw(s,r)&&i.ref===e.ref)if(uo=!1,e.pendingProps=r=s,(i.lanes&n)!==0)i.flags&131072&&(uo=!0);else return e.lanes=i.lanes,Ad(i,e,n)}return y3(i,e,t,r,n)}function iq(i,e,t){var r=e.pendingProps,n=r.children,s=i!==null?i.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ir(r0,Vo),Vo|=t;else{if(!(t&1073741824))return i=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:i,cachePool:null,transitions:null},e.updateQueue=null,ir(r0,Vo),Vo|=i,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:t,ir(r0,Vo),Vo|=r}else s!==null?(r=s.baseLanes|t,e.memoizedState=null):r=t,ir(r0,Vo),Vo|=r;return wa(i,e,n,t),e.child}function rq(i,e){var t=e.ref;(i===null&&t!==null||i!==null&&i.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function y3(i,e,t,r,n){var s=mo(t)?$g:Ks.current;return s=K0(e,s),A0(e,n),t=AF(i,e,t,r,s,n),r=OF(),i!==null&&!uo?(e.updateQueue=i.updateQueue,e.flags&=-2053,i.lanes&=~n,Ad(i,e,n)):(br&&r&&_F(e),e.flags|=1,wa(i,e,t,n),e.child)}function Kk(i,e,t,r,n){if(mo(t)){var s=!0;r2(e)}else s=!1;if(A0(e,n),e.stateNode===null)AS(i,e),Oj(e,t,r),g3(e,t,r,n),r=!0;else if(i===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,c=t.contextType;typeof c=="object"&&c!==null?c=ql(c):(c=mo(t)?$g:Ks.current,c=K0(e,c));var u=t.getDerivedStateFromProps,d=typeof u=="function"||typeof a.getSnapshotBeforeUpdate=="function";d||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==r||l!==c)&&Gk(e,a,r,c),Bp=!1;var m=e.memoizedState;a.state=m,l2(e,r,a,n),l=e.memoizedState,o!==r||m!==l||po.current||Bp?(typeof u=="function"&&(f3(e,t,u,r),l=e.memoizedState),(o=Bp||Bk(e,t,o,r,m,l,c))?(d||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),a.props=r,a.state=l,a.context=c,r=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,Rj(i,e),o=e.memoizedProps,c=e.type===e.elementType?o:_c(e.type,o),a.props=c,d=e.pendingProps,m=a.context,l=t.contextType,typeof l=="object"&&l!==null?l=ql(l):(l=mo(t)?$g:Ks.current,l=K0(e,l));var f=t.getDerivedStateFromProps;(u=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==d||m!==l)&&Gk(e,a,r,l),Bp=!1,m=e.memoizedState,a.state=m,l2(e,r,a,n);var _=e.memoizedState;o!==d||m!==_||po.current||Bp?(typeof f=="function"&&(f3(e,t,f,r),_=e.memoizedState),(c=Bp||Bk(e,t,c,r,m,_,l)||!1)?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,_,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,_,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===i.memoizedProps&&m===i.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===i.memoizedProps&&m===i.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=_),a.props=r,a.state=_,a.context=l,r=c):(typeof a.componentDidUpdate!="function"||o===i.memoizedProps&&m===i.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===i.memoizedProps&&m===i.memoizedState||(e.flags|=1024),r=!1)}return v3(i,e,t,r,s,n)}function v3(i,e,t,r,n,s){rq(i,e);var a=(e.flags&128)!==0;if(!r&&!a)return n&&Nk(e,t,!1),Ad(i,e,s);r=e.stateNode,Nle.current=e;var o=a&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,i!==null&&a?(e.child=ev(e,i.child,null,s),e.child=ev(e,null,o,s)):wa(i,e,o,s),e.memoizedState=r.state,n&&Nk(e,t,!0),e.child}function nq(i){var e=i.stateNode;e.pendingContext?Fk(i,e.pendingContext,e.pendingContext!==e.context):e.context&&Fk(i,e.context,!1),SF(i,e.containerInfo)}function Jk(i,e,t,r,n){return J0(),vF(n),e.flags|=256,wa(i,e,t,r),e.child}var b3={dehydrated:null,treeContext:null,retryLane:0};function w3(i){return{baseLanes:i,cachePool:null,transitions:null}}function sq(i,e,t){var r=e.pendingProps,n=Sr.current,s=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=i!==null&&i.memoizedState===null?!1:(n&2)!==0),o?(s=!0,e.flags&=-129):(i===null||i.memoizedState!==null)&&(n|=1),ir(Sr,n&1),i===null)return p3(e),i=e.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?(e.mode&1?i.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,i=r.fallback,s?(r=e.mode,s=e.child,a={mode:"hidden",children:a},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=QP(a,r,0,null),i=_g(i,r,t,null),s.return=e,i.return=e,s.sibling=i,e.child=s,e.child.memoizedState=w3(t),e.memoizedState=b3,i):LF(e,a));if(n=i.memoizedState,n!==null&&(o=n.dehydrated,o!==null))return kle(i,e,a,r,o,n,t);if(s){s=r.fallback,a=e.mode,n=i.child,o=n.sibling;var l={mode:"hidden",children:r.children};return!(a&1)&&e.child!==n?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=vm(n,l),r.subtreeFlags=n.subtreeFlags&14680064),o!==null?s=vm(o,s):(s=_g(s,a,t,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,a=i.child.memoizedState,a=a===null?w3(t):{baseLanes:a.baseLanes|t,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=i.childLanes&~t,e.memoizedState=b3,r}return s=i.child,i=s.sibling,r=vm(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,i!==null&&(t=e.deletions,t===null?(e.deletions=[i],e.flags|=16):t.push(i)),e.child=r,e.memoizedState=null,r}function LF(i,e){return e=QP({mode:"visible",children:e},i.mode,0,null),e.return=i,i.child=e}function ET(i,e,t,r){return r!==null&&vF(r),ev(e,i.child,null,t),i=LF(e,e.pendingProps.children),i.flags|=2,e.memoizedState=null,i}function kle(i,e,t,r,n,s,a){if(t)return e.flags&256?(e.flags&=-257,r=AA(Error(ge(422))),ET(i,e,a,r)):e.memoizedState!==null?(e.child=i.child,e.flags|=128,null):(s=r.fallback,n=e.mode,r=QP({mode:"visible",children:r.children},n,0,null),s=_g(s,n,a,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&ev(e,i.child,null,a),e.child.memoizedState=w3(a),e.memoizedState=b3,s);if(!(e.mode&1))return ET(i,e,a,null);if(n.data==="$!"){if(r=n.nextSibling&&n.nextSibling.dataset,r)var o=r.dgst;return r=o,s=Error(ge(419)),r=AA(s,r,void 0),ET(i,e,a,r)}if(o=(a&i.childLanes)!==0,uo||o){if(r=os,r!==null){switch(a&-a){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}n=n&(r.suspendedLanes|a)?0:n,n!==0&&n!==s.retryLane&&(s.retryLane=n,Rd(i,n),kc(r,i,n,-1))}return VF(),r=AA(Error(ge(421))),ET(i,e,a,r)}return n.data==="$?"?(e.flags|=128,e.child=i.child,e=Yle.bind(null,i),n._reactRetry=e,null):(i=s.treeContext,el=fm(n.nextSibling),rl=e,br=!0,wc=null,i!==null&&(El[Pl++]=ad,El[Pl++]=od,El[Pl++]=Dg,ad=i.id,od=i.overflow,Dg=e),e=LF(e,r.children),e.flags|=4096,e)}function e9(i,e,t){i.lanes|=e;var r=i.alternate;r!==null&&(r.lanes|=e),m3(i.return,e,t)}function OA(i,e,t,r,n){var s=i.memoizedState;s===null?i.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:n}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=t,s.tailMode=n)}function aq(i,e,t){var r=e.pendingProps,n=r.revealOrder,s=r.tail;if(wa(i,e,r.children,t),r=Sr.current,r&2)r=r&1|2,e.flags|=128;else{if(i!==null&&i.flags&128)e:for(i=e.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&e9(i,t,e);else if(i.tag===19)e9(i,t,e);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break e;for(;i.sibling===null;){if(i.return===null||i.return===e)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}r&=1}if(ir(Sr,r),!(e.mode&1))e.memoizedState=null;else switch(n){case"forwards":for(t=e.child,n=null;t!==null;)i=t.alternate,i!==null&&c2(i)===null&&(n=t),t=t.sibling;t=n,t===null?(n=e.child,e.child=null):(n=t.sibling,t.sibling=null),OA(e,!1,n,t,s);break;case"backwards":for(t=null,n=e.child,e.child=null;n!==null;){if(i=n.alternate,i!==null&&c2(i)===null){e.child=n;break}i=n.sibling,n.sibling=t,t=n,n=i}OA(e,!0,t,null,s);break;case"together":OA(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function AS(i,e){!(e.mode&1)&&i!==null&&(i.alternate=null,e.alternate=null,e.flags|=2)}function Ad(i,e,t){if(i!==null&&(e.dependencies=i.dependencies),Ng|=e.lanes,!(t&e.childLanes))return null;if(i!==null&&e.child!==i.child)throw Error(ge(153));if(e.child!==null){for(i=e.child,t=vm(i,i.pendingProps),e.child=t,t.return=e;i.sibling!==null;)i=i.sibling,t=t.sibling=vm(i,i.pendingProps),t.return=e;t.sibling=null}return e.child}function Vle(i,e,t){switch(e.tag){case 3:nq(e),J0();break;case 5:Lj(e);break;case 1:mo(e.type)&&r2(e);break;case 4:SF(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,n=e.memoizedProps.value;ir(a2,r._currentValue),r._currentValue=n;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ir(Sr,Sr.current&1),e.flags|=128,null):t&e.child.childLanes?sq(i,e,t):(ir(Sr,Sr.current&1),i=Ad(i,e,t),i!==null?i.sibling:null);ir(Sr,Sr.current&1);break;case 19:if(r=(t&e.childLanes)!==0,i.flags&128){if(r)return aq(i,e,t);e.flags|=128}if(n=e.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),ir(Sr,Sr.current),r)break;return null;case 22:case 23:return e.lanes=0,iq(i,e,t)}return Ad(i,e,t)}var oq,x3,lq,cq;oq=function(i,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)i.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};x3=function(){};lq=function(i,e,t,r){var n=i.memoizedProps;if(n!==r){i=e.stateNode,ng(Zh.current);var s=null;switch(t){case"input":n=HI(i,n),r=HI(i,r),s=[];break;case"select":n=Mr({},n,{value:void 0}),r=Mr({},r,{value:void 0}),s=[];break;case"textarea":n=WI(i,n),r=WI(i,r),s=[];break;default:typeof n.onClick!="function"&&typeof r.onClick=="function"&&(i.onclick=t2)}QI(t,r);var a;t=null;for(c in n)if(!r.hasOwnProperty(c)&&n.hasOwnProperty(c)&&n[c]!=null)if(c==="style"){var o=n[c];for(a in o)o.hasOwnProperty(a)&&(t||(t={}),t[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Iw.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in r){var l=r[c];if(o=n!=null?n[c]:void 0,r.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(t||(t={}),t[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(t||(t={}),t[a]=l[a])}else t||(s||(s=[]),s.push(c,t)),t=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Iw.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&ar("scroll",i),s||o===l||(s=[])):(s=s||[]).push(c,l))}t&&(s=s||[]).push("style",t);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};cq=function(i,e,t,r){t!==r&&(e.flags|=4)};function Hv(i,e){if(!br)switch(i.tailMode){case"hidden":e=i.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?i.tail=null:t.sibling=null;break;case"collapsed":t=i.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||i.tail===null?i.tail=null:i.tail.sibling=null:r.sibling=null}}function Ds(i){var e=i.alternate!==null&&i.alternate.child===i.child,t=0,r=0;if(e)for(var n=i.child;n!==null;)t|=n.lanes|n.childLanes,r|=n.subtreeFlags&14680064,r|=n.flags&14680064,n.return=i,n=n.sibling;else for(n=i.child;n!==null;)t|=n.lanes|n.childLanes,r|=n.subtreeFlags,r|=n.flags,n.return=i,n=n.sibling;return i.subtreeFlags|=r,i.childLanes=t,e}function Ule(i,e,t){var r=e.pendingProps;switch(yF(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ds(e),null;case 1:return mo(e.type)&&i2(),Ds(e),null;case 3:return r=e.stateNode,tv(),mr(po),mr(Ks),PF(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(i===null||i.child===null)&&(CT(e)?e.flags|=4:i===null||i.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,wc!==null&&(O3(wc),wc=null))),x3(i,e),Ds(e),null;case 5:EF(e);var n=ng(Hw.current);if(t=e.type,i!==null&&e.stateNode!=null)lq(i,e,t,r,n),i.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ge(166));return Ds(e),null}if(i=ng(Zh.current),CT(e)){r=e.stateNode,t=e.type;var s=e.memoizedProps;switch(r[kh]=e,r[Bw]=s,i=(e.mode&1)!==0,t){case"dialog":ar("cancel",r),ar("close",r);break;case"iframe":case"object":case"embed":ar("load",r);break;case"video":case"audio":for(n=0;n<k1.length;n++)ar(k1[n],r);break;case"source":ar("error",r);break;case"img":case"image":case"link":ar("error",r),ar("load",r);break;case"details":ar("toggle",r);break;case"input":ck(r,s),ar("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},ar("invalid",r);break;case"textarea":uk(r,s),ar("invalid",r)}QI(t,s),n=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?r.textContent!==o&&(s.suppressHydrationWarning!==!0&&TT(r.textContent,o,i),n=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&TT(r.textContent,o,i),n=["children",""+o]):Iw.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&ar("scroll",r)}switch(t){case"input":fT(r),hk(r,s,!0);break;case"textarea":fT(r),dk(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=t2)}r=n,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=n.nodeType===9?n:n.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=FH(t)),i==="http://www.w3.org/1999/xhtml"?t==="script"?(i=a.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof r.is=="string"?i=a.createElement(t,{is:r.is}):(i=a.createElement(t),t==="select"&&(a=i,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):i=a.createElementNS(i,t),i[kh]=e,i[Bw]=r,oq(i,e,!1,!1),e.stateNode=i;e:{switch(a=ZI(t,r),t){case"dialog":ar("cancel",i),ar("close",i),n=r;break;case"iframe":case"object":case"embed":ar("load",i),n=r;break;case"video":case"audio":for(n=0;n<k1.length;n++)ar(k1[n],i);n=r;break;case"source":ar("error",i),n=r;break;case"img":case"image":case"link":ar("error",i),ar("load",i),n=r;break;case"details":ar("toggle",i),n=r;break;case"input":ck(i,r),n=HI(i,r),ar("invalid",i);break;case"option":n=r;break;case"select":i._wrapperState={wasMultiple:!!r.multiple},n=Mr({},r,{value:void 0}),ar("invalid",i);break;case"textarea":uk(i,r),n=WI(i,r),ar("invalid",i);break;default:n=r}QI(t,n),o=n;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?VH(i,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&NH(i,l)):s==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&Lw(i,l):typeof l=="number"&&Lw(i,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Iw.hasOwnProperty(s)?l!=null&&s==="onScroll"&&ar("scroll",i):l!=null&&rF(i,s,l,a))}switch(t){case"input":fT(i),hk(i,r,!1);break;case"textarea":fT(i),dk(i);break;case"option":r.value!=null&&i.setAttribute("value",""+Fm(r.value));break;case"select":i.multiple=!!r.multiple,s=r.value,s!=null?S0(i,!!r.multiple,s,!1):r.defaultValue!=null&&S0(i,!!r.multiple,r.defaultValue,!0);break;default:typeof n.onClick=="function"&&(i.onclick=t2)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ds(e),null;case 6:if(i&&e.stateNode!=null)cq(i,e,i.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ge(166));if(t=ng(Hw.current),ng(Zh.current),CT(e)){if(r=e.stateNode,t=e.memoizedProps,r[kh]=e,(s=r.nodeValue!==t)&&(i=rl,i!==null))switch(i.tag){case 3:TT(r.nodeValue,t,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&TT(r.nodeValue,t,(i.mode&1)!==0)}s&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[kh]=e,e.stateNode=r}return Ds(e),null;case 13:if(mr(Sr),r=e.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(br&&el!==null&&e.mode&1&&!(e.flags&128))Ej(),J0(),e.flags|=98560,s=!1;else if(s=CT(e),r!==null&&r.dehydrated!==null){if(i===null){if(!s)throw Error(ge(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ge(317));s[kh]=e}else J0(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ds(e),s=!1}else wc!==null&&(O3(wc),wc=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(i!==null&&i.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(i===null||Sr.current&1?Fn===0&&(Fn=3):VF())),e.updateQueue!==null&&(e.flags|=4),Ds(e),null);case 4:return tv(),x3(i,e),i===null&&Uw(e.stateNode.containerInfo),Ds(e),null;case 10:return xF(e.type._context),Ds(e),null;case 17:return mo(e.type)&&i2(),Ds(e),null;case 19:if(mr(Sr),s=e.memoizedState,s===null)return Ds(e),null;if(r=(e.flags&128)!==0,a=s.rendering,a===null)if(r)Hv(s,!1);else{if(Fn!==0||i!==null&&i.flags&128)for(i=e.child;i!==null;){if(a=c2(i),a!==null){for(e.flags|=128,Hv(s,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)s=t,i=r,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=i,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,i=a.dependencies,s.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),t=t.sibling;return ir(Sr,Sr.current&1|2),e.child}i=i.sibling}s.tail!==null&&Jr()>rv&&(e.flags|=128,r=!0,Hv(s,!1),e.lanes=4194304)}else{if(!r)if(i=c2(a),i!==null){if(e.flags|=128,r=!0,t=i.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Hv(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!br)return Ds(e),null}else 2*Jr()-s.renderingStartTime>rv&&t!==1073741824&&(e.flags|=128,r=!0,Hv(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(t=s.last,t!==null?t.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Jr(),e.sibling=null,t=Sr.current,ir(Sr,r?t&1|2:t&1),e):(Ds(e),null);case 22:case 23:return kF(),r=e.memoizedState!==null,i!==null&&i.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Vo&1073741824&&(Ds(e),e.subtreeFlags&6&&(e.flags|=8192)):Ds(e),null;case 24:return null;case 25:return null}throw Error(ge(156,e.tag))}function zle(i,e){switch(yF(e),e.tag){case 1:return mo(e.type)&&i2(),i=e.flags,i&65536?(e.flags=i&-65537|128,e):null;case 3:return tv(),mr(po),mr(Ks),PF(),i=e.flags,i&65536&&!(i&128)?(e.flags=i&-65537|128,e):null;case 5:return EF(e),null;case 13:if(mr(Sr),i=e.memoizedState,i!==null&&i.dehydrated!==null){if(e.alternate===null)throw Error(ge(340));J0()}return i=e.flags,i&65536?(e.flags=i&-65537|128,e):null;case 19:return mr(Sr),null;case 4:return tv(),null;case 10:return xF(e.type._context),null;case 22:case 23:return kF(),null;case 24:return null;default:return null}}var PT=!1,js=!1,Ble=typeof WeakSet=="function"?WeakSet:Set,Le=null;function i0(i,e){var t=i.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){Vr(i,e,r)}else t.current=null}function T3(i,e,t){try{t()}catch(r){Vr(i,e,r)}}var t9=!1;function Gle(i,e){if(a3=KE,i=pj(),gF(i)){if("selectionStart"in i)var t={start:i.selectionStart,end:i.selectionEnd};else e:{t=(t=i.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var n=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var a=0,o=-1,l=-1,c=0,u=0,d=i,m=null;t:for(;;){for(var f;d!==t||n!==0&&d.nodeType!==3||(o=a+n),d!==s||r!==0&&d.nodeType!==3||(l=a+r),d.nodeType===3&&(a+=d.nodeValue.length),(f=d.firstChild)!==null;)m=d,d=f;for(;;){if(d===i)break t;if(m===t&&++c===n&&(o=a),m===s&&++u===r&&(l=a),(f=d.nextSibling)!==null)break;d=m,m=d.parentNode}d=f}t=o===-1||l===-1?null:{start:o,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(o3={focusedElem:i,selectionRange:t},KE=!1,Le=e;Le!==null;)if(e=Le,i=e.child,(e.subtreeFlags&1028)!==0&&i!==null)i.return=e,Le=i;else for(;Le!==null;){e=Le;try{var _=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(_!==null){var g=_.memoizedProps,x=_.memoizedState,b=e.stateNode,v=b.getSnapshotBeforeUpdate(e.elementType===e.type?g:_c(e.type,g),x);b.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ge(163))}}catch(T){Vr(e,e.return,T)}if(i=e.sibling,i!==null){i.return=e.return,Le=i;break}Le=e.return}return _=t9,t9=!1,_}function zb(i,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var n=r=r.next;do{if((n.tag&i)===i){var s=n.destroy;n.destroy=void 0,s!==void 0&&T3(e,t,s)}n=n.next}while(n!==r)}}function WP(i,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&i)===i){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function C3(i){var e=i.ref;if(e!==null){var t=i.stateNode;switch(i.tag){case 5:i=t;break;default:i=t}typeof e=="function"?e(i):e.current=i}}function hq(i){var e=i.alternate;e!==null&&(i.alternate=null,hq(e)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(e=i.stateNode,e!==null&&(delete e[kh],delete e[Bw],delete e[h3],delete e[Sle],delete e[Ele])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function uq(i){return i.tag===5||i.tag===3||i.tag===4}function i9(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||uq(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function S3(i,e,t){var r=i.tag;if(r===5||r===6)i=i.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(i,e):t.insertBefore(i,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(i,t)):(e=t,e.appendChild(i)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=t2));else if(r!==4&&(i=i.child,i!==null))for(S3(i,e,t),i=i.sibling;i!==null;)S3(i,e,t),i=i.sibling}function E3(i,e,t){var r=i.tag;if(r===5||r===6)i=i.stateNode,e?t.insertBefore(i,e):t.appendChild(i);else if(r!==4&&(i=i.child,i!==null))for(E3(i,e,t),i=i.sibling;i!==null;)E3(i,e,t),i=i.sibling}var bs=null,vc=!1;function Wd(i,e,t){for(t=t.child;t!==null;)dq(i,e,t),t=t.sibling}function dq(i,e,t){if(Qh&&typeof Qh.onCommitFiberUnmount=="function")try{Qh.onCommitFiberUnmount(VP,t)}catch{}switch(t.tag){case 5:js||i0(t,e);case 6:var r=bs,n=vc;bs=null,Wd(i,e,t),bs=r,vc=n,bs!==null&&(vc?(i=bs,t=t.stateNode,i.nodeType===8?i.parentNode.removeChild(t):i.removeChild(t)):bs.removeChild(t.stateNode));break;case 18:bs!==null&&(vc?(i=bs,t=t.stateNode,i.nodeType===8?TA(i.parentNode,t):i.nodeType===1&&TA(i,t),Nw(i)):TA(bs,t.stateNode));break;case 4:r=bs,n=vc,bs=t.stateNode.containerInfo,vc=!0,Wd(i,e,t),bs=r,vc=n;break;case 0:case 11:case 14:case 15:if(!js&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){n=r=r.next;do{var s=n,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&T3(t,e,a),n=n.next}while(n!==r)}Wd(i,e,t);break;case 1:if(!js&&(i0(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(o){Vr(t,e,o)}Wd(i,e,t);break;case 21:Wd(i,e,t);break;case 22:t.mode&1?(js=(r=js)||t.memoizedState!==null,Wd(i,e,t),js=r):Wd(i,e,t);break;default:Wd(i,e,t)}}function r9(i){var e=i.updateQueue;if(e!==null){i.updateQueue=null;var t=i.stateNode;t===null&&(t=i.stateNode=new Ble),e.forEach(function(r){var n=Kle.bind(null,i,r);t.has(r)||(t.add(r),r.then(n,n))})}}function Jl(i,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var n=t[r];try{var s=i,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:bs=o.stateNode,vc=!1;break e;case 3:bs=o.stateNode.containerInfo,vc=!0;break e;case 4:bs=o.stateNode.containerInfo,vc=!0;break e}o=o.return}if(bs===null)throw Error(ge(160));dq(s,a,n),bs=null,vc=!1;var l=n.alternate;l!==null&&(l.return=null),n.return=null}catch(c){Vr(n,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)pq(e,i),e=e.sibling}function pq(i,e){var t=i.alternate,r=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(Jl(e,i),Kc(i),r&4){try{zb(3,i,i.return),WP(3,i)}catch(g){Vr(i,i.return,g)}try{zb(5,i,i.return)}catch(g){Vr(i,i.return,g)}}break;case 1:Jl(e,i),Kc(i),r&512&&t!==null&&i0(t,t.return);break;case 5:if(Jl(e,i),Kc(i),r&512&&t!==null&&i0(t,t.return),i.flags&32){var n=i.stateNode;try{Lw(n,"")}catch(g){Vr(i,i.return,g)}}if(r&4&&(n=i.stateNode,n!=null)){var s=i.memoizedProps,a=t!==null?t.memoizedProps:s,o=i.type,l=i.updateQueue;if(i.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&$H(n,s),ZI(o,a);var c=ZI(o,s);for(a=0;a<l.length;a+=2){var u=l[a],d=l[a+1];u==="style"?VH(n,d):u==="dangerouslySetInnerHTML"?NH(n,d):u==="children"?Lw(n,d):rF(n,u,d,c)}switch(o){case"input":jI(n,s);break;case"textarea":DH(n,s);break;case"select":var m=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!s.multiple;var f=s.value;f!=null?S0(n,!!s.multiple,f,!1):m!==!!s.multiple&&(s.defaultValue!=null?S0(n,!!s.multiple,s.defaultValue,!0):S0(n,!!s.multiple,s.multiple?[]:"",!1))}n[Bw]=s}catch(g){Vr(i,i.return,g)}}break;case 6:if(Jl(e,i),Kc(i),r&4){if(i.stateNode===null)throw Error(ge(162));n=i.stateNode,s=i.memoizedProps;try{n.nodeValue=s}catch(g){Vr(i,i.return,g)}}break;case 3:if(Jl(e,i),Kc(i),r&4&&t!==null&&t.memoizedState.isDehydrated)try{Nw(e.containerInfo)}catch(g){Vr(i,i.return,g)}break;case 4:Jl(e,i),Kc(i);break;case 13:Jl(e,i),Kc(i),n=i.child,n.flags&8192&&(s=n.memoizedState!==null,n.stateNode.isHidden=s,!s||n.alternate!==null&&n.alternate.memoizedState!==null||(FF=Jr())),r&4&&r9(i);break;case 22:if(u=t!==null&&t.memoizedState!==null,i.mode&1?(js=(c=js)||u,Jl(e,i),js=c):Jl(e,i),Kc(i),r&8192){if(c=i.memoizedState!==null,(i.stateNode.isHidden=c)&&!u&&i.mode&1)for(Le=i,u=i.child;u!==null;){for(d=Le=u;Le!==null;){switch(m=Le,f=m.child,m.tag){case 0:case 11:case 14:case 15:zb(4,m,m.return);break;case 1:i0(m,m.return);var _=m.stateNode;if(typeof _.componentWillUnmount=="function"){r=m,t=m.return;try{e=r,_.props=e.memoizedProps,_.state=e.memoizedState,_.componentWillUnmount()}catch(g){Vr(r,t,g)}}break;case 5:i0(m,m.return);break;case 22:if(m.memoizedState!==null){s9(d);continue}}f!==null?(f.return=m,Le=f):s9(d)}u=u.sibling}e:for(u=null,d=i;;){if(d.tag===5){if(u===null){u=d;try{n=d.stateNode,c?(s=n.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=d.stateNode,l=d.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=kH("display",a))}catch(g){Vr(i,i.return,g)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(g){Vr(i,i.return,g)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===i)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===i)break e;for(;d.sibling===null;){if(d.return===null||d.return===i)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Jl(e,i),Kc(i),r&4&&r9(i);break;case 21:break;default:Jl(e,i),Kc(i)}}function Kc(i){var e=i.flags;if(e&2){try{e:{for(var t=i.return;t!==null;){if(uq(t)){var r=t;break e}t=t.return}throw Error(ge(160))}switch(r.tag){case 5:var n=r.stateNode;r.flags&32&&(Lw(n,""),r.flags&=-33);var s=i9(i);E3(i,s,n);break;case 3:case 4:var a=r.stateNode.containerInfo,o=i9(i);S3(i,o,a);break;default:throw Error(ge(161))}}catch(l){Vr(i,i.return,l)}i.flags&=-3}e&4096&&(i.flags&=-4097)}function Hle(i,e,t){Le=i,mq(i)}function mq(i,e,t){for(var r=(i.mode&1)!==0;Le!==null;){var n=Le,s=n.child;if(n.tag===22&&r){var a=n.memoizedState!==null||PT;if(!a){var o=n.alternate,l=o!==null&&o.memoizedState!==null||js;o=PT;var c=js;if(PT=a,(js=l)&&!c)for(Le=n;Le!==null;)a=Le,l=a.child,a.tag===22&&a.memoizedState!==null?a9(n):l!==null?(l.return=a,Le=l):a9(n);for(;s!==null;)Le=s,mq(s),s=s.sibling;Le=n,PT=o,js=c}n9(i)}else n.subtreeFlags&8772&&s!==null?(s.return=n,Le=s):n9(i)}}function n9(i){for(;Le!==null;){var e=Le;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:js||WP(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!js)if(t===null)r.componentDidMount();else{var n=e.elementType===e.type?t.memoizedProps:_c(e.type,t.memoizedProps);r.componentDidUpdate(n,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&zk(e,s,r);break;case 3:var a=e.updateQueue;if(a!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}zk(e,a,t)}break;case 5:var o=e.stateNode;if(t===null&&e.flags&4){t=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&Nw(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ge(163))}js||e.flags&512&&C3(e)}catch(m){Vr(e,e.return,m)}}if(e===i){Le=null;break}if(t=e.sibling,t!==null){t.return=e.return,Le=t;break}Le=e.return}}function s9(i){for(;Le!==null;){var e=Le;if(e===i){Le=null;break}var t=e.sibling;if(t!==null){t.return=e.return,Le=t;break}Le=e.return}}function a9(i){for(;Le!==null;){var e=Le;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{WP(4,e)}catch(l){Vr(e,t,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var n=e.return;try{r.componentDidMount()}catch(l){Vr(e,n,l)}}var s=e.return;try{C3(e)}catch(l){Vr(e,s,l)}break;case 5:var a=e.return;try{C3(e)}catch(l){Vr(e,a,l)}}}catch(l){Vr(e,e.return,l)}if(e===i){Le=null;break}var o=e.sibling;if(o!==null){o.return=e.return,Le=o;break}Le=e.return}}var jle=Math.ceil,d2=Ud.ReactCurrentDispatcher,$F=Ud.ReactCurrentOwner,jl=Ud.ReactCurrentBatchConfig,pi=0,os=null,mn=null,As=0,Vo=0,r0=Wm(0),Fn=0,Xw=null,Ng=0,XP=0,DF=0,Bb=null,no=null,FF=0,rv=1/0,Wu=null,p2=!1,P3=null,_m=null,RT=!1,nm=null,m2=0,Gb=0,R3=null,OS=-1,MS=0;function Oa(){return pi&6?Jr():OS!==-1?OS:OS=Jr()}function ym(i){return i.mode&1?pi&2&&As!==0?As&-As:Rle.transition!==null?(MS===0&&(MS=YH()),MS):(i=Li,i!==0||(i=window.event,i=i===void 0?16:nj(i.type)),i):1}function kc(i,e,t,r){if(50<Gb)throw Gb=0,R3=null,Error(ge(185));zx(i,t,r),(!(pi&2)||i!==os)&&(i===os&&(!(pi&2)&&(XP|=t),Fn===4&&Qp(i,As)),fo(i,r),t===1&&pi===0&&!(e.mode&1)&&(rv=Jr()+500,HP&&Xm()))}function fo(i,e){var t=i.callbackNode;Roe(i,e);var r=YE(i,i===os?As:0);if(r===0)t!==null&&fk(t),i.callbackNode=null,i.callbackPriority=0;else if(e=r&-r,i.callbackPriority!==e){if(t!=null&&fk(t),e===1)i.tag===0?Ple(o9.bind(null,i)):Tj(o9.bind(null,i)),Tle(function(){!(pi&6)&&Xm()}),t=null;else{switch(KH(r)){case 1:t=lF;break;case 4:t=QH;break;case 16:t=ZE;break;case 536870912:t=ZH;break;default:t=ZE}t=xq(t,fq.bind(null,i))}i.callbackPriority=e,i.callbackNode=t}}function fq(i,e){if(OS=-1,MS=0,pi&6)throw Error(ge(327));var t=i.callbackNode;if(O0()&&i.callbackNode!==t)return null;var r=YE(i,i===os?As:0);if(r===0)return null;if(r&30||r&i.expiredLanes||e)e=f2(i,r);else{e=r;var n=pi;pi|=2;var s=_q();(os!==i||As!==e)&&(Wu=null,rv=Jr()+500,gg(i,e));do try{Xle();break}catch(o){gq(i,o)}while(1);wF(),d2.current=s,pi=n,mn!==null?e=0:(os=null,As=0,e=Fn)}if(e!==0){if(e===2&&(n=t3(i),n!==0&&(r=n,e=A3(i,n))),e===1)throw t=Xw,gg(i,0),Qp(i,r),fo(i,Jr()),t;if(e===6)Qp(i,r);else{if(n=i.current.alternate,!(r&30)&&!qle(n)&&(e=f2(i,r),e===2&&(s=t3(i),s!==0&&(r=s,e=A3(i,s))),e===1))throw t=Xw,gg(i,0),Qp(i,r),fo(i,Jr()),t;switch(i.finishedWork=n,i.finishedLanes=r,e){case 0:case 1:throw Error(ge(345));case 2:Ef(i,no,Wu);break;case 3:if(Qp(i,r),(r&130023424)===r&&(e=FF+500-Jr(),10<e)){if(YE(i,0)!==0)break;if(n=i.suspendedLanes,(n&r)!==r){Oa(),i.pingedLanes|=i.suspendedLanes&n;break}i.timeoutHandle=c3(Ef.bind(null,i,no,Wu),e);break}Ef(i,no,Wu);break;case 4:if(Qp(i,r),(r&4194240)===r)break;for(e=i.eventTimes,n=-1;0<r;){var a=31-Nc(r);s=1<<a,a=e[a],a>n&&(n=a),r&=~s}if(r=n,r=Jr()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*jle(r/1960))-r,10<r){i.timeoutHandle=c3(Ef.bind(null,i,no,Wu),r);break}Ef(i,no,Wu);break;case 5:Ef(i,no,Wu);break;default:throw Error(ge(329))}}}return fo(i,Jr()),i.callbackNode===t?fq.bind(null,i):null}function A3(i,e){var t=Bb;return i.current.memoizedState.isDehydrated&&(gg(i,e).flags|=256),i=f2(i,e),i!==2&&(e=no,no=t,e!==null&&O3(e)),i}function O3(i){no===null?no=i:no.push.apply(no,i)}function qle(i){for(var e=i;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var n=t[r],s=n.getSnapshot;n=n.value;try{if(!Hc(s(),n))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===i)break;for(;e.sibling===null;){if(e.return===null||e.return===i)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Qp(i,e){for(e&=~DF,e&=~XP,i.suspendedLanes|=e,i.pingedLanes&=~e,i=i.expirationTimes;0<e;){var t=31-Nc(e),r=1<<t;i[t]=-1,e&=~r}}function o9(i){if(pi&6)throw Error(ge(327));O0();var e=YE(i,0);if(!(e&1))return fo(i,Jr()),null;var t=f2(i,e);if(i.tag!==0&&t===2){var r=t3(i);r!==0&&(e=r,t=A3(i,r))}if(t===1)throw t=Xw,gg(i,0),Qp(i,e),fo(i,Jr()),t;if(t===6)throw Error(ge(345));return i.finishedWork=i.current.alternate,i.finishedLanes=e,Ef(i,no,Wu),fo(i,Jr()),null}function NF(i,e){var t=pi;pi|=1;try{return i(e)}finally{pi=t,pi===0&&(rv=Jr()+500,HP&&Xm())}}function kg(i){nm!==null&&nm.tag===0&&!(pi&6)&&O0();var e=pi;pi|=1;var t=jl.transition,r=Li;try{if(jl.transition=null,Li=1,i)return i()}finally{Li=r,jl.transition=t,pi=e,!(pi&6)&&Xm()}}function kF(){Vo=r0.current,mr(r0)}function gg(i,e){i.finishedWork=null,i.finishedLanes=0;var t=i.timeoutHandle;if(t!==-1&&(i.timeoutHandle=-1,xle(t)),mn!==null)for(t=mn.return;t!==null;){var r=t;switch(yF(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&i2();break;case 3:tv(),mr(po),mr(Ks),PF();break;case 5:EF(r);break;case 4:tv();break;case 13:mr(Sr);break;case 19:mr(Sr);break;case 10:xF(r.type._context);break;case 22:case 23:kF()}t=t.return}if(os=i,mn=i=vm(i.current,null),As=Vo=e,Fn=0,Xw=null,DF=XP=Ng=0,no=Bb=null,rg!==null){for(e=0;e<rg.length;e++)if(t=rg[e],r=t.interleaved,r!==null){t.interleaved=null;var n=r.next,s=t.pending;if(s!==null){var a=s.next;s.next=n,r.next=a}t.pending=r}rg=null}return i}function gq(i,e){do{var t=mn;try{if(wF(),PS.current=u2,h2){for(var r=Ar.memoizedState;r!==null;){var n=r.queue;n!==null&&(n.pending=null),r=r.next}h2=!1}if(Fg=0,es=Ln=Ar=null,Ub=!1,jw=0,$F.current=null,t===null||t.return===null){Fn=1,Xw=e,mn=null;break}e:{var s=i,a=t.return,o=t,l=e;if(e=As,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var m=u.alternate;m?(u.updateQueue=m.updateQueue,u.memoizedState=m.memoizedState,u.lanes=m.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=Xk(a);if(f!==null){f.flags&=-257,Qk(f,a,o,s,e),f.mode&1&&Wk(s,c,e),e=f,l=c;var _=e.updateQueue;if(_===null){var g=new Set;g.add(l),e.updateQueue=g}else _.add(l);break e}else{if(!(e&1)){Wk(s,c,e),VF();break e}l=Error(ge(426))}}else if(br&&o.mode&1){var x=Xk(a);if(x!==null){!(x.flags&65536)&&(x.flags|=256),Qk(x,a,o,s,e),vF(iv(l,o));break e}}s=l=iv(l,o),Fn!==4&&(Fn=2),Bb===null?Bb=[s]:Bb.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var b=Jj(s,l,e);Uk(s,b);break e;case 1:o=l;var v=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof v.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(_m===null||!_m.has(w)))){s.flags|=65536,e&=-e,s.lanes|=e;var T=eq(s,o,e);Uk(s,T);break e}}s=s.return}while(s!==null)}vq(t)}catch(E){e=E,mn===t&&t!==null&&(mn=t=t.return);continue}break}while(1)}function _q(){var i=d2.current;return d2.current=u2,i===null?u2:i}function VF(){(Fn===0||Fn===3||Fn===2)&&(Fn=4),os===null||!(Ng&268435455)&&!(XP&268435455)||Qp(os,As)}function f2(i,e){var t=pi;pi|=2;var r=_q();(os!==i||As!==e)&&(Wu=null,gg(i,e));do try{Wle();break}catch(n){gq(i,n)}while(1);if(wF(),pi=t,d2.current=r,mn!==null)throw Error(ge(261));return os=null,As=0,Fn}function Wle(){for(;mn!==null;)yq(mn)}function Xle(){for(;mn!==null&&!voe();)yq(mn)}function yq(i){var e=wq(i.alternate,i,Vo);i.memoizedProps=i.pendingProps,e===null?vq(i):mn=e,$F.current=null}function vq(i){var e=i;do{var t=e.alternate;if(i=e.return,e.flags&32768){if(t=zle(t,e),t!==null){t.flags&=32767,mn=t;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{Fn=6,mn=null;return}}else if(t=Ule(t,e,Vo),t!==null){mn=t;return}if(e=e.sibling,e!==null){mn=e;return}mn=e=i}while(e!==null);Fn===0&&(Fn=5)}function Ef(i,e,t){var r=Li,n=jl.transition;try{jl.transition=null,Li=1,Qle(i,e,t,r)}finally{jl.transition=n,Li=r}return null}function Qle(i,e,t,r){do O0();while(nm!==null);if(pi&6)throw Error(ge(327));t=i.finishedWork;var n=i.finishedLanes;if(t===null)return null;if(i.finishedWork=null,i.finishedLanes=0,t===i.current)throw Error(ge(177));i.callbackNode=null,i.callbackPriority=0;var s=t.lanes|t.childLanes;if(Aoe(i,s),i===os&&(mn=os=null,As=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||RT||(RT=!0,xq(ZE,function(){return O0(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=jl.transition,jl.transition=null;var a=Li;Li=1;var o=pi;pi|=4,$F.current=null,Gle(i,t),pq(t,i),fle(o3),KE=!!a3,o3=a3=null,i.current=t,Hle(t),boe(),pi=o,Li=a,jl.transition=s}else i.current=t;if(RT&&(RT=!1,nm=i,m2=n),s=i.pendingLanes,s===0&&(_m=null),Toe(t.stateNode),fo(i,Jr()),e!==null)for(r=i.onRecoverableError,t=0;t<e.length;t++)n=e[t],r(n.value,{componentStack:n.stack,digest:n.digest});if(p2)throw p2=!1,i=P3,P3=null,i;return m2&1&&i.tag!==0&&O0(),s=i.pendingLanes,s&1?i===R3?Gb++:(Gb=0,R3=i):Gb=0,Xm(),null}function O0(){if(nm!==null){var i=KH(m2),e=jl.transition,t=Li;try{if(jl.transition=null,Li=16>i?16:i,nm===null)var r=!1;else{if(i=nm,nm=null,m2=0,pi&6)throw Error(ge(331));var n=pi;for(pi|=4,Le=i.current;Le!==null;){var s=Le,a=s.child;if(Le.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(Le=c;Le!==null;){var u=Le;switch(u.tag){case 0:case 11:case 15:zb(8,u,s)}var d=u.child;if(d!==null)d.return=u,Le=d;else for(;Le!==null;){u=Le;var m=u.sibling,f=u.return;if(hq(u),u===c){Le=null;break}if(m!==null){m.return=f,Le=m;break}Le=f}}}var _=s.alternate;if(_!==null){var g=_.child;if(g!==null){_.child=null;do{var x=g.sibling;g.sibling=null,g=x}while(g!==null)}}Le=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,Le=a;else e:for(;Le!==null;){if(s=Le,s.flags&2048)switch(s.tag){case 0:case 11:case 15:zb(9,s,s.return)}var b=s.sibling;if(b!==null){b.return=s.return,Le=b;break e}Le=s.return}}var v=i.current;for(Le=v;Le!==null;){a=Le;var w=a.child;if(a.subtreeFlags&2064&&w!==null)w.return=a,Le=w;else e:for(a=v;Le!==null;){if(o=Le,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:WP(9,o)}}catch(E){Vr(o,o.return,E)}if(o===a){Le=null;break e}var T=o.sibling;if(T!==null){T.return=o.return,Le=T;break e}Le=o.return}}if(pi=n,Xm(),Qh&&typeof Qh.onPostCommitFiberRoot=="function")try{Qh.onPostCommitFiberRoot(VP,i)}catch{}r=!0}return r}finally{Li=t,jl.transition=e}}return!1}function l9(i,e,t){e=iv(t,e),e=Jj(i,e,1),i=gm(i,e,1),e=Oa(),i!==null&&(zx(i,1,e),fo(i,e))}function Vr(i,e,t){if(i.tag===3)l9(i,i,t);else for(;e!==null;){if(e.tag===3){l9(e,i,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(_m===null||!_m.has(r))){i=iv(t,i),i=eq(e,i,1),e=gm(e,i,1),i=Oa(),e!==null&&(zx(e,1,i),fo(e,i));break}}e=e.return}}function Zle(i,e,t){var r=i.pingCache;r!==null&&r.delete(e),e=Oa(),i.pingedLanes|=i.suspendedLanes&t,os===i&&(As&t)===t&&(Fn===4||Fn===3&&(As&130023424)===As&&500>Jr()-FF?gg(i,0):DF|=t),fo(i,e)}function bq(i,e){e===0&&(i.mode&1?(e=yT,yT<<=1,!(yT&130023424)&&(yT=4194304)):e=1);var t=Oa();i=Rd(i,e),i!==null&&(zx(i,e,t),fo(i,t))}function Yle(i){var e=i.memoizedState,t=0;e!==null&&(t=e.retryLane),bq(i,t)}function Kle(i,e){var t=0;switch(i.tag){case 13:var r=i.stateNode,n=i.memoizedState;n!==null&&(t=n.retryLane);break;case 19:r=i.stateNode;break;default:throw Error(ge(314))}r!==null&&r.delete(e),bq(i,t)}var wq;wq=function(i,e,t){if(i!==null)if(i.memoizedProps!==e.pendingProps||po.current)uo=!0;else{if(!(i.lanes&t)&&!(e.flags&128))return uo=!1,Vle(i,e,t);uo=!!(i.flags&131072)}else uo=!1,br&&e.flags&1048576&&Cj(e,s2,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;AS(i,e),i=e.pendingProps;var n=K0(e,Ks.current);A0(e,t),n=AF(null,e,r,i,n,t);var s=OF();return e.flags|=1,typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,mo(r)?(s=!0,r2(e)):s=!1,e.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,CF(e),n.updater=jP,e.stateNode=n,n._reactInternals=e,g3(e,r,i,t),e=v3(null,e,r,!0,s,t)):(e.tag=0,br&&s&&_F(e),wa(null,e,n,t),e=e.child),e;case 16:r=e.elementType;e:{switch(AS(i,e),i=e.pendingProps,n=r._init,r=n(r._payload),e.type=r,n=e.tag=ece(r),i=_c(r,i),n){case 0:e=y3(null,e,r,i,t);break e;case 1:e=Kk(null,e,r,i,t);break e;case 11:e=Zk(null,e,r,i,t);break e;case 14:e=Yk(null,e,r,_c(r.type,i),t);break e}throw Error(ge(306,r,""))}return e;case 0:return r=e.type,n=e.pendingProps,n=e.elementType===r?n:_c(r,n),y3(i,e,r,n,t);case 1:return r=e.type,n=e.pendingProps,n=e.elementType===r?n:_c(r,n),Kk(i,e,r,n,t);case 3:e:{if(nq(e),i===null)throw Error(ge(387));r=e.pendingProps,s=e.memoizedState,n=s.element,Rj(i,e),l2(e,r,null,t);var a=e.memoizedState;if(r=a.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){n=iv(Error(ge(423)),e),e=Jk(i,e,r,t,n);break e}else if(r!==n){n=iv(Error(ge(424)),e),e=Jk(i,e,r,t,n);break e}else for(el=fm(e.stateNode.containerInfo.firstChild),rl=e,br=!0,wc=null,t=Ij(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(J0(),r===n){e=Ad(i,e,t);break e}wa(i,e,r,t)}e=e.child}return e;case 5:return Lj(e),i===null&&p3(e),r=e.type,n=e.pendingProps,s=i!==null?i.memoizedProps:null,a=n.children,l3(r,n)?a=null:s!==null&&l3(r,s)&&(e.flags|=32),rq(i,e),wa(i,e,a,t),e.child;case 6:return i===null&&p3(e),null;case 13:return sq(i,e,t);case 4:return SF(e,e.stateNode.containerInfo),r=e.pendingProps,i===null?e.child=ev(e,null,r,t):wa(i,e,r,t),e.child;case 11:return r=e.type,n=e.pendingProps,n=e.elementType===r?n:_c(r,n),Zk(i,e,r,n,t);case 7:return wa(i,e,e.pendingProps,t),e.child;case 8:return wa(i,e,e.pendingProps.children,t),e.child;case 12:return wa(i,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,n=e.pendingProps,s=e.memoizedProps,a=n.value,ir(a2,r._currentValue),r._currentValue=a,s!==null)if(Hc(s.value,a)){if(s.children===n.children&&!po.current){e=Ad(i,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=fd(-1,t&-t),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=t,l=s.alternate,l!==null&&(l.lanes|=t),m3(s.return,t,e),o.lanes|=t;break}l=l.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(ge(341));a.lanes|=t,o=a.alternate,o!==null&&(o.lanes|=t),m3(a,t,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}wa(i,e,n.children,t),e=e.child}return e;case 9:return n=e.type,r=e.pendingProps.children,A0(e,t),n=ql(n),r=r(n),e.flags|=1,wa(i,e,r,t),e.child;case 14:return r=e.type,n=_c(r,e.pendingProps),n=_c(r.type,n),Yk(i,e,r,n,t);case 15:return tq(i,e,e.type,e.pendingProps,t);case 17:return r=e.type,n=e.pendingProps,n=e.elementType===r?n:_c(r,n),AS(i,e),e.tag=1,mo(r)?(i=!0,r2(e)):i=!1,A0(e,t),Oj(e,r,n),g3(e,r,n,t),v3(null,e,r,!0,i,t);case 19:return aq(i,e,t);case 22:return iq(i,e,t)}throw Error(ge(156,e.tag))};function xq(i,e){return XH(i,e)}function Jle(i,e,t,r){this.tag=i,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vl(i,e,t,r){return new Jle(i,e,t,r)}function UF(i){return i=i.prototype,!(!i||!i.isReactComponent)}function ece(i){if(typeof i=="function")return UF(i)?1:0;if(i!=null){if(i=i.$$typeof,i===sF)return 11;if(i===aF)return 14}return 2}function vm(i,e){var t=i.alternate;return t===null?(t=Vl(i.tag,e,i.key,i.mode),t.elementType=i.elementType,t.type=i.type,t.stateNode=i.stateNode,t.alternate=i,i.alternate=t):(t.pendingProps=e,t.type=i.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=i.flags&14680064,t.childLanes=i.childLanes,t.lanes=i.lanes,t.child=i.child,t.memoizedProps=i.memoizedProps,t.memoizedState=i.memoizedState,t.updateQueue=i.updateQueue,e=i.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=i.sibling,t.index=i.index,t.ref=i.ref,t}function IS(i,e,t,r,n,s){var a=2;if(r=i,typeof i=="function")UF(i)&&(a=1);else if(typeof i=="string")a=5;else e:switch(i){case Wy:return _g(t.children,n,s,e);case nF:a=8,n|=8;break;case UI:return i=Vl(12,t,e,n|2),i.elementType=UI,i.lanes=s,i;case zI:return i=Vl(13,t,e,n),i.elementType=zI,i.lanes=s,i;case BI:return i=Vl(19,t,e,n),i.elementType=BI,i.lanes=s,i;case MH:return QP(t,n,s,e);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case AH:a=10;break e;case OH:a=9;break e;case sF:a=11;break e;case aF:a=14;break e;case zp:a=16,r=null;break e}throw Error(ge(130,i==null?i:typeof i,""))}return e=Vl(a,t,e,n),e.elementType=i,e.type=r,e.lanes=s,e}function _g(i,e,t,r){return i=Vl(7,i,r,e),i.lanes=t,i}function QP(i,e,t,r){return i=Vl(22,i,r,e),i.elementType=MH,i.lanes=t,i.stateNode={isHidden:!1},i}function MA(i,e,t){return i=Vl(6,i,null,e),i.lanes=t,i}function IA(i,e,t){return e=Vl(4,i.children!==null?i.children:[],i.key,e),e.lanes=t,e.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},e}function tce(i,e,t,r,n){this.tag=e,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=dA(0),this.expirationTimes=dA(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=dA(0),this.identifierPrefix=r,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function zF(i,e,t,r,n,s,a,o,l){return i=new tce(i,e,t,o,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Vl(3,null,null,e),i.current=s,s.stateNode=i,s.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},CF(s),i}function ice(i,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:qy,key:r==null?null:""+r,children:i,containerInfo:e,implementation:t}}function Tq(i){if(!i)return Nm;i=i._reactInternals;e:{if(s_(i)!==i||i.tag!==1)throw Error(ge(170));var e=i;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(mo(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ge(171))}if(i.tag===1){var t=i.type;if(mo(t))return xj(i,t,e)}return e}function Cq(i,e,t,r,n,s,a,o,l){return i=zF(t,r,!0,i,n,s,a,o,l),i.context=Tq(null),t=i.current,r=Oa(),n=ym(t),s=fd(r,n),s.callback=e??null,gm(t,s,n),i.current.lanes=n,zx(i,n,r),fo(i,r),i}function ZP(i,e,t,r){var n=e.current,s=Oa(),a=ym(n);return t=Tq(t),e.context===null?e.context=t:e.pendingContext=t,e=fd(s,a),e.payload={element:i},r=r===void 0?null:r,r!==null&&(e.callback=r),i=gm(n,e,a),i!==null&&(kc(i,n,a,s),ES(i,n,a)),a}function g2(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function c9(i,e){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var t=i.retryLane;i.retryLane=t!==0&&t<e?t:e}}function BF(i,e){c9(i,e),(i=i.alternate)&&c9(i,e)}function rce(){return null}var Sq=typeof reportError=="function"?reportError:function(i){console.error(i)};function GF(i){this._internalRoot=i}YP.prototype.render=GF.prototype.render=function(i){var e=this._internalRoot;if(e===null)throw Error(ge(409));ZP(i,e,null,null)};YP.prototype.unmount=GF.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var e=i.containerInfo;kg(function(){ZP(null,i,null,null)}),e[Pd]=null}};function YP(i){this._internalRoot=i}YP.prototype.unstable_scheduleHydration=function(i){if(i){var e=tj();i={blockedOn:null,target:i,priority:e};for(var t=0;t<Xp.length&&e!==0&&e<Xp[t].priority;t++);Xp.splice(t,0,i),t===0&&rj(i)}};function HF(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function KP(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function h9(){}function nce(i,e,t,r,n){if(n){if(typeof r=="function"){var s=r;r=function(){var c=g2(a);s.call(c)}}var a=Cq(e,r,i,0,null,!1,!1,"",h9);return i._reactRootContainer=a,i[Pd]=a.current,Uw(i.nodeType===8?i.parentNode:i),kg(),a}for(;n=i.lastChild;)i.removeChild(n);if(typeof r=="function"){var o=r;r=function(){var c=g2(l);o.call(c)}}var l=zF(i,0,!1,null,null,!1,!1,"",h9);return i._reactRootContainer=l,i[Pd]=l.current,Uw(i.nodeType===8?i.parentNode:i),kg(function(){ZP(e,l,t,r)}),l}function JP(i,e,t,r,n){var s=t._reactRootContainer;if(s){var a=s;if(typeof n=="function"){var o=n;n=function(){var l=g2(a);o.call(l)}}ZP(e,a,i,n)}else a=nce(t,e,i,n,r);return g2(a)}JH=function(i){switch(i.tag){case 3:var e=i.stateNode;if(e.current.memoizedState.isDehydrated){var t=N1(e.pendingLanes);t!==0&&(cF(e,t|1),fo(e,Jr()),!(pi&6)&&(rv=Jr()+500,Xm()))}break;case 13:kg(function(){var r=Rd(i,1);if(r!==null){var n=Oa();kc(r,i,1,n)}}),BF(i,1)}};hF=function(i){if(i.tag===13){var e=Rd(i,134217728);if(e!==null){var t=Oa();kc(e,i,134217728,t)}BF(i,134217728)}};ej=function(i){if(i.tag===13){var e=ym(i),t=Rd(i,e);if(t!==null){var r=Oa();kc(t,i,e,r)}BF(i,e)}};tj=function(){return Li};ij=function(i,e){var t=Li;try{return Li=i,e()}finally{Li=t}};KI=function(i,e,t){switch(e){case"input":if(jI(i,t),e=t.name,t.type==="radio"&&e!=null){for(t=i;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==i&&r.form===i.form){var n=GP(r);if(!n)throw Error(ge(90));LH(r),jI(r,n)}}}break;case"textarea":DH(i,t);break;case"select":e=t.value,e!=null&&S0(i,!!t.multiple,e,!1)}};BH=NF;GH=kg;var sce={usingClientEntryPoint:!1,Events:[Gx,Yy,GP,UH,zH,NF]},jv={findFiberByHostInstance:ig,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},ace={bundleType:jv.bundleType,version:jv.version,rendererPackageName:jv.rendererPackageName,rendererConfig:jv.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ud.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=qH(i),i===null?null:i.stateNode},findFiberByHostInstance:jv.findFiberByHostInstance||rce,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var AT=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!AT.isDisabled&&AT.supportsFiber)try{VP=AT.inject(ace),Qh=AT}catch{}}ol.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sce;ol.createPortal=function(i,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!HF(e))throw Error(ge(200));return ice(i,e,null,t)};ol.createRoot=function(i,e){if(!HF(i))throw Error(ge(299));var t=!1,r="",n=Sq;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(n=e.onRecoverableError)),e=zF(i,1,!1,null,null,t,!1,r,n),i[Pd]=e.current,Uw(i.nodeType===8?i.parentNode:i),new GF(e)};ol.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var e=i._reactInternals;if(e===void 0)throw typeof i.render=="function"?Error(ge(188)):(i=Object.keys(i).join(","),Error(ge(268,i)));return i=qH(e),i=i===null?null:i.stateNode,i};ol.flushSync=function(i){return kg(i)};ol.hydrate=function(i,e,t){if(!KP(e))throw Error(ge(200));return JP(null,i,e,!0,t)};ol.hydrateRoot=function(i,e,t){if(!HF(i))throw Error(ge(405));var r=t!=null&&t.hydratedSources||null,n=!1,s="",a=Sq;if(t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),e=Cq(e,null,i,1,t??null,n,!1,s,a),i[Pd]=e.current,Uw(i),r)for(i=0;i<r.length;i++)t=r[i],n=t._getVersion,n=n(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,n]:e.mutableSourceEagerHydrationData.push(t,n);return new YP(e)};ol.render=function(i,e,t){if(!KP(e))throw Error(ge(200));return JP(null,i,e,!1,t)};ol.unmountComponentAtNode=function(i){if(!KP(i))throw Error(ge(40));return i._reactRootContainer?(kg(function(){JP(null,null,i,!1,function(){i._reactRootContainer=null,i[Pd]=null})}),!0):!1};ol.unstable_batchedUpdates=NF;ol.unstable_renderSubtreeIntoContainer=function(i,e,t,r){if(!KP(t))throw Error(ge(200));if(i==null||i._reactInternals===void 0)throw Error(ge(38));return JP(i,e,t,!1,r)};ol.version="18.2.0-next-9e3b772b8-20220608";(function(i){function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}e(),i.exports=ol})(roe);var u9=NI;FI.createRoot=u9.createRoot,FI.hydrateRoot=u9.hydrateRoot;/**
 * @remix-run/router v1.3.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Qw(){return Qw=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},Qw.apply(this,arguments)}var sm;(function(i){i.Pop="POP",i.Push="PUSH",i.Replace="REPLACE"})(sm||(sm={}));const d9="popstate";function oce(i){i===void 0&&(i={});function e(n,s){let{pathname:a="/",search:o="",hash:l=""}=a_(n.location.hash.substr(1));return M3("",{pathname:a,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(n,s){let a=n.document.querySelector("base"),o="";if(a&&a.getAttribute("href")){let l=n.location.href,c=l.indexOf("#");o=c===-1?l:l.slice(0,c)}return o+"#"+(typeof s=="string"?s:_2(s))}function r(n,s){lce(n.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(s)+")")}return hce(e,t,r,i)}function Un(i,e){if(i===!1||i===null||typeof i>"u")throw new Error(e)}function lce(i,e){if(!i){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function cce(){return Math.random().toString(36).substr(2,8)}function p9(i,e){return{usr:i.state,key:i.key,idx:e}}function M3(i,e,t,r){return t===void 0&&(t=null),Qw({pathname:typeof i=="string"?i:i.pathname,search:"",hash:""},typeof e=="string"?a_(e):e,{state:t,key:e&&e.key||r||cce()})}function _2(i){let{pathname:e="/",search:t="",hash:r=""}=i;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function a_(i){let e={};if(i){let t=i.indexOf("#");t>=0&&(e.hash=i.substr(t),i=i.substr(0,t));let r=i.indexOf("?");r>=0&&(e.search=i.substr(r),i=i.substr(0,r)),i&&(e.pathname=i)}return e}function hce(i,e,t,r){r===void 0&&(r={});let{window:n=document.defaultView,v5Compat:s=!1}=r,a=n.history,o=sm.Pop,l=null,c=u();c==null&&(c=0,a.replaceState(Qw({},a.state,{idx:c}),""));function u(){return(a.state||{idx:null}).idx}function d(){o=sm.Pop;let x=u(),b=x==null?null:x-c;c=x,l&&l({action:o,location:g.location,delta:b})}function m(x,b){o=sm.Push;let v=M3(g.location,x,b);t&&t(v,x),c=u()+1;let w=p9(v,c),T=g.createHref(v);try{a.pushState(w,"",T)}catch{n.location.assign(T)}s&&l&&l({action:o,location:g.location,delta:1})}function f(x,b){o=sm.Replace;let v=M3(g.location,x,b);t&&t(v,x),c=u();let w=p9(v,c),T=g.createHref(v);a.replaceState(w,"",T),s&&l&&l({action:o,location:g.location,delta:0})}function _(x){let b=n.location.origin!=="null"?n.location.origin:n.location.href,v=typeof x=="string"?x:_2(x);return Un(b,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,b)}let g={get action(){return o},get location(){return i(n,a)},listen(x){if(l)throw new Error("A history only accepts one active listener");return n.addEventListener(d9,d),l=x,()=>{n.removeEventListener(d9,d),l=null}},createHref(x){return e(n,x)},createURL:_,encodeLocation(x){let b=_(x);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:m,replace:f,go(x){return a.go(x)}};return g}var m9;(function(i){i.data="data",i.deferred="deferred",i.redirect="redirect",i.error="error"})(m9||(m9={}));function uce(i,e,t){t===void 0&&(t="/");let r=typeof e=="string"?a_(e):e,n=Rq(r.pathname||"/",t);if(n==null)return null;let s=Eq(i);dce(s);let a=null;for(let o=0;a==null&&o<s.length;++o)a=wce(s[o],Cce(n));return a}function Eq(i,e,t,r){e===void 0&&(e=[]),t===void 0&&(t=[]),r===void 0&&(r="");let n=(s,a,o)=>{let l={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:a,route:s};l.relativePath.startsWith("/")&&(Un(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let c=bm([r,l.relativePath]),u=t.concat(l);s.children&&s.children.length>0&&(Un(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),Eq(s.children,e,u,c)),!(s.path==null&&!s.index)&&e.push({path:c,score:vce(c,s.index),routesMeta:u})};return i.forEach((s,a)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))n(s,a);else for(let l of Pq(s.path))n(s,a,l)}),e}function Pq(i){let e=i.split("/");if(e.length===0)return[];let[t,...r]=e,n=t.endsWith("?"),s=t.replace(/\?$/,"");if(r.length===0)return n?[s,""]:[s];let a=Pq(r.join("/")),o=[];return o.push(...a.map(l=>l===""?s:[s,l].join("/"))),n&&o.push(...a),o.map(l=>i.startsWith("/")&&l===""?"/":l)}function dce(i){i.sort((e,t)=>e.score!==t.score?t.score-e.score:bce(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}const pce=/^:\w+$/,mce=3,fce=2,gce=1,_ce=10,yce=-2,f9=i=>i==="*";function vce(i,e){let t=i.split("/"),r=t.length;return t.some(f9)&&(r+=yce),e&&(r+=fce),t.filter(n=>!f9(n)).reduce((n,s)=>n+(pce.test(s)?mce:s===""?gce:_ce),r)}function bce(i,e){return i.length===e.length&&i.slice(0,-1).every((r,n)=>r===e[n])?i[i.length-1]-e[e.length-1]:0}function wce(i,e){let{routesMeta:t}=i,r={},n="/",s=[];for(let a=0;a<t.length;++a){let o=t[a],l=a===t.length-1,c=n==="/"?e:e.slice(n.length)||"/",u=xce({path:o.relativePath,caseSensitive:o.caseSensitive,end:l},c);if(!u)return null;Object.assign(r,u.params);let d=o.route;s.push({params:r,pathname:bm([n,u.pathname]),pathnameBase:Rce(bm([n,u.pathnameBase])),route:d}),u.pathnameBase!=="/"&&(n=bm([n,u.pathnameBase]))}return s}function xce(i,e){typeof i=="string"&&(i={path:i,caseSensitive:!1,end:!0});let[t,r]=Tce(i.path,i.caseSensitive,i.end),n=e.match(t);if(!n)return null;let s=n[0],a=s.replace(/(.)\/+$/,"$1"),o=n.slice(1);return{params:r.reduce((c,u,d)=>{if(u==="*"){let m=o[d]||"";a=s.slice(0,s.length-m.length).replace(/(.)\/+$/,"$1")}return c[u]=Sce(o[d]||"",u),c},{}),pathname:s,pathnameBase:a,pattern:i}}function Tce(i,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),jF(i==="*"||!i.endsWith("*")||i.endsWith("/*"),'Route path "'+i+'" will be treated as if it were '+('"'+i.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+i.replace(/\*$/,"/*")+'".'));let r=[],n="^"+i.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(a,o)=>(r.push(o),"/([^\\/]+)"));return i.endsWith("*")?(r.push("*"),n+=i==="*"||i==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?n+="\\/*$":i!==""&&i!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,e?void 0:"i"),r]}function Cce(i){try{return decodeURI(i)}catch(e){return jF(!1,'The URL path "'+i+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),i}}function Sce(i,e){try{return decodeURIComponent(i)}catch(t){return jF(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+i+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+t+").")),i}}function Rq(i,e){if(e==="/")return i;if(!i.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=i.charAt(t);return r&&r!=="/"?null:i.slice(t)||"/"}function jF(i,e){if(!i){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Ece(i,e){e===void 0&&(e="/");let{pathname:t,search:r="",hash:n=""}=typeof i=="string"?a_(i):i;return{pathname:t?t.startsWith("/")?t:Pce(t,e):e,search:Ace(r),hash:Oce(n)}}function Pce(i,e){let t=e.replace(/\/+$/,"").split("/");return i.split("/").forEach(n=>{n===".."?t.length>1&&t.pop():n!=="."&&t.push(n)}),t.length>1?t.join("/"):"/"}function LA(i,e,t,r){return"Cannot include a '"+i+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Aq(i){return i.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Oq(i,e,t,r){r===void 0&&(r=!1);let n;typeof i=="string"?n=a_(i):(n=Qw({},i),Un(!n.pathname||!n.pathname.includes("?"),LA("?","pathname","search",n)),Un(!n.pathname||!n.pathname.includes("#"),LA("#","pathname","hash",n)),Un(!n.search||!n.search.includes("#"),LA("#","search","hash",n)));let s=i===""||n.pathname==="",a=s?"/":n.pathname,o;if(r||a==null)o=t;else{let d=e.length-1;if(a.startsWith("..")){let m=a.split("/");for(;m[0]==="..";)m.shift(),d-=1;n.pathname=m.join("/")}o=d>=0?e[d]:"/"}let l=Ece(n,o),c=a&&a!=="/"&&a.endsWith("/"),u=(s||a===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const bm=i=>i.join("/").replace(/\/\/+/g,"/"),Rce=i=>i.replace(/\/+$/,"").replace(/^\/*/,"/"),Ace=i=>!i||i==="?"?"":i.startsWith("?")?i:"?"+i,Oce=i=>!i||i==="#"?"":i.startsWith("#")?i:"#"+i;function Mce(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.internal=="boolean"&&"data"in i}const Ice=["post","put","patch","delete"];[...Ice];/**
 * React Router v6.8.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function I3(){return I3=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},I3.apply(this,arguments)}function Lce(i,e){return i===e&&(i!==0||1/i===1/e)||i!==i&&e!==e}const $ce=typeof Object.is=="function"?Object.is:Lce,{useState:Dce,useEffect:Fce,useLayoutEffect:Nce,useDebugValue:kce}=DI;function Vce(i,e,t){const r=e(),[{inst:n},s]=Dce({inst:{value:r,getSnapshot:e}});return Nce(()=>{n.value=r,n.getSnapshot=e,$A(n)&&s({inst:n})},[i,r,e]),Fce(()=>($A(n)&&s({inst:n}),i(()=>{$A(n)&&s({inst:n})})),[i]),kce(r),r}function $A(i){const e=i.getSnapshot,t=i.value;try{const r=e();return!$ce(t,r)}catch{return!0}}function Uce(i,e,t){return e()}const zce=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Bce=!zce,Gce=Bce?Uce:Vce;"useSyncExternalStore"in DI&&(i=>i.useSyncExternalStore)(DI);const Mq=Pe.createContext(null),Iq=Pe.createContext(null),eR=Pe.createContext(null),tR=Pe.createContext(null),bv=Pe.createContext({outlet:null,matches:[]}),Lq=Pe.createContext(null);function Hce(i,e){let{relative:t}=e===void 0?{}:e;jx()||Un(!1);let{basename:r,navigator:n}=Pe.useContext(eR),{hash:s,pathname:a,search:o}=$q(i,{relative:t}),l=a;return r!=="/"&&(l=a==="/"?r:bm([r,a])),n.createHref({pathname:l,search:o,hash:s})}function jx(){return Pe.useContext(tR)!=null}function iR(){return jx()||Un(!1),Pe.useContext(tR).location}function jce(){jx()||Un(!1);let{basename:i,navigator:e}=Pe.useContext(eR),{matches:t}=Pe.useContext(bv),{pathname:r}=iR(),n=JSON.stringify(Aq(t).map(o=>o.pathnameBase)),s=Pe.useRef(!1);return Pe.useEffect(()=>{s.current=!0}),Pe.useCallback(function(o,l){if(l===void 0&&(l={}),!s.current)return;if(typeof o=="number"){e.go(o);return}let c=Oq(o,JSON.parse(n),r,l.relative==="path");i!=="/"&&(c.pathname=c.pathname==="/"?i:bm([i,c.pathname])),(l.replace?e.replace:e.push)(c,l.state,l)},[i,e,n,r])}function $q(i,e){let{relative:t}=e===void 0?{}:e,{matches:r}=Pe.useContext(bv),{pathname:n}=iR(),s=JSON.stringify(Aq(r).map(a=>a.pathnameBase));return Pe.useMemo(()=>Oq(i,JSON.parse(s),n,t==="path"),[i,s,n,t])}function qce(i,e){jx()||Un(!1);let{navigator:t}=Pe.useContext(eR),r=Pe.useContext(Iq),{matches:n}=Pe.useContext(bv),s=n[n.length-1],a=s?s.params:{};s&&s.pathname;let o=s?s.pathnameBase:"/";s&&s.route;let l=iR(),c;if(e){var u;let g=typeof e=="string"?a_(e):e;o==="/"||(u=g.pathname)!=null&&u.startsWith(o)||Un(!1),c=g}else c=l;let d=c.pathname||"/",m=o==="/"?d:d.slice(o.length)||"/",f=uce(i,{pathname:m}),_=Zce(f&&f.map(g=>Object.assign({},g,{params:Object.assign({},a,g.params),pathname:bm([o,t.encodeLocation?t.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:g.pathnameBase==="/"?o:bm([o,t.encodeLocation?t.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})),n,r||void 0);return e&&_?Pe.createElement(tR.Provider,{value:{location:I3({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:sm.Pop}},_):_}function Wce(){let i=ehe(),e=Mce(i)?i.status+" "+i.statusText:i instanceof Error?i.message:JSON.stringify(i),t=i instanceof Error?i.stack:null,n={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},s=null;return Pe.createElement(Pe.Fragment,null,Pe.createElement("h2",null,"Unexpected Application Error!"),Pe.createElement("h3",{style:{fontStyle:"italic"}},e),t?Pe.createElement("pre",{style:n},t):null,s)}class Xce extends Pe.Component{constructor(e){super(e),this.state={location:e.location,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location?{error:e.error,location:e.location}:{error:e.error||t.error,location:t.location}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error?Pe.createElement(bv.Provider,{value:this.props.routeContext},Pe.createElement(Lq.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Qce(i){let{routeContext:e,match:t,children:r}=i,n=Pe.useContext(Mq);return n&&n.static&&n.staticContext&&t.route.errorElement&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),Pe.createElement(bv.Provider,{value:e},r)}function Zce(i,e,t){if(e===void 0&&(e=[]),i==null)if(t!=null&&t.errors)i=t.matches;else return null;let r=i,n=t==null?void 0:t.errors;if(n!=null){let s=r.findIndex(a=>a.route.id&&(n==null?void 0:n[a.route.id]));s>=0||Un(!1),r=r.slice(0,Math.min(r.length,s+1))}return r.reduceRight((s,a,o)=>{let l=a.route.id?n==null?void 0:n[a.route.id]:null,c=t?a.route.errorElement||Pe.createElement(Wce,null):null,u=e.concat(r.slice(0,o+1)),d=()=>Pe.createElement(Qce,{match:a,routeContext:{outlet:s,matches:u}},l?c:a.route.element!==void 0?a.route.element:s);return t&&(a.route.errorElement||o===0)?Pe.createElement(Xce,{location:t.location,component:c,error:l,children:d(),routeContext:{outlet:null,matches:u}}):d()},null)}var g9;(function(i){i.UseBlocker="useBlocker",i.UseRevalidator="useRevalidator"})(g9||(g9={}));var y2;(function(i){i.UseLoaderData="useLoaderData",i.UseActionData="useActionData",i.UseRouteError="useRouteError",i.UseNavigation="useNavigation",i.UseRouteLoaderData="useRouteLoaderData",i.UseMatches="useMatches",i.UseRevalidator="useRevalidator"})(y2||(y2={}));function Yce(i){let e=Pe.useContext(Iq);return e||Un(!1),e}function Kce(i){let e=Pe.useContext(bv);return e||Un(!1),e}function Jce(i){let e=Kce(),t=e.matches[e.matches.length-1];return t.route.id||Un(!1),t.route.id}function ehe(){var i;let e=Pe.useContext(Lq),t=Yce(y2.UseRouteError),r=Jce(y2.UseRouteError);return e||((i=t.errors)==null?void 0:i[r])}function V1(i){Un(!1)}function the(i){let{basename:e="/",children:t=null,location:r,navigationType:n=sm.Pop,navigator:s,static:a=!1}=i;jx()&&Un(!1);let o=e.replace(/^\/*/,"/"),l=Pe.useMemo(()=>({basename:o,navigator:s,static:a}),[o,s,a]);typeof r=="string"&&(r=a_(r));let{pathname:c="/",search:u="",hash:d="",state:m=null,key:f="default"}=r,_=Pe.useMemo(()=>{let g=Rq(c,o);return g==null?null:{pathname:g,search:u,hash:d,state:m,key:f}},[o,c,u,d,m,f]);return _==null?null:Pe.createElement(eR.Provider,{value:l},Pe.createElement(tR.Provider,{children:t,value:{location:_,navigationType:n}}))}function ihe(i){let{children:e,location:t}=i,r=Pe.useContext(Mq),n=r&&!e?r.router.routes:L3(e);return qce(n,t)}var _9;(function(i){i[i.pending=0]="pending",i[i.success=1]="success",i[i.error=2]="error"})(_9||(_9={}));new Promise(()=>{});function L3(i,e){e===void 0&&(e=[]);let t=[];return Pe.Children.forEach(i,(r,n)=>{if(!Pe.isValidElement(r))return;if(r.type===Pe.Fragment){t.push.apply(t,L3(r.props.children,e));return}r.type!==V1&&Un(!1),!r.props.index||!r.props.children||Un(!1);let s=[...e,n],a={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,hasErrorBoundary:r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle};r.props.children&&(a.children=L3(r.props.children,s)),t.push(a)}),t}/**
 * React Router DOM v6.8.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function $3(){return $3=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},$3.apply(this,arguments)}function rhe(i,e){if(i==null)return{};var t={},r=Object.keys(i),n,s;for(s=0;s<r.length;s++)n=r[s],!(e.indexOf(n)>=0)&&(t[n]=i[n]);return t}function nhe(i){return!!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)}function she(i,e){return i.button===0&&(!e||e==="_self")&&!nhe(i)}const ahe=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"];function ohe(i){let{basename:e,children:t,window:r}=i,n=Pe.useRef();n.current==null&&(n.current=oce({window:r,v5Compat:!0}));let s=n.current,[a,o]=Pe.useState({action:s.action,location:s.location});return Pe.useLayoutEffect(()=>s.listen(o),[s]),Pe.createElement(the,{basename:e,children:t,location:a.location,navigationType:a.action,navigator:s})}const lhe=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",DA=Pe.forwardRef(function(e,t){let{onClick:r,relative:n,reloadDocument:s,replace:a,state:o,target:l,to:c,preventScrollReset:u}=e,d=rhe(e,ahe),m,f=!1;if(lhe&&typeof c=="string"&&/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i.test(c)){m=c;let b=new URL(window.location.href),v=c.startsWith("//")?new URL(b.protocol+c):new URL(c);v.origin===b.origin?c=v.pathname+v.search+v.hash:f=!0}let _=Hce(c,{relative:n}),g=che(c,{replace:a,state:o,target:l,preventScrollReset:u,relative:n});function x(b){r&&r(b),b.defaultPrevented||g(b)}return Pe.createElement("a",$3({},d,{href:m||_,onClick:f||s?r:x,ref:t,target:l}))});var y9;(function(i){i.UseScrollRestoration="useScrollRestoration",i.UseSubmitImpl="useSubmitImpl",i.UseFetcher="useFetcher"})(y9||(y9={}));var v9;(function(i){i.UseFetchers="useFetchers",i.UseScrollRestoration="useScrollRestoration"})(v9||(v9={}));function che(i,e){let{target:t,replace:r,state:n,preventScrollReset:s,relative:a}=e===void 0?{}:e,o=jce(),l=iR(),c=$q(i,{relative:a});return Pe.useCallback(u=>{if(she(u,t)){u.preventDefault();let d=r!==void 0?r:_2(l)===_2(c);o(i,{replace:d,state:n,preventScrollReset:s,relative:a})}},[l,o,c,r,n,t,i,s,a])}function hhe(){return nd("div",{className:"home",children:[Lt("div",{className:"link",children:Lt(DA,{to:"/media-layer-images",children:"MediaLayerImages"})}),Lt("div",{className:"link",children:Lt(DA,{to:"/media-layer-video",children:"MediaLayerVideo"})}),Lt("div",{className:"link",children:Lt(DA,{to:"/media-layer-webmap",children:"MediaLayerWebmap"})})]})}let Mu=class extends au(mt){constructor(...e){super(...e),this.position=new Ne([0,0,0]),this.heading=0,this.tilt=0,this.fov=55}normalizeCtorArgs(e,t,r,n){if(e&&typeof e=="object"&&("x"in e||Array.isArray(e))){const s={position:e};return t!=null&&(s.heading=t),r!=null&&(s.tilt=r),n!=null&&(s.fov=n),s}return e}writePosition(e,t,r,n){const s=e.clone();s.x=kp(e.x||0),s.y=kp(e.y||0),s.z=e.hasZ?kp(e.z||0):e.z,t[r]=s.write({},n)}readPosition(e,t){const r=new Ne;return r.read(e,t),r.x=kp(r.x||0),r.y=kp(r.y||0),r.z=r.hasZ?kp(r.z||0):r.z,r}equals(e){return!S(e)&&this.tilt===e.tilt&&this.heading===e.heading&&this.fov===e.fov&&this.position.equals(e.position)}};h([p({type:Ne,json:{write:{isRequired:!0}}})],Mu.prototype,"position",void 0),h([Cs("position")],Mu.prototype,"writePosition",null),h([Dl("position")],Mu.prototype,"readPosition",null),h([p({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),qr(i=>Z$.normalize(kp(i)))],Mu.prototype,"heading",void 0),h([p({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),qr(i=>ce(kp(i),-180,180))],Mu.prototype,"tilt",void 0),h([p({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],Mu.prototype,"fov",void 0),Mu=h([D("esri.Camera")],Mu);const al=Mu;var D3;let _p=D3=class extends mt{constructor(i){super(i),this.rotation=0,this.scale=0,this.targetGeometry=null,this.camera=null}castRotation(i){return(i%=360)<0&&(i+=360),i}clone(){return new D3({rotation:this.rotation,scale:this.scale,targetGeometry:y(this.targetGeometry)?this.targetGeometry.clone():null,camera:y(this.camera)?this.camera.clone():null})}};function FA(){return{enabled:!this.camera}}h([p({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:FA}}}}})],_p.prototype,"rotation",void 0),h([qr("rotation")],_p.prototype,"castRotation",null),h([p({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:FA}}}}})],_p.prototype,"scale",void 0),h([p({types:b7,json:{read:AE,write:!0,origins:{"web-scene":{read:AE,write:{overridePolicy:FA}}}}})],_p.prototype,"targetGeometry",void 0),h([p({type:al,json:{write:!0}})],_p.prototype,"camera",void 0),_p=D3=h([D("esri.Viewpoint")],_p);const rr=_p,LS={widthBreakpoint:{getValue(i){const e=i.viewSize[0],t=i.breakpoints,r=this.values;return e<=t.xsmall?r.xsmall:e<=t.small?r.small:e<=t.medium?r.medium:e<=t.large?r.large:r.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(i){const e=i.viewSize[1],t=i.breakpoints,r=this.values;return e<=t.xsmall?r.xsmall:e<=t.small?r.small:e<=t.medium?r.medium:e<=t.large?r.large:r.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(i){const e=i.viewSize,t=e[0],r=e[1],n=this.values;return r>=t?n.portrait:n.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},NA={xsmall:544,small:768,medium:992,large:1200};function uhe(i){const e=i;return e&&e.xsmall<e.small&&e.small<e.medium&&e.medium<e.large}function kA(i,e){return e?LS[i].valueToClassName[e].split(" "):[]}const Dq=i=>{let e=class extends i{constructor(...t){super(...t),this._breakpointsHandles=new Ft,this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=NA}initialize(){this._breakpointsHandles.add(z(()=>[this.breakpoints,this.size],()=>this._updateClassNames(),Qe))}destroy(){this.destroyed||(this._removeActiveClassNames(),this._breakpointsHandles=Te(this._breakpointsHandles))}set breakpoints(t){if(t===this._get("breakpoints"))return;const r=uhe(t);if(!r){const n=JSON.stringify(NA,null,2);console.warn("provided breakpoints are not valid, using defaults:"+n)}t=r?t:NA,this._set("breakpoints",{...t})}_updateClassNames(){if(!this.container)return;const t=oT.acquire(),r=oT.acquire();let n,s=!1;for(n in LS){const a=this[n],o=LS[n].getValue({viewSize:this.size,breakpoints:this.breakpoints});a!==o&&(s=!0,this[n]=o,kA(n,a).forEach(l=>r.push(l)),kA(n,o).forEach(l=>t.push(l)))}s&&(this._applyClassNameChanges(t,r),oT.release(t),oT.release(r))}_applyClassNameChanges(t,r){const n=this.container;n&&(r.forEach(s=>n.classList.remove(s)),t.forEach(s=>n.classList.add(s)))}_removeActiveClassNames(){const t=this.container;if(!t)return;let r;for(r in LS)kA(r,this[r]).forEach(n=>t.classList.remove(n))}};return h([p()],e.prototype,"breakpoints",null),h([p()],e.prototype,"orientation",void 0),h([p()],e.prototype,"widthBreakpoint",void 0),h([p()],e.prototype,"heightBreakpoint",void 0),e=h([D("esri.views.BreakpointsOwner")],e),e};let yp=class extends ue{constructor(){super(...arguments),this.items=new pt,this._watchUpdatingTracking=new mv,this._callbacks=new Map,this._projector=aI(),this._hiddenProjector=aI()}get needsRender(){return this.items.length>0}get updating(){var e;return((e=this._watchUpdatingTracking)==null?void 0:e.updating)??!1}initialize(){const e=document.createElement("div");e.className="esri-overlay-surface",this._set("surface",e),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),e.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange(()=>this.items,t=>{for(const r of t.added){const n=()=>r.render();this._callbacks.set(r,n),this._projector.append(this.surface,n)}for(const r of t.removed){const n=this._projector.detach(this._callbacks.get(r));this.surface.removeChild(n.domNode),this._callbacks.delete(r)}})}addItem(e){this.items.add(e)}removeItem(e){this.items.remove(e)}destroy(){this.items.removeAll(),this._callbacks.forEach(e=>this._projector.detach(e)),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}render(){this._projector.renderNow()}computeBoundingRect(e){const t=this._hiddenSurface,r=this._hiddenProjector;let n=null;const s=()=>(n=e.render(),n);r.append(t,s),r.renderNow();const a={left:0,top:0,right:0,bottom:0};if(n&&n.domNode){const o=n.domNode.getBoundingClientRect();a.left=o.left,a.top=o.top,a.right=o.right,a.bottom=o.bottom}for(r.detach(s);t.firstChild;)t.removeChild(t.firstChild);return a}overlaps(e,t){const r=this.computeBoundingRect(e),n=this.computeBoundingRect(t);return Math.max(r.left,n.left)<=Math.min(r.right,n.right)&&Math.max(r.top,n.top)<=Math.min(r.bottom,n.bottom)}get hasVisibleItems(){return this.items.some(e=>e.visible)}async prepare(){await document.fonts.load(this._fontString()).catch(()=>{})}renderCanvas(e){if(!this.items.some(r=>r.visible))return;const t=e.getContext("2d");t.save(),t.font=this._fontString(),this.items.forEach(r=>{t.save(),r.renderCanvas(t),t.restore()}),t.restore()}_fontString(){return`10px ${getComputedStyle(this.surface).fontFamily}`}};h([p({readOnly:!0})],yp.prototype,"surface",void 0),h([p({readOnly:!0})],yp.prototype,"items",void 0),h([p({readOnly:!0})],yp.prototype,"needsRender",null),h([p({readOnly:!0})],yp.prototype,"_watchUpdatingTracking",void 0),h([p({readOnly:!0})],yp.prototype,"updating",null),yp=h([D("esri.views.overlay.ViewOverlay")],yp);const b9=yp;function M0(i,e,t,r){let n=null,s=1e3;typeof e=="number"?(s=e,r=t):(n=e??null,s=t);let a,o=0;const l=()=>{o=0,i.apply(r,a)},c=(...u)=>{n&&n.apply(r,u),a=u,s?o||(o=setTimeout(l,s)):l()};return c.remove=()=>{o&&(clearTimeout(o),o=0)},c.forceUpdate=()=>{o&&(clearTimeout(o),l())},c.hasPendingUpdates=()=>!!o,c}function dhe(i,e,t){return i.units[e][t]}function rR(i,e,t,r=2,n="abbr"){return`${xP(e,{minimumFractionDigits:r,maximumFractionDigits:r,signDisplay:e>0?"never":"exceptZero"})} ${dhe(i,t,n)}`}function X4e(i,e,t,r=2,n="abbr"){const s=wte(e,t);return rR(i,wP(e,t,s),s,r,n)}function Q4e(i,e,t,r=2,n="abbr"){const s=xte(e,t);return rR(i,wP(e,t,s),s,r,n)}function Z4e(i,e,t,r=2,n="abbr"){const s=Tte(e,t);return rR(i,wP(e,t,s),s,r,n)}function Y4e(i,e,t,r=2,n="abbr"){const s=Cte(e,t);return rR(i,wP(e,t,s),s,r,n)}const w9=["B","kB","MB","GB","TB"];function phe(i,e){let t=e===0?0:Math.floor(Math.log(e)/Math.log(oI.KILOBYTES));t=ce(t,0,w9.length-1);const r=xP(e/oI.KILOBYTES**t,{maximumFractionDigits:2});return z0(i.units.bytes[w9[t]],{fileSize:r})}const mhe="esri.widgets.Feature.support.featureUtils",x9=J.getLogger(mhe),fhe=/href=(""|'')/gi,ghe=/(\{([^\{\r\n]+)\})/g,_he=/\'/g,Fq=/^\s*expression\//i,yhe=/(\n)/gi,vhe=/[\u00A0-\u9999<>\&]/gim,bhe=/href\s*=\s*(?:\"([^\"]+)\"|\'([^\']+)\')/gi,whe=/^(?:mailto:|tel:)/,Nq="relationships/",F3=O7("short-date-short-time");function kq(i){if(!S(i))return i.get("sourceLayer")||i.get("layer")}async function v2(i,e){return typeof i=="function"?i.call(null,e):i}function Vq(i=""){if(i)return!whe.test(i.trim().toLowerCase())}function qF(i){return!!i&&Fq.test(i)}function xhe(i,e){if(!qF(e)||!i)return null;const t=e.replace(Fq,"").toLowerCase();let r;return i.some(n=>n.name.toLowerCase()===t&&(r=n,!0)),r}function Uq(i,e){const t=xhe(e,i==null?void 0:i.fieldName);return t?t.title||null:i?i.label||i.fieldName:null}function The(i,e){const t=e.get(i.toLowerCase());return`{${t&&t.fieldName||i}}`}function Che(i){return i.replace(fhe,"")}function Zw(i,e){const t=WF(e,i);return t?t.name:i}function She(i,e){return i&&i.map(t=>Zw(t,e))}function WF(i,e){return i&&typeof i.getField=="function"?i.getField(e):null}function zq(i){return`${i}`.trim()}function sg({attributes:i,globalAttributes:e,layer:t,text:r,expressionAttributes:n,fieldInfoMap:s}){return r?N3({formattedAttributes:e,template:Ahe(r,{...e,...n,...i},t),fieldInfoMap:s}):""}function N3({formattedAttributes:i,template:e,fieldInfoMap:t}){return zq(Che(z0(z0(e,r=>The(r,t)),i)))}function Ehe(i,e,t=!1){const r=e[i];if(typeof r=="string"){const n="%27",s=(t?encodeURIComponent(r):r).replace(_he,n);e[i]=s}}function Phe(i,e=!1){const t={...i};return Object.keys(t).forEach(r=>Ehe(r,t,e)),t}function Rhe(i,e,t){const r=(e=zq(e))&&e[0]!=="{";return z0(i,Phe(t,r))}function k3(i,e){return i.replace(ghe,(t,r,n)=>{const s=WF(e,n);return s?`{${s.name}}`:r})}function Ahe(i,e,t){const r=k3(i,t);return r&&r.replace(bhe,(n,s,a)=>Rhe(n,s||a,e))}function Ohe(i,e){if(typeof i=="string"&&e&&e.dateFormat==null&&(e.places!=null||e.digitSeparator!=null)){const t=Number(i);if(!isNaN(t))return t}return i}function Mhe(i){return(i==null?void 0:i.type)==="feature"}function T9(i){return!!(i!=null&&i.layer)}function Ihe(i){return(i==null?void 0:i.type)==="map-image"}function Lhe(i,e){var c;const t=e.fieldInfos,r=e.fieldName,n=(c=Bq(t,r))==null?void 0:c.clone(),s=e.preventPlacesFormatting,a=e.layer,o=WF(a,r);if(n&&(o==null?void 0:o.type)==="date"){const u=n.format||new Ite;u.dateFormat=u.dateFormat||"short-date-short-time",u.dateTimeFormatOptions=!T9(a)&&Mhe(a)&&a.datesInUnknownTimezone||T9(a)&&Ihe(a.layer)&&a.layer.datesInUnknownTimezone?{timeZone:"UTC"}:null,n.format=u}const l=n&&n.format;return typeof i=="string"&&Ote(r)&&l?l.formatRasterPixelValue(i):typeof(i=Ohe(i,l))=="string"||i==null||l==null?qx(i):s?xP(i,{...Pte(l),minimumFractionDigits:0,maximumFractionDigits:20}):l.format(i)}function Bq(i,e){if(!i||!i.length||!e)return;const t=e.toLowerCase();let r;return i.some(n=>!(!n.fieldName||n.fieldName.toLowerCase()!==t)&&(r=n,!0)),r}function $he({fieldName:i,graphic:e,layer:t}){if(ld(i)||!t||typeof t.getFeatureType!="function")return null;const{typeIdField:r}=t;if(!r||i!==r)return null;const n=t.getFeatureType(e);return n?n.name:null}function Dhe({fieldName:i,value:e,graphic:t,layer:r}){if(ld(i)||!r||typeof r.getFieldDomain!="function")return null;const n=r.getFieldDomain(i,{feature:t});return n&&n.type==="coded-value"?n.getName(e):null}function Fhe(i,e){const{creatorField:t,creationDateField:r,editorField:n,editDateField:s}=i;if(!e)return;const a=e[s];if(typeof a=="number"){const l=e[n];return{type:"edit",date:LE(a,F3),user:l}}const o=e[r];if(typeof o=="number"){const l=e[t];return{type:"create",date:LE(o,F3),user:l}}return null}function Nhe(i,e){const t=new Map;return i&&i.forEach(r=>{const n=Zw(r.fieldName,e);r.fieldName=n,t.set(n.toLowerCase(),r)}),t}function C9(i){const e=[];if(!i)return e;const{fieldInfos:t,content:r}=i;return t&&e.push(...t),r&&Array.isArray(r)&&r.forEach(n=>{if(n.type==="fields"){const s=n&&n.fieldInfos;s&&e.push(...s)}}),e}function XF(i){return i.replace(vhe,e=>`&#${e.charCodeAt(0)};`)}function qx(i){return typeof i=="string"?i.replace(yhe,'<br class="esri-text-new-line" />'):i}function Gq(i){const{value:e,fieldName:t,fieldInfos:r,fieldInfoMap:n,layer:s,graphic:a}=i;if(e==null)return"";const o=Dhe({fieldName:t,value:e,graphic:a,layer:s});if(o)return o;const l=$he({fieldName:t,graphic:a,layer:s});if(l)return l;if(n.get(t.toLowerCase()))return Lhe(e,{fieldInfos:r||Array.from(n.values()),fieldName:t,layer:s});const c=s&&s.fieldsIndex;return c&&c.isDateField(t)?LE(e,F3):qx(e)}function VA({fieldInfos:i,attributes:e,layer:t,graphic:r,fieldInfoMap:n,relatedInfos:s}){const a={};return s==null||s.forEach(o=>Bhe({attributes:a,relatedInfo:o,fieldInfoMap:n,fieldInfos:i,layer:t})),Object.keys(e).forEach(o=>{const l=e[o];a[o]=Gq({fieldName:o,fieldInfos:i,fieldInfoMap:n,layer:t,value:l,graphic:r})}),a}async function khe(i,e){var u,d;const{layer:t,graphic:r,outFields:n,objectIds:s,returnGeometry:a,spatialReference:o}=i,l=s[0];if(typeof l!="number"&&typeof l!="string"){const m="Could not query required fields for the specified feature. The feature's ID is invalid.",f={layer:t,graphic:r,objectId:l,requiredFields:n};return x9.warn(m,f),null}if(!((d=(u=t.capabilities)==null?void 0:u.operations)!=null&&d.supportsQuery)){const m="The specified layer cannot be queried. The following fields will not be available.",f={layer:t,graphic:r,requiredFields:n,returnGeometry:a};return x9.warn(m,f),null}const c=t.createQuery();return c.objectIds=s,c.outFields=n!=null&&n.length?n:[t.objectIdField],c.returnGeometry=!!a,c.returnZ=!!a,c.returnM=!!a,c.outSpatialReference=o,(await t.queryFeatures(c,e)).features[0]}async function Vhe(i){var r;if(!((r=i.expressionInfos)!=null&&r.length))return!1;const e=await iD(),{arcadeUtils:{hasGeometryFunctions:t}}=e;return t(i)}async function Uhe({graphic:i,popupTemplate:e,layer:t,spatialReference:r},n){if(!t||!e||(typeof t.load=="function"&&await t.load(n),!i.attributes))return;const s=i.attributes[t.objectIdField];if(s==null)return;const a=[s],o=await e.getRequiredFields(t.fieldsIndex),l=Ate(o,i),c=l?[]:o,u=e.returnGeometry||await Vhe(e);if(l&&!u)return;const d=await khe({layer:t,graphic:i,outFields:c,objectIds:a,returnGeometry:u,spatialReference:r},n);d&&(d.geometry&&(i.geometry=d.geometry),d.attributes&&(i.attributes={...i.attributes,...d.attributes}))}function ld(i=""){return!!i&&i.includes(Nq)}function zhe(i){return i?`${Nq}${i.layerId}/${i.fieldName}`:""}function S9({attributes:i,graphic:e,relatedInfo:t,fieldInfos:r,fieldInfoMap:n,layer:s}){i&&e&&t&&Object.keys(e.attributes).forEach(a=>{const o=zhe({layerId:t.relation.id.toString(),fieldName:a}),l=e.attributes[a];i[o]=Gq({fieldName:o,fieldInfos:r,fieldInfoMap:n,layer:s,value:l,graphic:e})})}function Bhe({attributes:i,relatedInfo:e,fieldInfoMap:t,fieldInfos:r,layer:n}){i&&e&&(e.relatedFeatures&&e.relatedFeatures&&e.relatedFeatures.forEach(s=>S9({attributes:i,graphic:s,relatedInfo:e,fieldInfoMap:t,fieldInfos:r,layer:n})),e.relatedStatsFeatures&&e.relatedStatsFeatures&&e.relatedStatsFeatures.forEach(s=>S9({attributes:i,graphic:s,relatedInfo:e,fieldInfoMap:t,fieldInfos:r,layer:n})))}const E9=i=>{if(!i)return!1;const e=i.toUpperCase();return e.includes("CURRENT_TIMESTAMP")||e.includes("CURRENT_DATE")||e.includes("CURRENT_TIME")},Hq=({layer:i,method:e,query:t,definitionExpression:r})=>{var a,o;if(!((o=(a=i.capabilities)==null?void 0:a.query)!=null&&o.supportsCacheHint)||e==="attachments")return;const n=y(t.where)&&t.where,s=y(t.geometry)&&t.geometry;E9(r)||E9(n)||(s==null?void 0:s.type)==="extent"||t.resultType==="tile"||(t.cacheHint=!0)},Ghe=({query:i,layer:e,method:t})=>{Hq({layer:e,method:t,query:i,definitionExpression:`${e.definitionExpression} ${e.serviceDefinitionExpression}`})},Hhe=({queryPayload:i,layer:e,method:t})=>{Hq({layer:e,method:t,query:i,definitionExpression:`${e.definitionExpression} ${e.serviceDefinitionExpression}`})};function jhe(i,e,t){return i&&e&&t?P9(i.allLayers,e,t)||P9(i.allTables,e,t):null}function P9(i,e,t){return i.find(r=>r!==e&&r.type==="feature"&&r.url===e.url&&r.layerId===t.relatedTableId)}const R9={editing:!1,operations:{add:!0,update:!0,delete:!0}},jq=pt.ofType(Rte);let Ha=class extends ue{constructor(e){super(e),this._getAttachmentsPromise=null,this._attachmentLayer=null,this.abilities={...R9},this.activeAttachmentInfo=null,this.activeFileInfo=null,this.attachmentInfos=new jq,this.fileInfos=new pt,this.graphic=null,this.mode="view",this.filesEnabled=!1,this.addHandles(z(()=>this.graphic,()=>this._graphicChanged(),Qe))}destroy(){this._attachmentLayer=null,this.graphic=null}castAbilities(e){return{...R9,...e}}get state(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}get supportsResizeAttachments(){const{graphic:e}=this;if(!e)return!1;const t=e.layer||e.sourceLayer;return(t==null?void 0:t.loaded)&&"capabilities"in t&&"operations"in t.capabilities&&"supportsResizeAttachments"in t.capabilities.operations&&t.capabilities.operations.supportsResizeAttachments||!1}async getAttachments(){const{_attachmentLayer:e,attachmentInfos:t}=this;if(!e||typeof e.queryAttachments!="function")throw new K("invalid-layer","getAttachments(): A valid layer is required.");const r=this._getObjectId(),n=new u5({objectIds:[r],returnMetadata:!0}),s=[],a=e.queryAttachments(n).then(l=>l[r]||s).catch(()=>s);this._getAttachmentsPromise=a,this.notifyChange("state");const o=await a;return t.removeAll(),o.length&&t.addMany(o),this._getAttachmentsPromise=null,this.notifyChange("state"),o}async addAttachment(e,t=this.graphic){const{_attachmentLayer:r,attachmentInfos:n,abilities:s}=this;if(!t)throw new K("invalid-graphic","addAttachment(): A valid graphic is required.",{graphic:t});if(!e)throw new K("invalid-attachment","addAttachment(): An attachment is required.",{attachment:e});if(!s.operations.add)throw new K("invalid-abilities","addAttachment(): add abilities are required.");if(!r||typeof r.addAttachment!="function")throw new K("invalid-layer","addAttachment(): A valid layer is required.");const a=r.addAttachment(t,e).then(l=>this._queryAttachment(l.objectId,t)),o=await a;return n.add(o),o}async deleteAttachment(e){const{_attachmentLayer:t,attachmentInfos:r,graphic:n,abilities:s}=this;if(!e)throw new K("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:e});if(!s.operations.delete)throw new K("invalid-abilities","deleteAttachment(): delete abilities are required.");if(!t||typeof t.deleteAttachments!="function")throw new K("invalid-layer","deleteAttachment(): A valid layer is required.");const a=t.deleteAttachments(n,[e.id]).then(()=>e),o=await a;return r.remove(o),o}async updateAttachment(e,t=this.activeAttachmentInfo){const{_attachmentLayer:r,attachmentInfos:n,graphic:s,abilities:a}=this;if(!e)throw new K("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:e});if(!t)throw new K("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:t});if(!a.operations.update)throw new K("invalid-abilities","updateAttachment(): Update abilities are required.");const o=n.findIndex(u=>u===t);if(!r||typeof r.updateAttachment!="function")throw new K("invalid-layer","updateAttachment(): A valid layer is required.");const l=r.updateAttachment(s,t.id,e).then(u=>this._queryAttachment(u.objectId)),c=await l;return n.splice(o,1,c),c}async commitFiles(){return await Promise.all(this.fileInfos.items.map(e=>this.addAttachment(e.form))),this.fileInfos.removeAll(),this.getAttachments()}addFile(e,t){if(!e||!t)return null;const r={file:e,form:t};return this.fileInfos.add(r),r}updateFile(e,t,r=this.activeFileInfo){if(!e||!t||!r)return null;const n=this.fileInfos.findIndex(s=>r===s);return n>-1&&this.fileInfos.splice(n,1,{file:e,form:t}),this.fileInfos.items[n]}deleteFile(e){const t=this.fileInfos.find(r=>r.file===e);return this.fileInfos.remove(t)??null}async _queryAttachment(e,t){if(!e)throw new K("invalid-attachment-id","Could not query attachment.");const{_attachmentLayer:r}=this,n=this._getObjectId(t),s=new u5({objectIds:[n],attachmentsWhere:`AttachmentId=${e}`,returnMetadata:!0});return r.queryAttachments(s).then(a=>a[n][0])}_getObjectId(e=this.graphic){return(e==null?void 0:e.getObjectId())??null}_graphicChanged(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch(()=>{}))}_setAttachmentLayer(){const{graphic:e}=this,t=kq(e);this._attachmentLayer=t?t.type==="scene"&&y(t.associatedLayer)?t.associatedLayer:t:null}};h([p()],Ha.prototype,"abilities",void 0),h([qr("abilities")],Ha.prototype,"castAbilities",null),h([p()],Ha.prototype,"activeAttachmentInfo",void 0),h([p()],Ha.prototype,"activeFileInfo",void 0),h([p({readOnly:!0,type:jq})],Ha.prototype,"attachmentInfos",void 0),h([p()],Ha.prototype,"fileInfos",void 0),h([p({type:jc})],Ha.prototype,"graphic",void 0),h([p()],Ha.prototype,"mode",void 0),h([p({readOnly:!0})],Ha.prototype,"state",null),h([p()],Ha.prototype,"filesEnabled",void 0),h([p({readOnly:!0})],Ha.prototype,"supportsResizeAttachments",null),Ha=h([D("esri.widgets.Attachments.AttachmentsViewModel")],Ha);const QF=Ha;function A9(i){const e=i.toLowerCase();return e==="image/bmp"||e==="image/emf"||e==="image/exif"||e==="image/gif"||e==="image/x-icon"||e==="image/jpeg"||e==="image/png"||e==="image/tiff"||e==="image/x-wmf"}function qhe(i){const e=cI("esri/themes/base/images/files/");return i?i==="text/plain"?`${e}text-32.svg`:i==="application/pdf"?`${e}pdf-32.svg`:i==="text/csv"?`${e}csv-32.svg`:i==="application/gpx+xml"?`${e}gpx-32.svg`:i==="application/x-dwf"?`${e}cad-32.svg`:i==="application/postscript"||i==="application/json"||i==="text/xml"||i==="model/vrml"?`${e}code-32.svg`:i==="application/x-zip-compressed"||i==="application/x-7z-compressed"||i==="application/x-gzip"||i==="application/x-tar"||i==="application/x-gtar"||i==="application/x-bzip2"||i==="application/gzip"||i==="application/x-compress"||i==="application/x-apple-diskimage"||i==="application/x-rar-compressed"||i==="application/zip"?`${e}zip-32.svg`:i.includes("image/")?`${e}image-32.svg`:i.includes("audio/")?`${e}sound-32.svg`:i.includes("video/")?`${e}video-32.svg`:i.includes("msexcel")||i.includes("ms-excel")||i.includes("spreadsheetml")?`${e}excel-32.svg`:i.includes("msword")||i.includes("ms-word")||i.includes("wordprocessingml")?`${e}word-32.svg`:i.includes("powerpoint")||i.includes("presentationml")?`${e}report-32.svg`:`${e}generic-32.svg`:`${e}generic-32.svg`}const O9={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},xe={base:"esri-attachments",loaderContainer:"esri-attachments__loader-container",loader:"esri-attachments__loader",fadeIn:"esri-attachments--fade-in",container:"esri-attachments__container",containerList:"esri-attachments__container--list",containerPreview:"esri-attachments__container--preview",actions:"esri-attachments__actions",deleteButton:"esri-attachments__delete-button",addAttachmentButton:"esri-attachments__add-attachment-button",errorMessage:"esri-attachments__error-message",items:"esri-attachments__items",item:"esri-attachments__item",itemButton:"esri-attachments__item-button",itemMask:"esri-attachments__item-mask",itemMaskIcon:"esri-attachments__item-mask--icon",itemImage:"esri-attachments__image",itemImageResizable:"esri-attachments__image--resizable",itemLabel:"esri-attachments__label",itemFilename:"esri-attachments__filename",itemChevronIcon:"esri-attachments__item-chevron-icon",itemLink:"esri-attachments__item-link",itemLinkOverlay:"esri-attachments__item-link-overlay",itemLinkOverlayIcon:"esri-attachments__item-link-overlay-icon",itemEditIcon:"esri-attachments__item-edit-icon",itemAddIcon:"esri-attachments__item-add-icon",itemAddButton:"esri-attachments__item-add-button",formNode:"esri-attachments__form-node",fileFieldset:"esri-attachments__file-fieldset",fileLabel:"esri-attachments__file-label",fileName:"esri-attachments__file-name",fileInput:"esri-attachments__file-input",metadata:"esri-attachments__metadata",metadataFieldset:"esri-attachments__metadata-fieldset",progressBar:"esri-attachments__progress-bar",esriWidget:"esri-widget",esriButton:"esri-button",buttonDisabled:"esri-button--disabled",esriButtonSecondary:"esri-button--secondary",esriButtonTertiary:"esri-button--tertiary",esriButtonThird:"esri-button--third",esriButtonSmall:"esri-button--small",esriButtonHalf:"esri-button--half",empty:"esri-widget__content--empty",iconExternalLink:"esri-icon-link-external",iconEdit:"esri-icon-edit",iconRight:"esri-icon-right",iconLeft:"esri-icon-left",iconPlus:"esri-icon-plus"},UA=window.CSS;let ks=class extends Hn{constructor(e,t){super(e,t),this.displayType="auto",this.messages=null,this.messagesUnits=null,this.selectedFile=null,this.submitting=!1,this.viewModel=new QF,this.visibleElements={...O9},this._supportsImageOrientation=UA&&UA.supports&&UA.supports("image-orientation","from-image"),this._addAttachmentForm=null,this._updateAttachmentForm=null}initialize(){this.addHandles([wr(()=>{var e;return(e=this.viewModel)==null?void 0:e.attachmentInfos},"change",()=>this.scheduleRender()),wr(()=>{var e;return(e=this.viewModel)==null?void 0:e.fileInfos},"change",()=>this.scheduleRender()),z(()=>{var e;return(e=this.viewModel)==null?void 0:e.mode},()=>this._modeChanged(),Qe)])}loadDependencies(){return Promise.all([G(()=>import("./calcite-icon-938ab0b8.js"),["assets/calcite-icon-938ab0b8.js","assets/icon-40b00e67.js","assets/widget-fb292a2f.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/intl-65a3e389.js","assets/number-27cf8195.js","assets/jsonMap-7b8332c9.js","assets/locale-30120714.js","assets/messages-2289086c.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/assets-8d3e737a.js","assets/Evented-a45c8b0f.js","assets/Promise-376ab9f6.js","assets/reactiveUtils-4dabbb80.js","assets/uuid-73213768.js","assets/observers-edc9938f.js"])])}get abilities(){return this.viewModel.abilities}set abilities(e){this.viewModel.abilities=e}get effectiveDisplayType(){const{displayType:e}=this;return e&&e!=="auto"?e:this.viewModel.supportsResizeAttachments?"preview":"list"}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}castVisibleElements(e){return{...O9,...e}}addAttachment(){const{_addAttachmentForm:e,viewModel:t}=this;return this._set("submitting",!0),this._set("error",null),t.addAttachment(e).then(r=>(this._set("submitting",!1),this._set("error",null),t.mode="view",r)).catch(r=>{throw this._set("submitting",!1),this._set("error",new K("attachments:add-attachment",this.messages.addErrorMessage,r)),r})}deleteAttachment(e){const{viewModel:t}=this;return this._set("submitting",!0),this._set("error",null),t.deleteAttachment(e).then(r=>(this._set("submitting",!1),this._set("error",null),t.mode="view",r)).catch(r=>{throw this._set("submitting",!1),this._set("error",new K("attachments:delete-attachment",this.messages.deleteErrorMessage,r)),r})}updateAttachment(){const{viewModel:e}=this,{_updateAttachmentForm:t}=this;return this._set("submitting",!0),this._set("error",null),e.updateAttachment(t).then(r=>(this._set("submitting",!1),this._set("error",null),e.mode="view",r)).catch(r=>{throw this._set("submitting",!1),this._set("error",new K("attachments:update-attachment",this.messages.updateErrorMessage,r)),r})}addFile(){const e=this.viewModel.addFile(this.selectedFile,this._addAttachmentForm);return this.viewModel.mode="view",e}updateFile(){const{viewModel:e}=this,t=e.updateFile(this.selectedFile,this._updateAttachmentForm,e.activeFileInfo);return e.mode="view",t}deleteFile(e){const t=this.viewModel.deleteFile(e||this.viewModel.activeFileInfo.file);return this.viewModel.mode="view",t}render(){const{submitting:e,viewModel:t}=this,{state:r}=t;return F("div",{class:this.classes(xe.base,xe.esriWidget)},e?this.renderProgressBar():null,r==="loading"?this.renderLoading():this.renderAttachments(),this.renderErrorMessage())}renderErrorMessage(){const{error:e,visibleElements:t}=this;return e&&t.errorMessage?F("div",{key:"error-message",class:xe.errorMessage},e.message):null}renderAttachments(){const{activeFileInfo:e,mode:t,activeAttachmentInfo:r}=this.viewModel;return t==="add"?this.renderAddForm():t==="edit"?this.renderDetailsForm(r||e):this.renderAttachmentContainer()}renderLoading(){return F("div",{class:xe.loaderContainer,key:"loader"},F("div",{class:xe.loader}))}renderProgressBar(){return this.visibleElements.progressBar?F("div",{class:xe.progressBar,key:"progress-bar"}):null}renderAddForm(){const{submitting:e,selectedFile:t}=this,r=e||!t,n=this.visibleElements.cancelAddButton?F("button",{type:"button",bind:this,disabled:e,onclick:this._cancelForm,class:this.classes(xe.esriButton,xe.esriButtonTertiary,xe.esriButtonSmall,xe.esriButtonHalf,e&&xe.buttonDisabled)},this.messages.cancel):null,s=this.visibleElements.addSubmitButton?F("button",{type:"submit",disabled:r,class:this.classes(xe.esriButton,xe.esriButtonSecondary,xe.esriButtonSmall,xe.esriButtonHalf,{[xe.buttonDisabled]:r})},this.messages.add):null,a=t?F("span",{key:"file-name",class:xe.fileName},t.name):null,o=F("form",{bind:this,afterCreate:ME,afterRemoved:l5,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},F("fieldset",{class:xe.fileFieldset},a,F("label",{class:this.classes(xe.fileLabel,xe.esriButton,xe.esriButtonSecondary)},t?this.messages.changeFile:this.messages.selectFile,F("input",{class:xe.fileInput,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))),s,n);return F("div",{key:"add-form-container",class:xe.formNode},o)}renderDetailsForm(e){const{visibleElements:t,viewModel:r,selectedFile:n,submitting:s}=this,{abilities:a}=r,o=s||!n;let l,c,u,d;n?(l=n.type,c=n.name,u=n.size):"file"in e?(l=e.file.type,c=e.file.name,u=e.file.size):(l=e.contentType,c=e.name,u=e.size,d=e.url);const m=a.editing&&a.operations.delete&&t.deleteButton?F("button",{key:"delete-button",type:"button",disabled:s,bind:this,onclick:T=>this._submitDeleteAttachment(T,e),class:this.classes(xe.esriButton,xe.esriButtonSmall,xe.esriButtonTertiary,xe.deleteButton,{[xe.buttonDisabled]:s})},this.messages.delete):void 0,f=a.editing&&a.operations.update&&t.updateButton?F("button",{disabled:o,key:"update-button",type:"submit",class:this.classes(xe.esriButton,xe.esriButtonSmall,xe.esriButtonThird,{[xe.buttonDisabled]:o})},this.messages.update):void 0,_=this.visibleElements.cancelUpdateButton?F("button",{disabled:s,key:"cancel-button",type:"button",bind:this,onclick:this._cancelForm,class:this.classes(xe.esriButton,xe.esriButtonSmall,xe.esriButtonTertiary,xe.esriButtonThird,{[xe.buttonDisabled]:s})},this.messages.cancel):void 0,g=a.editing&&a.operations.update?F("fieldset",{key:"file",class:xe.fileFieldset},F("span",{key:"file-name",class:xe.fileName},c),F("label",{class:this.classes(xe.fileLabel,xe.esriButton,xe.esriButtonSecondary)},this.messages.changeFile,F("input",{class:xe.fileInput,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))):void 0,x=F("fieldset",{key:"size",class:xe.metadataFieldset},F("label",null,phe(this.messagesUnits,u))),b=F("fieldset",{key:"content-type",class:xe.metadataFieldset},F("label",null,l)),v=y(d)?F("a",{class:xe.itemLink,href:d,rel:"noreferrer",target:"_blank"},this.renderImageMask(e,400),F("div",{class:xe.itemLinkOverlay},F("span",{class:xe.itemLinkOverlayIcon},F("calcite-icon",{icon:"launch"})))):this.renderImageMask(e,400),w=F("form",{bind:this,afterCreate:ME,afterRemoved:l5,"data-node-ref":"_updateAttachmentForm",onsubmit:T=>this._submitUpdateAttachment(T,e)},F("div",{class:xe.metadata},x,b),g,F("div",{class:xe.actions},m,_,f));return F("div",{key:"edit-form-container",class:xe.formNode},v,w)}renderImageMask(e,t){return"file"in e?this.renderGenericImageMask(e.file.name,e.file.type):this.renderImageMaskForAttachment(e,t)}renderGenericImageMask(e,t){const{supportsResizeAttachments:r}=this.viewModel,n=qhe(t),s={[xe.itemImageResizable]:r};return F("div",{class:this.classes(xe.itemMaskIcon,xe.itemMask)},F("img",{title:e,alt:e,src:n,class:this.classes(s,xe.itemImage)}))}renderImageMaskForAttachment(e,t){const{supportsResizeAttachments:r}=this.viewModel,{contentType:n,name:s,url:a}=e;if(!r||!A9(n))return this.renderGenericImageMask(s,n);const o=this._getCSSTransform(e),l=o?{transform:o,"image-orientation":"none"}:{},c=`${a}${a.includes("?")?"&":"?"}w=${t}`,u={[xe.itemImageResizable]:r};return F("div",{class:this.classes(xe.itemMask)},F("img",{styles:l,alt:s,title:s,src:c,class:this.classes(u,xe.itemImage)}))}renderFile(e){const{file:t}=e;return F("li",{class:xe.item,key:t},F("button",{key:"details-button",bind:this,class:xe.itemButton,title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,onclick:()=>this._startEditFile(e),type:"button"},this.renderImageMask(e),F("label",{class:xe.itemLabel},F("span",{class:xe.itemFilename},t.name||this.messages.noTitle),F("span",{"aria-hidden":"true",class:this.classes(xe.itemChevronIcon,zh(this.container)?xe.iconLeft:xe.iconRight)}))))}renderAttachmentInfo({attachmentInfo:e,displayType:t}){const{viewModel:r,effectiveDisplayType:n}=this,{abilities:s,supportsResizeAttachments:a}=r,{contentType:o,name:l,url:c}=e,u=this.renderImageMask(e,t==="list"?48:400),d=s.editing?F("span",{"aria-hidden":"true",class:this.classes(xe.itemChevronIcon,zh(this.container)?xe.iconLeft:xe.iconRight)}):null,m=[u,n==="preview"&&a&&A9(o)?null:F("label",{class:xe.itemLabel},F("span",{class:xe.itemFilename},l||this.messages.noTitle),d)],f=s.editing?F("button",{key:"details-button",bind:this,class:xe.itemButton,title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,"data-attachment-info-id":e.id,onclick:()=>this._startEditAttachment(e),type:"button"},m):F("a",{key:"details-link",class:xe.itemButton,href:c,target:"_blank"},m);return F("li",{class:xe.item,key:e},f)}renderAttachmentContainer(){const{effectiveDisplayType:e,viewModel:t,visibleElements:r}=this,{attachmentInfos:n,abilities:s,fileInfos:a}=t,o=!!(n!=null&&n.length),l=!!(a!=null&&a.length),c={[xe.containerList]:e!=="preview",[xe.containerPreview]:e==="preview"},u=s.editing&&s.operations.add&&r.addButton?F("button",{bind:this,onclick:()=>this._startAddAttachment(),class:this.classes(xe.esriButton,xe.esriButtonTertiary,xe.addAttachmentButton),type:"button"},F("span",{"aria-hidden":"true",class:this.classes(xe.itemAddIcon,xe.iconPlus)}),this.messages.add):void 0,d=o?F("ul",{key:"attachments-list",class:xe.items},n.toArray().map(_=>this.renderAttachmentInfo({attachmentInfo:_,displayType:e}))):void 0,m=l?F("ul",{key:"file-list",class:xe.items},a.toArray().map(_=>this.renderFile(_))):void 0,f=l||o?void 0:F("div",{class:xe.empty},this.messages.noAttachments);return F("div",{key:"attachments-container",class:this.classes(xe.container,c)},d,m,f,u)}_modeChanged(){this._set("error",null),this._set("selectedFile",null)}_handleFileInputChange(e){const t=e.target,r=t&&t.files&&t.files.item(0);this._set("selectedFile",r)}_submitDeleteAttachment(e,t){e.preventDefault(),"file"in t?this.deleteFile(t.file):this.deleteAttachment(t)}_submitAddAttachment(e){e.preventDefault(),this.viewModel.filesEnabled?this.addFile():this.addAttachment()}_submitUpdateAttachment(e,t){e.preventDefault(),"file"in t?this.updateFile():this.updateAttachment()}_startEditAttachment(e){const{viewModel:t}=this;t.activeFileInfo=null,t.activeAttachmentInfo=e,t.mode="edit"}_startEditFile(e){const{viewModel:t}=this;t.activeAttachmentInfo=null,t.activeFileInfo=e,t.mode="edit"}_startAddAttachment(){this.viewModel.mode="add"}_cancelForm(e){e.preventDefault(),this.viewModel.mode="view"}_getCSSTransform(e){const{orientationInfo:t}=e;return!this._supportsImageOrientation&&t?[t.rotation?`rotate(${t.rotation}deg)`:"",t.mirrored?"scaleX(-1)":""].join(" "):""}};h([p()],ks.prototype,"abilities",null),h([p()],ks.prototype,"displayType",void 0),h([p({readOnly:!0})],ks.prototype,"effectiveDisplayType",null),h([p()],ks.prototype,"graphic",null),h([p()],ks.prototype,"label",null),h([p(),_n("esri/widgets/Attachments/t9n/Attachments")],ks.prototype,"messages",void 0),h([p(),_n("esri/core/t9n/Units")],ks.prototype,"messagesUnits",void 0),h([p({readOnly:!0})],ks.prototype,"selectedFile",void 0),h([p({readOnly:!0})],ks.prototype,"submitting",void 0),h([p({readOnly:!0})],ks.prototype,"error",void 0),h([p({type:QF})],ks.prototype,"viewModel",void 0),h([p()],ks.prototype,"visibleElements",void 0),h([qr("visibleElements")],ks.prototype,"castVisibleElements",null),ks=h([D("esri.widgets.Attachments")],ks);const Whe=ks;let U1=class extends QF{constructor(e){super(e),this.description=null,this.title=null}};h([p()],U1.prototype,"description",void 0),h([p()],U1.prototype,"title",void 0),U1=h([D("esri.widgets.Feature.FeatureAttachments.FeatureAttachmentsViewModel")],U1);const ZF=U1,Xhe={heading:"esri-widget__heading"};function YF(i,e){const t=Qhe(i.level),r=`h${t}`;return delete i.level,F(r,{...i,class:gte(Xhe.heading,i.class),role:"heading","aria-level":String(t)},e)}function Qhe(i){return ce(Math.ceil(i),1,6)}const zA={base:"esri-feature-element-info",title:"esri-feature-element-info__title",description:"esri-feature-element-info__description"};let hy=class extends Hn{constructor(e,t){super(e,t),this.description=null,this.headingLevel=2,this.title=null}render(){return F("div",{class:zA.base},this.renderTitle(),this.renderDescription())}renderTitle(){const{title:e}=this;return e?F(YF,{level:this.headingLevel,class:zA.title},e):null}renderDescription(){const{description:e}=this;return e?F("div",{key:"description",class:zA.description},e):null}};h([p()],hy.prototype,"description",void 0),h([p()],hy.prototype,"headingLevel",void 0),h([p()],hy.prototype,"title",void 0),hy=h([D("esri.widgets.Feature.support.FeatureElementInfo")],hy);const nR=hy,Zhe={base:"esri-feature-attachments"};let ph=class extends Hn{constructor(e,t){super(e,t),this._featureElementInfo=null,this.attachmentsWidget=new Whe,this.headingLevel=2,this.viewModel=new ZF}initialize(){this._featureElementInfo=new nR,this.addHandles([z(()=>{var e,t;return[(e=this.viewModel)==null?void 0:e.description,(t=this.viewModel)==null?void 0:t.title,this.headingLevel]},()=>this._setupFeatureElementInfo(),Qe),z(()=>{var e;return(e=this.viewModel)==null?void 0:e.graphic},e=>this.attachmentsWidget.graphic=e,Qe)])}destroy(){this.attachmentsWidget.destroy(),this._featureElementInfo.destroy()}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get displayType(){return this.attachmentsWidget.displayType}set displayType(e){this.attachmentsWidget.displayType=e}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}render(){var t;const{attachmentsWidget:e}=this;return F("div",{class:Zhe.base},(t=this._featureElementInfo)==null?void 0:t.render(),e==null?void 0:e.render())}_setupFeatureElementInfo(){const{description:e,title:t,headingLevel:r}=this;this._featureElementInfo.set({description:e,title:t,headingLevel:r})}};h([p({readOnly:!0})],ph.prototype,"attachmentsWidget",void 0),h([p()],ph.prototype,"description",null),h([p()],ph.prototype,"displayType",null),h([p()],ph.prototype,"graphic",null),h([p()],ph.prototype,"headingLevel",void 0),h([p()],ph.prototype,"title",null),h([p({type:ZF})],ph.prototype,"viewModel",void 0),ph=h([D("esri.widgets.Feature.FeatureAttachments")],ph);const Yhe=ph;let vp=class extends Lx(ue){constructor(e){super(e),this._loadingPromise=null,this.created=null,this.creator=null,this.destroyer=null,this.graphic=null,this.handles.add(z(()=>this.creator,t=>{this._destroyContent(),this._createContent(t)},Qe))}destroy(){this._destroyContent()}get state(){return this._loadingPromise?"loading":"ready"}_destroyContent(){const{created:e,graphic:t,destroyer:r}=this;e&&(v2(r,{graphic:t}).catch(()=>null),this._set("created",null))}async _createContent(e){const{graphic:t}=this,r=v2(e,{graphic:t}).catch(()=>null);this._loadingPromise=r,this.notifyChange("state");const n=await r;r===this._loadingPromise&&(this._loadingPromise=null,this.notifyChange("state"),this._set("created",n))}};h([p({readOnly:!0})],vp.prototype,"created",void 0),h([p()],vp.prototype,"creator",void 0),h([p()],vp.prototype,"destroyer",void 0),h([p({type:jc})],vp.prototype,"graphic",void 0),h([p({readOnly:!0})],vp.prototype,"state",null),vp=h([D("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")],vp);const b2=vp;function Uo(){return function(i,e){if(!i[e])throw new TypeError(`Cannot auto bind undefined function '${e}'`);return{value:Jhe(i[e])}}}function Khe(i){const{type:e}=i;return i instanceof KeyboardEvent||e==="keyup"||e==="keydown"||e==="keypress"}function Jhe(i){return function(e,...t){Khe(e)?_te(e.key)&&(e.preventDefault(),e.stopPropagation(),e.target.click()):i.call(this,e,...t)}}function eue(i){return e=>{e.hasOwnProperty("_delegatedEventNames")||(e._delegatedEventNames=e._delegatedEventNames?e._delegatedEventNames.slice():[]);const t=e._delegatedEventNames,r=Array.isArray(i)?i:tue(i);t.push(...r)}}function tue(i){return i.split(",").map(e=>e.trim())}const qq="calcite-theme-";function iue(){return getComputedStyle(document.body).getPropertyValue("--esri-calcite-theme-name").replace(/\s|'|"/g,"")}function w2(){return iue().startsWith("dark")}function rue(){return`${qq}${w2()?"dark":"light"}`}function nue(i){sue(i),i.classList.add(rue())}function sue(i){Array.from(i.classList).forEach(e=>{e.startsWith(qq)&&i.classList.remove(e)})}const BA={base:"esri-feature-content",loaderContainer:"esri-feature-content__loader-container",loader:"esri-feature-content__loader"};let uy=class extends Hn{constructor(e,t){super(e,t),this.viewModel=null,this._addTargetToAnchors=r=>{Array.from(r.querySelectorAll("a")).forEach(n=>{Vq(n.href)&&!n.hasAttribute("target")&&n.setAttribute("target","_blank")})}}get creator(){return this.viewModel.creator}set creator(e){this.viewModel.creator=e}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}renderLoading(){return F("div",{class:BA.loaderContainer,key:"loader"},F("div",{class:BA.loader}))}renderCreated(){var t;const e=(t=this.viewModel)==null?void 0:t.created;return e?e instanceof HTMLElement?F("div",{key:e,bind:e,afterCreate:this._attachToNode}):IE(e)?F("div",{key:e},!e.destroyed&&e.render()):F("div",{key:e,innerHTML:e,afterCreate:this._addTargetToAnchors}):null}render(){var t;const e=(t=this.viewModel)==null?void 0:t.state;return F("div",{class:BA.base},e==="loading"?this.renderLoading():this.renderCreated())}_attachToNode(e){const t=this;e.appendChild(t)}};h([p()],uy.prototype,"creator",null),h([p()],uy.prototype,"graphic",null),h([p({type:b2})],uy.prototype,"viewModel",void 0),uy=h([D("esri.widgets.Feature.FeatureContent")],uy);const $S=uy;let Iu=class extends ue{constructor(e){super(e),this.attributes=null,this.expressionInfos=null,this.description=null,this.fieldInfos=null,this.title=null}get formattedFieldInfos(){const{expressionInfos:e,fieldInfos:t}=this,r=[];return t==null||t.forEach(n=>{if(!(!n.hasOwnProperty("visible")||n.visible))return;const s=n.clone();s.label=Uq(s,e),r.push(s)}),r}};h([p()],Iu.prototype,"attributes",void 0),h([p({type:[Lte]})],Iu.prototype,"expressionInfos",void 0),h([p()],Iu.prototype,"description",void 0),h([p({type:[M7]})],Iu.prototype,"fieldInfos",void 0),h([p({readOnly:!0})],Iu.prototype,"formattedFieldInfos",null),h([p()],Iu.prototype,"title",void 0),Iu=h([D("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")],Iu);const sR=Iu,aue=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];function oue(i){let e=null;return aue.some(t=>(t.pattern.test(i)&&(e=t),!!e)),e}function lue(i,e){if(typeof e!="string"||!e)return e;const t=oue(e);if(!t)return e;const r=e.match(t.pattern),n=r&&r[2],s=z0(z0(t.label,{messages:i,hierPart:n}),{appName:t.appName}),a=t.target?` target="${t.target}"`:"",o=t.target==="_blank"?' rel="noreferrer"':"";return e.replace(t.pattern,`<a${a} href="$1"${o}>${s}</a>`)}const qv={base:"esri-feature-fields",fieldHeader:"esri-feature-fields__field-header",fieldData:"esri-feature-fields__field-data",fieldDataDate:"esri-feature-fields__field-data--date",esriTable:"esri-widget__table"};let nc=class extends Hn{constructor(e,t){super(e,t),this._featureElementInfo=null,this.viewModel=new sR,this.messages=null,this.messagesURIUtils=null}initialize(){this._featureElementInfo=new nR,this.addHandles(z(()=>{var e,t;return[(e=this.viewModel)==null?void 0:e.description,(t=this.viewModel)==null?void 0:t.title]},()=>this._setupFeatureElementInfo(),Qe))}destroy(){this._featureElementInfo.destroy()}get attributes(){return this.viewModel.attributes}set attributes(e){this.viewModel.attributes=e}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get expressionInfos(){return this.viewModel.expressionInfos}set expressionInfos(e){this.viewModel.expressionInfos=e}get fieldInfos(){return this.viewModel.fieldInfos}set fieldInfos(e){this.viewModel.fieldInfos=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}renderFieldInfo(e,t){const{attributes:r}=this.viewModel,n=e.fieldName,s=e.label||n,a=r?r[n]==null?"":r[n]:"",o=!(!e.format||!e.format.dateFormat),l=typeof a=="number"&&!o?this._forceLTR(a):lue(this.messagesURIUtils,a),c={[qv.fieldDataDate]:o};return F("tr",{key:`fields-element-info-row-${n}-${t}`},F("th",{key:`fields-element-info-row-header-${n}-${t}`,class:qv.fieldHeader,innerHTML:s}),F("td",{key:`fields-element-info-row-data-${n}-${t}`,class:this.classes(qv.fieldData,c),innerHTML:l}))}renderFields(){const{formattedFieldInfos:e}=this.viewModel;return e!=null&&e.length?F("table",{class:qv.esriTable,summary:this.messages.fieldsSummary},F("tbody",null,e.map((t,r)=>this.renderFieldInfo(t,r)))):null}render(){var e;return F("div",{class:qv.base},(e=this._featureElementInfo)==null?void 0:e.render(),this.renderFields())}_setupFeatureElementInfo(){const{description:e,title:t}=this;this._featureElementInfo.set({description:e,title:t})}_forceLTR(e){return`&lrm;${e}`}};h([p()],nc.prototype,"attributes",null),h([p()],nc.prototype,"description",null),h([p()],nc.prototype,"expressionInfos",null),h([p()],nc.prototype,"fieldInfos",null),h([p()],nc.prototype,"title",null),h([p({type:sR,nonNullable:!0})],nc.prototype,"viewModel",void 0),h([p(),_n("esri/widgets/Feature/t9n/Feature")],nc.prototype,"messages",void 0),h([p(),_n("esri/widgets/support/t9n/uriUtils")],nc.prototype,"messagesURIUtils",void 0),nc=h([D("esri.widgets.Feature.FeatureFields")],nc);const Wq=nc,cue={maximumFractionDigits:20};function hue(i){return xP(i,cue)}const uue="<",due=">",pue=O7("short-date");function mue(i,e,t,r){let n="";e===0?n=`${uue} `:e===t&&(n=`${due} `);let s=null;return s=r?LE(i,pue):hue(i),n+s}const fue=new ei([64,64,64]);function gue(i,e){const t=[],r=i.length-1;return i.length===5?t.push(0,2,4):t.push(0,r),i.map((n,s)=>t.includes(s)?mue(n,s,r,e):null)}async function _ue(i,e,t){let r=!1,n=[],s=[];if(i.stops){const c=i.stops;n=c.map(u=>u.value),r=c.some(u=>!!u.label),r&&(s=c.map(u=>u.label))}const a=n[0],o=n[n.length-1];if(a==null&&o==null)return null;const l=r?null:gue(n,t);return(await Promise.all(n.map(async(c,u)=>({value:c,color:i.type==="opacity"?await yue(c,i,e):(await G(()=>import("./UniqueValueRenderer-08f8851c.js").then(d=>d.v),["assets/UniqueValueRenderer-08f8851c.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/enumeration-3a03bd31.js","assets/jsonMap-7b8332c9.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/geometry-b7901087.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/locale-30120714.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/Clonable-545593ce.js","assets/LegendOptions-010d0873.js","assets/reactiveUtils-4dabbb80.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/number-27cf8195.js","assets/Identifiable-bfe1ff30.js","assets/jsonUtils-229211af.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js"])).getColor(i,c),label:r?s[u]:l[u]})))).reverse()}async function yue(i,e,t=fue){const r=new ei(t),n=(await G(()=>import("./UniqueValueRenderer-08f8851c.js").then(s=>s.v),["assets/UniqueValueRenderer-08f8851c.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/enumeration-3a03bd31.js","assets/jsonMap-7b8332c9.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/geometry-b7901087.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/locale-30120714.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/Clonable-545593ce.js","assets/LegendOptions-010d0873.js","assets/reactiveUtils-4dabbb80.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/number-27cf8195.js","assets/Identifiable-bfe1ff30.js","assets/jsonUtils-229211af.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js"])).getOpacity(e,i);return n!=null&&(r.a=n),r}function vue(i){if(!i.colorStops)return[];const e=[...i.colorStops].filter(r=>{var n;return((n=r.color)==null?void 0:n.a)>0});let t=e.length-1;if(e&&e[0]){const r=e[t];r&&r.ratio!==1&&(e.push(new Yte({ratio:1,color:r.color})),t++)}return e.map((r,n)=>{var a,o;let s="";return n===0?s=((a=i.legendOptions)==null?void 0:a.minLabel)||"low":n===t&&(s=((o=i.legendOptions)==null?void 0:o.maxLabel)||"high"),{color:r.color,label:s,ratio:r.ratio}}).reverse()}J.getLogger("esri.renderers.support.utils");async function To(i,e,t){Jee(i,e,()=>[]).push(...t)}async function bue(i){var t,r;const e=new Map;if(!i)return e;if("visualVariables"in i&&i.visualVariables){const n=i.visualVariables.filter(s=>s.type==="color");for(const s of n){const a=(await _ue(s)).map(o=>o.color);await To(e,s.field||s.valueExpression,a)}}if(i.type==="heatmap"){const n=vue(i).map(s=>s.color);await To(e,i.field||i.valueExpression,n)}else if(i.type==="pie-chart"){for(const n of i.attributes)await To(e,n.field||n.valueExpression,[n.color]);await To(e,"default",[(t=i==null?void 0:i.othersCategory)==null?void 0:t.color,b_(i.backgroundFillSymbol,null)])}else if(i.type==="dot-density"){for(const n of i.attributes)await To(e,n.field||n.valueExpression,[n.color]);await To(e,"default",[i.backgroundColor])}else if(i.type==="unique-value")if(((r=i.authoringInfo)==null?void 0:r.type)==="predominance")for(const n of i.uniqueValueInfos??[])await To(e,n.value.toString(),[b_(n.symbol,null)]);else{const n=(i.uniqueValueInfos??[]).map(c=>b_(c.symbol,null)),{field:s,field2:a,field3:o,valueExpression:l}=i;(s||l)&&await To(e,s||l,n),a&&await To(e,a,n),o&&await To(e,o,n)}else if(i.type==="class-breaks"){const n=i.classBreakInfos.map(o=>b_(o.symbol,null)),{field:s,valueExpression:a}=i;await To(e,s??a,n)}else i.type==="simple"&&await To(e,"default",[b_(i.symbol,null)]);return"defaultSymbol"in i&&i.defaultSymbol&&await To(e,"default",[b_(i.defaultSymbol,null)]),e.forEach((n,s)=>{const a=Px(n.filter(Boolean),(o,l)=>JSON.stringify(o)===JSON.stringify(l));e.set(s,a)}),e}const wue="esri.widgets.Feature.support.relatedFeatureUtils",M9=J.getLogger(wue),I9=new Map;function V3(i){if(!ld(i))return null;const[e,t]=i.split("/").slice(1);return{layerId:e,fieldName:t}}function xue(i,e){if(!e.relationships)return null;let t=null;const{relationships:r}=e;return r.some(n=>n.id===parseInt(i,10)&&(t=n,!0)),t}function Tue({originRelationship:i,relationships:e,layerId:t}){let r;return e&&e.some(n=>(`${n.relatedTableId}`===t&&n.id===i.id&&(r=n),!!r)),r}function Cue(i,e){const t=e.toLowerCase();for(const r in i)if(r.toLowerCase()===t)return i[r];return null}function Sue(i,e){const t=xue(i,e);if(t)return{url:`${e.url}/${t.relatedTableId}`,sourceSpatialReference:e.spatialReference,relation:t,relatedFields:[],outStatistics:[]}}function Eue(i,e){if(!e||!i)return;const{features:t,statsFeatures:r}=i,n=t&&t.value;e.relatedFeatures=n?n.features:[];const s=r&&r.value;e.relatedStatsFeatures=s?s.features:[]}function Pue(i,e,t,r){const n=new lI;return n.outFields=["*"],n.relationshipId=typeof e.id=="number"?e.id:parseInt(e.id,10),n.objectIds=[i.attributes[t.objectIdField]],t.queryRelatedFeatures(n,r)}function Rue(i,e,t){let r=0;const n=[];for(;r<e.length;)n.push(`${i} IN (${e.slice(r,t+r)})`),r+=t;return n.join(" OR ")}async function Aue(i,e,t,r){const n=t.layerId.toString(),{layerInfo:s,relation:a,relatedFields:o,outStatistics:l,url:c,sourceSpatialReference:u}=e,d=Tue({originRelationship:a,relationships:s.relationships,layerId:n});if(d.relationshipTableId&&d.keyFieldInRelationshipTable){const f=(await Pue(i,d,t,r))[i.attributes[t.objectIdField]];if(!f)return null;const _=f.features.map(g=>g.attributes[s.objectIdField]);if((l==null?void 0:l.length)>0&&s.supportsStatistics){const g=new Ob;g.where=Rue(s.objectIdField,_,1e3),g.outFields=o,g.outStatistics=l,g.sourceSpatialReference=u;const x={features:Promise.resolve(f),statsFeatures:JR(c,g)};return Yo(x)}}const m=d==null?void 0:d.keyField;if(m){const f=Mte($ue(s.fields,m)),_=Cue(i.attributes,a.keyField),g=f?`${m}=${_}`:`${m}='${_}'`,x=JR(c,new Ob({where:g,outFields:e.relatedFields,sourceSpatialReference:u}),r),b=e.outStatistics&&e.outStatistics.length>0&&s.supportsStatistics?JR(c,new Ob({where:g,outFields:e.relatedFields,outStatistics:e.outStatistics,sourceSpatialReference:u}),r):null,v={features:x};return b&&(v.statsFeatures=b),Yo(v)}return null}function Oue(i,e){return Wh(i,{query:{f:"json"},signal:e&&e.signal})}function Mue({relatedInfos:i,layer:e},t){const r={};return i.forEach((n,s)=>{const{relation:a}=n;if(!a){const d=new K("relation-required","A relation is required on a layer to retrieve related records.");throw M9.error(d),d}const{relatedTableId:o}=a;if(typeof o!="number"){const d=new K("A related table ID is required on a layer to retrieve related records.");throw M9.error(d),d}const l=`${e.url}/${o}`,c=I9.get(l),u=c||Oue(l,t);c||I9.set(l,u),r[s]=u}),Yo(r)}function Iue({graphic:i,relatedInfos:e,layer:t},r){const n={};return e.forEach((s,a)=>{s.layerInfo&&(n[a]=Aue(i,s,t,r))}),Yo(n)}function Lue({relatedInfo:i,fieldName:e,fieldInfo:t}){if(i.relatedFields.push(e),t.statisticType){const r=new rie({statisticType:t.statisticType,onStatisticField:e,outStatisticFieldName:e});i.outStatistics.push(r)}}function $ue(i,e){if(i!=null){e=e.toLowerCase();for(const t of i)if(t&&t.name.toLowerCase()===e)return t}return null}const L9={chartAnimation:!0};let En=class extends ue{constructor(e){super(e),this.abilities={...L9},this.activeMediaInfoIndex=0,this.attributes=null,this.description=null,this.fieldInfoMap=null,this.formattedAttributes=null,this.expressionAttributes=null,this.layer=null,this.mediaInfos=null,this.popupTemplate=null,this.relatedInfos=null,this.title=null}castAbilities(e){return{...L9,...e}}get activeMediaInfo(){return this.formattedMediaInfos[this.activeMediaInfoIndex]||null}get formattedMediaInfos(){return this._formatMediaInfos()||[]}get formattedMediaInfoCount(){return this.formattedMediaInfos.length}setActiveMedia(e){this._setContentElementMedia(e)}next(){this._pageContentElementMedia(1)}previous(){this._pageContentElementMedia(-1)}_setContentElementMedia(e){const{formattedMediaInfoCount:t}=this,r=(e+t)%t;this.activeMediaInfoIndex=r}_pageContentElementMedia(e){const{activeMediaInfoIndex:t}=this,r=t+e;this._setContentElementMedia(r)}_formatMediaInfos(){const{attributes:e,mediaInfos:t,formattedAttributes:r,expressionAttributes:n,fieldInfoMap:s,layer:a}=this;return t==null?void 0:t.map(o=>{const l=o==null?void 0:o.clone();if(!l)return null;if(l.title=sg({attributes:e,fieldInfoMap:s,globalAttributes:r,expressionAttributes:n,layer:a,text:l.title}),l.caption=sg({attributes:e,fieldInfoMap:s,globalAttributes:r,expressionAttributes:n,layer:a,text:l.caption}),l.altText=sg({attributes:e,fieldInfoMap:s,globalAttributes:r,expressionAttributes:n,layer:a,text:l.altText}),l.type==="image"){const{value:c}=l;return this._setImageValue({value:c,formattedAttributes:r,layer:a}),l.value.sourceURL?l:void 0}if(l.type==="pie-chart"||l.type==="line-chart"||l.type==="column-chart"||l.type==="bar-chart"){const{value:c}=l;return this._setChartValue({value:c,chartType:l.type,attributes:e,formattedAttributes:r,layer:a,expressionAttributes:n}),l}return null}).filter(Boolean)}_setImageValue(e){const{fieldInfoMap:t}=this,{value:r,formattedAttributes:n,layer:s}=e,{linkURL:a,sourceURL:o}=r;if(o){const l=k3(o,s);r.sourceURL=N3({formattedAttributes:n,template:l,fieldInfoMap:t})}if(a){const l=k3(a,s);r.linkURL=N3({formattedAttributes:n,template:l,fieldInfoMap:t})}}_setChartValue(e){const{value:t,attributes:r,formattedAttributes:n,chartType:s,layer:a,expressionAttributes:o}=e,{popupTemplate:l,relatedInfos:c}=this,{fields:u,normalizeField:d}=t;if(t.fields=She(u,a),d&&(t.normalizeField=Zw(d,a)),!u.some(f=>!!(n[f]!=null||ld(f)&&c.size)))return;const m=l==null?void 0:l.fieldInfos;u.forEach(f=>{if(ld(f))return void(t.series=[...t.series,...this._getRelatedChartInfos({fieldInfos:m,fieldName:f,formattedAttributes:n,chartType:s,value:t})]);const _=this._getChartOption({value:t,attributes:r,chartType:s,formattedAttributes:n,expressionAttributes:o,fieldName:f,fieldInfos:m});t.series.push(_)})}_getRelatedChartInfos(e){var g;const{fieldInfos:t,fieldName:r,formattedAttributes:n,chartType:s,value:a}=e,o=[],l=V3(r),{layerId:c,fieldName:u}=l,d=(g=this.relatedInfos)==null?void 0:g.get(c.toString());if(!d)return o;const{relatedFeatures:m,relation:f}=d;if(!f||!m)return o;const{cardinality:_}=f;return m.forEach(x=>{const{attributes:b}=x;b&&Object.keys(b).forEach(v=>{v===u&&o.push(this._getChartOption({value:a,attributes:b,formattedAttributes:n,fieldName:r,chartType:s,relatedFieldName:v,fieldInfos:t}))})}),_==="one-to-many"||_==="many-to-many"?o:[o[0]]}_getTooltip({label:e,value:t,chartType:r}){return r==="pie-chart"?`${e}`:`${e}: ${t}`}_getChartOption(e){var E;const{value:t,attributes:r,formattedAttributes:n,expressionAttributes:s,fieldName:a,relatedFieldName:o,fieldInfos:l,chartType:c}=e,{layer:u,fieldInfoMap:d}=this,{normalizeField:m,tooltipField:f}=t,_=m?ld(m)?r[V3(m).fieldName]:r[m]:null,g=qF(a)&&s&&s[a]!==void 0?s[a]:o&&r[o]!==void 0?r[o]:r[a]!==void 0?r[a]:n[a],x=new $te({fieldName:a,value:g===void 0?null:g&&_?g/_:g});if(ld(a)){const C=d.get(a.toLowerCase()),A=d.get(f.toLowerCase()),M=(C==null?void 0:C.fieldName)??a,I=n[(A==null?void 0:A.fieldName)??f]??(C==null?void 0:C.label)??(C==null?void 0:C.fieldName)??o,L=n[M];return x.tooltip=this._getTooltip({label:I,value:L,chartType:c}),x}const b=Bq(l,a),v=Zw(a,u),w=f&&n[f]!==void 0?n[f]:Uq(b||new M7({fieldName:v}),(E=this.popupTemplate)==null?void 0:E.expressionInfos),T=n[v];return x.tooltip=this._getTooltip({label:w,value:T,chartType:c}),x}};h([p()],En.prototype,"abilities",void 0),h([qr("abilities")],En.prototype,"castAbilities",null),h([p()],En.prototype,"activeMediaInfoIndex",void 0),h([p({readOnly:!0})],En.prototype,"activeMediaInfo",null),h([p()],En.prototype,"attributes",void 0),h([p()],En.prototype,"description",void 0),h([p()],En.prototype,"fieldInfoMap",void 0),h([p()],En.prototype,"formattedAttributes",void 0),h([p()],En.prototype,"expressionAttributes",void 0),h([p({readOnly:!0})],En.prototype,"formattedMediaInfos",null),h([p()],En.prototype,"layer",void 0),h([p({readOnly:!0})],En.prototype,"formattedMediaInfoCount",null),h([p()],En.prototype,"mediaInfos",void 0),h([p()],En.prototype,"popupTemplate",void 0),h([p()],En.prototype,"relatedInfos",void 0),h([p()],En.prototype,"title",void 0),En=h([D("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")],En);const ag=En;var $9=["#ffffff","#858585","#ffbebe","#ffebbe","#ffebaf","#ffffbe","#e9ffbe","#d3ffbe","#beffe8","#bee8ff","#bed2ff","#e8beff","#ffbee8","#ebebeb","#707070","#ff7f7f","#ffa77f","#ffd37f","#ffff73","#d1ff73","#a3ff73","#73ffdf","#73dfff","#73b2ff","#df73ff","#ff73df","#d6d6d6","#5c5c5c","#ff0000","#ff5500","#ffaa00","#ffff00","#aaff00","#55ff00","#00ffc5","#00c5ff","#0070ff","#c500ff","#ff00c5","#c2c2c2","#474747","#e60000","#e64c00","#e69800","#e6e600","#98e600","#4ce600","#00e6a9","#00a9e6","#005ce6","#a900e6","#e600a9","#adadad","#242424","#a80000","#a83800","#a87000","#a8a800","#70a800","#38a800","#00a884","#0084a8","#004da8","#8400a8","#a80084","#999999","#1a1a1a","#730000","#732600","#734c00","#737300","#4c7300","#267300","#00734c","#004c73","#002673","#4c0073","#73004"],Due=[].concat($9.slice(30,39),$9.slice(28,30).reverse()),Fue=[{name:"default",colors:Due},{name:"cat-dark",colors:["#ed5151","#149ece","#a7c636","#9e559c","#fc921f","#ffde3e","#f789d8","#b7814a","#3caf99","#6b6bd6","#b54779","#7f7f7f"]},{name:"tropical-bliss",colors:["#fce138","#ff9399","#fcd27e","#f1983c","#a553b7","#b1a9d0","#6ecffc","#4c81cd","#fc6f84","#fc3e5a","#6af689","#48885c"]},{name:"desert-blooms",colors:["#102432","#144d59","#ffc730","#ed9310","#a64f1b","#661510","#d9351a","#b31515","#4a0932","#8c213f","#18382e","#2c6954"]},{name:"under-the-sea",colors:["#bf9727","#607100","#00734c","#704489","#01acca","#024e76","#f09100","#ea311f","#c6004b","#7570b3","#666666","#333333"]},{name:"vibrant-rainbow",colors:["#fffb00","#f5cb11","#9fd40c","#46e39c","#32b8a6","#7ff2fa","#ac08cc","#dd33ff","#eb7200","#e8a784","#bf2e2e","#6c7000"]},{name:"ocean-bay",colors:["#191921","#11495c","#78b1c2","#454f4b","#8f8f82","#9be0c0","#87b051","#f7ec88","#ebdcc1","#dbb658","#c43541","#75351e"]},{name:"prairie-summer",colors:["#332424","#751555","#d47013","#d68989","#211173","#82aad6","#7bfaeb","#6ec9a8","#6b6408","#eada40","#ccc54a","#1fc235"]},{name:"pastel-chalk",colors:["#fffd99","#f5e6a4","#c1d48c","#b8e3d0","#a0b8b5","#cbf7fa","#d791f2","#dfc1eb","#f2b983","#e8c4b2","#bf8e8e","#94995c"]},{name:"seq-yellow-orange-red-bright",colors:["#910000","#b1260b","#c0370f","#e05919","#ef6a1d","#ff7b22","#ffa143","#ffb454","#ffda74","#ffed85"]},{name:"seq-reds-bright",colors:["#57453b","#7b4238","#9f4036","#c23d33","#d7483c","#ec5244","#f3696c","#f9816c","#ffc4ae","#fff0dc"]},{name:"seq-purples-bright",colors:["#4e465c","#5a4a78","#695291","#775baa","#8663c3","#946bdc","#aa89e8","#c1a6f3","#d7c4ff","#e6e1ff"]},{name:"seq-blues-bright",colors:["#404d54","#435c6c","#48799d","#4b88b6","#4d96ce","#50a5e7","#74bbed","#98d0f3","#bce6f9","#e6faff"]},{name:"seq-greens-bright",colors:["#39544c","#386757","#368165","#359b73","#33b581","#4bc392","#64d2a2","#7ce0b3","#cbf6d9","#f4ffea"]},{name:"seq-browns-bright",colors:["#524834","#715b38","#8f6e3c","#ae8140","#cc9444","#eba748","#eeb664","#f0c47f","#f9e0b7","#fff8eb"]}];const D9="en-us",KF=new Map([["ar",()=>G(()=>import("./ar-7e4d7001.js"),["assets/ar-7e4d7001.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.a)],["bg-bg",()=>G(()=>import("./bg_BG-fa0eaeae.js"),["assets/bg_BG-fa0eaeae.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.b)],["bs-ba",()=>G(()=>import("./bs_BA-4f949e9b.js"),["assets/bs_BA-4f949e9b.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.b)],["ca-es",()=>G(()=>import("./ca_ES-ac250c21.js"),["assets/ca_ES-ac250c21.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.c)],["cs-cz",()=>G(()=>import("./cs_CZ-41aa2dde.js"),["assets/cs_CZ-41aa2dde.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.c)],["da-dk",()=>G(()=>import("./da_DK-3cc83778.js"),["assets/da_DK-3cc83778.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.d)],["de-de",()=>G(()=>import("./de_DE-7cf156b8.js"),["assets/de_DE-7cf156b8.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.d)],["de-ch",()=>G(()=>import("./de_CH-b40119c2.js"),["assets/de_CH-b40119c2.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.d)],["el-gr",()=>G(()=>import("./el_GR-f5b4e421.js"),["assets/el_GR-f5b4e421.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.e)],["en-us",()=>G(()=>import("./en_US-b653138f.js"),["assets/en_US-b653138f.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.e)],["en-ca",()=>G(()=>import("./en_CA-b653138f.js"),["assets/en_CA-b653138f.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.e)],["es-es",()=>G(()=>import("./es_ES-21713ea8.js"),["assets/es_ES-21713ea8.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.e)],["et-ee",()=>G(()=>import("./et_EE-7e4a5525.js"),["assets/et_EE-7e4a5525.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.e)],["fi-fi",()=>G(()=>import("./fi_FI-9ff24319.js"),["assets/fi_FI-9ff24319.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.f)],["fr-fr",()=>G(()=>import("./fr_FR-51c37695.js"),["assets/fr_FR-51c37695.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.f)],["he-il",()=>G(()=>import("./he_IL-5c441159.js"),["assets/he_IL-5c441159.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.h)],["hr-hr",()=>G(()=>import("./hr_HR-f42ffa87.js"),["assets/hr_HR-f42ffa87.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.h)],["hu-hu",()=>G(()=>import("./hu_HU-5fba6ab9.js"),["assets/hu_HU-5fba6ab9.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.h)],["id-id",()=>G(()=>import("./id_ID-981fbb86.js"),["assets/id_ID-981fbb86.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.i)],["it-it",()=>G(()=>import("./it_IT-c635b784.js"),["assets/it_IT-c635b784.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.i)],["ja-jp",()=>G(()=>import("./ja_JP-e2cf7b21.js"),["assets/ja_JP-e2cf7b21.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.j)],["ko-kr",()=>G(()=>import("./ko_KR-32aae4f2.js"),["assets/ko_KR-32aae4f2.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.k)],["lt-lt",()=>G(()=>import("./lt_LT-3c0b9d54.js"),["assets/lt_LT-3c0b9d54.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.l)],["lv-lv",()=>G(()=>import("./lv_LV-c1cc4a4c.js"),["assets/lv_LV-c1cc4a4c.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.l)],["nb-no",()=>G(()=>import("./nb_NO-5958d98d.js"),["assets/nb_NO-5958d98d.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.n)],["nl-nl",()=>G(()=>import("./nl_NL-004b20fd.js"),["assets/nl_NL-004b20fd.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.n)],["pl-pl",()=>G(()=>import("./pl_PL-d6d01c5e.js"),["assets/pl_PL-d6d01c5e.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.p)],["pt-br",()=>G(()=>import("./pt_BR-a08a6ce1.js"),["assets/pt_BR-a08a6ce1.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.p)],["pt-pt",()=>G(()=>import("./pt_PT-d532c840.js"),["assets/pt_PT-d532c840.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.p)],["ro-ro",()=>G(()=>import("./ro_RO-e4007f77.js"),["assets/ro_RO-e4007f77.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.r)],["ru-ru",()=>G(()=>import("./ru_RU-905ac2e8.js"),["assets/ru_RU-905ac2e8.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.r)],["sk-sk",()=>G(()=>import("./sk_SK-cae815ce.js"),["assets/sk_SK-cae815ce.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.s)],["sl-sl",()=>G(()=>import("./sl_SL-50353bbe.js"),["assets/sl_SL-50353bbe.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.s)],["sr-rs",()=>G(()=>import("./sr_RS-9a9b8450.js"),["assets/sr_RS-9a9b8450.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.s)],["sv-se",()=>G(()=>import("./sv_SE-346c1643.js"),["assets/sv_SE-346c1643.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.s)],["th-th",()=>G(()=>import("./th_TH-210af5ed.js"),["assets/th_TH-210af5ed.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.t)],["tr-tr",()=>G(()=>import("./tr_TR-855c517f.js"),["assets/tr_TR-855c517f.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.t)],["uk-ua",()=>G(()=>import("./uk_UA-7de21af4.js"),["assets/uk_UA-7de21af4.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.u)],["vi-vn",()=>G(()=>import("./vi_VN-f87f03fa.js"),["assets/vi_VN-f87f03fa.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.v)],["zh-cn",()=>G(()=>import("./zh_Hans-79f10982.js"),["assets/zh_Hans-79f10982.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.z)],["zh-hk",()=>G(()=>import("./zh_Hant-abc409cd.js"),["assets/zh_Hant-abc409cd.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.z)],["zh-tw",()=>G(()=>import("./zh_Hant-abc409cd.js"),["assets/zh_Hant-abc409cd.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.z)]]);function Nue(i){const e=i.split("-")[0].toLowerCase();let t=null;for(const r of KF.keys())if(r.startsWith(e)){t=r;break}return t}function kue(i){return i?KF.has(i.toLowerCase())?i.toLowerCase():Nue(i)||D9:D9}let C_,Wv;async function Vue(i=mie()){if(i=kue(i),C_&&i===Wv)return C_;C_=G(()=>import("./index-3c8f1bc3.js"),["assets/index-3c8f1bc3.js","assets/_commonjsHelpers-a430e9ea.js"]).then(e=>e.i),Wv=i;try{const[e,t]=await Promise.all([C_,KF.get(Wv)()]);Wv===i&&(e.am4core.options.defaultLocale=t.default),e.am4core.options.suppressWarnings=!0,e.am4core.options.autoDispose=!0}catch{return C_=null,Wv=null,null}return C_}function Uue(i,e="default"){const t=Fue.find(r=>r.name===e);return t?t.colors.map(r=>i.color(r)):null}const xr={base:"esri-feature-media",mediaContainer:"esri-feature-media__container",mediaItemContainer:"esri-feature-media__item-container",mediaItem:"esri-feature-media__item",mediaItemTitle:"esri-feature-media__item-title",mediaItemCaption:"esri-feature-media__item-caption",mediaPrevious:"esri-feature-media__previous",mediaPreviousIconLTR:"esri-feature-media__previous-icon",mediaPreviousIconRTL:"esri-feature-media__previous-icon--rtl",mediaNext:"esri-feature-media__next",mediaNextIconLTR:"esri-feature-media__next-icon",mediaNextIconRTL:"esri-feature-media__next-icon--rtl",mediaChart:"esri-feature-media__chart",mediaButton:"esri-feature-media__button",mediaIcon:"esri-feature-media__icon",iconLeftTriangleArrow:"esri-icon-left-triangle-arrow",iconRightTriangleArrow:"esri-icon-right-triangle-arrow"},GA=.05,HA=.95,jA=15,fu="color",Xd="tooltip",Xv="value",F9="default-line-value";let ja=class extends Hn{constructor(e,t){super(e,t),this._refreshTimer=null,this._refreshIntervalInfo=null,this._featureElementInfo=null,this.viewModel=new ag,this.messages=null,this._getChartDependencies=async r=>{const n=await Vue(),{destroyed:s,viewModel:a}=this;if(s||!a||!r)return;const{activeMediaInfo:o}=a,l=await this._getRendererColors(n);this._renderChart({chartDiv:r,mediaInfo:o,chartsModule:n,colorMap:l})}}initialize(){this._featureElementInfo=new nR,this.addHandles([z(()=>{var e,t;return[(e=this.viewModel)==null?void 0:e.activeMediaInfo,(t=this.viewModel)==null?void 0:t.activeMediaInfoIndex]},()=>this._setupMediaRefreshTimer(),Qe),z(()=>{var e,t;return[(e=this.viewModel)==null?void 0:e.description,(t=this.viewModel)==null?void 0:t.title]},()=>this._setupFeatureElementInfo(),Qe)])}destroy(){this._clearMediaRefreshTimer(),this._featureElementInfo.destroy()}get attributes(){return this.viewModel.attributes}set attributes(e){this.viewModel.attributes=e}get activeMediaInfoIndex(){return this.viewModel.activeMediaInfoIndex}set activeMediaInfoIndex(e){this.viewModel.activeMediaInfoIndex=e}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get fieldInfoMap(){return this.viewModel.fieldInfoMap}set fieldInfoMap(e){this.viewModel.fieldInfoMap=e}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}get mediaInfos(){return this.viewModel.mediaInfos}set mediaInfos(e){this.viewModel.mediaInfos=e}get popupTemplate(){return this.viewModel.popupTemplate}set popupTemplate(e){this.viewModel.popupTemplate=e}get relatedInfos(){return this.viewModel.relatedInfos}set relatedInfos(e){this.viewModel.relatedInfos=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}render(){var e;return F("div",{bind:this,class:xr.base,onkeyup:this._handleMediaKeyup},(e=this._featureElementInfo)==null?void 0:e.render(),this.renderMedia())}renderMedia(){const{formattedMediaInfoCount:e}=this.viewModel;return e?F("div",{key:"media-element-container",class:xr.mediaContainer},this.renderMediaPageButton("previous"),this.renderMediaInfo(),this.renderMediaPageButton("next")):null}renderImageMediaInfo(e){const{_refreshIntervalInfo:t}=this,{activeMediaInfoIndex:r,formattedMediaInfoCount:n}=this.viewModel,{value:s,refreshInterval:a,altText:o,title:l,type:c}=e,{sourceURL:u,linkURL:d}=s,m=Vq(d)?"_blank":"_self",f=m==="_blank"?"noreferrer":"",_=a?t:null,g=_?_.timestamp:0,x=_?_.sourceURL:u,b=F("img",{alt:o||l,key:`media-${c}-${r}-${n}-${g}`,src:x});return(d?F("a",{title:l,href:d,rel:f,target:m},b):null)||b}renderChartMediaInfo(e){const{activeMediaInfoIndex:t,formattedMediaInfoCount:r}=this.viewModel;return F("div",{key:`media-${e.type}-${t}-${r}`,bind:this,class:xr.mediaChart,afterCreate:this._getChartDependencies})}renderMediaInfoType(){const{activeMediaInfo:e}=this.viewModel;return e?e.type==="image"?this.renderImageMediaInfo(e):e.type.includes("chart")?this.renderChartMediaInfo(e):null:null}renderMediaInfo(){const{activeMediaInfo:e}=this.viewModel;if(!e)return null;const t=e.title?F("div",{key:"media-title",class:xr.mediaItemTitle,innerHTML:e.title}):null,r=e.caption?F("div",{key:"media-caption",class:xr.mediaItemCaption,innerHTML:e.caption}):null;return F("div",{key:"media-container",class:xr.mediaItemContainer},F("div",{key:"media-item-container",class:xr.mediaItem},this.renderMediaInfoType()),t,r)}renderMediaPageButton(e){if(this.viewModel.formattedMediaInfoCount<2)return null;const t=e==="previous",r=t?this.messages.previous:this.messages.next,n=t?this.classes(xr.mediaButton,xr.mediaPrevious):this.classes(xr.mediaButton,xr.mediaNext),s=t?this.classes(xr.mediaIcon,xr.mediaPreviousIconLTR,xr.iconLeftTriangleArrow):this.classes(xr.mediaIcon,xr.mediaNextIconLTR,xr.iconRightTriangleArrow),a=t?this.classes(xr.mediaIcon,xr.mediaPreviousIconRTL,xr.iconRightTriangleArrow):this.classes(xr.mediaIcon,xr.mediaNextIconRTL,xr.iconLeftTriangleArrow),o=t?"media-previous":"media-next",l=t?this._previous:this._next;return F("button",{type:"button",key:o,title:r,"aria-label":r,tabIndex:0,class:n,bind:this,onclick:l},F("span",{"aria-hidden":"true",class:s}),F("span",{"aria-hidden":"true",class:a}))}_setupFeatureElementInfo(){const{description:e,title:t}=this;this._featureElementInfo.set({description:e,title:t})}_next(){this.viewModel.next()}_previous(){this.viewModel.previous()}async _getRendererColors(e){var o,l;const{am4core:t}=e,r=new Map,n=(l=(o=this.viewModel)==null?void 0:o.layer)==null?void 0:l.renderer,s="default";if(!n)return r;const a=await bue(n);return a.delete(s),Array.from(a.values()).every(c=>(c==null?void 0:c.length)===1)&&(r.set(F9,t.color({r:50,g:50,b:50,a:1})),Array.from(a.keys()).forEach(c=>{c&&r.set(c,t.color(a.get(c)[0].toCss(!0)))})),r}_handleMediaKeyup(e){const t=Ol(e);t==="ArrowLeft"&&(e.stopPropagation(),this.viewModel.previous()),t==="ArrowRight"&&(e.stopPropagation(),this.viewModel.next())}_renderChart(e){const{abilities:t}=this.viewModel,{chartsModule:r,chartDiv:n,mediaInfo:s,colorMap:a}=e,{value:o,type:l}=s,{am4core:c}=r,u=Uue(c);function d(_){_ instanceof c.ColorSet&&u&&(_.list=u)}w2()&&c.useTheme(r.am4themes_dark);const m=window.matchMedia("(prefers-reduced-motion: reduce)");t.chartAnimation&&!m.matches?c.useTheme(r.am4themes_animated):c.unuseTheme(r.am4themes_animated),c.useTheme(d);const f=l==="pie-chart"?this._createPieChart(e):this._createXYChart(e);n.setAttribute("aria-label",s.altText||s.title),f.data=o.series.map(_=>({[Xd]:_.tooltip,[Xv]:_.value,[fu]:a.get(_.fieldName)})).filter(_=>l!=="pie-chart"||_.value>0)}_customizeChartTooltip(e,t){e.label.wrap=!0,e.label.maxWidth=200,e.autoTextColor=!1,e.getFillFromObject=!1,e.label.fill=t.color("#ffffff"),e.background.fill=t.color({r:0,g:0,b:0,a:.7})}_createPieChart(e){const{chartDiv:t,chartsModule:r}=e,{am4core:n,am4charts:s}=r,a=n.create(t,s.PieChart);a.rtl=zh(this.container);const o=a.series.push(new s.PieSeries);return o.labels.template.disabled=!0,o.ticks.template.disabled=!0,o.dataFields.value=Xv,o.dataFields.category=Xd,this._customizeChartTooltip(o.tooltip,n),o.slices.template.propertyFields.fill=fu,o.slices.template.propertyFields.stroke=fu,a}_getMinSeriesValue(e){let t=0;return e.forEach(r=>t=Math.min(r.value,t)),t}_createColumnChart(e,t){const{chartsModule:r,mediaInfo:n}=t,{value:s}=n,{am4core:a,am4charts:o}=r,l=e.xAxes.push(new o.CategoryAxis);l.dataFields.category=Xd,l.renderer.labels.template.disabled=!0,this._customizeChartTooltip(l.tooltip,a),l.tooltip.events.on("sizechanged",()=>{l.tooltip.dy=-l.tooltip.contentHeight});const c=e.yAxes.push(new o.ValueAxis),u=c.renderer.labels.template;c.renderer.minLabelPosition=GA,c.renderer.maxLabelPosition=HA,c.min=this._getMinSeriesValue(s.series),this._customizeChartTooltip(c.tooltip,a),u.wrap=!0;const d=e.series.push(new o.ColumnSeries);d.dataFields.valueY=Xv,d.dataFields.categoryX=Xd,d.columns.template.propertyFields.fill=fu,d.columns.template.propertyFields.stroke=fu,e.cursor=new o.XYCursor,s.series.length>jA&&(e.scrollbarX=new a.Scrollbar)}_createBarChart(e,t){const{chartsModule:r,mediaInfo:n}=t,{value:s}=n,{am4core:a,am4charts:o}=r,l=e.yAxes.push(new o.CategoryAxis);l.dataFields.category=Xd,l.renderer.inversed=!0,l.renderer.labels.template.disabled=!0,this._customizeChartTooltip(l.tooltip,a),l.tooltip.events.on("sizechanged",()=>{l.tooltip.dx=l.tooltip.contentWidth});const c=e.xAxes.push(new o.ValueAxis),u=c.renderer.labels.template;c.renderer.minLabelPosition=GA,c.renderer.maxLabelPosition=HA,c.min=this._getMinSeriesValue(s.series),this._customizeChartTooltip(c.tooltip,a),u.wrap=!0;const d=e.series.push(new o.ColumnSeries);d.dataFields.valueX=Xv,d.dataFields.categoryY=Xd,d.columns.template.propertyFields.fill=fu,d.columns.template.propertyFields.stroke=fu,e.cursor=new o.XYCursor,s.series.length>jA&&(e.scrollbarY=new a.Scrollbar)}_createLineChart(e,t){const{chartsModule:r,mediaInfo:n,colorMap:s}=t,{value:a}=n,{am4core:o,am4charts:l}=r,c=e.xAxes.push(new l.CategoryAxis);c.dataFields.category=Xd,c.renderer.labels.template.disabled=!0,this._customizeChartTooltip(c.tooltip,o),c.tooltip.events.on("sizechanged",()=>{c.tooltip.dy=-c.tooltip.contentHeight});const u=e.yAxes.push(new l.ValueAxis),d=u.renderer.labels.template;u.renderer.minLabelPosition=GA,u.renderer.maxLabelPosition=HA,u.min=this._getMinSeriesValue(a.series),this._customizeChartTooltip(u.tooltip,o),d.wrap=!0;const m=e.series.push(new l.LineSeries);m.dataFields.categoryX=Xd,m.dataFields.valueY=Xv,m.strokeWidth=1;const f=s.get(F9);f&&(m.stroke=f);const _=m.bullets.push(new l.CircleBullet);_.propertyFields.fill=fu,_.propertyFields.stroke=fu,e.cursor=new l.XYCursor,a.series.length>jA&&(e.scrollbarX=new o.Scrollbar)}_createXYChart(e){const{chartDiv:t,chartsModule:r,mediaInfo:n}=e,{type:s}=n,{am4core:a,am4charts:o}=r,l=a.create(t,o.XYChart);return l.rtl=zh(this.container),s==="column-chart"&&this._createColumnChart(l,e),s==="bar-chart"&&this._createBarChart(l,e),s==="line-chart"&&this._createLineChart(l,e),l}_clearMediaRefreshTimer(){const{_refreshTimer:e}=this;e&&(clearTimeout(e),this._refreshTimer=null)}_updateMediaInfoTimestamp(e){const t=Date.now();this._refreshIntervalInfo={timestamp:t,sourceURL:this._getImageSource(e,t)},this.scheduleRender()}_setupMediaRefreshTimer(){this._clearMediaRefreshTimer();const{activeMediaInfo:e}=this.viewModel;e&&e.type==="image"&&e.refreshInterval&&this._setRefreshTimeout(e)}_setRefreshTimeout(e){const{refreshInterval:t,value:r}=e;if(!t)return;const n=6e4*t;this._updateMediaInfoTimestamp(r.sourceURL);const s=setInterval(()=>{this._updateMediaInfoTimestamp(r.sourceURL)},n);this._refreshTimer=s}_getImageSource(e,t){const r=e.includes("?")?"&":"?",[n,s=""]=e.split("#");return`${n}${r}timestamp=${t}${s?"#":""}${s}`}};h([p()],ja.prototype,"attributes",null),h([p()],ja.prototype,"activeMediaInfoIndex",null),h([p()],ja.prototype,"description",null),h([p()],ja.prototype,"fieldInfoMap",null),h([p()],ja.prototype,"layer",null),h([p()],ja.prototype,"mediaInfos",null),h([p()],ja.prototype,"popupTemplate",null),h([p()],ja.prototype,"relatedInfos",null),h([p()],ja.prototype,"title",null),h([p({type:ag})],ja.prototype,"viewModel",void 0),h([p(),_n("esri/widgets/Feature/t9n/Feature")],ja.prototype,"messages",void 0),ja=h([D("esri.widgets.Feature.FeatureMedia")],ja);const Xq=ja,zue=["$datastore","$map","$layer","$aggregatedfeatures"],Bue="esri.widgets.Feature.support.arcadeFeatureUtils",Gue=J.getLogger(Bue);function Hue(i){return typeof i=="string"?qx(XF(i)):Array.isArray(i)?jue(i):(i==null?void 0:i.declaredClass)==="esri.arcade.Dictionary"?que(i):i}function jue(i){return`<ul class="esri-widget__list">${i.map(e=>`<li>${typeof e=="string"?qx(XF(e)):e}</li>`).join("")}</ul>`}function que(i){return`<table class="esri-widget__table">${i.keys().map(e=>{const t=i.field(e);return`<tr><th>${e}</th><td>${typeof t=="string"?qx(XF(t)):t}</td></tr>`}).join("")}</table>`}function Wue({aggregatedFeatures:i,arcadeUtils:e,featureSetVars:t,context:r,viewInfo:n,map:s,graphic:a,interceptor:o}){t.forEach(l=>{const c=l.toLowerCase(),u={map:s,spatialReference:n.sr,interceptor:o};if(c==="$map"&&(r.vars[c]=e.convertMapToFeatureSetCollection(u)),c==="$layer"&&(r.vars[c]=e.convertFeatureLayerToFeatureSet({layer:a.sourceLayer,spatialReference:n.sr,interceptor:o})),c==="$datastore"&&(r.vars[c]=e.convertServiceUrlToWorkspace({url:a.sourceLayer.url,spatialReference:n.sr,interceptor:o})),c==="$aggregatedfeatures"){const d=a.layer,{fields:m,objectIdField:f,geometryType:_,spatialReference:g,displayField:x}=d,b=new k7({fields:m,objectIdField:f,geometryType:_,spatialReference:g,displayField:x,...d.type==="feature"?{templates:d.templates,typeIdField:d.typeIdField,types:d.types}:null,source:i});r.vars[c]=e.convertFeatureLayerToFeatureSet({layer:b,spatialReference:n.sr,interceptor:o})}})}function Qq(){return G(()=>import("./arcadeUtils-e61dca8e.js").then(i=>i.ay),["assets/arcadeUtils-e61dca8e.js","assets/geometry-b7901087.js","assets/ArrayPool-a8ee9378.js","assets/string-a318751c.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/Extent-da876e26.js","assets/cast-fcb46737.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/preload-helper-3bce6601.js","assets/number-8d860409.js","assets/locale-30120714.js","assets/Field-61ec9870.js","assets/enumeration-3a03bd31.js","assets/fieldType-f31285f7.js","assets/jsonUtils-229211af.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/request-6fc81c4c.js","assets/unitUtils-45d1147c.js","assets/hash-0ddfbf4b.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/sizeVariableUtils-d4870b0d.js"])}function Xue(i){return"createQuery"in i&&"queryFeatures"in i}async function Que({graphic:i,view:e}){const{isAggregate:t,layer:r}=i;if(!t||!r||(e==null?void 0:e.type)!=="2d")return[];const n=await e.whenLayerView(r);if(!Xue(n))return[];const s=n.createQuery();s.aggregateIds=[i.getObjectId()];const{features:a}=await n.queryFeatures(s);return a}async function Zq({expressionInfo:i,arcadeUtils:e,interceptor:t,spatialReference:r,map:n,graphic:s,view:a}){if(!i||!i.expression)return null;const o=e.createSyntaxTree(i.expression),l=zue.filter(f=>e.hasVariable(o,f)),[c]=await Promise.all([Que({graphic:s,view:a}),e.loadScriptDependencies(o,!0,l)]),u=e.getViewInfo({spatialReference:r}),d=e.createExecContext(s,u);d.interceptor=t,d.useAsync=!0,Wue({aggregatedFeatures:c,arcadeUtils:e,featureSetVars:l,context:d,viewInfo:u,map:n,graphic:s,interceptor:t});const m=e.createFunction(o,d);return e.executeAsyncFunction(m,d).catch(f=>Gue.error("arcade-execution-error",{error:f,graphic:s,expressionInfo:i}))}async function Zue({expressionInfos:i,spatialReference:e,graphic:t,interceptor:r,map:n,view:s}){if(!i||!i.length)return{};const a=await Qq(),o={};for(const u of i)o[`expression/${u.name}`]=Zq({expressionInfo:u,arcadeUtils:a,interceptor:r,spatialReference:e,map:n,graphic:t,view:s});const l=await Yo(o),c={};for(const u in l)c[u]=Hue(l[u].value);return c}const Yue=1;let Mo=class extends Lx(ue){constructor(e){super(e),this._abortController=null,this.expressionInfo=null,this.graphic=null,this.contentElement=null,this.contentElementViewModel=null,this.interceptor=null,this.view=null,this._cancelQuery=()=>{const{_abortController:t}=this;t&&t.abort(),this._abortController=null},this._createVM=()=>{var n,s;const t=(n=this.contentElement)==null?void 0:n.type;(s=this.contentElementViewModel)==null||s.destroy();const r=t==="fields"?new sR:t==="media"?new ag:t==="text"?new b2:null;this._set("contentElementViewModel",r)},this._compile=async()=>{this._cancelQuery();const t=new AbortController;this._abortController=t,await this._compileExpression(),this._abortController===t&&(this._abortController=null)},this._compileThrottled=M0(this._compile,Yue,this),this._compileExpression=async()=>{const{expressionInfo:t,graphic:r,interceptor:n,spatialReference:s,map:a,view:o,_abortController:l}=this;if(!(t&&r&&s&&a))return void this._set("contentElement",null);const c=await Qq();if(l!==this._abortController)return;const u=await Zq({arcadeUtils:c,expressionInfo:t,graphic:r,interceptor:n,map:a,spatialReference:s,view:o});if(!u||u.declaredClass!=="esri.arcade.Dictionary")return void this._set("contentElement",null);const d=await u.castAsJsonAsync(l.signal),m=d==null?void 0:d.type,f=m==="media"?Dte.fromJSON(d):m==="text"?I7.fromJSON(d):m==="fields"?Fte.fromJSON(d):null;this._set("contentElement",f)},this.handles.add([z(()=>[this.expressionInfo,this.graphic,this.map,this.spatialReference,this.view],()=>this._compileThrottled(),Qe),z(()=>[this.contentElement],()=>this._createVM(),Qe)])}destroy(){var e;this._cancelQuery(),(e=this.contentElementViewModel)==null||e.destroy(),this._set("contentElementViewModel",null),this._set("contentElement",null)}get spatialReference(){var e;return((e=this.view)==null?void 0:e.spatialReference)??null}set spatialReference(e){this._override("spatialReference",e)}get state(){const{_abortController:e,contentElement:t,contentElementViewModel:r}=this;return e?"loading":t||r?"ready":"disabled"}get map(){var e;return((e=this.view)==null?void 0:e.map)??null}set map(e){this._override("map",e)}};h([p()],Mo.prototype,"_abortController",void 0),h([p({type:Nte})],Mo.prototype,"expressionInfo",void 0),h([p({type:jc})],Mo.prototype,"graphic",void 0),h([p({readOnly:!0})],Mo.prototype,"contentElement",void 0),h([p({readOnly:!0})],Mo.prototype,"contentElementViewModel",void 0),h([p()],Mo.prototype,"interceptor",void 0),h([p()],Mo.prototype,"spatialReference",null),h([p({readOnly:!0})],Mo.prototype,"state",null),h([p()],Mo.prototype,"map",null),h([p()],Mo.prototype,"view",void 0),Mo=h([D("esri.widgets.Feature.FeatureExpression.FeatureExpressionViewModel")],Mo);const JF=Mo,OT={iconLoading:"esri-icon-loading-indicator esri-rotating",base:"esri-feature-expression",loadingSpinnerContainer:"esri-feature__loading-container",spinner:"esri-feature__loading-spinner"};let DS=class extends Hn{constructor(e,t){super(e,t),this.viewModel=new JF}initialize(){this.addHandles(z(()=>{var e;return(e=this.viewModel)==null?void 0:e.contentElementViewModel},()=>this._setupExpressionWidget(),Qe))}destroy(){this._destroyContentWidget()}renderLoading(){return F("div",{key:"loading-container",class:OT.loadingSpinnerContainer},F("span",{class:this.classes(OT.iconLoading,OT.spinner)}))}render(){var t;const{state:e}=this.viewModel;return F("div",{class:OT.base},e==="loading"?this.renderLoading():e==="disabled"?null:(t=this._contentWidget)==null?void 0:t.render())}_destroyContentWidget(){const{_contentWidget:e}=this;e&&(e.viewModel=null,e.destroy()),this._contentWidget=null}_setupExpressionWidget(){const{contentElementViewModel:e,contentElement:t}=this.viewModel,r=t==null?void 0:t.type;this._destroyContentWidget();const n=e?r==="fields"?new Wq({viewModel:e}):r==="media"?new Xq({viewModel:e}):r==="text"?new $S({viewModel:e}):null:null;this._contentWidget=n,this.scheduleRender()}};h([p({type:JF})],DS.prototype,"viewModel",void 0),DS=h([D("esri.widgets.Feature.FeatureExpression")],DS);const Kue=DS,qA=100;let qi=class extends au(sD(Lx(ue))){constructor(e){super(e),this._queryAbortController=null,this._queryPageAbortController=null,this._queryFeatureCountAbortController=null,this.featuresPerPage=10,this.description=null,this.graphic=null,this.layer=null,this.map=null,this.orderByFields=null,this.featureCount=0,this.relationshipId=null,this.showAllEnabled=!1,this.title=null,this._cancelQuery=()=>{const{_queryAbortController:t}=this;t&&t.abort(),this._queryAbortController=null},this._cancelQueryFeatureCount=()=>{const{_queryFeatureCountAbortController:t}=this;t&&t.abort(),this._queryFeatureCountAbortController=null},this._cancelQueryPage=()=>{const{_queryPageAbortController:t}=this;t&&t.abort(),this._queryPageAbortController=null},this._queryController=async()=>{this._cancelQuery();const t=new AbortController;this._queryAbortController=t,await Rb(this._query()),this._queryAbortController===t&&(this._queryAbortController=null)},this._queryFeatureCountController=async()=>{this._cancelQueryFeatureCount();const t=new AbortController;this._queryFeatureCountAbortController=t,await Rb(this._queryFeatureCount()),this._queryFeatureCountAbortController===t&&(this._queryFeatureCountAbortController=null)},this._queryPageController=async()=>{const t=new AbortController;this._queryPageAbortController=t,await Rb(this._queryPage()),this._queryPageAbortController===t&&(this._queryPageAbortController=null)},this._queryThrottled=M0(this._queryController,qA,this),this._queryFeatureCountThrottled=M0(this._queryFeatureCountController,qA,this),this._queryPageThrottled=M0(this._queryPageController,qA,this),this._query=async()=>{const{_queryAbortController:t,relatedFeatures:r}=this;this._destroyRelatedFeatureViewModels(),this.featurePage=1,r.removeAll(),r.addMany(this._sliceFeatures(await this._queryRelatedFeatures({signal:t==null?void 0:t.signal})))},this.handles.add([z(()=>[this.displayCount,this.graphic,this.layer,this.map,this.orderByFieldsFixedCasing,this.relationshipId,this.featuresPerPage,this.showAllEnabled],()=>this._queryThrottled(),Qe),z(()=>[this.featurePage,this.showAllEnabled],()=>this._queryPageThrottled()),z(()=>[this.layer,this.relationshipId,this.objectId],()=>this._queryFeatureCountThrottled())])}destroy(){this._destroyRelatedFeatureViewModels(),this.relatedFeatures.removeAll(),this._cancelQuery(),this._cancelQueryFeatureCount(),this._cancelQueryPage()}set featurePage(e){const{featuresPerPage:t,featureCount:r}=this,n=1,s=Math.ceil(r/t)||1;this._set("featurePage",Math.min(Math.max(e,n),s))}get featurePage(){return this._get("featurePage")}get orderByFieldsFixedCasing(){const{orderByFields:e,relatedLayer:t}=this;return e&&(t!=null&&t.loaded)?e.map(r=>{const n=r.clone(),s=Zw(r.field,t);return n.field=s,n}):e}get itemDescriptionFieldName(){var e,t;return((t=(e=this.orderByFieldsFixedCasing)==null?void 0:e[0])==null?void 0:t.field)||null}set displayCount(e){this._set("displayCount",Math.min(Math.max(e,0),10))}get displayCount(){return this._get("displayCount")}get objectId(){var e,t;return((t=(e=this.graphic)==null?void 0:e.attributes)==null?void 0:t[this.objectIdField])??null}get objectIdField(){var e;return((e=this.layer)==null?void 0:e.objectIdField)||null}get relatedFeatures(){return this._get("relatedFeatures")||new pt}get relatedLayer(){const{layer:e,map:t,relationship:r}=this;return e!=null&&e.loaded?jhe(t,e,r):null}get relationship(){var r;const{relationshipId:e,layer:t}=this;return typeof e=="number"?((r=t==null?void 0:t.relationships)==null?void 0:r.find(({id:n})=>n===e))??null:null}get relatedFeatureViewModels(){return this._get("relatedFeatureViewModels")||new pt}get state(){const{_queryAbortController:e,_queryFeatureCountAbortController:t,_queryPageAbortController:r,graphic:n,relatedLayer:s}=this;return t?"loading":e||r?"querying":n&&s?"ready":"disabled"}_destroyRelatedFeatureViewModels(){var e;(e=this.relatedFeatureViewModels)==null||e.forEach(t=>!t.destroyed&&t.destroy()),this.relatedFeatureViewModels.removeAll()}async _queryFeatureCount(){var u,d,m,f;const{layer:e,relatedLayer:t,relationshipId:r,objectId:n,_queryFeatureCountAbortController:s}=this;if(await(e==null?void 0:e.load()),!t||typeof n!="number"||!((d=(u=e==null?void 0:e.capabilities)==null?void 0:u.queryRelated)!=null&&d.supportsCount))return void this._set("featureCount",0);await t.load();const a=t.createQuery(),o=((f=(m=e.capabilities)==null?void 0:m.queryRelated)==null?void 0:f.supportsCacheHint)??!1,l=new lI({cacheHint:o,relationshipId:r,returnGeometry:!1,objectIds:[n],where:a.where}),c=await e.queryRelatedFeaturesCount(l,{signal:s==null?void 0:s.signal});this._set("featureCount",c[n]||0)}_sliceFeatures(e){const{showAllEnabled:t,displayCount:r}=this;return t?e:r?e.slice(0,r):[]}async _queryPage(){const{relatedFeatures:e,featurePage:t,showAllEnabled:r,_queryPageAbortController:n}=this;!r||t<2||e.addMany(await this._queryRelatedFeatures({signal:n==null?void 0:n.signal}))}async _queryRelatedFeatures(e){var C,A,M,I,L;const{orderByFieldsFixedCasing:t,showAllEnabled:r,featuresPerPage:n,displayCount:s,layer:a,relationshipId:o,featurePage:l,featureCount:c,relatedLayer:u}=this;await(a==null?void 0:a.load());const{relationship:d,objectId:m}=this;if(!d||typeof m!="number"||!((A=(C=a==null?void 0:a.capabilities)==null?void 0:C.queryRelated)!=null&&A.supportsPagination))return[];const f=r?((l-1)*n+c)%c:0,_=r?n:s;if(!u)return[];await u.load();const g=u.objectIdField,x=[...t==null?void 0:t.map(U=>U.field),g],b=t==null?void 0:t.map(U=>`${U.field} ${U.order}`),v=((I=(M=a.capabilities)==null?void 0:M.queryRelated)==null?void 0:I.supportsCacheHint)||!1,w=u.createQuery(),T=new lI({orderByFields:b,start:f,num:_,outFields:x,cacheHint:v,relationshipId:o,returnGeometry:!1,objectIds:[m],where:w.where}),E=((L=(await a.queryRelatedFeatures(T,{signal:e==null?void 0:e.signal}))[m])==null?void 0:L.features)||[];return E.forEach(U=>U.sourceLayer=u),E}};h([p()],qi.prototype,"_queryAbortController",void 0),h([p()],qi.prototype,"_queryPageAbortController",void 0),h([p()],qi.prototype,"_queryFeatureCountAbortController",void 0),h([p({value:1})],qi.prototype,"featurePage",null),h([p()],qi.prototype,"featuresPerPage",void 0),h([p({readOnly:!0})],qi.prototype,"orderByFieldsFixedCasing",null),h([p()],qi.prototype,"description",void 0),h([p({readOnly:!0})],qi.prototype,"itemDescriptionFieldName",null),h([p({value:3})],qi.prototype,"displayCount",null),h([p({type:jc})],qi.prototype,"graphic",void 0),h([p()],qi.prototype,"layer",void 0),h([p()],qi.prototype,"map",void 0),h([p({readOnly:!0})],qi.prototype,"objectId",null),h([p({readOnly:!0})],qi.prototype,"objectIdField",null),h([p()],qi.prototype,"orderByFields",void 0),h([p({readOnly:!0})],qi.prototype,"relatedFeatures",null),h([p({readOnly:!0})],qi.prototype,"relatedLayer",null),h([p({readOnly:!0})],qi.prototype,"relationship",null),h([p({readOnly:!0})],qi.prototype,"featureCount",void 0),h([p({readOnly:!0})],qi.prototype,"relatedFeatureViewModels",null),h([p()],qi.prototype,"relationshipId",void 0),h([p()],qi.prototype,"showAllEnabled",void 0),h([p({readOnly:!0})],qi.prototype,"state",null),h([p()],qi.prototype,"title",void 0),qi=h([D("esri.widgets.Feature.FeatureRelationship.FeatureRelationshipViewModel")],qi);const eN=qi,gu={base:"esri-feature-relationship",esriWidget:"esri-widget",listContainer:"esri-feature-relationship__list",listContainerQuerying:"esri-feature-relationship__list--querying",featureObserver:"esri-feature__feature-observer",stickySpinnerContainer:"esri-feature__sticky-loading-container",loadingSpinnerContainer:"esri-feature__loading-container",spinner:"esri-feature__loading-spinner",iconLoading:"esri-icon-loading-indicator esri-rotating"},N9={title:!0,description:!0};let ca=class extends Hn{constructor(e,t){super(e,t),this._featureElementInfo=null,this._relatedFeatureIntersectionObserver=new IntersectionObserver(([r])=>{r!=null&&r.isIntersecting&&this._increaseFeaturePage()},{root:window.document}),this.headingLevel=2,this.viewModel=new eN,this.messages=null,this.messagesCommon=null,this.visibleElements={...N9},this._increaseFeaturePage=()=>{const{state:r,showAllEnabled:n,relatedFeatures:s,featuresPerPage:a,featurePage:o}=this.viewModel;r==="ready"&&n&&s.length>=a*o&&this.viewModel.featurePage++}}initialize(){this._featureElementInfo=new nR,this.addHandles([z(()=>[this.viewModel.description,this.viewModel.title,this.headingLevel],()=>this._setupFeatureElementInfo(),Qe),z(()=>[this.viewModel.state,this.viewModel.showAllEnabled,this._relatedFeatureIntersectionObserverNode],()=>this._handleRelatedFeatureObserverChange()),wr(()=>this.viewModel.relatedFeatureViewModels,"change",()=>this._setupRelatedFeatureViewModels())])}loadDependencies(){return Promise.all([G(()=>import("./calcite-list-8d7e37dc.js"),["assets/calcite-list-8d7e37dc.js","assets/widget-fb292a2f.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/intl-65a3e389.js","assets/number-27cf8195.js","assets/jsonMap-7b8332c9.js","assets/locale-30120714.js","assets/messages-2289086c.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/assets-8d3e737a.js","assets/Evented-a45c8b0f.js","assets/Promise-376ab9f6.js","assets/reactiveUtils-4dabbb80.js","assets/uuid-73213768.js","assets/interactive-52dcf836.js"]),G(()=>import("./calcite-list-item-83bb520f.js"),["assets/calcite-list-item-83bb520f.js","assets/widget-fb292a2f.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/intl-65a3e389.js","assets/number-27cf8195.js","assets/jsonMap-7b8332c9.js","assets/locale-30120714.js","assets/messages-2289086c.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/assets-8d3e737a.js","assets/Evented-a45c8b0f.js","assets/Promise-376ab9f6.js","assets/reactiveUtils-4dabbb80.js","assets/uuid-73213768.js","assets/conditionalSlot-ff2173e3.js","assets/observers-edc9938f.js","assets/interactive-52dcf836.js"]),G(()=>import("./calcite-icon-938ab0b8.js"),["assets/calcite-icon-938ab0b8.js","assets/icon-40b00e67.js","assets/widget-fb292a2f.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/intl-65a3e389.js","assets/number-27cf8195.js","assets/jsonMap-7b8332c9.js","assets/locale-30120714.js","assets/messages-2289086c.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/assets-8d3e737a.js","assets/Evented-a45c8b0f.js","assets/Promise-376ab9f6.js","assets/reactiveUtils-4dabbb80.js","assets/uuid-73213768.js","assets/observers-edc9938f.js"]),G(()=>import("./calcite-notice-3d8b5086.js"),["assets/calcite-notice-3d8b5086.js","assets/widget-fb292a2f.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/intl-65a3e389.js","assets/number-27cf8195.js","assets/jsonMap-7b8332c9.js","assets/locale-30120714.js","assets/messages-2289086c.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/assets-8d3e737a.js","assets/Evented-a45c8b0f.js","assets/Promise-376ab9f6.js","assets/reactiveUtils-4dabbb80.js","assets/uuid-73213768.js","assets/conditionalSlot-ff2173e3.js","assets/observers-edc9938f.js","assets/icon-40b00e67.js"])])}destroy(){this._unobserveRelatedFeatureObserver(),this._featureElementInfo=Te(this._featureElementInfo)}get displayShowAllButton(){const{showAllEnabled:e,featureCount:t,displayCount:r}=this.viewModel;return!e&&(t>r||r===0)}get displayListItems(){return this.displayShowAllButton||this.viewModel.relatedFeatureViewModels.length>0}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get featureCountDescription(){const{messages:e}=this,{featureCount:t}=this.viewModel;return gc(t===1?e==null?void 0:e.numberRecord:e==null?void 0:e.numberRecords,{number:t})}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}castVisibleElements(e){return{...N9,...e}}renderStickyLoading(){return this.viewModel.state==="querying"?F("div",{key:"sticky-loader",class:gu.stickySpinnerContainer},this.renderLoadingIcon()):null}renderLoadingIcon(){return F("span",{class:this.classes(gu.iconLoading,gu.spinner)})}renderLoading(){return F("div",{key:"loading-container",class:gu.loadingSpinnerContainer},this.renderLoadingIcon())}renderShowAllIconNode(){return F("calcite-icon",{scale:"s",icon:"list",slot:"content-end"})}renderChevronIconNode(){const e=zh(this.container)?"chevron-left":"chevron-right";return F("calcite-icon",{scale:"s",icon:e,slot:"content-end"})}renderRelatedFeature(e){var s,a;const{itemDescriptionFieldName:t}=this.viewModel,r=e.title;e.description=t&&((s=e.formattedAttributes)==null?void 0:s.global[t]);const n=e.state==="loading";return F("calcite-list-item",{key:e.uid,label:n?`${(a=this.messagesCommon)==null?void 0:a.loading}`:r,description:n?"":e.description,onclick:()=>this.emit("select-record",{featureViewModel:e})},this.renderChevronIconNode())}renderShowAllListItem(){var e;return this.displayShowAllButton?F("calcite-list-item",{key:"show-all-item",label:(e=this.messages)==null?void 0:e.showAll,description:this.featureCountDescription,onclick:()=>this.emit("show-all-records")},this.renderShowAllIconNode()):null}renderNoRelatedFeaturesMessage(){var e;return F("calcite-notice",{key:"no-related-features-message",icon:"information",open:!0,color:"blue",scale:"s",width:"full"},F("div",{slot:"message"},(e=this.messages)==null?void 0:e.noRelatedFeatures))}renderFeatureObserver(){return F("div",{key:"feature-observer",class:gu.featureObserver,bind:this,afterCreate:this._relatedFeatureIntersectionObserverCreated})}renderList(){const{relatedFeatureViewModels:e}=this.viewModel;return F("calcite-list",null,e.toArray().map(t=>this.renderRelatedFeature(t)),this.renderShowAllListItem())}renderRelatedFeatures(){const{displayListItems:e}=this,{state:t}=this.viewModel;return F("div",{key:"list-container",class:this.classes(gu.listContainer,{[gu.listContainerQuerying]:t==="querying"})},e?this.renderList():t==="ready"?this.renderNoRelatedFeaturesMessage():null,this.renderStickyLoading(),this.renderFeatureObserver())}renderRelationshipNotFound(){var e;return F("calcite-notice",{key:"relationship-not-found",icon:"exclamation-mark-triangle",open:!0,color:"red",scale:"s",width:"full"},F("div",{slot:"message"},(e=this.messages)==null?void 0:e.relationshipNotFound))}render(){var t;const{state:e}=this.viewModel;return F("div",{class:this.classes(gu.base,gu.esriWidget)},(t=this._featureElementInfo)==null?void 0:t.render(),e==="loading"?this.renderLoading():e==="disabled"?this.renderRelationshipNotFound():this.renderRelatedFeatures())}_setupRelatedFeatureViewModels(){const{relatedFeatureViewModels:e}=this.viewModel,t="related-feature-viewmodels";this.removeHandles(t),e==null||e.forEach(r=>{this.addHandles(z(()=>[r.title,r.state],()=>this.scheduleRender(),Qe),t)}),this.scheduleRender()}_setupFeatureElementInfo(){const{headingLevel:e,visibleElements:t}=this,r=t.description&&this.description,n=t.title&&this.title;this._featureElementInfo.set({description:r,title:n,headingLevel:e})}async _handleRelatedFeatureObserverChange(){this._unobserveRelatedFeatureObserver();const{state:e,showAllEnabled:t}=this.viewModel;await B0(0),this._relatedFeatureIntersectionObserverNode&&e==="ready"&&t&&this._relatedFeatureIntersectionObserver.observe(this._relatedFeatureIntersectionObserverNode)}_relatedFeatureIntersectionObserverCreated(e){this._relatedFeatureIntersectionObserverNode=e}_unobserveRelatedFeatureObserver(){this._relatedFeatureIntersectionObserverNode&&this._relatedFeatureIntersectionObserver.unobserve(this._relatedFeatureIntersectionObserverNode)}};h([p()],ca.prototype,"_relatedFeatureIntersectionObserverNode",void 0),h([p({readOnly:!0})],ca.prototype,"displayShowAllButton",null),h([p({readOnly:!0})],ca.prototype,"displayListItems",null),h([p()],ca.prototype,"description",null),h([p({readOnly:!0})],ca.prototype,"featureCountDescription",null),h([p()],ca.prototype,"headingLevel",void 0),h([p()],ca.prototype,"title",null),h([p({type:eN})],ca.prototype,"viewModel",void 0),h([p(),_n("esri/widgets/Feature/t9n/Feature")],ca.prototype,"messages",void 0),h([p(),_n("esri/t9n/common")],ca.prototype,"messagesCommon",void 0),h([p()],ca.prototype,"visibleElements",void 0),h([qr("visibleElements")],ca.prototype,"castVisibleElements",null),ca=h([D("esri.widgets.Feature.FeatureRelationship")],ca);const k9=ca;let Jue=class{constructor(e,t){this.preLayerQueryCallback=e,this.preRequestCallback=t,this.preLayerQueryCallback||(this.preLayerQueryCallback=r=>{}),this.preRequestCallback||(this.preLayerQueryCallback=r=>{})}};var z1;const ede=1,V9="content-view-models",U9="relationship-view-models",z9={attachmentsContent:!0,chartAnimation:!0,customContent:!0,expressionContent:!0,fieldsContent:!0,mediaContent:!0,textContent:!0,relationshipContent:!0};let or=z1=class extends sD(ue){constructor(i){super(i),this._handles=new Ft,this._error=null,this._featureAbortController=null,this._graphicChangedThrottled=M0(this._graphicChanged,ede,this),this._expressionAttributes=null,this._graphicExpressionAttributes=null,this.abilities={...z9},this.content=null,this.contentViewModels=[],this.description=null,this.defaultPopupTemplateEnabled=!1,this.formattedAttributes=null,this.lastEditInfo=null,this.relatedInfos=new Map,this.title="",this.view=null,this._isAllowedContentType=e=>{const{abilities:t}=this;return e.type==="attachments"&&t.attachmentsContent||e.type==="custom"&&t.customContent||e.type==="fields"&&t.fieldsContent||e.type==="media"&&t.mediaContent||e.type==="text"&&t.textContent||e.type==="expression"&&t.expressionContent||e.type==="relationship"&&t.relationshipContent},this._handles.add(z(()=>[this.graphic,this._effectivePopupTemplate,this.abilities],()=>this._graphicChangedThrottled(),Qe))}destroy(){this._clear(),this._cancelFeatureQuery(),this._error=null,this._handles.destroy(),this._handles=null,this.graphic=null,this._destroyContentViewModels(),this.relatedInfos.clear()}get _effectivePopupTemplate(){return y(this.graphic)?this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled):null}get _fieldInfoMap(){return Nhe(C9(this._effectivePopupTemplate),this._sourceLayer)}get _sourceLayer(){return kq(this.graphic)}castAbilities(i){return{...z9,...i}}get state(){return this.graphic?this._error?"error":this.waitingForContent?"loading":"ready":"disabled"}set graphic(i){this._set("graphic",i?i.clone():null)}get spatialReference(){var i;return((i=this.view)==null?void 0:i.spatialReference)??null}set spatialReference(i){this._override("spatialReference",i)}get map(){var i;return((i=this.view)==null?void 0:i.map)||null}set map(i){this._override("map",i)}get waitingForContent(){return!!this._featureAbortController}setActiveMedia(i,e){const t=this.contentViewModels[i];t instanceof ag&&t.setActiveMedia(e)}nextMedia(i){const e=this.contentViewModels[i];e instanceof ag&&e.next()}previousMedia(i){const e=this.contentViewModels[i];e instanceof ag&&e.previous()}_clear(){this._set("title",""),this._set("content",null),this._set("formattedAttributes",null)}async _graphicChanged(){this._cancelFeatureQuery(),this._error=null,this._clear();const{graphic:i}=this;if(!i)return;const e=new AbortController;this._featureAbortController=e;try{await this._queryFeature({signal:e.signal})}catch(t){yo(t)||(this._error=t,J.getLogger(this.declaredClass).error("error","The popupTemplate could not be displayed for this feature.",{error:t,graphic:i,popupTemplate:this._effectivePopupTemplate}))}this._featureAbortController===e&&(this._featureAbortController=null)}_cancelFeatureQuery(){const{_featureAbortController:i}=this;i&&i.abort(),this._featureAbortController=null}_compileContentElement(i,e){return i.type==="attachments"?this._compileAttachments(i,e):i.type==="custom"?this._compileCustom(i,e):i.type==="fields"?this._compileFields(i,e):i.type==="media"?this._compileMedia(i,e):i.type==="text"?this._compileText(i,e):i.type==="expression"?this._compileExpression(i,e):i.type==="relationship"?this._compileRelationship(i,e):void 0}_compileContent(i){if(this._destroyContentViewModels(),this.graphic)return Array.isArray(i)?i.filter(this._isAllowedContentType).map((e,t)=>this._compileContentElement(e,t)):typeof i=="string"?this._compileText(new I7({text:i}),0).text:i}_destroyContentViewModels(){var i,e;(i=this._handles)==null||i.remove(U9),(e=this._handles)==null||e.remove(V9),this.contentViewModels.forEach(t=>t&&!t.destroyed&&t.destroy()),this._set("contentViewModels",[])}_matchesFeature(i,e){var n;const t=(n=i==null?void 0:i.graphic)==null?void 0:n.getObjectId(),r=e==null?void 0:e.getObjectId();return y(t)&&y(r)&&t===r}_setRelatedFeaturesViewModels({relatedFeatureViewModels:i,relatedFeatures:e,map:t}){e==null||e.filter(Boolean).forEach(r=>{i.find(n=>this._matchesFeature(n,r))||i.add(new z1({abilities:{relationshipContent:!1},map:t,graphic:r}))}),i.forEach(r=>{(e==null?void 0:e.find(s=>this._matchesFeature(r,s)))||i.remove(r)})}_setExpressionContentVM(i,e){const{formattedAttributes:t}=this,{contentElement:r,contentElementViewModel:n}=i,s=r==null?void 0:r.type;n&&s&&(s==="fields"&&(this._createFieldsFormattedAttributes({contentElement:r,contentElementIndex:e,formattedAttributes:t}),n.set(this._createFieldsVMParams(r,e))),s==="media"&&(this._createMediaFormattedAttributes({contentElement:r,contentElementIndex:e,formattedAttributes:t}),n.set(this._createMediaVMParams(r,e))),s==="text"&&n.set(this._createTextVMParams(r)))}_compileRelationship(i,e){const{displayCount:t,orderByFields:r,relationshipId:n,title:s,description:a}=i,{_sourceLayer:o,graphic:l,map:c}=this,u=new eN({displayCount:t,graphic:l,orderByFields:r,relationshipId:n,layer:o,map:c,...this._compileTitleAndDesc({title:s,description:a})});return this.contentViewModels[e]=u,this._handles.add(wr(()=>u.relatedFeatures,"change",()=>this._setRelatedFeaturesViewModels(u)),U9),i}_compileExpression(i,e){const{expressionInfo:t}=i,{graphic:r,map:n,spatialReference:s,view:a}=this,o=new JF({expressionInfo:t,graphic:r,interceptor:z1.interceptor,map:n,spatialReference:s,view:a});return this.contentViewModels[e]=o,this._handles.add(z(()=>o.contentElementViewModel,()=>this._setExpressionContentVM(o,e),Qe),V9),i}_compileAttachments(i,e){const{graphic:t}=this,{description:r,title:n}=i;return this.contentViewModels[e]=new ZF({graphic:t,...this._compileTitleAndDesc({title:n,description:r})}),i}_compileCustom(i,e){const{graphic:t}=this,{creator:r,destroyer:n}=i;return this.contentViewModels[e]=new b2({graphic:t,creator:r,destroyer:n}),i}_compileTitleAndDesc({title:i,description:e}){const{_fieldInfoMap:t,_sourceLayer:r,graphic:n,formattedAttributes:s,_expressionAttributes:a}=this,{attributes:o}=n,l=s.global;return{title:sg({attributes:o,fieldInfoMap:t,globalAttributes:l,expressionAttributes:a,layer:r,text:i}),description:sg({attributes:o,fieldInfoMap:t,globalAttributes:l,expressionAttributes:a,layer:r,text:e})}}_createFieldsVMParams(i,e){var c;const{_effectivePopupTemplate:t,formattedAttributes:r}=this,n={...r.global,...r.content[e]},s=(c=(i==null?void 0:i.fieldInfos)||(t==null?void 0:t.fieldInfos))==null?void 0:c.filter(({fieldName:u})=>qF(u)||ld(u)||n.hasOwnProperty(u)),a=t==null?void 0:t.expressionInfos,{description:o,title:l}=i;return{attributes:n,expressionInfos:a,fieldInfos:s,...this._compileTitleAndDesc({title:l,description:o})}}_compileFields(i,e){const t=i.clone(),r=new sR(this._createFieldsVMParams(i,e));return this.contentViewModels[e]=r,t.fieldInfos=r.formattedFieldInfos.slice(0),t}_createMediaVMParams(i,e){const{abilities:t,graphic:r,_fieldInfoMap:n,formattedAttributes:s,_effectivePopupTemplate:a,relatedInfos:o,_sourceLayer:l,_expressionAttributes:c}=this,{attributes:u}=r,{description:d,mediaInfos:m,title:f}=i;return{abilities:{chartAnimation:t.chartAnimation},activeMediaInfoIndex:i.activeMediaInfoIndex||0,attributes:u,layer:l,fieldInfoMap:n,formattedAttributes:{...s.global,...s.content[e]},expressionAttributes:c,mediaInfos:m,popupTemplate:a,relatedInfos:o,...this._compileTitleAndDesc({title:f,description:d})}}_compileMedia(i,e){const t=i.clone(),r=new ag(this._createMediaVMParams(i,e));return t.mediaInfos=r.formattedMediaInfos.slice(0),this.contentViewModels[e]=r,t}_createTextVMParams(i){const{graphic:e,_fieldInfoMap:t,_sourceLayer:r,_expressionAttributes:n}=this;if(i&&i.text){const{attributes:s}=e,a=this.formattedAttributes.global;i.text=sg({attributes:s,fieldInfoMap:t,globalAttributes:a,expressionAttributes:n,layer:r,text:i.text})}return{graphic:e,creator:i.text}}_compileText(i,e){const t=i.clone();return this.contentViewModels[e]=new b2(this._createTextVMParams(t)),t}_compileLastEditInfo(){const{_effectivePopupTemplate:i,_sourceLayer:e,graphic:t}=this;if(!i)return;const{lastEditInfoEnabled:r}=i,n=e==null?void 0:e.editFieldsInfo;return r&&n?Fhe(n,t.attributes):void 0}_compileTitle(i){const{_fieldInfoMap:e,_sourceLayer:t,graphic:r,_expressionAttributes:n}=this,{attributes:s}=r,a=this.formattedAttributes.global;return sg({attributes:s,fieldInfoMap:e,globalAttributes:a,expressionAttributes:n,layer:t,text:i})}async _getTitle(){const{_effectivePopupTemplate:i,graphic:e}=this,t=i==null?void 0:i.title;return v2(t,{graphic:e})}async _getContent(){const{_effectivePopupTemplate:i,graphic:e}=this,t=i==null?void 0:i.content;return v2(t,{graphic:e})}async _queryFeature(i){const{_featureAbortController:e,_sourceLayer:t,graphic:r,_effectivePopupTemplate:n,spatialReference:s,map:a,view:o}=this;if(e!==this._featureAbortController||!r)return;await Uhe({graphic:r,popupTemplate:n,layer:t,spatialReference:s},i);const{content:{value:l},title:{value:c}}=await Yo({content:this._getContent(),title:this._getTitle()}),{expressionAttributes:{value:u}}=await Yo({checkForRelatedFeatures:this._checkForRelatedFeatures(i),expressionAttributes:Zue({expressionInfos:n==null?void 0:n.expressionInfos,spatialReference:s,graphic:r,map:a,interceptor:z1.interceptor,view:o})});e===this._featureAbortController&&r&&(this._expressionAttributes=u,this._graphicExpressionAttributes={...r.attributes,...u},this._set("formattedAttributes",this._createFormattedAttributes(l)),this._set("title",this._compileTitle(c)),this._set("lastEditInfo",this._compileLastEditInfo()||null),this._set("content",this._compileContent(l)||null))}_createMediaFormattedAttributes({contentElement:i,contentElementIndex:e,formattedAttributes:t}){const{_effectivePopupTemplate:r,graphic:n,relatedInfos:s,_sourceLayer:a,_fieldInfoMap:o,_graphicExpressionAttributes:l}=this;t.content[e]=VA({fieldInfos:r==null?void 0:r.fieldInfos,graphic:n,attributes:{...l,...i.attributes},layer:a,fieldInfoMap:o,relatedInfos:s})}_createFieldsFormattedAttributes({contentElement:i,contentElementIndex:e,formattedAttributes:t}){if(i.fieldInfos){const{graphic:r,relatedInfos:n,_sourceLayer:s,_fieldInfoMap:a,_graphicExpressionAttributes:o}=this;t.content[e]=VA({fieldInfos:i.fieldInfos,graphic:r,attributes:{...o,...i.attributes},layer:s,fieldInfoMap:a,relatedInfos:n})}}_createFormattedAttributes(i){const{_effectivePopupTemplate:e,graphic:t,relatedInfos:r,_sourceLayer:n,_fieldInfoMap:s,_graphicExpressionAttributes:a}=this,o=e==null?void 0:e.fieldInfos,l={global:VA({fieldInfos:o,graphic:t,attributes:a,layer:n,fieldInfoMap:s,relatedInfos:r}),content:[]};return Array.isArray(i)&&i.forEach((c,u)=>{c.type==="fields"&&this._createFieldsFormattedAttributes({contentElement:c,contentElementIndex:u,formattedAttributes:l}),c.type==="media"&&this._createMediaFormattedAttributes({contentElement:c,contentElementIndex:u,formattedAttributes:l})}),l}_checkForRelatedFeatures(i){const{graphic:e,_effectivePopupTemplate:t}=this;return this._queryRelatedInfos(e,C9(t),i)}async _queryRelatedInfos(i,e,t){const{relatedInfos:r,_sourceLayer:n}=this;r.clear();const s=y(n.associatedLayer)?await n.associatedLayer.load(t):n;if(!s)return;const a=e.filter(c=>c&&ld(c.fieldName));if(!a||!a.length)return;e.forEach(c=>this._configureRelatedInfo(c,s));const o=await Mue({relatedInfos:r,layer:s},t);Object.keys(o).forEach(c=>{var m;const u=r.get(c.toString()),d=(m=o[c])==null?void 0:m.value;u&&d&&(u.layerInfo=d.data)});const l=await Iue({graphic:i,relatedInfos:r,layer:s},t);Object.keys(l).forEach(c=>{var u;Eue((u=l[c])==null?void 0:u.value,r.get(c.toString()))})}_configureRelatedInfo(i,e){const{relatedInfos:t}=this,r=V3(i.fieldName);if(!r)return;const{layerId:n,fieldName:s}=r;if(!n)return;const a=t.get(n.toString())||Sue(n,e);a&&(Lue({relatedInfo:a,fieldName:s,fieldInfo:i}),this.relatedInfos.set(n,a))}};or.interceptor=new Jue(Ghe,Hhe),h([p()],or.prototype,"_error",void 0),h([p()],or.prototype,"_featureAbortController",void 0),h([p({readOnly:!0})],or.prototype,"_effectivePopupTemplate",null),h([p({readOnly:!0})],or.prototype,"_fieldInfoMap",null),h([p({readOnly:!0})],or.prototype,"_sourceLayer",null),h([p()],or.prototype,"abilities",void 0),h([qr("abilities")],or.prototype,"castAbilities",null),h([p({readOnly:!0})],or.prototype,"content",void 0),h([p({readOnly:!0})],or.prototype,"contentViewModels",void 0),h([p()],or.prototype,"description",void 0),h([p({type:Boolean})],or.prototype,"defaultPopupTemplateEnabled",void 0),h([p({readOnly:!0})],or.prototype,"state",null),h([p({readOnly:!0})],or.prototype,"formattedAttributes",void 0),h([p({type:jc,value:null})],or.prototype,"graphic",null),h([p({readOnly:!0})],or.prototype,"lastEditInfo",void 0),h([p({readOnly:!0})],or.prototype,"relatedInfos",void 0),h([p()],or.prototype,"spatialReference",null),h([p({readOnly:!0})],or.prototype,"title",void 0),h([p()],or.prototype,"map",null),h([p({readOnly:!0})],or.prototype,"waitingForContent",null),h([p()],or.prototype,"view",void 0),or=z1=h([D("esri.widgets.FeatureViewModel")],or);const tN=or,_r={iconText:"esri-icon-font-fallback-text",iconLoading:"esri-icon-loading-indicator esri-rotating",esriTable:"esri-widget__table",esriWidget:"esri-widget",base:"esri-feature",container:"esri-feature__size-container",title:"esri-feature__title",main:"esri-feature__main-container",btn:"esri-feature__button",icon:"esri-feature__icon",content:"esri-feature__content",contentNode:"esri-feature__content-node",contentElement:"esri-feature__content-element",text:"esri-feature__text",lastEditedInfo:"esri-feature__last-edited-info",fields:"esri-feature__fields",fieldHeader:"esri-feature__field-header",fieldData:"esri-feature__field-data",fieldDataDate:"esri-feature__field-data--date",loadingSpinnerContainer:"esri-feature__loading-container",spinner:"esri-feature__loading-spinner"},Yq=i=>{let e=class extends i{constructor(){super(...arguments),this.renderNodeContent=t=>IE(t)&&!t.destroyed?F("div",{class:_r.contentNode,key:t},t.render()):t instanceof HTMLElement?F("div",{class:_r.contentNode,key:t,bind:t,afterCreate:this._attachToNode}):R7(t)?F("div",{class:_r.contentNode,key:t,bind:t.domNode,afterCreate:this._attachToNode}):null}_attachToNode(t){const r=this;t.appendChild(r)}};return e=h([D("esri.widgets.Feature.ContentMixin")],e),e};var U3;const B9={title:!0,content:!0,lastEditedInfo:!0},G9="relationship-handles";let Qn=U3=class extends Yq(Hn){constructor(i,e){super(i,e),this._contentWidgets=[],this.flowItems=null,this.headingLevel=2,this.messages=null,this.messagesCommon=null,this.messagesURIUtils=null,this.visibleElements={...B9},this.viewModel=new tN}initialize(){this.addHandles(z(()=>{var i;return(i=this.viewModel)==null?void 0:i.contentViewModels},()=>this._setupContentWidgets(),Qe))}loadDependencies(){return G(()=>import("./calcite-notice-3d8b5086.js"),["assets/calcite-notice-3d8b5086.js","assets/widget-fb292a2f.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/intl-65a3e389.js","assets/number-27cf8195.js","assets/jsonMap-7b8332c9.js","assets/locale-30120714.js","assets/messages-2289086c.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/assets-8d3e737a.js","assets/Evented-a45c8b0f.js","assets/Promise-376ab9f6.js","assets/reactiveUtils-4dabbb80.js","assets/uuid-73213768.js","assets/conditionalSlot-ff2173e3.js","assets/observers-edc9938f.js","assets/icon-40b00e67.js"])}destroy(){this._destroyContentWidgets()}get graphic(){return this.viewModel.graphic}set graphic(i){this.viewModel.graphic=i}get defaultPopupTemplateEnabled(){return this.viewModel.defaultPopupTemplateEnabled}set defaultPopupTemplateEnabled(i){this.viewModel.defaultPopupTemplateEnabled=i}get label(){var i;return((i=this.messages)==null?void 0:i.widgetLabel)??""}set label(i){this._overrideIfSome("label",i)}get spatialReference(){return this.viewModel.spatialReference}set spatialReference(i){this.viewModel.spatialReference=i}get title(){return this.viewModel.title}castVisibleElements(i){return{...B9,...i}}get map(){return this.viewModel.map}set map(i){this.viewModel.map=i}get view(){return this.viewModel.view}set view(i){this.viewModel.view=i}render(){const{state:i}=this.viewModel,e=F("div",{class:_r.container,key:"container"},this.renderTitle(),i==="error"?this.renderError():i==="loading"?this.renderLoading():this.renderContentContainer());return F("div",{class:this.classes(_r.base,_r.esriWidget)},e)}setActiveMedia(i,e){return this.viewModel.setActiveMedia(i,e)}nextMedia(i){return this.viewModel.nextMedia(i)}previousMedia(i){return this.viewModel.previousMedia(i)}renderError(){const{messagesCommon:i,messages:e,visibleElements:t}=this;return F("calcite-notice",{active:!0,color:"red",icon:"exclamation-mark-circle",scale:"s"},t.title?F("div",{key:"error-title",slot:"title"},i.errorMessage):null,F("div",{key:"error-message",slot:"message"},e.loadingError))}renderLoading(){return F("div",{key:"loading-container",class:_r.loadingSpinnerContainer},F("span",{class:this.classes(_r.iconLoading,_r.spinner)}))}renderContentContainer(){const{visibleElements:i}=this;return i.content?F("div",{class:_r.main},[this.renderContent(),this.renderLastEditInfo()]):null}renderTitle(){const{visibleElements:i,title:e}=this;return i.title?F(YF,{level:this.headingLevel,class:_r.title,innerHTML:e}):null}renderContent(){const i=this.viewModel.content,e="content";if(!i)return null;if(Array.isArray(i))return i.length?F("div",{class:_r.contentNode,key:`${e}-content-elements`},i.map(this.renderContentElement,this)):null;if(typeof i=="string"){const t=this._contentWidgets[0];return!t||t.destroyed?null:F("div",{class:_r.contentNode,key:`${e}-content`},t.render())}return this.renderNodeContent(i)}renderContentElement(i,e){const{visibleElements:t}=this;if(typeof t.content!="boolean"&&!t.content[i.type])return null;switch(i.type){case"attachments":return this.renderAttachments(e);case"custom":return this.renderCustom(i,e);case"fields":return this.renderFields(e);case"media":return this.renderMedia(e);case"text":return this.renderText(i,e);case"expression":return this.renderExpression(e);case"relationship":return this.renderRelationship(e);default:return null}}renderAttachments(i){const e=this._contentWidgets[i];if(!e||e.destroyed)return null;const{state:t,attachmentInfos:r}=e.viewModel;return t==="loading"||r.length>0?F("div",{key:this._buildKey("attachments-element",i),class:this.classes(_r.contentElement)},e.render()):null}renderRelationship(i){const e=this._contentWidgets[i];return e&&!e.destroyed&&this.flowItems?F("div",{key:this._buildKey("relationship-element",i),class:_r.contentElement},e.render()):null}renderExpression(i){const e=this._contentWidgets[i];return!e||e.destroyed?null:F("div",{key:this._buildKey("expression-element",i),class:_r.contentElement},e.render())}renderCustom(i,e){const{creator:t}=i,r=this._contentWidgets[e];return!r||r.destroyed?null:t?F("div",{key:this._buildKey("custom-element",e),class:_r.contentElement},r.render()):null}renderFields(i){const e=this._contentWidgets[i];return!e||e.destroyed?null:F("div",{key:this._buildKey("fields-element",i),class:_r.contentElement},e.render())}renderMedia(i){const e=this._contentWidgets[i];return!e||e.destroyed?null:F("div",{key:this._buildKey("media-element",i),class:_r.contentElement},e.render())}renderLastEditInfo(){const{visibleElements:i,messages:e}=this,{lastEditInfo:t}=this.viewModel;if(!t||!i.lastEditedInfo)return null;const{date:r,user:n}=t,s=t.type==="edit"?n?e.lastEditedByUser:e.lastEdited:n?e.lastCreatedByUser:e.lastCreated,a=gc(s,{date:r,user:n});return F("div",{key:"edit-info-element",class:this.classes(_r.lastEditedInfo,_r.contentElement)},a)}renderText(i,e){const t=i.text,r=this._contentWidgets[e];return!r||r.destroyed?null:t?F("div",{key:this._buildKey("text-element",e),class:this.classes(_r.contentElement,_r.text)},r.render()):null}_buildKey(i,...e){return`${i}__${this.get("viewModel.graphic.uid")||"0"}-${e.join("-")}`}_destroyContentWidget(i){i&&(i.viewModel=null,!i.destroyed&&i.destroy())}_destroyContentWidgets(){this.removeHandles(G9),this._contentWidgets.forEach(i=>this._destroyContentWidget(i)),this._contentWidgets=[]}_addFeatureRelationshipHandles(i){const{flowItems:e,visibleElements:t}=this;this.addHandles([wr(()=>i,"select-record",({featureViewModel:r})=>{e&&(r.abilities={relationshipContent:!0},e.push(new U3({flowItems:e,viewModel:r,visibleElements:t})))}),wr(()=>i,"show-all-records",()=>{if(!e)return;const{viewModel:r}=i;r.showAllEnabled=!0;const n=new k9({visibleElements:{title:!1,description:!1},viewModel:r});this._addFeatureRelationshipHandles(n),e.push(n)})],G9)}_setupContentWidgets(){this._destroyContentWidgets();const{headingLevel:i,visibleElements:e}=this,t=this.get("viewModel.content"),{contentViewModels:r}=this.viewModel;if(Array.isArray(t))t.forEach((n,s)=>{if(n.type==="attachments"&&(this._contentWidgets[s]=new Yhe({displayType:n.displayType,headingLevel:e.title?i+1:i,viewModel:r[s]})),n.type==="fields"&&(this._contentWidgets[s]=new Wq({viewModel:r[s]})),n.type==="media"&&(this._contentWidgets[s]=new Xq({viewModel:r[s]})),n.type==="text"&&(this._contentWidgets[s]=new $S({viewModel:r[s]})),n.type==="custom"&&(this._contentWidgets[s]=new $S({viewModel:r[s]})),n.type==="expression"&&(this._contentWidgets[s]=new Kue({viewModel:r[s]})),n.type==="relationship"){const a=new k9({viewModel:r[s]});this._addFeatureRelationshipHandles(a),this._contentWidgets[s]=a}},this);else{const n=r[0];n&&!n.destroyed&&(this._contentWidgets[0]=new $S({viewModel:n}))}this.scheduleRender()}};h([p()],Qn.prototype,"graphic",null),h([p()],Qn.prototype,"defaultPopupTemplateEnabled",null),h([p()],Qn.prototype,"flowItems",void 0),h([p()],Qn.prototype,"headingLevel",void 0),h([p()],Qn.prototype,"label",null),h([p(),_n("esri/widgets/Feature/t9n/Feature")],Qn.prototype,"messages",void 0),h([p(),_n("esri/t9n/common")],Qn.prototype,"messagesCommon",void 0),h([p(),_n("esri/widgets/support/t9n/uriUtils")],Qn.prototype,"messagesURIUtils",void 0),h([p()],Qn.prototype,"spatialReference",null),h([p({readOnly:!0})],Qn.prototype,"title",null),h([p()],Qn.prototype,"visibleElements",void 0),h([qr("visibleElements")],Qn.prototype,"castVisibleElements",null),h([p()],Qn.prototype,"map",null),h([p()],Qn.prototype,"view",null),h([p({type:tN})],Qn.prototype,"viewModel",void 0),Qn=U3=h([D("esri.widgets.Feature")],Qn);const tde=Qn;var Kq;const FS=Symbol("anchorHandles");let Pf=class extends nn.EventedAccessor{constructor(e){super(e),this[Kq]=new Ft,this.location=null,this.screenLocationEnabled=!1,this.view=null,this[FS].add([cs(()=>co(this.screenLocationEnabled?this.view:null,t=>[t.size,t.type==="3d"?t.camera:t.viewpoint]),()=>this.notifyChange("screenLocation")),z(()=>this.screenLocation,(t,r)=>{y(t)&&y(r)&&this.emit("view-change")})])}destroy(){this.view=null,this[FS]=Te(this[FS])}get screenLocation(){const{location:e,view:t,screenLocationEnabled:r}=this;return r&&y(e)&&y(t)&&t.ready?t.toScreen(e):null}};Kq=FS,h([p()],Pf.prototype,"location",void 0),h([p()],Pf.prototype,"screenLocation",null),h([p()],Pf.prototype,"screenLocationEnabled",void 0),h([p()],Pf.prototype,"view",void 0),Pf=h([D("esri.widgets.support.AnchorElementViewModel")],Pf);const Jq=Pf,ide="esri.widgets.CompassViewModel";let NS=class extends Jq{constructor(e){super(e),this.visible=!1}};h([p()],NS.prototype,"visible",void 0),NS=h([D(ide)],NS);const eW=NS,WA={base:"esri-spinner",spinnerStart:"esri-spinner--start",spinnerFinish:"esri-spinner--finish"};let Rf=class extends Hn{constructor(e,t){super(e,t),this._animationDelay=500,this._animationPromise=null,this.viewModel=new eW}initialize(){this.addHandles(z(()=>this.visible,e=>this._visibleChange(e)))}destroy(){this._animationPromise=null}get location(){return this.viewModel.location}set location(e){this.viewModel.location=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get visible(){return this.viewModel.visible}set visible(e){this.viewModel.visible=e}show(e){const{location:t,promise:r}=e;t&&(this.viewModel.location=t),this.visible=!0;const n=()=>this.hide();r&&r.catch(()=>{}).then(n)}hide(){this.visible=!1}render(){const{visible:e}=this,{screenLocation:t}=this.viewModel,r=!!t,n=e&&r,s=!e&&r,a={[WA.spinnerStart]:n,[WA.spinnerFinish]:s},o=this._getPositionStyles();return F("div",{class:this.classes(WA.base,a),styles:o})}_visibleChange(e){if(e)return void(this.viewModel.screenLocationEnabled=!0);const t=B0(this._animationDelay);this._animationPromise=t,t.catch(()=>{}).then(()=>{this._animationPromise===t&&(this.viewModel.screenLocationEnabled=!1,this._animationPromise=null)})}_getPositionStyles(){const{screenLocation:e,view:t}=this.viewModel;if(S(t)||S(e))return{};const{padding:r}=t;return{left:e.x-r.left+"px",top:e.y-r.top+"px"}}};h([p()],Rf.prototype,"location",null),h([p()],Rf.prototype,"view",null),h([p({type:eW})],Rf.prototype,"viewModel",void 0),h([p()],Rf.prototype,"visible",null),Rf=h([D("esri.widgets.Spinner")],Rf);const rde=Rf,tW="OBJECTID";var H9;(function(i){i[i.size=22]="size",i[i.lineWidth=50]="lineWidth",i[i.maxSize=120]="maxSize",i[i.maxOutlineSize=80]="maxOutlineSize",i[i.tallSymbolWidth=20]="tallSymbolWidth"})(H9||(H9={}));const j9=St("android");St("chrome")||j9&&j9>=4;aI();function iW(i){return i&&"opacity"in i?i.opacity*iW(i.parent):1}async function nde(i,e){if(!i)return;const t=i.sourceLayer,r=(y(e)&&e.useSourceLayer?t:i.layer)??t,n=iW(r);if(y(i.symbol)&&(!y(e)||e.ignoreGraphicSymbol!==!0)){const x=i.symbol.type==="web-style"?await i.symbol.fetchSymbol({...e,cache:y(e)?e.webStyleCache:null}):i.symbol.clone();return eA(x,null,n),x}const s=(y(e)?e.renderer:null)??(r&&"renderer"in r?r.renderer:null);let a=s&&"getSymbolAsync"in s?await s.getSymbolAsync(i,e):null;if(!a)return;if(a=a.type==="web-style"?await a.fetchSymbol({...e,cache:y(e)?e.webStyleCache:null}):a.clone(),!(s&&"visualVariables"in s&&s.visualVariables&&s.visualVariables.length))return eA(a,null,n),a;if("arcadeRequiredForVisualVariables"in s&&s.arcadeRequiredForVisualVariables&&(S(e)||S(e.arcade))){const x={...ct(e)};x.arcade=await iD(),e=x}const o=await G(()=>import("./UniqueValueRenderer-08f8851c.js").then(x=>x.v),["assets/UniqueValueRenderer-08f8851c.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/enumeration-3a03bd31.js","assets/jsonMap-7b8332c9.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/geometry-b7901087.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/locale-30120714.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/Clonable-545593ce.js","assets/LegendOptions-010d0873.js","assets/reactiveUtils-4dabbb80.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/number-27cf8195.js","assets/Identifiable-bfe1ff30.js","assets/jsonUtils-229211af.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js"]),l=[],c=[],u=[],d=[];for(const x of s.visualVariables)switch(x.type){case"color":l.push(x);break;case"opacity":c.push(x);break;case"rotation":d.push(x);break;case"size":x.target||u.push(x)}const m=!!l.length&&l[l.length-1],f=m?o.getColor(m,i,e):null,_=!!c.length&&c[c.length-1];let g=_?o.getOpacity(_,i,e):null;if(n!=null&&(g=g!=null?g*n:n),eA(a,f,g),u.length){const x=o.getAllSizes(u,i,e);await Bte(a,x)}for(const x of d)Gte(a,o.getRotationAngle(x,i,e),x.axis);return a}let Od=class{constructor(e,t){this._owner=t,this._properties={},this._afterDispatchHandle=null;for(const r in e){const n=e[r],s=new Ree(n,void 0,void 0,2,2);this._properties[r]={pool:s,acquired:[]}}this._afterDispatchHandle=o7(()=>this._release())}destroy(){this._afterDispatchHandle&&(this._afterDispatchHandle.remove(),this._afterDispatchHandle=null);for(const e in this._properties){const t=this._properties[e];for(const r of t.acquired)r5(r)||t.pool.release(r);t.pool.destroy(),t.pool=null,t.acquired=null}this._properties=null,this._owner=null}get(e){const t=this._owner._get(e),r=this._properties[e];let n=r.pool.acquire();for(r.acquired.push(n);n===t;)r.acquired.push(n),n=r.pool.acquire();return n}_release(){for(const e in this._properties){const t=this._properties[e];let r=0;for(const n of t.acquired)r5(n)?t.acquired[r++]=n:t.pool.release(n);t.acquired.length=r}}};const sde=St("mac")?"Meta":"Ctrl",aR={8:"Backspace",9:"Tab",13:"Enter",27:"Escape",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete"};for(let i=48;i<58;i++)aR[i]=String.fromCharCode(i);for(let i=1;i<25;i++)aR[111+i]=`F${i}`;for(let i=65;i<91;i++)aR[i]=[String.fromCharCode(i+32),String.fromCharCode(i)];function ade(i){if(i.key!==void 0)return Ol(i);const e=aR[i.keyCode];return Array.isArray(e)?i.shiftKey?e[1]:e[0]:e}function ode(i){switch(i){case"Ctrl":case"Alt":case"Shift":case"Meta":case"Primary":return!0}return!1}let lde=class{constructor(e,t=[]){this.eventType=e,this.keyModifiers=t}matches(e){if(e.type!==this.eventType)return!1;if(this.keyModifiers.length===0)return!0;const t=e.modifiers;for(const r of this.keyModifiers)if(!t.has(r))return!1;return!0}};const q9=J.getLogger("esri.views.input.InputHandler");let Ei=class{constructor(e){this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=e}get incomingEventMatches(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(const e in this._incoming){const t=this._incoming[e];for(const r of t)this._incomingEventMatches.push(r.match)}}return this._incomingEventMatches}get incomingEventTypes(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map(e=>e.eventType)),this._incomingEventTypes}get outgoingEventTypes(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}get hasSideEffects(){return this._hasSideEffects}get hasPendingInputs(){return!1}onInstall(e){this._manager?q9.error("This InputHandler has already been registered with an InputManager"):(e.setEventCallback(t=>this._handleEvent(t)),e.setUninstallCallback(()=>this._onUninstall()),this._manager=e)}onUninstall(){}registerIncoming(e,t,r){let n;typeof t=="function"?(r=t,n=[]):n=t||[];const s=typeof e=="string"?new lde(e,n):e,a=()=>{this._incomingEventTypes=null,this._incomingEventMatches=null},o=u=>{const d=this._incoming[u.match.eventType];if(d){const m=d.indexOf(u);d.splice(m,1),a(),this._manager&&this._manager.updateDependencies()}},l=new cde(s,r,{onPause:o,onRemove:o,onResume:u=>{const d=this._incoming[u.match.eventType];d&&!d.includes(u)&&(d.push(u),a(),this._manager&&this._manager.updateDependencies())}});let c=this._incoming[s.eventType];return c||(c=[],this._incoming[s.eventType]=c),c.push(l),a(),this._manager&&this._manager.updateDependencies(),l}registerOutgoing(e){if(this._outgoing[e])throw new Error("There is already a callback registered for this outgoing InputEvent: "+e);const t=new hde(e,{onEmit:(r,n,s,a)=>{var o;(o=this._manager)==null||o.emit(r.eventType,n,s,a)},onRemove:r=>{var n;delete this._outgoing[r.eventType],(n=this._manager)==null||n.updateDependencies()}});return this._outgoing[e]=t,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),t}startCapturingPointer(e){var t;(t=this._manager)==null||t.setPointerCapture(e,!0)}stopCapturingPointer(e){var t;(t=this._manager)==null||t.setPointerCapture(e,!1)}refreshHasPendingInputs(){var e;(e=this._manager)==null||e.refreshHasPendingInputs()}_onUninstall(){this._manager?(this.onUninstall(),this._manager=null):q9.error("This InputHandler is not registered with an InputManager")}_handleEvent(e){var r;const t=this._incoming[e.type];if(t){for(const n of t)if(n.match.matches(e)&&((r=n.callback)==null||r.call(n,e),e.shouldStopPropagation()))break}}},cde=class{constructor(e,t,r){this.match=e,this._callback=t,this._handler=r}pause(){this._handler.onPause(this)}resume(){this._handler.onResume(this)}remove(){this._handler.onRemove(this)}get callback(){return this._callback}},hde=class{constructor(e,t){this.eventType=e,this._removed=!1,this._handler=t}emit(e,t,r){this._removed||this._handler.onEmit(this,e,t,r)}remove(){this._removed=!0,this._handler.onRemove(this)}},ude=class extends Ei{constructor(e){super(!0),this._onChange=e,this._value="mouse",this._x=null,this._y=null,this.registerIncoming("pointer-move",t=>{this._update(t.data)})}_update(e){const t=e.native.pointerType==="touch"?"touch":"mouse",{x:r,y:n}=e;t===this._value&&this._x===r&&this._y===n||(this._value=t,this._x=r,this._y=n,this._onChange(t,r,n))}},dde=class extends Ei{constructor(){super(!0),this._activeTouchPointerIds=new Set,this._multiTouchActive=new yie(!1),this._onPointerAdd=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.add(e.native.pointerId),this._update())},this._onPointerRemove=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.delete(e.native.pointerId),this._update())},this.registerIncoming("pointer-down",this._onPointerAdd),this.registerIncoming("pointer-up",this._onPointerRemove),this.registerIncoming("pointer-capture-lost",this._onPointerRemove),this.registerIncoming("pointer-cancel",this._onPointerRemove)}get multiTouchActive(){return this._multiTouchActive.get()}_update(){this._multiTouchActive.set(this._activeTouchPointerIds.size>1)}},uc=class extends ue{constructor(e){super(e),this._pointerCaptures=new Map,this._nameToGroup={},this._handlers=[],this._handlersPriority=[],this._currentPropagation=null,this._updateDependenciesAfterPropagation=!1,this._sourceEvents=new Set,this._keyModifiers=new Set,this._activeKeyModifiers=new Set,this._stoppedPropagationEventIds=new Set,this.primaryKey=sde,this._latestPointerType="mouse",this._propertiesPool=new Od({latestPointerLocation:mde},this),this.latestPointerLocation=null,this.test={timestamp:void 0,hasCurrentPropagation:()=>!!this._currentPropagation}}initialize(){this.eventSource.onEventReceived=this._onEventReceived.bind(this),this._installRecognizers()}destroy(){const e=Object.keys(this._nameToGroup);for(const t of e)this.uninstallHandlers(t);this.eventSource.destroy(),this._currentPropagation=null,this._propertiesPool.destroy()}get hasPendingInputs(){return this._handlers.some(e=>e.handler.hasPendingInputs)}get latestPointerType(){return this._latestPointerType}get multiTouchActive(){return this._multiTouchHandler.multiTouchActive}installHandlers(e,t,r=Yh.INTERNAL){if(this._nameToGroup[e])return void J.getLogger(this.declaredClass).error("There is already an InputHandler group registered under the name `"+e+"`");if(t.length===0)return void J.getLogger(this.declaredClass).error("Can't register a group of zero handlers");const n={name:e,handlers:t.map(s=>({handler:s,active:!0,removed:!1,priorityIndex:0,groupPriority:r,eventCallback:null,uninstallCallback:null}))};this._nameToGroup[e]=n;for(let s=n.handlers.length-1;s>=0;s--){const a=n.handlers[s];this._handlers.push(a),a.handler.onInstall({updateDependencies:()=>{this.updateDependencies()},emit:(o,l,c,u,d)=>{this._emitInputEvent(a.priorityIndex+1,o,l,c,d,u)},setPointerCapture:(o,l)=>{this._setPointerCapture(n,a,o,l)},setEventCallback:o=>{a.eventCallback=o},setUninstallCallback:o=>{a.uninstallCallback=o},refreshHasPendingInputs:()=>{this.notifyChange("hasPendingInputs")}})}this.updateDependencies()}uninstallHandlers(e){const t=this._nameToGroup[e];t?(t.handlers.forEach(r=>{var n;r.removed=!0,(n=r.uninstallCallback)==null||n.call(r)}),delete this._nameToGroup[e],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):J.getLogger(this.declaredClass).error("There is no InputHandler group registered under the name `"+e+"`")}hasHandlers(e){return this._nameToGroup[e]!==void 0}updateDependencies(){if(this._currentPropagation)return void(this._updateDependenciesAfterPropagation=!0);this._updateDependenciesAfterPropagation=!1;const e=new Set,t=new Set;this._handlersPriority=[];for(let r=this._handlers.length-1;r>=0;r--){const n=this._handlers[r];n.priorityIndex=r,this._handlersPriority.push(n)}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(let r=this._handlersPriority.length-1;r>=0;r--){const n=this._handlersPriority[r];n.priorityIndex=r;let s=n.handler.hasSideEffects;if(!s){for(const a of n.handler.outgoingEventTypes)if(e.has(a)){s=!0;break}}if(s)for(const a of n.handler.incomingEventMatches){e.add(a.eventType);for(const o of a.keyModifiers)ode(o)||t.add(o)}n.active=s}this._sourceEvents=e,this._keyModifiers=t,this._pointerCaptures.size>0&&this._sourceEvents.add("pointer-capture-lost"),this._keyModifiers.size>0&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up")),this.eventSource&&(this.eventSource.activeEvents=this._sourceEvents)}_setLatestPointer(e,t,r){this._latestPointerType=e;const n=this._get("latestPointerLocation");if(S(n)||n.x!==t||n.y!==r){const s=this._propertiesPool.get("latestPointerLocation");s.x=t,s.y=r,this._set("latestPointerLocation",s)}}_onEventReceived(e,t){if(e==="pointer-capture-lost"){const s=t;this._pointerCaptures.delete(s.native.pointerId)}this._updateKeyModifiers(e,t);const r=this.test.timestamp!=null?this.test.timestamp:t.native?t.native.timestamp:void 0,n=t.native?t.native.cancelable:void 0;this._emitInputEventFromSource(e,t,r,n)}_updateKeyModifiers(e,t){if(!t)return;let r=!1;const n=()=>{if(!r){const o=new Set;this._activeKeyModifiers.forEach(l=>{o.add(l)}),this._activeKeyModifiers=o,r=!0}},s=(o,l)=>{l&&!this._activeKeyModifiers.has(o)?(n(),this._activeKeyModifiers.add(o)):!l&&this._activeKeyModifiers.has(o)&&(n(),this._activeKeyModifiers.delete(o))};if(e==="key-down"||e==="key-up"){const o=t.key;this._keyModifiers.has(o)&&s(o,e==="key-down")}const a=t.native;s("Alt",!(!a||!a.altKey)),s("Ctrl",!(!a||!a.ctrlKey)),s("Shift",!(!a||!a.shiftKey)),s("Meta",!(!a||!a.metaKey)),s("Primary",this._activeKeyModifiers.has(this.primaryKey))}_installRecognizers(){this._latestPointerHandler=new ude((e,t,r)=>this._setLatestPointer(e,t,r)),this._multiTouchHandler=new dde,this.installHandlers("input-manager-logic",[this._latestPointerHandler,this._multiTouchHandler],Yh.ALWAYS),this.recognizers.length>0&&this.installHandlers("default",this.recognizers,Yh.INTERNAL)}_setPointerCapture(e,t,r,n){const s=e.name+"-"+t.priorityIndex,a=this._pointerCaptures.get(r.pointerId)||new Set;this._pointerCaptures.set(r.pointerId,a),n?(a.add(s),a.size===1&&this.eventSource&&this.eventSource.setPointerCapture(r,!0)):a.has(s)&&(a.delete(s),a.size===0&&(this._pointerCaptures.delete(r.pointerId),this.eventSource&&this.eventSource.setPointerCapture(r,!1)))}_garbageCollectRemovedHandlers(){this._handlers=this._handlers.filter(e=>!e.removed),this.updateDependencies()}_emitInputEventFromSource(e,t,r,n){this._emitInputEvent(0,e,t,r,n)}_emitInputEvent(e,t,r,n,s,a){const o=n!==void 0?n:this._currentPropagation?this._currentPropagation.timestamp:performance.now(),l=s!==void 0&&s,c={event:new pde(t,r,o,a||this._activeKeyModifiers,l),priorityIndex:e};this._currentPropagation?this._currentPropagation.events.push(c):this._doNewPropagation(c)}_doNewPropagation(e){this._currentPropagation={events:new p5,currentHandler:null,needsHandlerGarbageCollect:!1,timestamp:e.event.timestamp},this._currentPropagation.events.push(e),this._continuePropagation()}_continuePropagation(){var t,r;const e=Vee(this._currentPropagation);for(;e.events.length>0;){const{event:n,priorityIndex:s}=e.events.pop(),a=n.data&&n.data.eventId;if(!(a!=null&&this._stoppedPropagationEventIds.has(a)))for(e.currentHandler=this._handlersPriority[s];e.currentHandler;){if(e.currentHandler.removed)e.needsHandlerGarbageCollect=!0;else{if(e.currentHandler.active&&!n.shouldStopPropagation()&&((r=(t=e.currentHandler).eventCallback)==null||r.call(t,n)),n.shouldStopPropagation()){a!=null&&this._stoppedPropagationEventIds.add(a);break}if(n.shouldPausePropagation(()=>this._continuePropagation()))return void this._pausePropagation({event:n,priorityIndex:e.currentHandler.priorityIndex+1})}e.currentHandler=this._handlersPriority[e.currentHandler.priorityIndex+1]}}e.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers(),this.hasPendingInputs||this._stoppedPropagationEventIds.clear(),this._currentPropagation=null,this._updateDependenciesAfterPropagation&&this.updateDependencies()}_pausePropagation(e){const t=new p5;t.push(e);const r=this._currentPropagation;if(r){for(;r.events.length;)t.push(r.events.pop());r.events=t,r.currentHandler=null}}_compareHandlerPriority(e,t){if(e.handler.hasSideEffects!==t.handler.hasSideEffects)return e.handler.hasSideEffects?1:-1;if(e.groupPriority!==t.groupPriority)return e.groupPriority>t.groupPriority?-1:1;for(const r of e.handler.incomingEventMatches)for(const n of t.handler.incomingEventMatches){if(r.eventType!==n.eventType)continue;const s=r.keyModifiers.filter(a=>n.keyModifiers.includes(a));if(s.length===r.keyModifiers.length!=(s.length===n.keyModifiers.length))return r.keyModifiers.length>n.keyModifiers.length?-1:1}return e.priorityIndex>t.priorityIndex?-1:1}_sortHandlersPriority(e){const t=[];for(const r of e){let n=0;for(;n<t.length&&this._compareHandlerPriority(r,t[n])>=0;)n++;t.splice(n,0,r)}return t}get debug(){const e=t=>{const r=this._setPointerCapture;this._setPointerCapture=()=>{},t(),this._setPointerCapture=r};return{injectEvent:(t,r)=>{e(()=>{this._onEventReceived(t,r)})},disablePointerCapture:e}}};h([p({readOnly:!0})],uc.prototype,"hasPendingInputs",null),h([p({constructOnly:!0})],uc.prototype,"eventSource",void 0),h([p({constructOnly:!0})],uc.prototype,"recognizers",void 0),h([p()],uc.prototype,"_latestPointerType",void 0),h([p()],uc.prototype,"latestPointerType",null),h([p()],uc.prototype,"multiTouchActive",null),h([p({readOnly:!0})],uc.prototype,"latestPointerLocation",void 0),uc=h([D("esri.views.input.InputManager")],uc);let pde=class{constructor(e,t,r,n,s){this.type=e,this.data=t,this.timestamp=r,this.modifiers=n,this.cancelable=s,this._propagationState=Gp.NONE,this._resumeCallback=null}stopPropagation(){this._propagationState|=Gp.STOPPED}shouldStopPropagation(){return(this._propagationState&Gp.STOPPED)!=0}async(e){this._propagationState|=Gp.PAUSED;const t=(r,n)=>{this._propagationState&=~Gp.PAUSED;const s=this._resumeCallback;if(this._resumeCallback=null,s&&s(),n)throw r;return r};return(typeof e=="function"?e():e).then(r=>t(r,!1),r=>t(r,!0))}shouldPausePropagation(e){return!!(this._propagationState&Gp.PAUSED)&&(this._resumeCallback=e,!0)}preventDefault(){this.data.native.preventDefault()}};var Gp;(function(i){i[i.NONE=0]="NONE",i[i.STOPPED=1]="STOPPED",i[i.PAUSED=2]="PAUSED"})(Gp||(Gp={}));const Yh={ALWAYS:1,DEFAULT:0,TOOL:-1,WIDGET:-2,INTERNAL:-3};let mde=class{};function W9(i){return i&&typeof i.highlight=="function"}function fde(i){return i&&typeof i.maskOccludee=="function"}function P5e(i,e,t){return S(i)||i>t&&(e===0||i<e)}function R5e(i,e){return i>0||e>0}function A5e(i){const e=i.effectiveScaleRange;return{minScale:(e==null?void 0:e.minScale)??0,maxScale:(e==null?void 0:e.maxScale)??0}}const oR={iconZoom:"esri-icon-zoom-in-magnifying-glass",iconTrash:"esri-icon-trash",iconBrowseClusteredFeatures:"esri-icon-table"},og=new $x({id:"zoom-to-feature",title:"{messages.zoom}",className:oR.iconZoom}),X9=new $x({id:"remove-selected-feature",title:"{messages.remove}",className:oR.iconTrash}),n0=new $x({id:"zoom-to-clustered-features",title:"{messages.zoom}",className:oR.iconZoom}),s0=new $x({id:"browse-clustered-features",title:"{messages.browseClusteredFeatures}",className:oR.iconBrowseClusteredFeatures}),gde="esri.widgets.Popup.PopupViewModel",x2=J.getLogger(gde),_de=i=>{const{event:e,view:t}=i,{action:r}=e,n=t&&t.popup;if(!r)return Promise.reject(new K("trigger-action:missing-arguments","Event has no action"));if(!n)return Promise.reject(new K("trigger-action:missing-arguments","view.popup is missing"));const{disabled:s,id:a}=r;if(!a)return Promise.reject(new K("trigger-action:invalid-action","action.id is missing"));if(s)return Promise.reject(new K("trigger-action:invalid-action","Action is disabled"));if(a===og.id)return vde(n.viewModel).catch(ste);if(a===n0.id)return bde(n.viewModel);if(a===s0.id)return n.featureMenuOpen=!n.featureMenuOpen,n.viewModel.browseClusterEnabled=!n.viewModel.browseClusterEnabled,Promise.resolve();if(n.viewModel.browseClusterEnabled=!1,a===X9.id){n.close();const{selectedFeature:o}=n;if(!o)return Promise.reject(new K(`trigger-action:${X9.id}`,"selectedFeature is required",{selectedFeature:o}));const{sourceLayer:l}=o;return l?l.remove(o):t.graphics.remove(o),Promise.resolve()}return Promise.resolve()};function rW(i){const{selectedFeature:e,location:t,view:r}=i;return r?r.type==="3d"?e||t:i.get("selectedFeature.geometry")||t:null}function Qf(i){var e,t;return(i==null?void 0:i.isAggregate)&&((t=(e=i==null?void 0:i.sourceLayer)==null?void 0:e.featureReduction)==null?void 0:t.type)==="cluster"}async function yde(i,e){if((e==null?void 0:e.type)!=="3d"||!i||i.declaredClass!=="esri.Graphic")return!0;const t=e.getViewForGraphic(i);if(t&&"whenGraphicBounds"in t){let r;try{r=await t.whenGraphicBounds(i,{useViewElevation:!0})}catch{}return!r||!r.boundingBox||r.boundingBox[0]===r.boundingBox[3]&&r.boundingBox[1]===r.boundingBox[4]&&r.boundingBox[2]===r.boundingBox[5]}return!0}async function vde(i){const{location:e,selectedFeature:t,view:r,zoomFactor:n}=i,s=rW(i);if(!s){const c=new K("zoom-to:invalid-target-or-view","Cannot zoom to location without a target and view.",{target:s,view:r});throw x2.error(c),c}const a=r.scale/n,o=i.get("selectedFeature.geometry")||e,l=o&&o.type==="point"&&await yde(t,r);og.active=!0,og.disabled=!0;try{await i.zoomTo({target:{target:s,scale:l?a:void 0}})}catch{const u=new K("zoom-to:invalid-graphic","Could not zoom to the location of the graphic.",{graphic:t});x2.error(u)}finally{og.active=!1,og.disabled=!1,i.zoomToLocation=null,l&&(i.location=o)}}async function bde(i){const{selectedFeature:e,view:t}=i;if((t==null?void 0:t.type)!=="2d"){const o=new K("zoomToCluster:invalid-view","View must be 2d MapView.",{view:t});throw x2.error(o),o}if(!Qf(e)){const o=new K("zoomToCluster:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:e});throw x2.error(o),o}const r=e.sourceLayer,n=await t.whenLayerView(r),s=n.createQuery();s.aggregateIds=[e.getObjectId()],n0.active=!0,n0.disabled=!0;const{extent:a}=await n.queryExtent(s);await i.zoomTo({target:a}),n0.active=!1,n0.disabled=!1}async function wde(i){const{selectedFeature:e,view:t}=i,r=e.sourceLayer,n=await t.whenLayerView(r),s=n.createQuery();s.aggregateIds=[e.getObjectId()];const{extent:a}=await n.queryExtent(s);i.selectedClusterBoundaryFeature.geometry=a,t.graphics.add(i.selectedClusterBoundaryFeature)}async function xde(i){const{selectedFeature:e,view:t}=i,r=e.sourceLayer,n=await t.whenLayerView(r),s=n.createQuery();s.aggregateIds=[e.getObjectId()],s0.active=!0,s0.disabled=!0;const{features:a}=await n.queryFeatures(s);s0.active=!1,s0.disabled=!1,t.popup.open({features:[e].concat(a),featureMenuOpen:!0})}function Tde(i){const e=i.features.filter(t=>Qf(t));e.length&&(i.features=e)}const nW=i=>{let e=class extends i{constructor(...t){super(...t),this.goToOverride=null,this.view=null}callGoTo(t){const{view:r}=this;return this.goToOverride?this.goToOverride(r,t):r.goTo(t.target,t.options)}};return h([p()],e.prototype,"goToOverride",void 0),h([p()],e.prototype,"view",void 0),e=h([D("esri.widgets.support.GoTo")],e),e},Hb=pt.ofType({key:"type",defaultKeyValue:"button",base:kte,typeMap:{button:$x,toggle:Vte}}),Cde=()=>[og.clone()],Sde=()=>[n0.clone(),s0.clone()];let Gt=class extends nW(Jq){constructor(e){super(e),this._handles=new Ft,this._pendingPromises=new Set,this._fetchFeaturesController=null,this._selectedClusterFeature=null,this.featurePage=null,this.actions=new Hb,this.activeFeature=null,this.defaultPopupTemplateEnabled=!1,this.autoCloseEnabled=!1,this.autoOpenEnabled=!0,this.browseClusterEnabled=!1,this.content=null,this.featuresPerPage=20,this.featureViewModelAbilities=null,this.featureViewModels=[],this.highlightEnabled=!0,this.includeDefaultActions=!0,this.selectedClusterBoundaryFeature=new jc({symbol:new jte({outline:{width:1.5,color:"cyan"},style:"none"})}),this.title=null,this.updateLocationEnabled=!1,this.view=null,this.visible=!1,this.zoomFactor=4,this.zoomToLocation=null}get isLoadingFeature(){return this.featureViewModels.some(e=>e.waitingForContent)}initialize(){this._handles.add([z(()=>[this.autoOpenEnabled,this.view],()=>this._autoOpenEnabledChange()),this.on("view-change",()=>this._autoClose()),z(()=>[this.highlightEnabled,this.selectedFeature,this.visible,this.view],()=>this._highlightSelectedFeature()),z(()=>[this.highlightEnabled,this.activeFeature,this.visible,this.view],()=>this._highlightActiveFeature()),z(()=>{var e,t;return(t=(e=this.view)==null?void 0:e.animation)==null?void 0:t.state},e=>this._animationStateChange(e)),z(()=>this.location,e=>this._locationChange(e)),z(()=>this.selectedFeature,e=>this._selectedFeatureChange(e)),z(()=>[this.selectedFeatureIndex,this.featureCount,this.featuresPerPage],()=>this._selectedFeatureIndexChange()),z(()=>[this.featurePage,this.selectedFeatureIndex,this.featureCount,this.featuresPerPage,this.featureViewModels],()=>this._setGraphicOnFeatureViewModels()),z(()=>this.featureViewModels,()=>this._featureViewModelsChange()),this.on("trigger-action",e=>_de({event:e,view:this.view})),cs(()=>!this.waitingForResult,()=>this._waitingForResultChange(),ri),z(()=>{var e,t;return[this.features,(e=this.view)==null?void 0:e.map,(t=this.view)==null?void 0:t.spatialReference]},()=>this._updateFeatureVMs()),z(()=>{var e;return(e=this.view)==null?void 0:e.scale},()=>this._viewScaleChange()),cs(()=>!this.visible,()=>this.browseClusterEnabled=!1),z(()=>this.browseClusterEnabled,e=>e?this.enableClusterBrowsing():this.disableClusterBrowsing())])}destroy(){this._cancelFetchingFeatures(),this._handles.destroy(),this._handles=null,this._pendingPromises.clear(),this.browseClusterEnabled=!1,this.view=null}get active(){return!(!this.visible||this.waitingForResult)}get allActions(){const e=this._get("allActions")||new Hb;e.removeAll();const{actions:t,defaultActions:r,defaultPopupTemplateEnabled:n,includeDefaultActions:s,selectedFeature:a}=this,o=s?r.concat(t):t,l=a&&(typeof a.getEffectivePopupTemplate=="function"&&a.getEffectivePopupTemplate(n)||a.popupTemplate),c=l&&l.actions,u=l&&l.overwriteActions?c:c?c.concat(o):o;return u&&u.filter(Boolean).forEach(d=>e.add(d)),e}get defaultActions(){const e=this._get("defaultActions")||new Hb;return e.removeAll(),e.addMany(Qf(this.selectedFeature)?Sde():Cde()),e}get featureCount(){return this.features.length}get features(){return this._get("features")||[]}set features(e){const t=e||[];this._set("features",t);const{pendingPromisesCount:r,promiseCount:n,selectedFeatureIndex:s}=this,a=n&&t.length;a&&r&&s===-1?this.selectedFeatureIndex=0:a&&s!==-1||(this.selectedFeatureIndex=t.length?0:-1)}get location(){return this._get("location")||null}set location(e){const t=this.get("view.spatialReference.isWebMercator");e&&e.get("spatialReference.isWGS84")&&t&&(e=_P(e)),this._set("location",e)}get pendingPromisesCount(){return this._pendingPromises.size}get waitingForResult(){return!(!(this._fetchFeaturesController||this.pendingPromisesCount>0)||this.featureCount!==0)}get promiseCount(){return this.promises.length}get promises(){return this._get("promises")||[]}set promises(e){if(this._pendingPromises.clear(),this.features=[],!Array.isArray(e)||!e.length)return this._set("promises",[]),void this.notifyChange("pendingPromisesCount");this._set("promises",e),(e=e.slice(0)).forEach(t=>{this._pendingPromises.add(t);const r=s=>{this._pendingPromises.has(t)&&this._updateFeatures(s),this._updatePendingPromises(t)},n=()=>this._updatePendingPromises(t);t.then(r,n)}),this.notifyChange("pendingPromisesCount")}get selectedFeature(){const{features:e,selectedFeatureIndex:t}=this;return t===-1?null:e[t]||null}get selectedFeatureIndex(){const e=this._get("selectedFeatureIndex");return typeof e=="number"?e:-1}set selectedFeatureIndex(e){const{featureCount:t}=this;e=isNaN(e)||e<-1||!t?-1:(e+t)%t,this.activeFeature=null,this._set("selectedFeatureIndex",e)}get selectedFeatureViewModel(){return this.featureViewModels[this.selectedFeatureIndex]||null}get state(){return this.get("view.ready")?"ready":"disabled"}centerAtLocation(){const{view:e}=this,t=rW(this);return t?this.callGoTo({target:{target:t,scale:e.scale}}):Promise.reject(new K("center-at-location:invalid-target-or-view","Cannot center at a location without a target and view.",{target:t,view:e}))}zoomTo(e){return this.callGoTo(e)}clear(){this.set({promises:[],features:[],content:null,title:null,location:null,activeFeature:null})}fetchFeatures(e,t){const{view:r}=this;if(!r||!e)throw new K("fetch-features:invalid-screenpoint-or-view","Cannot fetch features without a screenPoint and view.",{screenPoint:e,view:r});return r.fetchPopupFeatures(e,{event:t&&t.event,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,signal:t&&t.signal})}open(e){const t={updateLocationEnabled:!1,promises:[],fetchFeatures:!1,...e,visible:!0},{fetchFeatures:r}=t;delete t.fetchFeatures,r&&this._setFetchFeaturesPromises(t.location);const n=["actionsMenuOpen","collapsed","featureMenuOpen"];for(const s of n)delete t[s];this.set(t)}triggerAction(e){const t=this.allActions.getItemAt(e);t&&!t.disabled&&this.emit("trigger-action",{action:t})}next(){return this.selectedFeatureIndex=this.selectedFeatureIndex+1,this}previous(){return this.selectedFeatureIndex=this.selectedFeatureIndex-1,this}disableClusterBrowsing(){Tde(this),this._clearBrowsedClusterGraphics()}async enableClusterBrowsing(){const{view:e,selectedFeature:t}=this;(e==null?void 0:e.type)==="2d"?Qf(t)?(await wde(this),await xde(this)):J.getLogger(this.declaredClass).warn("enableClusterBrowsing:invalid-selectedFeature: Selected feature must represent an aggregate/cluster graphic.",t):J.getLogger(this.declaredClass).warn("enableClusterBrowsing:invalid-view: View must be 2d MapView.",t)}_animationStateChange(e){this.zoomToLocation||(og.disabled=e==="waiting-for-target")}_clearBrowsedClusterGraphics(){var t;const e=(t=this.view)==null?void 0:t.graphics;e&&(e.remove(this.selectedClusterBoundaryFeature),e.remove(this._selectedClusterFeature)),this._selectedClusterFeature=null,this.selectedClusterBoundaryFeature.geometry=null}_viewScaleChange(){if(Qf(this.selectedFeature))return this.browseClusterEnabled=!1,this.visible=!1,void this.clear();this.browseClusterEnabled&&(this.features=[this.selectedFeature])}_locationChange(e){const{selectedFeature:t,updateLocationEnabled:r}=this;r&&e&&(!t||t.geometry)&&this.centerAtLocation()}_selectedFeatureIndexChange(){this.featurePage=this.featureCount>1?Math.floor(this.selectedFeatureIndex/this.featuresPerPage)+1:null}_featureViewModelsChange(){this.featurePage=this.featureCount>1?1:null}_setGraphicOnFeatureViewModels(){const{features:e,featureCount:t,featurePage:r,featuresPerPage:n,featureViewModels:s}=this;if(r===null)return;const a=((r-1)*n+t)%t,o=a+n;s.slice(a,o).forEach((l,c)=>{l&&!l.graphic&&(l.graphic=e[a+c])})}async _selectedFeatureChange(e){if(!e)return;const{location:t,updateLocationEnabled:r,view:n}=this;if(this.browseClusterEnabled)return this._selectedClusterFeature&&(n.graphics.remove(this._selectedClusterFeature),this._selectedClusterFeature=null),Qf(e)?void 0:(e.symbol=await nde(e),this._selectedClusterFeature=e,void n.graphics.add(this._selectedClusterFeature));!r&&t||!e.geometry?r&&!e.geometry&&this.centerAtLocation().then(()=>{this.location=n.center.clone()}):this.location=ct(this._getPointFromGeometry(e.geometry))}_waitingForResultChange(){!this.featureCount&&this.promises&&(this.visible=!1)}_setFetchFeaturesPromises(e){return this._fetchFeaturesWithController(this._getScreenPoint(e||this.location)).then(t=>{const{clientOnlyGraphics:r,promisesPerLayerView:n}=t,s=Promise.resolve(r),a=n.map(o=>o.promise);this.promises=[s,...a]})}_destroyFeatureVMs(){this.featureViewModels.forEach(e=>e&&!e.destroyed&&e.destroy()),this._set("featureViewModels",[])}_updateFeatureVMs(){const{selectedFeature:e,features:t,featureViewModels:r}=this;if(Qf(e)||(this.browseClusterEnabled=!1),this._destroyFeatureVMs(),!t||!t.length)return;const n=r.slice(0),s=[];t.forEach((a,o)=>{var c,u;if(!a)return;let l=null;if(n.some((d,m)=>(d&&d.graphic===a&&(l=d,n.splice(m,1)),!!l)),l)s[o]=l;else{const d=new tN({abilities:this.featureViewModelAbilities,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,spatialReference:(c=this.view)==null?void 0:c.spatialReference,graphic:a===e?a:null,map:(u=this.view)==null?void 0:u.map,view:this.view});s[o]=d}}),n.forEach(a=>a&&!a.destroyed&&a.destroy()),this._set("featureViewModels",s)}_getScreenPoint(e){const{view:t}=this;return t&&e&&typeof t.toScreen=="function"?t.toScreen(e):null}_autoOpenEnabledChange(){const e="auto-fetch-features",{_handles:t,autoOpenEnabled:r}=this;if(t.remove(e),r&&this.view){const n=this.view.on("click",s=>{s.pointerType==="mouse"&&s.button!==0||this._fetchFeaturesAndOpen(s)},Yh.WIDGET);t.add(n,e)}}_cancelFetchingFeatures(){const e=this._fetchFeaturesController;e&&e.abort(),this._fetchFeaturesController=null,this.notifyChange("waitingForResult")}_fetchFeaturesWithController(e,t){this._cancelFetchingFeatures();const r=new AbortController,{signal:n}=r;this._fetchFeaturesController=r,this.notifyChange("waitingForResult");const s=this.fetchFeatures(e,{signal:n,event:t});return s.catch(()=>{}).then(()=>{this._fetchFeaturesController=null,this.notifyChange("waitingForResult")}),s}_fetchFeaturesAndOpen(e){const{screenPoint:t,mapPoint:r}=e,{view:n}=this;this._fetchFeaturesWithController(t,e).then(s=>{const{clientOnlyGraphics:a,promisesPerLayerView:o,location:l}=s,c=[Promise.resolve(a),...o.map(u=>u.promise)];return n.popup.open({location:l||r,promises:c}),s})}_updatePendingPromises(e){e&&this._pendingPromises.has(e)&&(this._pendingPromises.delete(e),this.notifyChange("pendingPromisesCount"))}_autoClose(){this.autoCloseEnabled&&(this.visible=!1)}_getPointFromGeometry(e){var t;return S(e)?null:e.type==="point"?e:e.type==="extent"?e.center:e.type==="polygon"?e.centroid:e.type==="multipoint"||e.type==="polyline"?(t=e.extent)==null?void 0:t.center:null}async _getLayerView(e,t){return await e.when(),e.whenLayerView(t)}_getHighlightLayer(e){const{layer:t,sourceLayer:r}=e;return r&&"layer"in r&&r.layer?r.layer:(r==null?void 0:r.type)==="map-notes"||(r==null?void 0:r.type)==="subtype-group"?r:t}_getHighlightTarget(e,t){const r=t.type==="imagery"?void 0:"objectIdField"in t?t.objectIdField||tW:null,n=e.attributes;return n&&r&&n[r]||e}async _highlightActiveFeature(){const e="highlight-active-feature";this._handles.remove(e);const{highlightEnabled:t,view:r,activeFeature:n,visible:s}=this;if(!(n&&r&&t&&s))return;const a=this._getHighlightLayer(n);if(!(a&&a instanceof uI))return;const o=this._getLayerView(r,a);this._highlightActiveFeaturePromise=o;const l=await o;if(!(l&&W9(l)&&this._highlightActiveFeaturePromise===o&&this.activeFeature&&this.highlightEnabled))return;const c=l.highlight(this._getHighlightTarget(n,a));this._handles.add(c,e)}async _highlightSelectedFeature(){const e="highlight-selected-feature";this._handles.remove(e);const{selectedFeature:t,highlightEnabled:r,view:n,visible:s}=this;if(!(t&&n&&r&&s))return;const a=this._getHighlightLayer(t);if(!(a&&a instanceof uI))return;const o=this._getLayerView(n,a);this._highlightSelectedFeaturePromise=o;const l=await o;if(!(l&&W9(l)&&this._highlightSelectedFeaturePromise===o&&this.selectedFeature&&this.highlightEnabled&&this.visible))return;const c=l.highlight(this._getHighlightTarget(t,a));this._handles.add(c,e)}_updateFeatures(e){const{features:t}=this;if(!e||!e.length)return;if(!t.length)return void(this.features=e);const r=e.filter(n=>!t.includes(n));this.features=t.concat(r)}};h([p()],Gt.prototype,"featurePage",void 0),h([p()],Gt.prototype,"isLoadingFeature",null),h([p({type:Hb})],Gt.prototype,"actions",void 0),h([p({readOnly:!0})],Gt.prototype,"active",null),h([p()],Gt.prototype,"activeFeature",void 0),h([p({readOnly:!0})],Gt.prototype,"allActions",null),h([p({type:Boolean})],Gt.prototype,"defaultPopupTemplateEnabled",void 0),h([p()],Gt.prototype,"autoCloseEnabled",void 0),h([p()],Gt.prototype,"autoOpenEnabled",void 0),h([p()],Gt.prototype,"browseClusterEnabled",void 0),h([p()],Gt.prototype,"content",void 0),h([p({type:Hb,readOnly:!0})],Gt.prototype,"defaultActions",null),h([p({readOnly:!0})],Gt.prototype,"featureCount",null),h([p()],Gt.prototype,"features",null),h([p()],Gt.prototype,"featuresPerPage",void 0),h([p()],Gt.prototype,"featureViewModelAbilities",void 0),h([p({readOnly:!0})],Gt.prototype,"featureViewModels",void 0),h([p()],Gt.prototype,"highlightEnabled",void 0),h([p()],Gt.prototype,"includeDefaultActions",void 0),h([p({type:Ne})],Gt.prototype,"location",null),h([p({readOnly:!0})],Gt.prototype,"pendingPromisesCount",null),h([p({readOnly:!0})],Gt.prototype,"selectedClusterBoundaryFeature",void 0),h([p({readOnly:!0})],Gt.prototype,"waitingForResult",null),h([p({readOnly:!0})],Gt.prototype,"promiseCount",null),h([p()],Gt.prototype,"promises",null),h([p({value:null,readOnly:!0})],Gt.prototype,"selectedFeature",null),h([p({value:-1})],Gt.prototype,"selectedFeatureIndex",null),h([p({readOnly:!0})],Gt.prototype,"selectedFeatureViewModel",null),h([p({readOnly:!0})],Gt.prototype,"state",null),h([p()],Gt.prototype,"title",void 0),h([p()],Gt.prototype,"updateLocationEnabled",void 0),h([p()],Gt.prototype,"view",void 0),h([p()],Gt.prototype,"visible",void 0),h([p()],Gt.prototype,"zoomFactor",void 0),h([p()],Gt.prototype,"zoomToLocation",void 0),h([p()],Gt.prototype,"centerAtLocation",null),Gt=h([D("esri.widgets.Popup.PopupViewModel")],Gt);const sW=Gt,Q9="selected-index",Ede=0,Z9="popup-spinner",le={calciteThemeLight:"calcite-theme-light",calciteThemeDark:"calcite-theme-dark",iconLeftTriangleArrow:"esri-icon-left-triangle-arrow",iconRightTriangleArrow:"esri-icon-right-triangle-arrow",iconDockToTop:"esri-icon-maximize",iconDockToBottom:"esri-icon-dock-bottom",iconDockToLeft:"esri-icon-dock-left",iconDockToRight:"esri-icon-dock-right",iconClose:"esri-icon-close",iconUndock:"esri-icon-minimize",iconCheckMark:"esri-icon-check-mark",iconLoading:"esri-icon-loading-indicator",iconDefaultAction:"esri-icon-default-action",iconActionsMenu:"esri-icon-handle-horizontal",rotating:"esri-rotating",base:"esri-popup",widget:"esri-widget",main:"esri-popup__main-container",loadingContainer:"esri-popup__loading-container",isCollapsible:"esri-popup--is-collapsible",isCollapsed:"esri-popup--is-collapsed",shadow:"esri-popup--shadow",isDocked:"esri-popup--is-docked",isDockedTopLeft:"esri-popup--is-docked-top-left",isDockedTopCenter:"esri-popup--is-docked-top-center",isDockedTopRight:"esri-popup--is-docked-top-right",isDockedBottomLeft:"esri-popup--is-docked-bottom-left",isDockedBottomCenter:"esri-popup--is-docked-bottom-center",isDockedBottomRight:"esri-popup--is-docked-bottom-right",alignTopCenter:"esri-popup--aligned-top-center",alignBottomCenter:"esri-popup--aligned-bottom-center",alignTopLeft:"esri-popup--aligned-top-left",alignBottomLeft:"esri-popup--aligned-bottom-left",alignTopRight:"esri-popup--aligned-top-right",alignBottomRight:"esri-popup--aligned-bottom-right",isFeatureMenuOpen:"esri-popup--feature-menu-open",isActionsMenuOpen:"esri-popup--actions-menu-open",hasFeatureUpdated:"esri-popup--feature-updated",header:"esri-popup__header",headerButtons:"esri-popup__header-buttons",headerContainer:"esri-popup__header-container",headerContainerButton:"esri-popup__header-container--button",headerTitle:"esri-popup__header-title",content:"esri-popup__content",contentHasFlows:"esri-content--has-flows",contentFlowItem:"esri-content__flow-item",footer:"esri-popup__footer",footerHasPagination:"esri-popup__footer--has-pagination",footerHasActions:"esri-popup__footer--has-actions",footerHasActionsMenu:"esri-popup__footer--has-actions-menu",button:"esri-popup__button",buttonDisabled:"esri-popup__button--disabled",buttonDock:"esri-popup__button--dock",icon:"esri-popup__icon",iconDock:"esri-popup__icon--dock-icon",inlineActionsContainer:"esri-popup__inline-actions-container",actionsMenuButton:"esri-popup__actions-menu-button",actions:"esri-popup__actions",action:"esri-popup__action",actionImage:"esri-popup__action-image",actionText:"esri-popup__action-text",actionToggle:"esri-popup__action-toggle",actionToggleOn:"esri-popup__action-toggle--on",actionExit:"esri-popup__action--exit",pointer:"esri-popup__pointer",pointerDirection:"esri-popup__pointer-direction",navigation:"esri-popup__navigation",paginationPrevious:"esri-popup__pagination-previous",paginationNext:"esri-popup__pagination-next",paginationPreviousIconLTR:"esri-popup__pagination-previous-icon",paginationPreviousIconRTL:"esri-popup__pagination-previous-icon--rtl",paginationNextIconLTR:"esri-popup__pagination-next-icon",paginationNextIconRTL:"esri-popup__pagination-next-icon--rtl",featureMenu:"esri-popup__feature-menu",featureMenuList:"esri-popup__feature-menu-list",featureMenuItem:"esri-popup__feature-menu-item",featureMenuViewport:"esri-popup__feature-menu-viewport",featureMenuHeader:"esri-popup__feature-menu-header",featureMenuNote:"esri-popup__feature-menu-note",featureMenuSelected:"esri-popup__feature-menu-item--selected",featureMenuButton:"esri-popup__feature-menu-button",featureMenuTitle:"esri-popup__feature-menu-title",featureMenuObserver:"esri-popup__feature-menu-observer",featureMenuLoader:"esri-popup__feature-menu-loader",collapseButton:"esri-popup__collapse-button",collapseIcon:"esri-popup__collapse-icon"},Y9={buttonEnabled:!0,position:"auto",breakpoint:{width:544}},K9="esri-popup";function _u(i,e){return e===void 0?`${K9}__${i}`:`${K9}__${i}-${e}`}const J9={closeButton:!0,featureNavigation:!0};let Be=class extends Yq(Hn){constructor(e,t){super(e,t),this._blurClose=!1,this._blurContainer=!1,this._containerNode=null,this._mainContainerNode=null,this._featureMenuNode=null,this._actionsMenuNode=null,this._focusClose=!1,this._focusContainer=!1,this._focusDockButton=!1,this._focusFeatureMenuButton=!1,this._focusActionsMenuButton=!1,this._focusFirstFeature=!1,this._focusFirstAction=!1,this._handles=new Ft,this._pointerOffsetInPx=16,this._spinner=null,this._feature=null,this._featureMenuIntersectionObserverCallback=([r])=>{r!=null&&r.isIntersecting&&this.viewModel.featurePage++},this._featureMenuIntersectionObserver=new IntersectionObserver(this._featureMenuIntersectionObserverCallback,{root:window.document}),this._displaySpinnerThrottled=M0(()=>this._displaySpinner(),Ede),this._exitRelatedRecordsActions=new WeakMap,this._flowItems=new pt,this.alignment="auto",this.collapsed=!1,this.collapseEnabled=!0,this.dockEnabled=!1,this.featureMenuOpen=!1,this.headingLevel=2,this.maxInlineActions=3,this.messages=null,this.messagesCommon=null,this.spinnerEnabled=!0,this.viewModel=new sW,this.visibleElements={...J9},this._addSelectedFeatureIndexHandle(),this.addHandles([z(()=>{var r;return(r=this.viewModel)==null?void 0:r.screenLocation},()=>this._positionContainer()),z(()=>{var r;return[(r=this.viewModel)==null?void 0:r.active,this.dockEnabled]},()=>this._toggleScreenLocationEnabled()),z(()=>{var r;return(r=this.viewModel)==null?void 0:r.screenLocation},(r,n)=>{!!r!=!!n&&this.reposition()}),z(()=>{var r,n,s,a,o,l;return[(n=(r=this.viewModel)==null?void 0:r.view)==null?void 0:n.padding,(a=(s=this.viewModel)==null?void 0:s.view)==null?void 0:a.size,(o=this.viewModel)==null?void 0:o.active,(l=this.viewModel)==null?void 0:l.location,this.alignment]},()=>this.reposition()),z(()=>this.spinnerEnabled,r=>this._spinnerEnabledChange(r)),z(()=>{var r,n;return(n=(r=this.viewModel)==null?void 0:r.view)==null?void 0:n.size},(r,n)=>this._updateDockEnabledForViewSize(r,n)),z(()=>{var r;return(r=this.viewModel)==null?void 0:r.view},(r,n)=>this._viewChange(r,n)),z(()=>{var r,n;return(n=(r=this.viewModel)==null?void 0:r.view)==null?void 0:n.ready},(r,n)=>this._viewReadyChange(r,n)),z(()=>{var r,n;return[(r=this.viewModel)==null?void 0:r.waitingForResult,(n=this.viewModel)==null?void 0:n.location]},()=>{this._hideSpinner(),this._displaySpinnerThrottled()}),z(()=>this.selectedFeatureWidget,()=>this._destroyFlowItemWidgets()),z(()=>{var r,n,s,a;return[(n=(r=this.selectedFeatureWidget)==null?void 0:r.viewModel)==null?void 0:n.title,(a=(s=this.selectedFeatureWidget)==null?void 0:s.viewModel)==null?void 0:a.state]},()=>this._setTitleFromFeatureWidget()),z(()=>{var r,n,s,a;return[(n=(r=this.selectedFeatureWidget)==null?void 0:r.viewModel)==null?void 0:n.content,(a=(s=this.selectedFeatureWidget)==null?void 0:s.viewModel)==null?void 0:a.state]},()=>this._setContentFromFeatureWidget()),cs(()=>!this.collapsed,()=>{var r,n;((n=(r=this.viewModel)==null?void 0:r.view)==null?void 0:n.widthBreakpoint)==="xsmall"&&this.viewModel.active&&this.collapseEnabled&&this.viewModel.centerAtLocation()}),wr(()=>{var r;return(r=this.viewModel)==null?void 0:r.allActions},"change",()=>this._watchActions()),z(()=>{var r;return(r=this.viewModel)==null?void 0:r.allActions},()=>this._watchActions(),Qe),z(()=>{var r;return(r=this.viewModel)==null?void 0:r.featureViewModels},()=>this._featureMenuViewportScrollTop()),wr(()=>this._flowItems,"change",()=>{this.notifyChange("_activeFlowItemWidget"),this.scheduleRender()}),z(()=>{var r,n,s,a;return[(n=(r=this._activeFlowItemWidget)==null?void 0:r.viewModel)==null?void 0:n.state,(a=(s=this._activeFlowItemWidget)==null?void 0:s.viewModel)==null?void 0:a.title]},()=>this.scheduleRender())])}loadDependencies(){return Promise.all([G(()=>import("./calcite-flow-2e30cea8.js"),["assets/calcite-flow-2e30cea8.js","assets/widget-fb292a2f.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/intl-65a3e389.js","assets/number-27cf8195.js","assets/jsonMap-7b8332c9.js","assets/locale-30120714.js","assets/messages-2289086c.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/assets-8d3e737a.js","assets/Evented-a45c8b0f.js","assets/Promise-376ab9f6.js","assets/reactiveUtils-4dabbb80.js","assets/uuid-73213768.js","assets/observers-edc9938f.js"]),G(()=>import("./calcite-flow-item-8e6353bf.js"),["assets/calcite-flow-item-8e6353bf.js","assets/widget-fb292a2f.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/intl-65a3e389.js","assets/number-27cf8195.js","assets/jsonMap-7b8332c9.js","assets/locale-30120714.js","assets/messages-2289086c.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/assets-8d3e737a.js","assets/Evented-a45c8b0f.js","assets/Promise-376ab9f6.js","assets/reactiveUtils-4dabbb80.js","assets/uuid-73213768.js","assets/guid-e49c4e43.js","assets/action-0ae695b2.js","assets/observers-edc9938f.js","assets/interactive-52dcf836.js","assets/icon-40b00e67.js","assets/tooltip-a9404009.js"]),G(()=>import("./calcite-action-a94942fd.js"),["assets/calcite-action-a94942fd.js","assets/action-0ae695b2.js","assets/widget-fb292a2f.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/intl-65a3e389.js","assets/number-27cf8195.js","assets/jsonMap-7b8332c9.js","assets/locale-30120714.js","assets/messages-2289086c.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/assets-8d3e737a.js","assets/Evented-a45c8b0f.js","assets/Promise-376ab9f6.js","assets/reactiveUtils-4dabbb80.js","assets/uuid-73213768.js","assets/observers-edc9938f.js","assets/interactive-52dcf836.js","assets/icon-40b00e67.js","assets/guid-e49c4e43.js"]),G(()=>import("./calcite-tooltip-deda8ecc.js"),["assets/calcite-tooltip-deda8ecc.js","assets/tooltip-a9404009.js","assets/widget-fb292a2f.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/intl-65a3e389.js","assets/number-27cf8195.js","assets/jsonMap-7b8332c9.js","assets/locale-30120714.js","assets/messages-2289086c.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/assets-8d3e737a.js","assets/Evented-a45c8b0f.js","assets/Promise-376ab9f6.js","assets/reactiveUtils-4dabbb80.js","assets/uuid-73213768.js","assets/guid-e49c4e43.js"]),G(()=>import("./calcite-icon-938ab0b8.js"),["assets/calcite-icon-938ab0b8.js","assets/icon-40b00e67.js","assets/widget-fb292a2f.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/intl-65a3e389.js","assets/number-27cf8195.js","assets/jsonMap-7b8332c9.js","assets/locale-30120714.js","assets/messages-2289086c.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/assets-8d3e737a.js","assets/Evented-a45c8b0f.js","assets/Promise-376ab9f6.js","assets/reactiveUtils-4dabbb80.js","assets/uuid-73213768.js","assets/observers-edc9938f.js"])])}destroy(){var e,t;this._destroyFlowItemWidgets(),this._destroySelectedFeatureWidget(),this._destroySpinner(),(e=this._handles)==null||e.destroy(),this._unobserveFeatureMenuObserver(),(t=this._featureMenuIntersectionObserver)==null||t.disconnect(),this._handles=null}get actionsMenuId(){return`${this.id}-actions-menu`}get actionsMenuButtonId(){return`${this.id}-actions-menu-button`}get featureMenuId(){return`${this.id}-feature-menu`}get titleId(){return`${this.id}-popup-title`}get contentId(){return`${this.id}-popup-content`}get hasContent(){const{selectedFeatureWidget:e,viewModel:t}=this;if(!e)return!!(t!=null&&t.content);const r=e.viewModel;if(r!=null&&r.waitingForContent||(r==null?void 0:r.state)==="error")return!0;const n=r==null?void 0:r.content;return Array.isArray(n)?!!n.length:!!n}get featureNavigationVisible(){return this.viewModel.active&&this.viewModel.featureCount>1&&this.visibleElements.featureNavigation}get collapsible(){return!!(this.collapseEnabled&&this.viewModel.title&&this.hasContent)}get featureMenuVisible(){return this.featureNavigationVisible&&this.featureMenuOpen}get contentCollapsed(){return this.collapsible&&!this.featureMenuVisible&&this.collapsed}get dividedActions(){return this._divideActions()}get _activeFlowItemWidget(){const{_flowItems:e}=this;return e.getItemAt(e.length-1)||null}get actions(){return this.viewModel.actions}set actions(e){this.viewModel.actions=e}set actionsMenuOpen(e){this._set("actionsMenuOpen",!!e)}get actionsMenuOpen(){return!!this.viewModel.active&&this._get("actionsMenuOpen")}get autoCloseEnabled(){return this.viewModel.autoCloseEnabled}set autoCloseEnabled(e){this.viewModel.autoCloseEnabled=e}get autoOpenEnabled(){return this.viewModel.autoOpenEnabled}set autoOpenEnabled(e){this.viewModel.autoOpenEnabled=e}get defaultPopupTemplateEnabled(){return this.viewModel.defaultPopupTemplateEnabled}set defaultPopupTemplateEnabled(e){this.viewModel.defaultPopupTemplateEnabled=e}get content(){return this.viewModel.content}set content(e){this.viewModel.content=e}get currentAlignment(){return this._getCurrentAlignment()}get currentDockPosition(){return this._getCurrentDockPosition()}get dockOptions(){return this._get("dockOptions")||Y9}set dockOptions(e){const t={...Y9},r=this.get("viewModel.view.breakpoints"),n={};r&&(n.width=r.xsmall,n.height=r.xsmall);const s={...t,...e},a={...t.breakpoint,...n},{breakpoint:o}=s;o===!0?s.breakpoint=a:typeof o=="object"&&(s.breakpoint={...a,...o}),this._set("dockOptions",s),this._setCurrentDockPosition(),this.reposition()}get featureCount(){return this.viewModel.featureCount}get features(){return this.viewModel.features}set features(e){this.viewModel.features=e}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get highlightEnabled(){return this.viewModel.highlightEnabled}set highlightEnabled(e){this.viewModel.highlightEnabled=e}get location(){return this.viewModel.location}set location(e){this.viewModel.location=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get promises(){return this.viewModel.promises}set promises(e){this.viewModel.promises=e}get selectedFeature(){return this.viewModel.selectedFeature}get selectedFeatureIndex(){return this.viewModel.selectedFeatureIndex}set selectedFeatureIndex(e){this.viewModel.selectedFeatureIndex=e}get selectedFeatureWidget(){const{_feature:e,visibleElements:t,headingLevel:r,_flowItems:n}=this,{selectedFeatureViewModel:s}=this.viewModel,a={...t,title:!1};return s?(e?(e.viewModel=s,e.visibleElements=a):this._feature=new tde({flowItems:n,headingLevel:r+1,viewModel:s,visibleElements:a}),this._feature):null}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}get updateLocationEnabled(){return this.viewModel.updateLocationEnabled}set updateLocationEnabled(e){this.viewModel.updateLocationEnabled=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get visible(){return this.viewModel.visible}set visible(e){this.viewModel.visible=e}castVisibleElements(e){return{...J9,...e}}blur(){const{active:e}=this.viewModel;e||J.getLogger(this.declaredClass).warn("Popup can only be blurred when currently active."),this.visibleElements.closeButton?this._blurClose=!0:this._blurContainer=!0,this.scheduleRender()}clear(){return this.viewModel.clear()}close(){this.visible=!1}fetchFeatures(e,t){return this.viewModel.fetchFeatures(e,t)}focus(){const{active:e}=this.viewModel;e||J.getLogger(this.declaredClass).warn("Popup can only be focused when currently active."),this.visibleElements.closeButton?this._focusClose=!0:this._focusContainer=!0,this.scheduleRender()}next(){return this.viewModel.next()}open(e){var s,a;this._handles.remove(Q9);const t=!!e&&!!e.featureMenuOpen,r=!!e&&!!e.actionsMenuOpen,n={collapsed:!!e&&!!e.collapsed,actionsMenuOpen:r,featureMenuOpen:t};((a=(s=this.viewModel)==null?void 0:s.view)==null?void 0:a.widthBreakpoint)==="xsmall"&&(n.collapsed=!0),this.set(n),this.viewModel.open(e),this._shouldFocus(e),this._addSelectedFeatureIndexHandle()}previous(){return this.viewModel.previous()}reposition(){this.renderNow(),this._positionContainer(),this._setCurrentAlignment()}triggerAction(e){return this.viewModel.triggerAction(e)}render(){var g,x,b,v;const{actionsMenuOpen:e,dockEnabled:t,featureMenuVisible:r,dividedActions:n,currentAlignment:s,currentDockPosition:a}=this,{active:o}=this.viewModel,{menuActions:l}=n,c=o&&l.length>1&&e,u=o&&t,d=o&&!t,m=(x=(g=this.selectedFeature)==null?void 0:g.layer)==null?void 0:x.title,f=(v=(b=this.selectedFeature)==null?void 0:b.layer)==null?void 0:v.id,_={[le.alignTopCenter]:s==="top-center",[le.alignBottomCenter]:s==="bottom-center",[le.alignTopLeft]:s==="top-left",[le.alignBottomLeft]:s==="bottom-left",[le.alignTopRight]:s==="top-right",[le.alignBottomRight]:s==="bottom-right",[le.isDocked]:u,[le.shadow]:d,[le.isDockedTopLeft]:a==="top-left",[le.isDockedTopCenter]:a==="top-center",[le.isDockedTopRight]:a==="top-right",[le.isDockedBottomLeft]:a==="bottom-left",[le.isDockedBottomCenter]:a==="bottom-center",[le.isDockedBottomRight]:a==="bottom-right",[le.isFeatureMenuOpen]:r,[le.isActionsMenuOpen]:c};return F("div",{class:this.classes(le.base,_),role:"presentation","data-layer-title":m,"data-layer-id":f,bind:this,afterCreate:this._positionContainer,afterUpdate:this._positionContainer},o?[this.renderMainContainer(),this.renderPointer()]:null)}renderLoadingIcon(){return F("span",{"aria-hidden":"true",class:this.classes(le.icon,le.iconLoading,le.rotating)})}renderNavigationLoading(){const{messagesCommon:e}=this;return this.viewModel.pendingPromisesCount?F("div",{key:_u("loading-container"),role:"presentation",class:le.loadingContainer,"aria-label":e.loading,title:e.loading},this.renderLoadingIcon()):null}renderPreviousIcon(){const e=zh(this.container),t={[le.iconRightTriangleArrow]:e,[le.paginationPreviousIconRTL]:e,[le.iconLeftTriangleArrow]:!e,[le.paginationPreviousIconLTR]:!e};return F("span",{"aria-hidden":"true",class:this.classes(le.icon,t)})}renderPreviousButton(){const{messages:e}=this;return F("div",{role:"button",tabIndex:0,bind:this,onclick:this._previous,onkeydown:this._previous,class:this.classes(le.button,le.paginationPrevious),"aria-label":e.previous,title:e.previous},this.renderPreviousIcon())}renderNextIcon(){const e=zh(this.container),t={[le.iconLeftTriangleArrow]:e,[le.paginationNextIconRTL]:e,[le.iconRightTriangleArrow]:!e,[le.paginationNextIconLTR]:!e};return F("span",{"aria-hidden":"true",class:this.classes(le.icon,t)})}renderNextButton(){const{messages:e}=this;return F("div",{role:"button",tabIndex:0,bind:this,onclick:this._next,onkeydown:this._next,class:this.classes(le.button,le.paginationNext),"aria-label":e.next,title:e.next},this.renderNextIcon())}renderFeatureMenuButton(){const{featureMenuOpen:e,featureMenuId:t,messagesCommon:r}=this,{featureCount:n,selectedFeatureIndex:s}=this.viewModel;return F("div",{role:"button",tabIndex:0,bind:this,onclick:this._toggleFeatureMenu,onkeydown:this._toggleFeatureMenu,afterCreate:this._focusFeatureMenuButtonNode,afterUpdate:this._focusFeatureMenuButtonNode,class:this.classes(le.button,le.featureMenuButton),"aria-haspopup":"true","aria-controls":t,"aria-expanded":e.toString(),"aria-label":r.menu,title:r.menu},this._getPageText(n,s))}renderNavigationButtons(){return this.featureNavigationVisible?[this.renderPreviousButton(),this.renderNavigationLoading()||this.renderFeatureMenuButton(),this.renderNextButton()]:null}renderDockIcon(){const{dockEnabled:e}=this,t=this._wouldDockTo(),r={[le.iconUndock]:e,[le.iconDock]:!e,[le.iconDockToRight]:!e&&(t==="top-right"||t==="bottom-right"),[le.iconDockToLeft]:!e&&(t==="top-left"||t==="bottom-left"),[le.iconDockToTop]:!e&&t==="top-center",[le.iconDockToBottom]:!e&&t==="bottom-center"};return F("span",{"aria-hidden":"true",class:this.classes(r,le.icon)})}renderDockButton(){var s,a,o;const{dockEnabled:e,messages:t}=this,r=(a=(s=this.viewModel)==null?void 0:s.view)==null?void 0:a.widthBreakpoint,n=e?t.undock:t.dock;return r!=="xsmall"&&((o=this.dockOptions)!=null&&o.buttonEnabled)?F("div",{role:"button","aria-label":n,title:n,tabIndex:0,bind:this,onclick:this._toggleDockEnabled,onkeydown:this._toggleDockEnabled,afterCreate:this._focusDockButtonNode,afterUpdate:this._focusDockButtonNode,class:this.classes(le.button,le.buttonDock)},this.renderDockIcon()):null}renderTitle(){const{title:e}=this.viewModel,{titleId:t,collapsible:r,contentCollapsed:n,messagesCommon:s}=this,a={[le.headerContainerButton]:r},o=F(YF,{level:this.headingLevel,class:le.headerTitle,innerHTML:e}),l=r?F("button",{key:`${e}--collapsible`,id:t,title:n?s.expand:s.collapse,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes(le.headerContainer,a),"aria-expanded":n?"false":"true",onclick:this._toggleCollapsed,type:"button"},o,F("calcite-icon",{class:le.collapseIcon,key:"collapse-icon",icon:n?"chevron-down":"chevron-up",scale:"m"})):F("div",{key:e,id:t,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes(le.headerContainer,a)},o);return e?l:null}renderCloseIcon(){return F("span",{"aria-hidden":"true",class:this.classes(le.icon,le.iconClose)})}renderCloseButton(){const{visibleElements:e,messagesCommon:t}=this;return e.closeButton?F("div",{role:"button",tabIndex:0,bind:this,onclick:this._close,onkeydown:this._close,class:le.button,"aria-label":t.close,title:t.close,afterCreate:this._closeButtonNodeUpdated,afterUpdate:this._closeButtonNodeUpdated},this.renderCloseIcon()):null}renderHeader(){return F("header",{class:le.header},this.renderTitle(),F("div",{class:le.headerButtons},this.renderDockButton(),this.renderCloseButton()))}renderContentContainer(){const{contentId:e,hasContent:t,contentCollapsed:r,_flowItems:n,messagesCommon:s}=this,{content:a}=this.viewModel,o=n.toArray(),l={[le.contentHasFlows]:!!o.length};return t&&!r?F("div",{key:a,enterAnimation:this._createFeatureUpdatedAnimation(),id:e,class:this.classes(le.content,l)},F("calcite-flow",{bind:this,onCalciteFlowItemBack:this._handleBackClick},F("calcite-flow-item",{bind:this,"data-node-ref":"_rootFlowItemNode","intl-back":s.back,afterCreate:ME,key:"root-flow-item"},this.renderContent()),o.map(c=>this.renderFlowItem(c))),o.map(c=>this.renderFlowItemTooltip(c))):null}renderFlowItem(e){const{messages:t,messagesCommon:r}=this,n=w2();return F("calcite-flow-item",{class:this.classes({[le.calciteThemeDark]:!n,[le.calciteThemeLight]:n}),heading:e.title,"intl-back":r.back,description:this._getFlowItemDescription(e),key:`flow-item-${e.viewModel.uid}`},F("calcite-action",{class:le.actionExit,icon:"move-up",label:t==null?void 0:t.exitRelatedRecords,text:t==null?void 0:t.exitRelatedRecords,slot:"header-actions-start",bind:this,afterCreate:s=>this._storeExitRelatedRecordsAction(e,s),onclick:this._destroyFlowItemWidgets}),F("div",{class:this.classes(le.contentFlowItem,{[le.calciteThemeDark]:n,[le.calciteThemeLight]:!n})},e.render()))}renderFlowItemTooltip(e){const{messages:t,_exitRelatedRecordsActions:r}=this,n=w2();return F("calcite-tooltip",{class:this.classes({[le.calciteThemeDark]:!n,[le.calciteThemeLight]:n}),key:`exit-related-records-tooltip-${e.viewModel.uid}`,label:t==null?void 0:t.exitRelatedRecords,overlayPositioning:"fixed",referenceElement:r.get(e),placement:"top"},t==null?void 0:t.exitRelatedRecords)}renderActionsMenuButton(){const{actionsMenuId:e,actionsMenuButtonId:t,actionsMenuOpen:r,dividedActions:n,messagesCommon:s}=this,a=r?s.close:s.open,{menuActions:o}=n;return o.length?F("div",{key:_u("actions-menu-button"),class:this.classes(le.button,le.actionsMenuButton),role:"button",id:t,"aria-haspopup":"true","aria-controls":r?e:null,tabIndex:0,bind:this,onclick:this._toggleActionsMenu,onkeydown:this._toggleActionsMenu,afterCreate:this._focusActionsMenuButtonNode,afterUpdate:this._focusActionsMenuButtonNode,"aria-label":a,title:a},F("span",{"aria-hidden":"true",class:le.iconActionsMenu})):null}renderMenuActions(){const{actionsMenuId:e,actionsMenuButtonId:t,actionsMenuOpen:r,dividedActions:n}=this,{menuActions:s}=n;return s.length&&r?F("ul",{id:e,role:"menu","aria-labelledby":t,key:_u("actions"),class:le.actions,bind:this,onkeyup:this._handleActionMenuKeyup,afterCreate:this._actionsMenuNodeUpdated,afterUpdate:this._actionsMenuNodeUpdated},s.toArray().map(a=>this.renderAction({action:a,type:"menu-item"}))):null}renderInlineActions(){const{inlineActions:e}=this.dividedActions;return!!e.length&&e.toArray().map(t=>this.renderAction({action:t,type:"inline"}))}renderInlineActionsContainer(){const{inlineActions:e,menuActions:t}=this.dividedActions,r=!!e.length,n=!!t.length;return r||n?F("div",{key:"inline-actions-container","data-inline-actions":r.toString(),"data-menu-actions":n.toString(),class:le.inlineActionsContainer},this.renderInlineActions(),this.renderActionsMenuButton(),this.renderMenuActions()):null}renderNavigation(){return this.featureNavigationVisible?F("section",{key:_u("navigation"),class:this.classes(le.navigation)},this.renderNavigationButtons()):null}renderFooter(){const{featureNavigationVisible:e,dividedActions:t}=this,{inlineActions:r,menuActions:n}=t,s=!!r.length,a=!!n.length,o={[le.footerHasPagination]:e,[le.footerHasActions]:s,[le.footerHasActionsMenu]:a};return e||s?F("div",{key:_u("feature-buttons"),class:this.classes(le.footer,o)},this.renderInlineActionsContainer(),this.renderNavigation()):null}renderFeatureMenuContainer(){const{messages:e}=this,{featureViewModels:t,isLoadingFeature:r}=this.viewModel,n=gc(e.selectedFeatures,{total:t.length});return F("section",{key:_u("menu"),class:le.featureMenu},F("strong",{class:le.featureMenuHeader},n),F("nav",{bind:this,class:le.featureMenuViewport,"data-node-ref":"_featureMenuViewportNode",afterCreate:ME},this.renderFeatureMenu(),F("div",{class:le.featureMenuObserver,bind:this,afterCreate:this._featureMenuIntersectionObserverCreated}),r?F("div",{class:le.featureMenuLoader},this.renderLoadingIcon()):null))}renderPointer(){return this.dockEnabled?null:F("div",{key:_u("pointer"),class:le.pointer,role:"presentation"},F("div",{class:this.classes(le.pointerDirection,le.shadow)}))}renderMainContainer(){const{dockEnabled:e,currentAlignment:t,currentDockPosition:r,titleId:n,contentId:s,collapsible:a,hasContent:o,contentCollapsed:l,visibleElements:c}=this,{title:u}=this.viewModel,d=t==="bottom-left"||t==="bottom-center"||t==="bottom-right"||r==="top-left"||r==="top-center"||r==="top-right",m=t==="top-left"||t==="top-center"||t==="top-right"||r==="bottom-left"||r==="bottom-center"||r==="bottom-right",f={[le.shadow]:e,[le.isCollapsible]:a,[le.isCollapsed]:l};return F("div",{class:this.classes(le.main,le.widget,f),tabIndex:c.closeButton?null:-1,role:"dialog","aria-labelledby":u?n:"","aria-describedby":o&&!l?s:"",bind:this,onkeyup:this._handleMainKeyup,afterCreate:this._mainContainerNodeUpdated,afterUpdate:this._mainContainerNodeUpdated},d?this.renderFooter():null,d?this.renderFeatureMenuContainer():null,this.renderHeader(),this.renderContentContainer(),m?this.renderFooter():null,m?this.renderFeatureMenuContainer():null)}renderContent(){var t;const e=(t=this.viewModel)==null?void 0:t.content;return e?typeof e=="string"?F("div",{class:_r.contentNode,key:e,innerHTML:e}):this.renderNodeContent(e):null}renderActionText(e){return F("span",{key:"text",class:le.actionText},e)}renderActionIcon(e){const t=this._getActionClass(e),r=this._getActionImage(e),n={[le.iconLoading]:e.active,[le.rotating]:e.active,[le.icon]:!!t,[le.actionImage]:!e.active&&!!r};return t&&(n[t]=!e.active),F("span",{key:"icon","aria-hidden":"true",class:this.classes(le.icon,n),styles:this._getIconStyles(r)})}renderAction(e){const{action:t,type:r}=e,n=this._getActionTitle(t),s={[le.action]:t.type!=="toggle",[le.actionToggle]:t.type==="toggle",[le.actionToggleOn]:t.type==="toggle"&&t.value,[le.buttonDisabled]:t.disabled},a=[this.renderActionIcon(t),this.renderActionText(n)],o=r==="menu-item"?F("li",{key:t.uid,role:"menuitem",tabIndex:0,title:n,"aria-label":n,class:this.classes(le.button,s),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-uid":t.uid,onclick:this._triggerAction,onkeydown:this._triggerAction},a):F("div",{key:t.uid,role:"button",tabIndex:0,title:n,"aria-label":n,class:this.classes(le.button,s),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-uid":t.uid,onclick:this._triggerAction,onkeydown:this._triggerAction},a);return t.visible?o:null}renderFeatureMenuItem(e,t){const{messages:r,messagesCommon:n}=this,{selectedFeatureIndex:s,selectedFeatureViewModel:a}=this.viewModel,o=e===a,l={[le.featureMenuSelected]:o},c=o?F("span",{key:_u(`feature-menu-selected-feature-${s}`),title:r.selectedFeature,"aria-label":r.selectedFeature,class:le.iconCheckMark}):null,u=F("span",{innerHTML:e.title||n.untitled});return F("li",{role:"menuitem",tabIndex:-1,key:_u(`feature-menu-feature-${s}`),class:this.classes(l,le.featureMenuItem),bind:this,"data-feature-index":t,onblur:this._removeActiveFeature,onfocus:this._setActiveFeature,onkeyup:this._handleFeatureMenuItemKeyup,onclick:this._selectFeature,onkeydown:this._selectFeature,onmouseover:this._setActiveFeature,onmouseleave:this._removeActiveFeature},F("span",{class:le.featureMenuTitle},u,c))}renderFeatureMenu(){const{featureMenuId:e}=this,{featureViewModels:t}=this.viewModel;return t.length>1?F("ol",{class:le.featureMenuList,id:e,bind:this,afterCreate:this._featureMenuNodeUpdated,afterUpdate:this._featureMenuNodeUpdated,onkeyup:this._handleFeatureMenuKeyup,role:"menu"},t.filter(r=>!!r.graphic).map((r,n)=>this.renderFeatureMenuItem(r,n))):null}_storeExitRelatedRecordsAction(e,t){this._exitRelatedRecordsActions.set(e,t),this.scheduleRender()}_getFlowItemDescription(e){return"featureCountDescription"in e?e.featureCountDescription:e.viewModel.description}_destroyFlowItemWidgets(){this._flowItems.removeAll().forEach(e=>{"showAllEnabled"in e.viewModel&&(e.viewModel.showAllEnabled=!1),e.viewModel=null,e.destroy()})}_handleBackClick(){const e=this._flowItems.pop();this._exitRelatedRecordsActions.delete(e),"showAllEnabled"in e.viewModel&&(e.viewModel.showAllEnabled=!1),e&&(e.viewModel=null,e.destroy())}_getActionTitle(e){const{messages:t,selectedFeature:r,messagesCommon:n}=this,{id:s}=e,a=r==null?void 0:r.attributes,o=s==="zoom-to-feature"?gc(e.title,{messages:t}):s==="remove-selected-feature"?gc(e.title,{messages:n}):s==="zoom-to-clustered-features"||s==="browse-clustered-features"?gc(e.title,{messages:t}):e.title;return o&&a?gc(o,a):o}_getActionClass(e){const{selectedFeature:t}=this,r=t==null?void 0:t.attributes,{className:n,image:s}=e,a=s||n?n:le.iconDefaultAction;return a&&r?gc(a,r):a}_getActionImage(e){const{selectedFeature:t}=this,r=t==null?void 0:t.attributes,{image:n}=e;return n&&r?gc(n,r):n}_createFeatureUpdatedAnimation(){return yte("enter",le.hasFeatureUpdated)}_getInlineActionCount(){const{maxInlineActions:e,featureNavigationVisible:t}=this;if(typeof e!="number")return null;const r=Math.round(e);return Math.max(t?r-1:r,0)}_watchActions(){const{allActions:e}=this.viewModel;this.notifyChange("dividedActions");const t="actions";this._handles.remove(t),e&&e.forEach(r=>{this._handles.add(z(()=>[r.uid,r.active,r.className,r.disabled,r.id,r.title,r.image,r.visible],()=>this.scheduleRender()),t)})}_divideActions(){const{allActions:e}=this.viewModel,t=e.filter(a=>a.visible),r=this._getInlineActionCount(),n=r===null,s=r===0;return{inlineActions:n?t.slice(0):s?new pt:t.slice(0,r),menuActions:n?new pt:s?t.slice(0):t.slice(r)}}_featureMenuOpenChanged(e){e?this._focusFirstFeature=!0:this._focusFeatureMenuButton=!0}_actionsMenuOpenChanged(e){e?this._focusFirstAction=!0:this._focusActionsMenuButton=!0}_setTitleFromFeatureWidget(){var r,n;const{selectedFeatureWidget:e,messagesCommon:t}=this;e&&(this.viewModel.title=((r=e.viewModel)==null?void 0:r.state)==="error"?t.errorMessage:((n=e.viewModel)==null?void 0:n.title)||"")}_setContentFromFeatureWidget(){const{selectedFeatureWidget:e}=this;e&&(this.viewModel.content=e)}_unobserveFeatureMenuObserver(){this._featureMenuIntersectionObserverNode&&this._featureMenuIntersectionObserver.unobserve(this._featureMenuIntersectionObserverNode)}_featureMenuIntersectionObserverCreated(e){this._unobserveFeatureMenuObserver(),this._featureMenuIntersectionObserver.observe(e),this._featureMenuIntersectionObserverNode=e}_handleFeatureMenuKeyup(e){Ol(e)==="Escape"&&(e.stopPropagation(),this._focusFeatureMenuButton=!0,this.featureMenuOpen=!1,this.scheduleRender())}_handleActionMenuKeyup(e){Ol(e)==="Escape"&&(e.stopPropagation(),this._focusActionsMenuButton=!0,this.actionsMenuOpen=!1,this.scheduleRender())}_setActiveFeature(e){const{viewModel:t}=this,r=e.currentTarget["data-feature-index"];t.activeFeature=t.features[r]||null}_removeActiveFeature(){this.viewModel.activeFeature=null}_handleFeatureMenuItemKeyup(e){const t=Ol(e),{_featureMenuNode:r}=this,n=e.currentTarget["data-feature-index"];if(!r)return;const s=r.querySelectorAll("li"),a=s.length;t!=="ArrowUp"?t!=="ArrowDown"?t!=="Home"?t!=="End"||(e.stopPropagation(),s[s.length-1].focus()):(e.stopPropagation(),s[0].focus()):(e.stopPropagation(),s[(n+1+a)%a].focus()):(e.stopPropagation(),s[(n-1+a)%a].focus())}_handleActionMenuItemKeyup(e){const t=Ol(e),{_actionsMenuNode:r}=this,n=e.currentTarget.dataset.actionUid,{menuActions:s}=this.dividedActions,a=s.findIndex(c=>c.uid===n);if(!r)return;const o=r.querySelectorAll("li"),l=o.length;t!=="ArrowUp"?t!=="ArrowDown"?t!=="Home"?t!=="End"||(e.stopPropagation(),o[o.length-1].focus()):(e.stopPropagation(),o[0].focus()):(e.stopPropagation(),o[(a+1+l)%l].focus()):(e.stopPropagation(),o[(a-1+l)%l].focus())}_handleMainKeyup(e){const t=Ol(e);t==="ArrowLeft"&&(e.stopPropagation(),this.previous()),t==="ArrowRight"&&(e.stopPropagation(),this.next())}_spinnerEnabledChange(e){if(this._destroySpinner(),!e)return;const t=this.get("viewModel.view");this._createSpinner(t)}_hideSpinner(){const{_spinner:e}=this;e&&(e.location=null,e.hide())}_displaySpinner(){const{_spinner:e}=this;if(!e)return;const{location:t,waitingForResult:r}=this.viewModel;r?e.show({location:t}):e.hide()}_getIconStyles(e){return{"background-image":e?`url(${e})`:""}}async _shouldFocus(e){e.shouldFocus&&(await Pm(()=>{var t;return((t=this.viewModel)==null?void 0:t.active)===!0}),this.focus())}_addSelectedFeatureIndexHandle(){const e=z(()=>{var t;return(t=this.viewModel)==null?void 0:t.selectedFeatureIndex},(t,r)=>this._selectedFeatureIndexUpdated(t,r));this._handles.add(e,Q9)}_selectedFeatureIndexUpdated(e,t){const{featureCount:r}=this;r&&e!==t&&e!==-1&&(this._destroyFlowItemWidgets(),this.actionsMenuOpen=!1,this.featureMenuOpen=!1,this._mainContainerNode&&(this._mainContainerNode.scrollTop=0),this._rootFlowItemNode&&this._rootFlowItemNode.scrollContentTo({top:0}))}_destroySelectedFeatureWidget(){const{_feature:e}=this;e&&(e.viewModel=null,e&&!e.destroyed&&e.destroy()),this._feature=null}_isScreenLocationWithinView(e,t){return e.x>-1&&e.y>-1&&e.x<=t.width&&e.y<=t.height}_isOutsideView(e){const{popupHeight:t,popupWidth:r,screenLocation:n,side:s,view:a}=e;if(isNaN(r)||isNaN(t)||!a||!n)return!1;const o=a.padding;return s==="right"&&n.x+r/2>a.width-o.right||s==="left"&&n.x-r/2<o.left||s==="top"&&n.y-t<o.top||s==="bottom"&&n.y+t>a.height-o.bottom}_calculateAutoAlignment(e){if(e!=="auto")return e;const{_pointerOffsetInPx:t,_containerNode:r,_mainContainerNode:n,viewModel:s}=this,{screenLocation:a,view:o}=s;if(S(a)||!o||!r)return"top-center";if(!this._isScreenLocationWithinView(a,o))return this._get("currentAlignment")||"top-center";function l(T){return parseInt(T.replace(/[^-\d\.]/g,""),10)}const c=n?window.getComputedStyle(n,null):null,u=c?l(c.getPropertyValue("max-height")):0,d=c?l(c.getPropertyValue("height")):0,{height:m,width:f}=r.getBoundingClientRect(),_=f+t,g=Math.max(m,u,d)+t,x=this._isOutsideView({popupHeight:g,popupWidth:_,screenLocation:a,side:"right",view:o}),b=this._isOutsideView({popupHeight:g,popupWidth:_,screenLocation:a,side:"left",view:o}),v=this._isOutsideView({popupHeight:g,popupWidth:_,screenLocation:a,side:"top",view:o}),w=this._isOutsideView({popupHeight:g,popupWidth:_,screenLocation:a,side:"bottom",view:o});return b?v?"bottom-right":"top-right":x?v?"bottom-left":"top-left":v?w?"top-center":"bottom-center":"top-center"}_callCurrentAlignment(e){return typeof e=="function"?e.call(this):e}_getCurrentAlignment(){const{alignment:e,dockEnabled:t}=this;return t||!this.viewModel.active?null:this._calculatePositionResult(this._calculateAutoAlignment(this._callCurrentAlignment(e)))}_setCurrentAlignment(){this._set("currentAlignment",this._getCurrentAlignment())}_setCurrentDockPosition(){this._set("currentDockPosition",this._getCurrentDockPosition())}_calculatePositionResult(e){const t=["left","right"];return zh(this.container)&&t.reverse(),e.replace(/leading/gi,t[0]).replace(/trailing/gi,t[1])}_callDockPosition(e){return typeof e=="function"?e.call(this):e}_getDockPosition(){var e;return this._calculatePositionResult(this._calculateAutoDockPosition(this._callDockPosition((e=this.dockOptions)==null?void 0:e.position)))}_getCurrentDockPosition(){return this.dockEnabled&&this.viewModel.active?this._getDockPosition():null}_wouldDockTo(){return this.dockEnabled?null:this._getDockPosition()}_calculateAutoDockPosition(e){var o;if(e!=="auto")return e;const t=(o=this.viewModel)==null?void 0:o.view,r=zh(this.container)?"top-left":"top-right";if(!t)return r;const n=t.padding||{left:0,right:0,top:0,bottom:0},s=t.width-n.left-n.right,{breakpoints:a}=t;return a&&s<=a.xsmall?"bottom-center":r}_positionContainer(e=this._containerNode){if(e&&(this._containerNode=e),!e)return;const{screenLocation:t}=this.viewModel,{width:r}=e.getBoundingClientRect(),n=this._calculatePositionStyle(t,r);n&&(e.style.top=n.top,e.style.left=n.left,e.style.bottom=n.bottom,e.style.right=n.right)}_calculateFullWidth(e){const{currentAlignment:t,_pointerOffsetInPx:r}=this;return t==="top-left"||t==="bottom-left"||t==="top-right"||t==="bottom-right"?e+r:e}_calculateAlignmentPosition(e,t,r,n){const{currentAlignment:s,_pointerOffsetInPx:a}=this,o=n/2,l=r.height-t,c=r.width-e,{padding:u}=this.view;return s==="bottom-center"?{top:t+a-u.top,left:e-o-u.left}:s==="top-left"?{bottom:l+a-u.bottom,right:c+a-u.right}:s==="bottom-left"?{top:t+a-u.top,right:c+a-u.right}:s==="top-right"?{bottom:l+a-u.bottom,left:e+a-u.left}:s==="bottom-right"?{top:t+a-u.top,left:e+a-u.left}:s==="top-center"?{bottom:l+a-u.bottom,left:e-o-u.left}:void 0}_calculatePositionStyle(e,t){const{dockEnabled:r,view:n}=this;if(!n)return;if(r)return{left:"",top:"",right:"",bottom:""};if(S(e)||!t)return;const s=this._calculateFullWidth(t),a=this._calculateAlignmentPosition(e.x,e.y,n,s);return a?{top:a.top!==void 0?`${a.top}px`:"auto",left:a.left!==void 0?`${a.left}px`:"auto",bottom:a.bottom!==void 0?`${a.bottom}px`:"auto",right:a.right!==void 0?`${a.right}px`:"auto"}:void 0}_viewChange(e,t){e&&t&&(this.close(),this.clear())}_viewReadyChange(e,t){if(e){const r=this.get("viewModel.view");this._wireUpView(r)}else t&&(this.close(),this.clear())}_wireUpView(e){if(this._destroySpinner(),!e)return;const{spinnerEnabled:t}=this;t&&this._createSpinner(e),this._setDockEnabledForViewSize(this.dockOptions)}_dockingThresholdCrossed(e,t,r){const[n,s]=e,[a,o]=t,{width:l,height:c}=r;return n<=l&&a>l||n>l&&a<=l||s<=c&&o>c||s>c&&o<=c}_updateDockEnabledForViewSize(e,t){if(!e||!t)return;const r=this.get("viewModel.view.padding")||{left:0,right:0,top:0,bottom:0},n=r.left+r.right,s=r.top+r.bottom,a=[],o=[];a[0]=e[0]-n,a[1]=e[1]-s,o[0]=t[0]-n,o[1]=t[1]-s;const{dockOptions:l}=this,c=l.breakpoint;this._dockingThresholdCrossed(a,o,c)&&this._setDockEnabledForViewSize(l),this._setCurrentDockPosition()}_focusDockButtonNode(e){this._focusDockButton&&(this._focusDockButton=!1,e.focus())}_closeButtonNodeUpdated(e){return this._focusClose?(this._focusClose=!1,void e.focus()):this._blurClose?(this._blurClose=!1,void e.blur()):void 0}_mainContainerNodeUpdated(e){return this._mainContainerNode=e,this._focusContainer?(this._focusContainer=!1,void e.focus()):this._blurContainer?(this._blurContainer=!1,void e.blur()):void 0}_featureMenuNodeUpdated(e){if(this._featureMenuNode=e,!e||!this._focusFirstFeature)return;this._focusFirstFeature=!1;const t=e.querySelectorAll("li");t.length&&t[0].focus()}_actionsMenuNodeUpdated(e){if(this._actionsMenuNode=e,!e||!this._focusFirstAction)return;this._focusFirstAction=!1;const t=e.querySelectorAll("li");t.length&&t[0].focus()}_focusFeatureMenuButtonNode(e){this._focusFeatureMenuButton&&(this._focusFeatureMenuButton=!1,e.focus())}_focusActionsMenuButtonNode(e){this._focusActionsMenuButton&&(this._focusActionsMenuButton=!1,e.focus())}_featureMenuViewportScrollTop(){this._featureMenuViewportNode&&(this._featureMenuViewportNode.scrollTop=0)}_toggleScreenLocationEnabled(){const{dockEnabled:e,viewModel:t}=this;if(!t)return;const r=t.active&&!e;t.screenLocationEnabled=r}_shouldDockAtCurrentViewSize(e){var l,c;const t=e.breakpoint,r=(c=(l=this.viewModel)==null?void 0:l.view)==null?void 0:c.ui;if(!r)return!1;const{width:n,height:s}=r;if(isNaN(n)||isNaN(s))return!1;const a=t.hasOwnProperty("width")&&n<=t.width,o=t.hasOwnProperty("height")&&s<=t.height;return a||o}_setDockEnabledForViewSize(e){e.breakpoint&&(this.dockEnabled=this._shouldDockAtCurrentViewSize(e))}_getPageText(e,t){return this.featureNavigationVisible?gc(this.messages.pageText,{index:t+1,total:e}):null}_destroySpinner(){const{_spinner:e,view:t}=this;e&&(t&&t.ui&&t.ui.remove(this._spinner,Z9),e.destroy(),this._spinner=null)}_createSpinner(e){e&&(this._spinner=new rde({view:e}),e.ui.add(this._spinner,{key:Z9,position:"manual"}))}_toggleCollapsed(){this.collapsed=!this.collapsed}_close(){this.close(),this.view&&this.view.focus()}_toggleDockEnabled(){this.dockEnabled=!this.dockEnabled,this._focusDockButton=!0,this.scheduleRender()}_toggleFeatureMenu(){const e=!this.featureMenuOpen;this._featureMenuOpenChanged(e),this.actionsMenuOpen=!1,this.featureMenuOpen=e}_toggleActionsMenu(){const e=!this.actionsMenuOpen;this._actionsMenuOpenChanged(e),this.featureMenuOpen=!1,this.actionsMenuOpen=e}_triggerAction(e){const t=e.currentTarget.dataset.actionUid,{allActions:r}=this.viewModel,n=r.findIndex(a=>a.uid===t),s=r.getItemAt(n);s&&s.type==="toggle"&&(s.value=!s.value),this.actionsMenuOpen=!1,this.viewModel.triggerAction(n)}_selectFeature(e){const t=e.currentTarget["data-feature-index"];isNaN(t)||(this.viewModel.selectedFeatureIndex=t),this.featureMenuOpen=!1,this._focusFeatureMenuButton=!0,this.scheduleRender()}_next(){this.next()}_previous(){this.previous()}};h([p({readOnly:!0})],Be.prototype,"actionsMenuId",null),h([p({readOnly:!0})],Be.prototype,"actionsMenuButtonId",null),h([p({readOnly:!0})],Be.prototype,"featureMenuId",null),h([p({readOnly:!0})],Be.prototype,"titleId",null),h([p({readOnly:!0})],Be.prototype,"contentId",null),h([p({readOnly:!0})],Be.prototype,"hasContent",null),h([p({readOnly:!0})],Be.prototype,"featureNavigationVisible",null),h([p({readOnly:!0})],Be.prototype,"collapsible",null),h([p({readOnly:!0})],Be.prototype,"featureMenuVisible",null),h([p({readOnly:!0})],Be.prototype,"contentCollapsed",null),h([p({readOnly:!0})],Be.prototype,"dividedActions",null),h([p({readOnly:!0,dependsOn:["_flowItems.length"]})],Be.prototype,"_activeFlowItemWidget",null),h([p()],Be.prototype,"actions",null),h([p()],Be.prototype,"actionsMenuOpen",null),h([p()],Be.prototype,"alignment",void 0),h([p()],Be.prototype,"autoCloseEnabled",null),h([p()],Be.prototype,"autoOpenEnabled",null),h([p()],Be.prototype,"defaultPopupTemplateEnabled",null),h([p()],Be.prototype,"content",null),h([p()],Be.prototype,"collapsed",void 0),h([p()],Be.prototype,"collapseEnabled",void 0),h([p({readOnly:!0})],Be.prototype,"currentAlignment",null),h([p({readOnly:!0})],Be.prototype,"currentDockPosition",null),h([p()],Be.prototype,"dockOptions",null),h([p()],Be.prototype,"dockEnabled",void 0),h([p({readOnly:!0})],Be.prototype,"featureCount",null),h([p()],Be.prototype,"featureMenuOpen",void 0),h([p()],Be.prototype,"features",null),h([p()],Be.prototype,"goToOverride",null),h([p()],Be.prototype,"headingLevel",void 0),h([p()],Be.prototype,"highlightEnabled",null),h([p()],Be.prototype,"location",null),h([p()],Be.prototype,"label",null),h([p()],Be.prototype,"maxInlineActions",void 0),h([p(),_n("esri/widgets/Popup/t9n/Popup")],Be.prototype,"messages",void 0),h([p(),_n("esri/t9n/common")],Be.prototype,"messagesCommon",void 0),h([p()],Be.prototype,"promises",null),h([p({readOnly:!0})],Be.prototype,"selectedFeature",null),h([p()],Be.prototype,"selectedFeatureIndex",null),h([p({readOnly:!0})],Be.prototype,"selectedFeatureWidget",null),h([p()],Be.prototype,"spinnerEnabled",void 0),h([p()],Be.prototype,"title",null),h([p()],Be.prototype,"updateLocationEnabled",null),h([p()],Be.prototype,"view",null),h([p({type:sW}),eue(["triggerAction","trigger-action"])],Be.prototype,"viewModel",void 0),h([p()],Be.prototype,"visible",null),h([p()],Be.prototype,"visibleElements",void 0),h([qr("visibleElements")],Be.prototype,"castVisibleElements",null),h([Uo()],Be.prototype,"_close",null),h([Uo()],Be.prototype,"_toggleDockEnabled",null),h([Uo()],Be.prototype,"_toggleFeatureMenu",null),h([Uo()],Be.prototype,"_toggleActionsMenu",null),h([Uo()],Be.prototype,"_triggerAction",null),h([Uo()],Be.prototype,"_selectFeature",null),h([Uo()],Be.prototype,"_next",null),h([Uo()],Be.prototype,"_previous",null),Be=h([D("esri.widgets.Popup")],Be);const eV=Be,XA=[0,0];function Pde(i){const e=(i.ownerDocument||window.document).defaultView,t=i.getBoundingClientRect();return XA[0]=t.left+((e==null?void 0:e.pageXOffset)??0),XA[1]=t.top+((e==null?void 0:e.pageYOffset)??0),XA}function tV(i){i&&(A7(i),i.parentNode&&i.parentNode.removeChild(i))}function Rde(i){const e=document.createElement("div");return i.appendChild(e),e}const Qv=16,MT=750,Ade=512,Ode=2,aW=i=>{let e=class extends i{constructor(...t){var r;super(...t),this._freqInfo={freq:Qv,time:MT},this._overlayRenderTaskHandle=null,this.height=0,this.overlay=null,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.ui=null,this.userContent=null,this.width=0,this.widthBreakpoint=null,t.length!==0&&((r=t[0])==null?void 0:r.popup)!==void 0||(this.popup=new eV({view:this})),this.handles.add([z(()=>this.cursor,n=>{const{surface:s}=this;s&&s.setAttribute("data-cursor",n)}),z(()=>this.interacting,n=>{const{surface:s}=this;s&&s.setAttribute("data-interacting",n.toString())})])}initialize(){this.handles.add(z(()=>this.ui,(t,r)=>this._handleUIChange(t,r))),this._wireUI(this.ui),this.handles.add([this.on("focus",()=>this.notifyChange("focused")),this.on("blur",()=>this.notifyChange("focused"))])}destroy(){this.destroyed||(this.ui=Te(this.ui),this.popup&&!this.popup.destroyed&&this.popup.destroy(),this.container=null)}get container(){return this._get("container")??null}set container(t){const r=this._get("container"),n=eD(t),s=n instanceof HTMLDivElement?n:null;if(s||typeof t!="string"||J.getLogger(this.declaredClass).error("#container",`element with id '${t}' not found`),r===s)return;const a="dom-size";if(this.handles.remove(a),this._stopMeasuring(),r&&(r.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay&&(this.overlay.destroy(),this._set("overlay",null)),this.root&&(tV(this.root),this._set("root",null)),this.userContent&&(c5(this.userContent,r),tV(this.userContent),this._set("userContent",null))),!s)return this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),void this._set("container",null);s.classList.add("esri-view");const o=document.createElement("div");o.className="esri-view-user-storage",c5(s,o),s.appendChild(o),this._set("userContent",o);const l=document.createElement("div");l.className="esri-view-root",s.insertBefore(l,s.firstChild),this._set("root",l);const c=document.createElement("div");c.className="esri-view-surface",c.setAttribute("role","application"),c.tabIndex=0,l.appendChild(c),this._set("surface",c);const u=new b9;l.appendChild(u.surface),this._set("overlay",u),z(()=>u.needsRender,d=>{d&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=wd({render:()=>{var m;return(m=this.overlay)==null?void 0:m.render()}}):this._overlayRenderTaskHandle=Os(this._overlayRenderTaskHandle)}),this.forceDOMReadyCycle(),this.handles.add(z(()=>this.size,d=>{const[m,f]=d,_="esri-view-surface--inset-outline";m>=document.body.clientWidth||f>=document.body.clientHeight?c.classList.add(_):c.classList.remove(_)},Qe),a),this._set("container",s),this._startMeasuring()}get focused(){const t=document.activeElement===this.surface;return document.hasFocus()&&t}set popup(t){const r=this._get("popup");r&&r!==t&&r.destroy(),this._set("popup",t)}get size(){return[this.width,this.height]}blur(){this.surface&&this.surface.blur()}focus(){this.surface&&this.surface.focus()}pageToContainer(t,r,n){const s=this.position;return t-=s?s[0]:0,r-=s?s[1]:0,n?(n[0]=t,n[1]=r):n=[t,r],n}containerToPage(t,r,n){const s=this.position;return t+=s?s[0]:0,r+=s?s[1]:0,n?(n[0]=t,n[1]=r):n=[t,r],n}_handleUIChange(t,r){r&&(this.handles.remove("ui"),r.destroy()),t&&this._wireUI(t),this._set("ui",t)}_wireUI(t){this.handles.remove("ui"),t&&(t.view=this,this.handles.add([z(()=>this.root,r=>{t.container=r?Rde(r):null},Qe),z(()=>this.popup,(r,n)=>{const s="popup",a="manual";n&&t.remove(n,s),r&&(r.view=t.view,t.add(r,{key:s,position:a}))},Qe)],"ui"))}_stopMeasuring(){this.handles.remove("measuring"),this._get("resizing")&&this._set("resizing",!1)}_startMeasuring(){const t=this._freqInfo;t.freq=Qv,t.time=MT,this.handles.add([(()=>{const r=()=>{t.freq=Qv,t.time=MT};return window.addEventListener("resize",r),{remove(){window.removeEventListener("resize",r)}}})(),wd({prepare:r=>{const n=this._measure(),s=this._freqInfo;if(s.time+=r.deltaTime,n&&(s.freq=Qv,this._get("resizing")||this._set("resizing",!0)),s.time<s.freq)return;s.time=0;const a=this._position();s.freq=a||n?Qv:Math.min(MT,s.freq*Ode),!n&&s.freq>=Ade&&this._get("resizing")&&this._set("resizing",!1)}})],"measuring"),this._measure(),this._position()}_measure(){const t=this.container,r=t?t.clientWidth:0,n=t?t.clientHeight:0;if(r===0||n===0)return this.suspended||this._set("suspended",!0),!1;const s=this.width,a=this.height;return r===s&&n===a?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",r),this._set("height",n),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:s,oldHeight:a,width:r,height:n}),!0)}_position(){const t=this.container,r=this.position,n=t&&Pde(t);return!!n&&(!r||n[0]!==r[0]||n[1]!==r[1])&&(this._set("position",[n[0],n[1]]),!0)}forceDOMReadyCycle(){}};return h([p()],e.prototype,"container",null),h([p({readOnly:!0})],e.prototype,"focused",null),h([p({readOnly:!0})],e.prototype,"height",void 0),h([p({type:eV})],e.prototype,"popup",null),h([p({type:b9})],e.prototype,"overlay",void 0),h([p({readOnly:!0})],e.prototype,"position",void 0),h([p({readOnly:!0})],e.prototype,"resizing",void 0),h([p({readOnly:!0})],e.prototype,"root",void 0),h([p({value:null,readOnly:!0})],e.prototype,"size",null),h([p({readOnly:!0})],e.prototype,"surface",void 0),h([p({readOnly:!0})],e.prototype,"suspended",void 0),h([p()],e.prototype,"ui",void 0),h([p({readOnly:!0})],e.prototype,"userContent",void 0),h([p({readOnly:!0})],e.prototype,"width",void 0),h([p()],e.prototype,"widthBreakpoint",void 0),e=h([D("esri.views.DOMContainer")],e),e},oW=i=>{let e=class extends i{async fetchPopupFeatures(t,r){await this.when();const{location:n,queryArea:s,layerViewsAndGraphics:a,clientOnlyGraphics:o}=await this._prepareFetchPopupFeatures(t,r),l=Promise.resolve(o),c=this._queryLayerPopupFeatures(s,a,r),u=c.map(d=>d.promise);return{location:n,clientOnlyGraphics:o,allGraphicsPromise:ate([l,...u]).then(d=>Array.from(new Set(d.flat()))),promisesPerLayerView:c}}_queryLayerPopupFeatures(t,r,n){return r.map(({layerView:s,graphics:a})=>{const o={clientGraphics:a,event:y(n)?n.event:null,signal:y(n)?n.signal:null,defaultPopupTemplateEnabled:!!y(n)&&!!n.defaultPopupTemplateEnabled},l=s.fetchPopupFeatures(t,o);return{layerView:s,promise:l}})}_isValidPopupGraphic(t,r){return t&&!!t.getEffectivePopupTemplate(y(r)&&r.defaultPopupTemplateEnabled)}async _prepareFetchPopupFeatures(t,r){const{clientGraphics:n,queryArea:s,location:a}=await this._popupHitTestGraphics(t,r),o=this._getFetchPopupLayerViews(),{layerViewsAndGraphics:l,clientOnlyGraphics:c}=this._graphicsPerFetchPopupLayerView(n,o);return{clientOnlyGraphics:c,layerViewsAndGraphics:l,queryArea:s,location:a}}async _popupHitTestGraphics(t,r){const{results:n,mapPoint:s}=await this.popupHitTest(t),a=n.filter(l=>l.type==="graphic"&&this._isValidPopupGraphic(l.graphic,r)),o=a.length?a[0].mapPoint:null;return{clientGraphics:a.map(l=>l.graphic),queryArea:s,location:s||o}}_getFetchPopupLayerViews(){const t=[];return this.allLayerViews.forEach(r=>{this._isValidPopupLayerView(r)&&t.push(r)}),y(this.graphicsView)&&this._isValidPopupLayerView(this.graphicsView)&&t.push(this.graphicsView),t.reverse()}_isValidPopupLayerView(t){return y(t)&&(!("layer"in t)||!t.suspended)&&"fetchPopupFeatures"in t}_graphicsPerFetchPopupLayerView(t,r){const n=[],s=new Map,a=r.map(o=>{const l=[];return"layer"in o?s.set(o.layer,l):s.set(o.graphics,l),{layerView:o,graphics:l}});for(const o of t){const l=s.get(o.layer)||s.get(o.sourceLayer)||null;l?l.push(o):n.push(o)}return{layerViewsAndGraphics:a,clientOnlyGraphics:n}}};return e=h([D("esri.views.PopupView")],e),e};var z3;let kS=z3=class extends mt{constructor(i){super(i),this.type="none"}clone(){return new z3({type:this.type})}};h([Ra({none:"none",stayAbove:"stay-above"})],kS.prototype,"type",void 0),kS=z3=h([D("esri.ground.NavigationConstraint")],kS);let Ji=class extends ue{constructor(){super(...arguments),this.SCENEVIEW_HITTEST_RETURN_INTERSECTOR=!1,this.DECONFLICTOR_SHOW_VISIBLE=!1,this.DECONFLICTOR_SHOW_INVISIBLE=!1,this.DECONFLICTOR_SHOW_GRID=!1,this.LABELS_SHOW_BORDER=!1,this.TEXT_SHOW_BASELINE=!1,this.TEXT_SHOW_BORDER=!1,this.OVERLAY_DRAW_DEBUG_TEXTURE=!1,this.OVERLAY_SHOW_CENTER=!1,this.SHOW_POI=!1,this.TESTS_DISABLE_OPTIMIZATIONS=!1,this.TESTS_DISABLE_FAST_UPDATES=!1,this.DRAW_MESH_GEOMETRY_NORMALS=!1,this.FEATURE_TILE_FETCH_SHOW_TILES=!1,this.FEATURE_TILE_TREE_SHOW_TILES=!1,this.TERRAIN_TILE_TREE_SHOW_TILES=!1,this.I3S_TREE_SHOW_TILES=!1,this.I3S_SHOW_MODIFICATIONS=!1,this.LOD_INSTANCE_RENDERER_DISABLE_UPDATES=!1,this.LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL=!1,this.EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES=!1,this.LINE_WIREFRAMES=!1,this.TERRAIN_USE_LEGACY_SHADING=!1}};h([p()],Ji.prototype,"SCENEVIEW_HITTEST_RETURN_INTERSECTOR",void 0),h([p()],Ji.prototype,"DECONFLICTOR_SHOW_VISIBLE",void 0),h([p()],Ji.prototype,"DECONFLICTOR_SHOW_INVISIBLE",void 0),h([p()],Ji.prototype,"DECONFLICTOR_SHOW_GRID",void 0),h([p()],Ji.prototype,"LABELS_SHOW_BORDER",void 0),h([p()],Ji.prototype,"TEXT_SHOW_BASELINE",void 0),h([p()],Ji.prototype,"TEXT_SHOW_BORDER",void 0),h([p()],Ji.prototype,"OVERLAY_DRAW_DEBUG_TEXTURE",void 0),h([p()],Ji.prototype,"OVERLAY_SHOW_CENTER",void 0),h([p()],Ji.prototype,"SHOW_POI",void 0),h([p()],Ji.prototype,"TESTS_DISABLE_OPTIMIZATIONS",void 0),h([p()],Ji.prototype,"TESTS_DISABLE_FAST_UPDATES",void 0),h([p()],Ji.prototype,"DRAW_MESH_GEOMETRY_NORMALS",void 0),h([p()],Ji.prototype,"FEATURE_TILE_FETCH_SHOW_TILES",void 0),h([p()],Ji.prototype,"FEATURE_TILE_TREE_SHOW_TILES",void 0),h([p()],Ji.prototype,"TERRAIN_TILE_TREE_SHOW_TILES",void 0),h([p()],Ji.prototype,"I3S_TREE_SHOW_TILES",void 0),h([p()],Ji.prototype,"I3S_SHOW_MODIFICATIONS",void 0),h([p()],Ji.prototype,"LOD_INSTANCE_RENDERER_DISABLE_UPDATES",void 0),h([p()],Ji.prototype,"LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL",void 0),h([p()],Ji.prototype,"EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES",void 0),h([p()],Ji.prototype,"LINE_WIREFRAMES",void 0),h([p()],Ji.prototype,"TERRAIN_USE_LEGACY_SHADING",void 0),Ji=h([D("esri.views.3d.support.DebugFlags")],Ji);const jt=new Ji;var B3;let mh=B3=class extends l7(Am){constructor(i){super(i),this.opacity=1,this.shading=!jt.TERRAIN_USE_LEGACY_SHADING,this.surfaceColor=null,this.navigationConstraint=null,this.layers=new pt;const e=r=>{r.parent&&r.parent!==this&&"remove"in r.parent&&r.parent.remove(r),r.parent=this,r.type!=="elevation"&&r.type!=="base-elevation"&&J.getLogger(this.declaredClass).error(`Layer '${r.title}, id:${r.id}' of type '${r.type}' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.`)},t=r=>{r.parent=null};this.layers.on("after-add",r=>e(r.item)),this.layers.on("after-remove",r=>t(r.item))}initialize(){this.when().catch(i=>{J.getLogger(this.declaredClass).error("#load()","Failed to load ground",i)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const i=this.layers.removeAll();for(const e of i)e.destroy();this.layers.destroy()}normalizeCtorArgs(i){return i&&"resourceInfo"in i&&(this._set("resourceInfo",i.resourceInfo),delete(i={...i}).resourceInfo),i}set layers(i){this._set("layers",B7(i,this._get("layers")))}writeLayers(i,e,t,r){const n=[];i&&(r={...r,layerContainerType:"ground"},i.forEach(s=>{if("write"in s){const a={};bie(s)().write(a,r)&&n.push(a)}else r&&r.messages&&r.messages.push(new K("layer:unsupported",`Layers (${s.title}, ${s.id}) of type '${s.declaredClass}' cannot be persisted in the ground`,{layer:s}))})),e.layers=n}load(i){return this.addResolvingPromise(this._loadFromSource(i)),Promise.resolve(this)}loadAll(){return G7(this,i=>{i(this.layers)})}async queryElevation(i,e){await this.load({signal:e==null?void 0:e.signal});const{ElevationQuery:t}=await G(()=>import("./ElevationQuery-d57239e1.js"),["assets/ElevationQuery-d57239e1.js","assets/asyncUtils-437defc4.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/unitUtils-45d1147c.js","assets/jsonMap-7b8332c9.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/projection-290b739f.js","assets/preload-helper-3bce6601.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/SimpleObservable-23231131.js","assets/mat4-44a0988f.js","assets/assets-8d3e737a.js","assets/request-6fc81c4c.js","assets/aaBoundingRect-193543b5.js","assets/zscale-89472cba.js","assets/ElevationSamplerData-b87e0e50.js","assets/geometry-b7901087.js","assets/typeUtils-35750739.js","assets/TileInfo-b0eb8c90.js"]);xi(e);const r=new t,n=this.layers.filter(iV).toArray();return r.queryAll(n,i,e)}async createElevationSampler(i,e){await this.load({signal:e==null?void 0:e.signal});const{ElevationQuery:t}=await G(()=>import("./ElevationQuery-d57239e1.js"),["assets/ElevationQuery-d57239e1.js","assets/asyncUtils-437defc4.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/unitUtils-45d1147c.js","assets/jsonMap-7b8332c9.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/projection-290b739f.js","assets/preload-helper-3bce6601.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/SimpleObservable-23231131.js","assets/mat4-44a0988f.js","assets/assets-8d3e737a.js","assets/request-6fc81c4c.js","assets/aaBoundingRect-193543b5.js","assets/zscale-89472cba.js","assets/ElevationSamplerData-b87e0e50.js","assets/geometry-b7901087.js","assets/typeUtils-35750739.js","assets/TileInfo-b0eb8c90.js"]);xi(e);const r=new t,n=this.layers.filter(iV).toArray();return r.createSamplerAll(n,i,e)}clone(){const i={opacity:this.opacity,surfaceColor:Rr(this.surfaceColor),navigationConstraint:Rr(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(i.loadStatus="loaded"),new B3({resourceInfo:this.resourceInfo}).set(i)}read(i,e){this.resourceInfo||this._set("resourceInfo",{data:i,context:e}),super.read(i,e)}_loadFromSource(i){const e=this.resourceInfo;return e?this._loadLayersFromJSON(e.data,e.context,i):Promise.resolve()}_loadLayersFromJSON(i,e,t){const r=e&&e.origin||"web-scene",n=e&&e.portal||null,s=e&&e.url||null;return G(()=>import("./layersCreator-af14d2eb.js"),["assets/layersCreator-af14d2eb.js","assets/Collection-910b6f71.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/lazyLayerLoader-41b90a4f.js","assets/preload-helper-3bce6601.js","assets/PortalItem-bb7e98a6.js","assets/assets-8d3e737a.js","assets/request-6fc81c4c.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Portal-2bb189b3.js","assets/locale-30120714.js","assets/PortalGroup-8e41557a.js","assets/jsonMap-7b8332c9.js","assets/PortalUser-659cc1d2.js","assets/portalLayers-bc22a371.js","assets/layersLoader-89454f28.js","assets/Layer-5ffe0eda.js","assets/geometry-b7901087.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/Identifiable-bfe1ff30.js","assets/arcgisLayerUrl-c09f09b4.js","assets/persistableUrlUtils-5f719c3b.js","assets/jsonContext-a007a25f.js","assets/portalItemUtils-2ccd793f.js","assets/projection-290b739f.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/aaBoundingRect-193543b5.js","assets/zscale-89472cba.js","assets/styleUtils-a989c0af.js","assets/asyncUtils-437defc4.js"]).then(({populateOperationalLayers:a})=>{xi(t);const o=[];if(i.layers&&Array.isArray(i.layers)){const l={context:{origin:r,url:s,portal:n,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};o.push(a(this.layers,i.layers,l))}return Yo(o)}).then(()=>{})}};function Mde(i){return i&&"createElevationSampler"in i}function iV(i){return i.type==="elevation"||Mde(i)}h([p({json:{read:!1}})],mh.prototype,"layers",null),h([Cs("layers")],mh.prototype,"writeLayers",null),h([p({readOnly:!0})],mh.prototype,"resourceInfo",void 0),h([p({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:nI,read:{reader:wie,source:"transparency"},write:{writer:(i,e)=>{e.transparency=xie(i)},target:"transparency"}}})],mh.prototype,"opacity",void 0),h([p({type:Boolean,nonNullable:!0,json:{read:!1}})],mh.prototype,"shading",void 0),h([p({type:ei,json:{type:[nI],write:(i,e)=>{e.surfaceColor=i.toJSON().slice(0,3)}}})],mh.prototype,"surfaceColor",void 0),h([p({type:kS,json:{write:!0}})],mh.prototype,"navigationConstraint",void 0),mh=B3=h([D("esri.Ground")],mh);const T2=mh;function Ide(i){var e;return!!(i&&i.loaded&&"capabilities"in i&&((e=i==null?void 0:i.capabilities)!=null&&e.operations)&&"supportsEditing"in i.capabilities.operations&&i.capabilities.operations.supportsEditing===!0)&&!("editingEnabled"in i&&!i.editingEnabled)}const rV=J.getLogger("esri.support.basemapUtils");function Lde(){return{}}function $de(i){for(const e in i){const t=i[e];(t==null?void 0:t.destroyed)===!1&&t.destroy(),delete i[e]}}function Dde(i,e){let t;if(typeof i=="string"){if(!(i in m5)){const r=Object.entries(m5).filter(([n,s])=>Sg.apiKey&&!s.classic||!Sg.apiKey&&s.classic&&!s.deprecated).map(([n])=>`"${n}"`).join(", ");return rV.warn(`Unable to find basemap definition for: ${i}. Try one of these: ${r}`),null}e&&(t=e[i]),t||(t=dI.fromId(i),e&&(e[i]=t))}else t=Ox(dI,i);return t!=null&&t.destroyed&&(rV.warn("The provided basemap is already destroyed",{basemap:t}),t=null),t}function Fde(i){return!!(i!=null&&i.baseLayers.concat(i.referenceLayers).some(lW))}function lW(i){var e;if(nV(i.url))return!0;if(i.type==="vector-tile"){for(const t in i.sourceNameToSource)if(nV((e=i.sourceNameToSource[t])==null?void 0:e.sourceUrl))return!0}return!1}function Nde(i,e){var n;if(S(e)||S(i))return{spatialReference:null,updating:!1};if(e.loadStatus==="not-loaded")return e.load(),{spatialReference:null,updating:!0};if(e.spatialReference)return{spatialReference:e.spatialReference,updating:!1};if(e.baseLayers.length===0)return{spatialReference:null,updating:!1};const t=e.baseLayers.getItemAt(0);switch(t.loadStatus){case"not-loaded":t.load();case"loading":return{spatialReference:null,updating:!0};case"failed":return{spatialReference:null,updating:!1}}const r=(("supportedSpatialReferences"in t?t.supportedSpatialReferences:null)||["tileInfo"in t?(n=t.tileInfo)==null?void 0:n.spatialReference:t.spatialReference]).filter(Boolean);return i.spatialReference?{spatialReference:r.find(s=>i.spatialReference.equals(s))??r[0]??null,updating:!1}:{spatialReference:r[0],updating:!1}}const kde=/^(basemaps|ibasemaps).*-api\.arcgis\.com$/i;function nV(i){if(!i)return!1;const e=new Kte(Jte(i));return kde.test(e.authority)}const sV={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}};function Vde(i){let e=null;if(typeof i=="string")if(i in sV){const t=sV[i];e=new T2({resourceInfo:{data:{layers:[t]}}})}else J.getLogger("esri.support.groundUtils").warn(`Unable to find ground definition for: ${i}. Try "world-elevation"`);else e=Ox(T2,i);return e}let fh=class extends Tie(Cie(nn.EventedMixin(ue))){constructor(e){super(e),this.allLayers=new mw({getCollections:()=>{var t,r,n;return[(t=this.basemap)==null?void 0:t.baseLayers,(r=this.ground)==null?void 0:r.layers,this.layers,(n=this.basemap)==null?void 0:n.referenceLayers]},getChildrenFunction:t=>"layers"in t?t.layers:null}),this.allTables=Sie(this),this.basemap=null,this.editableLayers=new mw({getCollections:()=>[this.allLayers],itemFilterFunction:Ide}),this.ground=new T2,this._basemapCache=Lde()}destroy(){var e,t;this.allLayers.destroy(),this.allTables.destroy(),this.editableLayers.destroy(),(e=this.ground)==null||e.destroy(),(t=this.basemap)==null||t.destroy(),$de(this._basemapCache),this._basemapCache=null}castBasemap(e){return Dde(e,this._basemapCache)}castGround(e){const t=Vde(e);return S(t)?this._get("ground"):t}findLayerById(e){return this.allLayers.find(t=>t.id===e)}findTableById(e){return this.allTables.find(t=>t.id===e)}};h([p({readOnly:!0,dependsOn:[]})],fh.prototype,"allLayers",void 0),h([p({readOnly:!0})],fh.prototype,"allTables",void 0),h([p({type:dI})],fh.prototype,"basemap",void 0),h([qr("basemap")],fh.prototype,"castBasemap",null),h([p({readOnly:!0})],fh.prototype,"editableLayers",void 0),h([p({type:T2,nonNullable:!0})],fh.prototype,"ground",void 0),h([qr("ground")],fh.prototype,"castGround",null),fh=h([D("esri.Map")],fh);const lR=fh;let nv=class extends Pie{constructor(e){super(e),this.handles.add(this.on("before-add",t=>{S(t.item)||t.item.parent===this.owner&&(J.getLogger(this.declaredClass).warn("Analysis inside the collection must be unique. Not adding this element again."),t.preventDefault())}))}_own(e){e.parent=this.owner}_release(e){e.parent=null}};nv=h([D("esri.support.AnalysesCollection")],nv);let bp=class extends ue{constructor(e){super(e),this.view=null,this.baseLayerViews=new pt,this.referenceLayerViews=new pt,this._loadingHandle=z(()=>{var t,r;return(r=(t=this.view)==null?void 0:t.map)==null?void 0:r.basemap},t=>{t&&t.load().catch(()=>{})},Qe)}destroy(){this._set("view",null),this._loadingHandle&&(this._loadingHandle.remove(),this._loadingHandle=null)}get suspended(){return!this.view||this.view.suspended}get updating(){var t,r;if(this.view&&this.view.suspended)return!1;const e=(r=(t=this.view)==null?void 0:t.map)==null?void 0:r.basemap;return!!e&&!!e.loaded&&(this.baseLayerViews.some(n=>n.updating)||this.referenceLayerViews.some(n=>n.updating))}};h([p({constructOnly:!0})],bp.prototype,"view",void 0),h([p({readOnly:!0})],bp.prototype,"baseLayerViews",void 0),h([p({readOnly:!0})],bp.prototype,"referenceLayerViews",void 0),h([p({readOnly:!0})],bp.prototype,"suspended",null),h([p({type:Boolean,readOnly:!0})],bp.prototype,"updating",null),bp=h([D("esri.views.BasemapView")],bp);let Ude=class{constructor(e,t,r){this.layer=e,this.view=t,this.layerViewImporter=r,this._controller=new AbortController,this._deferred=T7(),this._started=!1,this.done=!1,Em(this._controller.signal,()=>{const n=new K("cancelled:layerview-create","layerview creation cancelled",{layer:e});this._deferred.reject(n)})}get promise(){return this._deferred.promise}destroy(){this._controller.abort();const{layerView:e}=this;if(!e)return;const{layer:t,view:r}=this;t.emit("layerview-destroy",{view:r,layerView:e}),r.emit("layerview-destroy",{layer:t,layerView:e}),this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null}async start(){var n,s;if(this._started)return;this._started=!0;const{_controller:{signal:e},layer:t,view:r}=this;this._map=r.map;try{let a,o;if(await t.load({signal:e}),"prefetchResources"in t&&await t.prefetchResources({signal:e}),t.createLayerView)a=await t.createLayerView(r,{signal:e});else{if(!this.layerViewImporter.hasLayerViewModule(t))throw new K("layer:view-not-supported","No layerview implementation was found");const u=await this.layerViewImporter.importLayerView(t);xi(e),a="default"in u?new u.default({layer:t,view:r}):new u({layer:t,view:r})}const l=()=>{o=Os(o),a.destroyed||a.destroy(),a.layer=null,a.parent=null,a.view=null,this.done=!0};o=Em(e,l),xi(e);try{await a.when()}catch(u){throw l(),u}if(!((s=(n=this._map)==null?void 0:n.allLayers)==null?void 0:s.includes(t)))return l(),void this._deferred.reject(new K("view:no-layerview-for-layer","The layer has been removed from the map",{layer:t}));this.layerView=a,t.emit("layerview-create",{view:r,layerView:a}),r.emit("layerview-create",{layer:t,layerView:a}),this.done=!0,this._deferred.resolve(a)}catch(a){t.emit("layerview-create-error",{view:r,error:a}),r.emit("layerview-create-error",{layer:t,error:a}),this.done=!0,this._deferred.reject(new K("layerview:create-error","layerview creation failed",{layer:t,error:a}))}}},ml=class extends ue{constructor(e){super(e),this._layerLayerViewInfoMap=new Map,this._watchUpdatingTracking=new mv,this.supportsGround=!0,this._preloadLayerViewModules=()=>{var r;const t=(r=this.view.map)==null?void 0:r.allLayers;if(t)for(const n of t)this.layerViewImporter.hasLayerViewModule(n)&&this.layerViewImporter.importLayerView(n)},this._reschedule=()=>(S(this._workPromise)&&(this._workPromise=T7(),this._workPromise.promise.catch(()=>{})),this.removeHandles("reschedule"),this.addHandles(c7(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{var o,l,c;const t=this.view.map;if(this._map!==t&&(this.clear(),this._map=t),S(this._workPromise))return void this.notifyChange("updating");this.removeHandles("reschedule"),this.removeHandles("collection-change");const r=[],n=u=>{if(!S(u))for(const d of u)d&&(r.push(d),this._createLayerView(d),"layers"in d&&d.layers&&n(d.layers))};for(const u of this._rootCollectionNames)n(this.get(u));this._refreshCollections();for(const[u,d]of this._layerLayerViewInfoMap)r.includes(u)||(this._layerLayerViewInfoMap.delete(d.layer),d.destroy());const s=r.filter(u=>u.type==="group").map(u=>u.layers),a=[(o=t==null?void 0:t.ground)==null?void 0:o.layers,(l=t==null?void 0:t.basemap)==null?void 0:l.baseLayers,(c=t==null?void 0:t.basemap)==null?void 0:c.referenceLayers,t==null?void 0:t.layers,...s].filter(u=>!!u);this.addHandles(a.map(u=>this._watchUpdatingTracking.addOnCollectionChange(()=>u,this._reschedule)),"collection-change"),this._workPromise.resolve(),this._workPromise=null}}initialize(){this.own([wr(()=>{var e,t;return(t=(e=this.view)==null?void 0:e.map)==null?void 0:t.allLayers},"change",this._preloadLayerViewModules,{onListenerAdd:this._preloadLayerViewModules}),z(()=>{const e=this.view,t=e==null?void 0:e.map;return[t==null?void 0:t.basemap,t==null?void 0:t.ground,t==null?void 0:t.layers,e==null?void 0:e.ready]},()=>this._reschedule(),Oi)]),this._preloadLayerViewModules(),this._reschedule()}destroy(){this.clear(),this._watchUpdatingTracking.destroy(),this._map=null,y(this._workPromise)&&(this._workPromise.reject(ts()),this._workPromise=null)}get _layersToLayerViews(){const e=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.layers","view.layerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"]];return this.supportsGround&&e.push(["view.map.ground.layers","view.groundView.layerViews"]),new Map(e)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return y(this._workPromise)||this._watchUpdatingTracking.updating||Er(this._layerLayerViewInfoMap,e=>!e.done)}get updatingRemaining(){let e=0;for(const t of this._layerLayerViewInfoMap.values())t.done||++e;return e}clear(){if(!this.destroyed){for(const e of this._layerLayerViewInfoMap.values())e.destroy();this._layerLayerViewInfoMap.clear(),this._refreshCollections()}}async whenLayerView(e){if(await this._reschedule(),!this._layerLayerViewInfoMap.has(e))throw new K("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:e});return this._layerLayerViewInfoMap.get(e).promise}_refreshCollections(){for(const[e,t]of this._layersToLayerViews)this._populateLayerViewsOwners(this.get(e),this.get(t),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining")}_populateLayerViewsOwners(e,t,r){if(!e||!t)return void(t&&t.removeAll());let n=0;for(const s of e){const a=this._layerLayerViewInfoMap.get(s);if(!a||!a.layerView)continue;const o=a.layerView;o.layer=s,o.parent=r,t.getItemAt(n)!==o&&t.splice(n,0,o),s.layers&&this._populateLayerViewsOwners(s.layers,o.layerViews,o),n+=1}n<t.length&&t.splice(n,t.length)}_createLayerView(e){if(this._layerLayerViewInfoMap.has(e))return this.view.ready&&this._layerLayerViewInfoMap.get(e).start(),this.notifyChange("updating"),void this.notifyChange("updatingRemaining");e.load().catch(()=>{}),this.layerViewImporter.hasLayerViewModule(e)&&this.layerViewImporter.importLayerView(e);const t=new Ude(e,this.view,this.layerViewImporter);t.promise.then(()=>this._refreshCollections(),r=>{r&&(yo(r)||r.name==="cancelled:layerview-create")||J.getLogger(this.declaredClass).error(`Failed to create layerview for layer title:'${e.title??"no title"}', id:'${e.id??"no id"}' of type '${e.type}'.`,{layer:e,error:r}),this._refreshCollections()}),this._layerLayerViewInfoMap.set(e,t),this.view.ready&&t.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining")}};h([p()],ml.prototype,"_workPromise",void 0),h([p({readOnly:!0})],ml.prototype,"_watchUpdatingTracking",void 0),h([p({readOnly:!0})],ml.prototype,"_layersToLayerViews",null),h([p({readOnly:!0})],ml.prototype,"_rootCollectionNames",null),h([p()],ml.prototype,"layerViewImporter",void 0),h([p()],ml.prototype,"supportsGround",void 0),h([p({readOnly:!0})],ml.prototype,"updating",null),h([p({readOnly:!0})],ml.prototype,"updatingRemaining",null),h([p({constructOnly:!0})],ml.prototype,"view",void 0),ml=h([D("esri.views.LayerViewManager")],ml);const zde=ml;let Io=class extends ue{constructor(e){super(e),this.factor=1.5,this.offset=Ps(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};h([p({type:Number})],Io.prototype,"factor",void 0),h([p({nonNullable:!0})],Io.prototype,"offset",void 0),h([p()],Io.prototype,"position",void 0),h([p({type:Number,range:{min:0}})],Io.prototype,"size",void 0),h([p()],Io.prototype,"maskUrl",void 0),h([p()],Io.prototype,"maskEnabled",void 0),h([p()],Io.prototype,"overlayUrl",void 0),h([p()],Io.prototype,"overlayEnabled",void 0),h([p({readOnly:!0})],Io.prototype,"version",null),h([p({type:Boolean})],Io.prototype,"visible",void 0),Io=h([D("esri.views.Magnifier")],Io);const cW=Io;let a0=class extends ue{constructor(e,t){super({}),this._stage=e,this._textureRequests=new Map,this._frameTask=(t==null?void 0:t.registerTask(dr.TEXTURE_UNLOAD))??oD}normalizeCtorArgs(){return{}}destroy(){super.destroy(),this._frameTask.remove(),this._textureRequests.forEach(e=>this._releaseTextureRequest(e)),this._textureRequests.clear()}get updating(){return this._frameTask.updating}fromData(e,t,r){const n=this.makeUid(e);let s=this._textureRequests.get(n);return s||(s={referenceCount:0,texture:t(),textureAsync:null,abortController:null,onRemove:r},this._stage&&(this._stage.add(s.texture),this._stage.loadImmediate(s.texture)),this._textureRequests.set(n,s)),s.referenceCount++,{uid:n,texture:s.texture,release:()=>this._release(n)}}_release(e){const t=this._textureRequests.get(e);t?(t.referenceCount<1&&console.warn("TextureCollection: reference count is < 1 for "+e),t.referenceCount--,t.referenceCount<1&&this._frameTask.schedule(()=>this._releaseNow(e))):console.warn(`TextureCollection: texture doesn't exist: '${e}'`)}get test(){return{textureRequests:this._textureRequests}}_releaseNow(e){if(!this._textureRequests)return;const t=this._textureRequests.get(e);!t||t.referenceCount>0||(this._releaseTextureRequest(t),this._textureRequests.delete(e))}_releaseTextureRequest(e){var t;e.onRemove&&e.onRemove(),e.texture?(t=this._stage)==null||t.remove(e.texture):e.abortController&&(e.abortController.abort(),e.abortController=null)}makeUid(e,t=null){return y(t)?`${e}.${t}px`:e}};h([p()],a0.prototype,"_frameTask",void 0),h([p()],a0.prototype,"updating",null),a0=h([D("esri.views.3d.support.TextureCollection")],a0);var aV;(function(i){i[i.Left=0]="Left",i[i.Middle=1]="Middle",i[i.Right=2]="Right"})(aV||(aV={}));const hW=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],uW={};function dW(i){return!!uW[i]}function Bde(i){for(const e of i)if(!dW(e))return!1;return!0}hW.forEach(i=>{uW[i]=!0});let Gde=class{constructor(e){this._handlers=new Map,this._counter=0,this._handlerCounts=new Map,this.view=e,this.inputManager=null}connect(e){e&&this.disconnect(),this.inputManager=e,this._handlers.forEach(({handler:t,priority:r},n)=>this.inputManager.installHandlers(n,[t],r))}disconnect(){this.inputManager&&this._handlers.forEach((e,t)=>this.inputManager.uninstallHandlers(t)),this.inputManager=null}destroy(){this.disconnect(),this._handlers.clear(),this.view=null}on(e,t,r,n){const s=Array.isArray(e)?e:e.split(",");if(!Bde(s))return s.some(dW)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let a,o;Array.isArray(t)?o=t:(a=t,o=[]),typeof r=="function"?a=r:n=r,n=n??Yh.DEFAULT;const l=this._createUniqueGroupName(),c=new Hde(this.view,s,o,a);this._handlers.set(l,{handler:c,priority:n});for(const u of s){const d=this._handlerCounts.get(u)||0;this._handlerCounts.set(u,d+1)}return this.inputManager&&this.inputManager.installHandlers(l,[c],n),{remove:()=>this._removeHandler(l,s)}}hasHandler(e){return!!this._handlerCounts.get(e)}_removeHandler(e,t){if(this._handlers.has(e)){this._handlers.delete(e);for(const r of t){const n=this._handlerCounts.get(r);n===void 0?console.error("Trying to remove handler for event that has no handlers registered: ",r):n===1?this._handlerCounts.delete(r):this._handlerCounts.set(r,n-1)}}this.inputManager&&this.inputManager.uninstallHandlers(e)}_createUniqueGroupName(){return this._counter+=1,`viewEvents_${this._counter}`}},Hde=class extends Ei{constructor(e,t,r,n){super(!0),this.view=e;for(const s of t)switch(s){case"click":this.registerIncoming("click",r,a=>n(this._wrapClick(a)));break;case"double-click":this.registerIncoming("double-click",r,a=>n(this._wrapDoubleClick(a)));break;case"immediate-click":this.registerIncoming("immediate-click",r,a=>n(this._wrapImmediateClick(a)));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",r,a=>n(this._wrapImmediateDoubleClick(a)));break;case"hold":this.registerIncoming("hold",r,a=>n(this._wrapHold(a)));break;case"drag":this.registerIncoming("drag",r,a=>{const o=this._wrapDrag(a);o&&n(o)});break;case"key-down":this.registerIncoming("key-down",r,a=>n(this._wrapKeyDown(a)));break;case"key-up":this.registerIncoming("key-up",r,a=>n(this._wrapKeyUp(a)));break;case"pointer-down":this.registerIncoming("pointer-down",r,a=>n(this._wrapPointer(a,"pointer-down")));break;case"pointer-move":this.registerIncoming("pointer-move",r,a=>n(this._wrapPointer(a,"pointer-move")));break;case"pointer-up":this.registerIncoming("pointer-up",r,a=>n(this._wrapPointer(a,"pointer-up")));break;case"pointer-drag":this.registerIncoming("pointer-drag",r,a=>n(this._wrapPointerDrag(a)));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",r,a=>n(this._wrapMouseWheel(a)));break;case"pointer-enter":this.registerIncoming("pointer-enter",r,a=>n(this._wrapPointer(a,"pointer-enter")));break;case"pointer-leave":this.registerIncoming("pointer-leave",r,a=>n(this._wrapPointer(a,"pointer-leave")));break;case"gamepad":this.registerIncoming("gamepad",r,a=>{n(this._wrapGamepad(a))});break;case"focus":this.registerIncoming("focus",r,a=>{n(this._wrapFocus(a))});break;case"blur":this.registerIncoming("blur",r,a=>{n(this._wrapBlur(a))})}}_wrapFocus(e){return{type:"focus",timestamp:e.timestamp,native:e.data.native,cancelable:e.cancelable,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}_wrapBlur(e){return{type:"blur",timestamp:e.timestamp,native:e.data.native,cancelable:e.cancelable,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}_wrapClick(e){const{pointerType:t,button:r,buttons:n,x:s,y:a,native:o,eventId:l}=e.data,{cancelable:c,timestamp:u}=e;return{type:"click",pointerType:t,button:r,buttons:n,x:s,y:a,native:o,timestamp:u,screenPoint:Ps(s,a),mapPoint:this._getMapPoint(s,a),eventId:l,cancelable:c,stopPropagation:()=>e.stopPropagation(),async:d=>e.async(d),preventDefault:()=>e.preventDefault()}}_wrapDoubleClick(e){const{pointerType:t,button:r,buttons:n,x:s,y:a,native:o,eventId:l}=e.data,{cancelable:c,timestamp:u}=e;return{type:"double-click",pointerType:t,button:r,buttons:n,x:s,y:a,native:o,timestamp:u,mapPoint:this._getMapPoint(s,a),eventId:l,cancelable:c,stopPropagation:()=>e.stopPropagation(),async:d=>e.async(d),preventDefault:()=>e.preventDefault()}}_wrapImmediateClick(e){const{pointerType:t,button:r,buttons:n,x:s,y:a,native:o,eventId:l}=e.data,c=o.pointerId,{cancelable:u,timestamp:d}=e;return{type:"immediate-click",pointerId:c,pointerType:t,button:r,buttons:n,x:s,y:a,native:o,timestamp:d,mapPoint:this._getMapPoint(s,a),eventId:l,cancelable:u,stopPropagation:()=>e.stopPropagation(),async:m=>e.async(m),preventDefault:()=>e.preventDefault()}}_wrapImmediateDoubleClick(e){const{pointerType:t,button:r,buttons:n,x:s,y:a,native:o,eventId:l}=e.data,c=o.pointerId,{cancelable:u,timestamp:d}=e;return{type:"immediate-double-click",pointerId:c,pointerType:t,button:r,buttons:n,x:s,y:a,native:o,timestamp:d,mapPoint:this._getMapPoint(s,a),eventId:l,cancelable:u,stopPropagation:()=>e.stopPropagation(),async:m=>e.async(m),preventDefault:()=>e.preventDefault()}}_wrapHold(e){const{pointerType:t,button:r,buttons:n,x:s,y:a,native:o}=e.data,{cancelable:l,timestamp:c}=e;return{type:"hold",pointerType:t,button:r,buttons:n,x:s,y:a,native:o,timestamp:c,mapPoint:this._getMapPoint(s,a),cancelable:l,stopPropagation:()=>e.stopPropagation(),async:u=>e.async(u),preventDefault:()=>e.preventDefault()}}_getMapPoint(e,t){return this.view.toMap(Ps(e,t),{exclude:[]})}_wrapDrag(e){const t=e.data,{x:r,y:n}=t.center,{action:s,pointerType:a,button:o}=t;if(s==="start"&&(this._latestDragStart=t),!this._latestDragStart)return;const l=t.pointer.native,c=t.buttons,{cancelable:u,timestamp:d}=e,m={x:this._latestDragStart.center.x,y:this._latestDragStart.center.y};return s==="end"&&(this._latestDragStart=void 0),{type:"drag",action:s,x:r,y:n,origin:m,pointerType:a,button:o,buttons:c,radius:t.radius,angle:_o(t.angle),native:l,timestamp:d,cancelable:u,stopPropagation:()=>e.stopPropagation(),async:f=>e.async(f),preventDefault:()=>e.preventDefault()}}_wrapKeyDown(e){const{key:t,repeat:r,native:n}=e.data,{cancelable:s,timestamp:a}=e;return{type:"key-down",key:t,repeat:r,native:n,timestamp:a,cancelable:s,stopPropagation:()=>e.stopPropagation(),async:o=>e.async(o),preventDefault:()=>e.preventDefault()}}_wrapKeyUp(e){const{key:t,native:r}=e.data,{cancelable:n,timestamp:s}=e;return{type:"key-up",key:t,native:r,timestamp:s,cancelable:n,stopPropagation:()=>e.stopPropagation(),async:a=>e.async(a),preventDefault:()=>e.preventDefault()}}_wrapPointer(e,t){const{x:r,y:n,button:s,buttons:a,native:o,eventId:l}=e.data,c=o.pointerId,u=o.pointerType,{cancelable:d,timestamp:m}=e;return{type:t,x:r,y:n,pointerId:c,pointerType:u,button:s,buttons:a,native:o,timestamp:m,eventId:l,cancelable:d,stopPropagation:()=>e.stopPropagation(),async:f=>e.async(f),preventDefault:()=>e.preventDefault()}}_wrapPointerDrag(e){const{x:t,y:r,buttons:n,native:s,eventId:a}=e.data.currentEvent,{button:o}=e.data.startEvent,l=e.data.startEvent.native.pointerId,c=e.data.startEvent.native.pointerType,u=e.data.action,d={x:e.data.startEvent.x,y:e.data.startEvent.y},{cancelable:m,timestamp:f}=e;return{type:"pointer-drag",x:t,y:r,pointerId:l,pointerType:c,button:o,buttons:n,action:u,origin:d,native:s,timestamp:f,eventId:a,cancelable:m,stopPropagation:()=>e.stopPropagation(),async:_=>e.async(_),preventDefault:()=>e.preventDefault()}}_wrapMouseWheel(e){const{cancelable:t,data:r,timestamp:n}=e,{x:s,y:a,deltaY:o,native:l}=r;return{type:"mouse-wheel",x:s,y:a,deltaY:o,native:l,timestamp:n,cancelable:t,stopPropagation:()=>e.stopPropagation(),async:c=>e.async(c),preventDefault:()=>e.preventDefault()}}_wrapGamepad(e){const{action:t,state:r,device:n}=e.data,{cancelable:s,timestamp:a}=e,{buttons:o,axes:l}=r;return{type:"gamepad",device:n,timestamp:a,action:t,buttons:o,axes:l,cancelable:s,stopPropagation:()=>e.stopPropagation(),async:c=>e.async(c),preventDefault:()=>e.preventDefault()}}};var Yw,oV,lV;(function(i){i[i.USER=0]="USER",i[i.MANAGER=1]="MANAGER"})(Yw||(Yw={})),function(i){i[i.None=0]="None",i[i.Unfocused=1]="Unfocused",i[i.Focused=2]="Focused",i[i.Unselected=4]="Unselected",i[i.Selected=8]="Selected",i[i.All=15]="All"}(oV||(oV={})),function(i){i[i.None=0]="None",i[i.Custom1=16]="Custom1",i[i.Custom2=32]="Custom2",i[i.Custom3=64]="Custom3",i[i.Custom4=128]="Custom4",i[i.Custom5=256]="Custom5",i[i.Custom6=512]="Custom6",i[i.Custom7=1024]="Custom7",i[i.Custom8=2048]="Custom8",i[i.Custom9=4096]="Custom9",i[i.Custom10=8192]="Custom10",i[i.Custom11=16384]="Custom11",i[i.Custom12=32768]="Custom12",i[i.All=65520]="All"}(lV||(lV={}));function jde(i){return[i.on("before-add",e=>{const t=e.item;if(t==null||i.includes(t))return J.getLogger("esri.views.interactive.interactiveToolUtils").warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void e.preventDefault();t.onAdd()}),i.on("after-remove",e=>{const t=e.item;t.active&&(t.view.activeTool=null),t.destroy()})]}function G3(i){return i.visible&&i.getEditableFlag(Yw.USER)&&i.getEditableFlag(Yw.MANAGER)}function gh(i){return Ps(i.x,i.y)}function B5e(i){return zi(i.x,i.y)}function pW(i,e){const t=(i instanceof HTMLElement?i:i.surface).getBoundingClientRect();return Ps(e.clientX-t.left,e.clientY-t.top)}function C2(i,e){return e instanceof Event?pW(i,e):gh(e)}function S2(i){if(i instanceof Event)return!0;if(typeof i=="object"&&"type"in i)switch(i.type){case"click":case"double-click":case"pointer-down":case"pointer-drag":case"pointer-enter":case"pointer-leave":case"pointer-up":case"pointer-move":case"immediate-click":case"immediate-double-click":case"hold":case"drag":case"mouse-wheel":return!0;default:return!1}return!1}let qde=class{constructor(){this._pointerLocations=new Map,this._hoveredManipulators=new Map,this._grabbedManipulators=new Map,this._draggedManipulators=new Map,this._stopDrag=!1,this._revertToNullActiveTool=!1,this._cursor=null}get cursor(){return this._cursor}handleInputEvent(e,t){const r=()=>e.stopPropagation();switch(e.type){case"pointer-move":cV(e.pointerType)&&this._pointerLocations.set(e.pointerId,{x:e.x,y:e.y,pointerType:e.pointerType});break;case"drag":this._grabbedManipulators.size>0&&(this._stopDrag=!0),this._stopDrag&&(r(),e.action==="end"&&(this._stopDrag=!1));break;case"pointer-down":{if(!hV(e))break;const n=gh(e),s=this._intersect(n,e.pointerType,t.forEachTool);if(S(s))break;const a=s.manipulator,o=s.tool;!(y(a)&&y(o)&&a.interactive)||a.grabbable&&a.grabbableForEvent(e)||!a.grabbing||a.dragging||this._ungrabManipulatorBeforeDragging(a,e,t),y(a)&&y(o)&&a.interactive&&a.grabbable&&a.grabbableForEvent(e)&&!a.grabbing&&(this._grabbedManipulators.set(e.pointerId,{manipulator:a,tool:o,start:n,pointerType:e.pointerType}),this._grabbedManipulators.size===1&&S(t.activeTool)&&(this._revertToNullActiveTool=!0,t.setActiveTool(s.tool)),a.grabbing=!0,a.events.emit("grab-changed",{action:"start",pointerType:e.pointerType,screenPoint:n}),r());break}case"pointer-up":this._draggedManipulators.has(e.pointerId)||this._handlePointerEnd(e,t);break;case"pointer-drag":{if(!hV(e))break;const n=this._grabbedManipulators.get(e.pointerId),s=co(n,({manipulator:u})=>u),a=co(n,({tool:u})=>u);if(S(s)||S(a))break;const o=gh(e);o.x=ce(o.x,0,t.view.width),o.y=ce(o.y,0,t.view.height);const l=ct(n).start,c=this._draggedManipulators.get(e.pointerId);switch(e.action){case"start":case"update":e.action!=="update"&&this._grabbedManipulators.size!==1||(s.dragging=!0,c?s.events.emit("drag",{action:"update",start:l,screenPoint:o}):s.events.emit("drag",{action:"start",start:l,screenPoint:o,pointerType:e.pointerType}),this._draggedManipulators.set(e.pointerId,{tool:a,manipulator:s,start:l}));break;case"end":s.dragging=!1,c&&s.events.emit("drag",{action:"end",start:l,screenPoint:o}),this._draggedManipulators.delete(e.pointerId),this._handlePointerEnd(e,t)}r();break}case"immediate-click":{const n=gh(e),s=this._intersect(n,e.pointerType,t.forEachTool);if(Wde(e)||t.forEachTool(c=>{if((!y(s)||s.tool!==c||c.automaticManipulatorSelection)&&c.manipulators){let u=!1;c.manipulators.forEach(({manipulator:d})=>{d.selected&&(d.selected=!1,u=!0)}),u&&c.onManipulatorSelectionChanged&&c.onManipulatorSelectionChanged()}}),S(s))break;const{manipulator:a,tool:o}=s;if(!a.interactive)break;a.selectable&&o.automaticManipulatorSelection&&(a.selected=!a.selected,o.onManipulatorSelectionChanged&&o.onManipulatorSelectionChanged());const l=e.native.shiftKey;a.events.emit("immediate-click",{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:l,stopPropagation:r});break}case"click":{const n=gh(e),s=this._intersect(n,e.pointerType,t.forEachTool),a=y(s)?s.manipulator:null;if(S(a)||!a.interactive)break;const o=e.native.shiftKey;a.events.emit(e.type,{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:o}),r();break}case"double-click":{const n=gh(e),s=this._intersect(n,e.pointerType,t.forEachTool),a=y(s)?s.manipulator:null;if(S(a)||!a.interactive)break;const o=e.native.shiftKey;a.events.emit("double-click",{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:o,stopPropagation:r});break}case"immediate-double-click":{const n=gh(e),s=this._intersect(n,e.pointerType,t.forEachTool),a=y(s)?s.manipulator:null;if(S(a)||!a.interactive)break;const o=e.native.shiftKey;a.events.emit("immediate-double-click",{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:o,stopPropagation:r});break}}this._onFocusChange(t.forEachTool)}_ungrabManipulatorBeforeDragging(e,t,r){e.grabbing=!1,e.events.emit("grab-changed",{action:"end",pointerType:t.pointerType,screenPoint:gh(t)}),this._grabbedManipulators.forEach(({manipulator:n},s)=>{n===e&&this._grabbedManipulators.delete(s)}),this._afterManipulatorUngrab(r.setActiveTool)}_handlePointerEnd(e,t){const r=co(this._grabbedManipulators.get(e.pointerId),({manipulator:n})=>n);S(r)||r.grabbing&&(r.grabbing=!1,r.events.emit("grab-changed",{action:"end",pointerType:e.pointerType,screenPoint:gh(e)}),this._grabbedManipulators.delete(e.pointerId),this._afterManipulatorUngrab(t.setActiveTool))}_cursorFromMap(e){let t=null;return Er(e,({manipulator:r})=>!(S(r)||!r.interactive)&&(r.grabbing&&r.grabCursor?(t=r.grabCursor,!0):!!r.cursor&&(t=r.cursor,!0))),t}_onFocusChange(e){this._updateCursor(),this._updateFocusedManipulatorTools(e)}_updateCursor(){this._grabbedManipulators.size>0?this._cursor=this._cursorFromMap(this._grabbedManipulators)||"grabbing":this._hoveredManipulators.size>0?this._cursor=this._cursorFromMap(this._hoveredManipulators)||"pointer":this._cursor=null}_updateFocusedManipulatorTools(e){const t=new Set,r=new Set;this._grabbedManipulators.forEach(({tool:n})=>{t.add(n)}),this._hoveredManipulators.forEach(({tool:n})=>{r.add(n)}),e(n=>{n.hasGrabbedManipulators=t.has(n),n.hasHoveredManipulators=r.has(n);const s=this._grabbedManipulators.values(),a=Aee(s,({tool:o})=>o===n);n.firstGrabbedManipulator=y(a)?a.manipulator:null})}clearPointers(e,{forEachTool:t,setActiveTool:r},n=!0,s){const a=(o,l)=>o===e&&(S(s)||s===l);this._grabbedManipulators.forEach(({tool:o,manipulator:l,pointerType:c},u)=>{a(o,l)&&(this._grabbedManipulators.delete(u),l.grabbing=!1,l.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:c}))}),this._draggedManipulators.forEach(({tool:o,manipulator:l},c)=>{a(o,l)&&(this._draggedManipulators.delete(c),l.dragging=!1,l.events.emit("drag",{action:"cancel"}))}),n&&this._hoveredManipulators.forEach(({tool:o,manipulator:l},c)=>{a(o,l)&&(this._hoveredManipulators.delete(c),l.hovering=!1)}),this._afterManipulatorUngrab(r),this._onFocusChange(t)}_intersect(e,t,r){let n=null;return r(s=>{if(s.manipulators==null||!G3(s))return!1;const a=s.manipulators.intersect(e,t);return!S(a)&&(n={tool:s,manipulator:a},!0)}),n}updateHoveredStateFromKnownPointers(e){this._pointerLocations.forEach((t,r)=>{this._updateHoveredStateForPointerAtScreenPosition(Ps(t.x,t.y),r,t.pointerType,e)})}handleHoverEvent(e,t){e.type!=="pointer-up"&&e.type!=="immediate-click"&&e.type!=="pointer-move"||!cV(e.pointerType)||this._updateHoveredStateForPointerAtScreenPosition(gh(e),e.pointerId,e.pointerType,t)}_updateHoveredStateForPointerAtScreenPosition(e,t,r,n){let s=this._intersect(e,r,n);const a=co(this._hoveredManipulators.get(t),({manipulator:o})=>o);y(s)&&!s.manipulator.interactive&&(s=null),y(s)&&a===s.manipulator||(y(a)&&(a.hovering=!1),y(s)?(s.manipulator.hovering=!0,this._hoveredManipulators.set(t,s)):this._hoveredManipulators.delete(t),this._onFocusChange(n))}_afterManipulatorUngrab(e){this._grabbedManipulators.size===0&&this._revertToNullActiveTool&&(e(null),this._revertToNullActiveTool=!1)}};function cV(i){return i==="mouse"}function hV(i){return i.pointerType!=="mouse"||i.button===0}function Wde(i){return!!i.native.shiftKey}const uV="attached",QA="tools";let Lu=class extends tD{constructor(e){super(e),this._manipulatorState=new qde,this.tools=new pt,this.cursor=null,this._forEachTool=t=>{for(const r of this.tools.items)if(t(r))return}}initialize(){this.handles.add([this.view.on(hW,e=>{this._handleInputEvent(e)},Yh.TOOL),...jde(this.tools),this.tools.on("before-add",({item:e})=>{this._updateToolEditableFlag(e)}),this.tools.on("before-remove",({item:e})=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()}),this.tools.on("change",()=>{this._refreshToolWatchers()})])}destroy(){this.detach(),this.handles.removeAll()}get _manipulatorStateEventArgs(){return{forEachTool:this._forEachTool,activeTool:this.activeTool,setActiveTool:e=>{this.activeTool=e},view:this.view}}set activeTool(e){if(y(e)&&!this.view.ready)return void J.getLogger(this.declaredClass).error("Cannot set active tool while view is not ready.");if(e===this.activeTool)return;const t=this.activeTool;this._set("activeTool",e),y(t)&&t.deactivate(),y(e)&&e.activate(),this._removeIncompleteTools(e);for(const r of this.tools){this._updateToolEditableFlag(r);const n=G3(r);!S(this.activeTool)&&n||this._manipulatorState.clearPointers(r,this._manipulatorStateEventArgs,!n)}this._updateCursor()}get updating(){var e;return this.updatingHandles.updating||this.tools.some(t=>t.updating)||(((e=this.textures)==null?void 0:e.updating)??!1)}attach(){this.view.type==="3d"?(this._set("textures",new a0(this.view._stage,this.view.resourceController.scheduler)),this.handles.add([z(()=>{const{state:e}=this.view;return"camera"in e&&e.camera},()=>{this._forEachManipulator(e=>{e.onViewChange!=null&&e.onViewChange()})}),this.view.elevationProvider.on("elevation-change",e=>{this._forEachManipulator(t=>{t.onElevationChange!=null&&t.onElevationChange(e)})}),uw(()=>this._set("textures",Te(this.textures)))],uV)):this.handles.add(z(()=>this.view.extent,()=>{this._forEachManipulator(e=>{e.onViewChange!=null&&e.onViewChange()})}))}detach(){y(this.activeTool)&&(this.activeTool=null),this.tools.removeAll(),this.handles.remove(uV)}_forEachManipulator(e){this._forEachTool(t=>{t.manipulators&&t.manipulators.forEach(({manipulator:r})=>e(r,t))})}_handleInputEvent(e){let t=!1;const r={...e,stopPropagation:()=>{t=!0,e.stopPropagation()}};y(this.activeTool)?this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(r):this._forEachTool(n=>{!t&&n.visible&&n.handleInputEvent(r)}),!t&&e.type==="key-down"&&e.key==="Escape"&&this.activeTool&&(e.stopPropagation(),this.activeTool=null),this._manipulatorState.handleInputEvent(r,this._manipulatorStateEventArgs),!t&&y(this.activeTool)&&this.activeTool.handleInputEventAfter(r),this._manipulatorState.handleHoverEvent(r,this._forEachTool),this._updateCursor()}_refreshToolWatchers(){this.handles.remove(QA),this._forEachTool(e=>{if(e instanceof ue){const t=z(()=>[e.cursor,e.visible,e.editable],()=>{G3(e)||this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()});this.handles.add(t,QA)}e.manipulators&&this.handles.add([e.manipulators.on("after-remove",t=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs,!0,t.item.manipulator)}),e.manipulators.on("change",()=>{this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()})],QA)}),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()}_updateToolEditableFlag(e){e.setEditableFlag(Yw.MANAGER,S(this.activeTool)||e===this.activeTool)}_updateCursor(){let e=this._manipulatorState.cursor;S(e)&&this._forEachTool(t=>!(!y(t.cursor)||!t.visible)&&(e=t.cursor,!0)),this._get("cursor")!==e&&this._set("cursor",e)}_removeIncompleteTools(e){this.tools.filter(t=>(S(e)||t!==e)&&!t.created&&t.removeIncompleteOnCancel).forEach(t=>{this.tools.remove(t)})}};h([p({constructOnly:!0,nonNullable:!0})],Lu.prototype,"view",void 0),h([p({readOnly:!0,nonNullable:!0})],Lu.prototype,"textures",void 0),h([p({value:null})],Lu.prototype,"activeTool",null),h([p({readOnly:!0,type:pt})],Lu.prototype,"tools",void 0),h([p({readOnly:!0})],Lu.prototype,"cursor",void 0),h([p({readOnly:!0})],Lu.prototype,"updating",null),Lu=h([D("esri.views.ToolViewManager")],Lu);const Xde=Lu;let dy=class extends ue{constructor(e){super(),this.nativeIndex=null,this._detectedDeviceType="unknown",e.mapping==="standard"?this._detectedDeviceType="standard":Qde.test(e.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=e.index}get native(){const e=navigator.getGamepads?navigator.getGamepads():[];return this.nativeIndex!=null&&this.nativeIndex<e.length?e[this.nativeIndex]:null}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return Zde[this.deviceType]}};h([p({nonNullable:!0,readOnly:!0})],dy.prototype,"nativeIndex",void 0),h([p({type:String,readOnly:!0})],dy.prototype,"deviceType",null),h([p({type:Number,readOnly:!0})],dy.prototype,"axisThreshold",null),dy=h([D("esri.views.input.gamepad.GamepadInputDevice")],dy);const Qde=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),Zde={standard:.15,spacemouse:.025,unknown:0},iN=dy;let B1=class extends ue{constructor(...e){super(...e),this.devices=new pt,this.enabledFocusMode="document"}};h([p({type:pt.ofType(iN),readOnly:!0})],B1.prototype,"devices",void 0),h([p({type:["document","view","none"]})],B1.prototype,"enabledFocusMode",void 0),B1=h([D("esri.views.input.gamepad.GamepadSettings")],B1);const Yde=B1;let VS=class extends ue{constructor(){super(...arguments),this.gamepad=new Yde}};h([p({readOnly:!0})],VS.prototype,"gamepad",void 0),VS=h([D("esri.views.input.Input")],VS);const Kde=VS;let wp=class extends ue{constructor(e){super(e),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1}};h([p({type:Boolean,nonNullable:!0})],wp.prototype,"enabled",void 0),h([p({type:iN})],wp.prototype,"device",void 0),h([p({type:["pan","zoom"],nonNullable:!0})],wp.prototype,"mode",void 0),h([p({type:["forward-down","forward-up"],nonNullable:!0})],wp.prototype,"tiltDirection",void 0),h([p({type:Number,nonNullable:!0})],wp.prototype,"velocityFactor",void 0),wp=h([D("esri.views.navigation.gamepad.GamepadSettings")],wp);const mW=wp;let Af=class extends ue{constructor(e){super(e),this.browserTouchPanEnabled=!0,this.gamepad=new mW,this.momentumEnabled=!0,this.mouseWheelZoomEnabled=!0}};h([p({type:Boolean})],Af.prototype,"browserTouchPanEnabled",void 0),h([p({type:mW,nonNullable:!0})],Af.prototype,"gamepad",void 0),h([p({type:Boolean})],Af.prototype,"momentumEnabled",void 0),h([p({type:Boolean})],Af.prototype,"mouseWheelZoomEnabled",void 0),Af=h([D("esri.views.navigation.Navigation")],Af);const fW=Af;function Z5e(i,e,t){const r=gW(i),n=e,s=Jde(r,n,t);if(r){const a=Fx.deriveUnitFromSR(r,i.spatialReference).heightUnit;if(!t&&a!==r.heightUnit){const o=new K("layerview:unmatched-height-unit",`The vertical units of the layer must match the horizontal units (${a})`,{horizontalUnit:a});return new K("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:r,error:o})}}if(!epe(i)||s===io.Unsupported)return new K("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:r});switch(s){case io.Units:{const a=(r==null?void 0:r.heightUnit)||"unknown",o=(n==null?void 0:n.heightUnit)||"unknown",l=new K("layerview:incompatible-height-unit",`The vertical units of the layer (${a}) must match the vertical units of the scene (${o})`,{layerUnit:a,sceneUnit:o});return new K("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:r,sceneHeightModelInfo:n,error:l})}case io.HeightModel:{const a=(r==null?void 0:r.heightModel)||"unknown",o=(n==null?void 0:n.heightModel)||"unknown",l=new K("layerview:incompatible-height-model",`The height model of the layer (${a}) must match the height model of the scene (${o})`,{layerHeightModel:a,sceneHeightModel:o});return new K("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:r,sceneHeightModelInfo:n,error:l})}case io.CRS:{const a=(r==null?void 0:r.vertCRS)||"unknown",o=(n==null?void 0:n.vertCRS)||"unknown",l=new K("layerview:incompatible-vertical-datum",`The vertical datum of the layer (${a}) must match the vertical datum of the scene (${o})`,{layerDatum:a,sceneDatum:o});return new K("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:r,sceneHeightModelInfo:n,error:l})}}return null}function Jde(i,e,t){if(!dV(i)||!dV(e))return io.Unsupported;if(i==null||e==null)return io.Ok;if(!t&&i.heightUnit!==e.heightUnit)return io.Units;if(i.heightModel!==e.heightModel)return io.HeightModel;switch(i.heightModel){case"gravity-related-height":return io.Ok;case"ellipsoidal":return i.vertCRS===e.vertCRS?io.Ok:io.CRS;default:return io.Unsupported}}var io;function dV(i){return i==null||i.heightModel!=null&&i.heightUnit!=null}function epe(i){return"heightModelInfo"in i&&i.heightModelInfo!=null||i.spatialReference!=null||!vW(i)}function gW(i){var r;const e=i.url?mI(i.url):void 0;return!(((r=i.spatialReference)==null?void 0:r.vcsWkid)==null&&y(e)&&e.serverType==="ImageServer")&&_W(i)&&i.heightModelInfo?i.heightModelInfo:vW(i)?Fx.deriveUnitFromSR(ipe,i.spatialReference):null}function _W(i){return"heightModelInfo"in i}function yW(i){if(i.type==="unknown"||!("capabilities"in i))return!1;switch(i.type){case"csv":case"feature":case"geojson":case"subtype-group":case"ogc-feature":case"oriented-imagery":case"wfs":return!0;default:return!1}}function vW(i){return yW(i)?!!(i.capabilities&&i.capabilities.data&&i.capabilities.data.supportsZ):bW(i)}function tpe(i){return i.layers!=null||bW(i)||yW(i)||_W(i)}function bW(i){switch(i.type){case"building-scene":case"elevation":case"integrated-mesh":case"point-cloud":case"scene":case"voxel":return!0;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"csv":case"dimension":case"geojson":case"feature":case"subtype-group":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"line-of-sight":case"map-image":case"map-notes":case"media":case"ogc-feature":case"open-street-map":case"oriented-imagery":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"wcs":case"web-tile":case"wfs":case"wms":case"wmts":case null:return!1}return!1}(function(i){i[i.Ok=0]="Ok",i[i.Units=1]="Units",i[i.HeightModel=2]="HeightModel",i[i.CRS=3]="CRS",i[i.Unsupported=4]="Unsupported"})(io||(io={}));const ipe=new Fx({heightModel:"gravity-related-height"});let H3,ZA=null;async function rpe(i){ZA||(ZA=G(()=>Promise.resolve().then(()=>d$),void 0).then(e=>H3=e)),await ZA,xi(i)}async function wW(i,e,t,r){if(!i)return null;const n=i.spatialReference;return fw()||pv(n,e)?Dd(i,e):H3?H3.projectGeometry(i,e,t,r):(await Promise.race([rpe(r),vP(r)]),wW(i,e,t,r))}let Pi=class extends ue{constructor(e){super(e),this.required={tileInfo:!1,heightModelInfo:!1,extent:!1},this.defaultSpatialReference=null,this.userSpatialReference=null,this.sourcePreloadCount=10,this.priorityCollection=null,this.requiresExtentInSpatialReference=!0,this.suspended=!1,this._projectExtentTask={task:null,input:null,output:null,spatialReference:null}}destroy(){this._projectExtentTask.task&&(this._projectExtentTask.task=iu(this._projectExtentTask.task)),this._set("map",null)}get ready(){return!this._spatialReferenceTask.updating&&!this._tileInfoTask.updating&&!this._extentTask.updating}get heightModelInfoReady(){return!this._heightModelInfoTask.updating}get spatialReference(){return y(this.userSpatialReference)?this.userSpatialReference:ct(this._spatialReferenceTask.spatialReference)}get extent(){return ct(this._extentTask.extent)}get heightModelInfo(){return ct(this._heightModelInfoTask.heightModelInfo)}get vcsWkid(){return ct(this._heightModelInfoTask.vcsWkid)}get latestVcsWkid(){return ct(this._heightModelInfoTask.latestVcsWkid)}get viewingMode(){return S(this.userSpatialReference)||this.userSpatialReference.equals(ct(this._spatialReferenceTask.spatialReference))?ct(this._spatialReferenceTask.viewingMode):null}get tileInfo(){return ct(this._tileInfoTask.tileInfo)}get mapCollections(){var r,n,s,a;const e=(r=this.map)==null?void 0:r.call(this),t=[];return y(this.priorityCollection)&&t.push(this.priorityCollection),t.push({parent:e==null?void 0:e.basemap,layers:(n=e==null?void 0:e.basemap)==null?void 0:n.baseLayers},{layers:e==null?void 0:e.layers},{parent:e==null?void 0:e.ground,layers:(s=e==null?void 0:e.ground)==null?void 0:s.layers},{parent:e==null?void 0:e.basemap,layers:(a=e==null?void 0:e.basemap)==null?void 0:a.referenceLayers}),t}get _allLayers(){return this._collectLayers(this.mapCollections)}get _spatialReferenceTask(){if(this.suspended)return this._get("_spatialReferenceTask")??{updating:!1};const{layers:e,updating:t}=this._allLayers;let r=null;for(const s of e){const a=this._getSupportedSpatialReferences(s);if(a.length>0){const o=this._narrowDownSpatialReferenceCandidates(r,a);y(o)&&(r=o)}if(y(r)&&r.length===1)break}if(t&&(S(r)||r.length!==1))return{updating:!0};const n=this._pickSpatialReferenceCandidate(r);return{spatialReference:y(n)?n.spatialReference:null,viewingMode:y(n)?n.viewingMode:null,updating:!1}}get _tileInfoTask(){var r,n,s,a,o,l,c;if(!this.required.tileInfo)return this._get("_tileInfoTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const{layers:e,updating:t}=this._collectLayers([{parent:(n=(r=this.map)==null?void 0:r.call(this))==null?void 0:n.basemap,layers:(o=(a=(s=this.map)==null?void 0:s.call(this))==null?void 0:a.basemap)==null?void 0:o.baseLayers},{layers:(c=(l=this.map)==null?void 0:l.call(this))==null?void 0:c.layers}]);if(e&&e.length>0&&"tileInfo"in e[0]){const u=e[0].tileInfo;return{tileInfo:u&&u.spatialReference.equals(this.spatialReference)?u:null,updating:!1}}return{updating:t}}get _heightModelInfoTask(){var r,n,s;if(!this.required.heightModelInfo||this.suspended&&((r=this._get("_heightModelInfoTask"))!=null&&r.heightModelInfo))return this._get("_heightModelInfoTask")??{updating:!1};const{layers:e,updating:t}=this._allLayers;for(const a of e)if(tpe(a)){const o=gW(a);if(o)return{heightModelInfo:o,vcsWkid:(n=a.spatialReference)==null?void 0:n.vcsWkid,latestVcsWkid:(s=a.spatialReference)==null?void 0:s.latestVcsWkid,updating:!1}}return{updating:t}}get _extentCandidatesTask(){if(this.suspended||!this.required.extent)return this._get("_extentCandidatesTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const e=this._allLayers,t=e.updating,r=[];for(const n of e.layers){const s="fullExtents"in n&&n.fullExtents||(y(n.fullExtent)?[n.fullExtent]:[]),a=this.requiresExtentInSpatialReference?null:s[0],o=s.find(l=>l.spatialReference.equals(this.spatialReference))??a;if(o)return{candidates:[{extent:o,layer:n}],updating:!1};if(this._getSupportedSpatialReferences(n).length>0)for(const l of s)r.push({extent:l,layer:n})}return{candidates:r,updating:t}}get _extentTask(){const{candidates:e,updating:t}=this._extentCandidatesTask;if(t)return{updating:t};if(S(e)||e.length===0)return{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const r=this._pickExtentCandidate(e),n=this.spatialReference;return r.extent.equals(this._projectExtentTask.input)&&n.equals(this._projectExtentTask.spatialReference)?{extent:this._projectExtentTask.output,updating:y(this._projectExtentTask.task)&&!this._projectExtentTask.task.finished}:(y(this._projectExtentTask.task)&&(this._projectExtentTask.task=iu(this._projectExtentTask.task)),this._projectExtentTask={input:r.extent.clone(),output:null,spatialReference:n.clone(),task:Dx(async s=>{try{const a=await wW(r.extent,n,r.layer.portalItem,s);this._projectExtentTask={...this._projectExtentTask,task:null,output:a}}catch{if(Ec(s))return;this._projectExtentTask={...this._projectExtentTask,task:null}}})},{updating:!0})}_narrowDownSpatialReferenceCandidates(e,t){if(S(e))return t;const r=[],n=(s,a)=>y(s)?y(a)?s===a&&s:s:a;for(const s of e)for(const a of t){if(!s.spatialReference.equals(a.spatialReference))continue;const o=n(s.viewingMode,a.viewingMode);if(o!==!1){r.push({spatialReference:s.spatialReference,viewingMode:o});break}}return r.length>0?r:null}_pickSpatialReferenceCandidate(e){const t=this.defaultSpatialReference;return S(e)||e.length<1?y(t)?{spatialReference:t,viewingMode:null}:null:(y(t)&&e.length>1&&e.some(({spatialReference:r})=>r.equals(t))&&(e=e.filter(({spatialReference:r})=>r.equals(t))),e.length>1&&e.some(({viewingMode:r})=>r!==Se.Local)&&(e=e.filter(({viewingMode:r})=>r!==Se.Local)),e[0])}_getSupportedSpatialReferences(e){const t="supportedSpatialReferences"in e&&e.supportedSpatialReferences||(e.spatialReference?[e.spatialReference]:[]);if(t.length===0)return[];const r=[];for(const n of t){const s=this.getSpatialReferenceSupport({spatialReference:n,layer:e});if(y(s)){const a=y(s.constraints)?s.constraints:[{spatialReference:n,viewingMode:null}];for(const{spatialReference:o,viewingMode:l}of a)(!this.requiresExtentInSpatialReference||S(this.userSpatialReference)||o.equals(this.userSpatialReference))&&r.push({spatialReference:o,viewingMode:l})}}return r}_pickExtentCandidate(e){const t=this.spatialReference;return e.find(({extent:r})=>t.equals(r.spatialReference))||e[0]}_collectLayers(e){var r;if(this._loadMaybe((r=this.map)==null?void 0:r.call(this))!=="loaded")return{layers:[],updating:!0};const t={layers:[],preloading:-1,updating:!1};for(const n of e)if(this._collectCollection(n,t),t.preloading===this.sourcePreloadCount)break;return{layers:t.layers,updating:t.updating}}_collectCollection(e,t){if(e.layers){switch(this._loadMaybe(e.parent)){case"loading":return t.updating=!0,void++t.preloading;case"failed":return}for(const r of e.layers){switch(this._loadMaybe(r)){case"failed":continue;case"loading":t.updating=!0,++t.preloading;break;case"loaded":t.updating||t.layers.push(r),"layers"in r&&this._collectCollection({layers:r.layers},t)}if(t.preloading===this.sourcePreloadCount)break}}}_loadMaybe(e){return e&&"loadStatus"in e?e.loadStatus==="not-loaded"?(e.load().catch(()=>{}),"loading"):e.loadStatus:"loaded"}};h([p()],Pi.prototype,"required",void 0),h([p({constructOnly:!0})],Pi.prototype,"map",void 0),h([p({constructOnly:!0})],Pi.prototype,"getSpatialReferenceSupport",void 0),h([p()],Pi.prototype,"defaultSpatialReference",void 0),h([p()],Pi.prototype,"userSpatialReference",void 0),h([p()],Pi.prototype,"sourcePreloadCount",void 0),h([p()],Pi.prototype,"priorityCollection",void 0),h([p()],Pi.prototype,"requiresExtentInSpatialReference",void 0),h([p()],Pi.prototype,"suspended",void 0),h([p({readOnly:!0})],Pi.prototype,"ready",null),h([p({readOnly:!0})],Pi.prototype,"heightModelInfoReady",null),h([p({readOnly:!0})],Pi.prototype,"spatialReference",null),h([p({readOnly:!0})],Pi.prototype,"extent",null),h([p({readOnly:!0})],Pi.prototype,"heightModelInfo",null),h([p({readOnly:!0})],Pi.prototype,"vcsWkid",null),h([p({readOnly:!0})],Pi.prototype,"latestVcsWkid",null),h([p({readOnly:!0})],Pi.prototype,"viewingMode",null),h([p({readOnly:!0})],Pi.prototype,"tileInfo",null),h([p({readOnly:!0})],Pi.prototype,"mapCollections",null),h([p({readOnly:!0})],Pi.prototype,"_allLayers",null),h([p({readOnly:!0})],Pi.prototype,"_spatialReferenceTask",null),h([p({readOnly:!0})],Pi.prototype,"_tileInfoTask",null),h([p({readOnly:!0})],Pi.prototype,"_heightModelInfoTask",null),h([p({readOnly:!0})],Pi.prototype,"_extentCandidatesTask",null),h([p()],Pi.prototype,"_extentTask",null),h([p()],Pi.prototype,"_projectExtentTask",void 0),Pi=h([D("esri.views.support.DefaultsFromMap")],Pi);var US;let Ye=US=class extends Lx(nn.EventedMixin(cD(ue))){constructor(i){super(i),this._userSpatialReference=null,this._cursor=null,this.allLayerViews=new mw({getCollections:()=>{var e,t,r;return[(e=this.basemapView)==null?void 0:e.baseLayerViews,(t=this.groundView)==null?void 0:t.layerViews,this.layerViews,(r=this.basemapView)==null?void 0:r.referenceLayerViews]},getChildrenFunction:e=>e.layerViews}),this.groundView=null,this.basemapView=null,this.fatalError=null,this.graphics=new H7,this.analyses=new nv,this.typeSpecificPreconditionsReady=!0,this.layerViews=new pt,this.magnifier=new cW,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this.spatialReferenceWarningDelay=1e3,this.supportsGround=!0,this.timeExtent=null,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this.input=new Kde,this.navigation=new fW,this.layerViewManager=null,this.analysisViewManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new Gde(this),this.persistableViewModels=new pt,this._isValid=!1,this._readyCycleForced=!1,this.handles.add(z(()=>this.preconditionsReady,e=>{var t,r;e?(this._currentSpatialReference=this.spatialReference,US.views.add(this)):(this._currentSpatialReference=null,US.views.remove(this)),this.notifyChange("spatialReference"),!e&&this.ready?((t=this.toolViewManager)==null||t.detach(),y(this.analysisViewManager)&&this.analysisViewManager.detach(),(r=this.layerViewManager)==null||r.clear(),this._teardown()):e&&!this.ready&&(this._startup(),y(this.analysisViewManager)&&this.analysisViewManager.attach(),this.toolViewManager.attach())},ri))}initialize(){this.addResolvingPromise(this.validate().then(()=>(this._isValid=!0,Pm(()=>this.ready)))),this.basemapView=new bp({view:this}),this.layerViewManager=new zde({view:this,layerViewImporter:{importLayerView:i=>this.importLayerView(i),hasLayerViewModule:i=>this.hasLayerViewModule(i)},supportsGround:this.supportsGround}),this.toolViewManager=new Xde({view:this}),this._setupSpatialReferenceLogger(),this.handles.add([z(()=>this.initialExtentRequired,i=>this.defaultsFromMap.required={...this.defaultsFromMap.required,extent:i},{sync:!0,initial:!0}),z(()=>this.ready,i=>{this.defaultsFromMap&&(this.defaultsFromMap.suspended=i,this.defaultsFromMap.userSpatialReference=i?this.spatialReference:this._userSpatialReference)},{sync:!0}),z(()=>this._userSpatialReference,i=>{this.defaultsFromMap&&(this.defaultsFromMap.userSpatialReference=i)},{sync:!0,initial:!0})])}_setupSpatialReferenceLogger(){let i=null;this.handles.add([z(()=>{var e;return(e=this.defaultsFromMap)==null?void 0:e.ready},e=>{var r;const t=((r=this.map)==null?void 0:r.allLayers.length)>0;if(e&&!this.spatialReference&&t){if(y(i))return;const n=uw(()=>i=iu(i));i=Dx(async s=>{try{await B0(this.spatialReferenceWarningDelay,null,s)}catch{return}finally{i=null}J.getLogger(this.declaredClass).warn("#spatialReference","no spatial reference could be derived from the currently added map layers")}),this.handles.add(n,"spatial-reference-logger-task")}else this.handles.remove("spatial-reference-logger-task")},{sync:!0})])}destroy(){if(this.destroyed)return;this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=Te(this.graphics),this.analyses=Te(this.analyses),this.handles.remove("defaultsFromMap"),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),Te(this.analysisViewManager),this.toolViewManager=Te(this.toolViewManager),this.layerViewManager=Te(this.layerViewManager),this.basemapView=Te(this.basemapView),this.invalidate(),this._emitter.clear(),this.handles.removeAll();const i=this.map;this.map=null,i==null||i.destroy()}_startup(){this._set("ready",!0)}_teardown(){this._set("ready",!1)}whenReady(){return Promise.resolve(this)}toMap(){return J.getLogger(this.declaredClass).error("#toMap()","Not implemented on this instance of View"),null}get activeTool(){var i;return(i=this.toolViewManager)==null?void 0:i.activeTool}set activeTool(i){this.toolViewManager&&(this.toolViewManager.activeTool=i)}get animation(){return this._get("animation")}set animation(i){this._set("animation",i)}get _defaultsFromMapSettings(){return{}}get defaultsFromMap(){return new Pi({required:{tileInfo:!1,heightModelInfo:!1,extent:!1},map:()=>this.map,getSpatialReferenceSupport:i=>this.getSpatialReferenceSupport(i),...this._defaultsFromMapSettings})}get extent(){return this._get("extent")}set extent(i){this._set("extent",i)}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get interacting(){return this.navigating}get navigating(){return!1}get preconditionsReady(){var i;return!(this.fatalError||!this._isValid||this._readyCycleForced||!this.map||Am.isLoadable(this.map)&&!this.map.loaded||this.width===0||this.height===0||!this.spatialReference||!this._validateSpatialReference(this.spatialReference)||!this._currentSpatialReference&&!((i=this.defaultsFromMap)!=null&&i.ready)||!this.typeSpecificPreconditionsReady)}set map(i){i!==this._get("map")&&(i!=null&&i.destroyed&&(J.getLogger(this.declaredClass).warn("#map","The provided map is already destroyed",{map:i}),i=null),Am.isLoadable(i)&&i.load().catch(()=>{}),this.constructed&&(this.forceReadyCycle(),this._currentSpatialReference=null),this._set("map",i))}get spatialReference(){var e,t;let i=this._userSpatialReference||this._currentSpatialReference||this.getDefaultSpatialReference()||null;return i&&((t=(e=this.defaultsFromMap)==null?void 0:e.required)!=null&&t.heightModelInfo)&&(i=i.clone(),i.vcsWkid=this.defaultsFromMap.vcsWkid,i.latestVcsWkid=this.defaultsFromMap.latestVcsWkid),i}set spatialReference(i){const e=!Bm(i,this._get("spatialReference"));this._set("_userSpatialReference",i),e&&(this._set("spatialReference",i),this._spatialReferenceChanged(i))}_spatialReferenceChanged(i){}get stationary(){return!this.animation&&!this.navigating&&!this.resizing}get tools(){var i;return(i=this.toolViewManager)==null?void 0:i.tools}get initialExtent(){var i;return(i=this.defaultsFromMap)==null?void 0:i.extent}get cursor(){const i=this.toolViewManager?this.toolViewManager.cursor:null;return y(i)?i:this._cursor||"default"}set cursor(i){this._cursor=i,this.notifyChange("cursor")}get size(){return[this.width,this.height]}whenLayerView(i){return this.layerViewManager.whenLayerView(i)}getDefaultSpatialReference(){var i;return(i=this.defaultsFromMap)==null?void 0:i.spatialReference}getDefaultHeightModelInfo(){var i;return(this.map&&"heightModelInfo"in this.map?this.map.heightModelInfo:void 0)??((i=this.defaultsFromMap)==null?void 0:i.heightModelInfo)??null}importLayerView(i){throw new K("importLayerView() not implemented")}hasLayerViewModule(i){return!1}async validate(){}invalidate(){this._isValid=!1}getSpatialReferenceSupport(){return{constraints:null}}_validateSpatialReference(i){return y(this.getSpatialReferenceSupport({spatialReference:i}))}when(i,e){return this.isResolved()&&!this.ready&&J.getLogger(this.declaredClass).warn("#when()","Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use reactiveUtils.whenOnce(() => view.ready).then(...) instead."),super.when(i,e)}forceReadyCycle(){this.ready&&(cs(()=>this.preconditionsReady===!1,()=>this._readyCycleForced=!1,{once:!0}),this._readyCycleForced=!0)}addAndActivateTool(i){this.toolViewManager.tools.add(i),this.activeTool=i}tryFatalErrorRecovery(){this.fatalError=null}};Ye.views=new pt,h([p()],Ye.prototype,"_userSpatialReference",void 0),h([p()],Ye.prototype,"activeTool",null),h([p({readOnly:!0})],Ye.prototype,"allLayerViews",void 0),h([p()],Ye.prototype,"groundView",void 0),h([p()],Ye.prototype,"animation",null),h([p()],Ye.prototype,"basemapView",void 0),h([p({readOnly:!0})],Ye.prototype,"_defaultsFromMapSettings",null),h([p()],Ye.prototype,"defaultsFromMap",null),h([p()],Ye.prototype,"fatalError",void 0),h([p({type:ui})],Ye.prototype,"extent",null),h([p(pI(H7,"graphics"))],Ye.prototype,"graphics",void 0),h([p(pI(nv,"analyses"))],Ye.prototype,"analyses",void 0),h([p({readOnly:!0,type:Fx})],Ye.prototype,"heightModelInfo",null),h([p({readOnly:!0})],Ye.prototype,"interacting",null),h([p({readOnly:!0})],Ye.prototype,"navigating",null),h([p({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_currentSpatialReference","defaultsFromMap.ready","typeSpecificPreconditionsReady"]})],Ye.prototype,"preconditionsReady",null),h([p({readOnly:!0})],Ye.prototype,"typeSpecificPreconditionsReady",void 0),h([p({type:pt,readOnly:!0})],Ye.prototype,"layerViews",void 0),h([p({type:cW})],Ye.prototype,"magnifier",void 0),h([p({value:null,type:lR})],Ye.prototype,"map",null),h([p()],Ye.prototype,"padding",void 0),h([p({readOnly:!0})],Ye.prototype,"ready",void 0),h([p({type:Qt})],Ye.prototype,"spatialReference",null),h([p()],Ye.prototype,"spatialReferenceWarningDelay",void 0),h([p()],Ye.prototype,"stationary",null),h([p({readOnly:!0})],Ye.prototype,"supportsGround",void 0),h([p({type:H0})],Ye.prototype,"timeExtent",void 0),h([p()],Ye.prototype,"tools",null),h([p()],Ye.prototype,"toolViewManager",void 0),h([p({readOnly:!0})],Ye.prototype,"type",void 0),h([p({type:Number})],Ye.prototype,"scale",void 0),h([p({readOnly:!0})],Ye.prototype,"updating",void 0),h([p({readOnly:!0})],Ye.prototype,"initialExtentRequired",void 0),h([p({readOnly:!0})],Ye.prototype,"initialExtent",null),h([p()],Ye.prototype,"cursor",null),h([p({readOnly:!0})],Ye.prototype,"input",void 0),h([p({type:fW,nonNullable:!0})],Ye.prototype,"navigation",void 0),h([p()],Ye.prototype,"layerViewManager",void 0),h([p()],Ye.prototype,"analysisViewManager",void 0),h([p()],Ye.prototype,"width",void 0),h([p()],Ye.prototype,"height",void 0),h([p({readOnly:!0})],Ye.prototype,"resizing",void 0),h([p({value:null,readOnly:!0})],Ye.prototype,"size",null),h([p({readOnly:!0})],Ye.prototype,"suspended",void 0),h([p({readOnly:!0})],Ye.prototype,"viewEvents",void 0),h([p({readOnly:!0})],Ye.prototype,"persistableViewModels",void 0),h([p()],Ye.prototype,"_isValid",void 0),h([p()],Ye.prototype,"_readyCycleForced",void 0),h([p()],Ye.prototype,"_currentSpatialReference",void 0),Ye=US=h([D("esri.views.View")],Ye);const xW=Ye;let xp=class extends Eie{constructor(e){super(e),this.state="running",this.target=null,this._dfd=null}initialize(){this.addResolvingPromise(new Promise((e,t)=>this._dfd={resolve:e,reject:t}))}get done(){return this.state==="finished"||this.state==="stopped"}stop(){var e;this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","stopped"),(e=this._dfd)==null||e.reject(new K("ViewAnimation stopped")))}finish(){var e;this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","finished"),(e=this._dfd)==null||e.resolve())}update(e,t){t||(t=Mx(e)?"waiting-for-target":"running"),this._set("target",e),this._set("state",t)}};h([p({readOnly:!0})],xp.prototype,"done",null),h([p({readOnly:!0,type:String})],xp.prototype,"state",void 0),h([p()],xp.prototype,"target",void 0),xp=h([D("esri.views.ViewAnimation")],xp),function(i){i.State={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"}}(xp||(xp={}));const Md=xp;function wm(){return[1,0,0,1,0,0]}function npe(i){return[i[0],i[1],i[2],i[3],i[4],i[5]]}function spe(i,e,t,r,n,s){return[i,e,t,r,n,s]}function ape(i,e){return new Float64Array(i,e,6)}Object.freeze(Object.defineProperty({__proto__:null,create:wm,clone:npe,fromValues:spe,createView:ape},Symbol.toStringTag,{value:"Module"}));const TW=96,CW=39.37,ope=180/Math.PI;function SW(i){return i.wkid?i:i.spatialReference||Qt.WGS84}function rN(i,e){return e.type?Je(i,e.x,e.y):wn(i,e)}function EW(i){return Gm(i)}function jb(i,e){const t=Math.max(1,e[0]),r=Math.max(1,e[1]);return Math.max(i.width/t,i.height/r)*gpe(i.spatialReference)}async function G1(i,e,t,r){let n,s;if(!i||Array.isArray(i)&&!i.length)return null;if(pt.isCollection(i)&&(i=i.toArray()),Array.isArray(i)&&i.length&&typeof i[0]=="object"){const o=i.every(u=>"attributes"in u),l=i.some(u=>!u.geometry);let c=i;if(o&&l&&e&&e.allLayerViews){const u=new Map;for(const _ of i){const g=_.layer,x=u.get(g)||[],b=_.attributes[g.objectIdField];b!=null&&x.push(b),u.set(g,x)}const d=[];u.forEach((_,g)=>{const x=e.allLayerViews.find(b=>b.layer.id===g.id);if("queryFeatures"in x){const b=g.createQuery();b.objectIds=_,b.returnGeometry=!0,d.push(x.queryFeatures(b))}});const m=await Promise.all(d),f=[];for(const _ of m)if(_&&_.features&&_.features.length)for(const g of _.features)y(g.geometry)&&f.push(g.geometry);c=f}for(const u of c)r=await G1(u,e,t,r);return r}if(Array.isArray(i)&&i.length===2&&typeof i[0]=="number"&&typeof i[1]=="number")n=new Ne(i);else if(i instanceof g7)n=i;else if("geometry"in i){if(i.geometry)n=i.geometry;else if(i.layer){const o=i.layer,l=e.allLayerViews.find(c=>c.layer.id===o.id);if("queryFeatures"in l){const c=o.createQuery();c.objectIds=[i.attributes[o.objectIdField]],c.returnGeometry=!0;const u=await l.queryFeatures(c);n=en(u,"features",0,"geometry")}}}if(S(n)||(s=n.type==="point"?new ui({xmin:n.x,ymin:n.y,xmax:n.x,ymax:n.y,spatialReference:n.spatialReference}):n.extent,!s))return null;fw()||pv(s.spatialReference,t)||await vP();const a=Dd(s,t);return a?r=r?r.union(a):a:null}function lpe(i){if(i&&(!Array.isArray(i)||typeof i[0]!="number")&&(typeof i=="object"||Array.isArray(i)&&typeof i[0]=="object")){if("layer"in i&&i.layer&&i.layer.minScale&&i.layer.maxScale){const e=i.layer;return{min:e.minScale,max:e.maxScale}}if(Array.isArray(i)&&i.length&&i.every(e=>"layer"in e)){let e=0,t=0;for(const r of i){const n=r.layer;n&&n.minScale&&n.maxScale&&(e=n.minScale<e?n.minScale:e,t=n.maxScale>t?n.maxScale:t)}return e&&t?{min:e,max:t}:null}}}function YA(i,e){return Bm(SW(i),e)?i:Dd(i,e)}async function cpe(i,e){if(!i||!e)return new rr({targetGeometry:new Ne,scale:0,rotation:0});let t=e.spatialReference;const{constraints:r,padding:n,viewpoint:s,size:a}=e,o=[n?a[0]-n.left-n.right:a[0],n?a[1]-n.top-n.bottom:a[1]];let l=null;i instanceof rr?l=i:i.viewpoint?l=i.viewpoint:i.target&&i.target.declaredClass==="esri.Viewpoint"&&(l=i.target);let c=null;l&&l.targetGeometry?c=l.targetGeometry:i instanceof ui?c=i:(i||i&&("center"in i||"extent"in i||"target"in i))&&(c=await G1(i.center,e,t)||await G1(i.extent,e,t)||await G1(i.target,e,t)||await G1(i,e,t)),!c&&s&&s.targetGeometry?c=s.targetGeometry:!c&&e.extent&&(c=e.extent),t||(t=SW(e.spatialReference||e.extent||c)),fw()||Bm(c.spatialReference,t)||pv(c,t)||await vP();const u=YA(c.center?c.center:c,t);let d=null;if(l&&y(l.targetGeometry)&&l.targetGeometry.type==="point")d=l.scale;else if("scale"in i&&i.scale)d=i.scale;else if("zoom"in i&&i.zoom!==-1&&r&&r.effectiveLODs)d=r.zoomToScale(i.zoom);else if(Array.isArray(c)||c.type==="point"||c.type==="extent"&&c.width===0&&c.height===0){const g=YA(e.extent,t);d=y(g)?jb(g,o):e.extent?jb(e.extent,o):s.scale}else d=jb(YA(c.extent,t),o);const m=lpe(i);m&&(m.min&&m.min>d?d=m.min:m.max&&m.max<d&&(d=m.max));let f=0;l?f=l.rotation:i.hasOwnProperty("rotation")?f=i.rotation:s&&(f=s.rotation);let _=new rr({targetGeometry:u,scale:d,rotation:f});return r&&(_=r.fit(_),r.constrainByGeometry(_),r.rotationEnabled||(_.rotation=f)),_}function Xc(i,e){const t=i.targetGeometry,r=e.targetGeometry;return t.x=r.x,t.y=r.y,t.spatialReference=r.spatialReference,i.scale=e.scale,i.rotation=e.rotation,i}function hpe(i,e,t){return t?Je(i,.5*(e[0]-t.right+t.left),.5*(e[1]-t.bottom+t.top)):qs(i,e,.5)}const upe=function(){const i=be();return function(e,t,r){const n=t.targetGeometry;rN(i,n);const s=.5*wv(t);return e.xmin=i[0]-s*r[0],e.ymin=i[1]-s*r[1],e.xmax=i[0]+s*r[0],e.ymax=i[1]+s*r[1],e.spatialReference=n.spatialReference,e}}();function dpe(i,e,t,r,n){return j3(i,e,t.center),i.scale=jb(t,r),n&&n.constraints&&n.constraints.constrain(i),i}function ppe(i,e,t,r){return aN(i,e,t,r),z7(i,i)}const PW=function(){const i=be();return function(e,t,r){return j7(e,_pe(e,t),hpe(i,t,r))}}(),mpe=function(){const i=wm(),e=be();return function(t,r,n,s){const a=wv(r),o=nN(r);return Je(e,a,a),gie(i,e),aD(i,i,o),$E(i,i,PW(e,n,s)),$E(i,i,[0,s.top-s.bottom]),Je(t,i[4],i[5])}}();function wv(i){return i.scale*fpe(i.targetGeometry)}function fpe(i){return y(i)&&f7(i.spatialReference)?1/(EW(i.spatialReference)*CW*TW):1}function nN(i){return SP(i.rotation)||0}function gpe(i){return f7(i)?EW(i)*CW*TW:1}function _pe(i,e){return qs(i,e,.5)}const sN=function(){const i=be(),e=be(),t=be();return function(r,n,s,a,o,l){return q7(i,n),qs(e,s,.5*l),Je(t,1/a*l,-1/a*l),U7(r,e),o&&aD(r,r,o),V7(r,r,t),$E(r,r,i),r}}(),aN=function(){const i=be();return function(e,t,r,n){const s=wv(t),a=nN(t);return rN(i,t.targetGeometry),sN(e,i,r,s,a,n)}}(),ype=function(){const i=be();return function(e,t,r,n){const s=wv(t);return rN(i,t.targetGeometry),sN(e,i,r,s,0,n)}}();function vpe(i){const e=_7(i);return e?e.valid[1]-e.valid[0]:0}function bpe(i,e){return Math.round(vpe(i)/e)}const wpe=function(){const i=be(),e=be(),t=[0,0,0];return function(r,n,s){Pc(i,r,n),j0(i,i),Pc(e,r,s),j0(e,e),Oie(t,i,e);let a=Math.acos(Fr(i,e)/(gI(i)*gI(e)))*ope;return t[2]<0&&(a=-a),isNaN(a)&&(a=0),a}}(),xpe=function(){const i=be();return function(e,t,r,n){const s=e.targetGeometry;return Xc(e,t),mpe(i,t,r,n),s.x+=i[0],s.y+=i[1],e}}(),j3=function(i,e,t){Xc(i,e);const r=i.targetGeometry;return r.x=t.x,r.y=t.y,r.spatialReference=t.spatialReference,i},Tpe=function(){const i=be();return function(e,t,r,n,s){s||(s="center"),j7(i,r,n),qs(i,i,.5);const a=i[0],o=i[1];switch(s){case"center":Je(i,0,0);break;case"left":Je(i,-a,0);break;case"top":Je(i,0,o);break;case"right":Je(i,a,0);break;case"bottom":Je(i,0,-o);break;case"top-left":Je(i,-a,o);break;case"bottom-left":Je(i,-a,-o);break;case"top-right":Je(i,a,o);break;case"bottom-right":Je(i,a,-o)}return cR(e,t,i),e}}();function J5e(i,e,t){return Xc(i,e),i.rotation+=t,i}function Cpe(i,e,t){return Xc(i,e),i.rotation=t,i}const Spe=function(){const i=be();return function(e,t,r,n,s){return Xc(e,t),isNaN(r)||r===0||(AW(i,n,t,s),e.scale=t.scale*r,OW(i,i,e,s),cR(e,e,Je(i,i[0]-n[0],n[1]-i[1]))),e}}();function pV(i,e,t){return Xc(i,e),i.scale=t,i}const RW=function(){const i=be();return function(e,t,r,n,s,a){return Xc(e,t),isNaN(r)||r===0||(AW(i,s,t,a),e.scale=t.scale*r,e.rotation+=n,OW(i,i,e,a),cR(e,e,Je(i,i[0]-s[0],s[1]-i[1]))),e}}(),eke=function(){const i=be(),e=be();return function(t,r,n,s,a,o,l){return PW(e,o,l),yc(i,a,e),s?RW(t,r,n,s,i,o):Spe(t,r,n,i,o)}}(),AW=function(){const i=wm();return function(e,t,r,n){return Yu(e,t,ppe(i,r,n,1))}}(),OW=function(){const i=wm();return function(e,t,r,n){return Yu(e,t,aN(i,r,n,1))}}(),cR=function(){const i=be(),e=wm();return function(t,r,n){Xc(t,r);const s=wv(r),a=t.targetGeometry;return fie(e,nN(r)),V7(e,e,Xt(s,s)),Yu(i,n,e),a.x+=i[0],a.y+=i[1],t}}();let Epe=class{constructor(e,t,r,n){const s=e.targetGeometry,a=t.targetGeometry;n?typeof n=="string"&&(n=Aie(n)||fI.ease):n=fI.ease,this.easing=n,this.duration=r,this.sCenterX=s.x,this.sCenterY=s.y,this.sScale=e.scale,this.sRotation=e.rotation,this.tCenterX=a.x,this.tCenterY=a.y,this.tScale=t.scale,this.tRotation=t.rotation,this.dCenterX=this.tCenterX-this.sCenterX,this.dCenterY=this.tCenterY-this.sCenterY,this.dScale=this.tScale-this.sScale,this.dRotation=this.tRotation-this.sRotation,this.dRotation>180?this.dRotation-=360:this.dRotation<-180&&(this.dRotation+=360)}applyRatio(e,t){const r=this.easing(t);let n,s,a,o;t>=1?(n=this.tCenterX,s=this.tCenterY,a=this.tRotation,o=this.tScale):(n=this.sCenterX+r*this.dCenterX,s=this.sCenterY+r*this.dCenterY,a=this.sRotation+r*this.dRotation,o=this.sScale+r*this.dScale),e.targetGeometry.x=n,e.targetGeometry.y=s,e.scale=o,e.rotation=a}},$u=class extends ue{constructor(e){super(e),this.duration=200,this.transition=null,this.easing=fI.ease,this.view=null,this.viewpoint=null,this.viewpoint=new rr({targetGeometry:new Ne,scale:0,rotation:0}),this._updateTask=wd({postRender:this._postRender.bind(this)}),this._updateTask.pause()}destroy(){this._updateTask.remove(),this._updateTask=null}animate(e,t,r){this.stop();const n=this.viewpoint;Xc(n,t),this.transition=new Epe(this.viewpoint,e.target,r&&r.duration||this.duration,r&&r.easing||this.easing);const s=()=>{this.animation===e&&this._updateTask&&(e.state==="finished"&&(this.transition.applyRatio(this.viewpoint,1),this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.animation=null,this.updateFunction=null)};return e.when(s,s),this._startTime=performance.now(),this._updateTask.resume(),this.animation=e,e}animateContinous(e,t){this.stop(),this.updateFunction=t,this.viewpoint=e;const r=new Md({target:e.clone()}),n=()=>{this.animation===r&&this._updateTask&&(this.animation=null,this.updateFunction=null)};return r.when(n,n),this._startTime=performance.now(),this._updateTask.resume(),this.animation=r,r}stop(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null)}_postRender(e){const t=this.animation;if(t&&t.state!==Md.State.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,e.deltaTime);else{const r=(performance.now()-this._startTime)/this.transition.duration,n=r>=1;this.transition.applyRatio(this.viewpoint,r),n&&this.animation.finish()}this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())}else this._updateTask.pause()}};h([p()],$u.prototype,"animation",void 0),h([p()],$u.prototype,"duration",void 0),h([p()],$u.prototype,"transition",void 0),h([p()],$u.prototype,"easing",void 0),h([p()],$u.prototype,"view",void 0),h([p()],$u.prototype,"viewpoint",void 0),$u=h([D("esri.views.2d.AnimationManager")],$u);const Ppe=$u;let Rpe=class{constructor(e){this.view=e,this._frameTaskHandle=null,this._updateRequested=!1,this.stationary=!0,this.animationInProgress=!1,this.prepare=()=>{this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions},this.update=()=>{this._updateRequested=!1;const{basemapView:t,graphicsView:r,labelManager:n,layerViews:s,state:{id:a}}=this.view;t.baseLayerViews.forEach(this._updateLayerView,this),s.forEach(this._updateLayerView,this),t.referenceLayerViews.forEach(this._updateLayerView,this),y(n)&&(n.lastUpdateId!==a&&(n.viewChange(),n.lastUpdateId=a),n.updateRequested&&n.processUpdate(this._updateParameters)),y(r)&&(r.lastUpdateId!==a&&(r.viewChange(),r.lastUpdateId=a),r.updateRequested&&r.processUpdate(this._updateParameters)),this.view.graphicsTileStore.setViewState(this._updateParameters.state),this.animationInProgress||this._updateRequested||this._frameTaskHandle.pause()}}destroy(){this.stop()}start(){if(this._frameTaskHandle)return;const e=this.view;this.stationary=e.stationary,this._updateParameters={state:e.state,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:e.renderingOptions},this._stationaryHandle=z(()=>e.stationary,t=>{this.stationary=t,this.requestFrame()}),this._frameTaskHandle=wd(this),this.requestUpdate()}stop(){this._frameTaskHandle&&(this._updateRequested=!1,this._stationaryHandle.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0,this.animationInProgress=!1)}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame())}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume()}_updateLayerView(e){const t=this.view.state,r=e.lastUpdateId;r!=null&&(this.stationary||e.moving)||(e.moving=!0,e.moveStart()),r!==t.id&&e.viewChange(),this.stationary&&e.moving&&(e.moving=!1,e.moveEnd()),e.lastUpdateId=t.id,e.updateRequested&&e.processUpdate(this._updateParameters),"layerViews"in e&&e.layerViews.forEach(this._updateLayerView,this)}};function dn(){return Promise.all([G(()=>import("./webglDeps-291b9ada.js"),["assets/webglDeps-291b9ada.js","assets/FramebufferObject-a3b9c52c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/typedArrayUtil-4d7bb04c.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/context-util-a4ce3a7b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/Evented-a45c8b0f.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/VertexElementDescriptor-2925c6af.js","assets/ShaderCompiler-77d0dcb6.js","assets/programUtils-f035fe8a.js","assets/ProgramTemplate-cc7f8b69.js","assets/preload-helper-3bce6601.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/vec2-528adfe4.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),G(()=>import("./mapViewDeps-d5a67c12.js"),["assets/mapViewDeps-d5a67c12.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/typedArrayUtil-4d7bb04c.js","assets/promiseUtils-1e54421e.js","assets/reactiveUtils-4dabbb80.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/mat3f32-d3d088e8.js","assets/Rasterizer-dce80cb8.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/_commonjsHelpers-a430e9ea.js","assets/imageutils-c0676a73.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/cimAnalyzer-38842966.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/arcadeOnDemand-281a01eb.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-193543b5.js","assets/jsonUtils-229211af.js","assets/enums-2658a65c.js","assets/alignmentUtils-ae955d28.js","assets/mat2d-2bbb5feb.js","assets/vec2-528adfe4.js","assets/vec2f32-461e65a9.js","assets/number-954e4ab6.js","assets/Rect-ea14f53a.js","assets/callExpressionWithFeature-55effb7b.js","assets/quantizationUtils-4dd81f85.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-9ad35d39.js","assets/rasterizingUtils-ec11e94c.js","assets/utils-317368cb.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/Evented-a45c8b0f.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/enums-4ca4641f.js","assets/MaterialKey-0093a242.js","assets/Utils-69cc114d.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/BufferPool-b74ae6cb.js","assets/WGLContainer-8a3733a0.js","assets/WGLBrushVTLSymbol-d778c554.js","assets/FramebufferObject-a3b9c52c.js","assets/StyleDefinition-ff072275.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/pixelUtils-d9cd2e49.js","assets/ShaderCompiler-77d0dcb6.js","assets/ProgramTemplate-cc7f8b69.js","assets/heatmapTextureUtils-2627384f.js","assets/earcut-58237617.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/VTLMaterialManager-2c63b5e3.js","assets/enums-0fc02184.js","assets/programUtils-f035fe8a.js","assets/MaterialPrograms-b885dd99.js","assets/pbf-0e99a620.js","assets/Matcher-f2620e9f.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/Queue-b7d3cd48.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/enumeration-3a03bd31.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Clonable-545593ce.js","assets/visualVariablesUtils-0d4b5279.js","assets/visualVariablesUtils-ecd70012.js","assets/tileUtils-55e656c2.js","assets/TileClipper-4637f47d.js","assets/assets-8d3e737a.js","assets/Geometry-daada628.js","assets/defaultsJSON-59981e75.js","assets/LRUCache-64ec42ee.js","assets/MemCache-18a255ed.js","assets/ExpandedCIM-b7ed8ce5.js","assets/devEnvironmentUtils-5002a058.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/locale-30120714.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/persistableUrlUtils-5f719c3b.js","assets/styleUtils-22b14a8b.js","assets/CircularArray-f4b6cd92.js","assets/MeshComponent-a43522cc.js","assets/deduplicate-03981d62.js","assets/HandleOwner-9b396af1.js","assets/FeatureSetReader-7e79a15e.js","assets/centroid-5c988df3.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/sizeVariableUtils-d4870b0d.js","assets/BaseGraphicContainer-78fa9e25.js","assets/projectionSupport-aa5eaa0d.js","assets/projection-290b739f.js","assets/SimpleObservable-23231131.js","assets/zscale-89472cba.js","assets/json-48e3ea08.js","assets/labelingInfo-607e66b8.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/fieldUtils-7f54c4b1.js","assets/Symbol-f93ed9fd.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/Collection-910b6f71.js","assets/collectionUtils-803d9ba8.js","assets/labelUtils-3108e8d7.js","assets/jsonUtils-0ff4ff96.js","assets/FeatureContainer-934cc4cc.js","assets/TileContainer-21007653.js","assets/capabilities-302cf20d.js","assets/schemaUtils-9c08f5e8.js","assets/LayerFloorInfo-54b916a2.js","assets/diffUtils-68b89c71.js","assets/createSymbolSchema-36503ad8.js","assets/rendererUtils-0bcb63a1.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/PopupTemplate-40f3c9aa.js","assets/number-27cf8195.js","assets/Identifiable-bfe1ff30.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/colorRamps-9dac42c1.js","assets/Graphic-f0e54e86.js","assets/compilerUtils-18d58939.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/deprecate-035b199e.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/util-4239daf3.js","assets/ComputedAttributeStorage-2b4316ba.js","assets/FieldsIndex-f104cc5f.js","assets/normalizeUtils-27e29a72.js","assets/GraphicsView-d3b9d029.js","assets/vec3f32-c9aa289f.js","assets/GraphicContainer-d62248af.js","assets/asyncUtils-437defc4.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/RelationshipQuery-0dda77ad.js","assets/utils-6786b611.js","assets/ItemCache-fd3aceaf.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/dehydratedFeatures-0557137d.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/SnappingCandidate-970faec6.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])])}const Zv=()=>dn().then(()=>G(()=>import("./TileLayerView2D-d7752d45.js"),["assets/TileLayerView2D-d7752d45.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/reactiveUtils-4dabbb80.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/imageUtils-5e882683.js","assets/BitmapTileContainer-d91c0937.js","assets/aaBoundingRect-193543b5.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/mat3f32-d3d088e8.js","assets/Bitmap-479ee434.js","assets/mat3-3fc68e72.js","assets/vec2f32-461e65a9.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/Evented-a45c8b0f.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/WGLContainer-8a3733a0.js","assets/WGLBrushVTLSymbol-d778c554.js","assets/enums-2658a65c.js","assets/enums-4ca4641f.js","assets/number-954e4ab6.js","assets/FramebufferObject-a3b9c52c.js","assets/StyleDefinition-ff072275.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/pixelUtils-d9cd2e49.js","assets/Utils-69cc114d.js","assets/ShaderCompiler-77d0dcb6.js","assets/ProgramTemplate-cc7f8b69.js","assets/MaterialKey-0093a242.js","assets/alignmentUtils-ae955d28.js","assets/utils-317368cb.js","assets/parser-498c8be0.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/Color-fb64d77d.js","assets/heatmapTextureUtils-2627384f.js","assets/earcut-58237617.js","assets/vec2-528adfe4.js","assets/featureConversionUtils-03a03f40.js","assets/jsonUtils-229211af.js","assets/Polyline-ff2d7c6b.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/TileContainer-21007653.js","assets/LayerView2D-4c855e4b.js","assets/Collection-910b6f71.js","assets/SimpleObservable-23231131.js","assets/collectionUtils-803d9ba8.js","assets/geometry-b7901087.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/TileStore-00ac650f.js","assets/Queue-b7d3cd48.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/enumeration-3a03bd31.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Clonable-545593ce.js","assets/TileStrategy-a90cd1af.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/Identifiable-bfe1ff30.js","assets/Promise-376ab9f6.js","assets/RefreshableLayerView-7c1c2c75.js","assets/TileLayerView-80cc70bb.js","assets/clickToleranceUtils-a273d161.js","assets/drapedUtils-f6534f49.js","assets/unitUtils-45d1147c.js","assets/preload-helper-3bce6601.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/capabilities-302cf20d.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])),Yv=()=>dn().then(()=>G(()=>import("./FeatureLayerView2D-7b892ba8.js"),["assets/FeatureLayerView2D-7b892ba8.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/reactiveUtils-4dabbb80.js","assets/utils-317368cb.js","assets/mat3f32-d3d088e8.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/enums-4ca4641f.js","assets/MaterialKey-0093a242.js","assets/alignmentUtils-ae955d28.js","assets/Utils-69cc114d.js","assets/number-954e4ab6.js","assets/enums-2658a65c.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/TimeExtent-23e282b9.js","assets/Query-b96bcde0.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/MemCache-18a255ed.js","assets/deprecate-035b199e.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/FeatureSet-d32b0eb8.js","assets/LayerView2D-4c855e4b.js","assets/schemaUtils-9c08f5e8.js","assets/LayerFloorInfo-54b916a2.js","assets/visualVariablesUtils-ecd70012.js","assets/createSymbolSchema-36503ad8.js","assets/cimAnalyzer-38842966.js","assets/BidiEngine-836b7ef6.js","assets/mat2d-2bbb5feb.js","assets/vec2-528adfe4.js","assets/vec2f32-461e65a9.js","assets/Rect-ea14f53a.js","assets/callExpressionWithFeature-55effb7b.js","assets/quantizationUtils-4dd81f85.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-9ad35d39.js","assets/ExpandedCIM-b7ed8ce5.js","assets/rendererUtils-0bcb63a1.js","assets/capabilities-302cf20d.js","assets/util-4239daf3.js","assets/TileStore-00ac650f.js","assets/Queue-b7d3cd48.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/FeatureLayerView-e9178bab.js","assets/floorFilterUtils-080a7cd2.js","assets/popupUtils-af06d391.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/RefreshableLayerView-7c1c2c75.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/projection-290b739f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/RelationshipQuery-0dda77ad.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/ItemCache-fd3aceaf.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/FramebufferObject-a3b9c52c.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/dehydratedFeatures-0557137d.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])),mV={"base-dynamic":()=>dn().then(()=>G(()=>import("./BaseDynamicLayerView2D-9dca0741.js"),["assets/BaseDynamicLayerView2D-9dca0741.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/BitmapContainer-5fb5f7d8.js","assets/WGLContainer-8a3733a0.js","assets/mat3f32-d3d088e8.js","assets/WGLBrushVTLSymbol-d778c554.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/Evented-a45c8b0f.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/enums-2658a65c.js","assets/enums-4ca4641f.js","assets/number-954e4ab6.js","assets/FramebufferObject-a3b9c52c.js","assets/StyleDefinition-ff072275.js","assets/vec2f32-461e65a9.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/pixelUtils-d9cd2e49.js","assets/Utils-69cc114d.js","assets/ShaderCompiler-77d0dcb6.js","assets/ProgramTemplate-cc7f8b69.js","assets/MaterialKey-0093a242.js","assets/alignmentUtils-ae955d28.js","assets/utils-317368cb.js","assets/parser-498c8be0.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/Color-fb64d77d.js","assets/heatmapTextureUtils-2627384f.js","assets/reactiveUtils-4dabbb80.js","assets/earcut-58237617.js","assets/vec2-528adfe4.js","assets/featureConversionUtils-03a03f40.js","assets/jsonUtils-229211af.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView2D-4c855e4b.js","assets/Collection-910b6f71.js","assets/SimpleObservable-23231131.js","assets/collectionUtils-803d9ba8.js","assets/geometry-b7901087.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/ExportStrategy-913accc5.js","assets/aaBoundingRect-193543b5.js","assets/TileInfo-b0eb8c90.js","assets/unitUtils-45d1147c.js","assets/Bitmap-479ee434.js","assets/TileStore-00ac650f.js","assets/Queue-b7d3cd48.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/enumeration-3a03bd31.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Clonable-545593ce.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/Identifiable-bfe1ff30.js","assets/Promise-376ab9f6.js","assets/RefreshableLayerView-7c1c2c75.js","assets/preload-helper-3bce6601.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/zscale-89472cba.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/capabilities-302cf20d.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])),"base-tile":Zv,"bing-maps":Zv,csv:Yv,"geo-rss":()=>dn().then(()=>G(()=>import("./GeoRSSLayerView2D-c8195d91.js"),["assets/GeoRSSLayerView2D-c8195d91.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/geometry-b7901087.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/reactiveUtils-4dabbb80.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/LegendOptions-010d0873.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/Graphic-f0e54e86.js","assets/jsonUtils-229211af.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/MemCache-18a255ed.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/LayerView2D-4c855e4b.js","assets/utils-317368cb.js","assets/mat3f32-d3d088e8.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/enums-4ca4641f.js","assets/MaterialKey-0093a242.js","assets/alignmentUtils-ae955d28.js","assets/Utils-69cc114d.js","assets/number-954e4ab6.js","assets/enums-2658a65c.js","assets/GraphicContainer-d62248af.js","assets/BaseGraphicContainer-78fa9e25.js","assets/cimAnalyzer-38842966.js","assets/BidiEngine-836b7ef6.js","assets/mat2d-2bbb5feb.js","assets/vec2-528adfe4.js","assets/vec2f32-461e65a9.js","assets/Rect-ea14f53a.js","assets/callExpressionWithFeature-55effb7b.js","assets/quantizationUtils-4dd81f85.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-9ad35d39.js","assets/HandleOwner-9b396af1.js","assets/projectionSupport-aa5eaa0d.js","assets/projection-290b739f.js","assets/assets-8d3e737a.js","assets/zscale-89472cba.js","assets/json-48e3ea08.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/FramebufferObject-a3b9c52c.js","assets/FeatureContainer-934cc4cc.js","assets/Queue-b7d3cd48.js","assets/visualVariablesUtils-0d4b5279.js","assets/visualVariablesUtils-ecd70012.js","assets/TileContainer-21007653.js","assets/WGLContainer-8a3733a0.js","assets/WGLBrushVTLSymbol-d778c554.js","assets/StyleDefinition-ff072275.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/pixelUtils-d9cd2e49.js","assets/ShaderCompiler-77d0dcb6.js","assets/ProgramTemplate-cc7f8b69.js","assets/heatmapTextureUtils-2627384f.js","assets/earcut-58237617.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/capabilities-302cf20d.js","assets/Matcher-f2620e9f.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/tileUtils-55e656c2.js","assets/TileClipper-4637f47d.js","assets/Geometry-daada628.js","assets/ExpandedCIM-b7ed8ce5.js","assets/devEnvironmentUtils-5002a058.js","assets/schemaUtils-9c08f5e8.js","assets/LayerFloorInfo-54b916a2.js","assets/createSymbolSchema-36503ad8.js","assets/rendererUtils-0bcb63a1.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/util-4239daf3.js","assets/ComputedAttributeStorage-2b4316ba.js","assets/FeatureSetReader-7e79a15e.js","assets/centroid-5c988df3.js","assets/FieldsIndex-f104cc5f.js","assets/normalizeUtils-27e29a72.js","assets/GraphicsView-d3b9d029.js","assets/vec3f32-c9aa289f.js","assets/LayerView-bd9a2316.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/RelationshipQuery-0dda77ad.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/ItemCache-fd3aceaf.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/dehydratedFeatures-0557137d.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])),feature:Yv,geojson:Yv,graphics:()=>dn().then(()=>G(()=>import("./GraphicsLayerView2D-6725a5f3.js"),["assets/GraphicsLayerView2D-6725a5f3.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/LayerView2D-4c855e4b.js","assets/reactiveUtils-4dabbb80.js","assets/utils-317368cb.js","assets/mat3f32-d3d088e8.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/enums-4ca4641f.js","assets/MaterialKey-0093a242.js","assets/alignmentUtils-ae955d28.js","assets/Utils-69cc114d.js","assets/number-954e4ab6.js","assets/enums-2658a65c.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/GraphicContainer-d62248af.js","assets/BaseGraphicContainer-78fa9e25.js","assets/cimAnalyzer-38842966.js","assets/BidiEngine-836b7ef6.js","assets/mat2d-2bbb5feb.js","assets/vec2-528adfe4.js","assets/vec2f32-461e65a9.js","assets/Rect-ea14f53a.js","assets/callExpressionWithFeature-55effb7b.js","assets/quantizationUtils-4dd81f85.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-9ad35d39.js","assets/HandleOwner-9b396af1.js","assets/projectionSupport-aa5eaa0d.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/assets-8d3e737a.js","assets/zscale-89472cba.js","assets/json-48e3ea08.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/jsonUtils-0ff4ff96.js","assets/FramebufferObject-a3b9c52c.js","assets/FeatureContainer-934cc4cc.js","assets/Queue-b7d3cd48.js","assets/visualVariablesUtils-0d4b5279.js","assets/visualVariablesUtils-ecd70012.js","assets/TileContainer-21007653.js","assets/WGLContainer-8a3733a0.js","assets/WGLBrushVTLSymbol-d778c554.js","assets/StyleDefinition-ff072275.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/pixelUtils-d9cd2e49.js","assets/ShaderCompiler-77d0dcb6.js","assets/ProgramTemplate-cc7f8b69.js","assets/heatmapTextureUtils-2627384f.js","assets/earcut-58237617.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/lengthUtils-fa751420.js","assets/capabilities-302cf20d.js","assets/Matcher-f2620e9f.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/tileUtils-55e656c2.js","assets/TileClipper-4637f47d.js","assets/Geometry-daada628.js","assets/LRUCache-64ec42ee.js","assets/MemCache-18a255ed.js","assets/ExpandedCIM-b7ed8ce5.js","assets/devEnvironmentUtils-5002a058.js","assets/styleUtils-22b14a8b.js","assets/schemaUtils-9c08f5e8.js","assets/LayerFloorInfo-54b916a2.js","assets/diffUtils-68b89c71.js","assets/createSymbolSchema-36503ad8.js","assets/rendererUtils-0bcb63a1.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/deprecate-035b199e.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/util-4239daf3.js","assets/ComputedAttributeStorage-2b4316ba.js","assets/FeatureSetReader-7e79a15e.js","assets/centroid-5c988df3.js","assets/FieldsIndex-f104cc5f.js","assets/normalizeUtils-27e29a72.js","assets/GraphicsView-d3b9d029.js","assets/vec3f32-c9aa289f.js","assets/LayerView-bd9a2316.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/RelationshipQuery-0dda77ad.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/ItemCache-fd3aceaf.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/dehydratedFeatures-0557137d.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])),group:()=>dn().then(()=>G(()=>import("./GroupLayerView2D-6ed7015b.js"),["assets/GroupLayerView2D-6ed7015b.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/GroupContainer-9db6cc15.js","assets/WGLContainer-8a3733a0.js","assets/mat3f32-d3d088e8.js","assets/WGLBrushVTLSymbol-d778c554.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/Evented-a45c8b0f.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/enums-2658a65c.js","assets/enums-4ca4641f.js","assets/number-954e4ab6.js","assets/FramebufferObject-a3b9c52c.js","assets/StyleDefinition-ff072275.js","assets/vec2f32-461e65a9.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/pixelUtils-d9cd2e49.js","assets/Utils-69cc114d.js","assets/ShaderCompiler-77d0dcb6.js","assets/ProgramTemplate-cc7f8b69.js","assets/MaterialKey-0093a242.js","assets/alignmentUtils-ae955d28.js","assets/utils-317368cb.js","assets/parser-498c8be0.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/Color-fb64d77d.js","assets/heatmapTextureUtils-2627384f.js","assets/reactiveUtils-4dabbb80.js","assets/earcut-58237617.js","assets/vec2-528adfe4.js","assets/featureConversionUtils-03a03f40.js","assets/jsonUtils-229211af.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView2D-4c855e4b.js","assets/Collection-910b6f71.js","assets/SimpleObservable-23231131.js","assets/collectionUtils-803d9ba8.js","assets/geometry-b7901087.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/GroupLayerView-6f5d18e8.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/Identifiable-bfe1ff30.js","assets/Promise-376ab9f6.js","assets/preload-helper-3bce6601.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])),imagery:()=>dn().then(()=>G(()=>import("./ImageryLayerView2D-98cb2677.js"),["assets/ImageryLayerView2D-98cb2677.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/reactiveUtils-4dabbb80.js","assets/GraphicsCollection-c37a9ffd.js","assets/HandleOwner-9b396af1.js","assets/RasterVFDisplayObject-0676fcf6.js","assets/FramebufferObject-a3b9c52c.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/VertexElementDescriptor-2925c6af.js","assets/dataUtils-a534a9c7.js","assets/pixelUtils-d9cd2e49.js","assets/WGLContainer-8a3733a0.js","assets/mat3f32-d3d088e8.js","assets/WGLBrushVTLSymbol-d778c554.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/enums-2658a65c.js","assets/enums-4ca4641f.js","assets/number-954e4ab6.js","assets/StyleDefinition-ff072275.js","assets/vec2f32-461e65a9.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/Utils-69cc114d.js","assets/ShaderCompiler-77d0dcb6.js","assets/ProgramTemplate-cc7f8b69.js","assets/MaterialKey-0093a242.js","assets/alignmentUtils-ae955d28.js","assets/utils-317368cb.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/heatmapTextureUtils-2627384f.js","assets/earcut-58237617.js","assets/vec2-528adfe4.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView2D-4c855e4b.js","assets/BaseGraphicContainer-78fa9e25.js","assets/cimAnalyzer-38842966.js","assets/BidiEngine-836b7ef6.js","assets/mat2d-2bbb5feb.js","assets/Rect-ea14f53a.js","assets/callExpressionWithFeature-55effb7b.js","assets/quantizationUtils-4dd81f85.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-9ad35d39.js","assets/projectionSupport-aa5eaa0d.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/assets-8d3e737a.js","assets/zscale-89472cba.js","assets/json-48e3ea08.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/jsonUtils-0ff4ff96.js","assets/FeatureContainer-934cc4cc.js","assets/Queue-b7d3cd48.js","assets/visualVariablesUtils-0d4b5279.js","assets/visualVariablesUtils-ecd70012.js","assets/TileContainer-21007653.js","assets/lengthUtils-fa751420.js","assets/capabilities-302cf20d.js","assets/Matcher-f2620e9f.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/tileUtils-55e656c2.js","assets/TileClipper-4637f47d.js","assets/Geometry-daada628.js","assets/LRUCache-64ec42ee.js","assets/MemCache-18a255ed.js","assets/ExpandedCIM-b7ed8ce5.js","assets/devEnvironmentUtils-5002a058.js","assets/styleUtils-22b14a8b.js","assets/schemaUtils-9c08f5e8.js","assets/LayerFloorInfo-54b916a2.js","assets/diffUtils-68b89c71.js","assets/createSymbolSchema-36503ad8.js","assets/rendererUtils-0bcb63a1.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/deprecate-035b199e.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/util-4239daf3.js","assets/ComputedAttributeStorage-2b4316ba.js","assets/FeatureSetReader-7e79a15e.js","assets/centroid-5c988df3.js","assets/FieldsIndex-f104cc5f.js","assets/normalizeUtils-27e29a72.js","assets/GraphicsView-d3b9d029.js","assets/vec3f32-c9aa289f.js","assets/HighlightGraphicContainer-e6694318.js","assets/BitmapContainer-5fb5f7d8.js","assets/Bitmap-479ee434.js","assets/ExportStrategy-913accc5.js","assets/TileInfo-b0eb8c90.js","assets/rasterProjectionHelper-a7452876.js","assets/ImageryLayerView-31e9d56f.js","assets/popupUtils-af06d391.js","assets/LayerView-bd9a2316.js","assets/RefreshableLayerView-7c1c2c75.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/RelationshipQuery-0dda77ad.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/ItemCache-fd3aceaf.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/dehydratedFeatures-0557137d.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])),"imagery-tile":()=>dn().then(()=>G(()=>import("./ImageryTileLayerView2D-e2ca2720.js"),["assets/ImageryTileLayerView2D-e2ca2720.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/reactiveUtils-4dabbb80.js","assets/multidimensionalUtils-98b0907f.js","assets/RasterVFDisplayObject-0676fcf6.js","assets/HandleOwner-9b396af1.js","assets/FramebufferObject-a3b9c52c.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/VertexElementDescriptor-2925c6af.js","assets/dataUtils-a534a9c7.js","assets/pixelUtils-d9cd2e49.js","assets/WGLContainer-8a3733a0.js","assets/mat3f32-d3d088e8.js","assets/WGLBrushVTLSymbol-d778c554.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/enums-2658a65c.js","assets/enums-4ca4641f.js","assets/number-954e4ab6.js","assets/StyleDefinition-ff072275.js","assets/vec2f32-461e65a9.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/Utils-69cc114d.js","assets/ShaderCompiler-77d0dcb6.js","assets/ProgramTemplate-cc7f8b69.js","assets/MaterialKey-0093a242.js","assets/alignmentUtils-ae955d28.js","assets/utils-317368cb.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/heatmapTextureUtils-2627384f.js","assets/earcut-58237617.js","assets/vec2-528adfe4.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView2D-4c855e4b.js","assets/TileContainer-21007653.js","assets/TileInfo-b0eb8c90.js","assets/unitUtils-45d1147c.js","assets/RawBlockCache-f270ede9.js","assets/rasterProjectionHelper-a7452876.js","assets/projection-290b739f.js","assets/assets-8d3e737a.js","assets/zscale-89472cba.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/Queue-b7d3cd48.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/capabilities-302cf20d.js","assets/util-4239daf3.js","assets/ImageryTileLayerView-f97d6c38.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/lengthUtils-fa751420.js","assets/popupUtils-af06d391.js","assets/LayerView-bd9a2316.js","assets/RefreshableLayerView-7c1c2c75.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])),kml:()=>dn().then(()=>G(()=>import("./KMLLayerView2D-b409491f.js"),["assets/KMLLayerView2D-b409491f.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/reactiveUtils-4dabbb80.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/projection-290b739f.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/unitUtils-45d1147c.js","assets/jsonMap-7b8332c9.js","assets/mat4-44a0988f.js","assets/Polyline-ff2d7c6b.js","assets/assets-8d3e737a.js","assets/aaBoundingRect-193543b5.js","assets/zscale-89472cba.js","assets/kmlUtils-83fc7c0c.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/geometry-b7901087.js","assets/typeUtils-35750739.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/aaBoundingBox-657a9b82.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/LegendOptions-010d0873.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/Graphic-f0e54e86.js","assets/jsonUtils-229211af.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/MemCache-18a255ed.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/normalizeUtils-27e29a72.js","assets/GraphicsCollection-c37a9ffd.js","assets/HandleOwner-9b396af1.js","assets/Bitmap-479ee434.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/BitmapContainer-5fb5f7d8.js","assets/WGLContainer-8a3733a0.js","assets/WGLBrushVTLSymbol-d778c554.js","assets/enums-2658a65c.js","assets/enums-4ca4641f.js","assets/number-954e4ab6.js","assets/FramebufferObject-a3b9c52c.js","assets/StyleDefinition-ff072275.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/pixelUtils-d9cd2e49.js","assets/Utils-69cc114d.js","assets/ShaderCompiler-77d0dcb6.js","assets/ProgramTemplate-cc7f8b69.js","assets/MaterialKey-0093a242.js","assets/alignmentUtils-ae955d28.js","assets/utils-317368cb.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/heatmapTextureUtils-2627384f.js","assets/earcut-58237617.js","assets/vec2-528adfe4.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView2D-4c855e4b.js","assets/GraphicContainer-d62248af.js","assets/BaseGraphicContainer-78fa9e25.js","assets/cimAnalyzer-38842966.js","assets/BidiEngine-836b7ef6.js","assets/mat2d-2bbb5feb.js","assets/Rect-ea14f53a.js","assets/callExpressionWithFeature-55effb7b.js","assets/quantizationUtils-4dd81f85.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-9ad35d39.js","assets/projectionSupport-aa5eaa0d.js","assets/json-48e3ea08.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/FeatureContainer-934cc4cc.js","assets/Queue-b7d3cd48.js","assets/visualVariablesUtils-0d4b5279.js","assets/visualVariablesUtils-ecd70012.js","assets/TileContainer-21007653.js","assets/capabilities-302cf20d.js","assets/Matcher-f2620e9f.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/tileUtils-55e656c2.js","assets/TileClipper-4637f47d.js","assets/Geometry-daada628.js","assets/ExpandedCIM-b7ed8ce5.js","assets/devEnvironmentUtils-5002a058.js","assets/schemaUtils-9c08f5e8.js","assets/LayerFloorInfo-54b916a2.js","assets/createSymbolSchema-36503ad8.js","assets/rendererUtils-0bcb63a1.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/util-4239daf3.js","assets/ComputedAttributeStorage-2b4316ba.js","assets/FeatureSetReader-7e79a15e.js","assets/centroid-5c988df3.js","assets/FieldsIndex-f104cc5f.js","assets/GraphicsView-d3b9d029.js","assets/vec3f32-c9aa289f.js","assets/LayerView-bd9a2316.js","assets/rasterProjectionHelper-a7452876.js","assets/MaterialPrograms-b885dd99.js","assets/programUtils-f035fe8a.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/RelationshipQuery-0dda77ad.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/ItemCache-fd3aceaf.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/dehydratedFeatures-0557137d.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])),"map-image":()=>dn().then(()=>G(()=>import("./MapImageLayerView2D-f148d000.js"),["assets/MapImageLayerView2D-f148d000.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/reactiveUtils-4dabbb80.js","assets/BitmapContainer-5fb5f7d8.js","assets/WGLContainer-8a3733a0.js","assets/mat3f32-d3d088e8.js","assets/WGLBrushVTLSymbol-d778c554.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/enums-2658a65c.js","assets/enums-4ca4641f.js","assets/number-954e4ab6.js","assets/FramebufferObject-a3b9c52c.js","assets/StyleDefinition-ff072275.js","assets/vec2f32-461e65a9.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/pixelUtils-d9cd2e49.js","assets/Utils-69cc114d.js","assets/ShaderCompiler-77d0dcb6.js","assets/ProgramTemplate-cc7f8b69.js","assets/MaterialKey-0093a242.js","assets/alignmentUtils-ae955d28.js","assets/utils-317368cb.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/heatmapTextureUtils-2627384f.js","assets/earcut-58237617.js","assets/vec2-528adfe4.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView2D-4c855e4b.js","assets/BaseGraphicContainer-78fa9e25.js","assets/cimAnalyzer-38842966.js","assets/BidiEngine-836b7ef6.js","assets/mat2d-2bbb5feb.js","assets/Rect-ea14f53a.js","assets/callExpressionWithFeature-55effb7b.js","assets/quantizationUtils-4dd81f85.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-9ad35d39.js","assets/HandleOwner-9b396af1.js","assets/projectionSupport-aa5eaa0d.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/assets-8d3e737a.js","assets/zscale-89472cba.js","assets/json-48e3ea08.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/jsonUtils-0ff4ff96.js","assets/FeatureContainer-934cc4cc.js","assets/Queue-b7d3cd48.js","assets/visualVariablesUtils-0d4b5279.js","assets/visualVariablesUtils-ecd70012.js","assets/TileContainer-21007653.js","assets/lengthUtils-fa751420.js","assets/capabilities-302cf20d.js","assets/Matcher-f2620e9f.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/tileUtils-55e656c2.js","assets/TileClipper-4637f47d.js","assets/Geometry-daada628.js","assets/LRUCache-64ec42ee.js","assets/MemCache-18a255ed.js","assets/ExpandedCIM-b7ed8ce5.js","assets/devEnvironmentUtils-5002a058.js","assets/styleUtils-22b14a8b.js","assets/schemaUtils-9c08f5e8.js","assets/LayerFloorInfo-54b916a2.js","assets/diffUtils-68b89c71.js","assets/createSymbolSchema-36503ad8.js","assets/rendererUtils-0bcb63a1.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/deprecate-035b199e.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/util-4239daf3.js","assets/ComputedAttributeStorage-2b4316ba.js","assets/FeatureSetReader-7e79a15e.js","assets/centroid-5c988df3.js","assets/FieldsIndex-f104cc5f.js","assets/normalizeUtils-27e29a72.js","assets/GraphicsView-d3b9d029.js","assets/vec3f32-c9aa289f.js","assets/HighlightGraphicContainer-e6694318.js","assets/ExportStrategy-913accc5.js","assets/TileInfo-b0eb8c90.js","assets/Bitmap-479ee434.js","assets/LayerView-bd9a2316.js","assets/MapImageLayerView-7b24456f.js","assets/scaleUtils-93ad8d0c.js","assets/ExportImageParameters-4b588db2.js","assets/floorFilterUtils-080a7cd2.js","assets/sublayerUtils-96c8a85b.js","assets/clickToleranceUtils-a273d161.js","assets/GraphicsCollection-c37a9ffd.js","assets/popupUtils-af06d391.js","assets/RefreshableLayerView-7c1c2c75.js","assets/drapedUtils-f6534f49.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/RelationshipQuery-0dda77ad.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/ItemCache-fd3aceaf.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/dehydratedFeatures-0557137d.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])),"map-notes":()=>dn().then(()=>G(()=>import("./MapNotesLayerView2D-8f903290.js"),["assets/MapNotesLayerView2D-8f903290.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/reactiveUtils-4dabbb80.js","assets/utils-317368cb.js","assets/mat3f32-d3d088e8.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/enums-4ca4641f.js","assets/MaterialKey-0093a242.js","assets/alignmentUtils-ae955d28.js","assets/Utils-69cc114d.js","assets/number-954e4ab6.js","assets/enums-2658a65c.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/GroupContainer-9db6cc15.js","assets/WGLContainer-8a3733a0.js","assets/WGLBrushVTLSymbol-d778c554.js","assets/FramebufferObject-a3b9c52c.js","assets/StyleDefinition-ff072275.js","assets/vec2f32-461e65a9.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/pixelUtils-d9cd2e49.js","assets/ShaderCompiler-77d0dcb6.js","assets/ProgramTemplate-cc7f8b69.js","assets/heatmapTextureUtils-2627384f.js","assets/earcut-58237617.js","assets/vec2-528adfe4.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView2D-4c855e4b.js","assets/GraphicContainer-d62248af.js","assets/BaseGraphicContainer-78fa9e25.js","assets/cimAnalyzer-38842966.js","assets/BidiEngine-836b7ef6.js","assets/mat2d-2bbb5feb.js","assets/Rect-ea14f53a.js","assets/callExpressionWithFeature-55effb7b.js","assets/quantizationUtils-4dd81f85.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-9ad35d39.js","assets/HandleOwner-9b396af1.js","assets/projectionSupport-aa5eaa0d.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/assets-8d3e737a.js","assets/zscale-89472cba.js","assets/json-48e3ea08.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/jsonUtils-0ff4ff96.js","assets/FeatureContainer-934cc4cc.js","assets/Queue-b7d3cd48.js","assets/visualVariablesUtils-0d4b5279.js","assets/visualVariablesUtils-ecd70012.js","assets/TileContainer-21007653.js","assets/lengthUtils-fa751420.js","assets/capabilities-302cf20d.js","assets/Matcher-f2620e9f.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/tileUtils-55e656c2.js","assets/TileClipper-4637f47d.js","assets/Geometry-daada628.js","assets/LRUCache-64ec42ee.js","assets/MemCache-18a255ed.js","assets/ExpandedCIM-b7ed8ce5.js","assets/devEnvironmentUtils-5002a058.js","assets/styleUtils-22b14a8b.js","assets/schemaUtils-9c08f5e8.js","assets/LayerFloorInfo-54b916a2.js","assets/diffUtils-68b89c71.js","assets/createSymbolSchema-36503ad8.js","assets/rendererUtils-0bcb63a1.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/deprecate-035b199e.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/util-4239daf3.js","assets/ComputedAttributeStorage-2b4316ba.js","assets/FeatureSetReader-7e79a15e.js","assets/centroid-5c988df3.js","assets/FieldsIndex-f104cc5f.js","assets/normalizeUtils-27e29a72.js","assets/GraphicsView-d3b9d029.js","assets/vec3f32-c9aa289f.js","assets/LayerView-bd9a2316.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/RelationshipQuery-0dda77ad.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/ItemCache-fd3aceaf.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/dehydratedFeatures-0557137d.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])),media:()=>dn().then(()=>G(()=>import("./MediaLayerView2D-d3c935bf.js"),["assets/MediaLayerView2D-d3c935bf.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/reactiveUtils-4dabbb80.js","assets/aaBoundingRect-193543b5.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/TileStrategy-a90cd1af.js","assets/vec2-528adfe4.js","assets/TileStore-00ac650f.js","assets/Queue-b7d3cd48.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/enumeration-3a03bd31.js","assets/jsonUtils-229211af.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Clonable-545593ce.js","assets/mat3f64-c6305894.js","assets/vec2f64-30dc1443.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/screenUtils-410d12c0.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/vec3f32-c9aa289f.js","assets/normalizeUtils-27e29a72.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/WGLContainer-8a3733a0.js","assets/WGLBrushVTLSymbol-d778c554.js","assets/enums-2658a65c.js","assets/enums-4ca4641f.js","assets/number-954e4ab6.js","assets/StyleDefinition-ff072275.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/pixelUtils-d9cd2e49.js","assets/Utils-69cc114d.js","assets/ShaderCompiler-77d0dcb6.js","assets/ProgramTemplate-cc7f8b69.js","assets/MaterialKey-0093a242.js","assets/alignmentUtils-ae955d28.js","assets/utils-317368cb.js","assets/parser-498c8be0.js","assets/colorUtils-639f4d25.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/Color-fb64d77d.js","assets/heatmapTextureUtils-2627384f.js","assets/earcut-58237617.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView2D-4c855e4b.js","assets/collectionUtils-803d9ba8.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/Identifiable-bfe1ff30.js","assets/Promise-376ab9f6.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/capabilities-302cf20d.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])),"ogc-feature":()=>dn().then(()=>G(()=>import("./OGCFeatureLayerView2D-13336e15.js"),["assets/OGCFeatureLayerView2D-13336e15.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/FeatureLayerView2D-7b892ba8.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/reactiveUtils-4dabbb80.js","assets/utils-317368cb.js","assets/mat3f32-d3d088e8.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/enums-4ca4641f.js","assets/MaterialKey-0093a242.js","assets/alignmentUtils-ae955d28.js","assets/Utils-69cc114d.js","assets/number-954e4ab6.js","assets/enums-2658a65c.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/TimeExtent-23e282b9.js","assets/Query-b96bcde0.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/MemCache-18a255ed.js","assets/deprecate-035b199e.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/FeatureSet-d32b0eb8.js","assets/LayerView2D-4c855e4b.js","assets/schemaUtils-9c08f5e8.js","assets/LayerFloorInfo-54b916a2.js","assets/visualVariablesUtils-ecd70012.js","assets/createSymbolSchema-36503ad8.js","assets/cimAnalyzer-38842966.js","assets/BidiEngine-836b7ef6.js","assets/mat2d-2bbb5feb.js","assets/vec2-528adfe4.js","assets/vec2f32-461e65a9.js","assets/Rect-ea14f53a.js","assets/callExpressionWithFeature-55effb7b.js","assets/quantizationUtils-4dd81f85.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-9ad35d39.js","assets/ExpandedCIM-b7ed8ce5.js","assets/rendererUtils-0bcb63a1.js","assets/capabilities-302cf20d.js","assets/util-4239daf3.js","assets/TileStore-00ac650f.js","assets/Queue-b7d3cd48.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/FeatureLayerView-e9178bab.js","assets/floorFilterUtils-080a7cd2.js","assets/popupUtils-af06d391.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/RefreshableLayerView-7c1c2c75.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/projection-290b739f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/RelationshipQuery-0dda77ad.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/ItemCache-fd3aceaf.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/FramebufferObject-a3b9c52c.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/dehydratedFeatures-0557137d.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js","assets/OGCFeatureLayerView-409b7077.js"])),"open-street-map":Zv,"oriented-imagery":Yv,route:()=>dn().then(()=>G(()=>import("./RouteLayerView2D-3b58d2e8.js"),["assets/RouteLayerView2D-3b58d2e8.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/Stop-8921a099.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/LayerView2D-4c855e4b.js","assets/utils-317368cb.js","assets/mat3f32-d3d088e8.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/enums-4ca4641f.js","assets/MaterialKey-0093a242.js","assets/alignmentUtils-ae955d28.js","assets/Utils-69cc114d.js","assets/number-954e4ab6.js","assets/enums-2658a65c.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/GraphicContainer-d62248af.js","assets/BaseGraphicContainer-78fa9e25.js","assets/cimAnalyzer-38842966.js","assets/BidiEngine-836b7ef6.js","assets/mat2d-2bbb5feb.js","assets/vec2-528adfe4.js","assets/vec2f32-461e65a9.js","assets/Rect-ea14f53a.js","assets/callExpressionWithFeature-55effb7b.js","assets/quantizationUtils-4dd81f85.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-9ad35d39.js","assets/HandleOwner-9b396af1.js","assets/projectionSupport-aa5eaa0d.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/assets-8d3e737a.js","assets/zscale-89472cba.js","assets/json-48e3ea08.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/jsonUtils-0ff4ff96.js","assets/FramebufferObject-a3b9c52c.js","assets/FeatureContainer-934cc4cc.js","assets/Queue-b7d3cd48.js","assets/visualVariablesUtils-0d4b5279.js","assets/visualVariablesUtils-ecd70012.js","assets/TileContainer-21007653.js","assets/WGLContainer-8a3733a0.js","assets/WGLBrushVTLSymbol-d778c554.js","assets/StyleDefinition-ff072275.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/pixelUtils-d9cd2e49.js","assets/ShaderCompiler-77d0dcb6.js","assets/ProgramTemplate-cc7f8b69.js","assets/heatmapTextureUtils-2627384f.js","assets/earcut-58237617.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/lengthUtils-fa751420.js","assets/capabilities-302cf20d.js","assets/Matcher-f2620e9f.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/tileUtils-55e656c2.js","assets/TileClipper-4637f47d.js","assets/Geometry-daada628.js","assets/LRUCache-64ec42ee.js","assets/MemCache-18a255ed.js","assets/ExpandedCIM-b7ed8ce5.js","assets/devEnvironmentUtils-5002a058.js","assets/styleUtils-22b14a8b.js","assets/schemaUtils-9c08f5e8.js","assets/LayerFloorInfo-54b916a2.js","assets/diffUtils-68b89c71.js","assets/createSymbolSchema-36503ad8.js","assets/rendererUtils-0bcb63a1.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/deprecate-035b199e.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/util-4239daf3.js","assets/ComputedAttributeStorage-2b4316ba.js","assets/FeatureSetReader-7e79a15e.js","assets/centroid-5c988df3.js","assets/FieldsIndex-f104cc5f.js","assets/normalizeUtils-27e29a72.js","assets/GraphicsView-d3b9d029.js","assets/vec3f32-c9aa289f.js","assets/LayerView-bd9a2316.js","assets/Cyclical-151bcc41.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/RelationshipQuery-0dda77ad.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/ItemCache-fd3aceaf.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/dehydratedFeatures-0557137d.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])),stream:()=>dn().then(()=>G(()=>import("./StreamLayerView2D-989a1fd1.js"),["assets/StreamLayerView2D-989a1fd1.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/reactiveUtils-4dabbb80.js","assets/FeatureSet-d32b0eb8.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/FeatureLayerView2D-7b892ba8.js","assets/utils-317368cb.js","assets/mat3f32-d3d088e8.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/enums-4ca4641f.js","assets/MaterialKey-0093a242.js","assets/alignmentUtils-ae955d28.js","assets/Utils-69cc114d.js","assets/number-954e4ab6.js","assets/enums-2658a65c.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/TimeExtent-23e282b9.js","assets/Query-b96bcde0.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/MemCache-18a255ed.js","assets/deprecate-035b199e.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/LayerView2D-4c855e4b.js","assets/schemaUtils-9c08f5e8.js","assets/LayerFloorInfo-54b916a2.js","assets/visualVariablesUtils-ecd70012.js","assets/createSymbolSchema-36503ad8.js","assets/cimAnalyzer-38842966.js","assets/BidiEngine-836b7ef6.js","assets/mat2d-2bbb5feb.js","assets/vec2-528adfe4.js","assets/vec2f32-461e65a9.js","assets/Rect-ea14f53a.js","assets/callExpressionWithFeature-55effb7b.js","assets/quantizationUtils-4dd81f85.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-9ad35d39.js","assets/ExpandedCIM-b7ed8ce5.js","assets/rendererUtils-0bcb63a1.js","assets/capabilities-302cf20d.js","assets/util-4239daf3.js","assets/TileStore-00ac650f.js","assets/Queue-b7d3cd48.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/FeatureLayerView-e9178bab.js","assets/floorFilterUtils-080a7cd2.js","assets/popupUtils-af06d391.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/RefreshableLayerView-7c1c2c75.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/projection-290b739f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/RelationshipQuery-0dda77ad.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/ItemCache-fd3aceaf.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/FramebufferObject-a3b9c52c.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/dehydratedFeatures-0557137d.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])),"subtype-group":()=>dn().then(()=>G(()=>import("./SubtypeGroupLayerView2D-472a1082.js"),["assets/SubtypeGroupLayerView2D-472a1082.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/reactiveUtils-4dabbb80.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/parser-498c8be0.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/TimeExtent-23e282b9.js","assets/Query-b96bcde0.js","assets/enumeration-3a03bd31.js","assets/jsonUtils-229211af.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Clonable-545593ce.js","assets/PopupTemplate-40f3c9aa.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/UniqueValueRenderer-08f8851c.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec4-790471c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/LegendOptions-010d0873.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/Graphic-f0e54e86.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/MemCache-18a255ed.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/FeatureLayerView2D-7b892ba8.js","assets/utils-317368cb.js","assets/mat3f32-d3d088e8.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/enums-4ca4641f.js","assets/MaterialKey-0093a242.js","assets/alignmentUtils-ae955d28.js","assets/Utils-69cc114d.js","assets/number-954e4ab6.js","assets/enums-2658a65c.js","assets/FeatureSet-d32b0eb8.js","assets/LayerView2D-4c855e4b.js","assets/schemaUtils-9c08f5e8.js","assets/LayerFloorInfo-54b916a2.js","assets/visualVariablesUtils-ecd70012.js","assets/createSymbolSchema-36503ad8.js","assets/cimAnalyzer-38842966.js","assets/BidiEngine-836b7ef6.js","assets/mat2d-2bbb5feb.js","assets/vec2-528adfe4.js","assets/vec2f32-461e65a9.js","assets/Rect-ea14f53a.js","assets/callExpressionWithFeature-55effb7b.js","assets/quantizationUtils-4dd81f85.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-9ad35d39.js","assets/ExpandedCIM-b7ed8ce5.js","assets/rendererUtils-0bcb63a1.js","assets/capabilities-302cf20d.js","assets/util-4239daf3.js","assets/TileStore-00ac650f.js","assets/Queue-b7d3cd48.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/FeatureLayerView-e9178bab.js","assets/floorFilterUtils-080a7cd2.js","assets/popupUtils-af06d391.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/RefreshableLayerView-7c1c2c75.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/projection-290b739f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/RelationshipQuery-0dda77ad.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/ItemCache-fd3aceaf.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/FramebufferObject-a3b9c52c.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/dehydratedFeatures-0557137d.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])),tile:Zv,"vector-tile":()=>dn().then(()=>G(()=>import("./VectorTileLayerView2D-0e96b466.js"),["assets/VectorTileLayerView2D-0e96b466.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/reactiveUtils-4dabbb80.js","assets/diffUtils-68b89c71.js","assets/enums-0fc02184.js","assets/TileInfoViewPOT-135a9f15.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/Rect-ea14f53a.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/pbf-0e99a620.js","assets/rasterizingUtils-ec11e94c.js","assets/floatRGBA-9ad35d39.js","assets/TileKey-5aef17b6.js","assets/mat3f32-d3d088e8.js","assets/config-1337d16e.js","assets/StyleDefinition-ff072275.js","assets/enums-2658a65c.js","assets/TileInfo-b0eb8c90.js","assets/unitUtils-45d1147c.js","assets/TileStore-00ac650f.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/LRUCache-64ec42ee.js","assets/MemCache-18a255ed.js","assets/enums-4ca4641f.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/vec2f64-30dc1443.js","assets/VertexElementDescriptor-2925c6af.js","assets/TileContainer-21007653.js","assets/WGLContainer-8a3733a0.js","assets/WGLBrushVTLSymbol-d778c554.js","assets/number-954e4ab6.js","assets/FramebufferObject-a3b9c52c.js","assets/vec2f32-461e65a9.js","assets/GeometryUtils-c093d234.js","assets/pixelUtils-d9cd2e49.js","assets/Utils-69cc114d.js","assets/ShaderCompiler-77d0dcb6.js","assets/ProgramTemplate-cc7f8b69.js","assets/MaterialKey-0093a242.js","assets/alignmentUtils-ae955d28.js","assets/utils-317368cb.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/heatmapTextureUtils-2627384f.js","assets/earcut-58237617.js","assets/vec2-528adfe4.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/StyleRepository-0c36ed5d.js","assets/colorUtils-0c057879.js","assets/GeometryUtils-eebff0a0.js","assets/Geometry-daada628.js","assets/LayerView2D-4c855e4b.js","assets/TileStrategy-a90cd1af.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/projection-290b739f.js","assets/zscale-89472cba.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/ItemCache-fd3aceaf.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/deprecate-035b199e.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/capabilities-302cf20d.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])),wcs:()=>dn().then(()=>G(()=>import("./ImageryTileLayerView2D-e2ca2720.js"),["assets/ImageryTileLayerView2D-e2ca2720.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/reactiveUtils-4dabbb80.js","assets/multidimensionalUtils-98b0907f.js","assets/RasterVFDisplayObject-0676fcf6.js","assets/HandleOwner-9b396af1.js","assets/FramebufferObject-a3b9c52c.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/VertexElementDescriptor-2925c6af.js","assets/dataUtils-a534a9c7.js","assets/pixelUtils-d9cd2e49.js","assets/WGLContainer-8a3733a0.js","assets/mat3f32-d3d088e8.js","assets/WGLBrushVTLSymbol-d778c554.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/enums-2658a65c.js","assets/enums-4ca4641f.js","assets/number-954e4ab6.js","assets/StyleDefinition-ff072275.js","assets/vec2f32-461e65a9.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/Utils-69cc114d.js","assets/ShaderCompiler-77d0dcb6.js","assets/ProgramTemplate-cc7f8b69.js","assets/MaterialKey-0093a242.js","assets/alignmentUtils-ae955d28.js","assets/utils-317368cb.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/heatmapTextureUtils-2627384f.js","assets/earcut-58237617.js","assets/vec2-528adfe4.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView2D-4c855e4b.js","assets/TileContainer-21007653.js","assets/TileInfo-b0eb8c90.js","assets/unitUtils-45d1147c.js","assets/RawBlockCache-f270ede9.js","assets/rasterProjectionHelper-a7452876.js","assets/projection-290b739f.js","assets/assets-8d3e737a.js","assets/zscale-89472cba.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/Queue-b7d3cd48.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/capabilities-302cf20d.js","assets/util-4239daf3.js","assets/ImageryTileLayerView-f97d6c38.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/lengthUtils-fa751420.js","assets/popupUtils-af06d391.js","assets/LayerView-bd9a2316.js","assets/RefreshableLayerView-7c1c2c75.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])),"web-tile":Zv,wfs:Yv,wms:()=>dn().then(()=>G(()=>import("./WMSLayerView2D-3b1dac67.js"),["assets/WMSLayerView2D-3b1dac67.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/reactiveUtils-4dabbb80.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/BitmapContainer-5fb5f7d8.js","assets/WGLContainer-8a3733a0.js","assets/mat3f32-d3d088e8.js","assets/WGLBrushVTLSymbol-d778c554.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/Evented-a45c8b0f.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/enums-2658a65c.js","assets/enums-4ca4641f.js","assets/number-954e4ab6.js","assets/FramebufferObject-a3b9c52c.js","assets/StyleDefinition-ff072275.js","assets/vec2f32-461e65a9.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/pixelUtils-d9cd2e49.js","assets/Utils-69cc114d.js","assets/ShaderCompiler-77d0dcb6.js","assets/ProgramTemplate-cc7f8b69.js","assets/MaterialKey-0093a242.js","assets/alignmentUtils-ae955d28.js","assets/utils-317368cb.js","assets/parser-498c8be0.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/Color-fb64d77d.js","assets/heatmapTextureUtils-2627384f.js","assets/earcut-58237617.js","assets/vec2-528adfe4.js","assets/featureConversionUtils-03a03f40.js","assets/jsonUtils-229211af.js","assets/Polyline-ff2d7c6b.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView2D-4c855e4b.js","assets/Collection-910b6f71.js","assets/SimpleObservable-23231131.js","assets/collectionUtils-803d9ba8.js","assets/geometry-b7901087.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/ExportStrategy-913accc5.js","assets/aaBoundingRect-193543b5.js","assets/TileInfo-b0eb8c90.js","assets/unitUtils-45d1147c.js","assets/Bitmap-479ee434.js","assets/TileStore-00ac650f.js","assets/Queue-b7d3cd48.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/enumeration-3a03bd31.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Clonable-545593ce.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/Identifiable-bfe1ff30.js","assets/Promise-376ab9f6.js","assets/RefreshableLayerView-7c1c2c75.js","assets/WMSLayerView-ccaae110.js","assets/OperationalLayer-97084f13.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/persistableUrlUtils-5f719c3b.js","assets/ElevationInfo-215614d8.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/lengthUtils-fa751420.js","assets/opacityUtils-1f7f5126.js","assets/ExportWMSImageParameters-e7eb0d55.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/zscale-89472cba.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/capabilities-302cf20d.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])),wmts:()=>dn().then(()=>G(()=>import("./WMTSLayerView2D-857b3d62.js"),["assets/WMTSLayerView2D-857b3d62.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/reactiveUtils-4dabbb80.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/imageUtils-5e882683.js","assets/BitmapTileContainer-d91c0937.js","assets/aaBoundingRect-193543b5.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/mat3f32-d3d088e8.js","assets/Bitmap-479ee434.js","assets/mat3-3fc68e72.js","assets/vec2f32-461e65a9.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/Evented-a45c8b0f.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/WGLContainer-8a3733a0.js","assets/WGLBrushVTLSymbol-d778c554.js","assets/enums-2658a65c.js","assets/enums-4ca4641f.js","assets/number-954e4ab6.js","assets/FramebufferObject-a3b9c52c.js","assets/StyleDefinition-ff072275.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/pixelUtils-d9cd2e49.js","assets/Utils-69cc114d.js","assets/ShaderCompiler-77d0dcb6.js","assets/ProgramTemplate-cc7f8b69.js","assets/MaterialKey-0093a242.js","assets/alignmentUtils-ae955d28.js","assets/utils-317368cb.js","assets/parser-498c8be0.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/Color-fb64d77d.js","assets/heatmapTextureUtils-2627384f.js","assets/earcut-58237617.js","assets/vec2-528adfe4.js","assets/featureConversionUtils-03a03f40.js","assets/jsonUtils-229211af.js","assets/Polyline-ff2d7c6b.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/TileContainer-21007653.js","assets/LayerView2D-4c855e4b.js","assets/Collection-910b6f71.js","assets/SimpleObservable-23231131.js","assets/collectionUtils-803d9ba8.js","assets/geometry-b7901087.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/TileStore-00ac650f.js","assets/Queue-b7d3cd48.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/enumeration-3a03bd31.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Clonable-545593ce.js","assets/TileStrategy-a90cd1af.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/Identifiable-bfe1ff30.js","assets/Promise-376ab9f6.js","assets/RefreshableLayerView-7c1c2c75.js","assets/preload-helper-3bce6601.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/capabilities-302cf20d.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])),"line-of-sight":null,"base-elevation":null,"building-scene":null,dimension:null,elevation:null,"integrated-mesh":null,"point-cloud":null,voxel:null,scene:null,unknown:null,unsupported:null};function Ape(i){const e=i.declaredClass?i.declaredClass.slice(i.declaredClass.lastIndexOf(".")+1):"Unknown",t=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new K(`${t}:view-not-supported`,`${e} is not supported in 2D`)}const fV={hasLayerViewModule:i=>y(mV[i.type]),importLayerView:i=>{const e=mV[i.type];if(S(e))throw Ape(i);return e(i)}};function Ope(i,e){const{spatialReference:t}=e,r=[e.x,e.y];let n=Number.POSITIVE_INFINITY,s=0,a=0;const o=[0,0],l=i.type==="extent"?[[[i.xmin,i.ymin],[i.xmin,i.ymax],[i.xmax,i.ymax],[i.xmax,i.ymin],[i.xmin,i.ymin]]]:i.rings;for(const c of l)for(let u=0;u<c.length-1;u++){sie(o,r,c,u);const d=q0(r,o);d<n&&(n=d,s=o[0],a=o[1])}return{coordinate:new Ne({x:s,y:a,spatialReference:t}),distance:n}}var q3;let Zf=q3=class extends TP(ue){constructor(i){super(i),this.geometry=null,this.spatialReference=null}get normalizedGeometry(){if(S(this.geometry)||!this.spatialReference)return null;if(!this.spatialReference.equals(this.geometry.spatialReference))try{return Dd(this.geometry,this.spatialReference)}catch(i){return J.getLogger(this.declaredClass).error("#constraints.geometry","could not project the geometry to the view's spatial reference",{geometry:this.geometry,spatialReference:this.spatialReference,error:i}),null}return this.geometry}constrain(i,e){if(S(this.normalizedGeometry))return i;const t=i.targetGeometry;if(this.normalizedGeometry.type==="extent"?y7(this.normalizedGeometry,t):Wee(this.normalizedGeometry,t))return i;const{coordinate:r}=Ope(this.normalizedGeometry,t);return r&&(i.targetGeometry=r),i}clone(){var i,e;return new q3({geometry:(i=this.geometry)==null?void 0:i.clone(),spatialReference:(e=this.spatialReference)==null?void 0:e.clone()})}};h([p({constructOnly:!0})],Zf.prototype,"geometry",void 0),h([p({readOnly:!0})],Zf.prototype,"normalizedGeometry",null),h([p({constructOnly:!0})],Zf.prototype,"spatialReference",void 0),Zf=q3=h([D("esri.views.2d.constraints.GeometryConstraint")],Zf);var W3;let H1=W3=class extends TP(ue){constructor(){super(...arguments),this.enabled=!0,this.rotationEnabled=!0}constrain(i,e){return this.enabled&&e&&(this.rotationEnabled||(i.rotation=e.rotation)),i}clone(){return new W3({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}};h([p()],H1.prototype,"enabled",void 0),h([p()],H1.prototype,"rotationEnabled",void 0),H1=W3=h([D("esri.views.2d.constraints.RotationConstraint")],H1);const MW=H1;var X3;let qa=X3=class extends TP(ue){constructor(i){super(i),this._lodByScale={},this._scales=[],this.effectiveLODs=null,this.effectiveMinZoom=-1,this.effectiveMaxZoom=-1,this.effectiveMinScale=0,this.effectiveMaxScale=0,this.lods=null,this.minZoom=-1,this.maxZoom=-1,this.minScale=0,this.maxScale=0,this.snapToZoom=!0}initialize(){let i,{lods:e,minScale:t,maxScale:r,minZoom:n,maxZoom:s}=this,a=-1,o=-1,l=!1,c=!1;if(t!==0&&r!==0&&t<r&&([t,r]=[r,t]),!e||!e.length)return this._set("effectiveMinScale",t),void this._set("effectiveMaxScale",r);e=e.map(u=>u.clone()),e.sort((u,d)=>d.scale-u.scale),e.forEach((u,d)=>u.level=d);for(const u of e)!l&&t>0&&t>=u.scale&&(a=u.level,l=!0),!c&&r>0&&r>=u.scale&&(o=i?i.level:-1,c=!0),i=u;n===-1&&(n=t===0?0:a),s===-1&&(s=r===0?e.length-1:o),n=Math.max(n,0),n=Math.min(n,e.length-1),s=Math.max(s,0),s=Math.min(s,e.length-1),n>s&&([n,s]=[s,n]),t=e[n].scale,r=e[s].scale,e.splice(0,n),e.splice(s-n+1,e.length),e.forEach((u,d)=>{this._lodByScale[u.scale]=u,this._scales[d]=u.scale}),this._set("effectiveLODs",e),this._set("effectiveMinZoom",n),this._set("effectiveMaxZoom",s),this._set("effectiveMinScale",t),this._set("effectiveMaxScale",r)}constrain(i,e){if(e&&i.scale===e.scale)return i;const t=this.effectiveMinScale,r=this.effectiveMaxScale,n=i.targetGeometry,s=e&&e.targetGeometry,a=r!==0&&i.scale<r,o=t!==0&&i.scale>t;if(a||o){const l=o?t:r;if(e&&s){const c=(l-e.scale)/(i.scale-e.scale);n.x=s.x+(n.x-s.x)*c,n.y=s.y+(n.y-s.y)*c}i.scale=l}return this.snapToZoom&&this.effectiveLODs&&(i.scale=this._getClosestScale(i.scale)),i}fit(i){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(i,null);const e=this.scaleToZoom(i.scale),t=Math.abs(e-Math.floor(e));return i.scale=this.zoomToScale(t>.99?Math.round(e):Math.floor(e)),i}zoomToScale(i){if(!this.effectiveLODs)return 0;i-=this.effectiveMinZoom,i=Math.max(0,i);const e=this._scales;if(i<=0)return e[0];if(i>=e.length)return e[e.length-1];const t=Math.round(i-.5),r=Math.round(i);return e[r]+(r-i)*(e[t]-e[r])}scaleToZoom(i){if(!this.effectiveLODs)return-1;const e=this._scales;let t,r;if(i>=e[0])return this.effectiveMinZoom;if(i<=e[e.length-1])return this.effectiveMaxZoom;for(let n=0;n<e.length-1;n++){if(t=e[n],r=e[n+1],r===i)return n+this.effectiveMinZoom+1;if(t>i&&r<i)return n+this.effectiveMinZoom+1-(i-r)/(t-r)}return-1}snapToClosestScale(i){if(!this.effectiveLODs)return i;const e=this.scaleToZoom(i);return this.zoomToScale(Math.round(e))}snapToNextScale(i,e=.5){if(!this.effectiveLODs)return i*e;const t=Math.round(this.scaleToZoom(i));return this.zoomToScale(t+1)}snapToPreviousScale(i,e=2){if(!this.effectiveLODs)return i*e;const t=Math.round(this.scaleToZoom(i));return this.zoomToScale(t-1)}clone(){return new X3({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}_getClosestScale(i){return this._lodByScale[i]||(i=this._scales.reduce((e,t)=>Math.abs(t-i)<=Math.abs(e-i)?t:e,this._scales[0])),this._lodByScale[i].scale}};h([p({readOnly:!0})],qa.prototype,"effectiveLODs",void 0),h([p({readOnly:!0})],qa.prototype,"effectiveMinZoom",void 0),h([p({readOnly:!0})],qa.prototype,"effectiveMaxZoom",void 0),h([p({readOnly:!0})],qa.prototype,"effectiveMinScale",void 0),h([p({readOnly:!0})],qa.prototype,"effectiveMaxScale",void 0),h([p()],qa.prototype,"lods",void 0),h([p()],qa.prototype,"minZoom",void 0),h([p()],qa.prototype,"maxZoom",void 0),h([p()],qa.prototype,"minScale",void 0),h([p()],qa.prototype,"maxScale",void 0),h([p()],qa.prototype,"snapToZoom",void 0),qa=X3=h([D("esri.views.2d.constraints.ZoomConstraint")],qa);const IW=qa,Mpe={base:null,key:"type",typeMap:{extent:ui,polygon:Hm}};let $r=class extends ue{constructor(e){super(e),this.lods=null,this.minScale=0,this.maxScale=0,this.minZoom=-1,this.maxZoom=-1,this.rotationEnabled=!0,this.snapToZoom=!0}destroy(){this.view=null}get effectiveLODs(){return this._zoom.effectiveLODs}get effectiveMinScale(){return this._zoom.effectiveMinScale}get effectiveMaxScale(){return this._zoom.effectiveMaxScale}get effectiveMinZoom(){return this._zoom.effectiveMinZoom}get effectiveMaxZoom(){return this._zoom.effectiveMaxZoom}set geometry(e){e?this._set("geometry",e):this._set("geometry",null)}get version(){var e,t,r;return`${(e=this._zoom)==null?void 0:e.uid}/${(t=this._rotation)==null?void 0:t.uid}/${(r=this._geometry)==null?void 0:r.uid}`}get _defaultLODs(){var r,n,s;const e=(n=(r=this.view)==null?void 0:r.defaultsFromMap)==null?void 0:n.tileInfo,t=(s=this.view)==null?void 0:s.spatialReference;return e&&t&&e.spatialReference.equals(t)?e.lods:null}get _geometry(){var e;return new Zf({geometry:this.geometry,spatialReference:(e=this.view)==null?void 0:e.spatialReference})}get _rotation(){return new MW({rotationEnabled:this.rotationEnabled})}get _zoom(){const e=this._get("_zoom"),t=this.lods||this._defaultLODs,r=this.minZoom,n=this.maxZoom,s=this.minScale,a=this.maxScale,o=this.snapToZoom;return e&&e.lods===t&&e.minZoom===r&&e.maxZoom===n&&e.minScale===s&&e.maxScale===a&&e.snapToZoom===o?e:new IW({lods:t,minZoom:r,maxZoom:n,minScale:s,maxScale:a,snapToZoom:o})}canZoomInTo(e){const t=this.effectiveMaxScale;return t===0||e>=t}canZoomOutTo(e){const t=this.effectiveMinScale;return t===0||e<=t}constrain(e,t){return this._zoom.constrain(e,t),this._rotation.constrain(e,t),this._geometry.constrain(e,t),e}constrainByGeometry(e){return this._geometry.constrain(e)}fit(e){return this._zoom.fit(e)}zoomToScale(e){return this._zoom.zoomToScale(e)}scaleToZoom(e){return this._zoom.scaleToZoom(e)}snapScale(e){return this._zoom.snapToClosestScale(e)}snapToNextScale(e){return this._zoom.snapToNextScale(e)}snapToPreviousScale(e){return this._zoom.snapToPreviousScale(e)}};h([p({readOnly:!0})],$r.prototype,"effectiveLODs",null),h([p({readOnly:!0})],$r.prototype,"effectiveMinScale",null),h([p({readOnly:!0})],$r.prototype,"effectiveMaxScale",null),h([p({readOnly:!0})],$r.prototype,"effectiveMinZoom",null),h([p({readOnly:!0})],$r.prototype,"effectiveMaxZoom",null),h([p({types:Mpe,value:null})],$r.prototype,"geometry",null),h([p({type:[fte]})],$r.prototype,"lods",void 0),h([p()],$r.prototype,"minScale",void 0),h([p()],$r.prototype,"maxScale",void 0),h([p()],$r.prototype,"minZoom",void 0),h([p()],$r.prototype,"maxZoom",void 0),h([p()],$r.prototype,"rotationEnabled",void 0),h([p()],$r.prototype,"snapToZoom",void 0),h([p()],$r.prototype,"view",void 0),h([p({readOnly:!0})],$r.prototype,"version",null),h([p()],$r.prototype,"_defaultLODs",null),h([p({type:Zf})],$r.prototype,"_geometry",null),h([p({type:MW})],$r.prototype,"_rotation",null),h([p({readOnly:!0,type:IW})],$r.prototype,"_zoom",null),$r=h([D("esri.views.2d.MapViewConstraints")],$r);const LW=$r;function Ipe(i){return i instanceof Float32Array&&i.length>=2}function Lpe(i){return Array.isArray(i)&&i.length>=2}function KA(i){return Ipe(i)||Lpe(i)}var Q3;const yu=[0,0];let Tp=Q3=class extends mt{constructor(i){super(i),this._viewpoint2D={center:be(),rotation:0,scale:0,spatialReference:null},this.center=[0,0],this.extent=new ui,this.id=0,this.inverseTransform=wm(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=wm(),this.transformNoRotation=wm(),this.displayMat3=cm(),this.displayViewMat3=cm(),this.viewMat3=cm(),this.viewMat2d=_ie(),this.worldScreenWidth=0,this.size=[0,0]}set pixelRatio(i){this._set("pixelRatio",i),this._update()}set size(i){this._set("size",i),this._update()}set viewpoint(i){if(i){const e=this._viewpoint2D,t=i.targetGeometry;e.center[0]=t.x,e.center[1]=t.y,e.rotation=i.rotation,e.scale=i.scale,e.spatialReference=t.spatialReference}this._update()}copy(i){const e=this.size,t=this.viewpoint;return t&&e?(this.viewpoint=Xc(t,i.viewpoint),this._set("size",wn(e,i.size))):(this.viewpoint=i.viewpoint.clone(),this._set("size",[i.size[0],i.size[1]])),this._set("pixelRatio",i.pixelRatio),this}clone(){return new Q3({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(i,e,t){return KA(e)?Yu(i,e,this.inverseTransform):(yu[0]=e,yu[1]=t,Yu(i,yu,this.inverseTransform))}toScreen(i,e,t){return KA(e)?Yu(i,e,this.transform):(yu[0]=e,yu[1]=t,Yu(i,yu,this.transform))}toScreenNoRotation(i,e,t){return KA(e)?Yu(i,e,this.transformNoRotation):(yu[0]=e,yu[1]=t,Yu(i,yu,this.transformNoRotation))}getScreenTransform(i,e){const{center:t}=this._viewpoint2D,r=this._get("pixelRatio")||1,n=this._get("size");return sN(i,t,n,e,0,r),i}_update(){const{center:i,spatialReference:e,scale:t,rotation:r}=this._viewpoint2D,n=this._get("pixelRatio")||1,s=this._get("size"),a=new rr({targetGeometry:new Ne(i[0],i[1],e),scale:t,rotation:r});if(this._set("viewpoint",a),!s||!e||!t)return;this.resolution=wv(a),this.rotation=r,this.scale=t,this.spatialReference=e,wn(this.center,i);const o=s[0]!==0?2/s[0]:0,l=s[1]!==0?-2/s[1]:0;_I(this.displayMat3,o,0,0,0,l,0,-1,1,1);const c=W7(this.viewMat3),u=Vp(s[0]/2,s[1]/2),d=Vp(-s[0]/2,-s[1]/2),m=SP(r);yI(c,c,u),X7(c,c,m),yI(c,c,d),uD(this.displayViewMat3,this.displayMat3,c);const f=U7(this.viewMat2d,u);return aD(f,f,m),$E(f,f,d),upe(this.extent,a,s),aN(this.transform,a,s,n),z7(this.inverseTransform,this.transform),ype(this.transformNoRotation,a,s,n),this.worldScreenWidth=bpe(this.spatialReference,this.resolution),this._set("id",this.id+1),this}};h([p({readOnly:!0})],Tp.prototype,"id",void 0),h([p({value:1,json:{write:!0}})],Tp.prototype,"pixelRatio",null),h([p({json:{write:!0}})],Tp.prototype,"size",null),h([p()],Tp.prototype,"spatialReference",void 0),h([p({type:rr,json:{write:!0}})],Tp.prototype,"viewpoint",null),Tp=Q3=h([D("esri.views.2d.ViewState")],Tp);const Z3=Tp;var Y3,K3;let Ju=Y3=class extends ue{constructor(){super(...arguments),this.left=0,this.top=0,this.right=0,this.bottom=0}clone(){return new Y3({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}};h([p()],Ju.prototype,"left",void 0),h([p()],Ju.prototype,"top",void 0),h([p()],Ju.prototype,"right",void 0),h([p()],Ju.prototype,"bottom",void 0),Ju=Y3=h([D("esri.views.2d.PaddedViewState.Padding")],Ju);let py=K3=class extends Z3{constructor(...i){super(...i),this.paddedViewState=new Z3,this._updateContent=(()=>{const e=be();return()=>{const t=this._get("size"),r=this._get("padding");if(!t||!r)return;const n=this.paddedViewState;Je(e,r.left+r.right,r.top+r.bottom),Pc(e,t,e),wn(n.size,e);const s=n.viewpoint;s&&(this.viewpoint=s)}})(),this.addHandles(z(()=>[this.size,this.padding],()=>this._updateContent(),ri)),this.padding=new Ju,this.size=[0,0]}set padding(i){this._set("padding",i||new Ju)}set viewpoint(i){if(i){const e=i.clone();this.paddedViewState.viewpoint=i,xpe(e,i,this._get("size"),this._get("padding"));const t=this._viewpoint2D,r=e.targetGeometry;t.center[0]=r.x,t.center[1]=r.y,t.rotation=e.rotation,t.scale=e.scale,t.spatialReference=r.spatialReference,this._update()}}clone(){return new K3({padding:this.padding.clone(),size:this.size.slice(),viewpoint:this.paddedViewState.viewpoint.clone(),pixelRatio:this.pixelRatio})}};h([p()],py.prototype,"paddedViewState",void 0),h([p({type:Ju})],py.prototype,"padding",null),h([p()],py.prototype,"viewpoint",null),py=K3=h([D("esri.views.2d.PaddedViewState")],py);const $pe=py;function hR(i,e){switch(e){case"primary":return i.pointerType==="touch"||i.button===0;case"secondary":return i.pointerType!=="touch"&&i.button===2;case"tertiary":return i.pointerType!=="touch"&&i.button===1}}function oN(i,e){if(i.pointerType==="touch")return!1;switch(e){case"primary":return i.button===0;case"secondary":return i.button===2;case"tertiary":return i.button===1}}let gV=class extends Ei{constructor(e,t){super(!0),this._view=e,this.registerIncoming("double-click",t,r=>this._handleDoubleClick(r,t))}_handleDoubleClick(e,t){hR(e.data,"primary")&&(e.stopPropagation(),t?this._view.mapViewNavigation.zoomOut([e.data.x,e.data.y]):this._view.mapViewNavigation.zoomIn([e.data.x,e.data.y]))}},Dpe=class extends Ei{constructor(e,t,r){super(!0),this.view=e,this.pointerType=t,this.registerIncoming("double-tap-drag",r,n=>this._handleDoubleTapDrag(n))}_handleDoubleTapDrag(e){const{data:t}=e,{pointerType:r}=t;if(r!==this.pointerType)return;e.stopPropagation();const{action:n,delta:s}=t,{view:a}=this,{mapViewNavigation:o}=a;switch(n){case"begin":{const{scale:l}=a;this._startScale=l,this._currentScale=l,this._previousDelta=s,o.begin();break}case"update":{if(this._previousDelta.y===s.y)return;this._previousDelta=s;const l=1.015**s.y,c=this._startScale*l,u=c/this._currentScale;o.setViewpointImmediate(u),this._currentScale=c;break}case"end":{const{constraints:l}=a,{effectiveLODs:c,snapToZoom:u}=l;if(!u||!c)return void o.end();const d=l.snapScale(this._currentScale),m=(s.y>0?Math.max(d,l.snapToPreviousScale(this._startScale)):Math.min(d,l.snapToNextScale(this._startScale)))/this._currentScale;o.zoom(m);break}}}},Wx=class{constructor(e){this._callbacks=e,this._currentCount=0,this._callbacks.condition||(this._callbacks.condition=()=>!0)}handle(e){const t=e.data,r=t.pointers.size;switch(t.action){case"start":this._currentCount=r,this._emitStart(e);break;case"added":this._emitEnd(this._previousEvent),this._currentCount=r,this._emitStart(e);break;case"update":this._emitUpdate(e);break;case"removed":this._startEvent&&this._emitEnd(this._previousEvent),this._currentCount=r,this._emitStart(e);break;case"end":this._emitEnd(e),this._currentCount=0}this._previousEvent=e}_emitStart(e){var t,r;this._startEvent=e,(r=(t=this._callbacks).condition)!=null&&r.call(t,this._currentCount,e)&&this._callbacks.start(this._currentCount,e,this._startEvent)}_emitUpdate(e){var t,r;(r=(t=this._callbacks).condition)!=null&&r.call(t,this._currentCount,e)&&this._callbacks.update(this._currentCount,e,this._startEvent)}_emitEnd(e){var t,r;(r=(t=this._callbacks).condition)!=null&&r.call(t,this._currentCount,e)&&this._callbacks.end(this._currentCount,e,this._startEvent),this._startEvent=null}},Fpe=class extends Ei{constructor(e,t,r){super(!0),this.view=e,this.pointerAction=t,this.registerIncoming("drag",r,n=>this._handleDrag(n)),this.registerIncoming("pointer-down",()=>this.stopMomentumNavigation())}onInstall(e){super.onInstall(e),this._dragEventSeparator=new Wx({start:(t,r)=>{this.view.mapViewNavigation.pan.begin(this.view,r.data),r.stopPropagation()},update:(t,r)=>{this.view.mapViewNavigation.pan.update(this.view,r.data),r.stopPropagation()},end:(t,r)=>{this.view.mapViewNavigation.pan.end(this.view,r.data),r.stopPropagation()},condition:(t,r)=>t===1&&hR(r.data,this.pointerAction)})}_handleDrag(e){const t=this.view.mapViewNavigation;t.pinch.zoomMomentum||t.pinch.rotateMomentum?this.stopMomentumNavigation():this._dragEventSeparator.handle(e)}stopMomentumNavigation(){this.view.mapViewNavigation.pan.stopMomentumNavigation()}},Npe=class extends Ei{constructor(e,t,r){super(!0),this._view=e,this.pointerAction=t;const n=this._view.mapViewNavigation;this._dragEventSeparator=new Wx({start:(s,a)=>{n.rotate.begin(this._view,a.data),a.stopPropagation()},update:(s,a)=>{n.rotate.update(this._view,a.data),a.stopPropagation()},end:(s,a)=>{n.rotate.end(),a.stopPropagation()},condition:(s,a)=>s===1&&hR(a.data,this.pointerAction)}),this.registerIncoming("drag",r,s=>this._dragEventSeparator.handle(s))}};function ec(i){let e=i*i;return i<0&&(e*=-1),e}function kpe(i){return i.translation[0]=0,i.translation[1]=0,i.translation[2]=0,i.heading=0,i.tilt=0,i}function J3(i,e,t){const r=t,n=i.state,s=i.device,a=e.tiltDirection==="forward-down"?1:-1,o=1;return s.deviceType==="standard"?(r.translation[0]=ec(n.axes[0]),r.translation[1]=ec(n.axes[1]),r.translation[2]=ec(n.buttons[7])-ec(n.buttons[6]),r.heading=ec(n.axes[2]),r.tilt=ec(n.axes[3])):s.deviceType==="spacemouse"&&(r.translation[0]=1.2*ec(n.axes[0]),r.translation[1]=1.2*ec(n.axes[1]),r.translation[2]=2*-ec(n.axes[2]),r.heading=1.2*ec(n.axes[5]),r.tilt=1.2*ec(n.axes[3])),r.tilt*=a,Q(r.translation,r.translation,o),r}function _V(i,e){const t=e;return t.translation[0]=i[1]-i[0],t.translation[1]=i[3]-i[2],t.translation[2]=i[4]-i[5],t.heading=i[7]-i[6],t.tilt=i[8]-i[9],t.zoom=i[10]-i[11],t}function zS(i){return i.translation[0]===0&&i.translation[1]===0&&i.translation[2]===0&&i.heading===0&&i.tilt===0&&i.zoom===0}let Vpe=class extends Ei{constructor(e){super(!0),this._view=e,this._frameTask=null,this._watchHandles=new Ft,this._currentDevice=null,this._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this._handle=this.registerIncoming("gamepad",t=>this._handleGamePadEvent(t)),this._handle.pause()}onInstall(e){super.onInstall(e),this._watchHandles.add([z(()=>{var t;return(t=this._view.navigation.gamepad)==null?void 0:t.enabled},t=>{t?(this._handle.resume(),this._frameTask||(this._frameTask=wd({update:r=>this._frameUpdate(r.deltaTime)}))):(this._handle.pause(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null))},Qe)])}onUninstall(){this._watchHandles.removeAll(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null),super.onUninstall()}_handleGamePadEvent(e){const t=this._view.navigation.gamepad.device;t&&e.data.device!==t||this._currentDevice&&this._currentDevice!==e.data.device||(e.data.action==="end"?(this._currentDevice=null,kpe(this._transformation)):(this._currentDevice=e.data.device,J3(e.data,this._view.navigation.gamepad,this._transformation)))}_frameUpdate(e){const t=this._transformation;if(zS(t))return;const r=this._view.viewpoint.clone(),n=this._view.navigation.gamepad.velocityFactor,s=zpe*n*e;cR(r,r,[t.translation[0]*s,-t.translation[1]*s]);const a=1+t.translation[2]*Bpe*e,o=this._view.constraints.rotationEnabled?-t.heading*Upe*e:0,l=this._view.size,c=[l[0]/2,l[1]];RW(r,r,a,o,c,l);const u=this._view.constraints.constrain(r,this._view.viewpoint);this._view.viewpoint=u}};const Upe=.06,zpe=.7,Bpe=6e-4;let Gpe=class extends Ei{constructor(e,t,r){super(!0),this.view=e,this.keys=t,this._pressed=!1,this._keyMap={[t.left]:"left",[t.right]:"right",[t.up]:"up",[t.down]:"down"},this.registerIncoming("key-down",r,n=>this._handleKeyDown(n)),this.registerIncoming("key-up",r,n=>this._handleKeyUp(n)),this.registerIncoming("blur",r,()=>this._handleBlur())}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0)}_handleKeyUp(e){this._handleKey(e,!1)}_handleBlur(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(e,t){const r=this._keyMap[e.data.key];if(this._pressed=r!=null,this._pressed){if(t)switch(this.view.mapViewNavigation.begin(),r){case"left":this.view.mapViewNavigation.continousPanLeft();break;case"right":this.view.mapViewNavigation.continousPanRight();break;case"up":this.view.mapViewNavigation.continousPanUp();break;case"down":this.view.mapViewNavigation.continousPanDown()}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation()}}},Hpe=class extends Ei{constructor(e,t,r){super(!0),this.view=e,this.keys=t,this._pressed=!1,this._keyToDirection={[t.clockwiseOption1]:"clockwise",[t.clockwiseOption2]:"clockwise",[t.counterClockwiseOption1]:"counterClockwise",[t.counterClockwiseOption2]:"counterClockwise",[t.resetOption1]:"reset",[t.resetOption2]:"reset"},this.registerIncoming("key-down",r,n=>this._handleKeyDown(n)),this.registerIncoming("key-up",r,n=>this._handleKeyUp(n)),this.registerIncoming("blur",r,()=>this._handleBlur())}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0)}_handleKeyUp(e){this._handleKey(e,!1)}_handleBlur(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(e,t){const r=e.modifiers;if(r.size>0&&!r.has("Shift")||!this.view.constraints.rotationEnabled)return;const n=this._keyToDirection[e.data.key];if(this._pressed=n!=null,this._pressed){if(t)switch(this.view.mapViewNavigation.begin(),n){case"clockwise":this.view.mapViewNavigation.continousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation()}}};var o0;(function(i){i[i.IN=0]="IN",i[i.OUT=1]="OUT"})(o0||(o0={}));let jpe=class extends Ei{constructor(e,t,r){super(!0),this.view=e,this.keys=t,this._keysToZoomAction={},this.registerIncoming("key-down",r,n=>this._handleKeyDown(n)),t.zoomIn.forEach(n=>this._keysToZoomAction[n]=o0.IN),t.zoomOut.forEach(n=>this._keysToZoomAction[n]=o0.OUT)}_handleKeyDown(e){this._handleKey(e)}_handleKey(e){const t=e.modifiers;if(t.size>0&&!t.has("Shift"))return;const{key:r}=e.data;if(!(r in this._keysToZoomAction))return;const n=this._keysToZoomAction[r],{mapViewNavigation:s}=this.view;let a=null;switch(n){case o0.IN:a=s.zoomIn();break;case o0.OUT:a=s.zoomOut();break;default:return}s.begin(),a.then(()=>s.end()),e.stopPropagation()}};const qpe=.6;let Wpe=class extends Ei{constructor(e,t){super(!0),this._view=e,this._canZoom=!0,this.registerIncoming("mouse-wheel",t,r=>this._handleMouseWheel(r))}_handleMouseWheel(e){if(!this._view.navigation.mouseWheelZoomEnabled||(e.preventDefault(),e.stopPropagation(),!this._canZoom))return;const t=this._view.mapViewNavigation,{x:r,y:n,deltaY:s}=e.data,a=1/qpe**(1/60*s),o=t.zoom(a,[r,n]);o&&(this._canZoom=!1,o.catch(()=>{}).then(()=>{this._canZoom=!0,t.end()}))}},Xpe=class extends Ei{constructor(e){super(!0),this.view=e,this.registerIncoming("drag",r=>this._handleDrag(r)),this.registerIncoming("pointer-down",()=>this._stopMomentumNavigation());const t=this.view.mapViewNavigation;this._dragEventSeparator=new Wx({start:(r,n)=>{t.pinch.begin(this.view,n.data),n.stopPropagation()},update:(r,n)=>{t.pinch.update(this.view,n.data),n.stopPropagation()},end:(r,n)=>{t.pinch.end(this.view),n.stopPropagation()},condition:r=>r>=2})}_handleDrag(e){this._dragEventSeparator.handle(e)}_stopMomentumNavigation(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()}};function yV(i){const e=i.native;return e?{buttons:e.buttons.map(t=>t.pressed?t.value?t.value:1:0),axes:e.axes.map(t=>Ype(t,i.axisThreshold))}:{buttons:[],axes:[]}}function Qpe(i,e){if(i.axes.length!==e.axes.length||i.buttons.length!==e.buttons.length)return!1;for(let t=0;t<i.axes.length;t++)if(i.axes[t]!==e.axes[t])return!1;for(let t=0;t<i.buttons.length;t++)if(i.buttons[t]!==e.buttons[t])return!1;return!0}function Zpe(i){for(let e=0;e<i.axes.length;e++)if(i.axes[e]!==0)return!1;for(let e=0;e<i.buttons.length;e++)if(i.buttons[e]!==0)return!1;return!0}function Ype(i,e){const t=Math.abs(i);return t<e?0:Math.sign(i)*(t-e)/(1-e)}let Kpe=class{constructor(e,t){this._element=e,this._input=t,this._hasEventListeners=!1,this._onConnectGamepad=s=>{this._connectGamepad(s.gamepad)},this._onDisconnectGamepad=s=>{const a=s.gamepad,o=a.index,l=this._inputDevices[o];l&&(this._emitGamepadEvent(a,yV(l),!1),this._inputDevices.splice(o,1),this._latestUpdate.splice(o,1),this._input.gamepad.devices.remove(l),this.ensurePollingState())},this._frameTask=null,this._latestUpdate=new Array,this._inputDevices=new Array,this._callback=null;const r="getGamepads"in window.navigator,n=window.isSecureContext;this.supported=r&&n,this.supported&&(this._forEachGamepad(s=>this._connectGamepad(s)),window.addEventListener("gamepadconnected",this._onConnectGamepad),window.addEventListener("gamepaddisconnected",this._onDisconnectGamepad),this.ensurePollingState())}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this._onConnectGamepad),window.removeEventListener("gamepaddisconnected",this._onDisconnectGamepad))}set hasEventListeners(e){this._hasEventListeners!==e&&(this._hasEventListeners=e,this.ensurePollingState())}get _eventsEnabled(){return this.supported&&this._inputDevices.length>0&&this._hasEventListeners}set onEvent(e){this._callback=e}_connectGamepad(e){const t=new iN(e);t.deviceType!=="unknown"&&(this._inputDevices[e.index]=t,this._input.gamepad.devices.add(t)),this.ensurePollingState()}ensurePollingState(){this._eventsEnabled?this._startPolling():this._stopPolling()}_startPolling(){this._frameTask==null&&(this._frameTask=wd({update:()=>this._readGamepadState()}))}_stopPolling(){this._frameTask!=null&&(this._frameTask.remove(),this._frameTask=null,this._latestUpdate=new Array)}_readGamepadState(){const e=document.hasFocus(),t=this._element.contains(document.activeElement),r=this._input.gamepad.enabledFocusMode==="document"&&!e||this._input.gamepad.enabledFocusMode==="view"&&!t;this._forEachGamepad(n=>{const s=this._inputDevices[n.index];if(!s)return;const a=this._latestUpdate[n.index],o=yV(s),l=r||Zpe(o);a&&(a.timestamp===n.timestamp||!a.active&&l||Qpe(a.state,o))||this._emitGamepadEvent(n,o,!l)})}_forEachGamepad(e){const t=window.navigator.getGamepads();for(let r=0;r<t.length;r++){const n=t[r];this._validate(n)&&e(n)}}_emitGamepadEvent(e,t,r){const n=this._latestUpdate[e.index],s=n&&n.active;if(!s&&!r)return;const a=!s&&r?"start":s&&r?"update":"end";this._latestUpdate[e.index]={timestamp:e.timestamp,state:t,active:r},this._callback&&this._callback({device:this._inputDevices[e.index],state:t,action:a})}_validate(e){if(!e||!e.connected)return!1;for(let t=0;t<e.axes.length;t++)if(isNaN(e.axes[t]))return!1;return!0}};const vV=St("trident"),bV=St("edge"),Jpe=St("chrome"),eme=St("ff"),tme=St("safari"),S_={touchNone:"esri-view-surface--touch-none",touchPan:"esri-view-surface--touch-pan"};let lN=class $W{constructor(e,t){this._input=t,this._active={},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=e,e.getAttribute("tabindex")||e.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new Kpe(e,this._input),this._gamepadSource.onEvent=r=>this._callback("gamepad",r)}destroy(){this._callback=null,this.activeEvents=null,this._activePointerCaptures.forEach(e=>{this._releasePointerCaptureSafe(e)}),this._gamepadSource=Te(this._gamepadSource),this._activePointerCaptures=null,this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault)}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(e){this._browserTouchPanningEnabled=e,this._updateTouchAction(),this._updateTouchEventHandling()}set onEventReceived(e){this._callback=e}set activeEvents(e){for(const t in this._active)if(!e||!e.has(t)){const r=this._active[t];this._element.removeEventListener(JA[t],r),delete this._active[t]}e&&e.forEach(t=>{if(!this._active[t]&&JA[t]){const r=(this._eventHandlers[t]||this._handleDefault).bind(this,t);this._element.addEventListener(JA[t],r),this._active[t]=r}}),this._gamepadSource.hasEventListeners=e&&e.has("gamepad")}setPointerCapture(e,t){t?(this._element.setPointerCapture(e.pointerId),this._activePointerCaptures.add(e.pointerId)):(this._releasePointerCaptureSafe(e.pointerId),this._activePointerCaptures.delete(e.pointerId))}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?S_.touchNone:S_.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?S_.touchPan:S_.touchNone)}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_removeTouchAction(){this._element.classList.remove(S_.touchNone),this._element.classList.remove(S_.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_releasePointerCaptureSafe(e){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(e))return;this._element.releasePointerCapture(e)}catch{}}_updateNormalizedPointerLikeEvent(e,t){const r=pW(this._element,e);return $W.test.disableSubpixelCoordinates&&(r.x=Math.round(r.x),r.y=Math.round(r.y)),t.x=r.x,t.y=r.y,t}_handleKey(e,t){const r=ade(t);r&&e==="key-up"&&this._keyDownState.delete(r);const n={native:t,key:r,repeat:r&&this._keyDownState.has(r)};r&&e==="key-down"&&this._keyDownState.add(n.key),this._callback(e,n)}_handlePointer(e,t){const r=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,pointerType:t.pointerType,button:t.button,buttons:t.buttons,eventId:this._eventId++});this._callback(e,r)}_handlePointerPreventDefault(e,t){const r=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,pointerType:t.pointerType,button:t.button,buttons:t.buttons,eventId:this._eventId++});t.preventDefault(),this._callback(e,r)}_handleMouseWheel(e,t){let r=t.deltaY;switch(t.deltaMode){case 0:(vV||bV)&&(r=r/document.documentElement.clientHeight*600);break;case 1:r*=30;break;case 2:r*=900}vV||bV?r*=.7:Jpe||tme?r*=.6:eme&&(r*=1.375);const n=100,s=Math.abs(r);s>n&&(r=r/s*200/(1+Math.exp(-.02*(s-n))));const a=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,deltaY:r});this._callback(e,a)}_handlePointerCaptureLost(e,t){this._activePointerCaptures.delete(t.pointerId),this._handleDefault(e,t)}_handleDefault(e,t){const r={native:t};t.preventDefault(),this._callback(e,r)}_preventAltKeyDefault(e){e.key==="Alt"&&e.preventDefault()}_preventMultiTouchPanning(e){e.touches.length>1&&e.preventDefault()}};lN.test={disableSubpixelCoordinates:!1};const JA={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};let DW=class extends Ei{constructor(){super(!0),this.registerIncoming("context-menu",e=>{e.data.native.preventDefault()})}};function cN(i,e){return Math.abs(e.x-i.x)+Math.abs(e.y-i.y)}function ime(i,e){const t=e.x-i.x,r=e.y-i.y;return Math.sqrt(t*t+r*r)}function rme(i,e){if(e?(e.radius=0,e.center.x=0,e.center.y=0):e={radius:0,center:Ps()},i.length===0)return e;if(i.length===1)return e.center.x=i[0].x,e.center.y=i[0].y,e;if(i.length===2){const[w,T]=i,[E,C]=[T.x-w.x,T.y-w.y];return e.radius=Math.sqrt(E*E+C*C)/2,e.center.x=(w.x+T.x)/2,e.center.y=(w.y+T.y)/2,e}let t=0,r=0;for(let w=0;w<i.length;w++)t+=i[w].x,r+=i[w].y;t/=i.length,r/=i.length;const n=i.map(w=>w.x-t),s=i.map(w=>w.y-r);let a=0,o=0,l=0,c=0,u=0,d=0,m=0;for(let w=0;w<n.length;w++){const T=n[w],E=s[w],C=T*T,A=E*E;a+=C,o+=A,l+=T*E,c+=C*T,u+=A*E,d+=T*A,m+=E*C}const f=.5*(c+d),_=.5*(u+m),g=a*o-l*l,x=(f*o-_*l)/g,b=(a*_-l*f)/g,v=Ps(x+t,b+r);return{radius:Math.sqrt(x*x+b*b+(a+o)/i.length),center:v}}function yg(i){const{native:e}=i,{pointerId:t,button:r,pointerType:n}=e;return n==="mouse"?`${t}:${r}`:`${n}`}const Ul={maximumDoubleClickDelay:250,maximumDoubleClickDistance:10,maximumDoubleTouchDelay:350,maximumDoubleTouchDistance:35};let FW=class extends Ei{constructor(e=Ul.maximumDoubleClickDelay,t=Ul.maximumDoubleClickDistance,r=Ul.maximumDoubleTouchDelay,n=Ul.maximumDoubleTouchDistance,s=yP){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=t,this._maximumDoubleTouchDelay=r,this._maximumDoubleTouchDistance=n,this._clock=s,this._pointerState=new Map,this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",this._handleImmediateClick.bind(this)),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this))}onUninstall(){this._pointerState.forEach(e=>e.doubleClickTimer=Os(e.doubleClickTimer))}get hasPendingInputs(){return Er(this._pointerState,e=>e.doubleClickTimer!=null)}_clearDoubleClickTimer(e,t){const r=this._pointerState.get(e);r&&(r.doubleClickTimer=Os(r.doubleClickTimer),t&&this._click.emit(r.event.data,void 0,r.event.modifiers),this._pointerState.delete(e),this.refreshHasPendingInputs())}_doubleClickTimeoutExceeded(e){const t=this._pointerState.get(e);t.pointerDownCount===1&&this._click.emit(t.event.data,void 0,t.event.modifiers),t.doubleClickTimer=null,this._pointerState.delete(e),this.refreshHasPendingInputs()}_getPointerId(e){const{pointerId:t,pointerType:r,button:n}=e.native;return r==="mouse"?`${t}:${n}`:`${r}`}_handleImmediateClick(e){const t=e.data,{pointerType:r}=t.native,n=this._getPointerId(t);if(!this._pointerState.has(n))return void this._startClick(e);const s=this._pointerState.get(n),{data:a,modifiers:o}=s.event,l=r==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;cN(a,t)>l?(this._clearDoubleClickTimer(n,!0),this._startClick(e)):(this._clearDoubleClickTimer(n,!1),s.pointerDownCount===2&&this._doubleClick.emit(a,void 0,o))}_handlePointerDown(e){const t=yg(e.data),r=this._pointerState.get(t);r&&(r.pointerDownCount+=1)}_startClick(e){const{data:t}=e,{native:{pointerType:r}}=t,n=yg(t),s=r==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,a=this._clock.setTimeout(()=>this._doubleClickTimeoutExceeded(n),s),o=1;this._pointerState.set(n,{event:e,doubleClickTimer:a,pointerDownCount:o}),this.refreshHasPendingInputs()}},nme=class extends Ei{constructor(e=Ul.maximumDoubleClickDelay,t=Ul.maximumDoubleClickDistance,r=Ul.maximumDoubleTouchDelay,n=Ul.maximumDoubleTouchDistance,s=yP){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=t,this._maximumDoubleTouchDelay=r,this._maximumDoubleTouchDistance=n,this._clock=s,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=Ps(0,0),this._pointerState=new Map,this._doubleTapDrag=this.registerOutgoing("double-tap-drag"),this._dragEventSeparator=new Wx({start:(a,o)=>this._dragStart(a,o),update:(a,o)=>this._dragUpdate(o),end:(a,o)=>this._dragEnd(o)}),this.registerIncoming("drag",a=>this._dragEventSeparator.handle(a)),this.registerIncoming("pointer-down",a=>this._handlePointerDown(a)),this.registerIncoming("pointer-up",()=>this._handlePointerUp())}onUninstall(){this._pointerState.forEach(e=>{e.doubleTapTimeout=Os(e.doubleTapTimeout)})}get hasPendingInputs(){return Er(this._pointerState,e=>e.doubleTapTimeout!=null)}_clearPointerDown(e){const t=this._pointerState.get(e);t&&(t.doubleTapTimeout=Os(t.doubleTapTimeout),this._pointerState.delete(e),this.refreshHasPendingInputs())}_createDoubleTapDragData(e,t,r){const{button:n,buttons:s,pointer:a,pointers:o,pointerType:l,timestamp:c}=r;return{action:e,delta:t,button:n,buttons:s,pointer:a,pointers:o,pointerType:l,timestamp:c}}_dragStart(e,t){if(!this._doubleTapDragReady||e!==1)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;const{data:r,modifiers:n}=t,{center:s}=r;this._dragStartCenter=s;const a=this._createDoubleTapDragData("begin",Ps(0,0),r);this._doubleTapDrag.emit(a,void 0,n),t.stopPropagation()}_dragUpdate(e){if(!this._doubleTapDragActive)return;const{data:t,modifiers:r}=e,{center:n}=t,s=Ps(n.x-this._dragStartCenter.x,n.y-this._dragStartCenter.y),a=this._createDoubleTapDragData("update",s,t);this._doubleTapDrag.emit(a,void 0,r),e.stopPropagation()}_dragEnd(e){if(!this._doubleTapDragActive)return;const{data:t,modifiers:r}=e,{center:n}=t,s=Ps(n.x-this._dragStartCenter.x,n.y-this._dragStartCenter.y),a=this._createDoubleTapDragData("end",s,t);this._doubleTapDrag.emit(a,void 0,r),this._doubleTapDragActive=!1,e.stopPropagation()}_handlePointerDown(e){const{data:t}=e,r=yg(t),n=this._pointerState.get(r),{pointerType:s}=t.native;if(n){const a=s==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;this._clearPointerDown(r),cN(n.event.data,t)>a?this._storePointerDown(e):this._doubleTapDragReady=!0}else this._storePointerDown(e)}_handlePointerUp(){this._doubleTapDragReady=!1}_storePointerDown(e){const{data:t}=e,{pointerType:r}=t.native,n=yg(t),s=r==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,a=this._clock.setTimeout(()=>this._clearPointerDown(n),s);this._pointerState.set(n,{event:e,doubleTapTimeout:a}),this.refreshHasPendingInputs()}},NW=class extends Ei{constructor(e){super(!1),this._navigationTouch=e,this._startStateModifiers=new Set,this._activePointerMap=new Map,this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this._handlePointerUpAndPointerLost.bind(this))}_createPayload(e,t,r,n){return{action:e,pointerType:this._pointerType,button:this._mouseButton,buttons:t.buttons,timestamp:n,pointers:sme(this._activePointerMap),pointer:t,angle:r.angle,radius:r.radius,center:r.center}}_addPointer(e){const t=e.native.pointerId,r=IT(this._activePointerMap).angle,n={event:e,initialAngle:0,lastAngle:0};this._activePointerMap.set(t,n);const s=BS(n,kW(this._activePointerMap));n.initialAngle=s,n.lastAngle=s,this._updatePointerAngles(r)}_updatePointer(e){if(e&&e.x==null&&e.y==null)return;const t=e.native.pointerId,r=this._activePointerMap.get(t);r?r.event=e:this._addPointer(e)}_removePointer(e){const t=IT(this._activePointerMap).angle;this._activePointerMap.delete(e),this._updatePointerAngles(t)}_updatePointerAngles(e){const t=IT(this._activePointerMap);this._activePointerMap.forEach(r=>{r.initialAngle=BS(r,t)-e,r.lastAngle=BS(r,t)-e})}_emitEvent(e,t,r){const n=IT(this._activePointerMap);this._drag.emit(this._createPayload(e,t,n,r),void 0,this._startStateModifiers)}_handlePointerUpAndPointerLost(e){const t=e.data.native.pointerId,r=Rt(e.timestamp);this._activePointerMap.get(t)&&(this._activePointerMap.size===1?(this._updatePointer(e.data),!this._isCurrentDragSuppressed&&this._emitEvent("end",e.data,r),this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._removePointer(t)):(this._removePointer(t),this._emitEvent("removed",e.data,Rt(e.timestamp))))}_handlePointerDrag(e){const t=e.data,r=t.currentEvent,n=Rt(e.timestamp);switch(t.action){case"start":case"update":this._isDragging?this._activePointerMap.has(r.native.pointerId)?(this._updatePointer(r),!this._isCurrentDragSuppressed&&this._emitEvent("update",r,n)):(this._addPointer(r),this._emitEvent("added",r,n),this._isCurrentDragSuppressed=this._isSuppressed):(this._updatePointer(r),this._pointerType=e.data.startEvent.pointerType,this._mouseButton=e.data.startEvent.button,this._startStateModifiers=e.modifiers,this._isDragging=!0,this._isCurrentDragSuppressed=this._isSuppressed,!this._isCurrentDragSuppressed&&this._emitEvent("start",r,n))}}get _isSuppressed(){return!!this._navigationTouch&&!this._navigationTouch.browserTouchPanEnabled&&this._pointerType==="touch"&&this._activePointerMap.size===1}};function kW(i){const e=[];return i.forEach(t=>{e.push(Ps(t.event.x,t.event.y))}),rme(e)}function IT(i){const e=kW(i);let t=0;return i.forEach(r=>{let n=BS(r,e),s=n-r.lastAngle;for(;s>Math.PI;)s-=2*Math.PI;for(;s<-Math.PI;)s+=2*Math.PI;n=r.lastAngle+s,r.lastAngle=n;const a=n-r.initialAngle;t+=a}),t/=i.size||1,{angle:t,radius:e.radius,center:e.center}}function sme(i){const e=new Map;return i.forEach((t,r)=>e.set(r,t.event)),e}function BS(i,e){const t=i.event,r=t.x-e.center.x,n=t.y-e.center.y;return Math.atan2(n,r)}var wV;(function(i){i[i.Left=0]="Left",i[i.Middle=1]="Middle",i[i.Right=2]="Right",i[i.Back=3]="Back",i[i.Forward=4]="Forward",i[i.Undefined=-1]="Undefined"})(wV||(wV={}));let VW=class extends Ei{constructor(e=Ul.maximumDoubleClickDelay,t=Ul.maximumDoubleClickDistance,r=Ul.maximumDoubleTouchDelay,n=Ul.maximumDoubleTouchDistance,s=yP){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=t,this._maximumDoubleTouchDelay=r,this._maximumDoubleTouchDistance=n,this._clock=s,this._pointerState=new Map,this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUp.bind(this))}onUninstall(){this._pointerState.forEach(e=>{e.immediateDoubleClick&&e.immediateDoubleClick.timeoutHandle.remove()}),super.onUninstall()}_handlePointerDown(e){const t=e.data,r=yg(t);if(!this._pointerState.has(r)){const n={downButton:t.native.button,immediateDoubleClick:null};this._pointerState.set(r,n),this.startCapturingPointer(t.native)}}_handlePointerUp(e){const t=e.data,r=yg(t),n=this._pointerState.get(r);if(n&&n.downButton===t.native.button){const s=n.immediateDoubleClick;if(s){s.timeoutHandle.remove();const a=e.data.native.pointerType==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;cN(s,e.data)>a?this._startImmediateDoubleClick(e,n):(this._immediateDoubleClick.emit(e.data,void 0,s.modifiers),this._removeState(t))}else this._startImmediateDoubleClick(e,n)}}_startImmediateDoubleClick(e,t){const r=e.data.native.pointerType==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay;t.immediateDoubleClick={x:e.data.x,y:e.data.y,modifiers:e.modifiers,timeoutHandle:this._clock.setTimeout(()=>this._removeState(e.data),r)}}_removeState(e){const t=yg(e);this._pointerState.delete(t),this.stopCapturingPointer(e.native),this.refreshHasPendingInputs()}};const Kv={maximumClickDelay:300,movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500};let UW=class extends Ei{constructor(e=Kv.maximumClickDelay,t=Kv.movementUntilMouseDrag,r=Kv.movementUntilPenDrag,n=Kv.movementUntilTouchDrag,s=Kv.holdDelay,a=yP){super(!1),this._maximumClickDelay=e,this._movementUntilMouseDrag=t,this._movementUntilPenDrag=r,this._movementUntilTouchDrag=n,this._holdDelay=s,this._clock=a,this._pointerState=new Map,this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",o=>{this._handlePointerLoss(o,"pointer-up")}),this.registerIncoming("pointer-capture-lost",o=>{this._handlePointerLoss(o,"pointer-capture-lost")}),this.registerIncoming("pointer-cancel",o=>{this._handlePointerLoss(o,"pointer-cancel")}),this._moveHandle=this.registerIncoming("pointer-move",this._handlePointerMove.bind(this)),this._moveHandle.pause()}onUninstall(){this._pointerState.forEach(e=>{e.holdTimeout=Os(e.holdTimeout)}),super.onUninstall()}_handlePointerDown(e){const t=e.data,r=t.native.pointerId;let n=null;this._pointerState.size===0&&(n=this._clock.setTimeout(()=>{const a=this._pointerState.get(r);if(a){if(!a.isDragging){const o=a.previousEvent;this._pointerHold.emit(o,void 0,e.modifiers),a.holdEmitted=!0}a.holdTimeout=null}},this._holdDelay));const s={startEvent:t,previousEvent:t,startTimestamp:e.timestamp,isDragging:!1,downButton:t.native.button,holdTimeout:n,modifiers:new Set};this._pointerState.set(r,s),this.startCapturingPointer(t.native),this._moveHandle.resume(),this._pointerState.size>1&&this._startDragging(e)}_createPointerDragData(e,t,r){return{action:e,startEvent:t.startEvent,previousEvent:t.previousEvent,currentEvent:r}}_handlePointerMove(e){const t=e.data,r=t.native.pointerId,n=this._pointerState.get(r);n&&(n.isDragging?this._pointerDrag.emit(this._createPointerDragData("update",n,t),void 0,n.modifiers):ime(t,n.startEvent)>this._getDragThreshold(t.native.pointerType)&&this._startDragging(e),n.previousEvent=t)}_getDragThreshold(e){switch(e){case"touch":return this._movementUntilTouchDrag;case"pen":return this._movementUntilPenDrag;default:return this._movementUntilMouseDrag}}_startDragging(e){const t=e.data,r=t.native.pointerId;this._pointerState.forEach(n=>{n.holdTimeout!=null&&(n.holdTimeout.remove(),n.holdTimeout=null),n.isDragging||(n.modifiers=e.modifiers,n.isDragging=!0,r===n.startEvent.native.pointerId?this._pointerDrag.emit(this._createPointerDragData("start",n,t)):this._pointerDrag.emit(this._createPointerDragData("start",n,n.previousEvent),e.timestamp))})}_handlePointerLoss(e,t){const r=e.data,n=r.native.pointerId,s=this._pointerState.get(n);s&&(s.holdTimeout!=null&&(s.holdTimeout.remove(),s.holdTimeout=null),s.isDragging?this._pointerDrag.emit(this._createPointerDragData("end",s,t==="pointer-up"?r:s.previousEvent),void 0,s.modifiers):t==="pointer-up"&&s.downButton===r.native.button&&e.timestamp-s.startTimestamp<=this._maximumClickDelay&&!s.holdEmitted&&this._immediateClick.emit(r),this._pointerState.delete(n),this.stopCapturingPointer(r.native),this._pointerState.size===0&&this._moveHandle.pause())}};const LT={counter:"Ctrl",pan:{left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},zoom:{zoomIn:["=","+"],zoomOut:["-","_"]},rotate:{clockwiseOption1:"a",clockwiseOption2:"A",counterClockwiseOption1:"d",counterClockwiseOption2:"D",resetOption1:"n",resetOption2:"N"}};let Of=class extends ue{constructor(){super(...arguments),this._handles=new Ft}initialize(){const e=()=>{var t;return(t=this.view)==null?void 0:t.ready};this._handles.add([cs(()=>!e(),()=>this._disconnect()),cs(e,()=>this._connect())])}destroy(){this._handles&&(this._handles.removeAll(),this._handles=null),this._disconnect()}get latestPointerType(){var e;return(e=this._inputManager)==null?void 0:e.latestPointerType}get latestPointerLocation(){var e;return(e=this._inputManager)==null?void 0:e.latestPointerLocation}get multiTouchActive(){var e;return((e=this._inputManager)==null?void 0:e.multiTouchActive)??!1}_disconnect(){this.view.viewEvents.disconnect(),this._inputManager=Te(this._inputManager)}_connect(){const e=this.view.surface,t=new lN(e,this.view.input),r=[new VW,new UW,new FW,new NW(this.view.navigation),new nme],n=new uc({eventSource:t,recognizers:r});n.installHandlers("prevent-context-menu",[new DW],Yh.INTERNAL),n.installHandlers("navigation",[new Xpe(this.view),new Vpe(this.view),new Wpe(this.view),new gV(this.view),new gV(this.view,[LT.counter]),new Fpe(this.view,"primary"),new Gpe(this.view,LT.pan),new jpe(this.view,LT.zoom),new Hpe(this.view,LT.rotate),new Npe(this.view,"secondary"),new Dpe(this.view,"touch")],Yh.INTERNAL),this.view.viewEvents.connect(n),this._source=t,this._inputManager=n,z(()=>{var s,a;return(a=(s=this.view)==null?void 0:s.navigation)==null?void 0:a.browserTouchPanEnabled},s=>{this._source&&(this._source.browserTouchPanningEnabled=!s)},Qe)}get test(){return{inputManager:this._inputManager}}};h([p()],Of.prototype,"view",void 0),h([p()],Of.prototype,"latestPointerType",null),h([p()],Of.prototype,"latestPointerLocation",null),h([p()],Of.prototype,"multiTouchActive",null),Of=h([D("esri.views.2d.input.MapViewInputManager")],Of);const ame=Of;let ome=0,Cp=class extends ue{constructor(){super(...arguments),this.color=new ei([0,255,255]),this.haloOpacity=1,this.fillOpacity=.25}get version(){return ome++}};h([p({readOnly:!0})],Cp.prototype,"version",null),h([p({type:ei})],Cp.prototype,"color",void 0),h([p({type:ei})],Cp.prototype,"haloColor",void 0),h([p()],Cp.prototype,"haloOpacity",void 0),h([p()],Cp.prototype,"fillOpacity",void 0),Cp=h([D("esri.views.2d.support.HighlightOptions")],Cp);const zW=Cp,lme=i=>i.includes("Brush");let BW=class{constructor(){this._names=new Map}begin(e){this._names.has(e)||(this._names.set(e,!1),lme(e)&&this.record("Esri.FirstDraw"),performance.mark(`Esri.${e}.Start`))}end(e){this._names.has(e)&&!this._names.get(e)&&(this._names.set(e,!0),performance.mark(`Esri.${e}.End`))}record(e){this._names.has(e)||(this._names.set(e,!0),performance.mark(`Esri.${e}`))}};function cme(i,e,t,r,n,s,a,o){let l;i.ignorePadding&&(r={left:0,right:0,top:0,bottom:0}),i.width!=null&&i.height!=null?l=[i.width,i.height]:i.width==null&&i.height!=null?l=[i.height,i.height]:i.width!=null&&i.height==null?l=[i.width,i.width]:i.width==null&&i.height==null&&(l=null);const c=t[0]-(r.left+r.right),u=t[1]-(r.top+r.bottom);let d,m,f=i.area||{x:0,y:0,width:c,height:u};if(l){const _=c/u,g=l[0]/l[1];if(g>_){const x=f.width/g;f={x:f.x,y:Math.round(f.y+(f.height-x)/2),width:f.width,height:Math.round(x)}}else{const x=f.height*g;f={x:Math.round(f.x+(f.width-x)/2),y:f.y,width:Math.round(x),height:f.height}}}else l=[f.width,f.height];return l[0]>f.width?(d=Math.min(l[0]/f.width,e),m=l[0]/f.width/d):(d=1,m=l[0]/f.width),{resolutionScale:d,cropArea:{x:Math.round((f.x+r.left)*d),y:Math.round((f.y+r.top)*d),width:Math.round(f.width*d),height:Math.round(f.height*d)},outputScale:m,format:n,quality:s,children:a,rotation:o}}const xV=2048,hme=1.5,ume=8;function dme(i,e){const{format:t,quality:r,rotation:n,disableDecorations:s}=i||{},a=hN(i,e.padding),o=wme(i,{width:e.width-a.left-a.right,height:e.height-a.top-a.bottom}),{width:l,height:c}=bme(i,o),u=qW(t),d=WW[u];return{format:u,quality:ce(r??d,0,100),area:o,width:l,height:c,rotation:n,disableDecorations:!!s,ignoreBackground:!(!i||!i.ignoreBackground),ignorePadding:!(!i||!i.ignorePadding)}}function pme(i,e){const t=dme(i,e),r=t.area,n=t.width/r.width,s=hN(t,e.padding),a=s.left+s.right,o=s.top+s.bottom,l=e.width-a,c=e.height-o,u=Math.floor(l*n+a),d=Math.floor(c*n+o),m=i&&i.layers?i.layers:[],f=t.ignoreBackground,_=t.ignorePadding;return{framebufferWidth:u,framebufferHeight:d,region:{x:Math.floor(r.x*n)+s.left,y:Math.floor(r.y*n)+s.top,width:t.width,height:t.height},format:t.format,quality:t.quality,rotation:t.rotation,pixelRatio:n,layers:m,disableDecorations:t.disableDecorations,ignoreBackground:f,ignorePadding:_,objectAndLayerIdColor:!1}}function GS(i,e,t){const{ctx:r,canvas:n}=HW(i,t),s=r.getImageData(0,0,i.width,i.height),a=fme(n,e);return jW(n),{dataUrl:a,data:s}}function GW(i,e){const{ctx:t,canvas:r}=HW(i,e),n=t.getImageData(0,0,i.width,i.height);return jW(r),n}function HW(i,e){const t=mme();e.premultipliedAlpha&&Sme(i),t.width=i.width,t.height=i.height;const r=t.getContext("2d");return r.putImageData(i,0,0),e.flipY&&Cme(r),{ctx:r,canvas:t}}function jW(i){i.width=0,i.height=0}function mme(){return S(eO)&&(eO=document.createElement("canvas")),eO}let eO=null;function fme(i,e){const t=Eme[e.format],r=e.quality/100;return i.toDataURL(t,r)}function gme(i,e){const t=qW(i),r=WW[t];return{format:t,quality:ce(e??r,0,100)}}function _me(i,e){return e/Math.max(i[0],i[1])}function yme(i,e,t,r=0,n=0,s=i.width-r,a=i.height-n,o=!1){const{data:l}=i,{width:c,height:u,data:d}=e,m=s/c,f=a/u,_=Math.ceil(m/2),g=Math.ceil(f/2),x=i.width;for(let b=0;b<u;b++)for(let v=0;v<c;v++){const w=4*(v+(o?u-b-1:b)*c);let T=0,E=0,C=0,A=0,M=0,I=0;const L=(b+.5)*f;for(let U=Math.floor(b*f);U<(b+1)*f;U++){const j=Math.abs(L-(U+.5))/g,re=(v+.5)*m,ee=j*j;for(let H=Math.floor(v*m);H<(v+1)*m;H++){const V=Math.abs(re-(H+.5))/_,X=Math.sqrt(ee+V*V);if(X>=1)continue;let $=2*X*X*X-3*X*X+1;const B=4*(r+H+(n+U)*x);I+=$*l[B+3],E+=$,!t&&l[B+3]<255&&($=$*l[B+3]/255),C+=$*l[B],A+=$*l[B+1],M+=$*l[B+2],T+=$}}d[w]=C/T,d[w+1]=A/T,d[w+2]=M/T,d[w+3]=I/E}return e}function vme(i,e,t){if(!e)return i;const{framebufferWidth:r,framebufferHeight:n,pixelRatio:s,region:a}=i,o=hN(i,t),l=o.left+o.right,c=o.top+o.bottom,u=r-l,d=n-c,m=Math.min(ume,Math.min((xV-l)/u,(xV-c)/d));return m<hme?i:{...i,framebufferWidth:Math.round(u*m)+l,framebufferHeight:Math.round(d*m)+c,pixelRatio:s*m,resample:{region:{x:Math.round((a.x-o.left)*m)+o.left,y:Math.round((a.y-o.top)*m)+o.top,width:Math.round(a.width*m),height:Math.round(a.height*m)},width:r,height:n}}}function bme(i,e){if(!i)return e;const t=i.width,r=i.height;if(t!=null&&r!=null)return{width:Math.floor(t),height:Math.floor(r)};if(t==null&&r==null)return e;const n=e.width/e.height;return r==null?{width:Math.floor(t),height:Math.floor(t/n)}:{width:Math.floor(r*n),height:Math.floor(r)}}function wme(i,e){const t={x:0,y:0,width:e.width,height:e.height};if(i&&i.area){i.area.x!=null&&(t.x=Math.floor(i.area.x)),i.area.y!=null&&(t.y=Math.floor(i.area.y));const r=i.area.width!=null?Math.floor(i.area.width):null,n=i.area.height!=null?Math.floor(i.area.height):null;if(t.width=e.width-t.x,t.height=e.height-t.y,r!=null&&n!=null)t.width=Math.min(t.width,r),t.height=Math.min(t.height,n);else if(r==null&&n!=null){const s=Math.min(t.width,r);t.height=s/t.width*t.height,t.width=s}else if(r!=null&&n==null){const s=Math.min(t.height,n);t.width=s/t.height*t.width,t.height=s}}return xme(Tme(t,i),e)}function xme(i,e){const t=Math.floor(Math.max(i.x,0)),r=Math.floor(Math.max(i.y,0)),n={x:t,y:r,width:Math.floor(Math.min(i.width,e.width-t)),height:Math.floor(Math.min(i.height,e.height-r))},s=n.width/n.height,a=i.width/i.height;if(a===s)return n;if(a>s){const c=Math.floor(n.width/a),u=n.height-c;return{x:n.x,y:Math.floor(n.y+u/2),width:n.width,height:c}}const o=Math.floor(n.height*a),l=n.width-o;return{x:Math.floor(n.x+l/2),y:n.y,width:o,height:n.height}}function Tme(i,e){if(!e||e.width==null||e.height==null)return i;const t=e.width/e.height,r=i.width/i.height;if(r===t)return i;if(r<t){const s=Math.floor(i.height*t);return i.x-=(s-i.width)/2,i.width=s,i}const n=Math.floor(i.width/t);return i.y-=(n-i.height)/2,i.height=n,i}function hN(i,e){return!e||i&&i.ignorePadding?Rme:e}function qW(i){switch(i){case"png":case"jpg":case"jpeg":return i;default:return Pme}}function Cme(i){i.save(),i.globalCompositeOperation="copy",i.scale(1,-1),i.translate(0,-i.canvas.height),i.drawImage(i.canvas,0,0),i.restore()}function Sme(i){const e=i.data,t=e.length;for(let r=0;r<t;r+=4){const n=e[r+3];if(n!==255&&n>0){const s=255/n;e[r+0]=e[r+0]*s,e[r+1]=e[r+1]*s,e[r+2]=e[r+2]*s}}}const Eme={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},TV=98,Pme="png",WW={png:100,jpg:TV,jpeg:TV},Rme={top:0,right:0,bottom:0,left:0};function XW(i){const e=Hie(i);if(!e.available)return new K("webgl:required","WebGL is required but not supported.");if(i==="3d"&&e.majorPerformanceCaveat)return new K("webgl:major-performance-caveat-detected","Your WebGL implementation doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist.");if(!e.supportsHighPrecisionFragment)return new K("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported.");if(!e.supportsVertexShaderSamplers)return new K("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported.");if(e.type===Nn.WEBGL1){if(!e.supportsElementIndexUint)return new K("webgl:element-index-uint-required","WebGL support for uint vertex indices is required but not supported.");if(!e.supportsStandardDerivatives)return new K("webgl:standard-derivatives-required","WebGL support for standard derivatives is required but not supported.");if(!e.supportsInstancedArrays)return new K("webgl:instanced-arrays-required","WebGL support for instanced rendering is required but not supported.")}return null}function Ame(i){return i&&"nodeType"in i}function Ome(i){return i&&typeof i.render=="function"}const CV={component:"esri-component"};let Mf=class extends ue{constructor(){super(...arguments),this.widget=null}destroy(){this.widget&&this.widget.destroy(),this.node=null}get id(){return this.get("widget.id")||this.get("node.id")}set node(e){const t=this._get("node");e!==t&&(e&&e.classList.add(CV.component),t&&t.classList.remove(CV.component),this._set("node",e))}castNode(e){return e?typeof e=="string"||Ame(e)?(this._set("widget",null),eD(e)):(Ome(e)&&!e.domNode&&(e.domNode=document.createElement("div")),this._set("widget",e),e.domNode):(this._set("widget",null),null)}};h([p({dependsOn:[]})],Mf.prototype,"id",null),h([p()],Mf.prototype,"node",null),h([qr("node")],Mf.prototype,"castNode",null),h([p({readOnly:!0})],Mf.prototype,"widget",void 0),Mf=h([D("esri.views.ui.Component")],Mf);const HS=Mf,Mme={left:0,top:0,bottom:0,right:0},QW={bottom:30,top:15,right:15,left:15},tO="manual",ea={ui:"esri-ui",corner:"esri-ui-corner",innerContainer:"esri-ui-inner-container",manualContainer:"esri-ui-manual-container",cornerContainer:"esri-ui-corner-container",topLeft:"esri-ui-top-left",topRight:"esri-ui-top-right",bottomLeft:"esri-ui-bottom-left",bottomRight:"esri-ui-bottom-right"};function Ime(i){return i&&!i._started&&typeof i.postMixInProperties=="function"&&typeof i.buildRendering=="function"&&typeof i.postCreate=="function"&&typeof i.startup=="function"}function iO(i){const e=i,t=typeof e=="object"&&e!==null&&Object.getPrototypeOf(e);return(t===null||t===Object.prototype)&&("component"in e||"index"in e||"position"in e)?i:null}function rO(i,{top:e,bottom:t,left:r,right:n}){i.style.top=e,i.style.bottom=t,i.style.left=r,i.style.right=n}let Du=class extends nn.EventedAccessor{constructor(e){super(e),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentToKey=new Map,this._handles=new Ft,this.view=null,this._applyViewPadding=()=>{const t=this.container;t&&rO(t,this._toPxPosition(this._getViewPadding()))},this._applyUIPadding=()=>{const t=this._innerContainer;t&&rO(t,this._toPxPosition(this.padding))},this._initContainers()}initialize(){this._handles.add([z(()=>{var e;return[(e=this.view)==null?void 0:e.padding,this.container]},this._applyViewPadding,Qe),z(()=>this.padding,this._applyUIPadding,Qe)])}destroy(){this.container=null;for(const e of this._components)e.destroy();this._components.length=0,this._handles.destroy(),this._componentToKey.clear()}set container(e){const t=this._get("container");e!==t&&(e&&(e.classList.add(ea.ui),nue(e),this._attachContainers(e)),t&&(t.classList.remove(ea.ui),rO(t,{top:"",bottom:"",left:"",right:""}),A7(t)),this._set("container",e))}get height(){const e=this.get("view.height")||0;if(e===0)return e;const t=this._getViewPadding(),r=t.top+t.bottom;return Math.max(e-r,0)}get padding(){return this._get("padding")}set padding(e){this._overrideIfSome("padding",e)}castPadding(e){return typeof e=="number"?{bottom:e,top:e,right:e,left:e}:{...QW,...e}}get width(){const e=this.get("view.width")||0;if(e===0)return e;const t=this._getViewPadding(),r=t.left+t.right;return Math.max(e-r,0)}add(e,t){let r,n;if(Array.isArray(e))return void e.forEach(a=>this.add(a,t));const s=iO(e);s&&({index:r,position:t,component:e,key:n}=s),t&&typeof t=="object"&&({index:r,key:n,position:t}=t),!e||t&&!this._isValidPosition(t)||this._add(e,t,r,n)}remove(e,t){if(!e)return;if(Array.isArray(e))return e.map(n=>this.remove(n,t));const r=this._find(e);if(r){const n=this._componentToKey;if(n.has(e)&&n.get(e)!==t)return;const s=this._components.indexOf(r);return r.node.parentNode&&r.node.parentNode.removeChild(r.node),this._componentToKey.delete(e),this._components.splice(s,1)[0]}}empty(e){return Array.isArray(e)?e.map(t=>this.empty(t)).reduce((t,r)=>t.concat(r)):(e=e||tO)===tO?Array.prototype.slice.call(this._manualContainer.children).filter(t=>!t.classList.contains(ea.corner)).map(t=>this.remove(t)):this._isValidPosition(e)?Array.prototype.slice.call(this._cornerNameToContainerLookup[e].children).map(this.remove,this):null}move(e,t){if(Array.isArray(e)&&e.forEach(a=>this.move(a,t)),!e)return;let r;const n=iO(e)||iO(t);if(n&&(r=n.index,t=n.position,e=n.component||e),t&&!this._isValidPosition(t))return;const s=this.remove(e);s&&this.add(s,{position:t,index:r})}find(e){if(!e)return null;const t=this._findById(e);return t&&(t.widget||t.node)}getPosition(e){for(const t in this._positionNameToContainerLookup)if(this._positionNameToContainerLookup[t].contains(e))return t;return null}_add(e,t,r,n){e instanceof HS||(e=new HS({node:e})),this._place({component:e,position:t,index:r}),this._components.push(e),n&&this._componentToKey.set(e,n)}_find(e){return e?e instanceof HS?this._findByComponent(e):typeof e=="string"?this._findById(e):this._findByNode(e.domNode||e):null}_getViewPadding(){return this.get("view.padding")||Mme}_attachContainers(e){e.appendChild(this._innerContainer),e.appendChild(this._manualContainer)}_initContainers(){const e=document.createElement("div");e.classList.add(ea.innerContainer),e.classList.add(ea.cornerContainer);const t=document.createElement("div");t.classList.add(ea.innerContainer),t.classList.add(ea.manualContainer);const r=document.createElement("div");r.classList.add(ea.topLeft),r.classList.add(ea.corner),e.appendChild(r);const n=document.createElement("div");n.classList.add(ea.topRight),n.classList.add(ea.corner),e.appendChild(n);const s=document.createElement("div");s.classList.add(ea.bottomLeft),s.classList.add(ea.corner),e.appendChild(s);const a=document.createElement("div");a.classList.add(ea.bottomRight),a.classList.add(ea.corner),e.appendChild(a),this._innerContainer=e,this._manualContainer=t;const o=zh();this._cornerNameToContainerLookup={"top-left":r,"top-right":n,"bottom-left":s,"bottom-right":a,"top-leading":o?n:r,"top-trailing":o?r:n,"bottom-leading":o?a:s,"bottom-trailing":o?s:a},this._positionNameToContainerLookup={manual:t,...this._cornerNameToContainerLookup}}_isValidPosition(e){return!!this._positionNameToContainerLookup[e]}_place(e){const t=e.component,r=e.position||tO,n=e.index,s=this._positionNameToContainerLookup[r],a=n>-1;if(Ime(t.widget)&&t.widget.startup(),!a)return void s.appendChild(t.node);const o=Array.prototype.slice.call(s.children);if(n===0)return void(s.firstChild?h5(t.node,s.firstChild):s.appendChild(t.node));n>=o.length?s.appendChild(t.node):h5(t.node,o[n])}_toPxPosition(e){return{top:this._toPxUnit(e.top),left:this._toPxUnit(e.left),right:this._toPxUnit(e.right),bottom:this._toPxUnit(e.bottom)}}_toPxUnit(e){return e===0?"0":e+"px"}_findByComponent(e){let t,r=null;return this._components.some(n=>(t=n===e,t&&(r=n),t)),r}_findById(e){let t,r=null;return this._components.some(n=>(t=n.id===e,t&&(r=n),t)),r}_findByNode(e){let t,r=null;return this._components.some(n=>(t=n.node===e,t&&(r=n),t)),r}};h([p()],Du.prototype,"container",null),h([p()],Du.prototype,"height",null),h([p({value:QW})],Du.prototype,"padding",null),h([qr("padding")],Du.prototype,"castPadding",null),h([p()],Du.prototype,"view",void 0),h([p()],Du.prototype,"width",null),Du=h([D("esri.views.ui.UI")],Du);const Lme=Du;function SV(i,e){return i&&"copyright"in i&&(!e||typeof i.originOf=="function"&&i.originOf("copyright")==="user")}function $me(i,e){return i.length!==e.length||i.some((t,r)=>t.text!==e[r].text)}function $T(i,e,t){!t||!e||i.find(r=>r.layerView===e&&r.text===t)||i.push({text:t,layerView:e})}function Dme(i){return i.type==="bing-maps"}const Qd=[];let my=class extends tD{constructor(e){super(e),this._clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.handles.remove("suspension"),this.notifyChange("state")},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new pt,this.view=null,this._allLayerViewsChange=t=>{this.handles.remove("suspension");const r=this.get("view.allLayerViews");r&&this.handles.add(r.map(n=>z(()=>{var s;return[n.suspended,(s=n.layer)==null?void 0:s.attributionVisible]},()=>this._updateAttributionItems())),"suspension"),t&&t.removed&&t.removed.forEach(n=>{this._pendingAttributions.delete(n),this._fetchedAttributionData.delete(n)}),this._updateAttributionItems()},this.handles.add([wr(()=>{var t;return(t=this.view)==null?void 0:t.allLayerViews},"change",t=>this._allLayerViewsChange(t),{onListenerAdd:()=>this._allLayerViewsChange(),onListenerRemove:this._clear}),cs(()=>{var t;return((t=this.view)==null?void 0:t.stationary)===!0},()=>this._updateAttributionItems())])}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll()}get state(){return this.get("view.ready")?this._pendingAttributions.size>0?"loading":"ready":"disabled"}_updateAttributionItems(){const e=this.get("view.allLayerViews");Qd.length=0,e?(e.forEach(t=>{var s;if(t.suspended||!((s=t.layer)!=null&&s.attributionVisible))return;const r=t.layer;if(SV(r,"user"))return void $T(Qd,t,r.copyright);if(r.hasAttributionData){if(this._fetchedAttributionData.has(t)){const a=this._fetchedAttributionData.get(t);return void(a?$T(Qd,t,this._getDynamicAttribution(a,this.view,r)):SV(r)&&$T(Qd,t,r.copyright))}return void this._fetchAttributionData(t)}const n=r.get("portalItem.accessInformation");$T(Qd,t,n||r.copyright)}),$me(this.items,Qd)&&(this.items.removeAll(),this.items.addMany(Qd)),Qd.length=0,this.notifyChange("state")):this._clear()}async _fetchAttributionData(e){if(this._pendingAttributions.has(e))return;this._pendingAttributions.add(e);const t=await gw(e.layer.fetchAttributionData());if(this._pendingAttributions.has(e)){const r=t.ok?this._createContributionIndex(t.value,Dme(e.layer)):null;this._pendingAttributions.delete(e),this._fetchedAttributionData.set(e,r)}this._updateAttributionItems()}_createContributionIndex(e,t){const r=e.contributors,n={};if(!r)return n;for(let s=0;s<r.length;s++){const a=r[s],o=a.coverageAreas;if(!o)return;for(const l of o){const c=l.bbox,u=l.zoomMin-(t&&l.zoomMin?1:0),d=l.zoomMax-(t&&l.zoomMax?1:0),m={xmin:c[1],ymin:c[0],xmax:c[3],ymax:c[2],spatialReference:Qt.WGS84},f={extent:_P(m),attribution:a.attribution||"",score:l.score!=null?l.score:100,id:s};for(let _=u;_<=d;_++)n[_]=n[_]||[],n[_].push(f)}}return n.maxKey=Math.max.apply(null,Object.keys(n)),n}_getDynamicAttribution(e,t,r){const{extent:n,scale:s}=t;let a=r.tileInfo.scaleToZoom(s);if(a=Math.min(e.maxKey,Math.round(a)),!n||a==null||a<=-1)return"";const o=e[a],l=J$(n.center.clone().normalize(),t.spatialReference),c={};return o?o.filter(u=>{const d=!c[u.id]&&l&&y7(u.extent,l);return d&&(c[u.id]=!0),d}).sort((u,d)=>d.score-u.score||u.objectId-d.objectId).map(u=>u.attribution).join(", "):""}};h([p({readOnly:!0,type:pt})],my.prototype,"items",void 0),h([p({readOnly:!0})],my.prototype,"state",null),h([p()],my.prototype,"view",void 0),my=h([D("esri.widgets.Attribution.AttributionViewModel")],my);const ZW=my,Zd={base:"esri-attribution esri-widget",poweredBy:"esri-attribution__powered-by",sources:"esri-attribution__sources",open:"esri-attribution--open",sourcesOpen:"esri-attribution__sources--open",link:"esri-attribution__link",widgetIcon:"esri-icon-description",interactive:"esri-interactive"};let ha=class extends Hn{constructor(e,t){super(e,t),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this._resizeObserver=new ResizeObserver(r=>r.forEach(({target:n})=>this._checkSourceTextOverflow(n))),this.iconClass=Zd.widgetIcon,this.itemDelimiter=" | ",this.messages=null,this.viewModel=new ZW}initialize(){this.addHandles(wr(()=>{var e;return(e=this.viewModel)==null?void 0:e.items},"change",()=>this.scheduleRender()))}destroy(){var e;(e=this._resizeObserver)==null||e.disconnect()}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}get attributionText(){return this.viewModel.items.reduce((e,t)=>(e.includes(t.text)||e.push(t.text),e),[]).join(this.itemDelimiter)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e={[Zd.open]:this._isOpen};return F("div",{bind:this,class:this.classes(Zd.base,e),dir:"ltr",onclick:this._toggleState,onkeydown:this._toggleState},this.renderSourcesNode(),this.renderPoweredBy())}renderPoweredBy(){return F("div",{class:Zd.poweredBy},"Powered by"," ",F("a",{class:Zd.link,href:"http://www.esri.com/",target:"_blank",rel:"noreferrer"},"Esri"))}renderSourcesNode(){const e=this._isOpen,t=this._isInteractive,r=t?"0":"",{attributionText:n}=this,s={[Zd.sourcesOpen]:e,[Zd.interactive]:t};return F("div",{afterCreate:this._afterSourcesNodeCreate,bind:this,class:this.classes(Zd.sources,s),innerHTML:n,tabindex:r})}_afterSourcesNodeCreate(e){this._prevSourceNodeHeight=e.clientWidth,this._resizeObserver.observe(e)}_checkSourceTextOverflow(e){let t=!1;const{clientHeight:r,clientWidth:n,scrollWidth:s}=e,a=s>n,o=this._attributionTextOverflowed!==a;if(this._attributionTextOverflowed=a,o&&(t=!0),this._isOpen){const l=r<this._prevSourceNodeHeight;this._prevSourceNodeHeight=r,l&&(this._isOpen=!1,t=!0)}t&&this.scheduleRender()}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen)}};h([p()],ha.prototype,"_isOpen",void 0),h([p()],ha.prototype,"_isInteractive",null),h([p()],ha.prototype,"_attributionTextOverflowed",void 0),h([p()],ha.prototype,"_prevSourceNodeHeight",void 0),h([p({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],ha.prototype,"attributionText",null),h([p()],ha.prototype,"iconClass",void 0),h([p()],ha.prototype,"itemDelimiter",void 0),h([p()],ha.prototype,"label",null),h([p(),_n("esri/widgets/Attribution/t9n/Attribution")],ha.prototype,"messages",void 0),h([p()],ha.prototype,"view",null),h([p({type:ZW})],ha.prototype,"viewModel",void 0),h([Uo()],ha.prototype,"_toggleState",null),ha=h([D("esri.widgets.Attribution")],ha);const Fme=ha,Nme="esri.widgets.CompassViewModel";let If=class extends nW(ue){constructor(e){super(e),this._handles=new Ft,this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this)}initialize(){this._handles.add(z(()=>this.view,this._updateRotationWatcher,Qe))}destroy(){this._handles=Os(this._handles),this.view=null}get canShowNorth(){const e=this.get("view.spatialReference");return!(!e||!e.isWebMercator&&!e.isGeographic)}get state(){return this.get("view.ready")?this.canShowNorth?"compass":"rotation":"disabled"}reset(){if(!this.get("view.ready"))return;const e={};this.view.type==="2d"?e.rotation=0:e.heading=0,this.callGoTo({target:e})}_updateForRotation(e){e!=null&&(this.orientation={z:e})}_updateForCamera(e){if(!e)return;const t=-e.heading;this.orientation={x:0,y:0,z:t}}_updateRotationWatcher(e){this._handles.removeAll(),e&&this._handles.add(e.type==="2d"?z(()=>e==null?void 0:e.rotation,this._updateForRotation,Qe):z(()=>e==null?void 0:e.camera,this._updateForCamera,Qe))}};h([p({readOnly:!0})],If.prototype,"canShowNorth",null),h([p()],If.prototype,"orientation",void 0),h([p({readOnly:!0})],If.prototype,"state",null),h([p()],If.prototype,"view",void 0),If=h([D(Nme)],If);const YW=If,Yd={base:"esri-compass esri-widget--button esri-widget",text:"esri-icon-font-fallback-text",icon:"esri-compass__icon",rotationIcon:"esri-icon-dial",northIcon:"esri-icon-compass",widgetIcon:"esri-icon-locate-circled",interactive:"esri-interactive",disabled:"esri-disabled"};let _h=class extends Hn{constructor(e,t){super(e,t),this.iconClass=Yd.widgetIcon,this.messages=null,this.viewModel=new YW}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}reset(){return this.viewModel.reset()}render(){const{orientation:e,state:t}=this.viewModel,r=t==="disabled",n=(t==="rotation"?"rotation":"compass")=="compass",s=r?-1:0,a={[Yd.disabled]:r,[Yd.interactive]:!r},o={[Yd.northIcon]:n,[Yd.rotationIcon]:!n},{messages:l}=this;return F("div",{bind:this,class:this.classes(Yd.base,a),onclick:this._reset,onkeydown:this._reset,role:"button",tabIndex:s,"aria-label":l.reset,title:l.reset},F("span",{"aria-hidden":"true",class:this.classes(Yd.icon,o),styles:this._toRotationTransform(e)}),F("span",{class:Yd.text},l.reset))}_reset(){this.viewModel.reset()}_toRotationTransform(e){return{transform:`rotateZ(${e.z}deg)`}}};h([p()],_h.prototype,"goToOverride",null),h([p()],_h.prototype,"iconClass",void 0),h([p()],_h.prototype,"label",null),h([p(),_n("esri/widgets/Compass/t9n/Compass")],_h.prototype,"messages",void 0),h([p()],_h.prototype,"view",null),h([p({type:YW})],_h.prototype,"viewModel",void 0),h([Uo()],_h.prototype,"_reset",null),_h=h([D("esri.widgets.Compass")],_h);const kme=_h;let fy=class extends ue{constructor(e){super(e),this.navigationMode="pan",this.view=null}initialize(){this.own(cs(()=>{var e;return(e=this.view)==null?void 0:e.inputManager},()=>this._setNavigationMode()))}destroy(){this.view=null}get state(){return this.get("view.ready")&&this.view.type==="3d"?"ready":"disabled"}toggle(){this.state!=="disabled"&&(this.navigationMode=this.navigationMode!=="pan"?"pan":"rotate",this._setNavigationMode())}_setNavigationMode(){this.get("view.inputManager").primaryDragAction=this.navigationMode==="pan"?"pan":"rotate"}};h([p({readOnly:!0})],fy.prototype,"state",null),h([p()],fy.prototype,"navigationMode",void 0),h([p()],fy.prototype,"view",void 0),fy=h([D("esri.widgets.NavigationToggleViewModel")],fy);const KW=fy,hl={base:"esri-navigation-toggle esri-widget",button:"esri-navigation-toggle__button esri-widget--button",activeButton:"esri-navigation-toggle__button--active",panButton:"esri-navigation-toggle__button--pan",rotateButton:"esri-navigation-toggle__button--rotate",isLayoutHorizontal:"esri-navigation-toggle--horizontal",rotationIcon:"esri-icon-rotate",panIcon:"esri-icon-pan",widgetIcon:"esri-icon-pan2",disabled:"esri-disabled"};let yh=class extends Hn{constructor(e,t){super(e,t),this.iconClass=hl.widgetIcon,this.messages=null,this.viewModel=new KW}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}toggle(){return this.viewModel.toggle()}render(){const e=this.get("viewModel.state")==="disabled",t=this.get("viewModel.navigationMode")==="pan",r={[hl.disabled]:e,[hl.isLayoutHorizontal]:this.layout==="horizontal"},n={[hl.activeButton]:t},s={[hl.activeButton]:!t},a=e?-1:0,o=this.messages.toggle;return F("div",{bind:this,class:this.classes(hl.base,r),onclick:this._toggle,onkeydown:this._toggle,tabIndex:a,"aria-label":o,title:o},F("div",{class:this.classes(hl.button,hl.panButton,n)},F("span",{class:hl.panIcon})),F("div",{class:this.classes(hl.button,hl.rotateButton,s)},F("span",{class:hl.rotationIcon})))}_toggle(){this.toggle()}};h([p()],yh.prototype,"iconClass",void 0),h([p()],yh.prototype,"label",null),h([p({value:"vertical"})],yh.prototype,"layout",null),h([p(),_n("esri/widgets/NavigationToggle/t9n/NavigationToggle")],yh.prototype,"messages",void 0),h([p()],yh.prototype,"view",null),h([p({type:KW})],yh.prototype,"viewModel",void 0),h([Uo()],yh.prototype,"_toggle",null),yh=h([D("esri.widgets.NavigationToggle")],yh);const Vme=yh,Jv={button:"esri-widget--button esri-widget",disabled:"esri-disabled",interactive:"esri-interactive",iconText:"esri-icon-font-fallback-text",icon:"esri-icon"};let Sp=class extends Hn{constructor(){super(...arguments),this.enabled=!0,this.iconClass="",this.title=""}render(){const e=this.enabled?0:-1,t={[Jv.disabled]:!this.enabled,[Jv.interactive]:this.enabled},r={[this.iconClass]:!!this.iconClass};return F("div",{bind:this,class:this.classes(Jv.button,t),onclick:this._triggerAction,onkeydown:this._triggerAction,role:"button",tabIndex:e,title:this.title},F("span",{"aria-hidden":"true",role:"presentation",class:this.classes(Jv.icon,r)}),F("span",{class:Jv.iconText},this.title))}_triggerAction(){this.action.call(this)}};h([p()],Sp.prototype,"action",void 0),h([p()],Sp.prototype,"enabled",void 0),h([p()],Sp.prototype,"iconClass",void 0),h([p()],Sp.prototype,"title",void 0),h([Uo()],Sp.prototype,"_triggerAction",null),Sp=h([D("esri.widgets.IconButton")],Sp);const EV=Sp;let gy=class extends ue{get canZoomIn(){if(!this.get("view.ready"))return!1;const e=this.get("view.animation.target.scale")||this.get("view.scale"),t=this.get("view.constraints.effectiveMaxScale");return t===0||e>t}get canZoomOut(){if(!this.get("view.ready"))return!1;const e=this.get("view.animation.target.scale")||this.get("view.scale"),t=this.get("view.constraints.effectiveMinScale");return t===0||e<t}};h([p({readOnly:!0})],gy.prototype,"canZoomIn",null),h([p({readOnly:!0})],gy.prototype,"canZoomOut",null),h([p()],gy.prototype,"view",void 0),gy=h([D("esri.widgets.Zoom.ZoomConditions2D")],gy);const Ume=gy;let _y=class extends ue{get canZoomIn(){return!!this.view.ready}get canZoomOut(){return!!this.view.ready}};h([p({readOnly:!0})],_y.prototype,"canZoomIn",null),h([p({readOnly:!0})],_y.prototype,"canZoomOut",null),h([p()],_y.prototype,"view",void 0),_y=h([D("esri.widgets.Zoom.ZoomConditions3D")],_y);const zme=_y;let Ep=class extends ue{constructor(e){super(e)}destroy(){this.view=null}get canZoomIn(){return y(this._zoomConditions)&&this._zoomConditions.canZoomIn}get canZoomOut(){var e;return y(this._zoomConditions)&&((e=this._zoomConditions)==null?void 0:e.canZoomOut)}get state(){var e;return(e=this.view)!=null&&e.ready?"ready":"disabled"}set view(e){e?e.type==="2d"?this._zoomConditions=new Ume({view:e}):e.type==="3d"&&(this._zoomConditions=new zme({view:e})):this._zoomConditions=null,this._set("view",e)}zoomIn(){if(!this.canZoomIn)return;const e=this.view;e.type==="2d"?e.mapViewNavigation.zoomIn():Rb(e.goTo({zoomFactor:2}))}zoomOut(){if(!this.canZoomOut)return;const e=this.view;e.type==="2d"?e.mapViewNavigation.zoomOut():Rb(e.goTo({zoomFactor:.5}))}};h([p()],Ep.prototype,"_zoomConditions",void 0),h([p()],Ep.prototype,"canZoomIn",null),h([p()],Ep.prototype,"canZoomOut",null),h([p({readOnly:!0})],Ep.prototype,"state",null),h([p()],Ep.prototype,"view",null),Ep=h([D("esri.widgets.Zoom.ZoomViewModel")],Ep);const JW=Ep,e1={base:"esri-zoom esri-widget",horizontalLayout:"esri-zoom--horizontal",zoomInIcon:"esri-icon-plus",zoomOutIcon:"esri-icon-minus",widgetIcon:"esri-icon-zoom-in-magnifying-glass"};let Fu=class extends Hn{constructor(e,t){super(e,t),this.iconClass=e1.widgetIcon,this.messages=null,this.viewModel=new JW}initialize(){this._zoomInButton=new EV({action:this.zoomIn.bind(this),iconClass:e1.zoomInIcon}),this._zoomOutButton=new EV({action:this.zoomOut.bind(this),iconClass:e1.zoomOutIcon})}destroy(){this._zoomInButton=Te(this._zoomInButton),this._zoomOutButton=Te(this._zoomOutButton)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}set view(e){this.viewModel.view=e}get view(){return this.viewModel.view}render(){const e=this.viewModel,t={[e1.horizontalLayout]:this.layout==="horizontal"},{canZoomIn:r,canZoomOut:n}=e;this._zoomInButton.enabled=r,this._zoomOutButton.enabled=n;const{zoomIn:s,zoomOut:a}=this.messages;return this._zoomInButton.title=s,this._zoomOutButton.title=a,F("div",{class:this.classes(e1.base,t)},this._zoomInButton.render(),this._zoomOutButton.render())}zoomIn(){return this.viewModel.zoomIn()}zoomOut(){return this.viewModel.zoomOut()}};h([p()],Fu.prototype,"iconClass",void 0),h([p()],Fu.prototype,"label",null),h([p({value:"vertical"})],Fu.prototype,"layout",null),h([p(),_n("esri/widgets/Zoom/t9n/Zoom")],Fu.prototype,"messages",void 0),h([p()],Fu.prototype,"view",null),h([p({type:JW})],Fu.prototype,"viewModel",void 0),Fu=h([D("esri.widgets.Zoom")],Fu);const Bme=Fu;function Gme(i){return i&&i.view!==void 0}let jS=class extends Lme{constructor(e){super(e),this._defaultPositionLookup={attribution:"manual",compass:"top-left","navigation-toggle":"top-left",zoom:"top-left"},this.components=[]}initialize(){this._handles.add([z(()=>this.components,this._componentsWatcher.bind(this),Qe),z(()=>this.view,this._updateViewAwareWidgets.bind(this),Qe)])}_add(e,t,r,n){if(typeof e=="string"&&this._defaultPositionLookup[e]){if(this._find(e))return;e=this._createComponent(e)}super._add(e,t,r,n)}_removeComponents(e){e.forEach(t=>{const r=this._find(t);r&&(this.remove(r),r.destroy())})}_updateViewAwareWidgets(e){this.components.forEach(t=>{const r=this._find(t),n=r&&r.widget;Gme(n)&&(n.view=e)})}_componentsWatcher(e,t){this._removeComponents(t),this._addComponents(e),this._adjustPadding(e)}_adjustPadding(e){if(!e.includes("attribution")&&!this._isOverridden("padding")){const{top:t}=this.padding;this.padding=t}}_addComponents(e){this.constructed&&e.forEach(t=>this.add(this._createComponent(t),this._defaultPositionLookup[t]))}_createComponent(e){const t=this._createWidget(e);if(t)return new HS({id:e,node:t})}_createWidget(e){return e==="attribution"?this._createAttribution():e==="compass"?this._createCompass():e==="navigation-toggle"?this._createNavigationToggle():e==="zoom"?this._createZoom():void 0}_createAttribution(){return new Fme({view:this.view})}_createCompass(){return new kme({view:this.view})}_createNavigationToggle(){return new Vme({view:this.view})}_createZoom(){return new Bme({view:this.view})}};h([p()],jS.prototype,"components",void 0),jS=h([D("esri.views.ui.DefaultUI")],jS);const eX=jS;let qS=class extends eX{constructor(e){super(e),this.components=["attribution","zoom"]}};h([p()],qS.prototype,"components",void 0),qS=h([D("esri.views.ui.2d.DefaultUI2D")],qS);const tX=qS;var eL;let WS=eL=class extends mt{constructor(i){super(i),this.color=new ei([0,0,0,1])}clone(){return new eL(Rr({color:this.color}))}};h([p({type:ei,json:{write:!0}})],WS.prototype,"color",void 0),WS=eL=h([D("esri.webmap.background.ColorBackground")],WS);const uR=WS;let iX,rX,nX,sX,aX,oX;async function Hme(){const[,{GraphicsView2D:i,GraphicContainer:e,LabelManager:t,MapViewNavigation:r,MagnifierView2D:n,Stage:s}]=await Promise.all([G(()=>import("./webglDeps-291b9ada.js"),["assets/webglDeps-291b9ada.js","assets/FramebufferObject-a3b9c52c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/typedArrayUtil-4d7bb04c.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/context-util-a4ce3a7b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/Evented-a45c8b0f.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/VertexElementDescriptor-2925c6af.js","assets/ShaderCompiler-77d0dcb6.js","assets/programUtils-f035fe8a.js","assets/ProgramTemplate-cc7f8b69.js","assets/preload-helper-3bce6601.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/vec2-528adfe4.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),G(()=>import("./mapViewDeps-d5a67c12.js"),["assets/mapViewDeps-d5a67c12.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/typedArrayUtil-4d7bb04c.js","assets/promiseUtils-1e54421e.js","assets/reactiveUtils-4dabbb80.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/mat3f32-d3d088e8.js","assets/Rasterizer-dce80cb8.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/_commonjsHelpers-a430e9ea.js","assets/imageutils-c0676a73.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/cimAnalyzer-38842966.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/arcadeOnDemand-281a01eb.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-193543b5.js","assets/jsonUtils-229211af.js","assets/enums-2658a65c.js","assets/alignmentUtils-ae955d28.js","assets/mat2d-2bbb5feb.js","assets/vec2-528adfe4.js","assets/vec2f32-461e65a9.js","assets/number-954e4ab6.js","assets/Rect-ea14f53a.js","assets/callExpressionWithFeature-55effb7b.js","assets/quantizationUtils-4dd81f85.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-9ad35d39.js","assets/rasterizingUtils-ec11e94c.js","assets/utils-317368cb.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/Evented-a45c8b0f.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/enums-4ca4641f.js","assets/MaterialKey-0093a242.js","assets/Utils-69cc114d.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/BufferPool-b74ae6cb.js","assets/WGLContainer-8a3733a0.js","assets/WGLBrushVTLSymbol-d778c554.js","assets/FramebufferObject-a3b9c52c.js","assets/StyleDefinition-ff072275.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/pixelUtils-d9cd2e49.js","assets/ShaderCompiler-77d0dcb6.js","assets/ProgramTemplate-cc7f8b69.js","assets/heatmapTextureUtils-2627384f.js","assets/earcut-58237617.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/VTLMaterialManager-2c63b5e3.js","assets/enums-0fc02184.js","assets/programUtils-f035fe8a.js","assets/MaterialPrograms-b885dd99.js","assets/pbf-0e99a620.js","assets/Matcher-f2620e9f.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/Queue-b7d3cd48.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/enumeration-3a03bd31.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Clonable-545593ce.js","assets/visualVariablesUtils-0d4b5279.js","assets/visualVariablesUtils-ecd70012.js","assets/tileUtils-55e656c2.js","assets/TileClipper-4637f47d.js","assets/assets-8d3e737a.js","assets/Geometry-daada628.js","assets/defaultsJSON-59981e75.js","assets/LRUCache-64ec42ee.js","assets/MemCache-18a255ed.js","assets/ExpandedCIM-b7ed8ce5.js","assets/devEnvironmentUtils-5002a058.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/locale-30120714.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/persistableUrlUtils-5f719c3b.js","assets/styleUtils-22b14a8b.js","assets/CircularArray-f4b6cd92.js","assets/MeshComponent-a43522cc.js","assets/deduplicate-03981d62.js","assets/HandleOwner-9b396af1.js","assets/FeatureSetReader-7e79a15e.js","assets/centroid-5c988df3.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/sizeVariableUtils-d4870b0d.js","assets/BaseGraphicContainer-78fa9e25.js","assets/projectionSupport-aa5eaa0d.js","assets/projection-290b739f.js","assets/SimpleObservable-23231131.js","assets/zscale-89472cba.js","assets/json-48e3ea08.js","assets/labelingInfo-607e66b8.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/fieldUtils-7f54c4b1.js","assets/Symbol-f93ed9fd.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/Collection-910b6f71.js","assets/collectionUtils-803d9ba8.js","assets/labelUtils-3108e8d7.js","assets/jsonUtils-0ff4ff96.js","assets/FeatureContainer-934cc4cc.js","assets/TileContainer-21007653.js","assets/capabilities-302cf20d.js","assets/schemaUtils-9c08f5e8.js","assets/LayerFloorInfo-54b916a2.js","assets/diffUtils-68b89c71.js","assets/createSymbolSchema-36503ad8.js","assets/rendererUtils-0bcb63a1.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/PopupTemplate-40f3c9aa.js","assets/number-27cf8195.js","assets/Identifiable-bfe1ff30.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/colorRamps-9dac42c1.js","assets/Graphic-f0e54e86.js","assets/compilerUtils-18d58939.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/deprecate-035b199e.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/util-4239daf3.js","assets/ComputedAttributeStorage-2b4316ba.js","assets/FieldsIndex-f104cc5f.js","assets/normalizeUtils-27e29a72.js","assets/GraphicsView-d3b9d029.js","assets/vec3f32-c9aa289f.js","assets/GraphicContainer-d62248af.js","assets/asyncUtils-437defc4.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/RelationshipQuery-0dda77ad.js","assets/utils-6786b611.js","assets/ItemCache-fd3aceaf.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/dehydratedFeatures-0557137d.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/SnappingCandidate-970faec6.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])]);rX=i,nX=e,sX=t,aX=r,oX=n,iX=s}const PV=160;function jme(i){return i&&i.declaredClass==="esri.Viewpoint"}let tt=class extends Dq(aW(oW(xW))){constructor(e){super(e),this._magnifierView=null,this._stage=null,this._resolveWhenReady=[],this.rootLayerViews=new mw({getCollections:()=>{var t,r;return[(t=this.basemapView)==null?void 0:t.baseLayerViews,this.layerViews,(r=this.basemapView)==null?void 0:r.referenceLayerViews]},getChildrenFunction:()=>null}),this.featuresTilingScheme=null,this.fullOpacity=1,this.graphicsView=null,this.labelManager=null,this.mapViewNavigation=null,this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.rendering=!1,this.supersampleScreenshotsEnabled=!1,this.supportsGround=!1,this._stationaryTimer=null,this.frameTask=new Rpe(this),this._pePromise=null,this.floors=new pt,this.highlightOptions=new zW,this.inputManager=new ame({view:this}),this.map=null,this.resizeAlign="center",this.spatialReferenceLocked=!1,this.timeline=new BW,this.type="2d",this.ui=new tX,this._pixelFormat={flipY:!0,premultipliedAlpha:!0},this.constraints=new LW,this.padding={top:0,right:0,bottom:0,left:0},this.handles.add([z(()=>this.viewpoint,()=>{this._lastStationaryEventTimestamp=performance.now(),this._flipStationary(PV)},ri),this.on("resize",t=>this._resizeHandler(t)),z(()=>{var t;return(t=this.animationManager)==null?void 0:t.animation},t=>{this.animation=t})]),S7()}destroy(){this._set("preconditionsReady",!1),this._gotoTask=this.frameTask=null,this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null)}get graphicsTileStore(){return new Vie(this.featuresTilingScheme)}get initialExtentRequired(){var o;const{scale:e,constraints:t,center:r,viewpoint:n,extent:s}=this;let a=this.zoom;return!(this.map&&"initialViewProperties"in this.map&&((o=this.map.initialViewProperties)!=null&&o.viewpoint))&&!s&&(t!=null&&t.effectiveLODs||(a=-1),(!r||e===0&&a===-1)&&(!n||!y(n.targetGeometry)||n.targetGeometry.type!=="extent"&&!n.scale))}get resourceManager(){return this._stage.resourceManager}get textureManager(){return this._stage.painter.textureManager}get _defaultsFromMapSettings(){return{required:{tileInfo:!0,heightModelInfo:!1,extent:!1},requiresExtentInSpatialReference:this.spatialReferenceLocked}}get _projectionEngineLoaded(){return!!fw()||(this._pePromise||(this._pePromise=vP().finally(()=>{this._pePromise=null})),!1)}get typeSpecificPreconditionsReady(){const e=this._getDefaultViewpoint();if(!e)return!1;const t=this.spatialReference,r=ct(e.targetGeometry);return!!pv(r.spatialReference,t)||this._projectionEngineLoaded}set animation(e){const t=this._get("animation");if(e===t)return;if(t&&t.stop(),!e||e.isFulfilled())return void this._set("animation",null);this._set("animation",e),this.frameTask.animationInProgress=!0;const r=()=>{var n;e===this._get("animation")&&(this._set("animation",null),(n=this.frameTask)==null||n.requestFrame()),this.frameTask&&(this.frameTask.animationInProgress=!1)};e.when(r,r)}get background(){return qme(this.map)?this.map.initialViewProperties.background:null}set background(e){this._override("background",e)}get center(){if(!this.ready)return this._get("center");const{center:e,spatialReference:t}=this.state.paddedViewState;return new Ne({x:e[0],y:e[1],spatialReference:t})}set center(e){if(e==null)return;if(!this.ready)return this._set("center",e),void this.notifyChange("initialExtentRequired");let t;try{t=this._project(e,this.spatialReference)}catch(n){return void J.getLogger(this.declaredClass).error(new K("mapview:invalid-center","could not project the value in the view's spatial reference",{input:e,error:n}))}const r=this.viewpoint;j3(r,r,t),this.viewpoint=r}set constraints(e){const t=this._get("constraints");t&&(this.handles.remove("map-view-constraints"),t.destroy()),this._set("constraints",e),e&&(e.view=this,this.ready&&(this.state.viewpoint=e.fit(this.state.paddedViewState.viewpoint)),this.handles.add(z(()=>e.version,()=>{this.ready&&this.state&&(this.state.viewpoint=e.fit(this.state.paddedViewState.viewpoint))},ri),"map-view-constraints"))}get extent(){return this.ready?this.state.paddedViewState.extent.clone():this._get("extent")}set extent(e){if(e==null)return;if(!e.width||!e.height)return void J.getLogger(this.declaredClass).error(new K("mapview:invalid-extent","invalid extent size"));if(!this.ready)return this._set("extent",e),this._set("center",null),this._set("viewpoint",null),this._set("scale",0),this._set("zoom",-1),void this.notifyChange("initialExtentRequired");let t;try{t=this._project(e,this.spatialReference)}catch(n){return void J.getLogger(this.declaredClass).error(new K("mapview:invalid-extent","could not project the value in the view's spatial reference",{error:n}))}const r=this.viewpoint;dpe(r,r,t,this.size,{constraints:this.constraints}),this.viewpoint=r}get padding(){return this.ready?this.state.padding:this._get("padding")}set padding(e){this.ready?(this.state.padding=e,this._set("padding",this.state.padding)):this._set("padding",e)}get resolution(){return this.state?this.state.resolution:0}get rotation(){return this.ready?this.state.rotation:this._get("rotation")}set rotation(e){if(isNaN(e))return;if(!this.ready)return void this._set("rotation",e);const t=this.viewpoint;Cpe(t,t,e),this.viewpoint=t}get scale(){return this.ready?this.state.scale:this._get("scale")}set scale(e){if(!e||isNaN(e))return;if(!this.ready){this._set("scale",e),this._set("zoom",-1);const r=this._get("extent");return r&&(this._set("extent",null),this._set("center",r.center)),void this.notifyChange("initialExtentRequired")}const t=this.viewpoint;pV(t,t,e),this.viewpoint=t}get stationary(){return!(this.animation||this.navigating||this.resizing||this._stationaryTimer)}get updating(){var t,r,n;const e=!this.destroyed&&(!this.layerViewManager||!this.labelManager||!this.graphicsView||this.layerViewManager.updating===!0||this.labelManager.updating===!0||this.graphicsView.updating===!0||this.allLayerViews.some(s=>!s.destroyed&&!("layerViews"in s)&&s.updating===!0));if(St("esri-2d-log-updating")){const s=this.allLayerViews.reduce((a,o)=>({...a,[o.layer.id]:!o.destroyed&&!("layerViews"in o)&&o.updating}),{});console.log(`Updating MapView: ${e}
-> Null LayerViewManager: ${!this.layerViewManager}
-> Null LabelManager: ${!this.labelManager}
-> Null GraphicsView: ${!this.graphicsView}
-> layerViewManager.updating: ${(t=this.layerViewManager)==null?void 0:t.updating}
-> labelManager.updating: ${(r=this.labelManager)==null?void 0:r.updating}
-> graphicsView.updating: ${(n=this.graphicsView)==null?void 0:n.updating}
-> allLayerViews: ${JSON.stringify(s)}
`)}return e}get viewpoint(){if(!this.ready)return this._get("viewpoint");const e=this.state.paddedViewState;return e&&e.viewpoint.clone()}set viewpoint(e){if(e==null)return;if(!this.ready)return this._set("viewpoint",e),this._set("extent",null),this._set("center",null),this._set("zoom",-1),this._set("scale",0),void this.notifyChange("initialExtentRequired");let t,r;try{t=this._project(e,this.spatialReference),!e.scale||isNaN(e.scale)?r=new K("mapview:invalid-viewpoint",`invalid scale value of ${e.scale}`):S(e.targetGeometry)&&(r=new K("mapview:invalid-viewpoint","geometry not defined"))}catch(s){r=new K("mapview:invalid-viewpoint","could not project the value in the view's spatial reference",{error:s})}if(r)return void J.getLogger(this.declaredClass).error(r);this._scaleBeforeChangingSpatialReference=null;const n=new rr({targetGeometry:new Ne,scale:0,rotation:0});Xc(n,t),this.constraints.constrain(n,this.state.paddedViewState.viewpoint),this.state.viewpoint=n,this.frameTask.requestFrame(),this._set("viewpoint",n)}get zoom(){return this.ready?this.constraints.scaleToZoom(this.scale):this._get("zoom")}set zoom(e){if(e==null)return;if(!this.ready){this._set("zoom",e),this._set("scale",0);const r=this._get("extent");return r&&(this._set("extent",null),this._set("center",r.center)),void this.notifyChange("initialExtentRequired")}if(!this.constraints.effectiveLODs)return void this._set("zoom",-1);const t=this.viewpoint;pV(t,t,this.constraints.zoomToScale(e)),this.viewpoint=t,this._set("zoom",this.constraints.scaleToZoom(this.scale))}get navigating(){return!(!this.mapViewNavigation||!this.mapViewNavigation.interacting)}goTo(e,t){if(e)return this.animation&&(this.animation=null),this._createAnimation(),Pm(()=>this.ready,t).then(()=>{const r={animate:!0,...t},n=cpe(e,this);return this.animation.update(n),this._gotoTask={},r.animate?this._gotoAnimated(n,r):this._gotoImmediate(n,r)});J.getLogger(this.declaredClass).error("#goTo()","target cannot be null or undefined")}async hitTest(e,t){const r=S2(e)?C2(this,e):e;if(!this.ready||isNaN(r.x)||isNaN(r.y))return{screenPoint:r,results:[]};let n=new Set,s=!1,a=null,o=null;t!=null&&t.include?AV(t.include,RV(this,d=>n.add(d),d=>{a||(a=new Set),a.add(d)},d=>n.add(d),()=>s=!0)):(s=!0,n=new Set(this.allLayerViews)),t!=null&&t.exclude&&AV(t.exclude,RV(this,d=>n.delete(d),d=>{o||(o=new Set),o.add(d)}));const l=this.allLayerViews.filter(d=>!d.suspended&&n.has(d)).reverse(),c=this.toMap(r);let u=[...s?this.graphicsView.hitTest(c).map(d=>({type:"graphic",graphic:d,layer:null,mapPoint:c})):[],...await Promise.all(l.map(d=>d.hitTest(c,r)).toArray())].filter(y).flat().filter(y);return a&&(u=u.filter(d=>!("graphic"in d)||!d.graphic||a.has(tL(d.graphic)))),o&&(u=u.filter(d=>!("graphic"in d)||!d.graphic||o.has(tL(d.graphic)))),{screenPoint:r,results:u}}async takeScreenshot(e){const t=this._createScreenshotPlan(e),r=await this._stage.takeScreenshot(t);return GS(r,{format:t.format,quality:t.quality,rotation:0,disableDecorations:!1},this._pixelFormat)}async _takeScreenshot(e){const t=this._createScreenshotPlan(e),r=await this._stage.takeScreenshot(t);return GW(r,this._pixelFormat)}_createScreenshotPlan(e){e=e||{};const t=this.supersampleScreenshotsEnabled?Math.min(4,_me(this.size,Math.min(4096,this._stage.context.parameters.maxTextureSize))):1;let r;e.layers?(r=[],e.layers.forEach(a=>{const o=this.allLayerViews.find(l=>l.layer.id===a.id);o&&"container"in o&&o.container&&r.push(o.container)})):r=this._stage.children;const{format:n,quality:s}=gme(e.format,e.quality);return cme(e,t,this.size,this.padding,n,s,r,e.rotation)}get test(){return{takeScreenshot:e=>this._takeScreenshot(e)}}toMap(e){if(!this.ready)return null;const t=S2(e)?C2(this,e):e,r=[0,0],[n,s]=this.state.toMap(r,[t.x,t.y]),a=this.spatialReference;return new Ne({x:n,y:s,spatialReference:a})}toScreen(e){if(!this.ready)return null;const t=this._project(e,this.spatialReference),r=[t.x,t.y];return this.state.toScreen(r,r),Ps(r[0],r[1])}on(e,t,r,n){return this.inputManager&&this.viewEvents.on(e,t,r,n)||super.on(e,t)}hasEventListener(e){return super.hasEventListener(e)||this.viewEvents.hasHandler(e)}whenLayerView(e){return super.whenLayerView(e)}graphicChanged(e){this.graphicsView&&this.graphicsView.graphicUpdateHandler(e)}whenReady(){return new Promise(e=>{this.ready?e(this):this._resolveWhenReady.push(e)})}forceDOMReadyCycle(){this.forceReadyCycle()}getDefaultSpatialReference(){var e,t,r;return this.map&&"initialViewProperties"in this.map&&((t=(e=this.map)==null?void 0:e.initialViewProperties)==null?void 0:t.spatialReference)||((r=this.defaultsFromMap)==null?void 0:r.spatialReference)||null}hasLayerViewModule(e){return fV.hasLayerViewModule(e)}importLayerView(e){return fV.importLayerView(e)}pixelSizeAt(){return this.ready?this.state.resolution:(J.getLogger(this.declaredClass).error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}popupHitTest(e){return this.hitTest(e).then(t=>({...t,mapPoint:this.toMap(e)}))}requestUpdate(){this.ready&&this.frameTask.requestUpdate()}validate(){let e=XW(this.type);return St("safari")&&St("safari")<9&&(e=new K("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:St("safari")})),y(e)?(J.getLogger(this.declaredClass).warn("#validate()",e.message),Promise.reject(e)):Hme()}_createAnimation(){return this.animation&&!this.animation.done||(this.animation=new Md),this.animation}_cancellableGoTo(e,t,r){const n=()=>e===this._gotoTask,s=r.then(()=>{n()&&(this.animation=null)}).catch(o=>{throw n()&&(this.animation=null,t.done||(t.stop(),this.frameTask.animationInProgress=!1)),o}),a=new Promise(o=>o(s));return t.when().catch(()=>{n()&&a.cancel&&a.cancel()}),a}_gotoImmediate(e,t){const r=this._gotoTask,n=this.animation,s=e.then(a=>{if(xi(t),r!==this._gotoTask)throw new K("view:goto-interrupted","Goto was interrupted");this.viewpoint=n.target=a,n.finish()});return this._cancellableGoTo(r,n,s)}_flipStationary(e){return this._stationaryTimer!==null||(this._stationaryTimer=setTimeout(()=>{this._stationaryTimer=null;const t=performance.now()-this._lastStationaryEventTimestamp;t<PV&&(this._stationaryTimer=this._flipStationary(t))},e)),this._stationaryTimer}_getDefaultViewpoint(){var b,v,w,T;const{constraints:e,initialExtent:t,map:r,padding:n,size:s}=this;if(!e)return null;const a=r&&"initialViewProperties"in r&&r.initialViewProperties,o={zoom:this._get("zoom"),scale:this._get("scale"),center:this._get("center"),extent:this._get("extent"),rotation:this._get("rotation"),viewpoint:this._get("viewpoint"),spatialReference:this._userSpatialReference};e.effectiveLODs?o.zoom!==-1&&(o.scale=e.zoomToScale(o.zoom)):o.zoom=-1;let l=null,c=null,u=0;const d=o.viewpoint&&o.viewpoint.rotation,m=o.viewpoint&&o.viewpoint.targetGeometry;y(m)&&(m.type==="extent"?l=m:m.type==="point"&&(c=m,u=o.viewpoint.scale));const f=o.extent||l||((v=ct((b=a==null?void 0:a.viewpoint)==null?void 0:b.targetGeometry))==null?void 0:v.extent)||t,_=o.center||c||(f==null?void 0:f.center),g=o.scale||u||((w=a==null?void 0:a.viewpoint)==null?void 0:w.scale)||f&&jb(f,[s[0]-n.left-n.right,s[1]-n.top-n.bottom]),x=o.rotation||d||((T=a==null?void 0:a.viewpoint)==null?void 0:T.rotation)||0;return _&&g?new rr({targetGeometry:_,scale:g,rotation:x}):null}_gotoAnimated(e,t){const r=this._gotoTask,n=this.animation,s=e.then(a=>{if(xi(t),r!==this._gotoTask)throw new K("view:goto-interrupted","Goto was interrupted");return n.update(a),this.animationManager.animate(n,this.viewpoint,t),n.when().then(()=>{},()=>{})});return this._cancellableGoTo(r,n,s)}_project(e,t){var s;const r=e&&e.targetGeometry||e;if(!t)return e;if(!r)return null;if(t.imageCoordinateSystem||(s=r.spatialReference)!=null&&s.imageCoordinateSystem||Bm(t,r.spatialReference))return e;const n=Dd(r,t);if(!n)throw new K("mapview:projection-not-possible","projecting input geometry to target spatial reference returned a null value",{geometry:r,spatialReference:t});return jme(e)?(e.targetGeometry=n,e):n}_resizeHandler(e){if(!this.ready)return;const t=this.state;let r=this.state.paddedViewState.viewpoint;const n=this.state.paddedViewState.size.concat();t.size=[e.width,e.height],Tpe(r,r,n,this.state.paddedViewState.size,this.resizeAlign),r=this.constraints.constrain(r,null),this.state.viewpoint=r}_startup(){var l,c;this.timeline.begin("MapView Startup");const e=this._getDefaultViewpoint(),t=e.targetGeometry;try{this._project(e,this.spatialReference)}catch(u){J.getLogger(this.declaredClass).warn(new n5("mapview:startup-projection-error","projection of initial viewpoint to the view's spatial reference, defaulting to the initial viewpoint.",{center:t.toJSON(),spatialReference:this.spatialReference,error:u})),e.targetGeometry=((l=this.defaultsFromMap.extent)==null?void 0:l.center)||new Ne({x:0,y:0,spatialReference:this.spatialReference})}(c=this.constraints)==null||c.fit(e),this._set("state",new $pe({padding:this._get("padding"),size:this.size,viewpoint:e})),this.graphics.owner=this;const r=new iX(this.surface,{canvas:this.renderCanvas,supersampleScreenshots:this.supersampleScreenshotsEnabled,contextOptions:{disabledExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions},renderingOptions:this.renderingOptions,timeline:this.timeline});this._stage=r,this._magnifierView=new oX,this._magnifierView.magnifier=this.magnifier;const n=new sX({view:this});this._set("labelManager",n);const s=new Ppe({view:this});this._set("animationManager",s);const a=new aX({view:this,animationManager:s});this._set("mapViewNavigation",a),this._setupSpatialReferenceDependentProperties(),this.handles.add([this.rootLayerViews.on("change",()=>this._updateStageChildren()),r.on("post-render",()=>this._set("rendering",r.renderRequested)),r.on("will-render",()=>this._set("rendering",r.renderRequested)),r.on("webgl-error",u=>this.fatalError=u.error),z(()=>this.stationary,u=>r.stationary=u,Oi),z(()=>this.background,u=>{r.background=u,this._magnifierView.background=u},Oi),z(()=>this.magnifier,u=>this._magnifierView.magnifier=u,Oi),z(()=>this.renderingOptions,u=>r.renderingOptions=u,Oi),z(()=>this.highlightOptions,u=>r.highlightOptions=u,Oi),z(()=>this.state.id,()=>r.state=this.state,Oi)],"map-view"),this._updateStageChildren();const o=this._resolveWhenReady;this._resolveWhenReady=[],o.forEach(u=>u(this)),this.timeline.end("MapView Startup"),this.frameTask&&this.frameTask.start(),this._set("ready",!0)}_teardown(){this._destroySpatialReferenceDependentProperties(),this.handles.remove("map-view"),this.mapViewNavigation.destroy(),this._set("mapViewNavigation",null),this.animationManager.destroy(),this._set("animationManager",null),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this._stage.destroy(),this._stage=null,this._set("graphicsView",null),this._magnifierView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,this.frameTask&&this.frameTask.stop(),this._stationaryTimer&&(clearTimeout(this._stationaryTimer),this._stationaryTimer=null),this._set("ready",!1);const{center:[e,t],spatialReference:r,rotation:n,scale:s}=this.state.paddedViewState,a=new Ne({x:e,y:t,spatialReference:r});this._set("viewpoint",null),this._set("extent",null),this._set("center",a),this._set("zoom",-1),this._set("rotation",n),this._set("scale",s),this._set("spatialReference",r),this._set("state",null),this.animation=null}_updateStageChildren(){this._stage.removeAllChildren(),this.rootLayerViews.forEach(t=>{this._stage.addChild(t.container)});const e=this.graphicsView;this._stage.addChild(e.container),this._stage.addChild(this._magnifierView)}_setupSpatialReferenceDependentProperties(){const e=new Uie(Ab.create({spatialReference:this.spatialReference,size:512,numLODs:36}));this._set("featuresTilingScheme",e);const t=new rX({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new nX(e)});this.frameTask.graphicsView=t,this._set("graphicsView",t)}_destroySpatialReferenceDependentProperties(){const e=this.graphicsView;this._set("graphicsView",null),this.frameTask.graphicsView=null,e.destroy(),this._set("featuresTilingScheme",null)}_spatialReferenceChanged(e){if(!this.ready)return;this.frameTask.stop();for(const l of this.allLayerViews)l.processDetach();this._destroySpatialReferenceDependentProperties();const t=this.state.paddedViewState.clone();if(S(this._scaleBeforeChangingSpatialReference))this._scaleBeforeChangingSpatialReference=t.scale;else{const l=t.viewpoint.clone();l.scale=this._scaleBeforeChangingSpatialReference,t.viewpoint=l}const r=t.clone(),[n,s]=t.center;let a=null;try{a=this._project(new Ne({x:n,y:s,spatialReference:t.spatialReference}),e)}catch(l){fw()||J.getLogger(this.declaredClass).warn(new n5("mapview:spatial-reference-change","could not project the view's center to the new spatial reference",{center:a.toJSON(),spatialReference:e,error:l}))}a||(a=new Ne({x:0,y:0,spatialReference:e}));const o=j3(new rr({targetGeometry:new Ne,scale:0,rotation:0}),t.viewpoint,a);r.viewpoint=o;try{const c=[t.size[0]/2,t.size[1]/2],u=[c[0]+20,c[1]],d=t.toMap([0,0],u),{x:m,y:f}=this._project(new Ne({x:d[0],y:d[1],spatialReference:t.spatialReference}),e);d[0]=m,d[1]=f,r.toScreen(d,d);const _=wpe(c,d,u),g=Math.hypot(d[0]-c[0],d[1]-c[1])/20;!Number.isFinite(g)||Math.abs(g)>4?(o.rotation=0,o.targetGeometry=new Ne({x:0,y:0,spatialReference:e})):(o.scale*=g,o.scale>St("mapview-srswitch-adjust-rotation-scale-threshold")?o.rotation=0:o.rotation+=Number.isFinite(_)?_:0)}catch{}this._get("constraints").constrain(o,null),this._get("state").viewpoint=o,this._stage.state=this.state,this._setupSpatialReferenceDependentProperties();for(const l of this.allLayerViews)l.processAttach();this.frameTask.requestFrame(),this.frameTask.start(),this._updateStageChildren()}};tt.type="2d",h([p({readOnly:!0})],tt.prototype,"animationManager",void 0),h([p({constructOnly:!0})],tt.prototype,"deactivatedWebGLExtensions",void 0),h([p({constructOnly:!0})],tt.prototype,"debugWebGLExtensions",void 0),h([p({readOnly:!0})],tt.prototype,"featuresTilingScheme",void 0),h([p({readOnly:!0})],tt.prototype,"fullOpacity",void 0),h([p({readOnly:!0})],tt.prototype,"graphicsTileStore",null),h([p()],tt.prototype,"graphicsView",void 0),h([p({readOnly:!0})],tt.prototype,"state",void 0),h([p()],tt.prototype,"initialExtentRequired",null),h([p()],tt.prototype,"labelManager",void 0),h([p({readOnly:!0})],tt.prototype,"resourceManager",null),h([p({readOnly:!0})],tt.prototype,"textureManager",null),h([p({readOnly:!0})],tt.prototype,"mapViewNavigation",void 0),h([p({constructOnly:!0})],tt.prototype,"renderCanvas",void 0),h([p()],tt.prototype,"renderingOptions",void 0),h([p({readOnly:!0})],tt.prototype,"rendering",void 0),h([p({constructOnly:!0})],tt.prototype,"supersampleScreenshotsEnabled",void 0),h([p({readOnly:!0})],tt.prototype,"supportsGround",void 0),h([p()],tt.prototype,"_stationaryTimer",void 0),h([p()],tt.prototype,"_defaultsFromMapSettings",null),h([p()],tt.prototype,"_pePromise",void 0),h([p({readOnly:!0})],tt.prototype,"typeSpecificPreconditionsReady",null),h([p()],tt.prototype,"animation",null),h([p({type:uR})],tt.prototype,"background",null),h([p({value:null,type:Ne,dependsOn:["state.id","ready"]})],tt.prototype,"center",null),h([p({type:LW})],tt.prototype,"constraints",null),h([p({value:null,type:ui,dependsOn:["state.id","ready"]})],tt.prototype,"extent",null),h([p()],tt.prototype,"floors",void 0),h([p({type:zW})],tt.prototype,"highlightOptions",void 0),h([p({readOnly:!0})],tt.prototype,"inputManager",void 0),h([p()],tt.prototype,"map",void 0),h([p({value:{top:0,right:0,bottom:0,left:0},cast:i=>({top:0,right:0,bottom:0,left:0,...i})})],tt.prototype,"padding",null),h([p()],tt.prototype,"resizeAlign",void 0),h([p({readOnly:!0,dependsOn:["state.id"]})],tt.prototype,"resolution",null),h([p({value:0,type:Number,dependsOn:["state.id","ready"]})],tt.prototype,"rotation",null),h([p({value:0,type:Number,dependsOn:["state.id","ready"]})],tt.prototype,"scale",null),h([p({constructOnly:!0})],tt.prototype,"spatialReferenceLocked",void 0),h([p()],tt.prototype,"stationary",null),h([p({type:BW,readOnly:!0})],tt.prototype,"timeline",void 0),h([p({readOnly:!0})],tt.prototype,"type",void 0),h([p({readOnly:!0})],tt.prototype,"updating",null),h([p({value:null,type:rr,dependsOn:["state.id","ready"]})],tt.prototype,"viewpoint",null),h([p({value:-1,dependsOn:["state.id","ready"]})],tt.prototype,"zoom",null),h([p({readOnly:!0})],tt.prototype,"navigating",null),h([p({type:tX})],tt.prototype,"ui",void 0),tt=h([D("esri.views.MapView")],tt);const lX=tt;function tL(i){var t,r;const e=i.getObjectId();return e?`${((t=i.layer)==null?void 0:t.uid)??((r=i.sourceLayer)==null?void 0:r.uid)??"MapView"}/${e}`:`"MapView/${i.uid}`}function RV(i,e,t,r,n){return s=>{if(s instanceof jc){if(s.layer===i)n==null||n();else{const a=i.allLayerViews.find(o=>o.layer===s.layer);a&&(r==null||r(a))}t(tL(s))}else{const a=i.allLayerViews.find(o=>o.layer===s);a&&e(a)}}}function AV(i,e){if(i)if(eI(i))for(const t of i)if(eI(t))for(const r of t)e(r);else e(t);else e(i)}function qme(i){return(i==null?void 0:i.declaredClass)==="esri.WebMap"}const ko=R(),yy=Or(),nO=Or(),OV=Or();function l0(i,e,t){return Z(ko,e[0],e[1],1),Nl(ko,ko,qc(yy,t)),ko[2]===0?Je(i,ko[0],ko[1]):Je(i,ko[0]/ko[2],ko[1]/ko[2])}function Wme(i,e,t){return MV(nO,e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]),MV(OV,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]),uD(i,Q7(nO,nO),OV)}function MV(i,e,t,r,n,s,a,o,l){_I(i,e,r,s,t,n,a,1,1,1),Z(ko,o,l,1),Q7(yy,i);const[c,u,d]=Nl(ko,ko,qc(yy,yy));return _I(yy,c,0,0,0,u,0,0,0,d),uD(i,yy,i)}let iL=class extends $ee{};iL=h([D("esri.layers.support.GeoreferenceBase")],iL);const dR=iL,Xme=Or(),Jc=be();let j1=class extends ue{constructor(){super(...arguments),this.sourcePoint=null,this.mapPoint=null}};h([p()],j1.prototype,"sourcePoint",void 0),h([p({type:Ne})],j1.prototype,"mapPoint",void 0),j1=h([D("esri.layers.support.ControlPoint")],j1);let Nu=class extends dR{constructor(e){super(e),this.controlPoints=null,this.height=0,this.type="control-points",this.width=0}get coords(){if(S(this.controlPoints))return null;const e=this._updateTransform(Xme);if(S(e)||!vu(this.controlPoints[0]))return null;const t=this.controlPoints[0].mapPoint.spatialReference;return efe(e,this.width,this.height,t)}get inverseTransform(){return S(this.transform)?null:Zg(Or(),this.transform)}get transform(){return this._updateTransform()}toMap(e){if(S(e)||S(this.transform)||S(this.controlPoints)||!vu(this.controlPoints[0]))return null;Je(Jc,e.x,e.y);const t=this.controlPoints[0].mapPoint.spatialReference;return l0(Jc,Jc,this.transform),new Ne({x:Jc[0],y:Jc[1],spatialReference:t})}toSource(e){if(S(e)||S(this.inverseTransform)||S(this.controlPoints)||!vu(this.controlPoints[0]))return null;const t=this.controlPoints[0].mapPoint.spatialReference;return e=e.normalize(),e=OE(e,t).geometry,S(e)?null:(Je(Jc,e.x,e.y),l0(Jc,Jc,this.inverseTransform),Ps(Jc[0],Jc[1]))}_updateTransform(e){const{controlPoints:t,width:r,height:n}=this;if(S(t)||!(r>0)||!(n>0))return null;const[s,a,o,l]=t;if(!vu(s))return null;const c=s.mapPoint.spatialReference,u=this._projectControlPoint(a,c),d=this._projectControlPoint(o,c),m=this._projectControlPoint(l,c);if(!u.valid||!d.valid||!m.valid||!vu(u.controlPoint))return null;S(e)&&(e=Or());let f=null;return f=vu(d.controlPoint)&&vu(m.controlPoint)?Yme(e,s,u.controlPoint,d.controlPoint,m.controlPoint):vu(d.controlPoint)?Zme(e,s,u.controlPoint,d.controlPoint):Qme(e,s,u.controlPoint),f.every(_=>_===0)?null:f}_projectControlPoint(e,t){if(!vu(e))return{valid:!0,controlPoint:e};const{sourcePoint:r,mapPoint:n}=e,{geometry:s,pending:a}=OE(n,t);return a?{valid:!1,controlPoint:null}:a||s?{valid:!0,controlPoint:{sourcePoint:r,mapPoint:s}}:(J.getLogger(this.declaredClass).warn("map point could not be projected to the spatial reference",{georeference:this,controlPoint:e,sourceSpatialReference:n.spatialReference,targetSpatialReference:t}),{valid:!1,controlPoint:null})}};function vu(i){return y(i)&&y(i.sourcePoint)&&y(i.mapPoint)}h([p({type:[j1]})],Nu.prototype,"controlPoints",void 0),h([p({readOnly:!0})],Nu.prototype,"coords",null),h([p()],Nu.prototype,"height",void 0),h([p({readOnly:!0})],Nu.prototype,"inverseTransform",null),h([p({readOnly:!0})],Nu.prototype,"transform",null),h([p()],Nu.prototype,"width",void 0),Nu=h([D("esri.layers.support.ControlPointsGeoreference")],Nu);const cd=be(),hd=be(),vg=be(),am=be(),ud=be(),dd=be(),bg=be(),om=be(),DT=Math.PI/2;function pd(i,e,t){Je(i,t.sourcePoint.x,t.sourcePoint.y),Je(e,t.mapPoint.x,t.mapPoint.y)}function Qme(i,e,t){return pd(cd,ud,e),pd(hd,dd,t),jy(vg,hd,cd,DT),jy(am,cd,hd,DT),jy(bg,dd,ud,-DT),jy(om,ud,dd,-DT),uN(i,cd,hd,vg,am,ud,dd,bg,om)}function Zme(i,e,t,r){return pd(cd,ud,e),pd(hd,dd,t),pd(vg,bg,r),Xf(am,cd,hd,.5),jy(am,vg,am,Math.PI),Xf(om,ud,dd,.5),jy(om,bg,om,Math.PI),uN(i,cd,hd,vg,am,ud,dd,bg,om)}function Yme(i,e,t,r,n){return pd(cd,ud,e),pd(hd,dd,t),pd(vg,bg,r),pd(am,om,n),uN(i,cd,hd,vg,am,ud,dd,bg,om)}const Kme=new Array(8).fill(0),Jme=new Array(8).fill(0);function IV(i,e,t,r,n){return i[0]=e[0],i[1]=e[1],i[2]=t[0],i[3]=t[1],i[4]=r[0],i[5]=r[1],i[6]=n[0],i[7]=n[1],i}function uN(i,e,t,r,n,s,a,o,l){return Wme(i,IV(Kme,e,t,r,n),IV(Jme,s,a,o,l))}function efe(i,e,t,r){const n=Xt(0,t),s=Xt(0,0),a=Xt(e,0),o=Xt(e,t);return l0(n,n,i),l0(s,s,i),l0(a,a,i),l0(o,o,i),new Hm({rings:[[n,s,a,o,n]],spatialReference:r})}const cX=Nu;let Pp=class extends dR{constructor(e){super(e),this.bottomLeft=null,this.bottomRight=null,this.topLeft=null,this.topRight=null,this.type="corners"}get coords(){let{topLeft:e,topRight:t,bottomLeft:r,bottomRight:n}=this;if(S(e)||S(t)||S(r)||S(n))return null;const s=e.spatialReference;return t=this._projectCorner(t,s),r=this._projectCorner(r,s),n=this._projectCorner(n,s),S(t)||S(r)||S(n)?null:new Hm({rings:[[[r.x,r.y],[e.x,e.y],[t.x,t.y],[n.x,n.y],[r.x,r.y]]],spatialReference:s})}_projectCorner(e,t){if(S(e))return e;const{geometry:r,pending:n}=OE(e,t);return n?null:n||r?r:(J.getLogger(this.declaredClass).warn("map point could not be projected to the spatial reference",{georeference:this,point:e,sourceSpatialReference:e.spatialReference,targetSpatialReference:t}),null)}};h([p({readOnly:!0})],Pp.prototype,"coords",null),h([p({type:Ne})],Pp.prototype,"bottomLeft",void 0),h([p({type:Ne})],Pp.prototype,"bottomRight",void 0),h([p({type:Ne})],Pp.prototype,"topLeft",void 0),h([p({type:Ne})],Pp.prototype,"topRight",void 0),Pp=h([D("esri.layers.support.CornersGeoreference")],Pp);const hX=Pp;let vy=class extends dR{constructor(e){super(e),this.extent=null,this.rotation=0,this.type="extent-and-rotation"}get coords(){if(S(this.extent))return null;const{xmin:e,ymin:t,xmax:r,ymax:n,spatialReference:s}=this.extent;let a;if(this.rotation){const{x:o,y:l}=this.extent.center,c=tfe(o,l,this.rotation);a=[c(e,t),c(e,n),c(r,n),c(r,t)],a.push(a[0])}else a=[[e,t],[e,n],[r,n],[r,t],[e,t]];return new Hm({rings:[a],spatialReference:s})}};function tfe(i,e,t){const r=SP(t),n=Math.cos(r),s=Math.sin(r);return(a,o)=>[n*(a-i)+s*(o-e)+i,n*(o-e)-s*(a-i)+e]}h([p({readOnly:!0})],vy.prototype,"coords",null),h([p({type:ui})],vy.prototype,"extent",void 0),h([p({type:Number})],vy.prototype,"rotation",void 0),vy=h([D("esri.layers.support.ExtentAndRotationGeoreference")],vy);const E2=vy,ife={key:"type",base:dR,typeMap:{"control-points":cX,corners:hX,"extent-and-rotation":E2}};let q1=class extends TP(Am){constructor(){super(...arguments),this.georeference=null,this.opacity=1}};h([p({types:ife})],q1.prototype,"georeference",void 0),h([p()],q1.prototype,"opacity",void 0),q1=h([D("esri.layers.support.MediaElementBase")],q1);const dN=q1;let W1=class extends dN{constructor(e){super(e),this.content=null,this.type="image",this.image=null}load(){const e=this.image;if(typeof e=="string"){const t=Wh(e,{responseType:"image"}).then(({data:r})=>{this._set("content",r)});this.addResolvingPromise(t)}else if(e instanceof HTMLImageElement){const t=e.decode().then(()=>{this._set("content",e)});this.addResolvingPromise(t)}else e?this._set("content",e):this.addResolvingPromise(Promise.reject(new K("image-element:invalid-image-type","Invalid image type",{image:e})));return Promise.resolve(this)}set image(e){this.loadStatus==="not-loaded"?this._set("image",e):J.getLogger(this.declaredClass).error("#image","image cannot be changed after the element is loaded.")}};h([p({readOnly:!0})],W1.prototype,"content",void 0),h([p()],W1.prototype,"image",null),W1=h([D("esri.layers.support.ImageElement")],W1);const X1=W1;function rfe(i){return uX(i,!0)}function Qke(i){return uX(i,!1)}function uX(i,e){if(S(i))return null;const t=i.spatialReference,r=_7(t),n="toJSON"in i?i.toJSON():i;if(!r)return n;const s=Xee(t)?102100:4326,a=d5[s].maxX,o=d5[s].minX;if(tte(n))return LV(n,a,o);if(ite(n))return n.points=n.points.map(l=>LV(l,a,o)),n;if(rte(n))return nfe(n,r);if(nte(n)||w7(n)){const l=aie(afe,n),c={xmin:l[0],ymin:l[1],xmax:l[2],ymax:l[3]},u=L1(c.xmin,o)*(2*a),d=u===0?n:hie(n,u);return c.xmin+=u,c.xmax+=u,c.xmax>a?DV(d,a,e):c.xmin<o?DV(d,o,e):d}return n}function nfe(i,e){if(!e)return i;const t=sfe(i,e).map(r=>r.extent);return t.length<2?t[0]||i:t.length>2?(i.xmin=e.valid[0],i.xmax=e.valid[1],i):{rings:t.map(r=>[[r.xmin,r.ymin],[r.xmin,r.ymax],[r.xmax,r.ymax],[r.xmax,r.ymin],[r.xmin,r.ymin]])}}function LV(i,e,t){if(Array.isArray(i)){const r=i[0];if(r>e){const n=L1(r,e);i[0]=r+n*(-2*e)}else if(r<t){const n=L1(r,t);i[0]=r+n*(-2*t)}}else{const r=i.x;if(r>e){const n=L1(r,e);i.x+=n*(-2*e)}else if(r<t){const n=L1(r,t);i.x+=n*(-2*t)}}return i}function sfe(i,e){const t=[],{ymin:r,ymax:n,xmin:s,xmax:a}=i,o=i.xmax-i.xmin,[l,c]=e.valid,{x:u,frameId:d}=$V(i.xmin,e),{x:m,frameId:f}=$V(i.xmax,e),_=u===m&&o>0;if(o>2*c){const g={xmin:s<a?u:m,ymin:r,xmax:c,ymax:n},x={xmin:l,ymin:r,xmax:s<a?m:u,ymax:n},b={xmin:0,ymin:r,xmax:c,ymax:n},v={xmin:l,ymin:r,xmax:0,ymax:n},w=[],T=[];FT(g,b)&&w.push(d),FT(g,v)&&T.push(d),FT(x,b)&&w.push(f),FT(x,v)&&T.push(f);for(let E=d+1;E<f;E++)w.push(E),T.push(E);t.push(new Km(g,[d]),new Km(x,[f]),new Km(b,w),new Km(v,T))}else u>m||_?t.push(new Km({xmin:u,ymin:r,xmax:c,ymax:n},[d]),new Km({xmin:l,ymin:r,xmax:m,ymax:n},[f])):t.push(new Km({xmin:u,ymin:r,xmax:m,ymax:n},[d]));return t}function $V(i,e){const[t,r]=e.valid,n=2*r;let s,a=0;return i>r?(s=Math.ceil(Math.abs(i-r)/n),i-=s*n,a=s):i<t&&(s=Math.ceil(Math.abs(i-t)/n),i+=s*n,a=-s),{x:i,frameId:a}}function FT(i,e){const{xmin:t,ymin:r,xmax:n,ymax:s}=e;return NT(i,t,r)&&NT(i,t,s)&&NT(i,n,s)&&NT(i,n,r)}function NT(i,e,t){return e>=i.xmin&&e<=i.xmax&&t>=i.ymin&&t<=i.ymax}function DV(i,e,t=!0){const r=!w7(i);if(r&&oie(i),t)return new ofe().cut(i,e);const n=r?i.rings:i.paths,s=r?4:2,a=n.length,o=-2*e;for(let l=0;l<a;l++){const c=n[l];if(c&&c.length>=s){const u=[];for(const d of c)u.push([d[0]+o,d[1]]);n.push(u)}}return r?i.rings=n:i.paths=n,i}let Km=class{constructor(e,t){this.extent=e,this.frameIds=t}};const afe=$t();let ofe=class{constructor(){this._linesIn=[],this._linesOut=[]}cut(e,t){let r;if(this._xCut=t,e.rings)this._closed=!0,r=e.rings,this._minPts=4;else{if(!e.paths)return null;this._closed=!1,r=e.paths,this._minPts=2}for(const s of r){if(!s||s.length<this._minPts)continue;let a=!0;for(const o of s)a?(this.moveTo(o),a=!1):this.lineTo(o);this._closed&&this.close()}this._pushLineIn(),this._pushLineOut(),r=[];for(const s of this._linesIn)s&&s.length>=this._minPts&&r.push(s);const n=-2*this._xCut;for(const s of this._linesOut)if(s&&s.length>=this._minPts){for(const a of s)a[0]+=n;r.push(s)}return this._closed?e.rings=r:e.paths=r,e}moveTo(e){this._pushLineIn(),this._pushLineOut(),this._prevSide=this._side(e[0]),this._moveTo(e[0],e[1],this._prevSide),this._prevPt=e,this._firstPt=e}lineTo(e){const t=this._side(e[0]);if(t*this._prevSide==-1){const r=this._intersect(this._prevPt,e);this._lineTo(this._xCut,r,0),this._prevSide=0,this._lineTo(e[0],e[1],t)}else this._lineTo(e[0],e[1],t);this._prevSide=t,this._prevPt=e}close(){const e=this._firstPt,t=this._prevPt;e[0]===t[0]&&e[1]===t[1]||this.lineTo(e),this._checkClosingPt(this._lineIn),this._checkClosingPt(this._lineOut)}_moveTo(e,t,r){this._closed?(this._lineIn.push([r<=0?e:this._xCut,t]),this._lineOut.push([r>=0?e:this._xCut,t])):(r<=0&&this._lineIn.push([e,t]),r>=0&&this._lineOut.push([e,t]))}_lineTo(e,t,r){this._closed?(this._addPolyVertex(this._lineIn,r<=0?e:this._xCut,t),this._addPolyVertex(this._lineOut,r>=0?e:this._xCut,t)):r<0?(this._prevSide===0&&this._pushLineOut(),this._lineIn.push([e,t])):r>0?(this._prevSide===0&&this._pushLineIn(),this._lineOut.push([e,t])):this._prevSide<0?(this._lineIn.push([e,t]),this._lineOut.push([e,t])):this._prevSide>0&&(this._lineOut.push([e,t]),this._lineIn.push([e,t]))}_addPolyVertex(e,t,r){const n=e.length;n>1&&e[n-1][0]===t&&e[n-2][0]===t?e[n-1][1]=r:e.push([t,r])}_checkClosingPt(e){const t=e.length;t>3&&e[0][0]===this._xCut&&e[t-2][0]===this._xCut&&e[1][0]===this._xCut&&(e[0][1]=e[t-2][1],e.pop())}_side(e){return e<this._xCut?-1:e>this._xCut?1:0}_intersect(e,t){const r=(this._xCut-e[0])/(t[0]-e[0]);return e[1]+r*(t[1]-e[1])}_pushLineIn(){this._lineIn&&this._lineIn.length>=this._minPts&&this._linesIn.push(this._lineIn),this._lineIn=[]}_pushLineOut(){this._lineOut&&this._lineOut.length>=this._minPts&&this._linesOut.push(this._lineOut),this._lineOut=[]}},ku=class extends ue{constructor(e){super(e)}get bounds(){const e=this.coords;return S(e)||S(e.extent)?null:_w(e.extent)}get coords(){var t;const e=(t=ct(this.element.georeference))==null?void 0:t.coords;return OE(e,this.spatialReference).geometry}get normalizedCoords(){return Hm.fromJSON(rfe(this.coords))}get normalizedBounds(){const e=y(this.normalizedCoords)?this.normalizedCoords.extent:null;return y(e)?_w(e):null}};h([p()],ku.prototype,"spatialReference",void 0),h([p()],ku.prototype,"element",void 0),h([p()],ku.prototype,"bounds",null),h([p()],ku.prototype,"coords",null),h([p()],ku.prototype,"normalizedCoords",null),h([p()],ku.prototype,"normalizedBounds",null),ku=h([D("esri.layers.support.media.MediaElementView")],ku);let Q1=class extends dN{constructor(e){super(e),this.content=null,this.type="video"}load(){const e=this.video;if(typeof e=="string"){const t=document.createElement("video");t.src=e,t.crossOrigin="anonymous",t.autoplay=!0,t.muted=!0,t.loop=!0,this.addResolvingPromise(this._loadVideo(t).then(()=>{this._set("content",t)}))}else e instanceof HTMLVideoElement?this.addResolvingPromise(this._loadVideo(e).then(()=>{this._set("content",e)})):this.addResolvingPromise(Promise.reject(new K("video-element:invalid-video-type","Invalid video type",{video:e})));return Promise.resolve(this)}set video(e){this.loadStatus==="not-loaded"?this._set("video",e):J.getLogger(this.declaredClass).error("#video","video cannot be changed after the element is loaded.")}_loadVideo(e){return new Promise((t,r)=>{e.oncanplay=()=>{e.oncanplay=null,e.play().then(t,r)},e.crossOrigin!=="anonymous"&&(e.crossOrigin="anonymous",e.src=e.src)})}};h([p({readOnly:!0})],Q1.prototype,"content",void 0),h([p()],Q1.prototype,"video",null),Q1=h([D("esri.layers.support.VideoElement")],Q1);const dX=Q1,lfe={key:"type",defaultKeyValue:"image",base:dN,typeMap:{image:X1,video:dX}},FV=pt.ofType(lfe);let by=class extends Am.LoadableMixin(cD(Lx(nn.EventedAccessor))){constructor(e){super(e),this._index=new Jie,this._elementViewsMap=new Map,this._elementsIndexes=new Map,this._elementsChangedHandler=t=>{for(const n of t.removed){const s=this._elementViewsMap.get(n);this._elementViewsMap.delete(n),this._index.delete(s),this.handles.remove(s),s.destroy(),this.notifyChange("fullExtent")}const{spatialReference:r}=this;for(const n of t.added){if(this._elementViewsMap.get(n))continue;const s=new ku({spatialReference:r,element:n});this._elementViewsMap.set(n,s);const a=z(()=>s.bounds,()=>this._updateIndexForElement(s,!1));this._updateIndexForElement(s,!0),this.handles.add(a,s)}this._elementsIndexes.clear(),this.elements.forEach((n,s)=>this._elementsIndexes.set(n,s)),this.emit("refresh")},this.elements=new FV}async load(e){if(xi(e),!this.spatialReference){const t=this.elements.find(r=>y(r.georeference)&&y(r.georeference.coords));this._set("spatialReference",t?ct(ct(t.georeference).coords).spatialReference:Qt.WGS84)}return this._elementsChangedHandler({added:this.elements.items,removed:[]}),this.handles.add(this.elements.on("change",this._elementsChangedHandler)),this}destroy(){this._index.clear(),this._elementViewsMap.clear(),this._elementsIndexes.clear()}set elements(e){this._set("elements",B7(e,this._get("elements"),FV))}get fullExtent(){if(this.loadStatus==="not-loaded")return null;const e=this._index.fullBounds;return S(e)?null:new ui({xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:this.spatialReference})}set spatialReference(e){this.loadStatus==="not-loaded"?this._set("spatialReference",e):J.getLogger(this.declaredClass).error("#spatialReference","spatialReference cannot be changed after the source is loaded.")}async queryElements(e,t){await this.load(),await ute(e.spatialReference,this.spatialReference,null,t);const r=Bm(e.spatialReference,this.spatialReference)?e:Dd(e,this.spatialReference);if(!r)return[];const n=r.normalize(),s=[];for(const a of n)this._index.forEachInBounds(_w(a),({normalizedCoords:o,element:l})=>{y(o)&&Qee(a,o)&&s.push(l)});return s.sort((a,o)=>this._elementsIndexes.get(a)-this._elementsIndexes.get(o)),s}_updateIndexForElement(e,t){const r=e.normalizedBounds,n=this._index.has(e),s=y(r);this._index.delete(e),s&&this._index.set(e,r),this.notifyChange("fullExtent"),t||n===s||this.emit("refresh")}};h([p()],by.prototype,"elements",null),h([p({readOnly:!0})],by.prototype,"fullExtent",null),h([p()],by.prototype,"spatialReference",null),by=h([D("esri.layers.support.LocalMediaElementSource")],by);const NV=by;let vh=class extends qie(Wie(uI)){constructor(e){super(e),this.copyright=null,this.spatialReference=null,this.type="media",this.source=new NV}load(e){this.spatialReference&&(this.source.spatialReference=this.spatialReference);const t=this.source.load(e).then(()=>{this.spatialReference=this.source.spatialReference});return this.addResolvingPromise(t),Promise.resolve(this)}destroy(){var e;(e=ct(this.source))==null||e.destroy()}get fullExtent(){var e;return(e=this.source)==null?void 0:e.fullExtent}set source(e){this.loadStatus==="not-loaded"?this._set("source",e):J.getLogger(this.declaredClass).error("#source","source cannot be changed after the layer is loaded.")}castSource(e){return e?Array.isArray(e)||e instanceof pt?new NV({elements:e}):e:null}};h([p({type:String})],vh.prototype,"copyright",void 0),h([p({readOnly:!0})],vh.prototype,"fullExtent",null),h([p({type:["show","hide"]})],vh.prototype,"listMode",void 0),h([p({nonNullable:!0})],vh.prototype,"source",null),h([qr("source")],vh.prototype,"castSource",null),h([p()],vh.prototype,"spatialReference",void 0),h([p({readOnly:!0})],vh.prototype,"type",void 0),vh=h([D("esri.layers.MediaLayer")],vh);const pX=vh;let Rp=class extends ue{constructor(e){super(e),this._viewpointHandle=null,this._handles=new Ft,this.group=null}initialize(){this._handles.add(wr(()=>{var e;return(e=this.view)==null?void 0:e.ui},"expand",e=>{const{target:t}=e;t&&t!==this&&t.expanded&&t.group&&t.group===this.group&&this._collapse()}))}destroy(){this._viewpointHandle=null,this.view=null,this._handles.destroy(),this._handles=null}set autoCollapse(e){this._set("autoCollapse",e),this._watchViewpoint()}set expanded(e){const t=!!e;this._set("expanded",t);const r=this.get("view.ui");r&&r.emit("expand",{target:this}),this._viewpointHandleChange(t)}get state(){return this.get("view.ready")?"ready":"disabled"}set view(e){this._get("view")!==e&&(this._set("view",e),e&&cs(()=>e.ready,()=>{this.view===e&&this._watchViewpoint()},{once:!0,initial:!0}))}_viewpointHandleChange(e){this._viewpointHandle&&(e?cs(()=>this.view.stationary,()=>this._viewpointHandle.resume(),{once:!0,initial:!0}):this._viewpointHandle.pause())}_watchViewpoint(){const e="viewpoint";this._handles.remove(e),this._viewpointHandle=null;const{autoCollapse:t,view:r}=this;if(r&&t){const n=hte(()=>r.type==="3d"?r.camera:r.viewpoint,()=>this._collapse());this._handles.add(n,e),this._viewpointHandle=n}}_collapse(){this.expanded=!1}};h([p({value:!1})],Rp.prototype,"autoCollapse",null),h([p({value:!1})],Rp.prototype,"expanded",null),h([p()],Rp.prototype,"group",void 0),h([p({readOnly:!0})],Rp.prototype,"state",null),h([p({value:null})],Rp.prototype,"view",null),Rp=h([D("esri.widgets.Expand.ExpandViewModel")],Rp);const mX=Rp,ln={base:"esri-expand esri-widget",modeAuto:"esri-expand--auto",modeDrawer:"esri-expand--drawer",modeFloating:"esri-expand--floating",container:"esri-expand__container",containerExpanded:"esri-expand__container--expanded",panel:"esri-expand__panel",button:"esri-widget--button",text:"esri-icon-font-fallback-text",icon:"esri-collapse__icon",iconExpanded:"esri-expand__icon--expanded",iconNumber:"esri-expand__icon-number",iconNumberExpanded:"esri-expand__icon-number--expanded",expandIcon:"esri-icon-expand",collapseIcon:"esri-icon-collapse",content:"esri-expand__content",contentExpanded:"esri-expand__content--expanded",expandMask:"esri-expand__mask",expandMaskExpanded:"esri-expand__mask--expanded"};let Dr=class extends Hn{constructor(e,t){super(e,t),this.closeOnEsc=!0,this.collapseTooltip="",this.content="",this.expandTooltip="",this.iconNumber=0,this.messages=null,this.messagesCommon=null,this.mode="auto",this.viewModel=new mX,this._handleKeyDown=r=>{const{closeOnEsc:n,_toggleButtonEl:s,expanded:a}=this;!a||!n||r.target===s||r.key!=="Escape"||(typeof n=="function"?n(r):n)&&(this.expanded=!1,s==null||s.focus())}}get contentId(){return`${this.id}_controls_content`}get expandTitle(){const{expanded:e,messagesCommon:t,collapseTooltip:r,expandTooltip:n}=this;return e?r||t.collapse:n||t.expand}get autoCollapse(){return this.viewModel.autoCollapse}set autoCollapse(e){this.viewModel.autoCollapse=e}get collapseIconClass(){return ln.collapseIcon}set collapseIconClass(e){this._overrideIfSome("collapseIconClass",e)}get expanded(){return this.viewModel.expanded}set expanded(e){this.viewModel.expanded=e}get expandIconClass(){return IE(this.content)?this.content.iconClass:ln.expandIcon}set expandIconClass(e){this._overrideIfSome("expandIconClass",e)}get group(){return this.viewModel.group}set group(e){this.viewModel.group=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}expand(){this.viewModel.expanded=!0}collapse(){this.viewModel.expanded=!1}toggle(){this.viewModel.expanded=!this.viewModel.expanded}render(){const{mode:e}=this,t={[ln.modeAuto]:e==="auto",[ln.modeDrawer]:e==="drawer",[ln.modeFloating]:e==="floating"};return F("div",{class:this.classes(ln.base,t),onkeydown:this._handleKeyDown},this.renderMask(),this.renderContainer())}renderContainer(){const{expanded:e}=this,t={[ln.containerExpanded]:e};return F("div",{class:this.classes(ln.container,t)},this.renderPanel(),this.renderContent())}renderMask(){const{expanded:e}=this,t={[ln.expandMaskExpanded]:e};return F("div",{bind:this,onclick:this._toggle,class:this.classes(ln.expandMask,t)})}renderBadgeNumber(){const{expanded:e,iconNumber:t}=this;return t&&!e?F("span",{key:"expand__icon-number",class:ln.iconNumber},t):null}renderPanelNumber(){const{iconNumber:e,expanded:t}=this;return e&&t?F("span",{key:"expand__expand-icon-number",class:this.classes(ln.iconNumber,ln.iconNumberExpanded)},e):null}renderIcon(){const{collapseIconClass:e,expandIconClass:t,expanded:r}=this,n={[ln.iconExpanded]:r,[e]:r,[t]:!r};return e===t&&(n[e]=!0),F("span",{"aria-hidden":"true",class:this.classes(ln.icon,n)})}renderTitle(){return F("span",{class:ln.text},this.expandTitle)}renderExpandButton(){const{expanded:e,expandTitle:t,contentId:r}=this;return F("div",{afterCreate:this._storeToggleButtonEl,"aria-controls":r,"aria-expanded":e?"true":"false",bind:this,class:ln.button,onclick:this._toggle,onkeydown:this._toggle,role:"button",tabindex:"0",title:t},this.renderBadgeNumber(),this.renderIcon(),this.renderTitle())}renderPanel(){return F("div",{class:ln.panel},this.renderExpandButton(),this.renderPanelNumber())}renderContent(){const{expanded:e,contentId:t,content:r}=this,n={[ln.contentExpanded]:e},s={id:t,role:"region",class:this.classes(ln.content,n)};return typeof r=="string"?F("div",{key:"content__string",innerHTML:r,...s}):IE(r)?F("div",{key:"content__widget",...s},r.render()):r instanceof HTMLElement?F("div",{key:"content__html-element",bind:r,afterCreate:this._attachToNode,...s}):R7(r)?F("div",{key:"content__node",bind:r.domNode,afterCreate:this._attachToNode,...s}):null}_toggle(){this.toggle()}_attachToNode(e){const t=this;e.appendChild(t)}_storeToggleButtonEl(e){this._toggleButtonEl=e}};h([p({readOnly:!0})],Dr.prototype,"contentId",null),h([p({readOnly:!0})],Dr.prototype,"expandTitle",null),h([p()],Dr.prototype,"autoCollapse",null),h([p()],Dr.prototype,"closeOnEsc",void 0),h([p()],Dr.prototype,"collapseIconClass",null),h([p()],Dr.prototype,"collapseTooltip",void 0),h([p()],Dr.prototype,"content",void 0),h([p()],Dr.prototype,"expanded",null),h([p()],Dr.prototype,"expandIconClass",null),h([p()],Dr.prototype,"expandTooltip",void 0),h([p()],Dr.prototype,"group",null),h([p()],Dr.prototype,"iconNumber",void 0),h([p()],Dr.prototype,"label",null),h([p(),_n("esri/widgets/Expand/t9n/Expand")],Dr.prototype,"messages",void 0),h([p(),_n("esri/t9n/common")],Dr.prototype,"messagesCommon",void 0),h([p()],Dr.prototype,"mode",void 0),h([p()],Dr.prototype,"view",null),h([p({type:mX})],Dr.prototype,"viewModel",void 0),h([Uo()],Dr.prototype,"_toggle",null),Dr=h([D("esri.widgets.Expand")],Dr);const Z1=Dr;let XS=class extends mt{get version(){return this.commitVersionProperties(),(this._get("version")||0)+1}};h([p({readOnly:!0})],XS.prototype,"version",null),XS=h([D("esri.views.layers.support.ClipArea")],XS);const cfe=XS;var rL;let Lf=rL=class extends cfe{constructor(i){super(i),this.type="rect",this.left=null,this.right=null,this.top=null,this.bottom=null}clone(){return new rL({left:this.left,right:this.right,top:this.top,bottom:this.bottom})}commitVersionProperties(){this.commitProperty("left"),this.commitProperty("right"),this.commitProperty("top"),this.commitProperty("bottom")}};h([p({type:[Number,String],json:{write:!0}})],Lf.prototype,"left",void 0),h([p({type:[Number,String],json:{write:!0}})],Lf.prototype,"right",void 0),h([p({type:[Number,String],json:{write:!0}})],Lf.prototype,"top",void 0),h([p({type:[Number,String],json:{write:!0}})],Lf.prototype,"bottom",void 0),Lf=rL=h([D("esri.views.layers.support.ClipRect")],Lf);const kT=Lf;function hfe(i,e){const t=10**e;return Math.round(i*t)/t}const VT={left:0,right:0,top:0,bottom:0};let Wa=class extends ue{constructor(e){super(e),this._handles=new Ft,this._leadingClips=new Map,this._trailingClips=new Map,this.direction="horizontal",this.leadingLayers=new pt,this.max=100,this.min=0,this.precision=4,this.step=.5,this.stepMultiplier=10,this.trailingLayers=new pt,this.view=null}initialize(){this._handles.add([z(()=>{var e;return[this.view,(e=this.view)==null?void 0:e.ready,this.position,this.direction]},()=>this._clipLayers(),Qe),wr(()=>this.leadingLayers,"change",()=>this._clipLeadingLayers()),wr(()=>this.trailingLayers,"change",()=>this._clipTrailingLayers())])}destroy(){this._removeExistingClips(),this._handles.destroy(),this._handles=null}get position(){return 25}set position(e){const{precision:t,min:r,max:n}=this;this._set("position",hfe(Math.max(Math.min(e,n),r),t))}get state(){const{view:e}=this;return e&&e.ready?"ready":"disabled"}_clipLayers(){this._clipLeadingLayers(),this._clipTrailingLayers()}_clipLeadingLayers(){this._removeClips("leading");const{leadingLayers:e}=this;e.forEach(t=>this._clipLayer({layer:t,type:"leading"}))}_clipTrailingLayers(){this._removeClips("trailing");const{trailingLayers:e}=this;e.forEach(t=>this._clipLayer({layer:t,type:"trailing"}))}async _getLayerView(e){const{view:t}=this;if(!e||!t)return null;const r=await t.whenLayerView(e);return"clips"in r?r:null}_getVerticalClipRect(e){const{position:t}=this;return e==="leading"?new kT({...VT,bottom:100-t+"%"}):e==="trailing"?new kT({...VT,top:`${t}%`}):null}_getHorizontalClipRect(e){const{position:t}=this;return e==="leading"?new kT({...VT,right:100-t+"%"}):e==="trailing"?new kT({...VT,left:`${t}%`}):null}_getClipRect(e){const{direction:t}=this;return t==="vertical"?this._getVerticalClipRect(e):t==="horizontal"?this._getHorizontalClipRect(e):null}async _clipLayer(e){const{_leadingClips:t,_trailingClips:r}=this,{layer:n,type:s}=e,a=s==="trailing"?r:s==="leading"?t:null,o=await this._getLayerView(n);if(!(o&&"clips"in o&&a&&o.hasOwnProperty("clips")))return;const l=a.get(o);l&&o.clips.remove(l);const c=this._getClipRect(s);c&&(a.set(o,c),o.clips.add(c))}_removeClips(e){const{_leadingClips:t,_trailingClips:r}=this,n=e==="trailing"?r:e==="leading"?t:null;n&&(n.forEach((s,a)=>{a&&a.hasOwnProperty("clips")&&a.clips.remove(s)}),n.clear())}_removeExistingClips(){this._removeClips("leading"),this._removeClips("trailing")}};h([p()],Wa.prototype,"direction",void 0),h([p({type:pt,nonNullable:!0})],Wa.prototype,"leadingLayers",void 0),h([p({readOnly:!0})],Wa.prototype,"max",void 0),h([p({readOnly:!0})],Wa.prototype,"min",void 0),h([p()],Wa.prototype,"position",null),h([p()],Wa.prototype,"precision",void 0),h([p({readOnly:!0})],Wa.prototype,"state",null),h([p()],Wa.prototype,"step",void 0),h([p()],Wa.prototype,"stepMultiplier",void 0),h([p({type:pt,nonNullable:!0})],Wa.prototype,"trailingLayers",void 0),h([p()],Wa.prototype,"view",void 0),Wa=h([D("esri.widgets.Swipe.SwipeViewModel")],Wa);const fX=Wa,ta={base:"esri-swipe",baseDisabled:"esri-swipe--disabled",vertical:"esri-swipe--vertical",horizontal:"esri-swipe--horizontal",container:"esri-swipe__container",divider:"esri-swipe__divider",handle:"esri-swipe__handle",handleHidden:"esri-swipe__handle--hidden",widgetIcon:"esri-icon-up-down-arrows",handleIcon:"esri-swipe__handle-icon",dragIconHorizontal:"esri-icon-drag-horizontal",dragIconVertical:"esri-icon-drag-vertical",widget:"esri-widget",disabled:"esri-disabled"},kV={handle:!0,divider:!0};let ua=class extends Hn{constructor(e,t){super(e,t),this.disabled=!1,this.iconClass=ta.widgetIcon,this.messages=null,this.viewModel=new fX,this._pointerOffset=null,this._container=null,this._onContainerPointerDown=this._onContainerPointerDown.bind(this),this._onContainerPointerMove=this._onContainerPointerMove.bind(this),this._onContainerPointerUp=this._onContainerPointerUp.bind(this)}get direction(){return this.viewModel.direction}set direction(e){this.viewModel.direction=e}get dragLabel(){var e;return this._get("dragLabel")??((e=this.messages)==null?void 0:e.dragLabel)??""}set dragLabel(e){this._set("dragLabel",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get leadingLayers(){return this.viewModel.leadingLayers}set leadingLayers(e){this.viewModel.leadingLayers=e}get position(){return this.viewModel.position}set position(e){this.viewModel.position=e}get trailingLayers(){return this.viewModel.trailingLayers}set trailingLayers(e){this.viewModel.trailingLayers=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}set visibleElements(e){this._set("visibleElements",{...kV,...e})}get visibleElements(){return this._get("visibleElements")||kV}render(){const{state:e,direction:t}=this.viewModel,r=e==="disabled"||this.disabled,n={[ta.disabled]:r,[ta.baseDisabled]:r,[ta.vertical]:t==="vertical",[ta.horizontal]:t==="horizontal"};return F("div",{class:this.classes(ta.base,ta.widget,n)},e==="disabled"?null:this.renderContainer())}renderHandle(){const{direction:e}=this.viewModel,{visibleElements:t}=this,r={[ta.dragIconHorizontal]:e==="vertical",[ta.dragIconVertical]:e==="horizontal"},n=this.classes(ta.handle,!t.handle&&ta.handleHidden);return F("div",{key:"handle",role:"presentation",class:n},F("span",{"aria-hidden":"true",class:this.classes(ta.handleIcon,r)}))}renderDivider(){const{visibleElements:e}=this;return e&&e.divider?F("div",{key:"divider",role:"presentation",class:ta.divider}):null}renderContent(){return[this.renderDivider(),this.renderHandle()]}renderContainer(){const{disabled:e,dragLabel:t,viewModel:r}=this,{max:n,min:s,direction:a,position:o}=r,l=`${o}%`,c={top:a==="vertical"?l:null,left:a==="vertical"?null:l},u=this.renderContent();return F("div",e?{key:"container",role:"presentation",styles:c,class:ta.container}:{tabIndex:0,key:"container",bind:this,afterCreate:this._afterContainerCreate,onkeydown:this._onContainerKeyDown,"touch-action":"none",role:"slider",title:t,"aria-label":t,"aria-orientation":a,"aria-valuemax":`${n}`,"aria-valuemin":`${s}`,"aria-valuenow":`${o}`,"aria-valuetext":l,styles:c,class:ta.container},u)}_afterContainerCreate(e){this._container=e,e.addEventListener("pointerdown",this._onContainerPointerDown)}_calculatePointerOffset(e){const{direction:t}=this,r=e.target,n=(t==="vertical"?r.clientHeight:r.clientWidth)/2,s=r.getBoundingClientRect(),a=e.clientX-s.left,o=e.clientY-s.top;this._pointerOffset=t==="vertical"?o-n:a-n}_onContainerPointerDown(e){e.preventDefault(),this._container&&document.activeElement!==this.container&&this._container.focus(),this._calculatePointerOffset(e),document.addEventListener("pointerup",this._onContainerPointerUp),document.addEventListener("pointermove",this._onContainerPointerMove)}_onContainerPointerUp(e){e.preventDefault(),document.removeEventListener("pointerup",this._onContainerPointerUp),document.removeEventListener("pointermove",this._onContainerPointerMove)}_onContainerPointerMove(e){e.preventDefault();const{_pointerOffset:t,container:r,direction:n}=this,{clientX:s,clientY:a}=e,{top:o,left:l,width:c,height:u}=r.getBoundingClientRect(),d=(n==="vertical"?a-o-t:s-l-t)/(n==="vertical"?u:c)*100;this.position=d}_getKeyPosition(e){const t=Ol(e),{position:r}=this,{max:n,min:s,step:a,stepMultiplier:o,direction:l}=this.viewModel,c=a*o;return["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Home","End","PageUp","PageDown"].includes(t)&&(e.preventDefault(),e.stopPropagation()),(l==="vertical"?t==="ArrowDown"||t==="ArrowRight":t==="ArrowUp"||t==="ArrowRight")?r+(e.shiftKey?c:a):(l==="vertical"?t==="ArrowUp"||t==="ArrowLeft":t==="ArrowDown"||t==="ArrowLeft")?r-(e.shiftKey?c:a):t==="Home"?s:t==="End"?n:(l==="vertical"?t==="PageDown":t==="PageUp")?r+c:(l==="vertical"?t==="PageUp":t==="PageDown")?r-c:null}_onContainerKeyDown(e){const t=this._getKeyPosition(e);typeof t=="number"&&(this.position=t)}};h([p()],ua.prototype,"direction",null),h([p()],ua.prototype,"disabled",void 0),h([p()],ua.prototype,"dragLabel",null),h([p()],ua.prototype,"iconClass",void 0),h([p()],ua.prototype,"label",null),h([p()],ua.prototype,"leadingLayers",null),h([p(),_n("esri/widgets/Swipe/t9n/Swipe")],ua.prototype,"messages",void 0),h([p()],ua.prototype,"position",null),h([p()],ua.prototype,"trailingLayers",null),h([p()],ua.prototype,"view",null),h([p({type:fX})],ua.prototype,"viewModel",void 0),h([p()],ua.prototype,"visibleElements",null),ua=h([D("esri.widgets.Swipe")],ua);const ufe=ua,ni={allRenderFn:!1,cmpDidLoad:!0,cmpDidUnload:!1,cmpDidUpdate:!0,cmpDidRender:!0,cmpWillLoad:!0,cmpWillUpdate:!0,cmpWillRender:!0,connectedCallback:!0,disconnectedCallback:!0,element:!0,event:!0,hasRenderFn:!0,lifecycle:!0,hostListener:!0,hostListenerTargetWindow:!0,hostListenerTargetDocument:!0,hostListenerTargetBody:!0,hostListenerTargetParent:!1,hostListenerTarget:!0,member:!0,method:!0,mode:!0,observeAttribute:!0,prop:!0,propMutable:!0,reflect:!0,scoped:!0,shadowDom:!0,slot:!0,cssAnnotations:!0,state:!0,style:!0,svg:!0,updatable:!0,vdomAttribute:!0,vdomXlink:!0,vdomClass:!0,vdomFunctional:!0,vdomKey:!0,vdomListener:!0,vdomRef:!0,vdomPropOrAttr:!0,vdomRender:!0,vdomStyle:!0,vdomText:!0,watchCallback:!0,taskQueue:!0,hotModuleReplacement:!1,isDebug:!1,isDev:!1,isTesting:!1,hydrateServerSide:!1,hydrateClientSide:!1,lifecycleDOMEvents:!1,lazyLoad:!1,profile:!1,slotRelocation:!0,appendChildSlotFix:!1,cloneNodeFix:!1,hydratedAttribute:!1,hydratedClass:!0,safari10:!1,scriptDataOpts:!1,scopedSlotTextContentFix:!1,shadowDomShim:!1,slotChildNodesFix:!1,invisiblePrehydration:!0,propBoolean:!0,propNumber:!0,propString:!0,cssVarShim:!1,constructableCSS:!0,cmpShouldUpdate:!0,devTools:!1,dynamicImportShim:!1,shadowDelegatesFocus:!0,initializeNextTick:!1,asyncLoading:!1,asyncQueue:!1,transformTagName:!1,attachStyles:!0};let wy,gX,pR,_X=!1,P2=!1,pN=!1,zo=!1,VV=null,nL=!1;const mN={isDev:!!ni.isDev,isBrowser:!0,isServer:!1,isTesting:!!ni.isTesting},yX=i=>{const e=new URL(i,Js.$resourcesUrl$);return e.origin!==xv.location.origin?e.href:e.pathname},dfe=i=>Js.$resourcesUrl$=i,Vg=(i,e="")=>()=>{},UV="http://www.w3.org/1999/xlink",zV={},pfe="http://www.w3.org/2000/svg",mfe="http://www.w3.org/1999/xhtml",ffe=i=>i!=null,fN=i=>(i=typeof i,i==="object"||i==="function"),Cr=(i,e,...t)=>{let r=null,n=null,s=null,a=!1,o=!1;const l=[],c=d=>{for(let m=0;m<d.length;m++)r=d[m],Array.isArray(r)?c(r):r!=null&&typeof r!="boolean"&&((a=typeof i!="function"&&!fN(r))&&(r=String(r)),a&&o?l[l.length-1].$text$+=r:l.push(a?R2(null,r):r),o=a)};if(c(t),e&&(ni.isDev&&i==="input"&&yfe(e),ni.vdomKey&&e.key&&(n=e.key),ni.slotRelocation&&e.name&&(s=e.name),ni.vdomClass)){const d=e.className||e.class;d&&(e.class=typeof d!="object"?d:Object.keys(d).filter(m=>d[m]).join(" "))}if(ni.isDev&&l.some(vX)&&Hfe(`The <Host> must be the single root component. Make sure:
- You are NOT using hostData() and <Host> in the same component.
- <Host> is used once, and it's the single root component of the render() function.`),ni.vdomFunctional&&typeof i=="function")return i(e===null?{}:e,l,gfe);const u=R2(i,null);return u.$attrs$=e,l.length>0&&(u.$children$=l),ni.vdomKey&&(u.$key$=n),ni.slotRelocation&&(u.$name$=s),u},R2=(i,e)=>{const t={$flags$:0,$tag$:i,$text$:e,$elm$:null,$children$:null};return ni.vdomAttribute&&(t.$attrs$=null),ni.vdomKey&&(t.$key$=null),ni.slotRelocation&&(t.$name$=null),t},gN={},vX=i=>i&&i.$tag$===gN,gfe={forEach:(i,e)=>i.map(BV).forEach(e),map:(i,e)=>i.map(BV).map(e).map(_fe)},BV=i=>({vattrs:i.$attrs$,vchildren:i.$children$,vkey:i.$key$,vname:i.$name$,vtag:i.$tag$,vtext:i.$text$}),_fe=i=>{if(typeof i.vtag=="function"){const t=Object.assign({},i.vattrs);return i.vkey&&(t.key=i.vkey),i.vname&&(t.name=i.vname),Cr(i.vtag,t,...i.vchildren||[])}const e=R2(i.vtag,i.vtext);return e.$attrs$=i.vattrs,e.$children$=i.vchildren,e.$key$=i.vkey,e.$name$=i.vname,e},yfe=i=>{const e=Object.keys(i),t=e.indexOf("value");if(t===-1)return;const r=e.indexOf("type"),n=e.indexOf("min"),s=e.indexOf("max"),a=e.indexOf("step");(t<r||t<n||t<s||t<a)&&jfe('The "value" prop of <input> should be set after "min", "max", "type" and "step"')},vfe=i=>qfe.map(e=>e(i)).find(e=>!!e),bfe=(i,e)=>i!=null&&!fN(i)?e&4?i==="false"?!1:i===""||!!i:e&2?parseFloat(i):e&1?String(i):i:i,GV=new WeakMap,wfe=(i,e,t)=>{let r=O2.get(i);Qfe&&t?(r=r||new CSSStyleSheet,typeof r=="string"?r=e:r.replaceSync(e)):r=e,O2.set(i,r)},xfe=(i,e,t,r)=>{let n=bX(e,t);const s=O2.get(n);if(i=i.nodeType===11?i:Vc,s)if(typeof s=="string"){i=i.head||i;let a=GV.get(i),o;a||GV.set(i,a=new Set),a.has(n)||(o=Vc.createElement("style"),o.innerHTML=s,i.insertBefore(o,i.querySelector("link")),a&&a.add(n))}else i.adoptedStyleSheets.includes(s)||(i.adoptedStyleSheets=[...i.adoptedStyleSheets,s]);return n},Tfe=i=>{const e=i.$cmpMeta$,t=i.$hostElement$,r=e.$flags$,n=Vg("attachStyles",e.$tagName$),s=xfe(M2&&t.shadowRoot?t.shadowRoot:t.getRootNode(),e,i.$modeName$);r&10&&(t["s-sc"]=s,t.classList.add(s+"-h"),r&2&&t.classList.add(s+"-s")),n()},bX=(i,e)=>"sc-"+(e&&i.$flags$&32?i.$tagName$+"-"+e:i.$tagName$),HV=(i,e,t,r,n,s)=>{if(t!==r){let a=XV(i,e),o=e.toLowerCase();if(e==="class"){const l=i.classList,c=jV(t),u=jV(r);l.remove(...c.filter(d=>d&&!u.includes(d))),l.add(...u.filter(d=>d&&!c.includes(d)))}else if(e==="style"){for(const l in t)(!r||r[l]==null)&&(l.includes("-")?i.style.removeProperty(l):i.style[l]="");for(const l in r)(!t||r[l]!==t[l])&&(l.includes("-")?i.style.setProperty(l,r[l]):i.style[l]=r[l])}else if(e!=="key")if(e==="ref")r&&r(i);else if(!i.__lookupSetter__(e)&&e[0]==="o"&&e[1]==="n")e[2]==="-"?e=e.slice(3):XV(xv,o)?e=o.slice(2):e=o[2]+e.slice(3),t&&Js.rel(i,e,t,!1),r&&Js.ael(i,e,r,!1);else{const l=fN(r);if((a||l&&r!==null)&&!n)try{if(i.tagName.includes("-"))i[e]=r;else{const u=r??"";e==="list"?a=!1:(t==null||i[e]!=u)&&(i[e]=u)}}catch{}let c=!1;o!==(o=o.replace(/^xlink\:?/,""))&&(e=o,c=!0),r==null||r===!1?(r!==!1||i.getAttribute(e)==="")&&(c?i.removeAttributeNS(UV,e):i.removeAttribute(e)):(!a||s&4||n)&&!l&&(r=r===!0?"":r,c?i.setAttributeNS(UV,e,r):i.setAttribute(e,r))}}},Cfe=/\s/,jV=i=>i?i.split(Cfe):[],wX=(i,e,t,r)=>{const n=e.$elm$.nodeType===11&&e.$elm$.host?e.$elm$.host:e.$elm$,s=i&&i.$attrs$||zV,a=e.$attrs$||zV;for(r in s)r in a||HV(n,r,s[r],void 0,t,e.$flags$);for(r in a)HV(n,r,s[r],a[r],t,e.$flags$)},A2=(i,e,t,r)=>{const n=e.$children$[t];let s=0,a,o,l;if(_X||(pN=!0,n.$tag$==="slot"&&(wy&&r.classList.add(wy+"-s"),n.$flags$|=n.$children$?2:1)),n.$text$!==null)a=n.$elm$=Vc.createTextNode(n.$text$);else if(n.$flags$&1)a=n.$elm$=Vc.createTextNode("");else{if(zo||(zo=n.$tag$==="svg"),a=n.$elm$=Vc.createElementNS(zo?pfe:mfe,n.$flags$&2?"slot-fb":n.$tag$),zo&&n.$tag$==="foreignObject"&&(zo=!1),wX(null,n,zo),ffe(wy)&&a["s-si"]!==wy&&a.classList.add(a["s-si"]=wy),n.$children$)for(s=0;s<n.$children$.length;++s)o=A2(i,n,s,a),o&&a.appendChild(o);n.$tag$==="svg"?zo=!1:a.tagName==="foreignObject"&&(zo=!0)}return a["s-hn"]=pR,n.$flags$&3&&(a["s-sr"]=!0,a["s-cr"]=gX,a["s-sn"]=n.$name$||"",l=i&&i.$children$&&i.$children$[t],l&&l.$tag$===n.$tag$&&i.$elm$&&Kw(i.$elm$,!1)),a},Kw=(i,e)=>{Js.$flags$|=1;const t=i.childNodes;for(let r=t.length-1;r>=0;r--){const n=t[r];n["s-hn"]!==pR&&n["s-ol"]&&(CX(n).insertBefore(n,_N(n)),n["s-ol"].remove(),n["s-ol"]=void 0,pN=!0),e&&Kw(n,e)}Js.$flags$&=-2},xX=(i,e,t,r,n,s)=>{let a=i["s-cr"]&&i["s-cr"].parentNode||i,o;for(a.shadowRoot&&a.tagName===pR&&(a=a.shadowRoot);n<=s;++n)r[n]&&(o=A2(null,t,n,i),o&&(r[n].$elm$=o,a.insertBefore(o,_N(e))))},TX=(i,e,t,r,n)=>{for(;e<=t;++e)(r=i[e])&&(n=r.$elm$,PX(r),P2=!0,n["s-ol"]?n["s-ol"].remove():Kw(n,!0),n.remove())},Sfe=(i,e,t,r)=>{let n=0,s=0,a=0,o=0,l=e.length-1,c=e[0],u=e[l],d=r.length-1,m=r[0],f=r[d],_,g;for(;n<=l&&s<=d;)if(c==null)c=e[++n];else if(u==null)u=e[--l];else if(m==null)m=r[++s];else if(f==null)f=r[--d];else if(UT(c,m))xy(c,m),c=e[++n],m=r[++s];else if(UT(u,f))xy(u,f),u=e[--l],f=r[--d];else if(UT(c,f))(c.$tag$==="slot"||f.$tag$==="slot")&&Kw(c.$elm$.parentNode,!1),xy(c,f),i.insertBefore(c.$elm$,u.$elm$.nextSibling),c=e[++n],f=r[--d];else if(UT(u,m))(c.$tag$==="slot"||f.$tag$==="slot")&&Kw(u.$elm$.parentNode,!1),xy(u,m),i.insertBefore(u.$elm$,c.$elm$),u=e[--l],m=r[++s];else{for(a=-1,o=n;o<=l;++o)if(e[o]&&e[o].$key$!==null&&e[o].$key$===m.$key$){a=o;break}a>=0?(g=e[a],g.$tag$!==m.$tag$?_=A2(e&&e[s],t,a,i):(xy(g,m),e[a]=void 0,_=g.$elm$),m=r[++s]):(_=A2(e&&e[s],t,s,i),m=r[++s]),_&&CX(c.$elm$).insertBefore(_,_N(c.$elm$))}n>l?xX(i,r[d+1]==null?null:r[d+1].$elm$,t,r,s,d):s>d&&TX(e,n,l)},UT=(i,e)=>i.$tag$===e.$tag$?i.$tag$==="slot"?i.$name$===e.$name$:i.$key$===e.$key$:!1,_N=i=>i&&i["s-ol"]||i,CX=i=>(i["s-ol"]?i["s-ol"]:i).parentNode,xy=(i,e)=>{const t=e.$elm$=i.$elm$,r=i.$children$,n=e.$children$,s=e.$tag$,a=e.$text$;let o;a===null?(zo=s==="svg"?!0:s==="foreignObject"?!1:zo,s==="slot"||wX(i,e,zo),r!==null&&n!==null?Sfe(t,r,e,n):n!==null?(i.$text$!==null&&(t.textContent=""),xX(t,null,e,n,0,n.length-1)):r!==null&&TX(r,0,r.length-1),zo&&s==="svg"&&(zo=!1)):(o=t["s-cr"])?o.parentNode.textContent=a:i.$text$!==a&&(t.data=a)},SX=i=>{const e=i.childNodes;let t,r,n,s,a,o;for(r=0,n=e.length;r<n;r++)if(t=e[r],t.nodeType===1){if(t["s-sr"]){for(a=t["s-sn"],t.hidden=!1,s=0;s<n;s++)if(o=e[s].nodeType,e[s]["s-hn"]!==t["s-hn"]||a!==""){if(o===1&&a===e[s].getAttribute("slot")){t.hidden=!0;break}}else if(o===1||o===3&&e[s].textContent.trim()!==""){t.hidden=!0;break}}SX(t)}},xc=[],EX=i=>{let e,t,r,n,s,a,o=0;const l=i.childNodes,c=l.length;for(;o<c;o++){if(e=l[o],e["s-sr"]&&(t=e["s-cr"])&&t.parentNode)for(r=t.parentNode.childNodes,n=e["s-sn"],a=r.length-1;a>=0;a--)t=r[a],!t["s-cn"]&&!t["s-nr"]&&t["s-hn"]!==e["s-hn"]&&(qV(t,n)?(s=xc.find(u=>u.$nodeToRelocate$===t),P2=!0,t["s-sn"]=t["s-sn"]||n,s?s.$slotRefNode$=e:xc.push({$slotRefNode$:e,$nodeToRelocate$:t}),t["s-sr"]&&xc.map(u=>{qV(u.$nodeToRelocate$,t["s-sn"])&&(s=xc.find(d=>d.$nodeToRelocate$===t),s&&!u.$slotRefNode$&&(u.$slotRefNode$=s.$slotRefNode$))})):xc.some(u=>u.$nodeToRelocate$===t)||xc.push({$nodeToRelocate$:t}));e.nodeType===1&&EX(e)}},qV=(i,e)=>i.nodeType===1?i.getAttribute("slot")===null&&e===""||i.getAttribute("slot")===e:i["s-sn"]===e?!0:e==="",PX=i=>{i.$attrs$&&i.$attrs$.ref&&i.$attrs$.ref(null),i.$children$&&i.$children$.map(PX)},Efe=(i,e)=>{const t=i.$hostElement$,r=i.$cmpMeta$,n=i.$vnode$||R2(null,null),s=vX(e)?e:Cr(null,null,e);pR=t.tagName,r.$attrsToReflect$&&(s.$attrs$=s.$attrs$||{},r.$attrsToReflect$.map(([a,o])=>s.$attrs$[o]=t[a])),s.$tag$=null,s.$flags$|=4,i.$vnode$=s,s.$elm$=n.$elm$=t.shadowRoot||t,wy=t["s-sc"],gX=t["s-cr"],_X=M2&&(r.$flags$&1)!==0,P2=!1,xy(n,s);{if(Js.$flags$|=1,pN){EX(s.$elm$);let a,o,l,c,u,d,m=0;for(;m<xc.length;m++)a=xc[m],o=a.$nodeToRelocate$,o["s-ol"]||(l=Vc.createTextNode(""),l["s-nr"]=o,o.parentNode.insertBefore(o["s-ol"]=l,o));for(m=0;m<xc.length;m++)if(a=xc[m],o=a.$nodeToRelocate$,a.$slotRefNode$){for(c=a.$slotRefNode$.parentNode,u=a.$slotRefNode$.nextSibling,l=o["s-ol"];l=l.previousSibling;)if(d=l["s-nr"],d&&d["s-sn"]===o["s-sn"]&&c===d.parentNode&&(d=d.nextSibling,!d||!d["s-nr"])){u=d;break}(!u&&c!==o.parentNode||o.nextSibling!==u)&&o!==u&&(!o["s-hn"]&&o["s-ol"]&&(o["s-hn"]=o["s-ol"].parentNode.nodeName),c.insertBefore(o,u))}else o.nodeType===1&&(o.hidden=!0)}P2&&SX(s.$elm$),Js.$flags$&=-2,xc.length=0}},Pfe=(i,e)=>{},RX=(i,e)=>(i.$flags$|=16,Pfe(i,i.$ancestorComponent$),Kfe(()=>Rfe(i,e))),Rfe=(i,e)=>{const t=i.$hostElement$,r=Vg("scheduleUpdate",i.$cmpMeta$.$tagName$),n=t;let s;return e?s=I0(n,"componentWillLoad"):s=I0(n,"componentWillUpdate"),s=WV(s,()=>I0(n,"componentWillRender")),r(),WV(s,()=>Afe(i,n,e))},Afe=async(i,e,t)=>{const r=i.$hostElement$,n=Vg("update",i.$cmpMeta$.$tagName$);r["s-rc"],t&&Tfe(i);const s=Vg("render",i.$cmpMeta$.$tagName$);Ofe(i,e,r),s(),n(),Mfe(i)},Ofe=(i,e,t)=>{try{VV=e,e=e.render&&e.render(),i.$flags$&=-17,i.$flags$|=2,(ni.hasRenderFn||ni.reflect)&&(ni.vdomRender||ni.reflect)&&(ni.hydrateServerSide||Efe(i,e))}catch(o){Xx(o,i.$hostElement$)}return VV=null,null},Mfe=i=>{const e=i.$cmpMeta$.$tagName$,t=i.$hostElement$,r=Vg("postUpdate",e),n=t;i.$ancestorComponent$,I0(n,"componentDidRender"),i.$flags$&64?(I0(n,"componentDidUpdate"),r()):(i.$flags$|=64,I0(n,"componentDidLoad"),r())},I0=(i,e,t)=>{if(i&&i[e])try{return i[e](t)}catch(r){Xx(r)}},WV=(i,e)=>i&&i.then?i.then(e):e(),Ife=(i,e)=>mR(i).$instanceValues$.get(e),Lfe=(i,e,t,r)=>{const n=mR(i),s=i,a=n.$instanceValues$.get(e),o=n.$flags$,l=s;t=bfe(t,r.$members$[e][0]);const c=Number.isNaN(a)&&Number.isNaN(t);if(t!==a&&!c){n.$instanceValues$.set(e,t);{if(r.$watchers$&&o&128){const d=r.$watchers$[e];d&&d.map(m=>{try{l[m](t,a,e)}catch(f){Xx(f,s)}})}if((o&18)===2){if(l.componentShouldUpdate&&l.componentShouldUpdate(t,a,e)===!1)return;RX(n,!1)}}}},$fe=(i,e,t)=>{if(e.$members$){i.watchers&&(e.$watchers$=i.watchers);const r=Object.entries(e.$members$),n=i.prototype;r.map(([s,[a]])=>{(a&31||a&32)&&Object.defineProperty(n,s,{get(){return Ife(this,s)},set(o){Lfe(this,s,o,e)},configurable:!0,enumerable:!0})});{const s=new Map;n.attributeChangedCallback=function(a,o,l){Js.jmp(()=>{const c=s.get(a);if(this.hasOwnProperty(c))l=this[c],delete this[c];else if(n.hasOwnProperty(c)&&typeof this[c]=="number"&&this[c]==l)return;this[c]=l===null&&typeof this[c]=="boolean"?!1:l})},i.observedAttributes=r.filter(([a,o])=>o[0]&15).map(([a,o])=>{const l=o[1]||a;return s.set(l,a),o[0]&512&&e.$attrsToReflect$.push([a,l]),l})}}return i},Dfe=async(i,e,t,r,n)=>{if(!(e.$flags$&32)&&(n=i.constructor,e.$flags$|=32,customElements.whenDefined(t.$tagName$).then(()=>e.$flags$|=128),n.style)){let a=n.style;typeof a!="string"&&(a=a[e.$modeName$=vfe(i)]);const o=bX(t,e.$modeName$);if(!O2.has(o)){const l=Vg("registerStyles",t.$tagName$);wfe(o,a,!!(t.$flags$&1)),l()}}e.$ancestorComponent$,(()=>RX(e,!0))()},Ffe=i=>{},Nfe=i=>{if(!(Js.$flags$&1)){const e=mR(i),t=e.$cmpMeta$,r=Vg("connectedCallback",t.$tagName$);e.$flags$&1?(AX(i,e,t.$listeners$),Ffe(e.$lazyInstance$)):(e.$flags$|=1,t.$flags$&12&&kfe(i),t.$members$&&Object.entries(t.$members$).map(([n,[s]])=>{if(s&31&&i.hasOwnProperty(n)){const a=i[n];delete i[n],i[n]=a}}),Dfe(i,e,t)),r()}},kfe=i=>{const e=i["s-cr"]=Vc.createComment("");e["s-cn"]=!0,i.insertBefore(e,i.firstChild)},Vfe=i=>{if(!(Js.$flags$&1)){const e=mR(i);e.$rmListeners$&&(e.$rmListeners$.map(t=>t()),e.$rmListeners$=void 0)}},yN=(i,e)=>{const t={$flags$:e[0],$tagName$:e[1]};ni.member&&(t.$members$=e[2]),ni.hostListener&&(t.$listeners$=e[3]),ni.watchCallback&&(t.$watchers$=i.$watchers$),ni.reflect&&(t.$attrsToReflect$=[]),ni.shadowDom&&!M2&&t.$flags$&1&&(t.$flags$|=8);const r=i.prototype.connectedCallback,n=i.prototype.disconnectedCallback;return Object.assign(i.prototype,{__registerHost(){Gfe(this,t)},connectedCallback(){Nfe(this),ni.connectedCallback&&r&&r.call(this)},disconnectedCallback(){Vfe(this),ni.disconnectedCallback&&n&&n.call(this)},__attachShadow(){M2?ni.shadowDelegatesFocus?this.attachShadow({mode:"open",delegatesFocus:!!(t.$flags$&16)}):this.attachShadow({mode:"open"}):this.shadowRoot=this}}),i.is=t.$tagName$,$fe(i,t)},AX=(i,e,t,r)=>{t&&t.map(([n,s,a])=>{const o=zfe(i,n),l=Ufe(e,a),c=Bfe(n);Js.ael(o,s,l,c),(e.$rmListeners$=e.$rmListeners$||[]).push(()=>Js.rel(o,s,l,c))})},Ufe=(i,e)=>t=>{try{ni.lazyLoad||i.$hostElement$[e](t)}catch(r){Xx(r)}},zfe=(i,e)=>e&4?Vc:e&8?xv:e&16?Vc.body:i,Bfe=i=>Wfe?{passive:(i&1)!==0,capture:(i&2)!==0}:(i&2)!==0,OX=new WeakMap,mR=i=>OX.get(i),Gfe=(i,e)=>{const t={$flags$:0,$hostElement$:i,$cmpMeta$:e,$instanceValues$:new Map};return ni.isDev&&(t.$renderCount$=0),ni.method&&ni.lazyLoad&&(t.$onInstancePromise$=new Promise(r=>t.$onInstanceResolve$=r)),ni.asyncLoading&&(t.$onReadyPromise$=new Promise(r=>t.$onReadyResolve$=r),i["s-p"]=[],i["s-rc"]=[]),AX(i,t,e.$listeners$),OX.set(i,t)},XV=(i,e)=>e in i,Xx=(i,e)=>(0,console.error)(i,e),MX=ni.isTesting?["STENCIL:"]:["%cstencil","color: white;background:#4c47ff;font-weight: bold; font-size:10px; padding:2px 6px; border-radius: 5px"],Hfe=(...i)=>console.error(...MX,...i),jfe=(...i)=>console.warn(...MX,...i),O2=new Map,qfe=[],xv=typeof window<"u"?window:{};ni.cssVarShim&&xv.CSS;const Vc=xv.document||{head:{}},vN=xv.HTMLElement||class{},Js={$flags$:0,$resourcesUrl$:"",jmp:i=>i(),raf:i=>requestAnimationFrame(i),ael:(i,e,t,r)=>i.addEventListener(e,t,r),rel:(i,e,t,r)=>i.removeEventListener(e,t,r),ce:(i,e)=>new CustomEvent(i,e)},M2=ni.shadowDomShim&&ni.shadowDom?(()=>(Vc.head.attachShadow+"").indexOf("[native")>-1)():!0,Wfe=(()=>{let i=!1;try{Vc.addEventListener("e",null,Object.defineProperty({},"passive",{get(){i=!0}}))}catch{}return i})(),Xfe=i=>Promise.resolve(i),Qfe=ni.constructableCSS?(()=>{try{return new CSSStyleSheet,typeof new CSSStyleSheet().replaceSync=="function"}catch{}return!1})():!1,QV=[],IX=[],Zfe=(i,e)=>t=>{i.push(t),nL||(nL=!0,e&&Js.$flags$&4?Yfe(sL):Js.raf(sL))},ZV=i=>{for(let e=0;e<i.length;e++)try{i[e](performance.now())}catch(t){Xx(t)}i.length=0},sL=()=>{ZV(QV),ZV(IX),(nL=QV.length>0)&&Js.raf(sL)},Yfe=i=>Xfe().then(i),Kfe=Zfe(IX,!0);/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.7
 */function Jfe(i){return i.map(e=>{let t="";for(let r=0;r<e;r++)t+=((1+Math.random())*65536|0).toString(16).substring(1);return t}).join("-")}const ege=()=>Jfe([2,1,1,1,3]);/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.7
 */const tge="calcite-mode-auto",ige="calcite-mode-dark";function rge(i){const e="dir",t=`[${e}]`,r=Qx(i,t);return r?r.getAttribute(e):"ltr"}function LX(i){return i.getRootNode()}function $X(i){return i.host||null}function nge(i,{selector:e,id:t}){function r(n){if(!n)return null;n.assignedSlot&&(n=n.assignedSlot);const s=LX(n),a=t?"getElementById"in s?s.getElementById(t):null:e?s.querySelector(e):null,o=$X(s);return a||(o?r(o):null)}return r(i)}function Qx(i,e){function t(r){return r?r.closest(e)||t($X(LX(r))):null}return t(i)}function sge(i,e){return DX(i,e)}function DX(i,e){if(!i)return;const t=e(i);if(t!==void 0)return t;const{parentNode:r}=i;return DX(r instanceof ShadowRoot?r.host:r,e)}function age(i,e){return!!sge(e,t=>t===i?!0:void 0)}function oge(i){return Boolean(i).toString()}/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.7
 */function lge(i){const{formEl:e}=i;return e?("requestSubmit"in e?e.requestSubmit():e.submit(),!0):!1}function cge(i){var e;(e=i.formEl)==null||e.reset()}/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.7
 */function hge(){}function uge(i,e=!1){if(i.disabled){i.el.setAttribute("tabindex","-1"),i.el.setAttribute("aria-disabled","true"),i.el.contains(document.activeElement)&&document.activeElement.blur(),i.el.click=hge;return}i.el.click=HTMLElement.prototype.click,typeof e=="function"?i.el.setAttribute("tabindex",e.call(i)?"0":"-1"):e===!0?i.el.setAttribute("tabindex","0"):e===!1&&i.el.removeAttribute("tabindex"),i.el.removeAttribute("aria-disabled")}/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.7
 */const FX="calciteInternalLabelClick",bN="calciteInternalLabelConnected",aL="calciteInternaLabelDisconnected",YV="calcite-label",I2=new WeakMap,Jw=new WeakMap,L2=new WeakMap,L0=new Set,dge=i=>{const{id:e}=i,t=e&&nge(i,{selector:`${YV}[for="${e}"]`});if(t)return t;const r=Qx(i,YV);return!r||pge(r,i)?null:r};function pge(i,e){let t;const r="custom-element-ancestor-check",n=a=>{a.stopImmediatePropagation();const o=a.composedPath();t=o.slice(o.indexOf(e),o.indexOf(i))};return i.addEventListener(r,n,{once:!0}),e.dispatchEvent(new CustomEvent(r,{composed:!0,bubbles:!0})),i.removeEventListener(r,n),t.filter(a=>a!==e&&a!==i).filter(a=>{var o;return(o=a.tagName)==null?void 0:o.includes("-")}).length>0}function NX(i){const e=dge(i.el);if(I2.has(e)||!e&&L0.has(i))return;const t=yge.bind(i);if(e){i.labelEl=e;const r=gge.bind(i);I2.set(i.labelEl,r),i.labelEl.addEventListener(FX,r),L0.delete(i),document.removeEventListener(bN,Jw.get(i)),L2.set(i,t),document.addEventListener(aL,t)}else L0.has(i)||(t(),document.removeEventListener(aL,L2.get(i)))}function mge(i){if(L0.delete(i),document.removeEventListener(bN,Jw.get(i)),document.removeEventListener(aL,L2.get(i)),Jw.delete(i),L2.delete(i),!i.labelEl)return;const e=I2.get(i.labelEl);i.labelEl.removeEventListener(FX,e),I2.delete(i.labelEl)}function fge(i){var e,t;return i.label||((t=(e=i.labelEl)==null?void 0:e.textContent)==null?void 0:t.trim())||""}function gge(i){this.disabled||this.el.contains(i.detail.sourceEvent.target)||this.onLabelClick(i)}function _ge(){L0.has(this)&&NX(this)}function yge(){L0.add(this);const i=Jw.get(this)||_ge.bind(this);Jw.set(this,i),document.addEventListener(bN,i)}/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.7
 */const kX=new WeakMap,VX=new WeakMap;function vge(i){VX.set(i,new Promise(e=>kX.set(i,e)))}function bge(i){kX.get(i)()}function wge(i){return VX.get(i)}/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.7
 */function wN(i,e,t){if(!mN.isBrowser)return;const r=xge(i);return new r(e,t)}function xge(i){class e extends window.MutationObserver{constructor(r){super(r),this.observedEntry=[],this.callback=r}observe(r,n){return this.observedEntry.push({target:r,options:n}),super.observe(r,n)}unobserve(r){const n=this.observedEntry.filter(s=>s.target!==r);this.observedEntry=[],this.callback(super.takeRecords(),this),this.disconnect(),n.forEach(s=>this.observe(s.target,s.options))}}return function(){return i==="intersection"?window.IntersectionObserver:i==="mutation"?e:window.ResizeObserver}()}/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.7
 */const Tge=new RegExp("-","g"),Cge=new RegExp("\\.?0+$");class Ni{constructor(e){if(this.add=n=>Ni.fromBigInt(this.value+new Ni(n).value),this.subtract=n=>Ni.fromBigInt(this.value-new Ni(n).value),this.multiply=n=>Ni._divRound(this.value*new Ni(n).value,Ni.SHIFT),this.divide=n=>Ni._divRound(this.value*Ni.SHIFT,new Ni(n).value),e instanceof Ni)return e;const[t,r]=String(e).split(".").concat("");this.value=BigInt(t+r.padEnd(Ni.DECIMALS,"0").slice(0,Ni.DECIMALS))+BigInt(Ni.ROUNDED&&r[Ni.DECIMALS]>="5"),this.isNegative=e.charAt(0)==="-"}getIntegersAndDecimals(){const e=this.value.toString().replace(Tge,"").padStart(Ni.DECIMALS+1,"0"),t=e.slice(0,-Ni.DECIMALS),r=e.slice(-Ni.DECIMALS).replace(Cge,"");return{integers:t,decimals:r}}toString(){const{integers:e,decimals:t}=this.getIntegersAndDecimals();return`${this.isNegative?"-":""}${e}${t.length?"."+t:""}`}formatToParts(e){const{integers:t,decimals:r}=this.getIntegersAndDecimals(),n=e.numberFormatter.formatToParts(BigInt(t));return this.isNegative&&n.unshift({type:"minusSign",value:e.minusSign}),r.length&&(n.push({type:"decimal",value:e.decimal}),r.split("").forEach(s=>n.push({type:"fraction",value:s}))),n}format(e){const{integers:t,decimals:r}=this.getIntegersAndDecimals(),n=`${this.isNegative?e.minusSign:""}${e.numberFormatter.format(BigInt(t))}`,s=r.length?`${e.decimal}${r.split("").map(a=>e.numberFormatter.format(Number(a))).join("")}`:"";return`${n}${s}`}}Ni.DECIMALS=100;Ni.ROUNDED=!0;Ni.SHIFT=BigInt("1"+"0".repeat(Ni.DECIMALS));Ni._divRound=(i,e)=>Ni.fromBigInt(i/e+(Ni.ROUNDED?i*BigInt(2)/e%BigInt(2):BigInt(0)));Ni.fromBigInt=i=>Object.assign(Object.create(Ni.prototype),{value:i});const Ug="en",Sge=["ar","bg","bs","ca","cs","da","de","el",Ug,"es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","no","nl","pl","pt-BR","pt-PT","ro","ru","sk","sl","sr","sv","th","tr","uk","vi","zh-CN","zh-HK","zh-TW"],Ege=["ar","bg","bs","ca","cs","da","de","de-CH","el",Ug,"en-AU","en-CA","en-GB","es","es-MX","et","fi","fr","fr-CH","he","hi","hr","hu","id","it","it-CH","ja","ko","lt","lv","mk","no","nl","pl","pt","pt-PT","ro","ru","sk","sl","sr","sv","th","tr","uk","vi","zh-CN","zh-HK","zh-TW"];new Intl.NumberFormat().resolvedOptions().numberingSystem;function Pge(i,e="cldr"){const t=e==="cldr"?Ege:Sge;return i?t.includes(i)?i:(i=i.toLowerCase(),i==="nb"?"no":e==="t9n"&&i==="pt"?"pt-BR":(i.includes("-")&&(i=i.replace(/(\w+)-(\w+)/,(r,n,s)=>`${n}-${s.toUpperCase()}`),t.includes(i)||(i=i.split("-")[0])),i==="zh"?"zh-CN":t.includes(i)?i:(console.warn(`Translations for the "${i}" locale are not available and will fall back to the default, English (en).`),Ug))):Ug}const ex=new Set;function Rge(i){Age(i),ex.size===0&&(QS==null||QS.observe(document.documentElement,{attributes:!0,attributeFilter:["lang"],subtree:!0})),ex.add(i)}function Age(i){i.effectiveLocale=Mge(i)}function Oge(i){ex.delete(i),ex.size===0&&QS.disconnect()}const QS=wN("mutation",i=>{i.forEach(e=>{const t=e.target;ex.forEach(r=>{if(!age(t,r.el))return;const s=Qx(r.el,"[lang]");if(!s){r.effectiveLocale=Ug;return}const a=s.lang;r.effectiveLocale=s.hasAttribute("lang")&&a===""?Ug:a})})});function Mge(i){var e;return i.el.lang||((e=Qx(i.el,"[lang]"))==null?void 0:e.lang)||document.documentElement.lang||Ug}/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.7
 */const zT={};async function Ige(i,e){const t=`${e}_${i}`;return zT[t]||(zT[t]=fetch(yX(`./assets/${e}/t9n/messages_${i}.json`)).then(r=>(r.ok||KV(),r.json())).catch(()=>KV())),zT[t]}function KV(){throw new Error("could not fetch component message bundle")}function xN(i){i.messages={...i.defaultMessages,...i.messageOverrides}}async function Lge(i){i.defaultMessages=await UX(i,i.effectiveLocale),xN(i)}async function UX(i,e){const{el:t}=i,n=t.tagName.toLowerCase().replace("calcite-","");return Ige(Pge(e,"t9n"),n)}async function $ge(i,e){i.defaultMessages=await UX(i,e),xN(i)}function Dge(i){i.onMessagesChange=Nge}function Fge(i){i.onMessagesChange=void 0}function Nge(){xN(this)}/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.7
 */const kge={icon:"icon",flipRtl:"flip-rtl"},sO={},aO={},zX={s:16,m:24,l:32};async function Vge({icon:i,scale:e}){const t=zX[e],r=Uge(i),n=r.charAt(r.length-1)==="F",a=`${n?r.substring(0,r.length-1):r}${t}${n?"F":""}`;if(sO[a])return sO[a];aO[a]||(aO[a]=fetch(yX(`./assets/icon/${a}.json`)).then(l=>l.json()).catch(()=>(console.error(`"${a}" is not a valid calcite-ui-icon name`),"")));const o=await aO[a];return sO[a]=o,o}function Uge(i){const e=!isNaN(Number(i.charAt(0))),t=i.split("-");if(t.length>0){const n=/[a-z]/i;i=t.map((s,a)=>s.replace(n,function(l,c){return a===0&&c===0?l:l.toUpperCase()})).join("")}return e?`i${i}`:i}const zge="@keyframes in{0%{opacity:0}100%{opacity:1}}@keyframes in-down{0%{opacity:0;transform:translate3D(0, -5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-up{0%{opacity:0;transform:translate3D(0, 5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-scale{0%{opacity:0;transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;transform:scale3D(1, 1, 1)}}:root{--calcite-animation-timing:calc(150ms * var(--calcite-internal-duration-factor));--calcite-internal-duration-factor:var(--calcite-duration-factor, 1);--calcite-internal-animation-timing-fast:calc(100ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-medium:calc(200ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-slow:calc(300ms * var(--calcite-internal-duration-factor))}.calcite-animate{opacity:0;animation-fill-mode:both;animation-duration:var(--calcite-animation-timing)}.calcite-animate__in{animation-name:in}.calcite-animate__in-down{animation-name:in-down}.calcite-animate__in-up{animation-name:in-up}.calcite-animate__in-scale{animation-name:in-scale}@media (prefers-reduced-motion: reduce){:root{--calcite-internal-duration-factor:0}}:root{--calcite-floating-ui-transition:var(--calcite-animation-timing);--calcite-floating-ui-z-index:600}:host([hidden]){display:none}:host{display:inline-flex;color:var(--calcite-ui-icon-color)}:host([scale=s]){block-size:1rem;inline-size:1rem;min-inline-size:1rem;min-block-size:1rem}:host([scale=m]){block-size:1.5rem;inline-size:1.5rem;min-inline-size:1.5rem;min-block-size:1.5rem}:host([scale=l]){block-size:2rem;inline-size:2rem;min-inline-size:2rem;min-block-size:2rem}.flip-rtl{transform:scaleX(-1)}.svg{display:block}",Bge=yN(class extends vN{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.icon=null,this.flipRtl=!1,this.scale="m",this.textLabel=void 0,this.pathData=void 0,this.visible=!1}connectedCallback(){this.waitUntilVisible(()=>{this.visible=!0,this.loadIconPathData()})}disconnectedCallback(){var i;(i=this.intersectionObserver)==null||i.disconnect(),this.intersectionObserver=null}async componentWillLoad(){this.loadIconPathData()}render(){const{el:i,flipRtl:e,pathData:t,scale:r,textLabel:n}=this,s=rge(i),a=zX[r],o=!!n,l=[].concat(t||"");return Cr(gN,{"aria-hidden":oge(!o),"aria-label":o?n:null,role:o?"img":null},Cr("svg",{"aria-hidden":"true",class:{[kge.flipRtl]:s==="rtl"&&e,svg:!0},fill:"currentColor",height:"100%",viewBox:`0 0 ${a} ${a}`,width:"100%",xmlns:"http://www.w3.org/2000/svg"},l.map(c=>typeof c=="string"?Cr("path",{d:c}):Cr("path",{d:c.d,opacity:"opacity"in c?c.opacity:1}))))}async loadIconPathData(){const{icon:i,scale:e,visible:t}=this;!mN.isBrowser||!i||!t||(this.pathData=await Vge({icon:i,scale:e}))}waitUntilVisible(i){if(this.intersectionObserver=wN("intersection",e=>{e.forEach(t=>{t.isIntersecting&&(this.intersectionObserver.disconnect(),this.intersectionObserver=null,i())})},{rootMargin:"50px"}),!this.intersectionObserver){i();return}this.intersectionObserver.observe(this.el)}static get assetsDirs(){return["assets"]}get el(){return this}static get watchers(){return{icon:["loadIconPathData"],scale:["loadIconPathData"]}}static get style(){return zge}},[1,"calcite-icon",{icon:[513],flipRtl:[516,"flip-rtl"],scale:[513],textLabel:[1,"text-label"],pathData:[32],visible:[32]}]);function BX(){if(typeof customElements>"u")return;["calcite-icon"].forEach(e=>{switch(e){case"calcite-icon":customElements.get(e)||customElements.define(e,Bge);break}})}BX();/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.7
 */const Gge='@charset "UTF-8";@keyframes in{0%{opacity:0}100%{opacity:1}}@keyframes in-down{0%{opacity:0;transform:translate3D(0, -5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-up{0%{opacity:0;transform:translate3D(0, 5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-scale{0%{opacity:0;transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;transform:scale3D(1, 1, 1)}}:root{--calcite-animation-timing:calc(150ms * var(--calcite-internal-duration-factor));--calcite-internal-duration-factor:var(--calcite-duration-factor, 1);--calcite-internal-animation-timing-fast:calc(100ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-medium:calc(200ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-slow:calc(300ms * var(--calcite-internal-duration-factor))}.calcite-animate{opacity:0;animation-fill-mode:both;animation-duration:var(--calcite-animation-timing)}.calcite-animate__in{animation-name:in}.calcite-animate__in-down{animation-name:in-down}.calcite-animate__in-up{animation-name:in-up}.calcite-animate__in-scale{animation-name:in-scale}@media (prefers-reduced-motion: reduce){:root{--calcite-internal-duration-factor:0}}:root{--calcite-floating-ui-transition:var(--calcite-animation-timing);--calcite-floating-ui-z-index:600}:host([hidden]){display:none}:host{position:relative;margin-inline:auto;display:none;align-items:center;justify-content:center;opacity:1;min-block-size:var(--calcite-loader-size);font-size:var(--calcite-loader-font-size);stroke:var(--calcite-ui-brand);stroke-width:3;fill:none;transform:scale(1, 1);animation:loader-color-shift calc(var(--calcite-internal-animation-timing-slow) * 2) alternate-reverse infinite linear;padding-block:var(--calcite-loader-padding, 4rem)}:host([scale=s]){--calcite-loader-font-size:var(--calcite-font-size--2);--calcite-loader-size:2rem;--calcite-loader-size-inline:0.75rem}:host([scale=m]){--calcite-loader-font-size:var(--calcite-font-size-0);--calcite-loader-size:4rem;--calcite-loader-size-inline:1rem}:host([scale=l]){--calcite-loader-font-size:var(--calcite-font-size-2);--calcite-loader-size:6rem;--calcite-loader-size-inline:1.5rem}:host([no-padding]){padding-block:0px}:host{display:flex}.loader__text{display:block;text-align:center;font-size:var(--calcite-font-size--2);line-height:1rem;color:var(--calcite-ui-text-1);margin-block-start:calc(var(--calcite-loader-size) + 1.5rem)}.loader__percentage{position:absolute;display:block;text-align:center;color:var(--calcite-ui-text-1);font-size:var(--calcite-loader-font-size);inline-size:var(--calcite-loader-size);inset-inline-start:50%;margin-inline-start:calc(var(--calcite-loader-size) / 2 * -1);line-height:0.25;transform:scale(1, 1)}.loader__svgs{position:absolute;overflow:visible;opacity:1;inline-size:var(--calcite-loader-size);block-size:var(--calcite-loader-size);inset-inline-start:50%;margin-inline-start:calc(var(--calcite-loader-size) / 2 * -1);transform:scale(1, 1)}.loader__svg{position:absolute;inset-block-start:0px;transform-origin:center;overflow:visible;inset-inline-start:0;inline-size:var(--calcite-loader-size);block-size:var(--calcite-loader-size);animation-iteration-count:infinite;animation-timing-function:linear;animation-name:loader-clockwise}@supports (display: grid){.loader__svg--1{animation-name:loader-offset-1}.loader__svg--2{animation-name:loader-offset-2}.loader__svg--3{animation-name:loader-offset-3}}:host([type=determinate]){animation:none;stroke:var(--calcite-ui-border-3)}:host([type=determinate]) .loader__svg--3{animation:none;stroke:var(--calcite-ui-brand);stroke-dasharray:150.79632;transform:rotate(-90deg);transition:all var(--calcite-internal-animation-timing-fast) linear}:host([inline]){position:relative;margin:0px;animation:none;stroke:currentColor;stroke-width:2;padding-block:0px;block-size:var(--calcite-loader-size-inline);min-block-size:var(--calcite-loader-size-inline);inline-size:var(--calcite-loader-size-inline);margin-inline-end:calc(var(--calcite-loader-size-inline) * 0.5);vertical-align:calc(var(--calcite-loader-size-inline) * -1 * 0.2)}:host([inline]) .loader__svgs{inset-block-start:0px;margin:0px;inset-inline-start:0;inline-size:var(--calcite-loader-size-inline);block-size:var(--calcite-loader-size-inline)}:host([inline]) .loader__svg{inline-size:var(--calcite-loader-size-inline);block-size:var(--calcite-loader-size-inline)}:host([complete]){opacity:0;transform:scale(0.75, 0.75);transform-origin:center;transition:opacity var(--calcite-internal-animation-timing-medium) linear 1000ms, transform var(--calcite-internal-animation-timing-medium) linear 1000ms}:host([complete]) .loader__svgs{opacity:0;transform:scale(0.75, 0.75);transform-origin:center;transition:opacity calc(180ms * var(--calcite-internal-duration-factor)) linear 800ms, transform calc(180ms * var(--calcite-internal-duration-factor)) linear 800ms}:host([complete]) .loader__percentage{color:var(--calcite-ui-brand);transform:scale(1.05, 1.05);transform-origin:center;transition:color var(--calcite-internal-animation-timing-medium) linear, transform var(--calcite-internal-animation-timing-medium) linear}.loader__svg--1{stroke-dasharray:27.9252444444% 139.6262222222%;animation-duration:calc(var(--calcite-internal-animation-timing-slow) * 2.4)}@keyframes loader-offset-1{0%{stroke-dasharray:27.9252444444% 251.3272%;stroke-dashoffset:0}50%{stroke-dasharray:139.6262222222% 139.6262222222%;stroke-dashoffset:-83.7757333333%}100%{stroke-dasharray:27.9252444444% 251.3272%;stroke-dashoffset:-279.2524444444%}}.loader__svg--2{stroke-dasharray:55.8504888889% 139.6262222222%;animation-duration:calc(var(--calcite-internal-animation-timing-slow) * 3.2)}@keyframes loader-offset-2{0%{stroke-dasharray:55.8504888889% 223.4019555556%;stroke-dashoffset:0}50%{stroke-dasharray:139.6262222222% 139.6262222222%;stroke-dashoffset:-97.7383555556%}100%{stroke-dasharray:55.8504888889% 223.4019555556%;stroke-dashoffset:-279.2524444444%}}.loader__svg--3{stroke-dasharray:13.9626222222% 139.6262222222%;animation-duration:calc(var(--calcite-internal-animation-timing-slow) * 3.867)}@keyframes loader-offset-3{0%{stroke-dasharray:13.9626222222% 265.2898222222%;stroke-dashoffset:0}50%{stroke-dasharray:139.6262222222% 139.6262222222%;stroke-dashoffset:-76.7944222222%}100%{stroke-dasharray:13.9626222222% 265.2898222222%;stroke-dashoffset:-279.2524444444%}}@keyframes loader-color-shift{0%{stroke:var(--calcite-ui-brand)}33%{stroke:var(--calcite-ui-brand-press)}66%{stroke:var(--calcite-ui-brand-hover)}100%{stroke:var(--calcite-ui-brand)}}@keyframes loader-clockwise{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}',Hge=yN(class extends vN{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.inline=!1,this.label=void 0,this.scale="m",this.type=void 0,this.value=0,this.text=""}render(){const{el:i,inline:e,label:t,scale:r,text:n,type:s,value:a}=this,o=i.id||ege(),l=.45,c=e?this.getInlineSize(r):this.getSize(r),u=c*l,d=`0 0 ${c} ${c}`,m=s==="determinate",f=2*u*Math.PI,_=a/100*f,g=f-_,x=Math.floor(a),b={"aria-valuenow":x,"aria-valuemin":0,"aria-valuemax":100,complete:x===100},v={r:u,cx:c/2,cy:c/2},w={"stroke-dasharray":`${_} ${g}`};return Cr(gN,{"aria-label":t,id:o,role:"progressbar",...m?b:{}},Cr("div",{class:"loader__svgs"},Cr("svg",{"aria-hidden":"true",class:"loader__svg loader__svg--1",viewBox:d},Cr("circle",{...v})),Cr("svg",{"aria-hidden":"true",class:"loader__svg loader__svg--2",viewBox:d},Cr("circle",{...v})),Cr("svg",{"aria-hidden":"true",class:"loader__svg loader__svg--3",viewBox:d,...m?{style:w}:{}},Cr("circle",{...v}))),n&&Cr("div",{class:"loader__text"},n),m&&Cr("div",{class:"loader__percentage"},a))}getSize(i){return{s:32,m:56,l:80}[i]}getInlineSize(i){return{s:12,m:16,l:20}[i]}get el(){return this}static get style(){return Gge}},[1,"calcite-loader",{inline:[516],label:[1],scale:[513],type:[513],value:[2],text:[1]}]);function GX(){if(typeof customElements>"u")return;["calcite-loader"].forEach(e=>{switch(e){case"calcite-loader":customElements.get(e)||customElements.define(e,Hge);break}})}GX();/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.7
 */(function(i){if(typeof i.requestSubmit=="function")return;i.requestSubmit=function(r){r?(e(r,this),r.click()):(r=document.createElement("input"),r.type="submit",r.hidden=!0,this.appendChild(r),r.click(),this.removeChild(r))};function e(r,n){r instanceof HTMLElement||t(TypeError,"parameter 1 is not of type 'HTMLElement'"),r.type=="submit"||t(TypeError,"The specified element is not a submit button"),r.form==n||t(DOMException,"The specified element is not owned by this form element","NotFoundError")}function t(r,n,s){throw new r("Failed to execute 'requestSubmit' on 'HTMLFormElement': "+n+".",s)}})(HTMLFormElement.prototype);const Co={buttonLoader:"calcite-button--loader",content:"content",contentSlotted:"content--slotted",icon:"icon",iconStart:"icon--start",iconEnd:"icon--end",loadingIn:"loading-in",loadingOut:"loading-out",iconStartEmpty:"icon-start-empty",iconEndEmpty:"icon-end-empty",buttonPadding:"button-padding",buttonPaddingShrunk:"button-padding--shrunk"},jge="@keyframes in{0%{opacity:0}100%{opacity:1}}@keyframes in-down{0%{opacity:0;transform:translate3D(0, -5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-up{0%{opacity:0;transform:translate3D(0, 5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-scale{0%{opacity:0;transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;transform:scale3D(1, 1, 1)}}:root{--calcite-animation-timing:calc(150ms * var(--calcite-internal-duration-factor));--calcite-internal-duration-factor:var(--calcite-duration-factor, 1);--calcite-internal-animation-timing-fast:calc(100ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-medium:calc(200ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-slow:calc(300ms * var(--calcite-internal-duration-factor))}.calcite-animate{opacity:0;animation-fill-mode:both;animation-duration:var(--calcite-animation-timing)}.calcite-animate__in{animation-name:in}.calcite-animate__in-down{animation-name:in-down}.calcite-animate__in-up{animation-name:in-up}.calcite-animate__in-scale{animation-name:in-scale}@media (prefers-reduced-motion: reduce){:root{--calcite-internal-duration-factor:0}}:root{--calcite-floating-ui-transition:var(--calcite-animation-timing);--calcite-floating-ui-z-index:600}:host([hidden]){display:none}:host([disabled]){pointer-events:none;cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-ui-opacity-disabled)}:host{display:inline-block;inline-size:auto;vertical-align:middle}:host([round]){border-radius:50px}:host([round]) a,:host([round]) button{border-radius:50px}:host button,:host a{outline-color:transparent}:host button:focus,:host a:focus{outline:2px solid var(--calcite-ui-brand);outline-offset:2px}:host button,:host a{--calcite-button-content-margin-internal:0.5rem;--calcite-button-padding-x-internal:7px;--calcite-button-padding-y-internal:3px;padding-block:var(--calcite-button-padding-y-internal);padding-inline:var(--calcite-button-padding-x-internal);position:relative;box-sizing:border-box;display:flex;block-size:100%;inline-size:100%;cursor:pointer;-webkit-user-select:none;user-select:none;-webkit-appearance:none;appearance:none;align-items:center;justify-content:center;border-radius:0px;border-style:none;text-align:center;font-family:inherit;font-weight:var(--calcite-font-weight-normal);text-decoration-line:none;transition:color var(--calcite-animation-timing) ease-in-out, background-color var(--calcite-animation-timing) ease-in-out, box-shadow var(--calcite-animation-timing) ease-in-out, outline-color var(--calcite-internal-animation-timing-fast) ease-in-out}:host button:hover,:host a:hover{text-decoration-line:none}.content{display:flex;flex-basis:auto;margin-inline:var(--calcite-button-content-margin-internal)}.icon-start-empty .content{margin-inline-start:unset}.icon-end-empty .content{margin-inline-end:unset}:host([scale=m]) button,:host([scale=m]) a{--calcite-button-content-margin-internal:0.75rem}:host([scale=l]) button,:host([scale=l]) a{--calcite-button-content-margin-internal:1rem}:host([width=auto]){inline-size:auto}:host([width=half]){inline-size:50%}:host([width=full]){inline-size:100%}:host([alignment=center]:not([width=auto])) a,:host([alignment=center]:not([width=auto])) button{justify-content:center}:host([alignment=start]:not([width=auto])) a,:host([alignment=start]:not([width=auto])) button{justify-content:flex-start}:host([alignment=end]:not([width=auto])) a,:host([alignment=end]:not([width=auto])) button{justify-content:flex-end}:host([alignment*=space-between]:not([width=auto])) a,:host([alignment*=space-between]:not([width=auto])) button{justify-content:space-between}:host([alignment=icon-start-space-between]:not([width=auto])) .icon--start{margin-inline-end:auto}:host([alignment=icon-start-space-between]:not([width=auto])) a,:host([alignment=icon-start-space-between]:not([width=auto])) button{text-align:unset}:host([alignment=icon-end-space-between]:not([width=auto])) .icon--end{margin-inline-start:auto}:host([alignment=icon-end-space-between]:not([width=auto])) a,:host([alignment=icon-end-space-between]:not([width=auto])) button{text-align:unset}:host([alignment=center]) a:not(.content--slotted) .icon--start+.icon--end,:host([alignment=center]) button:not(.content--slotted) .icon--start+.icon--end{margin-inline-start:var(--calcite-button-content-margin-internal)}.icon{position:relative;margin:0px;display:inline-flex;font-weight:var(--calcite-font-weight-normal);line-height:inherit}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}:host([loading]){pointer-events:none}:host([loading]) button,:host([loading]) a{pointer-events:none;opacity:var(--calcite-ui-opacity-disabled)}@keyframes loader-in{0%{inline-size:0;opacity:0;transform:scale(0.5)}100%{inline-size:1em;opacity:1;transform:scale(1)}}@keyframes loader-out{0%{inline-size:1em;opacity:1;transform:scale(1)}100%{inline-size:0;opacity:0;transform:scale(0.5)}}.calcite-button--loader{display:flex}.calcite-button--loader calcite-loader{margin:0px;transition:inline-size var(--calcite-internal-animation-timing-slow) ease-in-out, opacity var(--calcite-internal-animation-timing-slow) ease-in-out, transform var(--calcite-internal-animation-timing-slow) ease-in-out}.calcite-button--loader calcite-loader.loading-in{animation-name:loader-in;animation-duration:var(--calcite-internal-animation-timing-slow)}.calcite-button--loader calcite-loader.loading-out{animation-name:loader-out;animation-duration:var(--calcite-internal-animation-timing-slow)}:host([loading]) button.content--slotted .calcite-button--loader calcite-loader,:host([loading]) a.content--slotted .calcite-button--loader calcite-loader{margin-inline-end:var(--calcite-button-content-margin-internal)}:host([loading]) button:not(.content--slotted) .icon--start,:host([loading]) button:not(.content--slotted) .icon--end,:host([loading]) a:not(.content--slotted) .icon--start,:host([loading]) a:not(.content--slotted) .icon--end{display:none}:host([appearance]) button,:host([appearance]) a{border-width:1px;border-style:solid;border-color:transparent}:host([kind=brand]) button,:host([kind=brand]) a{background-color:var(--calcite-ui-brand);color:var(--calcite-ui-text-inverse)}:host([kind=brand]) button:hover,:host([kind=brand]) button:focus,:host([kind=brand]) a:hover,:host([kind=brand]) a:focus{background-color:var(--calcite-ui-brand-hover)}:host([kind=brand]) button:active,:host([kind=brand]) a:active{background-color:var(--calcite-ui-brand-press)}:host([kind=brand]) button calcite-loader,:host([kind=brand]) a calcite-loader{color:var(--calcite-ui-text-inverse)}:host([kind=danger]) button,:host([kind=danger]) a{background-color:var(--calcite-ui-danger);color:var(--calcite-ui-text-inverse)}:host([kind=danger]) button:hover,:host([kind=danger]) button:focus,:host([kind=danger]) a:hover,:host([kind=danger]) a:focus{background-color:var(--calcite-ui-danger-hover)}:host([kind=danger]) button:active,:host([kind=danger]) a:active{background-color:var(--calcite-ui-danger-press)}:host([kind=danger]) button calcite-loader,:host([kind=danger]) a calcite-loader{color:var(--calcite-ui-text-inverse)}:host([kind=neutral]) button,:host([kind=neutral]) a{background-color:var(--calcite-ui-foreground-3);color:var(--calcite-ui-text-1)}:host([kind=neutral]) button:hover,:host([kind=neutral]) button:focus,:host([kind=neutral]) a:hover,:host([kind=neutral]) a:focus{background-color:var(--calcite-ui-foreground-2)}:host([kind=neutral]) button:active,:host([kind=neutral]) a:active{background-color:var(--calcite-ui-foreground-1)}:host([kind=neutral]) button calcite-loader,:host([kind=neutral]) a calcite-loader{color:var(--calcite-ui-text-1)}:host([kind=inverse]) button,:host([kind=inverse]) a{color:var(--calcite-ui-text-inverse);background-color:var(--calcite-ui-inverse)}:host([kind=inverse]) button:hover,:host([kind=inverse]) button:focus,:host([kind=inverse]) a:hover,:host([kind=inverse]) a:focus{background-color:var(--calcite-ui-inverse-hover)}:host([kind=inverse]) button:active,:host([kind=inverse]) a:active{background-color:var(--calcite-ui-inverse-press)}:host([kind=inverse]) button calcite-loader,:host([kind=inverse]) a calcite-loader{color:var(--calcite-ui-text-inverse)}:host([appearance=outline-fill]) button,:host([appearance=outline-fill]) a{border-width:1px;border-style:solid;background-color:var(--calcite-ui-foreground-1);box-shadow:inset 0 0 0 1px transparent}:host([appearance=outline-fill][kind=brand]) button,:host([appearance=outline-fill][kind=brand]) a{border-color:var(--calcite-ui-brand);background-color:var(--calcite-ui-foreground-1);color:var(--calcite-ui-brand)}:host([appearance=outline-fill][kind=brand]) button:hover,:host([appearance=outline-fill][kind=brand]) a:hover{border-color:var(--calcite-ui-brand-hover);color:var(--calcite-ui-brand-hover);box-shadow:inset 0 0 0 1px var(--calcite-ui-brand-hover)}:host([appearance=outline-fill][kind=brand]) button:focus,:host([appearance=outline-fill][kind=brand]) a:focus{border-color:var(--calcite-ui-brand);color:var(--calcite-ui-brand);box-shadow:inset 0 0 0 2px var(--calcite-ui-brand)}:host([appearance=outline-fill][kind=brand]) button:active,:host([appearance=outline-fill][kind=brand]) a:active{border-color:var(--calcite-ui-brand-press);color:var(--calcite-ui-brand-press);box-shadow:inset 0 0 0 2px var(--calcite-ui-brand-press)}:host([appearance=outline-fill][kind=brand]) button calcite-loader,:host([appearance=outline-fill][kind=brand]) a calcite-loader{color:var(--calcite-ui-brand)}:host([appearance=outline-fill][kind=danger]) button,:host([appearance=outline-fill][kind=danger]) a{border-color:var(--calcite-ui-danger);background-color:var(--calcite-ui-foreground-1);color:var(--calcite-ui-danger)}:host([appearance=outline-fill][kind=danger]) button:hover,:host([appearance=outline-fill][kind=danger]) a:hover{border-color:var(--calcite-ui-danger-hover);color:var(--calcite-ui-danger-hover);box-shadow:inset 0 0 0 1px var(--calcite-ui-danger-hover)}:host([appearance=outline-fill][kind=danger]) button:focus,:host([appearance=outline-fill][kind=danger]) a:focus{border-color:var(--calcite-ui-danger);color:var(--calcite-ui-danger);box-shadow:inset 0 0 0 2px var(--calcite-ui-danger)}:host([appearance=outline-fill][kind=danger]) button:active,:host([appearance=outline-fill][kind=danger]) a:active{border-color:var(--calcite-ui-danger-press);color:var(--calcite-ui-danger-press);box-shadow:inset 0 0 0 2px var(--calcite-ui-danger-press)}:host([appearance=outline-fill][kind=danger]) button calcite-loader,:host([appearance=outline-fill][kind=danger]) a calcite-loader{color:var(--calcite-ui-danger)}:host([appearance=outline-fill][kind=neutral]) button,:host([appearance=outline-fill][kind=neutral]) a{background-color:var(--calcite-ui-foreground-1);color:var(--calcite-ui-text-1);border-color:var(--calcite-ui-foreground-3)}:host([appearance=outline-fill][kind=neutral]) button:hover,:host([appearance=outline-fill][kind=neutral]) a:hover{box-shadow:inset 0 0 0 1px var(--calcite-ui-foreground-3)}:host([appearance=outline-fill][kind=neutral]) button:focus,:host([appearance=outline-fill][kind=neutral]) a:focus{box-shadow:inset 0 0 0 2px var(--calcite-ui-foreground-3)}:host([appearance=outline-fill][kind=neutral]) button:active,:host([appearance=outline-fill][kind=neutral]) a:active{box-shadow:inset 0 0 0 2px var(--calcite-ui-foreground-3)}:host([appearance=outline-fill][kind=neutral]) button calcite-loader,:host([appearance=outline-fill][kind=neutral]) a calcite-loader{color:var(--calcite-ui-text-1)}:host([appearance=outline-fill][kind=inverse]) button,:host([appearance=outline-fill][kind=inverse]) a{background-color:var(--calcite-ui-foreground-1);color:var(--calcite-ui-text-1);border-color:var(--calcite-ui-inverse)}:host([appearance=outline-fill][kind=inverse]) button:hover,:host([appearance=outline-fill][kind=inverse]) a:hover{border-color:var(--calcite-ui-inverse-hover);box-shadow:inset 0 0 0 1px var(--calcite-ui-inverse-hover)}:host([appearance=outline-fill][kind=inverse]) button:focus,:host([appearance=outline-fill][kind=inverse]) a:focus{border-color:var(--calcite-ui-inverse);box-shadow:inset 0 0 0 2px var(--calcite-ui-inverse)}:host([appearance=outline-fill][kind=inverse]) button:active,:host([appearance=outline-fill][kind=inverse]) a:active{border-color:var(--calcite-ui-inverse-press);box-shadow:inset 0 0 0 2px var(--calcite-ui-inverse-press)}:host([appearance=outline-fill][kind=inverse]) button calcite-loader,:host([appearance=outline-fill][kind=inverse]) a calcite-loader{color:var(--calcite-ui-text-1)}:host([appearance=outline]) button,:host([appearance=outline]) a{border-width:1px;border-style:solid;background-color:transparent;box-shadow:inset 0 0 0 1px transparent}:host([appearance=outline][kind=brand]) button,:host([appearance=outline][kind=brand]) a{border-color:var(--calcite-ui-brand);background-color:transparent;color:var(--calcite-ui-brand)}:host([appearance=outline][kind=brand]) button:hover,:host([appearance=outline][kind=brand]) a:hover{border-color:var(--calcite-ui-brand-hover);color:var(--calcite-ui-brand-hover);box-shadow:inset 0 0 0 1px var(--calcite-ui-brand-hover)}:host([appearance=outline][kind=brand]) button:focus,:host([appearance=outline][kind=brand]) a:focus{border-color:var(--calcite-ui-brand);color:var(--calcite-ui-brand);box-shadow:inset 0 0 0 2px var(--calcite-ui-brand)}:host([appearance=outline][kind=brand]) button:active,:host([appearance=outline][kind=brand]) a:active{border-color:var(--calcite-ui-brand-press);color:var(--calcite-ui-brand-press);box-shadow:inset 0 0 0 2px var(--calcite-ui-brand-press)}:host([appearance=outline][kind=brand]) button calcite-loader,:host([appearance=outline][kind=brand]) a calcite-loader{color:var(--calcite-ui-brand)}:host([appearance=outline][kind=danger]) button,:host([appearance=outline][kind=danger]) a{border-color:var(--calcite-ui-danger);background-color:transparent;color:var(--calcite-ui-danger)}:host([appearance=outline][kind=danger]) button:hover,:host([appearance=outline][kind=danger]) a:hover{border-color:var(--calcite-ui-danger-hover);color:var(--calcite-ui-danger-hover);box-shadow:inset 0 0 0 1px var(--calcite-ui-danger-hover)}:host([appearance=outline][kind=danger]) button:focus,:host([appearance=outline][kind=danger]) a:focus{border-color:var(--calcite-ui-danger);color:var(--calcite-ui-danger);box-shadow:inset 0 0 0 2px var(--calcite-ui-danger)}:host([appearance=outline][kind=danger]) button:active,:host([appearance=outline][kind=danger]) a:active{border-color:var(--calcite-ui-danger-press);color:var(--calcite-ui-danger-press);box-shadow:inset 0 0 0 2px var(--calcite-ui-danger-press)}:host([appearance=outline][kind=danger]) button calcite-loader,:host([appearance=outline][kind=danger]) a calcite-loader{color:var(--calcite-ui-danger)}:host([appearance=outline][kind=neutral]) button,:host([appearance=outline][kind=neutral]) a{background-color:transparent;color:var(--calcite-ui-text-1);border-color:var(--calcite-ui-border-1)}:host([appearance=outline][kind=neutral]) button:hover,:host([appearance=outline][kind=neutral]) a:hover{box-shadow:inset 0 0 0 1px var(--calcite-ui-foreground-3)}:host([appearance=outline][kind=neutral]) button:focus,:host([appearance=outline][kind=neutral]) a:focus{box-shadow:inset 0 0 0 2px var(--calcite-ui-foreground-3)}:host([appearance=outline][kind=neutral]) button:active,:host([appearance=outline][kind=neutral]) a:active{box-shadow:inset 0 0 0 2px var(--calcite-ui-foreground-3)}:host([appearance=outline][kind=neutral]) button calcite-loader,:host([appearance=outline][kind=neutral]) a calcite-loader{color:var(--calcite-ui-text-1)}:host([appearance=outline][kind=inverse]) button,:host([appearance=outline][kind=inverse]) a{background-color:transparent;color:var(--calcite-ui-text-1);border-color:var(--calcite-ui-inverse)}:host([appearance=outline][kind=inverse]) button:hover,:host([appearance=outline][kind=inverse]) a:hover{border-color:var(--calcite-ui-inverse-hover);box-shadow:inset 0 0 0 1px var(--calcite-ui-inverse-hover)}:host([appearance=outline][kind=inverse]) button:focus,:host([appearance=outline][kind=inverse]) a:focus{border-color:var(--calcite-ui-inverse);box-shadow:inset 0 0 0 2px var(--calcite-ui-inverse)}:host([appearance=outline][kind=inverse]) button:active,:host([appearance=outline][kind=inverse]) a:active{border-color:var(--calcite-ui-inverse-press);box-shadow:inset 0 0 0 2px var(--calcite-ui-inverse-press)}:host([appearance=outline][kind=inverse]) button calcite-loader,:host([appearance=outline][kind=inverse]) a calcite-loader{color:var(--calcite-ui-text-1)}:host([appearance=outline-fill][split-child=primary]) button,:host([appearance=outline][split-child=primary]) button{border-inline-end-width:0;border-inline-start-width:1px}:host([appearance=outline-fill][split-child=secondary]) button,:host([appearance=outline][split-child=secondary]) button{border-inline-start-width:0;border-inline-end-width:1px}:host([appearance=transparent]:not(.enable-editing-button)) button,:host([appearance=transparent]:not(.enable-editing-button)) a{background-color:transparent}:host([appearance=transparent]:not(.enable-editing-button)) button:hover,:host([appearance=transparent]:not(.enable-editing-button)) button:focus,:host([appearance=transparent]:not(.enable-editing-button)) a:hover,:host([appearance=transparent]:not(.enable-editing-button)) a:focus{background-color:var(--calcite-button-transparent-hover)}:host([appearance=transparent]:not(.enable-editing-button)) button:active,:host([appearance=transparent]:not(.enable-editing-button)) a:active{background-color:var(--calcite-button-transparent-press)}:host([appearance=transparent][kind=brand]) button,:host([appearance=transparent][kind=brand]) a{color:var(--calcite-ui-brand)}:host([appearance=transparent][kind=brand]) button:hover,:host([appearance=transparent][kind=brand]) a:hover{color:var(--calcite-ui-brand-hover)}:host([appearance=transparent][kind=brand]) button:focus,:host([appearance=transparent][kind=brand]) a:focus{color:var(--calcite-ui-brand)}:host([appearance=transparent][kind=brand]) button:active,:host([appearance=transparent][kind=brand]) a:active{color:var(--calcite-ui-brand-press)}:host([appearance=transparent][kind=brand]) button calcite-loader,:host([appearance=transparent][kind=brand]) a calcite-loader{color:var(--calcite-ui-brand)}:host([appearance=transparent][kind=danger]) button,:host([appearance=transparent][kind=danger]) a{color:var(--calcite-ui-danger)}:host([appearance=transparent][kind=danger]) button:hover,:host([appearance=transparent][kind=danger]) a:hover{color:var(--calcite-ui-danger-hover)}:host([appearance=transparent][kind=danger]) button:focus,:host([appearance=transparent][kind=danger]) a:focus{color:var(--calcite-ui-danger)}:host([appearance=transparent][kind=danger]) button:active,:host([appearance=transparent][kind=danger]) a:active{color:var(--calcite-ui-danger-press)}:host([appearance=transparent][kind=danger]) button calcite-loader,:host([appearance=transparent][kind=danger]) a calcite-loader{color:var(--calcite-ui-danger)}:host([appearance=transparent][kind=neutral]:not(.cancel-editing-button)) button,:host([appearance=transparent][kind=neutral]:not(.cancel-editing-button)) a,:host([appearance=transparent][kind=neutral]:not(.cancel-editing-button)) calcite-loader{color:var(--calcite-ui-text-1)}:host([appearance=transparent][kind=neutral].cancel-editing-button) button{border-block-start-width:1px;border-block-end-width:1px;color:var(--calcite-ui-text-3);border-block-start-color:var(--calcite-ui-border-input);border-block-end-color:var(--calcite-ui-border-input);border-block-style:solid}:host([appearance=transparent][kind=neutral].cancel-editing-button) button:not(.content--slotted){--calcite-button-padding-y-internal:0}:host([appearance=transparent][kind=neutral].cancel-editing-button) button:hover{color:var(--calcite-ui-text-1)}:host([appearance=transparent][kind=neutral].enable-editing-button) button{background-color:transparent}:host(.confirm-changes-button) button:focus,:host(.cancel-editing-button) button:focus,:host(.enable-editing-button) button:focus{outline-offset:-2px}:host([appearance=transparent][kind=inverse]) button,:host([appearance=transparent][kind=inverse]) a,:host([appearance=transparent][kind=inverse]) calcite-loader{color:var(--calcite-ui-text-inverse)}:host([scale=s]) button.content--slotted,:host([scale=s]) a.content--slotted{font-size:var(--calcite-font-size--2);line-height:1rem}:host([scale=s][appearance=transparent]) button.content--slotted,:host([scale=s][appearance=transparent]) a.content--slotted{--calcite-button-padding-x-internal:0.5rem}:host([scale=s]) button,:host([scale=s]) a{--calcite-button-padding-y-internal:3px}:host([scale=m]) button.content--slotted,:host([scale=m]) a.content--slotted{--calcite-button-padding-x-internal:11px;font-size:var(--calcite-font-size--1);line-height:1rem}:host([scale=m]) button,:host([scale=m]) a{--calcite-button-padding-y-internal:7px}:host([scale=m][appearance=transparent]) button.content--slotted,:host([scale=m][appearance=transparent]) a.content--slotted{--calcite-button-padding-x-internal:0.75rem}:host([scale=l]) button.content--slotted,:host([scale=l]) a.content--slotted{--calcite-button-padding-x-internal:15px;font-size:var(--calcite-font-size-0);line-height:1.25rem}:host([scale=l]) .button-padding{--calcite-button-padding-x-internal:1rem;--calcite-button-padding-y-internal:11px}:host([scale=l]) .button-padding--shrunk{--calcite-button-padding-y-internal:9px}:host([scale=s]) button:not(.content--slotted),:host([scale=s]) a:not(.content--slotted){--calcite-button-padding-x-internal:0.125rem;--calcite-button-padding-y-internal:3px;inline-size:1.5rem;font-size:var(--calcite-font-size-0);line-height:1.25rem;min-block-size:1.5rem}:host([scale=m]) button:not(.content--slotted),:host([scale=m]) a:not(.content--slotted){--calcite-button-padding-x-internal:0.125rem;--calcite-button-padding-y-internal:7px;inline-size:2rem;font-size:var(--calcite-font-size-0);line-height:1.25rem;min-block-size:2rem}:host([scale=l]) button:not(.content--slotted),:host([scale=l]) a:not(.content--slotted){--calcite-button-padding-x-internal:0.125rem;--calcite-button-padding-y-internal:9px;inline-size:2.75rem;font-size:var(--calcite-font-size-0);line-height:1.25rem;min-block-size:2.75rem}:host([scale=l][appearance=transparent]) button:not(.content--slotted),:host([scale=l][appearance=transparent]) a:not(.content--slotted){--calcite-button-padding-y-internal:0.625rem}:host([scale=s][icon-start][icon-end]) button:not(.content--slotted),:host([scale=s][icon-start][icon-end]) a:not(.content--slotted){--calcite-button-padding-x-internal:23px;block-size:1.5rem;font-size:var(--calcite-font-size-0);line-height:1.25rem}:host([scale=s][icon-start][icon-end][appearance=transparent]) button:not(.content--slotted),:host([scale=s][icon-start][icon-end][appearance=transparent]) a:not(.content--slotted){--calcite-button-padding-x-internal:1.5rem}:host([scale=m][icon-start][icon-end]) button:not(.content--slotted),:host([scale=m][icon-start][icon-end]) a:not(.content--slotted){--calcite-button-padding-x-internal:2rem;block-size:2rem;font-size:var(--calcite-font-size-0);line-height:1.25rem}:host([scale=m][icon-start][icon-end][appearance=transparent]) button:not(.content--slotted),:host([scale=m][icon-start][icon-end][appearance=transparent]) a:not(.content--slotted){--calcite-button-padding-x-internal:33px}:host([scale=l][icon-start][icon-end]) button:not(.content--slotted),:host([scale=l][icon-start][icon-end]) a:not(.content--slotted){--calcite-button-padding-x-internal:43px;block-size:2.75rem;font-size:var(--calcite-font-size-0);line-height:1.25rem}:host([scale=l][icon-start][icon-end]) button:not(.content--slotted) .icon--start+.icon--end,:host([scale=l][icon-start][icon-end]) a:not(.content--slotted) .icon--start+.icon--end{margin-inline-start:1rem}:host([scale=l][icon-start][icon-end][appearance=transparent]) button:not(.content--slotted),:host([scale=l][icon-start][icon-end][appearance=transparent]) a:not(.content--slotted){--calcite-button-padding-x-internal:2.75rem}",qge=yN(class extends vN{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.mutationObserver=wN("mutation",()=>this.updateHasContent()),this.handleClick=()=>{const{type:i}=this;this.href||(i==="submit"?lge(this):i==="reset"&&cge(this))},this.alignment="center",this.appearance="solid",this.label=void 0,this.kind="brand",this.disabled=!1,this.href=void 0,this.iconEnd=void 0,this.iconFlipRtl=void 0,this.iconStart=void 0,this.loading=!1,this.name=void 0,this.rel=void 0,this.round=!1,this.scale="m",this.splitChild=!1,this.target=void 0,this.type="button",this.width="auto",this.messages=void 0,this.messageOverrides=void 0,this.hasContent=!1,this.hasLoader=!1,this.effectiveLocale="",this.defaultMessages=void 0}loadingChanged(i,e){i&&!e&&(this.hasLoader=!0),!i&&e&&window.setTimeout(()=>{this.hasLoader=!1},300)}onMessagesChange(){}async connectedCallback(){Rge(this),Dge(this),this.hasLoader=this.loading,this.setupTextContentObserver(),NX(this),this.formEl=Qx(this.el,"form")}disconnectedCallback(){var i;(i=this.mutationObserver)==null||i.disconnect(),mge(this),Oge(this),Fge(this),this.formEl=null}async componentWillLoad(){vge(this),mN.isBrowser&&(this.updateHasContent(),await Lge(this))}componentDidLoad(){bge(this)}componentDidRender(){uge(this)}render(){const i=this.href?"a":"button",e=i,t=this.hasLoader?Cr("div",{class:Co.buttonLoader},Cr("calcite-loader",{class:this.loading?Co.loadingIn:Co.loadingOut,inline:!0,label:this.messages.loading,scale:this.scale==="l"?"m":"s"})):null,r=!this.iconStart&&!this.iconEnd,n=Cr("calcite-icon",{class:{[Co.icon]:!0,[Co.iconStart]:!0},flipRtl:this.iconFlipRtl==="start"||this.iconFlipRtl==="both",icon:this.iconStart,scale:this.scale==="l"?"m":"s"}),s=Cr("calcite-icon",{class:{[Co.icon]:!0,[Co.iconEnd]:!0},flipRtl:this.iconFlipRtl==="end"||this.iconFlipRtl==="both",icon:this.iconEnd,scale:this.scale==="l"?"m":"s"}),a=Cr("span",{class:Co.content},Cr("slot",null));return Cr(e,{"aria-label":fge(this),class:{[Co.buttonPadding]:r,[Co.buttonPaddingShrunk]:!r,[Co.contentSlotted]:this.hasContent,[Co.iconStartEmpty]:!this.iconStart,[Co.iconEndEmpty]:!this.iconEnd},disabled:this.disabled||this.loading,href:i==="a"&&this.href,name:i==="button"&&this.name,onClick:this.handleClick,ref:o=>this.childEl=o,rel:i==="a"&&this.rel,tabIndex:this.disabled||this.loading?-1:null,target:i==="a"&&this.target,type:i==="button"&&this.type},t,this.iconStart?n:null,this.hasContent?a:null,this.iconEnd?s:null)}async setFocus(){var i;await wge(this),(i=this.childEl)==null||i.focus()}effectiveLocaleChange(){$ge(this,this.effectiveLocale)}updateHasContent(){var e,t;const i=this.el.textContent.trim().length>0||this.el.childNodes.length>0;this.hasContent=this.el.childNodes.length===1&&((e=this.el.childNodes[0])==null?void 0:e.nodeName)==="#text"?((t=this.el.textContent)==null?void 0:t.trim().length)>0:i}setupTextContentObserver(){var i;(i=this.mutationObserver)==null||i.observe(this.el,{childList:!0,subtree:!0})}onLabelClick(){this.handleClick(),this.setFocus()}static get assetsDirs(){return["assets"]}get el(){return this}static get watchers(){return{loading:["loadingChanged"],messageOverrides:["onMessagesChange"],effectiveLocale:["effectiveLocaleChange"]}}static get style(){return jge}},[1,"calcite-button",{alignment:[513],appearance:[513],label:[1],kind:[513],disabled:[516],href:[513],iconEnd:[513,"icon-end"],iconFlipRtl:[513,"icon-flip-rtl"],iconStart:[513,"icon-start"],loading:[516],name:[513],rel:[513],round:[516],scale:[513],splitChild:[520,"split-child"],target:[513],type:[1537],width:[513],messages:[1040],messageOverrides:[1040],hasContent:[32],hasLoader:[32],effectiveLocale:[32],defaultMessages:[32],setFocus:[64]}]);function Wge(){if(typeof customElements>"u")return;["calcite-button","calcite-icon","calcite-loader"].forEach(e=>{switch(e){case"calcite-button":customElements.get(e)||customElements.define(e,qge);break;case"calcite-icon":customElements.get(e)||BX();break;case"calcite-loader":customElements.get(e)||GX();break}})}Wge();const Xge=i=>i.toLowerCase().split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(""),HX=i=>i.replace(/([A-Z])/g,e=>`-${e[0].toLowerCase()}`),Qge=(i,e,t={})=>{if(i instanceof Element){const r=Zge(i.classList,e,t);r!==""&&(i.className=r),Object.keys(e).forEach(n=>{if(!(n==="children"||n==="style"||n==="ref"||n==="class"||n==="className"||n==="forwardedRef"))if(n.indexOf("on")===0&&n[2]===n[2].toUpperCase()){const s=n.substring(2),a=s[0].toLowerCase()+s.substring(1);jX(a)||Yge(i,a,e[n])}else i[n]=e[n],typeof e[n]==="string"&&i.setAttribute(HX(n),e[n])})}},Zge=(i,e,t)=>{const r=e.className||e.class,n=t.className||t.class,s=oO(i),a=oO(r?r.split(" "):[]),o=oO(n?n.split(" "):[]),l=[];return s.forEach(c=>{a.has(c)?(l.push(c),a.delete(c)):o.has(c)||l.push(c)}),a.forEach(c=>l.push(c)),l.join(" ")};/**
 * Checks if an event is supported in the current execution environment.
 * @license Modernizr 3.0.0pre (Custom Build) | MIT
 */const jX=i=>{if(typeof document>"u")return!0;{const e="on"+i;let t=e in document;if(!t){const r=document.createElement("div");r.setAttribute(e,"return;"),t=typeof r[e]=="function"}return t}},Yge=(i,e,t)=>{const r=i.__events||(i.__events={}),n=r[e];n&&i.removeEventListener(e,n),i.addEventListener(e,r[e]=function(a){t&&t.call(this,a)})},oO=i=>{const e=new Map;return i.forEach(t=>e.set(t,t)),e},Kge=(i,e)=>{typeof i=="function"?i(e):i!=null&&(i.current=e)},Jge=(...i)=>e=>{i.forEach(t=>{Kge(t,e)})},e_e=(i,e)=>{const t=(r,n)=>Mw.createElement(i,Object.assign({},r,{forwardedRef:n}));return t.displayName=e,Mw.forwardRef(t)};var t_e=globalThis&&globalThis.__rest||function(i,e){var t={};for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&e.indexOf(r)<0&&(t[r]=i[r]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(i);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(i,r[n])&&(t[r[n]]=i[r[n]]);return t};const i_e=(i,e,t,r)=>{r!==void 0&&r();const n=Xge(i),s=class extends Mw.Component{constructor(a){super(a),this.setComponentElRef=o=>{this.componentEl=o}}componentDidMount(){this.componentDidUpdate(this.props)}componentDidUpdate(a){Qge(this.componentEl,this.props,a)}render(){const a=this.props,{children:o,forwardedRef:l,style:c,className:u,ref:d}=a,m=t_e(a,["children","forwardedRef","style","className","ref"]);let f=Object.keys(m).reduce((g,x)=>{const b=m[x];if(x.indexOf("on")===0&&x[2]===x[2].toUpperCase()){const v=x.substring(2).toLowerCase();typeof document<"u"&&jX(v)&&(g[x]=b)}else{const v=typeof b;(v==="string"||v==="boolean"||v==="number")&&(g[HX(x)]=b)}return g},{});t&&(f=t(this.props,f));const _=Object.assign(Object.assign({},f),{ref:Jge(l,this.setComponentElRef),style:c});return Pe.createElement(i,_,o)}static get displayName(){return n}};return e&&(s.contextType=e),e_e(s,n)},Y1=i_e("calcite-button");var oL={},r_e={get exports(){return oL},set exports(i){oL=i}};(function(i){var e=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:{};/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var t=function(r){var n=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,s=0,a={},o={manual:r.Prism&&r.Prism.manual,disableWorkerMessageHandler:r.Prism&&r.Prism.disableWorkerMessageHandler,util:{encode:function v(w){return w instanceof l?new l(w.type,v(w.content),w.alias):Array.isArray(w)?w.map(v):w.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(v){return Object.prototype.toString.call(v).slice(8,-1)},objId:function(v){return v.__id||Object.defineProperty(v,"__id",{value:++s}),v.__id},clone:function v(w,T){T=T||{};var E,C;switch(o.util.type(w)){case"Object":if(C=o.util.objId(w),T[C])return T[C];E={},T[C]=E;for(var A in w)w.hasOwnProperty(A)&&(E[A]=v(w[A],T));return E;case"Array":return C=o.util.objId(w),T[C]?T[C]:(E=[],T[C]=E,w.forEach(function(M,I){E[I]=v(M,T)}),E);default:return w}},getLanguage:function(v){for(;v;){var w=n.exec(v.className);if(w)return w[1].toLowerCase();v=v.parentElement}return"none"},setLanguage:function(v,w){v.className=v.className.replace(RegExp(n,"gi"),""),v.classList.add("language-"+w)},currentScript:function(){if(typeof document>"u")return null;if("currentScript"in document&&1<2)return document.currentScript;try{throw new Error}catch(E){var v=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(E.stack)||[])[1];if(v){var w=document.getElementsByTagName("script");for(var T in w)if(w[T].src==v)return w[T]}return null}},isActive:function(v,w,T){for(var E="no-"+w;v;){var C=v.classList;if(C.contains(w))return!0;if(C.contains(E))return!1;v=v.parentElement}return!!T}},languages:{plain:a,plaintext:a,text:a,txt:a,extend:function(v,w){var T=o.util.clone(o.languages[v]);for(var E in w)T[E]=w[E];return T},insertBefore:function(v,w,T,E){E=E||o.languages;var C=E[v],A={};for(var M in C)if(C.hasOwnProperty(M)){if(M==w)for(var I in T)T.hasOwnProperty(I)&&(A[I]=T[I]);T.hasOwnProperty(M)||(A[M]=C[M])}var L=E[v];return E[v]=A,o.languages.DFS(o.languages,function(U,j){j===L&&U!=v&&(this[U]=A)}),A},DFS:function v(w,T,E,C){C=C||{};var A=o.util.objId;for(var M in w)if(w.hasOwnProperty(M)){T.call(w,M,w[M],E||M);var I=w[M],L=o.util.type(I);L==="Object"&&!C[A(I)]?(C[A(I)]=!0,v(I,T,null,C)):L==="Array"&&!C[A(I)]&&(C[A(I)]=!0,v(I,T,M,C))}}},plugins:{},highlightAll:function(v,w){o.highlightAllUnder(document,v,w)},highlightAllUnder:function(v,w,T){var E={callback:T,container:v,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};o.hooks.run("before-highlightall",E),E.elements=Array.prototype.slice.apply(E.container.querySelectorAll(E.selector)),o.hooks.run("before-all-elements-highlight",E);for(var C=0,A;A=E.elements[C++];)o.highlightElement(A,w===!0,E.callback)},highlightElement:function(v,w,T){var E=o.util.getLanguage(v),C=o.languages[E];o.util.setLanguage(v,E);var A=v.parentElement;A&&A.nodeName.toLowerCase()==="pre"&&o.util.setLanguage(A,E);var M=v.textContent,I={element:v,language:E,grammar:C,code:M};function L(j){I.highlightedCode=j,o.hooks.run("before-insert",I),I.element.innerHTML=I.highlightedCode,o.hooks.run("after-highlight",I),o.hooks.run("complete",I),T&&T.call(I.element)}if(o.hooks.run("before-sanity-check",I),A=I.element.parentElement,A&&A.nodeName.toLowerCase()==="pre"&&!A.hasAttribute("tabindex")&&A.setAttribute("tabindex","0"),!I.code){o.hooks.run("complete",I),T&&T.call(I.element);return}if(o.hooks.run("before-highlight",I),!I.grammar){L(o.util.encode(I.code));return}if(w&&r.Worker){var U=new Worker(o.filename);U.onmessage=function(j){L(j.data)},U.postMessage(JSON.stringify({language:I.language,code:I.code,immediateClose:!0}))}else L(o.highlight(I.code,I.grammar,I.language))},highlight:function(v,w,T){var E={code:v,grammar:w,language:T};if(o.hooks.run("before-tokenize",E),!E.grammar)throw new Error('The language "'+E.language+'" has no grammar.');return E.tokens=o.tokenize(E.code,E.grammar),o.hooks.run("after-tokenize",E),l.stringify(o.util.encode(E.tokens),E.language)},tokenize:function(v,w){var T=w.rest;if(T){for(var E in T)w[E]=T[E];delete w.rest}var C=new d;return m(C,C.head,v),u(v,C,w,C.head,0),_(C)},hooks:{all:{},add:function(v,w){var T=o.hooks.all;T[v]=T[v]||[],T[v].push(w)},run:function(v,w){var T=o.hooks.all[v];if(!(!T||!T.length))for(var E=0,C;C=T[E++];)C(w)}},Token:l};r.Prism=o;function l(v,w,T,E){this.type=v,this.content=w,this.alias=T,this.length=(E||"").length|0}l.stringify=function v(w,T){if(typeof w=="string")return w;if(Array.isArray(w)){var E="";return w.forEach(function(L){E+=v(L,T)}),E}var C={type:w.type,content:v(w.content,T),tag:"span",classes:["token",w.type],attributes:{},language:T},A=w.alias;A&&(Array.isArray(A)?Array.prototype.push.apply(C.classes,A):C.classes.push(A)),o.hooks.run("wrap",C);var M="";for(var I in C.attributes)M+=" "+I+'="'+(C.attributes[I]||"").replace(/"/g,"&quot;")+'"';return"<"+C.tag+' class="'+C.classes.join(" ")+'"'+M+">"+C.content+"</"+C.tag+">"};function c(v,w,T,E){v.lastIndex=w;var C=v.exec(T);if(C&&E&&C[1]){var A=C[1].length;C.index+=A,C[0]=C[0].slice(A)}return C}function u(v,w,T,E,C,A){for(var M in T)if(!(!T.hasOwnProperty(M)||!T[M])){var I=T[M];I=Array.isArray(I)?I:[I];for(var L=0;L<I.length;++L){if(A&&A.cause==M+","+L)return;var U=I[L],j=U.inside,re=!!U.lookbehind,ee=!!U.greedy,H=U.alias;if(ee&&!U.pattern.global){var V=U.pattern.toString().match(/[imsuy]*$/)[0];U.pattern=RegExp(U.pattern.source,V+"g")}for(var X=U.pattern||U,$=E.next,B=C;$!==w.tail&&!(A&&B>=A.reach);B+=$.value.length,$=$.next){var W=$.value;if(w.length>v.length)return;if(!(W instanceof l)){var te=1,ie;if(ee){if(ie=c(X,B,v,re),!ie||ie.index>=v.length)break;var Re=ie.index,Y=ie.index+ie[0].length,se=B;for(se+=$.value.length;Re>=se;)$=$.next,se+=$.value.length;if(se-=$.value.length,B=se,$.value instanceof l)continue;for(var Ee=$;Ee!==w.tail&&(se<Y||typeof Ee.value=="string");Ee=Ee.next)te++,se+=Ee.value.length;te--,W=v.slice(B,se),ie.index-=B}else if(ie=c(X,0,W,re),!ie)continue;var Re=ie.index,Ie=ie[0],Ue=W.slice(0,Re),ye=W.slice(Re+Ie.length),we=B+W.length;A&&we>A.reach&&(A.reach=we);var $e=$.prev;Ue&&($e=m(w,$e,Ue),B+=Ue.length),f(w,$e,te);var st=new l(M,j?o.tokenize(Ie,j):Ie,H,Ie);if($=m(w,$e,st),ye&&m(w,$,ye),te>1){var vt={cause:M+","+L,reach:we};u(v,w,T,$.prev,B,vt),A&&vt.reach>A.reach&&(A.reach=vt.reach)}}}}}}function d(){var v={value:null,prev:null,next:null},w={value:null,prev:v,next:null};v.next=w,this.head=v,this.tail=w,this.length=0}function m(v,w,T){var E=w.next,C={value:T,prev:w,next:E};return w.next=C,E.prev=C,v.length++,C}function f(v,w,T){for(var E=w.next,C=0;C<T&&E!==v.tail;C++)E=E.next;w.next=E,E.prev=w,v.length-=C}function _(v){for(var w=[],T=v.head.next;T!==v.tail;)w.push(T.value),T=T.next;return w}if(!r.document)return r.addEventListener&&(o.disableWorkerMessageHandler||r.addEventListener("message",function(v){var w=JSON.parse(v.data),T=w.language,E=w.code,C=w.immediateClose;r.postMessage(o.highlight(E,o.languages[T],T)),C&&r.close()},!1)),o;var g=o.util.currentScript();g&&(o.filename=g.src,g.hasAttribute("data-manual")&&(o.manual=!0));function x(){o.manual||o.highlightAll()}if(!o.manual){var b=document.readyState;b==="loading"||b==="interactive"&&g&&g.defer?document.addEventListener("DOMContentLoaded",x):window.requestAnimationFrame?window.requestAnimationFrame(x):window.setTimeout(x,16)}return o}(e);i.exports&&(i.exports=t),typeof ik<"u"&&(ik.Prism=t),t.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},t.languages.markup.tag.inside["attr-value"].inside.entity=t.languages.markup.entity,t.languages.markup.doctype.inside["internal-subset"].inside=t.languages.markup,t.hooks.add("wrap",function(r){r.type==="entity"&&(r.attributes.title=r.content.replace(/&amp;/,"&"))}),Object.defineProperty(t.languages.markup.tag,"addInlined",{value:function(n,s){var a={};a["language-"+s]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:t.languages[s]},a.cdata=/^<!\[CDATA\[|\]\]>$/i;var o={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:a}};o["language-"+s]={pattern:/[\s\S]+/,inside:t.languages[s]};var l={};l[n]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return n}),"i"),lookbehind:!0,greedy:!0,inside:o},t.languages.insertBefore("markup","cdata",l)}}),Object.defineProperty(t.languages.markup.tag,"addAttribute",{value:function(r,n){t.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+r+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[n,"language-"+n],inside:t.languages[n]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),t.languages.html=t.languages.markup,t.languages.mathml=t.languages.markup,t.languages.svg=t.languages.markup,t.languages.xml=t.languages.extend("markup",{}),t.languages.ssml=t.languages.xml,t.languages.atom=t.languages.xml,t.languages.rss=t.languages.xml,function(r){var n=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;r.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+n.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+n.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+n.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+n.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:n,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},r.languages.css.atrule.inside.rest=r.languages.css;var s=r.languages.markup;s&&(s.tag.addInlined("style","css"),s.tag.addAttribute("style","css"))}(t),t.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},t.languages.javascript=t.languages.extend("clike",{"class-name":[t.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),t.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,t.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:t.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:t.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:t.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:t.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:t.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),t.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:t.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),t.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),t.languages.markup&&(t.languages.markup.tag.addInlined("script","javascript"),t.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),t.languages.js=t.languages.javascript,function(){if(typeof t>"u"||typeof document>"u")return;Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var r="Loading",n=function(g,x){return" Error "+g+" while fetching file: "+x},s=" Error: File does not exist or is empty",a={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},o="data-src-status",l="loading",c="loaded",u="failed",d="pre[data-src]:not(["+o+'="'+c+'"]):not(['+o+'="'+l+'"])';function m(g,x,b){var v=new XMLHttpRequest;v.open("GET",g,!0),v.onreadystatechange=function(){v.readyState==4&&(v.status<400&&v.responseText?x(v.responseText):v.status>=400?b(n(v.status,v.statusText)):b(s))},v.send(null)}function f(g){var x=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(g||"");if(x){var b=Number(x[1]),v=x[2],w=x[3];return v?w?[b,Number(w)]:[b,void 0]:[b,b]}}t.hooks.add("before-highlightall",function(g){g.selector+=", "+d}),t.hooks.add("before-sanity-check",function(g){var x=g.element;if(x.matches(d)){g.code="",x.setAttribute(o,l);var b=x.appendChild(document.createElement("CODE"));b.textContent=r;var v=x.getAttribute("data-src"),w=g.language;if(w==="none"){var T=(/\.(\w+)$/.exec(v)||[,"none"])[1];w=a[T]||T}t.util.setLanguage(b,w),t.util.setLanguage(x,w);var E=t.plugins.autoloader;E&&E.loadLanguages(w),m(v,function(C){x.setAttribute(o,c);var A=f(x.getAttribute("data-range"));if(A){var M=C.split(/\r\n?|\n/g),I=A[0],L=A[1]==null?M.length:A[1];I<0&&(I+=M.length),I=Math.max(0,Math.min(I-1,M.length)),L<0&&(L+=M.length),L=Math.max(0,Math.min(L,M.length)),C=M.slice(I,L).join(`
`),x.hasAttribute("data-start")||x.setAttribute("data-start",String(I+1))}b.textContent=C,t.highlightElement(b)},function(C){x.setAttribute(o,u),b.textContent=C})}}),t.plugins.fileHighlight={highlight:function(x){for(var b=(x||document).querySelectorAll(d),v=0,w;w=b[v++];)t.highlightElement(w)}};var _=!1;t.fileHighlight=function(){_||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),_=!0),t.plugins.fileHighlight.highlight.apply(this,arguments)}}()})(r_e);const qX=oL;(function(){if(typeof Prism>"u"||typeof document>"u")return;var i="line-numbers",e=/\n(?!$)/g,t=Prism.plugins.lineNumbers={getLine:function(a,o){if(!(a.tagName!=="PRE"||!a.classList.contains(i))){var l=a.querySelector(".line-numbers-rows");if(l){var c=parseInt(a.getAttribute("data-start"),10)||1,u=c+(l.children.length-1);o<c&&(o=c),o>u&&(o=u);var d=o-c;return l.children[d]}}},resize:function(a){r([a])},assumeViewportIndependence:!0};function r(a){if(a=a.filter(function(l){var c=n(l),u=c["white-space"];return u==="pre-wrap"||u==="pre-line"}),a.length!=0){var o=a.map(function(l){var c=l.querySelector("code"),u=l.querySelector(".line-numbers-rows");if(!(!c||!u)){var d=l.querySelector(".line-numbers-sizer"),m=c.textContent.split(e);d||(d=document.createElement("span"),d.className="line-numbers-sizer",c.appendChild(d)),d.innerHTML="0",d.style.display="block";var f=d.getBoundingClientRect().height;return d.innerHTML="",{element:l,lines:m,lineHeights:[],oneLinerHeight:f,sizer:d}}}).filter(Boolean);o.forEach(function(l){var c=l.sizer,u=l.lines,d=l.lineHeights,m=l.oneLinerHeight;d[u.length-1]=void 0,u.forEach(function(f,_){if(f&&f.length>1){var g=c.appendChild(document.createElement("span"));g.style.display="block",g.textContent=f}else d[_]=m})}),o.forEach(function(l){for(var c=l.sizer,u=l.lineHeights,d=0,m=0;m<u.length;m++)u[m]===void 0&&(u[m]=c.children[d++].getBoundingClientRect().height)}),o.forEach(function(l){var c=l.sizer,u=l.element.querySelector(".line-numbers-rows");c.style.display="none",c.innerHTML="",l.lineHeights.forEach(function(d,m){u.children[m].style.height=d+"px"})})}}function n(a){return a?window.getComputedStyle?getComputedStyle(a):a.currentStyle||null:null}var s=void 0;window.addEventListener("resize",function(){t.assumeViewportIndependence&&s===window.innerWidth||(s=window.innerWidth,r(Array.prototype.slice.call(document.querySelectorAll("pre."+i))))}),Prism.hooks.add("complete",function(a){if(a.code){var o=a.element,l=o.parentNode;if(!(!l||!/pre/i.test(l.nodeName))&&!o.querySelector(".line-numbers-rows")&&Prism.util.isActive(o,i)){o.classList.remove(i),l.classList.add(i);var c=a.code.match(e),u=c?c.length+1:1,d,m=new Array(u+1).join("<span></span>");d=document.createElement("span"),d.setAttribute("aria-hidden","true"),d.className="line-numbers-rows",d.innerHTML=m,l.hasAttribute("data-start")&&(l.style.counterReset="linenumber "+(parseInt(l.getAttribute("data-start"),10)-1)),a.element.appendChild(d),r([l]),Prism.hooks.run("line-numbers",a)}}}),Prism.hooks.add("line-numbers",function(a){a.plugins=a.plugins||{},a.plugins.lineNumbers=!0})})();function n_e(){const i=Pe.useRef(null),e=Pe.useRef(null),t=Pe.useRef(null),r=Pe.useRef(null),n=Pe.useRef(null),[s,a]=Pe.useState(null),[o,l]=Pe.useState(null);Pe.useEffect(()=>{c()},[]);async function c(){if(qX.highlightAll(),!(i!=null&&i.current))return;Sg.portalUrl="http://arcgis.com/";const v=new lR({basemap:{portalItem:{id:"3582b744bba84668b52a16b0b6942544"}}}),w=new lX({container:i==null?void 0:i.current,map:v,zoom:10,center:[-89.93307,29.973197296501905],constraints:{snapToZoom:!1,minScale:1155582}});w.ui.add([new Z1({view:w,content:e==null?void 0:e.current,expanded:!0,group:"group1",expandTooltip:"MediaLayer"}),new Z1({view:w,content:t==null?void 0:t.current,group:"group1",expandTooltip:"ExtentAndRotationGeoreference"}),new Z1({view:w,content:r==null?void 0:r.current,group:"group1",expandTooltip:"CornersGeoreference"}),new Z1({view:w,content:n==null?void 0:n.current,group:"group1",expandTooltip:"ControlPointsGeoreference"})],"top-left"),a(w)}async function u(){const v=new X1({image:"https://arcgis.github.io/arcgis-samples-javascript/sample-data/media-layer/new-orleans/chef-menteur1892.png",georeference:new E2({extent:new ui({spatialReference:{wkid:102100},xmax:-100032576023701e-7,xmin:-10043731008847024e-9,ymax:3513936582106864e-9,ymin:3.4867731082574953e6})})}),w=new pX({source:[v]});s.map.layers.add(w),await s.when(),await w.when(),l(w);const T=new ufe({leadingLayers:[w],position:80,view:s});s.ui.add(T),s==null||s.goTo(new ui({spatialReference:{wkid:102100},xmax:-100032576023701e-7,xmin:-10043731008847024e-9,ymax:3513936582106864e-9,ymin:3.4867731082574953e6}).expand(1.5))}function d(){const v=new X1({image:"https://arcgis.github.io/arcgis-samples-javascript/sample-data/media-layer/new-orleans/neworleans1891.png",georeference:new E2({extent:new ui({spatialReference:{wkid:102100},xmin:-1004745627662979e-8,ymin:3.4867222723874687e6,xmax:-10006982870152846e-9,ymax:351446891365495e-8})})});o.source.elements.add(v),s==null||s.goTo(new ui({spatialReference:{wkid:102100},xmin:-1004745627662979e-8,ymin:3.4867222723874687e6,xmax:-10006982870152846e-9,ymax:351446891365495e-8}).expand(1.5))}function m(){const v=new X1({image:"https://arcgis.github.io/arcgis-samples-javascript/sample-data/media-layer/new-orleans/spanish-fort1891.png",georeference:new hX({bottomRight:new Ne({x:-10008215143195309e-9,y:3.4867942321162825e6,spatialReference:{wkid:102100}}),bottomLeft:new Ne({x:-1006146693004702e-8,y:3.4867942321162825e6,spatialReference:{wkid:102100}}),topRight:new Ne({x:-10008215143195309e-9,y:3.5144184006159767e6,spatialReference:{wkid:102100}}),topLeft:new Ne({x:-1006146693004702e-8,y:3.5144184006159767e6,spatialReference:{wkid:102100}})})});o.source.elements.add(v),s==null||s.goTo(new ui({spatialReference:{wkid:102100},xmax:-10008215143195309e-9,xmin:-1006146693004702e-8,ymax:3.5144184006159767e6,ymin:3.4867942321162825e6}).expand(1.5))}function f(){const v=new X1({image:"https://arcgis.github.io/arcgis-samples-javascript/sample-data/media-layer/new-orleans/st-bernard1892.png",georeference:new cX({width:1246,height:669,controlPoints:[{sourcePoint:{x:0,y:669},mapPoint:new Ne({x:-10046739695935503e-9,y:3486942691935667e-9,spatialReference:{wkid:102100}})},{sourcePoint:{x:0,y:0},mapPoint:new Ne({x:-10046739695935503e-9,y:3514979040597104e-9,spatialReference:{wkid:102100}})},{sourcePoint:{x:1246,y:0},mapPoint:new Ne({x:-10001415789436923e-9,y:3514979040597104e-9,spatialReference:{wkid:102100}})},{sourcePoint:{x:1246,y:669},mapPoint:new Ne({x:-10001415789436923e-9,y:3486942691935667e-9,spatialReference:{wkid:102100}})}]})});o.source.elements.add(v),s==null||s.goTo(new ui({spatialReference:{wkid:102100},xmax:-10001415789436923e-9,xmin:-10046739695935503e-9,ymax:3514979040597104e-9,ymin:3486942691935667e-9}).expand(1.5))}return nd("div",{className:"App",children:[Lt("div",{id:"view",ref:i}),nd("div",{ref:e,className:"card",children:[Lt("p",{children:"MediaLayer"}),Lt("pre",{className:"line-numbers",children:Lt("code",{className:"language-js",children:`new MediaLayer({ 
    source: [
      new ImageElement({
        image: "image url or image data",
        georeference: {...}
      })
    ] 
  });`})}),Lt(Y1,{className:"btn","icon-start":"play",onClick:u})]}),nd("div",{ref:t,className:"card",children:[Lt("p",{children:"ExtentAndRotationGeoreference"}),Lt("pre",{className:"line-numbers",children:Lt("code",{className:"language-js",children:`new ExtentAndRotationGeoreference({
    extent: new Extent({
      spatialReference: { wkid: 102100 },
      xmin: -10047456.27662979,
      ymin: 3486722.2723874687,
      xmax: -10006982.870152846,
      ymax: 3514468.91365495,
    }),
  })`})}),Lt(Y1,{className:"btn","icon-start":"play",onClick:d})]}),nd("div",{ref:r,className:"card",children:[Lt("p",{children:"CornersGeoreference"}),Lt("pre",{className:"line-numbers",children:Lt("code",{className:"language-js",children:`new CornersGeoreference({
    bottomRight: new Point({
      x: -10008215.143195309,
      y: 3486794.2321162825,
      spatialReference: { wkid: 102100 },
    }),
    bottomLeft: new Point({
      x: -10061466.93004702,
      y: 3486794.2321162825,
      spatialReference: { wkid: 102100 },
    }),
    topRight: new Point({
      x: -10008215.143195309,
      y: 3514418.4006159767,
      spatialReference: { wkid: 102100 },
    }),
    topLeft: new Point({
      x: -10061466.93004702,
      y: 3514418.4006159767,
      spatialReference: { wkid: 102100 },
    }),
  })`})}),Lt(Y1,{className:"btn","icon-start":"play",onClick:m})]}),nd("div",{ref:n,className:"card",children:[Lt("p",{children:"ControlPointsGeoreference"}),Lt("pre",{className:"line-numbers",children:Lt("code",{className:"language-js",children:`new ControlPointsGeoreference({
    width: 1246,
    height: 669,
    controlPoints: [
      {
        sourcePoint: { x: 0, y: 669 },
        mapPoint: new Point({ 
          x: -10046739.695935503, 
          y: 3486942.691935667, 
          spatialReference: { wkid: 102100 } 
        }),
      },
      {
        sourcePoint: { x: 0, y: 0 },
        mapPoint: new Point({
          x: -10046739.695935503,
          y: 3514979.040597104,
          spatialReference: { wkid: 102100 },
        }),
      },
      {
        sourcePoint: { x: 1246, y: 0 },
        mapPoint: new Point({
          x: -10001415.789436923,
          y: 3514979.040597104,
          spatialReference: { wkid: 102100 },
        }),
      },
      {
        sourcePoint: { x: 1246, y: 669 },
        mapPoint: new Point({
          x: -10001415.789436923,
          y: 3486942.691935667,
          spatialReference: { wkid: 102100 },
        }),
      },
    ],
  })`})}),Lt(Y1,{className:"btn","icon-start":"play",onClick:f})]})]})}function zg(i){const e=i[0]*i[0]+i[4]*i[4]+i[8]*i[8],t=i[1]*i[1]+i[5]*i[5]+i[9]*i[9],r=i[2]*i[2]+i[6]*i[6]+i[10]*i[10];return Math.sqrt(Math.max(e,t,r))}function s_e(i,e){const t=Math.sqrt(e[0]*e[0]+e[4]*e[4]+e[8]*e[8]),r=Math.sqrt(e[1]*e[1]+e[5]*e[5]+e[9]*e[9]),n=Math.sqrt(e[2]*e[2]+e[6]*e[6]+e[10]*e[10]);return Z(i,t,r,n),i}function o9e(i,e,t){t=t||i;const r=me(i,e);Z(t,i[0]-r*e[0],i[1]-r*e[1],i[2]-r*e[2]),he(t,t)}function l9e(i,e,t){Math.abs(i[0])>Math.abs(i[1])?Z(e,0,1,0):Z(e,1,0,0),nt(t,i,e),he(e,e),nt(e,t,i),he(t,t)}function BT(i,e,t,r,n,s){const a=i+(e-i)*n;return a+(t+(r-t)*n-a)*s}function a_e(i,e,t,r=R()){const n=_e(i),s=_e(e),a=me(i,e)/(n*s);if(a<.9999999999999999){const o=Math.acos(a),l=((1-t)*n+t*s)/Math.sin(o),c=l/n*Math.sin((1-t)*o),u=l/s*Math.sin(t*o);return Q(lg,i,c),Q(cg,e,u),oe(r,lg,cg)}return Bn(r,i,e,t)}function c9e(i,e,t,r=R(),n=R()){const s=_e(i),a=_e(e),o=me(i,e)/(s*a);if(o<.9999999999999999){const l=Math.acos(o),c=Math.sin(l),u=Math.sin(t*l),d=Math.sin((1-t)*l),m=(1-t)*s+t*a;{const f=m/c,_=f/a*u;Q(lg,i,f/s*d),Q(cg,e,_),oe(r,lg,cg)}{const f=1/s*(-Math.cos((1-t)*l)*l*m+d*(-s+a));Q(lg,i,f);const _=1/a*(Math.cos(t*l)*l*m+u*(-s+a));Q(cg,e,_),oe(n,lg,cg),Q(n,n,1/c)}return n}return Bn(r,i,e,t),ne(n,e,i),he(n,n),n}function ZS(i,e,t){i=he(lg,i),e=he(cg,e);const r=ls(me(i,e));if(t){const n=nt(o_e,i,e);if(me(n,t)<0)return-r}return r}function YS(i){const e=i.length;return t=>{if(t<=i[0][0])return i[0][1];if(t>=i[e-1][0])return i[e-1][1];let r=1;for(;t>i[r][0];)r++;const n=i[r-1][0],s=i[r][0],a=(s-t)/(s-n);return a*i[r-1][1]+(1-a)*i[r][1]}}function h9e(i,e,t,r){ne(JV,e,i),ne(e6,t,i),nt(r,JV,e6),he(r,r),r[3]=-me(i,r)}const JV=R(),e6=R(),o_e=R(),lg=R(),cg=R(),lO=J.getLogger("esri.views.3d.support.geometryUtils.boundedPlane");let WX=class{constructor(){this.plane=fr(),this.origin=R(),this.basis1=R(),this.basis2=R()}};function zd(i=nQ){return{plane:fr(i.plane),origin:as(i.origin),basis1:as(i.basis1),basis2:as(i.basis2)}}function l_e(i,e,t){const r=b_e.get();return r.origin=i,r.basis1=e,r.basis2=t,r.plane=yre(0,0,0,0),fR(r),r}function o_(i,e=zd()){return TN(i.origin,i.basis1,i.basis2,e)}function c_e(i,e){q(e.origin,i.origin),q(e.basis1,i.basis1),q(e.basis2,i.basis2),dG(e.plane,i.plane)}function TN(i,e,t,r=zd()){return q(r.origin,i),q(r.basis1,e),q(r.basis2,t),fR(r),y_e(r,"fromValues()"),r}function fR(i){ww(i.basis2,i.basis1,i.origin,i.plane)}function XX(i,e,t){i!==t&&o_(i,t);const r=Q(ze.get(),Id(i),e);return oe(t.origin,t.origin,r),t.plane[3]-=e,t}function h_e(i,e,t){return QX(e,t),XX(t,PN(i,i.origin),t),t}function QX(i,e=zd()){const t=(i[2]-i[0])/2,r=(i[3]-i[1])/2;return Z(e.origin,i[0]+t,i[1]+r,0),Z(e.basis1,t,0,0),Z(e.basis2,0,r,0),vre(0,0,1,0,e.plane),e}function CN(i,e,t){return!!Kg(i.plane,e,t)&&iQ(i,t)}function u_e(i,e,t){if(CN(i,e,t))return t;const r=ZX(i,e,ze.get());return oe(t,e.origin,Q(ze.get(),e.direction,Ii(e.origin,r)/_e(e.direction))),t}function ZX(i,e,t){const r=$2.get();rQ(i,e,r,$2.get());let n=Number.POSITIVE_INFINITY;for(const s of AN){const a=RN(i,s,gR.get()),o=ze.get();if(bre(r,a,o)){const l=Yg(ze.get(),e.origin,o),c=Math.abs(ls(me(e.direction,l)));c<n&&(n=c,q(t,o))}}return n===Number.POSITIVE_INFINITY?YX(i,e,t):t}function YX(i,e,t){if(CN(i,e,t))return t;const r=$2.get(),n=$2.get();rQ(i,e,r,n);let s=Number.POSITIVE_INFINITY;for(const a of AN){const o=RN(i,a,gR.get()),l=ze.get();if(wre(r,o,l)){const c=ire(e,l);if(!pG(n,l))continue;c<s&&(s=c,q(t,l))}}return SN(i,e.origin)<s&&KX(i,e.origin,t),t}function KX(i,e,t){const r=xre(i.plane,e,ze.get()),n=T5(t6(i,i.basis1),r,-1,1,ze.get()),s=T5(t6(i,i.basis2),r,-1,1,ze.get());return ne(t,oe(ze.get(),n,s),i.origin),t}function JX(i,e,t){const{origin:r,basis1:n,basis2:s}=i,a=ne(ze.get(),e,r),o=Mb(n,a),l=Mb(s,a),c=Mb(Id(i),a);return Z(t,o,l,c)}function SN(i,e){const t=JX(i,e,ze.get()),{basis1:r,basis2:n}=i,s=_e(r),a=_e(n),o=Math.max(Math.abs(t[0])-s,0),l=Math.max(Math.abs(t[1])-a,0),c=t[2];return o*o+l*l+c*c}function d_e(i,e){return Math.sqrt(SN(i,e))}function p_e(i,e){let t=Number.NEGATIVE_INFINITY;for(const r of AN){const n=RN(i,r,gR.get()),s=wD(n,e);s>t&&(t=s)}return Math.sqrt(t)}function EN(i,e){return pG(i.plane,e)&&iQ(i,e)}function m_e(i,e,t,r){return __e(i,t,r)}function PN(i,e){const t=-i.plane[3];return Mb(Id(i),e)-t}function f_e(i,e,t,r){const n=PN(i,e),s=Q(v_e,Id(i),t-n);return oe(r,e,s),r}function eQ(i,e){return Oc(i.basis1,e.basis1)&&Oc(i.basis2,e.basis2)&&Oc(i.origin,e.origin)}function tQ(i,e,t){return i!==t&&o_(i,t),kn(E_,e),yD(E_,E_),Ce(t.basis1,i.basis1,E_),Ce(t.basis2,i.basis2,E_),Ce(Ia(t.plane),Ia(i.plane),E_),Ce(t.origin,i.origin,e),xI(t.plane,t.plane,t.origin),t}function g_e(i,e,t,r){return i!==r&&o_(i,r),Bc(cO,e,t),Ce(r.basis1,i.basis1,cO),Ce(r.basis2,i.basis2,cO),fR(r),r}function Id(i){return Ia(i.plane)}function __e(i,e,t){switch(e){case tm.X:q(t,i.basis1),he(t,t);break;case tm.Y:q(t,i.basis2),he(t,t);break;case tm.Z:q(t,Id(i))}return t}function iQ(i,e){const t=ne(ze.get(),e,i.origin),r=Ml(i.basis1),n=Ml(i.basis2),s=me(i.basis1,t),a=me(i.basis2,t);return-s-r<0&&s-r<0&&-a-n<0&&a-n<0}function t6(i,e){const t=gR.get();return q(t.origin,i.origin),q(t.vector,e),t}function RN(i,e,t){const{basis1:r,basis2:n,origin:s}=i,a=Q(ze.get(),r,e.origin[0]),o=Q(ze.get(),n,e.origin[1]);oe(t.origin,a,o),oe(t.origin,t.origin,s);const l=Q(ze.get(),r,e.direction[0]),c=Q(ze.get(),n,e.direction[1]);return Q(t.vector,oe(l,l,c),2),t}function y_e(i,e){Math.abs(me(i.basis1,i.basis2)/(_e(i.basis1)*_e(i.basis2)))>1e-6&&lO.warn(e,"Provided basis vectors are not perpendicular"),Math.abs(me(i.basis1,Id(i)))>1e-6&&lO.warn(e,"Basis vectors and plane normal are not perpendicular"),Math.abs(-me(Id(i),i.origin)-i.plane[3])>1e-6&&lO.warn(e,"Plane offset is not consistent with plane origin")}function rQ(i,e,t,r){const n=Id(i);ww(n,e.direction,e.origin,t),ww(Ia(t),n,e.origin,r)}const nQ={plane:fr(),origin:Ge(0,0,0),basis1:Ge(1,0,0),basis2:Ge(0,1,0)},$2=new mD(fr),gR=new mD(fv),v_e=R(),b_e=new mD(()=>zd()),AN=[{origin:[-1,-1],direction:[1,0]},{origin:[1,-1],direction:[0,1]},{origin:[1,1],direction:[-1,0]},{origin:[-1,1],direction:[0,-1]}],E_=ve(),cO=ve(),w_e=Object.freeze(Object.defineProperty({__proto__:null,BoundedPlaneClass:WX,create:zd,wrap:l_e,copy:o_,copyWithoutVerify:c_e,fromValues:TN,updateUnboundedPlane:fR,elevate:XX,setExtent:h_e,fromAABoundingRect:QX,intersectRay:CN,intersectRayClosestSilhouette:u_e,closestPointOnSilhouette:ZX,closestPoint:YX,projectPoint:KX,projectPointLocal:JX,distance2:SN,distance:d_e,distanceToSilhouette:p_e,extrusionContainsPoint:EN,axisAt:m_e,altitudeAt:PN,setAltitudeAt:f_e,equals:eQ,transform:tQ,rotate:g_e,normal:Id,UP:nQ},Symbol.toStringTag,{value:"Module"}));function x_e(i){const{value:e,operations:t}=i;return{operations:t,value:t.create(e)}}function T_e(i,e,t){return i.operations.setExtent(i.value,e,t.value),t}function C_e(i){return{operations:i,value:i.create()}}function sQ(i,e,t=C_e(i)){return t.operations=i,i.copy(e,t.value),t}function S_e(i){return sQ(nre,rre(0,0,0,Yt(i).radius))}const i6=2**50;function E_e(){return sQ(w_e,TN([0,0,0],[i6,0,0],[0,i6,0]))}function P_e(i,e,t){return i.operations.axisAt(i.value,e,tm.Z,t)}function R_e(i,e,t,r){return i.operations.axisAt(i.value,e,t,r)}function A_e(i,e,t){return i.operations.intersectRay(i.value,e,t)}function O_e(i,e,t){return i.operations.intersectRayClosestSilhouette(i.value,e,t)}function M_e(i,e){return i.operations.altitudeAt(i.value,e)}function aQ(i,e,t,r){return i.operations.setAltitudeAt(i.value,e,t,r)}function I_e(i,e,t,r){return e!==r&&pn(r,e),Z(P_,r[12],r[13],r[14]),aQ(i,P_,t,P_),r[12]=P_[0],r[13]=P_[1],r[14]=P_[2],r}function hO(i,e,t){return i.operations.elevate(i.value,e,t.value)}const P_=R();function r6(i,e,t,r,n){return n[0]=me(i,e),n[1]=me(i,t),n[2]=me(i,r),n}function lL(i,e,t,r,n){q(t,i),q(GT,e),he(GT,GT),nt(r,GT,t),nt(n,r,t)}function oQ(i,e){return i?Ste(e):e.isGeographic?Qt.PlateCarree:e}const GT=R(),L_e=12;let so=class da{constructor(e){const t=da.checkUnsupported(e);if(y(t))throw t;const r=ct(e);this.spatialReference=r.spatialReference,this._isWebMercator=this.spatialReference.isWebMercator,this._isGCS=Eg(this.spatialReference)||Rx(this.spatialReference)||Ax(this.spatialReference),this.origin=[r.origin.x,r.origin.y],this.pixelSize=r.size[0],this.dpi=r.dpi;const n=r.lods.reduce((c,u,d)=>(u.level<c.min&&(c.min=u.level,c.minIndex=d),c.max=Math.max(c.max,u.level),c),{min:1/0,minIndex:0,max:-1/0}),s=r.lods[n.minIndex],a=2**s.level;let o=s.resolution*a,l=s.scale*a;this.levels=new Array(n.max+1);for(let c=0;c<this.levels.length;c++)this.levels[c]={resolution:o,scale:l,tileSize:[o*r.size[0],o*r.size[1]]},o/=2,l/=2}clone(){return new da(this.toTileInfo())}toTileInfo(){return new Ab({dpi:this.dpi,origin:{x:this.origin[0],y:this.origin[1],spatialReference:this.spatialReference},size:[this.pixelSize,this.pixelSize],spatialReference:this.spatialReference,lods:this.levels.map((e,t)=>({level:t,scale:e.scale,resolution:e.resolution}))})}getExtent(e,t,r,n){const s=this.levels[e],a=s.tileSize[0],o=s.tileSize[1];n[0]=this.origin[0]+r*a,n[2]=this.origin[0]+(r+1)*a,n[3]=this.origin[1]-t*o,n[1]=this.origin[1]-(t+1)*o}convertExtentToRadians(e,t){this._isWebMercator?(t[0]=a5(e[0]),t[1]=rI(e[1]),t[2]=a5(e[2]),t[3]=rI(e[3])):this._isGCS&&(t[0]=Ct(e[0]),t[1]=Ct(e[1]),t[2]=Ct(e[2]),t[3]=Ct(e[3]))}getExtentGeometry(e,t,r,n=new ui){return this.getExtent(e,t,r,eh),n.spatialReference=this.spatialReference,n.xmin=eh[0],n.ymin=eh[1],n.xmax=eh[2],n.ymax=eh[3],n.zmin=void 0,n.zmax=void 0,n}ensureMaxLod(e){if(e==null)return!1;let t=!1;for(;this.levels.length<=e;){const r=this.levels[this.levels.length-1],n=r.resolution/2;this.levels.push({resolution:n,scale:r.scale/2,tileSize:[n*this.pixelSize,n*this.pixelSize]}),t=!0}return t}capMaxLod(e){this.levels.length>e+1&&(this.levels.length=e+1)}getMaxLod(){return this.levels.length-1}scaleAtLevel(e){return this.levels[0].scale/2**e}levelAtScale(e){const t=this.levels[0].scale;return e>=t?0:Math.log(t/e)*Math.LOG2E}resolutionAtLevel(e){return this.levels[0].resolution/2**e}compatibleWith(e){if(!(e instanceof da)){if(da.checkUnsupported(e))return!1;e=new da(e)}if(!e.spatialReference.equals(this.spatialReference)||e.pixelSize!==this.pixelSize)return!1;const t=Math.min(this.levels.length,e.levels.length)-1,r=this.levels[t].resolution;let n=.5*r;return!YR(e.origin[0],this.origin[0],n)||!YR(e.origin[1],this.origin[1],n)?!1:(n=.5*r/2**t/this.pixelSize*L_e,YR(r,e.levels[t].resolution,n))}rootTilesInExtent(e,t=null,r=1/0){const n=new Array,s=this.levels[0].tileSize;if(S(e)||s[0]===0||s[1]===0)return n;da.computeRowColExtent(e,s,this.origin,eh);let a=eh[1],o=eh[3],l=eh[0],c=eh[2];const u=c-l,d=o-a;if(u*d>r){const m=Math.floor(Math.sqrt(r));d>m&&(a=a+Math.floor(.5*d)-Math.floor(.5*m),o=a+m),u>m&&(l=l+Math.floor(.5*u)-Math.floor(.5*m),c=l+m)}for(let m=a;m<o;m++)for(let f=l;f<c;f++)n.push([0,m,f]);return y(t)&&(t[0]=this.origin[0]+l*s[0],t[1]=this.origin[1]-o*s[1],t[2]=this.origin[0]+c*s[0],t[3]=this.origin[1]-a*s[1]),n}static computeRowColExtent(e,t,r,n){const s=.001*(e[2]-e[0]+(e[3]-e[1]));n[0]=Math.max(0,Math.floor((e[0]+s-r[0])/t[0])),n[2]=Math.max(0,Math.ceil((e[2]-s-r[0])/t[0])),n[1]=Math.max(0,Math.floor((r[1]-e[3]+s)/t[1])),n[3]=Math.max(0,Math.ceil((r[1]-e[1]-s)/t[1]))}static isPowerOfTwo(e){const t=e.lods,r=t[0].resolution*2**t[0].level;return!t.some(n=>!Fee(n.resolution,r/2**n.level))}static hasGapInLevels(e){const t=e.lods.map(r=>r.level);t.sort((r,n)=>r-n);for(let r=1;r<t.length;r++)if(t[r]!==t[0]+r)return!0;return!1}static tileSizeSupported(e){const t=e.size[1];return t===e.size[0]&&(t&t-1)==0&&t>=128&&t<=512}static hasOriginPerLODs(e){const t=e.origin;return e.lods.some(r=>r.origin!=null&&(r.origin[0]!==t.x||r.origin[1]!==t.y))}static getMissingTileInfoError(){return new K("tilingscheme:tile-info-missing","Tiling scheme must have tiling information")}static checkUnsupported(e){return S(e)?ON():e.lods.length<1?new K("tilingscheme:generic","Tiling scheme must have at least one level"):da.isPowerOfTwo(e)?da.hasGapInLevels(e)?new K("tilingscheme:gaps","Tiling scheme levels must not have gaps between min and max level"):da.tileSizeSupported(e)?da.hasOriginPerLODs(e)?new K("tilingscheme:multiple-origin","Tiling scheme levels must not have their own origin"):null:new K("tilingscheme:tile-size","Tiles must be square and size must be one of [128, 256, 512]"):new K("tilingscheme:power-of-two","Tiling scheme must be power of two")}static fromExtent(e,t){const r=e[2]-e[0],n=e[3]-e[1],s=Gm(t),a=1.2*Math.max(r,n),o=256,l=96,c=.0254,u=new da(new Ab({size:[o,o],origin:{x:e[0]-.5*(a-r),y:e[3]+.5*(a-n)},lods:[{level:0,resolution:a/o,scale:1/(o/l*c/(a*s))}],spatialReference:t}));return u.ensureMaxLod(20),u}static makeWebMercatorAuxiliarySphere(e){const t=new da(da.WebMercatorAuxiliarySphereTileInfo);return t.ensureMaxLod(e),t}static makeGCSWithTileSize(e,t=256,r=16){const n=256/t,s=new da(new Ab({size:[t,t],origin:{x:-180,y:90,spatialReference:e},spatialReference:e,lods:[{level:0,resolution:.703125*n,scale:295497598570834e-6*n}]}));return s.ensureMaxLod(r),s}get test(){return{isWebMercator:this._isWebMercator,isGCS:this._isGCS}}};function ON(){return new K("tilingscheme:tile-info-missing","Tiling scheme must have tiling information")}so.WebMercatorAuxiliarySphereTileInfo=new Ab({size:[256,256],origin:{x:-20037508342787e-6,y:20037508342787e-6,spatialReference:Qt.WebMercator},spatialReference:Qt.WebMercator,lods:[{level:0,resolution:156543.03392800014,scale:591657527591555e-6}]}),so.WebMercatorAuxiliarySphere=so.makeWebMercatorAuxiliarySphere(19);const eh=$t(),c0=64,K1=512,$_e=2.5,tx=Nee(kee/10),lQ=4,cQ=$t();so.WebMercatorAuxiliarySphere.getExtent(0,0,0,cQ);const D_e=$t([-180,-90,180,90]),F_e="Cannot extend surface to encompass all layers because it would result in too many root tiles.",N_e="Surface extent is too large for tile resolution at level 0.";let k_e=4;const KS=i=>i<4?3:k_e;let Ap=class extends nn.EventedAccessor{constructor(e){super(e),this.demResolution={min:-1,max:-1},this.noDataValue=tx}initialize(){this.view.basemapTerrain.on("elevation-change",()=>this.emit("changed",{}))}get extent(){const e=this.view.basemapTerrain;if(S(e.extent)||S(e.spatialReference))return null;const t=J7(e.extent,e.spatialReference);return t.zmin=e.visibleElevationBounds.min,t.zmax=e.visibleElevationBounds.max,t}get spatialReference(){return je(this.view.basemapTerrain.spatialReference,Qt.WGS84)}elevationAt(e,t){if(S(this.extent)||!Zee(this.extent,e,t)){const r=y(this.extent)?`${this.extent.xmin}, ${this.extent.ymin}, ${this.extent.xmax}, ${this.extent.ymax}`:null;return J.getLogger(this.declaredClass).warn("#elevationAt()",`Point used to sample elevation (${e}, ${t}) is outside of the sampler extent (${r})`),this.noDataValue}return je(this.view.elevationProvider.getElevation(e,t,0,this.spatialReference,"ground"),this.noDataValue)}queryElevation(e){return Rre(e.clone(),this)}};h([p({readOnly:!0})],Ap.prototype,"demResolution",void 0),h([p({readOnly:!0})],Ap.prototype,"extent",null),h([p({readOnly:!0})],Ap.prototype,"noDataValue",void 0),h([p()],Ap.prototype,"spatialReference",null),h([p({constructOnly:!0})],Ap.prototype,"view",void 0),Ap=h([D("esri.views.support.GroundViewElevationSampler")],Ap);const V_e=Ap;let Op=class extends ue{constructor(e){super(e),this._handles=new Ft,this.view=null,this.layerViews=new pt}initialize(){this._handles.add(cs(()=>{var e,t;return(t=(e=this.view)==null?void 0:e.map)==null?void 0:t.ground},e=>e.load())),this._handles.add(this.layerViews.on("after-changes",()=>this._layerViewsAfterChangesHandler()))}destroy(){this._set("view",null),this._handles&&(this._handles.destroy(),this._handles=null)}get elevationSampler(){return this.view?this.view.type==="2d"?null:this.view.ready&&this.view.basemapTerrain&&this.view.basemapTerrain.ready?new V_e({view:this.view}):null:null}get updating(){return!this.suspended&&this.layerViews.some(e=>e.updating)}get suspended(){return!this.view||this.view.suspended}_layerViewsAfterChangesHandler(){this._handles.remove("updating"),this._handles.add(this.layerViews.map(e=>z(()=>e.updating,()=>this._updateUpdating(),ri)).toArray(),"updating"),this._updateUpdating()}_updateUpdating(){this.notifyChange("updating")}};h([p({readOnly:!0})],Op.prototype,"elevationSampler",null),h([p({type:Boolean,readOnly:!0})],Op.prototype,"updating",null),h([p({constructOnly:!0})],Op.prototype,"view",void 0),h([p({type:pt,readOnly:!0})],Op.prototype,"layerViews",void 0),h([p({readOnly:!0})],Op.prototype,"suspended",null),Op=h([D("esri.views.GroundView")],Op);const U_e=Op,t1=()=>G(()=>import("./TileLayerView3D-cfeb69d6.js"),["assets/TileLayerView3D-cfeb69d6.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/projection-290b739f.js","assets/preload-helper-3bce6601.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/unitUtils-45d1147c.js","assets/jsonMap-7b8332c9.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/SimpleObservable-23231131.js","assets/mat4-44a0988f.js","assets/Polyline-ff2d7c6b.js","assets/assets-8d3e737a.js","assets/request-6fc81c4c.js","assets/aaBoundingRect-193543b5.js","assets/zscale-89472cba.js","assets/LayerView3D-276cda7d.js","assets/reactiveUtils-4dabbb80.js","assets/TiledLayerView3D-d9768dab.js","assets/LayerView-bd9a2316.js","assets/Evented-a45c8b0f.js","assets/HandleOwner-9b396af1.js","assets/Identifiable-bfe1ff30.js","assets/Promise-376ab9f6.js","assets/RefreshableLayerView-7c1c2c75.js","assets/TileLayerView-80cc70bb.js","assets/clickToleranceUtils-a273d161.js","assets/drapedUtils-f6534f49.js","assets/geometry-b7901087.js","assets/typeUtils-35750739.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),n6=()=>G(()=>import("./ElevationLayerView3D-0477db03.js"),["assets/ElevationLayerView3D-0477db03.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/LayerView3D-276cda7d.js","assets/reactiveUtils-4dabbb80.js","assets/TiledLayerView3D-d9768dab.js","assets/LayerView-bd9a2316.js","assets/Evented-a45c8b0f.js","assets/HandleOwner-9b396af1.js","assets/Identifiable-bfe1ff30.js","assets/Promise-376ab9f6.js","assets/preload-helper-3bce6601.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),s6={"base-dynamic":()=>G(()=>import("./BaseDynamicLayerView3D-7338748c.js"),["assets/BaseDynamicLayerView3D-7338748c.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/DynamicLayerView3D-22c99ecd.js","assets/asyncUtils-437defc4.js","assets/reactiveUtils-4dabbb80.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/aaBoundingRect-193543b5.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/LayerView3D-276cda7d.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/mat3-3fc68e72.js","assets/mat3f64-c6305894.js","assets/mat4-44a0988f.js","assets/mat4f64-1e28eae0.js","assets/aaBoundingBox-657a9b82.js","assets/BufferView-903d1848.js","assets/vec2-528adfe4.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/enums-64ab819c.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/quatf64-7fd38d64.js","assets/compilerUtils-18d58939.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/byteSizeEstimations-f0cab514.js","assets/VisualVariablePassParameters-d460182b.js","assets/VertexAttribute-9c5c630d.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/ShaderBuilder-a7d0da4e.js","assets/basicInterfaces-19ed850e.js","assets/ViewingMode-5d7d590b.js","assets/Util-a48361c6.js","assets/vec2f64-30dc1443.js","assets/vec4f64-e407da96.js","assets/sphere-2af0d852.js","assets/lineSegment-10422ca0.js","assets/Texture-46c8c2cb.js","assets/Evented-a45c8b0f.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/ScreenSpacePass-d5e48a9b.js","assets/Float4PassUniform-d7bdbc81.js","assets/Texture2DPassUniform-753de459.js","assets/assets-8d3e737a.js","assets/InterleavedLayout-984d67b2.js","assets/Matrix3PassUniform-ad9f953b.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/vec3f32-c9aa289f.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/symbolColorUtils-b2b55883.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/FloatPassUniform-68d54f51.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/projectExtentUtils-7f9e225f.js","assets/ImageMaterial-f710e8d5.js","assets/ImageMaterial.glsl-befce2a1.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/Identifiable-bfe1ff30.js","assets/Promise-376ab9f6.js","assets/RefreshableLayerView-7c1c2c75.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/NormalUtils.glsl-c12729bf.js","assets/HUD.glsl-d3a072ad.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),"base-elevation":n6,"base-tile":t1,"bing-maps":t1,"building-scene":()=>G(()=>import("./BuildingSceneLayerView3D-6cc37e61.js"),["assets/BuildingSceneLayerView3D-6cc37e61.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/reactiveUtils-4dabbb80.js","assets/BuildingGroupSublayer-cc8c0afd.js","assets/loadAll-b5bfa7ab.js","assets/asyncUtils-437defc4.js","assets/BuildingComponentSublayer-cd73d2b0.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/MemCache-18a255ed.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/TimeExtent-23e282b9.js","assets/ElevationInfo-215614d8.js","assets/RelationshipQuery-0dda77ad.js","assets/Query-b96bcde0.js","assets/Layer-5ffe0eda.js","assets/HandleOwner-9b396af1.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/editsZScale-6a661299.js","assets/queryZScale-1481fa99.js","assets/zscale-89472cba.js","assets/FeatureSet-d32b0eb8.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/TopFeaturesQuery-cad97c37.js","assets/popupUtils-86dc6b94.js","assets/capabilities-a18453f6.js","assets/I3SIndexInfo-7af1a739.js","assets/I3SLayerDefinitions-ec48d9ab.js","assets/I3SUtil-f31a4571.js","assets/mat3-3fc68e72.js","assets/mat3f64-c6305894.js","assets/mat4f64-1e28eae0.js","assets/quat-3d5eec2d.js","assets/quatf64-7fd38d64.js","assets/I3SBinaryReader-f4829435.js","assets/VertexAttribute-9c5c630d.js","assets/projection-290b739f.js","assets/ViewingMode-5d7d590b.js","assets/symbolColorUtils-b2b55883.js","assets/vec3f32-c9aa289f.js","assets/plane-b575face.js","assets/sphere-2af0d852.js","assets/byteSizeEstimations-f0cab514.js","assets/vec2f64-30dc1443.js","assets/popupUtils-af06d391.js","assets/WhereClause-d4b8b019.js","assets/I3SMeshView3D-cfbe0b2b.js","assets/mat3f32-d3d088e8.js","assets/I3SOverrides-b08cc3de.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/Scheduler-540208b6.js","assets/I3SNode-941d6d9e.js","assets/RenderTexture-a15e38d0.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec2-528adfe4.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/AlphaCutoff-96178e0d.js","assets/Texture-46c8c2cb.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/Util-a48361c6.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/ScreenSpacePass-d5e48a9b.js","assets/Octree-0a267ea2.js","assets/FeatureLayerView3D-897c7c3e.js","assets/FeatureLayerViewBase3D-5ca6a636.js","assets/FeatureLikeLayerView3D-cace86c7.js","assets/dehydratedFeatureComparison-59868945.js","assets/utils-6786b611.js","assets/ItemCache-fd3aceaf.js","assets/queryForSymbologySnapping-3bbff2c8.js","assets/elevationInfoUtils-36e5dd0f.js","assets/hash-0ddfbf4b.js","assets/Graphics3DObjectStates-1e0ab5c6.js","assets/OptimizedFeature-4ab8d380.js","assets/optimizedFeatureQueryEngineAdapter-d72f082e.js","assets/centroid-5c988df3.js","assets/PooledRBush-3e149119.js","assets/quickselect-322ec8e1.js","assets/floorFilterUtils-080a7cd2.js","assets/QueryEngine-cdb0ba2c.js","assets/normalizeUtils-27e29a72.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/QueryEngineResult-8f90b8dc.js","assets/utils-b34fcd9d.js","assets/generateRendererUtils-7252b5e6.js","assets/projectionSupport-aa5eaa0d.js","assets/json-48e3ea08.js","assets/SnappingCandidate-970faec6.js","assets/utils-511aa5f5.js","assets/QueryEngineCapabilities-42e44ded.js","assets/timeSupport-3de56d7f.js","assets/scaleUtils-93ad8d0c.js","assets/FeatureStore-3cfbdfa3.js","assets/BoundsStore-b9fa27cc.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/vec2f32-461e65a9.js","assets/lineSegment-10422ca0.js","assets/InterleavedLayout-984d67b2.js","assets/Matrix3PassUniform-ad9f953b.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/Heatmap.glsl-388d8513.js","assets/HeatmapDensity.glsl-92a06674.js","assets/heatmapTextureUtils-2627384f.js","assets/projectExtentUtils-7f9e225f.js","assets/LayerView3D-276cda7d.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/LercDecoder-4c9b29b3.js","assets/EventedSet-be3adf97.js","assets/FeatureLayerView-e9178bab.js","assets/LayerView-bd9a2316.js","assets/RefreshableLayerView-7c1c2c75.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/executeQueryJSON-2fe748db.js","assets/mat2d-2bbb5feb.js","assets/Basemap-af7f62f8.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/capabilities-302cf20d.js","assets/ElevationSamplerData-b87e0e50.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/NormalUtils.glsl-c12729bf.js","assets/HUD.glsl-d3a072ad.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/labelFormatUtils-d25d1d9e.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js","assets/SceneModification-3462a3f4.js","assets/persistable-ad5d84e1.js","assets/SceneLayerWorker-02654016.js","assets/I3SQueryFeatureStore-b0bfbe05.js","assets/DefinitionExpressionSceneLayerView-9802dbb8.js"]),csv:()=>G(()=>import("./CSVLayerView3D-3c90f7e0.js"),["assets/CSVLayerView3D-3c90f7e0.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/FeatureLayerViewBase3D-5ca6a636.js","assets/reactiveUtils-4dabbb80.js","assets/FeatureLikeLayerView3D-cace86c7.js","assets/asyncUtils-437defc4.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/Promise-376ab9f6.js","assets/HandleOwner-9b396af1.js","assets/arcgisLayerUrl-c09f09b4.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/persistableUrlUtils-5f719c3b.js","assets/Query-b96bcde0.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/TimeExtent-23e282b9.js","assets/enumeration-3a03bd31.js","assets/jsonUtils-229211af.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Clonable-545593ce.js","assets/aaBoundingRect-193543b5.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/dehydratedFeatures-0557137d.js","assets/byteSizeEstimations-f0cab514.js","assets/aaBoundingBox-657a9b82.js","assets/quantizationUtils-4dd81f85.js","assets/ViewingMode-5d7d590b.js","assets/dehydratedFeatureComparison-59868945.js","assets/Scheduler-540208b6.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/assets-8d3e737a.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/queryForSymbologySnapping-3bbff2c8.js","assets/elevationInfoUtils-36e5dd0f.js","assets/ElevationInfo-215614d8.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/hash-0ddfbf4b.js","assets/compilerUtils-18d58939.js","assets/diffUtils-68b89c71.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/Graphics3DObjectStates-1e0ab5c6.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/projection-290b739f.js","assets/zscale-89472cba.js","assets/Layer-5ffe0eda.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OptimizedFeature-4ab8d380.js","assets/optimizedFeatureQueryEngineAdapter-d72f082e.js","assets/centroid-5c988df3.js","assets/PooledRBush-3e149119.js","assets/quickselect-322ec8e1.js","assets/basicInterfaces-19ed850e.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/OperationalLayer-97084f13.js","assets/floorFilterUtils-080a7cd2.js","assets/QueryEngine-cdb0ba2c.js","assets/normalizeUtils-27e29a72.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/QueryEngineResult-8f90b8dc.js","assets/WhereClause-d4b8b019.js","assets/utils-b34fcd9d.js","assets/generateRendererUtils-7252b5e6.js","assets/projectionSupport-aa5eaa0d.js","assets/json-48e3ea08.js","assets/SnappingCandidate-970faec6.js","assets/utils-511aa5f5.js","assets/QueryEngineCapabilities-42e44ded.js","assets/timeSupport-3de56d7f.js","assets/FieldsIndex-f104cc5f.js","assets/FeatureSet-d32b0eb8.js","assets/scaleUtils-93ad8d0c.js","assets/FeatureStore-3cfbdfa3.js","assets/BoundsStore-b9fa27cc.js","assets/VisualVariablePassParameters-d460182b.js","assets/VertexAttribute-9c5c630d.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/ShaderBuilder-a7d0da4e.js","assets/mat3f64-c6305894.js","assets/Util-a48361c6.js","assets/vec2f64-30dc1443.js","assets/mat4f64-1e28eae0.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec2-528adfe4.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/mat3-3fc68e72.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/quatf64-7fd38d64.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/sphere-2af0d852.js","assets/lineSegment-10422ca0.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/Matrix3PassUniform-ad9f953b.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/symbolColorUtils-b2b55883.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/Heatmap.glsl-388d8513.js","assets/HeatmapDensity.glsl-92a06674.js","assets/heatmapTextureUtils-2627384f.js","assets/projectExtentUtils-7f9e225f.js","assets/LayerView3D-276cda7d.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/LercDecoder-4c9b29b3.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/EventedSet-be3adf97.js","assets/FeatureLayerView-e9178bab.js","assets/popupUtils-af06d391.js","assets/LayerView-bd9a2316.js","assets/RefreshableLayerView-7c1c2c75.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/executeQueryJSON-2fe748db.js","assets/RelationshipQuery-0dda77ad.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/capabilities-302cf20d.js","assets/plane-b575face.js","assets/ElevationSamplerData-b87e0e50.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/NormalUtils.glsl-c12729bf.js","assets/HUD.glsl-d3a072ad.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),dimension:()=>G(()=>import("./DimensionLayerView3D-10c6671a.js"),["assets/DimensionLayerView3D-10c6671a.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/asyncUtils-437defc4.js","assets/reactiveUtils-4dabbb80.js","assets/LayerView3D-276cda7d.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/Identifiable-bfe1ff30.js","assets/Promise-376ab9f6.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),elevation:n6,feature:()=>G(()=>import("./FeatureLayerView3D-897c7c3e.js"),["assets/FeatureLayerView3D-897c7c3e.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/projection-290b739f.js","assets/preload-helper-3bce6601.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/unitUtils-45d1147c.js","assets/jsonMap-7b8332c9.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/SimpleObservable-23231131.js","assets/mat4-44a0988f.js","assets/Polyline-ff2d7c6b.js","assets/assets-8d3e737a.js","assets/request-6fc81c4c.js","assets/aaBoundingRect-193543b5.js","assets/zscale-89472cba.js","assets/styleUtils-22b14a8b.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/locale-30120714.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/FeatureLayerViewBase3D-5ca6a636.js","assets/reactiveUtils-4dabbb80.js","assets/FeatureLikeLayerView3D-cace86c7.js","assets/asyncUtils-437defc4.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/HandleOwner-9b396af1.js","assets/arcgisLayerUrl-c09f09b4.js","assets/persistableUrlUtils-5f719c3b.js","assets/Query-b96bcde0.js","assets/geometry-b7901087.js","assets/typeUtils-35750739.js","assets/TimeExtent-23e282b9.js","assets/enumeration-3a03bd31.js","assets/jsonUtils-229211af.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Clonable-545593ce.js","assets/dehydratedFeatures-0557137d.js","assets/byteSizeEstimations-f0cab514.js","assets/aaBoundingBox-657a9b82.js","assets/quantizationUtils-4dd81f85.js","assets/ViewingMode-5d7d590b.js","assets/dehydratedFeatureComparison-59868945.js","assets/Scheduler-540208b6.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/number-27cf8195.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/queryForSymbologySnapping-3bbff2c8.js","assets/elevationInfoUtils-36e5dd0f.js","assets/ElevationInfo-215614d8.js","assets/lengthUtils-fa751420.js","assets/hash-0ddfbf4b.js","assets/compilerUtils-18d58939.js","assets/diffUtils-68b89c71.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/jsonUtils-0ff4ff96.js","assets/Graphics3DObjectStates-1e0ab5c6.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/Layer-5ffe0eda.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OptimizedFeature-4ab8d380.js","assets/optimizedFeatureQueryEngineAdapter-d72f082e.js","assets/centroid-5c988df3.js","assets/PooledRBush-3e149119.js","assets/quickselect-322ec8e1.js","assets/basicInterfaces-19ed850e.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/OperationalLayer-97084f13.js","assets/floorFilterUtils-080a7cd2.js","assets/QueryEngine-cdb0ba2c.js","assets/normalizeUtils-27e29a72.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/QueryEngineResult-8f90b8dc.js","assets/WhereClause-d4b8b019.js","assets/utils-b34fcd9d.js","assets/generateRendererUtils-7252b5e6.js","assets/projectionSupport-aa5eaa0d.js","assets/json-48e3ea08.js","assets/SnappingCandidate-970faec6.js","assets/utils-511aa5f5.js","assets/QueryEngineCapabilities-42e44ded.js","assets/timeSupport-3de56d7f.js","assets/FieldsIndex-f104cc5f.js","assets/FeatureSet-d32b0eb8.js","assets/scaleUtils-93ad8d0c.js","assets/FeatureStore-3cfbdfa3.js","assets/BoundsStore-b9fa27cc.js","assets/VisualVariablePassParameters-d460182b.js","assets/VertexAttribute-9c5c630d.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/ShaderBuilder-a7d0da4e.js","assets/mat3f64-c6305894.js","assets/Util-a48361c6.js","assets/vec2f64-30dc1443.js","assets/mat4f64-1e28eae0.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec2-528adfe4.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/mat3-3fc68e72.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/quatf64-7fd38d64.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/sphere-2af0d852.js","assets/lineSegment-10422ca0.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/Matrix3PassUniform-ad9f953b.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/symbolColorUtils-b2b55883.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/Heatmap.glsl-388d8513.js","assets/HeatmapDensity.glsl-92a06674.js","assets/heatmapTextureUtils-2627384f.js","assets/projectExtentUtils-7f9e225f.js","assets/LayerView3D-276cda7d.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/LercDecoder-4c9b29b3.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/EventedSet-be3adf97.js","assets/FeatureLayerView-e9178bab.js","assets/popupUtils-af06d391.js","assets/LayerView-bd9a2316.js","assets/RefreshableLayerView-7c1c2c75.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/executeQueryJSON-2fe748db.js","assets/RelationshipQuery-0dda77ad.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/capabilities-302cf20d.js","assets/plane-b575face.js","assets/ElevationSamplerData-b87e0e50.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/NormalUtils.glsl-c12729bf.js","assets/HUD.glsl-d3a072ad.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),geojson:()=>G(()=>import("./GeoJSONLayerView3D-806ab9ea.js"),["assets/GeoJSONLayerView3D-806ab9ea.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/FeatureLayerViewBase3D-5ca6a636.js","assets/reactiveUtils-4dabbb80.js","assets/FeatureLikeLayerView3D-cace86c7.js","assets/asyncUtils-437defc4.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/Promise-376ab9f6.js","assets/HandleOwner-9b396af1.js","assets/arcgisLayerUrl-c09f09b4.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/persistableUrlUtils-5f719c3b.js","assets/Query-b96bcde0.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/TimeExtent-23e282b9.js","assets/enumeration-3a03bd31.js","assets/jsonUtils-229211af.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Clonable-545593ce.js","assets/aaBoundingRect-193543b5.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/dehydratedFeatures-0557137d.js","assets/byteSizeEstimations-f0cab514.js","assets/aaBoundingBox-657a9b82.js","assets/quantizationUtils-4dd81f85.js","assets/ViewingMode-5d7d590b.js","assets/dehydratedFeatureComparison-59868945.js","assets/Scheduler-540208b6.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/assets-8d3e737a.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/queryForSymbologySnapping-3bbff2c8.js","assets/elevationInfoUtils-36e5dd0f.js","assets/ElevationInfo-215614d8.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/hash-0ddfbf4b.js","assets/compilerUtils-18d58939.js","assets/diffUtils-68b89c71.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/Graphics3DObjectStates-1e0ab5c6.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/projection-290b739f.js","assets/zscale-89472cba.js","assets/Layer-5ffe0eda.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OptimizedFeature-4ab8d380.js","assets/optimizedFeatureQueryEngineAdapter-d72f082e.js","assets/centroid-5c988df3.js","assets/PooledRBush-3e149119.js","assets/quickselect-322ec8e1.js","assets/basicInterfaces-19ed850e.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/OperationalLayer-97084f13.js","assets/floorFilterUtils-080a7cd2.js","assets/QueryEngine-cdb0ba2c.js","assets/normalizeUtils-27e29a72.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/QueryEngineResult-8f90b8dc.js","assets/WhereClause-d4b8b019.js","assets/utils-b34fcd9d.js","assets/generateRendererUtils-7252b5e6.js","assets/projectionSupport-aa5eaa0d.js","assets/json-48e3ea08.js","assets/SnappingCandidate-970faec6.js","assets/utils-511aa5f5.js","assets/QueryEngineCapabilities-42e44ded.js","assets/timeSupport-3de56d7f.js","assets/FieldsIndex-f104cc5f.js","assets/FeatureSet-d32b0eb8.js","assets/scaleUtils-93ad8d0c.js","assets/FeatureStore-3cfbdfa3.js","assets/BoundsStore-b9fa27cc.js","assets/VisualVariablePassParameters-d460182b.js","assets/VertexAttribute-9c5c630d.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/ShaderBuilder-a7d0da4e.js","assets/mat3f64-c6305894.js","assets/Util-a48361c6.js","assets/vec2f64-30dc1443.js","assets/mat4f64-1e28eae0.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec2-528adfe4.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/mat3-3fc68e72.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/quatf64-7fd38d64.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/sphere-2af0d852.js","assets/lineSegment-10422ca0.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/Matrix3PassUniform-ad9f953b.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/symbolColorUtils-b2b55883.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/Heatmap.glsl-388d8513.js","assets/HeatmapDensity.glsl-92a06674.js","assets/heatmapTextureUtils-2627384f.js","assets/projectExtentUtils-7f9e225f.js","assets/LayerView3D-276cda7d.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/LercDecoder-4c9b29b3.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/EventedSet-be3adf97.js","assets/FeatureLayerView-e9178bab.js","assets/popupUtils-af06d391.js","assets/LayerView-bd9a2316.js","assets/RefreshableLayerView-7c1c2c75.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/executeQueryJSON-2fe748db.js","assets/RelationshipQuery-0dda77ad.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/capabilities-302cf20d.js","assets/plane-b575face.js","assets/ElevationSamplerData-b87e0e50.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/NormalUtils.glsl-c12729bf.js","assets/HUD.glsl-d3a072ad.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),graphics:()=>G(()=>import("./GraphicsLayerView3D-28edb926.js"),["assets/GraphicsLayerView3D-28edb926.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/reactiveUtils-4dabbb80.js","assets/LayerView3D-276cda7d.js","assets/queryForSymbologySnapping-3bbff2c8.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/dehydratedFeatures-0557137d.js","assets/byteSizeEstimations-f0cab514.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/quantizationUtils-4dd81f85.js","assets/jsonUtils-229211af.js","assets/Field-61ec9870.js","assets/enumeration-3a03bd31.js","assets/fieldType-f31285f7.js","assets/elevationInfoUtils-36e5dd0f.js","assets/ElevationInfo-215614d8.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/GraphicsProcessor-e3db4c8c.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/HandleOwner-9b396af1.js","assets/diffUtils-68b89c71.js","assets/Layer-5ffe0eda.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/Graphics3DObjectStates-1e0ab5c6.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/MemCache-18a255ed.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/projection-290b739f.js","assets/mat4-44a0988f.js","assets/assets-8d3e737a.js","assets/zscale-89472cba.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OptimizedFeature-4ab8d380.js","assets/optimizedFeatureQueryEngineAdapter-d72f082e.js","assets/centroid-5c988df3.js","assets/asyncUtils-437defc4.js","assets/PooledRBush-3e149119.js","assets/quickselect-322ec8e1.js","assets/basicInterfaces-19ed850e.js","assets/Scheduler-540208b6.js","assets/projectExtentUtils-7f9e225f.js","assets/LayerView-bd9a2316.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/RelationshipQuery-0dda77ad.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),group:()=>G(()=>import("./GroupLayerView-6f5d18e8.js"),["assets/GroupLayerView-6f5d18e8.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/collectionUtils-803d9ba8.js","assets/reactiveUtils-4dabbb80.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/Identifiable-bfe1ff30.js","assets/Promise-376ab9f6.js"]),imagery:()=>G(()=>import("./ImageryLayerView3D-032e7329.js"),["assets/ImageryLayerView3D-032e7329.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/reactiveUtils-4dabbb80.js","assets/DynamicLayerView3D-22c99ecd.js","assets/asyncUtils-437defc4.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/aaBoundingRect-193543b5.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/LayerView3D-276cda7d.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/mat3-3fc68e72.js","assets/mat3f64-c6305894.js","assets/mat4-44a0988f.js","assets/mat4f64-1e28eae0.js","assets/aaBoundingBox-657a9b82.js","assets/BufferView-903d1848.js","assets/vec2-528adfe4.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/enums-64ab819c.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/quatf64-7fd38d64.js","assets/compilerUtils-18d58939.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/byteSizeEstimations-f0cab514.js","assets/VisualVariablePassParameters-d460182b.js","assets/VertexAttribute-9c5c630d.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/ShaderBuilder-a7d0da4e.js","assets/basicInterfaces-19ed850e.js","assets/ViewingMode-5d7d590b.js","assets/Util-a48361c6.js","assets/vec2f64-30dc1443.js","assets/vec4f64-e407da96.js","assets/sphere-2af0d852.js","assets/lineSegment-10422ca0.js","assets/Texture-46c8c2cb.js","assets/Evented-a45c8b0f.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/ScreenSpacePass-d5e48a9b.js","assets/Float4PassUniform-d7bdbc81.js","assets/Texture2DPassUniform-753de459.js","assets/assets-8d3e737a.js","assets/InterleavedLayout-984d67b2.js","assets/Matrix3PassUniform-ad9f953b.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/vec3f32-c9aa289f.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/symbolColorUtils-b2b55883.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/FloatPassUniform-68d54f51.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/projectExtentUtils-7f9e225f.js","assets/ImageMaterial-f710e8d5.js","assets/ImageMaterial.glsl-befce2a1.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/Identifiable-bfe1ff30.js","assets/Promise-376ab9f6.js","assets/RefreshableLayerView-7c1c2c75.js","assets/ImageryLayerView-31e9d56f.js","assets/OperationalLayer-97084f13.js","assets/TimeExtent-23e282b9.js","assets/persistableUrlUtils-5f719c3b.js","assets/ElevationInfo-215614d8.js","assets/jsonMap-7b8332c9.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/geometry-b7901087.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/opacityUtils-1f7f5126.js","assets/Query-b96bcde0.js","assets/enumeration-3a03bd31.js","assets/jsonUtils-229211af.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Clonable-545593ce.js","assets/popupUtils-af06d391.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/Collection-910b6f71.js","assets/SimpleObservable-23231131.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/symbolLayerUtils3D-76acc268.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/NormalUtils.glsl-c12729bf.js","assets/HUD.glsl-d3a072ad.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),"integrated-mesh":()=>G(()=>import("./IntegratedMeshLayerView3D-c416dcde.js"),["assets/IntegratedMeshLayerView3D-c416dcde.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/reactiveUtils-4dabbb80.js","assets/I3SMeshView3D-cfbe0b2b.js","assets/byteSizeEstimations-f0cab514.js","assets/unitUtils-45d1147c.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/mat4-44a0988f.js","assets/mat4f64-1e28eae0.js","assets/vec4f64-e407da96.js","assets/projection-290b739f.js","assets/assets-8d3e737a.js","assets/zscale-89472cba.js","assets/I3SOverrides-b08cc3de.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Scheduler-540208b6.js","assets/ViewingMode-5d7d590b.js","assets/I3SNode-941d6d9e.js","assets/sphere-2af0d852.js","assets/mat3f64-c6305894.js","assets/quatf64-7fd38d64.js","assets/vec2f64-30dc1443.js","assets/I3SUtil-f31a4571.js","assets/quat-3d5eec2d.js","assets/I3SBinaryReader-f4829435.js","assets/VertexAttribute-9c5c630d.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/symbolColorUtils-b2b55883.js","assets/vec3f32-c9aa289f.js","assets/plane-b575face.js","assets/asyncUtils-437defc4.js","assets/RenderTexture-a15e38d0.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec2-528adfe4.js","assets/compilerUtils-18d58939.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/AlphaCutoff-96178e0d.js","assets/Texture-46c8c2cb.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/Util-a48361c6.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/ScreenSpacePass-d5e48a9b.js","assets/Octree-0a267ea2.js","assets/styleUtils-22b14a8b.js","assets/FeatureLayerView3D-897c7c3e.js","assets/FeatureLayerViewBase3D-5ca6a636.js","assets/FeatureLikeLayerView3D-cace86c7.js","assets/HandleOwner-9b396af1.js","assets/arcgisLayerUrl-c09f09b4.js","assets/dehydratedFeatureComparison-59868945.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/queryForSymbologySnapping-3bbff2c8.js","assets/elevationInfoUtils-36e5dd0f.js","assets/ElevationInfo-215614d8.js","assets/lengthUtils-fa751420.js","assets/hash-0ddfbf4b.js","assets/diffUtils-68b89c71.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/jsonUtils-0ff4ff96.js","assets/Graphics3DObjectStates-1e0ab5c6.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/Layer-5ffe0eda.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OptimizedFeature-4ab8d380.js","assets/optimizedFeatureQueryEngineAdapter-d72f082e.js","assets/centroid-5c988df3.js","assets/PooledRBush-3e149119.js","assets/quickselect-322ec8e1.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/OperationalLayer-97084f13.js","assets/floorFilterUtils-080a7cd2.js","assets/QueryEngine-cdb0ba2c.js","assets/normalizeUtils-27e29a72.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/QueryEngineResult-8f90b8dc.js","assets/WhereClause-d4b8b019.js","assets/utils-b34fcd9d.js","assets/generateRendererUtils-7252b5e6.js","assets/projectionSupport-aa5eaa0d.js","assets/json-48e3ea08.js","assets/SnappingCandidate-970faec6.js","assets/utils-511aa5f5.js","assets/QueryEngineCapabilities-42e44ded.js","assets/timeSupport-3de56d7f.js","assets/FieldsIndex-f104cc5f.js","assets/FeatureSet-d32b0eb8.js","assets/scaleUtils-93ad8d0c.js","assets/FeatureStore-3cfbdfa3.js","assets/BoundsStore-b9fa27cc.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/vec2f32-461e65a9.js","assets/lineSegment-10422ca0.js","assets/InterleavedLayout-984d67b2.js","assets/Matrix3PassUniform-ad9f953b.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/Heatmap.glsl-388d8513.js","assets/HeatmapDensity.glsl-92a06674.js","assets/heatmapTextureUtils-2627384f.js","assets/projectExtentUtils-7f9e225f.js","assets/LayerView3D-276cda7d.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/LercDecoder-4c9b29b3.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/EventedSet-be3adf97.js","assets/FeatureLayerView-e9178bab.js","assets/popupUtils-af06d391.js","assets/LayerView-bd9a2316.js","assets/RefreshableLayerView-7c1c2c75.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/executeQueryJSON-2fe748db.js","assets/RelationshipQuery-0dda77ad.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/capabilities-302cf20d.js","assets/ElevationSamplerData-b87e0e50.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/NormalUtils.glsl-c12729bf.js","assets/HUD.glsl-d3a072ad.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/labelFormatUtils-d25d1d9e.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js","assets/SceneModification-3462a3f4.js","assets/persistable-ad5d84e1.js","assets/SceneLayerWorker-02654016.js"]),"line-of-sight":()=>G(()=>import("./LineOfSightLayerView3D-dac13231.js"),["assets/LineOfSightLayerView3D-dac13231.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/asyncUtils-437defc4.js","assets/reactiveUtils-4dabbb80.js","assets/LayerView3D-276cda7d.js","assets/LayerView-bd9a2316.js","assets/Evented-a45c8b0f.js","assets/HandleOwner-9b396af1.js","assets/Identifiable-bfe1ff30.js","assets/Promise-376ab9f6.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),"map-image":()=>G(()=>import("./MapImageLayerView3D-4234baf0.js"),["assets/MapImageLayerView3D-4234baf0.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/DynamicLayerView3D-22c99ecd.js","assets/asyncUtils-437defc4.js","assets/reactiveUtils-4dabbb80.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/aaBoundingRect-193543b5.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/LayerView3D-276cda7d.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/mat3-3fc68e72.js","assets/mat3f64-c6305894.js","assets/mat4-44a0988f.js","assets/mat4f64-1e28eae0.js","assets/aaBoundingBox-657a9b82.js","assets/BufferView-903d1848.js","assets/vec2-528adfe4.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/enums-64ab819c.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/quatf64-7fd38d64.js","assets/compilerUtils-18d58939.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/byteSizeEstimations-f0cab514.js","assets/VisualVariablePassParameters-d460182b.js","assets/VertexAttribute-9c5c630d.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/ShaderBuilder-a7d0da4e.js","assets/basicInterfaces-19ed850e.js","assets/ViewingMode-5d7d590b.js","assets/Util-a48361c6.js","assets/vec2f64-30dc1443.js","assets/vec4f64-e407da96.js","assets/sphere-2af0d852.js","assets/lineSegment-10422ca0.js","assets/Texture-46c8c2cb.js","assets/Evented-a45c8b0f.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/ScreenSpacePass-d5e48a9b.js","assets/Float4PassUniform-d7bdbc81.js","assets/Texture2DPassUniform-753de459.js","assets/assets-8d3e737a.js","assets/InterleavedLayout-984d67b2.js","assets/Matrix3PassUniform-ad9f953b.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/vec3f32-c9aa289f.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/symbolColorUtils-b2b55883.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/FloatPassUniform-68d54f51.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/projectExtentUtils-7f9e225f.js","assets/ImageMaterial-f710e8d5.js","assets/ImageMaterial.glsl-befce2a1.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/Identifiable-bfe1ff30.js","assets/Promise-376ab9f6.js","assets/RefreshableLayerView-7c1c2c75.js","assets/MapImageLayerView-7b24456f.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/enumeration-3a03bd31.js","assets/jsonMap-7b8332c9.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/geometry-b7901087.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/Collection-910b6f71.js","assets/SimpleObservable-23231131.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/locale-30120714.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/Clonable-545593ce.js","assets/unitUtils-45d1147c.js","assets/scaleUtils-93ad8d0c.js","assets/OperationalLayer-97084f13.js","assets/TimeExtent-23e282b9.js","assets/ElevationInfo-215614d8.js","assets/lengthUtils-fa751420.js","assets/ExportImageParameters-4b588db2.js","assets/LayerFloorInfo-54b916a2.js","assets/floorFilterUtils-080a7cd2.js","assets/sublayerUtils-96c8a85b.js","assets/clickToleranceUtils-a273d161.js","assets/normalizeUtils-27e29a72.js","assets/jsonUtils-229211af.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/number-27cf8195.js","assets/GraphicsCollection-c37a9ffd.js","assets/popupUtils-af06d391.js","assets/drapedUtils-f6534f49.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/executeQueryJSON-2fe748db.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/plane-b575face.js","assets/ElevationSamplerData-b87e0e50.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/NormalUtils.glsl-c12729bf.js","assets/HUD.glsl-d3a072ad.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),media:()=>G(()=>import("./MediaLayerView3D-892eb387.js"),["assets/MediaLayerView3D-892eb387.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/reactiveUtils-4dabbb80.js","assets/aaBoundingRect-193543b5.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/LayerView3D-276cda7d.js","assets/basicInterfaces-19ed850e.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/mat3-3fc68e72.js","assets/mat3f64-c6305894.js","assets/mat4-44a0988f.js","assets/mat4f64-1e28eae0.js","assets/aaBoundingBox-657a9b82.js","assets/BufferView-903d1848.js","assets/vec2-528adfe4.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/asyncUtils-437defc4.js","assets/enums-64ab819c.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/quatf64-7fd38d64.js","assets/compilerUtils-18d58939.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/byteSizeEstimations-f0cab514.js","assets/VisualVariablePassParameters-d460182b.js","assets/VertexAttribute-9c5c630d.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/ShaderBuilder-a7d0da4e.js","assets/ViewingMode-5d7d590b.js","assets/Util-a48361c6.js","assets/vec2f64-30dc1443.js","assets/vec4f64-e407da96.js","assets/sphere-2af0d852.js","assets/lineSegment-10422ca0.js","assets/Texture-46c8c2cb.js","assets/Evented-a45c8b0f.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/ScreenSpacePass-d5e48a9b.js","assets/Float4PassUniform-d7bdbc81.js","assets/Texture2DPassUniform-753de459.js","assets/assets-8d3e737a.js","assets/InterleavedLayout-984d67b2.js","assets/Matrix3PassUniform-ad9f953b.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/vec3f32-c9aa289f.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/symbolColorUtils-b2b55883.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/FloatPassUniform-68d54f51.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/ImageMaterial-f710e8d5.js","assets/ImageMaterial.glsl-befce2a1.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/Identifiable-bfe1ff30.js","assets/Promise-376ab9f6.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/NormalUtils.glsl-c12729bf.js","assets/HUD.glsl-d3a072ad.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),"ogc-feature":()=>G(()=>import("./OGCFeatureLayerView3D-41ee8bbc.js"),["assets/OGCFeatureLayerView3D-41ee8bbc.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/FeatureLayerViewBase3D-5ca6a636.js","assets/reactiveUtils-4dabbb80.js","assets/FeatureLikeLayerView3D-cace86c7.js","assets/asyncUtils-437defc4.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/Promise-376ab9f6.js","assets/HandleOwner-9b396af1.js","assets/arcgisLayerUrl-c09f09b4.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/persistableUrlUtils-5f719c3b.js","assets/Query-b96bcde0.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/TimeExtent-23e282b9.js","assets/enumeration-3a03bd31.js","assets/jsonUtils-229211af.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Clonable-545593ce.js","assets/aaBoundingRect-193543b5.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/dehydratedFeatures-0557137d.js","assets/byteSizeEstimations-f0cab514.js","assets/aaBoundingBox-657a9b82.js","assets/quantizationUtils-4dd81f85.js","assets/ViewingMode-5d7d590b.js","assets/dehydratedFeatureComparison-59868945.js","assets/Scheduler-540208b6.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/assets-8d3e737a.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/queryForSymbologySnapping-3bbff2c8.js","assets/elevationInfoUtils-36e5dd0f.js","assets/ElevationInfo-215614d8.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/hash-0ddfbf4b.js","assets/compilerUtils-18d58939.js","assets/diffUtils-68b89c71.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/Graphics3DObjectStates-1e0ab5c6.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/projection-290b739f.js","assets/zscale-89472cba.js","assets/Layer-5ffe0eda.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OptimizedFeature-4ab8d380.js","assets/optimizedFeatureQueryEngineAdapter-d72f082e.js","assets/centroid-5c988df3.js","assets/PooledRBush-3e149119.js","assets/quickselect-322ec8e1.js","assets/basicInterfaces-19ed850e.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/OperationalLayer-97084f13.js","assets/floorFilterUtils-080a7cd2.js","assets/QueryEngine-cdb0ba2c.js","assets/normalizeUtils-27e29a72.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/QueryEngineResult-8f90b8dc.js","assets/WhereClause-d4b8b019.js","assets/utils-b34fcd9d.js","assets/generateRendererUtils-7252b5e6.js","assets/projectionSupport-aa5eaa0d.js","assets/json-48e3ea08.js","assets/SnappingCandidate-970faec6.js","assets/utils-511aa5f5.js","assets/QueryEngineCapabilities-42e44ded.js","assets/timeSupport-3de56d7f.js","assets/FieldsIndex-f104cc5f.js","assets/FeatureSet-d32b0eb8.js","assets/scaleUtils-93ad8d0c.js","assets/FeatureStore-3cfbdfa3.js","assets/BoundsStore-b9fa27cc.js","assets/VisualVariablePassParameters-d460182b.js","assets/VertexAttribute-9c5c630d.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/ShaderBuilder-a7d0da4e.js","assets/mat3f64-c6305894.js","assets/Util-a48361c6.js","assets/vec2f64-30dc1443.js","assets/mat4f64-1e28eae0.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec2-528adfe4.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/mat3-3fc68e72.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/quatf64-7fd38d64.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/sphere-2af0d852.js","assets/lineSegment-10422ca0.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/Matrix3PassUniform-ad9f953b.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/symbolColorUtils-b2b55883.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/Heatmap.glsl-388d8513.js","assets/HeatmapDensity.glsl-92a06674.js","assets/heatmapTextureUtils-2627384f.js","assets/projectExtentUtils-7f9e225f.js","assets/LayerView3D-276cda7d.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/LercDecoder-4c9b29b3.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/EventedSet-be3adf97.js","assets/FeatureLayerView-e9178bab.js","assets/popupUtils-af06d391.js","assets/LayerView-bd9a2316.js","assets/RefreshableLayerView-7c1c2c75.js","assets/OGCFeatureLayerView-409b7077.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/executeQueryJSON-2fe748db.js","assets/RelationshipQuery-0dda77ad.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/capabilities-302cf20d.js","assets/plane-b575face.js","assets/ElevationSamplerData-b87e0e50.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/NormalUtils.glsl-c12729bf.js","assets/HUD.glsl-d3a072ad.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),"open-street-map":t1,"oriented-imagery":()=>G(()=>import("./FeatureLayerView3D-897c7c3e.js"),["assets/FeatureLayerView3D-897c7c3e.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/projection-290b739f.js","assets/preload-helper-3bce6601.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/unitUtils-45d1147c.js","assets/jsonMap-7b8332c9.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/SimpleObservable-23231131.js","assets/mat4-44a0988f.js","assets/Polyline-ff2d7c6b.js","assets/assets-8d3e737a.js","assets/request-6fc81c4c.js","assets/aaBoundingRect-193543b5.js","assets/zscale-89472cba.js","assets/styleUtils-22b14a8b.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/locale-30120714.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/FeatureLayerViewBase3D-5ca6a636.js","assets/reactiveUtils-4dabbb80.js","assets/FeatureLikeLayerView3D-cace86c7.js","assets/asyncUtils-437defc4.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/HandleOwner-9b396af1.js","assets/arcgisLayerUrl-c09f09b4.js","assets/persistableUrlUtils-5f719c3b.js","assets/Query-b96bcde0.js","assets/geometry-b7901087.js","assets/typeUtils-35750739.js","assets/TimeExtent-23e282b9.js","assets/enumeration-3a03bd31.js","assets/jsonUtils-229211af.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Clonable-545593ce.js","assets/dehydratedFeatures-0557137d.js","assets/byteSizeEstimations-f0cab514.js","assets/aaBoundingBox-657a9b82.js","assets/quantizationUtils-4dd81f85.js","assets/ViewingMode-5d7d590b.js","assets/dehydratedFeatureComparison-59868945.js","assets/Scheduler-540208b6.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/number-27cf8195.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/queryForSymbologySnapping-3bbff2c8.js","assets/elevationInfoUtils-36e5dd0f.js","assets/ElevationInfo-215614d8.js","assets/lengthUtils-fa751420.js","assets/hash-0ddfbf4b.js","assets/compilerUtils-18d58939.js","assets/diffUtils-68b89c71.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/jsonUtils-0ff4ff96.js","assets/Graphics3DObjectStates-1e0ab5c6.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/Layer-5ffe0eda.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OptimizedFeature-4ab8d380.js","assets/optimizedFeatureQueryEngineAdapter-d72f082e.js","assets/centroid-5c988df3.js","assets/PooledRBush-3e149119.js","assets/quickselect-322ec8e1.js","assets/basicInterfaces-19ed850e.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/OperationalLayer-97084f13.js","assets/floorFilterUtils-080a7cd2.js","assets/QueryEngine-cdb0ba2c.js","assets/normalizeUtils-27e29a72.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/QueryEngineResult-8f90b8dc.js","assets/WhereClause-d4b8b019.js","assets/utils-b34fcd9d.js","assets/generateRendererUtils-7252b5e6.js","assets/projectionSupport-aa5eaa0d.js","assets/json-48e3ea08.js","assets/SnappingCandidate-970faec6.js","assets/utils-511aa5f5.js","assets/QueryEngineCapabilities-42e44ded.js","assets/timeSupport-3de56d7f.js","assets/FieldsIndex-f104cc5f.js","assets/FeatureSet-d32b0eb8.js","assets/scaleUtils-93ad8d0c.js","assets/FeatureStore-3cfbdfa3.js","assets/BoundsStore-b9fa27cc.js","assets/VisualVariablePassParameters-d460182b.js","assets/VertexAttribute-9c5c630d.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/ShaderBuilder-a7d0da4e.js","assets/mat3f64-c6305894.js","assets/Util-a48361c6.js","assets/vec2f64-30dc1443.js","assets/mat4f64-1e28eae0.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec2-528adfe4.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/mat3-3fc68e72.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/quatf64-7fd38d64.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/sphere-2af0d852.js","assets/lineSegment-10422ca0.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/Matrix3PassUniform-ad9f953b.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/symbolColorUtils-b2b55883.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/Heatmap.glsl-388d8513.js","assets/HeatmapDensity.glsl-92a06674.js","assets/heatmapTextureUtils-2627384f.js","assets/projectExtentUtils-7f9e225f.js","assets/LayerView3D-276cda7d.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/LercDecoder-4c9b29b3.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/EventedSet-be3adf97.js","assets/FeatureLayerView-e9178bab.js","assets/popupUtils-af06d391.js","assets/LayerView-bd9a2316.js","assets/RefreshableLayerView-7c1c2c75.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/executeQueryJSON-2fe748db.js","assets/RelationshipQuery-0dda77ad.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/capabilities-302cf20d.js","assets/plane-b575face.js","assets/ElevationSamplerData-b87e0e50.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/NormalUtils.glsl-c12729bf.js","assets/HUD.glsl-d3a072ad.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),"point-cloud":()=>G(()=>import("./PointCloudLayerView3D-e956a3ea.js").then(i=>i.P),["assets/PointCloudLayerView3D-e956a3ea.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/asyncUtils-437defc4.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/reactiveUtils-4dabbb80.js","assets/screenUtils-410d12c0.js","assets/unitUtils-45d1147c.js","assets/jsonMap-7b8332c9.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec3f32-c9aa289f.js","assets/projection-290b739f.js","assets/preload-helper-3bce6601.js","assets/mathUtils-b4bb77e2.js","assets/vec4-790471c0.js","assets/mat4-44a0988f.js","assets/Polyline-ff2d7c6b.js","assets/assets-8d3e737a.js","assets/request-6fc81c4c.js","assets/aaBoundingRect-193543b5.js","assets/zscale-89472cba.js","assets/aaBoundingBox-657a9b82.js","assets/plane-b575face.js","assets/sphere-2af0d852.js","assets/vec4f64-e407da96.js","assets/byteSizeEstimations-f0cab514.js","assets/mat3f64-c6305894.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/vec2f64-30dc1443.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/jsonUtils-229211af.js","assets/typeUtils-35750739.js","assets/Field-61ec9870.js","assets/enumeration-3a03bd31.js","assets/fieldType-f31285f7.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/geometry-b7901087.js","assets/Scheduler-540208b6.js","assets/ElevationInfo-215614d8.js","assets/lengthUtils-fa751420.js","assets/LayerView3D-276cda7d.js","assets/LercDecoder-4c9b29b3.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/messages-2289086c.js","assets/I3SUtil-f31a4571.js","assets/mat3-3fc68e72.js","assets/quat-3d5eec2d.js","assets/I3SBinaryReader-f4829435.js","assets/VertexAttribute-9c5c630d.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/Clonable-545593ce.js","assets/ViewingMode-5d7d590b.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/symbolColorUtils-b2b55883.js","assets/PointCloudWorkerUtil-831c5cd2.js","assets/PointCloudUniqueValueRenderer-b0367a06.js","assets/LegendOptions-010d0873.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/basicInterfaces-19ed850e.js","assets/Matrix3PassUniform-ad9f953b.js","assets/ShaderBuilder-a7d0da4e.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/Util-a48361c6.js","assets/vec2-528adfe4.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/Texture2DPassUniform-753de459.js","assets/Slice.glsl-3b39b1f7.js","assets/OutputHighlight.glsl-fbac199a.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DDrawUniform-053796dc.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/compilerUtils-18d58939.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/PiUtils.glsl-db6418ee.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/lineSegment-10422ca0.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/PopupSceneLayerView-56a29af9.js","assets/popupUtils-af06d391.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js"]),voxel:()=>G(()=>import("./VoxelLayerView3D-39a52d99.js"),["assets/VoxelLayerView3D-39a52d99.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/reactiveUtils-4dabbb80.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/LayerView3D-276cda7d.js","assets/LayerView-bd9a2316.js","assets/Evented-a45c8b0f.js","assets/HandleOwner-9b396af1.js","assets/Identifiable-bfe1ff30.js","assets/Promise-376ab9f6.js","assets/context-util-a4ce3a7b.js","assets/preload-helper-3bce6601.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),route:()=>G(()=>import("./RouteLayerView3D-c4e2dd4a.js"),["assets/RouteLayerView3D-c4e2dd4a.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/Stop-8921a099.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/LayerView3D-276cda7d.js","assets/GraphicsProcessor-e3db4c8c.js","assets/HandleOwner-9b396af1.js","assets/diffUtils-68b89c71.js","assets/Layer-5ffe0eda.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Graphics3DObjectStates-1e0ab5c6.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/MemCache-18a255ed.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/projection-290b739f.js","assets/mat4-44a0988f.js","assets/assets-8d3e737a.js","assets/zscale-89472cba.js","assets/dehydratedFeatures-0557137d.js","assets/byteSizeEstimations-f0cab514.js","assets/quantizationUtils-4dd81f85.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OptimizedFeature-4ab8d380.js","assets/optimizedFeatureQueryEngineAdapter-d72f082e.js","assets/centroid-5c988df3.js","assets/asyncUtils-437defc4.js","assets/PooledRBush-3e149119.js","assets/quickselect-322ec8e1.js","assets/ElevationInfo-215614d8.js","assets/basicInterfaces-19ed850e.js","assets/Scheduler-540208b6.js","assets/projectExtentUtils-7f9e225f.js","assets/EventedSet-be3adf97.js","assets/LayerView-bd9a2316.js","assets/Cyclical-151bcc41.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/RelationshipQuery-0dda77ad.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),scene:i=>i.profile==null||i.profile==="mesh-pyramids"?G(()=>import("./SceneLayerView3D-9e589e6c.js"),["assets/SceneLayerView3D-9e589e6c.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/reactiveUtils-4dabbb80.js","assets/WhereClause-d4b8b019.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/TimeExtent-23e282b9.js","assets/Query-b96bcde0.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/MemCache-18a255ed.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/floorFilterUtils-080a7cd2.js","assets/I3SMeshView3D-cfbe0b2b.js","assets/byteSizeEstimations-f0cab514.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/mat4f64-1e28eae0.js","assets/projection-290b739f.js","assets/assets-8d3e737a.js","assets/zscale-89472cba.js","assets/I3SOverrides-b08cc3de.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/Scheduler-540208b6.js","assets/ViewingMode-5d7d590b.js","assets/I3SNode-941d6d9e.js","assets/sphere-2af0d852.js","assets/mat3f64-c6305894.js","assets/quatf64-7fd38d64.js","assets/vec2f64-30dc1443.js","assets/I3SUtil-f31a4571.js","assets/quat-3d5eec2d.js","assets/I3SBinaryReader-f4829435.js","assets/VertexAttribute-9c5c630d.js","assets/symbolColorUtils-b2b55883.js","assets/vec3f32-c9aa289f.js","assets/plane-b575face.js","assets/asyncUtils-437defc4.js","assets/RenderTexture-a15e38d0.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec2-528adfe4.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/AlphaCutoff-96178e0d.js","assets/Texture-46c8c2cb.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/Util-a48361c6.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/ScreenSpacePass-d5e48a9b.js","assets/Octree-0a267ea2.js","assets/FeatureLayerView3D-897c7c3e.js","assets/FeatureLayerViewBase3D-5ca6a636.js","assets/FeatureLikeLayerView3D-cace86c7.js","assets/HandleOwner-9b396af1.js","assets/arcgisLayerUrl-c09f09b4.js","assets/dehydratedFeatureComparison-59868945.js","assets/utils-6786b611.js","assets/ItemCache-fd3aceaf.js","assets/queryForSymbologySnapping-3bbff2c8.js","assets/elevationInfoUtils-36e5dd0f.js","assets/hash-0ddfbf4b.js","assets/Graphics3DObjectStates-1e0ab5c6.js","assets/Layer-5ffe0eda.js","assets/OptimizedFeature-4ab8d380.js","assets/optimizedFeatureQueryEngineAdapter-d72f082e.js","assets/centroid-5c988df3.js","assets/PooledRBush-3e149119.js","assets/quickselect-322ec8e1.js","assets/QueryEngine-cdb0ba2c.js","assets/normalizeUtils-27e29a72.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/QueryEngineResult-8f90b8dc.js","assets/utils-b34fcd9d.js","assets/generateRendererUtils-7252b5e6.js","assets/projectionSupport-aa5eaa0d.js","assets/json-48e3ea08.js","assets/SnappingCandidate-970faec6.js","assets/utils-511aa5f5.js","assets/QueryEngineCapabilities-42e44ded.js","assets/timeSupport-3de56d7f.js","assets/FieldsIndex-f104cc5f.js","assets/FeatureSet-d32b0eb8.js","assets/scaleUtils-93ad8d0c.js","assets/FeatureStore-3cfbdfa3.js","assets/BoundsStore-b9fa27cc.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/vec2f32-461e65a9.js","assets/lineSegment-10422ca0.js","assets/InterleavedLayout-984d67b2.js","assets/Matrix3PassUniform-ad9f953b.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/Heatmap.glsl-388d8513.js","assets/HeatmapDensity.glsl-92a06674.js","assets/heatmapTextureUtils-2627384f.js","assets/projectExtentUtils-7f9e225f.js","assets/LayerView3D-276cda7d.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/LercDecoder-4c9b29b3.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/EventedSet-be3adf97.js","assets/FeatureLayerView-e9178bab.js","assets/popupUtils-af06d391.js","assets/LayerView-bd9a2316.js","assets/RefreshableLayerView-7c1c2c75.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/executeQueryJSON-2fe748db.js","assets/RelationshipQuery-0dda77ad.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/capabilities-302cf20d.js","assets/ElevationSamplerData-b87e0e50.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/NormalUtils.glsl-c12729bf.js","assets/HUD.glsl-d3a072ad.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/labelFormatUtils-d25d1d9e.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js","assets/SceneModification-3462a3f4.js","assets/persistable-ad5d84e1.js","assets/SceneLayerWorker-02654016.js","assets/SceneLayerView-c06ba281.js","assets/DefinitionExpressionSceneLayerView-9802dbb8.js","assets/I3SQueryFeatureStore-b0bfbe05.js","assets/PopupSceneLayerView-56a29af9.js"]):G(()=>import("./SceneLayerGraphicsView3D-3b9950e8.js"),["assets/SceneLayerGraphicsView3D-3b9950e8.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/reactiveUtils-4dabbb80.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/assets-8d3e737a.js","assets/zscale-89472cba.js","assets/dehydratedFeatures-0557137d.js","assets/byteSizeEstimations-f0cab514.js","assets/quantizationUtils-4dd81f85.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/I3SOverrides-b08cc3de.js","assets/Scheduler-540208b6.js","assets/ViewingMode-5d7d590b.js","assets/vec4f64-e407da96.js","assets/I3SNode-941d6d9e.js","assets/sphere-2af0d852.js","assets/mat3f64-c6305894.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/vec2f64-30dc1443.js","assets/I3SUtil-f31a4571.js","assets/mat3-3fc68e72.js","assets/quat-3d5eec2d.js","assets/I3SBinaryReader-f4829435.js","assets/VertexAttribute-9c5c630d.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/symbolColorUtils-b2b55883.js","assets/vec3f32-c9aa289f.js","assets/plane-b575face.js","assets/asyncUtils-437defc4.js","assets/RenderTexture-a15e38d0.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec2-528adfe4.js","assets/compilerUtils-18d58939.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/AlphaCutoff-96178e0d.js","assets/Texture-46c8c2cb.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/Util-a48361c6.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/ScreenSpacePass-d5e48a9b.js","assets/Octree-0a267ea2.js","assets/styleUtils-22b14a8b.js","assets/FeatureLayerView3D-897c7c3e.js","assets/FeatureLayerViewBase3D-5ca6a636.js","assets/FeatureLikeLayerView3D-cace86c7.js","assets/HandleOwner-9b396af1.js","assets/arcgisLayerUrl-c09f09b4.js","assets/dehydratedFeatureComparison-59868945.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/queryForSymbologySnapping-3bbff2c8.js","assets/elevationInfoUtils-36e5dd0f.js","assets/ElevationInfo-215614d8.js","assets/lengthUtils-fa751420.js","assets/hash-0ddfbf4b.js","assets/diffUtils-68b89c71.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/jsonUtils-0ff4ff96.js","assets/Graphics3DObjectStates-1e0ab5c6.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/Layer-5ffe0eda.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OptimizedFeature-4ab8d380.js","assets/optimizedFeatureQueryEngineAdapter-d72f082e.js","assets/centroid-5c988df3.js","assets/PooledRBush-3e149119.js","assets/quickselect-322ec8e1.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/OperationalLayer-97084f13.js","assets/floorFilterUtils-080a7cd2.js","assets/QueryEngine-cdb0ba2c.js","assets/normalizeUtils-27e29a72.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/QueryEngineResult-8f90b8dc.js","assets/WhereClause-d4b8b019.js","assets/utils-b34fcd9d.js","assets/generateRendererUtils-7252b5e6.js","assets/projectionSupport-aa5eaa0d.js","assets/json-48e3ea08.js","assets/SnappingCandidate-970faec6.js","assets/utils-511aa5f5.js","assets/QueryEngineCapabilities-42e44ded.js","assets/timeSupport-3de56d7f.js","assets/FieldsIndex-f104cc5f.js","assets/FeatureSet-d32b0eb8.js","assets/scaleUtils-93ad8d0c.js","assets/FeatureStore-3cfbdfa3.js","assets/BoundsStore-b9fa27cc.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/lineSegment-10422ca0.js","assets/InterleavedLayout-984d67b2.js","assets/Matrix3PassUniform-ad9f953b.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/Heatmap.glsl-388d8513.js","assets/HeatmapDensity.glsl-92a06674.js","assets/heatmapTextureUtils-2627384f.js","assets/projectExtentUtils-7f9e225f.js","assets/LayerView3D-276cda7d.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/LercDecoder-4c9b29b3.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/EventedSet-be3adf97.js","assets/FeatureLayerView-e9178bab.js","assets/popupUtils-af06d391.js","assets/LayerView-bd9a2316.js","assets/RefreshableLayerView-7c1c2c75.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/executeQueryJSON-2fe748db.js","assets/RelationshipQuery-0dda77ad.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/capabilities-302cf20d.js","assets/ElevationSamplerData-b87e0e50.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/NormalUtils.glsl-c12729bf.js","assets/HUD.glsl-d3a072ad.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/labelFormatUtils-d25d1d9e.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js","assets/SceneLayerView-c06ba281.js","assets/DefinitionExpressionSceneLayerView-9802dbb8.js","assets/PopupSceneLayerView-56a29af9.js"]),stream:()=>G(()=>import("./StreamLayerView3D-ac7e79d2.js"),["assets/StreamLayerView3D-ac7e79d2.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/reactiveUtils-4dabbb80.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/HandleOwner-9b396af1.js","assets/StreamFeatureManager-adf26b1c.js","assets/CircularArray-f4b6cd92.js","assets/createConnection-37f8beca.js","assets/zscale-89472cba.js","assets/unitUtils-45d1147c.js","assets/query-694f7287.js","assets/normalizeUtils-27e29a72.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/EventedSet-be3adf97.js","assets/FeatureLikeLayerView3D-cace86c7.js","assets/asyncUtils-437defc4.js","assets/arcgisLayerUrl-c09f09b4.js","assets/dehydratedFeatures-0557137d.js","assets/byteSizeEstimations-f0cab514.js","assets/quantizationUtils-4dd81f85.js","assets/ViewingMode-5d7d590b.js","assets/dehydratedFeatureComparison-59868945.js","assets/Scheduler-540208b6.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/assets-8d3e737a.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/queryForSymbologySnapping-3bbff2c8.js","assets/elevationInfoUtils-36e5dd0f.js","assets/ElevationInfo-215614d8.js","assets/lengthUtils-fa751420.js","assets/hash-0ddfbf4b.js","assets/compilerUtils-18d58939.js","assets/diffUtils-68b89c71.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/Graphics3DObjectStates-1e0ab5c6.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/projection-290b739f.js","assets/Layer-5ffe0eda.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/optimizedFeatureQueryEngineAdapter-d72f082e.js","assets/centroid-5c988df3.js","assets/PooledRBush-3e149119.js","assets/quickselect-322ec8e1.js","assets/basicInterfaces-19ed850e.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/OperationalLayer-97084f13.js","assets/floorFilterUtils-080a7cd2.js","assets/QueryEngine-cdb0ba2c.js","assets/featureConversionUtils-03a03f40.js","assets/QueryEngineResult-8f90b8dc.js","assets/WhereClause-d4b8b019.js","assets/utils-b34fcd9d.js","assets/generateRendererUtils-7252b5e6.js","assets/projectionSupport-aa5eaa0d.js","assets/json-48e3ea08.js","assets/SnappingCandidate-970faec6.js","assets/utils-511aa5f5.js","assets/QueryEngineCapabilities-42e44ded.js","assets/timeSupport-3de56d7f.js","assets/FieldsIndex-f104cc5f.js","assets/FeatureSet-d32b0eb8.js","assets/scaleUtils-93ad8d0c.js","assets/FeatureStore-3cfbdfa3.js","assets/BoundsStore-b9fa27cc.js","assets/VisualVariablePassParameters-d460182b.js","assets/VertexAttribute-9c5c630d.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/ShaderBuilder-a7d0da4e.js","assets/mat3f64-c6305894.js","assets/Util-a48361c6.js","assets/vec2f64-30dc1443.js","assets/mat4f64-1e28eae0.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec2-528adfe4.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/mat3-3fc68e72.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/quatf64-7fd38d64.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/sphere-2af0d852.js","assets/lineSegment-10422ca0.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/Matrix3PassUniform-ad9f953b.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/symbolColorUtils-b2b55883.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/Heatmap.glsl-388d8513.js","assets/HeatmapDensity.glsl-92a06674.js","assets/heatmapTextureUtils-2627384f.js","assets/projectExtentUtils-7f9e225f.js","assets/LayerView3D-276cda7d.js","assets/LayerView-bd9a2316.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/executeQueryJSON-2fe748db.js","assets/RelationshipQuery-0dda77ad.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/capabilities-302cf20d.js","assets/plane-b575face.js","assets/ElevationSamplerData-b87e0e50.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/NormalUtils.glsl-c12729bf.js","assets/HUD.glsl-d3a072ad.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),tile:t1,"imagery-tile":()=>G(()=>import("./ImageryTileLayerView3D-d70d54d4.js"),["assets/ImageryTileLayerView3D-d70d54d4.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/reactiveUtils-4dabbb80.js","assets/LayerView3D-276cda7d.js","assets/TiledLayerView3D-d9768dab.js","assets/ImageryTileLayerView-f97d6c38.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/OperationalLayer-97084f13.js","assets/TimeExtent-23e282b9.js","assets/ElevationInfo-215614d8.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/rasterProjectionHelper-a7452876.js","assets/projection-290b739f.js","assets/mat4-44a0988f.js","assets/assets-8d3e737a.js","assets/zscale-89472cba.js","assets/popupUtils-af06d391.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/RefreshableLayerView-7c1c2c75.js","assets/drapedUtils-f6534f49.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),"vector-tile":()=>G(()=>import("./VectorTileLayerView3D-f9298701.js"),["assets/VectorTileLayerView3D-f9298701.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/reactiveUtils-4dabbb80.js","assets/MemCache-18a255ed.js","assets/mat3f32-d3d088e8.js","assets/aaBoundingRect-193543b5.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/TileInfoViewPOT-135a9f15.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/number-27cf8195.js","assets/jsonMap-7b8332c9.js","assets/locale-30120714.js","assets/messages-2289086c.js","assets/Rect-ea14f53a.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/pbf-0e99a620.js","assets/rasterizingUtils-ec11e94c.js","assets/floatRGBA-9ad35d39.js","assets/TileKey-5aef17b6.js","assets/config-1337d16e.js","assets/StyleDefinition-ff072275.js","assets/enums-2658a65c.js","assets/TileInfo-b0eb8c90.js","assets/unitUtils-45d1147c.js","assets/TileStore-00ac650f.js","assets/Evented-a45c8b0f.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-b96bcde0.js","assets/geometry-b7901087.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/TimeExtent-23e282b9.js","assets/enumeration-3a03bd31.js","assets/jsonUtils-229211af.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Clonable-545593ce.js","assets/WGLBrushVTLSymbol-d778c554.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/vec2f64-30dc1443.js","assets/VertexElementDescriptor-2925c6af.js","assets/enums-4ca4641f.js","assets/number-954e4ab6.js","assets/FramebufferObject-a3b9c52c.js","assets/vec2f32-461e65a9.js","assets/GeometryUtils-c093d234.js","assets/VTLMaterialManager-2c63b5e3.js","assets/enums-0fc02184.js","assets/ShaderCompiler-77d0dcb6.js","assets/programUtils-f035fe8a.js","assets/StyleRepository-0c36ed5d.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/colorUtils-0c057879.js","assets/GeometryUtils-eebff0a0.js","assets/Geometry-daada628.js","assets/LayerView3D-276cda7d.js","assets/TiledLayerView3D-d9768dab.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/Identifiable-bfe1ff30.js","assets/Promise-376ab9f6.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/Collection-910b6f71.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/projection-290b739f.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/vec2-528adfe4.js","assets/TileStrategy-a90cd1af.js","assets/capabilities-302cf20d.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),wcs:()=>G(()=>import("./ImageryTileLayerView3D-d70d54d4.js"),["assets/ImageryTileLayerView3D-d70d54d4.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/reactiveUtils-4dabbb80.js","assets/LayerView3D-276cda7d.js","assets/TiledLayerView3D-d9768dab.js","assets/ImageryTileLayerView-f97d6c38.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/OperationalLayer-97084f13.js","assets/TimeExtent-23e282b9.js","assets/ElevationInfo-215614d8.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/rasterProjectionHelper-a7452876.js","assets/projection-290b739f.js","assets/mat4-44a0988f.js","assets/assets-8d3e737a.js","assets/zscale-89472cba.js","assets/popupUtils-af06d391.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/RefreshableLayerView-7c1c2c75.js","assets/drapedUtils-f6534f49.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),"web-tile":t1,wfs:()=>G(()=>import("./WFSLayerView3D-dd6c71da.js"),["assets/WFSLayerView3D-dd6c71da.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/FeatureLayerViewBase3D-5ca6a636.js","assets/reactiveUtils-4dabbb80.js","assets/FeatureLikeLayerView3D-cace86c7.js","assets/asyncUtils-437defc4.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/Promise-376ab9f6.js","assets/HandleOwner-9b396af1.js","assets/arcgisLayerUrl-c09f09b4.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/persistableUrlUtils-5f719c3b.js","assets/Query-b96bcde0.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/TimeExtent-23e282b9.js","assets/enumeration-3a03bd31.js","assets/jsonUtils-229211af.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Clonable-545593ce.js","assets/aaBoundingRect-193543b5.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/dehydratedFeatures-0557137d.js","assets/byteSizeEstimations-f0cab514.js","assets/aaBoundingBox-657a9b82.js","assets/quantizationUtils-4dd81f85.js","assets/ViewingMode-5d7d590b.js","assets/dehydratedFeatureComparison-59868945.js","assets/Scheduler-540208b6.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/assets-8d3e737a.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/queryForSymbologySnapping-3bbff2c8.js","assets/elevationInfoUtils-36e5dd0f.js","assets/ElevationInfo-215614d8.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/hash-0ddfbf4b.js","assets/compilerUtils-18d58939.js","assets/diffUtils-68b89c71.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/Graphics3DObjectStates-1e0ab5c6.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/projection-290b739f.js","assets/zscale-89472cba.js","assets/Layer-5ffe0eda.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OptimizedFeature-4ab8d380.js","assets/optimizedFeatureQueryEngineAdapter-d72f082e.js","assets/centroid-5c988df3.js","assets/PooledRBush-3e149119.js","assets/quickselect-322ec8e1.js","assets/basicInterfaces-19ed850e.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/OperationalLayer-97084f13.js","assets/floorFilterUtils-080a7cd2.js","assets/QueryEngine-cdb0ba2c.js","assets/normalizeUtils-27e29a72.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/QueryEngineResult-8f90b8dc.js","assets/WhereClause-d4b8b019.js","assets/utils-b34fcd9d.js","assets/generateRendererUtils-7252b5e6.js","assets/projectionSupport-aa5eaa0d.js","assets/json-48e3ea08.js","assets/SnappingCandidate-970faec6.js","assets/utils-511aa5f5.js","assets/QueryEngineCapabilities-42e44ded.js","assets/timeSupport-3de56d7f.js","assets/FieldsIndex-f104cc5f.js","assets/FeatureSet-d32b0eb8.js","assets/scaleUtils-93ad8d0c.js","assets/FeatureStore-3cfbdfa3.js","assets/BoundsStore-b9fa27cc.js","assets/VisualVariablePassParameters-d460182b.js","assets/VertexAttribute-9c5c630d.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/ShaderBuilder-a7d0da4e.js","assets/mat3f64-c6305894.js","assets/Util-a48361c6.js","assets/vec2f64-30dc1443.js","assets/mat4f64-1e28eae0.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec2-528adfe4.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/mat3-3fc68e72.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/quatf64-7fd38d64.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/sphere-2af0d852.js","assets/lineSegment-10422ca0.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/Matrix3PassUniform-ad9f953b.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/symbolColorUtils-b2b55883.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/Heatmap.glsl-388d8513.js","assets/HeatmapDensity.glsl-92a06674.js","assets/heatmapTextureUtils-2627384f.js","assets/projectExtentUtils-7f9e225f.js","assets/LayerView3D-276cda7d.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/LercDecoder-4c9b29b3.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/EventedSet-be3adf97.js","assets/FeatureLayerView-e9178bab.js","assets/popupUtils-af06d391.js","assets/LayerView-bd9a2316.js","assets/RefreshableLayerView-7c1c2c75.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/executeQueryJSON-2fe748db.js","assets/RelationshipQuery-0dda77ad.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/capabilities-302cf20d.js","assets/plane-b575face.js","assets/ElevationSamplerData-b87e0e50.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/NormalUtils.glsl-c12729bf.js","assets/HUD.glsl-d3a072ad.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),wms:()=>G(()=>import("./WMSLayerView3D-15302e2a.js"),["assets/WMSLayerView3D-15302e2a.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/DynamicLayerView3D-22c99ecd.js","assets/asyncUtils-437defc4.js","assets/reactiveUtils-4dabbb80.js","assets/aaBoundingRect-193543b5.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/LayerView3D-276cda7d.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/mat3-3fc68e72.js","assets/mat3f64-c6305894.js","assets/mat4-44a0988f.js","assets/mat4f64-1e28eae0.js","assets/aaBoundingBox-657a9b82.js","assets/BufferView-903d1848.js","assets/vec2-528adfe4.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/enums-64ab819c.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/quatf64-7fd38d64.js","assets/compilerUtils-18d58939.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/byteSizeEstimations-f0cab514.js","assets/VisualVariablePassParameters-d460182b.js","assets/VertexAttribute-9c5c630d.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/ShaderBuilder-a7d0da4e.js","assets/basicInterfaces-19ed850e.js","assets/ViewingMode-5d7d590b.js","assets/Util-a48361c6.js","assets/vec2f64-30dc1443.js","assets/vec4f64-e407da96.js","assets/sphere-2af0d852.js","assets/lineSegment-10422ca0.js","assets/Texture-46c8c2cb.js","assets/Evented-a45c8b0f.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/ScreenSpacePass-d5e48a9b.js","assets/Float4PassUniform-d7bdbc81.js","assets/Texture2DPassUniform-753de459.js","assets/assets-8d3e737a.js","assets/InterleavedLayout-984d67b2.js","assets/Matrix3PassUniform-ad9f953b.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/vec3f32-c9aa289f.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/symbolColorUtils-b2b55883.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/FloatPassUniform-68d54f51.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/projectExtentUtils-7f9e225f.js","assets/ImageMaterial-f710e8d5.js","assets/ImageMaterial.glsl-befce2a1.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/Identifiable-bfe1ff30.js","assets/Promise-376ab9f6.js","assets/RefreshableLayerView-7c1c2c75.js","assets/WMSLayerView-ccaae110.js","assets/OperationalLayer-97084f13.js","assets/TimeExtent-23e282b9.js","assets/persistableUrlUtils-5f719c3b.js","assets/ElevationInfo-215614d8.js","assets/jsonMap-7b8332c9.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/geometry-b7901087.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/opacityUtils-1f7f5126.js","assets/ExportWMSImageParameters-e7eb0d55.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/SimpleObservable-23231131.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/symbolLayerUtils3D-76acc268.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/NormalUtils.glsl-c12729bf.js","assets/HUD.glsl-d3a072ad.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),wmts:()=>G(()=>import("./WMTSLayerView3D-835f2fc8.js"),["assets/WMTSLayerView3D-835f2fc8.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/reactiveUtils-4dabbb80.js","assets/layerUtils-f4d08f94.js","assets/LayerView3D-276cda7d.js","assets/TiledLayerView3D-d9768dab.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/Identifiable-bfe1ff30.js","assets/Promise-376ab9f6.js","assets/RefreshableLayerView-7c1c2c75.js","assets/preload-helper-3bce6601.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),"geo-rss":null,kml:null,"map-notes":null,"subtype-group":null,unknown:null,unsupported:null};function z_e(i){const e=i.declaredClass?i.declaredClass.slice(i.declaredClass.lastIndexOf(".")+1):"Unknown",t=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new K(`${t}:view-not-supported`,`${e} is not supported in 3D`)}const a6={hasLayerViewModule:i=>y(s6[i.type]),importLayerView:i=>{const e=s6[i.type];if(S(e))throw z_e(i);return e(i)}},o6="analyses-owner-handles";var h0,Yf;(function(i){i[i.PENDING=0]="PENDING",i[i.CREATED=1]="CREATED"})(h0||(h0={})),function(i){i[i.ADDED=0]="ADDED",i[i.REMOVED=1]="REMOVED"}(Yf||(Yf={}));let $f=class extends tD{constructor(e){super(e),this._allAnalysisViews=new pt,this._creatingViewCount=0,this._items=new Map,this._scheduledUpdateHandle=null,this._attachedToViewResolver=l6(),this._analysisModules={"area-measurement":{module:null},dimension:{module:null},"direct-line-measurement":{module:null},"line-of-sight":{module:null},slice:{module:null}}}destroy(){this._disconnectOwners(),this._attachedToViewResolver.reject(ts("AnalysisViewManager was destroyed"))}attach(){this._connectOwners(),this._attachedToViewResolver.resolve()}detach(){this._disconnectOwners(),this._attachedToViewResolver.reject(ts()),this._attachedToViewResolver=l6()}get updating(){return!this.view.ready||this._creatingViewCount!==0||this._allAnalysisViews.some(e=>e.updating)}get testInfo(){return{allAnalysisViews:this._allAnalysisViews}}async whenAnalysisView(e){await this._attachedToViewResolver.promise;const t=this._items.get(e);if(S(t)||t.state.list===Yf.REMOVED)throw new K("AnalysisViewManager:no-analysisview-for-analysis","The analysis has not been added to view.analyses",{analysis:e});return t.createAnalysisViewTask.promise}_connectOwners(){this.handles.add(this._connectAnalysesCollection(this.view.analyses),o6)}_disconnectOwners(){this.handles.remove(o6),this._update(),this._creatingViewCount=0}_connectAnalysesCollection(e){for(const n of e)this._addAnalysis(n);const t=e.on("after-add",n=>this._addAnalysis(n.item)),r=e.on("after-remove",n=>this._removeAnalysis(n.item));return{remove:()=>{t.remove(),r.remove();for(const n of e)this._removeAnalysis(n)}}}_addAnalysis(e){const t=this._items.get(e);if(t==null){const r={state:{view:h0.PENDING,list:Yf.ADDED},analysis:e,view:null,createAnalysisViewTask:null};this._items.set(e,r),r.createAnalysisViewTask=Dx(n=>this._createAnalysisViewPromise(r,n))}else t.state.list=Yf.ADDED}_removeAnalysis(e){const t=this._items.get(e);t!=null?(t.state.list=Yf.REMOVED,this._scheduleUpdate()):J.getLogger(this.declaredClass).error("Trying to remove analysis which was not added")}_scheduleUpdate(){y(this._scheduledUpdateHandle)||(this._scheduledUpdateHandle=c7(()=>this._update()))}_update(){this._scheduledUpdateHandle=Os(this._scheduledUpdateHandle),this._items.forEach(e=>{if(e.state.list===Yf.REMOVED)switch(this._items.delete(e.analysis),e.state.view){case h0.PENDING:e.createAnalysisViewTask=iu(e.createAnalysisViewTask);break;case h0.CREATED:y(e.view)&&(this._allAnalysisViews.remove(e.view),e.view=Te(e.view),e.createAnalysisViewTask=null)}})}async _createAnalysisViewPromise(e,t){const r=e.analysis,n=r.type,s=this._analysisModules[n];if(this._creatingViewCount+=1,S(s.module))try{s.module=await this._loadAnalysisModule(n)}catch(o){throw this._creatingViewCount-=1,o}if(Ec(t))throw this._creatingViewCount-=1,ts("AnalysisView creation aborted");const a=new s.module.default({analysis:r,view:this.view});try{await a.when()}catch(o){throw this._creatingViewCount-=1,o}if(Ec(t))throw this._creatingViewCount-=1,a.destroy(),ts("AnalysisView creation aborted");return e.view=a,e.state.view=h0.CREATED,this._allAnalysisViews.add(a),this._creatingViewCount-=1,a}_loadAnalysisModule(e){switch(e){case"area-measurement":return G(()=>import("./AreaMeasurementAnalysisView3D-a05a7c57.js").then(t=>t.A),["assets/AreaMeasurementAnalysisView3D-a05a7c57.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/analysisThemeUtils-efa1a8b1.js","assets/unitUtils-45d1147c.js","assets/jsonMap-7b8332c9.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/geometry-b7901087.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/projection-290b739f.js","assets/preload-helper-3bce6601.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/SimpleObservable-23231131.js","assets/mat4-44a0988f.js","assets/assets-8d3e737a.js","assets/request-6fc81c4c.js","assets/aaBoundingRect-193543b5.js","assets/zscale-89472cba.js","assets/screenUtils-410d12c0.js","assets/vec2-528adfe4.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/LineVisualElement-ae15994e.js","assets/Promise-376ab9f6.js","assets/mat4f64-1e28eae0.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/Evented-a45c8b0f.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/reactiveUtils-4dabbb80.js","assets/basicInterfaces-19ed850e.js","assets/VisualVariablePassParameters-d460182b.js","assets/VertexAttribute-9c5c630d.js","assets/FramebufferObject-a3b9c52c.js","assets/ShaderBuilder-a7d0da4e.js","assets/mat3f64-c6305894.js","assets/aaBoundingBox-657a9b82.js","assets/ViewingMode-5d7d590b.js","assets/Util-a48361c6.js","assets/vec4f64-e407da96.js","assets/Segment-f7754d46.js","assets/elevationInfoUtils-36e5dd0f.js","assets/ElevationInfo-215614d8.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/lengthUtils-fa751420.js","assets/widget-fb292a2f.js","assets/intl-65a3e389.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/messages-2289086c.js","assets/uuid-73213768.js","assets/sphere-2af0d852.js","assets/byteSizeEstimations-f0cab514.js","assets/quatf64-7fd38d64.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/asyncUtils-437defc4.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/compilerUtils-18d58939.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/lineSegment-10422ca0.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/ScreenSpacePass-d5e48a9b.js","assets/Float4PassUniform-d7bdbc81.js","assets/Texture2DPassUniform-753de459.js","assets/InterleavedLayout-984d67b2.js","assets/Matrix3PassUniform-ad9f953b.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/vec3f32-c9aa289f.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/symbolColorUtils-b2b55883.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/FloatPassUniform-68d54f51.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/geometryEngine-d1bfed92.js","assets/geometryEngineBase-3dd302e0.js","assets/hydrated-c3c67fc1.js","assets/earcut-58237617.js","assets/plane-b575face.js","assets/EditGeometryOperations-464d8964.js"]);case"dimension":return G(()=>import("./DimensionAnalysisView3D-639d3794.js").then(t=>t.D),["assets/DimensionAnalysisView3D-639d3794.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/reactiveUtils-4dabbb80.js","assets/LineVisualElement-ae15994e.js","assets/Promise-376ab9f6.js","assets/projection-290b739f.js","assets/preload-helper-3bce6601.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/unitUtils-45d1147c.js","assets/jsonMap-7b8332c9.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/mat4-44a0988f.js","assets/Polyline-ff2d7c6b.js","assets/assets-8d3e737a.js","assets/request-6fc81c4c.js","assets/aaBoundingRect-193543b5.js","assets/zscale-89472cba.js","assets/mat4f64-1e28eae0.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/basicInterfaces-19ed850e.js","assets/VisualVariablePassParameters-d460182b.js","assets/VertexAttribute-9c5c630d.js","assets/FramebufferObject-a3b9c52c.js","assets/ShaderBuilder-a7d0da4e.js","assets/mat3f64-c6305894.js","assets/aaBoundingBox-657a9b82.js","assets/ViewingMode-5d7d590b.js","assets/Util-a48361c6.js","assets/vec4f64-e407da96.js","assets/LengthDimension-6eb29622.js","assets/geometry-b7901087.js","assets/typeUtils-35750739.js","assets/Clonable-545593ce.js","assets/Cyclical-151bcc41.js","assets/Segment-f7754d46.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/vec2-528adfe4.js","assets/elevationInfoUtils-36e5dd0f.js","assets/ElevationInfo-215614d8.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/lengthUtils-fa751420.js","assets/widget-fb292a2f.js","assets/intl-65a3e389.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/messages-2289086c.js","assets/uuid-73213768.js","assets/sphere-2af0d852.js","assets/byteSizeEstimations-f0cab514.js","assets/quatf64-7fd38d64.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/jsonUtils-229211af.js","assets/Field-61ec9870.js","assets/enumeration-3a03bd31.js","assets/fieldType-f31285f7.js","assets/plane-b575face.js","assets/analysisViewUtils-6a390636.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/compilerUtils-18d58939.js","assets/lineSegment-10422ca0.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/asyncUtils-437defc4.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/ScreenSpacePass-d5e48a9b.js","assets/Float4PassUniform-d7bdbc81.js","assets/Texture2DPassUniform-753de459.js","assets/InterleavedLayout-984d67b2.js","assets/Matrix3PassUniform-ad9f953b.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/vec3f32-c9aa289f.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/symbolColorUtils-b2b55883.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/FloatPassUniform-68d54f51.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/ImageMaterial-f710e8d5.js","assets/ImageMaterial.glsl-befce2a1.js","assets/Factory-83aaa3aa.js","assets/MarkerSizing.glsl-566261cc.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/HandleOwner-9b396af1.js","assets/Octree-0a267ea2.js","assets/PointVisualElement-8782335a.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/RightAngleQuadVisualElement-81fed09a.js","assets/colorUtils-0c057879.js","assets/EditGeometryOperations-464d8964.js","assets/QueryEngineResult-8f90b8dc.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/WhereClause-d4b8b019.js","assets/utils-b34fcd9d.js","assets/generateRendererUtils-7252b5e6.js","assets/colorRamps-9dac42c1.js","assets/projectionSupport-aa5eaa0d.js","assets/json-48e3ea08.js","assets/SnappingCandidate-970faec6.js","assets/utils-511aa5f5.js","assets/normalizeUtils-27e29a72.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/dehydratedFeatureComparison-59868945.js","assets/Scheduler-540208b6.js","assets/RenderTexture-a15e38d0.js"]);case"direct-line-measurement":return G(()=>import("./DirectLineMeasurementAnalysisView3D-0e41b9b3.js").then(t=>t.D),["assets/DirectLineMeasurementAnalysisView3D-0e41b9b3.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/analysisThemeUtils-efa1a8b1.js","assets/unitUtils-45d1147c.js","assets/jsonMap-7b8332c9.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/geometry-b7901087.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/projection-290b739f.js","assets/preload-helper-3bce6601.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/SimpleObservable-23231131.js","assets/mat4-44a0988f.js","assets/assets-8d3e737a.js","assets/request-6fc81c4c.js","assets/aaBoundingRect-193543b5.js","assets/zscale-89472cba.js","assets/screenUtils-410d12c0.js","assets/vec2-528adfe4.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/LineVisualElement-ae15994e.js","assets/Promise-376ab9f6.js","assets/mat4f64-1e28eae0.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/Evented-a45c8b0f.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/reactiveUtils-4dabbb80.js","assets/basicInterfaces-19ed850e.js","assets/VisualVariablePassParameters-d460182b.js","assets/VertexAttribute-9c5c630d.js","assets/FramebufferObject-a3b9c52c.js","assets/ShaderBuilder-a7d0da4e.js","assets/mat3f64-c6305894.js","assets/aaBoundingBox-657a9b82.js","assets/ViewingMode-5d7d590b.js","assets/Util-a48361c6.js","assets/vec4f64-e407da96.js","assets/Segment-f7754d46.js","assets/elevationInfoUtils-36e5dd0f.js","assets/ElevationInfo-215614d8.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/lengthUtils-fa751420.js","assets/widget-fb292a2f.js","assets/intl-65a3e389.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/messages-2289086c.js","assets/uuid-73213768.js","assets/sphere-2af0d852.js","assets/byteSizeEstimations-f0cab514.js","assets/quatf64-7fd38d64.js","assets/geometryEngine-d1bfed92.js","assets/geometryEngineBase-3dd302e0.js","assets/hydrated-c3c67fc1.js","assets/InterleavedLayout-984d67b2.js","assets/BufferView-903d1848.js","assets/types-e1c0a5bf.js","assets/Matrix3PassUniform-ad9f953b.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/asyncUtils-437defc4.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/compilerUtils-18d58939.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/lineSegment-10422ca0.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/ScreenSpacePass-d5e48a9b.js","assets/Float4PassUniform-d7bdbc81.js","assets/Texture2DPassUniform-753de459.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/vec3f32-c9aa289f.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/symbolColorUtils-b2b55883.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/FloatPassUniform-68d54f51.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/RightAngleQuadVisualElement-81fed09a.js"]);case"line-of-sight":return G(()=>import("./LineOfSightAnalysisView3D-43390a19.js"),["assets/LineOfSightAnalysisView3D-43390a19.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/vec3f64-2f9cef06.js","assets/LineVisualElement-ae15994e.js","assets/Promise-376ab9f6.js","assets/projection-290b739f.js","assets/preload-helper-3bce6601.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/unitUtils-45d1147c.js","assets/jsonMap-7b8332c9.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/mat4-44a0988f.js","assets/Polyline-ff2d7c6b.js","assets/assets-8d3e737a.js","assets/request-6fc81c4c.js","assets/aaBoundingRect-193543b5.js","assets/zscale-89472cba.js","assets/mat4f64-1e28eae0.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/reactiveUtils-4dabbb80.js","assets/basicInterfaces-19ed850e.js","assets/VisualVariablePassParameters-d460182b.js","assets/VertexAttribute-9c5c630d.js","assets/FramebufferObject-a3b9c52c.js","assets/ShaderBuilder-a7d0da4e.js","assets/mat3f64-c6305894.js","assets/aaBoundingBox-657a9b82.js","assets/ViewingMode-5d7d590b.js","assets/Util-a48361c6.js","assets/vec4f64-e407da96.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/geometry-b7901087.js","assets/typeUtils-35750739.js","assets/LineOfSightAnalysisTarget-d9c2124d.js","assets/Clonable-545593ce.js","assets/persistable-ad5d84e1.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/uuid-73213768.js","assets/persistableUrlUtils-5f719c3b.js","assets/ElevationInfo-215614d8.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/lengthUtils-fa751420.js","assets/asyncUtils-437defc4.js","assets/HandleOwner-9b396af1.js","assets/sphere-2af0d852.js","assets/byteSizeEstimations-f0cab514.js","assets/quatf64-7fd38d64.js","assets/elevationInfoUtils-36e5dd0f.js","assets/screenUtils-410d12c0.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/jsonUtils-229211af.js","assets/Field-61ec9870.js","assets/enumeration-3a03bd31.js","assets/fieldType-f31285f7.js","assets/Scheduler-540208b6.js","assets/lineSegment-10422ca0.js","assets/analysisViewUtils-6a390636.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/compilerUtils-18d58939.js","assets/vec2-528adfe4.js","assets/plane-b575face.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/ScreenSpacePass-d5e48a9b.js","assets/Float4PassUniform-d7bdbc81.js","assets/Texture2DPassUniform-753de459.js","assets/InterleavedLayout-984d67b2.js","assets/Matrix3PassUniform-ad9f953b.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/vec3f32-c9aa289f.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/symbolColorUtils-b2b55883.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/FloatPassUniform-68d54f51.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/ImageMaterial-f710e8d5.js","assets/ImageMaterial.glsl-befce2a1.js","assets/PointVisualElement-8782335a.js","assets/Octree-0a267ea2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/NormalUtils.glsl-c12729bf.js","assets/HUD.glsl-d3a072ad.js","assets/projection-a69d43d0.js","assets/HUDMaterial.glsl-32cf019c.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/portalItemUtils-2ccd793f.js"]);case"slice":return G(()=>import("./SliceAnalysisView3D-cd003c44.js").then(t=>t.S),["assets/SliceAnalysisView3D-cd003c44.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/LineVisualElement-ae15994e.js","assets/Promise-376ab9f6.js","assets/projection-290b739f.js","assets/preload-helper-3bce6601.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/unitUtils-45d1147c.js","assets/jsonMap-7b8332c9.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/SimpleObservable-23231131.js","assets/mat4-44a0988f.js","assets/Polyline-ff2d7c6b.js","assets/assets-8d3e737a.js","assets/request-6fc81c4c.js","assets/aaBoundingRect-193543b5.js","assets/zscale-89472cba.js","assets/mat4f64-1e28eae0.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/Evented-a45c8b0f.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/reactiveUtils-4dabbb80.js","assets/basicInterfaces-19ed850e.js","assets/VisualVariablePassParameters-d460182b.js","assets/VertexAttribute-9c5c630d.js","assets/FramebufferObject-a3b9c52c.js","assets/ShaderBuilder-a7d0da4e.js","assets/mat3f64-c6305894.js","assets/aaBoundingBox-657a9b82.js","assets/ViewingMode-5d7d590b.js","assets/Util-a48361c6.js","assets/vec4f64-e407da96.js","assets/geometry-b7901087.js","assets/typeUtils-35750739.js","assets/Clonable-545593ce.js","assets/Cyclical-151bcc41.js","assets/persistable-ad5d84e1.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/uuid-73213768.js","assets/persistableUrlUtils-5f719c3b.js","assets/Layer-5ffe0eda.js","assets/Identifiable-bfe1ff30.js","assets/Loadable-268c900a.js","assets/BuildingComponentSublayer-cd73d2b0.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/Collection-910b6f71.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/MemCache-18a255ed.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/TimeExtent-23e282b9.js","assets/ElevationInfo-215614d8.js","assets/RelationshipQuery-0dda77ad.js","assets/Query-b96bcde0.js","assets/HandleOwner-9b396af1.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/editsZScale-6a661299.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/asyncUtils-437defc4.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/TopFeaturesQuery-cad97c37.js","assets/popupUtils-86dc6b94.js","assets/capabilities-a18453f6.js","assets/I3SIndexInfo-7af1a739.js","assets/I3SLayerDefinitions-ec48d9ab.js","assets/I3SUtil-f31a4571.js","assets/quat-3d5eec2d.js","assets/quatf64-7fd38d64.js","assets/I3SBinaryReader-f4829435.js","assets/symbolColorUtils-b2b55883.js","assets/vec3f32-c9aa289f.js","assets/plane-b575face.js","assets/sphere-2af0d852.js","assets/byteSizeEstimations-f0cab514.js","assets/popupUtils-af06d391.js","assets/analysisViewUtils-6a390636.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/vec2-528adfe4.js","assets/lineSegment-10422ca0.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/ScreenSpacePass-d5e48a9b.js","assets/Float4PassUniform-d7bdbc81.js","assets/Texture2DPassUniform-753de459.js","assets/InterleavedLayout-984d67b2.js","assets/Matrix3PassUniform-ad9f953b.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/View.glsl-3ce196d4.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/FloatPassUniform-68d54f51.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/ImageMaterial-f710e8d5.js","assets/ImageMaterial.glsl-befce2a1.js","assets/Factory-83aaa3aa.js"])}}};function l6(){const i=Ix();return i.promise.catch(()=>{}),i}h([p()],$f.prototype,"updating",null),h([p({constructOnly:!0})],$f.prototype,"view",void 0),h([p()],$f.prototype,"_allAnalysisViews",void 0),h([p()],$f.prototype,"_creatingViewCount",void 0),$f=h([D("esri.views.3d.analysis.AnalysisViewManager3D")],$f);const B_e=$f;let Vu=class extends ue{constructor(e){super(e),this.collision=new J1,this.distance=1/0,this.minimumPoiDistance=4,this.tilt=null}get altitude(){return this.mode===Se.Local?null:this._get("altitude")||null}set altitude(e){this.mode!==Se.Local?this._set("altitude",e):J.getLogger(this.declaredClass).warn("Altitude constraint is ignored in local scenes")}clampAltitude(e){return this.altitude?ce(e,this.altitude.min,this.altitude.max):e}clampTilt(e,t){if(!this.tilt)return t;const r=this.tilt(e);return ce(t,r.min,r.max)}clampDistance(e){return Math.min(e,this.distance)}createDefaultTilt(){return this.mode===Se.Local?this._createDefaultTiltLocal():this._createDefaultTiltGlobal()}createConstantMaxTilt(e){return(t,r=uO)=>(r.min=Jn.min,r.max=e,r)}_createDefaultTiltLocal(){const e=this.collision.enabled?YS([[4e3,Jn.max],[1e4,Ct(88)],[6e6,Ct(88)]]):()=>Jn.max;return(t,r=uO)=>(r.min=Jn.min,r.max=e(t),r)}_createDefaultTiltGlobal(){const e=this.collision.enabled?YS([[4e3,Jn.max],[5e4,Ct(88)],[6e6,Ct(88)],[2e7,Jn.min]]):YS([[3e5,Jn.max],[3e6,Ct(88)],[6e6,Ct(88)],[2e7,Jn.min]]);return(t,r=uO)=>(r.min=Jn.min,r.max=e(t),r)}};function G_e(i){return{min:-2e5,max:4*i.radius}}h([p()],Vu.prototype,"altitude",null),h([p({readOnly:!0})],Vu.prototype,"collision",void 0),h([p()],Vu.prototype,"distance",void 0),h([p({readOnly:!0})],Vu.prototype,"minimumPoiDistance",void 0),h([p()],Vu.prototype,"tilt",void 0),h([p({constructOnly:!0})],Vu.prototype,"mode",void 0),Vu=h([D("esri.views.3d.state.Constraints")],Vu);const c6=G_e(lo),Jn={min:Ct(.5),max:Ct(179.5)},uO={min:0,max:0};let J1=class extends ue{constructor(){super(...arguments),this.enabled=!0,this.elevationMargin=5}};h([p({type:Boolean})],J1.prototype,"enabled",void 0),h([p({type:Number})],J1.prototype,"elevationMargin",void 0),J1=h([D("esri.views.3d.state.Constraints.CollisionConstraint")],J1);let u0=class extends ue{constructor(){super(...arguments),this.min=c6.min,this.max=c6.max}};h([p({type:Number})],u0.prototype,"min",void 0),h([p({type:Number})],u0.prototype,"max",void 0),u0=h([D("esri.views.3d.constraints.AltitudeConstraint")],u0);let Xu=class extends ue{constructor(){super(...arguments),this.mode="auto"}get near(){return this._get("near")}set near(e){this._set("near",e),e>=this._get("far")&&(this.far=e+1e-9),this.mode="manual"}castNear(e){return Math.max(1e-8,e)}get far(){return this._get("far")}set far(e){this._set("far",e),e<=this._get("near")&&(this.near=e-1e-9),this.mode="manual"}castFar(e){return Math.max(1e-8,e)}autoUpdate(e,t){this.mode==="auto"&&(this._get("near")!==e&&this._set("near",e),this._get("far")!==t&&this._set("far",t))}};h([p({type:Number,value:1e-8})],Xu.prototype,"near",null),h([qr("near")],Xu.prototype,"castNear",null),h([p({type:Number,value:1e-8})],Xu.prototype,"far",null),h([qr("far")],Xu.prototype,"castFar",null),h([p({type:["auto","manual"]})],Xu.prototype,"mode",void 0),Xu=h([D("esri.views.3d.constraints.ClipDistanceConstraint")],Xu);const cL={min:_o(Jn.min),max:_o(Jn.max)};let Kf=class extends ue{constructor(){super(...arguments),this.mode="auto"}get max(){return this._get("max")}set max(e){this._set("max",e),this.mode="manual"}castMax(e){return ce(e,cL.min,cL.max)}autoUpdate(e){this.mode==="auto"&&this._get("max")!==e&&this._set("max",e)}};h([p({type:["auto","manual"]})],Kf.prototype,"mode",void 0),h([p({type:Number,value:cL.max})],Kf.prototype,"max",null),h([qr("max")],Kf.prototype,"castMax",null),Kf=h([D("esri.views.3d.constraints.TiltConstraint")],Kf);let Jf=class extends ue{constructor(){super(...arguments),this.tilt=new Kf,this.altitude=new u0,this.clipDistance=new Xu}};h([p({type:Kf})],Jf.prototype,"tilt",void 0),h([p({type:u0})],Jf.prototype,"altitude",void 0),h([p({type:Xu})],Jf.prototype,"clipDistance",void 0),Jf=h([D("esri.views.3d.constraints.Constraints")],Jf);var hL;let fl=hL=class extends mt{constructor(i){super(i),this.type="sun",this.date=null,this.directShadowsEnabled=!1,this.displayUTCOffset=null}readDate(i,e){return e.datetime!=null&&new Date(e.datetime)||null}writeDate(i,e,t){e[t]=i.getTime()}readDirectShadowsEnabled(i,e){return!!e.directShadows}writedirectShadowsEnabled(i,e,t){i&&(e[t]=i)}writeDisplayUTCOffset(i,e){i!=null&&(e.displayUTCOffset=i)}clone(){return new hL(this.cloneConstructProperties())}cloneConstructProperties(){const i={directShadowsEnabled:this.directShadowsEnabled,displayUTCOffset:this.displayUTCOffset!=null?this.displayUTCOffset:null};return this.date!=null&&(i.date=new Date(this.date.getTime())),i}};h([p({readOnly:!0,type:["sun"],json:{write:!0}})],fl.prototype,"type",void 0),h([p({type:Date,json:{type:Number,write:{target:"datetime"}}})],fl.prototype,"date",void 0),h([Dl("date",["datetime"])],fl.prototype,"readDate",null),h([Cs("date")],fl.prototype,"writeDate",null),h([p({type:Boolean,json:{default:!1,write:{target:"directShadows"}}})],fl.prototype,"directShadowsEnabled",void 0),h([Dl("directShadowsEnabled",["directShadows"])],fl.prototype,"readDirectShadowsEnabled",null),h([Cs("directShadowsEnabled")],fl.prototype,"writedirectShadowsEnabled",null),h([p({type:Number,json:{write:!0}})],fl.prototype,"displayUTCOffset",void 0),h([Cs("displayUTCOffset")],fl.prototype,"writeDisplayUTCOffset",null),fl=hL=h([D("esri.webscene.SunLighting")],fl);const ix=fl;var Ty;let bh=Ty=class extends nn.EventedMixin(ix){constructor(i){super(i),this.cameraTrackingEnabled=!0,this.ambientOcclusionEnabled=!1,this.waterReflectionEnabled=!1,this.positionTimezoneInfo={hours:0,minutes:0,seconds:0,autoUpdated:!0};const e=new Date().getFullYear(),t=new Date("March 15, "+e+" 12:00:00 UTC");this._set("defaultDate",t),this._set("date",t)}get defaultDate(){return new Date(this._get("defaultDate").getTime())}static fromWebsceneLighting(i){return new Ty(i.cloneConstructProperties())}set defaultDate(i){const e=this._get("date")===this._get("defaultDate");i=new Date(i.getTime()),this._set("defaultDate",i),e&&this._set("date",i)}set date(i){i!=null&&(this.positionTimezoneInfo.autoUpdated=!1,this._set("date",new Date(i.getTime())))}autoUpdate(i,e){const t=Ty.calculateTimezoneOffset(this.positionTimezoneInfo);this.positionTimezoneInfo.hours=e.hours,this.positionTimezoneInfo.minutes=e.minutes,this.positionTimezoneInfo.seconds=e.seconds;let r=null;y(i)&&(this.positionTimezoneInfo.autoUpdated=!0,isNaN(i.getTime())?(r=this.defaultDate.getTime(),this._set("date",this.defaultDate)):(r=this.date&&this.date.getTime(),this._set("date",new Date(i.getTime()))));const n=Ty.calculateTimezoneOffset(this.positionTimezoneInfo);if(t!==n&&(dO.target=this,dO.timezoneOffset=n,this.emit("timezone-will-change",dO)),y(i))return!!isNaN(i.getTime())||r!==i.getTime()}clone(){const i=this._get("date")===this._get("defaultDate"),e=new Ty({...this.cloneConstructProperties(),defaultDate:this.defaultDate,cameraTrackingEnabled:this.cameraTrackingEnabled,ambientOcclusionEnabled:this.ambientOcclusionEnabled,waterReflectionEnabled:this.waterReflectionEnabled});return i&&e._set("date",e._get("defaultDate")),e.positionTimezoneInfo.autoUpdated=this.positionTimezoneInfo.autoUpdated,e.positionTimezoneInfo.hours=this.positionTimezoneInfo.hours,e.positionTimezoneInfo.minutes=this.positionTimezoneInfo.minutes,e.positionTimezoneInfo.seconds=this.positionTimezoneInfo.seconds,e}cloneWithWebsceneLighting(i){const e=this.clone();return i.date!=null&&(e.date=i.date),e.directShadowsEnabled=i.directShadowsEnabled,e.displayUTCOffset=i.displayUTCOffset,e}cloneNonPersistentConstructProperties(){return{ambientOcclusionEnabled:this.ambientOcclusionEnabled,waterReflectionEnabled:this.waterReflectionEnabled,cameraTrackingEnabled:this.cameraTrackingEnabled}}};h([p({type:Boolean})],bh.prototype,"cameraTrackingEnabled",void 0),h([p({type:Boolean})],bh.prototype,"ambientOcclusionEnabled",void 0),h([p({type:Boolean})],bh.prototype,"waterReflectionEnabled",void 0),h([p({type:Date})],bh.prototype,"defaultDate",null),h([p({type:Date})],bh.prototype,"date",null),bh=Ty=h([D("esri.views.3d.environment.SunLighting")],bh),function(i){function e({hours:t,minutes:r,seconds:n}){return Math.round(t+r/60+n/3600)}i.calculateTimezoneOffset=e}(bh||(bh={}));const dO={target:null,timezoneOffset:0},Mp=bh;var uL;let eb=uL=class extends mt{constructor(i){super(i),this.type="virtual",this.directShadowsEnabled=!1}clone(){return new uL(this.cloneConstructProperties())}cloneConstructProperties(){return{directShadowsEnabled:this.directShadowsEnabled}}};h([p({readOnly:!0,type:["virtual"],json:{write:!0}})],eb.prototype,"type",void 0),h([p({type:Boolean,json:{default:!1,name:"directShadows",write:!0}})],eb.prototype,"directShadowsEnabled",void 0),eb=uL=h([D("esri.webscene.VirtualLighting")],eb);const _R=eb;var JS;let Cy=JS=class extends nn.EventedMixin(_R){constructor(i){super(i),this.ambientOcclusionEnabled=!1,this.waterReflectionEnabled=!1,this.cameraTrackingEnabled=!0}clone(){return new JS({...this.cloneConstructProperties(),ambientOcclusionEnabled:this.ambientOcclusionEnabled,waterReflectionEnabled:this.waterReflectionEnabled,cameraTrackingEnabled:this.cameraTrackingEnabled})}static fromWebsceneLighting(i){return new JS(i.cloneConstructProperties())}cloneWithWebsceneLighting(i){const e=this.clone();return e.directShadowsEnabled=i.directShadowsEnabled,e}cloneNonPersistentConstructProperties(){return{ambientOcclusionEnabled:this.ambientOcclusionEnabled,waterReflectionEnabled:this.waterReflectionEnabled,cameraTrackingEnabled:this.cameraTrackingEnabled}}};h([p({type:Boolean})],Cy.prototype,"ambientOcclusionEnabled",void 0),h([p({type:Boolean})],Cy.prototype,"waterReflectionEnabled",void 0),h([p({type:Boolean})],Cy.prototype,"cameraTrackingEnabled",void 0),Cy=JS=h([D("esri.views.3d.environment.VirtualLighting")],Cy);const tb=Cy,H_e={key:"type",defaultKeyValue:"sun",base:null,typeMap:{sun:Mp,virtual:tb}};var dL;let qb=dL=class extends ue{set quality(i){["low","high"].includes(i)&&this._set("quality",i)}clone(){return new dL({quality:this.quality})}};h([p({type:["low","high"],value:"low"})],qb.prototype,"quality",null),qb=dL=h([D("esri.views.3d.environment.SceneViewAtmosphere")],qb);var pL;let ib=pL=class extends mt{constructor(i){super(i),this.type="sunny",this.cloudCover=.5}clone(){return new pL({cloudCover:this.cloudCover})}};h([Ra({sunny:"sunny"})],ib.prototype,"type",void 0),h([p({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],ib.prototype,"cloudCover",void 0),ib=pL=h([D("esri.views.3d.environment.SunnyWeather")],ib);const mL=ib;var fL;let rb=fL=class extends mt{constructor(i){super(i),this.type="cloudy",this.cloudCover=.5}clone(){return new fL({cloudCover:this.cloudCover})}};h([Ra({cloudy:"cloudy"})],rb.prototype,"type",void 0),h([p({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],rb.prototype,"cloudCover",void 0),rb=fL=h([D("esri.views.3d.environment.CloudyWeather")],rb);const j_e=rb;var gL;let nb=gL=class extends mt{constructor(i){super(i),this.type="foggy",this.fogStrength=.5}clone(){return new gL({fogStrength:this.fogStrength})}};h([Ra({foggy:"foggy"})],nb.prototype,"type",void 0),h([p({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],nb.prototype,"fogStrength",void 0),nb=gL=h([D("esri.views.3d.environment.FoggyWeather")],nb);const q_e=nb;var _L;let Sy=_L=class extends mt{constructor(i){super(i),this.type="rainy",this.cloudCover=.5,this.precipitation=.5}clone(){return new _L({cloudCover:this.cloudCover,precipitation:this.precipitation})}};h([Ra({rainy:"rainy"})],Sy.prototype,"type",void 0),h([p({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],Sy.prototype,"cloudCover",void 0),h([p({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],Sy.prototype,"precipitation",void 0),Sy=_L=h([D("esri.views.3d.environment.RainyWeather")],Sy);const W_e=Sy;var yL;let Df=yL=class extends mt{constructor(i){super(i),this.type="snowy",this.cloudCover=.5,this.precipitation=.5,this.snowCover="disabled"}clone(){return new yL({cloudCover:this.cloudCover,precipitation:this.precipitation,snowCover:this.snowCover})}};h([Ra({snowy:"snowy"})],Df.prototype,"type",void 0),h([p({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],Df.prototype,"cloudCover",void 0),h([p({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],Df.prototype,"precipitation",void 0),h([p({type:["enabled","disabled"],nonNullable:!0,json:{write:!0}})],Df.prototype,"snowCover",void 0),Df=yL=h([D("esri.views.3d.environment.SnowyWeather")],Df);const X_e=Df,hQ={key:"type",base:mL,typeMap:{sunny:mL,cloudy:j_e,rainy:W_e,snowy:X_e,foggy:q_e}},Q_e=Object.keys(hQ.typeMap);function Z_e(i,e){return!!Q_e.includes(i)||(e.error(`"${i}" is not a valid weather type`),!1)}const Cl=1e4,Y_e={key:"type",defaultKeyValue:"sun",base:null,typeMap:{sun:ix,virtual:_R}};let eE=class extends mt{constructor(e){super(e)}clone(){}};h([p({readOnly:!0,json:{read:!1}})],eE.prototype,"type",void 0),eE=h([D("esri.webscene.background.Background")],eE);const uQ=eE;var vL;const K_e={...qte,nonNullable:!0};let sb=vL=class extends uQ{constructor(i){super(i),this.type="color",this.color=new ei([0,0,0,1])}clone(){return new vL(this.cloneProperties())}cloneProperties(){return{color:this.color.clone()}}};h([Ra({color:"color"},{readOnly:!0})],sb.prototype,"type",void 0),h([p(K_e)],sb.prototype,"color",void 0),sb=vL=h([D("esri.webscene.background.ColorBackground")],sb);const dQ=sb,h6={base:uQ,key:"type",typeMap:{color:dQ}};function J_e(i){return(e,t,r)=>{if(!e)return e;for(const n in i.typeMap)if(e.type===n){const s=new i.typeMap[n];return s.read(e,r),s}}}const eye={types:h6,json:{read:J_e(h6),write:{overridePolicy:(i,e,t)=>({enabled:!t||!t.isPresentation})}}};var bL;const pQ="esri.webscene.Environment",tye=J.getLogger(pQ),u6=(i,e,t)=>({enabled:!t||!t.isPresentation});let Ip=bL=class extends mt{constructor(i){super(i),this.lighting=new ix,this.background=null,this.atmosphereEnabled=!0,this.starsEnabled=!0}set weather(i){Z_e(i==null?void 0:i.type,tye)&&this._set("weather",i)}clone(){return new bL(this.cloneConstructProperties())}cloneConstructProperties(){return{lighting:this.lighting&&this.lighting.type==="virtual"?_R.prototype.clone.call(this.lighting):ix.prototype.clone.call(this.lighting),background:Rr(this.background),atmosphereEnabled:this.atmosphereEnabled,starsEnabled:this.starsEnabled,weather:this.weather.clone()}}};h([p({types:Y_e,nonNullable:!0,json:{write:!0}})],Ip.prototype,"lighting",void 0),h([p(eye)],Ip.prototype,"background",void 0),h([p({type:Boolean,nonNullable:!0,json:{write:{overridePolicy:u6}}})],Ip.prototype,"atmosphereEnabled",void 0),h([p({type:Boolean,nonNullable:!0,json:{write:{overridePolicy:u6}}})],Ip.prototype,"starsEnabled",void 0),h([p({types:hQ,nonNullable:!0,json:{write:!0},value:new mL})],Ip.prototype,"weather",null),Ip=bL=h([D(pQ)],Ip);const mQ=Ip;var ab;let Ey=ab=class extends mQ{constructor(i){super(i),this.atmosphere=new qb,this.lighting=new Mp,this.cachedCameraTrackingEnabled=null}static fromWebsceneEnvironment(i){const e=i.cloneConstructProperties();return new ab({...e,lighting:e.lighting.type==="virtual"?tb.fromWebsceneLighting(e.lighting):Mp.fromWebsceneLighting(e.lighting)})}castLighting(i){return this._convertLighting(i)}applyLighting(i){this.lighting=this._convertLighting(i)}_convertLighting(i){var e,t;return i?i instanceof Mp||i instanceof tb?i:i instanceof ix?this.lighting&&this.lighting.type!=="virtual"?this.lighting.cloneWithWebsceneLighting(i):new Mp({...i.cloneConstructProperties(),...(e=this.lighting)==null?void 0:e.cloneNonPersistentConstructProperties()}):i instanceof _R?this.lighting&&this.lighting.type==="virtual"?this.lighting.cloneWithWebsceneLighting(i):new tb({...i.cloneConstructProperties(),...(t=this.lighting)==null?void 0:t.cloneNonPersistentConstructProperties()}):ete(H_e,i):new Mp}clone(){return new ab({lighting:this.lighting.clone(),atmosphere:this.atmosphere.clone(),weather:this.weather.clone(),atmosphereEnabled:this.atmosphereEnabled,starsEnabled:this.starsEnabled,background:Rr(this.background)})}cloneWithWebsceneEnvironment(i){return new ab({atmosphere:this.atmosphere.clone(),weather:this.weather.clone(),atmosphereEnabled:this.atmosphereEnabled,starsEnabled:this.starsEnabled,background:Rr(this.background),...i.cloneConstructProperties(),lighting:this._getLighting(i)})}_getLighting(i){switch(i.lighting.type){case"sun":return this.lighting&&this.lighting.type==="sun"?this.lighting.cloneWithWebsceneLighting(i.lighting):Mp.fromWebsceneLighting(i.lighting);case"virtual":return this.lighting&&this.lighting.type==="virtual"?this.lighting.cloneWithWebsceneLighting(i.lighting):tb.fromWebsceneLighting(i.lighting);default:return Pa(i.lighting),Mp.fromWebsceneLighting(i.lighting)}}};h([p({type:qb,json:{read:!1},nonNullable:!0})],Ey.prototype,"atmosphere",void 0),h([p({nonNullable:!0})],Ey.prototype,"lighting",void 0),h([qr("lighting")],Ey.prototype,"castLighting",null),Ey=ab=h([D("esri.views.3d.environment.SceneViewEnvironment")],Ey);const Py=Ey;var In;(function(i){i[i.Simple=0]="Simple",i[i.Realistic=1]="Realistic",i[i.Panoramic=2]="Panoramic",i[i.None=3]="None"})(In||(In={}));function fQ(i){return Math.min(1,Math.max(0,(i-1e5)/(1e6-1e5)))}const wL=1e4,iye=.085,rx=1e5,Wb=Ge(parseFloat(Number(5802e-9).toFixed(6)),parseFloat(Number(13558e-9).toFixed(6)),parseFloat(Number(331e-7).toFixed(6))),pO=3,mO=Ge(pO*parseFloat(Number(65e-8).toFixed(6)),pO*parseFloat(Number(1881e-9).toFixed(6)),pO*parseFloat(Number(85e-9).toFixed(6))),rye=3996e-9,nye=Ge(parseFloat(Number(Wb[0]+mO[0]).toFixed(6)),parseFloat(Number(Wb[1]+mO[1]).toFixed(6)),parseFloat(Number(Wb[2]+mO[2]).toFixed(6)));function sye(i){const e=new Yi;e.attributes.add(P.POSITION,"vec2"),e.include(AP,{textureCoordinateType:Mm.Default}),e.varyings.add("worldRay","vec3"),e.varyings.add("eyeDir","vec3");const{vertex:t,fragment:r}=e;return t.uniforms.add([new Ys("inverseProjectionMatrix",(n,s)=>s.camera.inverseProjectionMatrix),new Ys("inverseViewMatrix",(n,s)=>kn(aye,s.camera.viewMatrix))]),t.code.add(O`void main(void) {
vec3 posViewNear = (inverseProjectionMatrix * vec4(position, -1, 1)).xyz;
eyeDir = posViewNear;
worldRay = (inverseViewMatrix * vec4(posViewNear, 0)).xyz;
forwardTextureCoordinates();
gl_Position = vec4(position, 1, 1);
}`),r.uniforms.add([new Zs("radii",n=>n.radii),new Rs("cameraPosition",(n,s)=>s.camera.eye),new Xh("heightParameters",n=>n.heightParameters),new Tt("innerFadeDistance",n=>n.innerFadeDistance),new Tt("altitudeFade",n=>n.altitudeFade),new Bt("depthTex",n=>n.depthTex),new Tt("hazeStrength",n=>n.hazeStrength)]),r.constants.add("betaRayleigh","vec3",Wb),r.constants.add("betaCombined","vec3",nye),r.constants.add("betaMie","float",rye),r.constants.add("scaleHeight","float",iye*rx),OP(r),e.include(ED),i.haze&&(r.include(Og),r.uniforms.add(new Zs("nearFar",(n,s)=>s.camera.nearFar))),r.code.add(O`vec2 sphereIntersect(vec3 start, vec3 dir, float radius, bool planet) {
float a = dot(dir, dir);
float b = 2.0 * dot(dir, start);
float c = planet ? heightParameters[1] - radius * radius : heightParameters[2];
float d = (b * b) - 4.0 * a * c;
if (d < 0.0) {
return vec2(1e5, -1e5);
}
return vec2((-b - sqrt(d)) / (2.0 * a), (-b + sqrt(d)) / (2.0 * a));
}`),r.code.add(O`float chapmanApproximation(float X, float h, float cosZenith) {
float c = sqrt(X + h);
float cExpH = c * exp(-h);
if (cosZenith >= 0.0) {
return cExpH / (c * cosZenith + 1.0);
} else {
float x0 = sqrt(1.0 - cosZenith * cosZenith) * (X + h);
float c0 = sqrt(x0);
return 2.0 * c0 * exp(X - x0) - cExpH / (1.0 - c * cosZenith);
}
}`),r.code.add(O`float getOpticalDepth(vec3 position, vec3 dir, float h) {
return scaleHeight * chapmanApproximation(radii[0] / scaleHeight, h, dot(normalize(position), dir));
}`),r.code.add(O`
    const int STEPS = 6;

    float getGlow(float dist, float radius, float intensity) {
      return pow(radius / max(dist, 1e-6), intensity);
    }

    vec3 getAtmosphereColour(vec3 cameraPos, vec3 rayDir, vec3 lightDir, float terrainDepth) {
      float reducedPlanetRadius = radii[0] - 20000.0;
      vec2 rayPlanetIntersect = sphereIntersect(cameraPos, rayDir, reducedPlanetRadius, true);
      vec2 rayAtmosphereIntersect = sphereIntersect(cameraPos, rayDir, radii[1], false);
      bool hitsAtmosphere = (rayAtmosphereIntersect.x <= rayAtmosphereIntersect.y) && rayAtmosphereIntersect.x > 0.0;
      bool insideAtmosphere = heightParameters[0] < radii[1];

      if (!(hitsAtmosphere || insideAtmosphere)) {
        return vec3(0);
      }

      bool hitsPlanet = (rayPlanetIntersect.x <= rayPlanetIntersect.y) && rayPlanetIntersect.x > 0.0;

      float start = insideAtmosphere ? 0.0 : rayAtmosphereIntersect.x;

      if (heightParameters[0] < reducedPlanetRadius) {
        // Long light rays from the night side of the planet lead to numerical instability
        // Do not render the atmosphere in such cases
        if (dot(rayDir, normalize(cameraPos)) < -0.025) {
          return vec3(0);
        }
        start = rayPlanetIntersect.y;
      }

      float end = hitsPlanet ? rayPlanetIntersect.x : rayAtmosphereIntersect.y;
      float maxEnd = end;

      ${i.haze?O`if (terrainDepth != -1.0) { end = terrainDepth; }`:""}

      vec3 samplePoint = cameraPos + rayDir * end;
      float multiplier = hitsPlanet ? -1.0 : 1.0;

      vec3 scattering = vec3(0);
      float scaleFract = (length(samplePoint) - radii[0]) / scaleHeight;
      float lastOpticalDepth = getOpticalDepth(samplePoint, rayDir, scaleFract);
      float stepSize = (end - start) / float(STEPS);
      for (int i = 0; i < STEPS; i++) {
        samplePoint -= stepSize * rayDir;
        scaleFract = (length(samplePoint) - radii[0]) / scaleHeight;
        float opticalDepth = multiplier * getOpticalDepth(samplePoint, rayDir * multiplier, scaleFract);

        if (i > 0) {
          scattering *= ${i.haze?O``:" mix(2.5, 1.0, clamp((length(cameraPos) - radii[0]) / 50e3, 0.0, 1.0)) * "} exp(-(mix(betaCombined, betaRayleigh, 0.5) + betaMie) * max(0.0, (opticalDepth - lastOpticalDepth)));
        }

        if (dot(normalize(samplePoint), lightDir) > -0.3) {

          float scale = exp(-scaleFract);
          float lightDepth = getOpticalDepth(samplePoint, lightDir, scaleFract);

          scattering += scale * exp(-(betaCombined + betaMie) * lightDepth);
          ${i.haze?"":O`scattering += scale * exp(-(0.25 * betaCombined ) * lightDepth);`}
        }

        lastOpticalDepth = opticalDepth;

      }

      float mu = dot(rayDir, lightDir);
      float mumu = 1.0 + mu * mu;

      float phaseRayleigh = 0.0596831 * mumu;

      ${i.haze?O`return 3.0 * scattering * stepSize * phaseRayleigh * betaRayleigh;`:O`
            const float g = 0.8;
            const float gg = g * g;
            float phaseMie = end == maxEnd ? 0.1193662 * ((1.0 - gg) * mumu) / (pow(1.0 + gg - 2.0 * mu * g, 1.5) * (2.0 + gg)) : 0.0;
            phaseMie += getGlow(1.0 - mu, 5e-5, 3.0) * smoothstep(0.01, 0.1, length(scattering));
            phaseMie = clamp(phaseMie, 0.0, 128.0);
            return 3.0 * scattering * stepSize * (phaseRayleigh * betaRayleigh + 0.025 * phaseMie * betaMie);`}
    }

    vec3 tonemapACES(vec3 x) {
      return clamp((x * (2.51 * x + 0.03)) / (x * (2.43 * x + 0.59) + 0.14), 0.0, 1.0);
    }

    vec4 applyUndergroundAtmosphere(vec3 rayDir, vec3 lightDirection, vec4 fragColor) {
      vec2 rayPlanetIntersect = sphereIntersect(cameraPosition, rayDir, radii[0], true);
      if (!((rayPlanetIntersect.x <= rayPlanetIntersect.y) && rayPlanetIntersect.y > 0.0)) {
        return fragColor;
      }

      float lightAngle = dot(lightDirection, normalize(cameraPosition + rayDir * max(0.0, rayPlanetIntersect.x)));
      vec4 surfaceColor = vec4(vec3(max(0.0, (smoothstep(-1.0, 0.8, 2.0 * lightAngle)))), 1.0 - altitudeFade);
      float relDist = (rayPlanetIntersect.y - max(0.0, rayPlanetIntersect.x)) / innerFadeDistance;
      if (relDist > 1.0) {
        return surfaceColor;
      }

      return mix(gl_FragColor, surfaceColor, smoothstep(0.0, 1.0, relDist * relDist));
    }

    void main() {
      vec3 rayDir = normalize(worldRay);
      float terrainDepth = -1.0;
      ${i.haze?O`
          vec4 depthSample = texture2D(depthTex, vuv0).rgba;
          if (depthSample != vec4(0)) {
            vec3 cameraSpaceRay = normalize(eyeDir);
            cameraSpaceRay /= cameraSpaceRay.z;
            cameraSpaceRay *= -linearDepthFromTexture(depthTex, vuv0, nearFar);
            terrainDepth = max(0.0, length(cameraSpaceRay));
          }`:O`
          float depthSample = texture2D(depthTex, vuv0).r;
          if (depthSample != 1.0) {
            gl_FragColor = vec4(0);
            return;
          }`}

      ${i.haze?O`
            vec3 col = vec3(0);
            float fadeOut = smoothstep(-10000.0, -15000.0, heightParameters[0] - radii[0]);
            if(depthSample != vec4(0)){
              col = (1.0 - fadeOut) * hazeStrength * getAtmosphereColour(cameraPosition, rayDir, mainLightDirection, terrainDepth);
            }
            float alpha = 1.0 - fadeOut;`:O`
            vec3 col = getAtmosphereColour(cameraPosition, rayDir, mainLightDirection, terrainDepth);;
            float alpha = smoothstep(0.0, mix(0.15, 0.01, heightParameters[3]), length(col));`}
      col = tonemapACES(col);
      gl_FragColor = delinearizeGamma(vec4(col, alpha));
      ${i.haze?"":O`
          if (depthSample == 1.0) {
            gl_FragColor = applyUndergroundAtmosphere(rayDir, mainLightDirection, gl_FragColor);
          }`}
    }
  `),e}const aye=ve(),oye=Object.freeze(Object.defineProperty({__proto__:null,betaRayleigh:Wb,build:sye},Symbol.toStringTag,{value:"Module"}));let lye=class extends Ir{constructor(){super(...arguments),this.heightParameters=_i(),this.radii=be(),this.innerFadeDistance=0,this.altitudeFade=0,this.hazeStrength=1}},xL=class gQ extends ti{initializeProgram(e){return new Jt(e.rctx,gQ.shader.get().build(this.configuration),ai)}initializePipeline(){return this.configuration.haze?Ke({blending:Gn(de.ONE,de.ZERO,de.ONE_MINUS_SRC_COLOR,de.ONE),colorWrite:ht}):Ke({blending:Gn(de.SRC_ALPHA,de.ONE,de.ONE_MINUS_SRC_ALPHA,de.ONE_MINUS_SRC_ALPHA),depthTest:{func:hs.LEQUAL},colorWrite:ht})}};xL.shader=new ii(oye,()=>G(()=>import("./ChapmanAtmosphere.glsl-4358f6e2.js"),["assets/ChapmanAtmosphere.glsl-4358f6e2.js","assets/mat4-44a0988f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/mat4f64-1e28eae0.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/vec3-e93e648f.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/FloatPassUniform-68d54f51.js","assets/vec4-790471c0.js","assets/vec4f64-e407da96.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/vec3f32-c9aa289f.js","assets/compilerUtils-18d58939.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));let _Q=class extends $a{constructor(){super(...arguments),this.haze=!1}};h([N()],_Q.prototype,"haze",void 0);let d6=class{constructor(e){this._view=e,this.type=In.Realistic,this._passParameters=new lye,this._rootTileElevationMin=NaN,this._lowerBoundEarthRadius=lo.radius,this._fadeHaze=0,this._updateRadius(lo.radius)}destroy(){this._atmosphereTechnique=Qi(this._atmosphereTechnique),this._atmosphereHazeTechnique=Qi(this._atmosphereHazeTechnique),this._vao=Me(this._vao),this._handles=Te(this._handles)}initializeRenderContext(e){const t=e.renderContext.rctx,r=this._handles=new Ft;this._updateRootTileElevationBounds(),r.add(z(()=>this._view.basemapTerrain.rootTileElevationBounds,()=>this._updateRootTileElevationBounds())),r.add(z(()=>this._view.basemapTerrain.visibleElevationBounds,()=>this._updateVisibleElevationBounds()));const n=new _Q;n.haze=!1,this._atmosphereTechnique=e.shaderTechniqueRepository.acquire(xL,n),n.haze=!0,this._atmosphereHazeTechnique=e.shaderTechniqueRepository.acquire(xL,n),this._vao=La(t,kx)}render(e){this._render(e,this._atmosphereTechnique,e.offscreenRenderingHelper.depthTexture)}renderHaze(e,t){this._fadeHaze=t,this._render(e,this._atmosphereHazeTechnique,e.offscreenRenderingHelper.linearDepthTexture)}_render(e,t,r){if(S(r))return;this._update(e.bindParameters.camera),this._passParameters.depthTex=r;const n=e.rctx.bindTechnique(t,this._passParameters,e.bindParameters);e.offscreenRenderingHelper.renderDepthDetached(()=>{this._renderCommon(n,e)})}_renderCommon(e,t){S(this._vao)||(t.rctx.bindVAO(this._vao),e.assertCompatibleVertexAttributeLocations(this._vao),t.rctx.drawArrays(Dt.TRIANGLE_STRIP,0,4))}_adjustRadiusForTesselation(e){return e*Math.cos(Math.PI/16/16)}_updateRootTileElevationBounds(){const e=this._view.basemapTerrain.rootTileElevationBounds.min;e!==this._rootTileElevationMin&&(this._rootTileElevationMin=e,this._lowerBoundEarthRadius=lo.radius,this._updateVisibleElevationBounds())}_updateVisibleElevationBounds(){const e=this._adjustRadiusForTesselation(lo.radius+this._view.basemapTerrain.visibleElevationBounds.min);e<this._lowerBoundEarthRadius&&this._updateRadius(e)}_updateRadius(e){this._lowerBoundEarthRadius=e,Je(this._passParameters.radii,e,e+rx),this._passParameters.innerFadeDistance=2*Math.sqrt((2*e-wL)*wL)}_update(e){if(S(e))return;const t=_e(e.eye),r=t*t,n=r-this._passParameters.radii[1]*this._passParameters.radii[1],s=Math.min(1,Math.max(0,(t-this._passParameters.radii[0])/rx));Qs(this._passParameters.heightParameters,t,r,n,s),this._passParameters.altitudeFade=fQ(t-this._lowerBoundEarthRadius),this._passParameters.hazeStrength=dt(dt(.6,1,U0(9500,10500,t-lo.radius)),1,this._fadeHaze)}static isSupported(e){return e.renderContext.rctx.capabilities.depthTexture}};function cye(){const i=new Yi;i.attributes.add(P.POSITION,"vec2"),i.varyings.add("worldRay","vec3");const{vertex:e,fragment:t}=i;return e.uniforms.add([new Ys("inverseProjectionMatrix",(r,n)=>n.camera.inverseProjectionMatrix),new Ys("inverseViewMatrix",(r,n)=>kn(hye,n.camera.viewMatrix))]),e.code.add(O`void main(void) {
vec3 posViewNear = (inverseProjectionMatrix * vec4(position, -1.0, 1.0)).xyz;
worldRay = (inverseViewMatrix * vec4(posViewNear, 0.0)).xyz;
gl_Position = vec4(position, 1.0, 1.0);
}`),t.include($G),t.include(e_),i.include(Dre,{pbrMode:zr.Disabled,lightingSphericalHarmonicsOrder:2}),i.include(gne),i.include(ED),i.include(Fre,{useLegacyTerrainShading:!1}),i.include(Ure,{instancedDoublePrecision:!1,useLegacyTerrainShading:!1}),t.uniforms.add([new Rs("cameraPosition",(r,n)=>n.camera.eye)]),t.code.add(O`void main() {
vec4 cloudsColor = renderClouds(normalize(worldRay), cameraPosition);
gl_FragColor = vec4((1.0 - totalFadeInOut) * cloudsColor.rgb, cloudsColor.a);
}`),i}const hye=ve(),uye=Object.freeze(Object.defineProperty({__proto__:null,build:cye},Symbol.toStringTag,{value:"Module"}));let yQ=class vQ extends ti{constructor(e){super(e,new $a,()=>this.destroy())}initializeProgram(e){return new Jt(e.rctx,vQ.shader.get().build(),ai)}initializePipeline(){return Ke({blending:lu(de.ONE,de.SRC_ALPHA),depthTest:{func:hs.LEQUAL},colorWrite:ht})}};yQ.shader=new ii(uye,()=>G(()=>import("./CloudsComposition.glsl-ca9dbfa7.js"),["assets/CloudsComposition.glsl-ca9dbfa7.js","assets/mat4-44a0988f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/mat4f64-1e28eae0.js","assets/vec3-e93e648f.js","assets/vec4-790471c0.js","assets/vec4f64-e407da96.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/vec3f32-c9aa289f.js","assets/compilerUtils-18d58939.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/mathUtils-b4bb77e2.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/mat3f64-c6305894.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/NormalUtils.glsl-c12729bf.js","assets/Ellipsoid-89682c5e.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/sphere-2af0d852.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));let Ff=class extends ue{constructor(e){super(e),this._technique=new yQ(e),this._vao=La(e.rctx)}destroy(){this._technique=Qi(this._technique),this._vao=Me(this._vao)}render(e){const t=e.bindParameters.cloudsFade;if(S(this._vao)||S(t.data))return;if(!this._technique.compiled)return void this.requestRender();const r=e.rctx.bindTechnique(this._technique,dye,e.bindParameters);e.rctx.bindVAO(this._vao),r.assertCompatibleVertexAttributeLocations(this._vao),e.rctx.drawArrays(Dt.TRIANGLE_STRIP,0,4)}};h([p({constructOnly:!0})],Ff.prototype,"rctx",void 0),h([p({constructOnly:!0})],Ff.prototype,"viewingMode",void 0),h([p({constructOnly:!0})],Ff.prototype,"planetRadius",void 0),h([p({constructOnly:!0})],Ff.prototype,"requestRender",void 0),Ff=h([D("esri.views.3d.environment.CloudsComposition")],Ff);const dye=new Ir;var Ea;(function(i){i[i.SIXTEEN=0]="SIXTEEN",i[i.HUNDRED=1]="HUNDRED",i[i.TWOHUNDRED=2]="TWOHUNDRED",i[i.COUNT=3]="COUNT"})(Ea||(Ea={}));let tE=class extends $a{constructor(){super(...arguments),this.steps=Ea.SIXTEEN,this.writeTextureChannels=PD.RG}};h([N({count:Ea.COUNT})],tE.prototype,"steps",void 0),h([N({constValue:St("esri-mobile")?1024:2048})],tE.prototype,"cubeMapSize",void 0),h([N()],tE.prototype,"writeTextureChannels",void 0);let ob=class{constructor(e,t,r,n,s,a,o,l,c=.5){this.coverage=e,this.density=t,this.absorption=r,this.cloudSize=n,this.detailSize=s,this.smoothness=a,this.cloudHeight=o,this.raymarchingSteps=l,this.median=c}};const p6=new ob([0,.6],[.03,.03],[0,0],[.9,.9],[.8,.8],[.7,.7],[.05,.05],Ea.SIXTEEN),ys={sunny:p6,cloudy:new ob([.3,.65],[.2,.4],[0,0],[.85,.85],[.75,.75],[.3,.4],[1,1],Ea.TWOHUNDRED,.6),rainy:new ob([.6,.8],[.5,.8],[.1,.5],[.9,.9],[.75,.75],[.5,.5],[1,1],Ea.TWOHUNDRED,.4),snowy:new ob([.25,.75],[.3,.3],[0,0],[.95,.95],[.7,.7],[.69,.75],[.3,1],Ea.HUNDRED,.65),foggy:new ob([.8,.8],[.5,.5],[0,0],[.95,.95],[.9,.9],[.55,.55],[.3,.3],Ea.SIXTEEN),default:p6},Sl=St("esri-mobile")?64:128,pye=Sl/128,dc=Math.ceil(Math.sqrt(Sl)),Tc=(Sl+2)*dc,mye=1e5,fO=128,fye=Tc/1560;let bQ=class extends Ir{constructor(){super(...arguments),this.cloudRadius=0,this.cloudSize=0,this.detailSize=0,this.absorption=0,this.density=0,this.smoothness=0,this.cloudHeight=0,this.coverage=0,this.raymarchingSteps=ys.default.raymarchingSteps,this.weatherTile=be()}},wQ=class extends Ir{constructor(){super(...arguments),this.viewMatrix=Or()}};function gye(i){const e=new Yi;e.include(Nd,!1);const t=e.fragment;return t.uniforms.add([new Tt("cloudRadius",r=>r.cloudRadius),new Tt("power",r=>dt(35,120,r.absorption)),new Tt("sigmaE",r=>1+r.absorption),new Tt("density",r=>dt(0,.3,r.density)),new Tt("cloudSize",r=>dt(0,.02,Math.max(.01,1-r.cloudSize))),new Tt("detailSize",r=>dt(0,.2,Math.max(.01,1-r.detailSize))),new Tt("smoothness",r=>dt(0,.5,1-r.smoothness)),new Tt("cloudHeight",r=>dt(0,1500,r.cloudHeight)),new Tt("coverage",r=>r.coverage),new RI("view",r=>r.viewMatrix),new Bt("cloudShapeTexture",r=>y(r.noiseTexture)?r.noiseTexture.textureAtlas:null),new Zs("cloudVariables",r=>Je(_ye,r.coverage,r.absorption))]),t.constants.add("halfCubeMapSize","float",.5*i.cubeMapSize),t.code.add(O`
    const int STEPS = ${i.steps===Ea.SIXTEEN?O`16`:i.steps===Ea.HUNDRED?O`100`:O`200`};
    const int STEPS_LIGHT = 6;
    const float stepL = 300.0 / float(STEPS_LIGHT);
    const float cloudStart = 1500.0;

    vec3 rayDirection(vec2 fragCoord) {
      vec2 xy = fragCoord - halfCubeMapSize;
      return normalize(vec3(-xy, -halfCubeMapSize));
    }

    float remap(float x, float low1, float high1, float low2, float high2) {
      return low2 + (x - low1) * (high2 - low2) / (high1 - low1);
    }

    float saturate(float x) {
      return clamp(x, 0.0, 1.0);
    }`),t.code.add(O`
    float getCloudShape(vec3 pos, float pOffset) {
      const float textureWidth = ${O.float(Tc)};
      const float dataWidth = ${O.float(Tc)};
      const float tileRows = ${O.float(dc)};
      const vec3 atlasDimensions = vec3(${O.float(Sl)}, ${O.float(Sl)}, tileRows * tileRows);

      //Change from Y being height to Z being height
      vec3 p = float(${O.float(pye)}) * pos.xzy;

      //Pixel coordinates of point in the 3D data
      vec3 coord = vec3(mod(p - pOffset * atlasDimensions, atlasDimensions));
      float f = fract(coord.z);
      float level = floor(coord.z);
      float tileY = floor(level / tileRows);
      float tileX = level - tileY * tileRows;

      //The data coordinates are offset by the x and y tile, the two boundary cells between each tile pair and the initial boundary cell on the first row/column
      vec2 offset = atlasDimensions.x * vec2(tileX, tileY) + 2.0 * vec2(tileX, tileY) + 1.0;
      vec2 pixel = coord.xy + offset;
      vec2 data = texture2D(cloudShapeTexture, mod(pixel, dataWidth) / textureWidth).xy;

      return 1.0 - mix(data.x, data.y, f);
    }

    float getCloudMap(vec2 p){
      // Non-power-of-two textures can't be tiled using WebGL1
      // Get fractional part of uv to tile
      // Shift the texture center to origin to avoid seam artifacts
      vec2 uv = fract((${O.float(fye)} * p) / ${O.float(Tc)} + 0.5);

      return texture2D(cloudShapeTexture, uv).a;
    }
    `),t.code.add(O`float clouds(vec3 p) {
float cloud = saturate(0.5 * mix(0.0, 1.0, min(2.0 * coverage, 1.0)));
if (cloud <= 0.0) {
return 0.0;
}
float cloudMap = getCloudMap(cloudSize * p.xy);
cloud = mix(cloud, min(2.0 * (coverage), 1.0) * cloudMap, min(2.0 * (1.0 - coverage), 1.0));
if (cloud <= 0.0) {
return 0.0;
}
float shape = getCloudShape(8.0 * cloudSize * p, 0.0);
cloud = saturate(remap(cloud, smoothness * shape, 1.0, 0.0, 1.0));
if (cloud <= 0.0) {
return 0.0;
}
float heightFraction = saturate((length(p) - cloudRadius - cloudStart) / cloudHeight);
cloud *= saturate(remap(heightFraction, 0.0, 0.25, 0.0, 1.0)) * smoothstep(1.0, 0.25, heightFraction);
if (cloud <= 0.0) {
return 0.0;
}
return density * saturate(remap(cloud, 0.35 * smoothness * getCloudShape(detailSize * p, 0.0), 1.0, 0.0, 1.0));
}`),t.code.add(O`vec2 sphereIntersections(vec3 start, vec3 dir, float radius) {
float a = dot(dir, dir);
float b = 2.0 * dot(dir, start);
float c = dot(start, start) - (radius * radius);
float d = (b * b) - 4.0 * a * c;
if (d < 0.0) {
return vec2(1e5, -1e5);
}
return vec2((-b - sqrt(d)) / (2.0 * a), (-b + sqrt(d)) / (2.0 * a));
}
float HenyeyGreenstein(float g, float costh) {
return (1.0 / (4.0 * 3.1415))  * ((1.0 - g * g) / pow(1.0 + g * g - 2.0 * g * costh, 1.5));
}`),t.code.add(`
    float multipleOctaves(float extinction, float mu, float stepL) {
      float attenuation = 1.0;
      float contribution = 1.0;
      float phaseAttenuation = 1.0;
      float luminance = 0.0;

      for (int i = 0; i < 4; i++) {
        float phase = mix(HenyeyGreenstein(0.0, mu), HenyeyGreenstein(0.3 * phaseAttenuation, mu), 0.7);
        luminance += contribution * phase * exp(-stepL * extinction * sigmaE * attenuation);
        attenuation *= 0.2;
        contribution *= 0.6;
        phaseAttenuation *= 0.5;
      }

      return luminance;
    }`),t.code.add(O`float lightRay(vec3 org, vec3 p, float phaseFunction, float mu, vec3 sunDirection) {
float lightRayDensity = clouds(p);
lightRayDensity += clouds(p + sunDirection * 1.0 * stepL);
lightRayDensity += clouds(p + sunDirection * 2.0 * stepL);
lightRayDensity += clouds(p + sunDirection * 3.0 * stepL);
lightRayDensity += clouds(p + sunDirection * 4.0 * stepL);
lightRayDensity += clouds(p + sunDirection * 5.0 * stepL);
float beersLaw = multipleOctaves(lightRayDensity, mu, stepL);
return mix(beersLaw * 2.0 * (1.0 - (exp(-stepL * lightRayDensity * 2.0 * sigmaE ))), beersLaw, 0.5 + 0.5 * mu);
}`),t.code.add(O`float mainRay(vec3 org, vec3 dir, vec3 sunDirection, float distToStart, float totalDistance, out float totalTransmittance) {
if (dir.z < 0.0) {
return 0.0;
}
totalTransmittance = 1.0;
float stepS = totalDistance / float(STEPS);
float cameraHeight = length(org);
float mu = 0.5 + 0.5 * dot(sunDirection, dir);
float phaseFunction = mix(HenyeyGreenstein(-0.3, mu), HenyeyGreenstein(0.3, mu), 0.7);
vec3 p = org + distToStart  * dir;
float dist = distToStart;
float shading = 0.0;
for (int i = 0; i < STEPS; i++) {
float sampleDensity = clouds(p);
float sampleSigmaE = sampleDensity * sigmaE;
if (sampleDensity > 0.0 ) {
float ambient = mix((1.2), (1.6), saturate((length(p) - cloudRadius - cloudStart) / cloudHeight));
float luminance = sampleDensity * (ambient + power * phaseFunction * lightRay(org, p, phaseFunction, mu, sunDirection));
float transmittance = exp(-sampleSigmaE * stepS);
shading += totalTransmittance * (luminance - luminance * transmittance) / sampleSigmaE;
totalTransmittance *= transmittance;
if (totalTransmittance <= 0.001) {
totalTransmittance = 0.0;
break;
}
}
dist += stepS;
p = org + dir * dist;
}
return shading;
}`),t.code.add(O`void main() {
if (coverage ==  0.0) {
gl_FragColor = vec4(0.0, 1.0, 0.0, 1.0);
return;
}
vec3 rayDir = rayDirection(gl_FragCoord.xy);
rayDir = normalize(view * rayDir);
vec3 viewPos = vec3(0, 0, cloudRadius + 1.0);
bool hitsPlanet = rayDir.z < 0.0;
float hazeFactor = smoothstep(-0.01, mix(0.0, 0.075, cloudVariables.x), abs(dot(rayDir, vec3(0, 0, 1))));
float totalTransmittance = 1.0;
float shading = 0.0;
if (hitsPlanet) {
shading = clamp(1.0 - cloudVariables.y, 0.6, 1.0) * (1.0 - hazeFactor);
totalTransmittance = hazeFactor;
gl_FragColor = vec4(shading, totalTransmittance, shading, totalTransmittance);
return;
}
vec2 rayStartIntersect = sphereIntersections(viewPos, rayDir, cloudRadius + cloudStart);
vec2 rayEndIntersect = sphereIntersections(viewPos, rayDir, cloudRadius + cloudStart + cloudHeight);
float distToStart = rayStartIntersect.y;
float totalDistance = rayEndIntersect.y - distToStart;
vec3 sunDirection = normalize(vec3(0, 0, 1));
shading = 0.5 * mainRay(viewPos, rayDir, sunDirection, distToStart, totalDistance, totalTransmittance);
shading = mix(clamp(1.0 - cloudVariables.y, 0.6, 1.0), shading, hazeFactor);
totalTransmittance = mix(0.0, totalTransmittance, hazeFactor);
gl_FragColor = vec4(shading, totalTransmittance, shading, totalTransmittance);
}`),e}const _ye=be(),yye=Object.freeze(Object.defineProperty({__proto__:null,CloudsPassParameters:bQ,CloudsDrawParameters:wQ,build:gye},Symbol.toStringTag,{value:"Module"}));let xQ=class TQ extends ti{constructor(e,t){super(e,t,()=>this.destroy())}initializeProgram(e){return new Jt(e.rctx,TQ.shader.get().build(this.configuration),ai)}initializePipeline(){return Ke({blending:lu(de.CONSTANT_COLOR,de.ONE_MINUS_CONSTANT_COLOR,Cw.ADD,this.configuration.writeTextureChannels===PD.RG?[1,1,0,0]:[0,0,1,1]),depthTest:{func:hs.LEQUAL},colorWrite:ht})}};xQ.shader=new ii(yye,()=>G(()=>import("./Clouds.glsl-fc789f55.js"),["assets/Clouds.glsl-fc789f55.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/mat3f64-c6305894.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DPassUniform-753de459.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));var Xo;(function(i){i[i.Full=0]="Full",i[i.WeatherMap=1]="WeatherMap",i[i.COUNT=2]="COUNT"})(Xo||(Xo={}));let TL=class extends $a{constructor(){super(...arguments),this.mode=Xo.Full}};h([N({count:Xo.COUNT})],TL.prototype,"mode",void 0);let CQ=class extends Ir{constructor(){super(...arguments),this.weatherTile=Xt(0,0)}};function vye(i){const e=new Yi;return e.include(Nd,!1),e.fragment.code.add(O`float remap(float x, float low1, float high1, float low2, float high2) {
return low2 + (x - low1) * (high2 - low2) / (high1 - low1);
}`),i.mode===Xo.Full&&e.fragment.code.add(O`
    float saturate(float x) {
      return clamp(x, 0.0, 1.0);
    }

    // Safer modulo for positive and negative values
    vec3 modulo(vec3 m, float n){
      return mod(mod(m, n) + n, n);
    }

    vec3 hash(vec3 p3, float frequency){
      p3 = modulo(p3, frequency);
      p3 = fract(p3 * vec3(0.1031, 0.1030, 0.0973));
      p3 += dot(p3, p3.yxz + 33.33);
      return -1.0 + 2.0 * fract((p3.xxy + p3.yxx) * p3.zyx);
    }

    // 5th order polynomial interpolation
    vec3 fade(vec3 t){
      return (t * t * t) * (t * (t * 6.0 - 15.0) + 10.0);
    }

    float gradientNoise(vec3 p, float frequency){
      // Cell point is in
      vec3 i = floor(p);

      // Position in the cell in [0, 1]
      vec3 f = fract(p);

      // Interpolation value for gradient mixing
      vec3 u = fade(f);

      // Trilinear interpolation of gradients at cube vertices around point
      return mix( mix( mix( dot( hash( i + vec3(0.0,0.0,0.0), frequency), f - vec3(0.0,0.0,0.0) ),
                            dot( hash( i + vec3(1.0,0.0,0.0), frequency), f - vec3(1.0,0.0,0.0) ), u.x),
                       mix( dot( hash( i + vec3(0.0,1.0,0.0), frequency), f - vec3(0.0,1.0,0.0) ),
                            dot( hash( i + vec3(1.0,1.0,0.0), frequency), f - vec3(1.0,1.0,0.0) ), u.x), u.y),
                  mix( mix( dot( hash( i + vec3(0.0,0.0,1.0), frequency), f - vec3(0.0,0.0,1.0) ),
                            dot( hash( i + vec3(1.0,0.0,1.0), frequency), f - vec3(1.0,0.0,1.0) ), u.x),
                       mix( dot( hash( i + vec3(0.0,1.0,1.0), frequency), f - vec3(0.0,1.0,1.0) ),
                            dot( hash( i + vec3(1.0,1.0,1.0), frequency), f - vec3(1.0,1.0,1.0) ), u.x), u.y), u.z );
    }

    float getPerlinNoise(vec3 pos, float frequency) {
      float octaveFrequencyFactor = 2.0;
      float sum = 0.0;
      float weightSum = 0.0;
      float weight = 1.0;

      for (int oct = 0; oct < 3; oct++) {
        vec3 p = pos * frequency;
        float val = 0.5 + 0.5 * gradientNoise(p, frequency);
        sum += val * weight;
        weightSum += weight;
        weight *= 0.5;
        frequency *= octaveFrequencyFactor;
      }

      float noise = (sum / weightSum);
      noise = saturate(noise);
      return noise;
    }

    float worley(vec3 pos, float numCells) {
      vec3 p = pos * numCells;
      float d = 1.0e10;

      for (int x = -1; x <= 1; x++) {
        for (int y = -1; y <= 1; y++) {
          for (int z = -1; z <= 1; z++) {
            vec3 tp = floor(p) + vec3(x, y, z);
            tp = p - tp - (hash(tp, numCells) * 0.5 + 0.5);
            d = min(d, dot(tp, tp));
          }
        }
      }

      return 1.0 - clamp(d, 0.0, 1.0);
    }

    vec3 get3Dfrom2D(vec2 uv) {
      vec2 tile = floor(uv);
      float z = floor(${O.float(dc)} * tile.y + tile.x);
      return vec3(fract(uv), z);
    }

    float getTextureForPointPerlinWorley(vec3 p) {
      float perlinNoise = getPerlinNoise(p, ${O.float(8)});

      float worley0 = worley(p, ${O.float(2)} * 2.0);
      float worley1 = worley(p, ${O.float(2)} * 8.0);
      float worley2 = worley(p, ${O.float(2)} * 14.0);

      float worleyFBM = worley0 * 0.625 + worley1 * 0.25 + worley2 * 0.125;
      return remap(perlinNoise, 0.0, 1.0, worleyFBM, 1.0);
    }

    float getTextureForPointWorley(vec3 p) {
      float worley0 = worley(p, ${O.float(2)});
      float worley1 = worley(p, ${O.float(2)} * 2.0);
      float worley2 = worley(p, ${O.float(2)} * 4.0);
      float worley3 = worley(p, ${O.float(2)} * 8.0);

      float FBM0 = worley0 * 0.625 + worley1 * 0.25 + worley2 * 0.125;
      float FBM1 = worley1 * 0.625 + worley2 * 0.25 + worley3 * 0.125;
      float FBM2 = worley2 * 0.75 + worley3 * 0.25;

      return FBM0 * 0.625 + FBM1 * 0.25 + FBM2 * 0.125;
    }
  `),e.fragment.uniforms.add(new Zs("weatherTile",t=>t.weatherTile)),e.fragment.code.add(O`
    vec2 modulo(vec2 m, float n){
      return mod(mod(m, n) + n, n);
    }

    vec2 hash(vec2 p){
      // Get position of p in weather tile
      p = modulo(p, ${O.float(fO)});

      // Get global coordinates of p
      p += weatherTile * ${O.float(fO)};

      // Limit position to avoid numerical instability
      p = modulo(p, ${O.float(mye)});

      vec3 p3 = fract(vec3(p.xyx) * vec3(0.1031, 0.1030, 0.0973));
      p3 += dot(p3, p3.yzx + 33.33);
      return 2.0 * fract((p3.xx + p3.yz) * p3.zy) - 1.0;
    }

    vec2 fade(vec2 t){
      return (t * t * t) * (t * (t * 6.0 - 15.0) + 10.0);
    }

    float gradientNoise(vec2 p){
      vec2 i = floor( p );
      vec2 f = fract( p );

      vec2 u = fade(f);

      // Bilinear interpolation of gradients at cell vertices around point
      return  mix(
                mix(dot( hash( i + vec2(0.0,0.0) ), f - vec2(0.0,0.0) ),
                    dot( hash( i + vec2(1.0,0.0) ), f - vec2(1.0,0.0) ), u.x),
                mix(dot( hash( i + vec2(0.0,1.0) ), f - vec2(0.0,1.0) ),
                    dot( hash( i + vec2(1.0,1.0) ), f - vec2(1.0,1.0) ), u.x),
                u.y);
    }

    float worley(vec2 p){
      float d = 1.0e10;
      for (int x = -1; x <= 1; x++){
        for (int y = -1; y <= 1; y++){
                vec2 tp = floor(p) + vec2(x, y);
                tp = p - tp - (0.5 + 0.5 * hash(tp));
                d = min(d, dot(tp, tp));
            }
        }
      return 1.0 - clamp(d, 0.0, 1.0);
    }
  `),e.fragment.code.add(O`void main() {`),i.mode===Xo.Full&&e.fragment.code.add(O`
        float padWidth = 1.0;
        float paddedSize = ${O.float(Sl)} + 2.0 * padWidth;
        float tileCount = ${O.float(dc)} * ${O.float(dc)};
        vec2 tile = floor((gl_FragCoord.xy - 0.5) / paddedSize);

        bool padCell = false;
        if (mod(gl_FragCoord.x, paddedSize) == 0.5 || mod(gl_FragCoord.x, paddedSize) == paddedSize - 0.5) {
          padCell = true;
        }

        if (mod(gl_FragCoord.y, paddedSize) == 0.5 || mod(gl_FragCoord.y, paddedSize) == paddedSize - 0.5) {
          padCell = true;
        }

        bool startPadX = false;
        bool startPadY = false;
        bool endPadX = false;
        bool endPadY = false;

        if (gl_FragCoord.x == tile.x * paddedSize + 0.5) {
          startPadX = true;
        }

        if (gl_FragCoord.y == tile.y * paddedSize + 0.5) {
          startPadY = true;
        }

        if (gl_FragCoord.x == (tile.x + 1.0) * paddedSize - 0.5) {
          endPadX = true;
        }

        if (gl_FragCoord.y == (tile.y + 1.0) * paddedSize - 0.5) {
          endPadY = true;
        }

        vec2 padding = vec2(2.0 * padWidth) * tile;
        vec2 uv;

        if (padCell) {
          vec2 pixel = gl_FragCoord.xy - padWidth - padding;

          if (startPadX) {
            pixel.x += ${O.float(Sl)};
          }

          if (startPadY) {
            pixel.y += ${O.float(Sl)};
          }

          if (endPadX) {
            pixel.x -= ${O.float(Sl)};
          }

          if (endPadY) {
            pixel.y -= ${O.float(Sl)};
          }

          uv = vec2(pixel.xy / ${O.float(Sl)});
        } else {
          vec2 pixel = gl_FragCoord.xy - padWidth - padding;
          uv = vec2(pixel.xy / ${O.float(Sl)});
        }

        vec3 p_ = get3Dfrom2D(uv);
        vec3 p = p_;
        p.z /= (${O.float(dc)} * ${O.float(dc)});

        float worleyPerlinNoise = getTextureForPointPerlinWorley(p);
        float worleyNoise = getTextureForPointWorley(p);

        gl_FragColor.r = saturate(remap(worleyPerlinNoise, worleyNoise, 1.0, 0.0, 1.0));

        p_ = mod(p_ + 1.0, ${O.float(dc)} * ${O.float(dc)});
        p = p_;
        p.z /= (${O.float(dc)} * ${O.float(dc)});

        worleyPerlinNoise = getTextureForPointPerlinWorley(p);
        worleyNoise = getTextureForPointWorley(p);

        gl_FragColor.g = saturate(remap(worleyPerlinNoise, worleyNoise, 1.0, 0.0, 1.0));
      `),e.fragment.code.add(O`
      vec2 mapUV = ${O.float(fO)} * (gl_FragCoord.xy / ${O.float(Tc)});
      float map = abs(gradientNoise(mapUV));
      map = remap(map, 0.25 * (1.0 - worley(8.0 * mapUV)), 1.0, 0.0, 1.0);

      ${i.mode===Xo.Full?O`gl_FragColor.ba = vec2(0.0, map);`:O`gl_FragColor = vec4(map);`};
    }
  `),e}const bye=Object.freeze(Object.defineProperty({__proto__:null,NoiseTextureAtlasPassParameters:CQ,build:vye},Symbol.toStringTag,{value:"Module"}));let CL=class SQ extends ti{initializeProgram(e){return new Jt(e.rctx,SQ.shader.get().build(this.configuration),ai)}initializePipeline(){return Ke({blending:this.configuration.mode===Xo.Full?lu(de.ONE,de.ZERO):Gn(de.ZERO,de.ONE,de.ONE,de.ZERO),depthTest:{func:hs.ALWAYS},colorWrite:ht})}};CL.shader=new ii(bye,()=>G(()=>import("./NoiseTextureAtlas.glsl-36e0bc8e.js"),["assets/NoiseTextureAtlas.glsl-36e0bc8e.js","assets/vec2f64-30dc1443.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/VertexAttribute-9c5c630d.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/vec2-528adfe4.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));let lb=class extends ue{constructor(e){super(e),this._needsRender=!0,this._passParameters=new CQ,this._frameBuffer=new yn(e.context.renderContext.rctx,{colorTarget:Vn.TEXTURE,width:Tc,height:Tc},{target:vi.TEXTURE_2D,pixelFormat:yt.RGBA,dataType:qt.UNSIGNED_BYTE,wrapMode:si.CLAMP_TO_EDGE,samplingMode:Kt.LINEAR,hasMipmap:!1,width:Tc,height:Tc}),this._vao=La(e.context.renderContext.rctx)}get _techniqueRepository(){return this.context.shaderTechniqueRepository}get textureAtlas(){return y(this._texture)?y(this._weatherMapTechnique)&&this._weatherMapTechnique.compiled&&this._needsRender&&(this._texture=this._render(Xo.WeatherMap)):y(this._fullTechnique)&&this._fullTechnique.compiled&&(this._texture=this._render(Xo.Full)),this._texture}_setDirty(){this._needsRender=!0}updateWeatherMap(e){this._passParameters.weatherTile[0]===e[0]&&this._passParameters.weatherTile[1]===e[1]||(wn(this._passParameters.weatherTile,e),this._setDirty())}destroy(){this._fullTechniqueCached=Qi(this._fullTechniqueCached),this._weatherMapTechniqueCached=Qi(this._weatherMapTechniqueCached),this._frameBuffer=Me(this._frameBuffer),this._vao=Me(this._vao)}get _fullTechnique(){if(S(this._fullTechniqueCached)){const e=new TL;e.mode=Xo.Full,this._fullTechniqueCached=this._techniqueRepository.acquire(CL,e)}return this._fullTechniqueCached}get _weatherMapTechnique(){if(S(this._weatherMapTechniqueCached)){const e=new TL;e.mode=Xo.WeatherMap,this._weatherMapTechniqueCached=this._techniqueRepository.acquire(CL,e)}return this._weatherMapTechniqueCached}_render(e){if(S(this._vao)||S(this._frameBuffer))return null;const t=e===Xo.Full?this._fullTechnique:this._weatherMapTechnique,r=this.context.renderContext.rctx,n=r.getViewport();r.setViewport(0,0,Tc,Tc),r.bindFramebuffer(this._frameBuffer);const s=r.bindTechnique(t,this._passParameters,null);return r.bindVAO(this._vao),s.assertCompatibleVertexAttributeLocations(this._vao),r.gl.drawArrays(r.gl.TRIANGLE_STRIP,0,4),r.setViewport(n.x,n.y,n.width,n.height),this._needsRender=!1,this._frameBuffer.colorTexture}};h([p({constructOnly:!0})],lb.prototype,"context",void 0),h([p({readOnly:!0})],lb.prototype,"_techniqueRepository",null),lb=h([D("esri.views.3d.environment.NoiseTextureAtlas")],lb);let yR=class{constructor(e,t,r){this.shadowMap=e,this.ssaoHelper=t,this.slicePlane=r,this.slot=ae.OPAQUE_MATERIAL,this.hasOccludees=!1,this.enableFillLights=!0,this._inverseViewport=be(),this.oldLighting=new iA,this.newLighting=new iA,this._fadedLighting=new iA,this._lighting=this.newLighting,this.ssr=new zre,this.multipassTerrain=new Cne,this.multipassGeometry=new xne,this.overlays=[],this.cloudsFade=new Bre}get camera(){return this._camera}set camera(e){this._camera=this.ssr.camera=e,this._inverseViewport[0]=1/e.fullViewport[2],this._inverseViewport[1]=1/e.fullViewport[3]}get inverseViewport(){return this._inverseViewport}get lighting(){return this._lighting}get weatherFading(){return this._lighting===this._fadedLighting}fadeLighting(e){const{oldLighting:t,newLighting:r}=this;e>=1?this._lighting=r:(this._fadedLighting.lerpLighting(t,r,e),this._lighting=this._fadedLighting)}},pa=class extends ue{constructor(e){super(e),this.runOncePerFrame=!0,this._handles=new Ft,this._techniques=new Array,this._techniqueConfiguration=new tE,this._bindParameters=new yR(null,null,null),this._passParameters=new bQ,this._drawParameters=new wQ,this._weatherTile=be(),this._weatherTileCount=128,this._faceIndex=0,this._tileIndex=0,this.coverage=dt(ys.default.coverage[0],ys.default.coverage[1],.5),this.density=dt(ys.default.density[0],ys.default.density[1],.5),this.absorption=dt(ys.default.absorption[0],ys.default.absorption[1],.5),this.cloudSize=dt(ys.default.cloudSize[0],ys.default.cloudSize[1],.5),this.detailSize=dt(ys.default.detailSize[0],ys.default.detailSize[1],.5),this.smoothness=dt(ys.default.smoothness[0],ys.default.smoothness[1],.5),this.cloudHeight=dt(ys.default.cloudHeight[0],ys.default.cloudHeight[1],.5),this.raymarchingSteps=ys.default.raymarchingSteps,this._viewMatrix=ve(),this._dirty=!1,this.running=!1}_getTechnique(e){const t=1-this.context.renderContext.bindParameters.cloudsFade.readChannels,r=t===PD.RG?2*e:2*e+1;return this._techniques[r]||(this._techniqueConfiguration.writeTextureChannels=t,this._techniqueConfiguration.steps=e,this._techniques[r]=new xQ({rctx:this.context.renderContext.rctx,viewingMode:this.view.state.viewingMode},this._techniqueConfiguration),this._techniques[r])}updateWeatherTile(){const e=this.view.camera.position.latitude,t=this.view.camera.position.longitude;Je(this._weatherTile,(e+90)/180,(t+180)/360);const r=Math.floor(this._weatherTileCount*Math.abs(2*this._weatherTile[0]-1));this._weatherTile[0]=Math.floor(2*this._weatherTileCount*this._weatherTile[0]),this._weatherTile[1]=Math.floor(4*(this._weatherTileCount-r)*this._weatherTile[1]);let n=0,s=0;if(y(this.view.environment)&&this.view.environment.lighting.type!=="virtual"&&y(this.view.environment.lighting.date)){const a=new Date(this.view.environment.lighting.date);a.setUTCHours(this.view.environment.lighting.date.getUTCHours()+this.view.environment.lighting.displayUTCOffset),n=31*a.getUTCMonth()+a.getUTCDate(),s=a.getUTCFullYear()}this._weatherTile[0]=(this._weatherTile[0]+n)%(2*this._weatherTileCount),this._weatherTile[1]=(this._weatherTile[1]+s%100)%(4*this._weatherTileCount),Mie(this._passParameters.weatherTile,this._weatherTile)||this.setDirty()}initialize(){this._vao=La(this.context.renderContext.rctx);const e=Yt(this.view.spatialReference);this._passParameters.cloudRadius=.5*e.radius,this.setDirty(),this.updateWeatherTile(),this._handles.add([this.view.resourceController.scheduler.registerTask(dr.CLOUDS_GENERATOR,this),z(()=>[this.coverage,this.density,this.absorption,this.cloudSize,this.detailSize,this.smoothness,this.cloudHeight,this.raymarchingSteps],()=>this.setDirty(),Qe)])}destroy(){this._handles.destroy(),this._techniques.forEach(e=>Qi(e)),this._frameBufferCube=Me(this._frameBufferCube),this._techniques.length=0,this._vao=Me(this._vao),this._passParameters.noiseTexture=Te(this._passParameters.noiseTexture)}get _tilesPerFace(){switch(this._techniqueConfiguration.steps){case Ea.SIXTEEN:return 1;case Ea.HUNDRED:return 4;case Ea.COUNT:case Ea.TWOHUNDRED:return 8}}_ensureNoiseTexture(){if(y(this._passParameters.noiseTexture))this._passParameters.noiseTexture.updateWeatherMap(this._passParameters.weatherTile);else{const e=this.context;this._passParameters.noiseTexture=new lb({context:e}),this._passParameters.noiseTexture.updateWeatherMap(this._passParameters.weatherTile)}return y(this._passParameters.noiseTexture.textureAtlas)}_ensureFrameBufferCube(e){if(S(this._frameBufferCube)){const t={target:vi.TEXTURE_CUBE_MAP,pixelFormat:yt.RGBA,dataType:qt.UNSIGNED_BYTE,wrapMode:si.CLAMP_TO_EDGE,samplingMode:Kt.LINEAR,hasMipmap:!1,width:e,height:e};this._frameBufferCube=new yn(this.context.renderContext.rctx,{colorTarget:Vn.CUBEMAP,width:e,height:e},t)}return this._frameBufferCube}get cubeMap(){return this._frameBufferCube}destroyFrameBufferCube(){this._frameBufferCube=Me(this._frameBufferCube)}applyPreset(e,t){const r=e.median,n=s=>{const a=dt(s[0],s[1],r);return t<.5?dt(s[0],a,2*t):dt(a,s[1],2*(t-.5))};this.coverage=n(e.coverage),this.density=n(e.density),this.absorption=n(e.absorption),this.cloudSize=n(e.cloudSize),this.detailSize=n(e.detailSize),this.smoothness=n(e.smoothness),this.cloudHeight=n(e.cloudHeight),this.raymarchingSteps=e.raymarchingSteps}setDirty(){this._dirty=this.running=!0}runTask(e){if(S(this._vao))return this._dirty=this.running=!1,void(this.context.renderContext.bindParameters.cloudsFade.renderingStage=Kr.FINISHED_RENDERING);this._faceIndex===0&&this._tileIndex===0&&(this._passParameters.raymarchingSteps=this.raymarchingSteps,this.updateWeatherTile(),wn(this._passParameters.weatherTile,this._weatherTile));const t=this._getTechnique(this._passParameters.raymarchingSteps);if(!t.compiled||!this.context.renderContext.bindParameters.cloudsFade.isCameraPositionFinal||this.context.renderContext.bindParameters.cloudsFade.isFading||!this._ensureNoiseTexture())return;this._faceIndex===0&&this._tileIndex===0&&(this.context.renderContext.bindParameters.cloudsFade.renderingStage=Kr.RENDERING,this._passParameters.absorption=this.absorption,this._passParameters.density=this.density,this._passParameters.cloudSize=this.cloudSize,this._passParameters.detailSize=this.detailSize,this._passParameters.smoothness=this.smoothness,this._passParameters.cloudHeight=this.cloudHeight,this._passParameters.coverage=this.coverage,this._dirty=!1);const r=this.context.renderContext.rctx,n=r.bindTechnique(t,this._passParameters,this._bindParameters);r.bindVAO(this._vao),n.assertCompatibleVertexAttributeLocations(this._vao);const s=r.getViewport(),a=t.configuration.cubeMapSize,o=a/this._tilesPerFace,l=this._tileIndex*o;r.setViewport(0,l,a,o);const c=this._ensureFrameBufferCube(a);r.bindFramebuffer(c);const u=wye[this._faceIndex],d=xye[this._faceIndex];dre(this._viewMatrix,Tye,u,d),Td(this._drawParameters.viewMatrix,this._viewMatrix);const m=vi.TEXTURE_CUBE_MAP_POSITIVE_X+this._faceIndex;c.setColorTextureTarget(m),n.bindDraw(this._drawParameters,this._bindParameters,this._passParameters),r.gl.drawArrays(r.gl.TRIANGLE_STRIP,0,4),r.gl.flush(),r.setViewport(s.x,s.y,s.width,s.height),this.requestRender(),e.madeProgress(),++this._tileIndex,this._faceIndex===4&&this._tileIndex===this._tilesPerFace?(this.running=this._dirty,this._faceIndex=0,this._tileIndex=0,this.context.renderContext.bindParameters.cloudsFade.renderingStage=Kr.FINISHED_RENDERING):this._tileIndex===this._tilesPerFace&&(++this._faceIndex,this._tileIndex=0)}};h([p({constructOnly:!0})],pa.prototype,"context",void 0),h([p({constructOnly:!0})],pa.prototype,"view",void 0),h([p({constructOnly:!0})],pa.prototype,"requestRender",void 0),h([p()],pa.prototype,"coverage",void 0),h([p()],pa.prototype,"density",void 0),h([p()],pa.prototype,"absorption",void 0),h([p()],pa.prototype,"cloudSize",void 0),h([p()],pa.prototype,"detailSize",void 0),h([p()],pa.prototype,"smoothness",void 0),h([p()],pa.prototype,"cloudHeight",void 0),h([p()],pa.prototype,"raymarchingSteps",void 0),h([p()],pa.prototype,"running",void 0),pa=h([D("esri.views.3d.environment.CloudsGenerator")],pa);const wye=[gi(1,0,0),gi(-1,0,0),gi(0,1,0),gi(0,-1,0),gi(0,0,1)],xye=[gi(0,1,0),gi(0,1,0),gi(0,0,-1),gi(0,0,1),gi(0,1,0)],Tye=_ne();let MN=class extends Ir{constructor(){super(...arguments),this.fogColor=R(),this.hazeColor=R(),this.fogStrength=4e-6,this.hazeStrength=4e-6,this.atmosphereC=1}};function Cye(i){const e=new Yi;e.attributes.add(P.POSITION,"vec2"),e.include(AP,{textureCoordinateType:Mm.Default}),e.varyings.add("worldRay","vec3"),e.varyings.add("eyeDir","vec3");const{vertex:t,fragment:r}=e;return t.uniforms.add([new Ys("inverseProjectionMatrix",(n,s)=>s.camera.inverseProjectionMatrix),new Ys("inverseViewMatrix",(n,s)=>kn(Sye,s.camera.viewMatrix))]),t.code.add(O`void main(void) {
vec3 posViewNear = (inverseProjectionMatrix * vec4(position, -1, 1)).xyz;
eyeDir = posViewNear;
worldRay = (inverseViewMatrix * vec4(posViewNear, 0)).xyz;
forwardTextureCoordinates();
gl_Position = vec4(position, 1, 1);
}`),r.uniforms.add(new Tt("atmosphereC",n=>n.atmosphereC)),r.uniforms.add(new Rs("cameraPosition",(n,s)=>s.camera.eye)),r.uniforms.add(new Zs("nearFar",(n,s)=>s.camera.nearFar)),r.uniforms.add(new Bt("depthTex",n=>n.depthTexture)),r.uniforms.add(new Tt("fogStrength",n=>i.haze?n.hazeStrength:n.fogStrength)),r.uniforms.add(new Tt("fogAmount",n=>i.haze?n.hazeAmount:n.fogAmount)),r.uniforms.add(new Rs("fogColor",n=>i.haze?n.hazeColor:n.fogColor)),e.include(ED),r.include(Og),r.code.add(O`vec2 sphereIntersect(vec3 start, vec3 dir) {
float a = dot(dir, dir);
float b = 2.0 * dot(dir, start);
float d = (b * b) - 4.0 * a * atmosphereC;
if (d < 0.0) {
return vec2(1e5, -1e5);
}
return vec2((-b - sqrt(d)) / (2.0 * a), (-b + sqrt(d)) / (2.0 * a));
}`),r.code.add(O`vec4 applyFog(float dist, vec3 rayDir){
if(dist == -1.0){
vec2 rayAtmosphereIntersect = sphereIntersect(cameraPosition, rayDir);
dist = 0.055 * rayAtmosphereIntersect.y;
}
float fogAmount = fogAmount * (1.0 - exp(-dist * fogStrength));
return vec4(fogAmount * fogColor, fogAmount);
}`),r.code.add(O`
    vec3 tonemapACES(vec3 x) {
      return clamp((x * (2.51 * x + 0.03)) / (x * (2.43 * x + 0.59) + 0.14), 0.0, 1.0);
    }

    void main() {
      vec3 rayDir = normalize(worldRay);
      float terrainDepth = -1.0;

      float depthSample = texture2D(depthTex, vuv0).r;
      float zNorm = 2.0 * depthSample - 1.0;
      float linDepth = 2.0 * nearFar[0] * nearFar[1] / (nearFar[1] + nearFar[0] - zNorm * (nearFar[1] - nearFar[0]));
      if(depthSample < 1.0 && depthSample > 0.0){
        vec3 cameraSpaceRay = normalize(eyeDir);
        cameraSpaceRay /= cameraSpaceRay.z;
        cameraSpaceRay *= linDepth;
        terrainDepth = max(0.0, length(cameraSpaceRay));
      }

      ${i.haze?O`
          if(terrainDepth == -1.0){
            gl_FragColor = vec4(0);
            return;
          }`:""}

      vec4 fog = applyFog(terrainDepth, rayDir);

      gl_FragColor = delinearizeGamma(vec4(tonemapACES(fog.rgb), fog.a));
    }
  `),e}const Sye=ve(),EQ=Object.freeze(Object.defineProperty({__proto__:null,FogHazePassParameters:MN,build:Cye},Symbol.toStringTag,{value:"Module"}));let PQ=class RQ extends ti{initializeProgram(e){return new Jt(e.rctx,RQ.shader.get().build(this.configuration),ai)}initializePipeline(){return this.configuration.haze?Ke({blending:Gn(de.ONE,de.ZERO,de.ONE_MINUS_SRC_COLOR,de.ONE),colorWrite:ht}):Ke({blending:Gn(de.SRC_ALPHA,de.ZERO,de.ONE_MINUS_SRC_ALPHA,de.ONE),colorWrite:ht})}};PQ.shader=new ii(EQ,()=>G(()=>import("./FogHaze.glsl-ea6aef58.js"),["assets/FogHaze.glsl-ea6aef58.js","assets/mat4-44a0988f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/mat4f64-1e28eae0.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/vec3-e93e648f.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/FloatPassUniform-68d54f51.js","assets/vec4-790471c0.js","assets/vec4f64-e407da96.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/vec3f32-c9aa289f.js","assets/compilerUtils-18d58939.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));let IN=class extends $a{constructor(){super(...arguments),this.haze=!1}};h([N()],IN.prototype,"haze",void 0);const Eye=.95,Pye=1;let cb=class extends ue{constructor(e){super(e),this._passParameters=new MN;const t=e.context.renderContext.rctx;this._vao=La(t,kx);const r=Yt(e.view.spatialReference);this._planetRadius=r.radius,this._atmosphereRadius=r.radius+rx}destroy(){this._thickFogTechniqueCached=Qi(this._thickFogTechniqueCached),this._vao=Me(this._vao)}get _shaderTechniqueRepository(){return this.context.shaderTechniqueRepository}set strength(e){this._passParameters.fogStrength=e}get strength(){return this._passParameters.fogStrength}get _thickFogTechnique(){if(S(this._thickFogTechniqueCached)){const e=new IN;e.haze=!1,this._thickFogTechniqueCached=this._shaderTechniqueRepository.acquire(PQ,e)}return this._thickFogTechniqueCached}render(e,t){if(this._update(e,t),this._passParameters.fogAmount<=0)return;const r=this._thickFogTechnique;if(!r.compiled)return void this.context.requestRender();const n=e.offscreenRenderingHelper;n.renderDepthDetached(()=>{this._passParameters.depthTexture=n.depthTexture;const s=e.rctx.bindTechnique(r,this._passParameters,e.bindParameters);this._renderFog(s,e)})}_renderFog(e,t){if(S(this._vao))return;const r=t.rctx;r.bindVAO(this._vao),e.assertCompatibleVertexAttributeLocations(this._vao),r.drawArrays(Dt.TRIANGLE_STRIP,0,4)}_update(e,t){const r=e.bindParameters.camera;he(m6,r.eye);const n=Math.max(0,me(m6,e.bindParameters.lighting.mainLight.direction)),s=t.color;Q(f6,s,.1),Bn(this._passParameters.fogColor,f6,s,n);const a=_e(r.eye),o=a*a;this._passParameters.atmosphereC=o-this._atmosphereRadius*this._atmosphereRadius,this._passParameters.fogAmount=(1-U0(Eye*Cl,Pye*Cl,Math.abs(a-this._planetRadius)))*t.amount,this._passParameters.fogStrength=t.strength}static isSupported(e){return e.capabilities.depthTexture}};h([p({constructOnly:!0})],cb.prototype,"context",void 0),h([p({constructOnly:!0})],cb.prototype,"view",void 0),cb=h([D("esri.views.3d.environment.Fog")],cb);let Rye=class{constructor(){this.color=R(),this.strength=0,this.amount=0}};const m6=R(),f6=R();var su;(function(i){i[i.Cone=0]="Cone",i[i.Cylinder=1]="Cylinder",i[i.Underground=2]="Underground",i[i.COUNT=3]="COUNT"})(su||(su={}));let D2=class extends cu{constructor(){super(...arguments),this.geometry=su.Cone}};h([N({count:su.COUNT})],D2.prototype,"geometry",void 0);let LN=class extends Ir{constructor(){super(...arguments),this.texV=be(),this.altitudeFade=0,this.innerScale=0,this.undergroundFadeAlpha=0,this.silhouette=new AQ}},AQ=class{constructor(){this.center=R(),this.v1=R(),this.v2=R()}};function Aye(i){const e=new Yi,{vertex:t,fragment:r}=e;if(OP(t),i.geometry===su.Underground)e.attributes.add(P.POSITION,"vec2"),e.varyings.add("color","vec4"),t.uniforms.add([new Rs("cameraPosition",(n,s)=>s.camera.eye),new Tt("undergroundFadeAlpha",n=>n.undergroundFadeAlpha)]),t.code.add(O`void main(void) {
float ndotl = dot(normalize(cameraPosition), mainLightDirection);
float lighting = max(0.0, smoothstep(-1.0, 0.8, 2.0 * ndotl));
color = vec4(vec3(lighting), undergroundFadeAlpha);
gl_Position = vec4(position.xy, 1.0, 1.0);
}`),r.code.add(O`void main() {
gl_FragColor = color;
}`);else{e.include(HG,i),e.attributes.add(P.POSITION,"vec3"),e.varyings.add("vtc","vec2"),e.varyings.add("falloff","float");const n=i.geometry===su.Cylinder;t.uniforms.add([new Ys("proj",(o,l)=>l.camera.projectionMatrix),new Ys("view",(o,l)=>l.camera.viewMatrix)]),n||(e.varyings.add("innerFactor","float"),t.uniforms.add(new Rs("silCircleCenter",o=>o.silhouette.center)),t.uniforms.add(new Rs("silCircleV1",o=>o.silhouette.v1)),t.uniforms.add(new Rs("silCircleV2",o=>o.silhouette.v2)),t.uniforms.add(new Zs("texV",o=>o.texV)),t.uniforms.add(new Tt("innerScale",o=>o.innerScale)));const s=6.2831853,a=1/128;t.code.add(O`
		void main(void) {
      ${n?O`
      vec3 pos = position;
      float ndotl = mainLightDirection.z;
      vtc = vec2(0.0, position.z + 0.05);`:O`
      innerFactor = clamp(-position.z, 0.0, 1.0);
      float scale = position.y * (1.0 + innerFactor * innerScale);
      float phi = position.x * ${O.float(s*a)} + 1.0;
      vec3 pos =  (silCircleCenter + sin(phi) * silCircleV1 + cos(phi) * silCircleV2) * scale;
      float ndotl = dot(normalize(position.y > 0.0 ? pos: silCircleCenter), mainLightDirection);
      vtc.x = position.x  * ${O.float(a)};
      vtc.y = texV.x * (1.0 - position.z) + texV.y * position.z;
      `}
      falloff = max(0.0, smoothstep(-1.0, 0.8, 2.0 * ndotl));

		  gl_Position = transformPosition(proj, view, pos);
		  gl_Position.z = gl_Position.w; // project atmosphere onto the far plane
    }
	  `),r.uniforms.add(new Bt("tex",o=>o.texture)),n||r.uniforms.add(new Tt("altitudeFade",o=>o.altitudeFade)),r.code.add(O`
		void main() {
			vec4 atmosphereColor = texture2D(tex, vtc) * falloff;
      ${n?O`gl_FragColor = atmosphereColor;`:O`
			vec4 innerColor = vec4(atmosphereColor.rgb, 1.0 - altitudeFade);
			gl_FragColor = mix(atmosphereColor, innerColor, smoothstep(0.0, 1.0, innerFactor));
      `}
    }`)}return e}const Oye=Object.freeze(Object.defineProperty({__proto__:null,SimpleAtmospherePassParameters:LN,SilhouetteCircle:AQ,build:Aye},Symbol.toStringTag,{value:"Module"}));let F2=class OQ extends ti{initializeProgram(e){return new Jt(e.rctx,OQ.shader.get().build(this.configuration),ai)}initializePipeline(){return this.configuration.geometry===su.Cylinder?Ke({blending:Gn(de.SRC_ALPHA,de.ONE,de.ONE_MINUS_SRC_ALPHA,de.ONE_MINUS_SRC_ALPHA),culling:wG,depthTest:{func:hs.LEQUAL},colorWrite:ht}):Ke({blending:Gn(de.SRC_ALPHA,de.ONE,de.ONE_MINUS_SRC_ALPHA,de.ONE_MINUS_SRC_ALPHA),depthTest:{func:hs.LEQUAL},colorWrite:ht})}};F2.shader=new ii(Oye,()=>G(()=>import("./SimpleAtmosphere.glsl-d3ceeb84.js"),["assets/SimpleAtmosphere.glsl-d3ceeb84.js","assets/vec2f64-30dc1443.js","assets/vec3f64-2f9cef06.js","assets/Matrix3PassUniform-ad9f953b.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/mat3f64-c6305894.js","assets/mat4f64-1e28eae0.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/vec2-528adfe4.js","assets/common-c186b691.js","assets/Texture2DPassUniform-753de459.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/sphere-2af0d852.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));const MQ=new Uint8ClampedArray([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,2,0,0,0,2,0,0,0,2,0,0,0,2,0,0,0,2,0,0,0,2,0,0,0,3,0,0,0,3,0,0,0,3,0,0,0,3,0,0,0,3,0,0,0,4,0,0,0,4,0,0,0,4,0,0,0,4,0,0,0,4,0,0,0,4,0,0,0,5,0,0,0,5,0,0,0,5,0,0,0,5,0,0,0,5,0,0,0,6,0,0,0,6,0,0,0,6,0,0,0,6,0,0,0,6,0,0,0,7,0,0,0,7,0,0,0,7,0,0,0,7,0,0,0,7,0,0,0,8,0,0,0,8,0,0,0,8,0,0,0,8,0,0,0,8,0,0,0,9,0,0,0,9,0,0,0,9,0,0,0,9,0,0,0,9,0,0,0,10,0,0,0,10,0,0,0,10,0,0,0,10,0,0,0,11,0,0,0,11,0,0,0,11,0,0,0,11,0,0,0,11,0,0,0,12,0,0,0,12,0,0,0,12,0,0,0,12,0,0,0,13,0,0,0,13,0,0,0,13,0,0,0,13,0,0,0,14,0,0,0,14,0,0,0,14,0,0,0,14,0,0,0,15,0,0,0,15,0,0,0,15,0,0,0,15,0,0,0,15,16,0,0,16,16,0,0,16,16,0,0,16,16,0,0,16,15,0,0,17,15,0,0,17,15,0,0,17,15,0,0,17,14,0,0,18,14,0,0,18,14,0,0,18,13,0,0,19,13,0,0,19,13,0,0,19,13,0,0,19,13,0,0,20,13,0,0,20,13,0,0,20,13,0,0,20,12,0,0,21,12,0,0,21,12,0,0,21,12,0,0,21,12,0,0,22,12,0,0,22,12,0,0,22,12,0,0,22,11,0,0,23,11,0,0,23,11,0,0,23,11,0,0,24,11,0,0,24,11,0,0,24,11,0,0,24,10,0,0,25,10,0,0,25,10,0,0,25,10,0,0,26,10,0,0,26,10,0,0,26,10,0,0,26,9,0,0,27,9,0,0,27,9,0,0,27,18,0,0,28,18,0,0,28,18,0,0,28,18,0,0,28,18,0,0,29,18,0,0,29,18,0,0,29,17,0,0,30,17,0,0,30,17,0,0,30,17,0,0,30,16,0,0,31,16,0,0,31,16,0,0,31,16,0,0,32,16,0,0,32,16,0,0,32,15,0,0,33,15,0,0,33,15,0,0,33,15,0,0,34,15,8,0,34,15,8,0,34,15,8,0,34,15,7,0,35,15,7,0,35,15,7,0,35,21,7,0,36,21,7,0,36,21,7,0,36,21,7,0,37,21,7,0,37,21,7,0,37,20,7,0,38,20,7,0,38,20,7,0,38,20,7,0,39,20,7,0,39,20,7,0,39,20,7,0,39,19,6,0,40,19,6,0,40,19,6,0,40,19,6,0,41,19,6,0,41,19,6,0,41,18,6,0,42,18,6,0,42,18,6,0,42,24,6,0,43,24,6,0,43,24,6,0,43,23,6,0,44,23,6,0,44,23,6,0,44,23,6,0,45,23,6,0,45,23,6,0,45,22,6,0,46,22,6,0,46,22,6,0,46,22,5,0,47,22,5,0,47,22,5,0,47,21,5,0,48,21,5,0,48,21,5,0,48,21,5,0,49,21,5,0,49,26,5,0,49,25,5,0,50,25,5,0,50,25,5,0,50,25,5,0,51,25,5,0,51,25,5,0,51,25,5,0,52,25,5,0,52,25,5,0,52,24,5,0,53,24,5,0,53,24,5,0,53,24,9,0,54,28,9,0,54,28,9,0,54,28,9,0,55,28,9,0,55,27,9,0,56,27,9,0,56,27,9,0,56,27,9,4,57,27,9,4,57,27,9,4,57,26,9,4,58,26,9,4,58,26,9,4,58,26,9,4,59,26,9,4,59,26,9,4,59,26,8,4,60,30,8,4,60,30,8,4,60,29,8,4,61,29,8,4,61,29,8,4,62,29,8,4,62,29,8,4,62,28,8,4,63,28,8,4,63,28,8,4,63,28,12,4,64,28,12,4,64,28,12,4,64,27,12,4,65,27,12,8,65,27,12,8,65,31,12,8,66,31,12,8,66,30,11,8,67,30,11,8,67,30,11,8,67,30,11,8,68,30,11,8,68,30,11,8,68,30,15,7,69,30,15,7,69,30,15,7,69,33,15,11,70,33,15,11,70,32,14,11,71,32,14,11,71,32,14,11,71,32,18,14,72,32,18,14,72,32,18,14,72,31,17,14,73,35,17,14,73,34,17,17,74,34,21,17,74,34,21,17,74,34,20,17,75,34,20,20,75,34,20,20,75,34,23,20,76,34,23,20,76,36,23,23,77,36,23,23,77,36,23,23,77,36,23,23,78,36,26,26,78,36,26,26,78,36,26,26,79,36,26,29,79,38,26,29,80,38,29,29,80,38,29,29,80,38,28,31,81,38,28,31,81,38,31,31,81,37,31,34,82,37,31,34,82,37,31,37,83,40,34,37,83,40,34,37,83,39,33,39,84,39,33,39,84,39,36,42,84,39,36,42,85,39,36,42,85,39,36,42,85,39,39,44,86,39,39,44,86,41,38,47,87,41,41,47,87,41,41,50,87,41,41,49,88,41,41,52,88,40,43,52,89,43,43,52,89,43,43,54,89,42,45,54,90,42,45,57,90,42,45,57,90,42,45,59,91,42,48,59,91,44,47,61,92,44,47,61,92,44,50,61,92,44,49,63,93,44,49,63,93,44,52,66,93,43,52,65,94,46,54,68,94,46,54,70,95,46,54,70,95,46,54,70,95,45,56,72,96,45,56,72,96,45,58,74,97,47,58,76,97,47,58,76,97,47,60,78,98,47,60,78,98,47,60,81,98,49,62,80,99,49,62,82,99,48,61,84,100,48,64,84,100,48,64,84,100,50,63,86,101,50,66,86,101,50,66,88,101,50,65,90,102,52,67,89,103,51,69,91,104,51,68,92,105,52,69,93,107,52,71,94,108,54,70,96,109,53,71,96,111,52,73,98,112,54,72,98,114,53,73,100,115,54,72,100,117,54,73,102,118,55,74,104,120,55,76,105,121,56,77,106,123,56,76,107,124,57,79,107,126,58,78,110,128,57,79,111,129,56,80,113,131,58,79,112,132,57,82,114,134,58,81,116,136,60,82,117,137,59,83,117,139,60,83,119,141,59,84,120,142,60,85,122,144,59,86,122,146,60,86,126,148,62,87,127,149,61,88,127,151,62,88,128,153,63,89,130,155,62,90,131,156,63,90,132,158,64,91,134,160,65,91,135,162,64,92,136,163,63,93,138,165,66,95,139,167,65,95,140,169,66,95,142,171,67,96,142,172,66,97,144,174,67,99,145,176,67,97,148,178,67,99,147,180,68,100,149,181,68,100,150,183,69,101,152,185,70,102,153,187,71,103,155,188,70,103,156,190,70,104,157,192,71,105,158,194,71,106,160,195,72,106,161,197,72,108,161,199,73,108,163,200,73,109,164,202,74,109,165,204,74,110,167,206,75,111,168,207,74,112,170,209,75,112,170,210,76,113,171,212,76,114,173,214,77,115,174,215,78,115,175,217,78,116,175,218,78,117,177,220,78,118,178,221,79,118,180,223,80,120,180,224,81,120,181,226,81,120,182,227,82,121,184,229,82,122,185,230,84,123,186,232,83,123,187,233,84,124,189,234,84,125,188,235,85,126,189,237,86,126,190,238,86,127,191,239,87,127,192,240,87,129,193,242,88,129,194,243,89,130,195,244,90,131,196,245,90,132,197,246,91,132,197,247,92,133,198,248,92,134,199,249,93,135,200,250,94,136,201,251,95,137,202,252,96,138,203,253,97,140,204,254,98,141,205,254,99,142,206,255,101,143,207,255,102,144,208,255,103,146,209,255,104,147,209,255,106,148,210,255,107,149,211,255,108,151,212,255,110,152,213,255,111,153,213,255,112,154,214,255,114,156,215,255,115,157,215,255,117,158,216,255,118,160,217,255,120,161,217,255,121,162,218,255,123,164,218,255,124,165,219,255,125,166,219,255,127,167,220,255,129,169,220,255,130,170,221,255,132,171,221,255,133,173,222,255,134,174,222,255,136,175,223,255,139,178,224,255,142,180,224,255,144,182,225,255,147,185,226,255,150,187,226,255,153,189,227,255,155,191,228,255,158,194,228,255,160,196,229,255,163,198,229,255,165,200,230,255,168,202,231,255,170,203,231,255,172,205,232,255,174,207,232,255,176,209,233,255,178,210,234,255,180,212,234,255,182,214,235,255,184,215,236,255,186,217,237,255,188,219,238,255,190,220,238,255,192,221,239,255,193,222,240,255,194,224,240,255,196,225,241,255,197,226,241,255,198,226,242,255,199,227,242,255,200,228,242,255,201,228,243,255,202,229,243,255,203,230,243,255,204,230,244,255,205,231,244,255,207,232,244,255,208,233,245,255,209,233,245,255,211,234,246,255,213,235,246,255,217,238,247,255,222,240,248,255,226,242,249,255,231,245,250,255,236,247,251,255,241,249,252,255,245,251,253,255,249,252,254,255,255,255,255,255]);var SL;(function(i){function e(a,o){const l=a[o],c=a[o+1],u=a[o+2];return Math.sqrt(l*l+c*c+u*u)}function t(a,o){const l=a[o],c=a[o+1],u=a[o+2],d=1/Math.sqrt(l*l+c*c+u*u);a[o]*=d,a[o+1]*=d,a[o+2]*=d}function r(a,o,l){a[o]*=l,a[o+1]*=l,a[o+2]*=l}function n(a,o,l,c,u,d=o){(u=u||a)[d]=a[o]+l[c],u[d+1]=a[o+1]+l[c+1],u[d+2]=a[o+2]+l[c+2]}function s(a,o,l,c,u,d=o){(u=u||a)[d]=a[o]-l[c],u[d+1]=a[o+1]-l[c+1],u[d+2]=a[o+2]-l[c+2]}i.length=e,i.normalize=t,i.scale=r,i.add=n,i.subtract=s})(SL||(SL={}));const R_=SL;var EL,PL,RL;(function(i){const t=[[-.5,-.5,.5],[.5,-.5,.5],[.5,.5,.5],[-.5,.5,.5],[-.5,-.5,-.5],[.5,-.5,-.5],[.5,.5,-.5],[-.5,.5,-.5]],r=[0,0,1,-1,0,0,1,0,0,0,-1,0,0,1,0,0,0,-1],n=[0,0,1,0,1,1,0,1],s=[0,1,2,2,3,0,4,0,3,3,7,4,1,5,6,6,2,1,1,0,4,4,5,1,3,2,6,6,7,3,5,4,7,7,6,5],a=new Array(36);for(let c=0;c<6;c++)for(let u=0;u<6;u++)a[6*c+u]=c;const o=new Array(36);for(let c=0;c<6;c++)o[6*c+0]=0,o[6*c+1]=1,o[6*c+2]=2,o[6*c+3]=2,o[6*c+4]=3,o[6*c+5]=0;function l(c){Array.isArray(c)||(c=[c,c,c]);const u=new Array(24);for(let d=0;d<8;d++)u[3*d]=t[d][0]*c[0],u[3*d+1]=t[d][1]*c[1],u[3*d+2]=t[d][2]*c[2];return new jr([[P.POSITION,{size:3,data:u,exclusive:!0}],[P.NORMAL,{size:3,data:r}],[P.UV0,{size:2,data:n}]],[[P.POSITION,s],[P.NORMAL,a],[P.UV0,o]])}i.createGeometry=l})(EL||(EL={})),function(i){const t=[[-.5,0,-.5],[.5,0,-.5],[.5,0,.5],[-.5,0,.5],[0,-.5,0],[0,.5,0]],r=[0,1,-1,1,1,0,0,1,1,-1,1,0,0,-1,-1,1,-1,0,0,-1,1,-1,-1,0],n=[5,1,0,5,2,1,5,3,2,5,0,3,4,0,1,4,1,2,4,2,3,4,3,0],s=[0,0,0,1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6,7,7,7];function a(o){Array.isArray(o)||(o=[o,o,o]);const l=new Array(18);for(let c=0;c<6;c++)l[3*c]=t[c][0]*o[0],l[3*c+1]=t[c][1]*o[1],l[3*c+2]=t[c][2]*o[2];return new jr([[P.POSITION,{size:3,data:l,exclusive:!0}],[P.NORMAL,{size:3,data:r}]],[[P.POSITION,n],[P.NORMAL,s]])}i.createGeometry=a}(PL||(PL={})),function(i){const r=gi(-.5,0,-.5),n=gi(.5,0,-.5),s=gi(0,0,.5),a=gi(0,0+.5,0),o=Xi(),l=Xi(),c=Xi(),u=Xi(),d=Xi();ne(o,r,a),ne(l,r,n),nt(c,o,l),he(c,c),ne(o,n,a),ne(l,n,s),nt(u,o,l),he(u,u),ne(o,s,a),ne(l,s,r),nt(d,o,l),he(d,d);const m=[r,n,s,a],f=[0,-1,0,c[0],c[1],c[2],u[0],u[1],u[2],d[0],d[1],d[2]],_=[0,1,2,3,1,0,3,2,1,3,0,2],g=[0,0,0,1,1,1,2,2,2,3,3,3];function x(b){Array.isArray(b)||(b=[b,b,b]);const v=new Array(12);for(let w=0;w<4;w++)v[3*w]=m[w][0]*b[0],v[3*w+1]=m[w][1]*b[1],v[3*w+2]=m[w][2]*b[2];return new jr([[P.POSITION,{size:3,data:v,exclusive:!0}],[P.NORMAL,{size:3,data:f}]],[[P.POSITION,_],[P.NORMAL,g]])}i.createGeometry=x}(RL||(RL={}));const Mye=EL.createGeometry,Iye=PL.createGeometry,Lye=RL.createGeometry;function B9e(i,e,t,r={uv:!0}){const n=-Math.PI,s=2*Math.PI,a=-Math.PI/2,o=Math.PI,l=Math.max(3,Math.floor(e)),c=Math.max(2,Math.floor(t)),u=(l+1)*(c+1),d=new Float32Array(3*u),m=new Float32Array(3*u),f=new Float32Array(2*u),_=[];let g=0;for(let w=0;w<=c;w++){const T=[],E=w/c,C=a+E*o,A=Math.cos(C);for(let M=0;M<=l;M++){const I=M/l,L=n+I*s,U=Math.cos(L)*A,j=Math.sin(C),re=-Math.sin(L)*A;d[3*g]=U*i,d[3*g+1]=j*i,d[3*g+2]=re*i,m[3*g]=U,m[3*g+1]=j,m[3*g+2]=re,f[2*g]=I,f[2*g+1]=E,T.push(g),++g}_.push(T)}const x=new Array;for(let w=0;w<c;w++)for(let T=0;T<l;T++){const E=_[w][T],C=_[w][T+1],A=_[w+1][T+1],M=_[w+1][T];w===0?(x.push(E),x.push(A),x.push(M)):w===c-1?(x.push(E),x.push(C),x.push(A)):(x.push(E),x.push(C),x.push(A),x.push(A),x.push(M),x.push(E))}const b=[[P.POSITION,x],[P.NORMAL,x]],v=[[P.POSITION,{size:3,data:d,exclusive:!0}],[P.NORMAL,{size:3,data:m,exclusive:!0}]];return r.uv&&(v.push([P.UV0,{size:2,data:f,exclusive:!0}]),b.push([P.UV0,x])),r.offset&&(b[0][0]=P.OFFSET,v[0][0]=P.OFFSET,b.push([P.POSITION,new Array(x.length).fill(0)]),v.push([P.POSITION,{size:3,data:Float64Array.from(r.offset),exclusive:!0}])),new jr(v,b)}function IQ(i,e,t){const r=i;let n,s;if(t)n=[0,-1,0,1,0,0,0,0,1,-1,0,0,0,0,-1,0,1,0],s=[0,1,2,0,2,3,0,3,4,0,4,1,1,5,2,2,5,3,3,5,4,4,5,1];else{const d=r*(1+Math.sqrt(5))/2;n=[-r,d,0,r,d,0,-r,-d,0,r,-d,0,0,-r,d,0,r,d,0,-r,-d,0,r,-d,d,0,-r,d,0,r,-d,0,-r,-d,0,r],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1]}for(let d=0;d<n.length;d+=3)R_.scale(n,d,i/R_.length(n,d));let a={};function o(d,m){d>m&&([d,m]=[m,d]);const f=d.toString()+"."+m.toString();if(a[f])return a[f];let _=n.length;return n.length+=3,R_.add(n,3*d,n,3*m,n,_),R_.scale(n,_,i/R_.length(n,_)),_/=3,a[f]=_,_}for(let d=0;d<e;d++){const m=s.length,f=new Array(4*m);for(let _=0;_<m;_+=3){const g=s[_],x=s[_+1],b=s[_+2],v=o(g,x),w=o(x,b),T=o(b,g),E=4*_;f[E]=g,f[E+1]=v,f[E+2]=T,f[E+3]=x,f[E+4]=w,f[E+5]=v,f[E+6]=b,f[E+7]=T,f[E+8]=w,f[E+9]=v,f[E+10]=w,f[E+11]=T}s=f,a={}}const l=new Float32Array(n);for(let d=0;d<l.length;d+=3)R_.normalize(l,d);const c=[[P.POSITION,s],[P.NORMAL,s]],u=[[P.POSITION,{size:3,data:new Float32Array(n),exclusive:!0}],[P.NORMAL,{size:3,data:l,exclusive:!0}]];return new jr(u,c)}function AL(i,e,t,r,n,s,a,o){const l=e?[e[0],e[1],e[2]]:[0,0,0],c=i?[i[0],i[1],i[2]]:[0,0,1];s=s||[0,0];const u=t?[255*t[0],255*t[1],255*t[2],t.length>3?255*t[3]:255]:[255,255,255,255],d=r!=null&&r.length===2?r:[1,1],m=[[P.POSITION,{size:3,data:l,exclusive:!0}],[P.NORMAL,{size:3,data:c,exclusive:!0}],[P.UV0,{size:s.length,data:s}],[P.COLOR,{size:4,data:u,exclusive:!0}],[P.SIZE,{size:2,data:d}]];if(n!=null){const f=new Float32Array([n[0],n[1],n[2],n[3]]);m.push([P.AUXPOS1,{size:4,data:f}])}if(a!=null){const f=new Float32Array([a[0],a[1],a[2],a[3]]);m.push([P.AUXPOS2,{size:4,data:f}])}return new jr(m,null,Fc.Point,o)}const $ye=[[-1,-1,0],[1,-1,0],[1,1,0],[-1,1,0]];function G9e(i=$ye){const e=new Array(12);for(let c=0;c<4;c++)for(let u=0;u<3;u++)e[3*c+u]=i[c][u];const t=[0,1,2,2,3,0],r=[0,0,1],n=[0,0,0,0,0,0],s=[0,0,1,0,1,1,0,1],a=[255,255,255,255],o=[[P.POSITION,t],[P.NORMAL,n],[P.UV0,t],[P.COLOR,n]],l=[[P.POSITION,{size:3,data:e,exclusive:!0}],[P.NORMAL,{size:3,data:r,exclusive:!0}],[P.UV0,{size:2,data:s,exclusive:!0}],[P.COLOR,{size:4,data:a,exclusive:!0}]];return new jr(l,o)}function g6(i,e,t,r,n=!0,s=!0){let a=0;const o=e,l=i;let c=gi(0,a,0),u=gi(0,a+l,0),d=gi(0,-1,0),m=gi(0,1,0);r&&(a=l,u=gi(0,0,0),c=gi(0,a,0),d=gi(0,1,0),m=gi(0,-1,0));const f=[u,c],_=[d,m],g=t+2,x=Math.sqrt(l*l+o*o);if(r)for(let A=t-1;A>=0;A--){const M=A*(2*Math.PI/t),I=gi(Math.cos(M)*o,a,Math.sin(M)*o);f.push(I);const L=gi(l*Math.cos(M)/x,-o/x,l*Math.sin(M)/x);_.push(L)}else for(let A=0;A<t;A++){const M=A*(2*Math.PI/t),I=gi(Math.cos(M)*o,a,Math.sin(M)*o);f.push(I);const L=gi(l*Math.cos(M)/x,o/x,l*Math.sin(M)/x);_.push(L)}const b=new Array,v=new Array;if(n){for(let A=3;A<f.length;A++)b.push(1),b.push(A-1),b.push(A),v.push(0),v.push(0),v.push(0);b.push(f.length-1),b.push(2),b.push(1),v.push(0),v.push(0),v.push(0)}if(s){for(let A=3;A<f.length;A++)b.push(A),b.push(A-1),b.push(0),v.push(A),v.push(A-1),v.push(1);b.push(0),b.push(2),b.push(f.length-1),v.push(1),v.push(2),v.push(_.length-1)}const w=new Float32Array(3*g);for(let A=0;A<g;A++)w[3*A]=f[A][0],w[3*A+1]=f[A][1],w[3*A+2]=f[A][2];const T=new Float32Array(3*g);for(let A=0;A<g;A++)T[3*A]=_[A][0],T[3*A+1]=_[A][1],T[3*A+2]=_[A][2];const E=[[P.POSITION,b],[P.NORMAL,v]],C=[[P.POSITION,{size:3,data:w,exclusive:!0}],[P.NORMAL,{size:3,data:T,exclusive:!0}]];return new jr(C,E)}function Dye(i,e,t,r,n,s){const a=r?$5(r):gi(1,0,0),o=n?$5(n):gi(0,0,0);s=s??!0;const l=Xi();he(l,a);const c=Xi();Q(c,l,Math.abs(i));const u=Xi();Q(u,c,-.5),oe(u,u,o);const d=gi(0,1,0);Math.abs(1-me(l,d))<.2&&Z(d,0,0,1);const m=Xi();nt(m,l,d),he(m,m),nt(d,m,l);const f=2*t+(s?2:0),_=t+(s?2:0),g=new Float32Array(3*f),x=new Float32Array(3*_),b=new Float32Array(2*f),v=new Array(3*t*(s?4:2)),w=new Array(3*t*(s?4:2));s&&(g[3*(f-2)+0]=u[0],g[3*(f-2)+1]=u[1],g[3*(f-2)+2]=u[2],b[2*(f-2)]=0,b[2*(f-2)+1]=0,g[3*(f-1)+0]=g[3*(f-2)+0]+c[0],g[3*(f-1)+1]=g[3*(f-2)+1]+c[1],g[3*(f-1)+2]=g[3*(f-2)+2]+c[2],b[2*(f-1)]=1,b[2*(f-1)+1]=1,x[3*(_-2)+0]=-l[0],x[3*(_-2)+1]=-l[1],x[3*(_-2)+2]=-l[2],x[3*(_-1)+0]=l[0],x[3*(_-1)+1]=l[1],x[3*(_-1)+2]=l[2]);const T=(L,U,j)=>{v[L]=U,w[L]=j};let E=0;const C=Xi(),A=Xi();for(let L=0;L<t;L++){const U=L*(2*Math.PI/t);Q(C,d,Math.sin(U)),Q(A,m,Math.cos(U)),oe(C,C,A),x[3*L+0]=C[0],x[3*L+1]=C[1],x[3*L+2]=C[2],Q(C,C,e),oe(C,C,u),g[3*L+0]=C[0],g[3*L+1]=C[1],g[3*L+2]=C[2],b[2*L+0]=L/t,b[2*L+1]=0,g[3*(L+t)+0]=g[3*L+0]+c[0],g[3*(L+t)+1]=g[3*L+1]+c[1],g[3*(L+t)+2]=g[3*L+2]+c[2],b[2*(L+t)+0]=L/t,b[2*L+1]=1;const j=(L+1)%t;T(E++,L,L),T(E++,L+t,L),T(E++,j,j),T(E++,j,j),T(E++,L+t,L),T(E++,j+t,j)}if(s){for(let L=0;L<t;L++){const U=(L+1)%t;T(E++,f-2,_-2),T(E++,L,_-2),T(E++,U,_-2)}for(let L=0;L<t;L++){const U=(L+1)%t;T(E++,L+t,_-1),T(E++,f-1,_-1),T(E++,U+t,_-1)}}const M=[[P.POSITION,v],[P.NORMAL,w],[P.UV0,v]],I=[[P.POSITION,{size:3,data:g,exclusive:!0}],[P.NORMAL,{size:3,data:x,exclusive:!0}],[P.UV0,{size:2,data:b,exclusive:!0}]];return new jr(I,M)}function H9e(i,e,t,r,n,s=gi(0,0,0)){const a=i.length,o=new Float32Array(e.length*a*3+(6*t.length||0)),l=new Float32Array(e.length*a*3+(t?6:0)),c=new Array,u=new Array;let d=0,m=0;const f=Xi(),_=Xi(),g=Xi(),x=Xi(),b=Xi(),v=Xi(),w=Xi(),T=R(),E=Xi(),C=Xi(),A=Xi(),M=Xi(),I=Xi(),L=fr();Z(E,0,1,0),ne(_,e[1],e[0]),he(_,_),n?(oe(T,e[0],s),he(g,T)):Z(g,0,0,1),N2(_,g,E,E,b,g,_6),q(x,g),q(M,b);for(let $=0;$<t.length;$++)Q(v,b,t[$][0]),Q(T,g,t[$][2]),oe(v,v,T),oe(v,v,e[0]),o[d++]=v[0],o[d++]=v[1],o[d++]=v[2];l[m++]=-_[0],l[m++]=-_[1],l[m++]=-_[2];for(let $=0;$<r.length;$++)c.push(r[$][0]>0?r[$][0]:-r[$][0]-1+t.length),c.push(r[$][1]>0?r[$][1]:-r[$][1]-1+t.length),c.push(r[$][2]>0?r[$][2]:-r[$][2]-1+t.length),u.push(0),u.push(0),u.push(0);let U=t.length;const j=t.length-1;for(let $=0;$<e.length;$++){let B=!1;$>0&&(q(f,_),$<e.length-1?(ne(_,e[$+1],e[$]),he(_,_)):B=!0,oe(C,f,_),he(C,C),oe(A,e[$-1],x),xw(e[$],C,L),Kg(L,zc(A,f),T)?(ne(T,T,e[$]),he(g,T),nt(b,C,g),he(b,b)):N2(C,x,M,E,b,g,_6),q(x,g),q(M,b)),n&&(oe(T,e[$],s),he(I,T));for(let W=0;W<a;W++)if(Q(v,b,i[W][0]),Q(T,g,i[W][1]),oe(v,v,T),he(w,v),l[m++]=w[0],l[m++]=w[1],l[m++]=w[2],oe(v,v,e[$]),o[d++]=v[0],o[d++]=v[1],o[d++]=v[2],!B){const te=(W+1)%a;c.push(U+W),c.push(U+a+W),c.push(U+te),c.push(U+te),c.push(U+a+W),c.push(U+a+te);for(let ie=0;ie<6;ie++){const Y=c.length-6;u.push(c[Y+ie]-j)}}U+=a}const re=e[e.length-1];for(let $=0;$<t.length;$++)Q(v,b,t[$][0]),Q(T,g,t[$][1]),oe(v,v,T),oe(v,v,re),o[d++]=v[0],o[d++]=v[1],o[d++]=v[2];const ee=m/3;l[m++]=_[0],l[m++]=_[1],l[m++]=_[2];const H=U-a;for(let $=0;$<r.length;$++)c.push(r[$][0]>=0?U+r[$][0]:-r[$][0]-1+H),c.push(r[$][2]>=0?U+r[$][2]:-r[$][2]-1+H),c.push(r[$][1]>=0?U+r[$][1]:-r[$][1]-1+H),u.push(ee),u.push(ee),u.push(ee);const V=[[P.POSITION,c],[P.NORMAL,u]],X=[[P.POSITION,{size:3,data:o,exclusive:!0}],[P.NORMAL,{size:3,data:l,exclusive:!0}]];return new jr(X,V)}function j9e(i,e,t){it(i.length>1,"createPolylineGeometry(): polyline needs at least 2 points"),it(i[0].length===3,"createPolylineGeometry(): malformed vertex"),it(e==null||e.length===i.length,"createPolylineGeometry: need same number of points and normals"),it(e==null||e[0].length===3,"createPolylineGeometry(): malformed normal");const r=new Float64Array(3*i.length),n=new Array(2*(i.length-1));let s=0,a=0;for(let c=0;c<i.length;c++){for(let u=0;u<3;u++)r[s++]=i[c][u];c>0&&(n[a++]=c-1,n[a++]=c)}const o=[],l=[];if(o.push([P.POSITION,n]),l.push([P.POSITION,{size:3,data:r,exclusive:!0}]),e){const c=new Float32Array(3*e.length);let u=0;for(let d=0;d<i.length;d++)for(let m=0;m<3;m++)c[u++]=e[d][m];o.push([P.NORMAL,n]),l.push([P.NORMAL,{size:3,data:c,exclusive:!0}])}return t&&(l.push([P.COLOR,{size:4,data:t}]),o.push([P.COLOR,zD(t.length/4)])),new jr(l,o,Fc.Line)}function q9e(i,e,t,r,n=0){const s=new Array(18),a=[[-e,n,r/2],[t,n,r/2],[0,i+n,r/2],[-e,n,-r/2],[t,n,-r/2],[0,i+n,-r/2]],o=[0,1,2,3,0,2,2,5,3,1,4,5,5,2,1,1,0,3,3,4,1,4,3,5];for(let l=0;l<6;l++)s[3*l]=a[l][0],s[3*l+1]=a[l][1],s[3*l+2]=a[l][2];return new jr([[P.POSITION,{size:3,data:s,exclusive:!0}]],[[P.POSITION,o]])}function Fye(i,e=i){const t=i.vertexAttributes,r=t.get(P.POSITION).data,n=t.get(P.NORMAL).data;if(n){const s=e.getMutableAttribute(P.NORMAL).data;for(let a=0;a<n.length;a+=3){const o=n[a+1];s[a+1]=-n[a+2],s[a+2]=o}}if(r){const s=e.getMutableAttribute(P.POSITION).data;for(let a=0;a<r.length;a+=3){const o=r[a+1];s[a+1]=-r[a+2],s[a+2]=o}}return e}function gO(i,e,t,r,n){return!(Math.abs(me(e,i))>n)&&(nt(t,i,e),he(t,t),nt(r,t,i),he(r,r),!0)}function N2(i,e,t,r,n,s,a){return gO(i,e,n,s,a)||gO(i,t,n,s,a)||gO(i,r,n,s,a)}const _6=.99619469809;let Nye=class{constructor(){this.type=In.Panoramic,this._configuration=new D2,this._passParameters=new LN}destroy(){this._passParameters.texture=Me(this._passParameters.texture),this._vao=Me(this._vao)}initializeRenderContext(e){this._configuration.geometry=su.Cylinder,this._technique=e.shaderTechniqueRepository.acquire(F2,this._configuration);const t=e.renderContext.rctx;this._vao=this._createVertexArrayObject(t),this._vaoCount=Ws(this._vao,"geometry"),this._passParameters.texture=new Gi(t,{pixelFormat:yt.RGBA,dataType:qt.UNSIGNED_BYTE,wrapMode:si.CLAMP_TO_EDGE,samplingMode:Kt.LINEAR,flipped:!0,width:1,height:512},MQ),e.requestRender()}render(e){if(S(this._vao)||S(this._passParameters.texture))return;const t=e.rctx,r=t.bindTechnique(this._technique,this._passParameters,e.bindParameters);kye(y6,e.bindParameters.camera.viewMatrix),r.setUniformMatrix4fv("view",y6),t.bindVAO(this._vao),r.assertCompatibleVertexAttributeLocations(this._vao),t.drawArrays(Dt.TRIANGLES,0,this._vaoCount)}renderHaze(){return!1}_createVertexArrayObject(e){const t=IQ(1,2,!1),r=t.indices.get(P.POSITION);for(let o=0;o<r.length;o+=3){const l=r[o];r[o]=r[o+2],r[o+2]=l}const n=t.vertexAttributes.get(P.POSITION).data,s=v6.createBuffer(r.length),a=s.position;for(let o=0;o<r.length;++o){const l=3*r[o];a.set(o,0,n[l]),a.set(o,1,n[l+1]),a.set(o,2,n[l+2])}return new nu(e,ai,{geometry:Wc(v6)},{geometry:hi.createVertex(e,di.STATIC_DRAW,s.buffer)})}};function kye(i,e){pn(i,e),i[12]=0,i[13]=0,i[14]=0,i[15]=1}const y6=ve(),v6=sn().vec3f(P.POSITION);var Ld;(function(i){i[i.Rain=0]="Rain",i[i.Snow=1]="Snow",i[i.COUNT=2]="COUNT"})(Ld||(Ld={}));let OL=class extends $a{constructor(){super(...arguments),this.type=Ld.Rain}};h([N({count:Ld.COUNT})],OL.prototype,"type",void 0);function Vye(i){const e=new Yi;return e.attributes.add(P.POSITION,"vec3"),e.attributes.add(P.INSTANCEFEATUREATTRIBUTE,"float"),e.vertex.uniforms.add(new Rs("cameraPosition",(t,r)=>r.camera.eye)),e.vertex.uniforms.add(new Rs("offset",(t,r)=>Uye(t,r))),e.vertex.uniforms.add(new Tt("width",t=>t.width)),e.vertex.uniforms.add(new Ys("proj",(t,r)=>r.camera.projectionMatrix)),e.vertex.uniforms.add(new Ys("view",(t,r)=>r.camera.viewMatrix)),e.vertex.uniforms.add(new Tt("time",t=>t.time)),e.varyings.add("vUv","vec2"),e.vertex.code.add(O`
    vec3 hash31(float p){
      vec3 p3 = fract(vec3(p) * vec3(0.1031, 0.1030, 0.0973));
      p3 += dot(p3, p3.yzx + 33.33);
      return fract((p3.xxy + p3.yzz) * p3.zyx);
    }

    float hash11(float p){
      p = fract(p * 0.1031);
      p *= p + 33.33;
      p *= p + p;
      return fract(p);
    }

    //https://www.geeks3d.com/20141201/how-to-rotate-a-vertex-by-a-quaternion-in-glsl/
    vec3 rotateVectorByQuaternion(vec3 v, vec4 q){
      return 2.0 * cross(q.xyz, v * q.w + cross(q.xyz, v)) + v;
    }

    void main(void) {

      vUv = position.xz;

      vec3 rand = hash31(instanceFeatureAttribute);

      // Set random position for all particles
      // The hash function space is not high resolution so offset particles by an additional random value
      // This creates grids of 1000 particles which are shifted by random hundreths of the tile width
      // overlaying multiple identical but offset grids
      vec3 randomPosition = 2.0 * (rand + (0.01 + 0.01 * rand) * floor(0.001 * instanceFeatureAttribute)) - 1.0;

      // Random orientation of rain drops
      float angle = 3.1415 * hash11(instanceFeatureAttribute);

      vec3 up = vec3(0, 0, 1);

      // Gravity and wind direction
      vec3 direction = normalize(cameraPosition);

      vec3 tangent = normalize(cross(direction, up));

      // Gravity
      vec3 animatedPos = randomPosition + direction * -time;

      // Rain particles fall straight down and are randomly oriented
      // Snow particles have random sinusoid trajectories and are rotated to face the camera
      ${i.type===Ld.Rain?O`
            // Random rotation for particle
            vec3 rotationAxis = up;
            vec4 quat = vec4(rotationAxis * sin(angle), cos(angle));
            vec3 transformedPos = rotateVectorByQuaternion(vec3(0.2, 0.2, 4.0) * (position - vec3(0.5, 0.0, 0.5)), quat);

            // Rotate particle to planetary position
            rotationAxis = tangent;
            angle = 0.5 * -acos(dot(direction, up));
            quat = vec4(rotationAxis * sin(angle), cos(angle));
            transformedPos = rotateVectorByQuaternion(transformedPos, quat);

            vec4 pos = mat4(mat3(view)) * vec4(transformedPos + (mod(width * animatedPos - offset, width) - 0.5 * width), 1.0);
            gl_Position = proj * pos;
      `:O`
            vec3 rotationAxis = direction;
            vec4 quat = vec4(rotationAxis * sin(angle), cos(angle));

            tangent = rotateVectorByQuaternion(tangent, quat);
            // Random sinusoid from friction
            animatedPos += tangent * 0.25 * sin(dot(animatedPos, direction));
            vec4 pos = mat4(mat3(view)) * vec4((mod(width * animatedPos - offset, width) - 0.5 * width), 1.0);
            gl_Position = proj * (0.5 * vec4(position.xzy, 0.0) + pos);
      `}
    }
  `),e.fragment.uniforms.add([new Tt("opacity",t=>t.opacity),new Rs("particleColor",(t,r)=>zye(r,i))]),e.fragment.code.add(O`
    void main() {

      // Cut off corners of the triangle
      if(vUv.x < 0.0 || vUv.y < 0.0){
        discard;
      }

      float d = length(vUv - vec2(0.5));

      ${i.type===Ld.Rain?O`d = 0.35 * smoothstep(0.5, 0.0, d);`:O`d = smoothstep(0.5, 0.1, d);`}
      gl_FragColor = opacity * vec4(particleColor * d, d);
    }
  `),e}function Uye(i,e){const t=e.camera.eye,r=.5*i.width,n=1/i.width,s=zie(ML,Z(ML,(t[0]+r)*n,(t[1]+r)*n,(t[2]+r)*n));return tl(s,t,Q(s,s,i.width))}function zye(i,e){const t=e.type===Ld.Rain?Gye:Bye,r=Q(ML,t,Hye),n=i.camera.eye;he(b6,n);const s=Math.max(0,me(b6,i.lighting.mainLight.direction));return Bn(r,r,t,s)}const ML=R(),b6=R(),Bye=Ge(1,1,1),Gye=Ge(.85,.85,.85),Hye=.7,jye=Object.freeze(Object.defineProperty({__proto__:null,build:Vye},Symbol.toStringTag,{value:"Module"}));let qye=class extends Ir{constructor(){super(...arguments),this.time=0,this.radius=1,this.width=500,this.opacity=1}},IL=class LQ extends ti{initializeProgram(e){return new Jt(e.rctx,LQ.shader.get().build(this.configuration),iE)}initializePipeline(){return Ke({blending:Gn(de.ONE,de.ONE,de.ONE_MINUS_SRC_ALPHA,de.ONE_MINUS_SRC_ALPHA),depthTest:{func:hs.LEQUAL},colorWrite:ht})}};IL.shader=new ii(jye,()=>G(()=>import("./Precipitation.glsl-97ce2097.js"),["assets/Precipitation.glsl-97ce2097.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/VertexAttribute-9c5c630d.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));const iE=new Map([[P.POSITION,0],[P.INSTANCEFEATUREATTRIBUTE,1]]);let $Q=class{constructor(){this.enabled=!0,this._time=Rt(0)}get time(){return this._time}advance(e){return this._time!==e.time&&(this._time=e.time,!0)}},Nf=class extends ue{constructor(e){super(e),this._numParticles=25e4,this._rainSpeed=.1,this._snowSpeed=.01,this._passParameters=new qye,this._animation=new $Q,this._updatingTracking=new mv,this._passParameters.time=0,this._passParameters.radius=Yt(e.view.spatialReference).radius,this._shaderTechniqueRepository=e.context.shaderTechniqueRepository}destroy(){this._updatingTracking.destroy(),this._numParticles=0,this._snowTechniqueCached=Qi(this._snowTechniqueCached),this._rainTechniqueCached=Qi(this._rainTechniqueCached),this._vao=Me(this._vao),this._instanceIdBuffer=Me(this._instanceIdBuffer)}get updating(){return this._updatingTracking.updating}get _rainTechnique(){if(S(this._rainTechniqueCached)){const e=new OL;e.type=Ld.Rain,this._rainTechniqueCached=this._shaderTechniqueRepository.acquire(IL,e)}return this._rainTechniqueCached}get _snowTechnique(){if(S(this._snowTechniqueCached)){const e=new OL;e.type=Ld.Snow,this._snowTechniqueCached=this._shaderTechniqueRepository.acquire(IL,e)}return this._snowTechniqueCached}update(e){return this._animation.advance(e)}render(e,t,r){const n=r==="rainy"?this._rainTechnique:this._snowTechnique;if(!n.compiled)return void this.context.requestRender();const s=e.rctx;if(this._ensureResources(s),S(n)||S(this._vao)||S(this._instanceIdBuffer)||(y(e.bindParameters.cloudsFade.data)&&(this._passParameters.opacity=1-e.bindParameters.cloudsFade.fadeInOutHeight.factor),this._passParameters.opacity<=0))return;const a=.35;t=t<.5?dt(0,a,2*t):dt(a,1,2*(t-.5)),this._passParameters.time=(r==="rainy"?this._rainSpeed:this._snowSpeed)*Q$(this._animation.time)%1e5;const o=s.bindTechnique(n,this._passParameters,e.bindParameters);s.bindVAO(this._vao),o.assertCompatibleVertexAttributeLocations(this._vao),FG(s,iE,this._instanceIdBuffer,w6,0),s.capabilities.instancing.drawArraysInstanced(Dt.TRIANGLES,0,3,this._numParticles*t),NG(s,iE,this._instanceIdBuffer,w6)}_ensureResources(e){S(this._vao)&&(this._vao=this._createVertexArrayObject(e)),S(this._instanceIdBuffer)&&(this._instanceIdBuffer=this._createInstanceIndices(e))}_createInstanceIndices(e){const t=[];for(let r=0;r<this._numParticles;r++)t.push(r);return hi.createVertex(e,di.STATIC_DRAW,new Float32Array(t))}_createVertexArrayObject(e){const t=new Float32Array([-1,0,1,1,0,-1,1,0,1]);return new nu(e,iE,{geometry:Wc(Wye)},{geometry:hi.createVertex(e,di.STATIC_DRAW,t)})}};h([p({constructOnly:!0})],Nf.prototype,"context",void 0),h([p({constructOnly:!0})],Nf.prototype,"view",void 0),h([p({readOnly:!0})],Nf.prototype,"updating",null),h([p()],Nf.prototype,"_updatingTracking",void 0),Nf=h([D("esri.views.3d.environment.Precipitation")],Nf);const Wye=sn().vec3f(P.POSITION),w6=Wc(sn().f32(P.INSTANCEFEATUREATTRIBUTE),1),Xye=new Uint8ClampedArray([0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,2,0,0,0,2,0,0,0,2,0,0,0,2,0,0,0,3,0,0,0,3,0,0,0,3,0,0,0,4,0,0,0,4,0,0,0,4,0,0,0,5,0,0,0,5,0,0,0,5,0,0,0,5,0,0,0,5,0,0,0,5,0,0,0,5,0,0,0,6,0,0,0,6,0,0,0,7,0,0,0,7,0,0,0,7,0,0,0,8,0,0,0,8,0,0,0,8,0,0,0,9,0,0,0,9,0,0,0,9,0,0,0,10,0,0,0,10,0,0,0,11,0,0,0,11,0,0,0,11,0,0,0,12,0,0,0,12,0,0,0,12,0,0,0,13,0,0,0,13,0,0,0,14,0,0,0,14,0,0,0,14,0,0,0,14,0,0,0,14,0,0,0,15,0,0,0,15,0,0,0,16,0,0,0,16,0,0,0,16,0,0,0,17,0,0,0,17,0,0,0,18,0,0,0,18,0,0,0,19,0,0,0,19,0,0,0,19,0,0,0,20,0,0,0,20,0,0,0,21,0,0,0,21,0,0,0,22,0,0,0,22,11,0,0,23,11,0,0,23,11,0,0,23,11,0,0,23,11,0,0,24,11,0,0,24,11,0,0,24,10,0,0,25,10,0,0,25,10,0,0,26,10,0,0,26,9,0,0,27,9,0,0,27,9,0,0,28,9,0,0,28,9,0,0,29,9,0,0,29,8,0,0,30,8,0,0,30,8,0,0,31,8,0,0,31,8,0,0,32,8,0,0,32,8,0,0,32,8,0,0,32,8,0,0,33,8,0,0,33,8,0,0,34,7,0,0,35,7,0,0,35,7,0,0,36,7,0,0,36,7,7,0,37,7,7,0,37,7,7,0,38,7,7,0,38,13,7,0,39,13,7,0,39,13,6,0,40,13,6,0,40,12,6,0,41,12,6,0,41,12,6,0,41,12,6,0,42,12,6,0,42,12,6,0,43,12,6,0,43,12,6,0,44,12,6,0,44,11,6,0,45,11,6,6,45,11,6,6,46,11,5,5,47,11,5,5,47,11,5,5,48,11,5,5,48,10,5,5,49,10,5,5,49,10,5,5,50,15,5,5,51,15,5,5,51,15,5,5,51,15,5,5,51,15,5,5,52,15,5,5,52,14,5,5,53,14,5,5,54,14,5,5,54,14,5,5,55,14,5,5,55,14,5,5,56,13,4,4,57,13,4,4,57,13,4,4,58,13,4,4,58,13,4,4,59,13,4,4,59,17,4,4,60,17,4,4,60,17,4,4,60,17,4,4,61,17,4,4,61,16,4,4,62,16,4,4,63,16,4,4,63,16,8,4,64,16,8,4,64,16,8,4,65,15,8,4,66,15,8,4,66,15,8,4,67,19,8,4,68,19,8,4,68,18,7,4,69,18,7,4,69,18,7,4,69,18,7,4,70,18,7,4,70,18,7,4,71,18,7,4,71,18,7,4,72,17,7,3,73,17,7,3,73,21,7,3,74,21,7,3,74,20,7,3,75,20,7,3,76,20,7,3,76,20,7,3,77,20,7,3,77,20,7,3,78,20,7,3,78,20,7,7,78,19,6,6,79,19,10,6,80,19,10,6,80,22,9,6,81,22,9,6,81,22,9,6,82,22,9,6,83,22,9,6,83,21,9,6,84,21,9,6,84,21,9,6,85,21,9,6,86,21,9,6,86,23,9,6,87,23,9,6,87,23,9,6,87,23,9,6,88,23,9,6,88,23,9,6,89,23,8,6,90,23,8,6,90,22,8,6,91,22,8,6,91,25,8,6,92,25,8,5,93,25,8,5,93,24,8,5,94,24,8,5,94,24,11,5,95,24,11,5,96,24,11,5,96,26,11,5,97,26,11,5,97,26,11,5,97,26,10,5,98,26,10,5,98,26,10,5,99,25,10,5,100,25,10,5,100,25,10,5,101,25,10,5,101,25,10,5,102,27,10,5,103,27,10,5,103,27,10,5,104,27,10,5,104,27,12,5,105,26,12,5,106,26,12,5,106,29,12,5,106,29,12,5,106,29,12,7,107,28,12,7,108,28,12,7,108,28,12,7,109,28,12,7,109,30,12,7,110,30,11,7,111,30,11,7,111,30,11,7,112,30,11,7,112,29,11,7,113,29,11,7,114,29,11,7,114,31,11,7,115,31,11,7,115,31,11,7,115,31,11,7,116,31,11,7,116,33,13,7,117,33,13,9,117,32,13,9,118,32,13,9,118,32,13,9,119,34,15,8,120,34,15,8,120,34,15,8,121,36,15,8,121,36,15,8,122,36,15,8,122,35,15,8,123,37,14,8,124,37,14,8,124,37,14,8,124,37,14,8,124,39,14,8,125,39,16,8,125,38,16,8,126,38,16,8,127,38,16,8,127,40,16,10,128,40,16,10,128,40,16,10,129,42,18,10,129,41,18,10,130,41,18,10,130,43,18,10,131,43,18,10,131,42,17,10,132,42,17,12,132,42,17,12,133,44,17,12,133,44,17,12,133,46,17,11,134,46,17,11,134,45,19,11,135,45,19,11,135,47,19,11,136,47,19,11,136,47,19,11,137,47,19,11,137,48,20,11,138,48,20,11,138,50,20,13,139,50,20,13,139,49,20,13,140,49,22,13,140,51,22,13,141,51,22,13,141,50,22,13,142,52,22,13,142,52,21,12,143,53,21,12,143,53,21,12,143,53,21,12,143,53,21,14,144,53,23,14,144,55,23,14,145,55,23,14,145,56,23,14,146,56,23,14,146,57,24,14,147,57,24,14,147,59,24,16,148,59,24,16,148,58,24,15,149,58,26,15,149,58,26,15,149,60,26,15,150,60,26,15,150,61,25,15,151,61,25,15,151,62,25,17,152,62,25,17,152,64,25,17,152,64,27,17,152,63,27,17,153,63,27,17,153,65,27,17,153,66,28,17,154,66,28,17,154,67,28,16,155,67,28,16,155,67,30,16,155,69,29,18,156,69,29,18,156,68,29,18,157,70,29,18,157,70,29,18,157,71,31,18,158,71,31,18,158,72,30,19,159,72,30,19,159,74,30,19,159,73,30,19,160,73,32,19,160,74,32,19,161,74,32,21,161,76,32,21,161,78,33,21,161,78,33,21,161,79,35,20,162,78,34,20,163,79,34,22,164,81,36,22,164,82,36,22,165,81,35,22,166,82,37,21,167,84,37,21,167,85,36,21,168,86,38,23,169,88,38,23,169,88,38,23,170,88,39,23,170,89,39,24,171,91,40,24,171,92,40,24,172,93,40,24,173,94,41,25,173,95,41,25,174,96,42,25,175,98,42,25,175,99,43,26,176,99,43,26,177,101,45,26,177,102,44,26,178,103,46,27,179,104,46,27,179,105,46,27,179,106,45,28,180,108,47,28,180,108,46,28,181,109,48,28,182,111,48,29,182,111,49,29,183,114,49,29,184,114,50,30,184,114,50,30,185,116,51,30,185,117,51,30,186,119,52,31,187,119,53,31,187,121,53,31,188,122,54,33,188,123,54,32,189,124,55,32,189,125,55,32,189,126,56,34,190,128,56,34,190,128,57,33,191,130,57,33,191,131,58,35,192,131,58,35,192,133,59,34,193,134,60,35,194,135,60,35,194,136,61,37,195,139,61,37,195,139,62,36,196,141,62,36,196,141,63,38,197,142,63,38,197,143,64,39,198,144,64,39,198,146,66,39,198,146,67,39,198,147,67,38,199,147,68,40,199,149,68,40,200,150,69,40,200,152,70,41,201,154,71,41,201,154,71,42,202,155,72,42,202,156,73,41,203,157,73,43,203,158,74,42,204,160,75,44,204,161,76,44,204,162,77,44,205,164,77,45,205,165,78,45,206,166,79,45,206,168,80,46,207,169,81,46,207,170,83,47,207,171,83,47,207,172,83,47,207,174,85,48,208,175,85,48,208,177,85,48,209,178,87,49,209,180,87,49,210,181,87,49,210,182,89,50,210,182,89,50,211,185,91,50,211,186,91,51,212,186,93,51,212,189,94,52,212,190,95,51,213,192,96,51,213,193,96,53,213,194,97,52,214,195,98,54,214,197,98,55,215,198,100,55,215,199,101,55,215,200,102,55,216,202,103,55,216,203,104,55,216,204,105,57,216,205,106,57,216,207,107,58,216,208,108,58,217,209,109,59,217,210,110,60,217,211,111,60,218,212,112,61,218,213,113,61,218,214,114,62,219,217,115,63,219,217,116,64,219,218,118,64,220,219,119,65,220,220,121,66,220,222,121,67,221,222,122,67,221,222,123,68,221,223,124,69,222,224,125,70,222,225,127,71,222,226,128,72,223,228,129,73,223,228,130,74,223,229,132,75,223,230,135,79,224,231,138,81,224,233,141,84,224,233,144,87,225,235,147,91,225,236,150,94,225,237,154,97,225,238,158,102,225,239,161,107,225,239,165,110,225,240,168,114,226,241,172,118,226,241,176,122,226,241,181,126,226,242,183,130,227,243,186,135,227,243,190,139,227,244,194,143,227,244,197,147,228,244,200,150,228,245,204,154,228,245,207,157,228,245,210,161,229,246,212,164,229,246,215,167,229,246,217,169,229,246,220,172,230,247,221,174,230]),HT=128,x6=-wL,T6=0,_O=50,Qye=()=>1-511/512,Zye=YS([[50,.1015625],[500,.21875],[5e3,1-250/512],[5e4,.4140625]]);let Yye=class{constructor(e){this.view=e,this.type=In.Simple,this._passParameters=new LN,this._fadeVaoCount=0,this._texV1=1,this._isOnMars=Rx(e.spatialReference);const t=Yt(e.spatialReference);this._planetRadius=t.radius,this._outerRimWidth=t.outerAtmosphereRimWidth,this._innerRimFactor=(this._planetRadius+x6)/this._planetRadius,this._middleRimFactor=(this._planetRadius+T6)/this._planetRadius,this._outerRimFactor=(this._planetRadius+this._outerRimWidth)/this._planetRadius,this._texV0=T6/this._outerRimWidth,this._texVScale=this._texV1-this._texV0}destroy(){this._cameraChangeHandle=Os(this._cameraChangeHandle),this._passParameters.texture=Me(this._passParameters.texture),this._fadeVao=Me(this._fadeVao),this._vao=Me(this._vao)}async initializeRenderContext(e){this._shaderTechniqueRepository=e.shaderTechniqueRepository;const t=e.renderContext.rctx;this._cameraChangeHandle=z(()=>{var n;return(n=this.view.state)==null?void 0:n.camera},()=>e.requestRender(),Oi),this._vao=this._createRibbon(t),this._vaoCount=Ws(this._vao,"geometry"),this._fadeVao=La(t),this._fadeVaoCount=Ws(this._fadeVao,"geometry");const r=this._isOnMars?Xye:MQ;this._passParameters.texture=new Gi(t,{pixelFormat:yt.RGBA,dataType:qt.UNSIGNED_BYTE,wrapMode:si.CLAMP_TO_EDGE,samplingMode:Kt.LINEAR,flipped:!0,width:1,height:512},r),e.requestRender()}get _coneTechnique(){if(S(this._coneTechniqueCached)){const e=new D2;e.geometry=su.Cone,this._coneTechniqueCached=this._shaderTechniqueRepository.acquire(F2,e)}return this._coneTechniqueCached}get _undergroundTechnique(){if(S(this._undergroundTechniqueCached)){const e=new D2;e.geometry=su.Underground,this._undergroundTechniqueCached=this._shaderTechniqueRepository.acquire(F2,e)}return this._undergroundTechniqueCached}render(e){if(S(this._vao)||S(this._passParameters.texture))return;const t=e.bindParameters.camera;this._update(t);const r=e.rctx;this._passParameters.undergroundFadeAlpha<1&&(r.bindTechnique(this._coneTechnique,this._passParameters,e.bindParameters),r.bindVAO(this._vao),r.drawArrays(Dt.TRIANGLES,0,this._vaoCount)),this._passParameters.undergroundFadeAlpha>0&&(r.bindTechnique(this._undergroundTechnique,this._passParameters,e.bindParameters),r.bindVAO(this._fadeVao),r.drawArrays(Dt.TRIANGLE_STRIP,0,this._fadeVaoCount))}renderHaze(){}_update(e){const t=R(),r=this._planetRadius,n=_e(e.eye),s=n-r;if(s<0){const f=Math.min(-s/5e3,1);this._passParameters.undergroundFadeAlpha=f}else this._passParameters.undergroundFadeAlpha=0;const a=Math.max(_O,s),o=r+x6;this._passParameters.innerScale=Kye(r+a,r,o)-1,this._passParameters.altitudeFade=fQ(s),Q(t,e.eye,(r+_O)/n),C6(t,e.center,e.up,r,this._passParameters.silhouette);const l=this._computeScreenRimWidth(e,t,e.up,this._passParameters.silhouette),c=Qye(),u=Zye(s);let d=this._texV0+c*this._texVScale,m=this._texV0+l*u*this._texVScale;if(s>_O){C6(e.eye,e.center,e.up,r,this._passParameters.silhouette);const f=this._computeScreenRimWidth(e,e.eye,e.up,this._passParameters.silhouette),_=ce((f-1.5)/(l-1.5),0,1);d=this._texV0+_*c*this._texVScale,m=this._texV0+dt(this._texV1,l*u,_)*this._texVScale}Je(this._passParameters.texV,d,m)}_createRibbon(e){const t=new Float32Array(3+3*HT*3),r=new Uint32Array(3*HT*5);t[0]=0,t[1]=0,t[2]=-1;for(let a=0;a<HT;a++){const o=9*a+3;t[o+0]=a,t[o+1]=this._innerRimFactor,t[o+2]=-1,t[o+3]=a,t[o+4]=this._middleRimFactor,t[o+5]=0,t[o+6]=a,t[o+7]=this._outerRimFactor,t[o+8]=1;const l=3*a+1,c=a===HT-1?1:l+3,u=15*a;r[u+0]=l,r[u+1]=l+1,r[u+2]=c+1,r[u+3]=c+1,r[u+4]=c,r[u+5]=l,r[u+6]=l+1,r[u+7]=l+2,r[u+8]=c+2,r[u+9]=c+2,r[u+10]=c+1,r[u+11]=l+1,r[u+12]=l,r[u+13]=c,r[u+14]=0}const n=S6.createBuffer(r.length),s=n.position;for(let a=0;a<r.length;++a){const o=3*r[a];s.set(a,0,t[o]),s.set(a,1,t[o+1]),s.set(a,2,t[o+2])}return new nu(e,ai,{geometry:Wc(S6)},{geometry:hi.createVertex(e,di.STATIC_DRAW,n.buffer)})}_computeScreenRimWidth(e,t,r,n){return oe(i1,n.center,n.v2),Q(vO,i1,this._outerRimFactor),vD(yO,t,i1,r),G5(i1,yO,e.projectionMatrix,e.viewport),G5(vO,yO,e.projectionMatrix,e.viewport),Ii(i1,vO)/e.height}};function C6(i,e,t,r,n){const s=_e(i),a=r*Math.sqrt(s*s-r*r)/s,o=Math.sqrt(r*r-a*a),l=n.v1,c=n.v2;return Q(n.center,i,o/s),nt(l,i,e),Ml(l)<1&&nt(l,i,t),Q(l,l,a/_e(l)),nt(c,l,i),Q(c,c,a/_e(c)),a}const yO=ve(),i1=R(),vO=R();function Kye(i,e,t){return i*i/(Math.sqrt(i*i-e*e)*Math.sqrt(i*i-t*t)+e*t)}const S6=sn().vec3f(P.POSITION);let DQ=class FQ extends ti{initializeProgram(e){return new Jt(e.rctx,FQ.shader.get().build(this.configuration),ai)}initializePipeline(){return Ke({blending:Gn(de.ONE,de.ZERO,de.ONE_MINUS_SRC_COLOR,de.ONE),colorWrite:ht})}};DQ.shader=new ii(EQ,()=>G(()=>import("./FogHaze.glsl-ea6aef58.js"),["assets/FogHaze.glsl-ea6aef58.js","assets/mat4-44a0988f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/mat4f64-1e28eae0.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/vec3-e93e648f.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/FloatPassUniform-68d54f51.js","assets/vec4-790471c0.js","assets/vec4f64-e407da96.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/vec3f32-c9aa289f.js","assets/compilerUtils-18d58939.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));const Jye=.7,e0e=1;let hb=class extends ue{constructor(e){super(e),this._passParameters=new MN;const t=e.context.renderContext.rctx;this._vao=La(t,kx);const r=Yt(e.view.spatialReference);this._planetRadius=r.radius,this._atmosphereRadius=r.radius+rx}destroy(){this._hazeTechniqueCached=Qi(this._hazeTechniqueCached),this._vao=Me(this._vao)}get _shaderTechniqueRepository(){return this.context.shaderTechniqueRepository}set strength(e){this._passParameters.hazeStrength=e}get strength(){return this._passParameters.hazeStrength}get _hazeTechnique(){if(S(this._hazeTechniqueCached)){const e=new IN;e.haze=!0,this._hazeTechniqueCached=this._shaderTechniqueRepository.acquire(DQ,e)}return this._hazeTechniqueCached}render(e,t){if(this.view.basemapTerrain.baseOpacity===0||(this._update(e,t),this._passParameters.hazeAmount<=0))return;const r=this._hazeTechnique;if(!r.compiled)return void this.context.requestRender();const n=e.offscreenRenderingHelper;n.renderDepthDetached(()=>{this._passParameters.depthTexture=n.depthTexture;const s=e.rctx.bindTechnique(r,this._passParameters,e.bindParameters);this._renderSimpleHaze(s,e)})}_renderSimpleHaze(e,t){if(S(this._vao))return;const r=t.rctx;r.bindVAO(this._vao),e.assertCompatibleVertexAttributeLocations(this._vao),r.drawArrays(Dt.TRIANGLE_STRIP,0,4)}_update(e,t){const r=e.bindParameters.camera;he(E6,r.eye);const n=Math.max(0,me(E6,e.bindParameters.lighting.mainLight.direction)),s=i0e;Q(P6,s,0),Bn(this._passParameters.hazeColor,P6,s,n);const a=_e(r.eye),o=a*a;this._passParameters.atmosphereC=o-this._atmosphereRadius*this._atmosphereRadius,this._passParameters.hazeAmount=(1-U0(Jye*Cl,e0e*Cl,Math.abs(a-this._planetRadius)))*t.amount,this._passParameters.fogStrength=t.strength}static isSupported(e){return e.capabilities.depthTexture}};h([p({constructOnly:!0})],hb.prototype,"context",void 0),h([p({constructOnly:!0})],hb.prototype,"view",void 0),hb=h([D("esri.views.3d.environment.SimpleHaze")],hb);let t0e=class{constructor(){this.strength=0,this.amount=0}};const i0e=Ge(.24,.44,.8),E6=R(),P6=R();function r0e(){const i=new Yi;return i.attributes.add(P.POSITION,"vec3"),i.attributes.add(P.COLOR,"vec4"),i.attributes.add(P.SIZE,"float"),i.varyings.add("vcolor","vec4"),i.varyings.add("vsize","float"),i.vertex.uniforms.add([new Ys("transform",(e,t)=>n0e(e,t)),new Xh("viewport",(e,t)=>t.camera.fullViewport),new Tt("pixelRatio",(e,t)=>t.camera.pixelRatio)]),i.include(Tne),i.vertex.code.add(O`void main(void) {
vec4 posProj = transform * vec4(position, 0);
gl_Position = alignToPixelCenter(posProj, viewport.zw);
vcolor = color / 1.2;
vsize = size * 5.0 * pixelRatio;
gl_PointSize = vsize;
}`),i.fragment.code.add(O`void main() {
float cap = 0.7;
float scale = 1.0 / cap;
float helper = clamp(length(abs(gl_PointCoord - vec2(0.5))), 0.0, cap);
float alpha = clamp((cap - helper) * scale, 0.0, 1.0);
float intensity = alpha * alpha * alpha;
if (vsize < 3.0) {
intensity *= 0.5;
}
gl_FragColor = vec4(vcolor.xyz, intensity);
}`),i}function n0e(i,e){return pn(Kd,e.camera.projectionMatrix),Kd[10]=24e-8-1,Kd[11]=-1,Kd[14]=(24e-8-2)*e.camera.near,Hr(Kd,Kd,e.camera.viewMatrix),Hr(Kd,Kd,i.modelMatrix)}const Kd=ve(),s0e=Object.freeze(Object.defineProperty({__proto__:null,build:r0e},Symbol.toStringTag,{value:"Module"}));let a0e=class extends Ir{constructor(){super(...arguments),this.modelMatrix=ve()}},NQ=class kQ extends ti{constructor(e){super(e,new $a,()=>this.destroy())}initializeProgram(e){return new Jt(e.rctx,kQ.shader.get().build(),ai)}initializePipeline(){return Ke({blending:Gn(de.SRC_ALPHA,de.ONE,de.ONE_MINUS_SRC_ALPHA,de.ONE_MINUS_SRC_ALPHA),depthTest:{func:hs.LEQUAL},colorWrite:ht})}};NQ.shader=new ii(s0e,()=>G(()=>import("./Stars.glsl-facc3b97.js"),["assets/Stars.glsl-facc3b97.js","assets/mat4-44a0988f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/mat4f64-1e28eae0.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/VertexAttribute-9c5c630d.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));let Lp=class extends ue{constructor(e){super(e),this._loadDataTask=null,this._numPoints=0,this._renderParameter=new a0e,this._updatingTracking=new mv}get updating(){return this._updatingTracking.updating||this.loading}get loading(){return y(this._loadDataTask)&&!this._loadDataTask.finished}initialize(){this._loadDataTask=this._createLoadDataTask()}destroy(){this._loadDataTask=iu(this._loadDataTask),this._updatingTracking.destroy(),this._numPoints=0,this._technique=Qi(this._technique),this._vao=Me(this._vao)}render(e){const{rctx:t}=e;if(this._ensureResources(t),S(this._technique)||S(this._vao))return;if(!this._technique.compiled)return void this.requestRender();const r=t.bindTechnique(this._technique,this._renderParameter,e.bindParameters);t.bindVAO(this._vao),r.assertCompatibleVertexAttributeLocations(this._vao),t.drawArrays(Dt.POINTS,0,this._numPoints)}_ensureResources(e){if(y(this._technique)||S(A_))return;this._technique=new NQ({rctx:e,viewingMode:this.view.state.viewingMode}),this._numPoints=A_.byteLength/R6;const t=new Float32Array(A_,0,2*this._numPoints),r=new Uint8Array(A_,2*this._numPoints*4,this._numPoints);this._vao=this._createVertexArrayObject(e,t,r,this._numPoints),this._updatingTracking.add(()=>this.view.environment.lighting.type!=="virtual"?this.view.environment.lighting.date:null,n=>this._update(n),Qe)}_computeDayDuration(e){const t=e,r=new Date(e.getFullYear(),0,1,11,58,56);return(+t-+r)/(+new Date(e.getFullYear()+1,0,1,11,58,55)-+r)}_update(e){if(!e)return;const t=(e.getHours()/12+e.getMinutes()/60*(2/24)+e.getSeconds()/60*(2/1440)-.9972222)%2,r=2*this._computeDayDuration(e),n=pn(this._renderParameter.modelMatrix,c0e);vw(n,n,-r*Math.PI),Hr(n,l0e,n),vw(n,n,-t*Math.PI),this.requestRender()}_hexToRGB(e){return[parseInt(e.substring(0,2),16),parseInt(e.substring(2,4),16),parseInt(e.substring(4,6),16)]}_unpackUint8Attributes(e){return e>=192?[2.9,e-192]:e>=160?[2.5,e-160]:e>=128?[2,e-128]:e>=96?[1.5,e-96]:e>=64?[1,e-64]:e>=32?[.7,e-32]:[.4,e]}_createVertexArrayObject(e,t,r,n){const s=A6.createBuffer(n),a=s.position,o=s.color,l=s.size;for(let c=0;c<n;c++){const u=t[2*c+0],d=t[2*c+1];a.set(c,0,-Math.cos(u)*Math.sin(d)),a.set(c,1,-Math.sin(u)*Math.sin(d)),a.set(c,2,-Math.cos(d));const m=this._unpackUint8Attributes(r[c]),f=this._hexToRGB(o0e[m[1]]);o.set(c,0,255*f[0]),o.set(c,1,255*f[1]),o.set(c,2,255*f[2]),o.set(c,3,255),l.set(c,m[0])}return new nu(e,ai,{geometry:Wc(A6)},{geometry:hi.createVertex(e,di.STATIC_DRAW,s.buffer)})}_createLoadDataTask(){if(y(A_))return null;const e=Dx(async t=>{const{data:r}=await zte("esri/views/3d/environment/resources/stars.wsv",{responseType:"array-buffer",signal:t});this._verifyStarData(r),A_=r});return e.promise.catch(t=>{yo(t)||J.getLogger(this.declaredClass).error(t)}).then(()=>{this.destroyed||(this.requestRender(),this.notifyChange("updating"))}),e}_verifyStarData(e){if(!e)throw new K("stars:no-data-received","Failed to create stars because star catalogue is missing");const t=e.byteLength/R6;if(t%1!=0||t>5e4||t<5e3)throw new K("stars:invalid-data","Failed to create stars because star catalogue data is invalid")}};h([p({constructOnly:!0})],Lp.prototype,"view",void 0),h([p({constructOnly:!0})],Lp.prototype,"requestRender",void 0),h([p({readOnly:!0})],Lp.prototype,"updating",null),h([p()],Lp.prototype,"_loadDataTask",void 0),h([p()],Lp.prototype,"_updatingTracking",void 0),Lp=h([D("esri.views.3d.environment.Stars")],Lp);const o0e=["9bb2ff","9eb5ff","aabfff","bbccff","ccd8ff ","dae2ff","e4e9ff","eeefff","f8f6ff","fff9fb","fff5ef","fff1e5","ffeddb","ffe9d2","ffe6ca","ffe3c3","ffe0bb","ffddb4","ffdaad","ffd6a5","ffd29c","ffcc8f","ffc178","ffa94b","ff7b00"],l0e=hG(1,0,0,0,0,.9174771405229186,.39778850739794974,0,0,-.39778850739794974,.9174771405229186,0,0,0,0,1),c0e=hG(1,0,0,0,0,.9174771405229186,-.39778850739794974,0,0,.39778850739794974,.9174771405229186,0,0,0,0,1),R6=9,A6=sn().vec3f(P.POSITION).vec4u8(P.COLOR).f32(P.SIZE);let A_=null;function h0e(i,e,t){const r=i.parallax.anchorPointClouds;i.fadeIn.stage===Ih.FINISHED&&(i.fadeIn.factor=0,q(r,Vh),i.fadeIn.stage=Ih.CHANGE_ANCHOR,i.crossFade.enabled=!1,i.fadeInOut.stage=ba.FINISHED),i.fadeIn.stage===Ih.CHANGE_ANCHOR&&i.isCameraPositionFinal&&(RD(i.data)&&i.renderingStage!==Kr.RENDERING||i.renderingStage===Kr.FADING_TEXTURE_CHANNELS)&&(q(r,Vh),i.fadeIn.stage=Ih.FADE_IN,i.startTime=e,i.renderingStage===Kr.FADING_TEXTURE_CHANNELS&&(i.renderingStage=Kr.SWITCH_CHANNELS)),i.fadeIn.factor<1&&i.fadeIn.stage===Ih.FADE_IN?i.fadeIn.factor=t?ce((e-i.startTime)/(VQ*t),0,1):1:i.fadeIn.factor>=1&&i.fadeIn.stage===Ih.FADE_IN&&(i.fadeIn.stage=Ih.FINISHED,i.fadeIn.factor=1)}function u0e(i,e,t){const{fadeInOut:r,crossFade:n}=i;r.stage===ba.FINISHED&&(i.startTime=e,r.factor=1,r.stage=ba.FADE_OUT),r.factor>0&&r.stage===ba.FADE_OUT?r.factor=t?1-ce((e-i.startTime)/(g0e*t),0,1):0:(r.factor<=0&&r.stage===ba.FADE_OUT&&(r.factor=0,q(i.parallax.anchorPointClouds,Vh)),r.factor<=0&&r.stage===ba.FADE_OUT&&i.isCameraPositionFinal&&(r.factor=0,r.stage=ba.SWITCH,i.crossFade.enabled=!1,n.factor=1),r.stage===ba.SWITCH&&(RD(i.data)&&i.renderingStage!==Kr.RENDERING||i.renderingStage===Kr.FADING_TEXTURE_CHANNELS)&&(i.startTime=e,r.factor=0,r.stage=ba.FADE_IN,q(i.parallax.anchorPointClouds,Vh),i.crossFade.enabled=!1,n.factor=1,i.renderingStage===Kr.FADING_TEXTURE_CHANNELS&&(i.renderingStage=Kr.SWITCH_CHANNELS)),r.factor<1&&r.stage===ba.FADE_IN?r.factor=t?ce((e-i.startTime)/(VQ*t),0,1):1:r.factor>=1&&r.stage===ba.FADE_IN&&(r.stage=ba.FINISHED,r.factor=1))}function d0e(i,e,t,r){const{crossFade:n}=i,s=i.parallax.anchorPointClouds;i.crossFade.enabled&&!r||(q(i.parallaxNew.anchorPointClouds,Vh),i.startTime=e,n.factor=0,i.crossFade.enabled=!0),n.factor<1&&i.crossFade.enabled?n.factor=t?ce((e-i.startTime)/(_0e*t),0,1):1:n.factor>=1&&i.crossFade.enabled&&(i.crossFade.enabled=!1,n.factor=1,q(s,i.parallaxNew.anchorPointClouds),i.renderingStage===Kr.FADING_TEXTURE_CHANNELS&&(i.renderingStage=Kr.SWITCH_CHANNELS))}function O6(i,e,t,r){const n=i.fadeInOutHeight,s=n.stage===FE.FINISHED?t:i.startTimeHeightFade;if(r!==0){const a=(t-s)/(y0e*r);n.factor+=e?-a:a}else n.factor=e?0:1;i.startTimeHeightFade=t,n.factor=ce(n.factor,0,1),n.stage=FE.HEIGHT_FADE}function p0e(i,e,t,r,n){i.renderingStage===Kr.FINISHED_RENDERING&&(i.renderingStage=Kr.FADING_TEXTURE_CHANNELS);const s=_e(e.eye);i.fadeInOutHeight.factor<0&&(i.fadeInOutHeight.factor=s-lo.radius>Cl?1:0),i.isCameraPositionFinal=Rg(i.cameraPositionLastFrame,e.eye),he(Vh,e.eye),Q(Vh,Vh,lo.radius);const a=i.parallax;a.anchorPointClouds[0]===0&&a.anchorPointClouds[1]===0&&a.anchorPointClouds[2]===0&&q(a.anchorPointClouds,Vh);const o=_e(ne(f0e,a.anchorPointClouds,Vh));let l=!0;o>i.fadeIn.distanceThresholdFactor*a.cloudsHeight||i.fadeIn.stage!==Ih.FINISHED?h0e(i,r,n):o>i.fadeInOut.distanceThresholdFactor*a.cloudsHeight||i.fadeInOut.stage!==ba.FINISHED?u0e(i,r,n):o>i.crossFade.distanceThresholdFactor*a.cloudsHeight||i.crossFade.enabled||i.renderingStage===Kr.FADING_TEXTURE_CHANNELS?d0e(i,r,n,(t!==Fh.IDLE||!RD(i.data))&&i.renderingStage!==Kr.FADING_TEXTURE_CHANNELS):l=!1;const c=s-lo.radius;if((c>1.7*Cl||c<-Cl)&&i.fadeInOutHeight.factor<1?i.fadeInOutHeight.factor=1:(c>Cl||c<-.35*Cl)&&i.fadeInOutHeight.factor<1?O6(i,!1,r,n):c<Cl&&c>-.35*Cl&&i.fadeInOutHeight.factor>0?O6(i,!0,r,n):i.fadeInOutHeight.stage=FE.FINISHED,i.renderingStage===Kr.SWITCH_CHANNELS&&(i.readChannels=1-i.readChannels,i.renderingStage=Kr.FINISHED),a.radiusCurvatureCorrectionFactor=.84*Math.sqrt(Math.max(s*s-lo.radius*lo.radius,0))/s,H5(M6,a.anchorPointClouds,O_),kl(a.transform,rn,O_[3],j5(O_)),l){const{parallaxNew:u}=i;H5(M6,u.anchorPointClouds,O_),kl(u.transform,rn,O_[3],j5(O_))}q(i.cameraPositionLastFrame,e.eye)}function m0e(i){return i.crossFade.enabled||i.fadeInOut.stage!==ba.FINISHED||i.fadeIn.stage!==Ih.FINISHED||i.fadeInOutHeight.stage!==FE.FINISHED||i.renderingStage!==Kr.FINISHED}const M6=Ge(0,0,1),O_=Jne(),Vh=R(),f0e=R(),VQ=1,g0e=.5,_0e=1.3,y0e=1;var $0;(function(i){i[i.Immediate=0]="Immediate",i[i.Faded=1]="Faded"})($0||($0={}));var Ry;const v0e=[ae.POSTPROCESSING_ENVIRONMENT_OPAQUE,ae.POSTPROCESSING_ENVIRONMENT_TRANSPARENT];let gs=Ry=class extends ue{constructor(i){super(i),this._handles=new Ft,this._context=null,this._atmosphere=null,this._oldWeatherParameters=new bO,this._newWeatherParameters=new bO,this._fadedWeatherParameters=new bO,this._weatherParameters=this._newWeatherParameters}initialize(){this.view._stage.addRenderPlugin(v0e,this)}destroy(){var i;((i=this.view)==null?void 0:i._stage)!=null&&this.view._stage.removeRenderPlugin(this),this._handles=Te(this._handles),this._set("view",null)}get atmosphereType(){return y(this._atmosphere)?this._atmosphere.type:In.None}get canRender(){var i;return!!((i=this.view.basemapTerrain)!=null&&i.renderer.canRender)||this.view.viewingMode!=="global"}get needsLinearDepth(){return y(this._atmosphere)&&this._atmosphere.type===In.Realistic}updateAnimation(i){return!!y(this._precipitation)&&this._precipitation.update(i)}get updating(){return y(this._stars)&&this._stars.updating||y(this._clouds)&&this._clouds.running}get weatherVisible(){return _e(this.view.state.camera.eye)-Yt(this.view.spatialReference).radius<=Cl}get _stars(){var r;const i=this.view,e=((r=i.environment)==null?void 0:r.starsEnabled)??!1,t=this._get("_stars");return!e||S(this._context)?(Te(t),null):y(t)?t:new Lp({view:i,requestRender:()=>this._setNeedsRender()})}get _precipitation(){const i=this._get("_precipitation");if(!this._precipitationEnabled||S(this._context))return Te(i),null;const e=this.view,t=this._context;return y(i)&&i.context===t?i:(Te(i),new Nf({context:t,view:e}))}get _clouds(){const i=this._get("_clouds");if(!this.weatherEnabled||S(this._context))return Te(i),null;if(y(i))return i;const e=this.view,t=this._context;return Te(i),new pa({context:t,view:e,requestRender:()=>this._setNeedsRender()})}get _cloudsComposition(){const i=this._get("_cloudsComposition");if(!this.weatherEnabled||S(this._context))return Te(i),null;const e=this.view.state.viewingMode,t=this._context.renderContext.rctx,r=Yt(this.view.spatialReference).radius;return y(i)&&i.viewingMode===e&&i.planetRadius===r?i:(Te(i),new Ff({rctx:t,viewingMode:e,planetRadius:r,requestRender:()=>this._setNeedsRender()}))}get _fog(){const i=this._get("_fog");if(!this.weatherEnabled||S(this._context))return Te(i),null;if(y(i))return i;const e=this.view,t=this._context;return new cb({context:t,view:e})}get _simpleHaze(){const i=this._get("_simpleHaze");if(!this.weatherEnabled||S(this._context))return Te(i),null;if(y(i))return i;const e=this.view,t=this._context;return new hb({context:t,view:e})}get weatherEnabled(){var i,e;return!!((e=(i=this.view)==null?void 0:i.environmentManager)!=null&&e.weatherEnabled)}get _precipitationEnabled(){return this.weatherEnabled&&(this.view.environment.weather.type==="rainy"||this.view.environment.weather.type==="snowy")}initializeRenderContext(i=null){this._context=i;const e=()=>this._setNeedsRender();this._handles.add([cs(()=>{var t;return(t=this.view)==null?void 0:t.basemapTerrain},()=>this._updateBasemapTerrain(),Oi),z(()=>({viewingMode:this.view.viewingMode,atmosphereEnabled:this.view.environment.atmosphereEnabled,atmosphereQuality:this.view.environment.atmosphere.quality}),()=>this._updateAtmosphere(),Oi),z(()=>this._stars,e),z(()=>this._precipitation,e),z(()=>this._clouds,()=>this._updateWeather(),Qe),z(()=>this._fog,()=>this._updateFogHaze(),Qe),z(()=>this._simpleHaze,()=>this._updateFogHaze(),Qe),z(()=>this._weatherUpdateParameters,()=>{this._updateWeather(),this._updateFogHaze()},Oi)])}uninitializeRenderContext(){this._context=null,this._atmosphere=Te(this._atmosphere),this._set("_stars",Te(this._stars)),this._set("_precipitation",Te(this._precipitation)),this._set("_clouds",Te(this._clouds)),this._set("_cloudsComposition",Te(this._cloudsComposition)),this._set("_fog",Te(this._fog)),this._set("_simpleHaze",Te(this._simpleHaze))}prepareRender(i){i.bindParameters.cloudsFade.data=Gre(this._clouds)?this._clouds:null,this.view.viewingMode!=="local"&&(p0e(i.bindParameters.cloudsFade,i.bindParameters.camera,this.view.state.mode,Ry.test.time||i.time,this.view.qualitySettings.weatherFadeDuration),this._updateWeatherFading(i.bindParameters),i.bindParameters.cloudsFade.renderingStage===Kr.FINISHED&&y(this._clouds)&&this._clouds.coverage===0&&this._clouds.running===!1&&this._clouds.destroyFrameBufferCube())}render(i){if(i.output===k.Color)switch(i.bindParameters.slot){case ae.POSTPROCESSING_ENVIRONMENT_OPAQUE:y(this._stars)&&this._stars.render(i),y(this._atmosphere)&&(this._atmosphere.render(i),y(this._cloudsComposition)&&y(i.bindParameters.cloudsFade.data)&&(this.weatherVisible&&y(this._clouds)&&this._clouds.updateWeatherTile(),this._cloudsComposition.render(i)),m0e(i.bindParameters.cloudsFade)&&y(this._context)&&this._context.requestRender());break;case ae.POSTPROCESSING_ENVIRONMENT_TRANSPARENT:if(y(this._atmosphere)&&(this._atmosphere.renderHaze(i,this._weatherParameters.haze.amount),this._weatherParameters.haze.amount>0&&this._selectAtmosphereType()!==In.Realistic&&y(this._simpleHaze)&&this._simpleHaze.render(i,this._weatherParameters.haze),this._weatherParameters.fog.amount>0&&y(this._fog)&&this._fog.render(i,this._weatherParameters.fog),y(this._precipitation))){const e=this.view.environment.weather;e.type!=="rainy"&&e.type!=="snowy"||this._precipitation.render(i,e.precipitation,e.type)}}}updateLightSources(i,e,t,r){if(y(this._context)){const n=this._context.renderContext;n.bindParameters.oldLighting.copyFrom(n.bindParameters.lighting),n.bindParameters.newLighting.noonFactor=e,n.bindParameters.newLighting.globalFactor=t,n.bindParameters.newLighting.set(i),r===$0.Faded||n.bindParameters.weatherFading?n.bindParameters.fadeLighting(0):n.bindParameters.fadeLighting(1),this._context.requestRender()}}get _weatherUpdateParameters(){const i=this.weatherEnabled?this.view.environment.weather:null;return S(i)?null:i.type==="rainy"||i.type==="snowy"?{type:i.type,weatherAdjustment:i.cloudCover,effect:i.precipitation}:{type:i.type,weatherAdjustment:i.type==="foggy"?i.fogStrength:i.cloudCover}}_updateWeatherFading(i){if(!i.weatherFading)return;const e=i.cloudsFade;return e.fadeIn.stage===Ih.FADE_IN?(i.fadeLighting(e.fadeIn.factor),void this._fadeWeather(e.fadeIn.factor)):e.fadeInOut.stage===ba.FADE_IN?(i.fadeLighting(e.fadeInOut.factor),void this._fadeWeather(e.fadeInOut.factor)):e.crossFade.enabled?(i.fadeLighting(e.crossFade.factor),void this._fadeWeather(e.crossFade.factor)):(i.fadeLighting(0),void this._fadeWeather(0))}_fadeWeather(i){const{_newWeatherParameters:e,_oldWeatherParameters:t}=this;i>=1?this._weatherParameters=e:(this._fadedWeatherParameters.lerp(t,e,i),this._weatherParameters=this._fadedWeatherParameters)}_updateWeather(){const i=this._weatherUpdateParameters;S(i)||S(this._clouds)||(this._clouds.applyPreset(ys[i.type],i.weatherAdjustment),this._setNeedsRender())}_setNeedsRender(){y(this._context)&&this._context.requestRender()}_updateFogHaze(){const i=this._weatherUpdateParameters;if(S(this._fog)||S(this._simpleHaze)||S(i)||S(this._context))return;const e=this._context.renderContext.bindParameters;switch(this._oldWeatherParameters.copyFrom(this._weatherParameters),i.type){case"foggy":this._newWeatherParameters.fog.strength=dt(3e-5,.005,i.weatherAdjustment**3),q(this._newWeatherParameters.fog.color,I6),this._newWeatherParameters.fog.amount=1,this._newWeatherParameters.haze.strength=0,this._newWeatherParameters.haze.amount=this._selectAtmosphereType()===In.Realistic?1:0,this._setNeedsRender();break;case"rainy":this._newWeatherParameters.fog.strength=dt(4e-6,2e-4,i.effect**3),q(this._newWeatherParameters.fog.color,b0e),this._newWeatherParameters.fog.amount=1,this._newWeatherParameters.haze.strength=0,this._newWeatherParameters.haze.amount=0,this._setNeedsRender();break;case"snowy":this._newWeatherParameters.fog.strength=dt(4e-6,2e-4,i.effect**3),q(this._newWeatherParameters.fog.color,I6),this._newWeatherParameters.fog.amount=1,this._newWeatherParameters.haze.strength=0,this._newWeatherParameters.haze.amount=this._selectAtmosphereType()===In.Realistic?1:0,this._setNeedsRender();break;default:this._newWeatherParameters.fog.strength=0,this._newWeatherParameters.fog.amount=0,this._newWeatherParameters.haze.strength=4e-6,this._newWeatherParameters.haze.amount=1,this._setNeedsRender()}e.weatherFading?this._fadeWeather(0):this._fadeWeather(1)}_updateAtmosphere(){const i=this._selectAtmosphereType();if(this.atmosphereType===i)return;const e=this._getAtmosphereClass();if(!e)return y(this._atmosphere)&&(this._atmosphere.destroy(),this._atmosphere=null,this._setNeedsRender()),void this._updateBasemapTerrain();y(this._context)&&(Te(this._atmosphere),this._atmosphere=new e(this.view),this._atmosphere.initializeRenderContext(this._context),this._setNeedsRender(),this._updateBasemapTerrain())}_getAtmosphereClass(){switch(this._selectAtmosphereType()){case In.None:return null;case In.Realistic:return d6;case In.Panoramic:return Nye;case In.Simple:return Yye;default:return}}_selectAtmosphereType(){const i=this.view.get("environment.atmosphereEnabled"),e=this.view.get("environment.atmosphere.quality"),t=this.view.viewingMode;return!i||e==null||Ax(this.view.spatialReference)?In.None:t==="local"?In.Panoramic:e==="high"&&y(this._context)&&d6.isSupported(this._context)&&PE(this.view.spatialReference)?In.Realistic:In.Simple}_updateBasemapTerrain(){this.view.basemapTerrain&&(this.view.basemapTerrain.velvetOverground=y(this._atmosphere)&&this.atmosphereType===In.Simple)}get test(){return{atmosphere:this._atmosphere,clouds:this._clouds,selectAtmosphereType:()=>this._selectAtmosphereType(),stubGetAtmosphereClass:i=>{L6=Ry.prototype._getAtmosphereClass,Ry.prototype._getAtmosphereClass=i},restoreGetAtmosphereClass:()=>{Ry.prototype._getAtmosphereClass=L6}}}};gs.test={time:Rt(0)},h([p({constructOnly:!0})],gs.prototype,"view",void 0),h([p({type:Boolean,readOnly:!0})],gs.prototype,"updating",null),h([p({readOnly:!0})],gs.prototype,"weatherVisible",null),h([p()],gs.prototype,"_context",void 0),h([p({readOnly:!0})],gs.prototype,"_stars",null),h([p({readOnly:!0})],gs.prototype,"_precipitation",null),h([p({readOnly:!0})],gs.prototype,"_clouds",null),h([p({readOnly:!0})],gs.prototype,"_cloudsComposition",null),h([p({readOnly:!0})],gs.prototype,"_fog",null),h([p({readOnly:!0})],gs.prototype,"_simpleHaze",null),h([p({readOnly:!0})],gs.prototype,"weatherEnabled",null),h([p({readOnly:!0})],gs.prototype,"_precipitationEnabled",null),h([p({readOnly:!0})],gs.prototype,"_weatherUpdateParameters",null),gs=Ry=h([D("esri.views.3d.environment.EnvironmentRenderer")],gs);let bO=class{constructor(){this.fog=new Rye,this.haze=new t0e}copyFrom(e){this.fog.amount=e.fog.amount,this.haze.amount=e.haze.amount,this.fog.strength=e.fog.strength,this.haze.strength=e.haze.strength,q(this.fog.color,e.fog.color)}lerp(e,t,r){this.fog.amount=dt(e.fog.amount,t.fog.amount,r),this.haze.amount=dt(e.haze.amount,t.haze.amount,r),this.fog.strength=dt(e.fog.strength,t.fog.strength,r),this.haze.strength=dt(e.haze.strength,t.haze.strength,r),Bn(this.fog.color,e.fog.color,t.fog.color,r)}};const b0e=Ge(.5,.5,.5),I6=Ge(1.5,1.5,1.5);let L6;function $6(i,e,t){if(S(e.longitude)||S(e.latitude)||S(t.longitude)||S(t.latitude))throw new Error("Invalid points: no lon/lat");return w0e(i,e.longitude,e.latitude,t.longitude,t.latitude)}function w0e(i,e,t,r,n){const s=Ct(t),a=Ct(n),o=s-a,l=Ct(e)-Ct(r),c=Math.sin(o/2),u=Math.sin(l/2),d=2*tu(Math.sqrt(c*c+Math.cos(s)*Math.cos(a)*u*u))*i;return Math.round(1e4*d)/1e4}function x0e(i,e,t){const r=e.spatialReference,n=Yt(r),s=new Ne(e.x,i.y,r),a=new Ne(t.x,i.y,r),o=new Ne(i.x,e.y,r),l=new Ne(i.x,t.y,r);return{lon:$6(n.radius,s,a),lat:$6(n.radius,o,l)}}function T0e(i,e,t){const r=e/t,n=Ct(i),s=Math.sin(r/2),a=Math.cos(n),o=2*tu(Math.sqrt(s*s/(a*a)));return _o(o)}function C0e(i,e){let t=i/15;return e||(t=Math.round(t)),t}function D6(i,e){e||(e={hours:0,minutes:0,seconds:0}),e.hours=C0e(i[0],!0);const t=e.hours%1;e.hours-=t,e.minutes=60*t;const r=e.minutes%1;return e.minutes-=r,e.seconds=Math.round(60*r),e}var F6,N6,k6,UQ={exports:{}};F6=UQ,N6=function(){var i=Math.PI,e=Math.sin,t=Math.cos,r=Math.tan,n=Math.asin,s=Math.atan2,a=Math.acos,o=i/180,l=864e5,c=2440588,u=2451545,d={dec:0,ra:0};function m(X){return X.valueOf()/l-.5+c}function f(X){return new Date((X+.5-c)*l)}function _(X){return m(X)-u}var g=23.4397*o;function x(X,$){return s(e(X)*t(g)-r($)*e(g),t(X))}function b(X,$){return n(e($)*t(g)+t($)*e(g)*e(X))}function v(X,$,B){return s(e(X),t(X)*e($)-r(B)*t($))}function w(X,$,B){return n(e($)*e(B)+t($)*t(B)*t(X))}function T(X,$){return o*(280.16+360.9856235*X)-$}function E(X){return o*(357.5291+.98560028*X)}function C(X){return o*(1.9148*e(X)+.02*e(2*X)+3e-4*e(3*X))}function A(X,$){return X+$+102.9372*o+i}function M(X,$){var B=E(X),W=A(B,C(B));return $||($={dec:0,ra:0}),$.dec=b(W,0),$.ra=x(W,0),$}var I={PolarException:{NORMAL:0,MIDNIGHT_SUN:1,POLAR_NIGHT:2},getPosition:function(X,$,B,W){var te=o*-B,ie=o*$,Y=_(X),se=M(Y,d),Ee=T(Y,te)-se.ra;return W||(W={azimuth:0,altitude:0}),W.azimuth=v(Ee,ie,se.dec),W.altitude=w(Ee,ie,se.dec),W}},L=[[-.83,"sunrise","sunset"]];I.addTime=function(X,$,B){L.push([X,$,B])};var U=9e-4;function j(X,$){return Math.round(X-U-$/(2*i))}function re(X,$,B){return U+(X+$)/(2*i)+B}function ee(X,$,B){return u+X+.0053*e($)-.0069*e(2*B)}function H(X,$,B){return a((e(X)-e($)*e(B))/(t($)*t(B)))}function V(X){var $=o*(134.963+13.064993*X),B=o*(93.272+13.22935*X),W=o*(218.316+13.176396*X)+6.289*o*e($),te=5.128*o*e(B),ie=385001-20905*t($);return{ra:x(W,te),dec:b(W,te),dist:ie}}return I.getTimes=function(X,$,B){var W=o*-B,te=o*$,ie=j(_(X),W),Y=re(0,W,ie),se=E(Y),Ee=C(se),Re=A(se,Ee),Ie=b(Re,0),Ue=ee(Y,se,Re);function ye(ft){return ee(re(H(ft,te,Ie),W,ie),se,Re)}function we(ft){var Et=(e(ft)-e(te)*e(Ie))/(t(te)*t(Ie));return Et<-1?I.PolarException.MIDNIGHT_SUN:Et>1?I.PolarException.POLAR_NIGHT:I.PolarException.NORMAL}var $e,st,vt,Ot,Ve,De={solarNoon:f(Ue),nadir:f(Ue-.5),polarException:I.PolarException.NORMAL};for($e=0,st=L.length;$e<st;$e+=1)Ve=Ue-((Ot=ye((vt=L[$e])[0]*o))-Ue),De[vt[1]]=f(Ve),De[vt[2]]=f(Ot);return De.polarException=we(L[0][0]*o),De},I.getMoonPosition=function(X,$,B){var W=o*-B,te=o*$,ie=_(X),Y=V(ie),se=T(ie,W)-Y.ra,Ee=w(se,te,Y.dec);return Ee+=.017*o/r(Ee+10.26*o/(Ee+5.1*o)),{azimuth:v(se,te,Y.dec),altitude:Ee,distance:Y.dist}},I.getMoonFraction=function(X){var $=_(X),B=M($),W=V($),te=149598e3,ie=a(e(B.dec)*e(W.dec)+t(B.dec)*t(W.dec)*t(B.ra-W.ra)),Y=s(te*e(ie),W.dist-te*t(ie));return(1+t(Y))/2},I},(k6=N6())!==void 0&&(F6.exports=k6);const Bg=UQ.exports,Lh={local:{altitude:1500,ambientAtNight:.1,ambientAtNoon:.45,ambientAtTwilight:.2,directAtNoon:.65,directAtTwilight:.7},global:{altitude:8e5,ambient:.015,direct:.75},planarDirection:{localAltitude:1e4,globalAltitude:1e6,globalAngles:{azimuth:1.3*Math.PI,altitude:.6*Math.PI}}};function S0e(i,e,t,r,n,s){Z(s.ambient.color,1,1,1),s.ambient.intensity=Lh.global.ambient,Z(s.direct.color,1,1,1),s.direct.intensity=Lh.global.direct;const a=e[2],o=ce((Math.abs(a)-Lh.local.altitude)/(Lh.global.altitude-Lh.local.altitude),0,1);let l;if(s.globalFactor=o,y(i)&&(l=Bg.getTimes(i,e[1],e[0])),o<1){let c;if(y(i))c=I0e(i,l,r);else{const u=GQ(r);c={direct:{intensity:Lh.local.directAtNoon*u.direct,color:Ge(1,1,1)},ambient:{intensity:Lh.local.ambientAtNoon*u.ambient,color:Ge(1,1,1)},timeOfDay:"early afternoon"}}Bn(s.ambient.color,c.ambient.color,s.ambient.color,o),s.ambient.intensity=dt(c.ambient.intensity,s.ambient.intensity,o),Bn(s.direct.color,c.direct.color,s.direct.color,o),s.direct.intensity=dt(c.direct.intensity,s.direct.intensity,o),s.specularStrength=r==="rainy"||r==="snowy"||r==="foggy"?0:1,s.environmentStrength=r==="rainy"?.7:r==="snowy"||r==="foggy"?.75:1}s.noonFactor=y(i)?M0e(i,l):1,y(i)?E0e(i,e,t,s.direct.directionToLightSource):zQ(n,t,s.direct.directionToLightSource)}function zQ(i,e,t){e===Se.Global?he(wO,i.eye):Z(wO,0,0,1),Q(xO,i.viewForward,-1);const r=ZS(xO,wO),n=Math.max(r-2*TO,0),s=.85*n/(n+1),a=Math.max(TO,r-TO-s);Bc(U6,-a,i.viewRight),Ce(t,xO,U6),oe(t,t,Q(L0e,i.viewRight,$0e)),he(t,t)}function E0e(i,e,t,r){const n=O0e,s=Ag(A0e);if(t===Se.Global)Bg.getPosition(i,0,0,n),Z(r,0,0,-1),bw(s,s,-n.azimuth),bD(s,s,-n.altitude),Ce(r,r,s);else{const a=Lh.planarDirection,o=a.globalAngles,l=e[2];let c=(Math.abs(l)-a.localAltitude)/(a.globalAltitude-a.localAltitude);c=ce(c,0,1),c<1?(Bg.getPosition(i,e[1],e[0],n),n.azimuth=(1-c)*n.azimuth+c*o.azimuth,n.altitude=(1-c)*n.altitude+c*o.altitude):(n.azimuth=o.azimuth,n.altitude=o.altitude),Z(r,0,-1,0),vw(s,s,-n.azimuth),bw(s,s,-n.altitude),Ce(r,r,s)}}function P0e(i,e){if(e===Se.Global)return!0;const t=Lh.planarDirection;return Math.abs(i)<t.localAltitude}const R0e=Ge(.5773502691896258,-.5773502691896258,.5773502691896258);let BQ=class{constructor(){this.ambient={color:Ge(1,1,1),intensity:.55},this.direct={color:Ge(1,1,1),intensity:.55,directionToLightSource:as(R0e)},this.noonFactor=.5,this.globalFactor=0,this.specularStrength=1,this.environmentStrength=1}};const A0e=ve(),O0e={azimuth:0,altitude:0};function M0e(i,e){const t=i.valueOf();let r,n;e.polarException===Bg.PolarException.MIDNIGHT_SUN?(r=t-60*(i.getHours()+48)*60*1e3-60*i.getMinutes()*1e3,n=r+432e6):e.polarException===Bg.PolarException.POLAR_NIGHT?(r=t-2,n=t-1):(r=e.sunrise.valueOf(),n=e.sunset.valueOf());const s=r+(n-r)/2;return 1-ce(Math.abs(t-s)/432e5,0,1)}function GQ(i){switch(i){case"disabled":case"sunny":case"cloudy":return{direct:1,ambient:1};case"rainy":return{direct:.4,ambient:1.2};case"snowy":return{direct:.5,ambient:1.3};case"foggy":return{direct:.2,ambient:1.6}}}function V6(i,e){const t=(i[0]+i[1]+i[2])/3;for(let r=0;r<3;r++)i[r]=i[r]+(t-i[r])*e;return i}function I0e(i,e,t){const r=i.valueOf();let n,s;e.polarException===Bg.PolarException.MIDNIGHT_SUN?(n=r-60*(i.getHours()+48)*60*1e3-60*i.getMinutes()*1e3,s=n+432e6):e.polarException===Bg.PolarException.POLAR_NIGHT?(n=r-2,s=r-1):(n=e.sunrise.valueOf(),s=e.sunset.valueOf());const a=s-n,o=n+a/2,l=a/4,c=o-l,u=o+l,d=.06*a,m=n-d/2,f=n+d/2,_=s-d/2,g=s+d/2,x=Lh.local,b=[.01,x.ambientAtNight],v=[.8,.8,1],w=[.01,.01,.01],T=[x.directAtTwilight,x.ambientAtTwilight],E=[1,.6,.5],C=[.8,.8,1],A=[.9*x.directAtNoon,x.ambientAtNoon],M=[1,.98,.98],I=[.98,.98,1],L=[x.directAtNoon,x.ambientAtNoon],U=[1,1,1],j=[1,1,1],re=A,ee=M,H=I,V=T,X=E,$=C;let B,W,te=[0,0],ie=[0,0,0],Y=[0,0,0];r<m||r>g?(te=b,ie=w,Y=v,W="night"):r<f?(B=f-m,te=Wn(r-m,B,b,T),ie=Wn(r-m,B,w,E),Y=Wn(r-m,B,v,C),W="sun rising"):r<c?(B=c-f,te=Wn(r-f,B,T,A),ie=Wn(r-f,B,E,M),Y=Wn(r-f,B,C,I),W="early morning"):r<o?(B=o-c,te=Wn(r-c,B,A,L),ie=Wn(r-c,B,M,U),Y=Wn(r-c,B,I,j),W="late morning"):r<u?(B=u-o,te=Wn(r-o,B,L,re),ie=Wn(r-o,B,U,ee),Y=Wn(r-o,B,j,H),W="early afternoon"):r<_?(B=_-u,te=Wn(r-u,B,re,V),ie=Wn(r-u,B,ee,X),Y=Wn(r-u,B,H,$),W="late afternoon"):r<g&&(B=g-_,te=Wn(r-_,B,V,b),ie=Wn(r-_,B,X,w),Y=Wn(r-_,B,$,v),W="sun setting");let se=0;switch(t){case"rainy":case"foggy":se=.9;case"snowy":se=.5}se>0&&(ie=V6(ie,se),Y=V6(Y,se));const Ee=Ge(ie[0],ie[1],ie[2]),Re=Ge(Y[0],Y[1],Y[2]),Ie=GQ(t);return{direct:{intensity:te[0]*Ie.direct,color:Ee},ambient:{intensity:te[1]*Ie.ambient,color:Re},timeOfDay:W}}function Wn(i,e,t,r){const n=[];for(let s=0;s<t.length;s++)n[s]=(r[s]-t[s])*i/e+t[s];return n}const U6=ve(),wO=R(),xO=R(),L0e=R(),TO=.25,$0e=.2;let sc=class extends nn.EventedAccessor{constructor(){super(),this._referencePointUpdateDelay=200,this._referencePointUpdateInterval=3e3,this._referencePointUpdateDistThreshold=1e6,this._referencePosUpdateQuery=null,this._referencePosMapCoordsRequested=null,this._viewHandles=new Ft,this._preserveAbsoluteDateTime=!1,this._trackingEnabled=!1,this._referencePosResetPreserveAbsoluteTime=!1,this._referencePosUpdateTimer=null,this._referencePosMapCoords=null,this._mainLight=new Qre,this._ambientLight=new xG,this._moonLight=new Zre,this.disableQueries=!1,this._disableWeather=!1,this._renderer=null,this._referencePosWGS84Comparable=null,this._resetReferencePosition()}destroy(){this.disconnectView(),this._viewHandles.destroy()}get _view(){var e;return(e=this._renderer)==null?void 0:e.view}get updating(){var e;return!((this.disableQueries||!this._referencePosUpdateQuery&&!this._referencePosMapCoordsRequested)&&!((e=this._renderer)!=null&&e.updating))}get weatherEnabled(){var e,t,r;return((e=this._view)==null?void 0:e.environment.atmosphereEnabled)&&!this._disableWeather&&((r=(t=this._view)==null?void 0:t.state)==null?void 0:r.viewingMode)===Se.Global&&PE(this._view.spatialReference)}get weatherVisible(){var e;return this.weatherEnabled&&((e=this._renderer)==null?void 0:e.weatherVisible)}get referencePositionWGS84Comparable(){return this._referencePosWGS84Comparable}connectView(e){if(this._renderer)return;this._renderer=new gs({view:e});const t=()=>this._updateRenderParameters(),r=()=>this._cameraHandler();this._viewHandles.add([z(()=>e.environment.lighting,n=>this._updateLightingHandler(n),ri),z(()=>e.environment.lighting.type!=="virtual"?e.environment.lighting.date:null,n=>this._lightingDateHandler(n),ri),z(()=>e.stationary,()=>this._interactingStationaryHandler()),z(()=>e.environment.lighting.directShadowsEnabled,t,ri),z(()=>e.environment.lighting.ambientOcclusionEnabled,t,ri),z(()=>e.environment.lighting.waterReflectionEnabled,t,ri),z(()=>{var n;return(n=e.environment.background)==null?void 0:n.color},t,ri),z(()=>e.spatialReference,()=>this._resetReferencePosition(!0),ri),z(()=>e.environment.weather.type,()=>this._updateLighting(null,$0.Faded),ri),z(()=>this.weatherEnabled,()=>this._updateLighting(null,$0.Faded),ri),z(()=>e.viewingMode,()=>this._resetReferencePosition(!0),Oi),z(()=>e.environment.lighting.type!=="virtual"&&e.environment.lighting.cameraTrackingEnabled,n=>this._updateCameraTracking(n),Oi),z(()=>e.state.camera,r,Oi),z(()=>this.disableQueries,r)]),this._updateRenderParameters(),this._updateLighting(),this._cameraHandler(),this.notifyChange("updating")}disconnectView(){this._viewHandles.removeAll(),this._resetReferencePosition(),this._renderer=Te(this._renderer)}_updateLightingHandler(e){this._updateCameraTracking(e.type!=="virtual"&&e.cameraTrackingEnabled),this._lightingDateHandler(e.type!=="virtual"?e.date:null),this._updateRenderParameters()}_updateCameraTracking(e){if(this._trackingEnabled=e,e)this._cameraHandler();else{const t=this._view.environment.lighting;(t==null?void 0:t.type)!=="virtual"&&(t.positionTimezoneInfo.autoUpdated=!1)}}_lightingDateHandler(e){const t=this._view.environment.lighting;if((t==null?void 0:t.type)!=="virtual"){if(e){if(!t.positionTimezoneInfo.autoUpdated){this._preserveAbsoluteDateTime=!0;const r=this._view.spatialReference;if(!Eg(r)){const n=this._view.camera.position;if(!this._referencePosMapCoords||!this._referencePosMapCoords.equals(n))return void this._requestReferencePositionUpdate(n)}if(this._preupdateTracking(e),y(this._referencePosWGS84Comparable)){const n=D6(this._referencePosWGS84Comparable,z6);y(n)&&(t.autoUpdate(null,n),this._trackingEnabled&&(t.positionTimezoneInfo.autoUpdated=!0))}}this._updateLighting(e)}}else this._updateLighting()}_preupdateTracking(e){!this._trackingEnabled&&this._view.environment.lighting.type!=="virtual"&&this._view.environment.lighting.cameraTrackingEnabled&&this._cameraHandler(e)}_cameraHandler(e=null){const t=this._view;if(!t.ready)return;const r=t.stateManager.camera;r&&(this._cameraHandlerClientSide(r,e)||this._cameraHandlerServerSide(r))}_cameraHandlerClientSide(e,t){const r=PE(this._view.spatialReference);if(r&&!Eg(this._view.spatialReference))return this._view.environment.lighting.type==="virtual"&&this._updateLighting(),!1;const n=e.position;return S(this._referencePosWGS84Comparable)&&(this._referencePosWGS84Comparable=R()),r?dte(n,this._referencePosWGS84Comparable):Z(this._referencePosWGS84Comparable,n.longitude,n.latitude,n.z),this.notifyChange("referencePositionWGS84Comparable"),this._autoUpdateTimezone(this._referencePosWGS84Comparable,t)||this._updateLighting(t),!0}_cameraHandlerServerSide(e){const t=e.position;(!this._referencePosMapCoords||this._referencePosMapCoordsRequested||this._exceedsReferencePosDistThreshold(t))&&this._requestReferencePositionUpdate(t,!0),this._view.mapCoordsHelper&&this._referencePosWGS84Comparable&&(this._referencePosWGS84Comparable[2]=t.z*this._view.mapCoordsHelper.unitInMeters,this._referencePosChanged())}_interactingStationaryHandler(){this._view.stationary&&this._executePendingReferencePositionUpdate()}_updateLighting(e,t=$0.Immediate){const r=this._view;e=e||(r.environment.lighting.type==="virtual"?null:r.environment.lighting.date);const n=this._referencePosWGS84Comparable,s=y(n)?D0e:F0e,a=this.weatherVisible?r.environment.weather.type:"disabled";y(n)?S0e(e,n,r.state.viewingMode,a,r.state.camera,s):r.environment.lighting.type==="virtual"&&zQ(r.state.camera,r.state.viewingMode,s.direct.directionToLightSource);const o=this._mainLight,l=s.direct;Q(o.intensity,l.color,l.intensity*Math.PI),q(o.direction,l.directionToLightSource),o.specularStrength=s.specularStrength,o.environmentStrength=s.environmentStrength;const c=this._ambientLight;Q(c.intensity,s.ambient.color,s.ambient.intensity);const u=this._moonLight;Bn(u.intensity,k0e,V0e,s.globalFactor);const d=(1-.5*s.globalFactor)*(1-.4*s.noonFactor*(1-s.globalFactor));Q(u.intensity,u.intensity,d),q(u.direction,l.directionToLightSource),this._renderer.updateLightSources([o,c,u],s.noonFactor,s.globalFactor,t),this._updateRenderParameters()}_autoUpdateTimezone(e,t=null){if(this._view.environment.lighting.type==="virtual"||!this._view.environment.lighting.cameraTrackingEnabled||S(e))return!1;const r=N0e;r.setTime((t||this._view.environment.lighting.date).getTime());const n=D6(e,z6);if(S(n))return!1;let s=this._view.environment.lighting.positionTimezoneInfo;if(s.autoUpdated){if(s.hours===n.hours&&s.minutes===n.minutes&&s.seconds===n.seconds)return!1}else s=n;const a=r.getUTCHours()-(n.hours-s.hours),o=r.getUTCMinutes()-(n.minutes-s.minutes),l=r.getUTCSeconds()-(n.seconds-s.seconds);return r.setUTCHours(a),r.setUTCMinutes(o),r.setUTCSeconds(l),!t&&this._view.environment.lighting.autoUpdate(r,n)}_updateRenderParameters(){const e=this._view._stage;if(!e)return;const t=Np(this._referencePosWGS84Comparable,!0,s=>P0e(s[2],this._view.state.viewingMode)),r=this._view.environment.background,n=r instanceof dQ?{type:"color",color:Ire(ei.toUnitRGBA(r.color))}:{type:"color",color:Bi(0,0,0,1)};e.renderView.setRenderParameters({shadowMap:this._view.environment.lighting.directShadowsEnabled&&t,background:n,environment:this._view.environment,weatherVisible:this._view.environmentManager.weatherVisible})}_resetReferencePosition(e=!1){this._cancelReferencePosUpdates(),this._referencePosMapCoords=null,this._referencePosMapCoordsRequested=null,this._referencePosResetPreserveAbsoluteTime=null,this._referencePosWGS84Comparable=null,this.notifyChange("updating"),e&&this._cameraHandler()}_requestReferencePositionUpdate(e,t=!1){if(!this.disableQueries&&(this._referencePosMapCoordsRequested?this._referencePosMapCoordsRequested.copy(e):this._referencePosMapCoordsRequested=e.clone(),this._referencePosResetPreserveAbsoluteTime=!!t,!this._referencePosUpdateQuery&&!this._referencePosUpdateTimer&&this._view.stationary)){const r=this._referencePosUpdateQuery=B0(this._referencePointUpdateDelay).then(()=>{if(this._referencePosUpdateQuery===r){const s=()=>this._referencePosUpdateQuery!==r;return this._doReferencePositionUpdateQuery(s)}}).catch(s=>{s.name==="mapcoordshelper:missing-geometry-service"&&(this.disableQueries=!0)}).then(()=>{this._referencePosUpdateQuery===r&&(this._referencePosUpdateQuery=null,this._referencePosUpdateTimer||this._executePendingReferencePositionUpdate(),this.notifyChange("updating"))}),n=this._referencePosUpdateTimer=B0(this._referencePointUpdateInterval).then(()=>{this._referencePosUpdateTimer===n&&(this._referencePosUpdateTimer=null,this._referencePosUpdateQuery||this._executePendingReferencePositionUpdate())});this.notifyChange("updating")}}async _doReferencePositionUpdateQuery(e){this._referencePosResetPreserveAbsoluteTime&&(this._preserveAbsoluteDateTime=!1),this._referencePosMapCoords?this._referencePosMapCoords.copy(this._referencePosMapCoordsRequested):this._referencePosMapCoords=this._referencePosMapCoordsRequested.clone(),this._referencePosResetPreserveAbsoluteTime=null,this._referencePosMapCoordsRequested=null;const t=await this._view.mapCoordsHelper.toGeographic(this._referencePosMapCoords);if(!e()&&!isNaN(t[0])&&!isNaN(t[1])){const r=this._referencePosMapCoords.z*this._view.mapCoordsHelper.unitInMeters;this._referencePosWGS84Comparable?(this._referencePosWGS84Comparable[0]=t[0],this._referencePosWGS84Comparable[1]=t[1],this._referencePosWGS84Comparable[2]=r):this._referencePosWGS84Comparable=[t[0],t[1],r],this._referencePosChanged()}}_executePendingReferencePositionUpdate(){const e=this._referencePosMapCoordsRequested;e&&this._requestReferencePositionUpdate(e,this._referencePosResetPreserveAbsoluteTime)}_referencePosChanged(){this._preserveAbsoluteDateTime?this._updateLighting():this._autoUpdateTimezone(this._referencePosWGS84Comparable)||this._updateLighting(),this.notifyChange("referencePositionWGS84Comparable")}_exceedsReferencePosDistThreshold(e){if(this._referencePosMapCoords){let t=this._referencePosMapCoords.distance(e);return this._view.mapCoordsHelper&&(t*=this._view.mapCoordsHelper.unitInMeters),t>this._referencePointUpdateDistThreshold}return!0}_cancelReferencePosUpdates(){const e=!!this._referencePosUpdateQuery;return this._referencePosUpdateQuery=null,this._referencePosUpdateTimer=null,e}get test(){const e=this;return{get renderer(){return e._renderer},set referencePointUpdateInterval(t){e._referencePointUpdateInterval=t},set referencePointUpdateDistThreshold(t){e._referencePointUpdateDistThreshold=t},set referencePosUpdateTimer(t){e._referencePosUpdateTimer=t},set referencePointUpdateDelay(t){e._referencePointUpdateDelay=t},set disableWeather(t){e._disableWeather=t}}}};h([p({type:Boolean,readOnly:!0})],sc.prototype,"updating",null),h([p()],sc.prototype,"disableQueries",void 0),h([p()],sc.prototype,"_disableWeather",void 0),h([p()],sc.prototype,"weatherEnabled",null),h([p()],sc.prototype,"weatherVisible",null),h([p()],sc.prototype,"referencePositionWGS84Comparable",null),h([p()],sc.prototype,"_renderer",void 0),h([p()],sc.prototype,"_referencePosWGS84Comparable",void 0),sc=h([D("esri.views.3d.environment.SceneViewEnvironmentManager")],sc);const D0e=new BQ,F0e=new BQ,N0e=new Date,z6={hours:0,minutes:0,seconds:0},k0e=Ge(.22,.22,.33),V0e=Ge(.22,.22,.22);var wi;(function(i){i[i.NONE=0]="NONE",i[i.TILT=1]="TILT",i[i.ALTITUDE=2]="ALTITUDE",i[i.DISTANCE=4]="DISTANCE",i[i.COLLISION=8]="COLLISION",i[i.ALL=15]="ALL",i[i.ALL_EXCEPT_COLLISION=7]="ALL_EXCEPT_COLLISION"})(wi||(wi={}));var rt;(function(i){i[i.NONE=0]="NONE",i[i.ZOOM=1]="ZOOM",i[i.TUMBLE=2]="TUMBLE",i[i.LOOK_AROUND=3]="LOOK_AROUND",i[i.PAN=4]="PAN",i[i.ASCEND=5]="ASCEND"})(rt||(rt={}));var vn;(function(i){i[i.TUMBLE=0]="TUMBLE",i[i.LOOK_AROUND=1]="LOOK_AROUND"})(vn||(vn={}));function nx(i,e){return(i&e)!=0}function k2(i,e,t,r,n,s){i!==0&&(t?(s.min=Math.min(s.min,e),s.max=Math.max(s.max,e)):r!=null?(s.min-=Math.max(0,(e-s.min)*(1-r)),s.max+=Math.max(0,(e-s.max)*(1-r))):n&&(s.min-=Math.max(0,e-s.min-n),s.max+=Math.max(0,e-s.max-n)))}const km={selection:wi.NONE,interactionType:rt.NONE,interactionFactor:0,interactionStartCamera:null,interactionDirection:null,tiltMode:vn.TUMBLE};function HQ(i,e,t,r){return e=e||i.viewForward,q(r,e),Q(r,r,Math.sign(me(e,t))),r}function U0e(i,e,t,r){return j0e(i,e,t,G0e(r,e,t,!0))}function z0e(i,e,t,r){const n=me(t,ne(i,r,e));return oe(i,e,Q(i,t,n))}const B0e={dir:R(),len:0,clip:be()};function G0e(i,e,t,r){const n=B0e;return i?(t&&r&&(n.len=Ii(e,t)),q(n.dir,i)):r?(n.len=Ii(e,t),ne(n.dir,t,e),Q(n.dir,n.dir,1/n.len)):(ne(n.dir,t,e),he(n.dir,n.dir)),n}function H0e(i,e,t){const r=me(Ia(i),t.dir),n=-tr(i,e);if(n<0&&r>=0)return!1;if(r>-1e-6&&r<1e-6)return n>0;if((n<0||r<0)&&!(n<0&&r<0))return!0;const s=n/r;return r>0?s<t.clip[1]&&(t.clip[1]=s):s>t.clip[0]&&(t.clip[0]=s),t.clip[0]<=t.clip[1]}function j0e(i,e,t,r){r.clip[0]=0,r.clip[1]=t?r.len:Number.MAX_VALUE;for(let n=0;n<i.length;n++)if(!H0e(i[n],e,r))return!1;return!0}function q0e(i,e,t=km){const r=$N(i,e,t);if(r===0)return!1;const n=i.renderCoordsHelper,s=n.getAltitude(e.eye)+r,a=HQ(e,t.interactionDirection,Q0e(i,e,Math.sign(r),J0e),K0e),o=q(eve,e.viewForward),l=n.intersectInfiniteManifold(zc(e.eye,a),s,CO);return e.eye=y(l)?l:n.setAltitude(CO,s,e.eye),e.center=z0e(CO,e.eye,o,e.center),!0}function $N(i,e,t=km){if(!W0e(i,t))return 0;const r=Z0e(i.state.constraints.altitude,Y0e);X0e(i,t,r);const n=i.renderCoordsHelper.getAltitude(e.eye),s=ce(n,r.min,r.max)-n;return Math.abs(s)<=1e-6?0:s}function W0e(i,e){const t=i.state.constraints.altitude;return!(!i.state.isGlobal||!t)&&(e.interactionType!==rt.TUMBLE||!nx(e.selection,wi.TILT))}function X0e(i,e,t){const r=e.interactionType;if(r===rt.NONE)return;const{min:n,max:s}=t,{interactionStartCamera:a,interactionFactor:o}=e,l=r===rt.TUMBLE||r===rt.ZOOM,c=$N(i,a),u=c===0?0:i.renderCoordsHelper.getAltitude(a.eye);t.min=n,t.max=s,k2(c,u,l,o,.05*u,t)}function Q0e(i,e,t,r){return i.renderCoordsHelper.worldUpAtPosition(e.eye,r),Q(r,r,t),r}function Z0e(i,e){return e.min=i.min,e.max=i.max,e}const Y0e={min:0,max:0},K0e=R(),J0e=R(),eve=R(),CO=R();function DN(i,e,t=km){if(!i.state.isLocal)return 0;const r=i.state.constraints.distance;if(!i.pointsOfInterest.surfaceOrigin.renderLocation||r===1/0)return 0;jT.min=0,jT.max=r,ive(i,t,jT);const n=FN(i,e),s=jT.max-n;return s>=-1e-6?0:s}function tve(i,e,t=km){const r=DN(i,e,t);if(r===0)return!1;const n=i.pointsOfInterest.surfaceOrigin,s=FN(i,e)+r,a=q(nve,e.eye),o=HQ(e,t.interactionDirection,rve(i,e,ove),ave);if(!PP(sre(n.renderLocation,s),zc(e.eye,o),qT))return!1;e.eye=qT;const l=ne(sve,e.eye,a);e.center=oe(qT,e.center,l);const c=i.renderCoordsHelper.getAltitude(e.center),u=i.renderCoordsHelper.intersectInfiniteManifold(e.ray,c,qT);return y(u)&&(e.center=u),!0}function ive(i,e,t){const r=e.interactionType;if(r===rt.NONE)return;const{min:n,max:s}=t,{interactionStartCamera:a,interactionFactor:o}=e,l=r===rt.ZOOM||r===rt.PAN,c=DN(i,a),u=c===0?0:FN(i,a);t.min=n,t.max=s,k2(c,u,l,o,.05*u,t)}function FN(i,e){const t=i.pointsOfInterest.surfaceOrigin;return Ii(e.eye,t.renderLocation)}function rve(i,e,t){const r=i.pointsOfInterest.surfaceOrigin;return Yg(t,e.eye,r.renderLocation)}const jT={min:0,max:0},nve=R(),sve=R(),ave=R(),ove=R(),qT=R();var Ui,zn;(function(i){i[i.OBJECT=0]="OBJECT",i[i.HUD=1]="HUD",i[i.TERRAIN=2]="TERRAIN",i[i.OVERLAY=3]="OVERLAY",i[i.I3S=4]="I3S",i[i.PCL=5]="PCL",i[i.LOD=6]="LOD",i[i.VOXEL=7]="VOXEL"})(Ui||(Ui={}));let lve=class{constructor(){this.verticalOffset=0,this.selectionMode=!1,this.hud=!0,this.selectOpaqueTerrainOnly=!0,this.invisibleTerrain=!1,this.backfacesTerrain=!0,this.isFiltered=!1,this.store=zn.ALL}};(function(i){i[i.MIN=0]="MIN",i[i.MINMAX=1]="MINMAX",i[i.ALL=2]="ALL"})(zn||(zn={}));function hu(i){return y(i)&&y(i.dist)}function B6(i){return(e,t,r)=>(Bn(G6,e,t,r),!EN(i,G6))}function vR(i){return hu(i)&&i.intersector===Ui.OBJECT&&!!i.target}function bR(i){return hu(i)&&i.intersector===Ui.HUD&&!!i.target&&y(i.target.center)}const G6=R(),sv=1e-5;let cve=class{constructor(e){this.options=new lve,this._results=new hve,this.transform=new Sne,this.tolerance=sv,this.verticalOffset=null,this._ray=oo(),this._rayEnd=R(),this._rayBeginTransformed=R(),this._rayEndTransformed=R(),this.viewingMode=e??Se.Global}get results(){return this._results}get ray(){return this._ray}get rayBegin(){return this._ray.origin}get rayEnd(){return this._rayEnd}reset(e,t,r){this.resetWithRay(are(e,t,this._ray),r)}resetWithRay(e,t){this.camera=t,e!==this._ray&&wI(e,this._ray),this.options.verticalOffset!==0?this.viewingMode===Se.Local?this._ray.origin[2]-=this.options.verticalOffset:this.verticalOffset=this.options.verticalOffset:this.verticalOffset=null,oe(this._rayEnd,this._ray.origin,this._ray.direction),this._results.init(this._ray)}intersect(e=null,t,r,n,s){this.point=t,this.filterPredicate=n,this.tolerance=r??sv;const a=V5(this.verticalOffset);if(y(e)&&e.length>0){const o=s?l=>{s(l)&&this.intersectObject(l)}:l=>{this.intersectObject(l)};for(const l of e){const c=l.getSpatialQueryAccelerator&&l.getSpatialQueryAccelerator();y(c)?(y(a)?c.forEachAlongRayWithVerticalOffset(this._ray.origin,this._ray.direction,o,a):c.forEachAlongRay(this._ray.origin,this._ray.direction,o),this.options.selectionMode&&this.options.hud&&c.forEachDegenerateObject(o)):l.objects.forAll(u=>o(u))}}this.sortResults()}intersectObject(e){const t=e.geometryRecords;if(!t)return;const r=e.transformation,n=V5(this.verticalOffset);for(const s of t){const{geometry:a,material:o,instanceParameters:l}=s;if(MP(l))continue;const c=a.id;this.transform.setAndInvalidateLazyTransforms(r,s.getShaderTransformation()),Ce(this._rayBeginTransformed,this.rayBegin,this.transform.inverse),Ce(this._rayEndTransformed,this.rayEnd,this.transform.inverse);const u=this.transform.transform;y(n)&&(n.objectTransform=this.transform),o.intersect(a,l,this.transform.transform,this,this._rayBeginTransformed,this._rayEndTransformed,(d,m,f,_,g,x)=>{if(d>=0){if(y(this.filterPredicate)&&!this.filterPredicate(this._ray.origin,this._rayEnd,d))return;const b=_?this._results.hud:this._results,v=_?w=>{const T={object:e,geometryId:c,triangleNr:f,center:y(x)?[x[0],x[1],x[2]]:null};w.set(Ui.HUD,T,d,m,rn,g)}:w=>w.set(Ui.OBJECT,{object:e,geometryId:c,triangleNr:f},d,m,u,g);if((b.min.drapedLayerOrder==null||g>=b.min.drapedLayerOrder)&&(b.min.dist==null||d<b.min.dist)&&v(b.min),this.options.store!==zn.MIN&&(b.max.drapedLayerOrder==null||g<b.max.drapedLayerOrder)&&(b.max.dist==null||d>b.max.dist)&&v(b.max),this.options.store===zn.ALL)if(_){const w=new LL(this._ray);v(w),this._results.hud.all.push(w)}else{const w=new D0(this._ray);v(w),this._results.all.push(w)}}},s.shaderTransformation)}}sortResults(e=this._results.all){e.sort((t,r)=>t.dist!==r.dist?je(t.dist,0)-je(r.dist,0):t.drapedLayerOrder!==r.drapedLayerOrder?je(t.drapedLayerOrder,Number.MAX_VALUE)-je(r.drapedLayerOrder,Number.MAX_VALUE):je(r.drapedLayerGraphicOrder,Number.MIN_VALUE)-je(t.drapedLayerGraphicOrder,Number.MIN_VALUE))}};function Xl(i){return new cve(i)}let hve=class{constructor(){this.min=new D0(oo()),this.max=new D0(oo()),this.hud={min:new LL(oo()),max:new LL(oo()),all:new Array},this.ground=new D0(oo()),this.all=[]}init(e){this.min.init(e),this.max.init(e),this.ground.init(e),this.all.length=0,this.hud.min.init(e),this.hud.max.init(e),this.hud.all.length=0}},D0=class{constructor(e){this.intersector=Ui.OBJECT,this.normal=R(),this.transformation=ve(),this._ray=oo(),this.init(e)}get ray(){return this._ray}get distanceInRenderSpace(){return y(this.dist)?(Q(WT,this.ray.direction,this.dist),_e(WT)):null}getIntersectionPoint(e){return!!hu(this)&&(Q(WT,this.ray.direction,this.dist),oe(e,this.ray.origin,WT),!0)}getTransformedNormal(e){return q(r1,this.normal),r1[3]=0,sd(r1,r1,this.transformation),q(e,r1),he(e,e)}init(e){this.dist=null,this.target=null,this.drapedLayerOrder=null,this.drapedLayerGraphicOrder=null,this.intersector=Ui.OBJECT,wI(e,this._ray)}set(e,t,r,n,s,a,o){this.intersector=e,this.dist=r,q(this.normal,je(n,ere)),pn(this.transformation,je(s,rn)),this.target=t,this.drapedLayerOrder=a,this.drapedLayerGraphicOrder=o}copy(e){wI(e.ray,this._ray),this.intersector=e.intersector,this.dist=e.dist,this.target=e.target,this.drapedLayerOrder=e.drapedLayerOrder,this.drapedLayerGraphicOrder=e.drapedLayerGraphicOrder,q(this.normal,e.normal),pn(this.transformation,e.transformation)}},LL=class extends D0{constructor(){super(...arguments),this.intersector=Ui.HUD}};function NN(i){return new D0(i)}const WT=R(),r1=_i();function jQ(i,e,t,r){return y(i.renderCoordsHelper.fromRenderCoords(e.eye,V2,r))&&eG(t,V2)}function wR(i,e){return i.elevationProvider?je(i.elevationProvider.getElevation(e[0],e[1],e[2],i.renderCoordsHelper.spatialReference,"ground"),0):0}function l_(i,e,t,r){const n=i.state.camera.clone();e&&(n.eye=e,n.center=t,n.up=r),uve(i,n.ray,Jd)||q(Jd,n.center);const s=i.state.constraints,a=s.minimumPoiDistance;if(Bl(n.eye,Jd)<a){const o=s.collision.enabled;q(Jm,n.viewForward),Q(Jm,Jm,a),o?n.eye=ne(V2,Jd,Jm):oe(Jd,n.eye,Jm);const l=i.renderCoordsHelper,c=l.getAltitude(n.eye),u=s.collision.elevationMargin;o&&c<u&&(ne(Jm,Jd,n.eye),n.eye=l.setAltitude(V2,u,n.eye),oe(Jd,n.eye,Jm))}return n.center=Jd,n}function H6(i,e,t){if(!i.state.isGlobal)return!1;const r=wR(i,e),n=i.stateManager.constraintsManager.nearFarHeuristic,{far:s}=n.compute(e,t,i.renderDataExtent,r,pve),a=s*s;return Bl(e,t)>a}function uve(i,e,t){let r=j6[i.viewingMode];r||(r=Xl(i.state.viewingMode),r.options.backfacesTerrain=!i.state.isGlobal,r.options.invisibleTerrain=!0,j6[i.viewingMode]=r);const{isGlobal:n}=i.state;return!(!i.sceneIntersectionHelper.intersectRay(e,r,t)||H6(i,e.origin,t))||!(!i.renderCoordsHelper.intersectManifold(e,0,t)||H6(i,e.origin,t))||!!n&&dve(e,t,Yt(i.spatialReference).radius)}function dve(i,e,t){const r=me(i.origin,i.origin)-t*t,n=r>0?Math.sqrt(r)/3:1;return Q(e,i.direction,n/_e(i.direction)),oe(e,e,i.origin),!0}const j6={},V2=R(),Jd=R(),Jm=R(),pve={near:0,far:0};function Tv(i,e,t=zl.EYE){const r=i.state.constraints;if(!r.collision.enabled)return!1;const n=wR(i,e.eye),s=i.renderCoordsHelper.getAltitude(e.eye),a=n+r.collision.elevationMargin;if(s>=a)return!1;const o=_e(e.eye);if(ne(XT,e.center,e.eye),e.eye=i.renderCoordsHelper.setAltitude(mve,a,e.eye),t===zl.EYE_AND_CENTER)e.center=oe(XT,e.eye,XT);else if(t===zl.EYE_AND_CENTER_SCALE){const l=(o-s+a)/o;e.center=Q(XT,e.center,l)}return!0}var zl;(function(i){i[i.EYE=0]="EYE",i[i.EYE_AND_CENTER=1]="EYE_AND_CENTER",i[i.EYE_AND_CENTER_SCALE=2]="EYE_AND_CENTER_SCALE"})(zl||(zl={}));const XT=R(),mve=R();function Vm(i,e,t){i.worldUpAtPosition(e,q6),ne(SO,t,e);const r=_e(SO);return r===0?0:ls(me(SO,q6)/r)}const q6=R(),SO=R();function qQ(i,e,t=km,r=!0){n1.eyeCenterDistance=0,n1.requiresTwoSteps=!1;const n=kN(i,e,t,void 0,n1);if(n===0)return!1;switch(Bc(QT,-n,e.viewRight),t.tiltMode){case vn.LOOK_AROUND:Ce(ep,e.viewForward,QT),Q(ep,ep,n1.eyeCenterDistance),e.center=oe(Zp,e.eye,ep);break;case vn.TUMBLE:ne(ep,e.center,e.eye),Ce(ep,ep,QT),e.eye=ne(Zp,e.center,ep);break;default:Pa(t.tiltMode)}return e.up=Ce(Zp,e.up,QT),!n1.requiresTwoSteps||!r||qQ(i,e,t,!1)}function kN(i,e,t=km,r=km,n){if(!i.state.constraints.tilt)return 0;const s=e.distance,a=i.state.constraints.tilt(s,Cve);return Tve(i,t,a),r.interactionType===rt.TUMBLE&&nx(r.selection,wi.ALTITUDE)&&WQ(i,r.interactionStartCamera,a),t.tiltMode===vn.LOOK_AROUND||r.tiltMode===vn.LOOK_AROUND?gve(i,e,a,n):fve(i,e,a)}function fve(i,e,t){const r=Vm(i.renderCoordsHelper,e.center,e.eye),n=r-ce(r,t.min,t.max);return sx(n)?n:0}function gve(i,e,t,r){switch(r&&(r.requiresTwoSteps=!1),i.viewingMode){case"global":return yve(i,e,t,r);case"local":return _ve(i,e,t,r);default:return void Pa(i.viewingMode)}}function _ve(i,e,t,r){const n=Vm(i.renderCoordsHelper,e.center,e.eye),s=ce(n,t.min,t.max),a=n-s;if(!sx(a))return 0;if(r){const o=i.pointsOfInterest.centerOnSurfaceFrequent.estimatedSurfaceAltitude,l=i.renderCoordsHelper.getAltitude(e.eye)-o,c=Math.cos(s);Math.abs(c)>1e-4?r.eyeCenterDistance=l/c:r.eyeCenterDistance=e.distance}return a}function yve(i,e,t,r){const n=vve(i,e,Sve),s=ce(n.tiltAtCenter,t.min,t.max);if(!sx(n.tiltAtCenter-s))return 0;let a,o;return n.centerIsOnSurface?(a=bve(n),o=wve(n,a)):(a=n.constraints.clampTilt(n.eyeCenterDistance,n.tiltAtCenter),r&&a<Math.PI/2&&(r.requiresTwoSteps=!0,a=Math.PI/2-1e-5),o=xve(n,a)),r&&(r.eyeCenterDistance=$L(n,a)),o}function vve(i,e,t){const r=i.pointsOfInterest.centerOnSurfaceFrequent.estimatedSurfaceAltitude,n=r+Yt(i.spatialReference).radius,s=i.renderCoordsHelper.intersectManifold(e.ray,r,Zp);return t.eyeCenterDistance=e.distance,t.centerIsOnSurface=!1,y(s)?(t.eyeCenterDistance=Ii(e.eye,s),t.tiltAtCenter=Vm(i.renderCoordsHelper,s,e.eye),t.centerIsOnSurface=!0):i.state.isLocal?t.tiltAtCenter=Vm(i.renderCoordsHelper,e.center,e.eye):(RP(fD(gD,n),e.ray,Zp),t.eyeCenterDistance=Ii(e.eye,Zp),t.tiltAtCenter=ls(-me(e.viewForward,he(Zp,Zp)))),t.radius=n,t.eyeRadius=_e(e.eye),t.constraints=i.state.constraints,t}function sx(i){return Math.abs(i)>1e-9}function bve(i){const{constraints:e,eyeCenterDistance:t,tiltAtCenter:r}=i;let n=r,s=e.clampTilt(t,r);const a=$L(i,s);if(e.clampTilt(a,r)===s)return s;let o=0;for(;o<10&&sx(s-n);){const l=(n+s)/2,c=$L(i,l);sx(e.clampTilt(c,l)-l)?n=l:s=l,o++}return s}function $L(i,e){if(!i.centerIsOnSurface)return i.eyeCenterDistance;const t=Math.PI-ce(e,0,Math.PI),r=tu(i.radius/i.eyeRadius*Math.sin(t)),n=Math.PI-t-r,s=Math.sin(n)/Math.sin(t);if(i.eyeRadius<i.radius&&s>1){const a=Math.PI-r,o=Math.PI-t-a;return Math.sin(o)/Math.sin(t)*i.eyeRadius}return s*i.eyeRadius}function wve(i,e){const t=tu(i.radius/i.eyeRadius*Math.sin(i.tiltAtCenter)),r=tu(i.radius/i.eyeRadius*Math.sin(e));return i.eyeRadius>i.radius?t-r:r-t}function xve(i,e){return i.tiltAtCenter-Math.PI/2-(e-Math.PI/2)}function Tve(i,e,t){if(e.interactionType===rt.NONE)return;const{interactionStartCamera:r,interactionFactor:n}=e,{min:s,max:a}=t,o=kN(i,r,km,e),l=o===0?0:Vm(i.renderCoordsHelper,r.center,r.eye);t.min=s,t.max=a,e.interactionType===rt.TUMBLE?(nx(e.selection,wi.ALTITUDE)&&WQ(i,r,t),k2(o,l,!0,n,W6,t)):k2(o,l,!1,n,W6,t)}function WQ(i,e,t){if(i.state.isLocal)return;const r=i.state.constraints;if(!r.altitude)return;const n=Ml(e.center),s=Math.sqrt(n),a=e.distance,o=Yt(i.spatialReference).radius,l=r.altitude.min+o,c=r.altitude.max+o,u=(l*l-a*a-n)/(-2*s*a),d=(c*c-a*a-n)/(-2*s*a);t.min=Math.max(t.min,Math.min(Math.PI-ls(d),t.max)),t.max=Math.min(t.max,Math.PI-ls(u))}const ep=R(),QT=ve(),Zp=R(),W6=Ct(5),Cve={min:0,max:0},Sve={constraints:null,radius:0,eyeRadius:0,centerIsOnSurface:!0,eyeCenterDistance:0,tiltAtCenter:0},n1={eyeCenterDistance:0,requiresTwoSteps:!1};function Eve(i){return i}const xR=i=>i*i,VN=i=>1-xR(1-i),Pve=i=>i<.5?xR(2*i)/2:(VN(2*(i-.5))+1)/2,UN=i=>i*i*i,XQ=i=>1-UN(1-i),QQ=i=>i<.5?UN(2*i)/2:(XQ(2*(i-.5))+1)/2,zN=i=>i*i*i*i,ZQ=i=>1-zN(1-i),Rve=i=>i<.5?zN(2*i)/2:(ZQ(2*(i-.5))+1)/2,BN=i=>i*i*i*i*i,YQ=i=>1-BN(1-i),Ave=i=>i<.5?BN(2*i)/2:(YQ(2*(i-.5))+1)/2,GN=i=>1-Math.cos(i*Math.PI/2),KQ=i=>1-GN(1-i),Ove=i=>i<.5?GN(2*i)/2:(KQ(2*(i-.5))+1)/2,HN=i=>2**(10*(i-1)),Zx=i=>1-HN(1-i),Mve=i=>i<.5?HN(2*i)/2:(Zx(2*(i-.5))+1)/2,jN=i=>-(Math.sqrt(1-i*i)-1),JQ=i=>1-jN(1-i),Ive=i=>i<.5?jN(2*i)/2:(JQ(2*(i-.5))+1)/2;function Zl(i){const e=2*(i-Math.sqrt((i-1)*i)),t=e/2/i;return r=>r<t?i*r*r:e*r-e+1}function Yl(i,e){return(t,r)=>t<e?e*i(t/e,r):1-i((1-t)/(1-e),r)*(1-e)}const Lve=Yl(Zl(1),1),$ve=Yl(Zl(1),0),eZ=Yl(Zl(1),.5),Dve=Yl(Zl(2),1),Fve=Yl(Zl(2),0),Nve=Yl(Zl(2),.5),kve=Yl(Zl(3),1),Vve=Yl(Zl(3),0),Uve=Yl(Zl(3),.5),zve=Yl(Zl(4),1),Bve=Yl(Zl(4),0),Gve=Yl(Zl(4),.5),Hve={linear:Eve,"in-quad":xR,"out-quad":VN,"in-out-quad":Pve,"in-coast-quad":Lve,"out-coast-quad":$ve,"in-out-coast-quad":eZ,"in-cubic":UN,"out-cubic":XQ,"in-out-cubic":QQ,"in-coast-cubic":Dve,"out-coast-cubic":Fve,"in-out-coast-cubic":Nve,"in-quart":zN,"out-quart":ZQ,"in-out-quart":Rve,"in-coast-quart":kve,"out-coast-quart":Vve,"in-out-coast-quart":Uve,"in-quint":BN,"out-quint":YQ,"in-out-quint":Ave,"in-coast-quint":zve,"out-coast-quint":Bve,"in-out-coast-quint":Gve,"in-sine":GN,"out-sine":KQ,"in-out-sine":Ove,"in-expo":HN,"out-expo":Zx,"in-out-expo":Mve,"in-circ":jN,"out-circ":JQ,"in-out-circ":Ive};function pr(i,e,t=Xve,r=e){r!==e&&r.copyFrom(e),r.computeUp(i.state.viewingMode);let n=!1;for(let o=0;o<Qve;o++){let l=0;for(const c of Wve)if(nx(t.selection,c.type)){const u=Math.abs(c.error(i,r,t));c.apply(i,r,t)&&(n=!0,l+=u)}if(l===0)break}const s=nx(t.selection,wi.COLLISION),a=jve(t.interactionType,i);return s&&Tv(i,r,a)&&(n=!0),n&&r.computeUp(i.state.viewingMode),n}function jve(i,e){switch(i){case rt.PAN:return zl.EYE_AND_CENTER;case rt.ASCEND:return e.state.isGlobal?zl.EYE_AND_CENTER_SCALE:zl.EYE_AND_CENTER;default:return zl.EYE}}function Cc(i){const e=Math.min(1,i/150);return QQ(e)}function qve(i,e,t){return kN(i,e,t)*e.distance}const Wve=[{type:wi.TILT,error:qve,apply:qQ},{type:wi.ALTITUDE,error:$N,apply:q0e},{type:wi.DISTANCE,error:DN,apply:tve}],Xve={selection:wi.ALL,interactionType:rt.NONE,interactionFactor:0,interactionStartCamera:null,interactionDirection:null,tiltMode:vn.TUMBLE},Qve=5,So=R(),Na=R(),tp=R(),ds=R(),ef=R(),Zve=R(),Eo={upward:Ge(0,0,1),forward:Ge(0,1,0),sideway:Ge(1,0,0)},X6=Or();let Q6=class{constructor(e=Se.Global){this.viewingMode=e,this.center=R(),this.pitch=0,this.yaw=0,this.distance=0,this.lookAtDirection=as(Eo.forward)}pixelsPerPanAtZoom(e){return this.size/2/(this._zoomToPanScale*e)}zoomAtPixelsPerPan(e){return this.size/2/(this._zoomToPanScale*e)}pixelsPerRotateAtZoom(){const e=Math.max(Math.cos(Math.abs(this.pitch)),.5);return this.size/2/e}compareTo(e,t){if(t||(t={pan:0,rotate:0,sourceZoom:0,targetZoom:0}),this.viewingMode===Se.Global){const s=(_e(this.center)+_e(e.center))/2;t.pan=ZS(this.center,e.center)*s}else t.pan=Ii(this.center,e.center);let r=Math.abs(e.yaw-this.yaw);r>=Math.PI&&(r=2*Math.PI-r);const n=Math.abs(e.pitch-this.pitch);return t.rotate=Math.max(r,n),t.sourceZoom=this.distance,t.targetZoom=e.distance,t}interpolate(e,t,r){this.viewingMode===Se.Global?a_e(e.center,t.center,r.pan,this.center):Bn(this.center,e.center,t.center,r.pan),this.distance=isFinite(t.distance)?dt(e.distance,t.distance,r.zoom):e.distance,this.pitch=dt(e.pitch,t.pitch,r.rotate);let n=e.yaw;const s=t.yaw;Math.abs(s-n)>=Math.PI&&(n+=2*(n<s?1:-1)*Math.PI),this.yaw=dt(n,s,r.rotate)}copyFrom(e){q(this.center,e.center),this.pitch=e.pitch,this.yaw=e.yaw,this.distance=e.distance,q(this.lookAtDirection,e.lookAtDirection),this.size=e.size,this.copyFromCommon(e),this.viewingMode=e.viewingMode}copyFromRenderCamera(e){const t=this._lookAtOrientation(e.center,X6);q(this.center,e.center),ne(ds,e.center,e.eye),Nl(ds,ds,t),Nl(ef,e.up,t),this.distance=_e(ds),this.distance!==0&&(ds[0]/=this.distance,ds[1]/=this.distance,ds[2]/=this.distance),this.pitch=this._eyeUpToPitch(ds),this.yaw=this._eyeUpToYaw(ds,ef),this.size=Math.sqrt(e.width*e.width+e.height*e.height),this.copyFromCommon(e)}copyFromCommon(e){this.fov=e.fov,this._zoomToPanScale=Math.atan(.5*this.fov)}copyToRenderCamera(e){const t=this._lookAtOrientation(this.center,X6);qc(t,t),this._axisAngleVec3(Eo.sideway,this.pitch-Math.PI/2,Eo.forward,ds),this._axisAngleVec3(Eo.upward,this.yaw,ds),this._axisAngleVec3(Eo.sideway,this.pitch-Math.PI/2,Eo.upward,ef),this._axisAngleVec3(Eo.upward,this.yaw,ef),Q(ds,ds,this.distance),Nl(ds,ds,t),Nl(ef,ef,t),e.center=this.center,e.eye=ne(ds,this.center,ds),e.up=ef}_axisAngleVec3(e,t,r,n=r){const s=Math.cos(t),a=Math.sin(t);return Q(So,r,s),nt(Na,e,r),Q(Na,Na,a),Q(tp,e,(1-s)*me(e,r)),oe(n,oe(n,So,Na),tp)}_lookAtOrientation(e,t=Or()){return this._upAtLookAt(e,tp),nt(So,this.lookAtDirection,tp),he(So,So),So[0]===0&&So[1]===0&&So[2]===0&&q(So,Eo.sideway),nt(Na,tp,So),he(Na,Na),t[0]=So[0],t[1]=Na[0],t[2]=tp[0],t[3]=So[1],t[4]=Na[1],t[5]=tp[1],t[6]=So[2],t[7]=Na[2],t[8]=tp[2],t}_upAtLookAt(e,t){return this.viewingMode===Se.Local?q(t,Eo.upward):he(t,e)}_eyeUpToPitch(e){return Math.PI-ZS(Eo.upward,e)}_eyeUpToYaw(e,t){const r=Zve;return Math.abs(t[2])<.5?(q(r,t),e[2]>0&&Q(r,r,-1)):q(r,e),nt(Na,r,Eo.upward),he(Na,Na),ZS(Eo.sideway,Na,Eo.upward)}},yi=class tZ{constructor(e=null,t=null,r=null){this._viewUp=R(),this._viewForward=R(),this._viewRight=R(),this._ray=oo(),this._viewport=Bi(0,0,1,1),this._padding=Bi(0,0,0,0),this._fov=55/180*Math.PI,this._nearFar=Xt(1,1e3),this._viewDirty=!0,this._viewMatrix=ve(),this._projectionDirty=!0,this._projectionMatrix=ve(),this._viewProjectionDirty=!0,this._viewProjectionMatrix=ve(),this._viewInverseTransposeMatrixDirty=!0,this._viewInverseTransposeMatrix=ve(),this._inverseProjectionDirty=!0,this._inverseProjectionMatrix=null,this._frustumDirty=!0,this._frustum=Rw(),this._fullViewport=_i(),this._pixelRatio=1,this.relativeElevation=0,y(e)&&q(this._ray.origin,e),this._center=y(t)?as(t):R(),this._up=y(r)?as(r):Ge(0,0,1)}get pixelRatio(){return this._pixelRatio}set pixelRatio(e){this._pixelRatio=e>0?e:1}get eye(){return this._ray.origin}set eye(e){this._compareAndSetView(e,this._ray.origin)}get center(){return this._center}set center(e){this._compareAndSetView(e,this._center)}get ray(){return ne(this._ray.direction,this.center,this.eye),this._ray}get up(){return this._up}set up(e){this._compareAndSetView(e,this._up)}get viewMatrix(){return this._ensureViewClean(),this._viewMatrix}set viewMatrix(e){pn(this._viewMatrix,e),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}get viewForward(){return this._ensureViewClean(),this._viewForward}get viewUp(){return this._ensureViewClean(),this._viewUp}get viewRight(){return this._ensureViewClean(),this._viewRight}get nearFar(){return this._nearFar}get near(){return this._nearFar[0]}set near(e){this._nearFar[0]!==e&&(this._nearFar[0]=e,this._projectionDirty=!0,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get far(){return this._nearFar[1]}set far(e){this._nearFar[1]!==e&&(this._nearFar[1]=e,this._projectionDirty=!0,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get viewport(){return this._viewport}set viewport(e){this.x=e[0],this.y=e[1],this.width=e[2],this.height=e[3]}get x(){return this._viewport[0]}set x(e){e+=this._padding[Xe.LEFT],this._viewport[0]!==e&&(this._viewport[0]=e,this._projectionDirty=!0,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get y(){return this._viewport[1]}set y(e){e+=this._padding[Xe.BOTTOM],this._viewport[1]!==e&&(this._viewport[1]=e,this._projectionDirty=!0,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get width(){return this._viewport[2]}set width(e){this._viewport[2]!==e&&(this._viewport[2]=e,this._projectionDirty=!0,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get height(){return this._viewport[3]}set height(e){this._viewport[3]!==e&&(this._viewport[3]=e,this._projectionDirty=!0,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get fullWidth(){return this._viewport[2]+this._padding[Xe.RIGHT]+this._padding[Xe.LEFT]}set fullWidth(e){this.width=e-(this._padding[Xe.RIGHT]+this._padding[Xe.LEFT])}get fullHeight(){return this._viewport[3]+this._padding[Xe.TOP]+this._padding[Xe.BOTTOM]}set fullHeight(e){this.height=e-(this._padding[Xe.TOP]+this._padding[Xe.BOTTOM])}get fullViewport(){return this._fullViewport[0]=this._viewport[0]-this._padding[Xe.LEFT],this._fullViewport[1]=this._viewport[1]-this._padding[Xe.BOTTOM],this._fullViewport[2]=this.fullWidth,this._fullViewport[3]=this.fullHeight,this._fullViewport}get aspect(){return this.width/this.height}get padding(){return this._padding}set padding(e){this._padding[Xe.TOP]===e[Xe.TOP]&&this._padding[Xe.RIGHT]===e[Xe.RIGHT]&&this._padding[Xe.BOTTOM]===e[Xe.BOTTOM]&&this._padding[Xe.LEFT]===e[Xe.LEFT]||(this._viewport[0]+=e[Xe.LEFT]-this._padding[Xe.LEFT],this._viewport[1]+=e[Xe.BOTTOM]-this._padding[Xe.BOTTOM],this._viewport[2]-=e[Xe.RIGHT]+e[Xe.LEFT]-(this._padding[Xe.RIGHT]+this._padding[Xe.LEFT]),this._viewport[3]-=e[Xe.TOP]+e[Xe.BOTTOM]-(this._padding[Xe.TOP]+this._padding[Xe.BOTTOM]),im(this._padding,e),this._projectionDirty=!0,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get viewProjectionMatrix(){return this._viewProjectionDirty&&(Hr(this._viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),this._viewProjectionDirty=!1),this._viewProjectionMatrix}get projectionMatrix(){if(this._projectionDirty){const e=this.width,t=this.height,r=this.near*Math.tan(this.fovY/2),n=r*this.aspect;pre(this._projectionMatrix,-n*(1+2*this._padding[Xe.LEFT]/e),n*(1+2*this._padding[Xe.RIGHT]/e),-r*(1+2*this._padding[Xe.BOTTOM]/t),r*(1+2*this._padding[Xe.TOP]/t),this.near,this.far),this._projectionDirty=!1}return this._projectionMatrix}get inverseProjectionMatrix(){return S(this._inverseProjectionMatrix)&&(this._inverseProjectionMatrix=ve()),this._inverseProjectionDirty&&kn(this._inverseProjectionMatrix,this.projectionMatrix),this._inverseProjectionMatrix}set projectionMatrix(e){pn(this._projectionMatrix,e),this._projectionDirty=!1,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}get fov(){return this._fov}set fov(e){this._fov=e,this._projectionDirty=!0,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}get fovX(){return Wne(this._fov,this.width,this.height)}set fovX(e){this._fov=Xne(e,this.width,this.height),this._projectionDirty=!0,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}get fovY(){return Qne(this._fov,this.width,this.height)}set fovY(e){this._fov=Zne(e,this.width,this.height),this._projectionDirty=!0,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}get distance(){return Ii(this._center,this.eye)}get frustum(){return this._recomputeFrustum(),this._frustum}get viewInverseTransposeMatrix(){return(this._viewInverseTransposeMatrixDirty||this._viewDirty)&&(kn(this._viewInverseTransposeMatrix,this.viewMatrix),yD(this._viewInverseTransposeMatrix,this._viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1),this._viewInverseTransposeMatrix}depthNDCToWorld(e){const t=2*e-1;return 2*this.near*this.far/(this.far+this.near-t*(this.far-this.near))}get perRenderPixelRatio(){return Math.tan(this.fovX/2)/(this.width/2)}get perScreenPixelRatio(){return this.perRenderPixelRatio*this._pixelRatio}get aboveGround(){return this.relativeElevation!=null&&this.relativeElevation>=0}copyFrom(e){q(this._ray.origin,e.eye),q(this._center,e.center),q(this._up,e.up),im(this._viewport,e.viewport),im(this._padding,e.padding),wn(this._nearFar,e.nearFar),this._fov=e.fov,this.relativeElevation=e.relativeElevation;const t=e;return this._viewDirty=t._viewDirty,this._viewDirty||(pn(this._viewMatrix,e.viewMatrix),q(this._viewRight,e.viewRight),q(this._viewUp,e.viewUp),q(this._viewForward,e.viewForward)),t._projectionDirty?this._projectionDirty=!0:(pn(this._projectionMatrix,e.projectionMatrix),this._projectionDirty=!1),this._viewProjectionDirty=!0,this._inverseProjectionDirty=!0,this._frustumDirty=t._frustumDirty,this._frustumDirty||(BE(this._frustum,e.frustum),this._frustumDirty=!1),t._viewInverseTransposeMatrixDirty?this._viewInverseTransposeMatrixDirty=!0:(pn(this._viewInverseTransposeMatrix,e.viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1),im(this._fullViewport,e.fullViewport),this._pixelRatio=e.pixelRatio,this}copyViewFrom(e){this.eye=e.eye,this.center=e.center,this.up=e.up}clone(){return new tZ().copyFrom(this)}equals(e){return Oc(this.eye,e.eye)&&Oc(this._center,e.center)&&Oc(this._up,e.up)&&SI(this._viewport,e.viewport)&&SI(this._padding,e.padding)&&Iie(this._nearFar,e.nearFar)&&this._fov===e.fov&&this._pixelRatio===e.pixelRatio&&this.relativeElevation===e.relativeElevation}almostEquals(e){if(this._pixelRatio!==e.pixelRatio||Math.abs(e.fov-this._fov)>=.001)return!1;const t=5e-4,r=1-1e-10;tl(ps,e.eye,e.center),tl(EO,this.eye,this._center);const n=me(ps,EO),s=y5(ps),a=y5(EO);return n*n>=r*s*a&&Y7(e.eye,this.eye)<Math.max(s,a)*t*t&&R5(e.padding,this._padding)<.5&&R5(e.viewport,this._viewport)<.5}computeRenderPixelSizeAt(e){return this.computeRenderPixelSizeAtDist(this._viewDirectionDistance(e))}computeRenderPixelSizeAtDist(e){return e*this.perRenderPixelRatio}computeScreenPixelSizeAt(e){return this.computeScreenPixelSizeAtDist(this._viewDirectionDistance(e))}_viewDirectionDistance(e){return Math.abs(Mb(this.viewForward,ne(ps,e,this.eye)))}computeScreenPixelSizeAtDist(e){return e*this.perScreenPixelRatio}computeDistanceFromRadius(e,t){return e/Math.tan(Math.min(this.fovX,this.fovY)/(2*(t||1)))}getScreenCenter(e=zi()){return e[0]=(this.padding[Xe.LEFT]+this.width/2)/this._pixelRatio,e[1]=(this.padding[Xe.TOP]+this.height/2)/this._pixelRatio,e}getRenderCenter(e,t=.5,r=.5){return e[0]=this.padding[Xe.LEFT]+this.width*t,e[1]=this.padding[Xe.BOTTOM]+this.height*r,e[2]=.5,e}setGLViewport(e){const t=this.viewport,r=this.padding;e.setViewport(t[0]-r[3],t[1]-r[2],t[2]+r[1]+r[3],t[3]+r[0]+r[2])}applyProjection(e,t){e!==ot&&q(ot,e),ot[3]=1,sd(ot,ot,this.projectionMatrix);const r=Math.abs(ot[3]);Q(ot,ot,1/r);const n=this.fullViewport;t[0]=dt(0,n[0]+n[2],.5+.5*ot[0]),t[1]=dt(0,n[1]+n[3],.5+.5*ot[1]),t[2]=.5*(ot[2]+1),t[3]=r}unapplyProjection(e,t){const r=this.fullViewport;ot[0]=(e[0]/(r[0]+r[2])*2-1)*e[3],ot[1]=(e[1]/(r[1]+r[3])*2-1)*e[3],ot[2]=(2*e[2]-1)*e[3],ot[3]=e[3],sd(ot,ot,this.inverseProjectionMatrix),t[0]=ot[0],t[1]=ot[1],t[2]=ot[2]}projectToScreen(e,t){return this.projectToRenderScreen(e,PO),this.renderToScreen(PO,t),t}projectToRenderScreen(e,t){if(ot[0]=e[0],ot[1]=e[1],ot[2]=e[2],ot[3]=1,sd(ot,ot,this.viewProjectionMatrix),ot[3]===0)return null;Q(ot,ot,1/Math.abs(ot[3]));const r=this.fullViewport;return"x"in t?(t.x=dt(0,r[0]+r[2],.5+.5*ot[0]),t.y=dt(0,r[1]+r[3],.5+.5*ot[1])):(t[0]=dt(0,r[0]+r[2],.5+.5*ot[0]),t[1]=dt(0,r[1]+r[3],.5+.5*ot[1]),t.length>2&&(t[2]=.5*(ot[2]+1))),t}unprojectFromScreen(e,t){return this.unprojectFromRenderScreen(this.screenToRender(e,PO),t)}unprojectFromRenderScreen(e,t){if(Hr(ZT,this.projectionMatrix,this.viewMatrix),!kn(ZT,ZT))return null;const r=this.fullViewport;return ot[0]=2*(e[0]-r[0])/r[2]-1,ot[1]=2*(e[1]-r[1])/r[3]-1,ot[2]=2*e[2]-1,ot[3]=1,sd(ot,ot,ZT),ot[3]===0?null:(t[0]=ot[0]/ot[3],t[1]=ot[1]/ot[3],t[2]=ot[2]/ot[3],t)}constrainWindowSize(e,t,r,n=r){const s=e*this._pixelRatio,a=t*this._pixelRatio,o=Math.max(s-r/2,0),l=Math.max(this.fullHeight-a-n/2,0),c=-Math.min(s-r/2,0),u=-Math.min(this.fullHeight-a-n/2,0);return[o,l,r-c- -Math.min(this.fullWidth-s-r/2,0),n-u- -Math.min(a-n/2,0)]}computeUp(e){e===Se.Global?this._computeUpGlobal():this._computeUpLocal()}screenToRender(e,t){const r=e[0]*this._pixelRatio,n=this.fullHeight-e[1]*this._pixelRatio;return t[0]=r,t[1]=n,t}renderToScreen(e,t){const r=e[0]/this._pixelRatio,n=(this.fullHeight-e[1])/this._pixelRatio;t[0]=r,t[1]=n}_computeUpGlobal(){ne(ps,this.center,this.eye);const e=_e(this.center);e<1?(Z(this._up,0,0,1),this._markViewDirty()):Math.abs(me(ps,this.center))>.9999*_e(ps)*e||(nt(this._up,ps,this.center),nt(this._up,this._up,ps),he(this._up,this._up),this._markViewDirty())}_computeUpLocal(){Yg(ps,this.eye,this.center),Math.abs(ps[2])<=.9999&&(Q(ps,ps,ps[2]),Z(this._up,-ps[0],-ps[1],1-ps[2]),he(this._up,this._up),this._markViewDirty())}_compareAndSetView(e,t){typeof e[0]=="number"&&isFinite(e[0])&&typeof e[1]=="number"&&isFinite(e[1])&&typeof e[2]=="number"&&isFinite(e[2])?Oc(e,t)||(q(t,e),this._markViewDirty()):J.getLogger("esri.views.3d.webgl-engine.lib.Camera").warn("Camera vector contains invalid number, ignoring value")}_markViewDirty(){this._viewDirty=!0,this._frustumDirty=!0,this._viewProjectionDirty=!0}_recomputeFrustum(){this._frustumDirty&&(WG(this.viewMatrix,this.projectionMatrix,this._frustum),this._frustumDirty=!1)}_ensureViewClean(){this._viewDirty&&(vD(this._viewMatrix,this.eye,this._center,this._up),Z(this._viewForward,-this._viewMatrix[2],-this._viewMatrix[6],-this._viewMatrix[10]),Z(this._viewUp,this._viewMatrix[1],this._viewMatrix[5],this._viewMatrix[9]),Z(this._viewRight,this._viewMatrix[0],this._viewMatrix[4],this._viewMatrix[8]),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0)}};const ot=_i(),ZT=ve(),ps=R(),EO=R(),PO=is();var Xe;(function(i){i[i.TOP=0]="TOP",i[i.RIGHT=1]="RIGHT",i[i.BOTTOM=2]="BOTTOM",i[i.LEFT=3]="LEFT"})(Xe||(Xe={}));const U2={desiredScreenFlow:2,minDuration:Rt(500),maxDuration:Rt(8e3)};let Yve=class iZ{constructor(e){this._createCamera=e,this.compared={sourceZoom:0,targetZoom:0,pan:0,rotate:0},this.settings={desiredScreenFlow:U2.desiredScreenFlow},this.source=e(),this.target=e()}clone(){const e=new iZ(this._createCamera);return e.copyFrom(this),e}copyFrom(e){this.update(e.source,e.target,e.settings)}update(e,t,r){this.source!==e&&this.source.copyFrom(e),this.target!==t&&this.target.copyFrom(t),this.compared=this.source.compareTo(this.target,this.compared),this.settings.desiredScreenFlow=r.desiredScreenFlow!=null?r.desiredScreenFlow:U2.desiredScreenFlow,this.desiredPixelFlow=this.settings.desiredScreenFlow*this.target.size,this.halfWindowSize=this.target.size/2}halfWindowPanAtZoom(e){const t=this.target.pixelsPerPanAtZoom(e);return this.halfWindowSize/t}get hasZoom(){return Math.abs(this.compared.sourceZoom-this.compared.targetZoom)>1e-5}get hasPan(){return this.compared.pan>1e-9}get hasRotate(){return this.compared.rotate>1e-9}},Kve=class{constructor(){this.segments=[]}get time(){return this.segments.reduce((e,t)=>fc(e+t.time),fc(0))}interpolateComponentsAt(e,t){e=Math.min(Math.max(e,0),1),e*=this.time;let r=0,n=0;const s=this.definition;for(let a=0;a<this.segments.length;a++){const o=this.segments[a],l=o.definition;if(e<=o.time||a===this.segments.length-1){if(t=this.segmentInterpolateComponentsAt(o,o.time===0?0:e/o.time,t),s.hasPan&&!isNaN(t.pan)&&isFinite(s.compared.pan)?t.pan=(r+l.compared.pan*t.pan)/s.compared.pan:t.pan=1,s.hasRotate&&!isNaN(t.rotate)&&isFinite(s.compared.rotate)?t.rotate=(n+l.compared.rotate*t.rotate)/s.compared.rotate:t.rotate=1,s.hasZoom&&!isNaN(t.zoom)&&isFinite(l.compared.targetZoom)){const c=t.zoom*(l.compared.targetZoom-l.compared.sourceZoom)+l.compared.sourceZoom,u=this.segments[0].definition.compared.sourceZoom,d=this.segments[this.segments.length-1].definition.compared.targetZoom;t.zoom=(c-u)/(d-u)}else t.zoom=1;return t}e-=o.time,r+=l.compared.pan,n+=l.compared.rotate}}segmentInterpolateComponentsAt(e,t,r){return e.interpolateComponentsAt(t,r)}},RO=class{constructor(e){e&&this.update(e)}get time(){return this._time}update(e){e&&(this.definition?this.definition.copyFrom(e):this.definition=e.clone()),this._updatePrecomputedVariables(),this._updatePixelFlow()}_updatePrecomputedVariables(){const e=this.definition,t=e.compared,r=t.sourceZoom,n=t.targetZoom;this._zoomSign=r>n?1:-1,this._panPixelsAtSource=t.pan*e.source.pixelsPerPanAtZoom(r);const s=(e.source.pixelsPerRotateAtZoom(r)+e.target.pixelsPerRotateAtZoom(n))/2;this._rotatePixels=t.rotate*s}_updatePixelFlow(){const e=this.definition.compared.sourceZoom,t=this.definition.compared.targetZoom,{hasZoom:r,hasPan:n,hasRotate:s}=this.definition;let a=0,o=0;r&&(n&&(a=(t/e-1)/(-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2*this._panPixelsAtSource)),s&&(o=this._zoomSign*(Math.log(e/t)/Math.LN2)*this.definition.halfWindowSize/this._rotatePixels)),this._zoomPixelFlow=0,this._panPixelFlow=0,this._rotatePixelFlow=0;const l=this.definition.desiredPixelFlow;if(r&&n&&s){const c=a+o+a*o;this._zoomPixelFlow=a*o/c*l,this._panPixelFlow=o/c*l,this._rotatePixelFlow=a/c*l}else if(r&&n){const c=1+a;this._zoomPixelFlow=a/c*l,this._panPixelFlow=1/c*l}else if(r&&s){const c=1+o;this._zoomPixelFlow=o/c*l,this._rotatePixelFlow=1/c*l}else if(n&&s){const c=this._panPixelsAtSource/this._rotatePixels,u=1+c;this._panPixelFlow=c/u*l,this._rotatePixelFlow=1/u*l}else n?this._panPixelFlow=l:r?this._zoomPixelFlow=l:s&&(this._rotatePixelFlow=l);this._time=s?this.rotateTime:r?this.zoomTime:n?this.panTime:fc(0)}get rotateTime(){return this.definition.hasRotate?fc(this._rotatePixels/this._rotatePixelFlow):fc(0)}get zoomTime(){return this.definition.hasZoom?fc(this._zoomSign*(Math.log(this.definition.compared.sourceZoom/this.definition.compared.targetZoom)/Math.LN2)*this.definition.halfWindowSize/this._zoomPixelFlow):fc(0)}get panTime(){if(this.definition.hasPan){if(this.definition.hasZoom){const e=-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2,t=e*this._panPixelsAtSource;return fc(Math.log(t*(this._zoomPixelFlow/this._panPixelFlow)+1)/(e*this._zoomPixelFlow))}return fc(this._panPixelsAtSource/this._panPixelFlow)}return fc(0)}_interpolateComponentsZoom(e){if(e===0||e===1)return e;if(this.definition.hasZoom){const t=this.definition.compared.sourceZoom,r=this.definition.compared.targetZoom;return(t*(t/r)**-e-t)/(r-t)}return e}_interpolateComponentsPan(e){if(e===0||e===1)return e;if(this.definition.hasPan&&this.definition.hasZoom){const t=-1/(this._zoomSign*this.definition.halfWindowSize)*this._zoomPixelFlow;return 1/this._panPixelsAtSource*(this._panPixelFlow*(2**(t*e*this._time)-1))/(t*Math.LN2)}return e}_interpolateComponentsRotate(e){return e}interpolateComponentsAt(e,t){e=Math.min(Math.max(e,0),1);const r=this._interpolateComponentsZoom(e),n=this._interpolateComponentsPan(e),s=this._interpolateComponentsRotate(e);return t?(t.zoom=r,t.pan=n,t.rotate=s):t={zoom:r,pan:n,rotate:s},t}};function Jve(i,e,t){const r=e-i.compared.sourceZoom,n=i.halfWindowPanAtZoom(r);return-i.halfWindowSize*(t.ascensionFactor*Math.LN2*i.compared.pan+n)*Math.log(i.compared.sourceZoom/e)/(i.desiredPixelFlow*Math.LN2*n)}function e1e(i,e,t){const r=1/e,n=Math.log(i.compared.sourceZoom*r),s=1/i.desiredPixelFlow,a=1/Math.LN2,o=e-i.compared.sourceZoom,l=1/o,c=(t.ascensionFactor*Math.LN2*i.compared.pan+i.halfWindowPanAtZoom(o))/i.halfWindowPanAtZoom(1);return i.halfWindowSize*r*s*a*l*c-i.halfWindowSize*n*s*a*l+i.halfWindowSize*n*s*a*c/(o*o)}function t1e(i,e,t){const r=e-i.compared.sourceZoom,n=1/r,s=1/e,a=Math.log(i.compared.sourceZoom*s),o=(t.ascensionFactor*Math.LN2*i.compared.pan+i.halfWindowPanAtZoom(r))/i.halfWindowPanAtZoom(1);return i.halfWindowSize*n*(-2*n*s*o+2*n*a+2*s-2*a*o/(r*r)-o/(e*e))/(i.desiredPixelFlow*Math.LN2)}function i1e(i,e){return-i.halfWindowSize*Math.log(i.compared.sourceZoom/e)/(i.desiredPixelFlow*Math.LN2)}function r1e(i,e){return i.halfWindowSize/(e*i.desiredPixelFlow*Math.LN2)}function n1e(i,e){return-i.halfWindowSize/(e*e*i.desiredPixelFlow*Math.LN2)}function s1e(i,e,t){return-i.compared.pan*i.halfWindowSize*(t.ascensionFactor+t.descensionFactor-1)/(i.desiredPixelFlow*i.halfWindowPanAtZoom(e))}function a1e(i,e,t){return i.compared.pan*i.halfWindowSize*(t.ascensionFactor+t.descensionFactor-1)/(i.desiredPixelFlow*i.halfWindowPanAtZoom(e*e))}function o1e(i,e,t){return-2*i.compared.pan*i.halfWindowSize*(t.ascensionFactor+t.descensionFactor-1)/(i.desiredPixelFlow*i.halfWindowPanAtZoom(e*e*e))}function l1e(i,e,t){return i.halfWindowSize*(-i.halfWindowPanAtZoom(e)-t.descensionFactor*Math.LN2*i.compared.pan+i.halfWindowPanAtZoom(i.compared.targetZoom))*Math.log(e/i.compared.targetZoom)/(i.desiredPixelFlow*Math.LN2*i.halfWindowPanAtZoom(-e+i.compared.targetZoom))}function c1e(i,e,t){const r=Math.log(e/i.compared.targetZoom),n=1/i.desiredPixelFlow,s=1/Math.LN2,a=-e+i.compared.targetZoom,o=1/a,l=(-i.halfWindowPanAtZoom(e)-t.descensionFactor*Math.LN2*i.compared.pan+i.halfWindowPanAtZoom(i.compared.targetZoom))/i.halfWindowPanAtZoom(1);return-i.halfWindowSize*r*n*s*o+i.halfWindowSize*r*n*s*l/(a*a)+i.halfWindowSize*n*s*o*l/e}function h1e(i,e,t){const r=e-i.compared.targetZoom,n=1/r,s=1/e,a=Math.log(e/i.compared.targetZoom),o=(i.halfWindowPanAtZoom(e)+t.descensionFactor*Math.LN2*i.compared.pan-i.halfWindowPanAtZoom(i.compared.targetZoom))/i.halfWindowPanAtZoom(1);return i.halfWindowSize*n*(-2*n*s*o-2*n*a+2*s+2*a*o/(r*r)-o/(e*e))/(i.desiredPixelFlow*Math.LN2)}function u1e(i,e){return i.halfWindowSize*Math.log(e/i.compared.targetZoom)/(i.desiredPixelFlow*Math.LN2)}function d1e(i,e){return i.halfWindowSize/(e*i.desiredPixelFlow*Math.LN2)}function p1e(i,e){return-i.halfWindowSize/(e*e*i.desiredPixelFlow*Math.LN2)}function m1e(i){const e=Math.LN2*i.compared.pan,t=i.compared.sourceZoom-i.compared.targetZoom,r=i.halfWindowPanAtZoom(t),n=i.halfWindowSize*Math.log(i.compared.sourceZoom/i.compared.targetZoom)/(i.desiredPixelFlow*Math.LN2*r);return i.compared.sourceZoom<=i.compared.targetZoom?n*(e-r):n*(e+r)}function f1e(i,e){let t=g1e(i,e);const r={ascensionFactor:e.ascensionFactor!=null?e.ascensionFactor:.5,descensionFactor:e.descensionFactor!=null?e.descensionFactor:.5},n=r.ascensionFactor===0,s=r.descensionFactor===0,a=n?i1e:Jve,o=n?r1e:e1e,l=n?n1e:t1e,c=s?u1e:l1e,u=s?d1e:c1e,d=s?p1e:h1e,m=T=>a(i,T,r)+s1e(i,T,r)+c(i,T,r),f=T=>o(i,T,r)+a1e(i,T,r)+u(i,T,r),_=T=>l(i,T,r)+o1e(i,T,r)+d(i,T,r);let g=m(t);const x=m1e(i);let b;const v=e.maximumIterations||20,w=e.maximumDistance!=null?e.maximumDistance:1/0;for(b=0;b<v;b++){const E=(f(t)+1e-6)/_(t);if(isNaN(E)||t>=w&&E<0){if(!isFinite(w))return null;t=w,g=m(t);break}if(t-=E,t<i.compared.sourceZoom||t<i.compared.targetZoom)return null;const C=m(t);if(Math.abs(C-g)/g<=.005)break;g=C}return g>x*(1-.3)||t<i.compared.sourceZoom||t<i.compared.targetZoom?null:t}function g1e(i,e){const t=Math.max(i.compared.sourceZoom,i.compared.targetZoom),r=i.source.zoomAtPixelsPerPan(i.desiredPixelFlow/i.compared.pan)/2;return r<t?e.maximumDistance!=null?t+(e.maximumDistance-t)/2:1.5*t:e.maximumDistance?Math.min(e.maximumDistance,r):r}let _1e=class extends Kve{constructor(e,t){super(),this._preallocSegments=[new RO,new RO,new RO],this.update(e,t)}update(e,t){if(!e)return;this.definition?this.definition.copyFrom(e):this.definition=e.clone();let r=null;t&&t.apex&&(r=f1e(e,t.apex)),this.segments.length=0,this._ascensionSegment=null,this._descensionSegment=null,r==null?this._updateWithoutApex():this._updateWithApex(r,t.apex)}segmentInterpolateComponentsAt(e,t,r){return r=e.interpolateComponentsAt(t,r),e===this._ascensionSegment?r.zoom=VN(r.zoom):e===this._descensionSegment&&(r.zoom=xR(r.zoom)),r}_updateWithApex(e,t){const[r,n,s]=this._preallocSegments,a=t.ascensionFactor!=null?t.ascensionFactor:.5,o=Math.min(1-a,t.ascensionFactor!=null?t.descensionFactor:.5),l=1-a-o;r.definition?r.definition.copyFrom(this.definition):r.definition=this.definition.clone(),r.definition.compared.targetZoom=e,r.definition.compared.pan=this.definition.compared.pan*a,r.definition.compared.rotate=this.definition.compared.rotate*a,r.update(),this._ascensionSegment=r,this.segments.push(r),l>0&&(n.definition?n.definition.copyFrom(this.definition):n.definition=this.definition.clone(),n.definition.copyFrom(this.definition),n.definition.compared.sourceZoom=e,n.definition.compared.targetZoom=e,n.definition.compared.pan=this.definition.compared.pan*l,n.definition.compared.rotate=this.definition.compared.rotate*l,n.update(),this.segments.push(n)),s.definition?s.definition.copyFrom(this.definition):s.definition=this.definition.clone(),s.definition.compared.sourceZoom=e,s.definition.compared.pan=this.definition.compared.pan*o,s.definition.compared.rotate=this.definition.compared.rotate*o,s.update(),this._descensionSegment=s,this.segments.push(s)}_updateWithoutApex(){const[e]=this._preallocSegments;e.update(this.definition),this.segments.push(e)}};const y1e={zoom:0,pan:0,rotate:0};let v1e=class{constructor(e){this._createCamera=e,this._time=Rt(0),this.definition=new Yve(e),this.path=new _1e}get time(){return this._time}update(e,t,r){this.definition.update(e,t,r),this.path.update(this.definition,r),this._time=this._applyTimeSettings(h7(isFinite(this.path.time)?this.path.time:fc(0)),r),this._easing=r.easing?r.easing:this._time>=1e3?eZ:Zx}cameraAt(e,t){t=t||this._createCamera(),e=Math.min(Math.max(0,e),1),e=this._normalizedEasing(e);const r=this.path.interpolateComponentsAt(e,y1e);return t.interpolate(this.definition.source,this.definition.target,r),t}_normalizedEasing(e){const t=this._easing(0,this._time),r=this._easing(1,this._time);return(this._easing(e,this._time)-t)/(r-t)}_applyTimeSettings(e,t){const r=t.speedFactor!=null?t.speedFactor:1;t.duration!=null?e=t.duration:t.speedFactor!=null&&(e=Rt(e/r));const n=t.minDuration!=null?t.minDuration:U2.minDuration/r,s=t.maxDuration!=null?t.maxDuration:U2.maxDuration/r;return Rt(Math.min(Math.max(n,e),s))}};const b1e=R();let w1e=class{constructor(e){this.currentTime=Rt(0),this._animation=new v1e(()=>new Q6(e)),this._current=new Q6(e)}get finished(){return this.currentTime>=this._animation.time}get time(){return this._animation.time}update(e,t,r){const n=this._animation.definition.source,s=this._animation.definition.target,a=ne(b1e,t.center,e.center),o=_e(a);o>=1e-5?(a[0]/=o,a[1]/=o,a[2]/=o):(a[0]=0,a[1]=1,a[0]=0),q(n.lookAtDirection,a),q(s.lookAtDirection,a),n.copyFromRenderCamera(e),s.copyFromRenderCamera(t),this._current.copyFrom(n),this._animation.update(n,s,r),this.currentTime=Rt(0),e.almostEquals(t)&&(this.currentTime=this._animation.time)}cameraAt(e,t){return this._animation.cameraAt(e,this._current),t=t||new yi,this._current.copyToRenderCamera(t),t}step(e,t){return this.finished||(this.currentTime=Rt(this.currentTime+h7(e)),this.currentTime>=this.time&&(this.currentTime=this.time)),this.cameraAt(this.currentTime/this.time,t)}};var Vi;(function(i){i.Ready="ready",i.Rejected="rejected",i.Running="running",i.Stopped="stopped",i.Finished="finished"})(Vi||(Vi={}));let ed=class extends ue{constructor(e){super(e),this.state=Vi.Ready}get active(){return this.state===Vi.Running}get isInteractive(){return!1}get canStop(){return!1}stopController(){return!!this.canStop&&(this.state=Vi.Stopped,!0)}finishController(){this.state=Vi.Finished}get steppingFinished(){return!1}};h([p({constructOnly:!0})],ed.prototype,"view",void 0),h([p({readOnly:!0})],ed.prototype,"active",null),h([p()],ed.prototype,"state",void 0),h([p({readOnly:!0})],ed.prototype,"isInteractive",null),ed=h([D("esri.views.3d.state.controllers.CameraController")],ed);let ax=class extends ed{constructor(){super(...arguments),this._asyncResult=null}get canStop(){return!0}set asyncResult(e){this._asyncResult&&(this._asyncResult.reject(ts()),this._asyncResult=null),this.state===Vi.Finished||this.state===Vi.Stopped?(Uee(e),this.state===Vi.Finished?e.resolve():e.reject(ts())):this._asyncResult=e}get asyncResult(){return this._asyncResult}onControllerStart(){this.state=Vi.Running,y(this.viewAnimation)&&this.viewAnimation.when(()=>this.updateStateFromViewAnimation(),()=>this.updateStateFromViewAnimation())}updateStateFromViewAnimation(){!y(this.viewAnimation)||this.state!==Vi.Ready&&this.state!==Vi.Running||(this.viewAnimation.state===Md.State.FINISHED?this.finish():this.viewAnimation.state===Md.State.STOPPED&&(this.state=Vi.Stopped))}onControllerEnd(){y(this.viewAnimation)&&!this.viewAnimation.done&&(this.state===Vi.Finished?this.viewAnimation.finish():this.state===Vi.Stopped&&this.viewAnimation.stop()),this._asyncResult&&(this.state===Vi.Finished?this._asyncResult.resolve():this._asyncResult.reject(ts()))}finish(){this.finishController()}};ax=h([D("esri.views.3d.state.controllers.AnimationController")],ax);let md=class extends ax{constructor(e){super(e),this.mode="interaction",this._hasTarget=!1}get intersectionHelper(){return this.view.sceneIntersectionHelper}initialize(){this.animation=new w1e(this.view.state.viewingMode),this.viewAnimation=this.mode==="interaction"?null:new Md}get isInteractive(){return this.mode==="interaction"}begin(e,t){this._hasTarget=!0;const r=this.animationSettings(t);YT.copyFrom(this.view.state.camera);const n=Xl(this.view.state.viewingMode);this.intersectionHelper.intersectRay(YT.ray,n,Z6)&&(YT.center=Z6),this.animation.update(YT,e,r),this.animation.finished&&this.finish()}finish(){this.animation.currentTime=this.animation.time,super.finish()}get steppingFinished(){return this._hasTarget&&this.animation.finished}stepController(e,t){this._hasTarget&&this.animation.step(e,t)}onControllerEnd(e){this._hasTarget&&(this.animation.cameraAt(this.animation.currentTime/this.animation.time,e),this.animation.currentTime=this.animation.time),super.onControllerEnd(e)}animationSettings(e={}){return{apex:{maximumDistance:this.view.state.constraints.clampAltitude(1/0)/6,ascensionFactor:void 0,descensionFactor:void 0},...e,easing:typeof e.easing=="string"?Hve[e.easing]:e.easing}}};h([p({constructOnly:!0})],md.prototype,"mode",void 0),h([p({readOnly:!0})],md.prototype,"isInteractive",null),md=h([D("esri.views.3d.state.controllers.PointToPointAnimationController")],md);const YT=new yi,Z6=R();function TR(i=T1e){return[i[0],i[1],i[2],i[3]]}function ox(i,e){return x1e(i[0],i[1],i[2],e,ore.get())}function x1e(i,e,t,r,n=TR()){return n[0]=i,n[1]=e,n[2]=t,n[3]=r,n}function qN(i,e,t){return nt(t,i,e),he(t,t),t[3]=rG(i,e),t}const T1e=[0,0,1,0];function rZ(i,e,t){return C1e(i,i.screenToRender(e,G0(ze.get())),t)}function C1e(i,e,t){const r=G0(wn(ze.get(),e));if(r[2]=0,!i.unprojectFromRenderScreen(r,t.origin))return null;const n=G0(wn(ze.get(),e));n[2]=1;const s=i.unprojectFromRenderScreen(n,ze.get());return S(s)?null:(ne(t.direction,s,t.origin),t)}function Cv(i,e,t){return WN(i,i.screenToRender(e,G0(ze.get())),t)}function WN(i,e,t){q(t.origin,i.eye);const r=Z(ze.get(),e[0],e[1],1),n=i.unprojectFromRenderScreen(r,ze.get());return S(n)?null:(ne(t.direction,n,t.origin),t)}function XN(i,e,t,r){const n=Cv(e,t,S1e);return PP(i,n,r)}const S1e=oo();var av;(function(i){i[i.Ellipsoid=0]="Ellipsoid",i[i.Silhouette=1]="Silhouette"})(av||(av={}));const nZ=30,z2=[1,3e8],sZ=70;function wg(i,e,t){return t[0]=e[0]/(i.fullWidth/i.pixelRatio),t[1]=e[1]/(i.fullHeight/i.pixelRatio),t}function DL(i){for(;i>Math.PI;)i-=2*Math.PI;for(;i<-Math.PI;)i+=2*Math.PI;return i}function Um(i,e,t){const r=Bc(lre.get(),t[3],t);S(r)||mre(r,rn)||(ne(ci,i.eye,e),Ce(ci,ci,r),i.eye=oe(ci,ci,e),ne(ci,i.center,e),Ce(ci,ci,r),i.center=oe(ci,ci,e),i.up=Ce(ci,i.up,r))}function E1e(i,e,t,r){return Kg(i,rZ(e,t,YN),r)}function FL(i,e,t,r){return Kg(i,Cv(e,t,YN),r)}function QN(i,e,t,r){const n=ze.get();let s=1-t;ne(n,e,i.eye);const a=_e(n);let o=a*(1-s);s>=0&&o<r&&(o=r,s=-(o-a)/a),Math.abs(a-o)<1e-6||(Q(n,n,s),i.eye=oe(ci,i.eye,n),i.center=Bn(ci,i.center,e,s))}function aZ(i,e,t){e.getScreenCenter(Y6),XN(i,e,Y6,ci)&&(e.center=ci);const r=e.distance,n=r*t;if(Math.abs(r-n)<1e-6)return;const s=Q(ze.get(),e.viewForward,n);e.eye=ne(ci,e.center,s)}const Y6=zi();function AO(i,e){Z(e,0,0,0);for(const t of i)oe(e,e,t);Q(e,e,1/i.length)}function rE(i,e,t,r){return Math.sin(i/_e(e))*(t+r.radius)}function K6(i,e,t,r){return rE(Math.PI/2,e,t,r)+(i-Math.PI/2)}var Dn;(function(i){i[i.Vertical=0]="Vertical",i[i.Horizontal=1]="Horizontal"})(Dn||(Dn={}));const J6={Elevation:3e4,Angle:Ct(6)},KT={Pole:.95,Angle:Ct(18),Tilt:45},oZ=Ct(80);function lZ(i,e,t,r,n,s){const a=R(),o=ou();let l=!0,c=!0;return i.intersectScreen(t,a,s)?o[3]=_e(a):(c=!1,e.aboveGround&&n!==av.Ellipsoid?o[3]=Math.max(_e(e.center),.9*r.radius):o[3]=_e(e.eye)-e.relativeElevation,n===av.Silhouette?lx(o,e,t,a):l=XN(o,e,t,a)),{sphere:o,scenePickPoint:l?a:null,hasGeometryIntersection:c}}function CR(i,e,t,r){return _e(i.eye)-r.radius>J6.Elevation?Dn.Horizontal:t?(Cv(i,e,oU),-Math.sign(i.relativeElevation)*(.5*Math.PI+rG(i.eye,oU.direction))<J6.Angle?Dn.Vertical:Dn.Horizontal):Dn.Vertical}function cZ(i,e,t){ne(OO,t,e),i.eye=ne(ci,i.eye,OO),i.center=ne(ci,i.center,OO)}const OO=R();function lx(i,e,t,r){const n=Cv(e,t,YN);return!S(n)&&(RP(i,n,JT),PP(i,n,r)?!(Bl(JT,n.origin)<Bl(r,n.origin))||(q(r,JT),!1):(ne(M_,e.eye,e.center),he(M_,M_),mG(M_,-me(he(M_,M_),JT),eU),Kg(eU,n,r),!1))}const JT=R(),M_=R(),eU=fr();function hZ(i,e,t,r,n,s){let a=0;if(nt(H2,i,e),ne(rC,i,e),_e(i)<=n||!r.aboveGround){nt(t,rC,r.eye);const o=me(i,e)/(_e(i)*_e(e));if(o<.9999)a=ls(o);else{const c=_e(nt(R(),i,e))/(_e(i)*_e(e));a=tu(c)}const l=Math.cos(ce(Sm.normalize(Ct(s)),0,oZ));a=-a-Math.max(0,_e(e)-n)/(l*n)}else ne(tU,r.eye,r.center),nt(t,rC,tU),a=-_e(rC)/n;return he(t,t),Q(t,t,_e(H2)),a}const tU=R();function iU(i,e,t,r){let n,s;const a=Math.cos(ce(Sm.normalize(Ct(r)),0,oZ));return n=e>t?-(e-t)/(a*t):e<-t?Math.PI-(e+t)/(a*t):ls(e/t),s=i>t?-(i-t)/(a*t):i<-t?Math.PI-(i+t)/(a*t):ls(i/t),(s-n)*t}function P1e(i,e,t,r,n,s,a,o,l,c){const u=iU(i[2],e[2],s[3],o),d=l?iU(i[0],e[0],s[3],180):e[0]-i[0],m=Math.sin(a)*d-Math.cos(a)*u,f=Math.cos(a)*d+Math.sin(a)*u;he(ci,n);const _=l?m/Math.sqrt(Math.abs(s[3]**2-me(t,ci)**2)):m/s[3],g=f/Math.sqrt(Math.abs(s[3]**2-me(t,r)**2));Je(c,_,g)}function uZ(i,e,t,r,n,s,a,o,l,c){nt(H2,i,e),lL(s.up,s.eye,eC,tC,iC),lL([0,0,1],s.eye,gd,xm,fZ),q(t,xm),q(r,gd),he(t,t),Q(t,t,_e(H2)),r6(i,he(tC,tC),he(iC,iC),he(eC,eC),rU),r6(e,tC,iC,eC,nU),P1e(rU,nU,i,gd,xm,a,o,l,c,n)}function R1e(i,e,t,r,n,s,a){Bc(B2,n,r),Bc(G2,a,s),Hr(d0,B2,G2),ne(e,i,t),Ce(e,e,d0),oe(e,e,t)}function dZ(i,e,t,r,n,s){Bc(B2,r,t),Bc(G2,s,n),Hr(d0,B2,G2),ne(ci,i.eye,e),Ce(ci,ci,d0),i.eye=oe(ci,ci,e),ne(ci,i.center,e),Ce(ci,ci,d0),i.center=oe(ci,ci,e),ne(ci,i.up,e),Ce(ci,ci,d0),i.up=oe(ci,ci,e)}function ZN(i,e,t,r,n,s){return(Math.abs(r)>Math.PI-KT.Angle||Math.abs(r)<KT.Angle)&&(Math.abs(i[2])<t*KT.Pole||Math.abs(e)>t)&&s.aboveGround&&n<KT.Tilt}function pZ(i,e,t,r,n,s){if(s)qN(t,r,sU),Um(e,i,sU);else{const a=hZ(t,r,aU,e,i[3],n);Um(e,i,ox(aU,a))}}function mZ(i,e,t,r,n,s,a){const o=a?20:1,l=1e-12;let c,u;q(tf,r),nC.copyFrom(e);for(let d=0;d<o&&Bl(t,tf)>l&&(c=Bl(t,tf),uZ(t,tf,xm,gd,s1,nC,i,n,s,a),dZ(nC,i,gd,s1[1],xm,s1[0]),R1e(tf,tf,i,gd,s1[1],xm,s1[0]),u=Bl(t,tf),u<c||d===0);d++)e.copyFrom(nC)}function A1e(i,e,t,r,n,s,a){ZN(t,me(e.up,t),i[3],-Sm.normalize(Ct(n)),s,e)?mZ(i,e,t,r,-Sm.normalize(Ct(n)),s,a):pZ(i,e,t,r,s,a)}function O1e(i,e,t,r,n,s){const{eye:a}=i;lL([0,0,1],a,gd,xm,fZ);const o=e.translation[0]*t.pan,l=n.mode==="zoom"?0:e.translation[1]*t.pan,c=Math.max(Math.sqrt(Math.abs(1-me(i.center,gd)**2/_e(i.center)**2)),.5),u=(Math.sin(s)*l+Math.cos(s)*o)/c,d=-Math.cos(s)*l+Math.sin(s)*o;switch(kl(r.pan.matrix,r.pan.matrix,u,gd),r.pan.enabled=!0,n.mode){case"pan":kl(r.pan.matrix,r.pan.matrix,d,xm),r.pan.enabled=!0;break;case"zoom":r.zoom=-e.translation[1]*t.zoom}}function M1e(i,e,t,r,n){const{eye:s,viewRight:a}=i,o=nt(ze.get(),a,s),l=e.translation[0]*t.pan;switch(l!==0&&(kl(r.pan.matrix,r.pan.matrix,-l,o),r.pan.enabled=!0),n.mode){case"pan":{const c=e.translation[1]*t.pan;c!==0&&(kl(r.pan.matrix,r.pan.matrix,c,a),r.pan.enabled=!0);break}case"zoom":r.zoom=-e.translation[1]*t.zoom}}function I1e(i,e,t,r,n,s,a,o,l){ZN(i.center,me(i.up,i.center),_e(i.center),-Sm.normalize(Ct(s)),a,e)?O1e(e,t,r,o,l,-Sm.normalize(Ct(n))):M1e(e,t,r,o,l)}const gd=R(),xm=R(),fZ=R(),eC=R(),tC=R(),iC=R(),rU=R(),nU=R(),s1=be(),sU=TR(),B2=ve(),G2=ve(),d0=ve(),tf=R(),ci=R(),rC=R(),nC=new yi,H2=R(),aU=R(),YN={origin:R(),direction:R()},oU={origin:R(),direction:R()},lU=.6,MO=4,L1e=12,$1e=60,D1e=200;let j2=class extends md{constructor(){super(...arguments),this._zoomLocation=R(),this._tmpCamera=new yi,this._tmpViewDir=R(),this._tmpRayDir={origin:R(),direction:R()},this._targetOnSphere=R(),this._tmpCenter=R(),this._constraintOptions={selection:wi.ALL_EXCEPT_COLLISION,interactionType:rt.ZOOM,interactionFactor:null,interactionStartCamera:new yi,interactionDirection:null,tiltMode:vn.TUMBLE},this._sphere=ou()}initialize(){this._intersector=Xl(this.view.state.viewingMode)}zoomStep(e,t){if(!this.active)return;const r=this.view.state,{interactionStartCamera:n}=this._constraintOptions;this.animation.finished?n.copyFrom(r.camera):this.animation.cameraAt(1,n);let s=!1,a=!1;this.intersectionHelper.intersectScreen(t,this._zoomLocation,this.view.map.ground.opacity===0?F1e:{})&&(s=e>0,a=!0),this._tmpCamera.copyFrom(r.camera),s?this.intersectionHelper.intersectRay(this._tmpCamera.ray,this._intersector,this._tmpCenter)&&(this._tmpCamera.center=this._tmpCenter):this.intersectionHelper.intersectRay(this._tmpCamera.ray,this._intersector,this._zoomLocation)?this._tmpCamera.center=this._zoomLocation:q(this._zoomLocation,this._tmpCamera.center),this._updateCamera(this._tmpCamera,e,this._zoomLocation,t,a),this.begin(this._tmpCamera)}animationSettings(){return{apex:null,duration:Rt(600),easing:Zx}}_updateCamera(e,t,r,n,s){const a=Yt(this.view.spatialReference),o=CR(e,n,s,a);let l;this.view.camera.position.hasZ&&(l=Math.abs(this.view.camera.position.z)),he(aC,e.eye),Q(aC,aC,-1),Cv(e,n,this._tmpRayDir),he(this._tmpRayDir.direction,this._tmpRayDir.direction);const c=Math.max(Math.min(L1e,1/Math.abs(me(aC,this._tmpRayDir.direction)))*l,D1e);if(o===Dn.Horizontal){let u=lU**t;this._sphere[3]=_e(r),ne(this._tmpViewDir,e.center,e.eye);const d=Math.min(_e(this._tmpViewDir),c);let m=d*u;if(u<=1&&m<MO&&(m=MO,u=m/d),Math.abs(d-m)<1e-6)return;const f=_e(e.center);if(this._sphere[3]!==f){const _=this._sphere[3]+u*(f-this._sphere[3]);e.center=Q(sC,e.center,_/f)}Q(this._tmpViewDir,this._tmpViewDir,-u),e.eye=oe(sC,e.center,this._tmpViewDir),pr(this.view,e,this._constraintOptions),Bl(r,e.center)>1e-12&&XN(this._sphere,e,n,this._targetOnSphere)&&A1e(this._sphere,e,r,this._targetOnSphere,this.view.camera.heading,this.view.camera.tilt,!0)}else{let u=lU**Math.abs(t);const d=t>0?1:-1;ne(this._tmpViewDir,r,e.eye);const m=_e(this._tmpViewDir),f=this.view._stage.renderView.getMinimalDepthForArea(null,n[0],n[1],this.view.state.camera,$1e);let _=y(f)?Math.min(c,f):c;_=s?Math.min(_,m):_,Q(this._tmpRayDir.direction,this._tmpRayDir.direction,_),oe(r,this._tmpRayDir.origin,this._tmpRayDir.direction);let g=_*u;const x=Math.max(MO,1.01*e.nearFar[0]);if(t>0&&g<x&&(g=x,u=g/_),Math.abs(_-g)<1e-6)return;Q(this._tmpRayDir.direction,this._tmpRayDir.direction,d*(1-u)),e.eye=oe(sC,e.eye,this._tmpRayDir.direction),e.center=oe(sC,e.center,this._tmpRayDir.direction)}Tv(this.view,e)}};j2=h([D("esri.views.3d.state.controllers.global.ZoomStepController")],j2);const sC=R(),aC=R(),F1e={exclude:new Set([Ac])},N1e=.6,k1e=4,V1e=60,U1e=14,z1e=200;let q2=class extends md{constructor(){super(...arguments),this._zoomLocation=R(),this._tmpCamera=new yi,this._tmpRayDir=R(),this._tmpCenter=R(),this._constraintOptions={selection:wi.ALL,interactionType:rt.ZOOM,interactionFactor:null,interactionStartCamera:new yi,interactionDirection:null,tiltMode:vn.TUMBLE}}zoomStep(e,t){if(!this.active)return;const r=this.view.state,{interactionStartCamera:n}=this._constraintOptions;this.animation.finished?n.copyFrom(r.camera):this.animation.cameraAt(1,n),this._tmpCamera.copyFrom(r.camera);const s=Xl(this.view.state.viewingMode);e>0?(this.view.map.ground.opacity===0?this.intersectionHelper.intersectScreenFreePointFallback(t,this._zoomLocation,G1e):this.intersectionHelper.intersectScreenFreePointFallback(t,this._zoomLocation),this.intersectionHelper.intersectRay(this._tmpCamera.ray,s,this._tmpCenter)&&(this._tmpCamera.center=this._tmpCenter)):this.intersectionHelper.intersectRay(this._tmpCamera.ray,s,this._zoomLocation)?this._tmpCamera.center=this._zoomLocation:q(this._zoomLocation,this._tmpCamera.center);const a=N1e**e;let o=this.view._stage.renderView.getMinimalDepthForArea(this.view.voxelWasm,t[0],t[1],this.view.state.camera,V1e);ne(oC,this._tmpCamera.eye,this._zoomLocation),he(oC,oC);const l=Math.max(Math.min(U1e,1/Math.abs(me(B1e,oC)))*Math.abs(this.view.camera.position.z),z1e);if(o=y(o)?Math.min(o,l):l,o){const c=R();ne(c,this._zoomLocation,this._tmpCamera.eye),o<_e(c)&&(he(c,c),oe(this._zoomLocation,this._tmpCamera.eye,Q(c,c,o)))}this._updateCamera(this._tmpCamera,a,this._zoomLocation),this.begin(this._tmpCamera)}animationSettings(){return{apex:null,duration:Rt(600),easing:Zx}}_updateCamera(e,t,r){ne(this._tmpRayDir,r,e.eye);const n=_e(this._tmpRayDir);let s=n*t;const a=t<=1,o=Math.max(k1e,1.01*e.nearFar[0]);s!==0&&(a&&s<o&&(s=o,t=s/n),Math.abs(n-s)<1e-6||(Q(this._tmpRayDir,this._tmpRayDir,t),e.eye=ne(cU,r,this._tmpRayDir),e.center=Bn(cU,e.center,r,1-t),pr(this.view,e,this._constraintOptions)))}};q2=h([D("esri.views.3d.state.controllers.local.ZoomStepController")],q2);const cU=R(),B1e=Ge(0,0,1),oC=R(),G1e={exclude:new Set([Ac])};let H1e=class extends Ei{constructor(e,t){super(!0),this._view=e,this.registerIncoming("double-click",t,r=>this._handleDoubleClick(r))}_handleDoubleClick(e){const t=e.data;if(hR(t,"primary")){const r=this._view.state.isGlobal?new j2({view:this._view,mode:"animation"}):new q2({view:this._view,mode:"animation"});this._view.state.switchCameraController(r),r.zoomStep(Math.log(.5)/Math.log(.6),zi(t.x,t.y)),e.stopPropagation()}}};function j1e(i,e,t){return i===Se.Global?new W1e(t):new q1e(e,t)}let q1e=class{constructor(e,t){this._elevationProvider=e,this._referenceEllipsoid=Yt(t),this._unitInMeters=Gm(t,this._referenceEllipsoid.metersPerDegree)}compute(e,t,r,n,s){var w;s||(s={near:0,far:0});let a=e[2]*this._unitInMeters;const o=a,l=a-n,c=(w=this._elevationProvider)==null?void 0:w.visibleElevationBounds;c&&(a=l>=0?o-this._unitInMeters*c.min:this._unitInMeters*c.max-o);const u={x:(r=y(r)?r:new ui({xmin:0,ymin:0,zmin:0,xmax:0,ymax:0,zmax:0})).xmax-r.xmin,y:r.ymax-r.ymin,z:4*Math.max(r.xmax-r.xmin,r.ymax-r.ymin)},d=Math.max(u.x,u.y,u.z);ne(rf,t,e),I_[0]=rf[0]>0?r.xmax:r.xmin,I_[1]=rf[1]>0?r.ymax:r.ymin,I_[2]=rf[2]>0?d/2:-d/2,ne(I_,I_,e),he(rf,rf);const m=1.1*me(I_,rf)*this._unitInMeters,f=Math.sqrt(a*(a+2*this._referenceEllipsoid.radius)),_=Math.max(r.xmax-r.xmin,r.ymax-r.ymin),g=_*Z1e*this._unitInMeters,x=_*Y1e*this._unitInMeters;let b=ce((a-x)/(g-x),0,1);b*=b*b;let v=Math.min(dt(f,m,b),f);return v*=Math.max(Math.log(Math.abs(l)),1),v=Math.min(v,Math.max(34064e4,d)),v/=this._unitInMeters,gZ(v,X1e,this._unitInMeters,s)}},W1e=class{constructor(e){this._referenceEllipsoid=Yt(e)}compute(e,t,r,n,s){s||(s={near:0,far:0});const a=_e(e)-this._referenceEllipsoid.radius,o=this._referenceEllipsoid.radius+Math.min(0,n),l=Math.abs(a-n),c=Math.max(l,Math.abs(a));return gZ(1.2*Math.sqrt(c*(c+2*o)),ce(2e4-(Math.log(c)-7.983)/9.011*19e3,1e3,2e4),1,s)}};function gZ(i,e,t,r){const n=Q1e/t;return i/e>n?(r.far=i,r.near=r.far/e):(r.near=n,r.far=r.near*e),r}const X1e=2e4,Q1e=2,Z1e=.001,Y1e=1e-4,I_=R(),rf=R();let nE=class extends ue{constructor(e){super(e),this._handles=new Ft}initialize(){this._handles.add(this.view.basemapTerrain.on("elevation-change",e=>this._handleElevationChangeEvent(e)))}destroy(){this._handles&&(this._handles.destroy(),this._handles=null)}_handleElevationChangeEvent(e){if(this.view.state.cameraController)return;const t=this.view.state.camera;y(e.spatialReference)&&jQ(this.view,t,e.extent,e.spatialReference)&&this._applyToCurrentCamera()}_applyToCurrentCamera(){this.view.state.updateCamera(e=>Tv(this.view,e,zl.EYE_AND_CENTER))}};h([p({constructOnly:!0})],nE.prototype,"view",void 0),nE=h([D("esri.views.3d.state.ElevationCollisionConstraint")],nE);let ub=class extends ue{constructor(e){super(e),this._handles=new Ft,this.nearFarHeuristic=j1e(e.view.state.viewingMode,e.view.basemapTerrain,e.view.renderCoordsHelper.spatialReference)}initialize(){this._handles.add([z(()=>{var e,t,r,n;return[(t=(e=this.view.constraints)==null?void 0:e.clipDistance)==null?void 0:t.near,(n=(r=this.view.constraints)==null?void 0:r.clipDistance)==null?void 0:n.far]},()=>this._clipDistanceNearFarChanged()),z(()=>{var e,t;return(t=(e=this.view.constraints)==null?void 0:e.clipDistance)==null?void 0:t.mode},()=>this._updateNearFar()),this.view.state.events.on("before-camera-change",e=>this._updateCameraNearFar(e.camera)),z(()=>this.view.renderDataExtent,()=>this._updateNearFar(),ri),z(()=>{var e,t,r,n;return[(t=(e=this.view.constraints)==null?void 0:e.altitude)==null?void 0:t.min,(n=(r=this.view.constraints)==null?void 0:r.altitude)==null?void 0:n.max]},()=>this._updateAltitude(),ri),z(()=>{var e,t;return(t=(e=this.view.constraints)==null?void 0:e.tilt)==null?void 0:t.max},()=>this._updateTiltMax(),ri),z(()=>{var e,t;return(t=(e=this.view.constraints)==null?void 0:e.tilt)==null?void 0:t.mode},()=>this._updateTilt(),ri),z(()=>{var e;return(e=this.view.state)==null?void 0:e.camera},()=>this._updateTiltAutoMax(),ri),z(()=>{var e,t,r,n,s,a;return[(r=(t=(e=this.view.map)==null?void 0:e.ground)==null?void 0:t.navigationConstraint)==null?void 0:r.type,(a=(s=(n=this.view.state)==null?void 0:n.constraints)==null?void 0:s.collision)==null?void 0:a.enabled]},()=>this._updateCollision(),ri)]),this.view.state.isLocal&&this._handles.add(z(()=>this.view.renderDataExtent,e=>this._updateLocalSurfaceDistance(e),Qe)),this._updateNearFar(),this.view.state.viewingMode!==Se.Local&&this._updateAltitude(),this._updateTilt(),this._updateCollision(),this._set("surfaceCollisionConstraint",new nE({view:this.view}))}destroy(){this._handles=Te(this._handles),this.surfaceCollisionConstraint&&(this.surfaceCollisionConstraint.destroy(),this._set("surfaceCollisionConstraint",null))}_clipDistanceNearFarChanged(){var t;const e=(t=this.view.constraints)==null?void 0:t.clipDistance;e&&e.mode!=="auto"&&this.view.state.updateCamera(r=>this._updateCameraNearFarManual(r,e))}_updateNearFar(){this.view.state.updateCamera(e=>this._updateCameraNearFar(e))}_updateCameraNearFar(e){const t=this.view.constraints&&this.view.constraints.clipDistance;(t?t.mode:"auto")==="manual"?this._updateCameraNearFarManual(e,t):this._updateCameraNearFarAuto(e,t)}_updateCameraNearFarAuto(e,t){this.nearFarHeuristic.compute(e.eye,e.center,this.view.renderDataExtent,wR(this.view,e.eye),e),t&&t.autoUpdate(e.near,e.far)}_updateCameraNearFarManual(e,t){t&&(e.near=t.near,e.far=t.far)}_updateCollision(){var n,s,a;const e=(a=(s=(n=this.view.map)==null?void 0:n.ground)==null?void 0:s.navigationConstraint)==null?void 0:a.type,t=!e||e==="stay-above",r=this.view.state.constraints.collision;if(t!==r.enabled){r.enabled=t,t&&this._reapplyConstraints(wi.COLLISION);const o=this.view.constraints&&this.view.constraints.tilt;o&&o.mode!=="auto"||this._updateTiltAuto()}}_updateAltitude(){const e=this.view.constraints&&this.view.constraints.altitude;e&&this.view.state.viewingMode!==Se.Local?this.view.state.constraints.altitude={min:e.min,max:e.max}:this.view.state.constraints.altitude=null,this._reapplyConstraints()}_updateTiltMax(){const e=this.view.constraints&&this.view.constraints.tilt;e&&e.mode!=="auto"&&(this._updateTiltManual(e),this._reapplyConstraints())}_updateTilt(){const e=this.view.constraints&&this.view.constraints.tilt;(e?e.mode:"auto")==="manual"?this._updateTiltManual(e):this._updateTiltAuto(),this._reapplyConstraints()}_updateTiltManual(e){const t=this.view.state.constraints;t.tilt=t.createConstantMaxTilt(Ct(e.max))}_updateTiltAuto(){const e=this.view.state.constraints;e.tilt=e.createDefaultTilt(),this._updateTiltAutoMax()}_updateTiltAutoMax(){const e=this.view.constraints&&this.view.constraints.tilt;if(!e||e.mode!=="auto")return;const t=this.view.state.constraints;if(t.tilt){const r=t.tilt(this.view.state.camera.distance).max;e.autoUpdate(_o(r))}}_updateLocalSurfaceDistance(e){if(S(e))return;let t=Math.max(e.width,e.height);if(t<=0)return;e.hasZ&&(t=Math.max(t,e.zmax-e.zmin));const r=this.view.state,n=3*t/Math.atan(r.camera.fov/2);n!==r.constraints.distance&&(r.constraints.distance=n)}_reapplyConstraints(e=wi.ALL){this.view.state.updateCamera(t=>pr(this.view,t,{selection:e,interactionType:rt.NONE,interactionFactor:null,interactionStartCamera:null,interactionDirection:null,tiltMode:vn.TUMBLE}))}};h([p({constructOnly:!0})],ub.prototype,"view",void 0),h([p({readOnly:!0})],ub.prototype,"surfaceCollisionConstraint",void 0),ub=h([D("esri.views.3d.state.ConstraintsManager")],ub);let Yp=class{constructor(e){this.renderCoordsHelper=e,this.frustum=Rw(),this._points=sse(),this.lines=new Array(12),this._origin=R(),this._direction=R(),this._altitude=null;for(let t=0;t<12;t++)this.lines[t]={origin:null,direction:R(),endpoint:null}}get planes(){return this.frustum}get points(){return this._points}get mutablePoints(){return this._points}get direction(){return this._direction}update(e){WG(e.viewMatrix,e.projectionMatrix,this.frustum,this._points),q(this._origin,e.eye),q(this._direction,e.viewForward),this._altitude=this.renderCoordsHelper.getAltitude(this._origin),this._updateLines()}updatePoints(e){for(let t=0;t<this._points.length;t++)q(this._points[t],e[t]);ase(this.frustum,this._points),this._updateLines()}get altitude(){return this._altitude}intersectsSphere(e){return $P(this.frustum,e)}intersectsRay(e){return ose(this.frustum,e)}intersectsLineSegment(e,t){return lse(this.frustum,e,t)}intersectsPoint(e){return XG(this.frustum,e)}_updateLines(){const e=this._points;for(let t=0;t<4;t++){const r=t+4;IO(this.lines[t],e[t],e[r]),IO(this.lines[t+4],e[t],t===3?e[0]:e[t+1]),IO(this.lines[t+8],e[r],t===3?e[4]:e[r+1])}}};function IO(i,e,t){i.origin=e,i.endpoint=t,Yg(i.direction,e,t)}Yp.planePointIndices=cse,Yp.nearFarLineIndices=[[Ti.NEAR_BOTTOM_LEFT,Ti.FAR_BOTTOM_LEFT],[Ti.NEAR_BOTTOM_RIGHT,Ti.FAR_BOTTOM_RIGHT],[Ti.NEAR_TOP_RIGHT,Ti.FAR_TOP_RIGHT],[Ti.NEAR_TOP_LEFT,Ti.FAR_TOP_LEFT]];let Xb=class extends ed{constructor(e){super(e),this._handles=new Ft}set desiredCamera(e){this._set("desiredCamera",e.clone())}get canStop(){return!0}get constraintEnabled(){return this.view.state.constraints.collision.enabled}onControllerStart(){this.state=Vi.Running,this._handles.add(this.view.basemapTerrain.on("elevation-change",e=>this._handleElevationChangeEvent(e))),this._applyCorrection()}onControllerEnd(){this._handles.removeAll()}stepController(){}_handleElevationChangeEvent(e){y(e.spatialReference)&&!jQ(this.view,this.desiredCamera,e.extent,e.spatialReference)||this._applyCorrection()}_applyCorrection(){this.view.state.updateCamera(e=>{e.copyViewFrom(this.desiredCamera),Tv(this.view,e,zl.EYE_AND_CENTER)||this.constraintEnabled||(this.state=Vi.Stopped)})}};h([p({constructOnly:!0})],Xb.prototype,"desiredCamera",null),Xb=h([D("esri.views.3d.state.controllers.SurfaceCollisionCorrectionController")],Xb);const K1e=R(),lC=R();function KN(){return{direction:R(),up:R()}}function _Z(i,e,t,r,n){let s=he(K1e,i),a=me(s,r);const o=a>0;a=Math.abs(a),a>.99&&(a=Math.abs(me(e,r)),a<.99?(q(s,e),o&&Q(s,s,-1)):s=null);let l=0;if(s){Q(lC,r,me(r,s)),ne(s,s,lC);const u=me(s,n)/(_e(s)*_e(n));nt(lC,s,n),l=(me(lC,r)>0?1:-1)*_o(ls(u))}const c=_o(ls(-me(r,i)/_e(i)));return t?(t.heading=l,t.tilt=c,t):{heading:l,tilt:c}}const yZ=Ge(0,1,0),vZ=Ge(0,0,1),a1=ve(),bu=R(),wu=R();function bZ(i,e,t,r=KN()){const{direction:n,up:s}=r;return fre(a1,-Ct(e)),bw(a1,a1,Ct(t)),Ce(n,vZ,a1),Q(n,n,-1),Ce(s,yZ,a1),r}function J1e(i,e,t,r){return _Z(e,t,r,vZ,yZ)}function ebe(i,e,t,r){const n=bZ(i,t,r),s=R();return Q(s,n.direction,-e),oe(s,s,i),{up:n.up,eye:s,heading:t,tilt:r}}function tbe(i){return _o(i)}function ibe(i){return Ct(i)}function wZ(i,e,t,r,n){const s=i.renderSpatialReference,a=i.map&&i.spatialReference||e.spatialReference;return bn(e,bu,s),bn(e,wu,s),bu[0]-=t/2,wu[0]+=t/2,bu[1]-=r/2,wu[1]+=r/2,ss(bu,s,bu,a),ss(wu,s,wu,a),n?(n.xmin=bu[0],n.ymin=bu[1],n.xmax=wu[0],n.ymax=wu[1],n.spatialReference=a):n=new ui(bu[0],bu[1],wu[0],wu[1],a),n}const rbe=Object.freeze(Object.defineProperty({__proto__:null,headingTiltToDirectionUp:bZ,directionToHeadingTilt:J1e,eyeForCenterWithHeadingTilt:ebe,lookAtTiltToEyeTilt:tbe,eyeTiltToLookAtTilt:ibe,toExtent:wZ},Symbol.toStringTag,{value:"Module"})),xZ=Ge(0,0,1),TZ=he(R(),Ge(1,1,1)),nbe=new dw(-180,180),o1=ve(),Hp=R(),L_=R();function CZ(i,e,t,r=KN()){nt(Hp,i,xZ),me(Hp,Hp)===0&&nt(Hp,i,TZ),Bc(o1,-Ct(e),i),kl(o1,o1,-Ct(t),Hp);const{up:n,direction:s}=r;return nt(n,Hp,i),he(n,n),Ce(n,n,o1),he(s,i),Aa(s,s),Ce(s,s,o1),r}function sbe(i,e,t,r){const n=Hp,s=L_;return he(n,i),nt(L_,n,xZ),me(L_,L_)===0&&nt(L_,n,TZ),nt(s,L_,n),_Z(e,t,r,n,s)}function abe(i,e,t,r){const n={eye:R(),up:null,tilt:r,heading:t},s=Hp;s[0]=i[0],s[1]=i[2],s[2]=-i[1];const a=e,o=Ct(t),l=Ct(r),c=Math.sin(o),u=Math.cos(o),d=Math.sin(l),m=Math.cos(l),f=_e(s);let _;if(Math.abs(l)<1e-8)_=a+f;else{const V=f/d,X=tu(a/V),$=Math.PI-l-X;_=V*Math.sin($)}const g=m*a,x=a*a*(d*d),b=u*u*x,v=_-g,w=v*v,T=b*(b+w-s[1]*s[1]);if(T<0)return Q(n.eye,s,_/f),n.tilt=0,n;const E=Math.sqrt(T),C=s[1]*v,A=b+w;let M;if(M=u>0?-E+C:E+C,Math.abs(A)<1e-8)return f<1e-8?(n.eye[0]=0,n.eye[1]=0,n.eye[2]=a):Q(n.eye,s,_/f),n.tilt=0,LO(n.eye),$O(n,i);n.eye[1]=M/A;const I=c*c*x,L=d*a,U=u*L*n.eye[1],j=n.eye[1]*n.eye[1],re=1-j,ee=Math.sqrt(re),H=b*j+I-2*U*ee*v+re*w;return Math.abs(H)<1e-8?(Q(n.eye,s,_/f),n.tilt=0,LO(n.eye),$O(n,i)):(n.eye[0]=(re*(_*s[0]-g*s[0])-L*ee*(s[0]*n.eye[1]*u+s[2]*c))/H,n.eye[2]=(re*(_*s[2]-g*s[2])-L*ee*(s[2]*n.eye[1]*u-s[0]*c))/H,Q(n.eye,n.eye,_),LO(n.eye),$O(n,i))}function LO(i){const e=i[1];i[1]=-i[2],i[2]=e}function $O(i,e){const t=CZ(e,i.heading,i.tilt);return i.up=t.up,i}function obe(i,e,t){const r=_e(e),n=Math.sqrt(t*t+r*r-2*t*r*Math.cos(Math.PI-i)),s=tu(t/(n/Math.sin(i)));return _o(i-s)}function lbe(i,e,t){const r=Ct(i),n=_e(e);return tu(t/(n/Math.sin(r)))+r}function SZ(i,e,t,r,n){let s,a,o,l;const c=e.latitude,u=Yt(i.spatialReference).radius,d=e.longitude,m=T0e(c,t,u)/2;s=d-m,a=d+m;const f=Ct(c),_=(1+Math.sin(f))/(1-Math.sin(f)),g=(_+1)*Math.tan(r/u/2),x=g*g;function b(w){const T=Math.PI/2;return(w=Dee.normalize(w,-T))>T&&(w=Math.PI-w),w}if(o=1.5*Math.PI-2*Math.atan(.5*(g+Math.sqrt(4*_+x))),l=o+r/u,o=b(o),l=b(l),l<o){const w=l;l=o,o=w}if(o=Math.max(_o(o),-90),l=Math.min(_o(l),90),a=nbe.monotonic(s,a),a-s>180){const w=(a-s-180)/2;s+=w,a-=w}const v=i.spatialReference&&i.spatialReference.isGeographic?i.spatialReference:Qt.WGS84;return n?(n.xmin=s,n.ymin=o,n.xmax=a,n.ymax=l,n.spatialReference=v):n=new ui(s,o,a,l,v),i.spatialReference&&i.spatialReference.isWebMercator&&_P(n,!1,n),n}const cbe=Object.freeze(Object.defineProperty({__proto__:null,headingTiltToDirectionUp:CZ,directionToHeadingTilt:sbe,eyeForCenterWithHeadingTilt:abe,lookAtTiltToEyeTilt:obe,eyeTiltToLookAtTilt:lbe,toExtent:SZ},Symbol.toStringTag,{value:"Module"}));function W2(i){return i.type==="point"}let EZ=class{constructor(e,t=null,r=0){this.array=e,this.spatialReference=t,this.offset=r}};function PZ(i){return"array"in i}function Gh(i,e,t="ground"){if(W2(e))return i.getElevation(e.x,e.y,e.z||0,e.spatialReference,t);if(PZ(e)){let r=e.offset;return i.getElevation(e.array[r++],e.array[r++],e.array[r]||0,je(e.spatialReference,i.spatialReference),t)}return i.getElevation(e[0],e[1],e[2]||0,i.spatialReference,t)}function X2(i,e){return i!=null&&(e==null||(e===Se.Local?!i.isGeographic||i.isWGS84||i.wkid===$v.CGCS2000:i.isWebMercator||i.isWGS84||i.wkid===$v.CGCS2000||i.wkid===$v.GCSMARS2000||i.wkid===$v.GCSMARS2000_SPHERE||i.wkid===$v.GCSMOON2000))}const RZ=J.getLogger("esri.views.3d.support.cameraUtils"),AZ=39.37,OZ=96,NL=1,hbe=8,ube=5,MZ=1,hU=R(),cC=R(),dbe={heading:0,tilt:0},td=new Ne,pbe=new dw(-20037508342788905e-9,20037508342788905e-9),mbe=new dw(-180,180);var ns;function Yx(i){return i.spatialReference||Qt.WGS84}function Sv(i){return i.viewingMode==="global"?cbe:rbe}function fbe(i,e,t,r,n){return Sv(i).headingTiltToDirectionUp(e,t,r,n)}function Qu(i,e){if(S(e))return null;const t=i.renderSpatialReference,r=Sv(i).headingTiltToDirectionUp,n=R();if(!bn(e.position,n,t))return null;const s=r(n,e.heading,e.tilt);Q(s.direction,s.direction,i.state.camera.distance),oe(s.direction,s.direction,n);const a=l_(i,n,s.direction,s.up);return a.fov=Ct(e.fov),a}(function(i){i[i.LOCKED=0]="LOCKED",i[i.ADJUST=1]="ADJUST"})(ns||(ns={}));const $_=R();function ov(i,e,t){const r=i.renderSpatialReference,n=SR(i,e.eye,e.viewForward,e.up,dbe);let s=Yx(i);return ss(e.eye,r,$_,s)||(s=Qt.WGS84,ss(e.eye,r,$_,s)),S(t)?new al(new Ne($_,s),n.heading,n.tilt,_o(e.fov)):(t.position.x=$_[0],t.position.y=$_[1],t.position.z=$_[2],t.position.spatialReference=s,t.heading=n.heading,t.tilt=n.tilt,t.fov=_o(e.fov),t)}function JN(i,e,t){const r=i.state.camera,n=r.width/2/r.pixelRatio;return i.renderCoordsHelper.viewingMode===Se.Global&&t!=null&&(e*=Math.cos(Ct(t))),e/=i.renderCoordsHelper.unitInMeters,n/(OZ*AZ/e)/Math.tan(r.fovX/2)}function Gg(i,e,t){const r=i.state.camera,n=e*Math.tan(r.fovX/2),s=r.width/2/r.pixelRatio;let a=OZ*AZ/(s/n);return i.renderCoordsHelper.viewingMode===Se.Global&&(a/=Math.cos(Ct(t))),a*=i.renderCoordsHelper.unitInMeters,a}function IZ(i,e,t,r,n,s){return LZ(i,e,JN(i,t,e.latitude),r,n,s)}function LZ(i,e,t,r,n,s){if(xg(s)){const o=new Ev(s.signal);return cx(i,r.heading,r.tilt,e,t,n,o),void o.resolver.promise.then(l=>{const c=Z2(i,l,r.fov);if(!S(c))return s.resolver.resolve(c);s.resolver.reject()},l=>s.resolver.reject(l))}const a=cx(i,r.heading,r.tilt,e,t,n);return Z2(i,a,r.fov,s)}function SR(i,e,t,r,n){return Sv(i).directionToHeadingTilt(e,t,r,n)}function gbe(i,e){return!!(i.basemapTerrain&&i.renderCoordsHelper.fromRenderCoords(e,td,i.spatialReference)&&je(Gh(i.elevationProvider,td),0)>td.z-MZ)}async function _be(i,e,t){if(!i.renderCoordsHelper.fromRenderCoords(e,td,i.spatialReference))return!1;const r=await i.elevationProvider.queryElevation(td.x,td.y,td.z,td.spatialReference,"ground",t);return je(r,0)>td.z-MZ}async function ybe(i,e,t){const r=R();if(e)if(e instanceof Ne){if(bn(e,r,i.renderSpatialReference),e.z==null&&i.basemapTerrain!=null){const n=await i.elevationProvider.queryElevation(e.x,e.y,e.z,e.spatialReference,"ground",t);return y(n)&&i.renderCoordsHelper.setAltitude(r,n),r}}else q(r,e);else q(r,i.state.camera.center);return r}function vbe(i,e){const t=R();if(e&&e instanceof Ne){if(bn(e,t,i.renderSpatialReference),e.z==null&&i.basemapTerrain!=null){const r=Gh(i.elevationProvider,e);y(r)&&i.renderCoordsHelper.setAltitude(t,r)}}else q(t,e||i.state.camera.center);return t}function cx(i,e,t,r,n,s,a){const o=r&&r instanceof Ne?r:null;if(xg(a))return ybe(i,r,a.signal).then(c=>{kL(i,e,t,o,c,n,s,a)},c=>a.resolver.reject(c)),null;const l=vbe(i,r);return kL(i,e,t,o,l,n,s,a)}function kL(i,e,t,r,n,s,a,o){if(S(r)){const d=i.renderSpatialReference;if(r=Rm(n,d,Yx(i)),S(r))return null}s=Math.max(s,i.state.constraints.minimumPoiDistance);const l=xbe(i,e,t,n,s,a),c=(0,Sv(i).eyeForCenterWithHeadingTilt)(n,s,l.heading,l.tilt);if(a===ns.ADJUST&&i.viewingMode==="global"&&t>0){const d=()=>{const f=$Z(i,n,s,Cbe(i,s,t,n));return a=t-f<1?ns.LOCKED:ns.ADJUST,kL(i,e,f,r,n,s,a,o)},m=i.map.ground.navigationConstraint;if(!m||m.type==="stay-above"){if(gbe(i,c.eye))return d();if(xg(o))return _be(i,c.eye,o.signal).then(f=>f?d():(o.resolver.resolve({eye:c.eye,up:c.up,center:as(n),heading:c.heading,tilt:c.tilt}),null)),null}}const u=!o||xg(o)?{center:R(),eye:R(),up:R(),tilt:0,heading:0}:o;return u.eye=c.eye,u.up=c.up,u.center=as(n),u.heading=c.heading,u.tilt=c.tilt,xg(o)&&o.resolver.resolve(u),u}function Qb(i,e,t,r,n,s=null){const a=e.zmax!=null&&e.zmin!=null;let o,l,c;if(i.state.isGlobal){if(!X2(e.spatialReference,Se.Global))return xg(s)&&s.resolver.reject(),null;const b=new Ne(e.xmin,e.ymin,e.spatialReference),v=new Ne(e.xmax,e.ymax,e.spatialReference),w=e.spatialReference.isGeographic?mbe:pbe;o=new Ne({x:w.center(b.x,v.x),y:(v.y+b.y)/2,z:a?(e.zmax+e.zmin)/2:null,spatialReference:e.spatialReference});const T=Yt(e.spatialReference),E=x0e(o,b,v);l=E.lon,c=E.lat,w.diff(b.x,v.x)>w.range/2&&(l+=T.halfCircumference),l=Math.min(l,T.halfCircumference),c=Math.min(c,T.halfCircumference)}else{const b=je(i.renderSpatialReference,e.spatialReference);b.equals(e.spatialReference)||(e=Dd(e,b)),l=e.xmax-e.xmin,c=e.ymax-e.ymin;const v=a?(e.zmax+e.zmin)/2:null;o=new Ne({x:e.xmin+.5*l,y:e.ymin+.5*c,z:v,spatialReference:b})}const u=a?e.zmax-e.zmin:0,d=i.state.camera,m=1/Math.tan(d.fovX/2),f=1/Math.tan(d.fovY/2),_=1/Math.tan(d.fov/2),g=Math.max(.5*l*m,.5*c*f,.5*u*_)/NL;if(xg(s)){const b=new Ev(s.signal);return cx(i,t,r,o,g,n,b),void b.resolver.promise.then(v=>{const w=Z2(i,v,i.camera.fov);if(!S(w))return s.resolver.resolve(w);s.resolver.reject()},v=>s.resolver.reject(v))}const x=cx(i,t,r,o,g,n);return Z2(i,x,i.camera.fov,s)}function bbe(i,e,t){const r=i.renderSpatialReference,n=Rm(t,r,Yx(i));if(S(n))return null;const s=Math.tan(e.fovX/2),a=Math.tan(e.fovY/2),o=K7(e.eye,t),l=2*o*s*NL,c=2*o*a*NL;return i.viewingMode==="global"?SZ(i,n,l,c):wZ(i,n,l,c)}function wbe(i,e,t){const r=i.pointsOfInterest.centerOnSurfaceFrequent.distance;if(Math.log(t/r)/Math.LN2>hbe)return!0;const n=i.renderSpatialReference,s=Yx(i),a=Rm(e,n,s),o=Rm(i.pointsOfInterest.centerOnSurfaceFrequent.renderLocation,n,s);if(S(a)||S(o))return!1;const l=Math.tan(.5*i.state.camera.fov)*r;return o.distance(a)/l>ube}function xbe(i,e,t,r,n,s){let a=0;return s===ns.ADJUST&&wbe(i,r,n)?(e=0,a=Tbe(i,n,t,r)):a=e4(i,r,n,t),a=i.state.constraints.clampTilt(n,a),{heading:e,tilt:t=$Z(i,r,n,a)}}const Q2=.7;function Tbe(i,e,t,r){const n=i.state.constraints.tilt(e);n.max=Math.min(n.max,.5*Math.PI);const s=n.min*(1-Q2)+n.max*Q2,a=e4(i,r,e,t);return Math.min(a,s)}function Cbe(i,e,t,r){const n=i.state.constraints.tilt(e);let s=e4(i,r,e,t);return s=Math.min(s,.5*Math.PI),n.min*(1-Q2)+s*Q2}function $Z(i,e,t,r){return Sv(i).lookAtTiltToEyeTilt(r,e,t)}function e4(i,e,t,r){return Sv(i).eyeTiltToLookAtTilt(r,e,t)}function Z2(i,e,t,r){if(S(e))return null;const n=i.renderSpatialReference,s=Rm(e.eye,n,Yx(i));return S(s)?null:y(r)?(r.position=s,r.heading=e.heading,r.tilt=e.tilt,r.fov=t,r):new al(s,e.heading,e.tilt,t)}function Sbe(i,e){var r;const t=(r=i.basemapTerrain)==null?void 0:r.tilingScheme;if(t)return t.levelAtScale(e);RZ.error("#scaleToZoom()","Cannot compute zoom from scale without a tiling scheme")}function DZ(i,e){var r;const t=(r=i.basemapTerrain)==null?void 0:r.tilingScheme;if(t)return t.scaleAtLevel(e);RZ.error("#zoomToScale()","Cannot compute scale from zoom without a tiling scheme")}function FZ(i,e,t){const r=i.renderSpatialReference;let n,s;e||(e=i.state.camera);const a=Qt.WGS84;return e instanceof al?(n=e.position.latitude,bn(e.position,hU,r),bn(t,cC,r),s=Ii(hU,cC)):(ss(e.center,r,cC,a),n=cC[1],s=e.distance),Gg(i,s,n)}let Ev=class{constructor(e){this.signal=e,this.resolver=Ix()}};function xg(i){return i&&"resolver"in i}const Ebe=.66;function NZ(i){return 360-Z$.normalize(i)}function ER(i){return Z$.normalize(360-i)}function hC(i){return y(i)&&i.resolver&&i.resolver.reject(),null}function Pbe(i,e){return y(i)&&i.resolver&&i.resolver.resolve(e),e}function kZ(i,e,t,r=null){if(!e)return hC(r);const n=i.spatialReference||Qt.WGS84;if(y(e.camera)){const c=J$(e.camera.position,n);if(S(c))return hC(r);const u=e.camera.clone();return u.position=c,Pbe(r,u)}if(S(e.targetGeometry))return hC(r);const s=e.get("targetGeometry.spatialReference");if(s&&!RE(s,n))return hC(r);const a=ov(i,i.state.camera);let o=ns.ADJUST;if(e.rotation!=null&&(a.heading=NZ(e.rotation),o=ns.LOCKED),t!=null&&(a.tilt=t),e.targetGeometry.type==="point"){const c=e.targetGeometry;let u;const d=e.targetGeometry.clone();return u=e.scale!=null?JN(i,e.scale,c.latitude):i.state.camera.distance,LZ(i,d,u,a,o,r)}const l=e.targetGeometry.extent;return Qb(i,l,a.heading,a.tilt,o,r)}function Rbe(i,e,t=null){return S(t)&&(t=new rr),r4(i,null,e.clone(),t)}async function Abe(i,e,t){const r=Vbe(i,e);if(!r)throw new K("viewpointutils-create:no-target","Missing target for creating viewpoint");const n=new al({fov:i.camera.fov}),s=new rr({camera:n});if(r.target instanceof rr)return nf(await Ibe(i,r.target,r,t,s));if(r.target instanceof al)return nf(UZ(i,r.target,s));const a=r.scale!=null||r.zoom!=null;if(r.target instanceof ui){const c=r.target.xmin===r.target.xmax||r.target.ymin===r.target.ymax;return nf(a||c?await VL(i,r,r.target.center,n,t,s):await Fbe(i,r,r.target,n,t,s))}const o={boundingBox:Mi(),hasZ:!1,screenSpaceObjects:[]},l=a?Obe(i,r):void 0;if(await VZ(i,r.target,l,o),isFinite(o.boundingBox[0])){let c;if(Ic(o.boundingBox,ur),Bo.x=ur[0],Bo.y=ur[1],Bo.z=ur[2],Bo.spatialReference=i.spatialReference,isFinite(Bo.z)&&o.hasZ?c=BD(o.boundingBox):(Bo.z=void 0,c=Xie(GD(o.boundingBox,zbe))),a||c)return nf(await VL(i,r,Bo,n,t,s));const u=Ube(i,o.screenSpaceObjects);return nf(await kbe(i,r,Bo,o.boundingBox,u,n,t,s))}return r.position?nf($be(i,r,n,s)):nf(await Dbe(i,r,n,t,s))}function t4(i,e){return e.scale==null&&e.zoom!=null?DZ(i,e.zoom):e.scale}function Obe(i,e){return Cre(t4(i,e))}function i4(i,e){let t=!1;return e.heading!=null?(i.heading=e.heading,t=!0):e.rotation!=null&&(i.heading=NZ(e.rotation),t=!0),e.tilt!=null&&(i.tilt=e.tilt,t=!0),e.fov!=null&&(i.fov=e.fov),t}function r4(i,e,t,r){const n=i.spatialReference||Qt.WGS84;return e=y(e)?e:Qu(i,t),S(e)||(r.targetGeometry=Rm(e.center,i.renderSpatialReference,n),r.scale=FZ(i,e),r.rotation=ER(t.heading),r.camera=t),r}function Y2(i,e,t){var o;const r=()=>new K("viewpointutils:invalid-geometry","The target is missing a valid geometry");if(!e)throw r();if(!RE(e.spatialReference,i.spatialReference))throw new K("viewpointutils:incompatible-spatialreference",`Spatial reference (${e.spatialReference?e.spatialReference.wkid:"unknown"}) is incompatible with the view (${i.spatialReference.wkid})`,{geometry:e});const n=[];if(!e.hasZ&&i.basemapTerrain){let l;switch(e.type){case"point":l=e;break;case"multipoint":case"polyline":l=(o=e.extent)==null?void 0:o.center;break;case"mesh":l=e.origin;break;case"extent":l=e.center;break;case"polygon":l=e.centroid}l&&y(i.basemapTerrain.spatialReference)&&RE(l,i.basemapTerrain.spatialReference)?ur[2]=je(Gh(i.elevationProvider,l),0):ur[2]=0}(0,Bbe[e.type])(e,l=>{n.push(l[0],l[1],l[2])},ur);const s=n.length/3;if(s===0)throw r();const a=new Array(n.length);if(Ma(n,e.spatialReference,0,a,i.spatialReference,0,s)){e.hasZ&&(t.hasZ=!0);for(let l=0;l<a.length;l+=3)e.hasZ?(ur[0]=a[l+0],ur[1]=a[l+1],ur[2]=a[l+2]):(ur[0]=a[l+0],ur[1]=a[l+1]),W0(t.boundingBox,ur)}}async function Mbe(i,e,t,r){const n=await gw(i.whenViewForGraphic(e));if(n.ok===!1||S(n.value)||!("whenGraphicBounds"in n.value))return void Y2(i,e.geometry,r);const s=n.value,a=await gw(s.whenGraphicBounds(e,{minDemResolution:t}));if(a.ok===!1)return void Y2(i,e.geometry,r);const{screenSpaceObjects:o,boundingBox:l}=a.value;X0(r.boundingBox,l),o&&o.forEach(c=>{r.screenSpaceObjects.push(c)}),isFinite(l[2])&&(r.hasZ=!0)}async function VZ(i,e,t,r){if(Array.isArray(e)&&e.length===2){const n=e[0],s=e[1];if(typeof n=="number"&&typeof s=="number")return Bo.x=n,Bo.y=s,Bo.z=void 0,Bo.spatialReference=i.spatialReference.isGeographic?i.spatialReference:Qt.WGS84,void Y2(i,Bo,r)}e&&typeof e.map=="function"?await Yo(e.map(n=>VZ(i,n,t,r))):e instanceof g7?Y2(i,e,r):e instanceof jc&&await Mbe(i,e,t,r)}async function Ibe(i,e,t,r,n){if(y(e.camera))return UZ(i,e.camera,n);n.scale=e.scale,n.rotation=e.rotation,n.targetGeometry=y(e.targetGeometry)?e.targetGeometry.clone():null,n.camera=null,t.heading!=null?n.rotation=ER(t.heading):t.rotation!=null&&(n.rotation=t.rotation);const s=t4(i,t);s!=null&&(n.scale=s);const a=new Ev(r);return kZ(i,n,t.tilt,a),n.camera=await a.resolver.promise,n}function UZ(i,e,t){const r=i.spatialReference,n=J$(e.position,r);return S(n)?null:((e=e.clone()).fov=i.camera.fov,e.position=n,r4(i,null,e,t))}function Lbe(i,e,t,r,n,s){const a=i.renderSpatialReference;return bn(t.position,dC,a),bn(e,DO,a),s.targetGeometry=new Ne(e),n.position=new Ne(t.position),ne(K2,DO,dC),SR(i,dC,K2,r.up,n),s.scale=Gg(i,Ii(dC,DO),s.targetGeometry.latitude),s.rotation=ER(n.heading),s.camera=n,s}async function VL(i,e,t,r,n,s){if(S(t))throw new K("createfromcenter","invalid point");s.targetGeometry=t.clone();const a=l_(i);if(e.position)return Lbe(i,s.targetGeometry,e,a,r,s);if(e.zoomFactor){const l=a.distance/e.zoomFactor,c=Q(ur,a.viewForward,-l);a.eye=oe(ur,a.center,c),s.scale=Gg(i,l,t.latitude)}ov(i,a,r);const o=i4(r,e)?ns.LOCKED:ns.ADJUST;if(!e.zoomFactor){s.scale=t4(i,e),s.scale==null&&(bn(t,ur,i.renderSpatialReference),XG(a.frustum,ur)?s.scale=Gg(i,Ii(a.eye,ur),t.latitude):s.scale=FZ(i,a));const l=new Ev(n);IZ(i,s.targetGeometry,s.scale,r,o,l),s.camera=await l.resolver.promise}return s}function $be(i,e,t,r){const n=l_(i);return q(K2,n.viewForward),SR(i,n.eye,K2,n.up,FO),t.position=new Ne(e.position),t.heading=e.heading!=null?e.heading:FO.heading,t.tilt=e.tilt!=null?e.tilt:FO.tilt,r4(i,null,t,r)}async function Dbe(i,e,t,r,n){const s=l_(i);return VL(i,e,Rm(s.center,i.renderSpatialReference,i.spatialReference),t,r,n)}async function Fbe(i,e,t,r,n,s){s.targetGeometry=t.clone();const a=l_(i);ov(i,a,r);const o=i4(r,e)?ns.LOCKED:ns.ADJUST,l=new Ev(n);return Qb(i,t,r.heading,r.tilt,o,l),s.camera=await l.resolver.promise,s}function Nbe(i,e,t,r,n){let s=0;t.hasZ?s=t.z:i.basemapTerrain&&(s=ct(Gh(i.elevationProvider,t))),Z(ur,t.x,t.y,s),xd(i.spatialReference,ur,uU,i.renderSpatialReference),Td(uC,uU),qc(uC,uC),Mi(l1);const a=[[0,1,2],[3,1,2],[0,4,2],[3,4,2],[0,1,5],[3,1,5],[0,4,5],[3,4,5]];for(let _=0;_<a.length;_++){const g=a[_];let x=r[g[2]];isFinite(x)||(x=s),Z(ur,r[g[0]],r[g[1]],x),ss(ur,i.spatialReference,ur,i.renderSpatialReference),W0(l1,Nl(ur,ur,uC))}const o=QG(l1),l=HD(l1),c=ZG(l1),u=1/Math.tan(e.fovX/2),d=1/Math.tan(e.fovY/2),m=.5*Math.sqrt(o*o+c*c)*Math.max(d,u)+.5*l,f=.5*l*d+.5*Math.max(o,c);return Math.max(m,f)/n}async function kbe(i,e,t,r,n,s,a,o){o.targetGeometry=t.clone();const l=l_(i),c=Nbe(i,l,t,r,n);ov(i,l,s);const u=i4(s,e)?ns.LOCKED:ns.ADJUST;o.scale=Gg(i,c,o.targetGeometry.latitude);const d=new Ev(a);return IZ(i,o.targetGeometry,o.scale,s,u,d),o.camera=await d.resolver.promise,o}function Vbe(i,e){if(!e||!i.spatialReference)return null;const t={target:null};if("declaredClass"in e||Array.isArray(e))t.target=e;else{for(const r in e)t[r]=e[r];e.center&&!t.target&&(t.target=e.center)}return t}function nf(i){return i&&y(i.camera)&&(i.rotation=ER(i.camera.heading)),i}function Ube(i,e){const t=Ebe;if(!e.length)return t;let r=Number.NEGATIVE_INFINITY;for(let n=0;n<e.length;n++){const s=e[n].screenSpaceBoundingRect;r=Math.max(r,Math.abs(s[0]),Math.abs(s[1]),Math.abs(s[2]),Math.abs(s[3]))}return t-r/Math.min(i.width,i.height)*2}const ur=R(),uU=ve(),uC=Or(),l1=Ms(),zbe=$t(),K2=R(),dC=R(),DO=R(),FO={heading:0,tilt:0},Bo=new Ne,Bbe={point(i,e,t){t[0]=i.x,t[1]=i.y,i.hasZ&&(t[2]=i.z),e(t)},polygon(i,e,t){const r=i.hasZ;for(let n=0;n<i.rings.length;n++){const s=i.rings[n];for(let a=0;a<s.length;a++)t[0]=s[a][0],t[1]=s[a][1],r&&(t[2]=s[a][2]),e(t)}},polyline(i,e,t){const r=i.hasZ;for(let n=0;n<i.paths.length;n++){const s=i.paths[n];for(let a=0;a<s.length;a++)t[0]=s[a][0],t[1]=s[a][1],r&&(t[2]=s[a][2]),e(t)}},multipoint(i,e,t){const r=i.points,n=i.hasZ;for(let s=0;s<r.length;s++)t[0]=r[s][0],t[1]=r[s][1],n&&(t[2]=r[s][2]),e(t)},extent(i,e,t){i.hasZ?(e(Z(t,i.xmin,i.ymin,i.zmin)),e(Z(t,i.xmax,i.ymin,i.zmin)),e(Z(t,i.xmin,i.ymax,i.zmin)),e(Z(t,i.xmax,i.ymax,i.zmin)),e(Z(t,i.xmin,i.ymin,i.zmax)),e(Z(t,i.xmax,i.ymin,i.zmax)),e(Z(t,i.xmin,i.ymax,i.zmax)),e(Z(t,i.xmax,i.ymax,i.zmax))):(e(Z(t,i.xmin,i.ymin,t[2])),e(Z(t,i.xmax,i.ymin,t[2])),e(Z(t,i.xmin,i.ymax,t[2])),e(Z(t,i.xmax,i.ymax,t[2])))},mesh(i,e,t){const r=i.vertexAttributes&&i.vertexAttributes.position;if(r)for(let n=0;n<r.length;n+=3)e(Z(t,r[n+0],r[n+1],r[n+2]))}};let Gbe=class{constructor(e,t,r){this.target=e,this.options=t,this.view=r,this.state="pending",this._abortController=null,this._animationController=null,this._promise=new Promise((n,s)=>{this._resolveCallback=n,this._rejectCallback=s;const a=new AbortController;y(this.options.signal)&&Em(this.options.signal,()=>{this.abort()}),this._abortController=a,this.waitForReady()})}then(e,t){return this._promise.then(e,t)}catch(e){return this._promise.catch(e)}resolve(e){return this.state="finished",this._resolveCallback(e)}reject(e){return this.state="finished",this._rejectCallback(e)}abort(e=!1){switch(this.state){case"pending":case"wait-for-ready":case"wait-for-viewpoint":this.reject(ts());break;case"wait-for-animation-finish":!e&&y(this._animationController)&&this.view.state.cameraController===this._animationController&&this._animationController.active&&this._animationController.stopController(),this.reject(ts())}}async waitForReady(){if(this.state="wait-for-ready",!this.view.ready)try{await Pm(()=>this.view.ready,this._abortController.signal)}catch(e){return this.reject(e)}this.createViewPoint()}createViewPoint(){this.state!=="finished"&&(this.state="wait-for-viewpoint",this._animationController=this.options.animate?this._getAnimationController():null,Abe(this.view,this.target,this._abortController.signal).then(e=>{if(this.state==="finished")return;const t=this._getCameraFromViewpoint(e);if(!S(t))if(this.options.animate){if(S(this._animationController))return;this.startAnimation(t,this._animationController)}else this.view.stateManager.setStateCamera(t.camera,{applyConstraints:!t.isFullySpecified,positionAndOrientationOnly:!0,doNotCancelGoToOperation:!0}),this.resolve()},e=>{this.reject(e)}))}_getCameraFromViewpoint(e){const t=!!(this.target instanceof rr&&this.target.camera||this.target instanceof al),r=e.camera;if(S(r))return null;if(!this.view.stateManager.isCompatible(r)){const s=r.position,a=s&&s.spatialReference,o=a?a.wkid:"none",l=this.view.spatialReference.wkid;return this.reject(new K("GotoAnimation:incompatible-spatialreference",`Resulting camera has an incompatible spatial reference (camera: ${o}, view: ${l})`,{camera:r})),null}const n=Qu(this.view,r);return S(n)?(this.reject(new K("GotoAnimation:invalid-camera","Resulting camera is invalid")),null):{viewpoint:e,camera:n,isFullySpecified:t}}startAnimation(e,t){this.state="wait-for-animation-finish";const r=t.viewAnimation;if(S(r))return void this.reject(new K("GotoAnimation:missing-animation","Unreachable code in view.stateManager"));if(r.update(e.viewpoint,"running"),!t.active||S(t.viewAnimation)||t.viewAnimation.target!==e.viewpoint||this.view.state.cameraController!==t)return this.abort();let n;e.isFullySpecified?(n=new Xb({view:this.view,desiredCamera:e.camera}),Tv(this.view,e.camera,zl.EYE_AND_CENTER)):pr(this.view,e.camera),t.begin(e.camera,this.options);const s=()=>{const o=this.view.state.cameraController;n&&(o&&o.active?o instanceof md&&y(o.viewAnimation)&&o.viewAnimation.target===e.viewpoint&&(this.view.state.cameraController=n):y(t.viewAnimation)&&t.viewAnimation.target===e.viewpoint&&t.state==="finished"&&(this.view.state.cameraController=n))},a=o=>{if(!S(this.view.state))switch(t.state){case Vi.Finished:switch(this.state){case"pending":case"wait-for-ready":case"wait-for-viewpoint":case"wait-for-animation-finish":this.resolve()}break;case Vi.Ready:case Vi.Rejected:case Vi.Running:case Vi.Stopped:switch(this.state){case"pending":case"wait-for-ready":case"wait-for-viewpoint":case"wait-for-animation-finish":this.reject(o)}}};r.when(s,o=>a(o)),t.asyncResult={resolve:()=>a(),reject:o=>a(o)}}_getAnimationController(){let e,t=null;const r=this.view.state.cameraController;return r instanceof md&&(r.updateStateFromViewAnimation(),r.active&&(e=r,t=e.viewAnimation)),e!=null||(e=new md({view:this.view,mode:"animation"}),t=e.viewAnimation,this.view.state.switchCameraController(e))?e:(y(t)&&t.stop(),this.reject(new K("GotoAnimation:goto-cannot-interrupt","Cannot start an animation while interacting")),null)}},Xr=class extends ue{constructor(e){super(e),this._propertiesPool=new Od({frustum:Yp},this),this._handles=new Ft,this._cameraSetByUser=!1,this._gotoOperation=null,this.ready=!1,this._windowDevicePixelRatio=1,this._devicePixelRatioOverride=null,this._maximumPixelRatioOverride=null,this._cameraChangeTime=0,this.test={contentCameraResetState:new Map,setDevicePixelRatio:t=>this._devicePixelRatioOverride=t,setMaximumPixelRatio:t=>this._maximumPixelRatioOverride=t,renderState:null}}get camera(){const e=this._get("camera");if(!this.ready)return e;const t=ov(this.view,this.view.state.camera,NO);return t&&e&&t.equals(e)?e:t.clone()}set camera(e){this._updatePropertyBeforeReady("camera",e)||(this.view.elevationProvider.enableElevationCache(!0),this.setStateCamera(Qu(this.view,e),{applyConstraints:!1})||J.getLogger(this.declaredClass).error("#camera=","Invalid camera",e),this.view.elevationProvider.enableElevationCache(!1))}get contentCamera(){const e=this._get("contentCamera");if(!this.ready)return e;const t=ov(this.view,this.view.state.contentCamera,NO);return t&&e&&t.equals(e)?e:t.clone()}set contentCamera(e){if(this._updatePropertyBeforeReady("contentCamera",e))return;const t=Qu(this.view,e);S(t)?this.view.state.contentCamera=null:(this._updateElevation(t),this.view.state.contentCamera=t)}installContentCameraReset(e){if(this._handles.remove("contentCameraReset"),this.test.contentCameraResetState.clear(),!this.view.state.fixedContentCamera)return!1;const t=this.zoom,r=this.view.state.camera.distance**2,n=Tl(this.view.state.camera.center),s=e.sticky?this.contentCamera.clone():null;return this._handles.add([z(()=>this.contentCamera,()=>{e.sticky||(this._handles.remove("contentCameraReset"),this.test.contentCameraResetState.clear())}),z(()=>this.zoom,a=>{this.test.contentCameraResetState.set("view.zoom",Math.abs(a-t)/2),Math.abs(a-t)>2?this.contentCamera=null:this.view.state.fixedContentCamera||(this.contentCamera=s)}),z(()=>this.view.state.camera,a=>{const o=Bl(n,a.center);this.test.contentCameraResetState.set("camera.center",o/r),o>r?this.contentCamera=null:this.view.state.fixedContentCamera||(this.contentCamera=s)})],"contentCameraReset"),!0}get center(){return this.ready?this.view.pointsOfInterest.centerOnContent.location:this._get("center")}set center(e){this._updatePropertyBeforeReady("center",e)||(e?this.isCompatible(e)?this.setStateCamera(this._centerToCamera(e),{applyConstraints:!0})?this.view.pointsOfInterest.centerOnContent.runTask():J.getLogger(this.declaredClass).error("#center=","Invalid center",e):J.getLogger(this.declaredClass).error("#center=","Center has an incompatible spatial reference (center: "+(e.spatialReference?e.spatialReference.wkid:"none")+", view: "+this.view.spatialReference.wkid+")",e):J.getLogger(this.declaredClass).error("#center=","Center may not be null or undefined"))}get extent(){if(!this.ready)return this._get("extent");const e=this.view,t=bbe(e,e.state.camera,e.pointsOfInterest.centerOnContent.renderLocation);return y(t)?t:this._get("extent")}set extent(e){this._updatePropertyBeforeReady("extent",e)||(e?this.isCompatible(e)?this.setStateCamera(this._extentToCamera(e),{applyConstraints:!0})||J.getLogger(this.declaredClass).error("#extent=","Invalid extent",e):J.getLogger(this.declaredClass).error("#extent=","Extent has an incompatible spatial reference (extent: "+(e.spatialReference?e.spatialReference.wkid:"none")+", view: "+this.view.spatialReference.wkid+")",e):J.getLogger(this.declaredClass).error("#extent=","Extent may not be null or undefined"))}get frustum(){const e=this._propertiesPool.get("frustum");return e.renderCoordsHelper=this.view.renderCoordsHelper,e.update(this.view.state.camera),e}get hasInitialView(){return!!this.view.get("map.initialViewProperties.viewpoint")}get scale(){if(this.ready){const e=this.view.pointsOfInterest.centerOnContent;return Gg(this.view,e.distance,e.location.latitude)}return this._get("scale")}set scale(e){this._updatePropertyBeforeReady("scale",e)||this.setStateCamera(this._scaleToCamera(e),{applyConstraints:!0})||J.getLogger(this.declaredClass).error("#scale=","Invalid scale",e)}get padding(){if(!this.ready)return this._get("padding");const e=this.view.state.camera,t=e.padding,r=e.pixelRatio,n=this._get("padding"),s=Math.round(t[Xe.TOP]/r),a=Math.round(t[Xe.RIGHT]/r),o=Math.round(t[Xe.BOTTOM]/r),l=Math.round(t[Xe.LEFT]/r);return n!=null&&n.top===s&&n.right===a&&n.bottom===o&&n.left===l?n:{top:s,right:a,bottom:o,left:l}}set padding(e){this._updatePropertyBeforeReady("padding",e)||(this._paddingToArray(e,this.view.state.camera.pixelRatio,pC),this.view.state.updateCamera(t=>t.padding=pC))}_paddingToArray(e,t,r){e?Qs(r,e.top||0,e.right||0,e.bottom||0,e.left||0):Qs(r,0,0,0,0);for(let n=0;n<4;n++)r[n]=Math.round(r[n]*t)}get screenCenter(){const e=this.padding;return Ps((this.view.width-(e.left+e.right))/2+e.left,(this.view.height-(e.top+e.bottom))/2+e.top)}get viewpoint(){return this.ready?Rbe(this.view,this.camera):this._get("viewpoint")}set viewpoint(e){if(!this._updatePropertyBeforeReady("viewpoint",e))if(e)if(this.isCompatible(e))this.setStateCamera(this._viewpointToCamera(e),{applyConstraints:!e.camera})||J.getLogger(this.declaredClass).error("#viewpoint=","Invalid viewpoint",e);else{const t=y(e.camera)?e.camera.position:e.targetGeometry,r=y(t)&&t.spatialReference;J.getLogger(this.declaredClass).error("#viewpoint=","Viewpoint has an incompatible spatial reference (viewpoint: "+(r?r.wkid:"none")+", view: "+this.view.spatialReference.wkid+")",e)}else J.getLogger(this.declaredClass).error("#viewpoint=","Viewpoint may not be null or undefined")}get zoom(){return this.ready?Sbe(this.view,this.scale):this._get("zoom")}set zoom(e){this._updatePropertyBeforeReady("zoom",e)||this.setStateCamera(this._zoomToCamera(e),{applyConstraints:!0})||J.getLogger(this.declaredClass).error("#zoom=","Invalid zoom",e)}get maximumPixelRatio(){if(y(this._maximumPixelRatioOverride))return this._maximumPixelRatioOverride;let e=1/0;const{maximumPixelRatio:t,maximumRenderResolution:r}=this.view.qualitySettings;if(t!=null&&(e=Math.min(e,t)),r!=null){const n=r/Math.max(this.view.width,this.view.height);e=Math.min(e,n)}return e}get _devicePixelRatio(){return S(this._devicePixelRatioOverride)?Math.min(this._windowDevicePixelRatio,this.maximumPixelRatio):this._devicePixelRatioOverride}initialize(){this._cameraChangeTime=performance.now(),this._handles.add([wr(()=>this.view.state.events,"before-camera-change",e=>this._updateElevation(e.camera)),z(()=>{var e;return(e=this.view.state)==null?void 0:e.camera},(e,t)=>this._cameraChangedHandler(e,t),ri)]),cs(()=>{var e;return(e=this.view.state)==null?void 0:e.camera},e=>this._updateElevation(e),{once:!0,sync:!0}),this._handles.add([wd({prepare:()=>this._prepareFrame()}),z(()=>this.view.state.cameraController,()=>{this._cameraSetByUser=!0,this._handles.remove(mC)}),wr(()=>this.view.state.events,"camera-projection-changed",()=>this.notifyChange("scale"))])}destroy(){this.exit(),this._handles&&(this._handles.destroy(),this._handles=null),this._propertiesPool&&(this._propertiesPool.destroy(),this._propertiesPool=null)}init(){this.constraintsManager=new ub({view:this.view}),this._prepareFrame();const e=this._getInitialProperties();this._cameraSetByUser=!1,this._set("ready",!0);for(const t of e)this.set(t.name,t.value);if(!this._cameraSetByUser){const t=this.view.get("map.initialViewProperties.viewpoint")||this.view.initialExtent;t&&this.isCompatible(t)?this._setInitialView(t):this.view.state.viewingMode===Se.Local&&this._handles.add(cs(()=>this.view.basemapTerrain.ready,()=>{this._handles.remove(mC),this._setInitialView(this.view.dataExtent)},{once:!0,initial:!0}),mC)}}exit(){this._cancelGoToOperation(),this.ready&&(this._override("padding",this.padding),this._set("ready",!1),this._clearOverride("hasInitialView"),this._cameraSetByUser=!1,this._handles.remove(mC),this.constraintsManager&&(this.constraintsManager.destroy(),this.constraintsManager=null))}async goTo(e,t){const r={animate:!0,...t};return y(this._gotoOperation)&&this._gotoOperation.abort(r.animate),this._gotoOperation=new Gbe(e,r,this.view),this.view.resourceController.scheduler.stopFrame(),this._gotoOperation}debugSetCameraOnContent(){this.setStateCamera(l_(this.view),{applyConstraints:!1})}step(e){const t=this.view.state,r=t==null?void 0:t.cameraController;r&&(t.updateCamera(n=>r.stepController(e,n)),r.steppingFinished&&r.finishController())}_cancelGoToOperation(){y(this._gotoOperation)&&(this._gotoOperation.abort(),this._gotoOperation=null)}_getInitialProperties(){const e=new Set,t=[];for(const{propertyName:r,overrides:n}of jbe){const s=e.has(r),a=this._isOverridden(r);!s&&a&&t.push({name:r,value:this._get(r)}),this._clearOverride(r),(s||a)&&n.forEach(o=>e.add(o))}return t}_setInitialView(e){if(S(e)||this._cameraSetByUser)return;if(e instanceof al)return void this.setStateCamera(Qu(this.view,e),{applyConstraints:!1});if(e instanceof rr){if(e.targetGeometry instanceof ui){const s=Qb(this.view,e.targetGeometry,0,.5,ns.LOCKED);return void(y(s)&&this.setStateCamera(Qu(this.view,s),{applyConstraints:!0}))}const r={applyConstraints:!e.camera},n=this._viewpointToCamera(e);return void this.setStateCamera(n,r)}const t=Qb(this.view,e,0,.5,ns.LOCKED);y(t)&&this.setStateCamera(Qu(this.view,t),{applyConstraints:!0})}_updatePropertyBeforeReady(e,t){return!this.ready&&(this._override(e,t),t&&Hbe.includes(e)&&this._override("hasInitialView",!0),!0)}isCompatible(e){return!S(e)&&(e instanceof rr?e.camera?this.isCompatible(e.camera):this.isCompatible(e.targetGeometry):e instanceof al?this.isCompatible(e.position):e.spatialReference&&RE(e.spatialReference,this.view.spatialReference))}_getPreservingHeadingTilt(e=qbe){return this._cameraSetByUser?(e.heading=this.camera.heading,e.tilt=this.camera.tilt):(e.heading=0,e.tilt=.5),e}_centerPointAtDistanceToCamera(e,t,r=ip){const{heading:n,tilt:s}=this._getPreservingHeadingTilt(),a=cx(this.view,n,s,e,t,ns.ADJUST);return S(a)?null:(r.copyFrom(this.view.state.camera),r.eye=a.eye,r.center=a.center,r.up=a.up,r)}_centerToCamera(e){const t=this.view.pointsOfInterest.centerOnContent;t.runTask();const r=t.distance;return this._centerPointAtDistanceToCamera(e,r)}_extentToCamera(e){const{heading:t,tilt:r}=this._getPreservingHeadingTilt(),n=Qb(this.view,e,t,r,ns.ADJUST,NO);return y(n)?Qu(this.view,n):null}_scaleToCamera(e){if(e==null)return null;const t=this.view.pointsOfInterest.centerOnContent;t.runTask();const r=t.renderLocation,n=t.location.latitude,s=JN(this.view,e,n);return this._centerPointAtDistanceToCamera(r,s)}_zoomToCamera(e){return this._scaleToCamera(DZ(this.view,e))}_viewpointToCamera(e){return Qu(this.view,kZ(this.view,e))}setStateCamera(e,t){return!(S(e)||!this.view.state.stopActiveCameraController())&&(this._cameraSetByUser=!0,t.doNotCancelGoToOperation||this._cancelGoToOperation(),this.view.state.updateCamera(r=>{t.positionAndOrientationOnly?(r.eye=e.eye,r.center=e.center,r.up=e.up):r.copyFrom(e),t.applyConstraints&&pr(this.view,r)}),t.applyConstraints||(this.view.state.cameraController=new Xb({view:this.view,desiredCamera:e})),!0)}_prepareFrame(){const{surface:e,canvas:t}=this.view;if(!e||!t)return;this._windowDevicePixelRatio=window.devicePixelRatio;const r=this._devicePixelRatio,n=Math.round(e.clientWidth*r),s=Math.round(e.clientHeight*r);if(n!==0&&s!==0&&(t.width===n&&t.height===s||(t.width=n,t.height=s),this.view.state)){const a=this.view.state.camera;a.fullWidth===n&&a.fullHeight===s&&a.pixelRatio===r||(ip.copyFrom(a),ip.pixelRatio!==r&&(this._paddingToArray(this.padding,r,pC),ip.padding=pC),ip.fullWidth=n,ip.fullHeight=s,ip.pixelRatio=r,this.view.state.camera=ip),this._updateRenderState()}}_updateElevation(e){var s;const t=this.view.basemapTerrain&&this.view.basemapTerrain.spatialReference,r=((s=this.view.renderCoordsHelper)==null?void 0:s.getAltitude(e.eye))??0,n=t?wR(this.view,e.eye):0;e.relativeElevation=r-n}_updateRenderState(){y(this.test.renderState)?this.view.state.mode=this.test.renderState:this.view.animation?this.view.state.mode=Fh.ANIMATING:this.view.interacting?this.view.state.mode=Fh.INTERACTING:(this.view.state.mode===Fh.ANIMATING&&(this._cameraChangeTime=0),performance.now()-this._cameraChangeTime<=Wbe?this.view.state.mode=Fh.INTERACTING:this.view.state.mode=Fh.IDLE)}_cameraChangedHandler(e,t){e&&t&&e.almostEquals(t)||(this._cameraChangeTime=performance.now(),this._updateRenderState())}};h([p({type:al,dependsOn:["view.state.camera","ready"]})],Xr.prototype,"camera",null),h([p({type:al,dependsOn:["view.state.contentCamera","ready"]})],Xr.prototype,"contentCamera",null),h([p({type:Ne})],Xr.prototype,"center",null),h([p({type:ui})],Xr.prototype,"extent",null),h([p({readOnly:!0})],Xr.prototype,"frustum",null),h([p({readOnly:!0})],Xr.prototype,"hasInitialView",null),h([p({readOnly:!0,type:Boolean})],Xr.prototype,"ready",void 0),h([p({type:Number})],Xr.prototype,"scale",null),h([p()],Xr.prototype,"padding",null),h([p({readOnly:!0})],Xr.prototype,"screenCenter",null),h([p({constructOnly:!0})],Xr.prototype,"view",void 0),h([p({type:rr})],Xr.prototype,"viewpoint",null),h([p({type:Number})],Xr.prototype,"zoom",null),h([p()],Xr.prototype,"maximumPixelRatio",null),h([p()],Xr.prototype,"_devicePixelRatio",null),h([p()],Xr.prototype,"_windowDevicePixelRatio",void 0),h([p()],Xr.prototype,"_devicePixelRatioOverride",void 0),h([p()],Xr.prototype,"_maximumPixelRatioOverride",void 0),Xr=h([D("esri.views.3d.state.ViewStateManager")],Xr);const Hbe=["camera","viewpoint","extent","scale","center","zoom"],jbe=[{propertyName:"camera",overrides:["viewpoint"]},{propertyName:"viewpoint",overrides:["extent"]},{propertyName:"extent",overrides:["center","scale"]},{propertyName:"center",overrides:[]},{propertyName:"scale",overrides:["zoom"]},{propertyName:"zoom",overrides:[]},{propertyName:"padding",overrides:[]}],qbe={heading:0,tilt:0},NO=new al,ip=new yi,pC=_i(),mC="pending-initial-view",Wbe=300,dU=100;let Hh=class extends ed{constructor(){super(...arguments),this.startCamera=new yi,this.currentCamera=new yi,this._lastInteraction=0}get isInteractive(){return performance.now()-this._lastInteraction<dU}stepController(e,t){t.copyViewFrom(this.currentCamera),this.currentCamera.copyFrom(t)}onControllerStart(e){this.state=Vi.Running,this.startCamera.copyFrom(e),this.currentCamera.copyFrom(e)}onControllerEnd(e){e.copyViewFrom(this.currentCamera)}commitCamera(){this._lastInteraction=performance.now(),setTimeout(()=>this.notifyChange("isInteractive"),dU),this.view.state.updateCamera(e=>this.stepController(0,e)),this.steppingFinished&&this.finishController()}};h([p({readOnly:!0})],Hh.prototype,"isInteractive",null),h([p()],Hh.prototype,"_lastInteraction",void 0),Hh=h([D("esri.views.3d.state.controllers.InteractiveController")],Hh);var ro;(function(i){i[i.CENTER=0]="CENTER",i[i.EYE=1]="EYE"})(ro||(ro={}));const Xbe=7,kO=90;let Zb=class extends Hh{constructor(e){super(e),this.pivot=ro.CENTER,this._lastPoint=be(),this._tmpWorldUp=R(),this._tmpViewDir=R(),this._tmpRotCurPoint=be(),this._tmpTransf=ve(),this._tmpAxis=R(),this._tmpPivotPoint=R(),this._pivotPos=R(),this._constraintOptions={selection:wi.ALL,interactionType:rt.TUMBLE,interactionFactor:0,interactionStartCamera:null,interactionDirection:null,tiltMode:vn.TUMBLE}}get _intersectionHelper(){return this.view.sceneIntersectionHelper}initialize(){this._rotScale=this.pivot===ro.CENTER?3:1.5}begin(e){if(this.active){switch(this.pivot){case ro.EYE:q(this._pivotPos,this.startCamera.eye),this._constraintOptions.interactionType=rt.LOOK_AROUND,this._constraintOptions.tiltMode=vn.LOOK_AROUND,this._constraintOptions.selection=wi.NONE;break;case ro.CENTER:{const t=this._intersectionHelper.intersectRayFreePointFallback(this.startCamera.ray,this._pivotPos);t||q(this._pivotPos,this.startCamera.center),this._constrainPivotPoint(e,t),this.startCamera.center=this._pivotPos,this._constraintOptions.interactionType=rt.TUMBLE,this._constraintOptions.tiltMode=vn.TUMBLE,this._constraintOptions.selection=wi.ALL&~wi.DISTANCE;break}}this._constraintOptions.interactionStartCamera=this.startCamera,wg(this.startCamera,e,this._lastPoint)}}_constrainPivotPoint(e,t){const r=this.startCamera,n=R();ne(n,this._pivotPos,r.eye);const s=_e(n);let a=Math.min(s,Xbe*Math.abs(this.view.camera.position.z));const o=Yt(this.view.spatialReference),l=zi(r.width/r.pixelRatio*.5,r.height/r.pixelRatio*.5),c=CR(this.startCamera,l,!0,o);let u=this.view._stage.renderView.getMinimalDepthForArea(this.view.voxelWasm,r.fullWidth/r.pixelRatio*.5,r.fullHeight/r.pixelRatio*.5,r,2.5*kO,kO),d=this.view._stage.renderView.getMinimalDepthForArea(this.view.voxelWasm,e[0],e[1],r,kO);(y(u)||y(d))&&(u=je(u,d),d=S(d)||c===Dn.Horizontal?u:d,a=u>d?d:u,a=t?Math.min(a,s):a),he(n,n),q(this._pivotPos,oe(this._tmpPivotPoint,r.eye,Q(this._tmpPivotPoint,n,a)))}update(e){if(this.active){switch(this.pivot){case ro.EYE:this.currentCamera.center=this._applyRotation(this.currentCamera,e,this.currentCamera.center,this._pivotPos);break;case ro.CENTER:this.currentCamera.center=this._pivotPos,this.currentCamera.eye=this._applyRotation(this.currentCamera,e,this.currentCamera.eye,this._pivotPos)}pr(this.view,this.currentCamera,this._constraintOptions),this.commitCamera()}}end(){this.active&&this.finishController()}_applyRotation(e,t,r,n){this.view.renderCoordsHelper.worldUpAtPosition(n,this._tmpWorldUp),wg(e,t,this._tmpRotCurPoint);let s=(this._lastPoint[1]-this._tmpRotCurPoint[1])*this._rotScale,a=(this._tmpRotCurPoint[0]-this._lastPoint[0])*this._rotScale;ne(this._tmpViewDir,r,n);const o=_e(this._tmpViewDir),l=ls(me(this._tmpViewDir,this._tmpWorldUp)/o);if(this.pivot===ro.EYE){s*=-.5;const c=.5*Math.PI-l,u=.5*Math.PI*.99;s=c-Math.max(-u,Math.min(u,c+s))}return s=ce(s+l,Jn.min,Jn.max)-l,nt(this._tmpAxis,e.up,this._tmpViewDir),this.pivot===ro.CENTER&&(a=-a),Bc(this._tmpTransf,a,this._tmpWorldUp),kl(this._tmpTransf,this._tmpTransf,s,this._tmpAxis),Ce(this._tmpViewDir,this._tmpViewDir,this._tmpTransf),e.up=Ce(VO,e.up,this._tmpTransf),oe(VO,n,this._tmpViewDir),wn(this._lastPoint,this._tmpRotCurPoint),VO}};h([p()],Zb.prototype,"pivot",void 0),Zb=h([D("esri.views.3d.state.controllers.RotateController")],Zb);const VO=R();let UO=class extends Ei{constructor(e,t,r,n){super(!0),this._view=e,this.pointerAction=t,this._pivot=r,this.registerIncoming("drag",n,s=>this._handleDrag(s))}_handleDrag(e){const t=e.data;if(t.pointers.size>1||!oN(e.data,this.pointerAction))return;const r=zi(t.center.x,t.center.y);switch(t.action){case"start":this._cameraController&&(this._cameraController.end(),this._cameraController=null),this._cameraController=new Zb({view:this._view,pivot:this._pivot}),this._view.state.switchCameraController(this._cameraController),this._cameraController.begin(r);break;case"update":this._cameraController&&this._cameraController.update(r);break;case"end":this._cameraController&&(this._cameraController.end(),this._cameraController=null)}e.stopPropagation()}},UL=class extends Hh{constructor(){super(...arguments),this._pickPoint=R(),this._tmpP0=be(),this._panAxisAngle=TR(),this._tmpRayDir=R(),this._tmpRayDirPick=R(),this._targetOnSphere=R(),this._tmpRay={origin:R(),direction:R()},this.dragBeginPoint=zi(),this._normalizedAnchorPoint=be(),this._constraintOptions={selection:wi.ALL_EXCEPT_COLLISION,interactionType:rt.ZOOM,interactionFactor:0,interactionStartCamera:null,interactionDirection:null,tiltMode:vn.TUMBLE},this._sphere=ou(),this._hasPickPoint=!1}get _intersectionHelper(){return this.view.sceneIntersectionHelper}begin(e){if(!this.active)return;wn(this.dragBeginPoint,e),wg(this.startCamera,e,this._normalizedAnchorPoint);const t=Yt(this.view.spatialReference),r=lZ(this._intersectionHelper,this.startCamera,e,t,av.Ellipsoid,this.view.map.ground.opacity===0?Qbe:{});if(this._navMode=CR(this.startCamera,e,r.hasGeometryIntersection,t),this._navMode===Dn.Horizontal)this._hasPickPoint=!!r.scenePickPoint,this._pickPoint=je(r.scenePickPoint,this._pickPoint),this._sphere=r.sphere;else{let n,s;Cv(this.startCamera,e,this._tmpRay),he(this._tmpRay.direction,this._tmpRay.direction),y(r.scenePickPoint)&&(ne(this._tmpRayDirPick,this.startCamera.eye,r.scenePickPoint),s=_e(this._tmpRayDirPick)),this.view.camera.position.hasZ&&(n=Math.abs(this.view.camera.position.z));let a=ce(nZ*n,z2[0],z2[1]);const o=this.view._stage.renderView.getMinimalDepthForArea(null,e[0],e[1],this.view.state.camera,sZ);a=y(o)?Math.min(a,o):a,a=r.scenePickPoint?Math.min(a,s):a,this._hasPickPoint=!0,Q(this._tmpRay.direction,this._tmpRay.direction,a),oe(this._pickPoint,this._tmpRay.origin,this._tmpRay.direction)}this._constraintOptions.interactionStartCamera=this.startCamera}update(e){if(this.active){if(this.currentCamera.eye=this.startCamera.eye,this.currentCamera.center=this.startCamera.center,this.currentCamera.up=this.startCamera.up,this._navMode===Dn.Horizontal){ne(this._tmpRayDir,this.currentCamera.center,this.currentCamera.eye);const t=_e(this._tmpRayDir);wg(this.currentCamera,e,this._tmpP0);const r=12*(this._normalizedAnchorPoint[1]-this._tmpP0[1]);let n=t*2**r;const s=this.view.state.constraints.minimumPoiDistance;if(r<0&&n<s&&(n=s),Math.abs(t-n)<1e-6)return;if(this._hasPickPoint&&n<t){const a=1-(1-n/t)*(1-this._sphere[3]/_e(this.currentCamera.center));this.currentCamera.center=Q(fC,this.currentCamera.center,a)}Q(this._tmpRayDir,this._tmpRayDir,-n/t),this.currentCamera.eye=oe(fC,this.currentCamera.center,this._tmpRayDir),this._constraintOptions.interactionFactor=Cc(q0(this.dragBeginPoint,e)),pr(this.view,this.currentCamera,this._constraintOptions),this._hasPickPoint&&(lx(this._sphere,this.currentCamera,this.dragBeginPoint,this._targetOnSphere),qN(this._pickPoint,this._targetOnSphere,this._panAxisAngle),Um(this.currentCamera,this._sphere,this._panAxisAngle))}else{const t=_e(this._tmpRay.direction);wg(this.currentCamera,e,this._tmpP0);const r=12*(this._normalizedAnchorPoint[1]-this._tmpP0[1]);let n=t*2**r;const s=this.view.state.constraints.minimumPoiDistance;if(r<0&&n<s&&(n=s),Math.abs(t-n)<1e-6)return;Q(this._tmpRayDir,this._tmpRay.direction,1-n/t),this.currentCamera.eye=oe(fC,this.currentCamera.eye,this._tmpRayDir),this.currentCamera.center=oe(fC,this.currentCamera.center,this._tmpRayDir)}Tv(this.view,this.currentCamera),this.commitCamera()}}end(){this.active&&this.finishController()}};UL=h([D("esri.views.3d.state.controllers.global.ZoomController")],UL);const fC=R(),Qbe={exclude:new Set([Ac])};let zL=class extends Hh{constructor(){super(...arguments),this._tmpP=R(),this._tmpDir=R(),this._tmpN=R(),this._tmpP0=be(),this._tmpPoi=R(),this._tmpRayDir=R(),this.dragBeginPoint=zi(),this._normalizedAnchorPoint=be(),this._constraintOptions={selection:wi.ALL,interactionType:rt.ZOOM,interactionFactor:0,interactionStartCamera:null,interactionDirection:R(),tiltMode:vn.TUMBLE},this._plane=fr()}get _intersectionHelper(){return this.view.sceneIntersectionHelper}begin(e){if(!this.active)return;wn(this.dragBeginPoint,e),wg(this.startCamera,e,this._normalizedAnchorPoint);const t=this._intersectionHelper.intersectScreenFreePointFallback(e,this._tmpP,this.view.map.ground.opacity===0?Zbe:{});ne(this._tmpDir,this._tmpP,this.startCamera.eye);const r=_e(this._tmpDir);let n;he(this._tmpDir,this._tmpDir),this.view.camera.position.hasZ&&(n=Math.abs(this.view.camera.position.z));let s=ce(nZ*n,z2[0],z2[1]);const a=this.view._stage.renderView.getMinimalDepthForArea(this.view.voxelWasm,e[0],e[1],this.view.state.camera,sZ);s=y(a)?Math.min(s,a):s,s=t?Math.min(s,r):s,Q(this._tmpDir,this._tmpDir,s),oe(this._tmpP,this.startCamera.eye,this._tmpDir),ne(this._tmpN,this.startCamera.eye,this.startCamera.center),he(this._tmpN,this._tmpN),this._tmpN[1]<0&&Aa(this._tmpN,this._tmpN),xw(this._tmpP,this._tmpN,this._plane),this._constraintOptions.interactionStartCamera=this.startCamera}update(e){if(!this.active)return;E1e(this._plane,this.currentCamera,this.dragBeginPoint,this._tmpPoi)||q(this._tmpPoi,this.currentCamera.center),wg(this.currentCamera,e,this._tmpP0);let t=4*(this._tmpP0[1]-this._normalizedAnchorPoint[1]);wn(this._normalizedAnchorPoint,this._tmpP0),ne(this._tmpRayDir,this._tmpPoi,this.currentCamera.eye);const r=_e(this._tmpRayDir);let n=r*(1-t);q(this._constraintOptions.interactionDirection,this._tmpRayDir),Q(this._constraintOptions.interactionDirection,this._constraintOptions.interactionDirection,Math.sign(t)/r);const s=this.view.state.constraints.minimumPoiDistance;t>=0&&n<s&&(n=s,t=-(n-r)/r),Math.abs(r-n)<1e-6||(Q(this._tmpRayDir,this._tmpRayDir,t),this.currentCamera.eye=oe(sf,this.currentCamera.eye,this._tmpRayDir),Bn(sf,this.currentCamera.center,this._tmpPoi,t),this._tmpPoi[2]>this.startCamera.center[2]?sf[2]=Math.max(this.startCamera.center[2],sf[2]):sf[2]=Math.min(this.startCamera.center[2],sf[2]),this.currentCamera.center=sf,this._constraintOptions.interactionFactor=Cc(q0(this.dragBeginPoint,e)),pr(this.view,this.currentCamera,this._constraintOptions),this.commitCamera())}end(){this.active&&this.finishController()}};zL=h([D("esri.views.3d.state.controllers.local.ZoomController")],zL);const sf=R(),Zbe={exclude:new Set([Ac])};let Ybe=class extends Ei{constructor(e,t,r){super(!0),this._view=e,this.pointerAction=t,this.registerIncoming("drag",r,n=>this._handleDrag(n))}_handleDrag(e){const t=e.data;if(t.pointers.size>1||!oN(e.data,this.pointerAction))return;const r=zi(t.center.x,t.center.y);switch(t.action){case"start":this._cameraController&&(this._cameraController.end(),this._cameraController=null),this._view.state.isGlobal?this._cameraController=new UL({view:this._view}):this._cameraController=new zL({view:this._view}),this._view.state.switchCameraController(this._cameraController),this._cameraController.begin(r);break;case"update":this._cameraController&&this._cameraController.update(r);break;case"end":this._cameraController&&(this._cameraController.end(),this._cameraController=null)}e.stopPropagation()}},hg=class extends Hh{constructor(e){super(e),this._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this._keysButtonState=[0,0,0,0,0,0,0,0,0,0,0,0],this._tmpCamera=new yi,this._constraintOptions={selection:wi.ALL,interactionType:rt.NONE,interactionStartCamera:new yi,interactionFactor:0,interactionDirection:null,tiltMode:vn.LOOK_AROUND}}handleEventGamepad(e){const t=J3(e,this.view.navigation.gamepad,this._transformation);(e.action==="end"||zS(t))&&this.finishController()}activateDirection(e){this._keysButtonState[e]=1,_V(this._keysButtonState,this._transformation)}deactivateDirection(e){this._keysButtonState[e]=0;const t=_V(this._keysButtonState,this._transformation);zS(t)&&this.finishController()}onControllerStart(e){this._filteredSurfaceElevation=this.view.pointsOfInterest.cameraOnSurface.location.z,this._headingStart=this.view.camera.heading,super.onControllerStart(e)}_updateFilteredSurfaceElevation(e){const t=this.view.pointsOfInterest.cameraOnSurface.location.z,r=1;this._filteredSurfaceElevation+=r*(t-this._filteredSurfaceElevation)*e}stepController(e,t){this._updateStartHeading(),this._updateFilteredSurfaceElevation(e),this.currentCamera.copyViewFrom(t),this._updateCameraCenter(),this._constraintOptions.interactionStartCamera.copyFrom(this.currentCamera),this._calculateControlTransformation(e,this.currentCamera,af),this._applyDisabledMovementTypes(af),this._applyPan(af.pan),this._applyRotate(af.rotate),this._applyZoom(af.zoom),this._applyAscend(af.ascend),this._constraintOptions.interactionType=rt.NONE,this._constraintOptions.selection=wi.COLLISION,pr(this.view,this.currentCamera,this._constraintOptions),super.stepController(e,t)}_updateStartHeading(){this._transformation.heading!==0&&(this._headingStart=this.view.camera.heading)}_applyRotate(e){if(!e.enabled)return;const t=this.currentCamera;ne(ia,t.center,t.eye),Ce(ia,ia,e.matrix),t.center=oe(ia,ia,t.eye),t.up=Ce(ia,t.up,e.matrix),this._constraintOptions.interactionType=rt.LOOK_AROUND,this._constraintOptions.selection=wi.ALL_EXCEPT_COLLISION,pr(this.view,t,this._constraintOptions)}_applyPan(e,t=this.currentCamera){e.enabled&&(t.eye=Ce(ia,t.eye,e.matrix),t.center=Ce(ia,t.center,e.matrix),this.view.state.isGlobal&&(t.up=Ce(ia,t.up,e.matrix)),this._constraintOptions.interactionType=rt.PAN,this._constraintOptions.selection=wi.ALL,pr(this.view,t,this._constraintOptions))}_applyZoom(e){if(!e)return;const t=this.currentCamera.viewForward;this.currentCamera.eye=oe(ia,this.currentCamera.eye,Q(ze.get(),t,e)),q(c1,t),Aa(c1,c1),this._constraintOptions.interactionDirection=c1,this._constraintOptions.interactionType=rt.ZOOM,this._constraintOptions.selection=wi.ALL_EXCEPT_COLLISION,pr(this.view,this.currentCamera,this._constraintOptions),this._constraintOptions.interactionDirection=null}_applyAscend(e){if(!e)return;const t=this.view.renderCoordsHelper.worldUpAtPosition(this.currentCamera.eye,ze.get());if(this._constraintOptions.interactionDirection=q(c1,t),this.view.state.isGlobal){const r=_e(this.currentCamera.eye),n=(r+e)/r;this.currentCamera.eye=Q(ia,this.currentCamera.eye,n),this.currentCamera.center=Q(ia,this.currentCamera.center,n)}else{const r=Q(ze.get(),t,e);this.currentCamera.eye=oe(ia,this.currentCamera.eye,r),this.currentCamera.center=oe(ia,this.currentCamera.center,r)}this._updateCameraCenter(),this._constraintOptions.interactionType=rt.ASCEND,this._constraintOptions.selection=wi.COLLISION,pr(this.view,this.currentCamera,this._constraintOptions)&&this._updateCameraCenter(),this._constraintOptions.selection=wi.ALL_EXCEPT_COLLISION,pr(this.view,this.currentCamera,this._constraintOptions),this._constraintOptions.interactionDirection=null}_calculateControlTransformation(e,t,r){nwe(r);const n=this._computeVelocities(e);this.view.state.isLocal?this._calculateControlTransformationLocal(n,t,r):this._calculateControlTransformationGlobal(n,t,r)}_updateCameraCenter(){const e=this.view.pointsOfInterest.centerOnSurfaceFrequent.estimatedSurfaceAltitude,t=this.view.renderCoordsHelper,r=this.currentCamera.ray;this.currentCamera.center=t.intersectManifoldClosestSilhouette(r,e,ia)}_calculateControlTransformationLocal(e,t,r){const{viewRight:n,viewForward:s}=t,a=this._transformation,o=this.view.navigation.gamepad,l=Z(ze.get(),s[0],s[1],0);he(l,l);const c=a.translation[0]*e.pan;if(c!==0){const g=Q(ze.get(),n,c);ru(r.pan.matrix,r.pan.matrix,g),r.pan.enabled=!0}switch(o.mode){case"pan":{const g=-a.translation[1]*e.pan;if(g!==0){const x=Q(ze.get(),l,g);ru(r.pan.matrix,r.pan.matrix,x),r.pan.enabled=!0}r.zoom=a.zoom*e.zoom;break}case"zoom":r.zoom=(-a.translation[1]+a.zoom)*e.zoom;break;default:Pa(o.mode)}const u=a.translation[2]*e.ascend;r.ascend=u;const d=-a.heading*e.rotate;d!==0&&(kl(r.rotate.matrix,r.rotate.matrix,d,this.view.renderCoordsHelper.worldUpAtPosition(t.eye,ze.get())),r.rotate.enabled=!0);const m=a.tilt*e.rotate,f=Vm(this.view.renderCoordsHelper,t.center,t.eye),_=ce(f+m,Jn.min,Jn.max)-f;_&&(kl(r.rotate.matrix,r.rotate.matrix,_,n),r.rotate.enabled=!0)}_calculateControlTransformationGlobal(e,t,r){const{eye:n,viewRight:s}=t,a=this._transformation,o=this.view.navigation.gamepad,l=nt(ze.get(),s,n);he(l,l),Aa(l,l),I1e(this.startCamera,t,a,e,this.view.camera.heading,this._headingStart,this.view.camera.tilt,r,o),this._tmpCamera.copyFrom(this.currentCamera),this._applyPan(af.pan,this._tmpCamera);const c=this.view.pointsOfInterest.centerOnSurfaceFrequent.estimatedSurfaceAltitude,u=a.translation[2]*e.ascend;r.ascend=u;const d=-a.heading*e.rotate;d!==0&&(kl(r.rotate.matrix,r.rotate.matrix,d,this._tmpCamera.eye),r.rotate.enabled=!0);const m=a.tilt*e.rotate,f=this._clampTiltDeltaGlobalToValidRange(m,t.ray,c);f!==0&&(kl(r.rotate.matrix,r.rotate.matrix,f,this._tmpCamera.viewRight),r.rotate.enabled=!0),r.zoom+=a.zoom*e.zoom}_clampTiltDeltaGlobalToValidRange(e,t,r){const n=Yt(this.view.spatialReference),s=rE(Jn.min,t.origin,r,n);let a=0,o=0;const l=ze.get();if(this.view.renderCoordsHelper.intersectManifold(t,r,l)){const c=Vm(this.view.renderCoordsHelper,l,t.origin);a=rE(c,t.origin,r,n),o=rE(Jn.max,t.origin,r,n)}else{RP(fD(gD,r+n.radius),t,l);const c=ls(-me(t.direction,he(l,l)));a=K6(c,t.origin,r,n),o=K6(Jn.max,t.origin,r,n)}return ce(a+e,s,o)-a}_getPointAbsoluteSurfaceElevation(e,t,r){const{renderCoordsHelper:n}=this.view,s=n.getAltitude(e),a=t+Math.abs(s-t);return n.setAltitude(r,a,e),a}_clampedDistanceToSurface(e,t){const{renderCoordsHelper:r}=this.view,{camera:n}=this.view.state,{direction:s}=fbe(this.view,t,0,zZ,rwe),a=r.intersectManifoldClosestSilhouette(zc(t,s),e,ze.get()),o=Ii(t,a),l=r.intersectManifoldClosestSilhouette(zc(t,Yg(ze.get(),t,n.center)),e,ze.get()),c=Ii(t,l);return Math.min(o,c)}_computeHeadingRotateRadius(e){const{renderCoordsHelper:t,state:r}=this.view,{camera:n,isGlobal:s}=r,a=t.intersectManifoldClosestSilhouette(n.ray,this._filteredSurfaceElevation,ze.get());if(s){const o=ne(ze.get(),e,a),l=_e(o);Q(o,o,1/l);const c=he(ze.get(),e),u=ls(me(c,o));return l*Math.sin(Math.min(Jbe,u))}{const o=q(ze.get(),e);return t.setAltitude(o,this._filteredSurfaceElevation),Ii(a,o)}}_minimumAscendVelocity(){return this.view.state.constraints.collision.enabled?0:ewe}_computeVelocities(e){const t=this._filteredSurfaceElevation,r=t+Yt(this.view.spatialReference).radius,{camera:n,isGlobal:s}=this.view.state,a=ze.get(),o=this._getPointAbsoluteSurfaceElevation(n.eye,t,a),l=this._clampedDistanceToSurface(t,a),c=n.width/2,u=pU*n.width,d=pU*n.width,m=l*Math.tan(.5*n.fovX)/c,f=m/r,_=m/this._computeHeadingRotateRadius(a),g=o-t;return{pan:(s?f:m)*u*e,ascend:Math.max(this._minimumAscendVelocity()*e,2**(u*e/c)*g-g),zoom:2**(u*e/c)*l-l,rotate:ce(_*d,twe,iwe)*e}}_applyDisabledMovementTypes(e){!y(this.disableMovements)||this.disableMovements.mode!==void 0&&this.view.state.viewingMode!==this.disableMovements.mode||(e.zoom=this.disableMovements.zoom?0:e.zoom,e.ascend=this.disableMovements.ascend?0:e.ascend,e.pan.enabled=!this.disableMovements.pan,this.disableMovements.pan&&Ag(e.pan.matrix),e.rotate.enabled=!this.disableMovements.rotate,this.disableMovements.rotate&&Ag(e.rotate.matrix))}static activatesFor(e,t){const r=J3(t,e.navigation.gamepad,Kbe);return!(t.action==="end"||zS(r))}};h([p({constructOnly:!0})],hg.prototype,"gamepadDevice",void 0),h([p({constructOnly:!0})],hg.prototype,"disableMovements",void 0),hg=h([D("esri.views.3d.state.controllers.GamepadKeyboardController")],hg);const Kbe={translation:[0,0,0],heading:0,tilt:0,zoom:0},zZ=80,Jbe=Ct(zZ),pU=.75,ewe=5,twe=Ct(30),iwe=Ct(80),af={zoom:0,ascend:0,pan:{enabled:!1,matrix:ve()},rotate:{enabled:!1,matrix:ve()}},ia=R(),c1=R(),rwe=KN();function nwe(i){i.zoom=0,i.ascend=0,i.pan.enabled=!1,Ag(i.pan.matrix),i.rotate.enabled=!1,Ag(i.rotate.matrix)}let swe=class extends Ei{constructor(e){super(!0),this._view=e,this._watchHandles=new Ft,this._handle=this.registerIncoming("gamepad",t=>this._handleEventGamepad(t)),this._handle.pause()}onInstall(e){super.onInstall(e),this._watchHandles.add([z(()=>this._view.navigation.gamepad.enabled,t=>{t?this._handle.resume():(this._handle.pause(),this._cameraControllerGamepad&&(this._cameraControllerGamepad.finishController(),this._cameraControllerGamepad=null))},Qe),z(()=>this._view.navigation.gamepad.device,t=>{this._cameraControllerGamepad&&t&&this._cameraControllerGamepad.gamepadDevice!==t&&(this._cameraControllerGamepad.finishController(),this._cameraControllerGamepad=null)})])}onUninstall(){this._watchHandles.removeAll(),super.onUninstall()}_handleEventGamepad(e){const t=this._view.navigation.gamepad.device;if(t&&e.data.device!==t)return;const r=this._cameraControllerGamepad&&this._cameraControllerGamepad.active;if(r||hg.activatesFor(this._view,e.data)){if(!r){const n=new hg({view:this._view,gamepadDevice:e.data.device});this._view.state.switchCameraController(n)&&(this._cameraControllerGamepad=n)}this._cameraControllerGamepad&&this._cameraControllerGamepad.active&&this._cameraControllerGamepad.gamepadDevice===e.data.device&&this._cameraControllerGamepad.handleEventGamepad(e.data)}}};var Ka;(function(i){i[i.LEFT=0]="LEFT",i[i.RIGHT=1]="RIGHT",i[i.FORWARD=2]="FORWARD",i[i.BACKWARD=3]="BACKWARD",i[i.UP=4]="UP",i[i.DOWN=5]="DOWN",i[i.HEADINGLEFT=6]="HEADINGLEFT",i[i.HEADINGRIGHT=7]="HEADINGRIGHT",i[i.TILTUP=8]="TILTUP",i[i.TILTDOWN=9]="TILTDOWN",i[i.ZOOMIN=10]="ZOOMIN",i[i.ZOOMOUT=11]="ZOOMOUT"})(Ka||(Ka={}));let awe=class extends Ei{constructor(e,t){super(!0),this._view=e,this._disableMovements={pan:!0,zoom:!1,ascend:!0,rotate:!1,mode:Se.Local},this._keyToNumber={[t.left]:Ka.LEFT,[t.right]:Ka.RIGHT,[t.forward]:Ka.FORWARD,[t.backward]:Ka.BACKWARD,[t.up]:Ka.UP,[t.down]:Ka.DOWN,[t.headingLeft]:Ka.HEADINGLEFT,[t.headingRight]:Ka.HEADINGRIGHT,[t.tiltUp]:Ka.TILTUP,[t.tiltDown]:Ka.TILTDOWN,[t.zoomIn]:Ka.ZOOMIN,[t.zoomOut]:Ka.ZOOMOUT},this.registerIncoming("key-down",null,r=>this._handleKeyDown(r)),this.registerIncoming("key-up",null,r=>this._handleKeyUp(r)),this.registerIncoming("blur",null,()=>this._handleBlur())}_handleKeyDown(e){if(e.data.native.ctrlKey||e.data.native.metaKey)return;const t=this._keyToNumber[e.data.key];t!=null&&(this._cameraControllerKeyboard&&this._cameraControllerKeyboard.active||(this._cameraControllerKeyboard=new hg({view:this._view,disableMovements:this._disableMovements}),this._view.state.switchCameraController(this._cameraControllerKeyboard)),this._cameraControllerKeyboard.active&&(this._cameraControllerKeyboard.activateDirection(t),e.stopPropagation()))}_handleBlur(){this._cameraControllerKeyboard&&this._cameraControllerKeyboard.active&&(this._cameraControllerKeyboard.finishController(),this._cameraControllerKeyboard=null)}_handleKeyUp(e){if(e.data.native.ctrlKey||e.data.native.metaKey)return;const t=this._keyToNumber[e.data.key];t!=null&&this._cameraControllerKeyboard&&this._cameraControllerKeyboard.active&&(this._cameraControllerKeyboard.deactivateDirection(t),e.stopPropagation())}},owe=class extends Ei{constructor(e,t){super(!0),this._view=e,this.registerIncoming("mouse-wheel",t,r=>this._handleMouseWheel(r))}_handleMouseWheel(e){if(!this._view.navigation.mouseWheelZoomEnabled)return;const t=e.data;this._cameraController&&this._cameraController.active||(this._cameraController=this._view.state.isGlobal?new j2({view:this._view,mode:"interaction"}):new q2({view:this._view,mode:"interaction"}),this._view.state.switchCameraController(this._cameraController)),this._cameraController.zoomStep(-1/60*t.deltaY,zi(t.x,t.y)),e.preventDefault(),e.stopPropagation()}},J2=class{constructor(e){this._gain=e}reset(e){this._value=e}set gain(e){this._gain=e}get value(){return this._value===void 0?0:this._value}update(e){this._value===void 0?this._value=e:this._value=this._gain*e+(1-this._gain)*this._value}},Hg=class extends ax{constructor(){super(...arguments),this._beginCamera=new yi,this._elapsedTimeSec=0,this.constraintOptions={selection:wi.ALL,interactionType:rt.PAN,interactionFactor:0,interactionStartCamera:new yi,interactionDirection:null,tiltMode:vn.TUMBLE}}initialize(){this.constraintOptions.interactionType=this.interactionType,this.viewAnimation=new Md}get steppingFinished(){return this.momentum.isFinished(this._elapsedTimeSec)}onControllerStart(e){this._beginCamera.copyFrom(e),this.constraintOptions.interactionStartCamera=this._beginCamera,super.onControllerStart(e)}stepController(e,t){t.copyViewFrom(this._beginCamera),this._elapsedTimeSec+=e,this.momentumStep(this._elapsedTimeSec,t),pr(this.view,t,this.constraintOptions)}};Hg=h([D("esri.views.3d.state.controllers.momentum.MomentumController")],Hg);let Yb=class extends Hg{constructor(e){super(e),this.interactionType=rt.PAN,this._tmpPan=R()}momentumStep(e,t){const r=this.momentum.value(e);Q(this._tmpPan,this.momentum.direction,r),t.eye=ne(mU,t.eye,this._tmpPan),t.center=ne(mU,t.center,this._tmpPan),this.constraintOptions.interactionDirection=this._tmpPan}};h([p({constructOnly:!0})],Yb.prototype,"momentum",void 0),Yb=h([D("esri.views.3d.state.controllers.momentum.PanPlanarMomentumController")],Yb);const mU=R(),lwe=R(),gC=R();let sE=class extends Hg{constructor(e){super(e),this.interactionType=rt.PAN}momentumStep(e,t){const r=this.momentum.value1(e),n=this.momentum.value2(e);q(gC,t.eye),he(gC,gC),nt(this.momentum.axis2,gC,this.momentum.axis1),dZ(t,lwe,this.momentum.axis1,r,this.momentum.axis2,n)}};h([p({constructOnly:!0})],sE.prototype,"momentum",void 0),sE=h([D("esri.views.3d.state.controllers.momentum.PanSphericalMomentumController")],sE);let eg=class extends Hg{constructor(e){super(e),this.interactionType=rt.TUMBLE}set center(e){this._set("center",as(e))}set axis(e){this._set("axis",as(e))}momentumStep(e,t){const r=this.momentum.value(e);Um(t,this.center,ox(this.axis,r))}};h([p({constructOnly:!0})],eg.prototype,"momentum",void 0),h([p({constructOnly:!0})],eg.prototype,"center",null),h([p({constructOnly:!0})],eg.prototype,"axis",null),eg=h([D("esri.views.3d.state.controllers.momentum.MomentumController")],eg);let p0=class extends Hg{constructor(e){super(e),this.interactionType=rt.ZOOM,this.constraintOptions.interactionDirection=R()}set zoomCenter(e){this._set("zoomCenter",as(e))}momentumStep(e,t){q(this.constraintOptions.interactionDirection,t.eye);const r=this.momentum.valueDelta(0,e);QN(t,this.zoomCenter,r,this.view.state.constraints.minimumPoiDistance),this.constraintOptions.interactionDirection=Yg(this.constraintOptions.interactionDirection,t.eye,this.constraintOptions.interactionDirection)}};h([p({constructOnly:!0})],p0.prototype,"momentum",void 0),h([p({constructOnly:!0})],p0.prototype,"zoomCenter",null),p0=h([D("esri.views.3d.state.controllers.momentum.ZoomPlanarMomentumController")],p0);let kf=class extends Hg{constructor(e){super(e),this.interactionType=rt.ZOOM,this.radius=0,this._tmpSceneCenter=R(),this._tmpZoomAxisAngle=TR(),this._sphere=ou()}set screenCenter(e){this._set("screenCenter",zi(e[0],e[1]))}set sceneCenter(e){this._set("sceneCenter",as(e))}initialize(){this._sphere[3]=this.radius}momentumStep(e,t){const r=this.momentum.valueDelta(0,e);aZ(this._sphere,t,r),this.constraintOptions.interactionType=rt.ZOOM,pr(this.view,t,this.constraintOptions),lx(this._sphere,t,this.screenCenter,this._tmpSceneCenter),qN(this.sceneCenter,this._tmpSceneCenter,this._tmpZoomAxisAngle),Um(t,this._sphere,this._tmpZoomAxisAngle),this.constraintOptions.interactionType=rt.PAN}};h([p({constructOnly:!0})],kf.prototype,"momentum",void 0),h([p({constructOnly:!0})],kf.prototype,"screenCenter",null),h([p({constructOnly:!0})],kf.prototype,"sceneCenter",null),h([p({constructOnly:!0})],kf.prototype,"radius",void 0),kf=h([D("esri.views.3d.state.controllers.momentum.ZoomSphericalMomentumController")],kf);let Sc=class{constructor(e){this._gain=e,this.lastValue=void 0,this.filteredDelta=void 0}update(e){if(this.hasLastValue()){const t=this.computeDelta(e);this._updateDelta(t)}this.lastValue=e}reset(){this.lastValue=void 0,this.filteredDelta=void 0}hasLastValue(){return this.lastValue!==void 0}hasFilteredDelta(){return this.filteredDelta!==void 0}computeDelta(e){return this.lastValue===void 0?NaN:e-this.lastValue}_updateDelta(e){this.filteredDelta!==void 0?this.filteredDelta=(1-this._gain)*this.filteredDelta+this._gain*e:this.filteredDelta=e}},PR=class{constructor(e,t,r){this._initialVelocity=e,this._stopVelocity=t,this._friction=r,this._duration=Math.abs(Math.log(Math.abs(this._initialVelocity)/this._stopVelocity)/Math.log(1-this._friction))}get duration(){return this._duration}isFinished(e){return e>this.duration}get friction(){return this._friction}value(e){return this.valueFromInitialVelocity(this._initialVelocity,e)}valueDelta(e,t){const r=this.value(e);return this.value(e+t)-r}valueFromInitialVelocity(e,t){t=Math.min(t,this.duration);const r=1-this.friction;return e*(r**t-1)/Math.log(r)}},cwe=class extends PR{constructor(e,t,r,n,s){super(e,t,r),this._sceneVelocity=n,this.direction=s}value(e){return super.valueFromInitialVelocity(this._sceneVelocity,e)}},BZ=class{constructor(e=300,t=12,r=.84){this._minimumInitialVelocity=e,this._stopVelocity=t,this._friction=r,this.enabled=!0,this._time=new Sc(.6),this._screen=[new Sc(.4),new Sc(.4)],this._scene=[new Sc(.6),new Sc(.6),new Sc(.6)],this._tmpDirection=R()}add(e,t,r){if(this.enabled){if(this._time.hasLastValue()&&this._time.computeDelta(r)<.015)return;this._screen[0].update(e[0]),this._screen[1].update(e[1]),this._scene[0].update(t[0]),this._scene[1].update(t[1]),this._scene[2].update(t[2]),this._time.update(r)}}reset(){this._screen[0].reset(),this._screen[1].reset(),this._scene[0].reset(),this._scene[1].reset(),this._scene[2].reset(),this._time.reset()}evaluateMomentum(){if(!this.enabled||!this._screen[0].hasFilteredDelta()||!this._time.hasFilteredDelta())return null;const e=this._screen[0].filteredDelta,t=this._screen[1].filteredDelta,r=e==null||t==null?0:Math.sqrt(e*e+t*t),n=this._time.filteredDelta,s=n==null||r==null?0:r/n;return Math.abs(s)<this._minimumInitialVelocity?null:this.createMomentum(s,this._stopVelocity,this._friction)}createMomentum(e,t,r){Z(this._tmpDirection,this._scene[0].filteredDelta??0,this._scene[1].filteredDelta??0,this._scene[2].filteredDelta??0);const n=_e(this._tmpDirection);n>0&&Q(this._tmpDirection,this._tmpDirection,1/n);const s=this._time.filteredDelta;return new cwe(e,t,r,s==null?0:n/s,this._tmpDirection)}},fU=class{constructor(e){this._gain=e}update(e){this.filteredValue!==void 0?this.filteredValue=(1-this._gain)*this.filteredValue+this._gain*e:this.filteredValue=e}reset(){this.filteredValue=void 0}get hasFilteredValue(){return this.filteredValue!==void 0}};const gU=1e-5;let hwe=class extends PR{constructor(e,t,r,n,s,a=0,o){super(e,t,r),this._angularVelocity1=n,this.axis1=s,this.angularVelocity2=a,this.axis2=o}value1(e){return super.valueFromInitialVelocity(this._angularVelocity1,e)}value2(e){return super.valueFromInitialVelocity(this.angularVelocity2,e)}},uwe=class{constructor(e=300,t=12,r=.84){this._minimumInitialVelocity=e,this._stopVelocity=t,this._friction=r,this.enabled=!0,this._tmpAxis1=R(),this._tmpAxis2=R(),this._tmpAngles=be(),this._time=new Sc(.3),this._screen=[new Sc(.4),new Sc(.4)],this._angle1=new fU(.6),this._angle2=new fU(.6),this._axis1=R(),this._axis2=R(),this._lastScene=R()}addMomentumDirectRotation(e,t,r,n,s,a){if(this.enabled){if(this._time.hasLastValue()){if(this._time.computeDelta(r)<.01)return;let o=hZ(this._lastScene,t,this._tmpAxis2,n,s,a);this._angle2.update(0),Ml(this._tmpAxis2)<gU?o=0:he(this._axis1,this._tmpAxis2),this._angle1.update(o),q(this._lastScene,t)}this._screen[0].update(e[0]),this._screen[1].update(e[1]),this._time.update(r)}}addMomentumPreserveHeading(e,t,r,n,s,a,o){if(this.enabled){if(this._time.hasLastValue()){if(this._time.computeDelta(r)<.01)return;uZ(this._lastScene,t,this._tmpAxis2,this._tmpAxis1,this._tmpAngles,n,s,a,o,!1),Ml(this._tmpAxis2)<gU?(this._angle1.update(0),this._angle2.update(0)):(this._angle1.update(this._tmpAngles[1]),this._angle2.update(this._tmpAngles[0]),he(this._axis1,this._tmpAxis1),he(this._axis2,this._tmpAxis2)),q(this._lastScene,t)}this._screen[0].update(e[0]),this._screen[1].update(e[1]),this._time.update(r)}}reset(){this._screen[0].reset(),this._screen[1].reset(),this._angle1.reset(),this._angle2.reset(),this._time.reset()}evaluateMomentum(){if(!this.enabled||!this._screen[0].hasFilteredDelta())return null;const e=this._screen[0].filteredDelta,t=this._screen[1].filteredDelta,r=e==null||t==null?null:Math.sqrt(e*e+t*t),n=this._time.filteredDelta,s=r==null||n==null?0:r/n;return Math.abs(s)<this._minimumInitialVelocity?null:this.createMomentum(s,this._stopVelocity,this._friction)}createMomentum(e,t,r){const n=this._time.filteredDelta,s=this._angle1.filteredValue,a=this._angle2.filteredValue,o=n==null||a==null?0:a/n;return new hwe(e,t,r,n==null||s==null?0:s/n,this._axis1,o,this._axis2)}},GZ=class{constructor(e=2.5,t=.01,r=.95,n=12){this._minimumInitialVelocity=e,this._stopVelocity=t,this._friction=r,this._maxVelocity=n,this.enabled=!0,this.value=new Sc(.8),this.time=new Sc(.3)}add(e,t){if(this.enabled&&t!=null){if(this.time.hasLastValue()){if(this.time.computeDelta(t)<.01)return;if(this.value.hasFilteredDelta()){const r=this.value.computeDelta(e);this.value.filteredDelta*r<0&&this.value.reset()}}this.time.update(t),this.value.update(e)}}reset(){this.value.reset(),this.time.reset()}evaluateMomentum(){if(!this.enabled||!this.value.hasFilteredDelta()||!this.time.hasFilteredDelta())return null;let e=this.value.filteredDelta/this.time.filteredDelta;return e=ce(e,-this._maxVelocity,this._maxVelocity),Math.abs(e)<this._minimumInitialVelocity?null:this.createMomentum(e,this._stopVelocity,this._friction)}createMomentum(e,t,r){return new PR(e,t,r)}},HZ=class extends GZ{constructor(e=3,t=.01,r=.95,n=12){super(e,t,r,n)}add(e,t){const r=this.value.lastValue;if(r!=null){let n=e-r;for(;n>Math.PI;)n-=2*Math.PI;for(;n<-Math.PI;)n+=2*Math.PI;e=r+n}super.add(e,t)}},dwe=class extends PR{constructor(e,t,r){super(e,t,r)}value(e){const t=super.value(e);return Math.exp(t)}valueDelta(e,t){const r=super.value(e),n=super.value(e+t)-r;return Math.exp(n)}},jZ=class extends GZ{constructor(e=2.5,t=.01,r=.95,n=12){super(e,t,r,n)}add(e,t){super.add(Math.log(e),t)}createMomentum(e,t,r){return new dwe(e,t,r)}},BL=class extends Hh{constructor(){super(...arguments),this._smoothRotation=new J2(.05),this._rotationAxis=R(),this._panningPlane=fr(),this._smoothScaling=new J2(.05),this._zoomCenterScreen=zi(),this._zoomMomentumEstimator=new jZ,this._rotationMomentumEstimator=new HZ,this._panSphericalMomentumEstimator=new uwe,this._panPlanarMomentumEstimator=new BZ,this._adjustedSphere=ou(),this._tmp3d=R(),this._tmpScreenPointArray=zi(),this._beginScreenPoint=zi(),this._beginScenePoint=R(),this._screenPickPoint=zi(),this._mode=Dn.Horizontal,this._tmpInteractionDirection=R(),this._constraintOptions={selection:wi.ALL,interactionType:rt.NONE,interactionFactor:0,interactionStartCamera:new yi,interactionDirection:null,tiltMode:vn.TUMBLE}}get _intersectionHelper(){return this.view.sceneIntersectionHelper}begin(e){if(!this.active)return;const t=this.view.navigation.momentumEnabled;this._zoomMomentumEstimator.enabled=t,this._rotationMomentumEstimator.enabled=t,this._panPlanarMomentumEstimator.enabled=t,this._panSphericalMomentumEstimator.enabled=t,this._beginHeading=-Sm.normalize(Ct(this.view.camera.heading)),this._beginRadius=e.radius,this._pointerCount=e.pointers.size,this._beginAngle=e.angle,this._smoothRotation.reset(),Dh(e.center,this._screenPickPoint),wn(this._beginScreenPoint,this._screenPickPoint);const r=Yt(this.view.spatialReference),n=lZ(this._intersectionHelper,this.startCamera,this._screenPickPoint,r,av.Silhouette);S(n.scenePickPoint)||(this._scenePickPoint=n.scenePickPoint,this._sphere=n.sphere,q(this._beginScenePoint,this._scenePickPoint),this._mode=CR(this.startCamera,this._screenPickPoint,n.hasGeometryIntersection,r),this._mode===Dn.Vertical&&this._preparePlanarPanMode(e),this._constraintOptions.interactionStartCamera.copyFrom(this.startCamera))}update(e){if(!this.active)return;this.currentCamera.copyFrom(this.startCamera);const t=e.pointers.size>1;this._mode===Dn.Horizontal?(t&&this._zoomSpherical(e),this._panningSpherical(e),t&&this._rotateSpherical(e)):(t&&this._zoomPlanar(e),this._panningPlanar(e),t&&this._rotatePlanar(e)),this.commitCamera()}end(e){e.pointers.size===this._pointerCount&&this.update(e),this.finishController();const t=this._zoomMomentumEstimator.evaluateMomentum();if(t)return this._mode===Dn.Horizontal?new kf({view:this.view,momentum:t,screenCenter:this._zoomCenterScreen,sceneCenter:this._beginScenePoint,radius:this._sphere[3]}):new p0({view:this.view,momentum:t,zoomCenter:this._beginScenePoint});const r=this._rotationMomentumEstimator.evaluateMomentum();if(r)return new eg({view:this.view,momentum:r,center:this._sphere,axis:this._rotationAxis});if(this._mode===Dn.Horizontal){const n=this._panSphericalMomentumEstimator.evaluateMomentum();if(n)return new sE({view:this.view,momentum:n})}else{const n=this._panPlanarMomentumEstimator.evaluateMomentum();if(n)return new Yb({view:this.view,momentum:n})}return null}_preparePlanarPanMode(e){const t=Aa(this._tmp3d,this.startCamera.viewForward);xw(this._scenePickPoint,t,this._panningPlane);const r=zi(this._screenPickPoint[0],0),n=R(),s=_e(this.startCamera.eye);this._adjustedSphere[3]=s<this._sphere[3]?s-100:this._sphere[3],lx(this._adjustedSphere,this.startCamera,r,n);const a=is();this.startCamera.projectToRenderScreen(n,a);const o=.9*a[1];this._screenPickPoint[1]=Math.min(this._screenPickPoint[1],o);const l=this._intersectionHelper.intersectScreen(this._screenPickPoint,this._scenePickPoint);l&&xw(this._scenePickPoint,Ia(this._panningPlane),this._panningPlane);const c=R(),u=R(),d=R(),m=80,f=5,_=50;ne(c,this._scenePickPoint,this.currentCamera.eye);const g=_e(c);he(c,c);const x=f*Math.max(Math.abs(this.view.camera.position.z),_),b=this.view._stage.renderView.getMinimalDepthForArea(null,this._screenPickPoint[0],this._screenPickPoint[1],this.view.state.camera,m);let v=y(b)?Math.min(b,x):x;v=l?Math.min(v,g):v,q(d,oe(u,this.currentCamera.eye,Q(u,c,v))),this._panningPlane[3]=-me(this._panningPlane,d),this.startCamera.center=oe(u,this.startCamera.eye,Q(u,this.startCamera.viewForward,v));const w=Dh(e.center,this._tmpScreenPointArray);FL(this._panningPlane,this.startCamera,w,this._beginScenePoint)}_zoomSpherical(e){const t=this._beginRadius/e.radius,r=.001875*Math.min(Math.max(e.radius,40),120);this._smoothScaling.gain=r,this._smoothScaling.update(t),aZ(this._sphere,this.currentCamera,this._smoothScaling.value),Dh(e.center,this._zoomCenterScreen),this._zoomMomentumEstimator.add(this._smoothScaling.value,.001*e.timestamp),this._constraintOptions.interactionType=rt.ZOOM,this._constraintOptions.interactionFactor=Cc(e.radius-this._beginRadius),pr(this.view,this.currentCamera,this._constraintOptions)}_panningSpherical(e){const t=Dh(e.center,this._tmpScreenPointArray);lx(this._sphere,this.currentCamera,t,this._tmp3d),ZN(this._beginScenePoint,me(this.currentCamera.up,this._beginScenePoint),this._sphere[3],this._beginHeading,this.view.camera.tilt,this.startCamera)?(mZ(this._sphere,this.currentCamera,this._beginScenePoint,this._tmp3d,this._beginHeading,this.view.camera.tilt,!1),this._panSphericalMomentumEstimator.addMomentumPreserveHeading(t,this._tmp3d,.001*e.timestamp,this.startCamera,this._sphere,this._beginHeading,this.view.camera.tilt)):(pZ(this._sphere,this.currentCamera,this._beginScenePoint,this._tmp3d,this.view.camera.tilt,!1),this._panSphericalMomentumEstimator.addMomentumDirectRotation(t,this._tmp3d,.001*e.timestamp,this.startCamera,this._sphere[3],this.view.camera.tilt)),this._constraintOptions.interactionType=rt.PAN,this._constraintOptions.interactionFactor=Cc(q0(this._screenPickPoint,t)),pr(this.view,this.currentCamera,this._constraintOptions)}_rotateSpherical(e){he(this._rotationAxis,this._scenePickPoint),this.currentCamera.aboveGround||Aa(this._rotationAxis,this._rotationAxis);const t=this._smoothRotation.value,r=t+DL(e.angle-t),n=.00125*Math.min(Math.max(e.radius,40),120);this._smoothRotation.gain=n,this._smoothRotation.update(r);const s=this._smoothRotation.value-this._beginAngle;this._rotationMomentumEstimator.add(s,.001*e.timestamp),Um(this.currentCamera,this._sphere,ox(this._rotationAxis,s)),this._constraintOptions.interactionType=rt.TUMBLE,this._constraintOptions.interactionFactor=Cc(e.radius*r),pr(this.view,this.currentCamera,this._constraintOptions)}_panningPlanar(e){const t=Dh(e.center,this._tmpScreenPointArray);FL(this._panningPlane,this.currentCamera,t,this._tmp3d)&&(cZ(this.currentCamera,this._beginScenePoint,this._tmp3d),this._panPlanarMomentumEstimator.add(t,this._tmp3d,.001*e.timestamp),this._constraintOptions.interactionType=rt.PAN,this._constraintOptions.interactionFactor=Cc(q0(this._beginScreenPoint,t)),this._constraintOptions.interactionDirection=this.view.renderCoordsHelper.worldUpAtPosition(this.currentCamera.eye,this._tmpInteractionDirection),pr(this.view,this.currentCamera,this._constraintOptions),this._constraintOptions.interactionDirection=null)}_zoomPlanar(e){const t=this._beginRadius/e.radius,r=.001875*Math.min(Math.max(e.radius,40),120);this._smoothScaling.gain=r,this._smoothScaling.update(t),this._zoomMomentumEstimator.add(this._smoothScaling.value,.001*e.timestamp),QN(this.currentCamera,this._beginScenePoint,this._smoothScaling.value,this.view.state.constraints.minimumPoiDistance),this._constraintOptions.interactionType=rt.ZOOM,this._constraintOptions.interactionFactor=Cc(e.radius-this._beginRadius),pr(this.view,this.currentCamera,this._constraintOptions)}_rotatePlanar(e){q(this._rotationAxis,this._beginScenePoint),this.currentCamera.aboveGround||Aa(this._rotationAxis,this._rotationAxis);const t=this._smoothRotation.value;let r=e.angle-t;r=DL(r);const n=t+r,s=.00125*Math.min(Math.max(e.radius,40),120);this._smoothRotation.gain=s,this._smoothRotation.update(n);const a=this._smoothRotation.value-this._beginAngle;this._rotationMomentumEstimator.add(a,.001*e.timestamp),Um(this.currentCamera,this._sphere,ox(this._rotationAxis,a)),this._constraintOptions.interactionType=rt.TUMBLE,this._constraintOptions.interactionFactor=Cc(e.radius*a),pr(this.view,this.currentCamera,this._constraintOptions)}};BL=h([D("esri.views.3d.state.controllers.global.PinchAndPanController")],BL);const _U=Ge(0,0,1),pwe={ELEVATION_THRESHOLD:3e4,ANGLE_THRESHOLD:16/180*Math.PI},mwe=80;let GL=class extends Hh{constructor(){super(...arguments),this._rotationValueSmooth=new J2(.05),this._scalingValueSmooth=new J2(.05),this._planeHorizontal=fr(),this._planeVertical=fr(),this._rotationMomentumEstimator=new HZ,this._panMomentumEstimator=new BZ(300,12,.9),this._zoomMomentumEstimator=new jZ,this._beginCenter=R(),this._tmpPoints=[],this._beginCenterScreen=zi(),this._tmpCentroid3d=R(),this._tmpCentroid2d=zi(),this._tmp2d=zi(),this._constraintOptions={selection:wi.ALL,interactionType:rt.NONE,interactionFactor:0,interactionStartCamera:new yi,interactionDirection:null,tiltMode:vn.TUMBLE}}begin(e){if(!this.active)return;const t=this.view.navigation.momentumEnabled;this._zoomMomentumEstimator.enabled=t,this._rotationMomentumEstimator.enabled=t,this._panMomentumEstimator.enabled=t,this._beginRadius=e.radius,this._pointerCount=e.pointers.size,this._beginAngle=e.angle,this._rotationValueSmooth.reset(),this._scalingValueSmooth.reset(),Dh(e.center,this._beginCenterScreen),mG(_U,0,this._planeHorizontal);const r=R(),n=this._intersectionHelper.intersectScreenFreePointFallback(this._beginCenterScreen,r),s=R();Aa(s,this.startCamera.viewForward);const a=R();q(a,_U);const o=me(s,a),l=tu(o<0?-o:o);if(this._panMode=l>=pwe.ANGLE_THRESHOLD?Dn.Horizontal:Dn.Vertical,xI(this._planeHorizontal,this._planeHorizontal,r),this.startCamera.aboveGround||TI(this._planeHorizontal,this._planeHorizontal),this._panMode===Dn.Vertical){Q(a,a,o),ne(this._planeVertical,s,a),he(this._planeVertical,this._planeVertical),xI(this._planeVertical,this._planeVertical,r);const c=R(),u=R(),d=R();ne(c,r,this.currentCamera.eye);const m=_e(c);he(c,c);const f=5*Math.max(Math.abs(this.view.camera.position.z),50),_=this.view._stage.renderView.getMinimalDepthForArea(this.view.voxelWasm,this._beginCenterScreen[0],this._beginCenterScreen[1],this.view.state.camera,mwe);let g=y(_)?Math.min(_,f):f;g=n?Math.min(g,m):g,q(d,oe(u,this.currentCamera.eye,Q(u,c,g))),this._planeVertical[3]=-me(this._planeVertical,d),this._computePlanePoints(e.pointers,this._planeVertical,this.startCamera,this._tmpPoints),AO(this._tmpPoints,this._beginCenter)}else this._computePlanePoints(e.pointers,this._planeHorizontal,this.startCamera,this._tmpPoints),AO(this._tmpPoints,this._beginCenter);this._constraintOptions.interactionStartCamera.copyFrom(this.startCamera)}update(e){if(!this.active)return;this.currentCamera.copyFrom(this.startCamera);const t=e.pointers.size>1,r=this._panMode===Dn.Horizontal?this._planeHorizontal:this._planeVertical,n=this._beginCenter;if(t){const s=this._beginRadius/e.radius,a=.001875*Math.min(Math.max(e.radius,40),120);this._scalingValueSmooth.gain=a,this._scalingValueSmooth.update(s),QN(this.currentCamera,n,this._scalingValueSmooth.value,this.view.state.constraints.minimumPoiDistance),this._zoomMomentumEstimator.add(this._scalingValueSmooth.value,.001*e.timestamp),this._constraintOptions.interactionType=rt.ZOOM,this._constraintOptions.interactionFactor=Cc(Math.abs(e.radius-this._beginRadius)),pr(this.view,this.currentCamera,this._constraintOptions)}if(this._computePlanePoints(e.pointers,r,this.currentCamera,this._tmpPoints),AO(this._tmpPoints,this._tmpCentroid3d),Dh(e.center,this._tmpCentroid2d),cZ(this.currentCamera,n,this._tmpCentroid3d),this._panMomentumEstimator.add(this._tmpCentroid2d,this._tmpCentroid3d,.001*e.timestamp),this._constraintOptions.interactionType=rt.PAN,this._constraintOptions.interactionFactor=Cc(q0(this._beginCenterScreen,this._tmpCentroid2d)),pr(this.view,this.currentCamera,this._constraintOptions),t){const s=this._planeHorizontal,a=n,o=this._rotationValueSmooth.value,l=o+DL(e.angle-o),c=.00125*Math.min(Math.max(e.radius,40),120);this._rotationValueSmooth.gain=c,this._rotationValueSmooth.update(l);const u=this._rotationValueSmooth.value-this._beginAngle;this._rotationMomentumEstimator.add(u,.001*e.timestamp),Um(this.currentCamera,a,ox(s,u)),this._constraintOptions.interactionType=rt.TUMBLE,this._constraintOptions.interactionFactor=Cc(Math.abs(e.radius*u)),pr(this.view,this.currentCamera,this._constraintOptions)}this.commitCamera()}end(e){e.pointers.size===this._pointerCount&&this.update(e),this.finishController();const t=this._zoomMomentumEstimator.evaluateMomentum();if(t)return new p0({view:this.view,momentum:t,zoomCenter:this._beginCenter});const r=this._rotationMomentumEstimator.evaluateMomentum();if(r)return new eg({view:this.view,momentum:r,center:this._beginCenter,axis:Ia(this._planeHorizontal)});const n=this._panMomentumEstimator.evaluateMomentum();return n?new Yb({view:this.view,momentum:n}):null}_computePlanePoints(e,t,r,n){n.length=e.size;const s=this._tmp2d;let a=0;return e.forEach(o=>{s[0]=o.x,s[1]=o.y,n[a]===void 0&&(n[a]=R()),FL(t,r,s,n[a]),a+=1}),n}get _intersectionHelper(){return this.view.sceneIntersectionHelper}};GL=h([D("esri.views.3d.state.controllers.local.PinchAndPanController")],GL);let yU=class extends Ei{constructor(e,t,r){super(!0),this._view=e,this.pointerAction=t,this._lastEndTimestamp=0,this._lastTimestamp=0,this.registerIncoming("drag",r,n=>this._handleDrag(n))}_handleDrag(e){if(e.data.pointerType==="mouse"&&!oN(e.data,this.pointerAction))return;const t=e.timestamp-this._lastEndTimestamp,r=40,n=this._momentum&&this._momentum.active&&t<r;switch(e.data.action){case"start":case"update":if(n)break;this._controller&&this._controller.active?e.data.timestamp-this._lastTimestamp>2&&(this._controller.update(e.data),this._lastTimestamp=e.timestamp):this._startController(e);break;case"end":case"removed":this._endController(e,!0);break;case"added":this._endController(e,!1),this._startController(e)}e.stopPropagation()}_endController(e,t){if(this._controller&&this._controller.active){this._lastEndTimestamp=e.timestamp;const r=this._controller.end(e.data);t&&r&&(this._momentum=r,this._view.state.switchCameraController(this._momentum))}this._controller=null}_startController(e){this._controller=this._createController(),this._view.state.switchCameraController(this._controller),this._controller.begin(e.data),this._lastTimestamp=e.timestamp}_createController(){return this._view.state.isGlobal?new BL({view:this._view}):new GL({view:this._view})}},fwe=class extends Ei{constructor(e,t){super(!0),this.view=e,this.registerIncoming("pointer-down",t,()=>this.view.state.stopActiveCameraController())}},qZ=class extends Ei{constructor(e,t){super(!0),this.key=e,this.registerIncoming("key-down",t,r=>this._handleKeyDown(r))}_handleKeyDown(e){e.data.key===this.key&&(this.activate(),e.stopPropagation())}},gwe=class extends qZ{constructor(e,t,r){super(t,r),this.view=e}activate(){this.view.goTo({heading:0}).catch(()=>{})}},_we=class extends qZ{constructor(e,t,r){super(t,r),this.view=e}activate(){this.view.goTo({tilt:0}).catch(()=>{})}},ywe=class extends Ei{constructor(e,t=!1){super(!0),this._view=e,this._invert=t,this.registerIncoming("vertical-two-finger-drag",r=>this._handleTwoFinger(r))}_handleTwoFinger(e){var n,s,a;const t=this._invert?-1:1,r=zi(0,e.data.delta*t);switch(e.data.action){case"begin":(n=this._cameraController)==null||n.end(),this._cameraController=new Zb({view:this._view,pivot:ro.CENTER}),this._view.state.switchCameraController(this._cameraController),this._cameraController.begin(r);break;case"update":(s=this._cameraController)==null||s.update(r);break;case"end":(a=this._cameraController)==null||a.end(),this._cameraController=null}}},vwe=class extends Ei{constructor(e=20,t=40){super(!1),this._threshold=e,this._maxDelta=t,this._state="ready",this._emittedArtificalEnd2=!1,this._vertical=this.registerOutgoing("vertical-two-finger-drag"),this._artificalDrag=this.registerOutgoing("drag"),this._dragEventSeparator=new Wx({start:(r,n)=>this._observeStart(r,n),update:(r,n,s)=>this._observeUpdate(r,n,s),end:(r,n)=>this._observeEnd(n)}),this.registerIncoming("drag",r=>this._dragEventSeparator.handle(r))}get failed(){return this._state==="failed"}_observeStart(e,t){e===1&&this._emittedArtificalEnd2&&(this._emittedArtificalEnd2=!1,this._artificalDrag.emit({action:"start",button:t.data.button,buttons:t.data.buttons,pointerType:t.data.pointerType,timestamp:t.data.timestamp,pointers:t.data.pointers,pointer:t.data.pointer,angle:t.data.angle,radius:t.data.radius,center:t.data.center}),t.stopPropagation()),this._state=e===2?"ready":"failed"}_observeUpdate(e,t,r){if(this._state!=="failed"&&e===2)return this._state==="active"?(this._vertical.emit({delta:t.data.center.y-this._thresholdReachedCenter.y,action:"update"}),void t.stopPropagation()):void(this._checkMovementWithinLimits(t.data,r.data)?this._checkVerticalThresholdReached(t.data,r.data)&&(this._state="active",this._emittedArtificalEnd2=!0,this._thresholdReachedCenter=t.data.center,this._artificalDrag.emit({action:"end",button:t.data.button,buttons:t.data.buttons,pointerType:t.data.pointerType,timestamp:t.data.timestamp,pointers:t.data.pointers,pointer:t.data.pointer,angle:t.data.angle,radius:t.data.radius,center:t.data.center}),this._vertical.emit({delta:t.data.center.y-this._thresholdReachedCenter.y,action:"begin"}),t.stopPropagation()):this._state="failed")}_observeEnd(e){this._state==="active"&&(this._vertical.emit({delta:e.data.center.y-this._thresholdReachedCenter.y,action:"end"}),this._state="ready",e.stopPropagation())}_checkMovementWithinLimits(e,t){let r=-1/0,n=1/0,s=-1/0,a=1/0;for(const{x:g,y:x}of t.pointers.values())r=Math.max(r,g),n=Math.min(n,g),s=Math.max(s,x),a=Math.min(a,x);let o=-1/0,l=1/0,c=-1/0,u=1/0;for(const{x:g,y:x}of e.pointers.values())o=Math.max(o,g),l=Math.min(l,g),c=Math.max(c,x),u=Math.min(u,x);const d=r-n,m=s-a,f=o-l,_=c-u;return Math.abs(e.center.x-t.center.x)<this._threshold&&Math.abs(f-d)<=this._maxDelta&&Math.abs(_-m)<=this._maxDelta}_checkVerticalThresholdReached(e,t){let r=Math.abs(e.center.y-t.center.y);return e.pointers.forEach((n,s)=>{const a=t.pointers.get(s);r=Math.min(r,Math.abs(n.y-a.y))}),r>=this._threshold}},ac=class extends ue{constructor(){super(...arguments),this._handles=new Ft}destroy(){this._handles&&(this._handles.removeAll(),this._handles=null),this.disconnect()}get primaryDragAction(){return this._get("primaryDragAction")}set primaryDragAction(e){e!=="pan"&&e!=="rotate"||e===this._get("primaryDragAction")||(this._set("primaryDragAction",e),this._updateMode())}get mode(){return this._get("mode")}set mode(e){e!=="default"&&e!=="pro"||e===this._get("mode")||(this._set("mode",e),this._updateMode())}get hasPendingInputs(){var e;return(e=this._inputManager)==null?void 0:e.hasPendingInputs}get latestPointerType(){var e;return(e=this._inputManager)==null?void 0:e.latestPointerType}get latestPointerLocation(){var e;return(e=this._inputManager)==null?void 0:e.latestPointerLocation}get multiTouchActive(){var e;return((e=this._inputManager)==null?void 0:e.multiTouchActive)??!1}disconnect(){this.view.viewEvents.disconnect(),this._inputManager=Te(this._inputManager)}connect(){const e=this.view;this._source=new lN(this.view.surface,e.input);const t=[new VW,new UW,new FW,new NW(this.view.navigation),new vwe],r=new uc({eventSource:this._source,recognizers:t});this._inputManager=r,r.installHandlers("prevent-context-menu",[new DW],Yh.INTERNAL),this._modeDragPan=new yU(e,"primary"),this._modeDragRotate=new UO(e,"secondary",ro.CENTER),this._modeDragZoom=new Ybe(e,"tertiary");const n={lookAround:"b",pan:{left:"ArrowLeft",right:"ArrowRight",forward:"ArrowUp",backward:"ArrowDown",up:"u",down:"j",headingLeft:"a",headingRight:"d",tiltUp:"w",tiltDown:"s",zoomIn:"+",zoomOut:"-"},resetHeading:"n",resetTilt:"p"};r.installHandlers("navigation",[new fwe(e),new H1e(e),new swe(e),new awe(e,n.pan),new owe(e),new _we(e,n.resetTilt),new gwe(e,n.resetHeading),new UO(e,"primary",ro.EYE,[n.lookAround]),new UO(e,"secondary",ro.CENTER,[n.lookAround]),new yU(e,"tertiary",[n.lookAround]),this._modeDragRotate,this._modeDragZoom,this._modeDragPan,new ywe(e)],Yh.INTERNAL),this.view.viewEvents.connect(r),this._updateMode(),this._handles.add(z(()=>{var s;return(s=this.view.navigation)==null?void 0:s.browserTouchPanEnabled},s=>{this._source.browserTouchPanningEnabled=!s},Qe))}_updateMode(){const e=this.mode,t=this.primaryDragAction,r=HL.get(e).get(t);this._modeDragPan&&(this._modeDragPan.pointerAction=r.pan),this._modeDragRotate&&(this._modeDragRotate.pointerAction=r.rotate),this._modeDragZoom&&(this._modeDragZoom.pointerAction=r.zoom)}get test(){return{inputManager:this._inputManager,modeDragPan:this._modeDragPan,modeDragRotate:this._modeDragRotate,modeDragZoom:this._modeDragZoom}}};h([p()],ac.prototype,"view",void 0),h([p({value:"pan"})],ac.prototype,"primaryDragAction",null),h([p({value:"default"})],ac.prototype,"mode",null),h([p({readOnly:!0})],ac.prototype,"hasPendingInputs",null),h([p()],ac.prototype,"latestPointerType",null),h([p()],ac.prototype,"latestPointerLocation",null),h([p()],ac.prototype,"multiTouchActive",null),h([p()],ac.prototype,"_inputManager",void 0),ac=h([D("esri.views.3d.input.SceneInputManager")],ac);const HL=new Map,zO=new Map,BO=new Map;zO.set("pan",{pan:"primary",rotate:"secondary",zoom:"tertiary"}),zO.set("rotate",{pan:"secondary",rotate:"primary",zoom:"tertiary"}),BO.set("pan",{pan:"primary",rotate:"tertiary",zoom:"secondary"}),BO.set("rotate",{pan:"tertiary",rotate:"primary",zoom:"secondary"}),HL.set("default",zO),HL.set("pro",BO);const bwe=ac;let Go,F0,jL=!1,qL=!1,WL=!1,XL=!1,Kb=null;function wwe(i,e){if(!qL||!F0)return;WZ();const t=F0;let r=0;for(let n=0;n<i.accBinsNumX;n++)for(let s=0;s<i.accBinsNumY;s++){const a=i.accBins[n][i.accBinsNumY-1-s];r+=a.length;const o=n*i.accBinsSizeX,l=(n+1)*i.accBinsSizeX,c=s*i.accBinsSizeY,u=(s+1)*i.accBinsSizeY;t.fillText(a.length.toFixed(),o+5,c+15),XZ(o,l,c,u,"blue")}t.fillText("total totalShownLabels: "+r,70,40),t.fillText("total visible labels: "+e.size,70,50),t.fillText("total numTests: "+i.accNumTests,70,30)}function xwe(i){WL=jt.DECONFLICTOR_SHOW_VISIBLE,XL=jt.DECONFLICTOR_SHOW_INVISIBLE,jL=WL||XL,qL=jt.DECONFLICTOR_SHOW_GRID,Kb=null,jL||qL?Kb=()=>Twe(i):Go&&(Go.parentElement.removeChild(Go),Go=null)}function WZ(){Kb&&(Kb(),Kb=null)}function Twe(i){Go==null&&(Go=document.createElement("canvas"),Go.setAttribute("id","canvas2d"),i.surface.parentElement.style.position="relative",i.surface.parentElement.appendChild(Go));const{state:e}=i,{camera:t,pixelRatio:r}=e,{width:n,height:s}=t,a=n*r,o=s*r;Go.setAttribute("width",`${a}px`),Go.setAttribute("height",`${o}px`),Go.setAttribute("style",`position:absolute;left:0px;top:0px;display:block;pointer-events:none;width:${n}px;height:${s}px`),F0=Go.getContext("2d"),F0.clearRect(0,0,n,s),F0.font="12px Arial"}function XZ(i,e,t,r,n){WZ();const s=Go.height,a=F0;a.beginPath(),a.lineWidth=1,a.strokeStyle=n,a.moveTo(i,s-t),a.lineTo(e,s-t),a.stroke(),a.lineTo(e,s-r),a.stroke(),a.lineTo(e,s-t),a.stroke(),a.lineTo(i,s-t),a.stroke(),a.lineTo(i,s-t),a.stroke(),a.closePath()}function Cwe(i,e){jL&&(e&&WL||!e&&XL)&&XZ(i.aabr[0],i.aabr[2],i.aabr[1],i.aabr[3],e?"green":"red")}var $n,Qo;(function(i){i[i.GRAPHIC=0]="GRAPHIC",i[i.LABEL=1]="LABEL",i[i._COUNT=2]="_COUNT"})($n||($n={})),function(i){i[i.USER_SETTING=0]="USER_SETTING",i[i.SCALE_RANGE=1]="SCALE_RANGE",i[i.FILTER=2]="FILTER",i[i.DECONFLICTION=3]="DECONFLICTION",i[i._COUNT=4]="_COUNT"}(Qo||(Qo={}));function Swe(i){return i instanceof Float32Array&&i.length>=16}function Ewe(i){return Array.isArray(i)&&i.length>=16}function Pwe(i){return Swe(i)||Ewe(i)}let QZ=class ZZ extends ti{initializeConfiguration(e,t){t.hasWebGL2Context=e.rctx.type===Nn.WEBGL2,t.spherical=e.viewingMode===Se.Global}initializeProgram(e){return new Jt(e.rctx,ZZ.shader.get().build(this.configuration),ai)}_setPipelineState(e){const t=this.configuration,r=e===Ht.NONE,n=e===Ht.FrontFace,s=this.configuration.hasPolygonOffset&&Rwe,a=(r||n)&&t.output!==k.Highlight?(t.depthEnabled||t.occlusionPass)&&nl:null;return Ke({blending:t.output===k.Color||t.output===k.Alpha||t.output===k.Highlight?r?Awe:jm(e):null,depthTest:{func:hs.LEQUAL},depthWrite:a,colorWrite:ht,polygonOffset:s})}initializePipeline(){return this._setPipelineState(this.configuration.transparencyPassType)}get primitiveType(){return this.configuration.occlusionPass?Dt.POINTS:Dt.TRIANGLES}};QZ.shader=new ii(bse,()=>G(()=>import("./HUDMaterial.glsl-ea4d9626.js"),["assets/HUDMaterial.glsl-ea4d9626.js","assets/vec2-528adfe4.js","assets/common-c186b691.js","assets/vec2f64-30dc1443.js","assets/vec4f64-e407da96.js","assets/string-a318751c.js","assets/typedArrayUtil-4d7bb04c.js","assets/floatRGBA-9ad35d39.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/vec4-790471c0.js","assets/Texture-46c8c2cb.js","assets/compilerUtils-18d58939.js","assets/Error-ec6249b9.js","assets/Evented-a45c8b0f.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/VisualVariablePassParameters-d460182b.js","assets/VertexAttribute-9c5c630d.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/ShaderBuilder-a7d0da4e.js","assets/mat3f64-c6305894.js","assets/aaBoundingBox-657a9b82.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/aaBoundingRect-193543b5.js","assets/basicInterfaces-19ed850e.js","assets/ViewingMode-5d7d590b.js","assets/Util-a48361c6.js","assets/mat4-44a0988f.js","assets/mat4f64-1e28eae0.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/ScreenSpacePass-d5e48a9b.js","assets/Float4PassUniform-d7bdbc81.js","assets/Texture2DPassUniform-753de459.js","assets/assets-8d3e737a.js","assets/Matrix3PassUniform-ad9f953b.js","assets/HUD.glsl-d3a072ad.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/FloatPassUniform-68d54f51.js","assets/TransparencyPassType-a11868d2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/Slice.glsl-3b39b1f7.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/AlphaCutoff-96178e0d.js"]));const Rwe={factor:0,units:-4},Awe=lu(de.ONE,de.ONE_MINUS_SRC_ALPHA);let lr=class extends cu{constructor(){super(...arguments),this.output=k.Color,this.screenCenterOffsetUnitsEnabled=Im.World,this.transparencyPassType=Ht.NONE,this.spherical=!1,this.occlusionTestEnabled=!0,this.signedDistanceFieldEnabled=!1,this.vvSize=!1,this.vvColor=!1,this.hasVerticalOffset=!1,this.hasScreenSizePerspective=!1,this.debugDrawLabelBorder=!1,this.binaryHighlightOcclusionEnabled=!0,this.hasSlicePlane=!1,this.hasPolygonOffset=!1,this.depthEnabled=!0,this.pixelSnappingEnabled=!0,this.isDraped=!1,this.hasMultipassGeometry=!1,this.hasMultipassTerrain=!1,this.cullAboveGround=!1,this.occlusionPass=!1,this.objectAndLayerIdColorInstanced=!1}};h([N({count:k.COUNT})],lr.prototype,"output",void 0),h([N({count:Im.COUNT})],lr.prototype,"screenCenterOffsetUnitsEnabled",void 0),h([N({count:Ht.COUNT})],lr.prototype,"transparencyPassType",void 0),h([N()],lr.prototype,"spherical",void 0),h([N()],lr.prototype,"occlusionTestEnabled",void 0),h([N()],lr.prototype,"signedDistanceFieldEnabled",void 0),h([N()],lr.prototype,"vvSize",void 0),h([N()],lr.prototype,"vvColor",void 0),h([N()],lr.prototype,"hasVerticalOffset",void 0),h([N()],lr.prototype,"hasScreenSizePerspective",void 0),h([N()],lr.prototype,"debugDrawLabelBorder",void 0),h([N()],lr.prototype,"binaryHighlightOcclusionEnabled",void 0),h([N()],lr.prototype,"hasSlicePlane",void 0),h([N()],lr.prototype,"hasPolygonOffset",void 0),h([N()],lr.prototype,"depthEnabled",void 0),h([N()],lr.prototype,"pixelSnappingEnabled",void 0),h([N()],lr.prototype,"isDraped",void 0),h([N()],lr.prototype,"hasMultipassGeometry",void 0),h([N()],lr.prototype,"hasMultipassTerrain",void 0),h([N()],lr.prototype,"cullAboveGround",void 0),h([N()],lr.prototype,"occlusionPass",void 0),h([N()],lr.prototype,"objectAndLayerIdColorInstanced",void 0),h([N({constValue:!0})],lr.prototype,"hasSliceInVertexProgram",void 0),h([N({constValue:!1})],lr.prototype,"hasVvInstancing",void 0);let lv=class extends Fd{constructor(e){super(e,new Vwe),this._configuration=new lr}getConfiguration(e,t){return this._configuration.output=e,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.hasVerticalOffset=!!this.parameters.verticalOffset,this._configuration.hasScreenSizePerspective=!!this.parameters.screenSizePerspective,this._configuration.screenCenterOffsetUnitsEnabled=this.parameters.centerOffsetUnits==="screen"?Im.Screen:Im.World,this._configuration.hasPolygonOffset=this.parameters.polygonOffset,this._configuration.isDraped=this.parameters.isDraped,this._configuration.occlusionTestEnabled=this.parameters.occlusionTest,this._configuration.pixelSnappingEnabled=this.parameters.pixelSnappingEnabled,this._configuration.signedDistanceFieldEnabled=this.parameters.textureIsSignedDistanceField,this._configuration.vvSize=!!this.parameters.vvSizeEnabled,this._configuration.vvColor=!!this.parameters.vvColorEnabled,this._configuration.occlusionPass=t.slot===ae.OCCLUSION_PIXELS&&this.parameters.occlusionTest&&(e===k.Color||e===k.Alpha),e===k.Color&&(this._configuration.debugDrawLabelBorder=!!this.parameters.debugDrawLabelBorder),e===k.Highlight&&(this._configuration.binaryHighlightOcclusionEnabled=this.parameters.binaryHighlightOcclusion),this._configuration.depthEnabled=this.parameters.depthEnabled,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration.hasMultipassGeometry=t.multipassGeometry.enabled,this._configuration.hasMultipassTerrain=t.multipassTerrain.enabled,this._configuration.cullAboveGround=t.multipassTerrain.cullAboveGround,this._configuration}intersect(e,t,r,n,s,a,o,l,c){y(c)?this._intersectDrapedHudGeometry(e,a,o,l,c):this._intersectHudGeometry(e,t,r,n,o,l)}_intersectDrapedHudGeometry(e,t,r,n,s){const a=e.vertexAttributes.get(P.POSITION),o=e.vertexAttributes.get(P.SIZE),l=this.parameters,c=X5(l);let u=1,d=1;if(y(n)){const f=n(wU);u=f[0],d=f[5]}u*=e.screenToWorldRatio,d*=e.screenToWorldRatio;const m=Nwe*e.screenToWorldRatio;for(let f=0;f<a.data.length/a.size;f++){const _=f*a.size,g=a.data[_],x=a.data[_+1],b=f*o.size;let v;rp[0]=o.data[b]*u,rp[1]=o.data[b+1]*d,l.textureIsSignedDistanceField&&(v=l.outlineSize*e.screenToWorldRatio/2),vU(t,g,x,rp,m,v,l,c)&&r(s.dist,s.normal,-1,!1)}}_intersectHudGeometry(e,t,r,n,s,a){if(!n.options.selectionMode||!n.options.hud||MP(t))return;const o=this.parameters;let l=1,c=1;if(Td(HO,r),y(a)){const v=a(wU);l=v[0],c=v[5],Iwe(HO)}const u=e.vertexAttributes.get(P.POSITION),d=e.vertexAttributes.get(P.SIZE),m=e.vertexAttributes.get(P.NORMAL),f=e.vertexAttributes.get(P.AUXPOS1);it(u.size>=3);const _=n.point,g=n.camera,x=X5(o);l*=g.pixelRatio,c*=g.pixelRatio;const b=this.parameters.centerOffsetUnits==="screen";for(let v=0;v<u.data.length/u.size;v++){const w=v*u.size;Z(ms,u.data[w],u.data[w+1],u.data[w+2]),Ce(ms,ms,r);const T=v*d.size;rp[0]=d.data[T]*l,rp[1]=d.data[T+1]*c,Ce(ms,ms,g.viewMatrix);const E=v*f.size;if(Z(Po,f.data[E+0],f.data[E+1],f.data[E+2]),!b&&(ms[0]+=Po[0],ms[1]+=Po[1],Po[2]!==0)){const A=Po[2];he(Po,ms),ne(ms,ms,Q(Po,Po,A))}const C=v*m.size;if(Z(h1,m.data[C],m.data[C+1],m.data[C+2]),this._normalAndViewAngle(h1,HO,g,jO),this._applyVerticalOffsetTransformationView(ms,jO,g,GO),g.applyProjection(ms,Fs),Fs[0]>-1){Fs[0]=Math.floor(Fs[0]),Fs[1]=Math.floor(Fs[1]),b&&(Po[0]||Po[1])&&(Fs[0]+=Po[0],Po[1]!==0&&(Fs[1]+=tne(Po[1],GO.factorAlignment)),g.unapplyProjection(Fs,ms)),Fs[0]+=this.parameters.screenOffset[0],Fs[1]+=this.parameters.screenOffset[1],SG(rp,GO.factor,rp);const A=Fwe*g.pixelRatio;let M;if(o.textureIsSignedDistanceField&&(M=o.outlineSize*g.pixelRatio/2),vU(_,Fs[0],Fs[1],rp,A,M,o,x)){const I=n.ray;if(Ce(bU,ms,kn(Dwe,g.viewMatrix)),Fs[0]=_[0],Fs[1]=_[1],g.unprojectFromRenderScreen(Fs,ms)){const L=R();q(L,I.direction);const U=1/_e(L);Q(L,L,U),s(Ii(I.origin,ms)*U,L,-1,!0,1,bU)}}}}}computeAttachmentOrigin(e,t){const r=e.vertexAttributes;if(!r)return!1;const n=r.get(P.POSITION),s=e.indices.get(P.POSITION);return Ene(n,s,t)}createBufferWriter(){return new zwe(this)}_normalAndViewAngle(e,t,r,n){return Pwe(t)&&(t=Td($we,t)),Nl(n.normal,e,t),Ce(n.normal,n.normal,r.viewInverseTransposeMatrix),n.cosAngle=me(YZ,kwe),n}_updateScaleInfo(e,t,r){const n=this.parameters;y(n.screenSizePerspective)?M5(r,t,n.screenSizePerspective,e.factor):(e.factor.scale=1,e.factor.factor=0,e.factor.minPixelSize=0,e.factor.paddingPixels=0),y(n.screenSizePerspectiveAlignment)?M5(r,t,n.screenSizePerspectiveAlignment,e.factorAlignment):(e.factorAlignment.factor=e.factor.factor,e.factorAlignment.scale=e.factor.scale,e.factorAlignment.minPixelSize=e.factor.minPixelSize,e.factorAlignment.paddingPixels=e.factor.paddingPixels)}applyShaderOffsetsView(e,t,r,n,s,a,o){const l=this._normalAndViewAngle(t,r,s,jO);return this._applyVerticalGroundOffsetView(e,l,s,o),this._applyVerticalOffsetTransformationView(o,l,s,a),this._applyPolygonOffsetView(o,l,n[3],s,o),this._applyCenterOffsetView(o,n,o),o}applyShaderOffsetsNDC(e,t,r,n,s){return this._applyCenterOffsetNDC(e,t,r,n),y(s)&&q(s,n),this._applyPolygonOffsetNDC(n,t,r,n),n}_applyPolygonOffsetView(e,t,r,n,s){const a=n.aboveGround?1:-1;let o=Math.sign(r);o===0&&(o=a);const l=a*o;if(this.parameters.shaderPolygonOffset<=0)return q(s,e);const c=ce(Math.abs(t.cosAngle),.01,1),u=1-Math.sqrt(1-c*c)/c/n.viewport[2];return Q(s,e,l>0?u:1/u),s}_applyVerticalGroundOffsetView(e,t,r,n){const s=_e(e),a=r.aboveGround?1:-1,o=.5*r.computeRenderPixelSizeAtDist(s),l=Q(ms,t.normal,a*o);return oe(n,e,l),n}_applyVerticalOffsetTransformationView(e,t,r,n){const s=this.parameters;if(!s.verticalOffset||!s.verticalOffset.screenLength){if(s.screenSizePerspective||s.screenSizePerspectiveAlignment){const c=_e(e);this._updateScaleInfo(n,c,t.cosAngle)}else n.factor.scale=1,n.factorAlignment.scale=1;return e}const a=_e(e),o=je(s.screenSizePerspectiveAlignment,s.screenSizePerspective),l=ine(r,a,s.verticalOffset,t.cosAngle,o);return this._updateScaleInfo(n,a,t.cosAngle),Q(t.normal,t.normal,l),oe(e,e,t.normal)}_applyCenterOffsetView(e,t,r){const n=this.parameters.centerOffsetUnits!=="screen";return r!==e&&q(r,e),n&&(r[0]+=t[0],r[1]+=t[1],t[2]&&(he(h1,r),oe(r,r,Q(h1,h1,t[2])))),r}_applyCenterOffsetNDC(e,t,r,n){const s=this.parameters.centerOffsetUnits!=="screen";return n!==e&&q(n,e),s||(n[0]+=t[0]/r.fullWidth*2,n[1]+=t[1]/r.fullHeight*2),n}_applyPolygonOffsetNDC(e,t,r,n){const s=this.parameters.shaderPolygonOffset;if(e!==n&&q(n,e),s){const a=r.aboveGround?1:-1,o=a*Math.sign(t[3]);n[2]-=(o||a)*s}return n}requiresSlot(e,t){if(t===k.Color||t===k.Alpha||t===k.Highlight||t===k.ObjectAndLayerIdColor){if(e===ae.DRAPED_MATERIAL)return!0;const{drawInSecondSlot:r,occlusionTest:n}=this.parameters;return e===(r?ae.LABEL_MATERIAL:ae.HUD_MATERIAL)||n&&e===ae.OCCLUSION_PIXELS}return!1}createGLMaterial(e){return new Owe(e)}calculateRelativeScreenBounds(e,t,r=$t()){return Mwe(this.parameters,e,t,r),r[2]=r[0]+e[0],r[3]=r[1]+e[1],r}},Owe=class extends kG{constructor(e){super({...e,...e.material.parameters})}selectProgram(e){return this.ensureTechnique(QZ,e)}beginSlot(e){return this.updateTexture(this._material.parameters.textureId),this._material.setParameters(this.textureBindParameters),this.selectProgram(e)}};function Mwe(i,e,t,r=Lwe){return wn(r,i.anchorPosition),r[0]*=-e[0],r[1]*=-e[1],r[0]+=i.screenOffset[0]*t,r[1]+=i.screenOffset[1]*t,r}function Iwe(i){const e=i[0],t=i[1],r=i[2],n=i[3],s=i[4],a=i[5],o=i[6],l=i[7],c=i[8],u=1/Math.sqrt(e*e+t*t+r*r),d=1/Math.sqrt(n*n+s*s+a*a),m=1/Math.sqrt(o*o+l*l+c*c);return i[0]=e*u,i[1]=t*u,i[2]=r*u,i[3]=n*d,i[4]=s*d,i[5]=a*d,i[6]=o*m,i[7]=l*m,i[8]=c*m,i}function vU(i,e,t,r,n,s,a,o){let l=e-n-(o[0]>0?r[0]*o[0]:0),c=l+r[0]+2*n,u=t-n-(o[1]>0?r[1]*o[1]:0),d=u+r[1]+2*n;const m=a.distanceFieldBoundingBox;return a.textureIsSignedDistanceField&&y(m)&&(l+=r[0]*m[0],u+=r[1]*m[1],c-=r[0]*(1-m[2]),d-=r[1]*(1-m[3]),l-=s,c+=s,u-=s,d+=s),i[0]>l&&i[0]<c&&i[1]>u&&i[1]<d}const GO={factor:{scale:0,factor:0,minPixelSize:0,paddingPixels:0},factorAlignment:{scale:0,factor:0,minPixelSize:0,paddingPixels:0}},Lwe=be(),ms=R(),h1=R(),Fs=_i(),YZ=R(),bU=R(),HO=Or(),$we=Or(),Dwe=ve(),Po=R(),jO={normal:YZ,cosAngle:0},wU=ve(),Fwe=1,Nwe=2,rp=[0,0],kwe=Ge(0,0,1);let Vwe=class extends Pne{constructor(){super(...arguments),this.renderOccluded=cr.Occlude,this.color=Bi(1,1,1,1),this.texCoordScale=[1,1],this.polygonOffset=!1,this.anchorPosition=Xt(.5,.5),this.screenOffset=[0,0],this.shaderPolygonOffset=1e-5,this.textureIsSignedDistanceField=!1,this.outlineColor=Bi(1,1,1,1),this.outlineSize=0,this.vvSizeEnabled=!1,this.vvSizeMinSize=[1,1,1],this.vvSizeMaxSize=[100,100,100],this.vvSizeOffset=[0,0,0],this.vvSizeFactor=[1,1,1],this.vvColorEnabled=!1,this.vvColorValues=[0,0,0,0,0,0,0,0],this.vvColorColors=[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],this.hasSlicePlane=!1,this.pixelSnappingEnabled=!0,this.occlusionTest=!0,this.binaryHighlightOcclusion=!0,this.debugDrawLabelBorder=!1,this.centerOffsetUnits="world",this.drawInSecondSlot=!1,this.depthEnabled=!0,this.isDraped=!1}};const KZ=sn().vec3f(P.POSITION).vec3f(P.NORMAL).vec2f(P.UV0).vec4u8(P.COLOR).vec2f(P.SIZE).vec4f(P.AUXPOS1).vec4f(P.AUXPOS2),Uwe=KZ.clone().vec4u8(P.OBJECTANDLAYERIDCOLOR);let zwe=class{constructor(e){this._material=e,this.vertexBufferLayout=St("enable-feature:objectAndLayerId-rendering")?Uwe:KZ}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){return 6*e.indices.get(P.POSITION).length}write(e,t,r,n,s){LD(r.indices.get(P.POSITION),r.vertexAttributes.get(P.POSITION).data,e,n.position,s,6),VG(r.indices.get(P.NORMAL),r.vertexAttributes.get(P.NORMAL).data,t,n.normal,s,6);{const a=r.vertexAttributes.get(P.UV0).data;let o,l,c,u;if(a==null||a.length<4){const _=this._material.parameters;o=0,l=0,c=_.texCoordScale[0],u=_.texCoordScale[1]}else o=a[0],l=a[1],c=a[2],u=a[3];c=Math.min(1.99999,c+1),u=Math.min(1.99999,u+1);const d=r.indices.get(P.POSITION).length,m=n.uv0;let f=s;for(let _=0;_<d;++_)m.set(f,0,o),m.set(f,1,l),f+=1,m.set(f,0,c),m.set(f,1,l),f+=1,m.set(f,0,c),m.set(f,1,u),f+=1,m.set(f,0,c),m.set(f,1,u),f+=1,m.set(f,0,o),m.set(f,1,u),f+=1,m.set(f,0,o),m.set(f,1,l),f+=1}UG(r.indices.get(P.COLOR),r.vertexAttributes.get(P.COLOR).data,4,n.color,s,6);{const a=r.indices.get(P.SIZE),o=r.vertexAttributes.get(P.SIZE).data,l=a.length,c=n.size;let u=s;for(let d=0;d<l;++d){const m=o[2*a[d]],f=o[2*a[d]+1];for(let _=0;_<6;++_)c.set(u,0,m),c.set(u,1,f),u+=1}}if(r.indices.get(P.AUXPOS1)&&r.vertexAttributes.get(P.AUXPOS1)&&Sw(r.indices.get(P.AUXPOS1),r.vertexAttributes.get(P.AUXPOS1).data,n.auxpos1,s,6),r.indices.get(P.AUXPOS2)&&r.vertexAttributes.get(P.AUXPOS2)&&Sw(r.indices.get(P.AUXPOS2),r.vertexAttributes.get(P.AUXPOS2).data,n.auxpos2,s,6),y(r.objectAndLayerIdColor)&&r.objectAndLayerIdColor.length===4&&r.indices.get(P.POSITION)){const a=r.indices.get(P.POSITION).length,o=n.getField(P.OBJECTANDLAYERIDCOLOR,Lm);Rne(r.objectAndLayerIdColor,o,a,s,6)}}};const th=R(),D_=_i(),u1=_i(),qO=R(),Bwe=ve(),Gwe=ou(),WO=oo(),Hwe=R(),jwe=$t();class qwe{constructor(){this.aabr=$t(),this.distance=0,this.culled=!1,this.visible=!1}}class Wwe{constructor(e,t,r={}){this.graphics3DGraphic=e,this.slicePlaneEnabled=t,this.info=r}}class Xwe{constructor(){this.active=new Map,this.visible=new Map}clear(){this.active.clear(),this.visible.clear()}}class Qwe{}class Zwe{constructor(){this.sortArray=new Zt({allocator:e=>e||new Qwe})}}var eo;(function(i){i[i.Idle=0]="Idle",i[i.Process=1]="Process",i[i.Sort=2]="Sort",i[i.Deconflict=3]="Deconflict",i[i.NumStates=4]="NumStates"})(eo||(eo={}));class JZ{constructor(){this.camera=new yi,this.slicePlane=zd(),this.slicePlaneEnabled=!1}copyFrom(e){this.camera.copyFrom(e.camera),o_(e.slicePlane,this.slicePlane),this.slicePlaneEnabled=e.slicePlaneEnabled}}let m0=class extends ue{constructor(i){super(i),this._dirty=!1,this._runningViewState=new JZ,this._state=eo.Idle,this._graphics=new Xwe,this._iterators=new Zwe,this._accBinsNumX=15,this._accBinsNumY=20,this._accBinsSizeX=0,this._accBinsSizeY=0,this._accBins=null,this.accNumTests=0}get dirty(){return this._dirty}get state(){return this._state}destroy(){this._graphics.clear(),this._iterators=null}setDirty(){!this._dirty&&this._graphics.active.size>0&&(this._dirty=!0,this.notifyChange("updating"))}get updating(){return this._state!==eo.Idle||this._dirty}get updatingProgress(){if(!this.updating)return 1;const i=this._state/eo.NumStates;return this._dirty?.5*i:i}get running(){return this.view.ready&&this.view.state!=null&&this.updating}runTask(i){switch(this._state){case eo.Idle:this._startUpdate(),i.madeProgress();case eo.Process:if(this._state=eo.Process,!this._processActiveGraphics(i))return;case eo.Sort:if(this._state=eo.Sort,!this._sortVisibleGraphics(i))return;case eo.Deconflict:if(this._state=eo.Deconflict,!this._deconflictVisibleGraphics(i))return;default:wwe(this,this._graphics.visible),this._state=eo.Idle,this.notifyChange("updating")}}modifyGraphics(i,e){e?i.forEach(t=>this.addToActiveGraphics(t)):i.forEach(t=>this.removeFromActiveGraphics(t)),this.setDirty()}layerSupportsDeconfliction(i){if(S(i)||i.type!=="object3d")return!1;const e=i.stageObject;return(e?e.geometryRecords.length:0)!==1?!1:e.geometryRecords[0].material instanceof lv}_startUpdate(){xwe(this.view),this._dirty=!1,this._runningViewState.copyFrom(this.viewState);const{fullWidth:i,fullHeight:e}=this._runningViewState.camera;this._initBins(i,e),this._resetIterators()}addToActiveGraphics(i){i.info[this.visibilityGroup]=new qwe,this._graphics.active.set(i.graphics3DGraphic.graphic.uid,i),this.setDirty()}removeFromActiveGraphics(i){this._removeFromVisibleGraphics(i),Ywe(i,this.visibilityGroup),delete i.info[this.visibilityGroup],this._graphics.active.delete(i.graphics3DGraphic.graphic.uid),this.setDirty()}_addToVisibleGraphics(i){this._graphics.visible.set(i.graphics3DGraphic.graphic.uid,i)}_removeFromVisibleGraphics(i){this._graphics.visible.delete(i.graphics3DGraphic.graphic.uid)}_processActiveGraphics(i){const e=this._ensureActiveGraphicsIterator(),t=kn(Bwe,this._runningViewState.camera.projectionMatrix),r=this.view.viewingMode==="global"&&this.view.map.ground.opacity===1&&this._runningViewState.camera.relativeElevation>0?Gwe:null;let n=0;for(y(r)&&(Ce(r,Gl,this._runningViewState.camera.viewMatrix),r[3]=Yt(this.view.spatialReference).radius,n=cre(r,Gl));!i.done;){i.madeProgress();const s=e.next();if(s.done===!0)return this._resetActiveGraphicsIterator(),!0;const a=s.value,o=a&&a.info[this.visibilityGroup];o&&(this._collectGraphics3DGraphics(a,t,r,n),o.culled?this._removeFromVisibleGraphics(a):this._addToVisibleGraphics(a))}return!1}_sortVisibleGraphics(i){const e=this._ensureSortGraphicsIterator();for(;!i.done;){const t=e.next();if(i.madeProgress(),t.done===!0)return this._resetSortGraphicsIterator(),!0}return!1}_deconflictVisibleGraphics(i){const e=this._ensureVisibleGraphicsIterator(),t=this.visibilityGroup===$n.LABEL;for(;!i.done;){i.madeProgress();const r=e.next();if(r.done===!0)return this._resetVisibleGraphicsIterator(),!0;const n=r.value,s=n.info[this.visibilityGroup];if(!s||s.culled)continue;const a=n.graphics3DGraphic,o=(!t||a.isVisible())&&!this._isConflicted(n);o&&this._addToBins(n),s.visible=o,this._setGraphicVisibility(n,o),Cwe(s,o)}return!1}_resetIterators(){this._iterators.active=null,this._iterators.visible=null,this._iterators.sort=null}_ensureActiveGraphicsIterator(){return this._iterators.active||(this._iterators.active=xU(this._graphics.active)),this._iterators.active}_resetActiveGraphicsIterator(){this._iterators.active=null}_ensureVisibleGraphicsIterator(){return this._iterators.visible||(this._iterators.visible=xU(this._graphics.visible)),this._iterators.visible}_resetVisibleGraphicsIterator(){this._iterators.visible=null}_ensureSortGraphicsIterator(){return this._iterators.sort||(this._iterators.sort=Kwe(this._graphics.visible,this._iterators.sortArray,this.visibilityGroup)),this._iterators.sort}_resetSortGraphicsIterator(){this._iterators.sort=null}_collectGraphics3DGraphics(i,e,t,r){const n=i.graphics3DGraphic;if(n.destroyed)return;const s=i.info[this.visibilityGroup];if(!n.isVisible($n.GRAPHIC,Qo.DECONFLICTION))return void(s.culled=!0);const a=this.getGraphicsLayers(n);Uc(s.aabr);let o=null;for(const l of a){if(!this.layerSupportsDeconfliction(l))continue;const c=l.stageObject.geometryRecords[0].material;if(S(o)){if(o=this._getProjectionInfo(l,e,txe),o.isOutsideScreen||this._isCulledBySlice(i,th)||y(t)&&this._isCulledByHorizon(o,t,r))return void(s.culled=!0);!jt.TESTS_DISABLE_OPTIMIZATIONS&&s.visible&&(o.distance*=.7)}this._expandBoundingRect(s,l,c,o)}S(o)?s.culled=!0:(s.distance=o.distance,s.culled=!1)}_getProjectionInfo(i,e,t){const r=this._runningViewState.camera,n=i.stageObject,s=n.geometryRecords[0],a=s.material,o=_D(n.boundingVolumeWorldSpace.bounds);Ce(th,o,r.viewMatrix);const l=s.geometry.vertexAttributes,c=l.get(P.NORMAL).data,u=l.get(P.AUXPOS1).data;return a.applyShaderOffsetsView(th,c,n.transformation,u,r,t.scaleInfo,th),Qs(D_,th[0],th[1],th[2],1),sd(u1,D_,r.projectionMatrix),Q(t.positionNDC,u1,1/u1[3]),a.applyShaderOffsetsNDC(t.positionNDC,u,r,t.positionNDC,qO),t.distanceWithoutPolygonOffset=r.depthNDCToWorld(qO[2]),t.distance=qO[2]===t.positionNDC[2]?t.distanceWithoutPolygonOffset:r.depthNDCToWorld(t.positionNDC[2]),Qs(u1,t.positionNDC[0],t.positionNDC[1],t.positionNDC[2],1),sd(D_,u1,e),TD(D_,D_,1/D_[3]),Z(t.positionView,th[0],th[1],th[2]),t}_isCulledByHorizon(i,e,t){return q(WO.direction,i.positionView),Z(WO.origin,0,0,0),!!PP(e,WO,Hwe)&&i.distanceWithoutPolygonOffset>t}_isCulledBySlice(i,e){return i.slicePlaneEnabled&&this._runningViewState.slicePlaneEnabled&&EN(this._runningViewState.slicePlane,e)}_expandBoundingRect(i,e,t,{positionNDC:r,scaleInfo:n}){const s=this._runningViewState.camera,a=e.getScreenSize(Jwe);SG(a,n.factor,a),a[0]*=s.pixelRatio,a[1]*=s.pixelRatio;const o=DE(t.calculateRelativeScreenBounds(a,n.factorAlignment.scale,jwe),dt(0,s.fullWidth,.5+.5*r[0]),dt(0,s.fullHeight,.5+.5*r[1])),l=this.iconMarginFactor;if(l!==0){const c=l*Math.min(Nh(o),Om(o));o[0]-=c,o[1]-=c,o[2]+=c,o[3]+=c}hm(i.aabr,o,i.aabr)}_isConflicted(i){const e=i.graphics3DGraphic.graphic.uid,t=i.info[this.visibilityGroup];for(let r=Math.floor(t.aabr[0]/this._accBinsSizeX);r<=Math.floor(t.aabr[2]/this._accBinsSizeX);r++)if(!(r<0||r>=this._accBinsNumX))for(let n=Math.floor(t.aabr[1]/this._accBinsSizeY);n<=Math.floor(t.aabr[3]/this._accBinsSizeY);n++){if(n<0||n>=this._accBinsNumY)continue;const s=this._accBins[r][n];for(let a=0;a<s.length;a++){const o=s.data[a],l=o.info[this.visibilityGroup];if(l&&l.visible&&o.graphics3DGraphic.graphic.uid!==e&&(this.accNumTests++,EP(l.aabr,t.aabr)))return!0}}return!1}_initBins(i,e){if(this._accBins==null){this._accBins=[];for(let t=0;t<this._accBinsNumX;t++){this._accBins.push([]);const r=this._accBins[this._accBins.length-1];for(let n=0;n<this._accBinsNumY;n++)r.push(new Zt)}}else for(let t=0;t<this._accBinsNumX;t++)for(let r=0;r<this._accBinsNumY;r++)this._accBins[t][r].clear();this._accBinsSizeX=i/this._accBinsNumX,this._accBinsSizeY=e/this._accBinsNumY,this.accNumTests=0}_addToBins(i){const e=i.info[this.visibilityGroup],t=Math.floor(e.aabr[0]/this._accBinsSizeX),r=Math.floor(e.aabr[2]/this._accBinsSizeX),n=Math.floor(e.aabr[1]/this._accBinsSizeY),s=Math.floor(e.aabr[3]/this._accBinsSizeY);for(let a=t;a<=r;a++)if(!(a<0||a>=this._accBinsNumX))for(let o=n;o<=s;o++)o<0||o>=this._accBinsNumY||this._accBins[a][o].push(i)}_setGraphicVisibility(i,e){const t=i.graphics3DGraphic;t.destroyed||(t.setVisibilityFlag(Qo.DECONFLICTION,e,this.visibilityGroup),this.visibilityGroup===$n.LABEL&&this.view.labeler.setLabelGraphicVisibility(t,e))}};function Ywe(i,e){const t=i.graphics3DGraphic;t.destroyed||t.clearVisibilityFlag(Qo.DECONFLICTION,e)}function*xU(i){if(Map.prototype.entries){const e=i.entries();for(let t=e.next();!t.done;t=e.next())yield t.value[1]}else yield*i.values()}function*Kwe(i,e,t){e.clear(),i.forEach((n,s)=>{const a=e.pushNew();a.id=s,a.prio=n.info?-n.info[t].distance:Number.MAX_VALUE}),yield;const r=e.iterableSort((n,s)=>s.prio-n.prio);for(let n=r.next();!n.done;n=r.next())yield;e.forAll(n=>{const s=i.get(n.id);s&&(i.delete(n.id),i.set(n.id,s))}),e.clear()}h([p({constructOnly:!0})],m0.prototype,"view",void 0),h([p({type:Boolean,readOnly:!0})],m0.prototype,"updating",null),m0=h([D("esri.views.3d.layers.graphics.Deconflictor")],m0);const Jwe=be();class exe{constructor(){this.positionView=R(),this.positionNDC=R(),this.distance=0,this.distanceWithoutPolygonOffset=0,this.scaleInfo={factor:{scale:0,factor:0,minPixelSize:0,paddingPixels:0},factorAlignment:{scale:0,factor:0,minPixelSize:0,paddingPixels:0}}}get isOutsideScreen(){const e=this.positionNDC;return e[0]<-1||e[1]<-1||e[2]<-1||e[0]>=1||e[1]>=1}}const txe=new exe,ixe=2e3;let aE=class extends m0{constructor(e){super(e),this.visibilityGroup=$n.LABEL,this.iconMarginFactor=0,this._lastDeconfliction=0}get viewState(){return this.parent.viewState}runTask(e){if(this.parent.running)return;const t=performance.now();(e.state===Fh.IDLE||t-this._lastDeconfliction>ixe)&&(super.runTask(e),this.state===eo.Idle&&(this._lastDeconfliction=t))}enabledChanged(e,t){this.modifyGraphics(t,e.labelsEnabled)}getGraphicsLayers(e){return e.labelGraphics}};h([p({constructOnly:!0})],aE.prototype,"parent",void 0),aE=h([D("esri.views.3d.layers.graphics.LabelDeconflictor")],aE);let QL=class extends m0{constructor(){super(...arguments),this._handles=new Ft,this._contexts=new Map,this._viewState=new JZ,this.visibilityGroup=$n.GRAPHIC,this._iconMarginFactor=-.1}get labels(){return this._labels}get viewState(){return this._viewState}initialize(){this._handles.add([z(()=>{var e,t;return(t=(e=this.view)==null?void 0:e.state)==null?void 0:t.camera},()=>{this._updateViewState(),this.setDirty()}),z(()=>{var e,t,r;return(r=(t=(e=this.view)==null?void 0:e.map)==null?void 0:t.ground)==null?void 0:r.opacity},(e,t)=>{e!==1&&t!==1||this.setDirty()}),z(()=>{var e;return(e=this.view)==null?void 0:e.slicePlane},()=>{this._updateSlicePlane(),this._slicePlaneChanged()},Qe)]),this._frameTask=this.view.resourceController.scheduler.registerTask(dr.GRAPHICS_DECONFLICTOR,this),this._labels=new aE({view:this.view,parent:this})}destroy(){this._labels.destroy(),this._labels=null,this._handles.destroy(),this._handles=null,this._frameTask&&(this._frameTask.remove(),this._frameTask=null)}get iconMarginFactor(){return this._iconMarginFactor}set iconMarginFactor(e){this._iconMarginFactor=e,this.setDirty()}setDirty(){this._contexts.size>0&&(super.setDirty(),this._labels.setDirty())}runTask(e){super.runTask(e),this.running||this._labels.setDirty()}setInitialIconVisibilityFlag(e,t){const r=!(this._graphicSupportsDeconfliction(t)&&XO(e));t.setVisibilityFlag(Qo.DECONFLICTION,r,$n.GRAPHIC)}_updateViewState(){this.view&&this.view.state&&(this._viewState.camera.copyFrom(this.view.state.camera),this._updateSlicePlane())}_updateSlicePlane(){const e=this.view?this.view.slicePlane:null;y(e)&&tQ(e,this._viewState.camera.viewMatrix,this._viewState.slicePlane),this._viewState.slicePlaneEnabled=y(e)}_slicePlaneChanged(){Er(this._contexts,(e,t)=>t.symbolCreationContext.slicePlaneEnabled)&&this.setDirty()}addGraphicsOwner(e){let t=this._contexts.get(e);return t==null&&(t=new Map,this._contexts.set(e,t),this.setDirty()),{addGraphic:r=>this._addGraphic(e,t,r),removeGraphic:r=>this._removeGraphic(t,r),labelingInfoChange:()=>this._labels.enabledChanged(e,t),featureReductionChange:()=>this.enabledChanged(e,t),slicePlaneEnabledChange:()=>this._slicePlaneEnabledChanged(e,t),clear:()=>t.forEach(r=>this._removeGraphic(t,r.graphics3DGraphic))}}removeGraphicsOwner(e){const t=this._contexts.get(e);t&&(t.forEach(r=>this._removeGraphic(t,r.graphics3DGraphic)),this._contexts.delete(e),this.setDirty())}_addGraphic(e,t,r){const n=r.graphic.uid,s=new Wwe(r,e.symbolCreationContext.slicePlaneEnabled);t.set(n,s),XO(e)&&this.addToActiveGraphics(s),e.labelsEnabled&&this._labels.addToActiveGraphics(s)}_removeGraphic(e,t){const r=t.graphic.uid,n=e.get(r);n&&(this.removeFromActiveGraphics(n),this._labels.removeFromActiveGraphics(n),e.delete(r),this.setDirty())}enabledChanged(e,t){const r=XO(e);r||rxe(e),this.modifyGraphics(t,r)}_slicePlaneEnabledChanged(e,t){const r=e.symbolCreationContext.slicePlaneEnabled;t.forEach(n=>n.slicePlaneEnabled=r),this.setDirty()}getGraphicsLayers(e){return e.graphics}_graphicSupportsDeconfliction(e){if(e.isDraped)return!1;const t=e.graphics;if(!t||!t.length)return!1;for(const r of t)if(this.layerSupportsDeconfliction(r))return!0;return!1}};function XO(i){const e=i.layer;return!(!e||!e.featureReduction||e.featureReduction.type!=="selection")}function rxe(i){const e=i.graphics3DGraphics;e&&e.forEach(t=>t.clearVisibilityFlag(Qo.DECONFLICTION))}QL=h([D("esri.views.3d.layers.graphics.GraphicsDeconflictor")],QL);function eY(i){return"declaredClass"in i}function TU(i){return"declaredClass"in i}function nxe(i){return"declaredClass"in i}function sxe(i,e){if(!i)return null;if(nxe(i))return i;const t=new jc({layer:e,sourceLayer:e});return t.visible=i.visible,t.symbol=Rr(i.symbol),t.attributes=Rr(i.attributes),t.geometry=tY(i.geometry),t}function tY(i){return S(i)?null:eY(i)?i:AE(axe(i))}function axe(i){const{wkid:e,wkt:t,latestWkid:r}=i.spatialReference,n={wkid:e,wkt:t,latestWkid:r};switch(i.type){case"point":{const{x:s,y:a,z:o,m:l}=i;return{x:s,y:a,z:o,m:l,spatialReference:n}}case"polygon":{const{rings:s,hasZ:a,hasM:o}=i;return{rings:CU(s),hasZ:a,hasM:o,spatialReference:n}}case"polyline":{const{paths:s,hasZ:a,hasM:o}=i;return{paths:CU(s),hasZ:a,hasM:o,spatialReference:n}}case"extent":{const{xmin:s,xmax:a,ymin:o,ymax:l,zmin:c,zmax:u,mmin:d,mmax:m,hasZ:f,hasM:_}=i;return{xmin:s,xmax:a,ymin:o,ymax:l,zmin:c,zmax:u,mmin:d,mmax:m,hasZ:f,hasM:_,spatialReference:n}}case"multipoint":{const{points:s,hasZ:a,hasM:o}=i;return{points:rY(s)?iY(s):s,hasZ:a,hasM:o,spatialReference:n}}default:return}}function CU(i){return oxe(i)?i.map(e=>iY(e)):i}function iY(i){return i.map(e=>zee(e))}function oxe(i){for(const e of i)if(e.length!==0)return rY(e);return!1}function rY(i){return i.length&&(u7(i[0])||d7(i[0]))}function lxe(i,e){if(!i)return null;let t;if(TU(i)){if(e==null)return i.clone();if(TU(e))return e.copy(i)}return e!=null?(t=e,t.x=i.x,t.y=i.y,t.spatialReference=i.spatialReference,i.hasZ?(t.z=i.z,t.hasZ=i.hasZ):(t.z=null,t.hasZ=!1),i.hasM?(t.m=i.m,t.hasM=!0):(t.m=null,t.hasM=!1)):(t=kd(i.x,i.y,i.z,i.spatialReference),i.hasM&&(t.m=i.m,t.hasM=!0)),t}function C6e(i){const{wkid:e,wkt:t,latestWkid:r}=i,n={wkid:e,wkt:t,latestWkid:r};return Qt.fromJSON(n)}function n4(i,e){if(i.type==="point")return np(i,e,!1);if(eY(i))switch(i.type){case"extent":return np(i.center,e,!1);case"polygon":return np(i.centroid,e,!1);case"polyline":return np(SU(i),e,!0);case"mesh":return np(i.origin,e,!1)}else switch(i.type){case"extent":return np(cxe(i),e,!0);case"polygon":return np(hxe(i),e,!0);case"polyline":return np(SU(i),e,!0)}}function SU(i){const e=i.paths[0];if(!e||e.length===0)return null;const t=F7(e,N7(e)/2);return kd(t[0],t[1],t[2],i.spatialReference)}function cxe(i){const e=isFinite(i.zmin);return kd(.5*(i.xmax+i.xmin),.5*(i.ymax+i.ymin),e?.5*(i.zmax+i.zmin):void 0,i.spatialReference)}function hxe(i){const e=i.rings[0];if(!e||e.length===0)return null;const t=lie(i.rings,i.hasZ);return kd(t[0],t[1],t[2],i.spatialReference)}function np(i,e,t){const r=t?i:lxe(i);return e&&i?pte(i,r,e)?r:null:r}function S6e(i,e,t,r=0){if(i){e||(e=$t());const n=i;let s=.5*n.width*(t-1),a=.5*n.height*(t-1);return n.width<1e-7*n.height?s+=a/20:n.height<1e-7*n.width&&(a+=s/20),Qs(e,n.xmin-s-r,n.ymin-a-r,n.xmax+s+r,n.ymax+a+r),e}return null}function nY(i,e){for(let t=0;t<i.geometries.length;++t){const r=i.geometries[t].getMutableAttribute(P.AUXPOS1);r&&r.data[3]!==e&&(r.data[3]=e,i.geometryVertexAttrsUpdated(i.geometryRecords[t]))}}function Jb(i,e){const t=xD(Rc);return y(i)&&(t[0]=i[0],t[1]=i[1],t[2]=i[2]),y(e)?t[3]=e:y(i)&&i.length>3&&(t[3]=i[3]),t}function E6e(i,e,t,r,n,s=[0,0,0,0]){for(let a=0;a<3;++a)y(i)&&i[a]!=null?s[a]=i[a]:y(t)&&t[a]!=null?s[a]=t[a]:s[a]=n[a];return y(e)?s[3]=e:y(r)?s[3]=r:s[3]=n[3],s}function EU(i=em,e,t,r=1){const n=new Array(3);if(S(e)||S(t))n[0]=1,n[1]=1,n[2]=1;else{let s,a=0;for(let o=2;o>=0;o--){const l=i[o];let c;const u=l!=null,d=o===0&&!s&&!u,m=t[o];l==="symbol-value"||d?c=m!==0?e[o]/m:1:u&&l!=="proportional"&&isFinite(l)&&(c=m!==0?l/m:1),c!=null&&(n[o]=c,s=c,a=Math.max(a,Math.abs(c)))}for(let o=2;o>=0;o--)n[o]==null?n[o]=s:n[o]===0&&(n[o]=.001*a)}for(let s=2;s>=0;s--)n[s]/=r;return Tl(n)}function uxe(i){return i.isPrimitive!=null}function RR(i){return uxe(i)&&(i=[i.width,i.depth,i.height]),eP(i)?null:"Symbol sizes may not be negative values"}function eP(i){if(Array.isArray(i)){for(const e of i)if(!eP(e))return!1;return!0}return i==null||i>=0}function dxe(i,e,t,r=ve()){const n=i||0,s=e||0,a=t||0;return n!==0&&vw(r,r,-n/180*Math.PI),s!==0&&bw(r,r,s/180*Math.PI),a!==0&&bD(r,r,a/180*Math.PI),r}function s4(i,e,t){if(t.minDemResolution!=null)return t.minDemResolution;const r=Gm(e),n=QG(i)*r,s=ZG(i)*r,a=HD(i)*(e.isGeographic?1:r);return n===0&&s===0&&a===0?t.minDemResolutionForPoints:.01*Math.max(n,s,a)}function sY(i,e,t,r,n,s,a,o,l,c,u){const d=bxe[u.mode];let m,f,_=0;if(Ma(i,e,t,r,l.spatialReference,n,o))return d.requiresAlignment(u)?(_=d.applyElevationAlignmentBuffer(r,n,s,a,o,l,c,u),m=s,f=a):(m=r,f=n),Ma(m,l.spatialReference,f,s,c.spatialReference,a,o)?_:void 0}function $d(i,e,t,r,n){const s=(W2(i)?i.z:PZ(i)?i.array[i.offset+2]:i[2])||0;switch(t.mode){case"on-the-ground":{const a=je(Gh(e,i,"ground"),0);return n.verticalDistanceToGround=0,n.sampledElevation=a,void(n.z=a)}case"relative-to-ground":{const a=je(Gh(e,i,"ground"),0),o=t.geometryZWithOffset(s,r);return n.verticalDistanceToGround=o,n.sampledElevation=a,void(n.z=o+a)}case"relative-to-scene":{const a=je(Gh(e,i,"scene"),0),o=t.geometryZWithOffset(s,r);return n.verticalDistanceToGround=o,n.sampledElevation=a,void(n.z=o+a)}case"absolute-height":{const a=t.geometryZWithOffset(s,r),o=je(Gh(e,i,"ground"),0);return n.verticalDistanceToGround=a-o,n.sampledElevation=o,void(n.z=a)}default:return Pa(t.mode),void(n.z=0)}}function pxe(i,e,t,r){return $d(i,e,t,r,f0),f0.z}function Kx(i,e,t){return e==null||t==null?i.definedChanged:e==="on-the-ground"&&t==="on-the-ground"?i.staysOnTheGround:e===t||e!=="on-the-ground"&&t!=="on-the-ground"?Zi.UPDATE:i.onTheGroundChanged}function Ql(i){return i==="relative-to-ground"||i==="relative-to-scene"}function zm(i){return i!=="absolute-height"}function mxe(i,e,t,r,n){$d(e,t,n,r,f0),nY(i,f0.verticalDistanceToGround);const s=f0.sampledElevation,a=pn(wxe,i.transformation);return _C[0]=e.x,_C[1]=e.y,_C[2]=f0.z,xd(e.spatialReference,_C,a,r.spatialReference)?i.transformation=a:console.warn("Could not locate symbol object properly, it might be misplaced"),s}function fxe(i,e,t,r,n,s){let a=0;const o=s.spatialReference;e*=3,r*=3;for(let l=0;l<n;++l){const c=i[e+0],u=i[e+1],d=i[e+2],m=je(s.getElevation(c,u,d,o,"ground"),0);a+=m,t[r+0]=c,t[r+1]=u,t[r+2]=m,e+=3,r+=3}return a/n}function gxe(i,e,t,r,n,s,a,o){let l=0;const c=o.calculateOffsetRenderUnits(a),u=o.featureExpressionInfoContext,d=s.spatialReference;e*=3,r*=3;for(let m=0;m<n;++m){const f=i[e+0],_=i[e+1],g=i[e+2],x=je(s.getElevation(f,_,g,d,"ground"),0);l+=x,t[r+0]=f,t[r+1]=_,t[r+2]=u==null?g+x+c:x+c,e+=3,r+=3}return l/n}function _xe(i,e,t,r,n,s,a,o){let l=0;const c=o.calculateOffsetRenderUnits(a),u=o.featureExpressionInfoContext,d=s.spatialReference;e*=3,r*=3;for(let m=0;m<n;++m){const f=i[e+0],_=i[e+1],g=i[e+2],x=je(s.getElevation(f,_,g,d,"scene"),0);l+=x,t[r+0]=f,t[r+1]=_,t[r+2]=u==null?g+x+c:x+c,e+=3,r+=3}return l/n}function yxe(i){const e=i.meterUnitOffset,t=i.featureExpressionInfoContext;return e!==0||t!=null}function vxe(i,e,t,r,n,s,a,o){const l=o.calculateOffsetRenderUnits(a),c=o.featureExpressionInfoContext;e*=3,r*=3;for(let u=0;u<n;++u){const d=i[e+0],m=i[e+1],f=i[e+2];t[r+0]=d,t[r+1]=m,t[r+2]=c==null?f+l:l,e+=3,r+=3}return 0}let Jx=class{constructor(){this.verticalDistanceToGround=0,this.sampledElevation=0,this.z=0}};var Zi;(function(i){i[i.NONE=0]="NONE",i[i.UPDATE=1]="UPDATE",i[i.RECREATE=2]="RECREATE"})(Zi||(Zi={}));const bxe={"absolute-height":{applyElevationAlignmentBuffer:vxe,requiresAlignment:yxe},"on-the-ground":{applyElevationAlignmentBuffer:fxe,requiresAlignment:()=>!0},"relative-to-ground":{applyElevationAlignmentBuffer:gxe,requiresAlignment:()=>!0},"relative-to-scene":{applyElevationAlignmentBuffer:_xe,requiresAlignment:()=>!0}},wxe=ve(),f0=new Jx,_C=R();function aY(i,e,t,r){const n=i.stageObject,s=n.geometryRecords;let a=0;for(const o of s){const{update:l,averageGeometrySampledElevation:c}=lY(o,e,t,r);a+=c,l&&n.geometryVertexAttrsUpdated(o)}return a/s.length}function hx(i,e,t,r){const n=i.stageObject,s=e.centerPointInElevationSR;let a=0;n.metadata.usesVerticalDistanceToGround?($d(s,t,e,r,Ta),nY(n,Ta.verticalDistanceToGround),a=Ta.sampledElevation):($d(s,t,e,r,Ta),e.mode!=="absolute-height"&&(a=Ta.sampledElevation));const o=pn(xxe,n.transformation),l=Z(oY,o[12],o[13],o[14]);jt.TESTS_DISABLE_OPTIMIZATIONS?(xa[0]=s.x,xa[1]=s.y,xa[2]=Ta.z,xd(s.spatialReference,xa,o,r.spatialReference)&&(n.transformation=o)):r.setAltitudeOfTransformation(Ta.z,o);const c=a4/r.unitInMeters;return(Math.abs(o[12]-l[0])>=c||Math.abs(o[13]-l[1])>=c||Math.abs(o[14]-l[2])>=c)&&(n.transformation=o),a}const xxe=ve();function Txe(i,e,t,r){const n=i.graphics3DSymbolLayer.lodRenderer;if(S(n))return 0;const s=e.centerPointInElevationSR;$d(s,t,e,r,Ta);const a=e.mode!=="absolute-height"?Ta.sampledElevation:0,o=n.instanceData,l=i.instanceIndex,c=Sxe;o.getGlobalTransform(l,c);const u=Z(oY,c[12],c[13],c[14]);jt.TESTS_DISABLE_OPTIMIZATIONS?(xa[0]=s.x,xa[1]=s.y,xa[2]=Ta.z,xd(s.spatialReference,xa,c,r.spatialReference)&&o.setGlobalTransform(l,c)):r.setAltitudeOfTransformation(Ta.z,c);const d=a4/r.unitInMeters;return(jt.TESTS_DISABLE_OPTIMIZATIONS||Math.abs(c[12]-u[0])>=d||Math.abs(c[13]-u[1])>=d||Math.abs(c[14]-u[2])>=d)&&o.setGlobalTransform(l,c),a}function Cxe(i,e,t,r){const n=i.stageObject,s=n.geometryRecords;if(s.length===0)return 0;let a=0,o=null,l=0,c=!1;for(const u of s){const d=u.geometry.vertexAttributes.get(P.POSITION);if(d!==o){const{update:m,averageGeometrySampledElevation:f}=lY(u,e,t,r);l=f,o=d,c=m}c&&n.geometryVertexAttrsUpdated(u),a+=l}return a/s.length}const a4=.01,xa=R(),ul=R(),F_=R(),Sxe=ve(),oY=R(),Ta=new Jx;function lY(i,e,t,r){let n=!1;const s=t.spatialReference,a=i.geometry,o=i.getShaderTransformation(),l=e.requiresSampledElevationInfo;ul[0]=o[12],ul[1]=o[13],ul[2]=o[14],a.invalidateBoundingInfo();const c=a.getMutableAttribute(P.POSITION),u=c.data,d=a.vertexAttributes.get(P.MAPPOS).data,m=c.size,f=u.length/m,_=new EZ(d,s);let g=0,x=0;for(let b=0;b<f;b++){if(F_[0]=u[g],F_[1]=u[g+1],F_[2]=u[g+2],$d(_,t,e,r,Ta),l&&(x+=Ta.sampledElevation),jt.TESTS_DISABLE_OPTIMIZATIONS)u[g]=_.array[_.offset],u[g+1]=_.array[_.offset+1],u[g+2]=Ta.z,Ma(u,s,g,u,r.spatialReference,g,1),u[g]-=ul[0],u[g+1]-=ul[1],u[g+2]-=ul[2],n=!0;else{xa[0]=u[g]+ul[0],xa[1]=u[g+1]+ul[1],xa[2]=u[g+2]+ul[2],r.setAltitude(xa,Ta.z),u[g]=xa[0]-ul[0],u[g+1]=xa[1]-ul[1],u[g+2]=xa[2]-ul[2];const v=a4/r.unitInMeters;(Math.abs(F_[0]-u[g])>=v||Math.abs(F_[1]-u[g+1])>=v||Math.abs(F_[2]-u[g+2])>=v)&&(n=!0)}g+=m,_.offset+=3}return x/=f,{update:n,averageGeometrySampledElevation:x}}const Exe=J.getLogger("esri.views.3d.layers.graphics.featureExpressionInfoUtils");function Pxe(i){return{cachedResult:i.cachedResult,arcade:i.arcade?{func:i.arcade.func,context:i.arcade.modules.arcadeUtils.createExecContext(null,{sr:i.arcade.context.spatialReference}),modules:i.arcade.modules}:null}}function R6e(i){const e=i&&i.expression;if(typeof e=="string"){const t=uY(e);if(t!=null)return{cachedResult:t}}return null}async function A6e(i,e,t,r){const n=i&&i.expression;if(typeof n!="string")return null;const s=uY(n);if(s!=null)return{cachedResult:s};const a=await iD();xi(t);const o=a.arcadeUtils,l=o.createSyntaxTree(n);return o.dependsOnView(l)?(r!=null&&r.error("Expressions containing '$view' are not supported on ElevationInfo"),{cachedResult:0}):{arcade:{func:o.createFunction(l),context:o.createExecContext(null,{sr:e}),modules:a}}}function cY(i,e,t){return i.arcadeUtils.createFeature(e.attributes,e.geometry,t)}function o4(i,e){if(i!=null&&!hY(i)){if(!e||!i.arcade)return void Exe.errorOncePerTick("Arcade support required but not provided");const t=e;t._geometry&&(t._geometry=tY(t._geometry)),i.arcade.modules.arcadeUtils.updateExecContext(i.arcade.context,e)}}function Rxe(i){if(i!=null){if(hY(i))return i.cachedResult;const e=i.arcade;let t=i.arcade.modules.arcadeUtils.executeFunction(e.func,e.context);return typeof t!="number"&&(i.cachedResult=0,t=0),t}return 0}function O6e(i,e=!1){let t=i&&i.featureExpressionInfo;const r=t&&t.expression;return e||r==="0"||(t=null),t}const Axe={cachedResult:0};function hY(i){return i.cachedResult!=null}function uY(i){return i==="0"?0:null}let Qc=class dY{constructor(){this._meterUnitOffset=0,this._renderUnitOffset=0,this._unit="meters",this._metersPerElevationInfoUnit=1,this._featureExpressionInfoContext=null,this.centerPointInElevationSR=null,this.mode=null}get featureExpressionInfoContext(){return this._featureExpressionInfoContext}get meterUnitOffset(){return this._meterUnitOffset}get unit(){return this._unit}set unit(e){this._unit=e,this._metersPerElevationInfoUnit=Cse(e)}get requiresSampledElevationInfo(){return this.mode!=="absolute-height"}reset(){this.mode=null,this._meterUnitOffset=0,this._renderUnitOffset=0,this._featureExpressionInfoContext=null,this.unit="meters"}set offsetMeters(e){this._meterUnitOffset=e,this._renderUnitOffset=0}set offsetElevationInfoUnits(e){this._meterUnitOffset=e*this._metersPerElevationInfoUnit,this._renderUnitOffset=0}addOffsetRenderUnits(e){this._renderUnitOffset+=e}geometryZWithOffset(e,t){const r=this.calculateOffsetRenderUnits(t);return this.featureExpressionInfoContext!=null?r:e+r}calculateOffsetRenderUnits(e){let t=this._meterUnitOffset;const r=this.featureExpressionInfoContext;return r!=null&&(t+=Rxe(r)*this._metersPerElevationInfoUnit),t/e.unitInMeters+this._renderUnitOffset}setFromElevationInfo(e){this.mode=e.mode,this.unit=Sse(e.unit)?e.unit:"meters",this.offsetElevationInfoUnits=je(e.offset,0)}updateFeatureExpressionInfoContext(e,t,r){if(S(e))return void(this._featureExpressionInfoContext=null);const n=e&&e.arcade;n&&y(t)&&y(r)?(this._featureExpressionInfoContext=Pxe(e),o4(this._featureExpressionInfoContext,cY(n.modules,t,r))):this._featureExpressionInfoContext=e}static fromElevationInfo(e){const t=new dY;return y(e)&&t.setFromElevationInfo(e),t}},uu=class{constructor(e,t,r,n,s,a,o,l=null){this.graphics3DSymbolLayer=e,this.stageObject=t,this._uniqueGeometries=r,this._uniqueMaterials=n,this._sharedResource=s,this.elevationAligner=a,this.elevationContext=o,this._edgeState=l,this.type="object3d",this._stageLayer=null,this._stage=null,this._visible=!1,this._addedToStage=!1,this.alignedSampledElevation=0,this.needsElevationUpdates=!1,this.useObjectOriginAsAttachmentOrigin=!1,this.graphics3DSymbolLayer=e,this.stageObject=t}get isElevationSource(){return!(!this.stageObject.metadata||!this.stageObject.metadata.isElevationSource)}initialize(e,t){this._stageLayer=t,this._stage=e,e.addMany(this._uniqueMaterials),e.addMany(this._uniqueGeometries),e.add(this.stageObject)}destroy(){const e=this._stage;this._stageLayer&&(e.removeMany(this._uniqueMaterials),e.removeMany(this._uniqueGeometries)),e.remove(this.stageObject),this._addedToStage&&(this._stageLayer.remove(this.stageObject),this._addedToStage=!1);const t=this._stage.renderView.ensureEdgeView();t.hasObject(this.stageObject)&&t.removeObject(this.stageObject),this.stageObject.dispose(),y(this._sharedResource)&&this._sharedResource.release(),this._visible=!1,this._stageLayer=null,this._stage=null}layerOpacityChanged(e,t){if(S(this._edgeState))return;const r=PU(this._edgeState.baseMaterial);let n=!1;for(const s of this._edgeState.edgeMaterials)s.objectTransparency!==r&&(s.objectTransparency=r,n=!0);n&&this._resetEdgeObject(t),this._stage.renderView.ensureEdgeView().updateAllComponentOpacities(this.stageObject,[e])}slicePlaneEnabledChanged(e,t){S(this._edgeState)||(this._stage.renderView.ensureEdgeView().updateAllComponentMaterials(this.stageObject,this._edgeState.edgeMaterials,{hasSlicePlane:e},!t),this._edgeState.properties.hasSlicePlane=e)}setVisibility(e){if(this._stage!=null&&this._visible!==e&&(this._visible=e,this._visible?this._addedToStage?this.stageObject.setVisible(!0):(this._stageLayer.add(this.stageObject),this._addedToStage=!0):this.stageObject.setVisible(!1),y(this._edgeState))){const t=this._stage.renderView.ensureEdgeView();t.hasObject(this.stageObject)?t.updateObjectVisibility(this.stageObject,e):e&&this._addOrUpdateEdgeObject(t,!1)}}get visible(){return this._visible}alignWithElevation(e,t,r,n){this.elevationAligner!=null&&(y(r)&&o4(this.elevationContext.featureExpressionInfoContext,r),this.alignedSampledElevation=this.elevationAligner(this,this.elevationContext,e,t),this._resetEdgeObject(n))}getCenterObjectSpace(e=R()){return q(e,_D(this.stageObject.boundingVolumeObjectSpace.bounds))}getBoundingBoxObjectSpace(e=Ms()){const t=this.stageObject.boundingVolumeObjectSpace;return pse(e,t.min),mse(e,t.max),e}computeAttachmentOrigin(e){if(this.useObjectOriginAsAttachmentOrigin){const t=this.stageObject.transformation;e.render.origin[0]+=t[12],e.render.origin[1]+=t[13],e.render.origin[2]+=t[14],e.render.num++}else for(const t of this.stageObject.geometryRecords)t.computeAttachmentOrigin(xu)&&(Ce(xu,xu,this.stageObject.transformation),oe(e.render.origin,e.render.origin,xu),e.render.num++)}async getProjectedBoundingBox(e,t,r,n,s){const a=this.getBoundingBoxObjectSpace(s),o=Oxe,l=BD(a)?1:o.length;for(let u=0;u<l;u++){const d=o[u];sp[0]=a[d[0]],sp[1]=a[d[1]],sp[2]=a[d[2]],Ce(sp,sp,this.stageObject.transformation),of[3*u+0]=sp[0],of[3*u+1]=sp[1],of[3*u+2]=sp[2]}if(!e(of,0,l))return null;Mi(a);let c=null;this.calculateRelativeScreenBounds&&(c=this.calculateRelativeScreenBounds());for(let u=0;u<3*l;u+=3){for(let d=0;d<3;d++)a[d]=Math.min(a[d],of[u+d]),a[d+3]=Math.max(a[d+3],of[u+d]);c&&r.push({location:of.slice(u,u+3),screenSpaceBoundingRect:c})}if(t&&t.service&&this.elevationContext.mode!=="absolute-height"){Ic(a,xu);const u=this.elevationContext.mode==="relative-to-scene"?"scene":"ground";let d=0;if(t.useViewElevation)d=je(t.service.getElevation(xu[0],xu[1],u),0);else try{const m=s4(a,t.service.spatialReference,t);d=je(await t.service.queryElevation(xu[0],xu[1],n,m,u),0)}catch{}YG(a,0,0,-this.alignedSampledElevation+d)}return a}addObjectState(e,t){e===Lg.Highlight&&t.addObject(this.stageObject,this.stageObject.highlight()),e===Lg.MaskOccludee&&t.addObject(this.stageObject,this.stageObject.maskOccludee())}removeObjectState(e){e.removeObject(this.stageObject)}_resetEdgeObject(e){if(S(this._edgeState))return;const t=this._stage.renderView.ensureEdgeView();this._visible?this._addOrUpdateEdgeObject(t,e):t.removeObject(this.stageObject)}_addOrUpdateEdgeObject(e,t){const r=this._edgeState;if(S(r))return;const n=PU(r.baseMaterial);for(const s of r.edgeMaterials)s.objectTransparency=n;e.addOrUpdateObject3D(this.stageObject,r.edgeMaterials,r.properties,!t).then(()=>{var s;return(s=this._stageLayer)==null?void 0:s.sync()})}};function PU(i){return i.isVisible?i.parameters.transparent?_t.TRANSPARENT:_t.OPAQUE:_t.INVISIBLE}const of=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],sp=R(),xu=R(),Oxe=[[0,1,2],[3,1,2],[0,4,2],[3,4,2],[0,1,5],[3,1,5],[0,4,5],[3,4,5]];var Gr;(function(i){i[i.Recreate_Symbol=0]="Recreate_Symbol",i[i.Recreate_Graphics=1]="Recreate_Graphics",i[i.Fast_Update=2]="Fast_Update"})(Gr||(Gr={}));let l4=class{constructor(e){this.schedule=e,this._abortController=null,this._loadStatus=jo.LOADING,this._loadError=null,this._loader=null,this.logger=null}destroy(){this.abortLoad()}get loadStatus(){return this._loadStatus}load(e,t){return this._loadStatus===jo.LOADED?(e&&e(),je(this._loader,Promise.resolve())):this._loadStatus===jo.FAILED?(t&&t(this._loadError),je(this._loader,Promise.resolve())):(S(this._loader)&&(this._abortController=new AbortController,this._loader=this.doLoad(this._abortController.signal).then(()=>{this._abortController=null,this._loadStatus=jo.LOADED},r=>{throw this._loadError=r,this._abortController=null,this._loadStatus=jo.FAILED,!yo(r)&&this.logger&&r.message&&this.logger.warn(r.message),r})),this._loader.then(e,t).catch(()=>{}),this._loader)}abortLoad(){y(this._abortController)?this._abortController=iu(this._abortController):this._loadStatus===jo.LOADING&&(this._loadStatus=jo.FAILED),this._loader=null}};var jo;(function(i){i[i.LOADING=0]="LOADING",i[i.LOADED=1]="LOADED",i[i.FAILED=2]="FAILED"})(jo||(jo={}));function Mxe(i){switch(i){case"sphere":case"cube":case"diamond":case"cylinder":case"cone":case"inverted-cone":case"tetrahedron":return!0}return!1}function pY(i,e){const t=(r,n,s=!1)=>({levels:r.map(a=>{const o=n(a.tesselation);return s&&Fye(o),{components:[{geometry:o,material:e}],faceCount:o.indexCount/3,minScreenSpaceRadius:a.minScreenSpaceRadius}})});switch(i){case"sphere":return t([{tesselation:0,minScreenSpaceRadius:0},{tesselation:1,minScreenSpaceRadius:8},{tesselation:2,minScreenSpaceRadius:16},{tesselation:3,minScreenSpaceRadius:50},{tesselation:4,minScreenSpaceRadius:250}],r=>IQ(.5,r,!0));case"cube":return t([{tesselation:0,minScreenSpaceRadius:0}],()=>Mye(1));case"cone":return t(QO,r=>g6(1,.5,r,!1),!0);case"inverted-cone":return t(QO,r=>g6(1,.5,r,!0),!0);case"cylinder":return t(QO,r=>Dye(1,.5,r,[0,0,1],[0,0,.5]));case"tetrahedron":return t([{tesselation:0,minScreenSpaceRadius:0}],()=>Lye(1),!0);case"diamond":return t([{tesselation:0,minScreenSpaceRadius:0}],()=>Iye(1),!0);default:return}}const QO=[{tesselation:6,minScreenSpaceRadius:0},{tesselation:18,minScreenSpaceRadius:7},{tesselation:64,minScreenSpaceRadius:65}];function yC(i){const e=[];return i.levels.forEach(t=>{t.components.forEach(r=>{e.push(r.material)})}),Px(e)}function RU(i){const e=new Array;return i.levels.forEach(t=>{t.components.forEach(r=>{r.textures&&e.push(...r.textures)})}),Px(e)}function c4(i){const e=[];return i.components.forEach(t=>{e.push(t.geometry)}),Px(e)}function AU(i){const e=[];return i.levels.forEach(t=>{t.components.forEach(r=>{e.push(r.geometry)})}),Px(e)}function Ixe(i){return c4(i).reduce((e,t)=>e+t.indexCount/3,0)}const h4={primitivesPerFeature:0,primitivesPerCoordinate:0,drawCallsPerFeature:0,estimated:!0,memory:{bytesPerFeature:0,bytesPerCoordinate:0,bytesPerFeatureLabel:0,resourceBytes:0,draped:{bytesPerFeature:0,bytesPerFeatureLabel:0,bytesPerCoordinate:0}}};function L6e(i){return i.type==="web-style"?h4:u4(i.symbolLayers.toArray().map(e=>mY(i,e)))}function u4(i){let e=0,t=0,r=0,n=!1,s=0;const a={bytesPerFeature:0,bytesPerFeatureLabel:0,bytesPerCoordinate:0,resourceBytes:0,draped:{bytesPerFeature:0,bytesPerFeatureLabel:0,bytesPerCoordinate:0}};for(const o of i)S(o)||(e+=o.primitivesPerFeature,t+=o.primitivesPerCoordinate,r+=o.drawCallsPerFeature,a.bytesPerFeature+=o.memory.bytesPerFeature,a.bytesPerFeatureLabel+=o.memory.bytesPerFeatureLabel,a.bytesPerCoordinate+=o.memory.bytesPerCoordinate,a.resourceBytes+=o.memory.resourceBytes,a.draped.bytesPerFeature+=o.memory.bytesPerFeature,a.draped.bytesPerFeatureLabel+=o.memory.bytesPerFeatureLabel,a.draped.bytesPerCoordinate+=o.memory.bytesPerCoordinate,n=n||o.estimated,++s);return{primitivesPerFeature:e,primitivesPerCoordinate:t,drawCallsPerFeature:r,estimated:n,memory:a,numComplexities:s}}function $6e(i){const e=u4(i);return e.numComplexities>0&&(e.primitivesPerFeature/=e.numComplexities,e.primitivesPerCoordinate/=e.numComplexities,e.drawCallsPerFeature/=e.numComplexities,e.memory.bytesPerFeature/=e.numComplexities,e.memory.bytesPerFeatureLabel/=e.numComplexities,e.memory.bytesPerCoordinate/=e.numComplexities,e.memory.resourceBytes/=e.numComplexities,e.memory.draped.bytesPerFeature/=e.numComplexities,e.memory.draped.bytesPerFeatureLabel/=e.numComplexities,e.memory.draped.bytesPerCoordinate/=e.numComplexities),e}const OU={};function mY(i,e){const t=fY(i,e),r=Ese(e)?2:0;switch(e.type){case"extrude":return{primitivesPerFeature:-4,primitivesPerCoordinate:4,drawCallsPerFeature:r,estimated:!1,memory:t};case"fill":return i.type==="mesh-3d"?{primitivesPerFeature:0,primitivesPerCoordinate:0,drawCallsPerFeature:r,estimated:!1,memory:t}:y(e.outline)&&e.outline.size>0?{primitivesPerFeature:-4,primitivesPerCoordinate:3,drawCallsPerFeature:0,estimated:!1,memory:t}:{primitivesPerFeature:-2,primitivesPerCoordinate:1,drawCallsPerFeature:0,estimated:!1,memory:t};case"water":return{primitivesPerFeature:-2,primitivesPerCoordinate:1,drawCallsPerFeature:0,estimated:!1,memory:t};case"line":return{primitivesPerFeature:-2,primitivesPerCoordinate:2,drawCallsPerFeature:0,estimated:!1,memory:t};case"object":return e.resource&&e.resource.href?{primitivesPerFeature:16,primitivesPerCoordinate:0,drawCallsPerFeature:0,estimated:!0,memory:t}:{...Lxe(e.resource&&e.resource.primitive||L7),memory:t};case"path":{let o=0,l=0;switch(e.profile){case"circle":o=10;break;case"quad":o=4;break;default:return void Pa(e.profile)}switch(e.join){case"round":l=3;break;case"miter":case"bevel":l=1;break;default:return void Pa(e.join)}const c=2*o,u=o*l*2;let d=-2*u-c;switch(e.cap){case"none":break;case"butt":case"square":d+=2*(o-1);break;case"round":d+=2*(o*(3-1)*2+o);break;default:return}return{primitivesPerFeature:d,primitivesPerCoordinate:u+c,drawCallsPerFeature:0,estimated:!1,memory:t}}case"text":case"icon":return{primitivesPerFeature:2,primitivesPerCoordinate:0,drawCallsPerFeature:0,estimated:!1,memory:t};default:return}}function fY(i,e){const t=i.type==="point-3d";switch(e.type){case"extrude":return e.edges&&e.edges.size>0?ra.EXTRUDE_EDGES:ra.EXTRUDE;case"fill":return y(e.outline)&&e.outline.size>0?ra.FILL_OUTLINE:ra.FILL;case"water":return ra.FILL;case"line":return e.join==="round"?ra.LINE_ROUND:ra.LINE_MITER;case"path":switch(e.join){case"round":switch(e.profile){case"circle":return ra.PATH_ROUND_CIRCLE;case"quad":return ra.PATH_ROUND_QUAD;default:return void Pa(e.profile)}case"miter":case"bevel":switch(e.profile){case"circle":return ra.PATH_MITER_CIRCLE;case"quad":return ra.PATH_MITER_QUAD;default:return void Pa(e.profile)}default:return void Pa(e.join)}case"object":return t?ra.OBJECT_POINT:ra.OBJECT_POLYGON;case"icon":case"text":return t?ra.ICON_POINT:ra.ICON_POLYGON;default:return}}function Lxe(i){let e=OU[i];if(e)return e;const t=pY(i,null);return e={primitivesPerFeature:c4(t.levels[0]).reduce((r,n)=>r+n.indices.get(P.POSITION).length/3,0),primitivesPerCoordinate:0,drawCallsPerFeature:0,estimated:!1},OU[i]=e,e}const ra={ICON_POINT:{bytesPerFeature:7127.413186968842,bytesPerFeatureLabel:4826.302896296296,bytesPerCoordinate:0,resourceBytes:0,draped:{bytesPerFeature:3929.4396628895197,bytesPerFeatureLabel:3550.1332222222227,bytesPerCoordinate:0}},ICON_POLYGON:{bytesPerFeature:9329.452613976147,bytesPerFeatureLabel:3675.3372604938268,bytesPerCoordinate:60.177252982212096,resourceBytes:0,draped:{bytesPerFeature:6190.247450139383,bytesPerFeatureLabel:3744.074358024691,bytesPerCoordinate:59.488211068026104}},OBJECT_POINT:{bytesPerFeature:2350.5884192634558,bytesPerFeatureLabel:4446.651003703703,bytesPerCoordinate:0,resourceBytes:0,draped:{bytesPerFeature:2350.5884192634558,bytesPerFeatureLabel:4446.651003703703,bytesPerCoordinate:0}},OBJECT_POLYGON:{bytesPerFeature:4583.807620302299,bytesPerFeatureLabel:3665.342685185186,bytesPerCoordinate:60.11621818101506,resourceBytes:0,draped:{bytesPerFeature:4583.807620302299,bytesPerFeatureLabel:3665.342685185186,bytesPerCoordinate:60.11621818101506}},LINE_MITER:{bytesPerFeature:7321.028181375921,bytesPerFeatureLabel:4048.0226716049388,bytesPerCoordinate:186.55621386363578,resourceBytes:0,draped:{bytesPerFeature:4246.856619435009,bytesPerFeatureLabel:3852.3737679012347,bytesPerCoordinate:163.47884002621583}},LINE_ROUND:{bytesPerFeature:7482.205842738954,bytesPerFeatureLabel:4045.886987654321,bytesPerCoordinate:191.5452524171851,resourceBytes:0,draped:{bytesPerFeature:4473.481387957992,bytesPerFeatureLabel:3842.1112395061728,bytesPerCoordinate:167.27703460226945}},PATH_MITER_CIRCLE:{bytesPerFeature:9010.489006415351,bytesPerFeatureLabel:4230.9109,bytesPerCoordinate:4618.2594178027275,resourceBytes:0,draped:{bytesPerFeature:9010.489006415351,bytesPerFeatureLabel:4230.9109,bytesPerCoordinate:4618.2594178027275}},PATH_ROUND_CIRCLE:{bytesPerFeature:4104.727250200398,bytesPerFeatureLabel:4251.8525,bytesPerCoordinate:8019.043777064957,resourceBytes:0,draped:{bytesPerFeature:4104.727250200398,bytesPerFeatureLabel:4251.8525,bytesPerCoordinate:8019.043777064957}},PATH_MITER_QUAD:{bytesPerFeature:9416.372942261387,bytesPerFeatureLabel:4241.2757,bytesPerCoordinate:3176.7222742582203,resourceBytes:0,draped:{bytesPerFeature:9416.372942261387,bytesPerFeatureLabel:4241.2757,bytesPerCoordinate:3176.7222742582203}},PATH_ROUND_QUAD:{bytesPerFeature:6614.431545308682,bytesPerFeatureLabel:4206.7461,bytesPerCoordinate:5141.817789093826,resourceBytes:0,draped:{bytesPerFeature:6614.431545308682,bytesPerFeatureLabel:4206.7461,bytesPerCoordinate:5141.817789093826}},FILL:{bytesPerFeature:9478.244183633637,bytesPerFeatureLabel:3713.816824691358,bytesPerCoordinate:95.9343604185578,resourceBytes:0,draped:{bytesPerFeature:6287.911108168086,bytesPerFeatureLabel:3790.785032098766,bytesPerCoordinate:83.08783220478168}},FILL_OUTLINE:{bytesPerFeature:13085.871870349445,bytesPerFeatureLabel:3392.613241975309,bytesPerCoordinate:118.63968023169875,resourceBytes:0,draped:{bytesPerFeature:8437.199992480122,bytesPerFeatureLabel:3973.5431172839503,bytesPerCoordinate:106.33556817014312}},EXTRUDE:{bytesPerFeature:19459.53727140414,bytesPerFeatureLabel:3743.7045209876546,bytesPerCoordinate:372.6819978900477,resourceBytes:0,draped:{bytesPerFeature:19459.53727140414,bytesPerFeatureLabel:3743.7045209876546,bytesPerCoordinate:372.6819978900477}},EXTRUDE_EDGES:{bytesPerFeature:22266.888534913724,bytesPerFeatureLabel:3064.3193358024696,bytesPerCoordinate:374.3725221561312,resourceBytes:0,draped:{bytesPerFeature:22266.888534913724,bytesPerFeatureLabel:3064.3193358024696,bytesPerCoordinate:374.3725221561312}}},N_=J.getLogger("esri.views.3d.layers.graphics.Graphics3DSymbolLayer");let du=class extends l4{constructor(e,t,r,n){super(r.schedule),this._context=r,this._elevationInfoOverride=null,this._ignoreDrivers=!1,this._drivenProperties={color:!1,opacity:!1,opacityAlwaysOpaque:!0,size:!1},this.complexity=null,this.logger=N_,this._elevationOptions={supportsOffsetAdjustment:!1,supportsOnTheGround:!0},this.symbol=e,this.symbolLayer=t,this._renderPriority=n.renderPriority,this._renderPriorityStep=n.renderPriorityStep,this._elevationContext=new Qc,this.complexity=this.computeComplexity(),this._ignoreDrivers=n.ignoreDrivers,this._ignoreDrivers||(this._drivenProperties=MU(this._context.renderer)),this._updateElevationContext()}getCachedSize(){return null}get extentPadding(){return 0}_drivenPropertiesChanged(e){if(this._ignoreDrivers)return!1;const t=this._drivenProperties,r=MU(e);return r.color!==t.color||r.opacity!==t.opacity||r.opacityAlwaysOpaque!==t.opacityAlwaysOpaque||r.size!==t.size}get needsDrivenTransparentPass(){return this._drivenProperties.opacity&&!this._drivenProperties.opacityAlwaysOpaque}_logGeometryCreationWarnings(e,t,r,n){const s=e.projectionSuccess,a="polygons"in e?e.polygons:null,o=`${n} geometry failed to be created`;let l=null;s?!this._logGeometryValidationWarnings(t,r,n)&&a&&a.length===0&&r==="rings"&&t.length>0&&t[0].length>2&&(l=`${o} (filled rings should use clockwise winding - try reversing the order of vertices)`):l=`${o} (failed to project geometry to view spatial reference)`,l&&N_.warnOncePerTick(l)}_logGeometryValidationWarnings(e,t,r){const n=`${r} geometry failed to be created`;return!e.length||e.length===1&&!e[0].length?(N_.warnOncePerTick(`${n} (no ${t} were defined)`),!0):(!Array.isArray(e)||!Array.isArray(e[0]))&&(N_.warnOncePerTick(`${n} (${t} should be defined as a 2D array)`),!0)}_validateGeometry(e,t=null,r=null){if(y(t)&&!t.includes(e.type))return this.logger.warn("unsupported geometry type for "+r+` symbol: ${e.type}`),!1;if(e.type==="point"){const n=e;if(!isFinite(n.x)||!isFinite(n.y))return N_.warn("point coordinate is not a valid number, graphic skipped"),!1}return!0}_defaultElevationInfoNoZ(){return $xe}_defaultElevationInfoZ(){return Dxe}_updateElevationContext(){y(this._elevationInfoOverride)?(this._elevationContext.setFromElevationInfo(this._elevationInfoOverride),this._elevationContext.updateFeatureExpressionInfoContext(null)):this._context.layer.elevationInfo?(this._elevationContext.setFromElevationInfo(this._context.layer.elevationInfo),this._elevationContext.updateFeatureExpressionInfoContext(this._context.featureExpressionInfoContext)):this._elevationContext.reset()}getDefaultElevationInfo(e){return e.hasZ?this._defaultElevationInfoZ():this._defaultElevationInfoNoZ()}getGeometryElevationMode(e,t=this.getDefaultElevationInfo(e)){return this._elevationContext.mode||t.mode}setElevationInfoOverride(e){this._elevationInfoOverride=e,this._updateElevationContext()}setGraphicElevationContext(e,t){const r=ct(e.geometry),n=this.getDefaultElevationInfo(r);t.unit=this._elevationContext.unit!=null?this._elevationContext.unit:n.unit,t.mode=this.getGeometryElevationMode(r,n),t.offsetMeters=je(this._elevationContext.meterUnitOffset,je(n.offset,0));const s=!this._elevationOptions.supportsOnTheGround&&t.mode==="on-the-ground";s&&(t.mode="relative-to-ground",t.offsetMeters=0);const a=s?Axe:this._elevationContext.featureExpressionInfoContext;return t.updateFeatureExpressionInfoContext(a,e,this._context.layer),t}prepareSymbolLayerPatch(e){}updateGeometry(e,t){return!1}onRemoveGraphic(e){}_getLayerOpacity(){return this._context.graphicsCoreOwner&&"fullOpacity"in this._context.graphicsCoreOwner?this._context.graphicsCoreOwner.fullOpacity:this._context.layer.opacity??1}_getCombinedOpacity(e,t=IU){let r=1;return this.draped||(r*=this._getLayerOpacity()),this._drivenProperties.opacity||(y(e)?r*=e.a:t.hasIntrinsicColor||(r=0)),r}_getCombinedOpacityAndColor(e,t=IU){const r=this._getCombinedOpacity(e,t);if(this._drivenProperties.color)return Jb(null,r);const n=y(e)?ei.toUnitRGB(e):em;return Jb(n,r)}_getVertexOpacityAndColor(e,t=null){const r=this._drivenProperties.color?e.color:null,n=this._drivenProperties.opacity?e.opacity:null,s=Jb(r,n);return y(t)&&(s[0]*=t,s[1]*=t,s[2]*=t,s[3]*=t),s}isFastUpdatesEnabled(){return this._fastUpdates&&this._fastUpdates.enabled}computeComplexity(){return mY(this.symbol,this.symbolLayer)}globalPropertyChanged(e,t,r){switch(e){case"opacity":return this.layerOpacityChanged(t,r),!0;case"elevationInfo":{const n=this._elevationContext.mode;return this._updateElevationContext(),this.layerElevationInfoChanged(t,r,n)!==Zi.RECREATE}case"slicePlaneEnabled":return this.slicePlaneEnabledChanged(t,r);case"physicalBasedRenderingEnabled":return this.physicalBasedRenderingChanged();case"pixelRatio":return this.pixelRatioChanged();default:return!1}}updateGraphics3DGraphicElevationInfo(e,t,r){let n=Zi.UPDATE;return e.forEach(s=>{const a=t(s);if(y(a)){const o=s.graphic;this.setGraphicElevationContext(o,a.elevationContext),a.needsElevationUpdates=r(a.elevationContext.mode)}else n=Zi.RECREATE}),n}applyRendererDiff(e,t){return Gr.Recreate_Symbol}getFastUpdateAttrValues(e){if(!this._fastUpdates.enabled)return null;const t=this._fastUpdates.visualVariables,r=t.size?_d(t.size.field,e):0,n=t.color?_d(t.color.field,e):0,s=t.opacity?_d(t.opacity.field,e):0;return Bi(r,n,s,0)}get draped(){return this._draped}ensureDrapedStatus(e){return this._draped==null?(this._draped=e,!0):(e!==this.draped&&N_.warnOnce("A symbol can only produce either draped or non-draped visualizations. Use two separate symbol instances for draped and non-draped graphics if necessary."),!1)}test(){const e=()=>{var t,r,n,s,a,o,l,c,u,d,m,f;return{size:((n=(r=(t=this._fastUpdates)==null?void 0:t.visualVariables)==null?void 0:r.size)==null?void 0:n.field)??null,color:((o=(a=(s=this._fastUpdates)==null?void 0:s.visualVariables)==null?void 0:a.color)==null?void 0:o.field)??null,opacity:((u=(c=(l=this._fastUpdates)==null?void 0:l.visualVariables)==null?void 0:c.opacity)==null?void 0:u.field)??null,rotation:((f=(m=(d=this._fastUpdates)==null?void 0:d.visualVariables)==null?void 0:m.rotation)==null?void 0:f.field)??null}};return{drivenProperties:this._drivenProperties,getVisVarFields:e}}};function _d(i,e){const t=i!=null?e.attributes[i]:0;return t!=null&&isFinite(t)?t:0}function MU(i){const e={color:!1,opacity:!1,opacityAlwaysOpaque:!0,size:!1};return i&&"visualVariables"in i&&i.visualVariables&&i.visualVariables.forEach(t=>{switch(t.type){case"color":if(e.color=!0,t.stops)for(let r=0;r<t.stops.length;r++){const n=t.stops[r].color;n&&(e.opacity=!0,n.a<1&&(e.opacityAlwaysOpaque=!1))}break;case"opacity":e.opacity=!0,e.opacityAlwaysOpaque=!1;break;case"size":e.size=!0}}),e}const $xe={mode:"on-the-ground",offset:0,unit:"meters"},Dxe={mode:"absolute-height",offset:0,unit:"meters"},IU={hasIntrinsicColor:!1};let jg=class{constructor(){this._disposed=!1}get disposed(){return this._disposed}get shaderTransformation(){return this._shaderTransformation}acquire(e,t,r,n,s,a){this.id=Cm(),this.geometry=e,this.material=t,this.transformation=r,this.instanceParameters=n,this.origin=s,this._shaderTransformation=a,this._disposed=!1}release(){this._disposed=!1}dispose(){this._disposed=!0}getStaticTransformation(){return this.transformation}getShaderTransformation(){return y(this._shaderTransformation)?this._shaderTransformation(this.transformation):this.transformation}computeAttachmentOrigin(e){return!!(this.material.computeAttachmentOrigin?this.material.computeAttachmentOrigin(this.geometry,e):this.geometry.computeAttachmentOrigin(e))&&(Ce(e,e,this.getStaticTransformation()),!0)}};jg.pool=new Fl(jg);let tP=class{constructor(e){this.channel=e,this.id=Cm()}},Bd=class extends EG{constructor(e={}){super(),this.type=gv.Object,this._geometryRecords=new Array,this._geometries=new Array,this._objectTransformation=ve(),this._bvObjectSpace=new LU,this._bvWorldSpace=new LU,this._bvDirty=!0,this._hasVolatileTransformation=!1,this._visible=!0,this.castShadow=e.castShadow==null||e.castShadow,this.metadata=e.metadata,this.metadata&&this.metadata.isElevationSource&&(this.metadata.lastValidElevationBB=new gY);const{geometries:t,materials:r,transformations:n,origins:s}=e;if(Array.isArray(t)){it(r.length===t.length,"Object3D: materials don't match geometries"),it(n.length===t.length,"Object3D: transformations don't match geometries"),this._geometryRecords.length=t.length,this._geometries.length=t.length;for(let a=0;a<t.length;a++)this._geometries[a]=t[a],this._geometryRecords[a]=jg.pool.acquire(t[a],r[a],_S(n[a]),{highlights:null,occludees:null,visible:this._visible},s&&s[a])}}get geometryRecords(){return this._geometryRecords}get geometries(){return this._geometries}get transformation(){return this._objectTransformation}set transformation(e){pn(this._objectTransformation,e),this._invalidateBoundingVolume(),this._emit("objectTransformation",this)}dispose(){this._geometryRecords.length=0,this._geometries.length=0}get parentLayer(){return this._parentLayer}set parentLayer(e){it(this._parentLayer==null||e==null,"Object3D can only be added to a single Layer"),this._parentLayer=e}addGeometry(e,t,r,n,s){r=r||rn,this._geometries.push(e);const a=jg.pool.acquire(e,t,r,{highlights:null,occludees:null,visible:this._visible},n,s);return this._geometryRecords.push(a),this._hasVolatileTransformation=this._hasVolatileTransformation||y(a.shaderTransformation),this._emit("objectGeometryAdded",{object:this,record:a}),this._invalidateBoundingVolume(),a}removeGeometry(e){const t=this._geometryRecords.splice(e,1)[0];return this._hasVolatileTransformation=y(t.shaderTransformation)?this._geometryRecords.some(r=>y(r.shaderTransformation)):this._hasVolatileTransformation,t.dispose(),this._geometries.splice(e,1),this._emit("objectGeometryRemoved",{object:this,record:t}),this._invalidateBoundingVolume(),t}removeAllGeometries(){for(;this.geometryRecords.length>0;)this.removeGeometry(0)}geometryVertexAttrsUpdated(e){this._emit("vertexAttrsUpdated",{object:this,record:e}),this._invalidateBoundingVolume()}get isVisible(){return this._visible}setVisible(e){if(this._visible!==e){this._visible=e;for(const t of this._geometryRecords)t.instanceParameters.visible=this._visible;this._emit("visibilityChanged",this)}}maskOccludee(){const e=new tP(Lg.MaskOccludee);for(const t of this._geometryRecords)t.instanceParameters.occludees=EI(t.instanceParameters.occludees,e);return this._emit("occlusionChanged",this),e}removeOcclude(e){for(const t of this._geometryRecords)t.instanceParameters.occludees=PI(t.instanceParameters.occludees,e);this._emit("occlusionChanged",this)}highlight(){const e=new tP(Lg.Highlight);for(const t of this._geometryRecords)t.instanceParameters.highlights=EI(t.instanceParameters.highlights,e);return this._emit("highlightChanged",this),e}removeHighlight(e){for(const t of this._geometryRecords)t.instanceParameters.highlights=PI(t.instanceParameters.highlights,e);this._emit("highlightChanged",this)}getCombinedStaticTransformation(e,t){return Hr(t,this.transformation,e.getStaticTransformation())}_getCombinedShaderTransformation(e){return Hr(ve(),this.transformation,e.getShaderTransformation())}hasVolativeTransformation(){return this._hasVolatileTransformation}get boundingVolumeWorldSpace(){return this._validateBoundingVolume(),this._bvWorldSpace}get boundingVolumeObjectSpace(){return this._validateBoundingVolume(),this._bvObjectSpace}_validateBoundingVolume(){if(!this._bvDirty&&!this._hasVolatileTransformation)return;this._bvObjectSpace.init(),this._bvWorldSpace.init();for(let n=0;n<this._geometryRecords.length;++n){const s=this._geometries[n],a=this._geometryRecords[n],o=s.boundingInfo;y(o)&&(this._calculateTransformedBoundingVolume(o,this._bvObjectSpace,a.getShaderTransformation()),this._calculateTransformedBoundingVolume(o,this._bvWorldSpace,this._getCombinedShaderTransformation(a)))}Bn(this._bvObjectSpace.bounds,this._bvObjectSpace.min,this._bvObjectSpace.max,.5),Bn(this._bvWorldSpace.bounds,this._bvWorldSpace.min,this._bvWorldSpace.max,.5);const e=R(),t=R(),r=zg(this.transformation);for(let n=0;n<this._geometryRecords.length;++n){const s=this._geometries[n].boundingInfo;if(S(s))continue;const a=this._geometryRecords[n].getShaderTransformation(),o=zg(a);Ce(e,s.getCenter(),a);const l=Ii(e,this._bvObjectSpace.bounds),c=s.getBSRadius()*o;this._bvObjectSpace.bounds[3]=Math.max(this._bvObjectSpace.bounds[3],l+c),Ce(t,e,this.transformation);const u=Ii(t,this._bvWorldSpace.bounds),d=c*r;this._bvWorldSpace.bounds[3]=Math.max(this._bvWorldSpace.bounds[3],u+d)}this._bvDirty=!1}_calculateTransformedBoundingVolume(e,t,r){const n=e.getBBMin(),s=e.getBBMax(),a=as(n),o=as(s);Ce(a,a,r),Ce(o,o,r);for(let l=0;l<3;++l)t.min[l]=Math.min(t.min[l],a[l],o[l]),t.max[l]=Math.max(t.max[l],a[l],o[l]);for(let l=0;l<3;++l){q(a,n),q(o,s),a[l]=s[l],o[l]=n[l],Ce(a,a,r),Ce(o,o,r);for(let c=0;c<3;++c)t.min[c]=Math.min(t.min[c],a[c],o[c]),t.max[c]=Math.max(t.max[c],a[c],o[c])}}_invalidateBoundingVolume(){this._bvDirty=!0,y(this._parentLayer)&&this._parentLayer.notifyObjectBBChanged(this,this._bvWorldSpace.bounds)}_emit(e,t){y(this._parentLayer)&&this._parentLayer.events.emit(e,t)}get test(){const e=this;return{hasGeometry:t=>e._geometries.includes(t),getGeometryIndex:t=>e._geometries.indexOf(t)}}},gY=class{constructor(){this.min=Ge(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this.max=Ge(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE)}isEmpty(){return this.max[0]<this.min[0]&&this.max[1]<this.min[1]&&this.max[2]<this.min[2]}},LU=class extends gY{constructor(){super(...arguments),this.bounds=ou()}init(){Z(this.min,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),Z(this.max,-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),hre(this.bounds)}};const lm=R();function d4(i,e,t,r,n,s,a,o){const l=t?t.length:0,c=i.clippingExtent;if(bn(e,lm,i.elevationProvider.spatialReference),y(c)&&!jD(c,lm))return null;bn(e,lm,i.renderCoordsHelper.spatialReference);const u=i.localOriginFactory.getOrigin(lm),d=new Bd({castShadow:!1,metadata:{layerUid:s,graphicUid:a,usesVerticalDistanceToGround:!0}});for(let m=0;m<l;m++){const f=rn;d.addGeometry(t[m],r[m],f,u,o)}return{object:d,sampledElevation:mxe(d,e,i.elevationProvider,i.renderCoordsHelper,n)}}function ux(i,e,t){const r=i.elevationContext,n=t.spatialReference;bn(e,lm,n),r.centerPointInElevationSR=kd(lm[0],lm[1],e.hasZ?lm[2]:0,y(n)?n:null)}function dx(i){switch(i.type){case"point":return i;case"polygon":case"extent":return n4(i);case"polyline":{const e=i.paths[0];if(!e||e.length===0)return null;const t=F7(e,N7(e)/2);return kd(t[0],t[1],t[2],i.spatialReference)}case"mesh":return i.origin}return null}let _Y=class yY extends ti{initializeConfiguration(e,t){t.spherical=e.viewingMode===Se.Global}initializeProgram(e){return new Jt(e.rctx,yY.shader.get().build(this.configuration),ai)}setPipelineState(e){const t=e?hs.ALWAYS:hs.LESS;return this.configuration.depthHudEnabled?Ke({depthTest:{func:t},depthWrite:nl}):Ke({blending:Gn(de.ONE,de.SRC_ALPHA,de.ONE_MINUS_SRC_ALPHA,de.ONE_MINUS_SRC_ALPHA),depthTest:{func:t},colorWrite:ht})}initializePipeline(){return this.setPipelineState(this.configuration.hasMultipassGeometry)}};_Y.shader=new ii(Mse,()=>G(()=>import("./LineCallout.glsl-00f1e0f3.js"),["assets/LineCallout.glsl-00f1e0f3.js","assets/vec2-528adfe4.js","assets/common-c186b691.js","assets/vec2f64-30dc1443.js","assets/vec4f64-e407da96.js","assets/mat4-44a0988f.js","assets/vec3f64-2f9cef06.js","assets/mat4f64-1e28eae0.js","assets/vec3-e93e648f.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/HUD.glsl-d3a072ad.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/vec4-790471c0.js","assets/Float4PassUniform-d7bdbc81.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/FloatPassUniform-68d54f51.js","assets/VertexAttribute-9c5c630d.js","assets/LineCallout.glsl-358ef89b.js","assets/Slice.glsl-3b39b1f7.js"]));let gl=class extends cu{constructor(){super(...arguments),this.screenCenterOffsetUnitsEnabled=Im.World,this.spherical=!1,this.occlusionTestEnabled=!0,this.hasVerticalOffset=!1,this.hasScreenSizePerspective=!1,this.depthHudEnabled=!1,this.depthHudAlignStartEnabled=!1,this.hasSlicePlane=!1,this.hasMultipassGeometry=!1}};h([N({count:Im.COUNT})],gl.prototype,"screenCenterOffsetUnitsEnabled",void 0),h([N()],gl.prototype,"spherical",void 0),h([N()],gl.prototype,"occlusionTestEnabled",void 0),h([N()],gl.prototype,"hasVerticalOffset",void 0),h([N()],gl.prototype,"hasScreenSizePerspective",void 0),h([N()],gl.prototype,"depthHudEnabled",void 0),h([N()],gl.prototype,"depthHudAlignStartEnabled",void 0),h([N()],gl.prototype,"hasSlicePlane",void 0),h([N()],gl.prototype,"hasMultipassGeometry",void 0),h([N({constValue:!0})],gl.prototype,"hasSliceInVertexProgram",void 0),h([N({constValue:!1})],gl.prototype,"isDraped",void 0);let vC=class ZL extends Fd{constructor(e){super(e,new Nxe),this._configuration=new gl,this._uniqueMaterialIdentifier=ZL.uniqueMaterialIdentifier(this.parameters)}get uniqueMaterialIdentifier(){return this._uniqueMaterialIdentifier}getPassParameters(){return this.parameters}getConfiguration(e,t){const r=(t==null?void 0:t.slot)!==ae.LINE_CALLOUTS;return this._configuration.occlusionTestEnabled=this.parameters.occlusionTest,this._configuration.hasVerticalOffset=y(this.parameters.verticalOffset),this._configuration.hasScreenSizePerspective=y(this.parameters.screenSizePerspective),this._configuration.depthHudEnabled=r,this._configuration.depthHudAlignStartEnabled=!!this.parameters.depthHUDAlignStart,this._configuration.screenCenterOffsetUnitsEnabled=this.parameters.centerOffsetUnits==="screen"?Im.Screen:Im.World,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.hasMultipassGeometry=t.multipassGeometry.enabled,this._configuration}intersect(){}requiresSlot(e,t){if(t===k.Color)switch(e){case ae.LINE_CALLOUTS:case ae.LINE_CALLOUTS_HUD_DEPTH:return!0}return!1}createGLMaterial(e){return new Fxe(e)}createBufferWriter(){return new Vxe}validateParameters(e){const t=ZL.uniqueMaterialIdentifier(e);t!==this._uniqueMaterialIdentifier&&(this._uniqueMaterialIdentifier=t)}static uniqueMaterialIdentifier(e){return JSON.stringify({screenOffset:e.screenOffset||[0,0],centerOffsetUnits:e.centerOffsetUnits||"world"})}},Fxe=class extends t_{beginSlot(e){return this.ensureTechnique(_Y,e)}},Nxe=class extends Vx{constructor(){super(...arguments),this.screenOffset=Pg,this.color=[0,0,0,1],this.size=1,this.occlusionTest=!1,this.shaderPolygonOffset=1e-5,this.depthHUDAlignStart=!1,this.centerOffsetUnits="world",this.hasSlicePlane=!1}};const kxe=sn().vec3f(P.POSITION).vec3f(P.NORMAL).vec2f(P.UV0).vec4f(P.AUXPOS1),$U=[Vp(0,0),Vp(1,0),Vp(0,1),Vp(1,0),Vp(1,1),Vp(0,1)];let Vxe=class{constructor(){this.vertexBufferLayout=kxe}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){return 6*e.indices.get(P.POSITION).length}write(e,t,r,n,s){LD(r.indices.get(P.POSITION),r.vertexAttributes.get(P.POSITION).data,e,n.position,s,6),VG(r.indices.get(P.NORMAL),r.vertexAttributes.get(P.NORMAL).data,t,n.normal,s,6),Sw(r.indices.get(P.AUXPOS1),r.vertexAttributes.get(P.AUXPOS1).data,n.auxpos1,s,6);for(let a=0;a<$U.length;++a)n.uv0.setVec(s+a,$U[a])}},vY=class bY extends du{constructor(e,t){super(e,null,t,Bxe),this._elevationOptions={supportsOffsetAdjustment:!0,supportsOnTheGround:!1},this.ensureDrapedStatus(!1)}async doLoad(){this._material=new vC(this._materialParameters),this._context.stage.add(this._material)}destroy(){super.destroy(),this._context.stage.remove(this._material),this._material=null}_perInstanceMaterialParameters(e){const t=this._materialParameters;return t.screenOffset=e.screenOffset||Pg,t.centerOffsetUnits=e.centerOffsetUnits||"world",t}get _materialParameters(){const e=this.symbol,t=e.callout,r=y(t.color)?ei.toUnitRGBA(t.color):[0,0,0,0];r[3]*=this._getLayerOpacity();const n=Sa(t.size||0);let s=null;if(e.verticalOffset){const{screenLength:d,minWorldLength:m,maxWorldLength:f}=e.verticalOffset;s={screenLength:Sa(d),minWorldLength:m||0,maxWorldLength:y(f)?f:1/0}}const a=y(t.border)&&y(t.border.color)?ei.toUnitRGBA(t.border.color):null,o=e.symbolLayers.getItemAt(0).type==="object",l=!o,c=o?0:void 0,u=e.type==="label-3d";return{color:r,size:n,verticalOffset:s,screenSizePerspective:this._context.screenSizePerspectiveEnabled?this._context.sharedResources.screenSizePerspectiveSettings:null,screenOffset:[0,0],centerOffsetUnits:"world",borderColor:a,occlusionTest:l,shaderPolygonOffset:c,depthHUDAlignStart:u,hasSlicePlane:this._context.slicePlaneEnabled,renderOccluded:cr.Occlude,__tagStrict:"NoParameters"}}_defaultElevationInfoNoZ(){return zxe}createGraphics3DGraphic(e){const t=e.renderingInfo,r=e.graphic,n=this.setGraphicElevationContext(r,new Qc,t.elevationOffset||0),s=t.symbol,a=this._elevationContext.mode==="on-the-ground"&&(s.type==="cim"||!s.symbolLayers.some(l=>l.type==="object"||l.type==="text"));if(s.type!=="label-3d"&&a||s.type==="point-3d"&&s.symbolLayers.every(l=>l.type==="text"&&!$7(l)))return null;const o=n4(r.geometry);return S(o)?null:this._createAs3DShape(o,n,t,r.uid)}layerOpacityChanged(){y(this._material)&&this._material.setParameters(this._materialParameters)}layerElevationInfoChanged(e,t,r){const n=this._elevationContext.mode,s=Kx(bY.elevationModeChangeTypes,r,n);return s!==Zi.UPDATE||e.forEach(a=>{const o=t(a);y(o)&&this.updateGraphicElevationContext(a.graphic,o)}),s}slicePlaneEnabledChanged(){return S(this._material)||this._material.setParameters({hasSlicePlane:this._context.slicePlaneEnabled}),!0}physicalBasedRenderingChanged(){return!0}pixelRatioChanged(){return!0}setGraphicElevationContext(e,t,r=0){const n=super.setGraphicElevationContext(e,t);return n.addOffsetRenderUnits(r),n}updateGraphicElevationContext(e,t){this.setGraphicElevationContext(e,t.elevationContext,t.metadata.elevationOffset),t.needsElevationUpdates=Ql(t.elevationContext.mode)}computeComplexity(){return{primitivesPerFeature:2,primitivesPerCoordinate:0,drawCallsPerFeature:0,estimated:!1,memory:h4.memory}}_createVertexData(e){const{translation:t,centerOffset:r}=e,n=t?{size:3,data:[t[0],t[1],t[2]],exclusive:!0}:{size:3,data:[0,0,0],exclusive:!0},s=r?{size:4,data:[r[0],r[1],r[2],r[3]],exclusive:!0}:{size:4,data:[0,0,0,1],exclusive:!0};return[[P.POSITION,n],[P.NORMAL,{size:3,data:[0,0,1],exclusive:!0}],[P.AUXPOS1,s]]}_getOrCreateMaterial(e){const t=this._perInstanceMaterialParameters(e),r=vC.uniqueMaterialIdentifier(t);if(y(this._material)&&r===this._material.uniqueMaterialIdentifier)return{material:this._material,isUnique:!1};if(e.materialCollection){let n=e.materialCollection.get(r);return S(n)&&(n=new vC(t),e.materialCollection.add(r,n)),{material:n,isUnique:!1}}return{material:new vC(t),isUnique:!0}}_createAs3DShape(e,t,r,n){const s=this._context.stage.renderView._getObjectAndLayerIdColor({graphicUid:n,layerUid:this._context.layer.uid}),a=[new jr(this._createVertexData(r),Uxe,Fc.Point,s)],o=this._getOrCreateMaterial(r),l=d4(this._context,e,a,[o.material],t,this._context.layer.uid,n);if(l===null)return null;const c=new uu(this,l.object,a,o.isUnique?[o.material]:null,null,hx,t);return c.metadata={elevationOffset:r.elevationOffset||0},c.alignedSampledElevation=l.sampledElevation,c.needsElevationUpdates=Ql(t.mode),ux(c,e,this._context.elevationProvider),c}};vY.elevationModeChangeTypes={definedChanged:Zi.UPDATE,staysOnTheGround:Zi.UPDATE,onTheGroundChanged:Zi.RECREATE};const ZO=[0],Uxe=[[P.POSITION,ZO],[P.NORMAL,ZO],[P.AUXPOS1,ZO]],zxe={mode:"relative-to-ground",offset:0},Bxe={ignoreDrivers:!0,renderPriority:0,renderPriorityStep:1},DU=J.getLogger("esri.views.3d.layers.graphics.Graphics3DCalloutSymbolLayerFactory");function Gxe(i,e){if(!rD(i))return DU.error("Graphics3DCalloutSymbolLayerFactory#make",`symbol of type '${i.type}' does not support callouts`),null;if(!i.callout)return null;const t=Hxe[i.callout.type];return t?new t(i,e):(DU.error("Graphics3DCalloutSymbolLayerFactory#make",`unknown or unsupported callout type ${i.callout.type}`),null)}const Hxe={line:vY};let jxe=class{constructor(e,t,r){this.graphic=e,this.renderingInfo=t,this.layer=r}};const FU=new Fl(Array,i=>qD(i,fse),null,10,5),qxe=$t();let Wxe=class{constructor(e,t,r,n,s){this.graphic=e,this.graphics3DSymbol=t,this.graphics=r,this._labelGraphics=new Array,this._auxiliaryGraphics=new Array,this._visibilityFlags=Xxe($n._COUNT,Qo._COUNT),this._featureExpressionFeature=null,this._optimizedGeometry={geometry:null,hasZ:!1,hasM:!1},this._extent=null,this.isElevationSource=!1,++t.referenced,this._featureExpressionFeature=s?cY(s,e,n):null;for(const a of r)y(a)&&(this.isElevationSource=this.isElevationSource||a.isElevationSource)}get labelGraphics(){return this._labelGraphics}get extent(){return this._extent}initialize(e,t){this._layer=t,this._stage=e,this._forEachSymbolLayerGraphic(r=>{r.initialize(e,t),r.setVisibility(this.isVisible())})}destroy(){this._forEachSymbolLayerGraphic(e=>e.destroy()),this.graphics=null,this._auxiliaryGraphics=null,--this.graphics3DSymbol.referenced,this.graphics3DSymbol=null}get destroyed(){return this.graphics==null}clearLabelGraphics(){this._forEachLabelGraphic(e=>e.destroy()),this._labelGraphics.length=0}addLabelGraphic(e,t,r){this._labelGraphics.push(e),e.initialize(t,r),e.setVisibility(this.isVisible($n.LABEL))}addAuxiliaryGraphic(e){this._auxiliaryGraphics.push(e),this._layer&&(e.initialize(this._stage,this._layer),e.setVisibility(this.isVisible()))}get isDraped(){let e=!1;return this._forEachSymbolLayerGraphic(t=>{t.type==="draped"&&(e=!0)}),e}isVisible(e=$n.GRAPHIC,t){for(let r=0;r<=e;r++){const n=this._visibilityFlags[r];for(let s=0;s<n.length;++s)if(n[s]===!1&&s!==t)return!1}return!0}hasVisibilityFlag(e,t){return this._visibilityFlags[t][e]!=null}setVisibilityFlag(e,t,r){const n=this.isVisible(r);this._visibilityFlags[r][e]=t;const s=this.isVisible(r);if(n===s)return!1;if(r===$n.LABEL)this._forEachLabelGraphic(a=>a.setVisibility(s));else{this._forEachSymbolLayerGraphic(o=>o.setVisibility(s));const a=this.isVisible($n.LABEL);this._forEachLabelGraphic(o=>o.setVisibility(a))}return!0}clearVisibilityFlag(e,t=$n.GRAPHIC){return this.setVisibilityFlag(e,void 0,t)}computeExtent(e){if(!this._extent){const t=this.graphic.geometry;if(S(t))return!1;this._extent=$t(),wse(t,this._extent);const r=t.spatialReference;if(!Bm(r,e)&&!bP(this._extent,r,this._extent,e))return this._extent=null,!1}return!0}getAsOptimizedGeometry(e,t){return y(this._optimizedGeometry.geometry)&&this._optimizedGeometry.hasZ===e&&this._optimizedGeometry.hasM===t||(this._optimizedGeometry.geometry=this._convertGraphicToOptimizedGeometry(this.graphic,e,t),this._optimizedGeometry.hasZ=e,this._optimizedGeometry.hasM=t),this._optimizedGeometry.geometry}_convertGraphicToOptimizedGeometry(e,t,r){let n=e.geometry;return n.type!=="mesh"&&n.type!=="extent"||(n=Hm.fromExtent(n.type==="mesh"?n.extent:n)),nie(n,t,r)}get usedMemory(){let e=bte(this.graphic.attributes);return this._forEachSymbolLayerGraphic(t=>{const r=t.graphics3DSymbolLayer.complexity;if(S(r))return;const n=t.type==="draped"?r.memory.draped:r.memory;e+=n.bytesPerFeature,n.bytesPerCoordinate&&(e+=xse(this.graphic.geometry)*n.bytesPerCoordinate)}),e}computeAttachmentOrigin(){const e={render:{origin:R(),num:0},draped:{origin:be(),num:0}};for(const t of this.graphics)S(t)||t.computeAttachmentOrigin(e);return e.render.num&&Q(e.render.origin,e.render.origin,1/e.render.num),e.draped.num&&qs(e.draped.origin,e.draped.origin,1/e.draped.num),e}async getProjectedBoundingBox(e,t,r,n,s){return s||(s={boundingBox:null,requiresDrapedElevation:!1,screenSpaceObjects:[]}),s.boundingBox?Mi(s.boundingBox):s.boundingBox=Mi(),s.requiresDrapedElevation=!1,await lD(this.graphics,async a=>{if(S(a))return;const o=a.type==="draped"?t:e,l=FU.acquire(),c=await a.getProjectedBoundingBox(o,r,s.screenSpaceObjects,n,l);isFinite(c[2])&&isFinite(c[5])||(s.requiresDrapedElevation=!0),c&&X0(s.boundingBox,l),FU.release(l)}),gse(s.boundingBox)||vI(GD(s.boundingBox,qxe))?s:null}needsElevationUpdates(){for(const e of this.graphics)if(y(e)&&(e.type==="object3d"||e.type==="lod-instance")&&e.needsElevationUpdates)return!0;for(const e of this._labelGraphics)if(e&&e.needsElevationUpdates)return!0;return!1}alignWithElevation(e,t,r){this._forEachRenderedGraphic(n=>{n.type!=="object3d"&&n.type!=="lod-instance"||n.alignWithElevation(e,t,this._featureExpressionFeature,r)})}addObjectStateSet(e,t){this._forEachSymbolLayerGraphic(r=>r.addObjectState(e,t))}removeObjectState(e){this._forEachSymbolLayerGraphic(t=>t.removeObjectState(e))}_forEachGraphicList(e,t){e.forEach(r=>r&&t(r))}_forEachSymbolLayerGraphic(e){this._forEachGraphicList(this.graphics,e),this._forEachGraphicList(this._auxiliaryGraphics,e)}_forEachLabelGraphic(e){this._forEachGraphicList(this._labelGraphics,e)}_forEachRenderedGraphic(e){this._forEachSymbolLayerGraphic(e),this._forEachLabelGraphic(e)}};function Xxe(i,e){const t=new Array(i);for(let r=0;r<t.length;r++)t[r]=new Array(e);return t}function AR(i,e){if(!i||i.symbol)return null;const t=e&&e.renderer;return i&&y(t)&&t.getObservationRenderer?t.getObservationRenderer(i):t}function Qxe(i,e){if(y(i.symbol))return i.symbol;const t=AR(i,e);return y(t)&&t.type!=="dot-density"?t.getSymbol(i,e):null}function W6e(i,e){const t=AR(i,e),r=Qxe(i,e);if(S(r))return null;const n={renderer:t,symbol:r};if(S(t)||!("visualVariables"in t)||!t.visualVariables)return n;const s=nH(t,i,e)??[],a=["proportional","proportional","proportional"];for(const{variable:o,value:l}of s)switch(o.type){case"color":n.color=l.toRgba();break;case"size":if(o.target==="outline")n.outlineSize=l;else{const c=o.axis,u=o.useSymbolValue?"symbol-value":l;switch(c){case"width":a[0]=u;break;case"depth":a[1]=u;break;case"height":a[2]=u;break;case"width-and-depth":a[0]=a[1]=u;break;default:a[0]=a[1]=a[2]=u}}break;case"opacity":n.opacity=l;break;case"rotation":switch(o.axis){case"tilt":n.tilt=l;break;case"roll":n.roll=l;break;default:n.heading=l}}return a[0]==="proportional"&&a[1]==="proportional"&&a[2]==="proportional"||(n.size=a),n}async function Zxe(i,e){if(y(i.symbol))return i.symbol;const t=AR(i,e);return y(t)?t.getSymbolAsync(i,e):null}async function X6e(i,e){const t=AR(i,e),r=await Zxe(i,e);if(!r)return null;const n={renderer:t,symbol:r};if(!t||!("visualVariables"in t)||!t.visualVariables)return n;const s=nH(t,i,e)??[],a=["proportional","proportional","proportional"];for(const{variable:o,value:l}of s)if(o.type==="color")n.color=ei.toUnitRGBA(l);else if(o.type==="size")if(o.target==="outline")n.outlineSize=l;else{const c=o.axis,u=o.useSymbolValue?"symbol-value":l;c==="width"?a[0]=u:c==="depth"?a[1]=u:c==="height"?a[2]=u:a[0]=a[1]=c==="width-and-depth"?u:a[2]=u}else o.type==="opacity"?n.opacity=l:o.type==="rotation"&&o.axis==="tilt"?n.tilt=l:o.type==="rotation"&&o.axis==="roll"?n.roll=l:o.type==="rotation"&&(n.heading=l);return(isFinite(a[0])||isFinite(a[1])||isFinite(a[2]))&&(n.size=a),n}function Yxe(i,e=0){const t=i[e];return typeof t=="number"&&isFinite(t)?t:null}function Kxe(i){for(let e=0;e<3;e++){const t=i[e];if(typeof t=="number")return isFinite(t)?t:0}return 0}function NU(i){const e=[[P.POSITION,i.indices]],t=[[P.POSITION,{size:3,data:i.attributeData.position,exclusive:!0}]];return y(i.attributeData.color)&&(t.push([P.COLOR,{size:4,data:i.attributeData.color,exclusive:!0}]),e.push([P.COLOR,new Array(i.indices.length).fill(0)])),y(i.attributeData.uvMapSpace)&&(t.push([P.UVMAPSPACE,{size:4,data:i.attributeData.uvMapSpace,exclusive:!0}]),e.push([P.UVMAPSPACE,i.indices])),y(i.attributeData.boundingRect)&&(t.push([P.BOUNDINGRECT,{size:9,data:i.attributeData.boundingRect,exclusive:!0}]),e.push([P.BOUNDINGRECT,i.indices])),y(i.attributeData.mapPosition)&&(t.push([P.MAPPOS,{size:3,data:i.attributeData.mapPosition,exclusive:!0}]),e.push([P.MAPPOS,i.indices])),new jr(t,e,Fc.Triangle,i.attributeData.objectAndLayerIdColor)}function kU(i){const e=[[P.POSITION,i.indices],[P.UV0,i.indices]],t=[[P.POSITION,{size:3,data:i.attributeData.position,exclusive:!0}],[P.UV0,{size:2,data:i.attributeData.uv0,exclusive:!0}]];return y(i.attributeData.mapPosition)&&(t.push([P.MAPPOS,{size:3,data:i.attributeData.mapPosition,exclusive:!0}]),e.push([P.MAPPOS,i.indices])),new jr(t,e)}function px(i){switch(i.type){case"extent":if(i instanceof ui)return Hm.fromExtent(i);break;case"polygon":return i}return null}let OR=class{constructor(e,t,r){this.renderData=e,this.layerUid=t,this.graphicsUid=r,this.outGeometries=new Array,this.outMaterials=new Array,this.outTransforms=new Array}};var ew,YL;(function(i){i[i.RasterImage=0]="RasterImage",i[i.Features=1]="Features"})(ew||(ew={})),function(i){i[i.WithRasterImage=0]="WithRasterImage",i[i.WithoutRasterImage=1]="WithoutRasterImage"}(YL||(YL={}));var ki,Rl,ke,tw,er,fn,xs;(function(i){i[i.INNER=0]="INNER",i[i.OUTER=1]="OUTER"})(ki||(ki={})),function(i){i[i.REGULAR=0]="REGULAR",i[i.HAS_NORTH_POLE=1]="HAS_NORTH_POLE",i[i.HAS_SOUTH_POLE=2]="HAS_SOUTH_POLE",i[i.HAS_BOTH_POLES=3]="HAS_BOTH_POLES"}(Rl||(Rl={})),function(i){i[i.NORTH=0]="NORTH",i[i.NORTH_EAST=1]="NORTH_EAST",i[i.EAST=2]="EAST",i[i.SOUTH_EAST=3]="SOUTH_EAST",i[i.SOUTH=4]="SOUTH",i[i.SOUTH_WEST=5]="SOUTH_WEST",i[i.WEST=6]="WEST",i[i.NORTH_WEST=7]="NORTH_WEST"}(ke||(ke={})),function(i){i[i.OFF=0]="OFF",i[i.ON=1]="ON"}(tw||(tw={})),function(i){i[i.Color=0]="Color",i[i.ColorNoRasterImage=1]="ColorNoRasterImage",i[i.Highlight=2]="Highlight",i[i.Water=3]="Water",i[i.Occluded=4]="Occluded",i[i.ObjectAndLayerIdColor=5]="ObjectAndLayerIdColor"}(er||(er={})),function(i){i[i.FADING=0]="FADING",i[i.IMMEDIATE=1]="IMMEDIATE",i[i.UNFADED=2]="UNFADED"}(fn||(fn={})),function(i){i[i.INSIDE=0]="INSIDE",i[i.INTERSECTS=1]="INTERSECTS",i[i.OUTSIDE=2]="OUTSIDE"}(xs||(xs={}));let Jxe=class{constructor(e,t){this.vec3=e,this.id=t}};function iw(i,e,t,r){return new Jxe(Ge(i,e,t),r)}var Zn;(function(i){i[i.None=0]="None",i[i.ColorAndWater=1]="ColorAndWater",i[i.Highlight=2]="Highlight",i[i.Occluded=3]="Occluded",i[i.ObjectAndLayerIdColor=4]="ObjectAndLayerIdColor"})(Zn||(Zn={}));let VU=class{constructor(e,t){this.index=e,this.renderTargets=t,this._extent=$t(),this.resolution=0,this.renderLocalOrigin=iw(0,0,0,"O"),this.pixelRatio=1,this.mapUnitsPerPixel=1,this.canvasGeometries=new tTe,this.validTargets=null,this.hasDrapedFeatureSource=!1,this.hasDrapedRasterSource=!1,this.hasTargetWithoutRasterImage=!1,this.index=e,this.validTargets=new Array(t.renderTargets.length).fill(!1)}get extent(){return this._extent}getValidTexture(e){return this.validTargets[e]?this.renderTargets.getTarget(e).getTexture():null}get _needsColorWithoutRasterImage(){return this.hasDrapedRasterSource&&this.hasDrapedFeatureSource&&this.hasTargetWithoutRasterImage}getColorTexture(e){const t=e===Zn.ColorAndWater?this.renderTargets.getTarget(er.Color):e===Zn.Highlight?this.renderTargets.getTarget(er.Highlight):e===Zn.ObjectAndLayerIdColor?this.renderTargets.getTarget(er.ObjectAndLayerIdColor):this.renderTargets.getTarget(er.Occluded);return t?t.getTexture():null}getColorTextureNoRasterImage(){return this._needsColorWithoutRasterImage?this.getValidTexture(er.ColorNoRasterImage):this.hasDrapedFeatureSource?this.getValidTexture(er.Color):null}getNormalTexture(e){const t=e===Zn.ColorAndWater?this.renderTargets.getTarget(er.Water):null;return t?t.getTexture():null}draw(e,t){const r=this.computeRenderTargetValidityBitfield();for(const n of this.renderTargets.renderTargets)n.type!==er.ColorNoRasterImage||this._needsColorWithoutRasterImage?this.validTargets[n.type]=e.drawTarget(this,n,t):this.validTargets[n.type]=!1;return r^this.computeRenderTargetValidityBitfield()?UE.CHANGED:UE.UNCHANGED}computeRenderTargetValidityBitfield(){const e=this.validTargets;return+e[er.Color]|+e[er.ColorNoRasterImage]<<1|+e[er.Highlight]<<2|+e[er.Water]<<3|+e[er.Occluded]<<4}setupGeometryViewsCyclical(e){this.setupGeometryViewsDirect();const t=.001*e.range;if(this._extent[0]-t<=e.min){const r=this.canvasGeometries.extents[this.canvasGeometries.numViews++];DE(this._extent,e.range,0,r)}if(this._extent[2]+t>=e.max){const r=this.canvasGeometries.extents[this.canvasGeometries.numViews++];DE(this._extent,-e.range,0,r)}}setupGeometryViewsDirect(){this.canvasGeometries.numViews=1,yw(this.canvasGeometries.extents[0],this._extent)}hasSomeSizedView(){for(let e=0;e<this.canvasGeometries.numViews;e++){const t=this.canvasGeometries.extents[e];if(t[0]!==t[2]&&t[1]!==t[3])return!0}return!1}applyViewport(e){e.setViewport(this.index===ki.INNER?0:this.resolution,0,this.resolution,this.resolution)}};function eTe(i,e,t){return Math.min(Y$(Math.max(i,e)+256),t)}let tTe=class{constructor(){this.extents=[$t(),$t(),$t()],this.numViews=0}},wY=class{constructor(e,t){this._size=kie(),this._fbo=null,this._fbo=new yn(e,{colorTarget:Vn.TEXTURE,depthStencilTarget:rs.NONE},{target:vi.TEXTURE_2D,pixelFormat:yt.RGBA,dataType:qt.UNSIGNED_BYTE,wrapMode:si.CLAMP_TO_EDGE,samplingMode:Kt.LINEAR_MIPMAP_LINEAR,hasMipmap:t,maxAnisotropy:8,width:0,height:0})}dispose(){this._fbo=Me(this._fbo)}getTexture(){return this._fbo?this._fbo.colorTexture:null}isValid(){return this._fbo!==null}resize(e,t){this._size[0]=e,this._size[1]=t,this._fbo.resize(this._size[0],this._size[1])}bind(e){e.bindFramebuffer(this._fbo)}generateMipMap(){const e=this._fbo.colorTexture;e.descriptor.hasMipmap&&e.generateMipmap()}disposeRenderTargetMemory(){var e;(e=this._fbo)==null||e.resize(0,0)}get gpuMemoryUsage(){var e;return((e=this._fbo)==null?void 0:e.gpuMemoryUsage)??0}},k_=class{constructor(e,t,r,n=!0){this.output=t,this.type=r,this.valid=!1,this.lastUsed=1/0,this.fbo=new wY(e,n)}},iTe=class{constructor(e){this.renderTargets=[new k_(e,k.Color,er.Color),new k_(e,k.Color,er.ColorNoRasterImage),new k_(e,k.Highlight,er.Highlight,!1),new k_(e,k.Normal,er.Water),new k_(e,k.Color,er.Occluded)],St("enable-feature:objectAndLayerId-rendering")&&this.renderTargets.push(new k_(e,k.ObjectAndLayerIdColor,er.ObjectAndLayerIdColor))}getTarget(e){return this.renderTargets[e].fbo}dispose(){for(const e of this.renderTargets)e.fbo.dispose()}disposeRenderTargetMemory(){for(const e of this.renderTargets)e.fbo.disposeRenderTargetMemory()}validateUsageForTarget(e,t,r){if(e)t.lastUsed=r;else if(r-t.lastUsed>rTe)t.fbo.disposeRenderTargetMemory(),t.lastUsed=1/0;else if(t.lastUsed<1/0)return!0;return!1}get gpuMemoryUsage(){return this.renderTargets.reduce((e,t)=>e+t.fbo.gpuMemoryUsage,0)}};const rTe=1e3;let p4=class{constructor(){this._outer=new Map}clear(){this._outer.clear()}get empty(){return this._outer.size===0}get(e,t){var r;return(r=this._outer.get(e))==null?void 0:r.get(t)}set(e,t,r){const n=this._outer.get(e);n?n.set(t,r):this._outer.set(e,new Map([[t,r]]))}delete(e,t){const r=this._outer.get(e);r&&(r.delete(t),r.size===0&&this._outer.delete(e))}forEach(e){this._outer.forEach((t,r)=>e(t,r))}},xY=class{constructor(e){this._context=e,this._perConstructorInstances=new p4,this._frameCounter=0,this._keepAliveFrameCount=UU}get viewingMode(){return this._context.viewingMode}get constructionContext(){return this._context}dispose(){this._perConstructorInstances.forEach(e=>e.forEach(t=>t.technique.destroy())),this._perConstructorInstances.clear()}acquire(e,t=sTe){const r=t.key;let n=this._perConstructorInstances.get(e,r);if(S(n)){const s=new e(this._context,t,()=>this.release(s));n=new nTe(s),this._perConstructorInstances.set(e,r,n)}return++n.refCount,n.technique}releaseAndAcquire(e,t,r){if(y(r)){if(t.key===r.key)return r;this.release(r)}return this.acquire(e,t)}release(e){if(S(e)||this._perConstructorInstances.empty)return;const t=this._perConstructorInstances.get(e.constructor,e.key);S(t)||(--t.refCount,t.refCount===0&&(t.refZeroFrame=this._frameCounter))}frameUpdate(){this._frameCounter++,this._keepAliveFrameCount!==UU&&this._perConstructorInstances.forEach((e,t)=>{e.forEach((r,n)=>{r.refCount===0&&r.refZeroFrame+this._keepAliveFrameCount<this._frameCounter&&(r.technique.destroy(),this._perConstructorInstances.delete(t,n))})})}async reloadAll(){const e=new Array;this._perConstructorInstances.forEach((t,r)=>{const n=async(s,a)=>{const o=a.shader;o&&(await o.reload(),s.forEach(l=>l.technique.reload(this._context)))};e.push(n(t,r))}),await Promise.all(e)}},nTe=class{constructor(e){this.technique=e,this.refCount=0,this.refZeroFrame=0}};const UU=-1,sTe=new $a,MR=i=>{class e extends i{constructor(){super(...arguments),this._isDisposed=!1}dispose(){for(const r of this._managedDisposables??[]){const n=this[r];this[r]=null,n&&typeof n.dispose=="function"&&n.dispose()}this._isDisposed=!0}get isDisposed(){return this._isDisposed}}return e};let IR=class extends MR(class{}){};function Yn(){return(i,e)=>{var t,r;i.hasOwnProperty("_managedDisposables")||(i._managedDisposables=((t=i._managedDisposables)==null?void 0:t.slice())??[]),(r=i._managedDisposables)==null||r.unshift(e)}}let TY=class{constructor(e,t,r,n){this._textureRepository=e,this._techniqueRepository=t,this.materialChanged=r,this.requestRender=n,this._id2glMaterialRef=new p4}dispose(){this._textureRepository.dispose()}acquire(e,t,r){if(this._ownMaterial(e),!e.requiresSlot(t,r))return null;let n=this._id2glMaterialRef.get(r,e.id);if(S(n)){const s=e.createGLMaterial({material:e,techniqueRep:this._techniqueRepository,textureRep:this._textureRepository,output:r});n=new aTe(s),this._id2glMaterialRef.set(r,e.id,n)}return n.ref(),n.glMaterial}release(e,t){const r=this._id2glMaterialRef.get(t,e.id);y(r)&&(r.unref(),r.referenced||(Me(r.glMaterial),this._id2glMaterialRef.delete(t,e.id)))}_ownMaterial(e){y(e.repository)&&e.repository!==this&&J.getLogger("esri.views.3d.webgl-engine.lib.GLMaterialRepository").error("Material is already owned by a different material repository"),e.repository=this}},aTe=class{constructor(e){this.glMaterial=e,this._refCnt=0}ref(){++this._refCnt}unref(){--this._refCnt,it(this._refCnt>=0)}get referenced(){return this._refCnt>0}};const oTe={orderedRepackingEnabled:!1},lTe={rootOrigin:null},cTe=["layerObjectAdded","layerObjectRemoved","layerObjectsAdded","layerObjectsRemoved","shaderTransformationChanged","objectTransformation","visibilityChanged","occlusionChanged","highlightChanged","objectGeometryAdded","objectGeometryRemoved","vertexAttrsUpdated"];let CY=class extends EG{constructor(e,t=""){super(),this.apiLayerUid=t,this.type=gv.Layer,this.events=new nn,this.isSliceable=!1,this._objects=new Zt,this._stageHandles=new Ft,this.apiLayerUid=t,this.isVisible=(e==null?void 0:e.isVisible)??!0,this.isPickable=(e==null?void 0:e.isPickable)??!0,this.updatePolicy=(e==null?void 0:e.updatePolicy)??zE.ASYNC}get objects(){return this._objects}destroy(){this.detachStage(),this._stage=null}attachStage(e){this.detachStage(),this._stage=e;for(const t of cTe)this._stageHandles.add(this.events.on(t,r=>e.handleEvent(t,r)))}detachStage(){this._stageHandles.removeAll(),this.invalidateSpatialQueryAccelerator()}add(e){this._objects.push(e),e.parentLayer=this,this.events.emit("layerObjectAdded",{layer:this,object:e}),y(this._octree)&&this._octree.add([e])}remove(e){this._objects.removeUnordered(e)&&(e.parentLayer=null,this.events.emit("layerObjectRemoved",{layer:this,object:e}),y(this._octree)&&this._octree.remove([e]))}addMany(e){this._objects.pushArray(e);for(const t of e)t.parentLayer=this;this.events.emit("layerObjectsAdded",{layer:this,objects:e}),y(this._octree)&&this._octree.add(e)}removeMany(e){const t=new Array;if(this._objects.removeUnorderedMany(e,e.length,t),t.length!==0){for(const r of t)r.parentLayer=null;this.events.emit("layerObjectsRemoved",{layer:this,objects:t}),y(this._octree)&&this._octree.remove(t)}}sync(){y(this._stage)&&this.updatePolicy!==zE.SYNC&&this._stage.syncLayer(this.id)}notifyObjectBBChanged(e,t){y(this._octree)&&this._octree.update(e,t)}getSpatialQueryAccelerator(){return S(this._octree)&&this._objects.length>50&&this._createOctree(),this._octree}shaderTransformationChanged(){this.invalidateSpatialQueryAccelerator(),this.events.emit("shaderTransformationChanged",this)}invalidateSpatialQueryAccelerator(){this._octree=Te(this._octree)}_createOctree(){this._octree=new Mc(e=>e.boundingVolumeWorldSpace.bounds),this._octree.add(this._objects.data,this._objects.length)}};function iP(i){return y(i)&&i.type===gv.Layer}const SY=new Map([[P.POSITION,0],[P.SUBDIVISIONFACTOR,1],[P.UV0,2],[P.AUXPOS1,3],[P.AUXPOS2,4],[P.COLOR,5],[P.COLORFEATUREATTRIBUTE,5],[P.SIZE,6],[P.SIZEFEATUREATTRIBUTE,6],[P.OPACITYFEATUREATTRIBUTE,7],[P.OBJECTANDLAYERIDCOLOR,8]]);let EY=class PY extends ti{initializeProgram(e){return new Jt(e.rctx,PY.shader.get().build(this.configuration),SY)}_makePipelineState(e,t){const r=this.configuration,n=e===Ht.NONE,s=e===Ht.FrontFace;return Ke({blending:r.output===k.Color||r.output===k.Alpha?n?Hl:jm(e):null,depthTest:{func:i_(e)},depthWrite:n?r.writeDepth&&nl:LP(e),colorWrite:ht,stencilWrite:r.hasOccludees?Cd:null,stencilTest:r.hasOccludees?t?Ig:r_:null,polygonOffset:n||s?r.hasPolygonOffset&&zU:$D})}initializePipeline(){const e=this.configuration;if(e.occluder){const t=e.hasPolygonOffset&&zU;this._occluderPipelineTransparent=Ke({blending:Hl,polygonOffset:t,depthTest:VE,depthWrite:null,colorWrite:ht,stencilWrite:null,stencilTest:zG}),this._occluderPipelineOpaque=Ke({blending:Hl,polygonOffset:t,depthTest:VE,depthWrite:null,colorWrite:ht,stencilWrite:BG,stencilTest:GG}),this._occluderPipelineMaskWrite=Ke({blending:null,polygonOffset:t,depthTest:DD,depthWrite:null,colorWrite:null,stencilWrite:Cd,stencilTest:Ig})}return this._occludeePipelineState=this._makePipelineState(this.configuration.transparencyPassType,!0),this._makePipelineState(this.configuration.transparencyPassType,!1)}get primitiveType(){return this.configuration.wireframe?Dt.LINES:Dt.TRIANGLE_STRIP}getPipelineState(e,t){return t?this._occludeePipelineState:this.configuration.occluder?e===ae.TRANSPARENT_OCCLUDER_MATERIAL?this._occluderPipelineTransparent:e===ae.OCCLUDER_MATERIAL?this._occluderPipelineOpaque:this._occluderPipelineMaskWrite:super.getPipelineState(e,t)}};EY.shader=new ii(Vse,()=>G(()=>import("./RibbonLine.glsl-7b33496e.js"),["assets/RibbonLine.glsl-7b33496e.js","assets/Matrix3PassUniform-ad9f953b.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/mat3f64-c6305894.js","assets/mat4f64-1e28eae0.js","assets/vec3f32-c9aa289f.js","assets/vec3f64-2f9cef06.js","assets/VertexAttribute-9c5c630d.js","assets/mat4-44a0988f.js","assets/common-c186b691.js","assets/vec3-e93e648f.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/mathUtils-b4bb77e2.js","assets/vec4-790471c0.js","assets/context-util-a4ce3a7b.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/promiseUtils-1e54421e.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/aaBoundingBox-657a9b82.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/aaBoundingRect-193543b5.js","assets/basicInterfaces-19ed850e.js","assets/ViewingMode-5d7d590b.js","assets/Util-a48361c6.js","assets/vec2f64-30dc1443.js","assets/vec4f64-e407da96.js","assets/LineStipple.glsl-ed22a88b.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/Texture2DPassUniform-753de459.js","assets/vec2-528adfe4.js","assets/Float4PassUniform-d7bdbc81.js","assets/FloatPassUniform-68d54f51.js","assets/floatRGBA-9ad35d39.js","assets/Texture-46c8c2cb.js","assets/compilerUtils-18d58939.js","assets/Evented-a45c8b0f.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/ScreenSpacePass-d5e48a9b.js","assets/assets-8d3e737a.js","assets/MarkerSizing.glsl-566261cc.js","assets/sdfPrimitives-9858c36d.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/TransparencyPassType-a11868d2.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Slice.glsl-3b39b1f7.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/PiUtils.glsl-db6418ee.js","assets/AlphaCutoff-96178e0d.js"]));const zU={factor:0,units:-4};var Ja;(function(i){i[i.LEFT_JOIN_START=-2]="LEFT_JOIN_START",i[i.LEFT_JOIN_END=-1]="LEFT_JOIN_END",i[i.LEFT_CAP_START=-4]="LEFT_CAP_START",i[i.LEFT_CAP_END=-5]="LEFT_CAP_END",i[i.RIGHT_JOIN_START=2]="RIGHT_JOIN_START",i[i.RIGHT_JOIN_END=1]="RIGHT_JOIN_END",i[i.RIGHT_CAP_START=4]="RIGHT_CAP_START",i[i.RIGHT_CAP_END=5]="RIGHT_CAP_END"})(Ja||(Ja={}));let g0=class extends Fd{constructor(e){super(e,new uTe),this._configuration=new Use,this._vertexAttributeLocations=SY,this._layout=this.createLayout()}isClosed(e,t){return RY(this.parameters,e,t)}getConfiguration(e,t){this._configuration.output=e,this._configuration.draped=t.slot===ae.DRAPED_MATERIAL;const r=y(this.parameters.stipplePattern)&&e!==k.Highlight;return this._configuration.stippleEnabled=r,this._configuration.stippleOffColorEnabled=r&&y(this.parameters.stippleOffColor),this._configuration.stippleScaleWithLineWidth=r&&this.parameters.stippleScaleWithLineWidth,this._configuration.stipplePreferContinuous=r&&this.parameters.stipplePreferContinuous,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.hasOccludees=this.parameters.hasOccludees,this._configuration.roundJoins=this.parameters.join==="round",this._configuration.capType=this.parameters.cap,this._configuration.applyMarkerOffset=!!y(this.parameters.markerParameters)&&pTe(this.parameters.markerParameters),this._configuration.hasPolygonOffset=this.parameters.hasPolygonOffset,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.vvColor=this.parameters.vvColorEnabled,this._configuration.vvOpacity=this.parameters.vvOpacityEnabled,this._configuration.vvSize=this.parameters.vvSizeEnabled,this._configuration.innerColorEnabled=this.parameters.innerWidth>0&&y(this.parameters.innerColor),this._configuration.falloffEnabled=this.parameters.falloff>0,this._configuration.occluder=this.parameters.renderOccluded===cr.OccludeAndTransparentStencil,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration.hasMultipassTerrain=t.multipassTerrain.enabled,this._configuration.cullAboveGround=t.multipassTerrain.cullAboveGround,this._configuration.wireframe=this.parameters.wireframe,this._configuration}intersect(e,t,r,n,s,a,o,l,c){y(c)?this._intersectDrapedLineGeometry(e,n,c,a,o):this._intersectLineGeometry(e,t,r,n,o)}_intersectDrapedLineGeometry(e,t,r,n,s){if(!t.options.selectionMode)return;const a=e.vertexAttributes.get(P.POSITION).data,o=e.vertexAttributes.get(P.SIZE);let l=this.parameters.width;if(this.parameters.vvSizeEnabled){const _=e.vertexAttributes.get(P.SIZEFEATUREATTRIBUTE).data[0];l*=ce(this.parameters.vvSizeOffset[0]+_*this.parameters.vvSizeFactor[0],this.parameters.vvSizeMinSize[0],this.parameters.vvSizeMaxSize[0])}else o&&(l*=o.data[0]);const c=n[0],u=n[1],d=(l/2+4)*e.screenToWorldRatio;let m=Number.MAX_VALUE,f=0;for(let _=0;_<a.length-5;_+=3){const g=a[_],x=a[_+1],b=c-g,v=u-x,w=a[_+3]-g,T=a[_+4]-x,E=ce((w*b+T*v)/(w*w+T*T),0,1),C=w*E-b,A=T*E-v,M=C*C+A*A;M<m&&(m=M,f=_/3)}m<d*d&&s(r.dist,r.normal,f,!1)}_intersectLineGeometry(e,t,r,n,s){if(!n.options.selectionMode||MP(t))return;if(!jG(r))return void J.getLogger("esri.views.3d.webgl-engine.materials.RibbonLineMaterial").error("intersection assumes a translation-only matrix");const a=e.vertexAttributes,o=a.get(P.POSITION).data;let l=this.parameters.width;if(this.parameters.vvSizeEnabled){const b=a.get(P.SIZEFEATUREATTRIBUTE).data[0];l*=ce(this.parameters.vvSizeOffset[0]+b*this.parameters.vvSizeFactor[0],this.parameters.vvSizeMinSize[0],this.parameters.vvSizeMaxSize[0])}else a.has(P.SIZE)&&(l*=a.get(P.SIZE).data[0]);const c=n.camera,u=mTe;wn(u,n.point);const d=l*c.pixelRatio/2+4*c.pixelRatio;Z(d1[0],u[0]-d,u[1]+d,0),Z(d1[1],u[0]+d,u[1]+d,0),Z(d1[2],u[0]+d,u[1]-d,0),Z(d1[3],u[0]-d,u[1]-d,0);for(let b=0;b<4;b++)if(!c.unprojectFromRenderScreen(d1[b],Tu[b]))return;Bh(c.eye,Tu[0],Tu[1],KO),Bh(c.eye,Tu[1],Tu[2],JO),Bh(c.eye,Tu[2],Tu[3],eM),Bh(c.eye,Tu[3],Tu[0],tM);let m=Number.MAX_VALUE,f=0;const _=KL(this.parameters,a,e.indices)?o.length-2:o.length-5;for(let b=0;b<_;b+=3){na[0]=o[b]+r[12],na[1]=o[b+1]+r[13],na[2]=o[b+2]+r[14];const v=(b+3)%o.length;if(sa[0]=o[v]+r[12],sa[1]=o[v+1]+r[13],sa[2]=o[v+2]+r[14],tr(KO,na)<0&&tr(KO,sa)<0||tr(JO,na)<0&&tr(JO,sa)<0||tr(eM,na)<0&&tr(eM,sa)<0||tr(tM,na)<0&&tr(tM,sa)<0)continue;if(c.projectToRenderScreen(na,cf),c.projectToRenderScreen(sa,hf),cf[2]<0&&hf[2]>0){ne(ih,na,sa);const T=c.frustum,E=-tr(T[hr.NEAR],na)/me(ih,Ia(T[hr.NEAR]));Q(ih,ih,E),oe(na,na,ih),c.projectToRenderScreen(na,cf)}else if(cf[2]>0&&hf[2]<0){ne(ih,sa,na);const T=c.frustum,E=-tr(T[hr.NEAR],sa)/me(ih,Ia(T[hr.NEAR]));Q(ih,ih,E),oe(sa,sa,ih),c.projectToRenderScreen(sa,hf)}else if(cf[2]<0&&hf[2]<0)continue;cf[2]=0,hf[2]=0;const w=wD(fg(cf,hf,HU),u);w<m&&(m=w,q(BU,na),q(GU,sa),f=b/3)}const g=n.rayBegin,x=n.rayEnd;if(m<d*d){let b=Number.MAX_VALUE;if(uG(fg(BU,GU,HU),fg(g,x,fTe),lf)){ne(lf,lf,g);const v=_e(lf);Q(lf,lf,1/v),b=v/Ii(g,x)}s(b,lf,f,!1)}}computeAttachmentOrigin(e,t){const r=e.vertexAttributes;if(!r)return!1;const n=e.indices,s=r.get(P.POSITION);return FD(s,n?n.get(P.POSITION):null,n&&KL(this.parameters,r,n),t)}createLayout(){const e=sn().vec3f(P.POSITION).f32(P.SUBDIVISIONFACTOR).vec2f(P.UV0).vec3f(P.AUXPOS1).vec3f(P.AUXPOS2);return this.parameters.vvSizeEnabled?e.f32(P.SIZEFEATUREATTRIBUTE):e.f32(P.SIZE),this.parameters.vvColorEnabled?e.f32(P.COLORFEATUREATTRIBUTE):e.vec4f(P.COLOR),this.parameters.vvOpacityEnabled&&e.f32(P.OPACITYFEATUREATTRIBUTE),St("enable-feature:objectAndLayerId-rendering")&&e.vec4u8(P.OBJECTANDLAYERIDCOLOR),e}createBufferWriter(){return new dTe(this._layout,this.parameters)}requiresSlot(e,t){return t===k.Color||t===k.Alpha||t===k.Highlight||t===k.Depth||t===k.ObjectAndLayerIdColor?e===ae.DRAPED_MATERIAL?!0:this.parameters.renderOccluded===cr.OccludeAndTransparentStencil?e===ae.OPAQUE_MATERIAL||e===ae.OCCLUDER_MATERIAL||e===ae.TRANSPARENT_OCCLUDER_MATERIAL:t===k.Color||t===k.Alpha?e===(this.parameters.writeDepth?ae.TRANSPARENT_MATERIAL:ae.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL):e===ae.OPAQUE_MATERIAL:!1}createGLMaterial(e){return new hTe(e)}validateParameters(e){e.join!=="miter"&&(e.miterLimit=0),y(e.markerParameters)&&(e.markerScale=e.markerParameters.width/e.width)}},hTe=class extends t_{constructor(){super(...arguments),this._stipplePattern=null}dispose(){super.dispose(),this._stippleTextureRepository.release(this._stipplePattern),this._stipplePattern=null}_updateOccludeeState(e){e.hasOccludees!==this._material.parameters.hasOccludees&&this._material.setParameters({hasOccludees:e.hasOccludees})}beginSlot(e){this._output!==k.Color&&this._output!==k.Alpha||this._updateOccludeeState(e);const t=this._material.parameters.stipplePattern;return this._stipplePattern!==t&&(this._material.setParameters(this._stippleTextureRepository.swap(this._stipplePattern,t)),this._stipplePattern=t),this.ensureTechnique(EY,e)}},uTe=class extends PG{constructor(){super(...arguments),this.width=0,this.color=Rc,this.join="miter",this.cap=T0.BUTT,this.miterLimit=5,this.writeDepth=!0,this.hasPolygonOffset=!1,this.stippleTexture=null,this.stippleScaleWithLineWidth=!1,this.stipplePreferContinuous=!0,this.markerParameters=null,this.markerScale=1,this.hasSlicePlane=!1,this.vvFastUpdate=!1,this.isClosed=!1,this.falloff=0,this.innerWidth=0,this.hasOccludees=!1,this.wireframe=!1}},dTe=class{constructor(e,t){this._parameters=t,this.numJoinSubdivisions=0,this.vertexBufferLayout=e;const r=t.stipplePattern?1:0;switch(this._parameters.join){case"miter":case"bevel":this.numJoinSubdivisions=r;break;case"round":this.numJoinSubdivisions=zse+r}}_isClosed(e){return KL(this._parameters,e.vertexAttributes,e.indices)}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){const r=e.indices.get(P.POSITION).length/2+1,n=this._isClosed(e);let s=n?2:2*2;return s+=((n?r:r-1)-(n?0:1))*(2*this.numJoinSubdivisions+4),s+=2,this._parameters.wireframe&&(s=2+4*(s-2)),s}write(e,t,r,n,s){var ee;const a=gTe,o=_Te,l=yTe,c=r.vertexAttributes.get(P.POSITION).data,u=r.indices&&r.indices.get(P.POSITION),d=(ee=r.vertexAttributes.get(P.DISTANCETOSTART))==null?void 0:ee.data;u&&u.length!==2*(c.length/3-1)&&console.warn("RibbonLineMaterial does not support indices");let m=1,f=0;this._parameters.vvSizeEnabled?f=r.vertexAttributes.get(P.SIZEFEATUREATTRIBUTE).data[0]:r.vertexAttributes.has(P.SIZE)&&(m=r.vertexAttributes.get(P.SIZE).data[0]);let _=[1,1,1,1],g=0;this._parameters.vvColorEnabled?g=r.vertexAttributes.get(P.COLORFEATUREATTRIBUTE).data[0]:r.vertexAttributes.has(P.COLOR)&&(_=r.vertexAttributes.get(P.COLOR).data);let x=null;St("enable-feature:objectAndLayerId-rendering")&&(x=r.objectAndLayerIdColor);let b=0;this._parameters.vvOpacityEnabled&&(b=r.vertexAttributes.get(P.OPACITYFEATUREATTRIBUTE).data[0]);const v=c.length/3,w=new Float32Array(n.buffer),T=St("enable-feature:objectAndLayerId-rendering")?new Uint8Array(n.buffer):null,E=this.vertexBufferLayout.stride/4;let C=s*E;const A=C;let M=0;const I=d?(H,V,X)=>M=d[X]:(H,V,X)=>M+=Ii(H,V),L=(H,V,X,$,B,W,te)=>{if(w[C++]=V[0],w[C++]=V[1],w[C++]=V[2],w[C++]=$,w[C++]=te,w[C++]=B,w[C++]=H[0],w[C++]=H[1],w[C++]=H[2],w[C++]=X[0],w[C++]=X[1],w[C++]=X[2],this._parameters.vvSizeEnabled?w[C++]=f:w[C++]=m,this._parameters.vvColorEnabled)w[C++]=g;else{const ie=Math.min(4*W,_.length-4);w[C++]=_[ie+0],w[C++]=_[ie+1],w[C++]=_[ie+2],w[C++]=_[ie+3]}this._parameters.vvOpacityEnabled&&(w[C++]=b),St("enable-feature:objectAndLayerId-rendering")&&(y(x)&&(T[4*C+0]=x[0],T[4*C+1]=x[1],T[4*C+2]=x[2],T[4*C+3]=x[3]),C++)};C+=E,Z(o,c[0],c[1],c[2]),e&&Ce(o,o,e);const U=this._isClosed(r);if(U){const H=c.length-3;Z(a,c[H],c[H+1],c[H+2]),e&&Ce(a,a,e)}else Z(l,c[3],c[4],c[5]),e&&Ce(l,l,e),L(o,o,l,1,Ja.LEFT_CAP_START,0,0),L(o,o,l,1,Ja.RIGHT_CAP_START,0,0),q(a,o),q(o,l);const j=U?0:1,re=U?v:v-1;for(let H=j;H<re;H++){const V=(H+1)%v*3;Z(l,c[V+0],c[V+1],c[V+2]),e&&Ce(l,l,e),I(a,o,H),L(a,o,l,0,Ja.LEFT_JOIN_END,H,M),L(a,o,l,0,Ja.RIGHT_JOIN_END,H,M);const X=this.numJoinSubdivisions;for(let $=0;$<X;++$){const B=($+1)/(X+1);L(a,o,l,B,Ja.LEFT_JOIN_END,H,M),L(a,o,l,B,Ja.RIGHT_JOIN_END,H,M)}L(a,o,l,1,Ja.LEFT_JOIN_START,H,M),L(a,o,l,1,Ja.RIGHT_JOIN_START,H,M),q(a,o),q(o,l)}U?(Z(l,c[3],c[4],c[5]),e&&Ce(l,l,e),M=I(a,o,re),L(a,o,l,0,Ja.LEFT_JOIN_END,j,M),L(a,o,l,0,Ja.RIGHT_JOIN_END,j,M)):(M=I(a,o,re),L(a,o,o,0,Ja.LEFT_CAP_END,re,M),L(a,o,o,0,Ja.RIGHT_CAP_END,re,M)),YO(w,A+E,w,A,E),C=YO(w,C-E,w,C,E),this._parameters.wireframe&&this._addWireframeVertices(n,A,C,E)}_addWireframeVertices(e,t,r,n){const s=new Float32Array(e.buffer,r*Float32Array.BYTES_PER_ELEMENT),a=new Float32Array(e.buffer,t*Float32Array.BYTES_PER_ELEMENT,r-t);let o=0;const l=c=>o=YO(a,c,s,o,n);for(let c=0;c<a.length-1;c+=2*n)l(c),l(c+2*n),l(c+1*n),l(c+2*n),l(c+1*n),l(c+3*n)}};function YO(i,e,t,r,n){for(let s=0;s<n;s++)t[r++]=i[e++];return r}function KL(i,e,t){return RY(i,e.get(P.POSITION).data,t?t.get(P.POSITION):null)}function RY(i,e,t){return!!i.isClosed&&(t?t.length>2:e.length>6)}function pTe(i){return i.anchor===sH.Tip&&i.hideOnShortSegments&&i.placement==="begin-end"&&i.worldSpace}const na=R(),sa=R(),ih=R(),lf=R(),mTe=R(),cf=is(),hf=is(),BU=R(),GU=R(),HU=fv(),fTe=fv(),gTe=R(),_Te=R(),yTe=R(),d1=[is(),is(),is(),is()],Tu=[R(),R(),R(),R()],KO=fr(),JO=fr(),eM=fr(),tM=fr();let m4=class{constructor(e){this._originSR=e,this._origins=new Map,this._objects=new Map,this._gridSize=5e5,this._rootOriginId="root/"+Cm()}getOrigin(e){const t=this._origins.get(this._rootOriginId);if(t==null){const u=lTe.rootOrigin;if(y(u))return this._origins.set(this._rootOriginId,iw(u[0],u[1],u[2],this._rootOriginId)),this.getOrigin(e);const d=iw(e[0]+Math.random()-.5,e[1]+Math.random()-.5,e[2]+Math.random()-.5,this._rootOriginId);return this._origins.set(this._rootOriginId,d),d}const r=this._gridSize,n=Math.round(e[0]/r),s=Math.round(e[1]/r),a=Math.round(e[2]/r),o=`${n}/${s}/${a}`;let l=this._origins.get(o);const c=.5*r;if(ne(Cn,e,t.vec3),Cn[0]=Math.abs(Cn[0]),Cn[1]=Math.abs(Cn[1]),Cn[2]=Math.abs(Cn[2]),Cn[0]<c&&Cn[1]<c&&Cn[2]<c){if(l){const u=Math.max(...Cn);if(ne(Cn,e,l.vec3),Cn[0]=Math.abs(Cn[0]),Cn[1]=Math.abs(Cn[1]),Cn[2]=Math.abs(Cn[2]),Math.max(...Cn)<u)return l}return t}return l||(l=iw(n*r,s*r,a*r,o),this._origins.set(o,l)),l}_drawOriginBox(e,t=Bi(1,1,0,1)){const r=window.view,n=r._stage,s=t.toString();if(!this._objects.has(s)){this._material=new g0({width:2,color:t}),n.add(this._material);const f=new CY({isPickable:!1}),_=new Bd({castShadow:!1});n.add(_),f.add(_),n.add(f),this._objects.set(s,_)}const a=this._objects.get(s),o=[0,1,5,4,0,2,1,7,6,2,0,1,3,7,5,4,6,2,0],l=o.length,c=new Array(3*l),u=new Array,d=.5*this._gridSize;for(let f=0;f<l;f++)c[3*f+0]=e[0]+(1&o[f]?d:-d),c[3*f+1]=e[1]+(2&o[f]?d:-d),c[3*f+2]=e[2]+(4&o[f]?d:-d),f>0&&u.push(f-1,f);Ma(c,this._originSR,0,c,r.renderSpatialReference,0,l);const m=new jr([[P.POSITION,{size:3,data:c,exclusive:!0}]],[[P.POSITION,u]],Fc.Line);n.add(m),a.addGeometry(m,this._material,rn)}get test(){const e=this;return{set gridSize(t){e._gridSize=t}}}};const Cn=R();let AY=class{constructor(e,t,r,n=null){this.rctx=e,this.sliceHelper=n,this.lastFrameCamera=new yi,this.output=k.Color,this.renderOccludedMask=jU,this.bindParameters=new yR(t,r,y(n)?n.plane:null)}resetRenderOccludedMask(){this.renderOccludedMask=jU}},vTe=class extends AY{constructor(e,t,r,n,s){super(e,r,n,s),this.offscreenRenderingHelper=t,this.sliceHelper=s}};const jU=cr.Occlude|cr.OccludeAndTransparent|cr.OccludeAndTransparentStencil;var cv;(function(i){i[i.Highlight=0]="Highlight",i[i.Default=1]="Default"})(cv||(cv={}));let bC=class{constructor(){this.camera=new yi,this.lightMat=ve()}},f4=class{constructor(e,t){this._rctx=e,this._viewingMode=t,this._enabled=!1,this._snapshots=new Array,this._textureSize=0,this._numCascades=1,this._maxNumCascades=4,this._splitSchemeLambda=0,this._warp=!0,this._cascadeDistances=[0,0,0,0,0],this._usedCascadeDistances=_i(),this._cascades=[new bC,new bC,new bC,new bC],this._maxTextureSize=Math.min(St("esri-mobile")?2048:8192,this._rctx.parameters.maxTextureSize)}get depthTexture(){return this._depthTexture}get textureSize(){return this._textureSize}get numCascades(){return this._numCascades}get cascadeDistances(){return Qs(this._usedCascadeDistances,this._cascadeDistances[0],this._numCascades>1?this._cascadeDistances[1]:1/0,this._numCascades>2?this._cascadeDistances[2]:1/0,this._numCascades>3?this._cascadeDistances[3]:1/0)}dispose(){this._discardDepthTexture(),this._discardAllSnapshots()}set maxCascades(e){this._maxNumCascades=ce(Math.floor(e),1,4)}get maxCascades(){return this._maxNumCascades}set enabled(e){this._enabled=e,e||(this._discardDepthTexture(),this._discardAllSnapshots())}get enabled(){return this._enabled}get ready(){return this._enabled&&y(this._depthTexture)}getSnapshot(e){return this.enabled?this._snapshots[e]:null}getCascades(){for(let e=0;e<this._numCascades;++e)rM[e]=this._cascades[e];return rM.length=this._numCascades,rM}start(e,t,r){it(this.enabled),this._textureSize=this._computeTextureSize(e.fullWidth,e.fullHeight),this._ensureDepthTexture();const{near:n,far:s}=this._clampNearFar(r);this._computeCascadeDistances(s,n),this._setupMatrices(e,t);const a=e.viewMatrix,o=e.projectionMatrix;for(let l=0;l<this._numCascades;++l)this._constructCascade(l,o,a,t);this._lastOrigin=null,this.clear()}finish(e){it(this.enabled),this._rctx.bindFramebuffer(e)}getShadowMapMatrices(e){if(!this._lastOrigin||!Oc(e,this._lastOrigin)){this._lastOrigin=this._lastOrigin||R(),q(this._lastOrigin,e);for(let t=0;t<this._numCascades;++t){ru(t8,this._cascades[t].lightMat,e);for(let r=0;r<16;++r)i8[16*t+r]=t8[r]}}return i8}takeCascadeSnapshotTo(e,t){it(this.enabled);const r=this._ensureSnapshot(t);this._bindFbo();const n=this._rctx,s=n.bindTexture(r,Gi.TEXTURE_UNIT_FOR_UPDATES);n.gl.copyTexSubImage2D(vi.TEXTURE_2D,0,e.camera.viewport[0],e.camera.viewport[1],e.camera.viewport[0],e.camera.viewport[1],e.camera.viewport[2],e.camera.viewport[3]),n.bindTexture(s,Gi.TEXTURE_UNIT_FOR_UPDATES)}clear(){const e=this._rctx;this._bindFbo(),e.setClearColor(1,1,1,1),e.clearSafe(Ai.COLOR_BUFFER_BIT|Ai.DEPTH_BUFFER_BIT)}_computeTextureSize(e,t){const r=.5*Math.log(e*e+t*t)*Math.LOG2E,n=.35,s=2**Math.round(r+n);return Math.min(this._maxTextureSize,2*s)}_ensureDepthTexture(){if(y(this._depthTexture)&&this._depthTexture.descriptor.width===this._textureSize)return;this._discardDepthTexture();const e={target:vi.TEXTURE_2D,pixelFormat:yt.RGBA,dataType:qt.UNSIGNED_BYTE,wrapMode:si.CLAMP_TO_EDGE,samplingMode:Kt.NEAREST,flipped:!0,width:this._textureSize,height:this._textureSize};this._depthTexture=new Gi(this._rctx,e),this._fbo=new yn(this._rctx,{colorTarget:Vn.TEXTURE,depthStencilTarget:rs.DEPTH_RENDER_BUFFER,width:this._textureSize,height:this._textureSize},this._depthTexture)}_ensureSnapshot(e){let t=this._snapshots[e];if(y(t)&&t.descriptor.width===this._textureSize)return t;this._discardSnapshot(e);const r={target:vi.TEXTURE_2D,pixelFormat:yt.RGBA,dataType:qt.UNSIGNED_BYTE,wrapMode:si.CLAMP_TO_EDGE,samplingMode:Kt.NEAREST,flipped:!0,width:this._textureSize,height:this._textureSize};return t=new Gi(this._rctx,r),this._snapshots[e]=t,t}_discardDepthTexture(){this._fbo=Me(this._fbo),this._depthTexture=Me(this._depthTexture)}_discardSnapshot(e){this._snapshots[e]=Me(this._snapshots[e])}_discardAllSnapshots(){for(let e=0;e<this._snapshots.length;++e)this._discardSnapshot(e);this._snapshots.length=0}_bindFbo(){const e=this._rctx;e.unbindTexture(this._depthTexture),e.bindFramebuffer(this._fbo)}_constructCascade(e,t,r,n){const s=this._cascades[e],a=-this._cascadeDistances[e],o=-this._cascadeDistances[e+1],l=(t[10]*a+t[14])/Math.abs(t[11]*a+t[15]),c=(t[10]*o+t[14])/Math.abs(t[11]*o+t[15]);it(l<c);for(let d=0;d<8;++d){Qs(QU,d%4==0||d%4==3?-1:1,d%4==0||d%4==1?-1:1,d<4?l:c,1),sd(Xa[d],QU,XU);for(let m=0;m<3;++m)Xa[d][m]/=Xa[d][3]}Aa(iM,Xa[0]),ru(qU,e8,iM),s.camera.viewMatrix=qU;for(let d=0;d<8;++d)Ce(Xa[d],Xa[d],s.camera.viewMatrix);q(rh,Xa[0]),q(nh,Xa[0]);for(let d=1;d<8;++d)for(let m=0;m<3;++m)rh[m]=Math.min(rh[m],Xa[d][m]),nh[m]=Math.max(nh[m],Xa[d][m]);rh[2]-=200,nh[2]+=200,s.camera.near=-nh[2],s.camera.far=-rh[2],this._warp?this._constructTrapezoidalProjection(r,n,s):this._constructOrthogonalProjection(s),Hr(s.lightMat,s.camera.projectionMatrix,s.camera.viewMatrix);const u=this._textureSize/2;s.camera.viewport[0]=e%2==0?0:u,s.camera.viewport[1]=Math.floor(e/2)===0?0:u,s.camera.viewport[2]=u,s.camera.viewport[3]=u}_constructOrthogonalProjection(e){aG(e.camera.projectionMatrix,rh[0],nh[0],rh[1],nh[1],e.camera.near,e.camera.far)}_constructTrapezoidalProjection(e,t,r){const n=1/Xa[0][3],s=1/Xa[4][3];it(n<s);let a=n+Math.sqrt(n*s);const o=Math.sin(ls(e[2]*t[0]+e[6]*t[1]+e[10]*t[2]));a/=o,wTe(Xa,a,o,ZU,YU,bTe,KU,JU),xTe(ZU,YU,KU,JU,r.camera.projectionMatrix),r.camera.projectionMatrix[10]=2/(rh[2]-nh[2]),r.camera.projectionMatrix[14]=-(rh[2]+nh[2])/(rh[2]-nh[2])}_setupMatrices(e,t){Hr(WU,e.projectionMatrix,e.viewMatrix),kn(XU,WU);const r=this._viewingMode===Se.Global?e.eye:Z(iM,0,0,1);vD(e8,[0,0,0],[-t[0],-t[1],-t[2]],r)}_clampNearFar(e){let{near:t,far:r}=e;return t<2&&(t=2),r<2&&(r=2),t>=r&&(t=2,r=4),{near:t,far:r}}_computeCascadeDistances(e,t){this._numCascades=Math.min(1+Math.floor(Yne(e/t,4)),this._maxNumCascades);const r=(e-t)/this._numCascades,n=(e/t)**(1/this._numCascades);let s=t,a=t;for(let o=0;o<this._numCascades+1;++o)this._cascadeDistances[o]=dt(s,a,this._splitSchemeLambda),s*=n,a+=r}get gpuMemoryUsage(){var e;return this._snapshots.reduce((t,r)=>t+kE(r),((e=this._fbo)==null?void 0:e.gpuMemoryUsage)??0)}get test(){const e=this;return{maxNumCascades:this._maxNumCascades,cascades:this._cascades,textureSize:this._textureSize,set splitSchemeLambda(t){e._splitSchemeLambda=t},get splitSchemeLambda(){return e._splitSchemeLambda},set warp(t){e._warp=t},get warp(){return e._warp}}}};const qU=ve(),WU=ve(),XU=ve(),QU=_i(),Xa=[];for(let i=0;i<8;++i)Xa.push(_i());const rh=R(),nh=R(),ZU=be(),YU=be(),bTe=be(),KU=be(),JU=be(),e8=ve(),iM=R(),rM=[],t8=ve(),i8=new Float32Array(64),Ro=be(),V_=be(),uf=[be(),be(),be(),be()],Wr=be(),nM=be(),ap=be(),p1=be(),U_=be(),z_=be(),wC=be();function wTe(i,e,t,r,n,s,a,o){Je(Ro,0,0);for(let E=0;E<4;++E)yc(Ro,Ro,i[E]);qs(Ro,Ro,.25),Je(V_,0,0);for(let E=4;E<8;++E)yc(V_,V_,i[E]);qs(V_,V_,.25),Xf(uf[0],i[4],i[5],.5),Xf(uf[1],i[5],i[6],.5),Xf(uf[2],i[6],i[7],.5),Xf(uf[3],i[7],i[4],.5);let l=0,c=g5(uf[0],Ro);for(let E=1;E<4;++E){const C=g5(uf[E],Ro);C<c&&(c=C,l=E)}Pc(Wr,uf[l],i[l+4]);const u=Wr[0];let d,m;Wr[0]=-Wr[1],Wr[1]=u,Pc(nM,V_,Ro),Fr(nM,Wr)<0&&q7(Wr,Wr),Xf(Wr,Wr,nM,t),j0(Wr,Wr),d=m=Fr(Pc(ap,i[0],Ro),Wr);for(let E=1;E<8;++E){const C=Fr(Pc(ap,i[E],Ro),Wr);C<d?d=C:C>m&&(m=C)}wn(r,Ro),qs(ap,Wr,d-e),yc(r,r,ap);let f=-1,_=1,g=0,x=0;for(let E=0;E<8;++E){Pc(p1,i[E],r),j0(p1,p1);const C=Wr[0]*p1[1]-Wr[1]*p1[0];C>0?C>f&&(f=C,g=E):C<_&&(_=C,x=E)}w_(f>0,"leftArea"),w_(_<0,"rightArea"),qs(U_,Wr,d),yc(U_,U_,Ro),qs(z_,Wr,m),yc(z_,z_,Ro),wC[0]=-Wr[1],wC[1]=Wr[0];const b=cT(r,i[x],z_,yc(ap,z_,wC),1,n),v=cT(r,i[g],z_,ap,1,s),w=cT(r,i[g],U_,yc(ap,U_,wC),1,a),T=cT(r,i[x],U_,ap,1,o);w_(b,"rayRay"),w_(v,"rayRay"),w_(w,"rayRay"),w_(T,"rayRay")}function It(i,e){return 3*e+i}const r8=be();function ka(i,e){return Je(r8,i[e],i[e+3]),r8}const aa=be(),Ae=Or();function xTe(i,e,t,r,n){Pc(aa,t,r),qs(aa,aa,.5),Ae[0]=aa[0],Ae[1]=aa[1],Ae[2]=0,Ae[3]=aa[1],Ae[4]=-aa[0],Ae[5]=0,Ae[6]=aa[0]*aa[0]+aa[1]*aa[1],Ae[7]=aa[0]*aa[1]-aa[1]*aa[0],Ae[8]=1,Ae[It(0,2)]=-Fr(ka(Ae,0),i),Ae[It(1,2)]=-Fr(ka(Ae,1),i);let s=Fr(ka(Ae,0),t)+Ae[It(0,2)],a=Fr(ka(Ae,1),t)+Ae[It(1,2)],o=Fr(ka(Ae,0),r)+Ae[It(0,2)],l=Fr(ka(Ae,1),r)+Ae[It(1,2)];s=-(s+o)/(a+l),Ae[It(0,0)]+=Ae[It(1,0)]*s,Ae[It(0,1)]+=Ae[It(1,1)]*s,Ae[It(0,2)]+=Ae[It(1,2)]*s,s=1/(Fr(ka(Ae,0),t)+Ae[It(0,2)]),a=1/(Fr(ka(Ae,1),t)+Ae[It(1,2)]),Ae[It(0,0)]*=s,Ae[It(0,1)]*=s,Ae[It(0,2)]*=s,Ae[It(1,0)]*=a,Ae[It(1,1)]*=a,Ae[It(1,2)]*=a,Ae[It(2,0)]=Ae[It(1,0)],Ae[It(2,1)]=Ae[It(1,1)],Ae[It(2,2)]=Ae[It(1,2)],Ae[It(1,2)]+=1,s=Fr(ka(Ae,1),e)+Ae[It(1,2)],a=Fr(ka(Ae,2),e)+Ae[It(2,2)],o=Fr(ka(Ae,1),t)+Ae[It(1,2)],l=Fr(ka(Ae,2),t)+Ae[It(2,2)],s=-.5*(s/a+o/l),Ae[It(1,0)]+=Ae[It(2,0)]*s,Ae[It(1,1)]+=Ae[It(2,1)]*s,Ae[It(1,2)]+=Ae[It(2,2)]*s,s=Fr(ka(Ae,1),e)+Ae[It(1,2)],a=Fr(ka(Ae,2),e)+Ae[It(2,2)],o=-a/s,Ae[It(1,0)]*=o,Ae[It(1,1)]*=o,Ae[It(1,2)]*=o,n[0]=Ae[0],n[1]=Ae[1],n[2]=0,n[3]=Ae[2],n[4]=Ae[3],n[5]=Ae[4],n[6]=0,n[7]=Ae[5],n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=Ae[6],n[13]=Ae[7],n[14]=0,n[15]=Ae[8]}let OY=class{constructor(){this.adds=new Zt,this.removes=new Zt,this.updates=new Zt({allocator:e=>e||new TTe,deallocator:e=>(e.renderGeometry=null,e)})}clear(){this.adds.clear(),this.removes.clear(),this.updates.clear()}prune(){this.adds.prune(),this.removes.prune(),this.updates.prune()}},TTe=class{},CTe=class{constructor(){this.adds=new Array,this.removes=new Array,this.updates=new Array}};var Fi,Ur;(function(i){i[i.ADD=0]="ADD",i[i.UPDATE=1]="UPDATE",i[i.REMOVE=2]="REMOVE"})(Fi||(Fi={})),function(i){i[i.NONE=0]="NONE",i[i.VISIBILITIES=1]="VISIBILITIES",i[i.VERTEXATTRS=2]="VERTEXATTRS",i[i.TRANSFORMATION=4]="TRANSFORMATION",i[i.HIGHLIGHTS=8]="HIGHLIGHTS",i[i.OCCLUDEES=16]="OCCLUDEES"}(Ur||(Ur={}));function MY(i){const e=new Map,t=r=>{let n=e.get(r);return n||(n=new CTe,e.set(r,n)),n};return i.removes.forAll(r=>{sM(r)&&t(r.material).removes.push(r)}),i.adds.forAll(r=>{sM(r)&&t(r.material).adds.push(r)}),i.updates.forAll(r=>{sM(r.renderGeometry)&&t(r.renderGeometry.material).updates.push(r)}),e}function sM(i){return i.data.indexCount>=1}let IY=class{constructor(e,t){this._material=e,this._repository=t,this._map=new Map}destroy(){this._map.forEach((e,t)=>{y(e)&&this._repository.release(this._material,t)})}load(e,t,r){if(!this._material.requiresSlot(t,r))return null;this._map.has(r)||this._map.set(r,this._repository.acquire(this._material,t,r));const n=this._map.get(r);if(y(n)){if(n.ensureResources(e)===bS.LOADED)return n;this._repository.requestRender()}return null}},JL=class extends Bse{constructor(e=R()){super(),this.origin=e,this.slicePlaneLocalOrigin=this.origin}},LY=class $Y extends ti{initializeConfiguration(e,t){t.hasWebGL2Context=e.rctx.type===Nn.WEBGL2,t.spherical=e.viewingMode===Se.Global,t.doublePrecisionRequiresObfuscation=IP(e.rctx)}initializeProgram(e){return new Jt(e.rctx,$Y.shader.get().build(this.configuration),ai)}_setPipelineState(e){const t=this.configuration,r=e===Ht.NONE,n=e===Ht.FrontFace;return Ke({blending:t.output!==k.Normal&&t.output!==k.Highlight&&t.transparent?r?Hl:jm(e):null,depthTest:{func:i_(e)},depthWrite:r?t.writeDepth&&nl:LP(e),colorWrite:ht,polygonOffset:r||n?null:ND(t.enableOffset)})}initializePipeline(){return this._setPipelineState(this.configuration.transparencyPassType)}};LY.shader=new ii(Hre,()=>G(()=>import("./WaterSurface.glsl-3260bb79.js"),["assets/WaterSurface.glsl-3260bb79.js","assets/Matrix3PassUniform-ad9f953b.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/mat3f64-c6305894.js","assets/mat4f64-1e28eae0.js","assets/vec3f32-c9aa289f.js","assets/vec3f64-2f9cef06.js","assets/VertexAttribute-9c5c630d.js","assets/mat4-44a0988f.js","assets/common-c186b691.js","assets/vec3-e93e648f.js","assets/vec4f64-e407da96.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/Texture2DPassUniform-753de459.js","assets/vec4-790471c0.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/compilerUtils-18d58939.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/mathUtils-b4bb77e2.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/NormalUtils.glsl-c12729bf.js","assets/Ellipsoid-89682c5e.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js"]));let Pn=class extends cu{constructor(){super(...arguments),this.output=k.Color,this.transparencyPassType=Ht.NONE,this.spherical=!1,this.receiveShadows=!1,this.hasSlicePlane=!1,this.transparent=!1,this.enableOffset=!0,this.writeDepth=!1,this.hasScreenSpaceReflections=!1,this.doublePrecisionRequiresObfuscation=!1,this.hasCloudsReflections=!1,this.isDraped=!1,this.hasMultipassTerrain=!1,this.cullAboveGround=!1}};h([N({count:k.COUNT})],Pn.prototype,"output",void 0),h([N({count:Ht.COUNT})],Pn.prototype,"transparencyPassType",void 0),h([N()],Pn.prototype,"spherical",void 0),h([N()],Pn.prototype,"receiveShadows",void 0),h([N()],Pn.prototype,"hasSlicePlane",void 0),h([N()],Pn.prototype,"transparent",void 0),h([N()],Pn.prototype,"enableOffset",void 0),h([N()],Pn.prototype,"writeDepth",void 0),h([N()],Pn.prototype,"hasScreenSpaceReflections",void 0),h([N()],Pn.prototype,"doublePrecisionRequiresObfuscation",void 0),h([N()],Pn.prototype,"hasCloudsReflections",void 0),h([N()],Pn.prototype,"isDraped",void 0),h([N()],Pn.prototype,"hasMultipassTerrain",void 0),h([N()],Pn.prototype,"cullAboveGround",void 0),h([N({constValue:zr.Water})],Pn.prototype,"pbrMode",void 0),h([N({constValue:!0})],Pn.prototype,"useCustomDTRExponentForWater",void 0),h([N({constValue:!0})],Pn.prototype,"highStepCount",void 0),h([N({constValue:!1})],Pn.prototype,"useFillLights",void 0);let STe=class extends t_{_updateShadowState(e){e.shadowMap.enabled!==this._material.parameters.receiveShadows&&this._material.setParameters({receiveShadows:e.shadowMap.enabled})}_updateSSRState(e){e.ssr.enabled!==this._material.parameters.hasScreenSpaceReflections&&this._material.setParameters({hasScreenSpaceReflections:e.ssr.enabled})}_updateCloudsReflectionState(e){const t=y(e.cloudsFade.data);t!==this._material.parameters.hasCloudsReflections&&this._material.setParameters({hasCloudsReflections:t})}ensureResources(e){return this._techniqueRepository.constructionContext.waterTextureRepository.ensureResources(e)}beginSlot(e){return this._output===k.Color&&(this._updateShadowState(e),this._updateSSRState(e),this._updateCloudsReflectionState(e)),this._material.setParameters(this._techniqueRepository.constructionContext.waterTextureRepository.passParameters),this.ensureTechnique(LY,e)}};const ETe=sn().vec3f(P.POSITION),PTe=sn().vec3f(P.POSITION).vec2f(P.UV0),DY=sn().vec3f(P.POSITION).vec4u8(P.COLOR);sn().vec3f(P.POSITION).vec4u8(P.OBJECTANDLAYERIDCOLOR);sn().vec3f(P.POSITION).vec2f(P.UV0).vec4u8(P.OBJECTANDLAYERIDCOLOR);const RTe=sn().vec3f(P.POSITION).vec4u8(P.COLOR).vec4u8(P.OBJECTANDLAYERIDCOLOR);let LR=class{constructor(e){this.vertexBufferLayout=e}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){return e.indices.get(P.POSITION).length}write(e,t,r,n,s){kD(r,this.vertexBufferLayout,e,t,n,s)}},FY=class extends Fd{constructor(e){super(e,new NY),this._configuration=new Pn,this.animation=new $Q}getConfiguration(e,t){return this._configuration.output=e,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.receiveShadows=this.parameters.receiveShadows,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this.parameters.transparent,this._configuration.hasScreenSpaceReflections=this.parameters.hasScreenSpaceReflections,this._configuration.hasCloudsReflections=this.parameters.hasCloudsReflections,this._configuration.isDraped=this.parameters.isDraped,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration.enableOffset=t.camera.relativeElevation<VD,this._configuration.hasMultipassTerrain=t.multipassTerrain.enabled,this._configuration.cullAboveGround=t.multipassTerrain.cullAboveGround,this._configuration}update(e){const t=Math.min(e.camera.relativeElevation,e.camera.distance);this.animation.enabled=Math.sqrt(this.parameters.waveTextureRepeat/this.parameters.waveStrength)*t<ATe;const r=this.animation.advance(e);return this.setParameters({timeElapsed:Q$(this.animation.time)*this.parameters.animationSpeed},!1),this.animation.enabled&&r}intersect(e,t,r,n,s,a,o){MD(e,t,n,s,a,void 0,o)}requiresSlot(e,t){switch(t){case k.Normal:return e===ae.DRAPED_WATER;case k.Color:if(this.parameters.isDraped)return e===ae.DRAPED_MATERIAL;break;case k.Alpha:break;case k.Highlight:return e===ae.OPAQUE_MATERIAL||e===ae.DRAPED_MATERIAL;default:return!1}let r=ae.OPAQUE_MATERIAL;return this.parameters.transparent&&(r=this.parameters.writeDepth?ae.TRANSPARENT_MATERIAL:ae.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL),e===r}createGLMaterial(e){return new STe(e)}createBufferWriter(){return new LR(PTe)}},NY=class extends Vx{constructor(){super(...arguments),this.waveStrength=.06,this.waveTextureRepeat=32,this.waveDirection=Xt(1,0),this.waveVelocity=.05,this.flowStrength=.015,this.flowOffset=-.5,this.animationSpeed=.35,this.timeElapsed=0,this.color=Bi(0,0,0,0),this.transparent=!0,this.writeDepth=!0,this.hasSlicePlane=!1,this.isDraped=!1,this.receiveShadows=!0,this.hasScreenSpaceReflections=!1,this.hasCloudsReflections=!1}};const ATe=35e3;let xC=class{constructor(){this.first=0,this.count=0}},Ay=class{constructor(e=0,t=0){this.from=e,this.to=t}},OTe=class extends Ay{constructor(e,t,r,n,s,a){super(t,r),this.id=e,this.isVisible=n,this.hasHighlights=s,this.hasOccludees=a}};function n8(i){return Array.from(i.values()).sort(MTe)}function MTe(i,e){return i.from===e.from?i.to-e.to:i.from-e.from}function TC(i,e){const t=i.back();if(t==null){const r=i.pushNew();return r.first=e.from,void(r.count=e.to-e.from)}if(ITe(t,e)){const r=e.from-t.first+e.to-e.from;t.count=r}else{const r=i.pushNew();r.first=e.from,r.count=e.to-e.from}}function ITe(i,e){return i.first+i.count>=e.from}let LTe=class{constructor(e,t){this._pool=e,this._size=0,this._buffer=e.newBuffer(t$(t))}dispose(){this._buffer=this._pool.deleteBuffer(this._buffer),this._size=0}release(){this.erase(0,this._size),this.dispose()}get buffer(){return this._buffer}get size(){return this._size}grow(e){this._resize(this._size+e,!0).dispose()}allocate(e){return this._resize(e,!1)}_resize(e,t){let r;const n=$Te(this._buffer.length,this._size,e);if(this._buffer.length!==n){const a=this._pool.newBuffer(n);t&&(a.array.set(this._buffer.array.subarray(0,Math.min(this._size,n))),a.vao.vertexBuffers.geometry.setSubData(a.array,0,0,a.array.length)),r=this._buffer,this._buffer=a}const s=this._size;return this._size=e,r?{dispose:()=>{r.array.fill(0,0,s),this._pool.deleteBuffer(r)},copy:(a,o,l)=>this._buffer.array.set(r.array.subarray(o,l),a),hasNewBuffer:!0}:{dispose:()=>{},copy:(a,o,l)=>{a!==o&&this._buffer.array.copyWithin(a,o,l)},hasNewBuffer:!1}}erase(e,t){this._buffer.array.fill(0,e,t)}};const e$=65536;function t$(i){return Math.ceil(i/e$)*e$}function $Te(i,e,t){return e<=t?i>=t?i:t$(Math.max(2*i,t)):i<=2*t?i:t$(t)}let DTe=class{constructor(e,t,r,n){this.vao=new nu(e,t,{geometry:r},{geometry:hi.createVertex(e,di.STATIC_DRAW)}),this.array=new Float32Array(n),this.vao.vertexBuffers.geometry.setSize(this.array.byteLength)}dispose(){this.vao.dispose(!0)}get length(){return this.array.length}};const FTe=Qse+1;let NTe=class{constructor(e,t,r){this._rctx=e,this._locations=t,this._layout=r,this._cache=e.newCache(`MergedRenderer pool ${Cm()}`,kTe)}dispose(){this._cache.destroy()}newBuffer(e){const t=e.toString(),r=this._cache.pop(t);if(y(r)){const n=r.pop();return r.length>0&&this._cache.put(t,r,n.array.byteLength*r.length,FTe),n}return new DTe(this._rctx,this._locations,this._layout,e)}deleteBuffer(e){const t=e.array.byteLength,r=e.array.length.toString(),n=this._cache.pop(r);return y(n)?(n.push(e),this._cache.put(r,n,t*n.length,-1)):this._cache.put(r,[e],t,-1),null}};function kTe(i,e){if(e===Xse.ALL)return void i.forEach(n=>n.dispose());const t=i.pop(),r=i.length*t.array.byteLength;return t.dispose(),r}let kY=class{constructor(e,t,r){this._rctx=e,this._materialRepository=t,this._material=r,this.type="MergedRenderer",this._dataByOrigin=new Map,this._renderCommandData=new Zt,this._hasHighlights=!1,this._hasOccludees=!1,this._glMaterials=new IY(this._material,this._materialRepository),this._bufferWriter=r.createBufferWriter(),this._bufferPool=new NTe(e,r.vertexAttributeLocations,Wc(this._bufferWriter.vertexBufferLayout))}dispose(){this._glMaterials.destroy(),this._dataByOrigin.forEach(e=>e.geometry.dispose()),this._dataByOrigin.clear(),this._bufferPool.dispose()}get isEmpty(){return this._dataByOrigin.size===0}get hasHighlights(){return this._hasHighlights}get hasOccludees(){return this._hasOccludees}get hasWater(){return!this.isEmpty&&this._material instanceof FY}get rendersOccluded(){return!this.isEmpty&&this._material.renderOccluded!==cr.Occlude}modify(e){this._updateGeometries(e.updates),this._addAndRemoveGeometries(e.adds,e.removes),this._updateDrawCommands()}_addAndRemoveGeometries(e,t){const r=this._bufferWriter,n=r.vertexBufferLayout.stride/4,s=this._dataByOrigin,a=UTe(e,t);a.forEach((o,l)=>{a.delete(l);const c=o.add.reduce((b,v)=>b+r.elementCount(v.data),0);let u=s.get(l);if(u==null)it(o.remove.length===0),u=new BTe(o.origin,new LTe(this._bufferPool,c*n)),s.set(l,u);else if(o.add.length===0&&u.instances.size===o.remove.length)return u.geometry.dispose(),void s.delete(l);let d=0;u.instances.forEach(b=>d+=b.to-b.from);const m=o.remove.reduce((b,v)=>b+r.elementCount(v.data),0),f=u.geometry.size,_=(d+c-m)*n,g=HTe;if(_>e$&&(_<f/2||f-_>1048576)?this._removeAndRebuild(u,o.remove,n,_,g):o.remove.length>0&&this._remove(u,o.remove,n,g),o.add.length>0){const b=jTe;Kne(b,-o.origin[0],-o.origin[1],-o.origin[2]),this._add(u,o.add,n,b,g)}const x=u.geometry.buffer.vao.vertexBuffers.geometry;o8(g),g.forAll(({from:b,to:v})=>{if(b<v){const w=u.geometry.buffer.array;x.setSubData(w,b,b,v)}}),g.clear(),u.drawCommandsDirty=!0})}_updateGeometries(e){const t=this._bufferWriter,r=t.vertexBufferLayout.stride/4;for(const n of e){const s=n.renderGeometry,a=this._dataByOrigin.get(s.origin.id),o=a&&a.instances.get(s.id);if(!o)return;const l=n.updateType;if(l&Ur.VISIBILITIES&&(o.isVisible=s.instanceParameters.visible),l&(Ur.HIGHLIGHTS|Ur.VISIBILITIES)){const c=s.instanceParameters.visible;o.hasHighlights=!!s.instanceParameters.highlights&&c}if(l&Ur.OCCLUDEES&&(o.hasOccludees=!!s.instanceParameters.occludees),l&(Ur.VERTEXATTRS|Ur.TRANSFORMATION)){const{array:c,vao:u}=a.geometry.buffer;rne(s,aM,m1),t.write(aM,m1,s.data,t.vertexBufferLayout.createView(c.buffer),o.from),it(o.from+t.elementCount(s.data)===o.to,"material VBO layout has changed"),u.vertexBuffers.geometry.setSubData(c,o.from*r,o.from*r,o.to*r)}a.drawCommandsDirty=!0}}_updateDrawCommands(){this._hasHighlights=!1,this._hasOccludees=!1,this._dataByOrigin.forEach(t=>{t.hasHiddenInstances=!1,t.hasHighlights=!1,t.hasOccludees=!1,Er(t.instances,r=>(r.isVisible?(r.hasHighlights&&(this._hasHighlights=!0,t.hasHighlights=!0),r.hasOccludees&&(this._hasOccludees=!0,t.hasOccludees=!0)):t.hasHiddenInstances=!0,t.hasHiddenInstances&&t.hasHighlights&&t.hasOccludees))});const e=t=>{if(t.drawCommandsDefault.clear(),t.drawCommandsHighlight.clear(),t.drawCommandsOccludees.clear(),t.drawCommandsShadowHighlightRest.clear(),t.instances.size===0)return;if(!a8(t)){const n=t.drawCommandsDefault.pushNew();return n.first=1/0,n.count=0,t.instances.forEach(s=>{n.first=Math.min(n.first,s.from),n.count=Math.max(n.count,s.to)}),void(n.count-=n.first)}const r=n8(t.instances);for(const n of r)n.isVisible&&(n.hasOccludees?TC(t.drawCommandsOccludees,n):TC(t.drawCommandsDefault,n),n.hasHighlights?TC(t.drawCommandsHighlight,n):TC(t.drawCommandsShadowHighlightRest,n))};this._dataByOrigin.forEach(t=>{t.drawCommandsDirty&&(e(t),t.drawCommandsDirty=!1)})}updateAnimation(e){return this._material.update(e)}requiresSlot(e,t){return this._material.requiresSlot(e,t)}render(e,t){if(!this.requiresSlot(t.slot,e))return!1;const r=e===k.Highlight||e===k.ShadowHighlight;if(r&&!this._hasHighlights)return!1;const n=e===k.ShadowExludeHighlight,s=!(r||n);if(this._dataByOrigin.forEach(u=>{if(r&&!u.hasHighlights)return;const d=(r?u.drawCommandsHighlight:n&&a8(u)?u.drawCommandsShadowHighlightRest:u.drawCommandsDefault)||null,m=s&&u.drawCommandsOccludees||null;(d!=null&&d.length||m!=null&&m.length)&&this._renderCommandData.push(new GTe(u.origin,u.geometry,d,m))}),this._renderCommandData.length===0)return!1;const a=this._rctx,o=this._glMaterials.load(a,t.slot,e);if(S(o))return this._renderCommandData.clear(),!1;const l=o.beginSlot(t),c=a.bindTechnique(l,this._material.parameters,t);return this._renderCommandData.forAll(u=>{c.bindDraw(u,t,this._material.parameters);const{geometry:d,renderCommands:m,occludeeCommands:f}=u;l.ensureAttributeLocations(d.buffer.vao),a.bindVAO(d.buffer.vao);const _=l.primitiveType;y(m)&&m.length>0&&(l.bindPipelineState(a,t.slot,!1),m.forAll(g=>a.drawArrays(_,g.first,g.count))),y(f)&&f.length>0&&(l.bindPipelineState(a,t.slot,!0),f.forAll(g=>a.drawArrays(_,g.first,g.count)))}),this._renderCommandData.clear(),!0}_removeAndRebuild(e,t,r,n,s){for(const u of t)e.instances.delete(u.id);const a=n8(e.instances);e.instances.clear();const o=e.geometry.size,l=e.geometry.allocate(n);let c=0;for(const u of a){const d=u.from*r,m=u.to*r;l.copy(c,d,m),u.from=c/r,c+=m-d,u.to=c/r,e.instances.set(u.id,u)}s.push(new Ay(0,l.hasNewBuffer?e.geometry.buffer.array.length:o)),l.dispose(),e.geometry.erase(c,s.back().to),e.holes.clear()}_remove(e,t,r,n){for(const s of t){const a=s.id,o=e.instances.get(a),l=o.from*r,c=o.to*r;e.geometry.erase(l,c),e.holes.push(new Ay(o.from,o.to)),e.instances.delete(a),n.push(new Ay(l,c))}o8(e.holes)}_add(e,t,r,n,s){if(t.length===0)return;const a=this._bufferWriter;let o=a.vertexBufferLayout.createView(e.geometry.buffer.array.buffer);const l=e.holes.length>0;let c=Number.MAX_SAFE_INTEGER,u=Number.MIN_SAFE_INTEGER;for(const d of t){const m=y(d.transformation)?Hr(aM,n,d.transformation):n;kn(m1,m);const f=yD(m1,m1),_=a.elementCount(d.data),g=_*r;let x=zTe(e.holes,_);S(x)&&(x=e.geometry.size/r,e.geometry.grow(g),o=a.vertexBufferLayout.createView(e.geometry.buffer.array.buffer)),a.write(m,f,d.data,o,x);const b=d.instanceParameters.visible,v=!!d.instanceParameters.highlights&&b,w=!!d.instanceParameters.occludees,T=new OTe(d.id,x,x+_,b,v,w);it(e.instances.get(d.id)==null),e.instances.set(d.id,T),l?s.push(new Ay(T.from*r,T.to*r)):(c=Math.min(T.from,c),u=Math.max(T.to,u))}l||s.push(new Ay(c*r,u*r))}get test(){return{material:this._material,glMaterials:this._glMaterials,dataByOrigin:this._dataByOrigin}}},VTe=class{constructor(e){this.origin=e,this.add=new Array,this.remove=new Array}};function UTe(i,e){const t=new Map;for(const r of i)s8(t,r,!0);for(const r of e)s8(t,r,!1);return t}function s8(i,e,t){const r=e.origin;if(S(r))return;let n=i.get(r.id);n==null&&(n=new VTe(r.vec3),i.set(r.id,n)),t?n.add.push(e):n.remove.push(e)}function a8(i){return i.hasOccludees||i.hasHighlights||i.hasHiddenInstances}function zTe(i,e){let t;if(!i.some(n=>!(n.to-n.from<e)&&(t=n,!0)))return null;const r=t.from;return t.from+=e,t.from>=t.to&&i.removeUnordered(t),r}function o8(i){const e=new Map;i.forAll(r=>e.set(r.from,r));let t=!0;for(;t;)t=!1,i.forEach(r=>{const n=e.get(r.to);n&&(r.to=n.to,e.delete(n.from),i.removeUnordered(n),t=!0)})}let BTe=class{constructor(e,t){this.origin=e,this.geometry=t,this.instances=new Map,this.holes=new Zt({deallocator:null}),this.hasHiddenInstances=!1,this.hasHighlights=!1,this.hasOccludees=!1,this.drawCommandsDirty=!1,this.drawCommandsDefault=new Zt({allocator:r=>r||new xC,deallocator:r=>r}),this.drawCommandsHighlight=new Zt({allocator:r=>r||new xC,deallocator:r=>r}),this.drawCommandsOccludees=new Zt({allocator:r=>r||new xC,deallocator:r=>r}),this.drawCommandsShadowHighlightRest=new Zt({allocator:r=>r||new xC,deallocator:r=>r})}},GTe=class extends JL{constructor(e,t,r,n){super(e),this.geometry=t,this.renderCommands=r,this.occludeeCommands=n}};const HTe=new Zt({deallocator:null}),jTe=ve(),aM=ve(),m1=ve();let Oh=class extends ue{constructor(e){super(e),this._pending=new qTe,this._changes=new OY,this._materialRenderers=new Map,this._sortedMaterialRenderers=new Zt,this._geometries=new Map,this._hasHighlights=!1,this._hasWater=!1}destroy(){this._changes.prune(),this._materialRenderers.forEach(e=>e.dispose()),this._materialRenderers.clear(),this._sortedMaterialRenderers.clear(),this._geometries.clear()}get updating(){return!this._pending.empty||this._changes.updates.length>0}get rctx(){return this.rendererContext.rctx}get _materialRepository(){return this.rendererContext.materialRepository}get _localOriginFactory(){return this.rendererContext.localOriginFactory}get hasHighlights(){return this._hasHighlights}get hasWater(){return this._hasWater}get rendersOccluded(){return Er(this._materialRenderers,e=>e.rendersOccluded)}get isEmpty(){return!this.updating&&this._materialRenderers.size===0&&this._geometries.size===0}commitChanges(){if(!this.updating)return!1;this._processAddsRemoves();const e=MY(this._changes);let t=!1,r=!1,n=!1;return e.forEach((s,a)=>{let o=this._materialRenderers.get(a);if(!o&&s.adds.length>0&&(o=new kY(this.rctx,this._materialRepository,a),this._materialRenderers.set(a,o),t=!0,r=!0,n=!0),!o)return;const l=r||o.hasHighlights,c=n||o.hasWater;o.modify(s),r=r||l!==o.hasHighlights,n=n||c!==o.hasWater,o.isEmpty&&(this._materialRenderers.delete(a),o.dispose(),t=!0)}),this._changes.clear(),t&&this._updateSortedMaterialRenderers(),r&&(this._hasHighlights=Er(this._materialRenderers,s=>s.hasHighlights)),n&&(this._hasWater=Er(this._materialRenderers,s=>s.hasWater)),this.notifyChange("updating"),!0}addGeometries(e,t){if(e.length===0)return;const r=this._validateRenderGeometries(e);for(const s of r)this._geometries.set(s.id,s);const n=this._pending.empty;for(const s of r)this._pending.adds.add(s);n&&this.notifyChange("updating"),t===Fi.UPDATE&&this._notifyGraphicGeometryChanged(e)}removeGeometries(e,t){const r=this._pending.empty,n=this._pending.adds;for(const s of e)n.has(s)?(this._pending.removed.add(s),n.delete(s)):this._pending.removed.has(s)||this._pending.removes.add(s),this._geometries.delete(ct(s.id));r&&!this._pending.empty&&this.notifyChange("updating"),t===Fi.UPDATE&&this._notifyGraphicGeometryChanged(e)}modifyGeometries(e,t){const r=this._changes.updates.length===0;for(const n of e){const s=this._changes.updates.pushNew();s.renderGeometry=this._validateRenderGeometry(n),s.updateType=t}switch(r&&this._changes.updates.length>0&&this.notifyChange("updating"),t){case Ur.TRANSFORMATION:case Ur.VERTEXATTRS:return this._notifyGraphicGeometryChanged(e);case Ur.VISIBILITIES:return this._notifyGraphicVisibilityChanged(e)}}updateAnimation(e){let t=!1;return this._sortedMaterialRenderers.forAll(({materialRenderer:r})=>t=r.updateAnimation(e)||t),t}render(e,t){for(let r=0;r<this._sortedMaterialRenderers.length;r++){const n=this._sortedMaterialRenderers.data[r];n.material.shouldRender(e)&&n.materialRenderer.render(e.output,t)}}intersect(e,t,r,n,s){return this._geometries.forEach(a=>{if(n&&!n(a))return;this._intersectRenderGeometry(a,r,t,0,e,s);const o=this.rendererContext.longitudeCyclical;o&&(a.boundingSphere[0]-a.boundingSphere[3]<o.min&&this._intersectRenderGeometry(a,r,t,o.range,e,s),a.boundingSphere[0]+a.boundingSphere[3]>o.max&&this._intersectRenderGeometry(a,r,t,-o.range,e,s)),s++}),s}_updateSortedMaterialRenderers(){this._sortedMaterialRenderers.clear();let e=0;this._materialRenderers.forEach((t,r)=>{r.insertOrder=e++,this._sortedMaterialRenderers.push({material:r,materialRenderer:t})}),this._sortedMaterialRenderers.sort((t,r)=>{const n=r.material.renderPriority-t.material.renderPriority;return n!==0?n:t.material.insertOrder-r.material.insertOrder})}_processAddsRemoves(){this._changes.adds.clear(),this._changes.removes.clear(),this._changes.adds.pushArray(Array.from(this._pending.adds)),this._changes.removes.pushArray(Array.from(this._pending.removes));for(let e=0;e<this._changes.updates.length;){const t=this._changes.updates.data[e];this._pending.has(t.renderGeometry)?this._changes.updates.removeUnorderedIndex(e):e++}this._pending.clear()}_intersectRenderGeometry(e,t,r,n,s,a){if(!e.instanceParameters.visible)return;let o=0;y(e.transformation)&&(n+=e.transformation[12],o=e.transformation[13]),CC[0]=r[0]-n,CC[1]=r[1]-o,CC[2]=1,SC[0]=r[0]-n,SC[1]=r[1]-o,SC[2]=0,e.screenToWorldRatio=this.rendererContext.screenToWorldRatio,e.material.intersect(e,null,e.getShaderTransformation(),s,CC,SC,(l,c,u)=>{WTe(t,u,e.material.renderPriority,a,s,e.layerUid,e.graphicUid)},e.calculateShaderTransformation,t)}_notifyGraphicGeometryChanged(e){if(S(this.drapeSource.notifyGraphicGeometryChanged))return;let t;for(const r of e){const n=r.graphicUid;y(n)&&n!==t&&(this.drapeSource.notifyGraphicGeometryChanged(n),t=n)}}_notifyGraphicVisibilityChanged(e){if(S(this.drapeSource.notifyGraphicVisibilityChanged))return;let t;for(const r of e){const n=r.graphicUid;y(n)&&n!==t&&(this.drapeSource.notifyGraphicVisibilityChanged(n),t=n)}}_validateRenderGeometries(e){for(const t of e)this._validateRenderGeometry(t);return e}_validateRenderGeometry(e){return S(e.origin)&&(e.origin=this._localOriginFactory.getOrigin(e.boundingSphere)),e}get test(){return{sortedMaterialRenderers:this._sortedMaterialRenderers}}};h([p()],Oh.prototype,"drapeSource",void 0),h([p()],Oh.prototype,"updating",null),h([p()],Oh.prototype,"rctx",null),h([p()],Oh.prototype,"rendererContext",void 0),h([p()],Oh.prototype,"_materialRepository",null),h([p()],Oh.prototype,"_localOriginFactory",null),Oh=h([D("esri.views.3d.webgl-engine.lib.SortedRenderGeometryRenderer")],Oh);let qTe=class{constructor(){this.adds=new Set,this.removes=new Set,this.removed=new Set}get empty(){return this.adds.size===0&&this.removes.size===0&&this.removed.size===0}has(e){return this.adds.has(e)||this.removes.has(e)||this.removed.has(e)}clear(){this.adds.clear(),this.removes.clear(),this.removed.clear()}};function WTe(i,e,t,r,n,s,a){const o={layerUid:s,graphicUid:a,triangleNr:e},l=c=>{c.set(Ui.OVERLAY,o,i.dist,i.normal,i.transformation,t,r)};if((n.results.min.drapedLayerOrder==null||t>=n.results.min.drapedLayerOrder)&&(n.results.min.dist==null||n.results.ground.dist<=n.results.min.dist)&&l(n.results.min),n.options.store!==zn.MIN&&(n.results.max.drapedLayerOrder==null||t<n.results.max.drapedLayerOrder)&&(n.results.max.dist==null||n.results.ground.dist>n.results.max.dist)&&l(n.results.max),n.options.store===zn.ALL){const c=NN(n.ray);l(c),n.results.all.push(c)}}const CC=R(),SC=R();let g4=class VY extends ti{initializeProgram(e){return new Jt(e.rctx,VY.shader.get().build(),ai)}initializePipeline(){return this.configuration.hasAlpha?Ke({blending:Gn(de.SRC_ALPHA,de.ONE,de.ONE_MINUS_SRC_ALPHA,de.ONE_MINUS_SRC_ALPHA),colorWrite:ht}):Ke({colorWrite:ht})}};g4.shader=new ii(Dse,()=>G(()=>import("./TextureOnly.glsl-18ace1e6.js"),["assets/TextureOnly.glsl-18ace1e6.js","assets/vec4f64-e407da96.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/VertexAttribute-9c5c630d.js","assets/vec2-528adfe4.js","assets/common-c186b691.js","assets/vec2f64-30dc1443.js","assets/Texture2DPassUniform-753de459.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/ScreenSpacePass-d5e48a9b.js","assets/Float4PassUniform-d7bdbc81.js"]));let _4=class extends $a{constructor(){super(...arguments),this.hasAlpha=!1}};h([N()],_4.prototype,"hasAlpha",void 0);let wh=class extends MR(ue){constructor(e){super(e),this._overlays=null,this._overlayRenderTarget=null,this._hasHighlights=!1,this._rendersOccluded=!1,this._hasWater=!1,this._handles=new Ft,this._renderers=new Map,this._sortedDrapeSourceRenderersDirty=!1,this._sortedRenderers=new Zt,this._passParameters=new Fse,this._rctx=null,this._materialRepository=null,this._screenToWorldRatio=1,this._localOriginFactory=null,this.worldToPCSRatio=1,this.events=new nn,this.longitudeCyclical=null}get _bindParameters(){return this._renderContext.bindParameters}get rctx(){return this._rctx}get materialRepository(){return this._materialRepository}get screenToWorldRatio(){return this._screenToWorldRatio}get localOriginFactory(){return this._localOriginFactory}initialize(){const e=this.view._stage.renderView;this._rctx=e.renderingContext;const t=e.waterTextureRepository;this._stippleTextureRepository=new oH(e.renderingContext),this._shaderTechniqueRepository=new xY({rctx:this._rctx,viewingMode:Se.Local,stippleTextureRepository:this._stippleTextureRepository,waterTextureRepository:t}),this._renderContext=new AY(this._rctx,new f4(this._rctx,this.view.state.viewingMode),new TG(this._shaderTechniqueRepository,this._rctx,()=>{})),this._handles.add([z(()=>t.updating,()=>this.events.emit("content-changed"),Oi),z(()=>this.spatialReference,r=>this._localOriginFactory=new m4(r),Oi),wr(()=>this.view.allLayerViews,"after-changes",()=>this._sortedDrapeSourceRenderersDirty=!0)]),this._materialRepository=new TY(e.textureRepository,this._shaderTechniqueRepository,r=>{(r.renderOccluded&rP)>0!==this._rendersOccluded&&this._updateRendersOccluded(),this.events.emit("content-changed"),this.notifyChange("updating")},()=>this.events.emit("content-changed")),this._bindParameters.slot=ae.DRAPED_MATERIAL,this._bindParameters.highlightDepthTexture=RG(this._rctx),this._bindParameters.camera=ug,this._bindParameters.transparencyPassType=Ht.NONE,this._bindParameters.newLighting.noonFactor=0,this._bindParameters.newLighting.globalFactor=0,this._bindParameters.newLighting.set([new xG(Ge(1,1,1))]),this._handles.add(this.view.resourceController.scheduler.registerTask(dr.STAGE,this))}dispose(){this._handles.destroy(),this._renderers.forEach(e=>e.destroy()),this._renderers.clear(),this._debugTextureTechnique=Qi(this._debugTextureTechnique),this._passParameters.texture=Me(this._passParameters.texture),this._bindParameters.highlightDepthTexture=Me(this._bindParameters.highlightDepthTexture),this._shaderTechniqueRepository=Me(this._shaderTechniqueRepository),this._temporaryFBO=Me(this._temporaryFBO),this._quadVAO=Me(this._quadVAO),this.disposeOverlays()}get updating(){return this._sortedDrapeSourceRenderersDirty||Er(this._renderers,e=>e.updating)}get hasOverlays(){return y(this._overlays)&&y(this._overlayRenderTarget)}get gpuMemoryUsage(){return y(this._overlayRenderTarget)?this._overlayRenderTarget.gpuMemoryUsage:0}createGeometryDrapeSourceRenderer(e){return this.createDrapeSourceRenderer(e,Oh)}createDrapeSourceRenderer(e,t,r){const n=this._renderers.get(e);y(n)&&n.destroy();const s=new t({...r,rendererContext:this,drapeSource:e});return this._renderers.set(e,s),this._sortedDrapeSourceRenderersDirty=!0,"fullOpacity"in e&&this._handles.add(z(()=>e.fullOpacity,()=>this.events.emit("content-changed")),e),s}removeDrapeSourceRenderer(e){if(S(e))return;const t=this._renderers.get(e);S(t)||(this._sortedDrapeSourceRenderersDirty=!0,this._renderers.delete(e),this._handles.remove(e),t.destroy())}collectUnusedRenderTargetMemory(e){let t=!1;if(y(this._overlayRenderTarget))for(const r of this._overlayRenderTarget.renderTargets){const n=this.overlays[0].validTargets[r.type]||!this.overlays[1].validTargets[r.type];t=this._overlayRenderTarget.validateUsageForTarget(n,r,e)||t}return t}get overlays(){return je(this._overlays,[])}ensureDrapeTargets(e){y(this._overlays)&&this._overlays.forEach(t=>t.hasTargetWithoutRasterImage=ZR(e,r=>r.drapeTargetType===YL.WithoutRasterImage))}ensureDrapeSources(e){y(this._overlays)&&this._overlays.forEach(t=>{t.hasDrapedFeatureSource=ZR(e,r=>r.drapeSourceType===ew.Features),t.hasDrapedRasterSource=ZR(e,r=>r.drapeSourceType===ew.RasterImage)})}ensureOverlays(e,t){S(this._overlays)&&(this._overlayRenderTarget=new iTe(this._rctx),this._overlays=[new VU(ki.INNER,this._overlayRenderTarget),new VU(ki.OUTER,this._overlayRenderTarget)]),this.ensureDrapeTargets(e),this.ensureDrapeSources(t)}disposeOverlays(){this._overlays=null,this._overlayRenderTarget=Me(this._overlayRenderTarget),this.events.emit("textures-disposed")}get running(){return this.updating}runTask(e){this._processDrapeSources(e,()=>!0)}_processDrapeSources(e,t){let r=!1;for(const[n,s]of this._renderers){if(e.done)break;(n.destroyed||t(n))&&s.commitChanges()&&(r=!0,e.madeProgress())}this._sortedDrapeSourceRenderersDirty&&(this._sortedDrapeSourceRenderersDirty=!1,r=!0,this._updateSortedDrapeSourceRenderers()),r&&(y(this._overlays)&&this._renderers.size===0&&this.disposeOverlays(),this.notifyChange("updating"),this.events.emit("content-changed"),this._updateHasHighlights(),this._updateRendersOccluded(),this._updateHasWater())}processSyncDrapeSources(){this._processDrapeSources(CP,e=>e.updatePolicy===zE.SYNC)}isEmpty(){if(jt.OVERLAY_DRAW_DEBUG_TEXTURE)return!1;for(const e of this._renderers.values())if(!e.isEmpty)return!1;return!0}get hasHighlights(){return this._hasHighlights}get hasWater(){return this._hasWater}get rendersOccluded(){return this._rendersOccluded}updateAnimation(e){let t=!1;return this._renderers.forEach(r=>t=r.updateAnimation(e)||t),t}updateDrapeSourceOrder(){this._sortedDrapeSourceRenderersDirty=!0}drawTarget(e,t,r){const n=e.canvasGeometries;if(n.numViews===0)return!1;this._screenToWorldRatio=r*e.mapUnitsPerPixel;const s=t.output;if(this.isEmpty()||s===k.Highlight&&!this.hasHighlights||s===k.Normal&&!this.hasWater||!e.hasSomeSizedView())return!1;const a=t.fbo;if(!a.isValid())return!1;const o=2*e.resolution,l=e.resolution;a.resize(o,l);const c=this._rctx;ug.pixelRatio=e.pixelRatio*r,this._renderContext.output=s,this._bindParameters.screenToWorldRatio=this._screenToWorldRatio,this._bindParameters.screenToPCSRatio=this._screenToWorldRatio*this.worldToPCSRatio,this._bindParameters.slot=s===k.Normal?ae.DRAPED_WATER:ae.DRAPED_MATERIAL,e.applyViewport(this._rctx),a.bind(c),e.index===ki.INNER&&(c.setClearColor(0,0,0,0),c.clearSafe(Ai.COLOR_BUFFER_BIT));const u=t.type===er.ColorNoRasterImage?jp.ExcludeRasterImage:t.type===er.Occluded?jp.OccludedOnly:jp.Normal;if(u===jp.OccludedOnly&&(this._renderContext.renderOccludedMask=rP),jt.OVERLAY_DRAW_DEBUG_TEXTURE&&u!==jp.OccludedOnly)for(let d=0;d<n.numViews;d++)this._setViewParameters(n.extents[d],e,ug),this._drawDebugTexture(e.resolution,QTe[e.index]);return this._renderers.size>0&&this._sortedRenderers.forAll(({drapeSource:d,renderer:m})=>{if(u===jp.ExcludeRasterImage&&d.drapeSourceType===ew.RasterImage)return;const{fullOpacity:f}=d,_=y(f)&&f<1&&s===k.Color;_&&(this.bindTemporaryFramebuffer(this._rctx,o,l),c.clearSafe(Ai.COLOR_BUFFER_BIT));for(let g=0;g<n.numViews;g++)this._setViewParameters(n.extents[g],e,ug),m.render(this._renderContext,this._bindParameters);_&&y(this._temporaryFBO)&&(a.bind(c),this.view._stage.renderView.compositingHelper.compositeOverlay(this._renderContext.bindParameters,this._temporaryFBO.getTexture(),f,e.index))}),c.bindFramebuffer(null),a.generateMipMap(),this._renderContext.resetRenderOccludedMask(),!0}bindTemporaryFramebuffer(e,t,r){S(this._temporaryFBO)&&(this._temporaryFBO=new wY(e,!1)),this._temporaryFBO.resize(t,r),this._temporaryFBO.bind(e)}async reloadShaders(){await this._shaderTechniqueRepository.reloadAll()}notifyContentChanged(){this.events.emit("content-changed")}intersect(e,t,r,n){var a;let s=0;for(const o of this._renderers.values())s=((a=o.intersect)==null?void 0:a.call(o,e,t,r,n,s))??s}_updateSortedDrapeSourceRenderers(){if(this._sortedRenderers.clear(),this._renderers.size===0)return;const e=this.view.map.allLayers;this._renderers.forEach((t,r)=>{const n=e.indexOf(r.layer);this._sortedRenderers.push(new XTe(r,t,n<0?1/0:n))}),this._sortedRenderers.sort((t,r)=>t.index-r.index)}_setViewParameters(e,t,r){r.viewport[0]=r.viewport[1]=0,r.viewport[2]=r.viewport[3]=t.resolution,aG(r.projectionMatrix,0,e[2]-e[0],0,e[3]-e[1],r.near,r.far),oG(r.viewMatrix,[-e[0],-e[1],0]),this._bindParameters.camera=r}_updateHasWater(){const e=Er(this._renderers,t=>t.hasWater);e!==this._hasWater&&(this._hasWater=e,this.events.emit("has-water",e))}_updateHasHighlights(){const e=Er(this._renderers,t=>t.hasHighlights);e!==this._hasHighlights&&(this._hasHighlights=e,this.events.emit("has-highlights",e))}_updateRendersOccluded(){const e=Er(this._renderers,t=>t.rendersOccluded);e!==this._rendersOccluded&&(this._rendersOccluded=e,this.events.emit("renders-occluded",e))}_drawDebugTexture(e,t){this._ensureDebugPatternResources(e,e,t);const r=this._rctx;r.bindTechnique(this._debugTextureTechnique,this._passParameters,null),r.bindVAO(this._quadVAO),r.drawArrays(Dt.TRIANGLE_STRIP,0,Ws(this._quadVAO,"geometry"))}_ensureDebugPatternResources(e,t,r){if(Z(this._passParameters.color,r[0],r[1],r[2]),this._passParameters.texture)return;const n=new Uint8Array(e*t*4);let s=0;for(let o=0;o<t;o++)for(let l=0;l<e;l++){const c=Math.floor(l/10),u=Math.floor(o/10);c<2||u<2||10*c>e-20||10*u>t-20?(n[s++]=255,n[s++]=255,n[s++]=255,n[s++]=255):(n[s++]=255,n[s++]=255,n[s++]=255,n[s++]=1&c&&1&u?1&l^1&o?0:255:1&c^1&u?0:128)}this._passParameters.texture=new Gi(this._rctx,{target:vi.TEXTURE_2D,pixelFormat:yt.RGBA,dataType:qt.UNSIGNED_BYTE,samplingMode:Kt.NEAREST,width:e,height:t},n);const a=new _4;a.hasAlpha=!0,this._debugTextureTechnique=this._shaderTechniqueRepository.acquire(g4,a),this._quadVAO=La(this._rctx)}get test(){return{drapeSourceRenderers:this._renderers,getDrapeSourceRenderer:e=>this._renderers.get(e)}}};var jp;h([p()],wh.prototype,"_sortedDrapeSourceRenderersDirty",void 0),h([Yn()],wh.prototype,"_shaderTechniqueRepository",void 0),h([Yn()],wh.prototype,"_stippleTextureRepository",void 0),h([p({constructOnly:!0})],wh.prototype,"view",void 0),h([p()],wh.prototype,"worldToPCSRatio",void 0),h([p()],wh.prototype,"spatialReference",void 0),h([p({type:Boolean,readOnly:!0})],wh.prototype,"updating",null),wh=h([D("esri.views.3d.terrain.OverlayRenderer")],wh),function(i){i[i.Normal=0]="Normal",i[i.OccludedOnly=1]="OccludedOnly",i[i.ExcludeRasterImage=2]="ExcludeRasterImage"}(jp||(jp={}));let XTe=class{constructor(e,t,r){this.drapeSource=e,this.renderer=t,this.index=r}};const QTe=[[1,.5,.5],[.5,.5,1]],ug=new yi;ug.near=1,ug.far=1e4,ug.relativeElevation=null;const y4=-2,rP=cr.OccludeAndTransparent;function v4(i,e,t,r){const n=DP(i.rings,i.hasZ,Q0.CCW_IS_HOLE),s=new Float64Array(n.position.length),a=sY(n.position,i.spatialReference,0,s,0,n.position,0,n.position.length/3,e,t,r),o=a!=null;return new YTe(n.position,s,BY(n.polygons,n.position,s),zY(n.outlines,n.position,s),o,a)}function UY(i,e){const t=DP(i.rings,!1,Q0.CCW_IS_HOLE),r=Ma(t.position,i.spatialReference,0,t.position,e,0,t.position.length/3);for(let n=2;n<t.position.length;n+=3)t.position[n]=y4;return{position:t.position,polygons:BY(t.polygons,t.position),outlines:zY(t.outlines,t.position),projectionSuccess:r}}function zY(i,e,t){return i.filter(({count:r})=>r>1).map(({index:r,count:n})=>{const s=3*r,a=s+3*n;return t?new ZTe(r,n,e.subarray(s,a),t.subarray(s,a)):new GY(r,n,e.subarray(s,a))})}function BY(i,e,t){const r=new Array;for(const{index:n,count:s,holeIndices:a,pathLengths:o}of i){if(s<=1)continue;const l=3*n,c=l+3*s,u=a.map(d=>d-n);r.push({index:n,count:s,holeIndices:u,pathLengths:o,position:e.subarray(l,c),mapPosition:t?t.subarray(l,c):void 0})}return r}let GY=class{constructor(e,t,r){this.index=e,this.count=t,this.position=r}},ZTe=class extends GY{constructor(e,t,r,n){super(e,t,r),this.mapPosition=n}},YTe=class{constructor(e,t,r,n,s,a){this.position=e,this.mapPosition=t,this.polygons=r,this.outlines=n,this.projectionSuccess=s,this.sampledElevation=a}};const KTe=["polygon","extent"];let JTe=class extends du{constructor(e,t,r,n){super(e,t,r,n),this.ensureDrapedStatus(!1)}async doLoad(){if(!this._drivenProperties.size){const o=RR(this._getSymbolSize());if(o)throw new K("graphics3dextrudesymbollayer:invalid-size",o)}const e=en(this.symbolLayer,"material","color"),t=this._getCombinedOpacityAndColor(e),r=Tl(t),n=t[3],s=n<1||this.needsDrivenTransparentPass,a={usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0,diffuse:r,ambient:r,opacity:n,transparent:s,cullFace:s?tn.None:tn.Back,hasVertexColors:!0,hasSlicePlane:this._context.slicePlaneEnabled,castShadows:this.symbolLayer.castShadows,offsetTransparentBackfaces:!0};this._material=new Ew(a),this._bottomMaterial=new Ew({...a,cullFace:tn.Back}),this._context.stage.add(this._material),this._context.stage.add(this._bottomMaterial)}destroy(){super.destroy(),this._material&&(this._context.stage.remove(this._material),this._context.stage.remove(this._bottomMaterial))}createGraphics3DGraphic(e){const t=e.graphic;if(!this._validateGeometry(t.geometry,KTe,this.symbolLayer.type))return null;const r=this._getVertexOpacityAndColor(e.renderingInfo,255),n=this.setGraphicElevationContext(t,new Qc);return this._createAs3DShape(t,e.renderingInfo,r,n,t.uid)}layerOpacityChanged(e,t){const r=en(this.symbolLayer,"material","color"),n=this._getCombinedOpacity(r),s=n<1||this.needsDrivenTransparentPass;this._material.setParameters({opacity:n,transparent:s}),this._bottomMaterial.setParameters({opacity:n,transparent:s});const a=this._getLayerOpacity();e.forEach(o=>{const l=t(o);y(l)&&l.layerOpacityChanged(a,this._context.isAsync)})}layerElevationInfoChanged(e,t){return this.updateGraphics3DGraphicElevationInfo(e,t,zm)}slicePlaneEnabledChanged(e,t){return this._material.setParameters({hasSlicePlane:this._context.slicePlaneEnabled}),this._bottomMaterial.setParameters({hasSlicePlane:this._context.slicePlaneEnabled}),e.forEach(r=>{const n=t(r);y(n)&&n.slicePlaneEnabledChanged(this._context.slicePlaneEnabled,this._context.isAsync)}),!0}physicalBasedRenderingChanged(){return this._material.setParameters({usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0}),this._bottomMaterial.setParameters({usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0}),!0}pixelRatioChanged(){return!0}_getExtrusionSize(e){let t;return t=e.size&&this._drivenProperties.size?Yxe(e.size,2)??0:this._getSymbolSize(),t/=this._context.renderCoordsHelper.unitInMeters,t}applyRendererDiff(e,t){return this._drivenPropertiesChanged(t)?Gr.Recreate_Symbol:Gr.Recreate_Graphics}async queryForSnapping(e,t,r,n){const s=this._getExtrusionSize(r)*this._context.renderCoordsHelper.unitInMeters/Ete(t),{objectId:a,target:o}=e,l=Rr(o);switch(l.z=(l.z??0)+s,e.type){case"edge":{const{start:c,end:u}=e,d=Rr(c),m=Rr(u);return d.z=(d.z??0)+s,m.z=(m.z??0)+s,[Z5(a,l,1/0,d,m)]}case"vertex":return[Ise(a,l,1/0),Z5(a,o,1/0,o,l)];default:return[]}}_getSymbolSize(){return this.symbolLayer.size??1}_createAs3DShape(e,t,r,n,s){const a=px(e.geometry);if(S(a))return null;if(a.rings.length===0||!a.rings.some(H=>H.length>0))return this._logGeometryValidationWarnings(a.rings,"rings","ExtrudeSymbol3DLayer"),null;const o=v4(a,this._context.elevationProvider,this._context.renderCoordsHelper,n);this._logGeometryCreationWarnings(o,a.rings,"rings","ExtrudeSymbol3DLayer");const l=n4(a);if(S(l))return null;const c=new Array,u=new Array,d=new Array,m=Ms(),f=ve(),_=R(),g=this._context.renderCoordsHelper.viewingMode===Se.Global;g||this._context.renderCoordsHelper.worldUpAtPosition(null,_),xd(a.spatialReference,[l.x,l.y,0],f,this._context.renderCoordsHelper.spatialReference);const x=ve();kn(x,f);const b=Or();Die(b,x);const{polygons:v,mapPosition:w,position:T}=o,E=T.length/3,C=new Float64Array(3*E*6),A=new Float64Array(3*E*6),M=new Float64Array(3*E*6),I=new Float64Array(1*E*6);let L=0;for(let H=0;H<v.length;++H){const V=v[H],X=V.count;if(this._context.clippingExtent&&(Mi(m),Jo(m,V.mapPosition),!Lc(m,this._context.clippingExtent)))continue;const $=Ow(V.mapPosition,V.holeIndices,3);if($.length===0)continue;const B=3*X*2+$.length,W=new Array(B),te=new Array($.length),ie=6*X,Y=3*C.BYTES_PER_ELEMENT,se=new $m(C.buffer,L*Y,Y,(L+ie)*Y),Ee=3*A.BYTES_PER_ELEMENT,Re=new $m(A.buffer,L*Ee,Ee,(L+ie)*Ee),Ie=new Float64Array(M.buffer,3*L*M.BYTES_PER_ELEMENT,3*ie),Ue=new Float64Array(I.buffer,1*L*I.BYTES_PER_ELEMENT,1*ie),ye=this._getExtrusionSize(t);eCe(T,w,$,V,se.typedBuffer,Ie,Re.typedBuffer,Ue,W,te,ye,_,g),iH(se,se,x),GE(Re,Re,b),L+=6*X;const we=this._context.stage.renderView._getObjectAndLayerIdColor({graphicUid:s,layerUid:this._context.layer.uid}),$e=l8(W,W.length-te.length,{positions:se.typedBuffer,elevation:Ie,normals:Re.typedBuffer,heights:Ue},r,we);c.push($e),u.push(this._material),d.push(rn);const st=l8(te,0,{positions:se.typedBuffer,elevation:Ie,normals:Re.typedBuffer,heights:Ue},r,we);c.push(st),u.push(this._bottomMaterial),d.push(rn)}if(c.length===0)return null;const U=new Bd({geometries:c,materials:u,transformations:d,metadata:{layerUid:this._context.layer.uid,graphicUid:s,isElevationSource:!0}});U.transformation=f;const j=tH(this.symbolLayer,{opacity:this._getLayerOpacity()}),re=y(j)?{baseMaterial:this._material,edgeMaterials:[j],properties:{mergeGeometries:!0,hasSlicePlane:this._context.slicePlaneEnabled}}:null,ee=new uu(this,U,c,null,null,rCe,n,re);return ee.alignedSampledElevation=o.sampledElevation,ee.needsElevationUpdates=zm(n.mode),ee}};function l8(i,e,t,r,n){const s=new Array(i.length).fill(0),a=[[P.POSITION,{size:3,data:t.positions,exclusive:!0}],[P.NORMAL,{size:3,data:t.normals,exclusive:!0}],[P.COLOR,{size:4,data:r,exclusive:!0}],[P.SIZE,{size:1,data:t.heights,exclusive:!0}]],o=[[P.POSITION,i],[P.NORMAL,i],[P.COLOR,s]];return t.elevation&&(a.push([P.MAPPOS,{size:3,data:t.elevation}]),o.push([P.MAPPOS,i])),new jr(a,o,Fc.Triangle,n,e)}function eCe(i,e,t,r,n,s,a,o,l,c,u,d,m){const f=t.length/3;let _=0,g=2*r.count;tCe(i,e,r.index,r.count,t,0,f,n,s,a,o,l,c,g,u,d,m);let x=2*r.count;g=0,c8(n,s,o,a,_,r.pathLengths[0],r.count,x,l,g,u),x+=4*r.pathLengths[0],g+=2*r.pathLengths[0],_+=r.pathLengths[0];for(let b=1;b<r.pathLengths.length;++b)c8(n,s,o,a,_,r.pathLengths[b],r.count,x,l,g,u),x+=4*r.pathLengths[b],g+=2*r.pathLengths[b],_+=r.pathLengths[b]}function tCe(i,e,t,r,n,s,a,o,l,c,u,d,m,f,_,g,x){q(oa,g);const b=_>0?1:-1;let v=3*t,w=0,T=3*w,E=r,C=3*E;for(let I=0;I<r;++I)x&&(oa[0]=i[v+0],oa[1]=i[v+1],oa[2]=i[v+2],he(oa,oa)),o[T+0]=i[v+0],o[T+1]=i[v+1],o[T+2]=i[v+2],l[T+0]=e[v+0],l[T+1]=e[v+1],l[T+2]=e[v+2],c[T+0]=-b*oa[0],c[T+1]=-b*oa[1],c[T+2]=-b*oa[2],u[w]=0,o[C+0]=i[v+0]+_*oa[0],o[C+1]=i[v+1]+_*oa[1],o[C+2]=i[v+2]+_*oa[2],l[C+0]=e[v+0],l[C+1]=e[v+1],l[C+2]=e[v+2],c[C+0]=b*oa[0],c[C+1]=b*oa[1],c[C+2]=b*oa[2],u[E]=_,T+=3,C+=3,v+=3,w+=1,E+=1;v=3*s,T=0,C=3*f;const A=_<0?f8:m8,M=_<0?m8:f8;for(let I=0;I<a;++I)m[T+0]=n[v+A[0]],m[T+1]=n[v+A[1]],m[T+2]=n[v+A[2]],d[C+0]=n[v+M[0]]+r,d[C+1]=n[v+M[1]]+r,d[C+2]=n[v+M[2]]+r,T+=3,C+=3,v+=3}function EC(i,e,t,r,n,s,a){r[s]=r[a],a*=3,i[(s*=3)+0]=i[a+0],i[s+1]=i[a+1],i[s+2]=i[a+2],e[s+0]=e[a+0],e[s+1]=e[a+1],e[s+2]=e[a+2],t[s+0]=n[0],t[s+1]=n[1],t[s+2]=n[2]}const f1=R();function c8(i,e,t,r,n,s,a,o,l,c,u){let d=n,m=n+1,f=n+a,_=n+a+1,g=o,x=o+1,b=o+2*s,v=o+2*s+1;u<0&&(d=n+a+1,_=n),c*=3;for(let w=0;w<s;++w)w===s-1&&(u>0?(m=n,_=n+a):(m=n,d=n+a)),iCe(i,d,m,f,f1),EC(i,e,r,t,f1,g,d),EC(i,e,r,t,f1,x,m),EC(i,e,r,t,f1,b,f),EC(i,e,r,t,f1,v,_),l[c++]=g,l[c++]=b,l[c++]=v,l[c++]=g,l[c++]=v,l[c++]=x,d++,m++,f++,_++,g+=2,x+=2,b+=2,v+=2}const oM=R(),h8=R(),u8=R(),d8=R(),p8=R();function iCe(i,e,t,r,n){e*=3,t*=3,r*=3,Z(oM,i[e++],i[e++],i[e++]),Z(h8,i[t++],i[t++],i[t++]),Z(u8,i[r++],i[r++],i[r++]),ne(d8,h8,oM),ne(p8,u8,oM),nt(n,p8,d8),he(n,n)}const B_=R();function rCe(i,e,t,r){const n=i.stageObject,s=n.geometryRecords,a=s.length,o=e.mode!=="absolute-height";let l=0;const c=n.transformation,u=kn(ve(),c);for(let d=0;d<a;d+=2){const m=s[d].geometry,f=m.getMutableAttribute(P.POSITION).data,_=m.vertexAttributes.get(P.SIZE).data,g=m.vertexAttributes.get(P.MAPPOS).data,x=new EZ(g),b=f.length/3;let v=0,w=!1,T=0;const E=t.spatialReference;for(let C=0;C<b;C++){B_[0]=f[v],B_[1]=f[v+1],B_[2]=f[v+2],$d(x,t,e,r,PC),o&&(T+=PC.sampledElevation),jt.TESTS_DISABLE_OPTIMIZATIONS?(Z(Va,x.array[x.offset+0],x.array[x.offset+1],PC.z+_[v/3]),y(E)&&r.toRenderCoords(Va,E,Va),Ce(Va,Va,u)):(Z(Va,f[v+0],f[v+1],f[v+2]),Ce(Va,Va,c),r.setAltitude(Va,PC.z+_[v/3]),Ce(Va,Va,u)),f[v]=Va[0],f[v+1]=Va[1],f[v+2]=Va[2];const A=nCe/r.unitInMeters;(Math.abs(B_[0]-f[v])>=A||Math.abs(B_[1]-f[v+1])>=A||Math.abs(B_[2]-f[v+2])>=A)&&(w=!0),x.offset+=3,v+=3}w&&(m.invalidateBoundingInfo(),n.geometryVertexAttrsUpdated(s[d]),s[d+1].geometry.invalidateBoundingInfo(),n.geometryVertexAttrsUpdated(s[d+1])),l+=T/b}return l/a}const Va=R(),oa=R(),PC=new Jx,m8=[0,2,1],f8=[0,1,2],nCe=.01,WUe=1.2,sCe=w0;let $R=class{constructor(e,t,r,n){this.graphics3DSymbolLayer=e,this.renderGeometries=t,this.boundingBox=r,this._drapeSourceRenderer=n,this.type="draped",this.stage=null,this._visible=!1,this._addedToStage=!1,this.isElevationSource=!1}initialize(e){this.stage=e}setVisibility(e){if(this.stage!=null&&this._visible!==e){if(this._visible=e,e&&!this._addedToStage)return this._addedToStage=!0,void this._drapeSourceRenderer.addGeometries(this.renderGeometries,Fi.ADD);if(e||this._addedToStage){for(const t of this.renderGeometries)t.instanceParameters.visible=this._visible;this._drapeSourceRenderer.modifyGeometries(this.renderGeometries,Ur.VISIBILITIES)}}}destroy(){this.stage&&this._addedToStage&&this._drapeSourceRenderer.removeGeometries(this.renderGeometries,Fi.REMOVE),this._addedToStage=!1,this._visible=!1,this.stage=null}getCenterObjectSpace(e=R()){return Z(e,0,0,0)}getBoundingBoxObjectSpace(e=Ms()){return Mi(e)}addObjectState(e,t){e===Lg.Highlight&&(this.renderGeometries.forEach(r=>{const n=r.addHighlight();t.addRenderGeometry(r,n,this)}),this._addedToStage&&this._drapeSourceRenderer.modifyGeometries(this.renderGeometries,Ur.HIGHLIGHTS))}removeObjectState(e){this.renderGeometries.forEach(t=>{e.removeRenderGeometry(t)})}removeRenderGeometryObjectState(e,t){e.removeHighlight(t),this._addedToStage&&this._drapeSourceRenderer.modifyGeometries(this.renderGeometries,Ur.HIGHLIGHTS)}computeAttachmentOrigin(e){for(const t of this.renderGeometries)t.computeAttachmentOrigin(G_)&&(e.draped.origin[0]+=G_[0],e.draped.origin[1]+=G_[1],e.draped.num++)}async getProjectedBoundingBox(e,t,r,n,s){Mi(s);for(let a=0;a<this.renderGeometries.length;a++){const o=this.renderGeometries[a];this._getRenderGeometryProjectedBoundingRect(o,e,g8,r),_se(s,g8)}if(t){let a;Ic(s,G_);const o=s4(s,t.service.spatialReference,t);try{a=await t.service.queryElevation(G_[0],G_[1],n,o,"ground")}catch{}y(a)&&(s[2]=Math.min(s[2],a),s[5]=Math.max(s[5],a))}return s}_getRenderGeometryProjectedBoundingRect(e,t,r,n){if(this.boundingBox)qD(sh,this.boundingBox);else{const s=e.boundingSphere,a=s[3];sh[0]=s[0]-a,sh[1]=s[1]-a,sh[2]=s[2]-a,sh[3]=s[0]+a,sh[4]=s[1]+a,sh[5]=s[2]+a}return t(sh,0,2),this.calculateRelativeScreenBounds&&n.push({location:Ic(sh),screenSpaceBoundingRect:this.calculateRelativeScreenBounds()}),GD(sh,r)}};const g8=$t(),sh=Ms(),G_=R();let HY=class{constructor(e,t,r,n=2048){this.text=e,this._alignment=t,this._parameters=r,this._maxSize=n,this._textWidths=[],this._lineWidths=[],this._renderPixelRatio=null,this._displayWidth=null,this._heightMetricsCached=null,this.key=`TextRenderer-${this._parameters.key}-${this._alignment}--${e}`,this._lines=e.split(/\r?\n/)}get displayWidth(){return Math.ceil(this._ensureTextWidth()+2*this._backgroundHorizontalPadding)}get displayHeight(){const e=this._lineSpacing*(this._lines.length-1),t=this._lineHeight;return Math.ceil(e+t+2*this._haloSize+this._backgroundTopPadding+this._backgroundBottomPadding)}get renderedWidth(){return Math.ceil(this._toRenderUnit(this.displayWidth))}get renderedHeight(){return Math.ceil(this._toRenderUnit(this.displayHeight))}get firstRenderedBaselinePosition(){return this._toRenderUnit(this._firstLineYOffset+this._baselinePosition)}get _firstLineYOffset(){return this._backgroundTopPadding+this._haloSize}get _heightMetrics(){return this._ensureHeightMetrics()}get _lineSpacing(){return(this._lineHeight+this._linePadding)*this._parameters.definition.lineSpacingFactor}get _lineHeight(){return this._heightMetrics.lineHeight}get _linePadding(){return this._lineHeight*aCe}get _baselinePosition(){return this._heightMetrics.baselinePosition}get _renderedFontSize(){return this._toRenderUnit(this._fontSize)}get _fontSize(){return this._parameters.definition.size}get _renderedHaloSize(){return this._toRenderUnit(this._haloSize)}get _haloSize(){return this._parameters.haloSize}get _backgroundHorizontalPadding(){return this._hasBackground?this._parameters.definition.background.padding[0]:0}get _backgroundVerticalPadding(){return this._hasBackground?this._parameters.definition.background.padding[1]:0}get _backgroundTopPadding(){return Math.max(0,this._backgroundVerticalPadding-this._heightMetrics.paddingTop)}get _backgroundBottomPadding(){return Math.max(0,this._backgroundVerticalPadding-this._heightMetrics.paddingBottom)}get _hasBackground(){return!!this._parameters.backgroundStyle}get renderPixelRatio(){if(S(this._renderPixelRatio)){const e=this._parameters.definition.pixelRatio;this._maxSize>0?this._renderPixelRatio=Math.min(e,Math.min(this._maxSize/this.displayWidth,this._maxSize/this.displayHeight)):this._renderPixelRatio=e}return this._renderPixelRatio}_getLineXOffset(e){switch(this._alignment){case Tm.Left:return this._backgroundHorizontalPadding;case Tm.Center:return(this.displayWidth-this._lineWidths[e])/2;case Tm.Right:return this.displayWidth-this._backgroundHorizontalPadding-this._lineWidths[e]}}render(e,t=0,r=0){e.save();const n=t/=this.renderPixelRatio,s=r/=this.renderPixelRatio,a=this._haloSize,o=this._firstLineYOffset;t+=a,r+=o+this._baselinePosition;const l=this._haloSize>0;l&&this._renderHalo(e,n,s,a,o),this._setFontProperties(e,this._renderedFontSize);for(let c=0;c<this._lines.length;++c){const u=this._lines[c],d=this._getLineXOffset(c);l&&(e.globalCompositeOperation="destination-out",e.fillStyle="rgb(0, 0, 0)",this._fillText(e,u,t+d,r),this._renderLineDecoration(e,t+d,r,this._textWidths[c])),e.globalCompositeOperation="source-over",e.fillStyle=this._parameters.textStyle,this._fillText(e,u,t+this._getLineXOffset(c),r),this._renderLineDecoration(e,t+d,r,this._textWidths[c]),r+=this._lineSpacing}if(jt.TEXT_SHOW_BASELINE){e.strokeStyle=_8,e.setLineDash([2,2]),e.lineWidth=1;let c=s+o;for(let u=0;u<this._lines.length;++u){const d=c+this._baselinePosition;this._drawLine(e,[n,d],[n+this.displayWidth,d]),c+=this._lineSpacing}}if(jt.TEXT_SHOW_BORDER&&(e.strokeStyle=_8,e.setLineDash([]),e.lineWidth=1,this._drawBox(e,[n,s],[this.displayWidth,this.displayHeight])),this._hasBackground){const c=this._parameters.definition.background.borderRadius*this.renderPixelRatio;this._roundedRect(e,n,s,c),e.globalCompositeOperation="destination-over",e.fillStyle=this._parameters.backgroundStyle,e.fill()}e.restore()}_renderLineDecoration(e,t,r,n,s=!1){if(this._parameters.definition.font.decoration==="none"||n===0)return;const a=1,o=Math.max(this._parameters.definition.size/16,a);switch(this._parameters.definition.font.decoration){case"underline":r+=2*o;break;case"line-through":r-=.33*this._baselinePosition}const l=s?this._haloSize:0;e.strokeStyle=s?this._parameters.haloStyle:this._parameters.textStyle,e.lineWidth=this._toRenderUnit(o+2*l),e.beginPath(),e.moveTo(this._toRenderUnit(t-l),this._toRenderUnit(r)),e.lineTo(this._toRenderUnit(t+n+l),this._toRenderUnit(r)),e.stroke()}_roundedRect(e,t,r,n){t=this._toRenderUnit(t),r=this._toRenderUnit(r);const s=this.renderedWidth,a=this.renderedHeight;n!==0?(n=ce(n,0,Math.floor(a/2)),e.beginPath(),e.moveTo(t,r+n),e.arcTo(t,r,t+n,r,n),e.lineTo(t+s-n,r),e.arcTo(t+s,r,t+s,r+n,n),e.lineTo(t+s,r+a-n),e.arcTo(t+s,r+a,t+s-n,r+a,n),e.lineTo(t+n,r+a),e.arcTo(t,r+a,t,r+a-n,n),e.closePath()):e.rect(t,r,s,a)}_renderHalo(e,t,r,n,s){const a=this.renderedWidth,o=this.renderedHeight,l=oE(lM,Math.max(a,H_),Math.max(o,H_)),c=l.getContext("2d");c.clearRect(0,0,a,o),this._setFontProperties(c,this._renderedFontSize),c.fillStyle=this._parameters.haloStyle,c.strokeStyle=this._parameters.haloStyle;const u=this._renderedHaloSize<3;c.lineJoin=u?"miter":"round",u?this._renderHaloEmulated(c,n,s):this._renderHaloNative(c,n,s);let d=s+this._baselinePosition;for(let m=0;m<this._lines.length;++m){const f=this._getLineXOffset(m);this._renderLineDecoration(c,n+f,d,this._textWidths[m],!0),d+=this._lineSpacing}e.globalAlpha=this._parameters.definition.halo.color[3],e.drawImage(l,0,0,a,o,this._toRenderUnit(t),this._toRenderUnit(r),a,o),e.globalAlpha=1}_renderHaloEmulated(e,t,r){r+=this._baselinePosition;for(let n=0;n<this._lines.length;++n){const s=this._lines[n],a=this._getLineXOffset(n);for(const[o,l]of jY)this._fillText(e,s,t+a+this._haloSize*o,r+this._haloSize*l);r+=this._lineSpacing}}_renderHaloNative(e,t,r){const n=2*this._haloSize;r+=this._baselinePosition;for(let s=0;s<this._lines.length;++s){const a=this._lines[s],o=this._getLineXOffset(s),l=5,c=.1;for(let u=0;u<l;u++){const d=1-(l-1)*c+u*c;e.lineWidth=this._toRenderUnit(d*n),this._strokeText(e,a,t+o,r)}r+=this._lineSpacing}}_setFontProperties(e,t){e.font=this._parameters.fontString(t),e.textAlign="left",e.textBaseline="alphabetic"}_ensureTextWidth(){if(y(this._displayWidth))return this._displayWidth;const e=oE(lM,H_,H_).getContext("2d");this._setFontProperties(e,this._fontSize);let t=2*this._haloSize;const r=this._parameters.definition.font;r.style!=="italic"&&r.style!=="oblique"&&r.weight!=="bold"&&r.weight!=="bolder"||(t+=.3*e.measureText("A").width),this._textWidths.length=0,this._lineWidths.length=0;let n=0;for(const s of this._lines){const a=e.measureText(s).width,o=a+t;this._textWidths.push(a),this._lineWidths.push(o),n=Math.max(n,o)}return this._displayWidth=n,this._displayWidth}_ensureHeightMetrics(){if(S(this._heightMetricsCached)){const e=oE(lM,H_,H_).getContext("2d");this._setFontProperties(e,this._fontSize);const t=e.measureText(this.text+oCe),r=this._hasBackground?e.measureText(this._lines[0]):t,n=this._lines.length===1?r:this._hasBackground?e.measureText(this._lines[this._lines.length-1]):t,s=t.actualBoundingBoxAscent+t.actualBoundingBoxDescent;this._heightMetricsCached={paddingTop:t.actualBoundingBoxAscent-r.actualBoundingBoxAscent,paddingBottom:t.actualBoundingBoxDescent-n.actualBoundingBoxDescent,lineHeight:s,baselinePosition:t.actualBoundingBoxAscent}}return this._heightMetricsCached}_toRenderUnit(e){return e*this.renderPixelRatio}_toRoundedRenderUnit(e){return Math.round(e*this.renderPixelRatio)}_fillText(e,t,r,n){e.fillText(t,this._toRenderUnit(r),this._toRenderUnit(n))}_strokeText(e,t,r,n){e.strokeText(t,this._toRenderUnit(r),this._toRenderUnit(n))}_drawLine(e,t,r){e.beginPath(),e.moveTo(this._toRoundedRenderUnit(t[0])+.5,this._toRoundedRenderUnit(t[1])+.5),e.lineTo(this._toRoundedRenderUnit(r[0])+.5,this._toRoundedRenderUnit(r[1])+.5),e.stroke()}_drawBox(e,t,r){const n=this._toRenderUnit(t[0]),s=this._toRenderUnit(t[1]),a=this._toRenderUnit(r[0]),o=this._toRenderUnit(r[1]),l=Math.floor(n)+.5,c=Math.ceil(n+a)-.5,u=Math.floor(s)+.5,d=Math.ceil(s+o)-.5;e.beginPath(),e.moveTo(l,u),e.lineTo(c,u),e.lineTo(c,d),e.lineTo(l,d),e.lineTo(l,u),e.stroke()}};const jY=[];for(let e=0;e<360;e+=360/16)jY.push([Math.cos(Math.PI*e/180),Math.sin(Math.PI*e/180)]);var Tm;function oE(i,e,t){return i.canvas||(i.canvas=document.createElement("canvas")),i.canvas.width=e,i.canvas.height=t,i.canvas}(function(i){i[i.Left=0]="Left",i[i.Center=1]="Center",i[i.Right=2]="Right"})(Tm||(Tm={}));const lM={canvas:null},aCe=.2,H_=512,_8="rgb(255, 0, 255, 0.5)",oCe=(()=>{let i="";for(let e=32;e<127;e++)i+=String.fromCharCode(e);return i})(),lCe=Object.freeze({left:0,center:.5,right:1}),lE=Object.freeze({"bottom-left":Xt(0,0),bottom:Xt(.5,0),"bottom-right":Xt(1,0),left:Xt(0,.5),center:Xt(.5,.5),right:Xt(1,.5),"top-left":Xt(0,1),top:Xt(.5,1),"top-right":Xt(1,1)});function qY(i){switch(i){case"left":return Tm.Left;case"right":return Tm.Right;default:return Tm.Center}}function y8(i){switch(i){case"bottom-left":case"left":case"top-left":return"left";case"bottom":case"center":case"top":return"center";case"bottom-right":case"right":case"top-right":return"right"}}function cCe(i){switch(i){case"bottom-left":case"bottom":case"bottom-right":return"bottom";case"left":case"center":case"right":return"center";case"top-left":case"top":case"top-right":return"top"}}function hCe(i,e){switch(e){case"bottom":return i==="left"?"bottom-left":i==="right"?"bottom-right":"bottom";case"center":return i;case"top":return i==="left"?"top-left":i==="right"?"top-right":"top"}}function uCe(i){return i==="middle"?"center":i}var Ss,v8,nP;function g1(i){return i!=null}function j_(i){return typeof i=="number"}function DR(i){return typeof i=="string"}function dCe(i){return i==null||DR(i)}function Br(i,e){i&&i.push(e)}function pCe(i,e,t,r=ve()){const n=i||0,s=e||0,a=t||0;return n!==0&&vw(r,r,-n/180*Math.PI),s!==0&&bw(r,r,s/180*Math.PI),a!==0&&bD(r,r,a/180*Math.PI),r}function op(i,e,t,r,n){const s=i.minSize,a=i.maxSize;if(i.expression)return Br(n,"Could not convert size info: expression not supported"),!1;if(i.useSymbolValue){const o=r.symbolSize[t];return e.minSize[t]=o,e.maxSize[t]=o,e.offset[t]=e.minSize[t],e.factor[t]=0,e.type[t]=Ss.DefinedSize,!0}if(g1(i.field))return g1(i.stops)?i.stops.length===2&&j_(i.stops[0].size)&&j_(i.stops[1].size)?(b8(i.stops[0].size,i.stops[1].size,i.stops[0].value,i.stops[1].value,e,t),e.type[t]=Ss.DefinedSize,!0):(Br(n,"Could not convert size info: stops only supported with 2 elements"),!1):j_(s)&&j_(a)&&g1(i.minDataValue)&&g1(i.maxDataValue)?(b8(s,a,i.minDataValue,i.maxDataValue,e,t),e.type[t]=Ss.DefinedSize,!0):Y5[i.valueUnit]!=null?(e.minSize[t]=-1/0,e.maxSize[t]=1/0,e.offset[t]=0,e.factor[t]=1/Y5[i.valueUnit],e.type[t]=Ss.DefinedSize,!0):i.valueUnit==="unknown"?(Br(n,"Could not convert size info: proportional size not supported"),!1):(Br(n,"Could not convert size info: scale-dependent size not supported"),!1);if(!g1(i.field)){if(i.stops&&i.stops[0]&&j_(i.stops[0].size))return e.minSize[t]=i.stops[0].size,e.maxSize[t]=i.stops[0].size,e.offset[t]=e.minSize[t],e.factor[t]=0,e.type[t]=Ss.DefinedSize,!0;if(j_(s))return e.minSize[t]=s,e.maxSize[t]=s,e.offset[t]=s,e.factor[t]=0,e.type[t]=Ss.DefinedSize,!0}return Br(n,"Could not convert size info: unsupported variant of sizeInfo"),!1}function b8(i,e,t,r,n,s){const a=Math.abs(r-t)>0?(e-i)/(r-t):0;n.minSize[s]=a>0?i:e,n.maxSize[s]=a>0?e:i,n.offset[s]=i-t*a,n.factor[s]=a}function mCe(i,e,t,r){if(i.normalizationField||i.valueRepresentation)return Br(r,"Could not convert size info: unsupported property"),null;if(!dCe(i.field))return Br(r,"Could not convert size info: field is not a string"),null;if(e.size){if(i.field)if(e.size.field){if(i.field!==e.size.field)return Br(r,"Could not convert size info: multiple fields in use"),null}else e.size.field=i.field}else e.size={field:i.field,minSize:[0,0,0],maxSize:[0,0,0],offset:[0,0,0],factor:[0,0,0],type:[Ss.Undefined,Ss.Undefined,Ss.Undefined]};let n;switch(i.axis){case"width":return n=op(i,e.size,0,t,r),n?e:null;case"height":return n=op(i,e.size,2,t,r),n?e:null;case"depth":return n=op(i,e.size,1,t,r),n?e:null;case"width-and-depth":return n=op(i,e.size,0,t,r),n&&op(i,e.size,1,t,r),n?e:null;case null:case void 0:case"all":return n=op(i,e.size,0,t,r),n=n&&op(i,e.size,1,t,r),n=n&&op(i,e.size,2,t,r),n?e:null;default:return Br(r,`Could not convert size info: unknown axis "${i.axis}""`),null}}function fCe(i,e,t){for(let n=0;n<3;++n){let s=e.unitInMeters;i.type[n]===Ss.DefinedSize&&(s*=e.modelSize[n],i.type[n]=Ss.DefinedScale),i.minSize[n]=i.minSize[n]/s,i.maxSize[n]=i.maxSize[n]/s,i.offset[n]=i.offset[n]/s,i.factor[n]=i.factor[n]/s}let r;if(i.type[0]!==Ss.Undefined)r=0;else if(i.type[1]!==Ss.Undefined)r=1;else{if(i.type[2]===Ss.Undefined)return Br(t,"No size axis contains a valid size or scale"),!1;r=2}for(let n=0;n<3;++n)i.type[n]===Ss.Undefined&&(i.minSize[n]=i.minSize[r],i.maxSize[n]=i.maxSize[r],i.offset[n]=i.offset[r],i.factor[n]=i.factor[r],i.type[n]=i.type[r]);return!0}function w8(i,e,t){i[4*e+0]=t.r/255,i[4*e+1]=t.g/255,i[4*e+2]=t.b/255,i[4*e+3]=t.a}function gCe(i,e,t){if(i.normalizationField)return Br(t,"Could not convert color info: unsupported property"),null;if(DR(i.field)){if(!i.stops)return Br(t,"Could not convert color info: missing stops or colors"),null;{if(i.stops.length>8)return Br(t,"Could not convert color info: too many color stops"),null;e.color={field:i.field,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};const r=i.stops;for(let n=0;n<8;++n){const s=r[Math.min(n,r.length-1)];e.color.values[n]=s.value,w8(e.color.colors,n,s.color)}}}else{if(!(i.stops&&i.stops.length>=0))return Br(t,"Could not convert color info: no field and no colors/stops"),null;{const r=i.stops&&i.stops.length>=0&&i.stops[0].color;e.color={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};for(let n=0;n<8;n++)e.color.values[n]=1/0,w8(e.color.colors,n,r)}}return e}function _Ce(i,e,t){if(i.normalizationField)return Br(t,"Could not convert opacity info: unsupported property"),null;if(DR(i.field)){if(!i.stops)return Br(t,"Could not convert opacity info: missing stops or opacities"),null;{if(i.stops.length>8)return Br(t,"Could not convert opacity info: too many opacity stops"),null;e.opacity={field:i.field,values:[0,0,0,0,0,0,0,0],opacityValues:[0,0,0,0,0,0,0,0]};const r=i.stops;for(let n=0;n<8;++n){const s=r[Math.min(n,r.length-1)];e.opacity.values[n]=s.value,e.opacity.opacityValues[n]=s.opacity}}}else{if(!(i.stops&&i.stops.length>=0))return Br(t,"Could not convert opacity info: no field and no opacities/stops"),null;{const r=i.stops&&i.stops.length>=0&&i.stops[0].opacity;e.opacity={field:null,values:[0,0,0,0,0,0,0,0],opacityValues:[0,0,0,0,0,0,0,0]};for(let n=0;n<8;n++)e.opacity.values[n]=1/0,e.opacity.opacityValues[n]=r}}return e}function cM(i,e,t){const r=t===2&&i.rotationType==="arithmetic";e.offset[t]=r?90:0,e.factor[t]=r?-1:1,e.type[t]=1}function yCe(i,e,t){if(!DR(i.field))return Br(t,"Could not convert rotation info: field is not a string"),null;if(e.rotation){if(i.field)if(e.rotation.field){if(i.field!==e.rotation.field)return Br(t,"Could not convert rotation info: multiple fields in use"),null}else e.rotation.field=i.field}else e.rotation={field:i.field,offset:[0,0,0],factor:[1,1,1],type:[0,0,0]};switch(i.axis){case"tilt":return cM(i,e.rotation,0),e;case"roll":return cM(i,e.rotation,1),e;case null:case void 0:case"heading":return cM(i,e.rotation,2),e;default:return Br(t,`Could not convert rotation info: unknown axis "${i.axis}""`),null}}function WY(i,e,t){if(!i)return null;const r=!e.supportedTypes||!!e.supportedTypes.size,n=!e.supportedTypes||!!e.supportedTypes.color,s=!e.supportedTypes||!!e.supportedTypes.rotation,a=!!e.supportedTypes&&!!e.supportedTypes.opacity,o=i.reduce((l,c)=>{if(!l)return l;if(c.valueExpression)return Br(t,"Could not convert visual variables: arcade expressions not supported"),null;switch(c.type){case"size":return r?mCe(c,l,e,t):l;case"color":return n?gCe(c,l,t):l;case"opacity":return a?_Ce(c,l,t):null;case"rotation":return s?yCe(c,l,t):l;default:return null}},{size:null,color:null,opacity:null,rotation:null});return!(i.length>0&&o)||o.size||o.color||o.opacity||o.rotation?o&&o.size&&!fCe(o.size,e,t)?null:o:null}function b4(i){return i&&i.size!=null}function mx(i,e){if(!i)return{enabled:!1};if(jt.TESTS_DISABLE_FAST_UPDATES)return{enabled:!1};const t=WY(i.visualVariables,e);return t?{enabled:!0,visualVariables:t,materialParameters:XY(t,e),requiresShaderTransformation:b4(t)}:{enabled:!1}}function fx(i,e,t){if(!e||!i.enabled)return!1;const r=i.visualVariables,n=WY(e.visualVariables,t);return!!n&&!!(RC(r.size,n.size,"size")&&RC(r.color,n.color,"color")&&RC(r.rotation,n.rotation,"rotation")&&RC(r.opacity,n.opacity,"opacity"))&&(i.visualVariables=n,i.materialParameters=XY(n,t),i.requiresShaderTransformation=b4(n),!0)}function RC(i,e,t){if(!!i!=!!e||i&&i.field!==e.field)return!1;if(i&&t==="rotation"){const r=i,n=e;for(let s=0;s<3;s++)if(r.type[s]!==n.type[s]||r.offset[s]!==n.offset[s]||r.factor[s]!==n.factor[s])return!1}return!0}function XY(i,e){const t={vvSizeEnabled:!1,vvSizeMinSize:null,vvSizeMaxSize:null,vvSizeOffset:null,vvSizeFactor:null,vvSizeValue:null,vvColorEnabled:!1,vvColorValues:null,vvColorColors:null,vvOpacityEnabled:!1,vvOpacityValues:null,vvOpacityOpacities:null,vvSymbolAnchor:null,vvSymbolRotationMatrix:null},r=b4(i);return i&&i.size?(t.vvSizeEnabled=!0,t.vvSizeMinSize=i.size.minSize,t.vvSizeMaxSize=i.size.maxSize,t.vvSizeOffset=i.size.offset,t.vvSizeFactor=i.size.factor):i&&r&&(t.vvSizeValue=e.transformation.scale),i&&r&&(t.vvSymbolAnchor=e.transformation.anchor,t.vvSymbolRotationMatrix=Or(),Ag(rw),pCe(e.transformation.rotation[2],e.transformation.rotation[0],e.transformation.rotation[1],rw),Td(t.vvSymbolRotationMatrix,rw)),i&&i.color&&(t.vvColorEnabled=!0,t.vvColorValues=i.color.values,t.vvColorColors=i.color.colors),i&&i.opacity&&(t.vvOpacityEnabled=!0,t.vvOpacityValues=i.opacity.values,t.vvOpacityOpacities=i.opacity.opacityValues),t}(function(i){i[i.Undefined=0]="Undefined",i[i.DefinedSize=1]="DefinedSize",i[i.DefinedScale=2]="DefinedScale"})(Ss||(Ss={})),function(i){i[i.Undefined=0]="Undefined",i[i.DefinedAngle=1]="DefinedAngle"}(v8||(v8={})),function(i){const e=ve(),t=R();function r(s,a,o){if(!s.vvSizeEnabled)return o;pn(e,o);const l=s.vvSymbolRotationMatrix;lG(rw,l[0],l[1],l[2],0,l[3],l[4],l[5],0,l[6],l[7],l[8],0,0,0,0,1),Hr(e,e,rw);for(let c=0;c<3;++c){const u=s.vvSizeOffset[c]+a[0]*s.vvSizeFactor[c];t[c]=ce(u,s.vvSizeMinSize[c],s.vvSizeMaxSize[c])}return cG(e,e,t),ru(e,e,s.vvSymbolAnchor),e}function n(s,a,o){if(!a.vvSizeEnabled)return Z(s,1,1,1);for(let l=0;l<3;++l){const c=a.vvSizeOffset[l]+o[0]*a.vvSizeFactor[l];s[l]=ce(c,a.vvSizeMinSize[l],a.vvSizeMaxSize[l])}return s}i.evaluateModelTransform=r,i.evaluateModelTransformScale=n}(nP||(nP={}));const rw=ve(),i$=nP.evaluateModelTransform,vCe=nP.evaluateModelTransformScale;let bCe=class{constructor(){this.visible=!0}},hv=class{constructor(e,t,r={}){this.data=e,this.material=t,this.boundingSphere=_i(),this.instanceParameters=new bCe,this._transformation=ve(),this._shaderTransformationDirty=!0,this.layerUid=je(r.layerUid,null),this.graphicUid=je(r.graphicUid,null),this.id=r.id?r.id:Cm(),this.boundingInfo=je(r.boundingInfo,null),this.calculateShaderTransformation=je(r.calculateShaderTransformation,null),this.castShadow=!!r.castShadow&&r.castShadow}get transformation(){return this._transformation}updateTransformation(e){e(this._transformation),this._shaderTransformationDirty=!0,this.computeBoundingSphere(this._transformation,this.boundingSphere)}shaderTransformationChanged(){this._shaderTransformationDirty=!0}computeBoundingSphere(e,t,r=zg(e)){S(this.boundingInfo)||(Ce(t,this.boundingInfo.getCenter(),e),t[3]=this.boundingInfo.getBSRadius()*r)}get hasShaderTransformation(){return y(this.calculateShaderTransformation)}get primitiveType(){return this.data.primitiveType}getShaderTransformation(){return S(this.calculateShaderTransformation)?je(this.transformation,rn):(this._shaderTransformationDirty&&(this._shaderTransformation||(this._shaderTransformation=ve()),pn(this._shaderTransformation,this.calculateShaderTransformation(je(this.transformation,rn))),this._shaderTransformationDirty=!1),this._shaderTransformation)}computeAttachmentOrigin(e){if(this.material.computeAttachmentOrigin)return!!this.material.computeAttachmentOrigin(this,e)&&(y(this._transformation)&&Ce(e,e,this._transformation),!0);const t=this.indices.get(P.POSITION),r=this.vertexAttributes.get(P.POSITION);return!!Ane(r,t,e)&&(y(this._transformation)&&Ce(e,e,this._transformation),!0)}get indices(){return this.data.indices}get vertexAttributes(){return this.data.vertexAttributes}addHighlight(){const e=new tP(Lg.Highlight),t=this.instanceParameters;return t.highlights=EI(t.highlights,e),e}removeHighlight(e){const t=this.instanceParameters;t.highlights=PI(t.highlights,e)}};const wCe=ve(),x8=Ge(0,0,1),xCe=16,TCe=1.5,dg=eae,CCe=[dg/2,dg/2,1-dg/2,1-dg/2],SCe=[K5*dg,K5*dg];let r$=class QY extends du{constructor(e,t,r,n){super(e,t,r,n),this._cimLayers=null,this._cimSymbolMaterials=new Map,this._cimSymbolTextures=new Map,this._cimMaterialParametersInfo=null,this._cimRequiredFields=null,this._cimScaleFactorOrFunction=null,this._size=null,this._symbolTextureRatio=1,this._outlineSize=0,this._elevationOptions={supportsOffsetAdjustment:!0,supportsOnTheGround:!0}}getCachedSize(){return{size:this._getIconSize()}}async doLoad(e){this._validateOrThrow();const t=this._prepareMaterialParameters(),r=this._getPrimitive();if(y(r))this._prepareResourcesPrimitive(t,r);else{const n=Hte(this.symbol,this.symbolLayer),s=D7(n);s&&s.mediaType==="application/json"?await this._prepareResourcesCIM(t,JSON.parse(s.data),e):await this._prepareResourcesHref(t,n,e)}}_validateOrThrow(){if(this._drivenProperties.size)return;const e=RR(this._getIconSize());if(e)throw new K("graphics3diconsymbollayer:invalid-size",e)}_getIconSize(){const e=this.symbolLayer,t=Math.round(e.size!=null?Sa(e.size):xCe);return this._drivenProperties.size?Math.max(t,64):t}_generateTextureCIM(e){const t=this._getGraphicHash(e);let r=t===""?null:this._cimSymbolTextures.get(t);if(!r){const n={scaleFactor:this._cimScaleFactorOrFunction},s=this._context.sharedResources.cimSymbolRasterizer.rasterizeCIMSymbol3D(this._cimLayers,e,"esriGeometryPoint",n,null,null);this._cimMaterialParametersInfo.anchorPosition=this._getAnchorPos("relative",s.anchorPosition);const a={width:s.imageData.width,height:s.imageData.height,powerOfTwoResizeMode:UD.PAD};r=new FP(s.imageData,a),this._cimSymbolTextures.set(t,r),this._context.stage.add(r)}return r}_computeSize(e,t){const r=e.width/e.height;return r>1?[t,Math.round(t/r)]:[Math.round(t*r),t]}_prepareMaterialParameters(){const e={anchorPosition:this._getAnchorPos(this.symbolLayer.anchor,this.symbolLayer.anchorPosition)},t=this.symbol;if(ECe(t)){const{screenLength:r,minWorldLength:n,maxWorldLength:s}=t.verticalOffset;e.verticalOffset={screenLength:Sa(r),minWorldLength:n||0,maxWorldLength:y(s)?s:1/0}}return this._context.screenSizePerspectiveEnabled&&(e.screenSizePerspective=this._context.sharedResources.screenSizePerspectiveSettings),e.occlusionTest=!0,e.hasSlicePlane=this._context.slicePlaneEnabled,e}_prepareResourcesPrimitive(e,t){const r=this._getOutlineSize();if(hM(t)&&r===0)throw new Error("Nothing to render");if(this._outlineSize=r,e.color=this._getFillColor(),e.outlineColor=this._getOutlineColor(),e.outlineSize=this._outlineSize,y(this._context.sharedResources.textures)){const s=this._context.sharedResources.textures.fromData(`${t}-icon`,()=>Jse(t));this._texture=s.texture,this._releaseTexture=s,e.textureId=this._texture.id}e.textureIsSignedDistanceField=!0,e.distanceFieldBoundingBox=CCe;const n=this._getIconSize();this._size=[n,n],this._symbolTextureRatio=1/dg,this._createMaterialAndAddToStage(e,this._context.stage)}async _prepareResourcesHref(e,t,r){if(!St("esri-canvas-svg-support")&&nD(t))throw new K("graphics3diconsymbollayer:unsupported-image-format","IconSymbol3DLayer failed to load (SVG symbols are not supported in IE11)");this._outlineSize=this._getOutlineSize(),e.color=this._getFillColor(),e.outlineColor=this._getOutlineColor(),e.outlineSize=this._outlineSize,e.textureIsSignedDistanceField=!1;const n=this._getIconSize(),s=n*this._context.graphicsCoreOwner.view.state.pixelRatio;if(y(this._context.sharedResources.textures)){const a=await gw(this._context.sharedResources.textures.fromUrl(t,s,{signal:r}));if(a.ok===!1)throw ote(a.error),new K("graphics3diconsymbollayer:request-failed",`Failed to load (Request for icon resource failed: ${t})`);this._releaseTexture=a.value;const o=a.value.texture,l=o.params;this._size=this._computeSize(l,n),e.textureId=o.id}this._createMaterialAndAddToStage(e,this._context.stage)}async _prepareResourcesCIM(e,t,r){const n=new tae({data:t});if(!this._context.sharedResources.cimSymbolRasterizer){const u=(await G(()=>import("./CIMSymbolRasterizer-0964644a.js"),["assets/CIMSymbolRasterizer-0964644a.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/typedArrayUtil-4d7bb04c.js","assets/ArrayPool-a8ee9378.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/promiseUtils-1e54421e.js","assets/screenUtils-410d12c0.js","assets/cimAnalyzer-38842966.js","assets/arcadeOnDemand-281a01eb.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/cast-fcb46737.js","assets/nextTick-3ee5a785.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-193543b5.js","assets/jsonUtils-229211af.js","assets/enums-2658a65c.js","assets/alignmentUtils-ae955d28.js","assets/mat2d-2bbb5feb.js","assets/vec2-528adfe4.js","assets/vec2f32-461e65a9.js","assets/number-954e4ab6.js","assets/Rect-ea14f53a.js","assets/callExpressionWithFeature-55effb7b.js","assets/quantizationUtils-4dd81f85.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-9ad35d39.js","assets/Rasterizer-dce80cb8.js","assets/_commonjsHelpers-a430e9ea.js","assets/imageutils-c0676a73.js","assets/rasterizingUtils-ec11e94c.js","assets/Symbol3DAnchorPosition2D-5726d999.js"])).CIMSymbolRasterizer;xi(r),this._context.sharedResources.cimSymbolRasterizer||(this._context.sharedResources.cimSymbolRasterizer=new u(this._context.renderCoordsHelper.spatialReference,!0))}const s=this._context.layer.fields?this._context.layer.fields.map(u=>u.toJSON()):null;let a,o;if(this._cimLayers=await this._context.sharedResources.cimSymbolRasterizer.analyzeCIMSymbol(n,s,this._context.renderer&&this._context.renderer.type==="dictionary"?this._context.renderer.fieldMap:null,"esriGeometryPoint",{signal:r}),this._context.renderer&&this._context.renderer.type==="dictionary"&&this._context.renderer.scaleExpression){const u=this._context.renderer;if(isNaN(u.scaleExpression)){const d=u.scaleExpression,m=await Ute(d,this._context.layer.spatialReference,s);o=(f,_,g)=>{const x=Kse(m,f,{$view:g},"esriGeometryPoint",_);return x!==null?x:1}}else a=Number(u.scaleExpression)}this._cimScaleFactorOrFunction=a||o||1;const l=this._context.renderer?await this._context.renderer.getRequiredFields(this._context.layer.fieldsIndex):[];xi(r);const c=this._context.layer.fieldsIndex;this._cimRequiredFields=l.map(u=>c.get(u).name),this._cimMaterialParametersInfo=e,this._cimMaterialParametersInfo.color=this._getFillColor(),this._cimMaterialParametersInfo.outlineColor=[0,0,0,0],this._cimMaterialParametersInfo.outlineSize=0,this._cimMaterialParametersInfo.textureIsSignedDistanceField=!1}_getPrimitive(){return this.symbolLayer.resource&&this.symbolLayer.resource.href?null:this.symbolLayer.resource&&this.symbolLayer.resource.primitive||Wte}_getOutlineSize(){let e=0;const t=this.symbolLayer;return y(t.outline)&&t.outline.size!=null?Math.max(Sa(t.outline.size),0):(e=hM(this._getPrimitive())?TCe:0,Math.max(e,0))}_getOutlineColor(){const e=this._getLayerOpacity(),t=this.symbolLayer,r=en(t,"outline","color");if(y(r)){const n=ei.toUnitRGB(r),s=r.a*e;return[n[0],n[1],n[2],s]}return[0,0,0,0]}_getFillColor(){if(hM(this._getPrimitive()))return sCe;const e=S(this._getPrimitive()),t=en(this.symbolLayer,"material","color");return this._getCombinedOpacityAndColor(t,{hasIntrinsicColor:e})}_getAnchorPos(e,t){return e==="relative"?Xt((t.x||0)+.5,.5-(t.y||0)):e in lE?lE[e]:lE.center}_createMaterialAndAddToStage(e,t){if(this._cimLayers?this._fastUpdates={enabled:!1}:this._fastUpdates=mx(this._context.renderer,this._fastVisualVariableConvertOptions()),this._fastUpdates.enabled&&Object.assign(e,this._fastUpdates.materialParameters),this._cimLayers){let r=y(e.textureId)?this._cimSymbolMaterials.get(e.textureId):null;return r||(r=new lv(e),this._cimSymbolMaterials.set(je(e.textureId,0),r),t.add(r)),r}return this._material=new lv(e),t.add(this._material),this._material}_setDrapingDependentMaterialParameters(){this.draped&&(this._forEachMaterial(e=>{e.setParameters({verticalOffset:null,screenSizePerspective:null,occlusionTest:!1,hasSlicePlane:!1,shaderPolygonOffset:0,isDraped:this.draped})}),this.layerOpacityChanged())}destroy(){super.destroy(),this._forEachMaterial(e=>this._context.stage.remove(e)),this._material=null,this._cimSymbolMaterials.clear(),this._cimSymbolTextures.forEach(e=>this._context.stage.remove(e)),this._cimSymbolTextures.clear(),this._releaseTexture=Qi(this._releaseTexture)}_getScaleFactor(e,t){if(this._drivenProperties.size&&e.size){for(let r=0;r<3;r++){const n=e.size[r];n&&n!=="symbol-value"&&n!=="proportional"&&(e.size[r]=Sa(n))}if(e.size[0]==="symbol-value")return 1;if(isFinite(+e.size[0]))return+e.size[0]/t;if(isFinite(+e.size[2]))return+e.size[2]/t}return 1}createGraphics3DGraphic(e){const t=e.graphic;if(!this._validateGeometry(t.geometry))return null;let r,n;if(this._cimLayers){if(!this._cimLayers.length)return null;const d=this._generateTextureCIM(t),m={textureId:d.id,...this._cimMaterialParametersInfo};n=this._createMaterialAndAddToStage(m,this._context.stage),r=[d.params.width,d.params.height]}else r=this._size,n=ct(this._material);const s=dx(t.geometry);if(S(s))return this.logger.warn(`unsupported geometry type for icon symbol: ${t.geometry.type}`),null;const a=e.renderingInfo,o=this._getVertexOpacityAndColor(a);let l=1;if(!this._fastUpdates.enabled||!this._fastUpdates.visualVariables.size){const d=r[0]>r[1]?r[0]:r[1];l=this._getScaleFactor(a,d)}l*=this._symbolTextureRatio;const c=[r[0]*l,r[1]*l],u=this.setGraphicElevationContext(t,new Qc);return this.ensureDrapedStatus(u.mode==="on-the-ground")&&this._setDrapingDependentMaterialParameters(),this.draped?this._createAsOverlay(t,s,n,o,c,e.layer.uid):this._createAs3DShape(t,s,n,o,c,u,t.uid)}layerOpacityChanged(){const e=this._getFillColor(),t=this._getOutlineColor();this._forEachMaterial(r=>{r.setParameters({color:e}),r.setParameters({outlineColor:t})})}layerElevationInfoChanged(e,t,r){const n=this._elevationContext.mode,s=Kx(QY.elevationModeChangeTypes,r,n);if(s!==Zi.UPDATE)return s;const a=Ql(n)||n==="absolute-height";return this.updateGraphics3DGraphicElevationInfo(e,t,()=>a)}slicePlaneEnabledChanged(){return this.draped||this._forEachMaterial(e=>{e.setParameters({hasSlicePlane:this._context.slicePlaneEnabled})}),!0}physicalBasedRenderingChanged(){return!0}pixelRatioChanged(){return!!this._getPrimitive()}applyRendererDiff(e,t){for(const r in e.diff){if(r!=="visualVariables"||!fx(this._fastUpdates,t,this._fastVisualVariableConvertOptions()))return Gr.Recreate_Symbol;y(this._material)&&this._material.setParameters(this._fastUpdates.materialParameters)}return Gr.Fast_Update}_defaultElevationInfoNoZ(){return PCe}_createAs3DShape(e,t,r,n,s,a,o){const l=this.getFastUpdateAttrValues(e),c=l?_=>i$(this._fastUpdates.materialParameters,l,_):null,u=this._context.stage.renderView._getObjectAndLayerIdColor({graphicUid:o,layerUid:this._context.layer.uid}),d=[AL(x8,null,n,s,RCe,null,l,u)],m=d4(this._context,t,d,[r],a,this._context.layer.uid,o,c);if(m===null)return null;const f=new uu(this,m.object,d,null,null,hx,a);return f.alignedSampledElevation=m.sampledElevation,f.needsElevationUpdates=Ql(a.mode)||a.mode==="absolute-height",f.getScreenSize=this._createScreenSizeGetter(s,c),f.calculateRelativeScreenBounds=_=>r.calculateRelativeScreenBounds(f.getScreenSize(),1,_),ux(f,t,this._context.elevationProvider),f}_createAsOverlay(e,t,r,n,s,a){r.renderPriority=this._renderPriority;const o=_i();bn(t,o,this._context.overlaySR),o[2]=y4;const l=this._context.clippingExtent;if(y(l)&&!jD(l,o))return null;const c=this.getFastUpdateAttrValues(e),u=c?g=>i$(this._fastUpdates.materialParameters,c,g):null,d=this._context.stage.renderView._getObjectAndLayerIdColor({graphicUid:e.uid,layerUid:this._context.layer.uid}),m=AL(x8,o,n,s,null,null,c,d),f=new hv(m,r,{layerUid:a,graphicUid:e.uid,calculateShaderTransformation:u});o[3]=0,im(f.boundingSphere,o);const _=new $R(this,[f],null,this._context.drapeSourceRenderer);return _.getScreenSize=this._createScreenSizeGetter(s,u),_.calculateRelativeScreenBounds=g=>r.calculateRelativeScreenBounds(_.getScreenSize(),1,g),_}_createScreenSizeGetter(e,t){const r=this._outlineSize+2;if(this._fastUpdates.enabled){const n=e[0]/this._symbolTextureRatio,s=e[1]/this._symbolTextureRatio;return(a=be())=>{const o=t(wCe);return a[0]=o[0]*n+r,a[1]=o[5]*s+r,a}}{const n=e[0]/this._symbolTextureRatio+r,s=e[1]/this._symbolTextureRatio+r;return(a=be())=>(a[0]=n,a[1]=s,a)}}_fastVisualVariableConvertOptions(){const e=this._size[0]>this._size[1]?this._size[0]:this._size[1],t=Ge(e,e,e),r=sI(1),n=e*r;return{modelSize:t,symbolSize:Ge(n,n,n),unitInMeters:r,transformation:{anchor:Gl,scale:em,rotation:Gl}}}_getGraphicHash(e){let t="";for(const r of this._cimRequiredFields)t+=r+e.attributes[r];return t}_forEachMaterial(e){y(this._material)&&e(this._material),this._cimSymbolMaterials.forEach(e)}test(){return{...super.test(),material:this._material}}};function ECe(i){return i&&i.type==="point-3d"&&i.hasVisibleVerticalOffset()}function hM(i){return!S(i)&&(i==="cross"||i==="x")}r$.PRIMITIVE_SIZE=SCe,r$.elevationModeChangeTypes={definedChanged:Zi.UPDATE,staysOnTheGround:Zi.NONE,onTheGroundChanged:Zi.RECREATE};const PCe={mode:"relative-to-ground",offset:0},RCe=Bi(0,0,0,1);function n$(i){switch(i){case"butt":return T0.BUTT;case"square":return T0.SQUARE;case"round":return T0.ROUND;default:return null}}function ACe(i){return i==="diamond"?"kite":i}function s$(i,e=null){const t=[],r=[];OCe(i,r,t);const n=r[0][1].data,s=t[0][1].length,a=new Array(s).fill(0);return MCe(i,r,t),ICe(i,r,t,a),DCe(i,r,t,a),LCe(i,r,t,a),$Ce(i,r,t,a),FCe(i,r,t,a),NCe(i,r,t,a),kCe(i,r,t,n),new jr(r,t,Fc.Line,e)}function OCe(i,e,t){const{attributeData:{position:r},removeDuplicateStartEnd:n}=i,s=VCe(r)&&n,a=r.length/3-(s?1:0),o=new Array(2*(a-1)),l=s?p7(r,0,r.length-3):r;let c=0;for(let u=0;u<a-1;u++)o[c++]=u,o[c++]=u+1;e.push([P.POSITION,{size:3,data:l,exclusive:s}]),t.push([P.POSITION,o])}function MCe(i,e,t){const r=i.attributeData.mapPosition;S(r)||(t.push([P.MAPPOS,t[0][1]]),e.push([P.MAPPOS,{size:3,data:r}]))}function ICe(i,e,t,r){if(y(i.attributeData.colorFeature))return;const n=i.attributeData.color;e.push([P.COLOR,{size:4,data:je(n,Rc)}]),t.push([P.COLOR,r])}function LCe(i,e,t,r){if(!y(i.attributeData.normal))return;const n=i.attributeData.normal;e.push([P.NORMAL,{size:3,data:n}]),t.push([P.NORMAL,r])}function $Ce(i,e,t,r){const n=i.attributeData.colorFeature;S(n)||(e.push([P.COLORFEATUREATTRIBUTE,{size:1,data:new Float32Array([n])}]),t.push([P.COLOR,r]))}function DCe(i,e,t,r){if(y(i.attributeData.sizeFeature))return;const n=i.attributeData.size;e.push([P.SIZE,{size:1,data:[je(n,1)]}]),t.push([P.SIZE,r])}function FCe(i,e,t,r){const n=i.attributeData.sizeFeature;S(n)||(e.push([P.SIZEFEATUREATTRIBUTE,{size:1,data:new Float32Array([n])}]),t.push([P.SIZEFEATUREATTRIBUTE,r]))}function NCe(i,e,t,r){const n=i.attributeData.opacityFeature;S(n)||(e.push([P.OPACITYFEATUREATTRIBUTE,{size:1,data:new Float32Array([n])}]),t.push([P.OPACITYFEATUREATTRIBUTE,r]))}function kCe(i,e,t,r){if(S(i.overlayInfo)||i.overlayInfo.renderCoordsHelper.viewingMode!==Se.Global||!i.overlayInfo.spatialReference.isGeographic)return;const n=new Float64Array(r.length),s=Yt(i.overlayInfo.spatialReference);for(let m=0;m<n.length;m+=3)E7(r,m,n,m,s);const a=r.length/3,o=new Float32Array(a+1);let l=UCe,c=zCe,u=0,d=0;Z(l,n[d++],n[d++],n[d++]),o[0]=0;for(let m=1;m<a+1;++m)m===a&&(d=0),Z(c,n[d++],n[d++],n[d++]),u+=Lie(l,c),o[m]=u,[l,c]=[c,l];e.push([P.DISTANCETOSTART,{size:1,data:o}]),t.push([P.DISTANCETOSTART,t[0][1]])}function VCe(i){const e=i.length;return i[0]===i[e-3]&&i[1]===i[e-2]&&i[2]===i[e-1]}var T8;(function(i){i[i.KEEP=0]="KEEP",i[i.REMOVE=1]="REMOVE"})(T8||(T8={}));const UCe=R(),zCe=R();function KUe(i,e){if(S(i)||i.length===0)return[];const t=[];return i.forEach(r=>{const n=r.length,s=new Float64Array(3*n);r.forEach((o,l)=>{s[3*l+0]=o[0],s[3*l+1]=o[1],s[3*l+2]=o[2]});const a={attributeData:{position:s,normal:e},removeDuplicateStartEnd:!1};t.push(a)}),t}function BCe(i,e,t,r){const n=i.type==="polygon"?Q0.CCW_IS_HOLE:Q0.NONE,s=i.type==="polygon"?i.rings:i.paths,{position:a,outlines:o}=DP(s,i.hasZ,n),l=new Float64Array(a.length),c=sY(a,i.spatialReference,0,l,0,a,0,a.length/3,e,t,r),u=c!=null;return{lines:u?ZY(o,a,l):[],projectionSuccess:u,sampledElevation:c}}function GCe(i,e){const t=i.type==="polygon"?Q0.CCW_IS_HOLE:Q0.NONE,r=i.type==="polygon"?i.rings:i.paths,{position:n,outlines:s}=DP(r,!1,t),a=Ma(n,i.spatialReference,0,n,e,0,n.length/3);for(let o=2;o<n.length;o+=3)n[o]=y4;return{lines:a?ZY(s,n):[],projectionSuccess:a}}function ZY(i,e,t){const r=new Array;for(const{index:n,count:s}of i){if(s<=1)continue;const a=3*n,o=a+3*s;r.push({position:e.subarray(a,o),mapPosition:t?t.subarray(a,o):void 0})}return r}const YY=new Map([[P.POSITION,0],[P.UV0,2],[P.AUXPOS1,3],[P.NORMAL,4],[P.COLOR,5],[P.COLORFEATUREATTRIBUTE,5],[P.SIZE,6],[P.SIZEFEATUREATTRIBUTE,6],[P.OPACITYFEATUREATTRIBUTE,7]]);let KY=class JY extends ti{initializeProgram(e){return new Jt(e.rctx,JY.shader.get().build(this.configuration),YY)}_makePipelineState(e,t){const r=this.configuration,n=e===Ht.NONE;return Ke({blending:r.output===k.Color||r.output===k.Alpha?n?Hl:jm(e):null,depthTest:{func:i_(e)},depthWrite:n?r.writeDepth&&nl:LP(e),colorWrite:ht,stencilWrite:r.hasOccludees?Cd:null,stencilTest:r.hasOccludees?t?Ig:r_:null,polygonOffset:{factor:0,units:-10}})}initializePipeline(){return this.configuration.occluder&&(this._occluderPipelineTransparent=Ke({blending:Hl,depthTest:VE,depthWrite:null,colorWrite:ht,stencilWrite:null,stencilTest:zG}),this._occluderPipelineOpaque=Ke({blending:Hl,depthTest:VE,depthWrite:null,colorWrite:ht,stencilWrite:BG,stencilTest:GG}),this._occluderPipelineMaskWrite=Ke({blending:null,depthTest:DD,depthWrite:null,colorWrite:null,stencilWrite:Cd,stencilTest:Ig})),this._occludeePipelineState=this._makePipelineState(this.configuration.transparencyPassType,!0),this._makePipelineState(this.configuration.transparencyPassType,!1)}getPipelineState(e,t){return t?this._occludeePipelineState:this.configuration.occluder?e===ae.TRANSPARENT_OCCLUDER_MATERIAL?this._occluderPipelineTransparent:e===ae.OCCLUDER_MATERIAL?this._occluderPipelineOpaque:this._occluderPipelineMaskWrite:super.getPipelineState(e,t)}};KY.shader=new ii(iae,()=>G(()=>import("./LineMarker.glsl-81f5bcae.js"),["assets/LineMarker.glsl-81f5bcae.js","assets/string-a318751c.js","assets/typedArrayUtil-4d7bb04c.js","assets/floatRGBA-9ad35d39.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/Texture-46c8c2cb.js","assets/compilerUtils-18d58939.js","assets/Error-ec6249b9.js","assets/Evented-a45c8b0f.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/VisualVariablePassParameters-d460182b.js","assets/VertexAttribute-9c5c630d.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/ShaderBuilder-a7d0da4e.js","assets/mat3f64-c6305894.js","assets/aaBoundingBox-657a9b82.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/aaBoundingRect-193543b5.js","assets/basicInterfaces-19ed850e.js","assets/ViewingMode-5d7d590b.js","assets/Util-a48361c6.js","assets/vec2f64-30dc1443.js","assets/vec4f64-e407da96.js","assets/mat4-44a0988f.js","assets/mat4f64-1e28eae0.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/ScreenSpacePass-d5e48a9b.js","assets/Float4PassUniform-d7bdbc81.js","assets/Texture2DPassUniform-753de459.js","assets/vec2-528adfe4.js","assets/assets-8d3e737a.js","assets/Matrix3PassUniform-ad9f953b.js","assets/vec3f32-c9aa289f.js","assets/MarkerSizing.glsl-566261cc.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/FloatPassUniform-68d54f51.js","assets/sdfPrimitives-9858c36d.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/TransparencyPassType-a11868d2.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/LineMarker.glsl-8166d610.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Slice.glsl-3b39b1f7.js","assets/OutputDepth.glsl-470c8e2a.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/AlphaCutoff-96178e0d.js"]));let HCe=class extends Fd{constructor(e){super(e,new qCe),this._vertexAttributeLocations=YY,this._configuration=new Nse,this._layout=this.createLayout()}dispose(){}getConfiguration(e,t){return this._configuration.output=e,this._configuration.space=t.slot===ae.DRAPED_MATERIAL?sA.Draped:this.parameters.worldSpace?sA.World:sA.Screen,this._configuration.hideOnShortSegments=this.parameters.hideOnShortSegments,this._configuration.hasCap=this.parameters.cap!==T0.BUTT,this._configuration.anchor=this.parameters.anchor,this._configuration.hasTip=this.parameters.hasTip,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.hasOccludees=this.parameters.hasOccludees,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.vvColor=this.parameters.vvColorEnabled,this._configuration.vvOpacity=this.parameters.vvOpacityEnabled,this._configuration.vvSize=this.parameters.vvSizeEnabled,this._configuration.occluder=this.parameters.renderOccluded===cr.OccludeAndTransparentStencil,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration.hasMultipassTerrain=t.multipassTerrain.enabled,this._configuration.cullAboveGround=t.multipassTerrain.cullAboveGround,this._configuration}intersect(){}createLayout(){const e=sn().vec3f(P.POSITION).vec2f(P.UV0).vec3f(P.AUXPOS1);return this.parameters.worldSpace&&e.vec3f(P.NORMAL),this.parameters.vvSizeEnabled?e.f32(P.SIZEFEATUREATTRIBUTE):e.f32(P.SIZE),this.parameters.vvColorEnabled?e.f32(P.COLORFEATUREATTRIBUTE):e.vec4f(P.COLOR),this.parameters.vvOpacityEnabled&&e.f32(P.OPACITYFEATUREATTRIBUTE),e}createBufferWriter(){return new WCe(this._layout,this.parameters)}requiresSlot(e,t){return t===k.Color||t===k.Alpha||t===k.Highlight||t===k.Depth?e===ae.DRAPED_MATERIAL?!0:this.parameters.renderOccluded===cr.OccludeAndTransparentStencil?e===ae.OPAQUE_MATERIAL||e===ae.OCCLUDER_MATERIAL||e===ae.TRANSPARENT_OCCLUDER_MATERIAL:t===k.Color||t===k.Alpha?e===(this.parameters.writeDepth?ae.TRANSPARENT_MATERIAL:ae.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL):e===ae.OPAQUE_MATERIAL:!1}createGLMaterial(e){return new jCe(e)}},jCe=class extends kG{_updateParameters(e){return this.updateTexture(this._material.parameters.textureId),this._material.setParameters(this.textureBindParameters),this.ensureTechnique(KY,e)}_updateOccludeeState(e){e.hasOccludees!==this._material.parameters.hasOccludees&&this._material.setParameters({hasOccludees:e.hasOccludees})}beginSlot(e){return this._output!==k.Color&&this._output!==k.Alpha||this._updateOccludeeState(e),this._updateParameters(e)}},qCe=class extends PG{constructor(){super(...arguments),this.width=0,this.color=[1,1,1,1],this.placement="end",this.cap=T0.BUTT,this.anchor=sH.Center,this.hasTip=!1,this.worldSpace=!1,this.hideOnShortSegments=!1,this.writeDepth=!0,this.hasSlicePlane=!1,this.vvFastUpdate=!1,this.hasOccludees=!1}},WCe=class{constructor(e,t){this.vertexBufferLayout=e,this._parameters=t}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(){return this._parameters.placement==="begin-end"?12:6}write(e,t,r,n,s){const a=r.vertexAttributes.get(P.POSITION).data,o=a.length/3;let l=[1,0,0];const c=r.vertexAttributes.get(P.NORMAL);this._parameters.worldSpace&&y(c)&&(l=c.data);let u=1,d=0;this._parameters.vvSizeEnabled?d=r.vertexAttributes.get(P.SIZEFEATUREATTRIBUTE).data[0]:r.vertexAttributes.has(P.SIZE)&&(u=r.vertexAttributes.get(P.SIZE).data[0]);let m=[1,1,1,1],f=0;this._parameters.vvColorEnabled?f=r.vertexAttributes.get(P.COLORFEATUREATTRIBUTE).data[0]:r.vertexAttributes.has(P.COLOR)&&(m=r.vertexAttributes.get(P.COLOR).data);let _=0;this._parameters.vvOpacityEnabled&&(_=r.vertexAttributes.get(P.OPACITYFEATUREATTRIBUTE).data[0]);const g=new Float32Array(n.buffer);let x=s*(this.vertexBufferLayout.stride/4);const b=(E,C,A,M)=>{if(g[x++]=E[0],g[x++]=E[1],g[x++]=E[2],g[x++]=A[0],g[x++]=A[1],g[x++]=C[0],g[x++]=C[1],g[x++]=C[2],this._parameters.worldSpace&&(g[x++]=l[0],g[x++]=l[1],g[x++]=l[2]),this._parameters.vvSizeEnabled?g[x++]=d:g[x++]=u,this._parameters.vvColorEnabled)g[x++]=f;else{const I=Math.min(4*M,m.length-4);g[x++]=m[I+0],g[x++]=m[I+1],g[x++]=m[I+2],g[x++]=m[I+3]}this._parameters.vvOpacityEnabled&&(g[x++]=_)};let v;(function(E){E[E.ASCENDING=1]="ASCENDING",E[E.DESCENDING=-1]="DESCENDING"})(v||(v={}));const w=(E,C)=>{const A=Z(XCe,a[3*E],a[3*E+1],a[3*E+2]),M=QCe;let I=E+C;do Z(M,a[3*I],a[3*I+1],a[3*I+2]),I+=C;while(Rg(A,M)&&I>=0&&I<o);e&&(Ce(A,A,e),Ce(M,M,e)),b(A,M,[-1,-1],E),b(A,M,[1,-1],E),b(A,M,[1,1],E),b(A,M,[-1,-1],E),b(A,M,[1,1],E),b(A,M,[-1,1],E)},T=this._parameters.placement;T!=="begin"&&T!=="begin-end"||w(0,v.ASCENDING),T!=="end"&&T!=="begin-end"||w(o-1,v.DESCENDING)}};const XCe=R(),QCe=R(),fs={dash:[4,3],dot:[1,3],"long-dash":[8,3],"short-dash":[4,1],"short-dot":[1,1]},ZCe={dash:fs.dash,"dash-dot":[...fs.dash,...fs.dot],dot:fs.dot,"long-dash":fs["long-dash"],"long-dash-dot":[...fs["long-dash"],...fs.dot],"long-dash-dot-dot":[...fs["long-dash"],...fs.dot,...fs.dot],none:null,"short-dash":fs["short-dash"],"short-dash-dot":[...fs["short-dash"],...fs["short-dot"]],"short-dash-dot-dot":[...fs["short-dash"],...fs["short-dot"],...fs["short-dot"]],"short-dot":fs["short-dot"],solid:null},YCe=8;function KCe(i,e=2){return S(i)?i:{pattern:i.slice(),pixelRatio:e}}function r8e(i,e=2){return{pattern:[i,i],pixelRatio:e}}function eK(i){return y(i)&&i.type==="style"?JCe(i.style):null}function JCe(i){return y(i)?KCe(ZCe[i],YCe):null}const eSe=["polyline","polygon","extent"];let tK=class iK extends du{constructor(e,t,r,n){super(e,t,r,n)}async doLoad(){if(this._vvConvertOptions={modelSize:[1,1,1],symbolSize:[1,1,1],unitInMeters:1,transformation:{anchor:[0,0,0],scale:[1,1,1],rotation:[0,0,0]},supportedTypes:{size:!0,color:!0,opacity:!0,rotation:!1}},this._context.renderer&&this._context.renderer.visualVariables&&this._context.renderer.visualVariables.length>0?this._fastUpdates=mx(this._context.renderer,this._vvConvertOptions):this._fastUpdates={enabled:!1},!this._drivenProperties.size&&(this.symbolLayer.size!=null?this.symbolLayer.size:sI(1))<0)throw new K("graphics3dlinesymbollayer:invalid-size","Symbol sizes may not be negative values");this._markerTexture=y(this.symbolLayer.marker)&&y(this._context.sharedResources.textures)?kse(this._context.sharedResources.textures,ACe(this.symbolLayer.marker.style)):null}_getMaterialParameters(e,t=!1){var s;const r=this._getCombinedOpacityAndColor(t&&this._markerColor||this._materialColor);this._patternHidesLine&&!t&&(r[3]=0);const n={width:this._computeMaterialWidth((s=this.symbolLayer)==null?void 0:s.size),color:r,hasPolygonOffset:!0,join:this.symbolLayer.join||"miter",cap:n$(this.symbolLayer.cap||"butt"),hasSlicePlane:this._context.slicePlaneEnabled,isClosed:e,stipplePattern:eK(this.symbolLayer.pattern),stippleScaleWithLineWidth:!0};return this._fastUpdates&&this._fastUpdates.visualVariables?{...n,...this._fastUpdates.materialParameters}:n}get _materialColor(){return co(this.symbolLayer.material,e=>e.color)}get _markerColor(){return co(this.symbolLayer.marker,e=>e.color)}get _lineMaterial(){return S(this._lineMaterialCached)&&(this._lineMaterialCached=new g0(this._getMaterialParameters(!1)),this._context.stage.add(this._lineMaterialCached)),this._lineMaterialCached}get _ringMaterial(){return S(this._ringMaterialCached)&&(this._ringMaterialCached=new g0(this._getMaterialParameters(!0)),this._context.stage.add(this._ringMaterialCached)),this._ringMaterialCached}get _wireframeLineMaterial(){return S(this._wireframeLineMaterialCached)&&(this._wireframeLineMaterialCached=new g0({...this._getMaterialParameters(!1),wireframe:!0}),this._context.stage.add(this._wireframeLineMaterialCached)),this._wireframeLineMaterialCached}get _wireframeRingMaterial(){return S(this._wireframeRingMaterialCached)&&(this._wireframeRingMaterialCached=new g0({...this._getMaterialParameters(!0),wireframe:!0}),this._context.stage.add(this._wireframeRingMaterialCached)),this._wireframeRingMaterialCached}get _markerMaterial(){return S(this._markerMaterialCached)&&y(this.symbolLayer.marker)&&y(this._markerTexture)&&(this._markerMaterialCached=new HCe({...this._getMaterialParameters(!1,!0),placement:this.symbolLayer.marker.placement,textureId:this._markerTexture.texture.id}),this._context.stage.add(this._markerMaterialCached)),this._markerMaterialCached}destroy(){super.destroy(),this._forEachMaterial(e=>this._context.stage.remove(e)),this._lineMaterialCached=null,this._ringMaterialCached=null,this._wireframeLineMaterialCached=null,this._wireframeRingMaterialCached=null,this._markerMaterialCached=null,this._markerTexture=Qi(this._markerTexture)}_getDrivenSize(e){return this._drivenProperties.size&&e.size?Sa(Kxe(e.size)):1}_getSizeFeatureAttributeData(e){return this._fastUpdates.enabled&&this._fastUpdates.visualVariables.size?_d(this._fastUpdates.visualVariables.size.field,e):null}_getDrivenColor(e){const t=Bi(1,1,1,1);return this._drivenProperties.color&&e.color&&(t[0]=e.color[0],t[1]=e.color[1],t[2]=e.color[2],e.color.length>0&&(t[3]=e.color[3])),this._drivenProperties.opacity&&e.opacity&&(t[3]=e.opacity),t}_getColorFeatureAttributeData(e){return this._fastUpdates.enabled&&this._fastUpdates.visualVariables.color?_d(this._fastUpdates.visualVariables.color.field,e):null}_getOpacityFeatureAttributeData(e){return this._fastUpdates.enabled&&this._fastUpdates.visualVariables.opacity?_d(this._fastUpdates.visualVariables.opacity.field,e):null}createGraphics3DGraphic(e){const t=e.graphic;if(!this._validateGeometry(t.geometry,eSe,this.symbolLayer.type))return null;const r=this.setGraphicElevationContext(t,new Qc);return this.ensureDrapedStatus(r.mode==="on-the-ground"),this.draped?this._createAsOverlay(e,this._context.layer.uid):this._createAs3DShape(e,r,t.uid)}applyRendererDiff(e,t){for(const r in e.diff){if(r!=="visualVariables"||!fx(this._fastUpdates,t,this._vvConvertOptions))return Gr.Recreate_Symbol;this._forEachMaterial(n=>n.setParameters(this._fastUpdates.materialParameters))}return Gr.Fast_Update}prepareSymbolLayerPatch(e){var s,a;if(e.diff.type!=="partial")return;const t=e.diff.diff,r={};((s=t.size)==null?void 0:s.type)==="complete"&&(r.width=this._computeMaterialWidth(t.size.newValue),delete t.size),((a=t.cap)==null?void 0:a.type)==="complete"&&(r.cap=n$(je(t.cap.newValue,"butt")),delete t.cap);const n=this._prepareMarkerPatch(e,t);this._prepareMaterialPatch(e,t,n),e.symbolLayerStatePatches.push(()=>this._forEachMaterial(o=>o.setParameters(r)))}layerOpacityChanged(){this._forEachMaterial((e,t)=>this._updateMaterialLayerOpacity(e,t))}_forEachMaterial(e){y(this._lineMaterialCached)&&e(this._lineMaterialCached),y(this._ringMaterialCached)&&e(this._ringMaterialCached),y(this._wireframeLineMaterialCached)&&e(this._wireframeLineMaterialCached),y(this._wireframeRingMaterialCached)&&e(this._wireframeRingMaterialCached),y(this._markerMaterialCached)&&e(this._markerMaterialCached,!0)}_updateMaterialLayerOpacity(e,t=!1){const r=e.parameters.color,n=en(this.symbolLayer,"material","color"),s=this._patternHidesLine&&!t?0:this._getCombinedOpacity(n),a=Bi(r[0],r[1],r[2],s);e.setParameters({color:a})}layerElevationInfoChanged(e,t,r){const n=this._elevationContext.mode,s=Kx(iK.elevationModeChangeTypes,r,n);if(s!==Zi.UPDATE)return s;const a=Ql(n);return this.updateGraphics3DGraphicElevationInfo(e,t,()=>a)}slicePlaneEnabledChanged(){const e={hasSlicePlane:this._context.slicePlaneEnabled};return this._forEachMaterial(t=>t.setParameters(e)),!0}physicalBasedRenderingChanged(){return!0}pixelRatioChanged(){return!0}_getGeometryAsPolygonOrPolyline(e){switch(e.type){case"extent":if(e instanceof ui)return Hm.fromExtent(e);break;case"polygon":case"polyline":return e}return null}_createAs3DShape(e,t,r){const n=e.graphic,s=this._getGeometryAsPolygonOrPolyline(n.geometry),a=s.type==="polygon"?s.rings:s.paths,o=new Array,l=new Array,c=new Array,u=Ms(),d=BCe(s,this._context.elevationProvider,this._context.renderCoordsHelper,t),m=s.type==="polygon"?"rings":"paths";this._logGeometryCreationWarnings(d,a,m,"LineSymbol3DLayer");for(let g=0;g<d.lines.length;g++){const{position:x,mapPosition:b}=d.lines[g];if(y(this._context.clippingExtent)&&(Mi(u),Jo(u,b),!Lc(u,this._context.clippingExtent)))continue;const v=this._createGeometry(e,x,b,s.type,nw.ELEVATED,r);o.push(v),l.push(s.type==="polygon"?this._ringMaterial:this._lineMaterial),c.push(rn),jt.LINE_WIREFRAMES&&(o.push(v.cloneShallow()),l.push(s.type==="polygon"?this._wireframeRingMaterial:this._wireframeLineMaterial),c.push(rn));const w=this._markerMaterial;y(w)&&(o.push(v.cloneShallow()),l.push(w),c.push(rn))}if(o.length===0)return null;const f=new Bd({geometries:o,materials:l,transformations:c,castShadow:!1,metadata:{layerUid:this._context.layer.uid,graphicUid:r}}),_=new uu(this,f,o,null,null,Cxe,t);return _.alignedSampledElevation=d.sampledElevation,_.needsElevationUpdates=Ql(t.mode),_}_createGeometry(e,t,r,n,s,a){const o=n==="polygon",l=this._fastUpdates.enabled&&this._fastUpdates.visualVariables.color,c=this._fastUpdates.enabled&&this._fastUpdates.visualVariables.size,u=this._context.stage.renderView._getObjectAndLayerIdColor({graphicUid:a,layerUid:this._context.layer.uid});return s$({overlayInfo:s===nw.DRAPED?{spatialReference:this._context.overlaySR,renderCoordsHelper:this._context.renderCoordsHelper}:null,removeDuplicateStartEnd:o,attributeData:{position:t,mapPosition:r,size:c?null:this._getDrivenSize(e.renderingInfo),color:l?null:this._getDrivenColor(e.renderingInfo),sizeFeature:this._getSizeFeatureAttributeData(e.graphic),colorFeature:this._getColorFeatureAttributeData(e.graphic),opacityFeature:this._getOpacityFeatureAttributeData(e.graphic)}},u)}_createAsOverlay(e,t){const r=e.graphic,n=this._getGeometryAsPolygonOrPolyline(r.geometry),s=n.type==="polygon"?n.rings:n.paths,a=n.type==="polygon"?this._ringMaterial:this._lineMaterial;a.renderPriority=this._renderPriority;const o=jt.LINE_WIREFRAMES?n.type==="polygon"?this._wireframeRingMaterial:this._wireframeLineMaterial:null,l=this._markerMaterial;y(o)&&(o.renderPriority=this._renderPriority-.001),y(l)&&(l.renderPriority=this._renderPriority-.002);const c=new Array,u=Ms(),d=Mi(),m=GCe(n,this._context.overlaySR),f=n.type==="polygon"?"rings":"paths";this._logGeometryCreationWarnings(m,s,f,"LineSymbol3DLayer");for(const _ of m.lines){if(Mi(u),Jo(u,_.position),!Lc(u,this._context.clippingExtent))continue;X0(d,u);const g=this._createGeometry(e,_.position,null,n.type,nw.DRAPED,r.uid),x=v=>{const w=new hv(g,v,{layerUid:t,graphicUid:r.uid});return c.push(w),w};if(y(l)){const v=x(l),w=ct(this.symbolLayer.marker).placement;w!=="begin"&&w!=="begin-end"||Jo(u,_.position,0,1),w!=="end"&&w!=="begin-end"||Jo(u,_.position,_.position.length-3,1),this._updateBoundingSphere(v,u)}const b=x(a);if(this._updateBoundingSphere(b,u),jt.LINE_WIREFRAMES){const v=x(o);this._updateBoundingSphere(v,u)}}return new $R(this,c,d,this._context.drapeSourceRenderer)}_updateBoundingSphere(e,t){Qs(e.boundingSphere,.5*(t[0]+t[3]),.5*(t[1]+t[4]),0,.5*Math.sqrt((t[3]-t[0])*(t[3]-t[0])+(t[4]-t[1])*(t[4]-t[1])))}get _patternHidesLine(){const e=this.symbolLayer.pattern;return y(e)&&e.type==="style"&&e.style==="none"}_computeMaterialWidth(e){return e=je(e,sI(1)),this._drivenProperties.size?this._fastUpdates.enabled&&this._fastUpdates.visualVariables.size?Sa(1):1:Sa(e)}_prepareMaterialPatch(e,t,r){const n=t.material;if(S(n))return void(r.changed&&r.useMaterialColor&&this._patchMaterialColor(this._getCombinedOpacityAndColor(this._materialColor),this._markerMaterialCached,e));if(n.type==="collection")return;const s=n.type==="complete"?co(n.newValue,o=>o.color):n.diff.color.type==="complete"?n.diff.color.newValue:null,a=this._getCombinedOpacityAndColor(s);r.useMaterialColor&&this._patchMaterialColor(xD(a),this._markerMaterialCached,e),this._patternHidesLine&&(a[3]=0),this._patchMaterialColor(a,this._lineMaterialCached,e),delete t.material}_prepareMarkerPatch(e,t){const r=t.marker;if(S(r)||r.type!=="partial"||y(r.diff.style)||y(r.diff.placement)||y(r.diff.color)&&r.diff.color.type!=="complete")return{changed:!1,useMaterialColor:S(this._markerColor)};const n=r.diff.color;if(S(n))return delete t.marker,{changed:!1,useMaterialColor:S(this._markerColor)};const s=ct(n.newValue);return S(s)?(delete t.marker,{changed:!0,useMaterialColor:!0}):(this._patchMaterialColor(this._getCombinedOpacityAndColor(s),this._markerMaterialCached,e),delete t.marker,{changed:!0,useMaterialColor:!1})}_patchMaterialColor(e,t,r){S(t)||r.symbolLayerStatePatches.push(()=>t.setParameters({color:e}))}};var nw;tK.elevationModeChangeTypes={definedChanged:Zi.RECREATE,staysOnTheGround:Zi.NONE,onTheGroundChanged:Zi.RECREATE},function(i){i[i.DRAPED=0]="DRAPED",i[i.ELEVATED=1]="ELEVATED"}(nw||(nw={}));let rK=class nK extends ti{get _stippleEnabled(){return this.configuration.stippleEnabled&&this.configuration.output!==k.Highlight}initializeConfiguration(e,t){t.hasWebGL2Context=e.rctx.type===Nn.WEBGL2}initializeProgram(e){return new Jt(e.rctx,nK.shader.get().build(this.configuration),ai)}initializePipeline(){const e=this.configuration,t=Gn(de.SRC_ALPHA,de.ONE,de.ONE_MINUS_SRC_ALPHA,de.ONE_MINUS_SRC_ALPHA),r=(n,s=null,a=null)=>Ke({blending:s,depthTest:DD,depthWrite:a,colorWrite:ht,stencilWrite:e.hasOccludees?Cd:null,stencilTest:e.hasOccludees?n?Ig:r_:null});return e.output===k.Color?(this._occludeePipelineState=r(!0,e.transparent||this._stippleEnabled?t:null,nl),r(!1,e.transparent||this._stippleEnabled?t:null,nl)):r(!1)}get primitiveType(){return Dt.LINES}getPipelineState(e,t){return t?this._occludeePipelineState:super.getPipelineState(e,t)}};rK.shader=new ii(nae,()=>G(()=>import("./NativeLine.glsl-c0fa9712.js"),["assets/NativeLine.glsl-c0fa9712.js","assets/Matrix3PassUniform-ad9f953b.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/mat4-44a0988f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/mat4f64-1e28eae0.js","assets/vec3-e93e648f.js","assets/mat3f64-c6305894.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/vec4f64-e407da96.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/Texture2DPassUniform-753de459.js","assets/LineStipple.glsl-ed22a88b.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/Float4PassUniform-d7bdbc81.js","assets/FloatPassUniform-68d54f51.js","assets/floatRGBA-9ad35d39.js","assets/mathUtils-b4bb77e2.js","assets/vec4-790471c0.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/NativeLine.glsl-742e9e29.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/VertexColor.glsl-8c022fa8.js","assets/OutputHighlight.glsl-fbac199a.js","assets/AlphaCutoff-96178e0d.js"]));let Lo=class extends cu{constructor(){super(...arguments),this.output=k.Color,this.hasSlicePlane=!1,this.hasVertexColors=!1,this.transparent=!1,this.draped=!1,this.stippleEnabled=!1,this.stippleOffColorEnabled=!1,this.stipplePreferContinuous=!0,this.hasOccludees=!1}};h([N({count:k.COUNT})],Lo.prototype,"output",void 0),h([N()],Lo.prototype,"hasSlicePlane",void 0),h([N()],Lo.prototype,"hasVertexColors",void 0),h([N()],Lo.prototype,"transparent",void 0),h([N()],Lo.prototype,"draped",void 0),h([N()],Lo.prototype,"stippleEnabled",void 0),h([N()],Lo.prototype,"stippleOffColorEnabled",void 0),h([N()],Lo.prototype,"stipplePreferContinuous",void 0),h([N()],Lo.prototype,"hasOccludees",void 0),h([N({constValue:!1})],Lo.prototype,"stippleRequiresClamp",void 0),h([N({constValue:!1})],Lo.prototype,"stippleScaleWithLineWidth",void 0),h([N({constValue:!1})],Lo.prototype,"stippleRequiresStretchMeasure",void 0);var sP;(function(i){i[i.START=0]="START",i[i.END=1]="END"})(sP||(sP={}));let C8=class extends Fd{constructor(e){super(e,new rSe),this._configuration=new Lo}getConfiguration(e,t){this._configuration.output=e,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.hasVertexColors=this.parameters.hasVertexColors,this._configuration.transparent=this.parameters.color[3]<1||this.parameters.width<1,this._configuration.draped=t.slot===ae.DRAPED_MATERIAL;const r=y(this.parameters.stipplePattern);return this._configuration.stippleEnabled=r,this._configuration.stippleOffColorEnabled=r&&y(this.parameters.stippleOffColor),this._configuration.hasOccludees=this.parameters.hasOccludees,this._configuration.stipplePreferContinuous=this.parameters.stipplePreferContinuous,this._configuration}intersect(e,t,r,n,s,a,o,l,c){y(c)?nne(e,n,c,a,1,o):this._intersectLineGeometry(e,t,r,n,o)}_intersectLineGeometry(e,t,r,n,s){if(!n.options.selectionMode||MP(t))return;if(!jG(r))return void J.getLogger("esri.views.3d.webgl-engine.materials.NativeLineMaterial").error("intersection assumes a translation-only matrix");const a=e.vertexAttributes.get(P.POSITION).data,o=n.camera,l=sSe;wn(l,n.point);const c=2;Z(_1[0],l[0]-c,l[1]+c,0),Z(_1[1],l[0]+c,l[1]+c,0),Z(_1[2],l[0]+c,l[1]-c,0),Z(_1[3],l[0]-c,l[1]-c,0);for(let _=0;_<4;_++)if(!o.unprojectFromRenderScreen(_1[_],Cu[_]))return;Bh(o.eye,Cu[0],Cu[1],uM),Bh(o.eye,Cu[1],Cu[2],dM),Bh(o.eye,Cu[2],Cu[3],pM),Bh(o.eye,Cu[3],Cu[0],mM);let u=Number.MAX_VALUE,d=0;for(let _=0;_<a.length-5;_+=3){if(Vs[0]=a[_]+r[12],Vs[1]=a[_+1]+r[13],Vs[2]=a[_+2]+r[14],Us[0]=a[_+3]+r[12],Us[1]=a[_+4]+r[13],Us[2]=a[_+5]+r[14],tr(uM,Vs)<0&&tr(uM,Us)<0||tr(dM,Vs)<0&&tr(dM,Us)<0||tr(pM,Vs)<0&&tr(pM,Us)<0||tr(mM,Vs)<0&&tr(mM,Us)<0)continue;if(o.projectToRenderScreen(Vs,pf),o.projectToRenderScreen(Us,mf),pf[2]<0&&mf[2]>0){ne(ah,Vs,Us);const x=o.frustum,b=-tr(x[hr.NEAR],Vs)/me(ah,Ia(x[hr.NEAR]));Q(ah,ah,b),oe(Vs,Vs,ah),o.projectToRenderScreen(Vs,pf)}else if(pf[2]>0&&mf[2]<0){ne(ah,Us,Vs);const x=o.frustum,b=-tr(x[hr.NEAR],Us)/me(ah,Ia(x[hr.NEAR]));Q(ah,ah,b),oe(Us,Us,ah),o.projectToRenderScreen(Us,mf)}else if(pf[2]<0&&mf[2]<0)continue;pf[2]=0,mf[2]=0;const g=wD(fg(pf,mf,P8),l);g<u&&(u=g,q(S8,Vs),q(E8,Us),d=_/3)}const m=n.rayBegin,f=n.rayEnd;if(u<c*c){let _=Number.MAX_VALUE;if(uG(fg(S8,E8,P8),fg(m,f,nSe),df)){ne(df,df,m);const g=_e(df);Q(df,df,1/g),_=g/Ii(m,f)}s(_,df,d,!1)}}computeAttachmentOrigin(e,t){const r=e.vertexAttributes;if(!r)return!1;const n=r.get(P.POSITION);return FD(n,null,!1,t)}requiresSlot(e,t){return!(t!==k.Color&&t!==k.Highlight&&t!==k.ObjectAndLayerIdColor||e!==ae.OPAQUE_MATERIAL&&e!==ae.DRAPED_MATERIAL)}createGLMaterial(e){return new tSe(e)}createBufferWriter(){const e=this.parameters.hasVertexColors?DY:ETe;return S(this.parameters.stipplePattern)?new LR(e):new iSe(e.clone().vec3f(P.AUXPOS1).vec2f(P.UV0))}},tSe=class extends t_{constructor(){super(...arguments),this._stipplePattern=null}dispose(){super.dispose(),this._stippleTextureRepository.release(this._stipplePattern),this._stipplePattern=null}_updateOccludeeState(e){e.hasOccludees!==this._material.parameters.hasOccludees&&this._material.setParameters({hasOccludees:e.hasOccludees})}beginSlot(e){this._output===k.Color&&this._updateOccludeeState(e);const t=this._material.parameters.stipplePattern;return this._stipplePattern!==t&&(this._material.setParameters(this._stippleTextureRepository.swap(this._stipplePattern,t)),this._stipplePattern=t),this.ensureTechnique(rK,e)}},iSe=class{constructor(e){this.vertexBufferLayout=e}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){return e.indices.get(P.POSITION).length}write(e,t,r,n,s){kD(r,this.vertexBufferLayout,e,t,n,s),this._writeAuxpos1(e,r,n,s),this._writeUV0(e,r,n,s)}_writeAuxpos1(e,t,r,n){const s=r.getField(P.AUXPOS1,Dm),a=t.indices.get(P.POSITION),o=t.vertexAttributes.get(P.POSITION).data,l=e,c=s.typedBufferStride,u=s.typedBuffer;n*=c;for(let d=0;d<a.length-1;d+=2)for(const m of[1,0]){const f=3*a[d+m],_=o[f],g=o[f+1],x=o[f+2],b=l[0]*_+l[4]*g+l[8]*x+l[12],v=l[1]*_+l[5]*g+l[9]*x+l[13],w=l[2]*_+l[6]*g+l[10]*x+l[14];u[n]=b,u[n+1]=v,u[n+2]=w,n+=c}}_writeUV0(e,t,r,n){var w;const s=r.getField(P.UV0,JG),a=t.indices.get(P.POSITION),o=t.vertexAttributes.get(P.POSITION).data,l=(w=t.vertexAttributes.get(P.DISTANCETOSTART))==null?void 0:w.data,c=s.typedBufferStride,u=s.typedBuffer;let d=0;u[n*=c]=sP.START,u[n+1]=d,n+=c;const m=3*a[0],f=Z(Vs,o[m],o[m+1],o[m+2]);e&&Ce(f,f,e);const _=Us,g=a.length-1;let x=1;const b=l?(T,E,C)=>d=l[C]:(T,E,C)=>d+=Ii(T,E);for(let T=1;T<g;T+=2){const E=3*a[T];Z(_,o[E],o[E+1],o[E+2]),e&&Ce(_,_,e),b(f,_,x++);for(let C=0;C<2;++C)u[n]=1-C,u[n+1]=d,n+=c;q(f,_)}const v=3*a[g];Z(_,o[v],o[v+1],o[v+2]),e&&Ce(_,_,e),b(f,_,x),u[n]=sP.END,u[n+1]=d}},rSe=class extends Vx{constructor(){super(...arguments),this.color=Rc,this.hasVertexColors=!1,this.hasSlicePlane=!1,this.width=1,this.stipplePreferContinuous=!0,this.hasOccludees=!1,this.stippleTexture=null}};const Vs=R(),Us=R(),ah=R(),df=R(),pf=is(),mf=is(),S8=R(),E8=R(),P8=fv(),nSe=fv(),sSe=R(),_1=[is(),is(),is(),is()],Cu=[R(),R(),R(),R()],uM=fr(),dM=fr(),pM=fr(),mM=fr(),aSe=["mesh"];let oSe=class extends du{constructor(e,t,r,n){super(e,t,r,n),this._materials=new Map,this._textures=new Map,this.ensureDrapedStatus(!1)}async doLoad(){jt.DRAW_MESH_GEOMETRY_NORMALS&&(this._debugVertexNormalMaterial=new C8({color:[1,0,1,1]}),this._debugFaceNormalMaterial=new C8({color:[0,1,1,1]}))}destroy(){super.destroy(),this._context.stage.removeMany(Array.from(this._materials.values(),e=>e.material)),this._context.stage.removeMany(Array.from(this._textures.values())),this._materials.clear(),this._textures.clear()}createGraphics3DGraphic(e){const t=e.graphic;if(!this._validateGeometry(t.geometry,aSe,"fill on mesh-3d"))return null;const r=this.setGraphicElevationContext(t,new Qc),n=e.renderingInfo;return this._createAs3DShape(t,n,r,t.uid)}layerOpacityChanged(e,t){const r=this._getLayerOpacity();this._materials.forEach(n=>{n.material.setParameters({layerOpacity:r});const s=n.material.parameters;this._setMaterialTransparentParameter(s,n),n.material.setParameters({transparent:s.transparent})}),e.forEach(n=>{const s=t(n);y(s)&&s.layerOpacityChanged(r,this._context.isAsync)})}layerElevationInfoChanged(e,t){return this.updateGraphics3DGraphicElevationInfo(e,t,zm)}slicePlaneEnabledChanged(e,t){return this._materials.forEach(r=>{r.material.setParameters({hasSlicePlane:this._context.slicePlaneEnabled})}),e.forEach(r=>{const n=t(r);y(n)&&n.slicePlaneEnabledChanged(this._context.slicePlaneEnabled,this._context.isAsync)}),!0}physicalBasedRenderingChanged(){const e=this._usePBR();return this._materials.forEach(t=>t.material.setParameters({usePBR:e})),!0}pixelRatioChanged(){return!0}_requiresSymbolVertexColors(){return this._drivenProperties.color||this._drivenProperties.opacity}_colorOrTextureUid(e){return S(e)?"-":e instanceof ei?e.toHex():e.contentHash}_materialPropertiesDefault(e,t){const r=this._requiresSymbolVertexColors(),n=!!e.vertexAttributes.color,s=!!e.vertexAttributes.tangent;return{hasSymbolVertexColors:r,hasVertexColors:n,hasVertexTangents:s,uid:`vc:${n},vt:${s},vct${t},svc:${r}`}}_materialProperties(e,t,r){const n=this._materialPropertiesDefault(e,r);if(!t.material)return n;const{color:s,colorTexture:a,normalTexture:o,doubleSided:l,alphaCutoff:c,alphaMode:u}=t.material,d=this._colorOrTextureUid(s),m=this._colorOrTextureUid(a),f=this._colorOrTextureUid(o);if(n.color=s,n.colorTexture=a,n.normalTexture=o,n.uid=`${n.uid},cmuid:${d},ctmuid:${m},ntmuid:${f},ds:${l},ac:${c},am:${u}`,t.material instanceof $se){const{metallic:_,roughness:g,metallicRoughnessTexture:x,emissiveColor:b,emissiveTexture:v,occlusionTexture:w}=t.material,T=this._colorOrTextureUid(x),E=this._colorOrTextureUid(b),C=this._colorOrTextureUid(v),A=this._colorOrTextureUid(w);n.metallic=_,n.roughness=g,n.metallicRoughnessTexture=x,n.emissiveColor=b,n.emissiveTexture=v,n.occlusionTexture=w,n.colorTextureTransform=t.material.colorTextureTransform,n.normalTextureTransform=t.material.normalTextureTransform,n.emissiveTextureTransform=t.material.emissiveTextureTransform,n.occlusionTextureTransform=t.material.occlusionTextureTransform,n.metallicRoughnessTextureTransform=t.material.metallicRoughnessTextureTransform,n.uid=`${n.uid},mrm:${_},mrr:${g},mrt:${T},emuid:${E},etmuid:${C},otmuid:${A}`}return n}_setInternalColorValueParameters(e,t){t.diffuse=ei.toUnitRGB(e),t.opacity=e.a}_getLoadableTextureResource(e){return e.data?e.data:e.url}_getInternalTextureId(e){const t=this._getInternalTexture(e,Ho.Opaque);return y(t)?t.id:null}_getInternalTexture(e,t){const r=this._getLoadableTextureResource(e);if(!r)return null;const n=`${e.contentHash}/${t}`;let s=this._textures.get(n);return s||(s=new FP(r,{mipmap:!0,wrap:this._castTextureWrap(e.wrap),noUnpackFlip:!0,preMultiplyAlpha:t!==Ho.Opaque}),this._textures.set(n,s),this._context.stage.add(s),this._context.stage.loadImmediate(s)),s}_castTextureWrap(e="repeat"){if(typeof e=="string"){const t=this._castTextureWrapIndividual(e);return{s:t,t}}return{s:this._castTextureWrapIndividual(e.horizontal),t:this._castTextureWrapIndividual(e.vertical)}}_castTextureWrapIndividual(e){switch(e){case"clamp":return si.CLAMP_TO_EDGE;case"mirror":return si.MIRRORED_REPEAT;default:return si.REPEAT}}_setInternalMaterialParameters(e,t){if(y(e.color)&&this._setInternalColorValueParameters(e.color,t),y(e.colorTexture)){const r=this._getInternalTexture(e.colorTexture,t.textureAlphaMode);y(r)?(t.textureId=r.id,t.textureAlphaPremultiplied=!!r.params.preMultiplyAlpha):t.textureId=void 0}y(e.normalTexture)&&(t.normalTextureId=this._getInternalTextureId(e.normalTexture)),y(e.emissiveColor)&&(t.emissiveFactor=ei.toUnitRGB(e.emissiveColor)),y(e.emissiveTexture)&&(t.emissiveTextureId=this._getInternalTextureId(e.emissiveTexture)),y(e.occlusionTexture)&&(t.occlusionTextureId=this._getInternalTextureId(e.occlusionTexture)),y(e.metallicRoughnessTexture)&&(t.metallicRoughnessTextureId=this._getInternalTextureId(e.metallicRoughnessTexture)),t.colorTextureTransformMatrix=Fv(e.colorTextureTransform),t.normalTextureTransformMatrix=Fv(e.normalTextureTransform),t.occlusionTextureTransformMatrix=Fv(e.occlusionTextureTransform),t.emissiveTextureTransformMatrix=Fv(e.emissiveTextureTransform),t.metallicRoughnessTextureTransformMatrix=Fv(e.metallicRoughnessTextureTransform)}_setExternalMaterialParameters(e){const t=this._drivenProperties.color;let r=y(this.symbolLayer.material)?this.symbolLayer.material.colorMixMode:null;if(t)e.externalColor=Rc;else{const n=y(this.symbolLayer.material)?this.symbolLayer.material.color:null;y(n)?e.externalColor=ei.toUnitRGBA(n):(r=null,e.externalColor=Rc)}r&&(e.colorMixMode=r),e.castShadows=!!this.symbolLayer.castShadows}_hasTransparentVertexColors(e){const t=e.vertexAttributes.color;if(S(t))return!1;for(let r=3;r<t.length;r+=4)if(t[r]!==255)return!0;return!1}_getOrCreateMaterial(e,t){var _,g,x;const r=(_=t.material)==null?void 0:_.color,n=(g=t.material)==null?void 0:g.colorTexture,s=(x=t.material)==null?void 0:x.alphaMode,a=s==="blend",o=s!=="opaque"&&(this._hasTransparentVertexColors(e)||y(r)&&r.a<1||y(n)&&n.transparent||a),l=this._materialProperties(e,t,o),c=this._materials.get(l.uid);if(c)return c.material;const u={material:null,isComponentTransparent:o,alphaMode:t.material?t.material.alphaMode:"opaque"},d=l.metallicRoughnessTexture==null&&l.metallic==null&&l.roughness==null,m={usePBR:this._usePBR(),isSchematic:d,hasVertexColors:l.hasVertexColors,hasSymbolColors:l.hasSymbolVertexColors,hasVertexTangents:l.hasVertexTangents,ambient:Gl,diffuse:em,opacity:1,doubleSided:!0,doubleSidedType:"winding-order",cullFace:tn.None,layerOpacity:this._getLayerOpacity(),hasSlicePlane:this._context.slicePlaneEnabled,initTextureTransparent:!0};d||(m.mrrFactors=[l.metallic!=null?l.metallic:1,l.roughness!=null?l.roughness:1,.5]),t.material&&(m.doubleSided=t.material.doubleSided,m.cullFace=t.material.doubleSided?tn.None:tn.Back,m.textureAlphaCutoff=t.material.alphaCutoff),this._setExternalMaterialParameters(m),this._setMaterialTransparentParameter(m,u),this._setInternalMaterialParameters(l,m);const f=new Ew(m);return u.material=f,this._materials.set(l.uid,u),this._context.stage.add(f),f}_usePBR(){return this._context.physicalBasedRenderingEnabled}_setMaterialTransparentParameter(e,t){e.transparent=this.needsDrivenTransparentPass||t.isComponentTransparent||e.layerOpacity<1||e.opacity<1||e.externalColor&&e.externalColor[3]<1,t.alphaMode==="auto"?e.textureAlphaMode=e.transparent?Ho.MaskBlend:Ho.Opaque:e.textureAlphaMode=t.alphaMode==="opaque"?Ho.Opaque:t.alphaMode==="mask"?Ho.Mask:Ho.Blend}_addDebugNormals(e,t,r,n){const s=t.length,a=e.spatialReference.isGeographic?20015077/180:1,o=.1*Math.max(e.extent.width*a,e.extent.height*a,e.extent.zmax-e.extent.zmin),l=[],c=[],u=[],d=[];for(let _=0;_<s;_++){const g=t[_],x=g.vertexAttributes.get(P.POSITION),b=g.vertexAttributes.get(P.NORMAL),v=g.indices.get(P.POSITION),w=g.indices.get(P.NORMAL),T=x.data,E=b.data;for(let C=0;C<v.length;C++){const A=3*v[C],M=3*w[C];for(let I=0;I<3;I++)l.push(T[A+I]);for(let I=0;I<3;I++)l.push(T[A+I]+E[M+I]*o);if(c.push(c.length),c.push(c.length),C%3==0){this._calculateFaceNormal(T,v,C,X_),this._getFaceVertices(T,v,C,Xn,q_,W_),oe(Xn,Xn,q_),oe(Xn,Xn,W_),Q(Xn,Xn,1/3);for(let I=0;I<3;I++)u.push(Xn[I]);for(let I=0;I<3;I++)u.push(Xn[I]+X_[I]*o);d.push(d.length),d.push(d.length)}}}const m=new jr([[P.POSITION,{data:l,size:3,exclusive:!0}]],[[P.POSITION,c]],Fc.Line);t.push(m),r.push(this._debugVertexNormalMaterial),n.push(_S(n[0]));const f=new jr([[P.POSITION,{data:u,size:3,exclusive:!0}]],[[P.POSITION,d]],Fc.Line);t.push(f),r.push(this._debugFaceNormalMaterial),n.push(_S(n[0]))}_createAs3DShape(e,t,r,n){const s=e.geometry;if(s.type!=="mesh")return null;const a=this._createGeometryInfo(s,t,n);if(!a)return null;const{geometries:o,materials:l,transformations:c,objectTransformation:u}=a;jt.DRAW_MESH_GEOMETRY_NORMALS&&this._addDebugNormals(s,o,l,c);const d=new Bd({geometries:o,materials:l,transformations:c,metadata:{layerUid:this._context.layer.uid,graphicUid:n}});d.transformation=u;const m=this._createEdgeMaterial(),f=y(m)?{baseMaterial:l[0],edgeMaterials:[m],properties:{mergeGeometries:!0,hasSlicePlane:this._context.slicePlaneEnabled}}:null,_=new uu(this,d,o,null,null,hx,r,f);return _.needsElevationUpdates=zm(r.mode),_.useObjectOriginAsAttachmentOrigin=!0,_.elevationContext.centerPointInElevationSR=this._getCenterPointInElevationSR(d),_.alignedSampledElevation=hx(_,_.elevationContext,this._context.elevationProvider,this._context.renderCoordsHelper),_}_getCenterPointInElevationSR(e){const t=kd(0,0,0,y(this._context.elevationProvider.spatialReference)?this._context.elevationProvider.spatialReference:null);return P7([e.transformation[12],e.transformation[13],e.transformation[14]],this._context.renderCoordsHelper.spatialReference,t),t}_createComponentNormals(e,t,r,n){switch(r.shading||"flat"){case"source":return this._createComponentNormalsSource(e,t,r,n);case"flat":return this._createComponentNormalsFlat(e,n);case"smooth":return this._createComponentNormalsSmooth(e,n);default:return}}_createComponentNormalsSource(e,t,r,n){if(S(t))return this._createComponentNormalsFlat(e,n);let s=!1;if(!r.trustSourceNormals)for(let a=0;a<n.length;a+=3){this._calculateFaceNormal(e,n,a,X_);for(let o=0;o<3;o++){const l=3*n[a+o];Xn[0]=t[l+0],Xn[1]=t[l+1],Xn[2]=t[l+2],me(X_,Xn)<0&&(t[l+0]=-t[l+0],t[l+1]=-t[l+1],t[l+2]=-t[l+2],s=!0)}}return{normals:t,indices:n,didFlipNormals:s}}_createComponentNormalsFlat(e,t){const r=new Float32Array(t.length),n=new Array(3*t.length);for(let s=0;s<t.length;s+=3){const a=this._calculateFaceNormal(e,t,s,X_);for(let o=0;o<3;o++)r[s+o]=a[o],n[s+o]=s/3}return{normals:r,indices:n,didFlipNormals:!1}}_createComponentNormalsSmooth(e,t){const r={};for(let a=0;a<t.length;a+=3){const o=this._calculateFaceNormal(e,t,a,X_);for(let l=0;l<3;l++){const c=t[a+l];let u=r[c];u||(u={normal:R(),count:0},r[c]=u),oe(u.normal,u.normal,o),u.count++}}const n=new Float32Array(3*t.length),s=new Array(3*t.length);for(let a=0;a<t.length;a++){const o=r[t[a]];o.count!==1&&(he(o.normal,o.normal),o.count=1);for(let l=0;l<3;l++)n[3*a+l]=o.normal[l];s[a]=a}return{normals:n,indices:s,didFlipNormals:!1}}_getFaceVertices(e,t,r,n,s,a){const o=3*t[r+0],l=3*t[r+1],c=3*t[r+2];n[0]=e[o+0],n[1]=e[o+1],n[2]=e[o+2],s[0]=e[l+0],s[1]=e[l+1],s[2]=e[l+2],a[0]=e[c+0],a[1]=e[c+1],a[2]=e[c+2]}_calculateFaceNormal(e,t,r,n){return this._getFaceVertices(e,t,r,Xn,q_,W_),ne(q_,q_,Xn),ne(W_,W_,Xn),nt(Xn,q_,W_),he(n,Xn),n}_getOrCreateComponents(e){return je(e.components,lSe)}_createPositionBuffer(e,t){let r=e.vertexAttributes.position;const n=t.reprojection===Fo.ECEF?t.transformBeforeProject:null;if(y(n)&&(r=ese(r,new Float64Array(r.length),n)),t.reprojection===Fo.NONE)return t.needsBufferCopy?new Float64Array(r):r;const s=y(n)?r:new Float64Array(r.length);return Ma(r,e.spatialReference,0,s,this._context.renderCoordsHelper.spatialReference,0,r.length/3),s}_createNormalBuffer(e,t,r){let n=e.vertexAttributes.normal;if(S(n))return null;const s=r.reprojection===Fo.ECEF?r.transformBeforeProject:null;if(y(s)&&(n=tse(n,new Float32Array(n.length),s)),this._context.graphicsCoreOwner.view.viewingMode==="local"||r.reprojection===Fo.NONE)return r.needsBufferCopy&&e.vertexAttributes.normal===n?new Float32Array(n):n;const a=e.vertexAttributes.position,o=y(s)?n:new Float32Array(n.length);return ise(n,a,t,e.spatialReference,o)}_createTangentBuffer(e,t,r){let n=e.vertexAttributes.tangent;if(S(n))return null;const s=r.reprojection===Fo.ECEF?r.transformBeforeProject:null;if(y(s)&&(n=rse(n,new Float32Array(n.length),s)),this._context.graphicsCoreOwner.view.viewingMode==="local"||r.reprojection===Fo.NONE)return r.needsBufferCopy&&e.vertexAttributes.normal===n?new Float32Array(n):n;const a=e.vertexAttributes.position,o=y(s)?n:new Float32Array(n.length);return nse(n,a,t,e.spatialReference,o)}_createColorBuffer(e){return e.vertexAttributes.color}_createSymbolColorBuffer(e){if(this._requiresSymbolVertexColors()){const t=this._getVertexOpacityAndColor(e),r=rae(en(this.symbolLayer,"material","colorMixMode")),n=new Uint8Array(4);return lH(t,r,n),n}return null}_createBuffers(e,t){const r=e.vertexAttributes&&e.vertexAttributes.position;if(!r)return this.logger.warn("Mesh geometry must contain position vertex attributes"),null;const n=e.vertexAttributes.normal,s=e.vertexAttributes.uv,a=e.vertexAttributes.tangent;if(y(n)&&n.length!==r.length)return this.logger.warn("Mesh normal vertex buffer must contain the same number of elements as the position buffer"),null;if(y(a)&&a.length/4!=r.length/3)return this.logger.warn("Mesh tangent vertex buffer must contain the same number of elements as the position buffer"),null;if(y(s)&&s.length/2!=r.length/3)return this.logger.warn("Mesh uv vertex buffer must contain the same number of elements as the position buffer"),null;const o=this._computeReprojectionInfo(e),l=this._createPositionBuffer(e,o),c=this._createColorBuffer(e),u=this._createSymbolColorBuffer(t),d=this._createNormalBuffer(e,l,o),m=this._createTangentBuffer(e,l,o);return{positionBuffer:l,normalBuffer:d,tangentBuffer:m,uvBuffer:s,colorBuffer:c,symbolColorBuffer:u,objectTransformation:o.reprojection===Fo.NONE&&y(o.objectTransformation)?o.objectTransformation:this._transformOriginLocal(e,l,d,m),geometryTransformation:o.reprojection===Fo.NONE&&y(o.geometryTransformation)?o.geometryTransformation:ve()}}_computeReprojectionInfo(e){const t=y(e.transform),r=t&&e.transform.geographic||this._context.renderCoordsHelper.viewingMode===Se.Local?Fo.NONE:Fo.ECEF;if(t){if(r===Fo.NONE){const s=ve();return xd(e.spatialReference,e.transform.origin,s,this._context.renderCoordsHelper.spatialReference),{reprojection:r,objectTransformation:s,geometryTransformation:_S(e.transform.localMatrix),needsBufferCopy:!1}}const n=oG(ve(),e.transform.origin);return Hr(n,n,e.transform.localMatrix),{reprojection:r,transformBeforeProject:n,needsBufferCopy:!0}}return{reprojection:r,needsBufferCopy:!0}}_transformOriginLocal(e,t,r,n){const s=this._context.renderCoordsHelper.spatialReference,a=e.anchor;AC[0]=a.x,AC[1]=a.y,AC[2]=a.z;const o=ve();xd(e.spatialReference,AC,o,s);const l=$m.fromTypedArray(t);if(kn(R8,o),iH(l,l,R8),y(r)||y(n)){if(Td(y1,o),qc(y1,y1),y(r)){const c=Dm.fromTypedArray(r);GE(c,c,y1)}if(y(n)){const c=Dm.fromTypedArray(n,4*n.BYTES_PER_ELEMENT);GE(c,c,y1)}}return o}_validateFaces(e,t){const r=e.vertexAttributes.position.length/3,n=t.faces;if(n){let s=-1;for(let a=0;a<n.length;a++){const o=n[a];o>s&&(s=o)}if(r<=s)return this.logger.warn(`Vertex index ${s} is out of bounds of the mesh position buffer`),!1}else if(r%3!=0)return this.logger.warn("Mesh position buffer length must be a multiple of 9 if no component faces are defined (3 values per vertex * 3 vertices per triangle)"),!1;return!0}_getOrCreateFaces(e,t){return t.faces?t.faces:zD(e.vertexAttributes.position.length/3)}_isOutsideClippingArea(e){if(!this._context.clippingExtent)return!1;const t=e.vertexAttributes&&e.vertexAttributes.position;if(!t)return!1;const r=this._context.elevationProvider.spatialReference;let n;const s=t.length/3;return y(r)&&!e.spatialReference.equals(r)?(n=new Float64Array(t.length),Ma(e.vertexAttributes.position,e.spatialReference,0,n,r,0,s)):n=t,Mi(fM),Jo(fM,n,0,s),!Lc(fM,this._context.clippingExtent)}_createGeometryInfo(e,t,r){if(!pv(e.spatialReference,this._context.graphicsCoreOwner.view.spatialReference))return this.logger.warn("Geometry spatial reference is not compatible with the view"),null;if(this._isOutsideClippingArea(e))return null;const n=this._createBuffers(e,t);if(S(n))return null;const{positionBuffer:s,uvBuffer:a,colorBuffer:o,symbolColorBuffer:l,normalBuffer:c,tangentBuffer:u,objectTransformation:d,geometryTransformation:m}=n,f=this._getOrCreateComponents(e),_=[],g=[],x=[];let b=!1;for(const v of f){if(!this._validateFaces(e,v))return null;const w=this._getOrCreateFaces(e,v);if(w.length===0)continue;const T=this._createComponentNormals(s,c,v,w);T.didFlipNormals&&(b=!0);const E=[[P.POSITION,{size:3,data:s,exclusive:!0}],[P.NORMAL,{size:3,data:T.normals,exclusive:!0}]],C=[[P.POSITION,w],[P.NORMAL,T.indices]];y(o)&&(E.push([P.COLOR,{size:4,data:o,exclusive:!0}]),C.push([P.COLOR,w])),y(l)&&(E.push([P.SYMBOLCOLOR,{size:4,data:l,exclusive:!0}]),C.push([P.SYMBOLCOLOR,new Array(w.length).fill(0)])),y(a)&&(E.push([P.UV0,{size:2,data:a,exclusive:!0}]),C.push([P.UV0,w])),y(u)&&(E.push([P.TANGENT,{size:4,data:u,exclusive:!0}]),C.push([P.TANGENT,w]));const A=this._context.stage.renderView._getObjectAndLayerIdColor({graphicUid:r,layerUid:this._context.layer.uid}),M=new jr(E,C,Fc.Triangle,A);_.push(M),g.push(m),x.push(this._getOrCreateMaterial(e,v))}return b&&this.logger.warn("Normals have been automatically flipped to be consistent with the counter clock wise face winding order. It is better to generate mesh geometries that have consistent normals."),{geometries:_,transformations:g,materials:x,objectTransformation:d}}_createEdgeMaterial(){const e={opacity:this._getLayerOpacity()};return tH(this.symbolLayer,e)}};const AC=R(),Xn=R(),q_=R(),W_=R(),X_=R(),R8=ve(),y1=Or(),fM=Ms(),lSe=[new Lse];var Fo;(function(i){i[i.NONE=0]="NONE",i[i.ECEF=1]="ECEF"})(Fo||(Fo={}));let cSe=class{constructor(e,t,r,n){this.graphics3DSymbolLayer=e,this.instanceIndex=t,this.elevationAligner=r,this.elevationContext=n,this.type="lod-instance",this._highlights=new Set,this.alignedSampledElevation=0,this.isElevationSource=!1,this.needsElevationUpdates=!1}initialize(){}setVisibility(e){const t=this._lodRenderer.instanceData;e!==t.getVisible(this.instanceIndex)&&t.setVisible(this.instanceIndex,e)}destroy(){this.instanceIndex!=null&&(this._lodRenderer.instanceData.removeInstance(this.instanceIndex),this.graphics3DSymbolLayer.notifyDestroyGraphicLayer(this))}alignWithElevation(e,t,r){if(this.elevationAligner){o4(this.elevationContext.featureExpressionInfoContext,r);const n=this.elevationAligner(this,this.elevationContext,e,t);y(n)&&(this.alignedSampledElevation=n)}}getCenterObjectSpace(e=R()){return this._lodRenderer.instanceData.getCombinedLocalTransform(this.instanceIndex,oh),Ce(e,this._lodRenderer.baseBoundingSphere.center,oh)}getBoundingBoxObjectSpace(e=Ms()){this._lodRenderer.instanceData.getCombinedLocalTransform(this.instanceIndex,oh);const t=this._lodRenderer.baseBoundingBox;Mi(e);for(let r=0;r<8;++r)Z(dl,1&r?t[3]:t[0],2&r?t[4]:t[1],4&r?t[5]:t[2]),Ce(dl,dl,oh),W0(e,dl);return e}computeAttachmentOrigin(e){this._lodRenderer.instanceData.getGlobalTransform(this.instanceIndex,oh),e.render.origin[0]+=oh[12],e.render.origin[1]+=oh[13],e.render.origin[2]+=oh[14],e.render.num++}async getProjectedBoundingBox(e,t,r,n,s){const a=this.getBoundingBoxObjectSpace(s),o=hSe,l=BD(a)?1:o.length;this._lodRenderer.instanceData.getGlobalTransform(this.instanceIndex,oh);for(let u=0;u<l;u++){const d=o[u];dl[0]=a[d[0]],dl[1]=a[d[1]],dl[2]=a[d[2]],Ce(dl,dl,oh),ff[3*u+0]=dl[0],ff[3*u+1]=dl[1],ff[3*u+2]=dl[2]}if(!e(ff,0,l))return null;Mi(a);let c=null;this.calculateRelativeScreenBounds&&(c=this.calculateRelativeScreenBounds());for(let u=0;u<3*l;u+=3){for(let d=0;d<3;d++)a[d]=Math.min(a[d],ff[u+d]),a[d+3]=Math.max(a[d+3],ff[u+d]);c&&r.push({location:ff.slice(u,u+3),screenSpaceBoundingRect:c})}if(t&&(Ic(a,gM),this.elevationContext.mode!=="absolute-height")){let u;const d=s4(a,t.service.spatialReference,t);try{u=await t.service.queryElevation(gM[0],gM[1],n,d,"ground")}catch{}y(u)&&YG(a,0,0,-this.alignedSampledElevation+u)}return a}addObjectState(e,t){if(e===Lg.Highlight){const r=new tP(e);this._addHighlightId(r),t.addExternal(n=>{this._removeHighlightId(n)},r)}}removeObjectState(e){this._highlights.forEach(t=>e.remove(t))}_addHighlightId(e){this._highlights.add(e),this._lodRenderer.instanceData.setHighlight(this.instanceIndex,!0)}_removeHighlightId(e){this._highlights.delete(e),this._lodRenderer.instanceData.setHighlight(this.instanceIndex,this._highlights.size>0)}get _lodRenderer(){return this.graphics3DSymbolLayer.lodRenderer}};const ff=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],dl=R(),gM=R(),hSe=[[0,1,2],[3,1,2],[0,4,2],[3,4,2],[0,1,5],[3,1,5],[0,4,5],[3,4,5]],oh=ve();function uSe(i){const e=[];return i.stageResources.geometries.forEach((t,r)=>{const n=i.stageResources.materials[r],s=i.stageResources.textures;e.push({material:n,geometry:t,textures:s})}),{components:e,minScreenSpaceRadius:y(i.lodThreshold)?i.lodThreshold:0,pivotOffset:i.pivotOffset}}function dSe(i){return{levels:i.map(e=>uSe(e))}}function pSe(i,e=fSe){const t=Ixe(i);return Math.sqrt(t/(e*Math.PI))}function mSe(i){i.levels.forEach(e=>{e.minScreenSpaceRadius||(e.minScreenSpaceRadius=pSe(e))})}const fSe=.05;var Ci;function gSe(i){let e=sn().mat4f64(P.LOCALTRANSFORM).mat4f64(P.GLOBALTRANSFORM).vec4f64(P.BOUNDINGSPHERE).vec3f64(P.MODELORIGIN).mat3f(P.MODEL).mat3f(P.MODELNORMAL).vec2f(P.MODELSCALEFACTORS);return i.includes("color")&&(e=e.vec4f(P.COLOR)),i.includes("featureAttribute")&&(e=e.vec4f(P.FEATUREATTRIBUTE)),e=e.u8(P.STATE).u8(P.LODLEVEL),i.includes(P.OBJECTANDLAYERIDCOLOR)&&(e=e.vec4u8(P.OBJECTANDLAYERIDCOLOR)),e.alignTo(8),e}(function(i){i[i.ALLOCATED=1]="ALLOCATED",i[i.DEFAULT_ACTIVE=2]="DEFAULT_ACTIVE",i[i.VISIBLE=4]="VISIBLE",i[i.HIGHLIGHT=8]="HIGHLIGHT",i[i.HIGHLIGHT_ACTIVE=16]="HIGHLIGHT_ACTIVE",i[i.REMOVE=32]="REMOVE",i[i.TRANSFORM_CHANGED=64]="TRANSFORM_CHANGED",i[i.ACTIVE=18]="ACTIVE"})(Ci||(Ci={}));let _Se=class{constructor(e){this.localTransform=e.getField(P.LOCALTRANSFORM,q5),this.globalTransform=e.getField(P.GLOBALTRANSFORM,q5),this.modelOrigin=e.getField(P.MODELORIGIN,$m),this.model=e.getField(P.MODEL,Aw),this.modelNormal=e.getField(P.MODELNORMAL,Aw),this.modelScaleFactors=e.getField(P.MODELSCALEFACTORS,JG),this.boundingSphere=e.getField(P.BOUNDINGSPHERE,vse),this.color=e.getField(P.COLOR,Sd),this.featureAttribute=e.getField(P.FEATUREATTRIBUTE,Sd),this.state=e.getField(P.STATE,W5),this.lodLevel=e.getField(P.LODLEVEL,W5),this.objectAndLayerIdColor=e.getField(P.OBJECTANDLAYERIDCOLOR,Lm)}},ySe=class extends nn{constructor(e,t){super(),this._capacity=0,this._size=0,this._next=0,this._buffer=null,this._view=null,this._layout=gSe(e),this._shaderTransformation=t}get capacity(){return this._capacity}get size(){return this._size}get buffer(){return this._buffer.buffer}get view(){return this._view}addInstance(){this._size+1>this._capacity&&this._grow();const e=this._findSlot();return this._view.state.set(e,Ci.ALLOCATED),this._size++,this.emit("instance-added",{index:e}),e}removeInstance(e){const t=this._view.state;it(e>=0&&e<this._capacity&&t.get(e)&Ci.ALLOCATED,"invalid instance handle"),this._getStateFlag(e,Ci.ACTIVE)?this._setStateFlags(e,Ci.REMOVE):this.freeInstance(e),this.emit("instance-removed",{index:e})}freeInstance(e){const t=this._view.state;it(e>=0&&e<this._capacity&&t.get(e)&Ci.ALLOCATED,"invalid instance handle"),t.set(e,0),this._size--}setLocalTransform(e,t,r=!0){this._view.localTransform.setMat(e,t),r&&this.updateModelTransform(e)}getLocalTransform(e,t){this._view.localTransform.getMat(e,t)}setGlobalTransform(e,t,r=!0){this._view.globalTransform.setMat(e,t),r&&this.updateModelTransform(e)}getGlobalTransform(e,t){this._view.globalTransform.getMat(e,t)}updateModelTransform(e){const t=this._view,r=lp,n=tc;t.localTransform.getMat(e,A8),t.globalTransform.getMat(e,_M);const s=Hr(_M,_M,A8);Z(r,s[12],s[13],s[14]),t.modelOrigin.setVec(e,r),Td(n,s),t.model.setMat(e,n);const a=s_e(lp,s);a.sort(),t.modelScaleFactors.set(e,0,a[1]),t.modelScaleFactors.set(e,1,a[2]),Zg(n,n),qc(n,n),t.modelNormal.setMat(e,n),this._setStateFlags(e,Ci.TRANSFORM_CHANGED),this.emit("instance-transform-changed",{index:e})}getModelTransform(e,t){const r=this._view;r.model.getMat(e,tc),r.modelOrigin.getVec(e,lp),t[0]=tc[0],t[1]=tc[1],t[2]=tc[2],t[3]=0,t[4]=tc[3],t[5]=tc[4],t[6]=tc[5],t[7]=0,t[8]=tc[6],t[9]=tc[7],t[10]=tc[8],t[11]=0,t[12]=lp[0],t[13]=lp[1],t[14]=lp[2],t[15]=1}applyShaderTransformation(e,t){this._shaderTransformation&&this._shaderTransformation.applyTransform(this,e,t)}getCombinedModelTransform(e,t){return this.getModelTransform(e,t),this._shaderTransformation&&this._shaderTransformation.applyTransform(this,e,t),t}getCombinedLocalTransform(e,t){return this._view.localTransform.getMat(e,t),this._shaderTransformation&&this._shaderTransformation.applyTransform(this,e,t),t}getCombinedMaxScaleFactor(e){let t=this._view.modelScaleFactors.get(e,1);if(this._shaderTransformation){const r=this._shaderTransformation.scaleFactor(lp,this,e);t*=Math.max(r[0],r[1],r[2])}return t}getCombinedMedianScaleFactor(e){let t=this._view.modelScaleFactors.get(e,0);if(this._shaderTransformation){const r=this._shaderTransformation.scaleFactor(lp,this,e);t*=vSe(r[0],r[1],r[2])}return t}getModel(e,t){this._view.model.getMat(e,t)}setFeatureAttribute(e,t){this._view.featureAttribute.setVec(e,t)}getFeatureAttribute(e,t){this._view.featureAttribute.getVec(e,t)}setColor(e,t){this._view.color.setVec(e,t)}setObjectAndLayerIdColor(e,t){this._view.objectAndLayerIdColor.setVec(e,t)}getColor(e,t){this._view.color.getVec(e,t)}setVisible(e,t){t!==this.getVisible(e)&&(this._setStateFlag(e,Ci.VISIBLE,t),this.emit("instance-visibility-changed",{index:e}))}getVisible(e){return this._getStateFlag(e,Ci.VISIBLE)}setHighlight(e,t){t!==this.getHighlight(e)&&(this._setStateFlag(e,Ci.HIGHLIGHT,t),this.emit("instance-highlight-changed",{index:e}))}getHighlight(e){return this._getStateFlag(e,Ci.HIGHLIGHT)}getState(e){return this._view.state.get(e)}getLodLevel(e){return this._view.lodLevel.get(e)}countFlags(e){let t=0;for(let r=0;r<this._capacity;++r)this.getState(r)&e&&++t;return t}_setStateFlags(e,t){const r=this._view.state;t=r.get(e)|t,r.set(e,t)}_clearStateFlags(e,t){const r=this._view.state;t=r.get(e)&~t,r.set(e,t)}_setStateFlag(e,t,r){r?this._setStateFlags(e,t):this._clearStateFlags(e,t)}_getStateFlag(e,t){return!!(this._view.state.get(e)&t)}_grow(){const e=Math.max(bSe,Math.floor(this._capacity*wSe)),t=this._layout.createBuffer(e);if(this._buffer){const r=new Uint8Array(this._buffer.buffer);new Uint8Array(t.buffer).set(r)}this._capacity=e,this._buffer=t,this._view=new _Se(this._buffer)}_findSlot(){const e=this._view.state;let t=this._next;for(;e.get(t)&Ci.ALLOCATED;)t=t+1===this._capacity?0:t+1;return this._next=t+1===this._capacity?0:t+1,t}};function vSe(i,e,t){return Math.max(Math.min(i,e),Math.min(Math.max(i,e),t))}const bSe=1024,wSe=2,lp=R(),tc=Or(),A8=ve(),_M=ve();let xSe=class extends Mc{constructor(e,t){super(r=>ure(this._instanceData.view.boundingSphere.getVec(r,this._tmpSphere)),{maximumDepth:25}),this._tmpSphere=ou(),this._tmpMat4=ve(),this._instanceData=e,this._boundingSphere=t}addInstance(e){const t=this._instanceData.view.boundingSphere,r=this._instanceData.getCombinedModelTransform(e,this._tmpMat4);Ce(this._tmpSphere,this._boundingSphere.center,r),this._tmpSphere[3]=this._boundingSphere.radius*zg(r),t.setVec(e,this._tmpSphere),this.add([e])}removeInstance(e){this.remove([e])}},TSe=class{constructor(e,t){this.thresholdScale=1,this._camera=new yi,this._worldSpaceRadius=e,this._thresholds=t.map(r=>r)}updateCamera(e){this._camera.copyFrom(e)}selectLevel(e,t){const r=this._camera.computeScreenPixelSizeAt(e),n=this._worldSpaceRadius*t/r,s=this._thresholds;let a=-1;for(let o=0;o<s.length;++o)n>=s[o]*this.thresholdScale&&(a=o);return a}},CSe=class{constructor(e,t){const r=e.renderContext.rctx,{geometry:n,material:s}=t;this._materialRepository=e.materialRep,s.setParameters({instancedDoublePrecision:!0});const a=s.createBufferWriter(),o=a.vertexBufferLayout,l=a.elementCount(n),c=a.allocate(l);a.write(null,null,n,c,0),this.geometry=n,this.material=s,this.glMaterials=new IY(s,this._materialRepository),this.vertexBufferLayout=o,this.vbo=hi.createVertex(r,di.STATIC_DRAW,c.buffer),this.vao=new nu(r,ai,{geometry:Wc(o)},{geometry:this.vbo}),this.vertexCount=l}destroy(){this.glMaterials.destroy(),this.vbo.dispose(),this.vao.dispose()}get boundingInfo(){return this.geometry.boundingInfo}get triangleCount(){return this.vertexCount/3}intersect(e,t,r,n,s,a,o,l){const c=this.geometry.id;this.material.intersect(this.geometry,null,e.transform.transform,e,r,n,(u,d,m,f,_)=>{if(u>=0){if(t!=null&&!t(e.rayBegin,e.rayEnd,u))return;const g={layerUid:a.layerUid,graphicUid:a.graphicUid(s),geometryId:c,triangleNr:m,baseBoundingSphere:o,numLodLevels:l};if((e.results.min.drapedLayerOrder==null||_>=e.results.min.drapedLayerOrder)&&(e.results.min.dist==null||u<e.results.min.dist)&&e.results.min.set(Ui.LOD,g,u,d,e.transform.transform,_),e.options.store!==zn.MIN&&(e.results.max.drapedLayerOrder==null||_>=e.results.max.drapedLayerOrder)&&(e.results.max.dist==null||u>e.results.max.dist)&&e.results.max.set(Ui.LOD,g,u,d,e.transform.transform,_),e.options.store===zn.ALL){const x=NN(e.results.min.ray);x.set(Ui.LOD,g,u,d,e.transform.transform,_),e.results.all.push(x)}}})}},SSe=class sK{constructor(e,t){this.minScreenSpaceRadius=e,this.components=t}static async create(e,t,r){const n=await Promise.allSettled(t.components.map(a=>e.schedule(()=>new CSe(e,a),r))),s=n.map(a=>a.status==="fulfilled"?a.value:null).filter(a=>a);if(Ec(r)||s.length!==n.length){s.forEach(a=>a.destroy()),xi(r);for(const a of n)if(a.status==="rejected")throw a.reason}return new sK(t.minScreenSpaceRadius,s)}destroy(){this.components.forEach(e=>e.destroy())}intersect(e,t,r,n,s,a,o){this.components.forEach(l=>l.intersect(e,t,r,n,s,a,this.boundingSphere,o))}get boundingBox(){if(S(this._boundingBox)){const e=Mi();this.components.forEach(t=>{y(t.boundingInfo)&&(W0(e,t.boundingInfo.bbMin),W0(e,t.boundingInfo.bbMax))}),this._boundingBox=e}return this._boundingBox}get boundingSphere(){if(S(this._boundingSphere)){const e=this.boundingBox,t=R();Ic(e,t),this._boundingSphere={center:t,radius:.5*KG(e)}}return this._boundingSphere}get triangleCount(){return this.components.reduce((e,t)=>e+t.triangleCount,0)}},ESe=class{constructor(e,t,r){this._elementSize=t,this._buffer=hi.createVertex(e,di.STATIC_DRAW),this.resize(r)}destroy(){this._buffer.dispose()}get elementSize(){return this._elementSize}get capacity(){return this._capacity}get array(){return this._array}get buffer(){return this._buffer}get memoryUsage(){return{cpu:this._capacity*this._elementSize,gpu:this._capacity*this._elementSize}}copyRange(e,t,r,n=0){const s=new Uint8Array(this.array,e*this.elementSize,(t-e)*this.elementSize);new Uint8Array(r.array,n*this.elementSize).set(s)}transferAll(){this._buffer.setData(this._array)}transferRange(e,t){const r=e*this._elementSize,n=t*this._elementSize;this._buffer.setSubData(new Uint8Array(this._array),r,r,n)}resize(e){const t=e*this._elementSize,r=new ArrayBuffer(t);this._array&&(e>=this._capacity?new Uint8Array(r).set(new Uint8Array(this._array)):new Uint8Array(r).set(new Uint8Array(this._array).subarray(0,e*this._elementSize))),this._array=r,this._buffer.setSize(t),this._capacity=e}},PSe=class{constructor(e){this.modelOriginHi=e.getField(P.MODELORIGINHI,Dm),this.modelOriginLo=e.getField(P.MODELORIGINLO,Dm),this.model=e.getField(P.MODEL,Aw),this.modelNormal=e.getField(P.MODELNORMAL,Aw),this.color=e.getField(P.INSTANCECOLOR,Sd),this.featureAttribute=e.getField(P.INSTANCEFEATUREATTRIBUTE,Sd),this.objectAndLayerIdColor=e.getField(P.OBJECTANDLAYERIDCOLOR_INSTANCED,Lm)}},O8=class{constructor(e,t){this._headIndex=0,this._tailIndex=0,this._firstIndex=null,this._captureFirstIndex=!0,this._updating=!1,this._prevHeadIndex=0,this._resized=!1,this._rctx=e,this._instanceBufferLayout=t,this._elementSize=t.stride,this._capacity=1}destroy(){this._buffer&&this._buffer.destroy()}get buffer(){return this._buffer.buffer}get view(){return this._view}get capacity(){return this._capacity}get size(){const e=this._headIndex,t=this._tailIndex;return e>=t?e-t:e+this._capacity-t}get isEmpty(){return this._headIndex===this._tailIndex}get isFull(){return this._tailIndex===(this._headIndex+1)%this._capacity}get headIndex(){return this._headIndex}get tailIndex(){return this._tailIndex}get firstIndex(){return this._firstIndex}get memoryUsage(){return this._buffer?this._buffer.memoryUsage:{cpu:0,gpu:0}}reset(){this._headIndex=0,this._tailIndex=0,this._firstIndex=null}startUpdateCylce(){this._captureFirstIndex=!0}beginUpdate(){it(!this._updating,"already updating"),this._updating=!0,this._prevHeadIndex=this._headIndex}endUpdate(){it(this._updating,"not updating"),this.size<ASe*this.capacity&&this._shrink(),this._resized?(this._buffer.transferAll(),this._resized=!1):this._transferRange(this._prevHeadIndex,this._headIndex),this._updating=!1}allocateHead(){it(this._updating,"not updating"),this.isFull&&this._grow();const e=this.headIndex;return this._captureFirstIndex&&(this._firstIndex=e,this._captureFirstIndex=!1),this._incrementHead(),it(this._headIndex!==this._tailIndex,"invalid pointers"),e}freeTail(){it(this._updating,"not updating"),it(this.size>0,"invalid size");const e=this._tailIndex===this._firstIndex;this._incrementTail(),e&&(this._firstIndex=this._tailIndex)}_grow(){const e=Math.max(M8,Math.floor(this._capacity*RSe));this._resize(e)}_shrink(){const e=Math.max(M8,Math.floor(this._capacity*OSe));this._resize(e)}_resize(e){if(it(this._updating,"not updating"),e===this._capacity)return;const t=new ESe(this._rctx,this._elementSize,e);if(this._buffer){this._firstIndex&&(this._firstIndex=(this._firstIndex+this._capacity-this._tailIndex)%this._capacity);const r=this.size,n=this._compactInstances(t);it(n===r,"invalid compaction"),this._buffer.destroy(),this._tailIndex=0,this._headIndex=n,this._prevHeadIndex=0}this._resized=!0,this._capacity=e,this._buffer=t,this._view=new PSe(this._instanceBufferLayout.createView(this._buffer.array))}_compactInstances(e){const t=this._headIndex,r=this._tailIndex;return r<t?(this._buffer.copyRange(r,t,e),t-r):r>t?(this._buffer.copyRange(r,this._capacity,e),t>0&&this._buffer.copyRange(0,t,e,this._capacity-r),t+(this._capacity-r)):0}_incrementHead(e=1){this._headIndex=(this._headIndex+e)%this._capacity}_incrementTail(e=1){this._tailIndex=(this._tailIndex+e)%this._capacity}_transferRange(e,t){e<t?this._buffer.transferRange(e,t):e>t&&(t>0&&this._buffer.transferRange(0,t),this._buffer.transferRange(e,this._capacity))}};const M8=1024,RSe=2,ASe=.3,OSe=.5,MSe=i=>{const e=i.baseBoundingSphere.radius,t=i.levels.map(r=>r.minScreenSpaceRadius);return new TSe(e,t)};let ISe=class{constructor(e,t,r,n){this.type=Ui.LOD,this.isGround=!1,this._levels=[],this._defaultRenderInstanceData=[],this._highlightRenderInstanceData=[],this._instanceIndex=0,this._slicePlane=!1,this._lastCamera=new yi,this._updateCyclesWithStaticCamera=-1,this._needFullCycle=!1,this.slots=[ae.OPAQUE_MATERIAL,ae.TRANSPARENT_MATERIAL],this.canRender=!0,this._symbol=e,this._optionalFields=t,this._metadata=r,this._instanceBufferLayout=Mne({instancedDoublePrecision:!0,instanced:t}),this._glInstanceBufferLayout=Wc(this._instanceBufferLayout,1),this._instanceData=new ySe(this._optionalFields,n),this._instanceData.on("instance-added",()=>this._requestUpdateCycle()),this._instanceData.on("instance-removed",()=>this._requestUpdateCycle()),this._instanceData.on("instance-transform-changed",s=>{this._requestUpdateCycle(),this._metadata.notifyGraphicGeometryChanged(s.index)}),this._instanceData.on("instance-visibility-changed",s=>{this._requestUpdateCycle(!0),this._metadata.notifyGraphicVisibilityChanged(s.index)}),this._instanceData.on("instance-highlight-changed",()=>this._requestUpdateCycle(!0)),this._enableLevelSelection=this._symbol.levels.length>1}get levels(){return this._levels}get baseBoundingBox(){return this._levels[this._levels.length-1].boundingBox}get baseBoundingSphere(){return this._levels[this._levels.length-1].boundingSphere}get baseMaterial(){return this._levels[this._levels.length-1].components[0].material}get slicePlaneEnabled(){return this._slicePlane}set slicePlaneEnabled(e){this._slicePlane=e}get layerUid(){return this._metadata.layerUid}get instanceData(){return this._instanceData}get memoryUsage(){const e={cpu:0,gpu:0};return this._defaultRenderInstanceData.forEach(t=>{const r=t.memoryUsage;e.cpu+=r.cpu,e.gpu+=r.gpu}),this._highlightRenderInstanceData.forEach(t=>{const r=t.memoryUsage;e.cpu+=r.cpu,e.gpu+=r.gpu}),e}get renderStats(){const e=this._instanceData.size,t=[];return this._levels.forEach((r,n)=>{const s=this._defaultRenderInstanceData[n],a=this._highlightRenderInstanceData[n],o=s.size+a.size,l=r.triangleCount;t.push({renderedInstances:o,renderedTriangles:o*l,trianglesPerInstance:l})}),{totalInstances:e,renderedInstances:t.reduce((r,n)=>r+n.renderedInstances,0),renderedTriangles:t.reduce((r,n)=>r+n.renderedTriangles,0),levels:t}}async initializeRenderContext(e,t){this._context=e;const r=e.renderContext.rctx,n=await Promise.allSettled(this._symbol.levels.map(a=>(this._defaultRenderInstanceData.push(new O8(r,this._instanceBufferLayout)),this._highlightRenderInstanceData.push(new O8(r,this._instanceBufferLayout)),SSe.create(e,a,t)))),s=n.map(a=>a.status==="fulfilled"?a.value:null).filter(a=>a);if(Ec(t)||s.length!==n.length){s.forEach(a=>a.destroy()),xi(t);for(const a of n)if(a.status==="rejected")throw a.reason}this._levels=s,this._levelSelector=MSe(this)}uninitializeRenderContext(){this._invalidateOctree(),this._levels.forEach(e=>e.destroy()),this._defaultRenderInstanceData.forEach(e=>e.destroy()),this._highlightRenderInstanceData.forEach(e=>e.destroy())}get needsTransparentPass(){return this._levels.some(e=>e.components.some(t=>t.material.requiresSlot(ae.TRANSPARENT_MATERIAL,k.Color)))}get needsHighlight(){return this._highlightRenderInstanceData.some(e=>e.size>0)}prepareRender(e){if(jt.LOD_INSTANCE_RENDERER_DISABLE_UPDATES)return;if(this._enableLevelSelection){const r=e.bindParameters.contentCamera.equals(this._lastCamera);this._lastCamera.copyFrom(e.bindParameters.contentCamera),r||this._requestUpdateCycle()}const t=this._needFullCycle?this._instanceData.size:2e3;this._needFullCycle=!1,this._updateInstances(e.bindParameters.contentCamera,t),this._needsUpdates&&this._context.requestRender()}render(e){!this.baseMaterial.isVisible()||!this.baseMaterial.isVisibleForOutput(e.output)||(e.rctx.bindVAO(),e.output!==k.Highlight&&e.output!==k.ShadowHighlight&&this._renderComponents(e,this._defaultRenderInstanceData),e.output!==k.ShadowExludeHighlight&&this._renderComponents(e,this._highlightRenderInstanceData))}intersect(e,t,r,n){if(!this.baseMaterial.isVisible())return;const s=R();ne(s,n,r);const a=o=>{this._instanceData.getCombinedModelTransform(o,$8),e.transform.set($8),Ce(D8,r,e.transform.inverse),Ce(F8,n,e.transform.inverse);const l=this._instanceData.getState(o),c=this._instanceData.getLodLevel(o),u=this._levels.length;it(l&Ci.ACTIVE,"invalid instance state"),it(c>=0&&c<u,"invaid lod level"),this._levels[c].intersect(e,t,D8,F8,o,this._metadata,u)};this.baseMaterial.parameters.verticalOffset?this._octree.forEach(a):this._octree.forEachAlongRay(r,s,a)}queryDepthRange(e){return this._queryDepthRangeOctree(e)}notifyShaderTransformationChanged(){this._invalidateOctree()}_requestUpdateCycle(e=!1){this._updateCyclesWithStaticCamera=-1,e&&(this._needFullCycle=!0),this._needsUpdates&&this._context.requestRender()}get _needsUpdates(){return this._instanceData.size>0&&this._updateCyclesWithStaticCamera<1}get _octree(){return S(this._octreeCached)&&(this._octreeCached=this._buildOctree()),this._octreeCached}_invalidateOctree(){this._octreeCached=Te(this._octreeCached)}_buildOctree(){const e=new xSe(this._instanceData,this.baseBoundingSphere),t=this._instanceData,r=t.view?t.view.state:null;for(let n=0;n<this._instanceData.capacity;++n)r.get(n)&Ci.ACTIVE&&e.addInstance(n);return e}_queryDepthRangeOctree(e){const t=e.eye,r=e.viewForward,n=this._octree.findClosest(r,Mc.DepthOrder.FRONT_TO_BACK,e.frustum),s=this._octree.findClosest(r,Mc.DepthOrder.BACK_TO_FRONT,e.frustum);if(n!=null&&s!=null){this._instanceData.view.boundingSphere.getVec(n,lh),ne(lh,lh,t);const a=me(lh,r)-lh[3];this._instanceData.view.boundingSphere.getVec(s,lh),ne(lh,lh,t);const o=me(lh,r)+lh[3];return{near:Math.max(e.near,a),far:Math.min(e.far,o)}}return{near:1/0,far:-1/0}}_startUpdateCycle(){this._updateCyclesWithStaticCamera++,this._defaultRenderInstanceData.forEach(e=>{e.startUpdateCylce()}),this._highlightRenderInstanceData.forEach(e=>{e.startUpdateCylce()}),this._needsUpdates&&this._context.requestRender()}_updateInstances(e,t){const r=this._enableLevelSelection,n=this._levelSelector;n.updateCamera(e),this._defaultRenderInstanceData.forEach(u=>u.beginUpdate()),this._highlightRenderInstanceData.forEach(u=>u.beginUpdate());const s=this._instanceData,a=this._instanceData.view,o=s.size,l=s.capacity;let c=this._instanceIndex;t=Math.min(o,t);for(let u=0;u<t;++u){c===0&&this._startUpdateCycle();const d=a.state.get(c);let m=0;if(!(d&Ci.ALLOCATED)){c=c+1===l?0:c+1,t++;continue}const f=a.lodLevel.get(c);if(d&Ci.DEFAULT_ACTIVE&&this._defaultRenderInstanceData[f].freeTail(),d&Ci.HIGHLIGHT_ACTIVE&&this._highlightRenderInstanceData[f].freeTail(),d&Ci.REMOVE)s.freeInstance(c);else if(d&Ci.VISIBLE){let _=0;r&&(a.modelOrigin.getVec(c,L8),_=n.selectLevel(L8,s.getCombinedMedianScaleFactor(c))),m=d&~(Ci.ACTIVE|Ci.TRANSFORM_CHANGED),_>=0&&(d&Ci.HIGHLIGHT?(I8(this._highlightRenderInstanceData[_],a,c),m|=Ci.HIGHLIGHT_ACTIVE):(I8(this._defaultRenderInstanceData[_],a,c),m|=Ci.DEFAULT_ACTIVE)),a.state.set(c,m),a.lodLevel.set(c,_)}else m=d&~(Ci.ACTIVE|Ci.TRANSFORM_CHANGED),a.state.set(c,m);if(y(this._octreeCached)){const _=!!(d&Ci.ACTIVE),g=!!(m&Ci.ACTIVE);!_&&g?this._octreeCached.addInstance(c):_&&!g?this._octreeCached.removeInstance(c):_&&g&&d&Ci.TRANSFORM_CHANGED&&(this._octreeCached.removeInstance(c),this._octreeCached.addInstance(c))}c=c+1===l?0:c+1}this._instanceIndex=c,this._defaultRenderInstanceData.forEach(u=>u.endUpdate()),this._highlightRenderInstanceData.forEach(u=>u.endUpdate())}_renderComponents(e,t){this.levels.forEach((r,n)=>{r.components.forEach(s=>{this._renderComponent(e,t[n],s,n)})})}_renderComponent(e,t,r,n){const{bindParameters:s,rctx:a,output:o}=e;if(t.size===0||!r.material.requiresSlot(s.slot,e.output))return;const l=r.glMaterials.load(a,s.slot,o);if(S(l))return;const c=l.beginSlot(s),u=a.bindTechnique(c,r.material.parameters,s);a.bindVAO(r.vao),c.ensureAttributeLocations(r.vao),u.bindDraw($Se,s,r.material.parameters),jt.LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL&&e.output===k.Color&&(u.setUniform4fv("externalColor",N8[Math.min(n,N8.length-1)]),u.setUniform1i("colorMixMode",sne.replace));const d=a.capabilities.instancing,m=t.capacity,f=t.headIndex,_=t.tailIndex,g=t.firstIndex,x=this._glInstanceBufferLayout,b=(v,w)=>{FG(a,ai,t.buffer,x,v),d.drawArraysInstanced(c.primitiveType,0,r.vertexCount,w-v),NG(a,ai,t.buffer,x)};r.material.parameters.transparent&&g!=null?f>_?(it(g>=_&&g<=f,"invalid firstIndex"),b(g,f),b(_,g)):f<_&&(g<=f?(it(g>=0&&g<=f,"invalid firstIndex"),b(g,f),b(_,m),b(0,g)):(it(g>=_&&g<=m,"invalid firstIndex"),b(g,m),b(0,f),b(_,g))):f>_?b(_,f):f<_&&(b(0,f),b(_,m)),a.bindVAO(null)}};function I8(i,e,t){const r=i.allocateHead();LSe(e,t,i.view,r)}function LSe(i,e,t,r){ane(i.modelOrigin,e,t.modelOriginHi,t.modelOriginLo,r),t.model.copyFrom(r,i.model,e),t.modelNormal.copyFrom(r,i.modelNormal,e),i.color&&t.color&&t.color.copyFrom(r,i.color,e),i.objectAndLayerIdColor&&t.objectAndLayerIdColor&&t.objectAndLayerIdColor.copyFrom(r,i.objectAndLayerIdColor,e),i.featureAttribute&&t.featureAttribute&&t.featureAttribute.copyFrom(r,i.featureAttribute,e)}const L8=R(),lh=_i(),$8=ve(),D8=R(),F8=R(),N8=[Bi(1,0,1,1),Bi(0,0,1,1),Bi(0,1,0,1),Bi(1,1,0,1),Bi(1,0,0,1)],$Se=new One;let DSe=class extends du{constructor(e,t,r,n){super(e,t,r,n),this._resources=null,this._optionalFields=new Array,this._instanceIndexToGraphicUid=new Map,this._hasLoadedPBRTextures=!1,this._disposeResourceHandles=new Array,this.ensureDrapedStatus(!1),this._hasLoadedPBRTextures=r.physicalBasedRenderingEnabled}getCachedSize(){const[e,t,r]=y(this._resources)?this._resources.symbolSize:[1,1,1];return{width:e,depth:t,height:r}}async doLoad(e){if(!this._drivenProperties.size&&RR(this.symbolLayer))throw new Error;const t=this.symbolLayer;if(this._isPrimitive){const r=t.resource?t.resource.primitive:L7;this._resources=await this._createResourcesForPrimitive(r,e)}else this._resources=await this._createResourcesForUrl(t.resource.href,e);this.layerOpacityChanged(),this.slicePlaneEnabledChanged(),this.physicalBasedRenderingChanged(),this.complexity=this.computeComplexity()}get extentPadding(){return y(this._resources)?this._resources.extentPadding:0}get _isPrimitive(){return!(this.symbolLayer.resource&&this.symbolLayer.resource.href)}get lodRenderer(){return en(this._resources,"lodRenderer")}_setMaterialTransparencyParams(e,t=en(this.symbolLayer,"material","color")){const r=this._getCombinedOpacity(t),n=r<1||this.needsDrivenTransparentPass;return e.transparent=n,e.opacity=r,e.cullFace=n?tn.None:tn.Back,e}async _createResourcesForPrimitive(e,t){if(!Mxe(e))throw new Error(`Unknown object symbol primitive: ${e}`);const r=this.symbolLayer,n=Ms(sae(e)),s=Tl(hT(n)),a=Tl(aA(s,r)),o=_e(a),l=!1,c=!1,u={usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0,ambient:em,diffuse:em,hasSlicePlane:this._context.slicePlaneEnabled,hasSliceHighlight:!1,castShadows:this.symbolLayer.castShadows,offsetTransparentBackfaces:!this.symbolLayer.isPrimitive},d=u.usePBR;this._setMaterialTransparencyParams(u);const m=this.symbol;if(m.type==="point-3d"&&m.verticalOffset){const{screenLength:b,minWorldLength:v,maxWorldLength:w}=m.verticalOffset;u.verticalOffset={screenLength:Sa(b),minWorldLength:v||0,maxWorldLength:y(w)?w:1/0},u.castShadows=!1}if(this._context.screenSizePerspectiveEnabled&&(u.screenSizePerspective=this._context.sharedResources.screenSizePerspectiveSettings),this._drivenProperties.color)u.externalColor=Rc;else{const b=y(r.material)&&r.material.color,v=y(b)?ei.toUnitRGBA(b):Rc;u.externalColor=v}this._fastUpdates=mx(this._context.renderer,this._fastVisualVariableConvertOptions(n,a,s,v_)),u.instanced=["transformation"],this._fastUpdates.enabled?(Object.assign(u,this._fastUpdates.materialParameters),u.instanced.push("featureAttribute"),this._optionalFields.push("featureAttribute")):this._hasPerInstanceColor()&&(u.instanced.push("color"),this._optionalFields.push("color")),St("enable-feature:objectAndLayerId-rendering")&&(u.instanced.push("objectAndLayerIdColor"),this._optionalFields.push("objectAndLayerIdColor"));const f=new Ew(u),_=pY(e,f);if(!_)throw new Error(`Unknown object symbol primitive: ${e}`);const g=yC(_).map(b=>({opacity:1,transparent:b.parameters.transparent})),x=await this._createStageResources(_,d);return{lodResources:_,lodRenderer:await this._createLodRenderer(_,t),stageResources:x,symbolSize:a,extentPadding:o,isEsriSymbolResource:l,isWosr:c,originalMaterialParameters:g,physicalBasedRenderingEnabled:d,resourceBoundingBox:n,resourceSize:s,pivotOffset:v_}}async _createResourcesForUrl(e,t){const r=["transformation"],n={materialParamsMixin:{instanced:r,hasSlicePlane:this._context.slicePlaneEnabled,castShadows:this.symbolLayer.castShadows},streamDataRequester:this._context.streamDataRequester,cache:this._context.sharedResources.objectResourceCache};this._fastUpdates=mx(this._context.renderer,this._fastVisualVariableConvertOptions(v_,v_,v_,v_)),this._fastUpdates.enabled?(Object.assign(n.materialParamsMixin,this._fastUpdates.materialParameters),r.push("featureAttribute"),this._optionalFields.push("featureAttribute")):this._hasPerInstanceColor()&&(r.push("color"),this._optionalFields.push("color")),St("enable-feature:objectAndLayerId-rendering")&&(r.push("objectAndLayerIdColor"),this._optionalFields.push("objectAndLayerIdColor"));const s=this.symbol;if(s.type==="point-3d"&&s.verticalOffset){const{screenLength:I,minWorldLength:L,maxWorldLength:U}=s.verticalOffset;n.materialParamsMixin.verticalOffset={screenLength:Sa(I),minWorldLength:L||0,maxWorldLength:y(U)?U:1/0},n.materialParamsMixin.castShadows=!1}n.signal=t,n.usePBR=this._context.physicalBasedRenderingEnabled,n.skipHighLods=this._context.skipHighSymbolLods;const a=n.usePBR,o=await Ine(e,n),l=o.isEsriSymbolResource,c=o.isWosr,u=dSe(o.lods);mSe(u),u.levels.sort((I,L)=>I.minScreenSpaceRadius-L.minScreenSpaceRadius),u.levels[0].minScreenSpaceRadius=Math.min(2,u.levels[0].minScreenSpaceRadius);const d=this._context,m=this.symbolLayer.material,f=this._getExternalColorParameters(m),_=en(this.symbolLayer,"material","color"),g=this._getCombinedOpacity(_,{hasIntrinsicColor:!0}),x=this.needsDrivenTransparentPass,b=yC(u),v=yC(u).map(I=>({opacity:I.parameters.opacity||1,transparent:I.parameters.transparent}));b.forEach(I=>{const L=I.parameters;I.setParameters(f);const U=L.opacity*g,j=U<1||x||L.transparent;I.setParameters({opacity:U,transparent:j}),d.screenSizePerspectiveEnabled&&I.setParameters({screenSizePerspective:d.sharedResources.screenSizePerspectiveSettings})});const w=o.referenceBoundingBox,T=Tl(hT(w)),E=Tl(u.levels[0].pivotOffset),C=Tl(aA(T,this.symbolLayer)),A=_e(C);fx(this._fastUpdates,this._context.renderer,this._fastVisualVariableConvertOptions(w,C,T,E))&&b.forEach(I=>I.setParameters(this._fastUpdates.materialParameters));const M=await this._createStageResources(u,a);return{lodResources:u,lodRenderer:await this._createLodRenderer(u,t),stageResources:M,symbolSize:C,extentPadding:A,isEsriSymbolResource:l,isWosr:c,originalMaterialParameters:v,physicalBasedRenderingEnabled:a,resourceBoundingBox:w,resourceSize:T,pivotOffset:E}}_addDisposeResource(e){this._disposeResourceHandles.push(e)}async _createStageResources(e,t){const r=this._context.stage,n=yC(e);t!==this._context.physicalBasedRenderingEnabled&&this.physicalBasedRenderingChanged(),r.addMany(n),this._addDisposeResource(()=>r.removeMany(n));const s=RU(e);r.addMany(s),this._addDisposeResource(()=>r.removeMany(s)),await r.load(s);const a=AU(e);return r.addMany(a),this._addDisposeResource(()=>r.removeMany(a)),{materials:n,textures:s,geometries:a}}async _createLodRenderer(e,t){const r=this._context.stage,n={layerUid:this._context.layer.uid,graphicUid:o=>this._instanceIndexToGraphicUid.get(o),notifyGraphicGeometryChanged:o=>this._context.notifyGraphicGeometryChanged(this._instanceIndexToGraphicUid.get(o)),notifyGraphicVisibilityChanged:o=>this._context.notifyGraphicVisibilityChanged(this._instanceIndexToGraphicUid.get(o))},s=this._fastUpdates.enabled?{applyTransform:(o,l,c)=>{o.getFeatureAttribute(l,OC),pn(c,i$(this._fastUpdates.materialParameters,OC,c))},scaleFactor:(o,l,c)=>(l.getFeatureAttribute(c,OC),vCe(o,this._fastUpdates.materialParameters,OC))}:null,a=new ISe(e,this._optionalFields,n,s);return a.slicePlaneEnabled=this._context.slicePlaneEnabled,this._addDisposeResource(()=>{r.removeRenderPlugin(a)}),await r.addRenderPlugin(a.slots,a,t),a}_getExternalColorParameters(e){const t={};return this._drivenProperties.color?t.externalColor=Rc:y(e)&&y(e.color)?t.externalColor=ei.toUnitRGBA(e.color):(t.externalColor=Rc,t.colorMixMode="ignore"),t}destroy(){super.destroy(),this._cleanupResources()}_cleanupResources(){this._disposeResourceHandles.forEach(e=>e()),this._disposeResourceHandles.length=0,this._resources=null}createGraphics3DGraphic(e){const t=e.graphic;if(!this._validateGeometry(t.geometry))return null;const r=dx(t.geometry);if(S(r))return this.logger.warn(`unsupported geometry type for icon symbol: ${t.geometry.type}`),null;const n=this.setGraphicElevationContext(t,new Qc),s=e.renderingInfo;return this._createAs3DShape(t,r,s,n,t.uid,e.layer.uid)}notifyDestroyGraphicLayer(e){this._instanceIndexToGraphicUid.delete(e.instanceIndex)}graphicLayerToGraphicId(){return 0}layerOpacityChanged(){if(S(this._resources))return;const e=this._drivenProperties.opacity,t=!this._isPrimitive,r=this._resources.stageResources.materials,n=this._resources.originalMaterialParameters;for(let s=0;s<r.length;s++){const a=r[s],o=en(this.symbolLayer,"material","color"),l=n[s],c=this._getCombinedOpacity(o,{hasIntrinsicColor:t})*l.opacity,u=c<1||e||l.transparent;a.setParameters({opacity:c,transparent:u}),this._isPrimitive&&a.setParameters({cullFace:u?tn.None:tn.Back})}}layerElevationInfoChanged(e,t){return this.updateGraphics3DGraphicElevationInfo(e,t,zm)}slicePlaneEnabledChanged(){if(S(this._resources))return!0;this._resources.lodRenderer.slicePlaneEnabled=this._context.slicePlaneEnabled;for(const e of this._resources.stageResources.materials)e.setParameters({hasSlicePlane:this._context.slicePlaneEnabled});return!0}physicalBasedRenderingChanged(){if(S(this._resources))return!0;const{stageResources:e,isWosr:t}=this._resources;for(const r of e.materials)this._isPrimitive?r.setParameters({usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0}):t||r.setParameters({usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!1});return this._hasLoadedPBRTextures!==!1||this._context.physicalBasedRenderingEnabled!==!0||(this._hasLoadedPBRTextures=!0,!1)}pixelRatioChanged(){return!0}applyRendererDiff(e,t){if(S(this._resources))return Gr.Recreate_Symbol;const{stageResources:{materials:r},lodRenderer:n,resourceBoundingBox:s,symbolSize:a,resourceSize:o,pivotOffset:l}=this._resources;for(const c in e.diff){if(c!=="visualVariables"||!fx(this._fastUpdates,t,this._fastVisualVariableConvertOptions(s,a,o,l)))return Gr.Recreate_Symbol;for(const u of r)u.setParameters(this._fastUpdates.materialParameters);n.notifyShaderTransformationChanged()}return Gr.Fast_Update}computeComplexity(){if(S(this._resources))return super.computeComplexity();const e=this._resources.lodResources,t=c4(e.levels[0]).reduce((s,a)=>s+a.indices.get(P.POSITION).length,0)/3,r=s=>Array.from(s.vertexAttributes.values()).reduce((a,o)=>{var l;return a+(((l=o.data.buffer)==null?void 0:l.byteLength)??0)},0)+Array.from(s.indices.values()).reduce((a,o)=>a+(Array.isArray(o)?12*o.length:o.buffer.byteLength),0),n=RU(e).reduce((s,a)=>s+a.estimatedTexMemRequired,0)/4+AU(e).reduce((s,a)=>s+r(a),0);return{primitivesPerFeature:t,primitivesPerCoordinate:0,drawCallsPerFeature:0,estimated:!1,memory:{...fY(this.symbol,this.symbolLayer),resourceBytes:n}}}_hasLodRenderer(){return y(this._resources)}_createAs3DShape(e,t,r,n,s,a){if(!this._hasLodRenderer()||S(this._resources))return null;const o=this.getFastUpdateAttrValues(e),l=!this._fastUpdates.enabled&&this._hasPerInstanceColor()?Jb(r.color,r.opacity):null,c=this._context.clippingExtent;if(bn(t,Q_,this._context.elevationProvider.spatialReference),y(c)&&!jD(c,Q_))return null;const u=this._requiresTerrainElevation(n),d=this._computeGlobalTransform(t,n,yM,MC),m=this._computeLocalTransform(this._resources,this.symbolLayer,r,k8),f=this._resources.lodRenderer.instanceData,_=f.addInstance();this._instanceIndexToGraphicUid.set(_,s),f.setLocalTransform(_,m,!1),f.setGlobalTransform(_,d),o&&f.setFeatureAttribute(_,o),l&&f.setColor(_,l),St("enable-feature:objectAndLayerId-rendering")&&f.setObjectAndLayerIdColor(_,this._context.stage.renderView._objectAndLayerIdRenderHelper.getObjectAndLayerIdColor({graphicUid:s,layerUid:a}));const g=new cSe(this,_,Txe,n);return u&&(g.alignedSampledElevation=MC.sampledElevation),g.needsElevationUpdates=zm(n.mode),ux(g,t,this._context.elevationProvider),g}_computeGlobalTransform(e,t,r,n){return $d(e,this._context.elevationProvider,t,this._context.renderCoordsHelper,n),Q_[0]=e.x,Q_[1]=e.y,Q_[2]=n.z,xd(e.spatialReference,Q_,r,this._context.renderCoordsHelper.spatialReference),r}_computeLocalTransform(e,t,r,n){return Ag(n),this._applyObjectRotation(r,!1,n),this._applyObjectRotation(t,!0,n),this._applyObjectScale(e,r,n),this._applyAnchor(e,t,n),n}_applyObjectScale(e,t,r){if(this._fastUpdates.enabled&&this._fastUpdates.requiresShaderTransformation)return;const n=this._drivenProperties.size&&t.size?t.size:e.symbolSize,s=EU(n,e.symbolSize,e.resourceSize,this._context.renderCoordsHelper.unitInMeters);s[0]===1&&s[1]===1&&s[2]===1||cG(r,r,s)}prepareSymbolLayerPatch(e){if(e.diff.type!=="partial")return;const t=e.diff.diff;this._preparePatchTransform(e,t),this._preparePatchColor(e,t)}updateGeometry(e,t){if(S(this._resources))return!0;const r=t&&dx(t);if(S(r))return!1;const n=this.getGeometryElevationMode(t);return e.elevationContext.mode===n&&(this._computeGlobalTransform(r,e.elevationContext,yM,MC),this._requiresTerrainElevation(e.elevationContext)&&(e.alignedSampledElevation=MC.sampledElevation),this._resources.lodRenderer.instanceData.setGlobalTransform(e.instanceIndex,yM,!0),ux(e,r,this._context.elevationProvider),!0)}_preparePatchTransform(e,t){if(!(t.heading||t.tilt||t.roll||t.width||t.height||t.depth||t.anchor||t.anchorPosition)||S(this._resources))return;const r=(_,g,x)=>je(_!=null&&_.type==="complete"?_.newValue:g,x),n=r(t.heading,this.symbolLayer.heading,0),s=r(t.tilt,this.symbolLayer.tilt,0),a=r(t.roll,this.symbolLayer.roll,0),o=r(t.width,this.symbolLayer.width,void 0),l=r(t.height,this.symbolLayer.height,void 0),c=r(t.depth,this.symbolLayer.depth,void 0),u=r(t.anchor,this.symbolLayer.anchor,void 0),d=r(t.anchorPosition,this.symbolLayer.anchorPosition,void 0);delete t.heading,delete t.tilt,delete t.roll,delete t.width,delete t.height,delete t.depth,delete t.anchor,delete t.anchorPosition;const m={heading:n,tilt:s,roll:a,anchor:u,anchorPosition:d},f=this._resources;this.loadStatus===jo.LOADED&&e.symbolLayerStatePatches.push(()=>{f.symbolSize=Tl(aA(f.resourceSize,{width:o,height:l,depth:c,isPrimitive:this.symbolLayer.isPrimitive}))}),e.graphics3DGraphicPatches.push((_,g)=>{const x=this._computeLocalTransform(f,m,g,k8),b=_.instanceIndex;f.lodRenderer.instanceData.setLocalTransform(b,x,!0)})}_preparePatchColor(e,t){if(!t.material||t.material.type!=="partial")return;const r=t.material.diff;if(!r.color||r.color.type!=="complete"||r.color.newValue==null||r.color.oldValue==null)return;const n=r.color.newValue,s=y(n)?ei.toUnitRGBA(n):Rc;delete r.color;const a=this._resources;S(a)||e.graphics3DGraphicPatches.push(o=>{let l;this._hasPerInstanceColor()?(a.lodRenderer.instanceData.setColor(o.instanceIndex,s),l=this._setMaterialTransparencyParams({},n)):l=this._setMaterialTransparencyParams({externalColor:s},n);for(const c of a.stageResources.materials)c.setParameters(l)})}_requiresTerrainElevation(e){return e.mode!=="absolute-height"}_applyObjectRotation(e,t,r){if(!(this._fastUpdates.enabled&&this._fastUpdates.requiresShaderTransformation&&t))return dxe(e.heading,e.tilt,e.roll,r)}_computeAnchor(e,t,r){const n=R();switch(r.anchor){case"center":q(n,Ic(e)),Aa(n,n);break;case"top":{const s=Ic(e);Z(n,-s[0],-s[1],-e[5]);break}case"bottom":{const s=Ic(e);Z(n,-s[0],-s[1],-e[2]);break}case"relative":{const s=Ic(e),a=hT(e),o=r.anchorPosition,l=o?Ge(o.x,o.y,o.z):Gl;Bie(n,a,l),oe(n,n,s),Aa(n,n);break}default:y(t)?Aa(n,t):q(n,Gl)}return n}_applyAnchor(e,t,r){if(this._fastUpdates.enabled&&this._fastUpdates.requiresShaderTransformation)return;const n=this._computeAnchor(e.resourceBoundingBox,e.pivotOffset,t);n&&ru(r,r,n)}_hasPerInstanceColor(){return this._drivenProperties.color||this._drivenProperties.opacity}_fastVisualVariableConvertOptions(e,t,r,n){const s=y(e)?Tl(hT(e)):em,a=y(e)?this._computeAnchor(e,n,this.symbolLayer):Gl,o=this._context.renderCoordsHelper.unitInMeters,l=EU(y(t)?t:void 0,t,r,o),c=Ge(this.symbolLayer.tilt||0,this.symbolLayer.roll||0,this.symbolLayer.heading||0);return{modelSize:s,symbolSize:y(t)?t:em,unitInMeters:o,transformation:{anchor:a,scale:l,rotation:c}}}};const Q_=R(),k8=ve(),yM=ve(),OC=_i(),MC=new Jx;function FSe(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i}function NSe(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=1,i}function w4(i,e,t,r,n){return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i}function kSe(i,e){if(i===e){const t=e[1];i[1]=e[2],i[2]=t}else i[0]=e[0],i[1]=e[2],i[2]=e[1],i[3]=e[3];return i}function VSe(i,e){const t=e[0],r=e[1],n=e[2],s=e[3];let a=t*s-n*r;return a?(a=1/a,i[0]=s*a,i[1]=-r*a,i[2]=-n*a,i[3]=t*a,i):null}function USe(i,e){const t=e[0];return i[0]=e[3],i[1]=-e[1],i[2]=-e[2],i[3]=t,i}function zSe(i){return i[0]*i[3]-i[2]*i[1]}function aK(i,e,t){const r=e[0],n=e[1],s=e[2],a=e[3],o=t[0],l=t[1],c=t[2],u=t[3];return i[0]=r*o+s*l,i[1]=n*o+a*l,i[2]=r*c+s*u,i[3]=n*c+a*u,i}function BSe(i,e,t){const r=e[0],n=e[1],s=e[2],a=e[3],o=Math.sin(t),l=Math.cos(t);return i[0]=r*l+s*o,i[1]=n*l+a*o,i[2]=r*-o+s*l,i[3]=n*-o+a*l,i}function GSe(i,e,t){const r=e[0],n=e[1],s=e[2],a=e[3],o=t[0],l=t[1];return i[0]=r*o,i[1]=n*o,i[2]=s*l,i[3]=a*l,i}function HSe(i,e){const t=Math.sin(e),r=Math.cos(e);return i[0]=r,i[1]=t,i[2]=-t,i[3]=r,i}function jSe(i,e){return i[0]=e[0],i[1]=0,i[2]=0,i[3]=e[1],i}function qSe(i){return"mat2("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+")"}function WSe(i){return Math.sqrt(i[0]**2+i[1]**2+i[2]**2+i[3]**2)}function XSe(i,e,t,r){return i[2]=r[2]/r[0],t[0]=r[0],t[1]=r[1],t[3]=r[3]-i[2]*t[1],[i,e,t]}function QSe(i,e,t){return i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2],i[3]=e[3]+t[3],i}function oK(i,e,t){return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],i[3]=e[3]-t[3],i}function ZSe(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]&&i[3]===e[3]}function YSe(i,e){const t=i[0],r=i[1],n=i[2],s=i[3],a=e[0],o=e[1],l=e[2],c=e[3],u=hD();return Math.abs(t-a)<=u*Math.max(1,Math.abs(t),Math.abs(a))&&Math.abs(r-o)<=u*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-l)<=u*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(s-c)<=u*Math.max(1,Math.abs(s),Math.abs(c))}function KSe(i,e,t){return i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i[3]=e[3]*t,i}function JSe(i,e,t,r){return i[0]=e[0]+t[0]*r,i[1]=e[1]+t[1]*r,i[2]=e[2]+t[2]*r,i[3]=e[3]+t[3]*r,i}const eEe=aK,tEe=oK;Object.freeze(Object.defineProperty({__proto__:null,copy:FSe,identity:NSe,set:w4,transpose:kSe,invert:VSe,adjoint:USe,determinant:zSe,multiply:aK,rotate:BSe,scale:GSe,fromRotation:HSe,fromScaling:jSe,str:qSe,frob:WSe,LDU:XSe,add:QSe,subtract:oK,exactEquals:ZSe,equals:YSe,multiplyScalar:KSe,multiplyScalarAndAdd:JSe,mul:eEe,sub:tEe},Symbol.toStringTag,{value:"Module"}));let iEe=class extends jr{constructor(e,t,r,n,s,a,o){super(e,t,Fc.Triangle,o),this.path=r,this.geometrySR=n,this.upVectorAlignment=s,this.stencilWidth=a}};function lK(i){return"upVectorAlignment"in i}function cK(){return[1,0,0,1]}function rEe(i){return[i[0],i[1],i[2],i[3]]}function nEe(i,e,t,r){return[i,e,t,r]}function sEe(i,e){return new Float64Array(i,e,4)}Object.freeze(Object.defineProperty({__proto__:null,create:cK,clone:rEe,fromValues:nEe,createView:sEe},Symbol.toStringTag,{value:"Module"}));function a$(){return{up:R(),right:R()}}function aEe(i,e,t){Ce(i.up,e.up,t),Ce(i.right,e.right,t)}function oEe(i,e,t){Je(i,me(t,e.right),me(t,e.up))}let lEe=class{constructor(){this.pos=R(),this.posES=R(),this.posGS=R(),this.vRight=R(),this.vLeft=R(),this.frame=a$(),this.rotationFrame=a$(),this.rotationRight=be(),this.rotationAngle=0,this.miterStretch=cK()}setFrameFromUpVector(e){q(this.frame.up,e),oe(_l,this.vLeft,this.vRight),he(_l,_l),Q(oc,this.frame.up,me(_l,this.frame.up)),ne(LC,_l,oc),he(LC,LC),nt(this.frame.right,LC,this.frame.up)}computeRotationAxisAndAngleFromUpVector(){q(this.rotationFrame.up,this.frame.up),q(this.rotationFrame.right,this.frame.right),Je(this.rotationRight,1,0),Q(oc,this.frame.up,me(this.frame.up,this.vLeft)),ne(oc,this.vLeft,oc),Aa(oc,oc),he(oc,oc),Q(_l,this.frame.up,me(this.frame.up,this.vRight)),ne(_l,this.vRight,_l),he(_l,_l),nt(l$,this.rotationFrame.up,this.vLeft);const e=Math.sign(me(l$,this.vRight));if(this.rotationAngle=e*(Math.PI-ls(me(oc,_l))),Math.abs(this.rotationAngle)>0){const r=tI(Math.cos(.5*this.rotationAngle));w4(this.miterStretch,r-1+1,0,0,1)}const t=Math.PI-this.rotationAngle;this.maxStretchDistance=Math.abs(Math.min(this.vLeftLength,this.vRightLength)/Math.cos(.5*t))}},V8=class o${constructor(){this.vertices=[],this.vertexIndices=[],this.vertexNormals=[],this.poles=[],this.poleIndices=[],this.uvs=null,this.uvIndices=null}addVertex(e,t){return this.vertices.push(lT(e)),this.vertexNormals.push(lT(t)),this.vertices.length-1}addUV(e){return this.uvs||(this.uvs=[],this.uvIndices=[]),this.uvs.push(e),this.uvs.length-1}addPole(e,t=null){return this.poles.push({position:lT(e),normal:t?lT(t):null}),this.poles.length-1}addSegment(e,t=null,r=null){this.vertexIndices.push(e.v0),this.vertexIndices.push(e.v1),t&&(this.uvIndices.push(t.v0),this.uvIndices.push(t.v1)),r&&(this.poleIndices.push(r.v0),this.poleIndices.push(r.v1))}get numSegments(){return this.vertexIndices.length/2}hasUV(){return this.uvs!=null}translate(e,t){for(const r of this.vertices)r[0]+=e,r[1]+=t;for(const r of this.poles)r.position[0]+=e,r.position[1]+=t}static circle(e=20){const r=new o$,n={v0:0,v1:0};r.addPole(Xt(0,0));for(let o=0;o<e;++o){const l=2*o*Math.PI/e,c=Math.cos(l),u=Math.sin(l),d=Xt(c*.5,u*.5),m=Xt(c,u);r.addVertex(d,m),r.addUV(o/e)}r.addUV(1);for(let o=0;o<e-1;++o){const l={v0:o,v1:o+1},c=l;r.addSegment(l,c,n)}const s={v0:e-1,v1:0},a={v0:e-1,v1:e};return r.addSegment(s,a,n),r}static rect(){const r=new o$,n=Xt(.5*-1,.5*-1),s=Xt(.5*1,.5*-1),a=Xt(.5*1,.5*1),o=Xt(.5*-1,.5*1),l=Xt(0,-1),c=Xt(1,0),u=Xt(0,1),d=Xt(-1,0);r.addUV(0),r.addUV(1),r.addPole(Xt(0,.5*1),u),r.addPole(Xt(0,.5*1)),r.addPole(Xt(0,.5*-1)),r.addPole(Xt(0,.5*-1),l);const m={v0:0,v1:1};return r.addVertex(n,l),r.addVertex(s,l),r.addSegment({v0:0,v1:1},m,{v0:3,v1:3}),r.addVertex(s,c),r.addVertex(a,c),r.addSegment({v0:2,v1:3},m,{v0:2,v1:1}),r.addVertex(a,u),r.addVertex(o,u),r.addSegment({v0:4,v1:5},m,{v0:0,v1:0}),r.addVertex(o,d),r.addVertex(n,d),r.addSegment({v0:6,v1:7},m,{v0:1,v1:2}),r}},cEe=class{constructor(e){this.vertices=[],this.offset=R(),this.xform=ve(),this.vertices=e;const t=Math.floor((e.length-1)/2);q(this.offset,this.vertices[t].pos);for(const r of this.vertices)ne(r.pos,r.pos,this.offset);ru(this.xform,this.xform,this.offset),this.updatePathVertexInformation()}updatePathVertexInformation(){const e=this.vertices.length;let t=this.vertices[0];t.index=0,Z(t.vLeft,0,0,0),t.vLeftLength=0,ne(t.vRight,this.vertices[1].pos,t.pos),t.vRightLength=_e(t.vRight),he(t.vRight,t.vRight);let r=t;for(let n=1;n<e;++n)t=this.vertices[n],t.index=n,q(t.vLeft,r.vRight),t.vLeftLength=r.vRightLength,n<e-1?(ne(t.vRight,this.vertices[n+1].pos,t.pos),t.vRightLength=_e(t.vRight),he(t.vRight,t.vRight)):(q(t.vRight,t.vLeft),t.vRightLength=t.vLeftLength),r=t}};function hEe(i,e){let t=null;const r=i.vertices.length,n=.99619469809,s=R(),a=R(),o=R(),l=R(),c=R(),u=R(),d=fr();let m=i.vertices[0];q(a,e),Z(s,0,1,0),N2(m.vRight,a,s,s,o,a,n),q(m.frame.up,a),q(m.frame.right,o),t=m;for(let f=1;f<r;++f){m=i.vertices[f],oe(c,m.vLeft,m.vRight);let _=_e(c);_>0?(_=1/Math.sqrt(_),c[0]=c[0]*_,c[1]=c[1]*_,c[2]=c[2]*_):(c[0]=m.vRight[0],c[1]=m.vRight[1],c[2]=m.vRight[2]),oe(u,t.pos,t.frame.up),xw(m.pos,c,d),Kg(d,zc(u,m.vLeft),l)?(ne(l,l,m.pos),he(a,l),nt(o,c,a),he(o,o)):N2(c,t.frame.up,t.frame.right,s,o,a,n),q(m.frame.up,a),q(m.frame.right,o),t=m}}let uEe=class{numProfilesPerJoin(){return 1}extrude(e,t,r){for(let n=0;n<t.vertices.length;++n)r(e.index,e.frame,t.vertices[n],t.vertexNormals[n],!1)}},vM=class{constructor(e=.8*Math.PI,t=1){this.cutoffAngle=e,this.numBendSubdivisions=t}numProfilesPerJoin(){return this.numBendSubdivisions+1}extrude(e,t,r){const n=yEe;if(Math.abs(e.rotationAngle)>=this.cutoffAngle)for(let s=0;s<this.numBendSubdivisions+1;++s){Bc(B8,.5*-e.rotationAngle+s*e.rotationAngle/this.numBendSubdivisions,e.rotationFrame.up),aEe(n,e.frame,B8);for(let a=0;a<t.vertices.length;++a)Fr(t.vertices[a],e.rotationRight)*e.rotationAngle>=0?r(e.index,n,t.vertices[a],t.vertexNormals[a],!1):(_5(pg,t.vertices[a],e.miterStretch),r(e.index,e.frame,pg,t.vertexNormals[a],!0))}else for(let s=0;s<this.numBendSubdivisions+1;++s)for(let a=0;a<t.vertices.length;++a){const o=Fr(t.vertices[a],e.rotationRight)*e.rotationAngle>=0;_5(pg,t.vertices[a],e.miterStretch),r(e.index,e.frame,pg,t.vertexNormals[a],!o)}}};const dEe={generateUV:!1};let x4=class{rebuildConnectingProfileGeometry(e,t,r){for(let n=0;n<t.vertices.length;++n)r(e.index,e.frame,t.vertices[n],t.vertexNormals[n],0,0)}},U8=class extends x4{constructor(){super()}getNumVertices(){return 0}getNumIndices(){return 0}rebuildCapGeometry(){}buildTopology(){}},IC=class extends x4{constructor(e,t=0,r=!1){super(),this.profile=e,this.profilePlaneOffset=t,this.flip=r}getNumVertices(){return this.profile.vertices.length}getNumIndices(){return 3*this.profile.numSegments}rebuildConnectingProfileGeometry(e,t,r){for(let n=0;n<t.vertices.length;++n)r(e.index,e.frame,t.vertices[n],t.vertexNormals[n],this.profilePlaneOffset,0)}rebuildCapGeometry(e,t){const r=T4;Je(r,0,0);const n=this.flip?1:-1;for(let s=0;s<this.profile.vertices.length;++s)t(e.index,e.frame,this.profile.vertices[s],r,this.profilePlaneOffset,n)}buildTopology(e,t){const r=this.vertexBufferStart+this.profile.vertexIndices[0];for(let n=1;n<this.profile.numSegments;++n){const s=this.profile.vertexIndices[2*n+0],a=this.profile.vertexIndices[2*n+1],o=this.vertexBufferStart+s,l=this.vertexBufferStart+a;this.flip?t(l,o,r):t(r,o,l)}}},z8=class extends x4{constructor(e){super(),this.flip=!1,this.sign=0,this.breakNormals=!1,this.numSegments=3,this.profile=e.profile,this.flip=e.flip,this.sign=this.flip?1:-1,this.breakNormals=e.breakNormals,this.numSegments=e.subdivisions}getNumVertices(){let e=0;return e=this.profile.vertices.length*(this.numSegments-1),this.breakNormals&&(e+=this.profile.vertices.length),e+=this.profile.poles.length,e}getNumIndices(){let e=0;e+=2*this.profile.numSegments*(this.numSegments-1);for(let t=0;t<this.profile.numSegments;++t){const r=this.profile.vertexIndices[2*t+0],n=this.profile.vertexIndices[2*t+1];this.profile.poleIndices[r]===this.profile.poleIndices[n]?e+=1:e+=2}return 3*e}rebuildCapGeometry(e,t){const r=e.frame,n=.5*this.sign,s=pg,a=T4;Je(a,0,0);for(let o=0;o<this.profile.poles.length;++o){const l=this.profile.poles[o];l.normal?t(e.index,r,l.position,l.normal,n,0):t(e.index,r,l.position,a,n,this.sign)}if(this.breakNormals)for(let o=0;o<this.profile.vertices.length;++o)t(e.index,r,this.profile.vertices[o],this.profile.vertexNormals[o],0,0);for(let o=0;o<this.numSegments-1;++o){const l=(1-(o+1)/this.numSegments)*Math.PI*.5,c=Math.sin(l),u=Math.cos(l);for(let d=0;d<this.profile.vertices.length;++d){const m=this.profile.poles[this.profile.poleIndices[d]];Pc(s,this.profile.vertices[d],m.position),qs(s,s,c),m.normal?(yc(s,s,m.position),t(e.index,r,s,m.normal,n*u,0)):(j0(a,s),qs(a,a,c),yc(s,s,m.position),t(e.index,r,s,a,n*u,this.sign*u))}}}buildTopology(e,t){const r=this.breakNormals?this.vertexBufferStart+this.profile.poles.length:this.firstProfileVertexIndex,n=this.breakNormals?this.vertexBufferStart+this.profile.poles.length+this.profile.vertices.length:this.vertexBufferStart+this.profile.poles.length;for(let s=0;s<this.profile.numSegments;++s){const a=this.profile.vertexIndices[2*s+0],o=this.profile.vertexIndices[2*s+1],l=this.vertexBufferStart+this.profile.poleIndices[a],c=this.vertexBufferStart+this.profile.poleIndices[o];let u=r+a,d=r+o;for(let m=0;m<this.numSegments-1;++m){const f=n+m*this.profile.vertices.length+a,_=n+m*this.profile.vertices.length+o;this.flip?(t(f,d,u),t(d,f,_)):(t(u,d,f),t(_,f,d)),u=f,d=_}this.flip?(t(l,d,u),l!==c&&t(l,c,d)):(t(u,d,l),l!==c&&t(d,c,l))}}},pEe=class{constructor(e,t,r,n,s,a=dEe){this.options=a,this._extrusionVertexCount=0,this.numExtrusionProfiles=0,this.numVerticesTotal=0,this.numNormalsTotal=0,this.numUVTotal=0,this.profile=t,this.path=e,this.extruder=r,this.startCap=n,this.endCap=s;const o=this.path.vertices.length-2;this.numExtrusionProfiles=r.numProfilesPerJoin()*o+2,this.numVerticesTotal=t.vertices.length*this.numExtrusionProfiles,this.numNormalsTotal=this.numVerticesTotal,this.startCap.vertexBufferStart=this.numVerticesTotal;const l=this.startCap.getNumVertices();this.numVerticesTotal+=l,this.numNormalsTotal+=l,this.endCap.vertexBufferStart=this.numVerticesTotal;const c=this.endCap.getNumVertices();this.numVerticesTotal+=c,this.numNormalsTotal+=c,this.pathVertexData=new Float32Array(1*this.numVerticesTotal),this.profileRightAxisData=new Float32Array(4*this.numVerticesTotal),this.profileUpAxisData=new Float32Array(4*this.numVerticesTotal),this.profileVertexAndNormalData=new Float32Array(4*this.numVerticesTotal),this.profile.hasUV()&&this.options.generateUV&&(this.numUVTotal=this.profile.uvs.length,this.uvData=new Float32Array(2*this.numUVTotal)),this.originData=new Float32Array(3*this.path.vertices.length),this._rebuildGeometry(),this.buildTopology()}emitVertex(e,t,r,n,s){if(this.profileRightAxisData[4*this._extrusionVertexCount+0]=t.right[0],this.profileRightAxisData[4*this._extrusionVertexCount+1]=t.right[1],this.profileRightAxisData[4*this._extrusionVertexCount+2]=t.right[2],this.profileUpAxisData[4*this._extrusionVertexCount+0]=t.up[0],this.profileUpAxisData[4*this._extrusionVertexCount+1]=t.up[1],this.profileUpAxisData[4*this._extrusionVertexCount+2]=t.up[2],this.profileVertexAndNormalData[4*this._extrusionVertexCount+0]=r[0],this.profileVertexAndNormalData[4*this._extrusionVertexCount+1]=r[1],this.profileVertexAndNormalData[4*this._extrusionVertexCount+2]=n[0],this.profileVertexAndNormalData[4*this._extrusionVertexCount+3]=n[1],this.pathVertexData[this._extrusionVertexCount]=e,s){const a=this.path.vertices[e];this.profileRightAxisData[4*this._extrusionVertexCount+3]=a.rotationRight[0]*a.maxStretchDistance,this.profileUpAxisData[4*this._extrusionVertexCount+3]=a.rotationRight[1]*a.maxStretchDistance}else this.profileRightAxisData[4*this._extrusionVertexCount+3]=0,this.profileUpAxisData[4*this._extrusionVertexCount+3]=0;++this._extrusionVertexCount}emitCapVertex(e,t,r,n,s,a){this.profileRightAxisData[4*this._extrusionVertexCount+0]=t.right[0],this.profileRightAxisData[4*this._extrusionVertexCount+1]=t.right[1],this.profileRightAxisData[4*this._extrusionVertexCount+2]=t.right[2],this.profileUpAxisData[4*this._extrusionVertexCount+0]=t.up[0],this.profileUpAxisData[4*this._extrusionVertexCount+1]=t.up[1],this.profileUpAxisData[4*this._extrusionVertexCount+2]=t.up[2],this.profileVertexAndNormalData[4*this._extrusionVertexCount+0]=r[0],this.profileVertexAndNormalData[4*this._extrusionVertexCount+1]=r[1],this.profileVertexAndNormalData[4*this._extrusionVertexCount+2]=n[0],this.profileVertexAndNormalData[4*this._extrusionVertexCount+3]=n[1],this.pathVertexData[this._extrusionVertexCount]=e,this.profileRightAxisData[4*this._extrusionVertexCount+3]=s,this.profileUpAxisData[4*this._extrusionVertexCount+3]=a,++this._extrusionVertexCount}emitTriangle(e,t,r){this.vertexIndices.push(e),this.vertexIndices.push(t),this.vertexIndices.push(r),this.pathVertexIndices.push(this.pathVertexData[e]),this.pathVertexIndices.push(this.pathVertexData[t]),this.pathVertexIndices.push(this.pathVertexData[r]),this.normalIndices.push(e),this.normalIndices.push(t),this.normalIndices.push(r)}_rebuildGeometry(){const e=(r,n,s,a,o)=>this.emitVertex(r,n,s,a,o),t=(r,n,s,a,o,l)=>this.emitCapVertex(r,n,s,a,o,l);this._extrusionVertexCount=0;for(const r of this.path.vertices)this.originData[3*r.index+0]=r.pos[0],this.originData[3*r.index+1]=r.pos[1],this.originData[3*r.index+2]=r.pos[2];this.startCap.rebuildConnectingProfileGeometry(this.path.vertices[0],this.profile,t);for(let r=1;r<this.path.vertices.length-1;++r)this.extruder.extrude(this.path.vertices[r],this.profile,e);if(this.endCap.rebuildConnectingProfileGeometry(this.path.vertices[this.path.vertices.length-1],this.profile,t),this.startCap.rebuildCapGeometry(this.path.vertices[0],t),this.endCap.rebuildCapGeometry(this.path.vertices[this.path.vertices.length-1],t),this.profile.hasUV()&&this.options.generateUV)for(let r=0;r<this.profile.uvs.length;++r)this.uvData[2*r+0]=this.profile.uvs[r],this.uvData[2*r+1]=0}buildTopology(){const e=this.profile.vertices.length,t=this.profile.numSegments,r=this.numExtrusionProfiles-1;let n=3*(2*(t*r));this.startCap.indexBufferStart=n,this.startCap.firstProfileVertexIndex=0,n+=this.startCap.getNumIndices(),this.endCap.indexBufferStart=n,this.endCap.firstProfileVertexIndex=e*(this.numExtrusionProfiles-1),this.vertexIndices=new Array,this.normalIndices=new Array,this.pathVertexIndices=new Array,this.profile.hasUV()&&this.options.generateUV&&(this.uvIndices=new Array);for(let a=0;a<t;++a){const o=this.profile.vertexIndices[2*a],l=this.profile.vertexIndices[2*a+1];for(let c=0;c<r;++c){const u=c*e+o,d=(c+1)*e+o,m=(c+1)*e+l,f=c*e+l;this.emitTriangle(u,d,m),this.emitTriangle(u,m,f)}}const s=(a,o,l)=>this.emitTriangle(a,o,l);this.startCap.buildTopology(this.path.vertices[0],s),this.endCap.buildTopology(this.path.vertices[this.path.vertices.length-1],s)}onPathChanged(){this._rebuildGeometry()}},hK=class{constructor(e){this.builder=e}get xform(){return this.builder.path.xform}onPathChanged(){this.builder.onPathChanged()}},uK=class extends hK{constructor(e){super(e),this.vertexAttributePosition=null,this.vertexAttributeNormal=null,this.vertexAttributeColor=null,this.vertexAttributePosition=new Float32Array(3*this.builder.numVerticesTotal),this.vertexAttributeNormal=new Float32Array(3*this.builder.numNormalsTotal),this.vertexAttributeColor=new Uint8Array(4),this.vertexAttributeColor[0]=255,this.vertexAttributeColor[1]=255,this.vertexAttributeColor[2]=255,this.vertexAttributeColor[3]=255}bakeVertexColors(e){this.vertexAttributeColor[0]=255*e[0],this.vertexAttributeColor[1]=255*e[1],this.vertexAttributeColor[2]=255*e[2],this.vertexAttributeColor[3]=255*(e.length>3?e[3]:1)}bake(e){this.size=e;for(let t=0;t<this.builder.numVerticesTotal;++t){let r=this.builder.pathVertexData[t];const n=r===0||r===this.builder.path.vertices.length-1;r*=3;const s=fEe;Z(s,this.builder.originData[r++],this.builder.originData[r++],this.builder.originData[r]);const a=4*t,o=oc,l=pg,c=_l,u=l$,d=_Ee;let m=0,f=0;if(Z(u,this.builder.profileRightAxisData[a],this.builder.profileRightAxisData[a+1],this.builder.profileRightAxisData[a+2]),Z(d,this.builder.profileUpAxisData[a],this.builder.profileUpAxisData[a+1],this.builder.profileUpAxisData[a+2]),Je(l,this.builder.profileVertexAndNormalData[a]*e[0],this.builder.profileVertexAndNormalData[a+1]*e[1]),n)nt(c,d,u),m=this.builder.profileRightAxisData[a+3]*e[0],f=this.builder.profileUpAxisData[a+3];else{const g=T4,x=gEe;Je(g,this.builder.profileRightAxisData[a+3],this.builder.profileUpAxisData[a+3]);const b=gI(g);j0(g,g);const v=Fr(l,g);if(Math.abs(v)>b){Je(x,-g[1],g[0]);const w=Fr(l,x);qs(g,g,b*Math.sign(v)),qs(x,x,w),yc(l,g,x)}Z(c,0,0,0)}Z(o,u[0]*l[0]+d[0]*l[1],u[1]*l[0]+d[1]*l[1],u[2]*l[0]+d[2]*l[1]),this.vertexAttributePosition[3*t+0]=s[0]+o[0]+c[0]*m,this.vertexAttributePosition[3*t+1]=s[1]+o[1]+c[1]*m,this.vertexAttributePosition[3*t+2]=s[2]+o[2]+c[2]*m;const _=pg;Je(_,this.builder.profileVertexAndNormalData[a+2],this.builder.profileVertexAndNormalData[a+3]),this.vertexAttributeNormal[3*t+0]=u[0]*_[0]+d[0]*_[1]+c[0]*f,this.vertexAttributeNormal[3*t+1]=u[1]*_[0]+d[1]*_[1]+c[1]*f,this.vertexAttributeNormal[3*t+2]=u[2]*_[0]+d[2]*_[1]+c[2]*f}}createGeometryData(){const e=[[P.POSITION,this.builder.vertexIndices],[P.NORMAL,this.builder.normalIndices]],t=[[P.POSITION,{size:3,data:this.vertexAttributePosition,exclusive:!0}],[P.NORMAL,{size:3,data:this.vertexAttributeNormal,exclusive:!0}]];if(this.vertexAttributeColor){const r=this.builder.vertexIndices.length;e.push([P.COLOR,new Array(r).fill(0)]),t.push([P.COLOR,{size:4,data:this.vertexAttributeColor}])}return{vertexAttributes:t,indices:e}}onPathChanged(){super.onPathChanged(),this.bake(this.size)}intersect(e,t,r){const n=this.builder.vertexIndices,s={size:3,data:this.vertexAttributePosition},a=n.length/3;ID(e,t,0,a,n,s,void 0,void 0,r)}},mEe=class extends hK{constructor(e,t,r,n){super(e),this.sizeAttributeValue=t,this.colorAttributeValue=r,this.opacityAttributeValue=n,this.vvData=null,this.baked=new uK(e),this.vvData=new Float32Array(4*this.builder.path.vertices.length);for(let s=0;s<this.builder.path.vertices.length;++s){this.vvData[4*s+0]=t,this.vvData[4*s+1]=r,this.vvData[4*s+2]=n;const a=s===0||s===this.builder.path.vertices.length-1;this.vvData[4*s+3]=a?1:0}}createGeometryData(){return{vertexAttributes:[[P.POSITION,{size:3,data:this.builder.originData,exclusive:!0}],[P.PROFILERIGHT,{size:4,data:this.builder.profileRightAxisData,exclusive:!0}],[P.PROFILEUP,{size:4,data:this.builder.profileUpAxisData,exclusive:!0}],[P.PROFILEVERTEXANDNORMAL,{size:4,data:this.builder.profileVertexAndNormalData,exclusive:!0}],[P.FEATUREVALUE,{size:4,data:this.vvData,exclusive:!0}]],indices:[[P.POSITION,this.builder.pathVertexIndices],[P.PROFILERIGHT,this.builder.vertexIndices],[P.PROFILEUP,this.builder.vertexIndices],[P.PROFILEVERTEXANDNORMAL,this.builder.vertexIndices],[P.FEATUREVALUE,this.builder.pathVertexIndices]]}}};const fEe=R(),pg=be(),T4=be(),gEe=be(),oc=R(),_l=R(),l$=R(),_Ee=R(),LC=R(),yEe=a$(),B8=ve(),dK=new Map([[P.POSITION,0],[P.PROFILERIGHT,1],[P.PROFILEUP,2],[P.PROFILEVERTEXANDNORMAL,3],[P.FEATUREVALUE,4]]);let vEe=class extends oae{constructor(){super(...arguments),this.ambient=Ge(.2,.2,.2),this.diffuse=Ge(.8,.8,.8),this.specular=Ge(0,0,0),this.opacity=1}},pK=class mK extends ti{initializeConfiguration(e,t){t.hasWebGL2Context=e.rctx.type===Nn.WEBGL2,t.spherical=e.viewingMode===Se.Global,t.doublePrecisionRequiresObfuscation=IP(e.rctx)}initializeProgram(e){return new Jt(e.rctx,mK.shader.get().build(this.configuration),dK)}initializePipeline(){const e=this.configuration.transparencyPassType,t=this.configuration,r=e===Ht.NONE,n=e===Ht.FrontFace;return Ke({blending:t.output!==k.Color&&t.output!==k.Alpha||!t.transparent?null:r?Hl:jm(e),culling:t.hasSlicePlane&&!t.transparent&&t.doubleSidedMode!==ho.None&&Yre,depthTest:{func:i_(e)},depthWrite:r||n?nl:null,colorWrite:ht,stencilWrite:t.hasOccludees?Cd:null,stencilTest:t.hasOccludees?r_:null,polygonOffset:r||n?null:$D})}};pK.shader=new ii(aae,()=>G(()=>import("./Path.glsl-a65bb2f6.js"),["assets/Path.glsl-a65bb2f6.js","assets/Matrix3PassUniform-ad9f953b.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/mat3f64-c6305894.js","assets/mat4f64-1e28eae0.js","assets/vec3f32-c9aa289f.js","assets/vec3f64-2f9cef06.js","assets/VertexAttribute-9c5c630d.js","assets/mat4-44a0988f.js","assets/common-c186b691.js","assets/vec3-e93e648f.js","assets/vec2f64-30dc1443.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/mathUtils-b4bb77e2.js","assets/vec4-790471c0.js","assets/context-util-a4ce3a7b.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/promiseUtils-1e54421e.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/aaBoundingBox-657a9b82.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/aaBoundingRect-193543b5.js","assets/basicInterfaces-19ed850e.js","assets/ViewingMode-5d7d590b.js","assets/Util-a48361c6.js","assets/vec4f64-e407da96.js","assets/vec2-528adfe4.js","assets/Texture2DPassUniform-753de459.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/compilerUtils-18d58939.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/Normals.glsl-76f97814.js","assets/TransparencyPassType-a11868d2.js","assets/Path.glsl-9f6bab44.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js"]));let cn=class extends cu{constructor(){super(...arguments),this.output=k.Color,this.doubleSidedMode=ho.None,this.transparencyPassType=Ht.NONE,this.spherical=!1,this.receiveShadows=!1,this.receiveAmbientOcclusion=!1,this.vvSize=!1,this.vvColor=!1,this.vvOpacity=!1,this.hasSlicePlane=!1,this.transparent=!1,this.hasOccludees=!1,this.hasMultipassTerrain=!1,this.cullAboveGround=!1,this.doublePrecisionRequiresObfuscation=!1}};h([N({count:k.COUNT})],cn.prototype,"output",void 0),h([N({count:ho.COUNT})],cn.prototype,"doubleSidedMode",void 0),h([N({count:Ht.COUNT})],cn.prototype,"transparencyPassType",void 0),h([N()],cn.prototype,"spherical",void 0),h([N()],cn.prototype,"receiveShadows",void 0),h([N()],cn.prototype,"receiveAmbientOcclusion",void 0),h([N()],cn.prototype,"vvSize",void 0),h([N()],cn.prototype,"vvColor",void 0),h([N()],cn.prototype,"vvOpacity",void 0),h([N()],cn.prototype,"hasSlicePlane",void 0),h([N()],cn.prototype,"transparent",void 0),h([N()],cn.prototype,"hasOccludees",void 0),h([N()],cn.prototype,"hasMultipassTerrain",void 0),h([N()],cn.prototype,"cullAboveGround",void 0),h([N()],cn.prototype,"doublePrecisionRequiresObfuscation",void 0),h([N({constValue:zr.Disabled})],cn.prototype,"pbrMode",void 0),h([N({constValue:!0})],cn.prototype,"hasVvInstancing",void 0),h([N({constValue:!1})],cn.prototype,"useCustomDTRExponentForWater",void 0),h([N({constValue:!1})],cn.prototype,"useFillLights",void 0);let bEe=class fK extends Fd{constructor(e){super(e,new xEe),this.supportsEdges=!0,this._vertexAttributeLocations=dK,this._configuration=new cn,this._vertexBufferLayout=fK.getVertexBufferLayout(this.parameters)}getConfiguration(e,t){return this._configuration.output=e,this._configuration.vvSize=this.parameters.vvSizeEnabled,this._configuration.vvColor=this.parameters.vvColorEnabled,this._configuration.vvOpacity=this.parameters.vvOpacityEnabled,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this.parameters.transparent,this._configuration.hasOccludees=this.parameters.hasOccludees,e!==k.Color&&e!==k.Alpha||(this._configuration.doubleSidedMode=this.parameters.doubleSided&&this.parameters.doubleSidedType==="normal"?ho.View:this.parameters.doubleSided&&this.parameters.doubleSidedType==="winding-order"?ho.WindingOrder:ho.None,this._configuration.receiveShadows=this.parameters.receiveShadows,this._configuration.receiveAmbientOcclusion=!!t.ssaoHelper.ready&&this.parameters.receiveSSAO),this._configuration.transparencyPassType=t.transparencyPassType,this._configuration.hasMultipassTerrain=t.multipassTerrain.enabled,this._configuration.cullAboveGround=t.multipassTerrain.cullAboveGround,this._configuration}isVisibleForOutput(e){return e!==k.Shadow&&e!==k.ShadowExludeHighlight&&e!==k.ShadowHighlight||this.parameters.castShadows}isVisible(){return super.isVisible()&&this.parameters.opacity>0}intersect(e,t,r,n,s,a,o){const l=e;if(!lK(l))return;const c=l.path,u=[this.parameters.size[0],this.parameters.size[1]];if(this.parameters.vvSizeEnabled){const b=this.parameters.vvSizeOffset,v=this.parameters.vvSizeFactor,w=this.parameters.vvSizeMinSize,T=this.parameters.vvSizeMaxSize,E=c.sizeAttributeValue;u[0]*=ce(b[0]+E*v[0],w[0],T[0]),u[1]*=ce(b[2]+E*v[2],w[2],T[2])}const d=Math.max(u[0],u[1]),m=e.boundingInfo;if(S(m))return void this._intersectTriangles(c,u,s,a,o);const f=II(m.bbMin[0]-d,m.bbMin[1]-d,m.bbMin[2]-d,m.bbMax[0]+d,m.bbMax[1]+d,m.bbMax[2]+d),_=[a[0]-s[0],a[1]-s[1],a[2]-s[2]],g=Math.sqrt(_[0]*_[0]+_[1]*_[1]+_[2]*_[2]),x=[g/_[0],g/_[1],g/_[2]];AG(f,s,x,n.tolerance)&&this._intersectTriangles(c,u,s,a,o)}_intersectTriangles(e,t,r,n,s){e.baked.size&&e.baked.size[0]===t[0]&&e.baked.size[1]===t[1]||e.baked.bake(t),e.baked.intersect(r,n,s)}computeAttachmentOrigin(e,t){const r=e.vertexAttributes;if(!r)return null;const n=r.get(P.POSITION);return FD(n,null,!1,t)}createBufferWriter(){return new TEe(this._vertexBufferLayout)}requiresSlot(e,t){switch(t){case k.Shadow:case k.ShadowHighlight:case k.ShadowExludeHighlight:if(!this.parameters.castShadows)return!1;case k.Color:case k.Alpha:case k.Depth:case k.Normal:case k.Highlight:case k.ObjectAndLayerIdColor:return e===(this.parameters.transparent?ae.TRANSPARENT_MATERIAL:ae.OPAQUE_MATERIAL)||e===ae.DRAPED_MATERIAL;default:return!1}}createGLMaterial(e){return new wEe(e)}static getVertexBufferLayout(e){const t=sn().vec3f(P.POSITION).vec4f(P.PROFILERIGHT).vec4f(P.PROFILEUP).vec4f(P.PROFILEVERTEXANDNORMAL);return(e.vvColorEnabled||e.vvSizeEnabled||e.vvOpacityEnabled)&&t.vec4f(P.FEATUREVALUE),t}},wEe=class extends t_{_updateOccludeeState(e){e.hasOccludees!==this._material.parameters.hasOccludees&&this._material.setParameters({hasOccludees:e.hasOccludees})}_updateShadowState(e){(S(this.technique)||e.shadowMap.enabled!==this.technique.configuration.receiveShadows)&&this._material.setParameters({receiveShadows:e.shadowMap.enabled})}beginSlot(e){return this._output!==k.Color&&this._output!==k.Alpha||(this._updateShadowState(e),this._updateOccludeeState(e)),this.ensureTechnique(pK,e)}},xEe=class extends vEe{constructor(){super(...arguments),this.doubleSided=!1,this.doubleSidedType="normal",this.receiveSSAO=!0,this.receiveShadows=!1,this.castShadows=!0,this.hasSlicePlane=!1,this.transparent=!1,this.hasOccludees=!1}},TEe=class{constructor(e){this.vertexBufferLayout=e}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){return e.indices.get(P.POSITION).length}write(e,t,r,n,s){$C(P.PROFILERIGHT,r,n,s),$C(P.PROFILEUP,r,n,s),$C(P.PROFILEVERTEXANDNORMAL,r,n,s),this.vertexBufferLayout.hasField(P.FEATUREVALUE)&&$C(P.FEATUREVALUE,r,n,s),kD(r,this.vertexBufferLayout,e,t,n,s)}};function $C(i,e,t,r){if(e.vertexAttributes.has(i)){const n=e.vertexAttributes.get(i),s=e.indices.get(i);it(n.size===4);const a=t.getField(i,Sd);if(!a)throw new Error("unable to acquire view for "+i);Sw(s,n.data,a,r)}}const CEe=["polyline"];let SEe=class extends du{constructor(e,t,r,n){super(e,t,r,n),this._intrinsicSize=Xt(1,1),this._upVectorAlignment="path",this._stencilWidth=.1,this.ensureDrapedStatus(!1)}async doLoad(){const e=y(this.symbolLayer.width)?this.symbolLayer.width:this.symbolLayer.height,t=y(this.symbolLayer.height)?this.symbolLayer.height:e;this._vvConvertOptions={modelSize:[1,1,1],symbolSize:[e,1,t],unitInMeters:this._context.renderCoordsHelper.unitInMeters,transformation:{anchor:[0,0,0],scale:[1,1,1],rotation:[0,0,0]},supportedTypes:{size:!0,color:!0,opacity:!0,rotation:!1}},this._context.renderer&&this._context.renderer.visualVariables&&this._context.renderer.visualVariables.length>0?this._fastUpdates=mx(this._context.renderer,this._vvConvertOptions):this._fastUpdates={enabled:!1};const r=this.symbolLayer.anchor||"center";this._upVectorAlignment="path",this.symbolLayer.profileRotation==="heading"&&(this._upVectorAlignment="world");const n=this.symbolLayer.profile||"circle";switch(n){case"circle":default:this._profile=V8.circle(OEe);break;case"quad":this._profile=V8.rect()}let s=[0,0];switch(r!=="center"&&(s={left:[.5,0],right:[-.5,0],top:[0,-.5],bottom:[0,.5]}[r],this._profile.translate(s[0],s[1])),this.symbolLayer.join||"simple"){case"round":this._extruder=new vM(0,AEe);break;case"bevel":this._extruder=new vM(0,1);break;case"miter":this._extruder=new vM(.8*Math.PI,1);break;default:this._extruder=new uEe}const a=this.symbolLayer.cap||"butt";switch(a){case"none":this._startCap=new U8,this._endCap=new U8;break;case"butt":default:this._startCap=new IC(this._profile,0),this._endCap=new IC(this._profile,0,!0);break;case"square":this._startCap=new IC(this._profile,-.5),this._endCap=new IC(this._profile,.5,!0);break;case"round":{const f=n==="quad";this._startCap=new z8({profile:this._profile,flip:!1,breakNormals:f,subdivisions:j8}),this._endCap=new z8({profile:this._profile,flip:!0,breakNormals:f,subdivisions:j8});break}}const o=en(this.symbolLayer,"material","color"),l=this._getCombinedOpacityAndColor(o),c=Tl(l),u=l[3],d=u<1||this.needsDrivenTransparentPass,m={diffuse:c,ambient:c,opacity:u,transparent:d,hasVertexColors:!1,hasSlicePlane:this._context.slicePlaneEnabled,castShadows:this.symbolLayer.castShadows,cullFace:d||a==="none"?tn.None:tn.Back,offsetTransparentBackfaces:!0};if(!this._drivenProperties.size&&(Je(this._intrinsicSize,e,t),!eP(this._intrinsicSize[0])||!eP(this._intrinsicSize[1])))throw new K("graphics3dpathsymbollayer:invalid-size","Symbol sizes may not be negative values");if(this._fastUpdates.enabled&&this._fastUpdates.visualVariables.size||qs(this._intrinsicSize,this._intrinsicSize,1/this._context.renderCoordsHelper.unitInMeters),this._fastUpdates.enabled){const f={...m,...this._fastUpdates.materialParameters,size:$ie(this._intrinsicSize)};this._material=new bEe(f)}else m.hasVertexColors=this._drivenProperties.color||this._drivenProperties.opacity,this._material=new Ew(m);this._material.setParameters({usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0}),this._context.stage.add(this._material)}destroy(){super.destroy(),this._context.stage.remove(this._material),this._material=null}createGraphics3DGraphic(e){const t=e.graphic;if(!this._validateGeometry(t.geometry,CEe,this.symbolLayer.type))return null;const r=this.setGraphicElevationContext(t,new Qc),n=e.renderingInfo;return this._createAs3DShape(t,n,r,t.uid)}layerOpacityChanged(){const e=en(this.symbolLayer,"material","color"),t=this._getCombinedOpacity(e),r=t<1||this.needsDrivenTransparentPass;this._material.setParameters({opacity:t,transparent:r})}layerElevationInfoChanged(e,t){return this.updateGraphics3DGraphicElevationInfo(e,t,zm)}slicePlaneEnabledChanged(){return this._material.setParameters({hasSlicePlane:this._context.slicePlaneEnabled}),!0}physicalBasedRenderingChanged(){return this._material.setParameters({usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0}),!0}pixelRatioChanged(){return!0}applyRendererDiff(e,t){for(const r in e.diff){if(r!=="visualVariables"||!fx(this._fastUpdates,t,this._vvConvertOptions))return Gr.Recreate_Symbol;this._material.setParameters(this._fastUpdates.materialParameters)}return Gr.Fast_Update}getVertexData(e){let t=0;const r=e.paths,n=[],s=e.spatialReference,a=this._context.elevationProvider.spatialReference,o=this._context.renderCoordsHelper.spatialReference;for(const f of r)t+=f.length;const l=new Float64Array(3*t),c=new Float64Array(3*t),u=new Float64Array(3*t);let d=0;for(const f of r){n.push({index:d,numVertices:f.length});for(const _ of f)l[d++]=_[0],l[d++]=_[1],l[d++]=e.hasZ?_[2]:0}let m=!0;return y(a)&&!s.equals(a)?m=Ma(l,s,0,c,a,0,t):this._copyVertices(l,0,c,0,t),y(a)&&!a.equals(o)?Ma(c,a,0,u,o,0,t):this._copyVertices(c,0,u,0,t),{pathVertexDataInfos:n,vertexDataGS:l,vertexDataES:c,vertexDataRS:u,projectionSuccess:m,terrainElevation:0}}_copyVertices(e,t,r,n,s){t*=3,n*=3;for(let a=0;a<s;++a)r[n++]=e[t++],r[n++]=e[t++],r[n++]=e[t++]}_createAs3DShape(e,t,r,n){const s=e.geometry,a=new Array,o=new Array,l=new Array,c=s.spatialReference,u=Ms(),d=this._context.renderCoordsHelper;_K.spatialReference=c;const m=this.getVertexData(s);if(!m.projectionSuccess)return this.logger.warn("PathSymbol3DLayer geometry failed to be created (failed to project geometry to view spatial reference)"),null;if(m.pathVertexDataInfos.length>0){for(let f=0;f<m.pathVertexDataInfos.length;++f){const _=m.pathVertexDataInfos[f],g=_.index,x=_.numVertices;if(x<2||y(this._context.clippingExtent)&&(Mi(u),Jo(u,m.vertexDataES,3*g,x),!Lc(u,this._context.clippingExtent)))continue;const b=[];for(let I=g;I<g+3*x;){const L=I++,U=I++,j=I++,re=new lEe;Z(re.posGS,m.vertexDataGS[L],m.vertexDataGS[U],m.vertexDataGS[j]),Z(re.posES,m.vertexDataES[L],m.vertexDataES[U],m.vertexDataES[j]);const ee=pxe(re.posES,this._context.elevationProvider,r,d);Z(Ll,m.vertexDataRS[L],m.vertexDataRS[U],m.vertexDataRS[j]),d.setAltitude(Ll,ee),Z(re.pos,Ll[0],Ll[1],Ll[2]),b.push(re)}const v=new cEe(b);gK(v,this._upVectorAlignment,this._context.renderCoordsHelper);const w=new pEe(v,this._profile,this._extruder,this._startCap,this._endCap);let T=null;if(this._fastUpdates.enabled){const I=this._fastUpdates.visualVariables,L=I.size?_d(I.size.field,e):0,U=I.color?_d(I.color.field,e):0,j=I.opacity?_d(I.opacity.field,e):0;T=new mEe(w,L,U,j)}else{const I=[this._intrinsicSize[0],this._intrinsicSize[1]];this._drivenProperties.size&&(I[0]*=G8(t.size[0],t.size[2]==="symbol-value"?this.symbolLayer.height||0:t.size[2],this.symbolLayer.width||0),I[1]*=G8(t.size[2],t.size[0]==="symbol-value"?this.symbolLayer.width||0:t.size[0],this.symbolLayer.height||0));let L=null;this._drivenProperties.color&&(L=t.color),this._drivenProperties.opacity&&t.opacity!=null&&(L=L?[L[0],L[1],L[2],t.opacity]:[1,1,1,t.opacity]);const U=new uK(w);U.bake(I),L&&U.bakeVertexColors(L),T=U}const{vertexAttributes:E,indices:C}=T.createGeometryData(),A=this._context.stage.renderView._getObjectAndLayerIdColor({graphicUid:n,layerUid:this._context.layer.uid}),M=new iEe(E,C,T,c,this._upVectorAlignment,this._stencilWidth,A);a.push(M),o.push(this._material),l.push(T.xform)}if(a.length>0){const f={layerUid:this._context.layer.uid,graphicUid:n},_=new Bd({geometries:a,materials:o,transformations:l,metadata:f}),g=new uu(this,_,a,null,null,PEe,r);return g.alignedSampledElevation=m.terrainElevation,g.needsElevationUpdates=zm(r.mode),g}}else s.paths.length!==0&&s.paths.some(f=>f.length>0)||this.logger.warn("PathSymbol3DLayer geometry failed to be created (no paths were defined)");return null}};function gK(i,e,t){switch(e){case"world":for(const r of i.vertices)oe(ch,r.pos,i.offset),t.worldUpAtPosition(ch,Ll),r.setFrameFromUpVector(Ll),r.computeRotationAxisAndAngleFromUpVector();break;case"path":oe(ch,i.vertices[0].pos,i.offset),t.worldUpAtPosition(ch,Ll),hEe(i,Ll);for(const r of i.vertices){const n=Math.sign(me(r.frame.right,r.vRight));nt(r.rotationFrame.up,r.vRight,r.vLeft),Q(r.rotationFrame.up,r.rotationFrame.up,n),he(r.rotationFrame.up,r.rotationFrame.up);const s=me(r.rotationFrame.up,r.frame.up),a=me(r.rotationFrame.up,r.frame.right);if(Q(ch,r.frame.up,-a),Q(H8,r.frame.right,s),oe(ch,ch,H8),he(r.rotationFrame.right,ch),oEe(r.rotationRight,r.frame,r.rotationFrame.right),Aa(ch,r.vLeft),r.rotationAngle=-n*(Math.PI-ls(me(ch,r.vRight))),Math.abs(r.rotationAngle)>0){const l=tI(Math.cos(.5*r.rotationAngle));w4(r.miterStretch,1+(l-1)*r.rotationRight[0]*r.rotationRight[0],(l-1)*r.rotationRight[0]*r.rotationRight[1],(l-1)*r.rotationRight[0]*r.rotationRight[1],1+(l-1)*r.rotationRight[1]*r.rotationRight[1])}const o=Math.PI-r.rotationAngle;r.maxStretchDistance=Math.abs(Math.min(r.vLeftLength,r.vRightLength)*tI(Math.cos(.5*o)))}}}function G8(i,e,t){switch(i){case"symbol-value":return t;case"proportional":return e;default:return i}}function EEe(i,e,t,r){let n=0;for(const s of i.vertices)$d(s.posES,t,e,r,bM),n+=bM.sampledElevation,oe(Ll,s.pos,i.offset),r.setAltitude(Ll,bM.z),ne(s.pos,Ll,i.offset);return i.updatePathVertexInformation(),n/i.vertices.length}function PEe(i,e,t,r){const n=i.stageObject,s=n.geometryRecords;let a=0;REe.spatialReference=r.spatialReference;for(const o of s){const l=o.geometry;if(!lK(l))continue;const c=l.path,u=c.builder.path,d=l.geometrySR;_K.spatialReference=d,a+=EEe(u,e,t,r),l.upVectorAlignment!=="world"&&gK(u,l.upVectorAlignment,r),c.onPathChanged(),l.invalidateBoundingInfo(),n.geometryVertexAttrsUpdated(o)}return a/s.length}const REe=kd(0,0,0,null),_K=kd(0,0,0,null),Ll=R(),ch=Xi(),H8=Xi(),bM=new Jx,AEe=3,j8=3,OEe=10;function MEe(i,e,t,r,n=1){if(t.isGeographic&&r===Se.Global){const o=new Float64Array(e.typedBuffer.length),l=3*e.count,c=Yt(t);for(let u=0;u<l;u+=3)E7(e.typedBuffer,u,o,u,c);e=$m.fromTypedArray(o)}Je(kr,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY);for(let o=0;o<e.count;o++)e.getVec(o,ao),kr[0]=Math.min(kr[0],ao[0]),kr[1]=Math.min(kr[1],ao[1]);const s=kr[0]%n,a=kr[1]%n;Al[0]=kr[0]-s,Al[1]=kr[1]-a;for(let o=0;o<e.count;o++)e.getVec(o,ao),i.setValues(o,(ao[0]-Al[0])/n,(ao[1]-Al[1])/n,Al[0]/n,Al[1]/n)}function yK(i,e,t,r,n=1){Z(gf,1,0,0),Z(_f,0,1,0),Z(Z_,0,0,1),$Ee(wM,e),IEe(e,q8)&&LEe(q8,gf,_f,Z_,t,wM),Je(kr,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),Je(yf,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(let l=0;l<e.count;l++){e.getVec(l,ao);const c=me(gf,ao),u=me(_f,ao);kr[0]=Math.min(kr[0],c),kr[1]=Math.min(kr[1],u),yf[0]=Math.max(yf[0],c),yf[1]=Math.max(yf[1],u)}const s=me(Z_,wM);TM(cp,kr[0],kr[1],s,gf,_f,Z_),TM(vf,yf[0],kr[1],s,gf,_f,Z_),TM(bf,kr[0],yf[1],s,gf,_f,Z_),ne(vf,vf,cp),Q(vf,vf,.5),ne(bf,bf,cp),Q(bf,bf,.5),oe(cp,cp,vf),oe(cp,cp,bf);const a=kr[0]%n,o=kr[1]%n;Al[0]=kr[0]-a,Al[1]=kr[1]-o;for(let l=0;l<e.count;l++){e.getVec(l,ao),i.setValues(l,(me(gf,ao)-Al[0])/n,(me(_f,ao)-Al[1])/n,Al[0]/n,Al[1]/n);for(let c=0;c<3;c++)r.set(l,c,cp[c]),r.set(l,c+3,vf[c]),r.set(l,c+6,bf[c])}}const wM=R(),ao=R(),q8=fr(),gf=R(),_f=R(),Z_=R(),kr=be(),yf=be(),Al=be(),cp=R(),vf=R(),bf=R();function IEe(i,e){const t=i.count-1;return Tre(i,e,0,Math.floor(t/3),Math.floor(t*(2/3)))}function LEe(i,e,t,r,n,s){y(n)?(n.basisMatrixAtPosition(s,hh),Z(DC,hh[0],hh[1],hh[2]),Z(FC,hh[4],hh[5],hh[6]),Z(xM,hh[8],hh[9],hh[10])):(Z(DC,1,0,0),Z(FC,0,1,0),Z(xM,0,0,1));const a=Ia(i);me(a,xM)<0&&Q(a,a,-1),q(r,a);const o=me(a,FC),l=me(a,DC);Math.abs(o)<Math.abs(l)?(v5(e,DC,a,-l),he(e,e),nt(t,e,a),he(t,t),Q(t,t,-1)):(v5(t,FC,a,-o),he(t,t),nt(e,t,a),he(e,e))}const hh=ve(),DC=R(),FC=R(),xM=R();function $Ee(i,e){Z(NC,0,0,0);for(let t=0;t<e.count-1;t++)e.getVec(t,ao),oe(NC,NC,ao);Q(i,NC,1/(e.count-1))}const NC=R();function TM(i,e,t,r,n,s,a){Z(i,e*n[0]+t*s[0]+r*a[0],e*n[1]+t*s[1]+r*a[1],e*n[2]+t*s[2]+r*a[2])}let vK=class bK extends ti{initializeConfiguration(e,t){t.hasWebGL2Context=e.rctx.type===Nn.WEBGL2}initializeProgram(e){return new Jt(e.rctx,bK.shader.get().build(this.configuration),ai)}_createPipeline(e,t){const r=this.configuration,n=e===Ht.NONE,s=e===Ht.FrontFace;return Ke({blending:r.output!==k.Color&&r.output!==k.Alpha||!r.transparent?null:n?Hl:jm(e),culling:OD(r.cullFace),depthTest:{func:i_(e)},depthWrite:n||s?r.writeDepth&&nl:null,colorWrite:ht,stencilWrite:r.hasOccludees?Cd:null,stencilTest:r.hasOccludees?t?Ig:r_:null,polygonOffset:n||s?r.polygonOffset&&DEe:ND(r.enableOffset)})}initializePipeline(){return this._occludeePipelineState=this._createPipeline(this.configuration.transparencyPassType,!0),this._createPipeline(this.configuration.transparencyPassType,!1)}getPipelineState(e,t){return t?this._occludeePipelineState:super.getPipelineState(e,t)}};vK.shader=new ii(lae,()=>G(()=>import("./ColorMaterial.glsl-b3baa2ff.js"),["assets/ColorMaterial.glsl-b3baa2ff.js","assets/Matrix3PassUniform-ad9f953b.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/mat3f64-c6305894.js","assets/mat4f64-1e28eae0.js","assets/vec3f32-c9aa289f.js","assets/vec3f64-2f9cef06.js","assets/VertexAttribute-9c5c630d.js","assets/mat4-44a0988f.js","assets/common-c186b691.js","assets/vec3-e93e648f.js","assets/vec4f64-e407da96.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/Texture2DPassUniform-753de459.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/TransparencyPassType-a11868d2.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/VertexColor.glsl-8c022fa8.js","assets/OutputDepth.glsl-470c8e2a.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/AlphaCutoff-96178e0d.js","assets/Float4PassUniform-d7bdbc81.js"]));const DEe={factor:1,units:1};let Qa=class extends cu{constructor(){super(...arguments),this.output=k.Color,this.cullFace=tn.None,this.hasSlicePlane=!1,this.hasVertexColors=!1,this.transparent=!1,this.polygonOffset=!1,this.enableOffset=!0,this.writeDepth=!0,this.hasOccludees=!1,this.transparencyPassType=Ht.NONE,this.hasMultipassTerrain=!1,this.cullAboveGround=!1,this.objectAndLayerIdColorInstanced=!1}};h([N({count:k.COUNT})],Qa.prototype,"output",void 0),h([N({count:tn.COUNT})],Qa.prototype,"cullFace",void 0),h([N()],Qa.prototype,"hasSlicePlane",void 0),h([N()],Qa.prototype,"hasVertexColors",void 0),h([N()],Qa.prototype,"transparent",void 0),h([N()],Qa.prototype,"polygonOffset",void 0),h([N()],Qa.prototype,"enableOffset",void 0),h([N()],Qa.prototype,"writeDepth",void 0),h([N()],Qa.prototype,"hasOccludees",void 0),h([N({count:Ht.COUNT})],Qa.prototype,"transparencyPassType",void 0),h([N()],Qa.prototype,"hasMultipassTerrain",void 0),h([N()],Qa.prototype,"cullAboveGround",void 0),h([N()],Qa.prototype,"objectAndLayerIdColorInstanced",void 0);let W8=class extends Fd{constructor(e){super(e,new NEe),this.supportsEdges=!0,this._configuration=new Qa}getConfiguration(e,t){return this._configuration.output=e,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasVertexColors=this.parameters.hasVertexColors,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this.parameters.transparent,this._configuration.polygonOffset=this.parameters.polygonOffset,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.hasOccludees=this.parameters.hasOccludees,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration.enableOffset=t.camera.relativeElevation<VD,this._configuration.hasMultipassTerrain=t.multipassTerrain.enabled,this._configuration.cullAboveGround=t.multipassTerrain.cullAboveGround,this._configuration}intersect(e,t,r,n,s,a,o){MD(e,t,n,s,a,void 0,o)}requiresSlot(e,t){return t===k.Color||t===k.Alpha||t===k.Highlight||t===k.Depth&&this.parameters.writeLinearDepth||t===k.ObjectAndLayerIdColor?e===ae.DRAPED_MATERIAL?!0:t===k.Highlight?e===ae.OPAQUE_MATERIAL:e===(this.parameters.transparent?this.parameters.writeDepth?ae.TRANSPARENT_MATERIAL:ae.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL:ae.OPAQUE_MATERIAL):!1}createGLMaterial(e){return new FEe(e)}createBufferWriter(){return new LR(St("enable-feature:objectAndLayerId-rendering")?RTe:DY)}},FEe=class extends t_{_updateOccludeeState(e){e.hasOccludees!==this._material.parameters.hasOccludees&&this._material.setParameters({hasOccludees:e.hasOccludees})}beginSlot(e){return this._output!==k.Color&&this._output!==k.Alpha||this._updateOccludeeState(e),this.ensureTechnique(vK,e)}},NEe=class extends Vx{constructor(){super(...arguments),this.color=w0,this.transparent=!1,this.writeDepth=!0,this.writeLinearDepth=!1,this.hasVertexColors=!1,this.polygonOffset=!1,this.hasSlicePlane=!1,this.cullFace=tn.None,this.hasOccludees=!1}},wK=class xK extends ti{initializeConfiguration(e,t){t.hasWebGL2Context=e.rctx.type===Nn.WEBGL2}initializeProgram(e){return new Jt(e.rctx,xK.shader.get().build(this.configuration),TK)}_setPipelineState(e,t){const r=this.configuration,n=e===Ht.NONE,s=e===Ht.FrontFace;return Ke({blending:r.output===k.Color||r.output===k.Alpha?n?Hl:jm(e):null,culling:OD(r.cullFace),depthTest:{func:i_(e)},depthWrite:n?r.writeDepth&&nl:LP(e),colorWrite:ht,stencilWrite:r.hasOccludees?Cd:null,stencilTest:r.hasOccludees?t?Ig:r_:null,polygonOffset:n||s?r.polygonOffset&&kEe:ND(r.enableOffset)})}initializePipeline(){return this._occludeePipelineState=this._setPipelineState(this.configuration.transparencyPassType,!0),this._setPipelineState(this.configuration.transparencyPassType,!1)}getPipelineState(e,t){return t?this._occludeePipelineState:super.getPipelineState(e,t)}};wK.shader=new ii(cae,()=>G(()=>import("./Pattern.glsl-6461350d.js"),["assets/Pattern.glsl-6461350d.js","assets/Matrix3PassUniform-ad9f953b.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/mat3f64-c6305894.js","assets/mat4f64-1e28eae0.js","assets/vec3f32-c9aa289f.js","assets/vec3f64-2f9cef06.js","assets/VertexAttribute-9c5c630d.js","assets/mat4-44a0988f.js","assets/common-c186b691.js","assets/vec3-e93e648f.js","assets/vec4f64-e407da96.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/Texture2DPassUniform-753de459.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/TransparencyPassType-a11868d2.js","assets/Pattern.glsl-67f4595b.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/VertexColor.glsl-8c022fa8.js","assets/OutputDepth.glsl-470c8e2a.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/AlphaCutoff-96178e0d.js","assets/Float4PassUniform-d7bdbc81.js","assets/FloatPassUniform-68d54f51.js"]));const kEe={factor:1,units:1};let zs=class extends cu{constructor(){super(...arguments),this.output=k.Color,this.cullFace=tn.None,this.transparencyPassType=Ht.NONE,this.hasSlicePlane=!1,this.hasVertexColors=!1,this.polygonOffset=!1,this.writeDepth=!0,this.hasOccludees=!1,this.enableOffset=!0,this.hasMultipassTerrain=!1,this.cullAboveGround=!1}};h([N({count:k.COUNT})],zs.prototype,"output",void 0),h([N({count:tn.COUNT})],zs.prototype,"cullFace",void 0),h([N({count:Up.COUNT})],zs.prototype,"style",void 0),h([N({count:Ht.COUNT})],zs.prototype,"transparencyPassType",void 0),h([N()],zs.prototype,"hasSlicePlane",void 0),h([N()],zs.prototype,"hasVertexColors",void 0),h([N()],zs.prototype,"polygonOffset",void 0),h([N()],zs.prototype,"writeDepth",void 0),h([N()],zs.prototype,"hasOccludees",void 0),h([N()],zs.prototype,"patternSpacing",void 0),h([N()],zs.prototype,"lineWidth",void 0),h([N()],zs.prototype,"enableOffset",void 0),h([N()],zs.prototype,"draped",void 0),h([N()],zs.prototype,"hasMultipassTerrain",void 0),h([N()],zs.prototype,"cullAboveGround",void 0);const TK=new Map([[P.POSITION,0],[P.COLOR,3],[P.UVMAPSPACE,4],[P.BOUNDINGRECT,5]]);let C4=class extends Fd{constructor(e){super(e,new zEe),this.supportsEdges=!0,this._vertexAttributeLocations=TK,this._configuration=new zs}getConfiguration(e,t){return this._configuration.output=e,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasVertexColors=this.parameters.hasVertexColors,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.polygonOffset=this.parameters.polygonOffset,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.style=this.parameters.style,this._configuration.patternSpacing=this.parameters.patternSpacing,this._configuration.lineWidth=this.parameters.lineWidth,this._configuration.draped=this.parameters.draped,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration.enableOffset=t.camera.relativeElevation<VD,this._configuration.hasMultipassTerrain=t.multipassTerrain.enabled,this._configuration.cullAboveGround=t.multipassTerrain.cullAboveGround,this._configuration}intersect(e,t,r,n,s,a,o){MD(e,t,n,s,a,void 0,o)}requiresSlot(e,t){return t===k.Color||t===k.Alpha||t===k.Highlight||t===k.Depth&&this.parameters.writeLinearDepth?e===ae.DRAPED_MATERIAL?!0:t===k.Highlight?e===ae.OPAQUE_MATERIAL:e===(this.parameters.writeDepth?ae.TRANSPARENT_MATERIAL:ae.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL):!1}createGLMaterial(e){return new VEe(e)}createBufferWriter(){const e=sn().vec3f(P.POSITION).vec4u8(P.COLOR).vec4f(P.UVMAPSPACE);return this.parameters.draped||e.mat3f(P.BOUNDINGRECT),new UEe(e)}},VEe=class extends t_{_updateParameters(e){return this.ensureTechnique(wK,e)}_updateOccludeeState(e){e.hasOccludees!==this._material.parameters.hasOccludees&&this._material.setParameters({hasOccludees:e.hasOccludees})}beginSlot(e){return this._output!==k.Color&&this._output!==k.Alpha||this._updateOccludeeState(e),this._updateParameters(e)}},UEe=class extends LR{write(e,t,r,n,s){for(const a of this.vertexBufferLayout.fieldNames){const o=r.vertexAttributes.get(a),l=r.indices.get(a);if(o&&l)switch(a){case P.POSITION:{it(o.size===3);const c=n.getField(a,Dm);c&&LD(l,o.data,e,c,s);break}case P.COLOR:{it(o.size===3||o.size===4);const c=n.getField(a,Lm);c&&UG(l,o.data,o.size,c,s);break}case P.UVMAPSPACE:{it(o.size===4);const c=n.getField(a,Sd);c&&Sw(l,o.data,c,s);break}case P.BOUNDINGRECT:{it(o.size===9);const c=n.getField(a,Aw);c&&this.writeBoundingRect(l,o.data,e,c,s);break}}}}writeBoundingRect(e,t,r,n,s){const a=r,o=n.typedBuffer,l=n.typedBufferStride,c=e.length;s*=l;for(let u=0;u<c;++u){const d=9*e[u],m=t[d],f=t[d+1],_=t[d+2];o[s]=a[0]*m+a[4]*f+a[8]*_+a[12],o[s+1]=a[1]*m+a[5]*f+a[9]*_+a[13],o[s+2]=a[2]*m+a[6]*f+a[10]*_+a[14];for(let g=3;g<9;++g)o[s+g]=t[d+g];s+=l}}},zEe=class extends Vx{constructor(){super(...arguments),this.color=Bi(1,1,1,1),this.writeDepth=!0,this.writeLinearDepth=!1,this.hasVertexColors=!1,this.polygonOffset=!1,this.hasSlicePlane=!1,this.cullFace=tn.None,this.hasOccludees=!1,this.style=Up.Cross,this.patternSpacing=10,this.lineWidth=1,this.draped=!0}};function BEe(i,e,t){return HEe(GEe(i),e,t)}function GEe(i){return i&&i.pattern||null}function HEe(i,e,t){return y(i)?i.style==="none"||i.style==="solid"?(i.style==="none"&&(e.color=Bi(0,0,0,0),e.transparent=!0),new W8(e)):(e.style=jEe(i.style),e.draped=t.isDraped,new C4(e)):new W8(e)}function jEe(i){switch(i){case"horizontal":return Up.Horizontal;case"vertical":return Up.Vertical;case"cross":return Up.Cross;case"forward-diagonal":return Up.ForwardDiagonal;case"backward-diagonal":return Up.BackwardDiagonal;case"diagonal-cross":return Up.DiagonalCross;default:return}}function qEe(i){return i.material instanceof C4&&!i.material.parameters.draped}function WEe(i,e){if(qEe(i)){const t=i.geometry.vertexAttributes,r=t.get(P.POSITION).data,n=t.get(P.UVMAPSPACE).data,s=t.get(P.BOUNDINGRECT).data;yK(Sd.fromTypedArray(n),$m.fromTypedArray(r),e,eH.fromTypedArray(s))}}function XEe(i,e,t,r){const n=aY(i,e,t,r),s=i.stageObject.geometryRecords;for(let a=0;a<s.length;a++)WEe(s[a],r);return n}const QEe=["polyline","polygon","extent"];let CK=class SK extends du{constructor(e,t,r,n){super(e,t,r,n),this._needsUV=!1,this._hasOutline=!1}async doLoad(){}_ensureMaterials(){this._ensureFillMaterial(),this._ensureOutlineMaterial()}_ensureFillMaterial(){if(y(this._material))return;const e=en(this.symbolLayer,"material","color"),t=this._getCombinedOpacityAndColor(e);this._material=BEe(this.symbolLayer,{color:t,transparent:t[3]<1||this.needsDrivenTransparentPass,polygonOffset:!1,hasVertexColors:!0,writeLinearDepth:!0,hasSlicePlane:this._context.slicePlaneEnabled},{isDraped:this.draped}),this._needsUV=this._material instanceof C4,this._context.stage.add(this._material)}_ensureOutlineMaterial(){const e=this.symbolLayer.outline;if(y(this._outlineMaterial)||!this._isValidOutline(e))return;this._hasOutline=!0;const t=r=>{const n=eK(e.pattern);return new g0({width:r,color:this._getOutlineColor(),hasPolygonOffset:!0,hasSlicePlane:this._context.slicePlaneEnabled,isClosed:!0,stipplePattern:n,stippleScaleWithLineWidth:!0,cap:n$(e.patternCap||"butt")})};this._outlineMaterial=t(Sa(e.size)),this._context.stage.add(this._outlineMaterial)}_isValidOutline(e){return y(e)&&e.size&&e.size>0&&y(e.color)&&(S(e.pattern)||e.pattern.type!=="style"||e.pattern.style!=="none")}destroy(){super.destroy(),this._context.stage.remove(this._material),this._material=null,this._context.stage.remove(this._outlineMaterial),this._outlineMaterial=null}createGraphics3DGraphic(e){const t=e.graphic;if(!this._validateGeometry(t.geometry,QEe,this.symbolLayer.type))return null;const r=this._getVertexOpacityAndColor(e.renderingInfo,255),n=this.setGraphicElevationContext(t,new Qc);return this.ensureDrapedStatus(n.mode==="on-the-ground"),this._ensureMaterials(),this.draped?this._createAsOverlay(t,r):this._createAs3DShape(t,r,n)}layerOpacityChanged(){if(y(this._material)){const e=this._material.parameters.color,t=en(this.symbolLayer,"material","color"),r=this._getCombinedOpacity(t);this._material.setParameters({color:[e[0],e[1],e[2],r],transparent:r<1||this.needsDrivenTransparentPass})}if(y(this._outlineMaterial)){const e=this._outlineMaterial.parameters.color;this._outlineMaterial.setParameters({color:[e[0],e[1],e[2],this._getOutlineOpacity()]})}}layerElevationInfoChanged(e,t,r){const n=this._elevationContext.mode,s=Kx(SK.elevationModeChangeTypes,r,n);if(s!==Zi.UPDATE)return s;const a=Ql(n);return this.updateGraphics3DGraphicElevationInfo(e,t,()=>a)}slicePlaneEnabledChanged(){if(y(this._material)&&this._material.setParameters({hasSlicePlane:this._context.slicePlaneEnabled}),y(this._outlineMaterial)){const e={hasSlicePlane:this._context.slicePlaneEnabled};this._outlineMaterial.setParameters(e)}return!0}physicalBasedRenderingChanged(){return!0}pixelRatioChanged(){return!0}_createAs3DShape(e,t,r){var u;const n=px(e.geometry);if(S(n))return null;const s=v4(n,this._context.elevationProvider,this._context.renderCoordsHelper,r),a=new ZEe(s,t,this._context.layer.uid,e.uid),o=a.renderData.position.length/3;if(this._needsUV&&(a.uvMapSpace=new Float32Array(4*o),a.boundingRect=new Float64Array(9*o)),a.objectAndLayerIdColor=(u=this._context.stage.renderView)==null?void 0:u._getObjectAndLayerIdColor({graphicUid:a.graphicsUid,layerUid:a.layerUid}),this._createAs3DShapeFill(a),this._hasOutline&&this._createAs3DShapeOutline(a),this._logGeometryCreationWarnings(a.renderData,n.rings,"rings","FillSymbol3DLayer"),a.outGeometries.length===0)return null;this._needsUV&&yK(Sd.fromTypedArray(a.uvMapSpace),$m.fromTypedArray(a.renderData.position),this._context.renderCoordsHelper,eH.fromTypedArray(a.boundingRect));const l=new Bd({geometries:a.outGeometries,materials:a.outMaterials,transformations:a.outTransforms,castShadow:!1,metadata:{layerUid:this._context.layer.uid,graphicUid:e.uid}}),c=new uu(this,l,a.outGeometries,null,null,XEe,r);return c.alignedSampledElevation=a.renderData.sampledElevation,c.needsElevationUpdates=Ql(r.mode),c}_createAs3DShapeFill(e){const t=e.renderData.polygons;for(const{position:r,mapPosition:n,holeIndices:s,index:a,count:o}of t){if(y(this._context.clippingExtent)&&(Mi(Ns),Jo(Ns,n),!Lc(Ns,this._context.clippingExtent)))continue;const l=Ow(n,s,3);if(l.length===0)continue;const c=NU({indices:l,attributeData:{position:r,color:e.color,mapPosition:n,uvMapSpace:this._needsUV?new Float32Array(e.uvMapSpace.buffer,4*a*e.uvMapSpace.BYTES_PER_ELEMENT,4*o):null,boundingRect:this._needsUV?new Float64Array(e.boundingRect.buffer,9*a*e.boundingRect.BYTES_PER_ELEMENT,9*o):null,objectAndLayerIdColor:e.objectAndLayerIdColor}});e.outGeometries.push(c),e.outMaterials.push(ct(this._material)),e.outTransforms.push(rn)}}_createAs3DShapeOutline(e){if(!this._hasOutline)return;const t=e.renderData.outlines;for(let r=0;r<t.length;++r){const{mapPosition:n,position:s}=t[r];if(y(this._context.clippingExtent)&&(Mi(Ns),Jo(Ns,n),!Lc(Ns,this._context.clippingExtent)))continue;const a=s$({overlayInfo:null,removeDuplicateStartEnd:!0,attributeData:{position:s,mapPosition:n}},e.objectAndLayerIdColor),o=a.vertexAttributes.get(P.POSITION);o.data===s&&(o.data=new Float64Array(s)),e.outGeometries.push(a),e.outMaterials.push(ct(this._outlineMaterial)),e.outTransforms.push(rn)}}_createAsOverlay(e,t){var o;const r=px(e.geometry);if(S(r))return null;ct(this._material).renderPriority=this._renderPriority+this._renderPriorityStep/2,y(this._outlineMaterial)&&(this._outlineMaterial.renderPriority=this._renderPriority);const n=UY(r,this._context.overlaySR),s=new YEe(n,t,this._context.layer.uid,e.uid),a=s.renderData.position.length/3;return this._needsUV&&(s.uvMapSpace=new Float32Array(4*a)),s.outBoundingBox=Mi(),s.objectAndLayerIdColor=(o=this._context.stage.renderView)==null?void 0:o._getObjectAndLayerIdColor({graphicUid:s.graphicsUid,layerUid:s.layerUid}),this._createAsOverlayFill(s),this._hasOutline&&this._createAsOverlayOutline(s),this._logGeometryCreationWarnings(s.renderData,r.rings,"rings","FillSymbol3DLayer"),s.outGeometries.length===0?null:(this._needsUV&&MEe(Sd.fromTypedArray(s.uvMapSpace),$m.fromTypedArray(s.renderData.position),this._context.overlaySR,this._context.graphicsCoreOwner.view.state.viewingMode),new $R(this,s.outGeometries,s.outBoundingBox,this._context.drapeSourceRenderer))}_createAsOverlayFill(e){const t=e.renderData.polygons;for(const{position:r,holeIndices:n,index:s,count:a}of t){if(Mi(Ns),Jo(Ns,r),!Lc(Ns,this._context.clippingExtent))continue;const o=Ow(r,n,3);if(o.length===0)continue;X0(e.outBoundingBox,Ns);const l=NU({indices:o,attributeData:{position:r,color:e.color,uvMapSpace:this._needsUV?new Float32Array(e.uvMapSpace.buffer,4*s*e.uvMapSpace.BYTES_PER_ELEMENT,4*a):null,objectAndLayerIdColor:e.objectAndLayerIdColor}}),c=new hv(l,ct(this._material),{layerUid:e.layerUid,graphicUid:e.graphicsUid}),u=Ns;Qs(c.boundingSphere,.5*(u[0]+u[3]),.5*(u[1]+u[4]),0,.5*Math.sqrt((u[3]-u[0])*(u[3]-u[0])+(u[4]-u[1])*(u[4]-u[1]))),e.outGeometries.push(c)}}_createAsOverlayOutline(e){if(!this._hasOutline)return;const t=e.renderData.outlines;for(let r=0;r<t.length;++r){const{position:n}=t[r];if(Mi(Ns),Jo(Ns,n),!Lc(Ns,this._context.clippingExtent))continue;X0(e.outBoundingBox,Ns);const s=s$({overlayInfo:{spatialReference:this._context.overlaySR,renderCoordsHelper:this._context.renderCoordsHelper},removeDuplicateStartEnd:!0,attributeData:{position:n}},e.objectAndLayerIdColor),a=new hv(s,ct(this._outlineMaterial),{layerUid:e.layerUid,graphicUid:e.graphicsUid}),o=Ns;Qs(a.boundingSphere,.5*(o[0]+o[3]),.5*(o[1]+o[4]),0,.5*Math.sqrt((o[3]-o[0])*(o[3]-o[0])+(o[4]-o[1])*(o[4]-o[1]))),e.outGeometries.push(a)}}_getOutlineOpacity(){const e=en(this.symbolLayer,"outline","color");return(this.draped?1:this._getLayerOpacity())*(y(e)?e.a:0)}_getOutlineColor(){const e=en(this.symbolLayer,"outline","color"),t=this._getOutlineOpacity();return Jb(y(e)?ei.toUnitRGB(e):null,t)}test(){return{...super.test(),createAsOverlay:(e,t)=>this._createAsOverlay(e,t),createAs3DShape:(e,t,r)=>this._createAs3DShape(e,t,r)}}};CK.elevationModeChangeTypes={definedChanged:Zi.RECREATE,staysOnTheGround:Zi.NONE,onTheGroundChanged:Zi.RECREATE};const Ns=Ms();let ZEe=class extends OR{constructor(e,t,r,n){super(e,r,n),this.color=t}},YEe=class extends OR{constructor(e,t,r,n){super(e,r,n),this.color=t}},EK=class PK{constructor(e){this.definition=e,this.key=JSON.stringify(e),this.haloSize=Math.round(e.halo.size),this.textStyle=this._colorToRGBA(e.color),this.haloStyle=this._colorToRGB(e.halo.color),this.backgroundStyle=e.background.color[3]!==0?this._colorToRGBA(e.background.color):null}fontString(e){const t=this.definition.font;return`${t.style} ${t.weight} ${e}px ${t.family}, sans-serif`}_colorToRGB(e){return`rgb(${e.slice(0,3).map(t=>Math.floor(255*t)).toString()})`}_colorToRGBA(e){return`rgba(${e.slice(0,3).map(t=>Math.floor(255*t)).toString()},${e[3]})`}static async fromSymbol(e,t=1){const r=en(e,"material","color"),n=Np(r,w0,ei.toUnitRGBA),s=Np(e.size,12,Sa),a=e.lineHeight,o=y(e.background)?ei.toUnitRGBA(e.background.color):w0,l={family:Np(e.font,"sans-serif",f=>f.family),decoration:Np(e.font,"none",f=>f.decoration),weight:Np(e.font,"normal",f=>f.weight),style:Np(e.font,"normal",f=>f.style)},c=e.halo,u=y(c)&&y(c.color)&&c.size>0?{size:Sa(c.size),color:ei.toUnitRGBA(c.color)}:{size:0,color:w0},d=new PK({color:n,size:s,background:{color:o,padding:y(e.background)?[.65*s,.5*s]:[0,0],borderRadius:y(e.background)?s*(6/16):0},lineSpacingFactor:a,font:l,halo:u,pixelRatio:t}),m=d.fontString(s);try{await document.fonts.load(m)}catch{J.getLogger("esri.views.3d.webgl-engine.lib.TextRenderParameters").warnOnce(`Failed to preload font '${m}'. Some text symbology may be rendered using the default browser font.`)}return d}},KEe=class{constructor(e,t,r){this._renderer=new HY(e,t,r)}get key(){return this._renderer.key}get baselineAnchorY(){return 1-this._renderer.firstRenderedBaselinePosition/this._renderer.renderedHeight}get displayWidth(){return this._renderer.displayWidth}get displayHeight(){return this._renderer.displayHeight}create(){const e=oE(JEe,this._renderer.renderedWidth,this._renderer.renderedHeight),t=e.getContext("2d");return t.save(),this._renderer.render(t,0,0),t.restore(),new FP(e,{wrap:{s:si.CLAMP_TO_EDGE,t:si.CLAMP_TO_EDGE},noUnpackFlip:!1,mipmap:!0,preMultiplyAlpha:!0,powerOfTwoResizeMode:UD.PAD})}};const JEe={canvas:null},e2e=[0,0,1];let t2e=class extends du{constructor(e,t,r,n){super(e,t,r,n),this._elevationOptions={supportsOffsetAdjustment:!0,supportsOnTheGround:!1},this.ensureDrapedStatus(!1)}async doLoad(){if(!this._drivenProperties.size){const e=RR(this.symbolLayer.size);if(e)throw new K("graphics3dtextsymbollayer:invalid-size",e)}await this._createTextRenderParameters()}async _createTextRenderParameters(){const e=this._context.graphicsCoreOwner.view.state.pixelRatio;this._textRenderParameters=await EK.fromSymbol(this.symbolLayer,e)}destroy(){super.destroy()}createGraphics3DGraphic(e){const t=e.graphic,r=dx(t.geometry);if(S(r))return this.logger.warn(`unsupported geometry type for text symbol: ${t.geometry.type}`),null;const n=this.symbolLayer.text;if(S(n)||n==="")return null;const s=rD(this.symbol)&&this.symbol.hasVisibleVerticalOffset()?this.symbol.verticalOffset:null;if(y(s)&&!$7(this.symbolLayer))return this.logger.errorOncePerTick(`Callouts and vertical offset on text symbols are currently only supported with 'center' horizontal alignment (not with '${this.symbolLayer.horizontalAlignment}' alignment)`),null;const a={...n2e,verticalOffset:s,horizontalPlacement:this.symbolLayer.horizontalAlignment,verticalPlacement:uCe(this.symbolLayer.verticalAlignment)};return this._createAs3DShape(t,r,n,a)}createLabel(e,t,r,n){const s=e.graphic,a=dx(s.geometry);if(S(a))return this.logger.warn(`unsupported geometry type for label: ${s.geometry.type}`),null;const o=t.text;return!o||/^\s+$/.test(o)?null:this._createAs3DShape(s,a,o,t,r,n)}setGraphicElevationContext(e,t,r=0){const n=super.setGraphicElevationContext(e,t);return n.addOffsetRenderUnits(r),n}layerOpacityChanged(){return this.logger.warn("layer opacity change not yet implemented in Graphics3DTextSymbolLayer"),!1}layerElevationInfoChanged(e,t){return X8(e,t,(r,n)=>{this.updateGraphicElevationContext(n,r)}),Zi.UPDATE}slicePlaneEnabledChanged(e,t){return X8(e,t,r=>{for(const n of r.stageObject.geometryRecords)n.material.setParameters({hasSlicePlane:this._context.slicePlaneEnabled})}),!0}physicalBasedRenderingChanged(){return!0}pixelRatioChanged(){return!1}updateGraphicElevationContext(e,t){this.setGraphicElevationContext(e,t.elevationContext,t.metadata.elevationOffset),t.needsElevationUpdates=Ql(t.elevationContext.mode)||t.elevationContext.mode==="absolute-height"}_defaultElevationInfoNoZ(){return r2e}_createAs3DShape(e,t,r,n,s,a){const o=this.setGraphicElevationContext(e,new Qc,n.elevationOffset),l=en(e.geometry,"type")==="polyline",c=e.uid;let u=null,d=null;if(S(a)){const L=qY(n.horizontalPlacement);u=new KEe(r,L,this._textRenderParameters);let U=null;if(y(this._context.sharedResources.textures)){d=this._context.sharedResources.textures.fromData(u.key,()=>ct(u).create(),()=>{y(U)&&U.release()});const j=this._context.stage.renderView.textureRepository.acquire(d.texture.id);if(S(j)||Mx(j))return d.release(),null;U=j}}const m=i2e(u,n),f={occlusionTest:!0,screenOffset:n.screenOffset,anchorPosition:m,polygonOffset:!0,color:[1,1,1,1],centerOffsetUnits:n.centerOffsetUnits,debugDrawLabelBorder:n.debugDrawLabelBorder,drawInSecondSlot:!0};if(y(d)&&(f.textureId=d.texture.id),y(a)&&(f.textureId=a.id),y(n.verticalOffset)){const{screenLength:L,minWorldLength:U,maxWorldLength:j}=n.verticalOffset;f.verticalOffset={screenLength:Sa(L),minWorldLength:U||0,maxWorldLength:y(j)?j:1/0}}if(this._context.screenSizePerspectiveEnabled){const{screenSizePerspectiveSettings:L,screenSizePerspectiveSettingsLabels:U}=this._context.sharedResources;f.screenSizePerspective=U.overridePadding(this._textRenderParameters.haloSize+this._textRenderParameters.definition.background.padding[0]),f.screenSizePerspectiveAlignment=L}let _;if(l&&(f.shaderPolygonOffset=1e-4),f.hasSlicePlane=this._context.slicePlaneEnabled,y(s)){const L=JSON.stringify(f);_=s.get(L),S(_)&&(_=new lv(f),s.add(L,_))}else _=new lv(f);const g=[_],x=n.translation,b=y(u)?[u.displayWidth,u.displayHeight]:[0,0],v=n.centerOffset,w=[AL(e2e,x,null,b,v,[0,0],null)],T=this._context.layer.uid,E=d4(this._context,t,w,g,o,T,c);if(E===null)return null;const C=new uu(this,E.object,w,S(s)?g:null,d,hx,o);C.alignedSampledElevation=E.sampledElevation,C.needsElevationUpdates=Ql(o.mode)||o.mode==="absolute-height";const{displayWidth:A,displayHeight:M}=y(u)?u:n;C.getScreenSize=(L=be())=>(L[0]=A,L[1]=M,L);const I={labelText:r,elevationOffset:n.elevationOffset};return C.metadata=I,ux(C,t,this._context.elevationProvider),C}};function X8(i,e,t){i&&i.forEach(r=>{const n=e(r);y(n)&&t(n,r.graphic)})}function i2e(i,e){if(e.verticalPlacement==="baseline"){const r=lCe[e.horizontalPlacement],n=y(i)?i.baselineAnchorY:0;return Xt(r,n)}const t=hCe(e.horizontalPlacement,e.verticalPlacement);return lE[t]}const r2e={mode:"relative-to-ground",offset:0},n2e={text:null,translation:[0,0,0],elevationOffset:0,centerOffset:[0,0,0,1],screenOffset:[0,0],horizontalPlacement:"center",verticalPlacement:"center",verticalOffset:null,centerOffsetUnits:null,debugDrawLabelBorder:!1,displayWidth:0,displayHeight:0},s2e={"calm-small":{waveStrength:.005,perturbationStrength:.02,textureRepeat:12,waveVelocity:.01},"rippled-small":{waveStrength:.02,perturbationStrength:.09,textureRepeat:32,waveVelocity:.07},"slight-small":{waveStrength:.05,perturbationStrength:.07,textureRepeat:28,waveVelocity:.1},"moderate-small":{waveStrength:.075,perturbationStrength:.07,textureRepeat:24,waveVelocity:.1},"calm-medium":{waveStrength:.003125,perturbationStrength:.01,textureRepeat:8,waveVelocity:.02},"rippled-medium":{waveStrength:.035,perturbationStrength:.015,textureRepeat:12,waveVelocity:.07},"slight-medium":{waveStrength:.06,perturbationStrength:.015,textureRepeat:8,waveVelocity:.12},"moderate-medium":{waveStrength:.09,perturbationStrength:.03,textureRepeat:4,waveVelocity:.12},"calm-large":{waveStrength:.01,perturbationStrength:0,textureRepeat:4,waveVelocity:.05},"rippled-large":{waveStrength:.025,perturbationStrength:.01,textureRepeat:8,waveVelocity:.11},"slight-large":{waveStrength:.06,perturbationStrength:.02,textureRepeat:3,waveVelocity:.13},"moderate-large":{waveStrength:.14,perturbationStrength:.03,textureRepeat:2,waveVelocity:.15}},a2e=["polyline","polygon","extent"];let c$=class Vf extends du{constructor(e,t,r,n){super(e,t,r,n)}async doLoad(){}destroy(){super.destroy(),this._context.stage.remove(this._material),this._material=null}createGraphics3DGraphic(e){const t=e.graphic;if(!this._validateGeometry(t.geometry,a2e,this.symbolLayer.type))return null;const r=this.setGraphicElevationContext(t,new Qc);return this.ensureDrapedStatus(r.mode==="on-the-ground"),this.ensureMaterial(),this.draped?this._createAsOverlay(t):this._createAs3DShape(t,r,t.uid)}ensureMaterial(){if(y(this._material))return;const e=new NY,t=this.symbolLayer.color;y(t)&&(e.color=ei.toUnitRGBA(t));const r=this._getCombinedOpacity(t,{hasIntrinsicColor:!0});e.color=[e.color[0],e.color[1],e.color[2],r],e.transparent=r<1||this.needsDrivenTransparentPass,e.waveDirection=y(this.symbolLayer.waveDirection)?Vf.headingVectorFromAngle(this.symbolLayer.waveDirection):Xt(0,0);const n=this.symbolLayer.waveStrength+"-"+this.symbolLayer.waterbodySize,s=s2e[n];e.waveStrength=s.waveStrength,e.waveTextureRepeat=s.textureRepeat,e.waveVelocity=s.waveVelocity,e.flowStrength=s.perturbationStrength,e.hasSlicePlane=this._context.slicePlaneEnabled,e.isDraped=this.draped,this._material=new FY(e),this._context.stage.add(this._material)}layerOpacityChanged(){if(S(this._material))return;const e=this._material.parameters.color,t=this._getCombinedOpacity(this.symbolLayer.color,{hasIntrinsicColor:!0}),r=t<1||this.needsDrivenTransparentPass;this._material.setParameters({color:[e[0],e[1],e[2],t],transparent:r})}layerElevationInfoChanged(e,t,r){const n=this._elevationContext.mode,s=Kx(Vf.elevationModeChangeTypes,r,n);if(s!==Zi.UPDATE)return s;const a=Ql(n);return this.updateGraphics3DGraphicElevationInfo(e,t,()=>a)}slicePlaneEnabledChanged(){return y(this._material)&&this._material.setParameters({hasSlicePlane:this._context.slicePlaneEnabled}),!0}physicalBasedRenderingChanged(){return!0}pixelRatioChanged(){return!0}_createAs3DShape(e,t,r){const n=px(e.geometry);if(S(n))return null;const s=v4(n,this._context.elevationProvider,this._context.renderCoordsHelper,t),a=s.position.length/3,o=new Float64Array(2*a),l=new o2e(s,o);if(this._create3DShapeGeometries(l),this._logGeometryCreationWarnings(l.renderData,n.rings,"rings","WaterSymbol3DLayer"),l.outGeometries.length===0)return null;this._createUVCoordsFromVertices(l.uvCoords,l.renderData.mapPosition,a,this._context.elevationProvider.spatialReference);const c=new Bd({geometries:l.outGeometries,materials:l.outMaterials,transformations:l.outTransforms,castShadow:!1,metadata:{layerUid:this._context.layer.uid,graphicUid:r}}),u=new uu(this,c,l.outGeometries,null,null,aY,t);return u.alignedSampledElevation=l.renderData.sampledElevation,u.needsElevationUpdates=Ql(t.mode),u}_createUVCoordsFromVertices(e,t,r,n){const s=Gm(n);Uc(hp);for(let l=0;l<r;l++)Je(Q8,t[3*l+0],t[3*l+1]),dD(hp,Q8);TD(hp,hp,s);const a=hp[0]%Vf.unitSizeOfTexture,o=hp[1]%Vf.unitSizeOfTexture;kC[0]=hp[0]-a,kC[1]=hp[1]-o;for(let l=0;l<r;l++)e[2*l+0]=(t[3*l+0]*s-kC[0])/Vf.unitSizeOfTexture,e[2*l+1]=(t[3*l+1]*s-kC[1])/Vf.unitSizeOfTexture}_create3DShapeGeometries(e){const t=e.renderData.polygons,r=e.uvCoords;for(const{count:n,index:s,position:a,mapPosition:o,holeIndices:l}of t){if(y(this._context.clippingExtent)&&(Mi(up),Jo(up,o),!Lc(up,this._context.clippingExtent)))continue;const c=Ow(o,l,3);if(c.length===0)continue;const u=new Float64Array(r.buffer,2*s*r.BYTES_PER_ELEMENT,2*n),d=kU({indices:c,attributeData:{position:a,uv0:u,mapPosition:o}});e.outGeometries.push(d),e.outMaterials.push(ct(this._material)),e.outTransforms.push(rn)}}_createAsOverlay(e){const t=px(e.geometry);if(S(t))return null;ct(this._material).renderPriority=this._renderPriority;const r=UY(t,this._context.overlaySR),n=r.position.length/3,s=new Float64Array(2*n),a=new l2e(r,s,this._context.layer.uid,e.uid);return a.outBoundingBox=Mi(),this._createAsOverlayWater(a),this._logGeometryCreationWarnings(a.renderData,t.rings,"rings","WaterSymbol3DLayer"),a.outGeometries.length===0?null:(this._createUVCoordsFromVertices(a.uvCoords,a.renderData.position,n,this._context.overlaySR),new $R(this,a.outGeometries,a.outBoundingBox,this._context.drapeSourceRenderer))}_createAsOverlayWater(e){const t=e.uvCoords,r=e.renderData.polygons;for(const{position:n,holeIndices:s,index:a,count:o}of r){if(Mi(up),Jo(up,n),!Lc(up,this._context.clippingExtent))continue;X0(e.outBoundingBox,up);const l=Ow(n,s,3);if(l.length===0)continue;const c=new Float64Array(t.buffer,2*a*t.BYTES_PER_ELEMENT,2*o),u=kU({indices:l,attributeData:{position:n,uv0:c}}),d=new hv(u,ct(this._material),{layerUid:e.layerUid,graphicUid:e.graphicsUid}),m=up;Qs(d.boundingSphere,.5*(m[0]+m[3]),.5*(m[1]+m[4]),0,.5*Math.sqrt((m[3]-m[0])*(m[3]-m[0])+(m[4]-m[1])*(m[4]-m[1]))),e.outGeometries.push(d)}}static headingVectorFromAngle(e){const t=be(),r=SP(e);return t[0]=Math.sin(r),t[1]=Math.cos(r),t}test(){return{...super.test(),create3DShape:e=>this._createAs3DShape(e.graphic,e.elevationContext,e.graphicUid),ensureMaterial:()=>this.ensureMaterial()}}};c$.unitSizeOfTexture=100,c$.elevationModeChangeTypes={definedChanged:Zi.RECREATE,staysOnTheGround:Zi.NONE,onTheGroundChanged:Zi.RECREATE};const kC=be(),hp=$t(),Q8=be(),up=Ms();let o2e=class extends OR{constructor(e,t){super(e,null,null),this.uvCoords=t}},l2e=class extends OR{constructor(e,t,r,n){super(e,r,n),this.uvCoords=t}};function c2e(i,e,t,r){const n=Z8[i.type]&&Z8[i.type][e.type]||h2e[e.type];return n?new n(i,e,t,r):(J.getLogger("esri.views.3d.layers.graphics.Graphics3DSymbolLayerFactory").error("GraphicsLayerFactory#make",`unknown symbol type ${e.type}`),null)}const h2e={icon:r$,object:DSe,line:tK,path:SEe,fill:CK,extrude:JTe,text:t2e,water:c$},Z8={"mesh-3d":{fill:oSe}};let u2e=class extends l4{constructor(e,t,r){super(t.schedule),this._symbol=e,this._context=t,this._backgroundLayers=r,this._destroyed=!1,this.symbolLayers=new Array,this.referenced=0,this._extentPadding=0}set symbol(e){this._symbol=e;for(let t=0;t<e.symbolLayers.length;t++){const r=this.symbolLayers[t];S(r)||(r.symbol=e,r.symbolLayer=e.symbolLayers.items[t])}}get symbol(){return this._symbol}async doLoad(e){let t=this._symbol.symbolLayers;this._extentPadding=0,this._backgroundLayers&&(t=this._backgroundLayers.concat(t));const r=t.length;for(;this.symbolLayers.length<t.length;)this.symbolLayers.push(null);this.symbolLayers.length=t.length;const n=[];for(let s=0;s<r;s++){const a=t.getItemAt(s);if(a.enabled===!1)continue;VC.renderPriority=1-(1+s)/r,VC.renderPriorityStep=1/r,VC.ignoreDrivers=a._ignoreDrivers;const o=c2e(this.symbol,a,this._context,VC);n.push(lte(e,()=>{this.symbolLayers[s]=null,o.destroy()})),this.symbolLayers[s]=o}await lD(this.symbolLayers,async(s,a)=>{if(y(s))try{await s.load(),this._extentPadding+=Math.max(this._extentPadding,s.extentPadding)}catch{this.symbolLayers[a]=null}});for(const s of n)s==null||s.remove();if(n.length=0,xi(e),this.symbolLayers.length&&!this.symbolLayers.some(s=>!!s))throw new Error}getSymbolLayerSize(e){const t=this.symbolLayers[e];return y(t)?t.getCachedSize():null}get extentPadding(){return this._extentPadding}get symbologySnappingSupported(){return this.symbolLayers.some(e=>y(e)&&e.queryForSnapping)}createGraphics3DGraphic(e,t){const r=e.graphic,n=new Array(this.symbolLayers.length);for(let a=0;a<this.symbolLayers.length;a++){const o=this.symbolLayers[a];n[a]=y(o)?o.createGraphics3DGraphic(e):null}const s=this._context.arcade||this._context.featureExpressionInfoContext&&this._context.featureExpressionInfoContext.arcade&&this._context.featureExpressionInfoContext.arcade.modules||null;return new Wxe(r,t||this,n,e.layer,s)}get complexity(){return u4(this.symbolLayers.map(e=>en(e,"complexity")))}globalPropertyChanged(e,t){const r=this.symbolLayers.length;for(let n=0;n<r;n++){const s=this.symbolLayers[n],a=o=>{const l=o.graphics[n];return l instanceof uu?l:null};if(y(s)&&!s.globalPropertyChanged(e,t,a))return!1}return!0}applyRendererDiff(e,t){return this.loadStatus!==jo.LOADED?Gr.Recreate_Symbol:this.symbolLayers.reduce((r,n)=>r!==Gr.Recreate_Symbol&&y(n)?Math.min(r,n.applyRendererDiff(e,t)):r,Gr.Fast_Update)}prepareSymbolPatch(e){if(this.loadStatus===jo.FAILED||e.diff.type!=="partial")return;const t=e.diff.diff;if(!t.symbolLayers||t.symbolLayers.type!=="partial")return;const r=t.symbolLayers.diff;this.symbolLayers.forEach((n,s)=>{if(S(n))return;const a=r[s];if(a){const o={diff:a,graphics3DGraphicPatches:[],symbolLayerStatePatches:[]};n.prepareSymbolLayerPatch(o),e.symbolStatePatches.push(...o.symbolLayerStatePatches),o.graphics3DGraphicPatches.length&&e.graphics3DGraphicPatches.push((l,c)=>{const u=l.graphics[s];y(u)&&o.graphics3DGraphicPatches.forEach(d=>d(u,c))})}})}updateGeometry(e,t){for(let r=0;r<this.symbolLayers.length;r++){const n=this.symbolLayers[r];if(S(n))continue;const s=e.graphics[r];if(S(s)||!n.updateGeometry(s,t))return!1}return!0}onRemoveGraphic(e){for(let t=0;t<this.symbolLayers.length;t++){const r=this.symbolLayers[t];if(S(r))continue;const n=e.graphics[t];y(n)&&r.onRemoveGraphic(n)}}getFastUpdateStatus(){let e=0,t=0,r=0;return this.symbolLayers.forEach(n=>{S(n)||(n.loadStatus===jo.LOADING?e++:n.isFastUpdatesEnabled()?r++:t++)}),{loading:e,slow:t,fast:r}}async queryForSnapping(e,t,r,n){const s=this.symbolLayers.filter(y).filter(o=>y(o.queryForSnapping)).map(o=>o.queryForSnapping(e,t,r,n)),a=await Promise.all(s);return xi(n),a.flat()}destroy(){if(this.destroyed)console.error("Graphics3DSymbol.destroy called when already destroyed!");else{super.destroy();for(const e of this.symbolLayers)y(e)&&e.destroy();this.symbolLayers.length=0,this._destroyed=!0}}get destroyed(){return this._destroyed}};const VC={renderPriority:0,renderPriorityStep:1,ignoreDrivers:!1};let d2e=class extends l4{constructor(e,t,r){super(t),this.symbol=e,this._convert=r,this.symbologySnappingSupported=!1,this.graphics3DSymbol=null,this.referenced=0}getSymbolLayerSize(e){return y(this.graphics3DSymbol)?this.graphics3DSymbol.getSymbolLayerSize(e):null}get symbolLayers(){return y(this.graphics3DSymbol)?this.graphics3DSymbol.symbolLayers:[]}get extentPadding(){return y(this.graphics3DSymbol)?this.graphics3DSymbol.extentPadding:0}async doLoad(e){const t=await this.symbol.fetchSymbol({signal:e});t.id=this.symbol.id,this.graphics3DSymbol=this._convert(t),y(this.graphics3DSymbol)&&await this.graphics3DSymbol.load()}createGraphics3DGraphic(e){return y(this.graphics3DSymbol)?this.graphics3DSymbol.createGraphics3DGraphic(e,this):null}get complexity(){return y(this.graphics3DSymbol)?this.graphics3DSymbol.complexity:h4}globalPropertyChanged(e,t){return!!y(this.graphics3DSymbol)&&this.graphics3DSymbol.globalPropertyChanged(e,t)}applyRendererDiff(e,t){return y(this.graphics3DSymbol)?this.graphics3DSymbol.applyRendererDiff(e,t):Gr.Recreate_Symbol}prepareSymbolPatch(e){y(this.graphics3DSymbol)&&this.graphics3DSymbol.prepareSymbolPatch(e)}updateGeometry(e,t){return!!y(this.graphics3DSymbol)&&this.graphics3DSymbol.updateGeometry(e,t)}onRemoveGraphic(){}getFastUpdateStatus(){return y(this.graphics3DSymbol)?this.graphics3DSymbol.getFastUpdateStatus():{loading:1,fast:0,slow:0}}destroy(){y(this.graphics3DSymbol)&&this.graphics3DSymbol.destroy(),this.graphics3DSymbol=void 0,super.destroy()}get destroyed(){return this.graphics3DSymbol===void 0}};function S4(i){return i instanceof d2e?i.graphics3DSymbol:i instanceof u2e?i:null}const gx=J.getLogger("esri.views.3d.layers.graphics.labelPlacement");function p2e(i){const e=x2e(i);if(S(e))return null;const t=m2e(i,e);if(S(t))return null;const r=t.anchor,n=!!e.hasLabelVerticalOffset;return g2e({anchor:r,verticalOffset:e.verticalOffset,screenOffset:be(),centerOffset:Bi(0,0,0,-1),centerOffsetUnits:"world",translation:R(),elevationOffset:0,hasLabelVerticalOffset:n},t,i)}function m2e(i,e){if(e.anchor)return e;const t=i.labelClass.labelPlacement,r=$c[t],n=r||aP(i);return t&&!r&&gx.warnOncePerTick(`the requested label placement '${t}' is currently unsupported in SceneView.`),f2e(n,i)}function E4(i){const e=i.graphics3DGraphic.graphics3DSymbol,t=S4(e);return y(t)?t.symbol.symbolLayers.getItemAt(0):null}function f2e(i,e){const t=e.graphics3DGraphic.graphic.geometry;if(S(t))return null;if(y(e.disablePlacement))return e.labelClass.labelPlacement?(gx.warnOncePerTick(Y8(i.placement,e.disablePlacement.logEntityDescription)),aP(e)):i;const r=t.type;switch(r){case"polyline":case"polygon":case"extent":case"multipoint":if(e.labelClass.labelPlacement)return gx.warnOncePerTick(Y8(i.placement,`'${r}' geometries`)),aP(e);break;case"point":case"mesh":return i}return i}function Y8(i,e){return`the requested label placement '${i}' is currently unsupported for ${e} in SceneView.`}function aP(i){const e=i.graphics3DGraphic.graphic.geometry;if(S(e))return null;switch(e.type){case"polyline":case"extent":case"multipoint":return{placement:"center-center",normalizedOffset:null,anchor:"center"};case"polygon":{const t=E4(i);return y(t)&&t.type==="extrude"?$c["above-center"]:{placement:"center-center",normalizedOffset:null,anchor:"center"}}case"point":case"mesh":return $c["above-center"];default:return}}function g2e(i,e,t){const r=t.graphics3DGraphic.graphic.geometry;if(S(r))return null;switch(r.type){case"point":y2e(i,e,t);break;case"polygon":_2e(i,e,t);break;case"mesh":P4(i,e,t.graphics3DGraphic.graphics[0])}return i}function _2e(i,e,t){const r=E4(t);if(!S(r))switch(r.type){case"extrude":{const n=t.graphics3DGraphic.graphics[0];y(n)?(n.getBoundingBoxObjectSpace(sw),Ic(sw,i.translation),i.translation[2]=HD(sw)/2):Z(i.translation,0,0,0),P4(i,e,n);break}}}function y2e(i,e,t){const r=E4(t);if(S(r))return;const n=t.graphics3DGraphic.graphics[0];switch(y(n)?n.getCenterObjectSpace(i.translation):Z(i.translation,0,0,0),r.type){case"icon":case"text":v2e(i,e,t,n);break;case"object":P4(i,e,n)}}function v2e(i,e,t,r){const{graphics3DGraphic:n}=t,s=y(r)?r.getScreenSize():null;if(!n.isDraped&&y(s)){const a=b2e(t);v1[0]=s[0]/2*(e.normalizedOffset[0]-a[0]),v1[1]=s[1]/2*(e.normalizedOffset[1]-a[1]),i.screenOffset[0]=v1[0],i.hasLabelVerticalOffset?(i.centerOffset[1]=v1[1],i.centerOffsetUnits="screen"):i.screenOffset[1]=v1[1]}else i.hasLabelVerticalOffset||i.anchor==="center"||($c[t.labelClass.labelPlacement]&&gx.warnOncePerTick(`the requested placement '${e.placement}' is currently unsupported for draped graphics`),i.anchor="center")}function b2e(i,e=T2e){const{graphics3DGraphic:t}=i,r=t.graphics[0],n=y(r)?r.stageObject.geometryRecords[0].material:null;if(n&&n instanceof lv){const s=n.parameters.anchorPosition;e[0]=2*(s[0]-.5),e[1]=2*(s[1]-.5)}else e[0]=0,e[1]=0;return e}function P4(i,e,t){const r=y(t)?t.getBoundingBoxObjectSpace(sw):sw,n=Ge(r[3]-r[0],r[4]-r[1],r[5]-r[2]),s=Math.sqrt(n[0]*n[0]+n[1]*n[1]);i.centerOffset[0]=s/2*e.normalizedOffset[0];const a=i.translation[2],o=n[2]/2*e.normalizedOffset[1];i.translation[2]=0,i.elevationOffset=a+o;const l=_e(n);i.centerOffset[2]=l/2*e.normalizedOffset[2]}function w2e(i){return i==="above-center"}function x2e(i){const e=i.labelClass.labelPlacement,{labelSymbol:t,graphics3DGraphic:r}=i,n=S4(r.graphics3DSymbol),s=co(n,o=>o.symbol.type==="point-3d"?o.symbol:null),a=$c[e]||aP(i);return y(s)&&s.supportsCallout()&&s.hasVisibleVerticalOffset()&&!r.isDraped?{placement:null,hasLabelVerticalOffset:!1,verticalOffset:K8(s.verticalOffset),anchor:null,normalizedOffset:null}:t&&t.hasVisibleVerticalOffset()&&(S(s)||!s.supportsCallout()||!s.verticalOffset||r.isDraped)?w2e(a.placement)?{placement:"above-center",verticalOffset:K8(t.verticalOffset),anchor:"bottom",normalizedOffset:[0,a.normalizedOffset[1],0],hasLabelVerticalOffset:!0}:(gx.errorOncePerTick("Callouts and vertical offset on labels are currently only supported with 'above-center' label placement (not with "+e+" placement)"),null):{placement:null,verticalOffset:null,anchor:null,normalizedOffset:null,hasLabelVerticalOffset:!1}}function K8(i){const{screenLength:e,minWorldLength:t,maxWorldLength:r}=i;return{screenLength:e,minWorldLength:t,maxWorldLength:r}}const $c={"above-center":{placement:"above-center",normalizedOffset:[0,1,0],anchor:"bottom"},"above-left":{placement:"above-left",normalizedOffset:[-1,1,0],anchor:"bottom-right"},"above-right":{placement:"above-right",normalizedOffset:[1,1,0],anchor:"bottom-left"},"below-center":{placement:"below-center",normalizedOffset:[0,-1,2],anchor:"top"},"below-left":{placement:"below-left",normalizedOffset:[-1,-1,0],anchor:"top-right"},"below-right":{placement:"below-right",normalizedOffset:[1,-1,0],anchor:"top-left"},"center-center":{placement:"center-center",normalizedOffset:[0,0,1],anchor:"center"},"center-left":{placement:"center-left",normalizedOffset:[-1,0,0],anchor:"right"},"center-right":{placement:"center-right",normalizedOffset:[1,0,0],anchor:"left"}},J8={"above-center":["default","esriServerPointLabelPlacementAboveCenter"],"above-left":["esriServerPointLabelPlacementAboveLeft"],"above-right":["esriServerPointLabelPlacementAboveRight"],"below-center":["esriServerPointLabelPlacementBelowCenter"],"below-left":["esriServerPointLabelPlacementBelowLeft"],"below-right":["esriServerPointLabelPlacementBelowRight"],"center-center":["esriServerPointLabelPlacementCenterCenter"],"center-left":["esriServerPointLabelPlacementCenterLeft"],"center-right":["esriServerPointLabelPlacementCenterRight"]};for(const i in J8){const e=J8[i],t=$c[i];e.forEach(r=>{$c[r]=t})}Object.freeze&&(Object.freeze($c),Object.keys($c).forEach(i=>{Object.freeze($c[i]),Object.freeze($c[i].normalizedOffset)}));const v1=[0,0],T2e=[0,0],sw=Ms();let ez=class{constructor(e){this._stage=e,this._materials=new Map}get(e){return this._materials.get(e)}add(e,t){this._materials.set(e,t),this._stage.add(t)}dispose(){this._stage.removeMany(Array.from(this._materials.values())),this._materials.clear()}};const CM=512,SM=4096,C2e=.85,S2e=.95;let db=class extends ue{constructor(e){super(e),this.type=gv.Texture,this.id=Cm(),this.events=new nn,this._glTexture=null,this._needsClear=!1,this._elementsToAddOrUpdate=new Map,this._elementsToRemove=new Map,this._elementsToRender=new Map,this._elements=new Map,this._stageObjects=new Map,this.updating=!1}initialize(){this._stage=this.view._stage,this._canvas=this._create2DCanvas(),this._ctx=this._canvas.getContext("2d"),this._stage.add(this);const e=this._computeAtlasResolution(this.view.width,this.view.height);this._createAtlasRegion(e),this._update2DCanvasSize(),this._resetAtlasCursor()}unload(){this._glTexture=Me(this._glTexture),this.updating=!1,this.events.emit("unloaded")}get width(){return this._atlas.size.width}get height(){return this._atlas.size.height}get requiresFrameUpdates(){return!1}_createDescriptor(e){return{target:vi.TEXTURE_2D,pixelFormat:yt.RGBA,dataType:qt.UNSIGNED_BYTE,wrapMode:si.CLAMP_TO_EDGE,flipped:!0,samplingMode:Kt.LINEAR_MIPMAP_LINEAR,hasMipmap:!0,preMultiplyAlpha:!0,maxAnisotropy:e.parameters.maxMaxAnisotropy}}get glTexture(){return this._glTexture}load(e){return y(this._glTexture)||(this._glTexture=new Gi(e,this._createDescriptor(e),this._canvas),this._frameWorker=this.view.resourceController.scheduler.registerTask(dr.TEXT_TEXTURE_ATLAS,this),this.setDirty()),this._glTexture}dispose(){this._elements=null,this._elementsToAddOrUpdate=null,this._elementsToRemove=null,this._elementsToRender=null,this._frameWorker=Os(this._frameWorker),this._glTexture&&(this._stage.remove(this),this._glTexture=Me(this._glTexture)),this._canvas.width=0,this._canvas.height=0,this._canvas=null,this._ctx=null}_create2DCanvas(){const e=document.createElement("canvas");return e.setAttribute("id","canvas2d"),e.setAttribute("style","display:none"),e.setAttribute("width",CM.toString()),e.setAttribute("height",CM.toString()),e}_update2DCanvasSize(){this._canvas.setAttribute("width",this._atlas.size.width.toString()),this._canvas.setAttribute("height",this._atlas.size.height.toString())}_createAtlasRegion(e=CM){this._atlas={size:{width:e,height:e},cursor:{x:0,y:0},lineHeight:0}}_computeAtlasResolution(e,t){let r=Math.max(e,t);return r+=256,r=Y$(r),r=Math.min(r,SM),r}_resizeAtlas(e,t){t=t||e;const r=this._atlas;r.size.width=e,r.size.height=t,y(this._glTexture)&&this._glTexture.resize(e,t),this._update2DCanvasSize()}_resetAtlasCursor(){const e=this._atlas;e.cursor.x=b1,e.cursor.y=b1+tz,e.lineHeight=0,this._needsClear=!0}_getAtlasUsage(){const e=this._atlas;return(e.cursor.x+e.cursor.y*e.size.width)/(e.size.width*e.size.height)}_getExpectedAtlasUsage(){const e=this._elementsToRemove.size,t=this._elementsToAddOrUpdate.size,r=this._elements.size;return this._getAtlasUsage()/r*(r+t-e)}_addAtlasElement(e,t,r,n){const s=this._atlas,{renderedWidth:a,renderedHeight:o,displayWidth:l,displayHeight:c}=e.textRenderer;e.placement.offset.x=s.cursor.x,e.placement.offset.y=s.cursor.y,e.placement.size.width=a,e.placement.size.height=o,e.placement.size.displayWidth=l,e.placement.size.displayHeight=c,e.placement.uvMinMax=[e.placement.offset.x/s.size.width,1-(e.placement.offset.y+o)/s.size.height,(e.placement.offset.x+a)/s.size.width,1-e.placement.offset.y/s.size.height],s.cursor.x+=r,s.lineHeight=Math.max(s.lineHeight,n),this._elements.set(t,e)}_removeAtlasElement(e){if(e&&this._elements.has(e.textId)){const t=e.placement.offset,r=e.placement.size;this._ctx.clearRect(t.x,t.y,r.width,r.height),this._elements.delete(e.textId)}}_ensureStageObjects(e){const t=this._stageObjects.get(e);if(t)return t;const r=new Set;return this._stageObjects.set(e,r),r}_addStageObject(e,t){this._ensureStageObjects(e).add(t)}_removeStageObject(e,t){const r=this._stageObjects.get(e);r&&r.delete(t)&&(t.geometries[0].vertexAttributes.get(P.SIZE).data=[0,0],t.geometryVertexAttrsUpdated(t.geometryRecords[0]))}_processAddition(e,t){const r=this._atlas,n=e.textId,s=e.textRenderer.renderedWidth,a=e.textRenderer.renderedHeight,o=s+b1,l=a+b1+tz;if(r.cursor.x+o<r.size.width&&r.cursor.y+l<r.size.height)this._addAtlasElement(e,n,o,l),this._elementsToRender.set(n,e),this._elementsToAddOrUpdate.delete(n);else{if(!(r.cursor.y+l+r.lineHeight<r.size.height)){const c=this._getExpectedAtlasUsage(),u=c>C2e&&r.size.width<SM;return u&&this._resizeAtlas(2*r.size.width,2*r.size.height),!t||!u&&c>S2e&&r.size.width===SM?(this._processRemovals(),_0.OK):(this._repack(),_0.REPACK)}r.cursor.x=b1,r.cursor.y+=r.lineHeight,r.lineHeight=0,this._addAtlasElement(e,n,o,l),this._elementsToRender.set(n,e),this._elementsToAddOrUpdate.delete(n)}return _0.OK}_processRemovals(){this._elementsToRemove.forEach((e,t)=>{const r=this._stageObjects.get(t);r&&r.size!==0||this._removeAtlasElement(e),r&&r.size===0&&this._stageObjects.delete(t)}),this._elementsToRemove.clear()}_repack(){this._processRemovals(),this._elements.forEach((e,t)=>{e.rendered=!1,this._elementsToAddOrUpdate.set(t,e)}),this._elements.clear(),this._resetAtlasCursor(),this._elementsToRender.clear()}_processRenderingRequest(e){this._ctx.clearRect(e.placement.offset.x,e.placement.offset.y,e.placement.size.width,e.placement.size.height),e.textRenderer.render(this._ctx,e.placement.offset.x,e.placement.offset.y);const t=this._stageObjects.get(e.textId);t&&t.forEach(r=>{r.geometries[0].vertexAttributes.get(P.UV0).data=new Float32Array(e.placement.uvMinMax),r.geometries[0].vertexAttributes.get(P.SIZE).data=[e.placement.size.displayWidth,e.placement.size.displayHeight],r.geometryVertexAttrsUpdated(r.geometryRecords[0])}),e.rendered=!0}get running(){return this.updating}runTask(e,t=!0){if(!this._glTexture)return;let r=!1;if(Er(this._elementsToAddOrUpdate,(s,a)=>{const o=this._elements.get(a);if(o&&o.rendered){const l=this._stageObjects.get(a);return l&&l.forEach(c=>{const u=c.geometries[0].vertexAttributes,d=this._elements.get(a);u.get(P.UV0).data=new Float32Array(d.placement.uvMinMax),u.get(P.SIZE).data=new Float32Array([d.placement.size.displayWidth,d.placement.size.displayHeight]),c.geometryVertexAttrsUpdated(c.geometryRecords[0])}),this._elementsToAddOrUpdate.delete(a),!1}return this._processAddition(this._elementsToAddOrUpdate.get(a),t)===_0.REPACK&&(r=!0,!0)}),r)return void this.runTask(CP,!1);let n=!1;this._elementsToRender.size>0&&this._needsClear&&(this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._needsClear=!1),Er(this._elementsToRender,(s,a)=>(this._processRenderingRequest(s),this._elementsToRender.delete(a),n=!0,e.madeProgress(),e.done)),n&&y(this._glTexture)&&this._glTexture.setData(this._canvas),this.updating=this._elementsToRender.size>0,!this.updating&&oTe.orderedRepackingEnabled&&this.repackOrdered()}addTextTexture(e,t){const r=e.key;this._elementsToAddOrUpdate.has(r)||this._elementsToAddOrUpdate.set(r,{textId:r,placement:{offset:{x:0,y:0},size:{width:0,height:0,displayWidth:0,displayHeight:0},uvMinMax:[]},textRenderer:e,rendered:!1}),this._addStageObject(r,t),this._elementsToRemove.delete(r),this.setDirty()}removeTextTexture(e,t){const r=e.key;this._elementsToRemove.set(r,this._elements.get(r)),this._removeStageObject(r,t)}setDirty(){this._glTexture&&(this.updating=!0)}repackOrdered(){if(this._elements.size===0)return;const e=[];this._elements.forEach((r,n)=>e.push({element:r,key:n}));let t=!0;for(let r=0;r<e.length-1;r++)if(e[r].key.localeCompare(e[r+1].key)>0){t=!1;break}if(!t||this._elementsToRemove.size){e.sort((r,n)=>r.key.localeCompare(n.key)),this._elements.clear();for(const{element:r,key:n}of e)this._elements.set(n,r);this._repack(),this.setDirty()}}get test(){const{_elements:e,_stageObjects:t,_elementsToRemove:r,_atlas:n}=this,s=this;return{elements:e,stageObjects:t,elementsToRemove:r,atlas:n,_resizeAtlas:(a,o)=>s._resizeAtlas(a,o),run:(a,o)=>s.runTask(a,o)}}};h([p({constructOnly:!0})],db.prototype,"view",void 0),h([p({type:Boolean})],db.prototype,"updating",void 0),db=h([D("esri.views.3d.webgl-engine.lib.TextTextureAtlas")],db);const b1=2,tz=2;var _0;(function(i){i[i.OK=0]="OK",i[i.REPACK=1]="REPACK"})(_0||(_0={}));let Uf=class extends ue{constructor(e){super(e),this._dirty=!1,this._labels=new Map,this._labelsToAdd=new Map,this._labelsToRemove=new Map,this._labelingContexts=new Array}setup(){this.dispose(),this._handles=new Ft,this._handles.add([z(()=>{var e;return(e=this.view.state)==null?void 0:e.camera},()=>this.setDirty()),z(()=>{var e;return(e=this.view.state)==null?void 0:e.pixelRatio},()=>this._resetAllLabels()),this.view.resourceController.scheduler.registerTask(dr.LABELER,this)]),this._textTextureAtlas=new db({view:this.view}),this._hudMaterialCollection=new ez(this.view._stage),this._calloutMaterialCollection=new ez(this.view._stage)}dispose(){this._handles=Te(this._handles),this._textTextureAtlas=Me(this._textTextureAtlas),this._hudMaterialCollection=Me(this._hudMaterialCollection),this._calloutMaterialCollection=Me(this._calloutMaterialCollection),this._labelingContexts.length=0,this._labels.clear(),this._labelsToAdd.clear(),this._labelsToRemove.clear()}_activateLabelingContext(e){e.labels.forEach((t,r)=>{this._labels.set(r,t),t.graphics3DGraphic.setVisibilityFlag(Qo.USER_SETTING,!0,$n.LABEL)}),e.active=!0}_deactivateLabelingContext(e){e.labels.forEach((t,r)=>{t.graphics3DGraphic.setVisibilityFlag(Qo.USER_SETTING,!1,$n.LABEL),this.setLabelGraphicVisibility(t.graphics3DGraphic,!1),this._labels.delete(r)}),e.active=!1}_addLabelTextureToAtlas(e){for(const t of e.graphics3DGraphic.labelGraphics){if(!t._labelClass)continue;const r=e.textTextureResources.textRenderers[t._labelIndex];y(r)&&this._textTextureAtlas.addTextTexture(r,t.stageObject)}e.rendered=!0}_removeLabelTextureFromAtlas(e){for(const t of e.graphics3DGraphic.labelGraphics){if(!t._labelClass)continue;const r=e.textTextureResources.textRenderers[t._labelIndex];y(r)&&this._textTextureAtlas.removeTextTexture(r,t.stageObject)}e.rendered=!1}get running(){var e;return this.view.ready&&(this._dirty||((e=this._textTextureAtlas)==null?void 0:e.updating)||this.deconflictor.running)}runTask(e){this._updateLabels(e),!this._dirty&&this.deconflictor.running&&this.deconflictor.runTask(e)}_updateLabels(e){if(this._dirty){this._dirty=!1;for(const t of this._labelingContexts)if(E2e(t)){if(!iz(t)){if(P2e(t)){this._deactivateLabelingContext(t);continue}if(this._createLabelClassContext(t),EM(t)){this._dirty=!0;continue}if(!iz(t))continue}Er(t.labelsToInitialize,(r,n)=>(this._ensureGraphics3DResources(r)&&(this._labels.set(n,r),this.deconflictor.setDirty(),e.madeProgress()),(r.visible&&r.textTextureResources.initialized||!r.visible&&r.hasGraphics3DResources)&&(t.labelsToInitialize.delete(n),e.madeProgress()),e.done))&&(this._dirty=!0)}this._labelsToRemove.forEach(t=>this._removeLabelTextureFromAtlas(t)),this._labelsToAdd.forEach(t=>this._addLabelTextureToAtlas(t)),this._labelsToRemove.clear(),this._labelsToAdd.clear(),this._dirty||this.notifyChange("updating")}}async _createLabelClassContextAsync(e){const t=e.labelClassAbortController.signal;await e.layer.when(),xi(t),e.scaleVisibility&&e.scaleVisibility.updateScaleRangeActive();const r=e.graphics3DCore,n=r.layer,s=n.labelingInfo&&n.labelingInfo.filter(l=>!!l.symbol);if(!s||s.length===0)return;const a=new Array(s.length);let o=!1;await lD(s,async(l,c)=>{const u=l.symbol,d=S4(r.getOrCreateGraphics3DSymbol(u));if(S(d))return void J.getLogger(this.declaredClass).error("Failed to create Graphics3DSymbol for label");await d.load(),xi(t);let m=null;rD(u)&&u.hasVisibleCallout()&&(m=Gxe(u,r.symbolCreationContext),await m.load(),xi(t));const f=await gw(Tse(l,e.layer.fieldsIndex,this.view.spatialReference));if(xi(t),f.ok===!0){const _=await this._createTextRenderParameters(d.symbol);xi(t),a[c]={labelClass:l,labelFunction:f.value,graphics3DSymbol:d,graphics3DCalloutSymbolLayer:m,calloutSymbolLayerIndex:0,textRenderParameters:_}}else J.getLogger(this.declaredClass).error(`Label expression failed to evaluate: ${f.error}`),o=!0}),xi(t),o||(e.labelClassContexts=a)}async _createLabelClassContext(e){return e.labelClassPromise||(e.labelClassPromise=this._createLabelClassContextAsync(e).catch(t=>{if(yo(t))throw t;e.labelClassContexts=null}).then(()=>{e.labelClassAbortController=null,this.notifyChange("updating")}).catch(()=>{}),this.notifyChange("updating")),e.labelClassPromise}async _createTextRenderParameters(e){const t=e.symbolLayers.getItemAt(0);return t&&t.type==="text"?EK.fromSymbol(t,this.view.state.pixelRatio):null}_destroyLabelClassContext(e){for(const r of e.labelClassContexts)--r.graphics3DSymbol.referenced,r.graphics3DSymbol=null;const t=e.labelClassAbortController;e.labelClassAbortController=new AbortController,t&&t.abort(),e.labelClassContexts=[],e.labelClassPromise=null,this.notifyChange("updating")}_createTextSymbolGraphic(e,t,r,n,s){const a={text:e.text,centerOffset:r.centerOffset,translation:r.translation,elevationOffset:r.elevationOffset,screenOffset:r.screenOffset,centerOffsetUnits:r.centerOffsetUnits,horizontalPlacement:y8(r.anchor),verticalPlacement:cCe(r.anchor),verticalOffset:r.verticalOffset,debugDrawLabelBorder:jt.LABELS_SHOW_BORDER,displayWidth:e.displayWidth,displayHeight:e.displayHeight};return dp.graphic=t,dp.renderingInfo=null,dp.layer=n,s.createLabel(dp,a,this._hudMaterialCollection,this._textTextureAtlas)}_createLineCalloutGraphic(e,t,r,n,s){const a={symbol:t,translation:n.translation,elevationOffset:n.elevationOffset,screenOffset:n.screenOffset,centerOffset:n.centerOffset,centerOffsetUnits:n.centerOffsetUnits,materialCollection:this._calloutMaterialCollection};return dp.graphic=e,dp.renderingInfo=a,dp.layer=s,r.createGraphics3DGraphic(dp)}_ensureGraphics3DResources(e){if(e.hasGraphics3DResources)return!1;const t=e.graphics3DGraphic;if(t.destroyed)return!1;this._ensureTextTextureResources(e);const{textTextureResources:r}=e,n=e.labelingContext,s=n.labelClassContexts;if(!s||s.length===0||!n.emptySymbolLabelSupported&&t.graphics.length===0)return!1;let a=!1;const o=t.graphic,l=n.layer,c=CI(n.layer),u=this.view._stage;for(let d=0;d<s.length;d++){const m=r.textRenderers[d],f=r.labelPlacements[d];if(S(m)||S(f))continue;const _=s[d],g=_.graphics3DSymbol,x=g.symbol&&g.symbol.type==="label-3d"?g.symbol:null,b=g.symbolLayers[0];if(!b)continue;b.setElevationInfoOverride(n.elevationInfoOverride);const v=this._createTextSymbolGraphic(m,o,f,l,b);if(!v)return!1;v._labelClass=_.labelClass,v._labelIndex=d,t.addLabelGraphic(v,u,n.stageLayer),t.setVisibilityFlag(Qo.USER_SETTING,c,$n.LABEL),t.clearVisibilityFlag(Qo.SCALE_RANGE,$n.LABEL),t.setVisibilityFlag(Qo.DECONFLICTION,!1,$n.LABEL),a=!0;const w=_.graphics3DCalloutSymbolLayer;if(w&&f.hasLabelVerticalOffset){w.setElevationInfoOverride(n.elevationInfoOverride);const T=this._createLineCalloutGraphic(o,x,w,f,l);y(T)&&(_.calloutSymbolLayerIndex=t.labelGraphics.length,t.addLabelGraphic(T,u,n.stageLayer))}break}return n.scaleVisibility&&a&&n.scaleVisibility.updateGraphicLabelScaleVisibility(t),e.hasGraphics3DResources=!0,!0}_destroyGraphics3DResources(e){const t=e.labelingContext.labelClassContexts;for(const r of e.graphics3DGraphic.labelGraphics){if(r._labelClass==null)continue;const n=t[r._labelIndex].graphics3DSymbol.symbolLayers[0];n!=null&&n.onRemoveGraphic(r)}e.graphics3DGraphic.clearLabelGraphics(),e.hasGraphics3DResources=!1}_ensureTextTextureResources(e){const{textTextureResources:t}=e;if(t.initialized)return;const r=e.labelingContext,n=r.labelClassContexts;if(!n||n.length===0)return;const s=e.graphics3DGraphic.graphic;for(let a=0;a<n.length;a++){const o=n[a];if(t.textRenderers[a]=null,t.labelPlacements[a]=null,!o.textRenderParameters)continue;const l=o.labelFunction;let c;if(l.type==="arcade")try{const v=l.needsHydrationToEvaluate()?sxe(s,r.layer):s;c=l.evaluate(v)}catch{c=null}else c=l.evaluate(s);if(S(c)||c===""||/^\s+$/.test(c))continue;const u=o.graphics3DSymbol,d=u.symbol&&u.symbol.type==="label-3d"?u.symbol:null;if(!u.symbolLayers[0])continue;const m=e.graphics3DGraphic,f=o.labelClass,_=r.disablePlacement,g=p2e({graphics3DGraphic:m,labelSymbol:d,labelClass:f,disablePlacement:_});if(S(g))continue;const x=y8(g.anchor),b=qY(x);t.textRenderers[a]=new HY(c,b,o.textRenderParameters),t.labelPlacements[a]=g}t.initialized=!0}_destroyTextTextureResources(e){const{textTextureResources:t}=e;t.initialized=!1,t.textRenderers=[],t.labelPlacements=[]}_addGraphic(e,t){const r={hasGraphics3DResources:!1,visible:!1,rendered:!1,labelingContext:e,graphics3DGraphic:t,textTextureResources:{initialized:!1,textRenderers:[],labelPlacements:[]}},n=t.graphic.uid;e.labels.set(n,r),e.labelsToInitialize.set(n,r),this.setDirty(),this.deconflictor.setDirty()}_removeGraphic(e,t){const r=t.graphic.uid,n=e.labels.get(r);n&&(this._destroyGraphic(n,r),e.labels.delete(r),e.labelsToInitialize.delete(r),this.setDirty(),this.deconflictor.setDirty())}_destroyGraphic(e,t){this._labels.has(t)&&(this._labels.delete(t),this._labelsToAdd.delete(t),this._labelsToRemove.delete(t)),e.textTextureResources.initialized&&(this._removeLabelTextureFromAtlas(e),this._destroyTextTextureResources(e)),e.hasGraphics3DResources&&this._destroyGraphics3DResources(e)}async _labelingInfoChange(e,t){if(!t)return this._visibilityInfoChange(e),this._resetLabels(e),this._createLabelClassContext(e);for(const r of t){const n=e.labels.get(r);n&&(this._removeGraphic(e,n.graphics3DGraphic),this._addGraphic(e,n.graphics3DGraphic))}}_globalPropertyChanged(e,t){for(const r of t.labelClassContexts){const n=new Map;t.labels.forEach(a=>{const o=a.graphics3DGraphic;n.set(o.graphic.uid,o)});const s=a=>a.labelGraphics[0];if(ct(r.graphics3DSymbol.symbolLayers[0]).globalPropertyChanged(e,n,s),r.graphics3DCalloutSymbolLayer){const a=o=>o.labelGraphics[r.calloutSymbolLayerIndex];r.graphics3DCalloutSymbolLayer.globalPropertyChanged(e,n,a)}}}_visibilityInfoChange(e){const t=e.layer.labelsVisible;t&&!e.active&&this._activateLabelingContext(e),!t&&e.active&&this._deactivateLabelingContext(e),this.setDirty()}_resetAllLabels(){for(const e of this._labelingContexts)this._resetLabels(e)}_resetLabels(e){e.labels.forEach((t,r)=>{this._destroyGraphic(t,r),t.visible=!1,t.rendered=!1,e.labelsToInitialize.set(r,t)}),this._destroyLabelClassContext(e),this.setDirty(),this.deconflictor.setDirty()}_findLabelingContext(e){for(const t of this._labelingContexts)if(t.graphics3DCore===e)return t;return null}addGraphicsOwner(e,t,r){const n=r&&r.emptySymbolLabelSupported||!1,s=r&&r.elevationInfoOverride||null,a=r&&r.disablePlacement||null;if(this._findLabelingContext(e))return;const o=e.layer,l={graphics3DCore:e,layer:o,scaleVisibility:t,emptySymbolLabelSupported:n,elevationInfoOverride:s,disablePlacement:a,active:o.labelsVisible,labelClassPromise:null,labelClassAbortController:new AbortController,labelClassContexts:[],labels:new Map,labelsToInitialize:new Map,stageLayer:new CY({isPickable:!0},o.uid)};return this.view._stage.add(l.stageLayer),this._labelingContexts.push(l),this.setDirty(),{addGraphic:c=>this._addGraphic(l,c),removeGraphic:c=>this._removeGraphic(l,c),featureReductionChange:()=>{},layerLabelsEnabled:()=>CI(l.layer),labelingInfoChange:c=>this._labelingInfoChange(l,c),elevationInfoChange:()=>this._globalPropertyChanged("elevationInfo",l),slicePlaneEnabledChange:()=>this._globalPropertyChanged("slicePlaneEnabled",l),visibilityInfoChange:()=>this._visibilityInfoChange(l),reset:()=>this._resetLabels(l),clear:()=>{}}}removeGraphicsOwner(e){const t=this._findLabelingContext(e);if(!t)return;const r=this._labelingContexts.indexOf(t);this._labelingContexts.splice(r,1),t.labels.forEach(n=>this._removeGraphic(t,n.graphics3DGraphic)),this.view._stage.remove(t.stageLayer),t.stageLayer=null,this.setDirty()}setLabelGraphicVisibility(e,t){const r=e.graphic.uid,n=this._labels.get(r);n&&n.visible!==t&&(t&&!n.rendered?(this._labelsToAdd.set(r,n),this._labelsToRemove.delete(r),n.textTextureResources.initialized||n.labelingContext.labelsToInitialize.set(r,n)):!t&&n.rendered&&(this._labelsToRemove.set(r,n),this._labelsToAdd.delete(r)),n.visible=t,this.setDirty())}setDirty(){!this._dirty&&this._labelingContexts.length>0&&(this._dirty=!0,this.notifyChange("updating"))}get updating(){var e;return this._dirty||((e=this._textTextureAtlas)==null?void 0:e.updating)||this.deconflictor.updating||this._labelingContexts.some(t=>EM(t))}get updatingProgress(){if(!this.updating||!this._textTextureAtlas)return 1;const e=this._labelingContexts.length>0?this._labelingContexts.reduce((t,r)=>t+(EM(r)?0:1),0)/this._labelingContexts.length:1;return(this._dirty?0:.3)+(this._textTextureAtlas.updating?0:.1)+.1*e+.5*this.deconflictor.updatingProgress}get test(){return{textTextureAtlas:this._textTextureAtlas,resetAllLabels:()=>this._resetAllLabels()}}};function E2e(i){return i.active&&CI(i.layer)}function EM(i){return i.labelClassPromise&&!!i.labelClassAbortController}function iz(i){return i.labelClassContexts&&i.labelClassContexts.length}function P2e(i){return i.labelClassContexts===null}h([p({constructOnly:!0})],Uf.prototype,"view",void 0),h([p({constructOnly:!0})],Uf.prototype,"deconflictor",void 0),h([p()],Uf.prototype,"_textTextureAtlas",void 0),h([p({type:Boolean,readOnly:!0})],Uf.prototype,"updating",null),Uf=h([D("esri.views.3d.layers.graphics.Labeler")],Uf);const dp=new jxe(null,null,null);let pb=class Oy{constructor(e,t,r,n=null){this.lij=[0,0,0],this.extent=$t(),this.resolution=0,this.loadPriority=0,this.measures={visibility:ws.VISIBLE_ON_SURFACE,screenRect:$t(),distance:0,shouldSplit:!1},this.used=!1,n&&this.acquire(e,t,r,n)}acquire(e,t,r,n){this.tilingScheme=n,this.id=Oy.id(e,t,r),this.lij[0]=e,this.lij[1]=t,this.lij[2]=r,n.getExtent(e,t,r,this.extent),this.resolution=n.resolutionAtLevel(e)}release(){this.tilingScheme=null}getChildren(e){const t=this.lij[0]+1,r=2*this.lij[1],n=2*this.lij[2];return e?(e[0].acquire(t,r,n,this.tilingScheme),e[1].acquire(t,r+1,n,this.tilingScheme),e[2].acquire(t,r,n+1,this.tilingScheme),e[3].acquire(t,r+1,n+1,this.tilingScheme),e):[new Oy(t,r,n,this.tilingScheme),new Oy(t,r+1,n,this.tilingScheme),new Oy(t,r,n+1,this.tilingScheme),new Oy(t,r+1,n+1,this.tilingScheme)]}copyMeasurementsFrom(e){this.measures.visibility=e.measures.visibility,this.measures.shouldSplit=e.measures.shouldSplit,this.measures.distance=e.measures.distance,yw(e.measures.screenRect,this.measures.screenRect)}static id(e,t,r){return`${e}/${t}/${r}`}};var ws;(function(i){i[i.INVISIBLE=0]="INVISIBLE",i[i.VISIBLE_WHEN_EXTENDED=1]="VISIBLE_WHEN_EXTENDED",i[i.VISIBLE_ON_SURFACE=2]="VISIBLE_ON_SURFACE"})(ws||(ws={}));const RK=.5*Math.PI,R2e=RK/Math.PI*180;let A2e=class{constructor(e){this._renderCoordsHelper=e.renderCoordsHelper,this._extent=new Array(4),this._planes=new Array(6),this._maxSpan=0,this._center={origin:R(),direction:R()};for(let t=0;t<4;t++)this._extent[t]={origin:R(),direction:R(),cap:{next:null,direction:R()}},this._planes[t]=fr();this._planes[hr.NEAR]=fr(),this._planes[hr.FAR]=fr(),this._planesWithoutFar=this._planes.slice(0,5)}update(e,t,r,n=!0){const s=this._extent;this._toRenderBoundingExtent(e,t,r),oe(this._center.origin,s[0].origin,s[2].origin),Q(this._center.origin,this._center.origin,.5),this._renderCoordsHelper.worldUpAtPosition(this._center.origin,this._center.direction),n||Q(this._center.direction,this._center.direction,-1);for(let a=0;a<4;a++){const o=s[a];this._renderCoordsHelper.worldUpAtPosition(o.origin,o.direction);const l=s[a===3?0:a+1];o.cap.next=l.origin,Yg(o.cap.direction,o.origin,l.origin),ww(o.direction,o.cap.direction,o.origin,this._planes[a]),n||Q(o.direction,o.direction,-1)}ww(s[0].cap.direction,s[1].cap.direction,s[0].origin,this._planes[hr.NEAR]),n?TI(this._planes[hr.NEAR],this._planes[hr.FAR]):(dG(this._planes[hr.FAR],this._planes[hr.NEAR]),TI(this._planes[hr.NEAR],this._planes[hr.NEAR])),this._maxSpan=Math.max(Math.abs(e[0]-e[2]),Math.abs(e[1]-e[3])),this._maxSpanSpatialReference=t,this._minGlobalAltitude=.9*Yt(this._maxSpanSpatialReference).radius}isVisibleInFrustum(e,t,r=!1){if(e==null)return!1;if(this._renderCoordsHelper.viewingMode===Se.Global){const s=this._maxSpanSpatialReference.isGeographic?R2e:RK*t;if(this._maxSpan>s)return!0;if(e.altitude!=null&&e.altitude>=this._minGlobalAltitude)return this._isVisibleInFrustumGlobal(e)}if(this._maxSpan===0){const s=this._extent[0];return!(r||!e.intersectsRay(zc(s.origin,s.direction)))}for(let s=0;s<this._extent.length;s++){const a=this._extent[s];if(!r&&e.intersectsRay(zc(a.origin,a.direction))||e.intersectsLineSegment(fg(a.origin,a.cap.next,M2e),a.cap.direction))return!0}const n=r?this._planes:this._planesWithoutFar;for(let s=0;s<e.lines.length;s++){const a=e.lines[s];if(U0e(n,a.origin,a.endpoint,a.direction))return!0}return!1}_toRenderBoundingExtentGlobal(e,t,r){pD(e,ic),ic[2]=r,xd(t,ic,PM,this._renderCoordsHelper.spatialReference),kn(rz,PM),Mi(Ua);for(const{x0:s,x1:a,y0:o,y1:l}of O2e)for(let c=0;c<5;c++){const u=c/4;ic[0]=dt(e[s],e[a],u),ic[1]=dt(e[o],e[l],u),ic[2]=r,ss(ic,t,ic,this._renderCoordsHelper.spatialReference),Ce(ic,ic,rz),W0(Ua,ic)}Z(this._extent[0].origin,Ua[0],Ua[1],Ua[2]),Z(this._extent[1].origin,Ua[3],Ua[1],Ua[2]),Z(this._extent[2].origin,Ua[3],Ua[4],Ua[2]),Z(this._extent[3].origin,Ua[0],Ua[4],Ua[2]);for(let s=0;s<4;++s)Ce(this._extent[s].origin,this._extent[s].origin,PM)}_toRenderBoundingExtentLocal(e,t,r){bP(e,t,Su,this._renderCoordsHelper.spatialReference),Z(this._extent[0].origin,Su[0],Su[1],r),Z(this._extent[1].origin,Su[2],Su[1],r),Z(this._extent[2].origin,Su[2],Su[3],r),Z(this._extent[3].origin,Su[0],Su[3],r)}_toRenderBoundingExtent(e,t,r){switch(this._renderCoordsHelper.viewingMode){case Se.Global:this._toRenderBoundingExtentGlobal(e,t,r);break;case Se.Local:this._toRenderBoundingExtentLocal(e,t,r);break;default:Pa(this._renderCoordsHelper.viewingMode)}}_isVisibleInFrustumGlobal(e){if(tr(e.planes[hr.NEAR],this._center.origin)<0&&me(this._center.direction,e.direction)<0)return!0;for(let t=0;t<4;t++){const r=this._extent[t];if(tr(e.planes[hr.NEAR],r.origin)<0&&me(r.direction,e.direction)<0)return!0}return!1}};const O2e=[{x0:0,y0:1,x1:2,y1:1},{x0:0,y0:3,x1:2,y1:3},{x0:0,y0:1,x1:0,y1:3},{x0:2,y0:1,x1:2,y1:3}],ic=R(),PM=ve(),rz=ve(),Ua=Ms(),Su=$t(),M2e=fv();let I2e=class{constructor(e){this._renderCoordsHelper=e,this._surfaceElevation=0,this._cache=new Map,this._frustum=new Yp(e),this._extendedFrustum=new Yp(e),this._intersector=new A2e({renderCoordsHelper:e}),this._renderCoordsHelper=e}begin(e,t){this._surfaceElevation=t,this._aboveGround=this._renderCoordsHelper.getAltitude(e.eye)>t,this._frustum.update(e),this._shortenFrustumFarPlane(this._frustum),this._updateExtendedFrustum(e)}end(){this._cache.clear()}calculate(e){if(this._allTilesInvisible)return ws.INVISIBLE;const t=this._renderCoordsHelper.viewingMode===Se.Global&&e.lij[0]>=L2e&&e.lij[0]<$2e,r=this._getOrCalculateSingleTileVisibility(e,!t);return r!==ws.INVISIBLE&&t?this._calculateAggregatedChildrenVisibility(e):r}_shortenFrustumFarPlane(e){const t=Yp.nearFarLineIndices,r=e.mutablePoints;for(const n of t){const[s,a]=n,o=r[s],l=r[a];ne(Ao,l,o),Q(Ao,Ao,F2e),oe(r[a],o,Ao)}e.updatePoints(r)}_calculateAggregatedChildrenVisibility(e){let t=ws.INVISIBLE;const r=this._cache.get(e.id);if(r!=null)return r;const n=oz.acquire();e.getChildren(n);for(const s of n){const a=this.calculate(s);if(a!==ws.INVISIBLE&&(t=a,a===ws.VISIBLE_ON_SURFACE))break}return oz.release(n),this._cache.set(e.id,t),t}_getOrCalculateSingleTileVisibility(e,t){const r=this._cache.get(e.id);if(r!=null)return r;const n=this._calculateSingleTileVisibility(e);return t&&this._cache.set(e.id,n),n}_calculateSingleTileVisibility(e){return!this._aboveGround&&this._renderCoordsHelper.viewingMode===Se.Global&&e.lij[0]<D2e?this._calculateSingleTileVisibilitySided(e,!1)===ws.INVISIBLE?this._calculateSingleTileVisibilitySided(e,!0):void 0:this._calculateSingleTileVisibilitySided(e,this._aboveGround)}_calculateSingleTileVisibilitySided(e,t){this._intersector.update(e.extent,e.tilingScheme.spatialReference,this._surfaceElevation,t);const r=Yt(e.tilingScheme.spatialReference).radius;return this._intersector.isVisibleInFrustum(this._extendedFrustum,r)?this._intersector.isVisibleInFrustum(this._frustum,r,!0)?ws.VISIBLE_ON_SURFACE:ws.VISIBLE_WHEN_EXTENDED:ws.INVISIBLE}_updateExtendedFrustum(e){this._extendedFrustum.update(e),this._shortenFrustumFarPlane(this._extendedFrustum);const t=this._renderCoordsHelper.worldUpAtPosition(e.eye,Ao);this._aboveGround||Aa(t,t);const r=ls(-me(t,e.viewForward));if(this._allTilesInvisible=r>(Math.PI+e.fovY)/2,this._allTilesInvisible||(this._hasExtendedFrustum=r>e.fovY/2,!this._hasExtendedFrustum))return;const n=this._extendedFrustumParameters(),s=this._extendedFrustum.mutablePoints;for(let a=0;a<4;a++){const o=n.pointIndices[a],l=s[o],c=this._renderCoordsHelper.getAltitude(l);if(n.needsAltitudeAdjustment(c)){switch(this._renderCoordsHelper.worldUpAtPosition(l,Ao),o){case Ti.FAR_BOTTOM_LEFT:case Ti.FAR_TOP_LEFT:case Ti.NEAR_BOTTOM_LEFT:case Ti.NEAR_TOP_LEFT:C5(this._extendedFrustum.planes[hr.LEFT],Ao,Ao);break;case Ti.FAR_BOTTOM_RIGHT:case Ti.FAR_TOP_RIGHT:case Ti.NEAR_BOTTOM_RIGHT:case Ti.NEAR_TOP_RIGHT:C5(this._extendedFrustum.planes[hr.RIGHT],Ao,Ao)}Q(Ao,Ao,n.direction),this._renderCoordsHelper.intersectInfiniteManifold(zc(l,Ao),n.zWithMargin,l)}}if(this._extendedFrustum.updatePoints(s),Bh(s[Ti.NEAR_BOTTOM_LEFT],s[Ti.NEAR_BOTTOM_RIGHT],s[Ti.NEAR_TOP_RIGHT],sz),Bh(s[Ti.NEAR_BOTTOM_RIGHT],s[Ti.NEAR_TOP_RIGHT],s[Ti.NEAR_TOP_LEFT],az),me(Ia(sz),Ia(az))<0){const a=this._extendedFrustum.mutablePoints;this._aboveGround?[a[Ti.NEAR_BOTTOM_LEFT],a[Ti.NEAR_BOTTOM_RIGHT]]=[a[Ti.NEAR_BOTTOM_RIGHT],a[Ti.NEAR_BOTTOM_LEFT]]:[a[Ti.NEAR_TOP_LEFT],a[Ti.NEAR_TOP_RIGHT]]=[a[Ti.NEAR_TOP_RIGHT],a[Ti.NEAR_TOP_LEFT]],this._extendedFrustum.updatePoints(a)}}_extendedFrustumParameters(){return this._aboveGround?this._extendedFrustumParametersAboveSurface():this._extendedFrustumParametersBelowSurface()}_extendedFrustumParametersAboveSurface(){const e=this._surfaceElevation-nz;return{zWithMargin:e,pointIndices:Yp.planePointIndices.bottom,direction:-1,needsAltitudeAdjustment:t=>t>e}}_extendedFrustumParametersBelowSurface(){const e=this._surfaceElevation+nz;return{zWithMargin:e,pointIndices:Yp.planePointIndices.top,direction:1,needsAltitudeAdjustment:t=>t<e}}};const L2e=2,$2e=6,D2e=12,F2e=.95,nz=1,Ao=R(),sz=fr(),az=fr(),oz=new Fl(Array,i=>{i.length!==4&&(i[0]=new pb,i[1]=new pb,i[2]=new pb,i[3]=new pb)},i=>{i[0].release(),i[1].release(),i[2].release(),i[3].release()});let N2e=class{constructor(e){this._camera=new yi,this._focusOnMap=[0,0],this._screenRect=$t(),this._tileSize=e.tileSize,this._renderCoordsHelper=e.renderCoordsHelper,this._tilingScheme=e.tilingScheme,this._visibility=new I2e(e.renderCoordsHelper)}begin(e,t,r){this._camera.copyFrom(e),this._surfaceElevation=r,this._focusOnMap[0]=t.x,this._focusOnMap[1]=t.y,tG(0,0,e.fullWidth,e.fullHeight,this._screenRect),this._visibility.begin(this._camera,r)}end(){this._visibility.end()}updateTile(e){e.measures.visibility=this._visibility.calculate(e),e.measures.distance=Qie(e.extent,this._focusOnMap),e.measures.visibility!==ws.INVISIBLE&&this._updateScreenMeasure(e)}_updateScreenMeasure(e){const t=k2e,r=1<<t,n=e.measures.screenRect;Uc(n);let s=0;const a=e.lij[0]+t,o=e.lij[1]<<t,l=e.lij[2]<<t,c=this._tileSizeWithBias(e),u=c*c;for(let d=0;d<r;d++)for(let m=0;m<r;m++)if(s+=this._computeScreenArea(e,a,o+d,l+m,n),s>u)return void(e.measures.shouldSplit=!0);e.measures.shouldSplit=!1}_tileSizeWithBias(e){return e.measures.visibility===ws.VISIBLE_WHEN_EXTENDED?this._tileSize*V2e:this._tileSize}_computeScreenArea(e,t,r,n,s){const a=e.measures.visibility===ws.VISIBLE_WHEN_EXTENDED;this._projectToScreen(t,r,n,a,pp),Uc(RM);for(let o=0;o<4;o++)dD(RM,pp[o]);return hm(s,RM,s),U5(pp[0],pp[1],pp[2])+U5(pp[0],pp[2],pp[3])}_projectToScreen(e,t,r,n,s){this._tilingScheme.ensureMaxLod(e),this._tilingScheme.getExtent(e,t,r,w1),this._toRenderCoords(w1,0,3,mp[0]),this._toRenderCoords(w1,2,3,mp[1]),this._toRenderCoords(w1,2,1,mp[2]),this._toRenderCoords(w1,0,1,mp[3]),n&&(this._projectToPlane(mp,this._camera.frustum[hr.NEAR]),this._projectToPlane(mp,this._camera.frustum[hr.TOP]),this._projectToPlane(mp,this._camera.frustum[hr.BOTTOM]));for(let a=0;a<4;a++)this._camera.projectToRenderScreen(mp[a],lz),this._camera.renderToScreen(lz,s[a])}_projectToPlane(e,t){for(let n=0;n<4;n++)T1[n]=tr(t,e[n]);const r=Math.max(T1[0],T1[1],T1[2],T1[3]);if(r>0){const n=Q(x1,Ia(t),-r);for(let s=0;s<4;s++)oe(e[s],e[s],n)}}_toRenderCoords(e,t,r,n){return x1[0]=e[t],x1[1]=e[r],x1[2]=this._surfaceElevation,this._renderCoordsHelper.toRenderCoords(x1,this._tilingScheme.spatialReference,n),n}};const RM=$t(),k2e=2,V2e=5,pp=[zi(),zi(),zi(),zi()],w1=$t(),x1=R(),mp=[R(),R(),R(),R()],T1=[0,0,0,0],lz=is();function cze(i,e,t){if(S(i)||S(t))return!1;let r=!0;return Nr[0]=i.xmin!=null?i.xmin:0,Nr[1]=i.ymin!=null?i.ymin:0,Nr[2]=i.zmin!=null?i.zmin:0,r=r&&Ma(Nr,i.spatialReference,0,e,t,0,1),Nr[0]=i.xmax!=null?i.xmax:0,Nr[1]=i.ymax!=null?i.ymax:0,Nr[2]=i.zmax!=null?i.zmax:0,r=r&&Ma(Nr,i.spatialReference,0,e,t,3,1),i.xmin==null&&(e[0]=-1/0),i.ymin==null&&(e[1]=-1/0),i.zmin==null&&(e[2]=-1/0),i.xmax==null&&(e[3]=1/0),i.ymax==null&&(e[4]=1/0),i.zmax==null&&(e[5]=1/0),r}function AK(i,e,t){if(S(i)||S(t))return!1;let r=!0;return Nr[0]=i.xmin!=null?i.xmin:0,Nr[1]=i.ymin!=null?i.ymin:0,Nr[2]=i.zmin!=null?i.zmin:0,r=r&&Ma(Nr,i.spatialReference,0,Nr,t,0,1),e[0]=Nr[0],e[1]=Nr[1],Nr[0]=i.xmax!=null?i.xmax:0,Nr[1]=i.ymax!=null?i.ymax:0,Nr[2]=i.zmax!=null?i.zmax:0,r=r&&Ma(Nr,i.spatialReference,0,Nr,t,0,1),e[2]=Nr[0],e[3]=Nr[1],i.xmin==null&&(e[0]=-1/0),i.ymin==null&&(e[1]=-1/0),i.xmax==null&&(e[2]=1/0),i.ymax==null&&(e[3]=1/0),r}const Nr=R();let Mn=class extends ue{constructor(e){super(e),this.tiles=new pt,this.tileSize=512,this._idToTile=new Map,this._handles=new Ft,this._clients=new Set,this._dirty=!1,this._newTiles=new Zt}get tilingScheme(){const e=this.tilingSchemeOwner.tilingScheme;return e?e.clone():null}set filterExtent(e){if(y(e)&&!e.spatialReference.equals(this.viewState.spatialReference))return void J.getLogger(this.declaredClass).error("#extent","extent spatial reference needs to be in the same spatial reference as the view");const t=this._get("filterExtent");if(t===e||y(t)&&e&&t.equals(e))return;const r=y(e)?e.clone():null;this._set("filterExtent",r),this._setDirty()}get _filterExtentRect(){if(S(this.filterExtent)||!this.tilingScheme)return null;const e=$t();return AK(this.filterExtent,e,this.tilingScheme.spatialReference),e}get _rootTileIds(){return this._filterExtentRect?this.tilingScheme.rootTilesInExtent(this._filterExtentRect):[[0,0,0]]}set suspended(e){e!==this._get("suspended")&&(this._set("suspended",e),this._setDirty())}get updating(){return this._dirty||!!this._pendingTiles}initialize(){this._handles.add([z(()=>[this.tilingScheme,this.tileSize],()=>this._reset(),ri),z(()=>{var e,t,r;return[this.tileSize,(e=this.cameraOnSurface)==null?void 0:e.location,this.tilingScheme,(t=this.viewState)==null?void 0:t.contentCamera,(r=this.focus)==null?void 0:r.location]},()=>this._setDirty(),Oi)]),this.scheduler&&(this._frameWorker=this.scheduler.registerTask(dr.FEATURE_TILE_TREE,this))}destroy(){this._frameWorker=Os(this._frameWorker),this._handles=Te(this._handles)}addClient(){const e=z2e();return this._clients.add(e),this._clients.size===1&&this._setDirty(),{remove:()=>this._removeClient(e)}}_removeClient(e){this._clients.delete(e),this._hasClients||this._clear()}get _hasClients(){return this._clients.size>0}_setDirty(){!this._hasClients||this.suspended||this._dirty||(this._frameWorker?(this._dirty=!0,this.notifyChange("updating")):this.runTask(CP))}_clear(){this.tiles.removeAll(),this._idToTile.clear(),this._reset(),this._dirty=!1,this.notifyChange("updating")}get running(){return this.updating}runTask(e){this._dirty=!1,this._pendingTiles||(this._startUpdate(),y(this._frameWorker)&&(this._frameWorker.priority=dr.FEATURE_TILE_TREE_ACTIVE)),this._subdivideTilesForView(e),!this._pendingTiles&&y(this._frameWorker)&&(this._frameWorker.priority=dr.FEATURE_TILE_TREE),this.notifyChange("updating")}_startUpdate(){if(this.suspended)return;if(!this.tilingScheme)return void this._clear();this._tileMeasurements||(this._tileMeasurements=new N2e({renderCoordsHelper:this.renderCoordsHelper,tilingScheme:this.tilingScheme,tileSize:this.tileSize}));const e=this.viewState.contentCamera;this._tileMeasurements.begin(e,this.focus.location,this.cameraOnSurface.location.z),this._pendingTiles=this._getRootTiles()}_reset(){this._newTiles.clear(),this._tileMeasurements=null,this._pendingTiles=null,this._setDirty()}_getRootTiles(){return this._rootTileIds.map(e=>new pb(e[0],e[1],e[2],this.tilingScheme))}_purgeHorizonTiles(e){e.sort((t,r)=>{const n=t.measures.screenRect,s=r.measures.screenRect;return n[1]+n[3]-(s[1]+s[3])}),Uc(UC);for(let t=0;t<e.length;t++)if(hm(UC,e.data[t].measures.screenRect,UC),Om(UC)>B2e)return e.data.slice(t,e.length);return[]}_subdivideTilesForView(e){if(this._pendingTiles){for(;this._pendingTiles.length>0&&!e.done;){const t=this._pendingTiles.pop();e.madeProgress(),this._filterExtentRect&&!EP(this._filterExtentRect,t.extent)||(this._tileMeasurements.updateTile(t),t.measures.visibility!==ws.INVISIBLE&&(t.measures.shouldSplit?(this.tilingScheme.ensureMaxLod(t.lij[0]+1),this._pendingTiles.push(...t.getChildren())):this._newTiles.push(t)))}this._pendingTiles.length===0&&(this._updateTiles(this._purgeHorizonTiles(this._newTiles)),this._newTiles.clear(),this._tileMeasurements.end(),this._pendingTiles=null)}}_updateTiles(e){for(const n of this.tiles.items)n.used=!1;const t=e.filter(n=>{const s=this._idToTile.get(n.id);return s?(s.copyMeasurementsFrom(n),s.used=!0):this._idToTile.set(n.id,n),!s}),r=this.tiles.items.filter(n=>!n.used&&(this._idToTile.delete(n.id),!0));this.tiles.removeMany(r),this.tiles.addMany(t),this._sortTiles()}_sortTiles(){this.viewState.fixedContentCamera||this.tiles.sort((e,t)=>e.measures.visibility!==t.measures.visibility?e.measures.visibility===ws.VISIBLE_ON_SURFACE?-1:1:e.measures.distance-t.measures.distance),this.tiles.forEach((e,t)=>e.loadPriority=t)}};h([p({constructOnly:!0})],Mn.prototype,"scheduler",void 0),h([p({constructOnly:!0})],Mn.prototype,"renderCoordsHelper",void 0),h([p({constructOnly:!0})],Mn.prototype,"tilingSchemeOwner",void 0),h([p({constructOnly:!0})],Mn.prototype,"cameraOnSurface",void 0),h([p({constructOnly:!0})],Mn.prototype,"focus",void 0),h([p({constructOnly:!0})],Mn.prototype,"viewState",void 0),h([p({constructOnly:!0})],Mn.prototype,"terrain",void 0),h([p()],Mn.prototype,"tiles",void 0),h([p()],Mn.prototype,"tileSize",void 0),h([p({readOnly:!0})],Mn.prototype,"tilingScheme",null),h([p()],Mn.prototype,"filterExtent",null),h([p({readOnly:!0})],Mn.prototype,"_filterExtentRect",null),h([p({readOnly:!0})],Mn.prototype,"_rootTileIds",null),h([p({value:!1})],Mn.prototype,"suspended",null),h([p({readOnly:!0})],Mn.prototype,"updating",null),Mn=h([D("esri.views.3d.layers.support.FeatureTileTree3D")],Mn);let U2e=0;function z2e(){return U2e++}const UC=$t(),B2e=10;let hn=class extends ue{constructor(){super(...arguments),this._propertiesPool=new Od({camera:yi},this),this._lastSeenCameraProjectionValues=new yi,this.events=new nn,this.viewingMode=Se.Global,this._cameraChanged=!1,this._updateQueue=new Array,this._processingUpdates=!1}init(e,t){this._set("viewingMode",e),this._set("spatialReference",t),this._set("constraints",new Vu({mode:this.viewingMode}))}exit(){this.cameraController=null,this._propertiesPool.destroy(),this._propertiesPool=new Od({camera:yi},this)}createInitialCamera(){if(this.viewingMode===Se.Global){const e=Yt(this.spatialReference).radius;this.camera=new yi(Ge(4*e,0,0),Ge(e,0,0),Ge(0,0,1))}else this.camera=new yi(Ge(0,0,100),Ge(0,0,0),Ge(0,1,0))}get animation(){return this.cameraController instanceof ax&&y(this.cameraController.viewAnimation)?this.cameraController.viewAnimation:null}get camera(){return this._get("camera")}set camera(e){e!==pl&&pl.copyFrom(e),pl.computeUp(this.viewingMode),cz.camera=pl,this.events.emit("before-camera-change",cz);const t=this._get("camera");if(this._cameraProjectionChanged(this._lastSeenCameraProjectionValues,pl)&&(this._lastSeenCameraProjectionValues.copyFrom(pl),hz.camera=this._lastSeenCameraProjectionValues,this.events.emit("camera-projection-changed",hz)),(!t||!t.equals(pl))&&(this._set("camera",this._propertiesPool.get("camera").copyFrom(pl)),this._cameraChanged=!t||!t.almostEquals(pl),this._cameraChanged)){const r=o7(()=>{this._cameraChanged=!1,r.remove()})}}get pixelRatio(){return this.camera.pixelRatio}get contentCamera(){return y(this._contentCamera)?this._contentCamera:this.camera}set contentCamera(e){this._contentCamera=y(e)?e.clone():null}get fixedContentCamera(){return y(this._contentCamera)}get isGlobal(){return this.viewingMode===Se.Global}get isLocal(){return this.viewingMode===Se.Local}get navigating(){return!(!this.cameraController||!this.cameraController.isInteractive)}get stationary(){return!this._cameraChanged&&!this.navigating}get cameraController(){return this._get("cameraController")}set cameraController(e){this.stopActiveCameraController()?(e&&(this.addHandles(cs(()=>e.state===Vi.Finished||e.state===Vi.Stopped,()=>{this._set("cameraController",null),this.updateCamera(t=>e.onControllerEnd(t))},{sync:!0,once:!0})),e.onControllerStart(this.camera)),this._set("cameraController",e)):e&&(e.state=Vi.Rejected)}switchCameraController(e){return this.cameraController=e,e.state!==Vi.Rejected}stopActiveCameraController(){return!(this.cameraController&&!this.cameraController.stopController())}updateCamera(e){this._updateQueue.push(e),this._processUpdateQueue()}_processUpdateQueue(){if(this._updateQueue.length===0||this._processingUpdates)return;this._processingUpdates=!0;const e=this._updateQueue.shift();pl.copyFrom(this._get("camera")),e(pl),this.camera=pl,this._processingUpdates=!1,this._processUpdateQueue()}_cameraProjectionChanged(e,t){return e.fov!==t.fov||e.fullViewport[0]!==t.fullViewport[0]||e.fullViewport[1]!==t.fullViewport[1]||e.fullViewport[2]!==t.fullViewport[2]||e.fullViewport[3]!==t.fullViewport[3]||e.padding[Xe.TOP]!==t.padding[Xe.TOP]||e.padding[Xe.RIGHT]!==t.padding[Xe.RIGHT]||e.padding[Xe.BOTTOM]!==t.padding[Xe.BOTTOM]||e.padding[Xe.LEFT]!==t.padding[Xe.LEFT]}};h([p()],hn.prototype,"mode",void 0),h([p({readOnly:!0,type:Md})],hn.prototype,"animation",null),h([p({type:yi})],hn.prototype,"camera",null),h([p()],hn.prototype,"pixelRatio",null),h([p({})],hn.prototype,"_contentCamera",void 0),h([p({type:yi})],hn.prototype,"contentCamera",null),h([p({readOnly:!0})],hn.prototype,"fixedContentCamera",null),h([p({readOnly:!0})],hn.prototype,"constraints",void 0),h([p({readOnly:!0})],hn.prototype,"events",void 0),h([p({readOnly:!0})],hn.prototype,"isGlobal",null),h([p({readOnly:!0})],hn.prototype,"isLocal",null),h([p({readOnly:!0})],hn.prototype,"viewingMode",void 0),h([p({readOnly:!0})],hn.prototype,"spatialReference",void 0),h([p()],hn.prototype,"navigating",null),h([p()],hn.prototype,"stationary",null),h([p()],hn.prototype,"_cameraChanged",void 0),h([p()],hn.prototype,"cameraController",null),hn=h([D("esri.views.3d.state.ViewState")],hn);const G2e=hn,pl=new yi,cz={camera:null},hz={camera:null};let H2e=class{constructor(e,t,r){this.viewingMode=e,this._forEachLayer=t,this._view=r,this._externalIntersectionHandlers=new Zt,this._tolerance=sv,this._tmpRay=oo(),this._tmpRegion=$t(),this._validateHUDIntersector=Xl(this.viewingMode),this._validateHUDIntersector.options.hud=!1}intersectScreen(e,t,r){return this.intersectRay(this._getPickRay(e,this._tmpRay),uz(this.viewingMode),t,r)}intersectScreenFreePointFallback(e,t,r){return this.intersectRayFreePointFallback(this._getPickRay(e,this._tmpRay),t,r)}intersectRayFreePointFallback(e,t,r){return this.intersectRay(e,uz(this.viewingMode),t,r)||this._intersectRayFreePointLocal(e,t)}intersectRay(e,t,r,n){return t.options.selectionMode=!1,t.options.store=zn.MIN,this.computeIntersection(e,t,n),!!t.results.min&&t.results.min.getIntersectionPoint(r)}getCenterRayWithSubpixelOffset(e,t,r=.5,n=.5){return e.getRenderCenter(GC,r,n),GC[0]+=.0466,GC[1]-=.0123,WN(e,GC,t)}intersectIntersectorScreen(e,t,r){this.computeIntersection(this._getPickRay(e,this._tmpRay),t,r)}intersectToolIntersectorScreen(e,t,r){const n=this._getPickRay(e,this._tmpRay);this.intersectToolIntersectorRay(n,t,r)}intersectToolIntersectorRay(e,t,r){t.options.selectionMode=!0,this.computeIntersection(e,t,r);const n=t.results.min;this._view.basemapTerrain&&this._view.basemapTerrain.opaque||hu(n)&&n.intersector!==Ui.TERRAIN||(t.options.selectionMode=!1,this.computeIntersection(e,t,r))}setTolerance(e=sv){this._tolerance=e}addIntersectionHandler(e){this._externalIntersectionHandlers.push(e),this._externalIntersectionHandlers.sort((t,r)=>t.type===Ui.TERRAIN?1:r.type===Ui.TERRAIN?-1:0)}removeIntersectionHandler(e){this._externalIntersectionHandlers.removeUnordered(e)!=null&&this._externalIntersectionHandlers.sort((t,r)=>t.type===Ui.TERRAIN?1:r.type===Ui.TERRAIN?-1:0)}_getPickRay(e,t){const r=this._view.state.camera;return rZ(r,e,t)}_intersectRayFreePointLocal(e,t){if(this.viewingMode!==Se.Local||S(e))return!1;const r=this._view.renderDataExtent;if(S(r))return oe(t,e.origin,he(ze.get(),e.direction)),!0;const n={x:r.xmax-r.xmin,y:r.ymax-r.ymin,z:8*Math.max(r.xmax-r.xmin,r.ymax-r.ymin)},s=Math.max(n.x,n.y,n.z);if(s===0)return oe(t,e.origin,he(ze.get(),e.direction)),!0;const a=this._view.state.camera,o=Math.max(0,r.xmin-a.eye[0],a.eye[0]-r.xmax),l=Math.max(0,r.ymin-a.eye[1],a.eye[1]-r.ymax),c=Math.sqrt(o*o+l*l),u=Math.abs(a.relativeElevation)+Number.MIN_VALUE,d=Math.max(0,Math.log(s/u))**2;let m=s/Math.max(1,d);m=Math.max(m,Math.min(c,s));const f=_e(e.direction),_=Q(ze.get(),e.direction,f===0?m:m/f);return oe(t,e.origin,_),!0}intersectElevationFromScreen(e,t,r=0,n=null){return this._intersectElevation(this._getPickRay(e,this._tmpRay),t,r,n)}_intersectElevation(e,t,r=0,n=null){if(S(e))return null;const s=y(t)?t.mode:"absolute-height",a=y(t)?je(t.offset,0):0,o=s!=="on-the-ground"?a+r:0,l=o/this._view.renderCoordsHelper.unitInMeters;if(s==="absolute-height"){if(this._view.renderCoordsHelper.intersectInfiniteManifold(e,o,BC)){const v=this._view.computeMapPointFromVec3d(BC);return v.z-=a,v}return null}const c=this._view.state.camera,u=G0(ze.get());c.projectToRenderScreen(e.origin,u);const d=new dz(null,this._forEachLayer),m=this._view.slicePlane,f=y(m)?B6(m):null,_=Xl(this.viewingMode);_.options.store=zn.MIN,_.options.verticalOffset=l;const g=e.origin,x=oe(ze.get(),g,e.direction);_.reset(g,x,c),_.point=u;const b=y(n)?"type"in n&&n.type==="graphics"?v=>v.metadata.layerUid!==n.uid:v=>v.metadata.graphicUid!==n.uid:null;switch(s){case"relative-to-scene":{const v=w=>(S(b)||b(w))&&w.metadata&&w.metadata.isElevationSource;_.intersect(d.layers,u,this._tolerance,null,v),this._externalIntersectionHandlers.forAll(w=>{if(w.type===Ui.I3S||w.type===Ui.TERRAIN){const T=w.slicePlaneEnabled?f:null;w.intersect(_,T,_.rayBegin,_.rayEnd,u)}})}break;case"on-the-ground":case"relative-to-ground":this._externalIntersectionHandlers.forAll(v=>{if(v.isGround){const w=v.slicePlaneEnabled?f:null;v.intersect(_,w,_.rayBegin,_.rayEnd,u)}})}if(_.results.min.getIntersectionPoint(BC)){const v=this._view.computeMapPointFromVec3d(BC);return v.z=r,v}return null}computeIntersection(e,t,r){if(S(e))return;const n=this._view.state.camera,s=G0(ze.get());n.projectToRenderScreen(e.origin,s);const a=new dz(r,this._forEachLayer);t.options.selectOpaqueTerrainOnly=!r||!("include"in r||"exclude"in r);const o=e.origin,l=oe(ze.get(),e.origin,e.direction);t.reset(o,l,n),t.intersect(a.layers,s,this._tolerance);const c=this._view.slicePlane,u=y(c)?B6(c):null;t.intersect(a.sliceableLayers,s,this._tolerance,u);const d=r&&(r.requiresGroundFeedback||r.enableDraped);this._externalIntersectionHandlers.forAll(_=>{if(t.options.isFiltered=!a.filterLayerUid(_.layerUid),_.isGround&&d||!t.options.isFiltered){const g=_.slicePlaneEnabled?u:null;_.intersect(t,g,o,l,s)}});const m=ze.get(),f=this._view.basemapTerrain;if(r&&r.enableDraped&&y(f.spatialReference)&&t.results.ground.getIntersectionPoint(m)){const _=f.overlayManager.renderer,g=this._view.renderCoordsHelper.spatialReference,x=ze.get();this._view.renderCoordsHelper.fromRenderCoords(m,x,f.spatialReference),x[2]=je(this._view.elevationProvider.getElevation(m[0],m[1],m[2],g,"ground"),0),_.intersect(t,x,t.results.ground,b=>a.filterRenderGeometry(b))}t.sortResults(),this._processHUDResults(t)}_processHUDResults(e){const t=e.results.hud;yw(this._tmpRegion,Zie);const r=this._view.state.camera,n=[],s=this._tmpRegion,a=b=>{const v=new q2e(b);r.projectToRenderScreen(b.target.center,v.screenPoint),v.screenPoint[0]=Math.floor(v.screenPoint[0]),v.screenPoint[1]=Math.floor(v.screenPoint[1]),n.push(v),dD(s,v.screenPoint)};e.sortResults(t.all),y(t.min.dist)&&a(t.min);for(const b of t.all)t.min.target.object!==b.target.object&&t.max.target.object!==b.target.object&&a(b);if(y(t.max.dist)&&t.max.target.object!==t.min.target.object&&a(t.max),!n.length)return;s[0]===s[2]&&(s[2]+=1),s[1]===s[3]&&(s[3]+=1);const o=r.fullWidth,l=r.fullHeight,c=Math.max(0,s[0]-mb),u=Math.max(0,s[1]-mb),d=Math.min(Nh(s)+2*mb,o-c),m=Math.min(Om(s)+2*mb,l-u),f=new Uint8Array(d*m*4);this._view._stage.renderView.readHUDVisibility(c,u,d,m,f);let _=!0;const g=S(e.results.max.dist);let x=0;for(const b of n)for(const v of j2e)if(f[4*(Math.min(b.screenPoint[0]+v[0],o)-s[0]+(Math.min(b.screenPoint[1]+v[1],l)-s[1])*d)]){_&&(e.results.min.copy(b.result),_=!1),g&&e.results.max.copy(b.result),e.options.store===zn.ALL&&e.results.all.splice(x++,0,b.result);break}}};const mb=1,j2e=(()=>{const i=[],e=mb;for(let t=-e;t<=e;t++)for(let r=-e;r<=e;r++)i.push([r+e,t+e]);return i})();let q2e=class{constructor(e){this.result=e,this.screenPoint=is()}},zC;function uz(i){return zC&&zC.viewingMode===i||(zC=Xl(i)),zC}let dz=class{constructor(e,t){this.layers=new Array,this.sliceableLayers=new Array,this.include=e==null?void 0:e.include,this.exclude=e==null?void 0:e.exclude,t(r=>{r.isPickable&&this.filterLayerUid(r.apiLayerUid)&&(r.isSliceable?this.sliceableLayers:this.layers).push(r)})}filterLayerUid(e){const{include:t,exclude:r}=this;return S(e)?t==null&&r==null:(t==null||t.has(e))&&(r==null||!r.has(e))}filterRenderGeometry(e){return this.filterLayerUid(e.layerUid)}};function pz(i){return typeof i=="object"&&"intersect"in i}const BC=R(),GC=is();let fze=class{constructor(e,t){this.spatialReference=e,this._view=t}getElevation(e,t,r){return this._view.elevationProvider.getElevation(e,t,0,this.spatialReference,r)}async queryElevation(e,t,r,n,s){return this._view.elevationProvider.queryElevation(e,t,0,this.spatialReference,s,r,n)}},W2e=class{constructor(e,t,r,n){this.spatialReference=t,this._getElevationQueryProvider=r,this._queries=new Array,this._queryOptions={...n,ignoreInvisibleLayers:!0},this._frameTask=e.registerTask(dr.ELEVATION_QUERY,this)}destroy(){this._frameTask.remove()}queryElevation(e,t,r,n=0){return new Promise((s,a)=>{const o={x:e,y:t,minDemResolution:n,result:{resolve:s,reject:a},signal:r};this._queries.push(o),Em(r,()=>{Bee(this._queries,o),a(ts())})})}get running(){return this._queries.length>0}runTask(){const e=this._queries;this._queries=[];const t=this._getElevationQueryProvider();if(!t)return void e.forEach(c=>c.result.reject());const r=e.map(c=>[c.x,c.y]),n=e.reduce((c,u)=>Math.min(c,u.minDemResolution),1/0),s=new cie({points:r,spatialReference:this.spatialReference}),a=e.length>1&&e.some(c=>!!c.signal)?new AbortController:null,o=y(a)?a.signal:e[0].signal;if(y(a)){let c=0;e.forEach(u=>Em(u.signal,()=>{c++,u.result.reject(ts()),c===e.length&&a.abort()}))}const l={...this._queryOptions,minDemResolution:n,signal:o};t.queryElevation(s,l).then(c=>{e.forEach((u,d)=>{y(u.signal)&&u.signal.aborted?u.result.reject(ts()):u.result.resolve(c.geometry.points[d][2])})}).catch(c=>{e.forEach(u=>u.result.reject(c))})}get test(){const e=this;return{update:()=>e._queries.length>0&&e.runTask()}}},fb=class extends nn.EventedMixin(ue){constructor(e){super(e),this._im=new Array,this._ground=new Array,this._scene=new Array,this._handles=new Map,this.lastElevationQuery=null,this.elevationCacheEnabled=!1}get spatialReference(){var e,t;return(t=(e=this.view)==null?void 0:e.basemapTerrain)==null?void 0:t.spatialReference}destroy(){this._elevationQueryCached=Te(this._elevationQueryCached)}get _elevationQuery(){return S(this._elevationQueryCached)&&(this._elevationQueryCached=new W2e(this.view.resourceController.scheduler,this.view.spatialReference,()=>this.view.map&&this.view.map.ground,{maximumAutoTileRequests:4})),this._elevationQueryCached}enableElevationCache(e){e||(this.lastElevationQuery=null),this.elevationCacheEnabled=e}getElevation(e,t,r,n,s){if(this.elevationCacheEnabled&&this.lastElevationQuery!=null){const o=this.lastElevationQuery;if(e===o.x&&t===o.y&&r===o.z&&Bm(n,o.spatialReference)&&s===o.queryContext)return o.result}let a=null;return a=HC(a,this._im,e,t,r,n,s),S(a)&&(a=HC(a,this._ground,e,t,r,n,s)),s==="scene"&&(a=HC(a,this._scene,e,t,r,n,s)),this.elevationCacheEnabled&&(this.lastElevationQuery={x:e,y:t,z:r,spatialReference:n,queryContext:s,result:a}),a}queryElevation(e,t,r,n,s,a=null,o=0){const l=Ix();return this._elevationQuery.queryElevation(e,t,a,o).then(c=>{s==="scene"&&(c=HC(c,this._scene,e,t,r,n,s)),l.resolve(c)}).catch(c=>{yo(c)?l.reject(c):l.resolve(this.getElevation(e,t,r,n,s))}),l.promise}register(e,t){this._handles.set(t,t.on("elevation-change",r=>this.emit("elevation-change",r))),this._providersFromContext(e).push(t)}unregister(e){this._handles.has(e)&&(this._handles.get(e).remove(),this._handles.delete(e));for(const t of[this._im,this._ground,this._scene]){const r=t.indexOf(e);r>-1&&t.splice(r,1)}}_providersFromContext(e){switch(e){case"ground":return this._ground;case"im":return this._im;case"scene":return this._scene}}};function HC(i,e,t,r,n,s,a){for(const o of e){const l=o.getElevation(t,r,n,s,a);y(l)&&(i=y(i)?Math.max(l,i):l)}return i}h([p({constructOnly:!0})],fb.prototype,"view",void 0),h([p()],fb.prototype,"spatialReference",null),fb=h([D("esri.views.3d.support.CombinedElevationProvider")],fb);let gb=class h${static isValidProfile(e){return e in h$.profiles}static getDefaultProfile(){return St("trident")||St("esri-iPhone")?"low":"medium"}static apply(e,t){const r=h$.profiles[e];t.graphics3D.maxTotalNumberOfFeatures=r.graphics3D.maxTotalNumberOfFeatures,t.graphics3D.maxTotalNumberOfPrimitives=r.graphics3D.maxTotalNumberOfPrimitives,t.graphics3D.polygonLodFactor=r.graphics3D.polygonLodFactor,t.graphics3D.polylineLodFactor=r.graphics3D.polylineLodFactor,t.graphics3D.snapshotAvailable=r.graphics3D.snapshotAvailable,t.graphics3D.skipHighSymbolLods=r.graphics3D.skipHighSymbolLods;{const n=t.sceneService.object,s=r.sceneService.object;n.lodFactor=s.lodFactor,n.lodCrossfadeinDuration=s.lodCrossfadeinDuration,n.lodCrossfadeoutDuration=s.lodCrossfadeoutDuration,n.lodCrossfadeUncoveredDuration=s.lodCrossfadeUncoveredDuration}t.sceneService.point.lodFactor=r.sceneService.point.lodFactor,t.sceneService.integratedMesh.lodFactor=r.sceneService.integratedMesh.lodFactor,t.sceneService.pointCloud.lodFactor=r.sceneService.pointCloud.lodFactor,t.sceneService.uncompressedTextureDownsamplingEnabled=r.sceneService.uncompressedTextureDownsamplingEnabled,t.tiledSurface.lodBias=r.tiledSurface.lodBias,t.tiledSurface.angledSplitBias=r.tiledSurface.angledSplitBias,t.tiledSurface.reduceTileLevelDifferences=r.tiledSurface.reduceTileLevelDifferences,t.tiledSurface.textureFadeDuration=r.tiledSurface.textureFadeDuration,t.heatmap.pixelRatio=r.heatmap.pixelRatio,t.heatmap.maxTotalNumberOfFeatures=r.heatmap.maxTotalNumberOfFeatures,t.weatherFadeDuration=r.weatherFadeDuration,t.antialiasingEnabled=r.antialiasingEnabled,t.physicallyBasedRenderingEnabled=r.physicalBasedRenderingEnabled,t.highQualityTransparency=r.highQualityTransparency,t.memoryLimit=r.memoryLimit,t.additionalCacheMemory=r.additionalCacheMemory,t.frameRate=r.frameRate,t.maximumRenderResolution=r.maximumRenderResolution,t.maximumPixelRatio=r.maximumPixelRatio}};function mz(){const i=!!St("esri-mobile"),e=!!St("ios"),t=Rt(400);return{low:{graphics3D:{maxTotalNumberOfFeatures:25e3,maxTotalNumberOfPrimitives:85e4,polygonLodFactor:.5,polylineLodFactor:1,snapshotAvailable:!1,skipHighSymbolLods:!0},heatmap:{pixelRatio:.125,maxTotalNumberOfFeatures:25e3},sceneService:{object:{lodFactor:.2,lodCrossfadeinDuration:Rt(0),lodCrossfadeoutDuration:Rt(0),lodCrossfadeUncoveredDuration:Rt(0)},point:{lodFactor:1},integratedMesh:{lodFactor:.6},pointCloud:{lodFactor:.5},uncompressedTextureDownsamplingEnabled:!0},tiledSurface:{lodBias:-1,angledSplitBias:.5,reduceTileLevelDifferences:!1,textureFadeDuration:Rt(0)},weatherFadeDuration:Rt(0),antialiasingEnabled:!1,physicalBasedRenderingEnabled:!1,highQualityTransparency:!1,memoryLimit:200,additionalCacheMemory:0,frameRate:0,maximumRenderResolution:void 0,maximumPixelRatio:1},medium:{graphics3D:{maxTotalNumberOfFeatures:5e4,maxTotalNumberOfPrimitives:17e5,polygonLodFactor:i?.8:1,polylineLodFactor:i?1.2:1.5,snapshotAvailable:!e,skipHighSymbolLods:!1},heatmap:{pixelRatio:.25,maxTotalNumberOfFeatures:5e4},sceneService:{object:{lodFactor:1,lodCrossfadeinDuration:Rt(0),lodCrossfadeoutDuration:Rt(0),lodCrossfadeUncoveredDuration:t},point:{lodFactor:1},integratedMesh:{lodFactor:1},pointCloud:{lodFactor:1},uncompressedTextureDownsamplingEnabled:i},tiledSurface:{lodBias:0,angledSplitBias:1,reduceTileLevelDifferences:!St("disable-feature:reduce-map-tile-levels"),textureFadeDuration:t},weatherFadeDuration:t,antialiasingEnabled:!0,physicalBasedRenderingEnabled:!0,highQualityTransparency:!0,memoryLimit:i?600:750,additionalCacheMemory:i?0:150,frameRate:0,maximumRenderResolution:void 0,maximumPixelRatio:1},high:{graphics3D:{maxTotalNumberOfFeatures:5e4,maxTotalNumberOfPrimitives:17e5,polygonLodFactor:i?1.2:2,polylineLodFactor:i?1.2:2,snapshotAvailable:!e,skipHighSymbolLods:!1},heatmap:{pixelRatio:.5,maxTotalNumberOfFeatures:5e4},sceneService:{object:{lodFactor:1,lodCrossfadeinDuration:Rt(0),lodCrossfadeoutDuration:Rt(0),lodCrossfadeUncoveredDuration:t},point:{lodFactor:1},integratedMesh:{lodFactor:1},pointCloud:{lodFactor:1},uncompressedTextureDownsamplingEnabled:!1},tiledSurface:{lodBias:0,angledSplitBias:1,reduceTileLevelDifferences:!St("disable-feature:reduce-map-tile-levels"),textureFadeDuration:t},weatherFadeDuration:t,antialiasingEnabled:!0,physicalBasedRenderingEnabled:!0,highQualityTransparency:!0,memoryLimit:i?900:1500,additionalCacheMemory:0,frameRate:0,maximumRenderResolution:i?void 0:4096,maximumPixelRatio:i?1:void 0}}}gb.debug={reset(){const i=mz();for(const e in i)gb.profiles[e]=i[e]}},function(i){i.profiles=mz()}(gb||(gb={}));const cE=gb;let xh=class extends ue{constructor(){super(...arguments),this.color=new ei([0,255,255]),this.haloColor=null,this.haloOpacity=1,this.fillOpacity=.25,this.shadowOpacity=.4,this.shadowColor=new ei([0,0,0]),this.shadowDifference=.2}static toEngineOptions(e){const t=ei.toUnitRGBA(e.color),r=y(e.haloColor)?ei.toUnitRGBA(e.haloColor):t,n=ei.toUnitRGBA(e.shadowColor);return{color:Z0(t[0],t[1],t[2],t[3]),haloColor:Z0(r[0],r[1],r[2],r[3]),haloOpacity:e.haloOpacity,haloOpacityOccluded:.25*e.haloOpacity,fillOpacity:e.fillOpacity,fillOpacityOccluded:.25*e.fillOpacity,shadowOpacity:e.shadowOpacity,shadowColor:Bi(n[0],n[1],n[2],n[3]),occludedShadowOpacity:e.shadowOpacity*(1-e.shadowDifference)}}};h([p({type:ei})],xh.prototype,"color",void 0),h([p({type:ei})],xh.prototype,"haloColor",void 0),h([p()],xh.prototype,"haloOpacity",void 0),h([p()],xh.prototype,"fillOpacity",void 0),h([p()],xh.prototype,"shadowOpacity",void 0),h([p({type:ei})],xh.prototype,"shadowColor",void 0),h([p()],xh.prototype,"shadowDifference",void 0),xh=h([D("esri.views.3d.support.HighlightOptions")],xh);const u$=xh;let zf=class extends mt{constructor(e){super(e),this.geometries=null,this.outSpatialReference=null,this.transformation=null,this.transformForward=null}toJSON(){const e=this.geometries.map(n=>n.toJSON()),t=this.geometries[0],r={};return r.outSR=this.outSpatialReference.wkid||JSON.stringify(this.outSpatialReference.toJSON()),r.inSR=t.spatialReference.wkid||JSON.stringify(t.spatialReference.toJSON()),r.geometries=JSON.stringify({geometryType:x7(t),geometries:e}),this.transformation&&(r.transformation=this.transformation.wkid||JSON.stringify(this.transformation)),this.transformForward!=null&&(r.transformForward=this.transformForward),r}};h([p()],zf.prototype,"geometries",void 0),h([p({json:{read:{source:"outSR"}}})],zf.prototype,"outSpatialReference",void 0),h([p()],zf.prototype,"transformation",void 0),h([p()],zf.prototype,"transformForward",void 0),zf=h([D("esri.rest.support.ProjectParameters")],zf);const _x=zf,X2e=Ox(_x);async function oP(i,e,t){e=X2e(e);const r=uie(i),n={...r.query,f:"json",...e.toJSON()},s=e.outSpatialReference,a=x7(e.geometries[0]),o=die(n,t);return Wh(r.path+"/project",o).then(({data:{geometries:l}})=>pie(l,a,s))}async function R4(i=null,e){var n,s;if(Sg.geometryServiceUrl)return Sg.geometryServiceUrl;if(!i)throw new K("internal:geometry-service-url-not-configured");let t;t="portal"in i?i.portal||$1.getDefault():i,await t.load({signal:e});const r=(s=(n=t.helperServices)==null?void 0:n.geometry)==null?void 0:s.url;if(!r)throw new K("internal:geometry-service-url-not-configured");return r}async function Q2e(i,e,t=null,r){const n=await R4(t,r),s=new _x;s.geometries=[i],s.outSpatialReference=e;const a=await oP(n,s,{signal:r});if(a&&Array.isArray(a)&&a.length===1)return a[0];throw new K("internal:geometry-service-projection-failed")}const d$=Object.freeze(Object.defineProperty({__proto__:null,getGeometryServiceURL:R4,projectGeometry:Q2e},Symbol.toStringTag,{value:"Module"}));let Z2e=class{constructor(e,t){this.spatialReference=t,this.unitInMeters=Gm(this.spatialReference,Yt(this.spatialReference).metersPerDegree),this._geometryServiceURLPromise=R4(e&&e.get("portalItem")).catch(()=>{throw new K("mapcoordshelper:missing-geometry-service","Must specify geometryService in esri/config")})}async toGeographic(e){const t=await this._geometryServiceURLPromise;let r,n=!0;Array.isArray(e[0])&&typeof e[0]!="number"?r=e:(r=[e],n=!1);const s=r.map(l=>l instanceof Ne?l:new Ne(l,this.spatialReference)),a=new _x({geometries:s,outSpatialReference:Qt.WGS84}),o=(await oP(t,a)).map(l=>l.type==="point"?[l.x,l.y]:void 0);return n?o:o[0]}},pc=class extends ue{constructor(){super(...arguments),this.minTotalNumberOfFeatures=2e3,this.maxTotalNumberOfFeatures=5e4,this.maxTotalNumberOfPrimitives=17e5,this.snapshotAvailable=!0,this.polygonLodFactor=1,this.polylineLodFactor=1,this.skipHighSymbolLods=!1}};h([p()],pc.prototype,"minTotalNumberOfFeatures",void 0),h([p()],pc.prototype,"maxTotalNumberOfFeatures",void 0),h([p()],pc.prototype,"maxTotalNumberOfPrimitives",void 0),h([p()],pc.prototype,"snapshotAvailable",void 0),h([p()],pc.prototype,"polygonLodFactor",void 0),h([p()],pc.prototype,"polylineLodFactor",void 0),h([p()],pc.prototype,"skipHighSymbolLods",void 0),pc=h([D("esri.views.3d.support.QualitySettings.Graphics3DSettings")],pc);let Kh=class extends ue{constructor(){super(...arguments),this.lodFactor=1}};h([p()],Kh.prototype,"lodFactor",void 0),Kh=h([D("esri.views.3d.support.QualitySettings.LoDFactorSettings")],Kh);let lP=class extends Kh{constructor(){super(...arguments),this.lodCrossfadeinDuration=Rt(0),this.lodCrossfadeoutDuration=Rt(0),this.lodCrossfadeUncoveredDuration=Rt(0)}};lP=h([D("esri.views.3d.support.QualitySettings.LoDFactor3DObjectSettings")],lP);let Zu=class extends ue{constructor(){super(...arguments),this.object=new lP,this.point=new Kh,this.integratedMesh=new Kh,this.pointCloud=new Kh,this.uncompressedTextureDownsamplingEnabled=!1}};h([p({type:lP})],Zu.prototype,"object",void 0),h([p({type:Kh})],Zu.prototype,"point",void 0),h([p({type:Kh})],Zu.prototype,"integratedMesh",void 0),h([p({type:Kh})],Zu.prototype,"pointCloud",void 0),h([p()],Zu.prototype,"uncompressedTextureDownsamplingEnabled",void 0),Zu=h([D("esri.views.3d.support.QualitySettings.SceneServiceSettings")],Zu);let qp=class extends ue{constructor(){super(...arguments),this.lodBias=0,this.angledSplitBias=1,this.reduceTileLevelDifferences=!0,this.textureFadeDuration=Rt(400)}};h([p()],qp.prototype,"lodBias",void 0),h([p()],qp.prototype,"angledSplitBias",void 0),h([p()],qp.prototype,"reduceTileLevelDifferences",void 0),h([p()],qp.prototype,"textureFadeDuration",void 0),qp=h([D("esri.views.3d.support.QualitySettings.TiledSurfaceSettings")],qp);let y0=class extends ue{constructor(){super(...arguments),this.pixelRatio=1,this.maxTotalNumberOfFeatures=5e4}};h([p()],y0.prototype,"pixelRatio",void 0),h([p()],y0.prototype,"maxTotalNumberOfFeatures",void 0),y0=h([D("esri.views.3d.support.QualitySettings.HeatmapSettings")],y0);let Bs=class extends ue{constructor(){super(...arguments),this.graphics3D=new pc,this.sceneService=new Zu,this.tiledSurface=new qp,this.heatmap=new y0,this.weatherFadeDuration=Rt(400),this.antialiasingEnabled=!0,this.physicallyBasedRenderingEnabled=!1,this.highQualityTransparency=!0,this.memoryLimit=void 0,this.additionalCacheMemory=void 0,this.frameRate=void 0,this.maximumRenderResolution=void 0,this.maximumPixelRatio=void 0}};h([p({type:pc})],Bs.prototype,"graphics3D",void 0),h([p({type:Zu})],Bs.prototype,"sceneService",void 0),h([p({type:qp})],Bs.prototype,"tiledSurface",void 0),h([p({type:y0})],Bs.prototype,"heatmap",void 0),h([p()],Bs.prototype,"weatherFadeDuration",void 0),h([p()],Bs.prototype,"antialiasingEnabled",void 0),h([p()],Bs.prototype,"physicallyBasedRenderingEnabled",void 0),h([p()],Bs.prototype,"highQualityTransparency",void 0),h([p()],Bs.prototype,"memoryLimit",void 0),h([p()],Bs.prototype,"additionalCacheMemory",void 0),h([p()],Bs.prototype,"frameRate",void 0),h([p()],Bs.prototype,"maximumRenderResolution",void 0),h([p()],Bs.prototype,"maximumPixelRatio",void 0),Bs=h([D("esri.views.3d.support.QualitySettings.QualitySettings")],Bs);const fz=Bs;function Y2e(i){return u7(i)&&i.length>=3}function K2e(i){return(d7(i)||Array.isArray(i))&&i.length>=3}function J2e(i){return Y2e(i)||K2e(i)}let ePe=class p${constructor(e,t,r,n){this.viewingMode=e,this.spatialReference=t,this.unitInMeters=r,this._coordinateSystem=n,this._tmpCoordinateSystem=x_e(n)}set extent(e){e&&T_e(this._coordinateSystem,e,this._coordinateSystem)}getAltitude(e){return M_e(this._coordinateSystem,e)}setAltitude(e,t,r=e){return aQ(this._coordinateSystem,r,t,e)}setAltitudeOfTransformation(e,t){I_e(this._coordinateSystem,t,e,t)}worldUpAtPosition(e,t){return P_e(this._coordinateSystem,e,t)}worldBasisAtPosition(e,t,r){return R_e(this._coordinateSystem,e,t,r)}basisMatrixAtPosition(e,t){const r=this.worldBasisAtPosition(e,tm.X,ze.get()),n=this.worldBasisAtPosition(e,tm.Y,ze.get()),s=this.worldBasisAtPosition(e,tm.Z,ze.get());return lG(t,r[0],r[1],r[2],0,n[0],n[1],n[2],0,s[0],s[1],s[2],0,0,0,0,1),t}headingAtPosition(e,t){const r=this.worldUpAtPosition(e,ze.get()),n=this.worldBasisAtPosition(e,tm.Y,ze.get()),s=nG(t,n,r);return _o(s)}intersectManifoldClosestSilhouette(e,t,r){return hO(this._coordinateSystem,t,this._tmpCoordinateSystem),O_e(this._tmpCoordinateSystem,e,r),r}intersectManifold(e,t,r){hO(this._coordinateSystem,t,this._tmpCoordinateSystem);const n=ze.get();return A_e(this._tmpCoordinateSystem,e,n)?q(r,n):null}intersectInfiniteManifold(e,t,r){if(this.viewingMode===Se.Global)return this.intersectManifold(e,t,r);hO(this._coordinateSystem,t,this._tmpCoordinateSystem);const n=this._tmpCoordinateSystem.value,s=ze.get();return Kg(n.plane,e,s)?q(r,s):null}toRenderCoords(e,t,r){return W2(e)?bn(e,t,this.spatialReference):ss(e,t,r,this.spatialReference)}fromRenderCoords(e,t,r=null){return W2(t)?(y(r)&&(t.spatialReference=r),P7(e,this.spatialReference,t)):J2e(t)?ss(e,this.spatialReference,t,r)?t:null:Rm(e,this.spatialReference,t)}static create(e,t){switch(e){case Se.Local:return new p$(Se.Local,t,Gm(t),E_e());case Se.Global:return new p$(Se.Global,t,1,S_e(t))}}static renderUnitScaleFactor(e,t){return gz(e)/gz(t)}};function gz(i){if(X2(i,Se.Global))return 1;const e=oQ(!1,i);return Gm(e)}var Uh;(function(i){i[i.ELEVATION=0]="ELEVATION",i[i.BASEMAP=1]="BASEMAP",i[i.I3S_INDEX=2]="I3S_INDEX",i[i.I3S_DATA=3]="I3S_DATA",i[i.SYMBOLOGY=4]="SYMBOLOGY"})(Uh||(Uh={}));const tPe=(()=>{const i=new Array;return i[Uh.ELEVATION]=10,i[Uh.BASEMAP]=10,i[Uh.I3S_INDEX]=10,i[Uh.I3S_DATA]=10,i[Uh.SYMBOLOGY]=5,i})(),iPe=30;function OK(i){return typeof i.getUsedMemory=="function"}function rPe(i){return new ma({view:i})}const jC=1,AM=1,nPe=.75,sPe=.6,_z=1.3;let ma=class extends ue{constructor(e){super(e),this._quality=1,this._memoryUsed=0,this._updating=!1,this.minQuality=.1,this._stableQuality=0,this._downscaleMemoryUsed=0,this._canFastRecover=!1,this._memoryPredicted=0,this._cacheStorage=new Zse,this._warnMemoryUsage=null,this._numQualityChanges=0,this._maxMemory=500,this._additionalCacheMemory=100}destroy(){this._cacheStorage.destroy()}set maxMemory(e){e==null||e<=0||(this._stableQuality=0,this._canFastRecover=!1,this._maxMemory<e&&this._updateQuality(jC),this._maxMemory=e)}get maxMemory(){return this._maxMemory}set additionalCacheMemory(e){e!=null&&e>=0&&(this._additionalCacheMemory=e)}get additionalCacheMemory(){return this._additionalCacheMemory}get memoryFactor(){return this._quality}get updating(){return this._updating}get usedMemory(){return this._memoryUsed}newCache(e,t){return new Yse(e,this._cacheStorage,t)}resetStableQuality(){this._stableQuality=0}disableMemCache(){this.additionalCacheMemory=-4096}update(){if(this._updateMemory(),this._memoryPredicted<=0&&!this._updating)return;let e=this._layersUpdating();if(this._memoryPredicted<sPe&&this._canFastRecover)this._downscaleMemoryUsed=0,this._stableQuality=0,this._canFastRecover=!1,this._updateQuality(jC);else if(e)(this._memoryPredicted>1.1*AM||this._memoryUsed>AM)&&(this._stableQuality>0?(this._downscaleMemoryUsed=0,this._updateQuality(this._stableQuality)):this._quality>this.minQuality&&this._downscaleMemoryUsed<this._memoryUsed&&(this._updateQuality(this._quality/_z),this._downscaleMemoryUsed=this._memoryUsed,this._canFastRecover=!1));else if(this._downscaleMemoryUsed=0,this._memoryUsed>AM)this._stableQuality=0,this._canFastRecover=!1,e=this._updateQuality(this._quality/_z),this._downscaleMemoryUsed=this._memoryPredicted;else if(this._stableQuality!==this._quality)if(this._memoryUsed<nPe&&this._quality<jC){this._stableQuality=this._quality;const t=.05;e=this._updateQuality(this._quality+t)}else this._quality<1&&(this._canFastRecover=!0);this._updating=e}_updateQuality(e){return(e=Math.min(Math.max(e,this.minQuality),jC))!==this._quality&&(this._quality=e,++this._numQualityChanges,!0)}_layersUpdating(){return this.view.allLayerViews.some(e=>!!e.updating)}_updateMemory(){let e=0,t=0;this.view.basemapTerrain&&this.view.basemapTerrain.getUsedMemory&&(e+=this.view.basemapTerrain.getUsedMemory());const r=this.view._stage&&this.view._stage.renderView&&this.view._stage.renderView.edgeView;y(r)&&(e+=r.usedMemory),this.view.allLayerViews&&this.view.allLayerViews.forEach(o=>{if(OK(o)){const l=o.ignoresMemoryFactor()?this._quality:1;e+=o.getUsedMemory()*l,t+=o.getUnloadedMemory()*l}});const n=S(this._warnMemoryUsage)||Math.round(10*e)!==Math.round(10*this._warnMemoryUsage),s=1048576*this.maxMemory;if(e>s&&n){this._warnMemoryUsage=e;const o=c=>(c/1048576).toLocaleString(void 0,{maximumFractionDigits:1})+" MB",l=Math.round(100*this._quality);J.getLogger(this.declaredClass).warn(`Memory Limit exceeded! Limit: ${o(s)} Current: ${o(e)} Projected: ${o(e+t)} Quality: ${l}%`)}this._memoryUsed=e/s,this._memoryPredicted=(e+t)/s;const a=s-e;this._cacheStorage.maxSize=Math.max(0,a+1048576*this.additionalCacheMemory)}get test(){const e=this;return{cacheStorage:this._cacheStorage,resetQualityChanges:()=>{const t=e._numQualityChanges;return e._numQualityChanges=0,t}}}};h([p({constructOnly:!0})],ma.prototype,"view",void 0),h([p()],ma.prototype,"maxMemory",null),h([p()],ma.prototype,"additionalCacheMemory",null),h([p()],ma.prototype,"memoryFactor",null),h([p()],ma.prototype,"updating",null),h([p()],ma.prototype,"usedMemory",null),h([p()],ma.prototype,"_quality",void 0),h([p()],ma.prototype,"_memoryUsed",void 0),h([p()],ma.prototype,"_updating",void 0),h([p()],ma.prototype,"_stableQuality",void 0),h([p()],ma.prototype,"_maxMemory",void 0),h([p()],ma.prototype,"_additionalCacheMemory",void 0),ma=h([D("esri.views.3d.support.MemoryControllerImpl")],ma);let aPe=class{constructor(e){this.client=e,this._cancelled=!1,this.size=0,this.duration=0}},oPe=class{constructor(e){this.typeWorkerQuota=e,this.tasks=new Array,this.numWorkers=0,this.statistics=new lPe}},lPe=class{constructor(){this.requests=0,this.size=0,this.duration=0,this.speed=0}},cPe=class{constructor(e,t,r,n){this._workerFunc=e,this._callbackFunc=t,this._maxTotalNumWorkers=r,this._totalNumWorkers=0,this._clients=n.map(s=>new oPe(s))}destroy(){this._clients.length=0}hasQuota(e){const t=this._clients[e];return!!t&&(this._totalNumWorkers<this._maxTotalNumWorkers||t.numWorkers+t.tasks.length<t.typeWorkerQuota)}push(e){const t=this._clients[e.client];t&&(this._totalNumWorkers<this._maxTotalNumWorkers?(t.numWorkers++,this._totalNumWorkers++,this._workerFunc(e,(r,n)=>this._taskCallback(r,n))):t.tasks.push(e))}cancel(e){this._taskFinished(e),e._cancelled=!0}_taskFinished(e){const t=this._clients[e.client];this._totalNumWorkers--,t.numWorkers--,t.statistics.requests++,t.statistics.size+=e.size||0,t.statistics.duration+=e.duration||0,t.statistics.speed=t.statistics.duration>0?t.statistics.size/t.statistics.duration:0,it(t.numWorkers>=0),this._next()}_next(){for(const e of this._clients)if(e&&e.numWorkers<e.typeWorkerQuota&&this._processQueue(e))return;for(const e of this._clients)if(e&&this._processQueue(e))return}_processQueue(e){for(;e.tasks.length>0;)if(this._workerFunc(e.tasks.shift(),(t,r)=>this._taskCallback(t,r)))return e.numWorkers++,this._totalNumWorkers++,!0;return!1}_taskCallback(e,t){e._cancelled||(this._callbackFunc(e,t),this._taskFinished(e))}getStatsForType(e){const t=this._clients[e];return t?{quota:t.typeWorkerQuota,workers:t.numWorkers,queueSize:t.tasks.length,requestStats:t.statistics}:null}get test(){const e=this;return{set workerFunc(t){e._workerFunc=t}}}},hE=class extends ue{constructor(){super(...arguments),this._tasks=new Map,this._onLoadQueue=new Array,this._doneQueue=new Array,this.updating=!1}setup(e,t,r){this._loadQueue=new cPe((n,s)=>this._startLoading(n,s),(n,s)=>this._doneLoadingCB(n,s),e,t),r&&(this._frameTask=r.registerTask(dr.STREAM_DATA_LOADER,this))}destroy(){this._frameTask=Os(this._frameTask),this._tasks.forEach(e=>iu(e.abortController)),this._loadQueue=Te(this._loadQueue),this._onLoadQueue=null,this._doneQueue=null,this._tasks=null}hasDownloadSlots(e){return this._loadQueue.hasQuota(e)}request(e,t,r,n={}){const s=Ix();s.__signal=y(n)?n.signal:null;const a=this._createOrUpdateTask(e,t,r,n,s);return Em(n,()=>this._cancelRequest(a,s)),s.promise}_createTask(e,t,r,n,s,a){const o=new dPe(e,t,r,n,s);return this._updateTask(o,a),this._tasks.set(s,o),this._tasks.size===1&&this._set("updating",!0),this._loadQueue.push(o),o}_cancelRequest(e,t){var r;m7(e.resolvers,t),t.reject(ts()),e.resolvers.length===0&&(e.status===bl.DOWNLOADING&&(e.status=bl.CANCELLED,this._loadQueue.cancel(e),(r=e.abortController)==null||r.abort(),e.request=null,e.abortController=null),e.status=bl.CANCELLED,this._tasks.delete(e.key),this._tasks.size===0&&this._set("updating",!1))}_updateTask(e,t){e.resolvers.push(t)}_createOrUpdateTask(e,t,r,n,s){const a=pPe(y(n)&&n.uid||e,t,r),o=this._tasks.get(a);return o?(this._updateTask(o,s),o):this._createTask(e,n,t,r,a,s)}_doneLoadingCB(e,t){this._loadQueue&&(it(e.status===bl.DOWNLOADING),e.status=bl.DOWNLOADED,this._frameTask?this._doneQueue.push({task:e,err:t}):this._doneLoading(e,t))}get running(){return this._doneQueue.length>0||this._onLoadQueue.length>0}runTask(e){for(;!e.done&&this._onLoadQueue.length>0;){const t=this._onLoadQueue.shift();xi(t.task.abortController),t.task.abortController=null,t.callback(t.task),e.madeProgress()}for(;!e.done&&this._doneQueue.length>0;){const t=this._doneQueue.shift();t.task.status!==bl.DOWNLOADED&&(t.err=t.err||ts()),this._doneLoading(t.task,t.err),e.madeProgress()}}_doneLoading(e,t){if(t&&!yo(t)&&e.numRetries>0)return--e.numRetries,void this._loadQueue.push(e);let r=e.result instanceof HTMLImageElement?0:e.resolvers.length;for(const n of e.resolvers)if(t)yo(t)?n.reject(t):n.reject(new K("stream-data-loader:request-error",`Failed to request resource at '${e.url}'. ${t}`,{url:e.url,error:t}));else{--r;const s=r<=0?e.result:Rr(e.result);n.resolve(s)}this._tasks.delete(e.key),this._tasks.size===0&&this._set("updating",!1)}_startLoading(e,t){if(e.status===bl.CANCELLED)return!1;let r,n;switch(e.startTime=performance.now(),e.status=bl.DOWNLOADING,e.docType){case"binary":n="array-buffer",r=0;break;case"image":n="image";break;case"image+type":n="array-buffer";break;default:n="json"}e.abortController=new AbortController;const s=e.abortController.signal;e.request=Wh(e.url,{...e.options,responseType:n,timeout:r,signal:s});let a=()=>{};const o=c=>{e.duration=performance.now()-e.startTime,e.size=c instanceof ArrayBuffer?c.byteLength:e.size||0,e.result=c,this._frameTask?this._onLoadQueue.push({callback:t,task:e}):(e.abortController=null,t(e))},l=c=>{e.status===bl.DOWNLOADING&&t(e,c),a()};return e.docType!=="image+type"?(e.request.then(c=>o(c.data),l),!0):(e.request.then(c=>{const u=c.data,d=uPe(u);if(n="image",e.size=u.byteLength,d==="unknown")return e.request=Wh(e.url,{responseType:n,timeout:r,signal:s}),void e.request.then(_=>o(_.data),l);const m=new Blob([u],{type:d}),f=window.URL.createObjectURL(m);a=()=>window.URL.revokeObjectURL(f),e.request=Wh(f,{responseType:n,timeout:r,signal:s}),e.request.then(_=>o(new FR(_.data,d,a)),l)},l),!0)}get test(){return{loadQueue:this._loadQueue}}};h([p({readOnly:!0})],hE.prototype,"updating",void 0),hE=h([D("esri.views.3d.support.StreamDataLoader")],hE);const hPe={numRetries:0};function uPe(i){if(i.byteLength<2)return"unknown";const e=new Uint8Array(i,0,i.byteLength);return e[0]===137&&e[1]===80?"image/png":e[0]===71&&e[1]===73?"image/gif":e[0]===66&&e[1]===77?"image/bmp":e[0]===255&&e[1]===216?"image/jpeg":"unknown"}let FR=class{constructor(e,t,r){this.image=e,this.type=t,this.release=r}get isOpaque(){return this.type==="image/jpeg"}},dPe=class extends aPe{constructor(e,t,r,n,s){super(n),this.url=e,this.options=t,this.docType=r,this.key=s,this.result=null,this.status=bl.QUEUED,this.request=null,this.abortController=null,this.resolvers=new Array,this.startTime=0,this.numRetries=hPe.numRetries}};function pPe(i,e,t){return`${i}:${e}:${t}`}var bl;(function(i){i[i.QUEUED=1]="QUEUED",i[i.DOWNLOADING=2]="DOWNLOADING",i[i.DOWNLOADED=3]="DOWNLOADED",i[i.CANCELLED=4]="CANCELLED"})(bl||(bl={}));let uE=class extends ue{constructor(){super(...arguments),this.updating=!1}};function mPe(i){return new Uu({view:i})}h([p({readOnly:!0})],uE.prototype,"updating",void 0),uE=h([D("esri.views.3d.support.ResourceControllerMain")],uE);let Uu=class extends uE{constructor(){super(...arguments),this._scheduler=null,this._memoryController=null,this._streamDataLoader=null,this._scheduleTask=oD,this._handles=new Ft,this._frameTask=null}initialize(){this._scheduler=vie(),this._memoryController=rPe(this.view),this._streamDataLoader=new hE,this._streamDataLoader.setup(iPe,tPe,this._scheduler),this._handles.add([z(()=>{var e;return(e=this.view.state)==null?void 0:e.mode},e=>this._scheduler.state=e,ri),z(()=>this.view.stationary,()=>this._stationaryChangedHandler())]),this._frameTask=wd({update:e=>this._frame(e)}),this._scheduleTask=this._scheduler.registerTask(dr.RESOURCE_CONTROLLER)}destroy(){this._handles=Te(this._handles),this._scheduleTask.remove(),this._frameTask=Os(this._frameTask),this._streamDataLoader=Te(this._streamDataLoader),this._memoryController=Te(this._memoryController),this._scheduler=Te(this._scheduler)}get updating(){var e,t,r;return!!((e=this._memoryController)!=null&&e.updating||(t=this._streamDataLoader)!=null&&t.updating||(r=this._scheduleTask)!=null&&r.updating)}get scheduler(){return this._scheduler}get memoryController(){return this._memoryController}schedule(e,t,r){return this._scheduleTask.schedule(e,t,r)}createStreamDataRequester(e){const t=this._streamDataLoader;return{request:(r,n,s)=>t.request(r,n,e,s),get busy(){return!t.hasDownloadSlots(e)}}}_frame(e){this.view.suspended||this.view.stateManager&&(this.view.stateManager.step(Q$(e.deltaTime)),!this._scheduler)||(this._scheduler.updateBudget(e)?(this._memoryController.update(),this._scheduler.frame()):this._memoryController.updating&&this._memoryController.update())}_stationaryChangedHandler(){this.memoryController.resetStableQuality()}get test(){return{getQueueStats:e=>this._streamDataLoader.test.loadQueue.getStatsForType(e)}}};h([p({constructOnly:!0})],Uu.prototype,"view",void 0),h([p()],Uu.prototype,"_scheduler",void 0),h([p()],Uu.prototype,"_memoryController",void 0),h([p()],Uu.prototype,"_streamDataLoader",void 0),h([p()],Uu.prototype,"_scheduleTask",void 0),h([p({readOnly:!0})],Uu.prototype,"updating",null),Uu=h([D("esri.views.3d.support.ResourceControllerImpl")],Uu);function fPe(i){return"performanceInfo"in i}const Y_=R(),gPe=R(),Eu=R(),Pu=R();function _Pe(i,e,t=0){const r=i.extent;if(S(r))return!1;if(t===0)return eG(r,e);const n=Math.min(r[2]-r[0],r[3]-r[1]);return Yie(r,e,t*n)}function qC(i,e,t,r){q(Y_,t),Y_[r]=e[r];const n=ne(Y_,Y_,e),s=ne(gPe,i,e),a=me(s,n),o=me(n,n);let l;l=a<=0?e:o<=a?t:oe(Y_,e,Q(n,n,a/o));const c=ne(Y_,i,l);return Math.PI/2-Math.atan(c[2]/Math.sqrt(c[0]*c[0]+c[1]*c[1]))}function yPe(i,e,t){const r=i.extent;if(S(r))return 0;Eu[0]=r[0],Eu[1]=r[1],Eu[2]=t,Pu[0]=r[2],Pu[1]=r[3],Pu[2]=t;let n=1/0,s=1/0;return e[0]<Eu[0]?n=qC(e,Eu,Pu,0):e[0]>Pu[0]&&(n=qC(e,Pu,Eu,0)),e[1]<Eu[1]?s=qC(e,Eu,Pu,1):e[1]>Pu[1]&&(s=qC(e,Pu,Eu,1)),Math.min(n,s)}function vPe(i,e,t){if(S(i))return ON();if(i.spatialReference.isGeographic&&!Eg(i.spatialReference))return new K("tilingscheme:local-unsupported-spatial-reference","The tiling scheme spatial reference is not supported in local scenes");const r=so.checkUnsupported(i);if(y(r))return r;if(S(t))return new K("tilingscheme:extent-not-exist","The layer does not provide a layer extent.");const n=bPe(i,t);if(n)return n;const s=i.spatialReference;return y(e)&&!(s.equals(e)||e.isWGS84&&s.isWebMercator)?new K("tilingscheme:spatial-reference-mismatch","The tiling scheme does not match the spatial reference of the local scene"):null}function bPe(i,e){const t=i.lods,r=t[0].resolution*2**t[0].level,n=[r*i.size[0],r*i.size[1]],s=[i.origin.x,i.origin.y],a=_w(e),o=$t();so.computeRowColExtent(a,n,s,o);const l=(o[2]-o[0])*(o[3]-o[1]);if(l>c0){const c=t[0].scale*2**t[0].level;let u=Math.max((a[3]-a[1])/i.size[1],(a[2]-a[0])/i.size[0])*c/r;const d=Math.floor(Math.log(u)/Math.log(10));return u=Math.ceil(u/10**d)*10**d,new K("tilingscheme:too-many-root-tiles","Scale of level 0 of the tiling scheme (1:"+Math.floor(c).toLocaleString()+") is too large for the layer's extent. Suggested scale: 1:"+u.toLocaleString()+".",{level0Scale:c,suggestedLevel0Scale:u,requiredNumRootTiles:l,allowedNumRootTiles:c0})}return null}const wPe=Object.freeze(Object.defineProperty({__proto__:null,isInsideExtent:_Pe,tiltToExtentEdge:yPe,checkIfTileInfoSupportedForViewSR:vPe},Symbol.toStringTag,{value:"Module"}));function xPe(){return!0}function TPe(){return 0}function CPe(i,e){if(S(i))return ON();const t=i.lods.length-1,r=i.spatialReference,n=Eg(r)||Rx(r)||Ax(r);if(r.isWebMercator){if(!so.makeWebMercatorAuxiliarySphere(t).compatibleWith(i))return new K("tilingscheme:incompatible-global-web-mercator","The tiling scheme is not compatible with the ArcGIS Online Web Mercator tiling scheme")}else{if(!n)return new K("tilingscheme:global-unsupported-spatial-reference","The tiling scheme spatial reference is not supported in global scenes");if(!so.makeGCSWithTileSize(i.spatialReference,i.size[0],t).compatibleWith(i))return i.spatialReference.isWGS84?new K("tilingscheme:incompatible-global-wgs84","The tiling scheme is not compatible with the ArcGIS Online WGS84 tiling scheme"):new K("tilingscheme:incompatible-global","The tiling scheme is not compatible with the ArcGIS Online tiling scheme")}return y(e)&&!i.spatialReference.equals(e)?new K("tilingscheme:spatial-reference-mismatch","The tiling scheme does not match the spatial reference of the global scene"):void 0}const SPe=Object.freeze(Object.defineProperty({__proto__:null,isInsideExtent:xPe,tiltToExtentEdge:TPe,checkIfTileInfoSupportedForViewSR:CPe},Symbol.toStringTag,{value:"Module"})),EPe={[Se.Global]:SPe,[Se.Local]:wPe};function $h(i,e){i||console.warn("Terrain: "+e)}let gn=!1,cP=!1;function PPe(i){cP=i,gn=gn||i}function RPe(i){gn=i}function pe(i,e){if(gn&&!i){const t=new Error().stack.slice(5);throw console.warn("Terrain internal: "+(e||"")+" at "+t),new Error("Assertion failed"+(e?": "+e:""))}}function m$(i){return NR(i)?{fullExtent:i.fullExtent,minScale:i.layer.minScale,maxScale:i.layer.maxScale,tilemapCache:null}:i.layer}function hP(i){return(i==null?void 0:i.type)==="imagery-tile"||(i==null?void 0:i.type)==="wcs"}function NR(i){return(i==null?void 0:i.type)==="imagery-tile-3d"}function A4(i){return(i==null?void 0:i.type)==="tile-3d"}function yx(i){return(i==null?void 0:i.type)==="vector-tile-3d"}function MK(i){return(i==null?void 0:i.type)==="wmts-3d"}function f$(i){return(i==null?void 0:i.type)==="elevation-3d"}function C1(i){return(i==null?void 0:i.type)==="group"}function uv(i){return(i==null?void 0:i.type)==="group"}function uP(i){return i&&(A4(i)||MK(i)||NR(i)||yx(i))}function g$(i){return i&&(A4(i)||NR(i)||yx(i)||MK(i))}function vx(i){return g$(i)||f$(i)}function APe(i){var t;const e=(t=i==null?void 0:i.sourceLayerInfo)==null?void 0:t.data;return y(e)&&"type"in e&&e.type==="raster-tile"}function OPe(i){var t;const e=(t=i==null?void 0:i.sourceLayerInfo)==null?void 0:t.data;return y(e)&&"type"in e&&e.type==="vector-tile"}function MPe(i){var t;const e=(t=i==null?void 0:i.sourceLayerInfo)==null?void 0:t.data;return y(e)&&"type"in e&&e.type==="tile-texture"}function IPe(i){var t;const e=(t=i==null?void 0:i.sourceLayerInfo)==null?void 0:t.data;return e instanceof HTMLImageElement||e instanceof FR||e instanceof HTMLCanvasElement||e instanceof ImageData}function N0(i){return y(i)&&"release"in i&&i.release(),null}function yz(i){return i.fetchTile&&i.hasOverriddenFetchTile!==!1}function O4(i,e,t,r){return EPe[r].checkIfTileInfoSupportedForViewSR(i,t,e)}function kR(i,e,t){let r=null,n=null;if((i==null?void 0:i.type)==="wmts"){const s=LPe(i,e,t);r=s.tileInfo,n=s.fullExtent}else{n=hP(i)?i.getCompatibleFullExtent(e):i.fullExtent;const s=t===Se.Local;if(hP(i))r=i.getCompatibleTileInfo(e,n,s);else if((i==null?void 0:i.type)==="vector-tile"){const a=s&&!$Pe(e)||DPe.force512VTL,o=i.tileInfo.spatialReference.isGeographic;r=a?i.tileInfo:i.tileInfo.getOrCreateCompatible(256,o?1:2)}else r=i.tileInfo}return y(r)&&y(n)&&O4(r,n,e,t)==null?{tileInfo:r,fullExtent:n}:null}function LPe(i,e,t){const r=Ere(i);if(y(r)){if(!pt.isCollection(r))return{tileInfo:r.tileInfo,fullExtent:r.fullExtent};{const n=r.find(s=>O4(s.tileInfo,s.fullExtent,e,t)==null);if(n)return{tileInfo:n.tileInfo,fullExtent:n.fullExtent}}}return{tileInfo:null,fullExtent:null}}function $Pe(i){return i.isWGS84||i.isWebMercator||Yee(i)||!PE(i)}const DPe={force512VTL:!1};function vz(i){return"["+i[0]+","+i[1]+","+i[2]+"]"}function Ru(i){return"("+i[0]+","+i[1]+","+i[2]+")"}function FPe(i,e,t=VPe){return Math.abs(i-e)<t}function _$(i){return i===ke.NORTH_EAST?ke.SOUTH_WEST:i===ke.NORTH_WEST?ke.SOUTH_EAST:i===ke.SOUTH_WEST?ke.NORTH_EAST:ke.NORTH_WEST}function dP(i){return i===ke.NORTH?ke.SOUTH:i===ke.EAST?ke.WEST:i===ke.SOUTH?ke.NORTH:ke.EAST}function NPe(i){return i===ke.NORTH_WEST||i===ke.SOUTH_WEST}function kPe(i){return i===ke.NORTH_WEST||i===ke.NORTH_EAST}function bz(i){return i===ke.NORTH_WEST||i===ke.WEST||i===ke.SOUTH_WEST}function wz(i){return i===ke.NORTH_EAST||i===ke.EAST||i===ke.SOUTH_EAST}function xz(i){return i===ke.SOUTH_EAST||i===ke.SOUTH||i===ke.SOUTH_WEST}function Tz(i){return i===ke.NORTH_EAST||i===ke.NORTH||i===ke.NORTH_WEST}const jh=[ke.NORTH,ke.EAST,ke.SOUTH,ke.WEST],pP=[ke.NORTH_EAST,ke.SOUTH_EAST,ke.SOUTH_WEST,ke.NORTH_WEST],VPe=1e-5;let UPe=class{constructor(e,t){if(this.layer=null,this.memory=0,this.displayedNumberOfFeatures=0,this.maximumNumberOfFeatures=null,this.totalNumberOfFeatures=null,this.layer=e.layer,this.memory=vx(e)?t.basemapTerrain.getUsedMemoryForLayerView(e):e.getUsedMemory(),fPe(e)){const r=e.performanceInfo;this.displayedNumberOfFeatures=r.displayedNumberOfFeatures,this.maximumNumberOfFeatures=r.maximumNumberOfFeatures,this.totalNumberOfFeatures=r.totalNumberOfFeatures}}},zPe=class{constructor(e){if(this.totalMemory=0,this.usedMemory=0,this.quality=1,this.load=0,this.terrainMemory=0,this.edgesMemory=0,this.layerPerformanceInfos=new Array,y(e.resourceController)){const r=e.resourceController.memoryController;this.totalMemory=r.maxMemory*oI.MEGABYTES,this.usedMemory=Math.round(r.usedMemory*this.totalMemory),this.quality=r.memoryFactor,this.load=e.resourceController.scheduler.load}this.terrainMemory=e.basemapTerrain?e.basemapTerrain.getUsedMemory():0;const t=e._stage&&e._stage.renderView&&e._stage.renderView.edgeView;this.edgesMemory=y(t)?t.usedMemory:0,e.allLayerViews.items.forEach(r=>{(OK(r)||vx(r))&&this.layerPerformanceInfos.push(new UPe(r,e))}),this.layerPerformanceInfos.sort((r,n)=>n.memory-r.memory)}},BPe=class{constructor(e){this._gltfLoading=new Map,this._wosrLoading=new Map,this._gltfMemCache=e("gltf-resources",()=>{}),this._wosrMemCache=e("wosr-resources",()=>{})}destroy(){this._gltfLoading.forEach(e=>e.abortController.abort()),this._wosrLoading.forEach(e=>e.abortController.abort()),this._gltfMemCache.destroy(),this._wosrMemCache.destroy()}loadGLTF(e,t,r){const n=r?`gltfPBR:${e}`:`gltf:${e}`,s=this._gltfMemCache.get(n);return y(s)?Promise.resolve(s):this._loadOnce(this._gltfLoading,this._gltfMemCache,n,a=>jne(new qne(a.streamDataRequester),e,a,r),t)}loadWOSR(e,t){const r=`wosr:${e}:${t.disableTextures}`,n=this._wosrMemCache.get(r);return y(n)?Promise.resolve(n):this._loadOnce(this._wosrLoading,this._wosrMemCache,r,s=>Lne(e,s),t)}async _loadOnce(e,t,r,n,s){xi(s);const a=Em(s,()=>this._abortLoad(e,r));let o=e.get(r);if(o)o.refCount++;else{const l=new AbortController;o={refCount:1,abortController:l,promise:n({...s,signal:l.signal})},e.set(r,o)}try{const l=await o.promise;return t.put(r,l,l.size),e.delete(r),xi(s),l}finally{Os(a)}}_abortLoad(e,t){const r=e.get(t);y(r)&&--r.refCount>0||(e.delete(t),y(r)&&r.abortController.abort())}},GPe=class extends a0{constructor(e,t,r,n){super(t,n),this._streamDataRequester=e,this._parameters=r}async fromUrl(e,t,r){xi(r);const n=y(r)&&r.signal,s=this.makeUid(e,t);let a=this._textureRequests.get(s);if(!a){const o=new AbortController,l=this._streamDataRequester.request(e,"image",{uid:s,signal:o.signal});a={referenceCount:0,texture:null,textureAsync:null,abortController:o},this._textureRequests.set(s,a),a.textureAsync=l.then(async c=>{const u=this._createTexture(e,c,t);return a.texture=u,a.abortController=null,this._stage.add(u),await this._stage.load(u),{uid:s,texture:u,release:()=>this._release(s)}},c=>{throw a.abortController=null,c})}return a.referenceCount++,new Promise((o,l)=>{Em(n,()=>{l(ts())}),a.textureAsync.then(o,l)}).catch(o=>{throw this._release(s),o})}_createTexture(e,t,r){const n={...this._parameters,powerOfTwoResizeMode:UD.PAD};if(nD(e)){if(r||t.width===0&&t.height===0){const s=t.width?t.height/t.width:1;r=r||64,s>1?(t.width=Math.round(r/s),t.height=r):(t.width=r,t.height=Math.round(r*s))}this._stage.renderView&&this._stage.renderView.renderingContext.driverTest.svgAlwaysPremultipliesAlpha&&(n.preMultiplyAlpha=!1)}return n.width=t.width,n.height=t.height,new FP(t,n)}},HPe=class{constructor(e){this.textures=null,this.streamDataRequester=null,this._graphicsOwners=[],this._screenSizePerspectiveHandles=null,this.cimSymbolRasterizer=null,this._viewState=e.viewState,this._view=e.view,this._pointsOfInterest=e.pointsOfInterest,this.streamDataRequester=e.resourceController.createStreamDataRequester(Uh.SYMBOLOGY),this.objectResourceCache=new BPe((r,n)=>e.resourceController.memoryController.newCache(r,n)),this.textures=new GPe(this.streamDataRequester,e.view._stage,{preMultiplyAlpha:!0,wrap:{s:si.CLAMP_TO_EDGE,t:si.CLAMP_TO_EDGE}},e.resourceController.scheduler);const t=Yt(this._view.spatialReference).radius;this.screenSizePerspectiveSettings=OG(e.viewingMode,t),this.screenSizePerspectiveSettingsLabels=one(e.viewingMode,t)}destroy(){Te(this.textures),this.textures=null,this.streamDataRequester=null}addGraphicsOwner(e){if(!e)return uw();this._graphicsOwners.push(e);const t=z(()=>{var r;return(r=e.layer)==null?void 0:r.screenSizePerspectiveEnabled},()=>this._updateScreenSizePerspectiveEnabled());return this._updateScreenSizePerspectiveEnabled(),uw(()=>{t.remove(),m7(this._graphicsOwners,e),this._updateScreenSizePerspectiveEnabled()})}_updateScreenSizePerspectiveEnabled(){const e=this._graphicsOwners.some(t=>{var r;return((r=t.layer)==null?void 0:r.screenSizePerspectiveEnabled)===!0});if(e&&!this._screenSizePerspectiveHandles){this._screenSizePerspectiveHandles=new Ft;const t=()=>this._updateScreenSizePerspectiveSettings();this._screenSizePerspectiveHandles.add([z(()=>this._pointsOfInterest.centerOnSurfaceInfrequent.distance,t,ri),this._viewState.events.on("camera-projection-changed",t)]),this._updateScreenSizePerspectiveSettings()}else!e&&this._screenSizePerspectiveHandles&&(this._screenSizePerspectiveHandles.destroy(),this._screenSizePerspectiveHandles=null)}_updateScreenSizePerspectiveSettings(){const e=this._pointsOfInterest;WC.distance=e.centerOnSurfaceInfrequent.distance,WC.fovY=this._viewState.camera.fovY,this.screenSizePerspectiveSettings.update(WC),this.screenSizePerspectiveSettingsLabels.update(WC),this._view._stage.renderView.requestRender()}get test(){return{screenSizePerspectiveHandles:this._screenSizePerspectiveHandles}}};const WC={distance:0,fovY:0};let $p=class{constructor(e,t,r=""){this.graphics=e,this._symbol=new Xte({symbolLayers:[new Qte({material:{color:t},outline:{color:[255,255,255],size:1},resource:{primitive:"circle"}}),new Zte({text:r,halo:{color:"white",size:1/.75},material:{color:t},size:12})]})}show(e,t){if(S(t))return;this.hide();const r=new Ne({x:e[0],y:e[1],z:e[2],spatialReference:t});this._graphic=new jc({geometry:r,symbol:this._symbol}),this.graphics.add(this._graphic)}hide(){y(this._graphic)&&(this.graphics.remove(this._graphic),this._graphic=null)}},Kp=class extends ue{constructor(e){super(e),this.handles=new Ft}destroy(){this.handles.destroy()}};h([p({constructOnly:!0})],Kp.prototype,"renderCoordsHelper",void 0),h([p({constructOnly:!0})],Kp.prototype,"surface",void 0),h([p({constructOnly:!0})],Kp.prototype,"state",void 0),Kp=h([D("esri.views.3d.support.PointOfInterest")],Kp);const jPe=Array;let No=class extends Kp{constructor(e){super(e),this._dirty=!1,this._propertiesPool=new Od({location:Ne,renderLocation:jPe},this),this._estimatedSurfaceAltitude=0,this._pendingElevationQueryController=null,this.cameraName="camera",this.renderLocation=R(),this._tmpPoint=new Ne}initialize(){if(this.scheduler&&this.handles.add(this.scheduler.registerTask(this.task,this)),this.runTask(),this.map){const e=()=>this._setDirty();this.handles.add(wr(()=>{var t,r;return(r=(t=this.map)==null?void 0:t.ground)==null?void 0:r.layers},"change",e,{onListenerAdd:e,onListenerRemove:e}))}this._updateRenderLocation()}destroy(){this._cancelPendingRequest(),this._propertiesPool.destroy(),this._propertiesPool=null}get _camera(){return this.state[this.cameraName]}get location(){const e=this._propertiesPool.get("location");return this.renderCoordsHelper.fromRenderCoords(this.renderLocation,e,this.state.spatialReference),e}get scale(){const e=this._camera,t=Ii(e.eye,this.renderLocation),r={renderCoordsHelper:this.renderCoordsHelper,state:{camera:e}};return Gg(r,t,0)}get updating(){return this._dirty||this._pendingElevationQueryController!=null}updateRenderLocation(){this._setDirty(),this._updateRenderLocation()}_setDirty(){this._dirty||(this._dirty=!0,this.notifyChange("updating"))}_cancelPendingRequest(){const e=this._pendingElevationQueryController;e&&(this._pendingElevationQueryController=null,e.abort(),this.notifyChange("updating"))}get running(){return!this._pendingElevationQueryController&&this._dirty}runTask(){if(this._cancelPendingRequest(),this._dirty=!1,this.notifyChange("updating"),!this.map||!this.map.ground)return void this._updateSurfaceAltitude(0);const e=this.state.spatialReference;this.renderCoordsHelper.fromRenderCoords(this._camera.eye,this._tmpPoint,e);const t=this._tmpPoint.z>qPe&&this.renderCoordsHelper.viewingMode===Se.Global&&(e.isWGS84||e.isWebMercator);let r=new AbortController;this.map.ground.queryElevation(this._tmpPoint,{signal:r.signal,cache:this.cache,minDemResolution:t?WPe:0}).then(n=>this._updateSurfaceAltitude(n.geometry.z)).catch(n=>{yo(n)||this._updateSurfaceAltitude(0)}).catch(()=>{}).then(()=>{this._pendingElevationQueryController===r&&(this._pendingElevationQueryController=null,this.notifyChange("updating")),r=null}),this._pendingElevationQueryController=r}_updateSurfaceAltitude(e){this._estimatedSurfaceAltitude!==e&&(this._estimatedSurfaceAltitude=e,this._updateRenderLocation())}_updateRenderLocation(){this.renderCoordsHelper.setAltitude(OM,this._estimatedSurfaceAltitude,this._camera.eye),Oc(this._get("renderLocation"),OM)||(this._set("renderLocation",q(this._propertiesPool.get("renderLocation"),OM)),this.notifyChange("renderLocation"))}};h([p({constructOnly:!0})],No.prototype,"scheduler",void 0),h([p({constructOnly:!0})],No.prototype,"cache",void 0),h([p({constructOnly:!0})],No.prototype,"task",void 0),h([p({constructOnly:!0})],No.prototype,"cameraName",void 0),h([p({readOnly:!0})],No.prototype,"location",null),h([p({constructOnly:!0})],No.prototype,"map",void 0),h([p({readOnly:!0})],No.prototype,"renderLocation",void 0),h([p({readOnly:!0})],No.prototype,"scale",null),h([p({readOnly:!0})],No.prototype,"updating",null),No=h([D("esri.views.3d.support.CameraOnSurface")],No);const OM=R(),qPe=1e5,WPe=1e6,XPe=Array;let to=class extends Kp{constructor(e){super(e),this._propertiesPool=new Od({location:Ne,renderLocation:XPe},this),this._currentSurfaceAltitude=0,this._latestSurfaceAltitude=0,this.cameraName="camera",this.distance=0,this.renderLocation=R(),this.updating=!1}initialize(){this._frameWorker=this.scheduler.registerTask(this.task,this),this.runTask()}destroy(){this._frameWorker=Os(this._frameWorker),this._propertiesPool=Te(this._propertiesPool)}get _camera(){return this.state[this.cameraName]}get location(){const e=this._propertiesPool.get("location");return this.renderCoordsHelper.fromRenderCoords(this.renderLocation,e,this.state.spatialReference),e}updateRenderLocation(){this.updating=!0,this._updateRenderLocation()}get estimatedSurfaceAltitude(){return this._latestSurfaceAltitude}get running(){return this.updating}runTask(){this._latestSurfaceAltitude=this.estimateSurfaceAltitudeAtCenter(),this._updateRenderLocation(),this.updating=!1}_updateRenderLocation(){const e=ZPe;let t=this._calculateSurfaceIntersection(this._currentSurfaceAltitude,e);const r=this._currentSurfaceAltitude!==this._latestSurfaceAltitude;!t&&r&&(t=this._calculateSurfaceIntersection(this._latestSurfaceAltitude,e),t&&(this._currentSurfaceAltitude=this._latestSurfaceAltitude));const n=YPe;t&&this._latestSurfaceAltitudeChangesDistanceSignificantly(e,n)&&(q(e,n),this._currentSurfaceAltitude=this._latestSurfaceAltitude),t?this.distance=Ii(this._camera.eye,e):(Q(e,this._camera.viewForward,this._get("distance")),oe(e,e,this._camera.eye)),Oc(this._get("renderLocation"),e)||this._set("renderLocation",q(this._propertiesPool.get("renderLocation"),e))}_calculateSurfaceIntersection(e,t){const r=this._camera;if(!this.renderCoordsHelper.intersectManifold(r.ray,e,t))return!1;if(this.state.isGlobal){const n=Yt(this.renderCoordsHelper.spatialReference).radius,s=n+e,a=Ml(r.eye),o=a<s*s,l=Ii(r.eye,t);if(o&&l>n/4){const c=s-Math.sqrt(a);return Q(t,r.viewForward,c),oe(t,t,r.eye),!0}}else{const n=this.surface.ready?this.surface.extent:null;y(n)&&bP(n,this.surface.spatialReference,S1,this.renderCoordsHelper.spatialReference)&&(t[0]=ce(t[0],S1[0],S1[2]),t[1]=ce(t[1],S1[1],S1[3]))}return!0}_latestSurfaceAltitudeChangesDistanceSignificantly(e,t){if(this._latestSurfaceAltitude===this._currentSurfaceAltitude||e==null)return!1;if(this._calculateSurfaceIntersection(this._latestSurfaceAltitude,t)){if(jt.TESTS_DISABLE_OPTIMIZATIONS)return!0;const r=this._camera.eye,n=Ii(r,e),s=Ii(r,t);if(Math.abs(s-n)/n>QPe)return!0}return!1}};h([p({constructOnly:!0})],to.prototype,"scheduler",void 0),h([p({constructOnly:!0})],to.prototype,"task",void 0),h([p({constructOnly:!0})],to.prototype,"cameraName",void 0),h([p()],to.prototype,"distance",void 0),h([p({constructOnly:!0})],to.prototype,"estimateSurfaceAltitudeAtCenter",void 0),h([p({readOnly:!0})],to.prototype,"location",null),h([p({readOnly:!0})],to.prototype,"renderLocation",void 0),h([p()],to.prototype,"updating",void 0),to=h([D("esri.views.3d.support.CenterOnSurface")],to);const QPe=.05,ZPe=R(),YPe=R(),S1=$t();let KPe=class{constructor(e){this._handles=new Ft,this.events=new nn,this._contentLayerViews=e.contentLayerViews,this._handles.add(this._contentLayerViews.on("change",t=>this._layerViewsChanged(t))),this._layerViewsChanged({added:this._contentLayerViews.toArray(),removed:[],moved:[],target:this._contentLayerViews})}destroy(){this._handles&&(this._handles.destroy(),this._handles=null)}_layerViewsChanged(e){e.added.forEach(t=>{t.declaredClass==="esri.views.3d.layers.SceneLayerView3D"&&this._handles.add(t.on("visible-geometry-changed",()=>this._contentChanged()),t.uid)}),e.removed.forEach(t=>this._handles.remove(t.uid))}_contentChanged(){this.events.emit("request-update",JPe)}};const JPe={},eRe=Array;let Th=class extends Kp{constructor(e){super(e),this._propertiesPool=new Od({location:Ne,renderLocation:eRe},this),this._dirty=!0,this.renderLocation=this._propertiesPool.get("renderLocation")}initialize(){this.handles.add([z(()=>this.centerOnSurface.renderLocation,()=>this.updateRenderLocation()),z(()=>this.state.contentCamera,()=>this.updateRenderLocation())]),this.scheduler&&this.handles.add(this.scheduler.registerTask(dr.POINT_OF_INTEREST_FREQUENT,this))}destroy(){this._propertiesPool.destroy(),this._propertiesPool=null}get updating(){return this._dirty||this.centerOnSurface.updating}get location(){const e=this._propertiesPool.get("location");return this.renderCoordsHelper.fromRenderCoords(this.renderLocation,e,this.state.spatialReference),e}get running(){return this._dirty}runTask(){const e=this._get("renderLocation"),t=this.centerOnSurface.renderLocation,r=this.renderCoordsHelper,n=this.state.contentCamera;this._dirty=!1,r.worldUpAtPosition(t,Cz);const s=Math.max(0,(Math.acos(me(Cz,n.viewForward))-.5*Math.PI)*(n.aboveGround?1:-1));if(Number.isNaN(s)){if(!e||!Rg(e,t)){const c=this._propertiesPool.get("renderLocation");q(c,t),this._set("renderLocation",c)}return}const a=1-ce(s/(.5*Math.PI),0,1),o=a*a*a;this._calculateScreenHorizontalEdgeOnSurface(Sz);const l=this._propertiesPool.get("renderLocation");Bn(l,t,Sz,o),e&&Rg(e,l)||this._set("renderLocation",l)}_calculateScreenHorizontalEdgeOnSurface(e){const t=this.state.contentCamera,r=t.getRenderCenter(is());if(r[1]=t.aboveGround?t.padding[Xe.BOTTOM]:t.fullHeight-t.padding[Xe.TOP],this.estimateSurfaceIntersectionAtRenderPoint(r,e))return e;const n=this.renderCoordsHelper.getAltitude(this.centerOnSurface.renderLocation);if(t.unprojectFromRenderScreen(r,E1)){ne(E1,E1,t.eye);const s=he(E1,E1);if(this.renderCoordsHelper.intersectManifold(zc(t.eye,s),n,e))return e}return this.renderCoordsHelper.setAltitude(e,n,t.eye)}updateRenderLocation(){this._dirty=!0}};h([p()],Th.prototype,"_dirty",void 0),h([p({constructOnly:!0})],Th.prototype,"scheduler",void 0),h([p({constructOnly:!0})],Th.prototype,"centerOnSurface",void 0),h([p({constructOnly:!0})],Th.prototype,"estimateSurfaceIntersectionAtRenderPoint",void 0),h([p({readOnly:!0})],Th.prototype,"updating",null),h([p({readOnly:!0})],Th.prototype,"location",null),h([p({readOnly:!0})],Th.prototype,"renderLocation",void 0),Th=h([D("esri.views.3d.support.pointsOfInterest.Focus")],Th);const Cz=R(),E1=R(),Sz=R();let zu=class extends ue{constructor(e){super(e),this.location=null,this._updateController=null,this._handles=new Ft}get surface(){var e;return(e=this.view.map)==null?void 0:e.ground}get surfaceView(){return this.view.basemapTerrain}get renderLocation(){if(!this.location)return null;const e=R();return this.view.renderCoordsHelper.toRenderCoords(this.location,e),e}initialize(){this.view.state.isLocal&&(this._handles.add([z(()=>{var e,t;return[(e=this.surfaceView)==null?void 0:e.spatialReference,(t=this.surfaceView)==null?void 0:t.extent]},()=>this._update()),wr(()=>{var e;return(e=this.surface)==null?void 0:e.layers},"change",()=>this._update())]),this._update())}destroy(){this._handles.destroy()}_update(){if(this._updateController&&(this._updateController.abort(),this._updateController=null),!this.surfaceView||S(this.surfaceView.extent)||S(this.surfaceView.spatialReference))return void this._set("location",null);const e=pD(this.surfaceView.extent),t=new Ne({x:e[0],y:e[1],z:0,spatialReference:this.surfaceView.spatialReference});this.surface&&this.surface.layers.length>0?(this._set("location",null),this._updateController=new AbortController,this.surface.queryElevation(t,{noDataValue:0,signal:this._updateController.signal,cache:this.cache}).then(r=>{this._updateController=null,this._set("location",r.geometry)}).catch(r=>{yo(r)||r&&r.name==="elevation-query:invalid-layer"||console.error("StableSurfaceCenter failed to update: ",r)})):this._set("location",t)}};h([p({constructOnly:!0})],zu.prototype,"view",void 0),h([p({constructOnly:!0})],zu.prototype,"cache",void 0),h([p()],zu.prototype,"surface",null),h([p()],zu.prototype,"surfaceView",null),h([p({readOnly:!0})],zu.prototype,"location",void 0),h([p({readOnly:!0})],zu.prototype,"renderLocation",null),zu=h([D("esri.views.3d.terrain.StableSurfaceCenter")],zu);let Bu=class extends ue{constructor(e){super(e),this._handles=new Ft,this._tileGeometryUpdateExtent=Uc(),this._tileGeometryUpdateSpatialReference=null,this.events=new nn,this.updating=!1}initialize(){this._handles.add([this.surface.on("elevation-change",e=>this._tileGeometryChanged(e)),this.scheduler.registerTask(dr.SURFACE_GEOMETRY_UPDATES,this)])}destroy(){this._handles=Te(this._handles)}get running(){return this.updating}runTask(){this.updating&&(this._centerIntersectsExtent(this._tileGeometryUpdateExtent,this._tileGeometryUpdateSpatialReference)&&this.events.emit("request-update",tRe),Uc(this._tileGeometryUpdateExtent),this._set("updating",!1))}_tileGeometryChanged(e){this._tileGeometryUpdateSpatialReference=ct(e.spatialReference),hm(this._tileGeometryUpdateExtent,e.extent,this._tileGeometryUpdateExtent),this._set("updating",!0)}_furthestCenterOnSurface(){let e=this.centerOnSurfaces[0];for(let t=1;t<this.centerOnSurfaces.length;t++){const r=this.centerOnSurfaces[t];r.distance>e.distance&&(e=r)}return e}_centerIntersectsExtent(e,t){const r=this.state.camera.eye,n=iRe,s=this._furthestCenterOnSurface();return this.renderCoordsHelper.fromRenderCoords(r,wf,t),this.renderCoordsHelper.fromRenderCoords(s.renderLocation,xf,t),wf[0]<xf[0]?(n[0]=wf[0],n[2]=xf[0]):(n[0]=xf[0],n[2]=wf[0]),wf[1]<xf[1]?(n[1]=wf[1],n[3]=xf[1]):(n[1]=xf[1],n[3]=wf[1]),EP(n,e)}};h([p({constructOnly:!0})],Bu.prototype,"state",void 0),h([p({constructOnly:!0})],Bu.prototype,"centerOnSurfaces",void 0),h([p({constructOnly:!0})],Bu.prototype,"renderCoordsHelper",void 0),h([p({constructOnly:!0})],Bu.prototype,"scheduler",void 0),h([p({constructOnly:!0})],Bu.prototype,"surface",void 0),h([p({readOnly:!0})],Bu.prototype,"updating",void 0),Bu=h([D("esri.views.3d.support.SurfaceGeometryUpdates")],Bu);const tRe={},wf=R(),xf=R(),iRe=Uc();let vs=class extends ue{constructor(e){super(e),this._handles=new Ft,this._tmpRay=oo(),this._centerRayDirty=!0,this._surfaceAltitudeAtCenter=0,this._surfaceAltitudeAtCenterDirty=!0,this._contentAltitudeAtCenter=0,this._contentAltitudeAtCenterDirty=!0,this._propertiesPool=new Od({renderPointOfView:rRe},this),this.renderPointOfView=R(),this._pois=new Array,this._debugCenters=new Map}initialize(){var u;const{state:e,basemapTerrain:t,renderCoordsHelper:r,map:n}=this.view;this._surfaceIntersector=Xl(e.viewingMode),e.isGlobal?this._surfaceIntersector.options.backfacesTerrain=!1:this._surfaceIntersector.options.backfacesTerrain=!0,this._surfaceIntersector.options.invisibleTerrain=!1,this._surfaceIntersector.options.store=zn.MIN,this._contentIntersector=Xl(e.viewingMode);const s=()=>this._estimateSurfaceAltitudeAtCenter(),a=this.view.resourceController.scheduler,o=ct((u=this.view.basemapTerrain)==null?void 0:u.elevationQueryCache),l={state:e,scheduler:a,surface:t,renderCoordsHelper:r};this._set("centerOnSurfaceInfrequent",new to({...l,task:dr.POINT_OF_INTEREST_INFREQUENT,estimateSurfaceAltitudeAtCenter:s})),this._set("centerOnSurfaceFrequent",new to({...l,task:dr.POINT_OF_INTEREST_FREQUENT,estimateSurfaceAltitudeAtCenter:s})),this._set("contentCenterOnSurface",new to({...l,task:dr.POINT_OF_INTEREST_INFREQUENT,estimateSurfaceAltitudeAtCenter:s,cameraName:"contentCamera"})),this._set("centerOnContent",new to({...l,task:dr.POINT_OF_INTEREST_FREQUENT,estimateSurfaceAltitudeAtCenter:()=>this._estimateContentAltitudeAtCenter()})),this._set("cameraOnSurface",new No({...l,cache:o,task:dr.POINT_OF_INTEREST_INFREQUENT,map:n})),this._set("contentCameraOnSurface",new No({...l,cache:o,task:dr.POINT_OF_INTEREST_INFREQUENT,map:n,cameraName:"contentCamera"})),this._set("surfaceGeometryUpdates",new Bu({...l,centerOnSurfaces:[this.centerOnSurfaceFrequent,this.centerOnContent,this.centerOnSurfaceInfrequent]})),this._set("contentGeometryUpdates",new KPe({contentLayerViews:this.view.allLayerViews,renderCoordsHelper:r})),this._set("surfaceOrigin",new zu({cache:o,view:this.view})),this._set("focus",new Th({state:e,scheduler:a,surface:t,renderCoordsHelper:r,centerOnSurface:this.contentCenterOnSurface,estimateSurfaceIntersectionAtRenderPoint:(d,m)=>this._estimateSurfaceIntersectionAtRenderPoint(d,this.view.state.contentCamera,m)})),this._pois.push(this.centerOnContent,this.centerOnSurfaceFrequent,this.centerOnSurfaceInfrequent,this.contentCenterOnSurface,this.cameraOnSurface,this.contentCameraOnSurface,this.focus);const c=this.view.graphics;this._debugCenters.set(this.centerOnContent,new $p(c,"red","CenterOnContent")),this._debugCenters.set(this.centerOnSurfaceFrequent,new $p(c,"red","CenterOnSurface")),this._debugCenters.set(this.centerOnSurfaceInfrequent,new $p(c,"red","CenterOnSurface")),this._debugCenters.set(this.contentCenterOnSurface,new $p(c,"red","ContentCenterOnSurface")),this._debugCenters.set(this.cameraOnSurface,new $p(c,"blue","CameraOnSurface")),this._debugCenters.set(this.contentCameraOnSurface,new $p(c,"blue","ContentCameraOnSurface")),this._debugCenters.set(this.focus,new $p(c,"green","Focus")),this._handles.add([z(()=>e.camera,d=>this._cameraChanged(d),ri),z(()=>t.extent,()=>this._updateCenterPointsOfInterest()),cs(()=>!t.updating,()=>this._updateCenterPointsOfInterest(),ri),wr(()=>this.surfaceGeometryUpdates.events,"request-update",()=>this._updateCenterPointsOfInterest()),wr(()=>this.contentGeometryUpdates.events,"request-update",()=>this._updateCenterOnContent()),cs(()=>jt.SHOW_POI,d=>this._setDebug(d),Qe)]),this._cameraChanged(this.view.state.camera);for(const d of this._pois)d.runTask()}destroy(){this._setDebug(!1),this._handles.destroy(),this._propertiesPool.destroy();for(const e of this._pois)e.destroy();this.surfaceOrigin.destroy()}get updating(){var e;return!(!((e=this.surfaceGeometryUpdates)!=null&&e.updating)&&!this._pois.some(t=>t.updating))}get _centerRay(){return this._centerRayDirty&&(this._centerRayCached=this.view.sceneIntersectionHelper.getCenterRayWithSubpixelOffset(this.view.state.camera,this._tmpRay),this._centerRayDirty=!1),this._centerRayCached}_estimateContentAltitudeAtCenter(){if(!this._contentAltitudeAtCenterDirty)return this._contentAltitudeAtCenter;this._contentAltitudeAtCenterDirty=!1;const e=this._centerRay;return S(e)||(this.view.sceneIntersectionHelper.intersectRay(e,this._contentIntersector,K_,sRe)?this._contentAltitudeAtCenter=this.view.renderCoordsHelper.getAltitude(K_):this._contentAltitudeAtCenter=this._estimateSurfaceAltitudeAtCenter()),this._contentAltitudeAtCenter}_estimateSurfaceAltitudeAtCenter(){if(!this.view.basemapTerrain)return 0;if(!this._surfaceAltitudeAtCenterDirty)return this._surfaceAltitudeAtCenter;this._surfaceAltitudeAtCenterDirty=!1;const e=this._centerRay;if(S(e))return this._surfaceAltitudeAtCenter;const t=e.origin,r=oe(K_,e.origin,e.direction);return this._surfaceIntersector.resetWithRay(e,this.view.state.camera),this.view.basemapTerrain.intersect(this._surfaceIntersector,null,t,r),this._surfaceIntersector.results.min.getIntersectionPoint(K_)&&(this._surfaceAltitudeAtCenter=this.view.renderCoordsHelper.getAltitude(K_)),this._surfaceAltitudeAtCenter}_estimateSurfaceIntersectionAtRenderPoint(e,t,r){const n=WN(t,e,nRe);if(S(n))return null;const s=n.origin,a=oe(K_,n.origin,n.direction);return this._surfaceIntersector.resetWithRay(n,t),this.view.basemapTerrain.intersect(this._surfaceIntersector,null,s,a),this._surfaceIntersector.results.min.getIntersectionPoint(r)?r:null}_cameraChanged(e){this._updateCenterPointsOfInterest();const t=e.eye;Oc(this.renderPointOfView,t)||this._set("renderPointOfView",q(this._propertiesPool.get("renderPointOfView"),t))}_updateCenterPointsOfInterest(){this._centerRayDirty=!0,this._surfaceAltitudeAtCenterDirty=!0,this._contentAltitudeAtCenterDirty=!0;for(const e of this._pois)e.updateRenderLocation()}_updateCenterOnContent(){this._contentAltitudeAtCenterDirty=!0,this.centerOnContent.updateRenderLocation()}_setDebug(e){if(!e)return this._debugCenters.forEach(t=>t.hide()),void this._handles.remove("debug");for(const t of this._pois)this._handles.add(z(()=>t.renderLocation,r=>this._debugCenters.get(t).show(r,t.renderCoordsHelper.spatialReference),Qe),"debug")}get test(){return{update:()=>{this.surfaceGeometryUpdates.runTask();for(const e of this._pois)e.runTask()},surfaceGeometryUpdates:this.surfaceGeometryUpdates}}};h([p({readOnly:!0})],vs.prototype,"centerOnContent",void 0),h([p({readOnly:!0})],vs.prototype,"centerOnSurfaceFrequent",void 0),h([p({readOnly:!0})],vs.prototype,"centerOnSurfaceInfrequent",void 0),h([p({readOnly:!0})],vs.prototype,"contentCenterOnSurface",void 0),h([p({readOnly:!0})],vs.prototype,"cameraOnSurface",void 0),h([p({readOnly:!0})],vs.prototype,"contentCameraOnSurface",void 0),h([p({readOnly:!0})],vs.prototype,"focus",void 0),h([p({readOnly:!0})],vs.prototype,"renderPointOfView",void 0),h([p({readOnly:!0})],vs.prototype,"surfaceOrigin",void 0),h([p({readOnly:!0})],vs.prototype,"contentGeometryUpdates",void 0),h([p({readOnly:!0})],vs.prototype,"surfaceGeometryUpdates",void 0),h([p({constructOnly:!0})],vs.prototype,"view",void 0),h([p({readOnly:!0})],vs.prototype,"updating",null),vs=h([D("esri.views.3d.support.PointsOfInterest")],vs);const rRe=Array,K_=R(),nRe=oo(),sRe={exclude:new Set([Ac])};let aRe=class{constructor(e){this._store=e}destroy(){this._store.destroy()}get(e){return this._store.get(e)}put(e,t){this._store.put(e,t,t.values.byteLength+256)}},oRe=class{constructor(e){this.xTile=0,this.yTile=0,this.hash=0,this.priority=1,this.colliders=[],this.textVertexRanges=[],this.iconVertexRanges=[],this.tile=e}},tBe=class{constructor(){this.tileSymbols=[],this.parts=[{startTime:0,startOpacity:0,targetOpacity:0,show:!1},{startTime:0,startOpacity:0,targetOpacity:0,show:!1}],this.show=!1}};function rBe(i,e,t,r,n,s){const a=t-n;if(a>=0)return(e>>a)+(r-(s<<a))*(i>>a);const o=-a;return e-(s-(r<<o))*(i>>o)<<o}let nBe=class{constructor(e,t,r){this._rows=Math.ceil(t/r),this._columns=Math.ceil(e/r),this._cellSize=r,this.cells=new Array(this._rows);for(let n=0;n<this._rows;n++){this.cells[n]=new Array(this._columns);for(let s=0;s<this._columns;s++)this.cells[n][s]=[]}}getCell(e,t){const r=Math.min(Math.max(Math.floor(t/this._cellSize),0),this._rows-1),n=Math.min(Math.max(Math.floor(e/this._cellSize),0),this._columns-1);return this.cells[r]&&this.cells[r][n]||null}getCellSpan(e,t,r,n){return[Math.min(Math.max(Math.floor(e/this._cellSize),0),this.columns-1),Math.min(Math.max(Math.floor(t/this._cellSize),0),this.rows-1),Math.min(Math.max(Math.floor(r/this._cellSize),0),this.columns-1),Math.min(Math.max(Math.floor(n/this._cellSize),0),this.rows-1)]}get cellSize(){return this._cellSize}get columns(){return this._columns}get rows(){return this._rows}};function lRe(i,e,t,r,n,s){const a=e[r++];for(let o=0;o<a;o++){const l=new oRe(s);l.xTile=e[r++],l.yTile=e[r++],l.hash=e[r++],l.priority=e[r++];const c=e[r++];for(let m=0;m<c;m++){const f=e[r++],_=e[r++],g=e[r++],x=e[r++],b=!!e[r++],v=e[r++],w=t[r++],T=t[r++],E=e[r++],C=e[r++];l.colliders.push({xTile:f,yTile:_,dxPixels:g,dyPixels:x,hard:b,partIndex:v,width:E,height:C,minLod:w,maxLod:T})}const u=i[r++];for(let m=0;m<u;m++)l.textVertexRanges.push([i[r++],i[r++]]);const d=i[r++];for(let m=0;m<d;m++)l.iconVertexRanges.push([i[r++],i[r++]]);n.push(l)}return r}function aBe(i,e,t){for(const[r,n]of i.symbols)cRe(i,e,t,n,r)}function cRe(i,e,t,r,n){const s=i.layerData.get(n);if(s.type===xl.SYMBOL){for(const a of r){const o=a.unique;let l;if(a.selectedForRendering){const c=o.parts[0],u=c.startOpacity,d=c.targetOpacity;i.allSymbolsFadingOut=i.allSymbolsFadingOut&&d===0;const m=t?Math.floor(127*u)|d<<7:d?255:0;l=m<<24|m<<16|m<<8|m}else l=0;for(const[c,u]of a.iconVertexRanges)for(let d=c;d<c+u;d+=4)s.iconOpacity[d/4]=l;if(a.selectedForRendering){const c=o.parts[1],u=c.startOpacity,d=c.targetOpacity;i.allSymbolsFadingOut=i.allSymbolsFadingOut&&d===0;const m=t?Math.floor(127*u)|d<<7:d?255:0;l=m<<24|m<<16|m<<8|m}else l=0;for(const[c,u]of a.textVertexRanges)for(let d=c;d<c+u;d+=4)s.textOpacity[d/4]=l}s.lastOpacityUpdate=e,s.opacityChanged=!0}}let VR=class{constructor(e,t){this.layerUIDs=[],this.isDestroyed=!1,this._data=e,this.memoryUsed=e.byteLength;let r=1;const n=new Uint32Array(e);this.layerUIDs=[];const s=n[r++];for(let a=0;a<s;a++)this.layerUIDs[a]=n[r++];this.bufferDataOffset=r,t&&(this.layer=t.getStyleLayerByUID(this.layerUIDs[0]))}get isPreparedForRendering(){return S(this._data)}get offset(){return this.bufferDataOffset}destroy(){this.isDestroyed||(this.doDestroy(),this.isDestroyed=!0)}prepareForRendering(e){S(this._data)||(this.doPrepareForRendering(e,this._data,this.bufferDataOffset),this._data=null)}},hRe=class extends VR{constructor(e,t){super(e,t),this.type=xl.LINE,this.lineIndexStart=0,this.lineIndexCount=0;const r=new Uint32Array(e);let n=this.bufferDataOffset;this.lineIndexStart=r[n++],this.lineIndexCount=r[n++];const s=r[n++];if(s>0){const a=new Map;for(let o=0;o<s;o++){const l=r[n++],c=r[n++],u=r[n++];a.set(l,[c,u])}this.patternMap=a}this.bufferDataOffset=n}hasData(){return this.lineIndexCount>0}triangleCount(){return this.lineIndexCount/3}doDestroy(){y(this.lineVertexArrayObject)&&this.lineVertexArrayObject.dispose(),y(this.lineVertexBuffer)&&this.lineVertexBuffer.dispose(),y(this.lineIndexBuffer)&&this.lineIndexBuffer.dispose(),this.lineVertexArrayObject=null,this.lineVertexBuffer=null,this.lineIndexBuffer=null,this.memoryUsed=0}doPrepareForRendering(e,t,r){const n=new Uint32Array(t),s=new Int32Array(n.buffer),a=n[r++];this.lineVertexBuffer=hi.createVertex(e,di.STATIC_DRAW,new Int32Array(s.buffer,4*r,a)),r+=a;const o=n[r++];this.lineIndexBuffer=hi.createIndex(e,di.STATIC_DRAW,new Uint32Array(n.buffer,4*r,o)),r+=o;const l=this.layer.lineMaterial;this.lineVertexArrayObject=new Gc(e,l.getAttributeLocations(),l.getLayoutInfo(),{geometry:this.lineVertexBuffer},this.lineIndexBuffer)}},uRe=class extends VR{constructor(e,t){super(e,t),this.type=xl.FILL,this.fillIndexStart=0,this.fillIndexCount=0,this.outlineIndexStart=0,this.outlineIndexCount=0;const r=new Uint32Array(e);let n=this.bufferDataOffset;this.fillIndexStart=r[n++],this.fillIndexCount=r[n++],this.outlineIndexStart=r[n++],this.outlineIndexCount=r[n++];const s=r[n++];if(s>0){const a=new Map;for(let o=0;o<s;o++){const l=r[n++],c=r[n++],u=r[n++];a.set(l,[c,u])}this.patternMap=a}this.bufferDataOffset=n}hasData(){return this.fillIndexCount>0||this.outlineIndexCount>0}triangleCount(){return(this.fillIndexCount+this.outlineIndexCount)/3}doDestroy(){y(this.fillVertexArrayObject)&&this.fillVertexArrayObject.dispose(),y(this.fillVertexBuffer)&&this.fillVertexBuffer.dispose(),y(this.fillIndexBuffer)&&this.fillIndexBuffer.dispose(),this.fillVertexArrayObject=null,this.fillVertexBuffer=null,this.fillIndexBuffer=null,y(this.outlineVertexArrayObject)&&this.outlineVertexArrayObject.dispose(),y(this.outlineVertexBuffer)&&this.outlineVertexBuffer.dispose(),y(this.outlineIndexBuffer)&&this.outlineIndexBuffer.dispose(),this.outlineVertexArrayObject=null,this.outlineVertexBuffer=null,this.outlineIndexBuffer=null,this.memoryUsed=0}doPrepareForRendering(e,t,r){const n=new Uint32Array(t),s=new Int32Array(n.buffer),a=n[r++];this.fillVertexBuffer=hi.createVertex(e,di.STATIC_DRAW,new Int32Array(s.buffer,4*r,a)),r+=a;const o=n[r++];this.fillIndexBuffer=hi.createIndex(e,di.STATIC_DRAW,new Uint32Array(n.buffer,4*r,o)),r+=o;const l=n[r++];this.outlineVertexBuffer=hi.createVertex(e,di.STATIC_DRAW,new Int32Array(s.buffer,4*r,l)),r+=l;const c=n[r++];this.outlineIndexBuffer=hi.createIndex(e,di.STATIC_DRAW,new Uint32Array(n.buffer,4*r,c)),r+=c;const u=this.layer,d=u.fillMaterial,m=u.outlineMaterial;this.fillVertexArrayObject=new Gc(e,d.getAttributeLocations(),d.getLayoutInfo(),{geometry:this.fillVertexBuffer},this.fillIndexBuffer),this.outlineVertexArrayObject=new Gc(e,m.getAttributeLocations(),m.getLayoutInfo(),{geometry:this.outlineVertexBuffer},this.outlineIndexBuffer)}},dRe=class extends VR{constructor(e,t,r){super(e,t),this.type=xl.SYMBOL,this.iconPerPageElementsMap=new Map,this.glyphPerPageElementsMap=new Map,this.symbolInstances=[],this.isIconSDF=!1,this.opacityChanged=!1,this.lastOpacityUpdate=0,this.symbols=[];const n=new Uint32Array(e),s=new Int32Array(e),a=new Float32Array(e);let o=this.bufferDataOffset;this.isIconSDF=!!n[o++];const l=n[o++];for(let m=0;m<l;m++){const f=n[o++],_=n[o++],g=n[o++];this.iconPerPageElementsMap.set(f,[_,g])}const c=n[o++];for(let m=0;m<c;m++){const f=n[o++],_=n[o++],g=n[o++];this.glyphPerPageElementsMap.set(f,[_,g])}const u=n[o++],d=n[o++];this.iconOpacity=new Int32Array(u),this.textOpacity=new Int32Array(d),o=lRe(n,s,a,o,this.symbols,r),this.bufferDataOffset=o}hasData(){return this.iconPerPageElementsMap.size>0||this.glyphPerPageElementsMap.size>0}triangleCount(){let e=0;for(const[t,r]of this.iconPerPageElementsMap)e+=r[1];for(const[t,r]of this.glyphPerPageElementsMap)e+=r[1];return e/3}doDestroy(){y(this.iconVertexArrayObject)&&this.iconVertexArrayObject.dispose(),y(this.iconVertexBuffer)&&this.iconVertexBuffer.dispose(),y(this.iconOpacityBuffer)&&this.iconOpacityBuffer.dispose(),y(this.iconIndexBuffer)&&this.iconIndexBuffer.dispose(),this.iconVertexArrayObject=null,this.iconVertexBuffer=null,this.iconOpacityBuffer=null,this.iconIndexBuffer=null,y(this.textVertexArrayObject)&&this.textVertexArrayObject.dispose(),y(this.textVertexBuffer)&&this.textVertexBuffer.dispose(),y(this.textOpacityBuffer)&&this.textOpacityBuffer.dispose(),y(this.textIndexBuffer)&&this.textIndexBuffer.dispose(),this.textVertexArrayObject=null,this.textVertexBuffer=null,this.textOpacityBuffer=null,this.textIndexBuffer=null,this.memoryUsed=0}updateOpacityInfo(){if(!this.opacityChanged)return;this.opacityChanged=!1;const e=ct(this.iconOpacity),t=ct(this.iconOpacityBuffer);e.length>0&&e.byteLength===t.size&&t.setSubData(e,0,0,e.length);const r=ct(this.textOpacity),n=ct(this.textOpacityBuffer);r.length>0&&r.byteLength===n.size&&n.setSubData(r,0,0,r.length)}doPrepareForRendering(e,t,r){const n=new Uint32Array(t),s=new Int32Array(n.buffer),a=n[r++];this.iconVertexBuffer=hi.createVertex(e,di.STATIC_DRAW,new Int32Array(s.buffer,4*r,a)),r+=a;const o=n[r++];this.iconIndexBuffer=hi.createIndex(e,di.STATIC_DRAW,new Uint32Array(n.buffer,4*r,o)),r+=o;const l=n[r++];this.textVertexBuffer=hi.createVertex(e,di.STATIC_DRAW,new Int32Array(s.buffer,4*r,l)),r+=l;const c=n[r++];this.textIndexBuffer=hi.createIndex(e,di.STATIC_DRAW,new Uint32Array(n.buffer,4*r,c)),r+=c,this.iconOpacityBuffer=hi.createVertex(e,di.STATIC_DRAW,ct(this.iconOpacity).buffer),this.textOpacityBuffer=hi.createVertex(e,di.STATIC_DRAW,ct(this.textOpacity).buffer);const u=this.layer,d=u.iconMaterial,m=u.textMaterial;this.iconVertexArrayObject=new Gc(e,d.getAttributeLocations(),d.getLayoutInfo(),{geometry:this.iconVertexBuffer,opacity:this.iconOpacityBuffer},this.iconIndexBuffer),this.textVertexArrayObject=new Gc(e,m.getAttributeLocations(),m.getLayoutInfo(),{geometry:this.textVertexBuffer,opacity:this.textOpacityBuffer},this.textIndexBuffer)}},pRe=class extends VR{constructor(e,t){super(e,t),this.type=xl.CIRCLE,this.circleIndexStart=0,this.circleIndexCount=0;const r=new Uint32Array(e);let n=this.bufferDataOffset;this.circleIndexStart=r[n++],this.circleIndexCount=r[n++],this.bufferDataOffset=n}hasData(){return this.circleIndexCount>0}triangleCount(){return this.circleIndexCount/3}doDestroy(){y(this.circleVertexArrayObject)&&this.circleVertexArrayObject.dispose(),y(this.circleVertexBuffer)&&this.circleVertexBuffer.dispose(),y(this.circleIndexBuffer)&&this.circleIndexBuffer.dispose(),this.circleVertexArrayObject=null,this.circleVertexBuffer=null,this.circleIndexBuffer=null,this.memoryUsed=0}doPrepareForRendering(e,t,r){const n=new Uint32Array(t),s=new Int32Array(n.buffer),a=n[r++];this.circleVertexBuffer=hi.createVertex(e,di.STATIC_DRAW,new Int32Array(s.buffer,4*r,a)),r+=a;const o=n[r++];this.circleIndexBuffer=hi.createIndex(e,di.STATIC_DRAW,new Uint32Array(n.buffer,4*r,o)),r+=o;const l=this.layer.circleMaterial;this.circleVertexArrayObject=new Gc(e,l.getAttributeLocations(),l.getLayoutInfo(),{geometry:this.circleVertexBuffer},this.circleIndexBuffer)}},MM=class IK extends hae{constructor(e,t,r,n,s,a,o,l=null){super(e,t,r,n,s,a,4096,4096),this._memCache=l,this.type="vector-tile",this._referenced=0,this._hasSymbolBuckets=!1,this._memoryUsedByLayerData=0,this.layerData=new Map,this.layerCount=0,this.status="loading",this.allSymbolsFadingOut=!1,this.lastOpacityUpdate=0,this.symbols=new Map,this.isCoverage=!1,this.neededForCoverage=!1,this.decluttered=!1,this.invalidating=!1,this.parentTile=null,this.childrenTiles=new Set,this._processed=!1,this._referenced=1,this.styleRepository=o,this.id=e.id}get hasSymbolBuckets(){return this._hasSymbolBuckets}get isFading(){return this._hasSymbolBuckets&&performance.now()-this.lastOpacityUpdate<tk}get isHoldingForFade(){return this._hasSymbolBuckets&&(!this.allSymbolsFadingOut||performance.now()-this.lastOpacityUpdate<tk)}get wasRequested(){return this.status==="errored"||this.status==="loaded"||this.status==="reloading"}setData(e){this.changeDataImpl(e),this.requestRender(),this.ready(),this.invalidating=!1,this._processed=!0}deleteLayerData(e){let t=!1;for(const r of e)if(this.layerData.has(r)){const n=this.layerData.get(r);this._memoryUsedByLayerData-=n.memoryUsed,n.type===xl.SYMBOL&&this.symbols.has(r)&&(this.symbols.delete(r),t=!0),n.destroy(),this.layerData.delete(r),this.layerCount--}y(this._memCache)&&this._memCache.updateSize(this.key.id,this,this._memoryUsedByLayerData),t&&this.emit("symbols-changed"),this.requestRender()}processed(){return this._processed}hasData(){return this.layerCount>0}dispose(){this.status!=="unloaded"&&(LK.delete(this),IK._destroyRenderBuckets(this.layerData),this.layerData=null,this.layerCount=0,this._memoryUsedByLayerData=0,this.destroy(),this.status="unloaded")}release(){return--this._referenced==0&&(this.dispose(),this.stage=null,!0)}retain(){++this._referenced}get referenced(){return this._referenced}get memoryUsage(){return(this._memoryUsedByLayerData+256)/(this._referenced||1)}changeDataImpl(e){let t=!1;if(e){const{bucketsWithData:r,emptyBuckets:n}=e,s=this._createRenderBuckets(r);if(n&&n.byteLength>0){const a=new Uint32Array(n);for(const o of a)this._deleteLayerData(o)}for(const[a,o]of s)this._deleteLayerData(a),o.type===xl.SYMBOL&&(this.symbols.set(a,o.symbols),t=!0),this._memoryUsedByLayerData+=o.memoryUsed,this.layerData.set(a,o),this.layerCount++;y(this._memCache)&&this._memCache.updateSize(this.key.id,this,this._memoryUsedByLayerData)}this._hasSymbolBuckets=!1;for(const[r,n]of this.layerData)n.type===xl.SYMBOL&&(this._hasSymbolBuckets=!0);t&&this.emit("symbols-changed")}attachWithContext(e){this.stage={context:e,trashDisplayObject(t){t.processDetach()},untrashDisplayObject:()=>!1}}setTransform(e){super.setTransform(e);const t=this.resolution/(e.resolution*e.pixelRatio),r=this.width/this.rangeX*t,n=this.height/this.rangeY*t,s=[0,0];e.toScreen(s,[this.x,this.y]);const a=this.transforms.tileUnitsToPixels;W7(a),yI(a,a,s),X7(a,a,Math.PI*e.rotation/180),Z7(a,a,[r,n,1])}_createTransforms(){return{dvs:cm(),tileMat3:cm(),tileUnitsToPixels:cm()}}static _destroyRenderBuckets(e){if(!e)return;const t=new Set;e.forEach(r=>{t.has(r)||(r.destroy(),t.add(r))}),e.clear()}_createRenderBuckets(e){const t=new Map,r=new Map;for(const n of e){const s=this._deserializeBucket(n,r);for(const a of s.layerUIDs)t.set(a,s)}return t}_deserializeBucket(e,t){let r=t.get(e);if(r)return r;switch(new Uint32Array(e)[0]){case xl.FILL:r=new uRe(e,this.styleRepository);break;case xl.LINE:r=new hRe(e,this.styleRepository);break;case xl.SYMBOL:r=new dRe(e,this.styleRepository,this);break;case xl.CIRCLE:r=new pRe(e,this.styleRepository)}return t.set(e,r),r}_deleteLayerData(e){if(!this.layerData.has(e))return;const t=this.layerData.get(e);this._memoryUsedByLayerData-=t.memoryUsed,t.destroy(),this.layerData.delete(e),this.layerCount--}};const LK=new Map;function mRe(){LK.forEach((i,e)=>{console.log(`
${e.key}:`),i[0].forEach(t=>console.log(t)),console.log("========"),i[1].forEach(t=>console.log(t))})}const dBe={value:.5,readOnly:!0},fRe={readOnly:!0,value:.5,get(){return this.updating?this.updatingProgressValue:1}};let v0=class{constructor(e=0,t=0){this.min=e,this.max=t,this.level=0,this.hasNoDataValues=!1}copyFrom(e){this.min=e.min,this.max=e.max,this.level=e.level,this.hasNoDataValues=e.hasNoDataValues}},gRe=class{constructor(e,t,r){this.type="elevation",this.level=e[0],this.i=e[1],this.j=e[2],this.extent=t;const n=r.noDataValue,s=r.values;let a=1/0,o=-1/0,l=!0,c=!1;for(let u=0;u<s.length;u++){const d=s[u];d!==n?(a=d<a?d:a,o=d>o?d:o,l=!1):c=!0}l&&(a=0,o=0),o=o>-3e38?o:0,this.samplerData=new Are(r,t),this.bounds=[a,o],this.hasNoDataValues=c}release(){this.samplerData=null,this.bounds=null}computeMinMaxValue(e,t,r,n){n.min=1/0,n.max=-1/0,n.hasNoDataValues=!1;const s=e-this.level;if(s<=0)return n;const a=2**s;if(!(Math.floor(t/a)===this.i&&Math.floor(r/a)===this.j))return n;let o=1/0,l=-1/0;const c=this.samplerData.width,u=this.samplerData.pixelData,d=.5*tx;let m=(c-1)/a,f=(r-this.j*a)*m,_=(t-this.i*a)*m;if(m<1){const g=Math.floor(f),x=Math.floor(_),b=g+x*c,v=u[b],w=u[b+1],T=u[b+c],E=u[b+c+1];if(v+w+T+E<d){const C=f-g,A=_-x,M=BT(v,w,T,E,C,A),I=BT(v,w,T,E,C+m,A),L=BT(v,w,T,E,C,A+m),U=BT(v,w,T,E,C+m,A+m);return n.min=Math.min(M,I,L,U),n.max=Math.max(M,I,L,U),n}f=g,_=x,m=1}else f=Math.floor(f),_=Math.floor(_),m=Math.ceil(m);for(let g=f;g<=f+m;g++)for(let x=_;x<=_+m;x++){const b=u[g+x*c];b<d?(o=Math.min(o,b),l=Math.max(l,b)):n.hasNoDataValues=!0}return n.min=o,n.max=l,n}};const _Re=.5*tx;function Si(i,e,t){if(S(t))return null;for(const r of t){if(!r)continue;const n=r.safeWidth;let s=ce(r.dy*(r.y1-e),0,n),a=ce(r.dx*(i-r.x0),0,n);const o=Math.floor(s),l=Math.floor(a),c=r.width,u=o*c+l,d=r.pixelData,m=d[u],f=d[u+1],_=u+c,g=d[_],x=d[_+1];if(m+g+f+x<_Re){s-=o,a-=l;const b=m+(f-m)*a;return b+(g+(x-g)*a-b)*s}}return null}let vl=class extends ue{constructor(e){super(e),this._handles=new Ft}initialize(){this._handles.add([this.layerViews.on("change",()=>this.notifyChange("stencilEnabledExtents"))])}destroy(){this._handles.destroy(),this._handles=null}get layerViewsExtent(){return this._computeLayerViewsExtent()}get tiledLayersExtent(){return this._computeTiledLayersExtent()}get stencilEnabledExtents(){return this._computeStencilEnabledExtents()}_computeStencilEnabledExtents(){const e=[];return this.layerViews.forEach(t=>{const r=t.layer;if(r.operationalLayerType==="IntegratedMeshLayer"&&this.viewSpatialReference!=null){const n=$K(r.fullExtent,this.viewSpatialReference);y(n)&&e.push(_w(n))}}),e}};function yRe(i,e){return i===Se.Global?new y$(e):new v$(e)}h([p({readOnly:!0})],vl.prototype,"layerViewsExtent",null),h([p({readOnly:!0})],vl.prototype,"tiledLayersExtent",null),h([p({readOnly:!0})],vl.prototype,"stencilEnabledExtents",null),h([p()],vl.prototype,"viewSpatialReference",void 0),h([p()],vl.prototype,"tilingScheme",void 0),h([p()],vl.prototype,"defaultTiledLayersExtent",void 0),h([p({constructOnly:!0})],vl.prototype,"layers",void 0),h([p({constructOnly:!0})],vl.prototype,"layerViews",void 0),vl=h([D("esri.views.3d.terrain.ExtentHelper")],vl);let y$=class extends vl{_computeLayerViewsExtent(){return this._globalExtent}_computeTiledLayersExtent(){return this._globalExtent}get _globalExtent(){return this.viewSpatialReference.isWebMercator?cQ:D_e}};y$=h([D("esri.views.3d.terrain.ExtentHelperGlobal")],y$);let v$=class extends vl{_computeLayerViewsExtent(){const e=Uc(),t=this.viewSpatialReference;this.layerViews.forEach(s=>{const a=s.layer;if(s.isResolved()&&(a.type!=="graphics"||!a.internal)){const o=$K("fullExtentInLocalViewSpatialReference"in s&&s.fullExtentInLocalViewSpatialReference||s.layer.fullExtent,t);hm(e,o,e)}});const r=vI(e)?e:null,n=this._get("layerViewsExtent");return mg(r,n)?n:r}_computeTiledLayersExtent(){const e=this.tilingScheme;if(!e)return null;const t=this.viewSpatialReference,r=Uc();this.layers.forEach(a=>{if(a.loaded&&Ib(a)){const o=kR(a,t,Se.Local);if(S(o))return;const{tileInfo:l,fullExtent:c}=o;y(l)&&y(c)&&(hP(a)||e.compatibleWith(l)&&c.spatialReference.equals(e.spatialReference))&&hm(r,c,r)}}),hm(r,this.defaultTiledLayersExtent,r);const n=vI(r)?r:null,s=this._get("tiledLayersExtent");return mg(n,s)?s:n}};function $K(i,e){return y(i)&&!i.spatialReference.equals(e)?mte(i,i.spatialReference,e):i}v$=h([D("esri.views.3d.terrain.ExtentHelperLocal")],v$);var ut;(function(i){i[i.ELEVATION=0]="ELEVATION",i[i.MAP=1]="MAP"})(ut||(ut={}));const Bf=[ut.ELEVATION,ut.MAP];function DK(){var e;const i=(e=globalThis.require)==null?void 0:e.modules;if(i){const t=Object.keys(i);for(const r of t)r.search(".glsl")!==-1&&delete i[r]}}const vRe=[[-.1,-2,3.9,2],[-.1,-3.9,3.9,.1],[-2,-3.9,2,.1],[-3.9,-3.9,.1,.1],[-3.9,-2,.1,2],[-3.9,-.1,.1,3.9],[-2,-.1,2,3.9],[-.1,-.1,3.9,3.9]];let fp,fa=class extends ue{constructor(e){super(e),this._handles=new Ft,this._spatialReference=null,this._renderSR=null,this._overlaySREqualsRenderSR=!0,this._drapeSources=new Set,this._drapeTargets=new Set,this._placementDirty=!1,this._contentUpdated=!1,this._drawTexturesDirty=!1,this._drawTexturesAnimateDirty=!1,this._hasUnusedRenderTargets=!1,this._longitudeCyclical=null,this._latestOriginId=0,this._maxResolution=St("esri-mobile")?2048:4096,this._animationTimeLast=0}get running(){return this._placementDirty&&(this._drapeSources.size>0||this._view.graphics.length>0||jt.OVERLAY_DRAW_DEBUG_TEXTURE)&&!!this._spatialReference&&!this.suspended&&this.surface.ready}get _isSpherical(){return this._view.state.isGlobal}get _worldToPCSRatio(){return y(this._spatialReference)&&this._spatialReference.isGeographic&&!this._view.state.isLocal?Yt(this._spatialReference).metersPerDegree:1}get _view(){return this.surface.view}get suspended(){return this.surface.suspended}get updating(){return this.running||this.renderer.updating||this._contentUpdated}get hasHighlights(){return this.renderer.hasHighlights}get rendersOccluded(){return this.renderer.rendersOccluded}initialize(){var t;const e=this._view;this.renderer=new wh({view:e,worldToPCSRatio:this._worldToPCSRatio,spatialReference:this._spatialReference}),this._groundIntersector=Xl(this._view.state.viewingMode),this._groundIntersector.options.backfacesTerrain=!0,this._groundIntersector.options.invisibleTerrain=!0,this._groundIntersector.options.hud=!1,this._handles.add([this.renderer.events.on("has-highlights",()=>{this.setDrawTexturesDirty(),this.notifyChange("hasHighlights")}),this.renderer.events.on("has-water",r=>{var n;return(n=e._stage)==null?void 0:n.renderView.setRenderParameters({hasOverlayWater:r})}),this.renderer.events.on("renders-occluded",()=>{this.setDrawTexturesDirty(),this.notifyChange("rendersOccluded")}),this.renderer.events.on("content-changed",()=>this.setDrawTexturesDirty()),this.renderer.events.on("textures-disposed",()=>this.updateOverlayResult()),z(()=>{var r,n,s;return[(r=e.pointsOfInterest)==null?void 0:r.renderPointOfView,(s=(n=e.pointsOfInterest)==null?void 0:n.centerOnSurfaceFrequent)==null?void 0:s.location]},()=>this.setPlacementDirty()),z(()=>{var r;return(r=e.state)==null?void 0:r.pixelRatio},()=>this.setPlacementDirty(),ri),this.surface.on("elevation-change",()=>this.setPlacementDirty()),e.on("resize",()=>this.setPlacementDirty()),e.resourceController.scheduler.registerTask(dr.OVERLAY,this),e._stage.renderView.events.on("force-camera-for-screenshot",r=>{this._updateOverlays(r,vr.BACKGROUND),this.renderer.hasOverlays&&this._drawOverlayTextures(this.renderer.overlays,vr.BACKGROUND,r)})]),(t=e._stage)==null||t.renderView.setRenderParameters({renderOverlay:r=>{this._contentUpdated=!1,this.renderer.processSyncDrapeSources(),this.renderer.hasOverlays&&(this._dispatchAnimationUpdate(r),this._drawOverlayTextures(this.renderer.overlays,vr.UPDATE)),this._hasUnusedRenderTargets&&this._collectUnusedRenderTargetMemory()}})}destroy(){this.renderer.dispose(),this._handles&&(this._handles.destroy(),this._handles=null),y(fp)&&(fp.hide(),fp=null)}get hasOverlays(){return this.renderer.hasOverlays}setSpatialReference(e){this._spatialReference=e,this.renderer.spatialReference=e,this._longitudeCyclical=null;const t=this._view.renderSpatialReference;y(e)&&y(t)?(this._renderSR=t,this._overlaySREqualsRenderSR=e.equals(this._renderSR),this._isSpherical&&(this._longitudeCyclical=e.isWebMercator?new dw(-20037508342787e-6,20037508342787e-6):new dw(-180,180),this.renderer.longitudeCyclical=this._longitudeCyclical),this.renderer&&(this.renderer.worldToPCSRatio=this._worldToPCSRatio)):this.renderer.disposeOverlays()}get gpuMemoryUsage(){return this.renderer.gpuMemoryUsage}registerDrapeSource(e,t,r){this._drapeSources.add(e),this.renderer.ensureOverlays(this._drapeTargets,this._drapeSources);const n=this.renderer.createDrapeSourceRenderer(e,t,r);return this._updateDrapeSourceExtent(e),this._setContentDirty(),this.notifyChange("running"),n}registerGeometryDrapeSource(e){return this.registerDrapeSource(e,Oh)}_updateDrapeSourceExtent(e){this.renderer.overlays.length===2&&y(e.setDrapingExtent)&&y(this._spatialReference)&&e.setDrapingExtent(this.renderer.overlays,this._spatialReference)}unregisterDrapeSource(e){this._drapeSources.has(e)&&(this._drapeSources.delete(e),this.renderer.removeDrapeSourceRenderer(e),this.renderer.ensureDrapeSources(this._drapeSources),this._setContentDirty(),this.notifyChange("running"))}registerDrapeTarget(e){this._drapeTargets.add(e),this.renderer.ensureOverlays(this._drapeTargets,this._drapeSources)}updateOverlayResult(){var e;(e=this._view._stage)==null||e.renderView.setRenderParameters({overlays:this.renderer.overlays})}unregisterDrapeTarget(e){this._drapeTargets.delete(e),this.renderer.ensureDrapeTargets(this._drapeTargets)}_setContentDirty(){this.setPlacementDirty(),this.setDrawTexturesDirty()}setPlacementDirty(){this._placementDirty=!0}runTask(){this._updateOverlays(this._view.state.camera,vr.UPDATE)}_updateOverlays(e,t){if(!this._spatialReference)return;const r=eTe(e.fullWidth,e.fullHeight,this._maxResolution);this._computeOverlayExtents(e,r,Au);const n=Nh(Au.inner)/Nh(Au.outer);this.renderer.ensureOverlays(this._drapeTargets,this._drapeSources);const s=this._updateOverlay(ki.INNER,Au.inner,r,1*Au.pixelRatioAdjustment,Au.mapUnitsPerPixel),a=this._updateOverlay(ki.OUTER,Au.outer,r,n*Au.pixelRatioAdjustment,Au.mapUnitsPerPixel);s!==Mh.EXTENT&&a!==Mh.EXTENT||(this._drapeSources.forEach(o=>this._updateDrapeSourceExtent(o)),this.surface.updateTileOverlayParams(t)),s===Mh.NONE&&a===Mh.NONE||this.setDrawTexturesDirty(),this._placementDirty=!1}_updateOverlay(e,t,r,n,s){if(this.renderer.overlays.length===0)return Mh.NONE;const a=this.renderer.overlays[e],o=a.mapUnitsPerPixel;if(a.mapUnitsPerPixel=s,a.pixelRatio=n,bRe(t,a.extent)&&r===a.resolution)return o===s?Mh.NONE:Mh.RERENDER_ONLY;yw(a.extent,t),a.resolution=r;const l=pD(a.extent);return a.renderLocalOrigin=iw(l[0],l[1],0,"OV_"+this._latestOriginId++),Mh.EXTENT}setTileParameters(e){const t=e.renderData.overlay;if(this.renderer.overlays.length>0){const r=this.renderer.overlays[ki.INNER],n=this.renderer.overlays[ki.OUTER],s=e.extent;this._rectInsideRect(r.extent,s)||this._rectanglesOverlap(s,r.extent)||this._rectanglesOverlap(s,n.extent)?(this._setTileOverlayData(s,ki.INNER,t),this._setTileOverlayData(s,ki.OUTER,t)):(this._clearTileOverlayData(ki.INNER,t),this._clearTileOverlayData(ki.OUTER,t))}else this._clearTileOverlayData(ki.INNER,t),this._clearTileOverlayData(ki.OUTER,t)}overlayPixelSizeInMapUnits(e){if(this.renderer.overlays.length===0)return 0;const t=this.renderer.overlays[ki.INNER],r=this.renderer.overlays[ki.OUTER],n=this._pointIsInExtent(e,t.extent)?t:r;return(n.extent[2]-n.extent[0])/n.resolution}_setTileOverlayData(e,t,r){if(this.renderer.overlays.length===0)return;const n=this.renderer.overlays[t].extent,s=Nh(n),a=Om(n);let o=e[0];if(this._longitudeCyclical){o=this._longitudeCyclical.minimalMonotonic(n[0],o);const l=this._longitudeCyclical.minimalMonotonic(n[0],e[2]);o>l&&(o=l-(e[2]-e[0]))}r.setScale(t,Nh(e)/s,Om(e)/a),r.setOffset(t,(o-n[0])/s,(e[1]-n[1])/a)}_clearTileOverlayData(e,t){t.setScale(e,-1,-1),t.setOffset(e,-1,-1)}async reloadShaders(){DK(),await this.renderer.reloadShaders(),this.setDrawTexturesDirty(),this.runTask()}_dispatchAnimationUpdate(e){const t=Rt(e-this._animationTimeLast);e=je(this._view.state.forcedAnimationTime,e),(t>=this.surface.view._stage.renderView.animationTimestep||y(this._view.state.forcedAnimationTime)||this._drawTexturesDirty||this._drawTexturesAnimateDirty)&&(this.renderer.updateAnimation({time:e,camera:this._view.state.camera})&&(this._drawTexturesAnimateDirty=!0),this._animationTimeLast=e)}setDrawTexturesDirty(){this.renderer.hasOverlays?(this._contentUpdated=!0,this._drawTexturesDirty=!0,this._view._stage.renderView.requestRender()):this.setPlacementDirty()}_intersectGroundFromView(e,t,r,n){const s=this._view.sceneIntersectionHelper.getCenterRayWithSubpixelOffset(e,TRe,t,r);if(S(s))return!1;const a=s.origin,o=oe(XC,s.origin,s.direction);return this._groundIntersector.reset(a,o,e),this._groundIntersector.intersect([],null),this._view.basemapTerrain.intersect(this._groundIntersector,null,a,o),this._groundIntersector.results.min.getIntersectionPoint(n)}_findHorizonBasedPointOfInterest(e,t){let r=.5;const n=.55,s=this._view.renderCoordsHelper.getAltitude(e.eye),a=this._view.pointsOfInterest.centerOnSurfaceFrequent,o=1e-5,l=ce(a.estimatedSurfaceAltitude,e.aboveGround?-1/0:s+o,e.aboveGround?s-o:1/0),c=e.aboveGround;if(this._view.viewingMode==="global"){const u=XC;RP(fD(gD,Yt(this._view.spatialReference).radius+l),zc(e.eye,e.viewForward),u),ne(u,u,e.eye);const d=Sm.normalize(nG(e.viewForward,u,e.viewRight))/e.fovY+.5,m=d<=0||d>=1?.5:n;r=c?m*d:d+m*(1-d)}else{const u=.5*Math.PI-Math.acos(-e.viewForward[2]),d=Math.tan(u),m=Bi(0,d,1,0),f=sd(m,m,e.projectionMatrix)[1],_=ce(.5+.5*f,0,1);r=_===1||_===0?.5:c?_*n:1-(1-_)*n}return!!this._intersectGroundFromView(e,.5,r,t)&&Y7(t,e.eye)<a.distance*a.distance}_computeOverlayExtents(e,t,r){const n=this._view.pointsOfInterest.centerOnSurfaceFrequent.renderLocation,s=R();this._findHorizonBasedPointOfInterest(e,s)||q(s,n);const a=Math.max(.1,Ii(e.eye,s)),o=Vm(this._view.renderCoordsHelper,n,e.eye),l=Math.PI/2-Math.abs(o-Math.PI/2);jt.OVERLAY_SHOW_CENTER?(S(fp)&&(fp=new $p(this._view.graphics,"red")),fp.show(s,this._renderSR)):y(fp)&&fp.hide(),this._overlaySREqualsRenderSR||ss(s,this._renderSR,s,this._spatialReference);const c=this.surface.extent,u=!this._isSpherical&&y(this._spatialReference)&&this._spatialReference.isGeographic,d=u&&y(this._spatialReference)?1/Yt(this._spatialReference).metersPerDegree:1,m=e.perRenderPixelRatio*a*d;r.mapUnitsPerPixel=m/this._worldToPCSRatio;let f=t*m/2,_=!1,g=u?90:1/0;this._isSpherical&&y(c)&&y(this._spatialReference)&&(this._spatialReference.isWebMercator?(f/=Math.cos(rI(s[1])),g=c[3]):(_=!0,f/=Yt(this._spatialReference).metersPerDegree,g=90),f>=g&&(f=g,s[1]=0,this._spatialReference.isWebMercator&&(s[0]=0)));let x=1;_&&(x=1/Math.max(.2,Math.cos(Math.abs(Ct(s[1])))),f*x>180&&(x=180/f),r.mapUnitsPerPixel*=x);const b=Math.log(2)/12;f=Math.exp(Math.round(Math.log(f)/b)*b);const v=f*x,w=32,T=.5*t/(w*v),E=.5*t/(w*f);s[0]=Math.round(s[0]*T)/T,s[1]=Math.round(s[1]*E)/E;const C=r.inner;C[0]=s[0]-v,C[1]=s[1]-f,C[2]=s[0]+v,C[3]=s[1]+f,this._isSpherical&&this._shiftExtentToFitBounds(C,1/0,g);const A=r.outer;if(6*v>Nh(c))yw(A,ct(c));else if(l<=.25*Math.PI)A[0]=C[0]-v,A[1]=C[1]-f,A[2]=C[2]+v,A[3]=C[3]+f;else{ss(e.eye,this._renderSR,XC,this._spatialReference),Pc(Tf,s,XC);let I=-Math.atan2(Tf[1],Tf[0])+.125*Math.PI;I<0&&(I+=2*Math.PI);const L=Math.floor(I/(.25*Math.PI));TD(Tf,vRe[L],2*f),Tf[0]*=x,Tf[2]*=x,Lre(A,C,Tf)}if(this._isSpherical)A[0]=this._longitudeCyclical.clamp(A[0]),A[2]=this._longitudeCyclical.clamp(A[2]),A[1]=Math.max(A[1],-g),A[3]=Math.min(A[3],g);else{const I=bI(C,c,wRe),L=bI(A,c,xRe);w5(I,L)&&(A[2]=A[0],A[3]=A[1])}const M=Math.abs(C[2]-C[0])/t;r.mapUnitsPerPixel=Math.max(r.mapUnitsPerPixel,M),r.pixelRatioAdjustment=r.mapUnitsPerPixel/M}_drawOverlayTextures(e,t,r=this._view.state.camera){if(e.length===0||!this._drawTexturesDirty&&!this._drawTexturesAnimateDirty)return;const n=this._drawTexturesDirty;this._drawTexturesDirty=!1,this._drawTexturesAnimateDirty=!1;const s=this._drawOverlay(e[ki.INNER],r),a=this._drawOverlay(e[ki.OUTER],r);s!==UE.CHANGED&&a!==UE.CHANGED||this.surface.updateTileOverlayParams(vr.UPDATE),this._collectUnusedRenderTargetMemory(),this.updateOverlayResult(),n?(this.surface.requestRender(t),t===vr.UPDATE&&this.surface.requestUpdate()):this.surface.requestRender(vr.BACKGROUND)}_drawOverlay(e,t){return this._longitudeCyclical?e.setupGeometryViewsCyclical(this._longitudeCyclical):e.setupGeometryViewsDirect(),e.draw(this.renderer,t.pixelRatio)}_collectUnusedRenderTargetMemory(){if(this._hasUnusedRenderTargets=!1,this.renderer.hasOverlays){const e=performance.now();this._hasUnusedRenderTargets=this.renderer.collectUnusedRenderTargetMemory(e)}}_rectanglesOverlap(e,t){return!S(e)&&(this._longitudeCyclical?(this._longitudeCyclical.contains(t[0],t[2],e[0])||this._longitudeCyclical.contains(t[0],t[2],e[2])||this._longitudeCyclical.contains(e[0],e[2],t[0]))&&!(e[1]>t[3]||e[3]<t[1]):EP(e,t))}_rectInsideRect(e,t){return!S(t)&&(this._longitudeCyclical?this._longitudeCyclical.contains(e[0],e[2],t[0])&&this._longitudeCyclical.contains(e[0],e[2],t[2])&&t[1]>e[1]&&t[3]<e[3]:w5(e,t))}_pointIsInExtent(e,t){if(this._longitudeCyclical)return this._longitudeCyclical.contains(t[0],t[2],e.x)&&e.y>=t[1]&&e.y<=t[3];const r=e.x,n=e.y;return r>t[0]&&r<t[2]&&n>t[1]&&n<t[3]}_shiftExtentToFitBounds(e,t,r){let n=0,s=0;e[0]<-t?n=e[0]+t:e[2]>t&&(n=t-e[2]),e[1]<-r?s=e[1]+r:e[3]>r&&(s=r-e[3]),DE(e,n,s)}get test(){return{renderer:this.renderer,update:()=>this.runTask()}}};function bRe(i,e){const r=jt.TESTS_DISABLE_OPTIMIZATIONS?0:1e-5*Math.max(i[2]-i[0],i[3]-i[1],e[2]-e[0],e[3]-e[1]);return Math.abs(e[0]-i[0])<=r&&Math.abs(e[1]-i[1])<=r&&Math.abs(e[2]-i[2])<=r&&Math.abs(e[3]-i[3])<=r}h([p()],fa.prototype,"_spatialReference",void 0),h([p({readOnly:!0})],fa.prototype,"running",null),h([p()],fa.prototype,"_placementDirty",void 0),h([p()],fa.prototype,"_contentUpdated",void 0),h([p()],fa.prototype,"_isSpherical",null),h([p()],fa.prototype,"_worldToPCSRatio",null),h([p()],fa.prototype,"renderer",void 0),h([p({constructOnly:!0})],fa.prototype,"surface",void 0),h([p()],fa.prototype,"suspended",null),h([p()],fa.prototype,"updating",null),h([p({type:Boolean})],fa.prototype,"hasHighlights",null),h([p({type:Boolean})],fa.prototype,"rendersOccluded",null),fa=h([D("esri.views.3d.terrain.OverlayManager")],fa);const Tf=_i(),XC=R(),Au={inner:$t(),outer:$t(),mapUnitsPerPixel:0,pixelRatioAdjustment:1},wRe=$t(),xRe=$t(),TRe=oo();var Mh;(function(i){i[i.NONE=0]="NONE",i[i.EXTENT=1]="EXTENT",i[i.RERENDER_ONLY=2]="RERENDER_ONLY"})(Mh||(Mh={}));let FK=class b${constructor(e,t){this._factoryCallback=e,this._lengthCallback=t,this._pool=new Map}acquire(e){if(!b$.test.disabled){const t=this._pool.get(e);if(t&&t.length!==0)return t.pop()}try{return this._factoryCallback(e)}catch(t){const r=window.performance&&window.performance.memory;let n="";throw r&&(n=`
  totalJSHeapSize: ${r.totalJSHeapSize}, usedJSHeapSize: ${r.usedJSHeapSize}, jsHeapSizeLimit: ${r.jsHeapSizeLimit}`),console.log("Array allocation of size "+e+" failed: "+t+n),t}}release(e){if(b$.test.disabled)return;const t=this._lengthCallback(e);let r=this._pool.get(t);r||(r=new Zt({shrink:!0}),this._pool.set(t,r)),r.push(e)}clear(){this._pool.clear()}get test(){return{size:this._pool.size}}};FK.test={disabled:!1};let CRe=class{constructor(){this.indices=null,this.vertexAttributes=null,this.boundingBox=Mi(),this.indexCount=0,this.numVerticesPerSide=0,this.uvRange=[0,0,1,1],this.outerEdges=[null,null,null,null],this.innerEdges=[null,null,null,null]}},Ez=class{constructor(e,t,r,n,s){this.attributes=e,this.localOrigin=t,this.index0=r,this.stride=n,this.count=s}getVertexIndex(e){return this.getAttributeIndex(e)}getAttributeIndex(e){return pe(0<=e&&e<this.count),this.index0+this.stride*e}_getVertexRaw(e,t){this.attributes.position.getVec(e,t)}_getNormalRaw(e,t){this.attributes.normalCompressed.getVec(e,t)}getVertexPos(e,t){this._getVertexRaw(this.getAttributeIndex(t),e),oe(e,e,this.localOrigin)}getNormal(e,t){const r=be();this._getNormalRaw(this.getAttributeIndex(t),r),RRe(e,r)}_setNormal(e,t,r,n){bx(this.attributes.normalCompressed,e,t,r,n)}_setUV(e,t,r){go(this.attributes.uv0,e,t,r)}setNormalFromValues(e,t,r,n){this._setNormal(this.getAttributeIndex(e),t,r,n)}setVertexFromValuesRawPositionUV(e,t,r,n,s,a){const o=this.getAttributeIndex(e);this.attributes.position.setValues(o,t,r,n),this._setUV(o,s,a)}setVertexFromValuesRawPositionUVNormal(e,t,r,n,s,a,o,l,c){const u=this.getAttributeIndex(e);this.attributes.position.setValues(u,t,r,n),this._setUV(u,s,a),this._setNormal(u,o,l,c)}};const SRe=sn().vec3f(P.POSITION).vec2i16(P.UV0).vec2i16(P.NORMALCOMPRESSED,{glNormalized:!0}),M4=new FK(i=>SRe.createBuffer(i),i=>i.count);function ERe(){M4.clear()}function NK(i){return M4.acquire(i)}function PRe(i){M4.release(i.vertexAttributes),i.vertexAttributes=null,i.indices=null}function bx(i,e,t,r,n){const s=1/(Math.abs(t)+Math.abs(r)+Math.abs(n)),a=t*s,o=r*s,l=n<=0?(a>=0?1:-1)*(1-Math.abs(o)):a,c=n<=0?(o>=0?1:-1)*(1-Math.abs(a)):o;i.setValues(e,Rz(l),Rz(c))}function RRe(i,e){const t=Az(e[0]),r=Az(e[1]),n=1-Math.abs(t)-Math.abs(r);i[2]=n,n<0?(i[0]=(t>=0?1:-1)*(1-Math.abs(r)),i[1]=(r>=0?1:-1)*(1-Math.abs(t))):(i[0]=t,i[1]=r),he(i,i)}const Pz=16384;function go(i,e,t,r){i.setValues(e,t*Pz,r*Pz)}function Rz(i){return ce(Math.round(32767*i),-32767,32767)}function Az(i){return ce(i/32767,-1,1)}function Xs(i,e,t,r){i<r[0]?r[0]=i:i>r[3]&&(r[3]=i),e<r[1]?r[1]=e:e>r[4]&&(r[4]=e),t<r[2]?r[2]=t:t>r[5]&&(r[5]=t)}let ARe=class{constructor(){this.sinLonLUT=new Array(K1+1),this.cosLonLUT=new Array(K1+1),this.sinLatLUT=new Array(K1+1),this.cosLatLUT=new Array(K1+1)}update(e,t,r){const n=t[0],s=t[2];for(let a=0;a<=e;a++){const o=a/e,l=n*(1-o)+s*o;this.sinLonLUT[a]=Math.sin(l),this.cosLonLUT[a]=Math.cos(l);const c=r(o);this.sinLatLUT[a]=Math.sin(c),this.cosLatLUT[a]=Math.cos(c)}}},QC=class{constructor(){this.cornerTiles=[null,null,null,null],this.cornerTileSamplerVersions=[-1,-1,-1,-1]}},ORe=class{constructor(){this.cornerNeighborData=[new QC,new QC,new QC,new QC],this.edgeResolutions=[-1,-1,-1,-1],this.edgePeerNeighbors=[null,null,null,null],this.edgePeerNeighborSamplerVersions=[-1,-1,-1,-1],this.cornerPeerNeighbors=[null,null,null,null]}},MRe=class{constructor(){this.numVerticesPerSide=0,this.samplerData=null,this.clippingArea=null,this.wireframe=!1,this.shading=!1,this.samplerDataVersion=0,this.neighborData=new ORe}},kK=class dE{constructor(e){this._getFadeDuration=e,this._fadeStart=0,this._delayedTime=0}clear(){this._current=Te(this._current),this._next=Te(this._next),this._waiting=Te(this._waiting),this._delayed=Te(this._delayed)}get current(){if(S(this._current))return null;if(!this._isFadingEnabled){const t=this._delayed||this._waiting||this._next||this._current;t!==this._current&&(this._current=null,this.clear(),this._current=t)}let e=dE.test.fadeMoment;if(y(this._delayed)&&(e=e||performance.now(),e>=this._delayedTime&&(this._push(this._delayed,yd.Immediate),this._delayed=null)),y(this._next)){e=e||performance.now();const t=this._fadeDuration,r=y(this._current)&&this._next.texture===this._current.texture,n=this._next.type!==fn.FADING,s=e-this._fadeStart>=t;(r||n||s)&&(Te(this._current),this._current=this._next,this._next=this._waiting,this._waiting=null,this._fadeStart=this._alignFadeStart(e))}return this._current}get next(){return this._next}get fadeFactor(){if(S(this._next))return 1;const e=dE.test.fadeMoment||performance.now(),t=Math.max(0,e-this._fadeStart),r=this._fadeDuration;return t>r?0:1-t/r}get isFading(){return y(this._next)||y(this._delayed)}push(e,t=yd.Immediate){this._delayed=Te(this._delayed),this._push(e,t)}_push(e,t){if(this._isFadingEnabled||this.clear(),S(this._current))return void(this._current=e);const r=dE.test.fadeMoment||performance.now();return t!==yd.Immediate?(this._delayed=e,void(this._delayedTime=r+t)):S(this._next)?(this._next=e,void(this._fadeStart=this._alignFadeStart(r))):void(S(e)||(Te(this._waiting),this._waiting=e))}get _fadeDuration(){return S(this._waiting)?this._getFadeDuration():.5*this._getFadeDuration()}_alignFadeStart(e){const t=this._getFadeDuration();return e+t-e%t}get _isFadingEnabled(){return this._getFadeDuration()>0}};var yd;kK.test={fadeMoment:0},function(i){i[i.Immediate=0]="Immediate",i[i.Delayed=5e3]="Delayed"}(yd||(yd={}));let VK=class{constructor(){this._queue=new Zt,this._last=null,this.remove=()=>{}}get done(){return this._queue.length===0&&(!this._last||this._last.isLeaf)}resetOne(e){this._queue.clear(),this._queue.push(e),this._last=null}reset(e=null){this._queue.clear(),y(e)&&this._queue.pushArray(e),this._last=null}skipSubtree(){this._last=null}next(){return this._last&&!this._last.isLeaf&&this._queue.pushArray(this._last.children),this._last=this._queue.pop(),this._last}},IRe=class{constructor(){this._q=new Zt}get done(){return this._q.length===0}reset(e){if(this._q.clear(),!S(e)){this._q.pushArray(e);for(let t=0;t<this._q.length;++t){const r=this._q.data[t];r.isLeaf||this._q.pushArray(r.children)}}}next(){return this._q.pop()}};function aw(i,e,t){if(S(e)||S(e.fullExtent))return!1;const r=e.fullExtent,n=i.extent;if(t){if(n[0]<r.xmin||n[1]<r.ymin||n[2]>r.xmax||n[3]>r.ymax)return!1}else if(r.xmin>n[2]||r.ymin>n[3]||r.xmax<n[0]||r.ymax<n[1])return!1;const s=i.surface.tilingScheme.levels[i.level].scale;return!(e.minScale>0&&s>1.00000001*e.minScale)&&!(e.maxScale>0&&s<.99999999*e.maxScale)}function vd(i,e){return i.lij[0]-e.lij[0]||i.lij[1]-e.lij[1]||i.lij[2]-e.lij[2]}function UK(i,e,t=null){S(t)||t.length===0?e.sort((r,n)=>I4(r,n,i)):e.sort((r,n)=>LRe(r,n,i,t))}function I4(i,e,t){const r=i.screenDepth,n=e.screenDepth;return r<n?-t:r>n?t:vd(i,e)}function LRe(i,e,t,r){return Oz(i,r)===Oz(e,r)?I4(i,e,t):i?t:-t}function Oz(i,e){for(const t of e)if(i.intersectsExtent(t))return!0;return!1}function $Re(i,e){const t=new Map;i.forAll(r=>t.set(r.lij,r.distanceToSquared(e))),i.sort((r,n)=>t.get(r.lij)-t.get(n.lij)||vd(r,n))}function DRe(i,e,t){let r=1,n=0,s=0;for(;i!==e;)if(r*=.5,n*=.5,s*=.5,1&i.lij[2]&&(n+=.5),!(1&i.lij[1])&&(s+=.5),(i=i.parent)==null)throw new Error("tile was not a descendant of upsampleTile");t.init(e,n,s,r)}function FRe(i){for(let e=0;e<i.length;e++){const t=i[e],r=t.parent;if(r)for(let n=0;n<4;n++){const s=r.children[n];if(s&&s!==t)return!0}}return!1}function PBe(i,e){if(!i||!e||i[0]===e[0])return!1;const t=i[0]<e[0],r=t?i:e,n=t?e:i,s=1<<n[0]-r[0];return Math.floor(n[1]/s)===r[1]&&Math.floor(n[2]/s)===r[2]}let L4=class{get updating(){return!!this._tileRequested}init(e,t,r,n){this.tile=e,this._layerIdx=t,this._layerClass=r,this._suspended=n,this._tileLayerInfo=e.getLayerInfo(t,r),this._tileRequested=null;const s=this._findAncestorWithData();this._setUpsampleTile(s)}startLoading(){return this._requestNext()}dispose(){this._tileRequested&&(this._tileRequested.unrequestLayerData(this._layerIdx,this._layerClass,this),this._tileRequested=null),this.tile=null,this._tileLayerInfo=null}setSuspension(e){e!==this._suspended&&(this._suspended=e,e?this._tileRequested&&(this._tileRequested.unrequestLayerData(this._layerIdx,this._layerClass,this),this._tileRequested=null):this._tileLayerInfo.data||this.update())}update(){const e=this._findAncestorWithData();return this._setUpsampleTile(e),this._requestNext()}dataArrived(e){this._setUpsampleTile(e),this._tileRequested=null,e===this.tile?this.tile.updateRenderData(this._layerClass,fn.FADING):this._requestNext()}dataMissing(){this._tileRequested=null,this._tileLayerInfo.data=null,this._requestNext()}_agentDone(){this.tile.agentDone(this._layerIdx,this._layerClass),this.dispose()}_requestNext(){if(this._suspended)return!0;const e=this._findNextDownload();if(this._tileRequested){if(e===this._tileRequested)return!0;this._tileRequested.unrequestLayerData(this._layerIdx,this._layerClass,this),this._tileRequested=null}return y(e)?e.requestLayerData(this._layerIdx,this._layerClass,this)&&(this._tileRequested=e):this._agentDone(),!!this._tileRequested}_findNextDownload(){const e=this._layerIdx,t=this._layerClass,r=this.tile.surface.layerViewByIndex(e,t),n=m$(r),{minLevel:s,maxLevel:a}=r.dataLevelRange,o=this._desiredMinLevelDelta,l=this._progressiveLevelModulo+o,c=this._scaleRangeEnabled?aw:()=>!0;let u=this.tile;const d=u.level;let m;const f=this._tileLayerInfo.upsampleInfo,_=y(f)?f.tile.level:-1,g=!!y(f)&&_-d>=o,x=en(n,"tilemapCache");for(;u&&c(u,n,!1)&&u.level>=s;){const b=u.level,v=d-b,w=u.layerInfo[t][e];if(w.data&&v>=o){(!g||b>_)&&this._setUpsampleTile(u),w.dataInvalidated&&(m=u);break}if((S(x)||x.getAvailability(u.lij[0],u.lij[1],u.lij[2])!=="unavailable")&&b<=a&&!w.data&&!w.dataMissing&&((S(m)||u.level===s||b%lQ==0||d-m.level<o)&&(m=u),v>=l))break;u=u.parent}return y(m)&&d-m.level<o&&this._tileLayerInfo.upsampleInfo&&(m=null),m}_findAncestorWithData(){const e=this.tile.vlevel,t=this._desiredMinLevelDelta;let r;for(let n=this.tile;n;n=n.parent)if(n.hasLayerData(this._layerIdx,this._layerClass)){if(e-n.level>=t)return n;r=n}return r}_setUpsampleTile(e){this._tileLayerInfo.setUpsampleInfo(this.tile,e),this.tile.updateRenderData(this._layerClass,fn.FADING)}get test(){return{findNextDownload:()=>this._findNextDownload(),tileLayerInfo:this._tileLayerInfo}}},NRe=class extends L4{get _desiredMinLevelDelta(){throw Mz}get _progressiveLevelModulo(){throw Mz}dispose(){}};const Mz=new Error("Abstract method called on TileAgent"),za=new NRe;let zK=class extends L4{constructor(){super(...arguments),this._scaleRangeEnabled=!1}get _desiredMinLevelDelta(){return KS(this.tile.level)-(this.tile.vlevel-this.tile.level)}get _progressiveLevelModulo(){return 0}},BK=class extends L4{constructor(){super(),this._scaleRangeEnabled=!0}get _desiredMinLevelDelta(){return 0}get _progressiveLevelModulo(){return lQ}};var Tg,qg;(function(i){i[i.Stretch=0]="Stretch",i[i.Lut=1]="Lut",i[i.Hillshade=2]="Hillshade",i[i.COUNT=3]="COUNT"})(Tg||(Tg={})),function(i){i[i.Noop=0]="Noop",i[i.PerBand=1]="PerBand",i[i.COUNT=2]="COUNT"}(qg||(qg={}));function kRe(i,e){i.fragment.uniforms.add([new Bt("u_colormap",t=>t.u_colormap),new Tt("u_colormapOffset",t=>t.colormap.u_colormapOffset),new Tt("u_colormapMaxIndex",t=>t.colormap.u_colormapMaxIndex),new Tt("u_opacity",t=>t.common.u_opacity)]),i.fragment.code.add(O`
    vec4 colormap(vec4 currentPixel, bool isFloat) {
      float colorIndex = isFloat ? currentPixel.r - u_colormapOffset : currentPixel.r * 255.0 - u_colormapOffset;
      vec4 result;
      // handle no data and out of range pixels
      if (currentPixel.a == 0.0 || colorIndex > u_colormapMaxIndex) {
        result = vec4(0.0, 0.0, 0.0, 0.0);
      } else {
        // colormap lookup
        vec2 texelCoordinates = vec2((colorIndex + 0.5), 0.5);
        result = ${Ko(e,"u_colormap","texelCoordinates","(1.0 / vec2(u_colormapMaxIndex + 1.0, 1.0))")};
      }
      return result;
    }
  `)}function VRe(i,e){i.fragment.uniforms.add(bG("u_transformGrid",t=>t.u_transformGrid,e.hasWebGL2Context?il.None:il.InvSize)),i.fragment.uniforms.add(new Zs("u_transformSpacing",t=>t.common.u_transformSpacing)),i.fragment.uniforms.add(new Zs("u_targetImageSize",t=>t.common.u_targetImageSize)),i.fragment.code.add(O`
    vec2 projectPixelLocation(vec2 coords) {
      // Pixel index in row/column, corresponds to upperleft corner, e.g. [100, 20]
      vec2 index_image = floor(coords * u_targetImageSize);

      // Pixel's corresponding cell index in transform grid
      // Each transform cell corresponds to 4 pixels: 6 coefficients from lowerleft triangle followed by 6 coefficients from upperright triangle
      vec2 oneTransformPixel = vec2(4.0, 1.0);
      vec2 index_transform = floor(index_image / u_transformSpacing) * oneTransformPixel;

      // Correspoding position in transform grid cell, cell center coordinates
      vec2 pos = fract((index_image + 0.5) / u_transformSpacing);

      // Pixel's corresponding transform cell location, cell center coordinates
      vec2 transform_location = index_transform + 0.5;

      vec2 srcLocation;

      // Use lower triangle or upper triangle
      if (pos.s <= pos.t) {
        vec3 ll_abc = ${Ko(e,"u_transformGrid","transform_location")}.rgb;
        vec3 ll_def = ${Ko(e,"u_transformGrid","vec2(transform_location.s + 1.0, transform_location.t)")}.rgb;
        srcLocation.s = dot(ll_abc, vec3(pos, 1.0));
        srcLocation.t = dot(ll_def, vec3(pos, 1.0));
      } else {
        vec3 ur_abc = ${Ko(e,"u_transformGrid","vec2(transform_location.s + 2.0, transform_location.t)")}.rgb;
        vec3 ur_def = ${Ko(e,"u_transformGrid","vec2(transform_location.s + 3.0, transform_location.t)")}.rgb;
        srcLocation.s = dot(ur_abc, vec3(pos, 1.0));
        srcLocation.t = dot(ur_def, vec3(pos, 1.0));
      }

      return srcLocation;
    }
  `)}let GK=class extends Ir{constructor(){super(...arguments),this.scale=1,this.offset=Pg}};function HK(i){i.attributes.add(P.POSITION,"vec2"),i.attributes.add(P.UV0,"vec2"),i.vertex.uniforms.add(new Tt("scale",e=>e.scale)),i.vertex.uniforms.add(new Zs("offset",e=>e.offset)),i.varyings.add("uv","vec2"),i.varyings.add("vuv","vec2"),i.vertex.code.add(O`void main(void) {
gl_Position = vec4(position, 0.0, 1.0);
uv = uv0 * scale + offset;
vuv = uv0;
}`)}let URe=class extends GK{constructor(e,t,r){super(),this.common=e,this.u_image=t,this.u_transformGrid=r}};function zRe(i,e){i.include(VRe,e),i.fragment.uniforms.add([new Bt("u_image",t=>t.u_image),new Tw("u_flipY",t=>t.common.u_flipY),new Tw("u_applyTransform",t=>t.common.u_applyTransform)]),i.fragment.code.add(O`vec2 getPixelLocation(vec2 coords) {
vec2 targetLocation = u_flipY ? vec2(coords.s, 1.0 - coords.t) : coords;
if (!u_applyTransform) {
return targetLocation;
}
return projectPixelLocation(targetLocation);
}
bool isOutside(vec2 coords){
if (coords.t>1.00001 ||coords.t<-0.00001 || coords.s>1.00001 ||coords.s<-0.00001) {
return true;
} else {
return false;
}
}
vec4 getPixel(vec2 pixelLocation) {
return texture2D(u_image, pixelLocation);
}`)}var fe;(function(i){i[i.Normal=0]="Normal",i[i.Average=1]="Average",i[i.Lighten=2]="Lighten",i[i.Lighter=3]="Lighter",i[i.Plus=4]="Plus",i[i.Screen=5]="Screen",i[i.ColorDodge=6]="ColorDodge",i[i.Darken=7]="Darken",i[i.Multiply=8]="Multiply",i[i.ColorBurn=9]="ColorBurn",i[i.Overlay=10]="Overlay",i[i.SoftLight=11]="SoftLight",i[i.HardLight=12]="HardLight",i[i.VividLight=13]="VividLight",i[i.Hue=14]="Hue",i[i.Saturation=15]="Saturation",i[i.Luminosity=16]="Luminosity",i[i.Color=17]="Color",i[i.DestinationOver=18]="DestinationOver",i[i.DestinationAtop=19]="DestinationAtop",i[i.DestinationIn=20]="DestinationIn",i[i.DestinationOut=21]="DestinationOut",i[i.SourceAtop=22]="SourceAtop",i[i.SourceIn=23]="SourceIn",i[i.SourceOut=24]="SourceOut",i[i.Xor=25]="Xor",i[i.Difference=26]="Difference",i[i.Exclusion=27]="Exclusion",i[i.Minus=28]="Minus",i[i.Invert=29]="Invert",i[i.Reflect=30]="Reflect",i[i.COUNT=31]="COUNT"})(fe||(fe={}));const w$={normal:fe.Normal,average:fe.Average,lighten:fe.Lighten,lighter:fe.Lighter,screen:fe.Screen,plus:fe.Plus,"color-dodge":fe.ColorDodge,darken:fe.Darken,multiply:fe.Multiply,"color-burn":fe.ColorBurn,overlay:fe.Overlay,"soft-light":fe.SoftLight,"hard-light":fe.HardLight,"vivid-light":fe.VividLight,hue:fe.Hue,saturation:fe.Saturation,luminosity:fe.Luminosity,color:fe.Color,difference:fe.Difference,exclusion:fe.Exclusion,minus:fe.Minus,invert:fe.Invert,reflect:fe.Reflect,"destination-over":fe.DestinationOver,"destination-atop":fe.DestinationAtop,"destination-in":fe.DestinationIn,"destination-out":fe.DestinationOut,"source-atop":fe.SourceAtop,"source-in":fe.SourceIn,"source-out":fe.SourceOut,xor:fe.Xor};function BRe(i){return i===fe.DestinationOver||i===fe.DestinationAtop||i===fe.DestinationIn||i===fe.DestinationOut||i===fe.SourceAtop||i===fe.SourceIn||i===fe.SourceOut||i===fe.Xor}function $4(i){i.code.add(O`
    float lineFactorAtPosition(float value) {
      float pos = value * ${O.float(257)};
      if(pos < 0.5 || pos > ${O.float(257-.5)}) {
        return 1.0;
      }

      pos = pos + 0.5;
      float modulo = mod(pos, 16.0);
      return modulo <= 2.0 ?  1.0 - abs(modulo - 1.0) : 0.0;
    }

    float lineFactorAtUV(vec2 uv) {
      return max(lineFactorAtPosition(uv.x), lineFactorAtPosition(uv.y));
    }

    float lineFactor(vec2 uv) {
      vec2 offset = fwidth(uv) * 0.25;
      return (lineFactorAtUV(vec2(uv.x + offset.x, uv.y + offset.y)) +
              lineFactorAtUV(vec2(uv.x - offset.x, uv.y + offset.y)) +
              lineFactorAtUV(vec2(uv.x + offset.x, uv.y - offset.y)) +
              lineFactorAtUV(vec2(uv.x - offset.x, uv.y - offset.y))) / 4.0;
    }

    vec4 gridColor(vec2 uv) {
      float line = lineFactor(uv) * 0.1 + 0.9;
      return vec4(vec3(1.0, 0.972, 0.918) * line, 1.0);
    }`)}function GRe(i,e){const t=e.blendMode;t!==fe.Normal&&(t===fe.Reflect&&i.code.add(O`float reflectBlend(in float cb, in float cl) {
return (cl == 1.0) ? cl : min(cb * cb / (1.0 - cl), 1.0);
}`),t!==fe.ColorDodge&&t!==fe.VividLight||i.code.add(O`float colorDodge(in float cb, in float cl) {
return (cb == 0.0) ? 0.0 : (cl == 1.0) ? 1.0 : min(1.0, cb / (1.0 - cl));
}`),t!==fe.ColorBurn&&t!==fe.VividLight||i.code.add(O`float colorBurn(in float cb, in float cl) {
return (cb == 1.0) ? 1.0 : (cl == 0.0) ? 0.0 : 1.0 - min(1.0, (1.0 - cb) / cl);
}`),t===fe.Overlay&&i.code.add(O`float overlay(in float cb, in float cl) {
return (1.0 - step(0.5, cl)) * (1.0 - 2.0 * (1.0 - cl ) * (1.0 - cb)) + step(0.5, cl) * (2.0 * cl * cb);
}`),t===fe.HardLight&&i.code.add(O`float hardLight(in float cb, in float cl) {
return (1.0 - step(0.5, cl)) * (2.0 * cl * cb) + step(0.5, cl) * (1.0 - 2.0 * (1.0 - cl) * (1.0 - cb));
}`),t===fe.SoftLight&&i.code.add(O`float softLight(in float cb, in float cl) {
if (cl <= 0.5) {
return cb - (1.0 - 2.0 * cl) * cb * (1.0 - cb);
}
if (cb <= 0.25) {
return cb + (2.0 * cl - 1.0) * cb * ((16.0 * cb - 12.0) * cb + 3.0);
}
return cb + (2.0 * cl - 1.0) * (sqrt(cb) - cb);
}`),t===fe.VividLight&&i.code.add(O`float vividLight(in float cb, in float cl) {
return (1.0 - step(0.5, cl)) * colorBurn(cb, 2.0 * cl) + step(0.5, cl) * colorDodge(cb, (2.0 * (cl - 0.5)));
}`),t!==fe.Hue&&t!==fe.Saturation&&t!==fe.Color&&t!==fe.Luminosity||(i.code.add(O`float minv3(in vec3 c) {
return min(min(c.r, c.g), c.b);
}
float maxv3(in vec3 c) {
return max(max(c.r, c.g), c.b);
}
float lumv3(in vec3 c) {
return dot(c, vec3(0.3, 0.59, 0.11));
}
vec3 clipColor(vec3 color) {
float lum = lumv3(color);
float mincol = minv3(color);
float maxcol = maxv3(color);
if (mincol < 0.0) {
color = lum + ((color - lum) * lum) / (lum - mincol);
}
if (maxcol > 1.0) {
color = lum + ((color - lum) * (1.0 - lum)) / (maxcol - lum);
}
return color;
}
vec3 setLum(vec3 cbase, vec3 clum) {
return clipColor(cbase + vec3(lumv3(clum) - lumv3(cbase)));
}`),t!==fe.Hue&&t!==fe.Saturation||i.code.add(O`float satv3(vec3 c) {
return maxv3(c) - minv3(c);
}
vec3 setLumSat(vec3 cbase, vec3 csat, vec3 clum)
{
float minbase = minv3(cbase);
float sbase = satv3(cbase);
float ssat = satv3(csat);
return setLum(sbase > 0.0 ? (cbase - minbase) * ssat / sbase : vec3(0.0), clum);
}`)),i.code.add(O`
    vec4 applyBlendMode(vec3 cl, float ol, vec3 cb, float ob) {
      ${t===fe.Multiply?O`return vec4(cl * ol * cb * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===fe.Average?O`return vec4((cb + cl) * 0.5 * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===fe.Lighten?O`return vec4(max(cb, cl) * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===fe.Darken?O`return vec4(min(cl, cb) * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===fe.Lighter?O`return vec4(cl * ol + cb * ob, ol + ob);`:t===fe.Plus?O`return clamp(vec4(cl.rgb + cb.rgb, ol + ob), 0.0, 1.0);`:t===fe.Minus?O`return vec4(clamp(vec3(cb.rgb - cl.rgb), 0.0, 1.0), ob * ol);`:t===fe.Screen?O`return vec4((cl + cb - cl * cb) * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===fe.Difference?O`return vec4(abs(cb - cl) * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===fe.Invert?O`return vec4((1.0 - cb) * ol * ob + cb * ob * (1.0 - ol), ob);`:t===fe.DestinationOver?O`return vec4(cl * ol * (1.0 - ob) + cb * ob, ol + ob - ol * ob);`:t===fe.DestinationAtop?O`return vec4(cl * ol * (1.0 - ob) + cb * ob * ol, ol);`:t===fe.DestinationOut?O`return vec4(cb * ob * (1.0 - ol), ob * (1.0 - ol));`:t===fe.SourceAtop?O`return vec4(cl * ol * ob + cb * ob * (1.0 - ol), ob);`:t===fe.SourceOut?O`return vec4(cl * ol * (1.0 - ob), ol * (1.0 - ob));`:t===fe.Xor?O`return vec4(cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), ol * (1.0 - ob) + ob * (1.0 - ol));`:t===fe.DestinationIn?O`return vec4(cb * ob * ol, ol * ob);`:t===fe.SourceIn?O`return vec4(cl * ol * ob, ol * ob);`:t===fe.Hue?O`
          vec3 f = setLumSat(cl, cb, cb);
          return vec4(f * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===fe.Saturation?O`
          vec3 f = setLumSat(cb, cl, cb);
          return vec4(f * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===fe.Color?O`
          vec3 f = setLum(cl, cb);
          return vec4(f * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===fe.Luminosity?O`
          vec3 f = setLum(cb, cl);
          return vec4(f * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===fe.Exclusion?O`
          vec3 f = cl + cb - 2.0 * cl * cb;
          return vec4(f * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===fe.Reflect?O`
          vec3 f = vec3(reflectBlend(cb.r, cl.r), reflectBlend(cb.g, cl.g), reflectBlend(cb.b, cl.b));
          return vec4(f * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===fe.ColorDodge?O`
          vec3 f = vec3(colorDodge(cb.r, cl.r), colorDodge(cb.g, cl.g), colorDodge(cb.b, cl.b));
          return vec4(f * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===fe.ColorBurn?O`
          vec3 f = vec3(colorBurn(cb.r, cl.r), colorBurn(cb.g, cl.g), colorBurn(cb.b, cl.b));
          return vec4(f * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===fe.Overlay?O`
          vec3 f = vec3(overlay(cb.r, cl.r), overlay(cb.g, cl.g), overlay(cb.b, cl.b));
          return vec4(f * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===fe.SoftLight?O`
          vec3 f = vec3(softLight(cb.r, cl.r), softLight(cb.g, cl.g), softLight(cb.b, cl.b));
          return vec4(f * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===fe.HardLight?O`
          vec3 f = vec3(hardLight(cb.r, cl.r), hardLight(cb.g, cl.g), hardLight(cb.b, cl.b));
          return vec4(f * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===fe.VividLight?O`
          vec3 f = vec3(vividLight(cb.r, cl.r), vividLight(cb.g, cl.g), vividLight(cb.b, cl.b));
          return vec4(f * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:O``}
    }
  `))}var Zr,Dc,bc;(function(i){i[i.Composite=0]="Composite",i[i.ColorComposite=1]="ColorComposite",i[i.GridComposite=2]="GridComposite",i[i.GroupBackgroundComposite=3]="GroupBackgroundComposite",i[i.COUNT=4]="COUNT"})(Zr||(Zr={})),function(i){i[i.NotRequired=0]="NotRequired",i[i.Required=1]="Required",i[i.COUNT=2]="COUNT"}(Dc||(Dc={})),function(i){i[i.Off=0]="Off",i[i.On=1]="On",i[i.COUNT=2]="COUNT"}(bc||(bc={}));function jK(i,e){const t=e.output===Zr.GridComposite,r=e.output===Zr.ColorComposite,n=e.output===Zr.GroupBackgroundComposite,s=e.output===Zr.Composite;t&&(i.extensions.add("GL_OES_standard_derivatives"),i.fragment.include($4)),r&&i.fragment.uniforms.add(new Rs("backgroundColor",c=>c.backgroundColor));const a=e.baseOpacityMode===Dc.Required;if(a&&i.fragment.uniforms.add(new Tt("baseOpacity",c=>c.baseOpacity)),s){const c=e.hasWebGL2Context?il.None:il.InvSize;i.fragment.uniforms.add(bG("fboColor",u=>u.fboTexture,c))}const o=e.blendMode!==fe.Normal,l=e.premultipliedSource===bc.On;i.fragment.include(GRe,e),i.fragment.code.add(O`
    vec4 getBackground(vec2 uv) {
      return ${a?O`baseOpacity *`:""} ${n?O`vec4(0.0, 0.0, 0.0, 0.0)`:r?O`vec4(backgroundColor, 1.0)`:t?O`gridColor(uv)`:O`${Ko(e,"fboColor","gl_FragCoord.xy")}`};
    }

    vec4 blendLayers(vec4 bgColor, vec4 colorLayer, float opacity) {
      ${o?O`
          vec3 Cb = bgColor.a == 0.0 ? bgColor.rgb : vec3(bgColor.rgb * bgColor.a);
          return applyBlendMode(colorLayer.rgb, colorLayer.a * opacity, Cb, bgColor.a);`:O`
          vec4 pmColorLayer = vec4(colorLayer.xyz, 1.0);
          float composeAlpha = colorLayer.a * opacity;
          return ${l?O`bgColor * (1.0 - composeAlpha) + colorLayer * opacity;`:s&&!a||n?O`pmColorLayer * composeAlpha;`:O`mix(bgColor, pmColorLayer, composeAlpha);`}`}
    }`)}let UR=class extends URe{constructor(e,t,r,n,s,a){super(e,n,s),this.colormap=t,this.symbolizer=r,this.u_colormap=a,this.backgroundColor=Gl,this.fboTexture=null,this.baseOpacity=1}},HRe=class extends UR{},jRe=class extends UR{};function qRe(i){const e=new Yi;return e.include(HK),e.include(zRe,i),e.include(kRe,i),e.include(jK,i),e.fragment.code.add(O`vec4 applyBackgroundBlend(vec4 layerColor) {
vec4 bgColor = getBackground(vuv);
return blendLayers(bgColor, layerColor, u_opacity);
}`),i.colorizerType===Tg.Stretch?XRe(e,i):i.colorizerType===Tg.Lut?WRe(e):i.colorizerType===Tg.Hillshade&&QRe(e,i),e}function WRe(i){i.fragment.code.add(O`void main() {
vec2 pixelLocation = getPixelLocation(uv);
if (isOutside(pixelLocation)) {
gl_FragColor = applyBackgroundBlend(vec4(0.0, 0.0, 0.0, 0.0));
return;
}
vec4 currentPixel = getPixel(pixelLocation);
gl_FragColor = applyBackgroundBlend(colormap(currentPixel, true));
}`)}function XRe(i,e){i.fragment.uniforms.add([new CD("u_bandCount",r=>r.symbolizer.u_bandCount),new rd("u_minCutOff",r=>r.symbolizer.u_minCutOff,3),new rd("u_maxCutOff",r=>r.symbolizer.u_maxCutOff,3),new rd("u_factor",r=>r.symbolizer.u_factor,3),new Tt("u_minOutput",r=>r.symbolizer.u_minOutput),new Tt("u_maxOutput",r=>r.symbolizer.u_maxOutput),new Tw("u_useGamma",r=>r.symbolizer.u_useGamma),new rd("u_gamma",r=>r.symbolizer.u_gamma,3),new rd("u_gammaCorrection",r=>r.symbolizer.u_gammaCorrection,3),new Tt("u_opacity",r=>r.common.u_opacity)]),i.fragment.code.add(O`float stretchOneValue(float val, float minCutOff, float maxCutOff, float minOutput, float maxOutput, float factor, bool useGamma, float gamma, float gammaCorrection) {
if (val >= maxCutOff) {
return maxOutput;
} else if (val <= minCutOff) {
return minOutput;
}
float stretchedVal;
if (useGamma) {
float tempf = 1.0;
float outRange = maxOutput - minOutput;
float relativeVal = (val - minCutOff) / (maxCutOff - minCutOff);
if (gamma > 1.0) {
tempf -= pow(1.0 / outRange, relativeVal * gammaCorrection);
}
stretchedVal = (tempf * outRange * pow(relativeVal, 1.0 / gamma) + minOutput) / 255.0;
} else {
stretchedVal = minOutput + (val - minCutOff) * factor;
}
return stretchedVal;
}`);const t=e.applyColormap?O`gl_FragColor = applyBackgroundBlend(colormap(vec4(grayVal, grayVal, grayVal, currentPixel.a), !u_useGamma));`:O`gl_FragColor = applyBackgroundBlend(vec4(grayVal, grayVal, grayVal, currentPixel.a));`;i.fragment.code.add(O`
      void main() {
        vec2 pixelLocation = getPixelLocation(uv);
        if (isOutside(pixelLocation)) {
          gl_FragColor = applyBackgroundBlend(vec4(0.0, 0.0, 0.0, 0.0));
          return;
        }

        vec4 currentPixel = getPixel(pixelLocation);
        ${e.stretchType===qg.Noop?O`
        gl_FragColor = applyBackgroundBlend(currentPixel);`:O`
        if (currentPixel.a == 0.0) {
          gl_FragColor = applyBackgroundBlend(vec4(0.0, 0.0, 0.0, 0.0));
          return;
        }
        if (u_bandCount == 1) {
          float grayVal = stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);
          ${t}
        } else {
          float redVal = stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);
          float greenVal = stretchOneValue(currentPixel.g, u_minCutOff[1], u_maxCutOff[1], u_minOutput, u_maxOutput, u_factor[1], u_useGamma, u_gamma[1], u_gammaCorrection[1]);
          float blueVal = stretchOneValue(currentPixel.b, u_minCutOff[2], u_maxCutOff[2], u_minOutput, u_maxOutput, u_factor[2], u_useGamma, u_gamma[2], u_gammaCorrection[2]);
          gl_FragColor = applyBackgroundBlend(vec4(redVal, greenVal, blueVal, currentPixel.a));
        }`}
      }`)}function QRe(i,e){const t=i.fragment;t.uniforms.add([new Bt("u_image",n=>n.u_image),new CD("u_hillshadeType",n=>n.symbolizer.u_hillshadeType),new rd("u_sinZcosAs",n=>n.symbolizer.u_sinZcosAs,6),new rd("u_sinZsinAs",n=>n.symbolizer.u_sinZsinAs,6),new rd("u_cosZs",n=>n.symbolizer.u_cosZs,6),new rd("u_weights",n=>n.symbolizer.u_weights,6),new Zs("u_factor",n=>n.symbolizer.u_factor),new Tt("u_minValue",n=>n.symbolizer.u_minValue),new Tt("u_maxValue",n=>n.symbolizer.u_maxValue),new Zs("u_srcImageSize",n=>n.common.u_srcImageSize)]),t.include($G),t.code.add(O`vec4 overlay(float val, float minValue, float maxValue, float hillshade, float alpha) {
val = clamp((val - minValue) / (maxValue - minValue), 0.0, 1.0);
vec3 hsv = rgb2hsv(colormap(vec4(val, val, val, 1.0), false).rgb);
hsv.z = hillshade;
return vec4(hsv2rgb(hsv) * alpha, alpha);
}`),t.code.add(O`float getNeighborHoodAlpha(float a, float b, float c, float d, float e, float f, float g, float h, float i){
if (a == 0.0 || a == 0.0 || a==0.0 || a == 0.0 || a == 0.0 || a==0.0 || a == 0.0 || a == 0.0 || a==0.0) {
return 0.0;
}  else {
return e;
}
}`);const r=e.applyColormap?O`gl_FragColor = applyBackgroundBlend(overlay(ve.r, u_minValue, u_maxValue, hillshade, alpha));`:O`hillshade *= alpha;
gl_FragColor = applyBackgroundBlend(vec4(hillshade, hillshade, hillshade, alpha));`;t.code.add(O`
    void main() {
      vec2 pixelLocation = getPixelLocation(uv);
      if (isOutside(pixelLocation)) {
        gl_FragColor = applyBackgroundBlend(vec4(0.0, 0.0, 0.0, 0.0));
        return;
      }

      vec4 currentPixel = getPixel(pixelLocation);
      if (currentPixel.a == 0.0) {
        gl_FragColor = applyBackgroundBlend(vec4(0.0, 0.0, 0.0, 0.0));
        return;
      }

      //mirror edge pixels
      vec2 axy = vec2(-1.0, -1.0);
      vec2 bxy = vec2(0.0, -1.0);
      vec2 cxy = vec2(1.0, -1.0);
      vec2 dxy = vec2(-1.0, 0.0);
      vec2 fxy = vec2(1.0, 0.0);
      vec2 gxy = vec2(-1.0, 1.0);
      vec2 hxy = vec2(0.0, 1.0);
      vec2 ixy = vec2(1.0, 1.0);
      vec2 onePixel = 1.0 / u_srcImageSize;
      if (pixelLocation.s < onePixel.s) {
        axy[0] = 1.0;
        dxy[0] = 1.0;
        gxy[0] = 1.0;
      }
      if (pixelLocation.t < onePixel.t) {
        axy[1] = 1.0;
        bxy[1] = 1.0;
        cxy[1] = 1.0;
      }
      if (pixelLocation.s > 1.0 - onePixel.s) {
        cxy[0] = -1.0;
        fxy[0] = -1.0;
        ixy[0] = -1.0;
      }
      if (pixelLocation.t > 1.0 - onePixel.t) {
        gxy[1] = -1.0;
        hxy[1] = -1.0;
        ixy[1] = -1.0;
      }

      // calculate hillshade
      vec4 va = texture2D(u_image, pixelLocation + onePixel * axy);
      vec4 vb = texture2D(u_image, pixelLocation + onePixel * bxy);
      vec4 vc = texture2D(u_image, pixelLocation + onePixel * cxy);
      vec4 vd = texture2D(u_image, pixelLocation + onePixel * dxy);
      vec4 ve = texture2D(u_image, pixelLocation);
      vec4 vf = texture2D(u_image, pixelLocation + onePixel * fxy);
      vec4 vg = texture2D(u_image, pixelLocation + onePixel * gxy);
      vec4 vh = texture2D(u_image, pixelLocation + onePixel * hxy);
      vec4 vi = texture2D(u_image, pixelLocation + onePixel * ixy);

      // calculate the rate of z change along the x, y, and diagonal direction
      float dzx = (vc + 2.0 * vf + vi - va - 2.0 * vd - vg).r * u_factor.s;
      float dzy = (vg + 2.0 * vh + vi - va - 2.0 * vb - vc).r * u_factor.t;
      float dzd = sqrt(1.0 + dzx * dzx + dzy * dzy);
      float hillshade = 0.0;

      // traditional single light source
      if (u_hillshadeType == 0){
        float cosDelta = u_sinZsinAs[0] * dzy - u_sinZcosAs[0] * dzx;
        float z = (u_cosZs[0] + cosDelta) / dzd;
        if (z < 0.0)  z = 0.0;
        hillshade = z;
      } else {
        // multi-directional with 6 light sources
        for (int k = 0; k < 6; k++) {
        float cosDelta = u_sinZsinAs[k] * dzy - u_sinZcosAs[k] * dzx;
        float z = (u_cosZs[k] + cosDelta) / dzd;
        if (z < 0.0) z = 0.0;
        hillshade = hillshade + z * u_weights[k];
        if (k == 5) break;
        }
      }

      // set color
      float alpha = getNeighborHoodAlpha(va.a, vb.a, vc.a, vd.a, ve.a, vf.a, vg.a, vh.a, vi.a);
      alpha *= u_opacity;
      ${r}
    }
  `)}const ZRe=Object.freeze(Object.defineProperty({__proto__:null,ColorizerUniforms:UR,ColorizerStretchUniforms:HRe,ColorizerHillshadeUniforms:jRe,build:qRe},Symbol.toStringTag,{value:"Module"})),Iz={bandCount:3,outMin:0,outMax:1,minCutOff:[0,0,0],maxCutOff:[255,255,255],factor:[1/255,1/255,1/255],useGamma:!1,gamma:[1,1,1],gammaCorrection:[1,1,1],colormap:null,colormapOffset:null,stretchType:"none",type:"stretch"};let YRe=class{constructor(e,t,r=null,n=null){this.type="raster-tile",this._memoryUsed=null,this._source=null,this._symbolizerParameters=null,this._bandIds=null,this._interpolation=null,this._dirty=!1,this._transformGrid=null,this.isRendereredSource=!1,this.symbolizerRenderer=null,this.rawPixelData=null,this.lij=null,this.opacity=1,this.lij=e,this.source=t,this.width=r||t.width,this.height=n||t.height}get source(){return this._source}set source(e){this._source=e,this._rasterTexture=Me(this._rasterTexture),this._memoryUsed=null}get symbolizerParameters(){return this.isRendereredSource?{...Iz,maxCutOff:[1,1,1],factor:[1,1,1]}:this._symbolizerParameters||Iz}set symbolizerParameters(e){this._symbolizerParameters=e}get bandIds(){return this._bandIds}set bandIds(e){y(e)&&e.length>0?this._bandIds&&e.every((t,r)=>!!this._bandIds[r]&&t===this._bandIds[r])||(this._bandIds=e,this._dirty=!0):this._bandIds=null}get interpolation(){return this._interpolation||"nearest"}set interpolation(e){if(this._interpolation=e,y(this._rasterTexture)){const t=this._getRasterTextureInterpolation(e);this._rasterTexture.setSamplingMode(t==="bilinear"?Kt.LINEAR:Kt.NEAREST)}}get transformGrid(){return this._transformGrid}set transformGrid(e){this._transformGrid=e,this._transformGridTexture=Me(this._transformGridTexture),this._memoryUsed=null}bind(e){return!!(this.source&&this.source.pixels&&this.source.pixels.length>0)&&((S(this._rasterTexture)||this._dirty)&&this._updateRasterTexture(e,this.bandIds),y(this._rasterTexture)&&(this._updateColormapTexture(e),this.transformGrid&&S(this._transformGridTexture)&&(this._transformGridTexture=uae(e,this.transformGrid))),!0)}getUniforms(){const{symbolizerParameters:e,transformGrid:t,width:r,height:n,opacity:s}=this,a=dae(t,[r,n],[this.source.width,this.source.height],s),o=pae(e.colormap,e.colormapOffset),l=this.symbolizerParameters.type==="stretch"?mae(this.symbolizerParameters):null,c=this.symbolizerParameters.type==="hillshade"?fae(this.symbolizerParameters):null;return new UR(a,o,l||c,this._rasterTexture,this._transformGridTexture,this._colormapTexture)}get memoryUsage(){if(S(this._memoryUsed)){const e=[this._rasterTexture,this._transformGridTexture,this._colormapTexture];this._memoryUsed=e.map(t=>y(t)?t.descriptor.width*t.descriptor.height*4:0).reduce((t,r)=>t+r,0)}return this._memoryUsed}release(){return this._rasterTexture=Me(this._rasterTexture),this._transformGridTexture=Me(this._transformGridTexture),this._colormapTexture=Me(this._colormapTexture),this.source=null,this.transformGrid=null,this.rawPixelData=null,!0}_updateRasterTexture(e,t){const r=this.source?this.source.extractBands(t):null;if(!(r&&r.pixels&&r.pixels.length>0))return void(this._rasterTexture=Me(this._rasterTexture));const n=S(t)&&S(this.bandIds)||y(t)&&y(this.bandIds)&&t.join("")===this.bandIds.join("");if(y(this._rasterTexture)&&n)return;this._rasterTexture=Me(this._rasterTexture);const s=this._getRasterTextureInterpolation(this.interpolation);this._rasterTexture=gae(e,r,s,this.isRendereredSource||this.hasStretchTypeNone())}hasStretchTypeNone(){return"stretchType"in this.symbolizerParameters&&this.symbolizerParameters.stretchType==="none"&&!this.symbolizerParameters.useGamma&&this.source.pixelType==="u8"}_getRasterTextureInterpolation(e){return this.symbolizerParameters.type==="lut"||e==="nearest"||e==="majority"?"nearest":"bilinear"}_updateColormapTexture(e){const t=this._colormap,r=this.symbolizerParameters.colormap;return r?t?r.length!==t.length||r.some((n,s)=>n!==t[s])?(this._colormapTexture=Me(this._colormapTexture),this._colormapTexture=J5(e,r),void(this._colormap=r)):void 0:(this._colormapTexture=J5(e,r),void(this._colormap=r)):(this._colormapTexture=Me(this._colormapTexture),void(this._colormap=null))}},pE=class{constructor(){this.waitingAgents=new Zt,this._upsampleInfo=null,this.loadingAgent=null,this.requestPromise=null,this.requestAbort=null,this.pendingUpdates=0}static acquire(e){const t=IM.acquire();return t._init(e),t}release(){this.dispose(),mE.delete(this),IM.release(this)}dispose(){this.loadingAgent=Me(this.loadingAgent),this.abortRequest(),this._unsetUpsampleInfo(),this.pendingUpdates=0,this._data=N0(this._data)}static prune(){IM.prune(0)}_init(e){this.waitingAgents.clear(),this._data=N0(this._data),this.dataMissing=!1,this.dataInvalidated=!1,this._unsetUpsampleInfo(),this.abortRequest(),this.loadingAgent=null,this.pendingUpdates=0,this._pool=e,this.elevationBounds=null}invalidateSourceData(){this.dataInvalidated=!0,this.dataMissing=!1,this._unsetUpsampleInfo()}abortRequest(){this.requestAbort=iu(this.requestAbort),this.requestPromise=null}get upsampleInfo(){return this._upsampleInfo}_unsetUpsampleInfo(){y(this._upsampleInfo)&&(this._upsampleInfo.tile.unrefMapData(),this._pool.release(this._upsampleInfo),this._upsampleInfo=null)}setUpsampleInfo(e,t){if(e===t||S(t))this._unsetUpsampleInfo();else{if(S(this._upsampleInfo))this._upsampleInfo=this._pool.acquire();else{if(this._upsampleInfo.tile===t)return;this._upsampleInfo.tile.unrefMapData()}t.refMapData(),DRe(e,t,this._upsampleInfo)}}get data(){return this._data}set data(e){N0(this._data),this._data=e}};const IM=new Fl(pE,null,()=>{}),mE=new Map;function KRe(){mE.size>0&&(console.log(`${mE.size} live TilePerLayerInfo allocations:`),mE.forEach(i=>console.log(i,`
`)))}let My=class{constructor(e){this._texture=e,this.type="tile-texture",this._refCount=1}retain(){++this._refCount}release(){--this._refCount,this._refCount===0&&this._texture.dispose()}get texture(){return this._texture}generateMipmap(){this._texture.generateMipmap()}get descriptor(){return this._texture.descriptor}};var Fe;(function(i){i[i.NONE=0]="NONE",i[i.NONE_HIT_MAXLOD=1]="NONE_HIT_MAXLOD",i[i.SPLIT=2]="SPLIT",i[i.VSPLITMERGE=4]="VSPLITMERGE",i[i.MERGE=8]="MERGE",i[i.RENDERDATA=16]="RENDERDATA",i[i.GEOMETRY=32]="GEOMETRY",i[i.TEXTURE_NOFADING=64]="TEXTURE_NOFADING",i[i.TEXTURE_FADING=128]="TEXTURE_FADING"})(Fe||(Fe={}));const LM=R(),J_=R(),Sn=R(),JRe=.1;let eAe=class{constructor(){this.fovX=0,this.fovY=0,this.relativeWidthLimit=0,this.relativeHeightLimit=0,this.maxLod=0,this.angledSplitBias=0,this.aboveGround=!0}},D4=class{constructor(){this.lij=[0,0,0],this._children=[null,null,null,null],this._pendingUpdates=0,this._dirty=!0,this._previouslyRendered=!1,this.extent=$t(),this._elevationBounds=be(),this.layerInfo=[[],[]],this.extentInRadians=$t(),this.centerAtSeaLevel=R(),this._center=[R(),ou(),R()],this.up=tre(),this._isWithinClippingArea=!0,this._intersectsClippingArea=!0,this._maxTesselation=0,this._usedMemory=null,this._mapTileMemoryInternal=0,this._mapDataRefCount=0,this._screenDepth=0,this.renderOrder=0,this._edgeLen=0,this._edgeLen2=0,this._curvatureHeight=0,this.extentMidX=0,this.extentMidY=0}static prune(){F4.prune(0),N4.prune(0),pE.prune()}get _isCached(){return!this.shouldLoad&&this._mapDataRefCount<=0}get maxTesselation(){return this._maxTesselation}get isWithinClippingArea(){return this._isWithinClippingArea}get intersectsClippingArea(){return this._intersectsClippingArea}get clippingArea(){return this._clippingArea}get parent(){return this._parent}get children(){return this._children}get surface(){return this._surface}get elevationBounds(){return this._elevationBounds}get level(){return this.lij[0]}get key(){return`${this.lij[0]}/${this.lij[1]}/${this.lij[2]}`}get edgeLen(){return this._edgeLen}get radius(){return this._center[Hs.MIDDLE][3]}get screenDepth(){return this._screenDepth}get visible(){return this._dirty&&this.computeVisibility(),this._visible}get frustumVisibility(){return this._dirty&&this.computeVisibility(),this._frustumVisibility}computeVisibility(){var r;this._dirty=!1;const e=((r=this.parent)==null?void 0:r.frustumVisibility)??xs.INTERSECTS;this._frustumVisibility=e===xs.INSIDE?xs.INSIDE:e===xs.OUTSIDE?xs.OUTSIDE:this._calculateFrustumVisibilityStatus(this.surface.frustum);const t=this._frustumVisibility!==xs.OUTSIDE&&this._intersectsClippingArea;t!==this._visible&&(this._visible=t,this._surface.emit("tiles-visibility-changed"),this._surface.renderer.setDirty(),this.updateAgentSuspension())}get loadable(){return this.visible||this._surface.view.state.fixedContentCamera}get rendered(){const e=!!this.renderData;return e!==this._previouslyRendered&&(this._surface.emit("tiles-visibility-changed"),this._previouslyRendered=e,this._surface.renderer.setDirty()),e}get shouldLoad(){const e=this._surface.snapLevel;if(y(e)){const t=this.level-e;if(t===0)return!0;if(t===1)return!1}return this.isLeaf}init(e,t,r){this.lij[0]=e[0],this.lij[1]=e[1],this.lij[2]=e[2],this.ellipsoid=Yt(r.tilingScheme.spatialReference),r.tilingScheme.getExtent(e[0],e[1],e[2],this.extent),r.tilingScheme.convertExtentToRadians(this.extent,this.extentInRadians),this.extentMidX=.5*(this.extent[0]+this.extent[2]),this.extentMidY=.5*(this.extent[1]+this.extent[3]),this._isWithinClippingArea=!0,this._intersectsClippingArea=!0,this._clippingArea=null,this._mapDataRefCount=0,r.upsampleMapCache.pop(this.key),this._edgeLen=0,this._edgeLen2=0,this._center[Hs.MIDDLE][3]=0,this.vlevel=e?e[0]:0,t&&t.elevationBounds?wn(this._elevationBounds,t.elevationBounds):Je(this._elevationBounds,0,0),this._pendingUpdates=0,this.renderData=null,this._screenDepth=0,this._visible=!1,this._previouslyRendered=!1,this._parent=t,this.unsetChildren(),this._surface=r,this.updateVisibility();for(const n of Bf){const s=r.numLayers(n),a=this.layerInfo[n];for(const o of a)o.release();a.length=s;for(let o=0;o<s;o++)a[o]=pE.acquire(this._surface.upsampleInfoPool),n===ut.ELEVATION&&this.findElevationBoundsForLayer(o,-1)}this.computeElevationBounds(),this._maxTesselation=Math.min(r.tilingScheme.pixelSize,K1)}release(){$h(!this.renderData,"tile.renderData was not unloaded"),this._surface.upsampleMapCache.pop(this.key);for(const e of Bf){for(const t of this.layerInfo[e])t.release();this.layerInfo[e].length=0}this._parent=null;for(let e=0;e<4;++e)this._children[e]=null;this._surface=null,this.setMemoryDirty()}refMapData(){++this._mapDataRefCount,this._isCached||this._surface.upsampleMapCache.pop(this.key)}unrefMapData(){if(--this._mapDataRefCount,this._isCached){this.setMemoryDirty();const e=this._cachedMemory;e>0&&this._surface.upsampleMapCache.put(this.key,this,e)}}setMemoryDirty(){this._usedMemory=null}get usedMemory(){return this._ensureUsedMemory()+(this._isCached?0:this._mapTileMemoryInternal)}get _cachedMemory(){return this._isCached?this._mapTileMemory:0}get _mapTileMemory(){return this._ensureUsedMemory(),this.layerInfo[ut.MAP].reduce((e,t)=>e+(t instanceof MM?t.memoryUsage:0),this._mapTileMemoryInternal)}get _cpuImageMemorySize(){const t=this._surface.tilingScheme.pixelSize;return t*t*4}_ensureUsedMemory(){if(y(this._usedMemory))return this._usedMemory;this._usedMemory=0,this._mapTileMemoryInternal=0;let e=0;for(const{data:r}of this.layerInfo[ut.MAP])r instanceof MM?e+=this._getTerrainDataMemory(r):this._mapTileMemoryInternal+=this._getTerrainDataMemory(r);const t=this._cpuImageMemorySize;for(const r of this.layerInfo[ut.ELEVATION])this._usedMemory+=r.data?t:0;return this.renderData&&(this._usedMemory+=this.renderData.estimatedGeometryMemoryUsage,this._mapTileMemoryInternal+=kE(this.renderData.textureDescriptor)),this._isCached&&this._surface.upsampleMapCache.updateSize(this.key,this,this._mapTileMemoryInternal+e),this._usedMemory}getUsedMemoryForLayer(e,t){const r=this.layerInfo[e][t];return r!=null&&r.data?e===ut.MAP?this._isCached?0:this._getTerrainDataMemory(r.data):e===ut.ELEVATION?this._cpuImageMemorySize:0:0}_getTerrainDataMemory(e){return e instanceof My?kE(e.texture):e instanceof HTMLImageElement||e instanceof FR?this._cpuImageMemorySize:e instanceof MM||e instanceof YRe?e.memoryUsage:0}updateScreenDepth(e){const t=this._center[Hs.MIDDLE],r=e,n=t[0],s=t[1],a=t[2],o=r[2]*n+r[6]*s+r[10]*a+r[14];this._screenDepth=o<0?0:o/(r[3]*n+r[7]*s+r[11]*a+r[15])}shouldSplit(e,t,r){if(!this.visible||y(e.frustum)&&(!this._intersectsClippingArea||this._calculateFrustumVisibilityStatus(e.frustum)===xs.OUTSIDE))return Fe.NONE;const n=this.level;ne(LM,this._center[Hs.MIDDLE],t);let s=Ml(LM),a=Hs.MIDDLE;ne(J_,this._center[Hs.TOP],t);const o=Ml(J_);o<s&&(s=o,a=Hs.TOP),ne(J_,this._center[Hs.BOTTOM],t);const l=Ml(J_);if(l<s&&(s=l,a=Hs.BOTTOM),this._edgeLen2>s&&n<e.maxLod)return Fe.SPLIT;const c=Math.sqrt(s),u=e.fovX*c*2,d=this._edgeLen/u,m=()=>{const x=n+Math.ceil(-Math.log2(e.relativeWidthLimit/d));return x!==this.vlevel?(this.vlevel=x,Fe.VSPLITMERGE):Fe.NONE_HIT_MAXLOD};if(y(r)&&r-n===1)return n>=e.maxLod?m():Fe.SPLIT;const f=me(this.up,LM),_=this._elevationBounds[1]-this._elevationBounds[0],g=_/this.edgeLen;if(e.aboveGround&&f>0&&g<.001&&f/c-Math.sin(this._curvatureHeight/(this.edgeLen*Math.SQRT1_2)*Math.PI)-g>0)return Fe.NONE;if(d<e.relativeWidthLimit)return this.vlevel!==this.level?(this.vlevel=this.level,Fe.VSPLITMERGE):Fe.NONE;if(n>=e.maxLod)return m();if(n>6){ne(J_,this._center[a],t),Q(Sn,this.up,f),ne(Sn,Sn,J_);const x=Ml(Sn);if(x>this.radius*this.radius){Q(Sn,Sn,this.radius/Math.sqrt(x)),oe(Sn,Sn,this._center[a]),ne(Sn,t,Sn);const b=Math.min(1,(Math.abs(me(Sn,this.up))+.5*_+this._curvatureHeight)/_e(Sn)),v=JRe/e.angledSplitBias,w=e.fovY*c*2;if(b*(this._edgeLen/w)<v*e.relativeHeightLimit)return Fe.NONE}}return Fe.SPLIT}setChildren(e,t,r,n){$h(!!(e&&t&&r&&n),"Null child passed"),this._children[0]=e,this._children[1]=t,this._children[2]=r,this._children[3]=n}unsetChildren(){this._children[0]=null,this._children[1]=null,this._children[2]=null,this._children[3]=null}get isLoaded(){var e;return((e=this.renderData)==null?void 0:e.hasGeometry)??!1}load(){this.refMapData();for(const e of Bf)this._createOrUpdateAgents(0,e);this.surface.renderer.loadTile(this)}unload(e){e.unloadTile(this);for(const t of Bf){const r=this.layerInfo[t];for(const n of r)n.loadingAgent&&n.loadingAgent!==za&&(ZC(n.loadingAgent),n.loadingAgent=null),n.pendingUpdates=0}this.resetPendingUpdate(Fe.GEOMETRY),this.resetPendingUpdate(Fe.TEXTURE_NOFADING),this.resetPendingUpdate(Fe.TEXTURE_FADING),this.unrefMapData()}unloadMapData(){const e=this.layerInfo[ut.MAP];for(const t of e)t.loadingAgent&&t.loadingAgent!==za&&(ZC(t.loadingAgent),t.loadingAgent=null),t.pendingUpdates=0;this.renderData&&this.renderData.releaseTexture(),this.setMemoryDirty()}updateClippingStatus(e){if(mg(e,this._clippingArea))return!1;const t=this._intersectsClippingArea,r=this._isWithinClippingArea;y(e)?(this._intersectsClippingArea=this.intersectsExtent(e),this._isWithinClippingArea=this._isWithinExtent(e)):(this._intersectsClippingArea=!0,this._isWithinClippingArea=!0),this._clippingArea=e,this.updateVisibility();const n=r&&this._isWithinClippingArea,s=!(r||t||this._isWithinClippingArea||this._intersectsClippingArea);return!this.renderData||n||s||this.setPendingUpdate(Fe.GEOMETRY),!0}updateVisibility(){this._dirty=!0,this._surface.setTileTreeDirty()}getLayerInfo(e,t){return this.layerInfo[t][e]}hasLayerData(e,t){const r=this.layerInfo[t][e];return!(!r||!r.data||r.dataInvalidated)}get updating(){if(this.hasPendingUpdates)return!0;for(const e of Bf){const t=this.layerInfo[e];for(const r of t)if(r.loadingAgent&&r.loadingAgent!==za&&r.loadingAgent.updating)return!0}return!1}_isSuspended(e){return!!this.hasPendingUpdate(Fe.SPLIT)||e!==ut.ELEVATION&&!this.loadable}get hasPendingUpdates(){return this._pendingUpdates!==0}hasPendingUpdate(e){return(this._pendingUpdates&e)===e}setPendingUpdate(e){this._pendingUpdates|=e,e===Fe.SPLIT||e===Fe.MERGE?this._surface.setTileTreeDirty():this._surface.requestUpdate()}resetPendingUpdate(e){return!!this.hasPendingUpdate(e)&&(this._pendingUpdates&=~e,!0)}requestLayerData(e,t,r){const n=this.layerInfo[t][e];if(n.waitingAgents.has(r))return console.warn("agent already requested this piece of map data (tile %s, agent tile %s, layer: %d/%d)",this.lij.toString(),r.tile.lij.toString(),t,e),!0;if(n.waitingAgents.push(r),n.data&&!n.dataInvalidated)return console.warn("agent requested existing data (tile %s, agent tile %s, layer: %d/%d)",this.lij.toString(),r.tile.lij.toString(),t,e),r.dataArrived(this),!0;if(n.requestPromise)return!0;iu(n.requestAbort),n.requestAbort=new AbortController;const s=this._surface.requestTileData(this,e,t,n.requestAbort);if(!s)return n.requestAbort=null,!1;const a=()=>{n.requestPromise===s&&(n.requestPromise=null,n.requestAbort=null)};return n.requestPromise=s,s.then(a,a),!0}get isLeaf(){return this._children[0]==null}hasLij(e){return this.lij[0]===e[0]&&this.lij[1]===e[1]&&this.lij[2]===e[2]}findByLij(e){return this.hasLij(e)?this:this.isLeaf?null:this._children[0].findByLij(e)||this._children[1].findByLij(e)||this._children[2].findByLij(e)||this._children[3].findByLij(e)||null}distanceToSquared(e){return Ml(ne(Sn,this._center[Hs.MIDDLE],e))}containsPoint(e){const t=this.extent;return e[0]>=t[0]&&e[1]>=t[1]&&e[0]<=t[2]&&e[1]<=t[3]}containsPointXY(e,t){const r=this.extent;return e>=r[0]&&t>=r[1]&&e<=r[2]&&t<=r[3]}unrequestLayerData(e,t,r){const n=this.layerInfo[t][e],s=n.waitingAgents,a=s.removeUnordered(r)!=null;$h(a,"agent has not requested this piece of map data"),s.length<1&&(n.abortRequest(),this.setMemoryDirty())}dataArrived(e,t,r){const n=this.layerInfo[t][e];n.data=r,n.dataInvalidated=!1,n.waitingAgents.forAll(s=>s.dataArrived(this)),n.waitingAgents.clear(),this.setMemoryDirty()}dataMissing(e,t,r){r.notInTilemap||console.error(`Tile ${this.lij.toString()} layer ${t}/${e} error ${r}`);const n=this.layerInfo[t][e];n.dataMissing=!0,n.waitingAgents.forAll(s=>s.dataMissing()),n.waitingAgents.clear(),this.setMemoryDirty()}updateRenderData(e,t){switch(e){case ut.MAP:return this._updateTexture(t);case ut.ELEVATION:return this._updateGeometry()}}_updateTexture(e){this.renderData&&(this.resetPendingUpdate(e===fn.FADING?Fe.TEXTURE_NOFADING:Fe.TEXTURE_FADING),this.setPendingUpdate(e===fn.FADING?Fe.TEXTURE_FADING:Fe.TEXTURE_NOFADING))}_updateGeometry(){this.setPendingUpdate(Fe.GEOMETRY);for(const e of this.layerInfo[ut.ELEVATION])e.pendingUpdates|=Fe.GEOMETRY}invalidateLayerData(e,t){this.layerInfo[t][e].invalidateSourceData(),this.restartAgents(t)}computeElevationBounds(){const e=this._elevationBounds;Je(e,1/0,-1/0);const t=this.layerInfo[ut.ELEVATION];let r=!0;for(const n of t)y(n.elevationBounds)&&(e[0]=Math.min(e[0],n.elevationBounds.min),e[1]=Math.max(e[1],n.elevationBounds.max),n.elevationBounds.hasNoDataValues||(r=!1));r&&(e[0]=Math.min(e[0],0),e[1]=Math.max(e[1],0)),this.updateRadiusAndCenter(),this._surface.setTileTreeDirty()}_updateCenter(){const e=this._elevationBounds,t=.5*(e[0]+e[1]);Q(Sn,this.up,t),oe(this._center[Hs.MIDDLE],this.centerAtSeaLevel,Sn),Q(Sn,this.up,e[0]),oe(this._center[Hs.TOP],this.centerAtSeaLevel,Sn),Q(Sn,this.up,e[1]),oe(this._center[Hs.BOTTOM],this.centerAtSeaLevel,Sn)}findElevationBoundsForLayer(e,t){const r=this.layerInfo[ut.ELEVATION][e];if(y(r.elevationBounds)&&r.elevationBounds.level>=t)return;const n=this._surface.layerViewByIndex(e,ut.ELEVATION),s=m$(n);if(!aw(this,s,!1))return;const a=iAe;let o=!1;if(r.data){const l=r.data;a.min=l.bounds[0],a.max=l.bounds[1],a.hasNoDataValues=l.hasNoDataValues,a.level=this.level,o=!0}else{let l,c,u=0;for(let d=this._parent;d&&(!c||u<KS(this.level))&&(u=this.vlevel-d.level,l=c||l,c=d.layerInfo[ut.ELEVATION][e].data,!(!c&&l&&u>=KS(this.level)));d=d.parent);c=c||l,c&&(c.computeMinMaxValue(this.lij[0],this.lij[1],this.lij[2],a),a.min!==1/0&&(a.level=c.level,o=!0))}o&&(S(r.elevationBounds)&&(r.elevationBounds=new v0),r.elevationBounds.copyFrom(a))}modifyLayers(e,t,r){const n=this.layerInfo[r];for(const o of n)o.loadingAgent&&o.loadingAgent!==za&&(ZC(o.loadingAgent),o.loadingAgent=null),o.waitingAgents.clear();for(let o=0;o<n.length;++o)e[o]===void 0&&n[o].release();const s=new Array(...n),a=t.length;n.length=a;for(let o=0;o<a;o++){const l=t[o];n[o]=l>-1?s[l]:pE.acquire(this._surface.upsampleInfoPool)}this.setMemoryDirty()}restartAgents(e){this.renderData&&(this._createOrUpdateAgents(0,e),this.updateRenderData(e,fn.FADING))}updateAgents(e){if(this.renderData){const t=this.layerInfo[e];for(const r of t)r.loadingAgent===za&&(r.loadingAgent=null);this._createOrUpdateAgents(0,e)}}updateAgentSuspension(){for(const e of Bf){const t=this._isSuspended(e);for(const r of this.layerInfo[e])r.loadingAgent&&r.loadingAgent!==za&&(r.loadingAgent.setSuspension(t),r.loadingAgent===za&&this.updateRenderData(e,fn.FADING))}}removeLayerAgent(e,t){const r=this.layerInfo[t][e];r.loadingAgent&&r.loadingAgent!==za&&r.loadingAgent.dispose(),r.loadingAgent=null}agentDone(e,t){const r=this.layerInfo[t][e];r.loadingAgent=za,!r.data&&S(r.upsampleInfo)&&this._createOrUpdateAgents(e+1,t)}_hasBlendableAncestor(e){return e.blendMode!=="normal"||uv(e.parent)&&this._hasBlendableAncestor(e.parent)}_hasBlendModes(e,t,r){var n,s,a;for(let o=e;o<t;++o){const l=this._surface.layerViewByIndex(o,r);if(uP(l)&&((n=l==null?void 0:l.layer)==null?void 0:n.blendMode)!=="normal"||uv((s=l==null?void 0:l.layer)==null?void 0:s.parent)&&this._hasBlendableAncestor((a=l==null?void 0:l.layer)==null?void 0:a.parent))return!0}return!1}_createOrUpdateAgents(e,t){const r=this.layerInfo[t];if(r.length===0)return;const n=this._isSuspended(t);for(let s=e;s<r.length;++s){const a=r[s];let o=!1;const l=this._surface.layerViewByIndex(s,t),c=m$(l);if(a.loadingAgent?aw(this,c,!1)?(a.loadingAgent!==za&&a.loadingAgent.setSuspension(n),a.loadingAgent!==za&&(o=a.loadingAgent.update())):a.dispose():aw(this,c,!1)&&(a.loadingAgent=tAe(this,s,t,n),o=a.loadingAgent.startLoading(),o?a.loadingAgent===za&&this.setPendingUpdate(Fe.GEOMETRY):(ZC(a.loadingAgent),a.loadingAgent=za)),a.loadingAgent===za&&this.updateRenderData(t,fn.FADING),!this._hasBlendModes(e,r.length,t)&&o&&l.isOpaque)return}}_isWithinExtent(e){const t=this.extent;return t[0]>=e[0]&&e[2]>=t[2]&&t[1]>=e[1]&&e[3]>=t[3]}intersectsExtent(e){const t=this.extent;return t[2]>=e[0]&&e[2]>=t[0]&&t[3]>=e[1]&&e[3]>=t[1]}getElevationBasedVerticesPerSide(e){const t=this.vlevel-this.level,r=Math.max(this.level-e,KS(this.level)-t);return ce(1+(this.maxTesselation>>r),2,this.maxTesselation+1)}get test(){return{cachedMemory:this._cachedMemory}}_findLIJ(e,t){if(!e)return null;const r=this.surface.rootTiles;if(y(r)){for(const n of r)if(rAe(n,e)){let s=n,a=e[0]-s.level-1;for(;a>=0&&!s.isLeaf&&!t(s);){const o=e[1]>>a&1,l=e[2]>>a&1;s=s.children[2*o+l],a--}return t(s)?s:null}}return null}findNeighborTile(e,t){const r=this.lij,n=this.getNeighborLIJ(r,e);return n?nAe(r,n)?t(this)?this:null:this._findLIJ(n,t):null}findCorner(e,t){const r=e===ke.NORTH_EAST?1:e===ke.NORTH_WEST?0:e===ke.SOUTH_WEST?2:3;let n=this;for(;!(n.isLeaf||t&&t(n));)n=n.children[r];return n}findNeighborCornerTileExact(e,t){var r;return(r=this.findNeighborTile(e,n=>t(n)||n.level===this.level))==null?void 0:r.findCorner(_$(e),t)}forAllSubtreeOnSide(e,t){const r=e===ke.NORTH?[0,1]:e===ke.NORTH_EAST?[1]:e===ke.EAST?[1,3]:e===ke.SOUTH_EAST?[3]:e===ke.SOUTH?[2,3]:e===ke.SOUTH_WEST?[2]:e===ke.WEST?[0,2]:[0],n=s=>{t(s)||s.isLeaf||r.forEach(a=>n(s.children[a]))};n(this)}forallNeighbors(e){pP.forEach(t=>this.findNeighborCornerTileExact(t,e)),jh.forEach(t=>{var r;return(r=this.findNeighborTile(t,n=>n.level===this.level||e(n)))==null?void 0:r.forAllSubtreeOnSide(dP(t),e)})}getNeighborEdgeStartVertexIndex(e,t){if(!t)return 0;const r=this.level-t.level;if(pe(!gn||r>=0),r===0)return 0;const n=2**r,s=(1&e)==1,a=s?0:1,o=t.lij[a+1]*n,l=this.lij[a+1],c=l-o,u=s?n-1-c:c;return gn&&(pe(o<=l&&l<o+n),pe(0<=u&&u<n)),u}forEachLoadedNeighbor(e){const t=this.level,r=n=>n.level===t||n.isLoaded;jh.forEach(n=>{const s=this.findNeighborTile(n,r);s!=null&&s!==this&&s.forAllSubtreeOnSide(dP(n),a=>!!a.isLoaded&&(e(a,n),!0))}),pP.forEach(n=>{var a;const s=(a=this.findNeighborTile(n,r))==null?void 0:a.findCorner(_$(n),o=>o.isLoaded);pe(!s||x$(this,s,n)),s!=null&&s.isLoaded&&e(s,n)})}getNeighborLIJ(e,t){const r=Tz(t)?-1:xz(t)?1:0,n=bz(t)?-1:wz(t)?1:0,s=[e[0],e[1]+r,e[2]+n];return s[1]<0?null:this.surface.isGlobal?this.wrapLIJ(s):s[2]<0?null:s}wrapLIJ(e){return!e||e[1]<0||e[1]>=2**e[0]?null:this.surface.wrapEastWest(e)}get westNeighborWestExtent(){return this.extent[0]*(this.isWestEnd?-1:1)}get eastNeighborEastExtent(){return this.extent[2]*(this.isEastEnd?-1:1)}get isEastEnd(){return this.lij[2]===this.surface.lijEastEnd(this.level)-1}get isWestEnd(){return this.lij[2]===0}get isNorthEnd(){return this.lij[1]===0}get isSouthEnd(){return this.extent[1]+hD()>=this.surface.extent[1]}compareLIJs(e){const t=this.lij,r=t[0],n=e[0];if(r===n)return[t,e];const s=r-n;if(s<0){const a=2**-s;return[[n,t[1]*a,t[2]*a],e]}{const a=2**s;return[t,[r,e[1]*a,e[2]*a]]}}checkGeometryWaterproofness(){cP&&(pe(this.isLoaded),this.renderData.checkGeometryWaterproofness())}shouldHaveNeighbor(e){const t=this.extent,r=this.surface.rootTilesExtent,n=.25*(t[2]-t[0]);if(Tz(e)&&t[3]+n>=r[3]||xz(e)&&t[1]-n<=r[1])return!1;const s=this.surface.isGlobal;return!(!s&&bz(e)&&t[0]-n<=r[0])&&!(!s&&wz(e)&&t[2]+n>=r[2])}};function tAe(i,e,t,r){const n=t===ut.ELEVATION?N4.acquire():F4.acquire();return n.init(i,e,t,r),n}function ZC(i){i.dispose(),i instanceof zK?N4.release(i):i instanceof BK&&F4.release(i)}const F4=new Fl(BK),N4=new Fl(zK),iAe=new v0;var Hs;function rAe(i,e){const t=i.level,r=e[0];if(t>r)return!1;const n=r-t,s=Math.floor(e[1]/2**n),a=Math.floor(e[2]/2**n);return s===i.lij[1]&&a===i.lij[2]}function nAe(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]}function id(i,e,t){return Math.abs(i-e)<=t}function sAe(i,e,t){if(S(i)||S(e))return!1;if(i.level===0&&e.level===0&&(i.isEastEnd&&e.isWestEnd&&t===ke.EAST||i.isWestEnd&&e.isEastEnd&&t===ke.WEST))return!0;const r=Math.max(1e-6*(i.extent[2]-i.extent[0]),1);switch(t){case ke.NORTH:return id(i.extent[3],e.extent[1],r);case ke.SOUTH:return id(i.extent[1],e.extent[3],r);case ke.EAST:return id(i.extent[2],e.extent[0],r)||id(i.extent[2],-e.extent[0],r);case ke.WEST:return id(i.extent[0],e.extent[2],r)||id(i.extent[0],-e.extent[2],r)}}function x$(i,e,t){return!S(i)&&!S(e)&&e!==i&&(i.level>=e.level?Lz(i,e,t):Lz(e,i,_$(t)))}function Lz(i,e,t){pe(i.level>=e.level);const r=NPe(t),n=kPe(t),s=i.extent,a=e.extent,o=[r?s[0]:s[2],n?s[3]:s[1]],l=[r?a[2]:a[0],n?a[1]:a[3]],c=1e-5*(s[2]-s[0]),u=id(o[0],l[0],c)||i.surface.isGlobal&&id(o[0],-l[0],c),d=id(o[1],l[1],c);if(u&&d)return!0;if(i.level===e.level||!u&&!d)return pe(!1),!1;const m=u?$z(a[1],a[3],s[1],s[3],c):$z(a[0],a[2],s[0],s[2],c);return pe(m),m}function $z(i,e,t,r,n=hD()){return i-n<=t&&t<=r&&r<=e+n}(function(i){i[i.TOP=0]="TOP",i[i.MIDDLE=1]="MIDDLE",i[i.BOTTOM=2]="BOTTOM"})(Hs||(Hs={}));let aAe=class{constructor(){this._scales=Bi(-1,-1,-1,-1),this._offsets=Bi(-1,-1,-1,-1)}clear(){this._scales[0]=this._scales[1]=this._scales[2]=this._scales[3]=-1,this._offsets[0]=this._offsets[1]=this._offsets[2]=this._offsets[3]=-1}setScale(e,t,r){this._scales[2*e]=t,this._scales[2*e+1]=r}setOffset(e,t,r){this._offsets[2*e]=t,this._offsets[2*e+1]=r}get scales(){return this._scales}get offsets(){return this._offsets}};function oAe(i,e){i.varyings.add("tbnTangent","vec3"),i.varyings.add("tbnBiTangent","vec3"),e.spherical?i.vertex.code.add(O`void forwardVertexTangent(vec3 n) {
tbnTangent = normalize(cross(vec3(0.0, 0.0, 1.0), n));
tbnBiTangent = normalize(cross(n, tbnTangent));
}`):i.vertex.code.add(O`void forwardVertexTangent(vec3 n) {
tbnTangent = vec3(1.0, 0.0, 0.0);
tbnBiTangent = normalize(cross(n, tbnTangent));
}`),i.fragment.code.add(O`mat3 getTBNMatrix(vec3 n) {
return mat3(tbnTangent, tbnBiTangent, n);
}`)}let k4=class extends Gse{constructor(){super(...arguments),this.slicePlaneLocalOrigin=R(),this.origin=this.slicePlaneLocalOrigin}};var Zo,yr;(function(i){i[i.Material=0]="Material",i[i.ShadowMap=1]="ShadowMap",i[i.Highlight=2]="Highlight"})(Zo||(Zo={})),function(i){i[i.Color=0]="Color",i[i.Alpha=1]="Alpha",i[i.Depth=2]="Depth",i[i.Normal=3]="Normal",i[i.ObjectAndLayerIdColor=4]="ObjectAndLayerIdColor"}(yr||(yr={}));let lAe=class extends k4{constructor(){super(...arguments),this.identifier=Zo.Material,this.transparent=!1,this.integratedMesh=!1}},cAe=class extends k4{constructor(){super(...arguments),this.identifier=Zo.ShadowMap}},hAe=class extends k4{constructor(){super(...arguments),this.identifier=Zo.Highlight}},mP=class extends Jg{constructor(e,t){super(e,"vec4",AD.Draw,(r,n,s)=>r.setUniform4fv(e,t(n,s)))}};var bd;function uAe(i,e){const{vertex:t,fragment:r}=i;t.uniforms.add([new mP("overlayTexOffset",(n,s)=>dAe(n,s)),new mP("overlayTexScale",(n,s)=>pAe(n,s))]),r.constants.add("overlayOpacity","float",1),r.uniforms.add(new Bt("ovColorTex",(n,s)=>T$(n,s))),qK(i,e)}function qK(i,e){i.extensions.add("GL_OES_standard_derivatives"),e.pbrMode!==zr.Water&&e.pbrMode!==zr.WaterOnIntegratedMesh||i.include(jre,e);const{vertex:t,fragment:r}=i;i.varyings.add("vtcOverlay","vec4"),t.code.add(O`void setOverlayVTC(in vec2 uv) {
vtcOverlay = vec4(uv, uv) * overlayTexScale + overlayTexOffset;
}`),r.code.add(O`bool isValid(vec2 uv, vec2 dxdy) {
return (uv.x >= 0.0 + dxdy.x) && (uv.x <= 1.0 - dxdy.x) && (uv.y >= 0.0 + dxdy.y) && (uv.y <= 1.0 - dxdy.y);
}
vec4 getOverlayColor(sampler2D ov0Tex, vec4 texCoords) {
vec4 color0 = texture2D(ov0Tex, vec2(texCoords.x * 0.5, texCoords.y));
vec4 color1 = texture2D(ov0Tex, vec2(texCoords.z * 0.5 + 0.5, texCoords.w));
bool isValid0 = isValid(texCoords.xy, fwidth(texCoords.xy));
bool isValid1 = isValid(texCoords.zw, vec2(0.0, 0.0));
return mix(color1 * float(isValid1), color0, float(isValid0));
}`),r.code.add(O`vec4 getCombinedOverlayColor() {
return overlayOpacity * getOverlayColor(ovColorTex, vtcOverlay);
}`),e.pbrMode!==zr.Water&&e.pbrMode!==zr.WaterOnIntegratedMesh||(OP(r),SD(r),r.code.add(O`vec4 getOverlayWaterColor(vec4 maskInput, vec4 colorInput, vec3 vposEyeDir,
float shadow, vec3 localUp, mat3 tbn, vec3 position, vec3 positionWorld) {
vec3 n = normalize(tbn *  (2.0 * maskInput.rgb - vec3(1.0)));
vec3 v = vposEyeDir;
vec3 final = getSeaColor(n, v, mainLightDirection, colorInput.rgb, mainLightIntensity, localUp, 1.0 - shadow, maskInput.w, position, positionWorld);
return vec4(final, colorInput.w);
}`))}function T$(i,e){return e.overlays.length===0?null:i.identifier===Zo.Material&&i.subPass===yr.Color?e.overlays[ki.INNER].getColorTextureNoRasterImage():i.identifier===Zo.Highlight?e.overlays[ki.INNER].getValidTexture(er.Highlight):null}function dAe(i,e){for(const t of e.overlays){const{index:r,extent:n}=t;iG(n)>0&&(k0[2*r]=i.toMapSpace[0]/Nh(n)-n[0]/Nh(n),k0[2*r+1]=i.toMapSpace[1]/Om(n)-n[1]/Om(n))}return k0}function pAe(i,e){for(const t of e.overlays){const{index:r,extent:n}=t;iG(n)>0&&(k0[2*r]=i.toMapSpace[2]/Nh(n),k0[2*r+1]=i.toMapSpace[3]/Om(n))}return k0}(function(i){i[i.Disabled=0]="Disabled",i[i.Enabled=1]="Enabled",i[i.EnabledWithWater=2]="EnabledWithWater",i[i.COUNT=3]="COUNT"})(bd||(bd={}));const k0=_i();var qh;(function(i){i[i.LayerOnly=0]="LayerOnly",i[i.ColorComposite=1]="ColorComposite",i[i.GridComposite=2]="GridComposite",i[i.COUNT=3]="COUNT"})(qh||(qh={}));let mAe=class extends Ir{constructor(){super(...arguments),this.overlayOpacity=1}};function YC(i,e){i.vertex.uniforms.add([new fP("overlayTexOffset"),new fP("overlayTexScale")]),i.fragment.uniforms.add([new Tt("overlayOpacity",t=>t.overlayOpacity),new Bt("ovColorTex",(t,r)=>r.overlays.length===0?null:r.overlays[ki.INNER].getColorTexture(t.overlaySource))]),qK(i,e)}function fAe(i,e){const{vertex:t,fragment:r,varyings:n}=i;n.add("vtc","vec2"),t.uniforms.add(new fP("texOffsetAndScale")),r.uniforms.add(new Dz("tex")),r.uniforms.add(new $M("textureOpacities"));const s=e.textureFadingEnabled&&!e.renderOccluded;s&&(t.uniforms.add(new fP("nextTexOffsetAndScale")),n.add("nvtc","vec2"),r.uniforms.add(new Dz("texNext")),r.uniforms.add(new $M("nextTexOpacities")),r.uniforms.add(new gAe("fadeFactor")));const a=e.tileBlendInput===qh.ColorComposite,o=e.tileBlendInput===qh.GridComposite;o&&r.include($4),a&&r.uniforms.add(new $M("backgroundColor")),t.code.add(O`
  void forwardTextureCoordinatesWithTransform(in vec2 uv) {
    vtc = uv * texOffsetAndScale.zw + texOffsetAndScale.xy;
    ${s?O`nvtc = uv * nextTexOffsetAndScale.zw + nextTexOffsetAndScale.xy;`:O``}
  }`),r.code.add(O`
    vec4 getColor(vec4 color, vec2 uv, vec3 opacities) {
      ${o||a?O`
              if (opacities.y <= 0.0) {
                return color * opacities.z * opacities.x;
              }
              vec4 bg = ${a?O`vec4(backgroundColor, 1.0)`:O`gridColor(uv)`} * opacities.y;
              float alpha = opacities.z * color.a;
              return mix(bg, color, alpha) * opacities.x;`:O`return color;`}
    }`),s?r.code.add(O`vec4 getTileColor() {
vec4 color = getColor(texture2D(tex, vtc), vtc, textureOpacities);
if (fadeFactor >= 1.0) {
return color;
}
vec4 nextColor = getColor(texture2D(texNext, nvtc), nvtc, nextTexOpacities);
return mix(nextColor, color, fadeFactor);
}`):r.code.add(O`vec4 getTileColor() {
return getColor(texture2D(tex, vtc), vtc, textureOpacities);
}`)}let gAe=class extends Jg{constructor(e){super(e,"float")}},$M=class extends Jg{constructor(e){super(e,"vec3")}},fP=class extends Jg{constructor(e){super(e,"vec4")}},Dz=class extends Jg{constructor(e){super(e,"sampler2D")}},WK=class extends mAe{};function _Ae(i){const e=new Yi,{vertex:t,fragment:r,varyings:n}=e;e.include(yne),e.include(Hse,i),e.include(AP,i);const s=()=>{e.include(Cae,i),t.code.add(O`
  vec3 decodeNormalTerrain(vec2 e) {
    float z = 1.0 - abs(e.x) - abs(e.y);
    vec3 n = vec3(e + vec2(e.x >= 0.0 ? 1.0 : -1.0, e.y >= 0.0 ? 1.0 : -1.0) * min(z,0.0),z);
    return normalize(n);
  }

  vec3 getNormal() {
    return  ${i.shading?O`normalize(decodeNormalTerrain(normalCompressed))`:O`getLocalUp(position, localOrigin)`};
  }
  `)};qre(t,i),e.include(HG,i);const a=i.overlayMode!==bd.Disabled;switch(i.output){case k.Color:{e.include(fAe,i),e.include(NE,i);const o=i.overlayMode===bd.EnabledWithWater;a&&e.include(YC,{...i,pbrMode:zr.Water}),o&&e.include(oAe,i),n.add("vnormal","vec3"),n.add("vpos","vec3"),s(),(i.atmosphere||i.screenSizePerspective)&&A5(t);const l=i.receiveShadows&&!i.renderOccluded;l&&e.include(DG,i),i.atmosphere&&n.add("wnormal","vec3"),i.screenSizePerspective&&(n.add("screenSizeDistanceToCamera","float"),n.add("screenSizeCosAngle","float")),t.code.add(O`
        void main(void) {
          //Position
          vpos = position;
          vec3 positionWorld = position + localOrigin;
          gl_Position = transformPosition(proj, view, vpos);

          //Normal
          vnormal = getNormal();

          ${o?O`forwardVertexTangent(vnormal);`:O``}

          ${i.atmosphere?O`
          wnormal = normalize((viewNormal * vec4(normalize(positionWorld), 1.0)).xyz);`:""}

          //Texture UV
          vec2 uv = getUV0();
          forwardTextureCoordinatesWithTransform(uv);
          ${a?O`setOverlayVTC(uv);`:""}
          ${i.tileBorders?O`forwardTextureCoordinates();`:""}

          ${i.screenSizePerspective?O`
          vec3 viewPos = (view * vec4(vpos, 1.0)).xyz;
          screenSizeDistanceToCamera = length(viewPos);
          vec3 viewSpaceNormal = (viewNormal * vec4(normalize(positionWorld), 1.0)).xyz;
          screenSizeCosAngle = abs(viewSpaceNormal.z);`:""}

          ${l?O`forwardLinearDepth();`:""}

        }
      `),e.extensions.add("GL_OES_standard_derivatives"),e.extensions.add("GL_EXT_shader_texture_lod"),e.include(cH,i),e.include(NE,i),e.include(Kre,i),e.include(_G,i),o&&Wre(r,i),Jre(r),CG(r),r.uniforms.add([t.uniforms.get("localOrigin"),new Rs("viewDirection",(c,u)=>he(Fz,Z(Fz,u.camera.viewMatrix[12],u.camera.viewMatrix[13],u.camera.viewMatrix[14])))]),o&&r.uniforms.add([new Bt("ovWaterTex",(c,u)=>u.overlays.length===0?null:u.overlays[ki.INNER].getNormalTexture(c.overlaySource)),new Xre("view",(c,u)=>ru(yAe,u.camera.viewMatrix,c.origin))]),r.code.add(O`const float sliceOpacity = 0.2;
float lum(vec3 c) {
return (min(min(c.r, c.g), c.b) + max(max(c.r, c.g), c.b)) * 0.5;
}`),OP(r),SD(r),r.code.add(O`
        void main() {
          vec3 normal = normalize(vnormal);
          float vndl = dot(normal, mainLightDirection);

          float additionalAmbientScale = smoothstep(0.0, 1.0, clamp(vndl*2.5, 0.0, 1.0));
          float shadow = ${i.receiveShadows&&!i.renderOccluded?"readShadowMap(vpos, linearDepth)":i.spherical&&i.shading?"lightingGlobalFactor * (1.0 - additionalAmbientScale)":"0.0"};

          float ssao = evaluateAmbientOcclusionInverse();
          vec4 tileColor = getTileColor();

          ${a?O`
              vec4 overlayColorOpaque = getOverlayColor(ovColorTex, vtcOverlay);
              vec4 overlayColor = overlayOpacity * overlayColorOpaque;
              ${i.transparent?O`if (overlayColor.a == 0.0) { discard; }`:""}
              vec4 groundColor = tileColor;
              tileColor = tileColor * (1.0 - overlayColor.a) + overlayColor;`:""}
          if (rejectBySlice(vpos)) {
            tileColor *= sliceOpacity;
          }
          ${i.atmosphere?O`
              float ndotl = clamp(vndl, 0.0, 1.0);
              vec3 atm = vec3(clamp(1.0 - dot(-viewDirection, wnormal), 0.0, 1.0));
              atm *= clamp(1.0 - lum(tileColor.rgb) * 1.5, 0.0, 1.0); // avoid atmosphere on bright base maps
              atm *= clamp(ndotl * 2.0, 0.0, 1.0); // avoid atmosphere on dark side of the globe
              atm *= tileColor.a; // premultiply with tile alpha`:""}

          vec3 albedo = ${i.atmosphere?O`atm + tileColor.rgb;`:O`tileColor.rgb;`}

          // heuristic shading function used in the old terrain, now used to add ambient lighting

          vec3 additionalLight = ssao * mainLightIntensity * additionalAmbientScale * ambientBoostFactor * lightingGlobalFactor;

          gl_FragColor = vec4(evaluateSceneLighting(normal, albedo, shadow, 1.0 - ssao, additionalLight), tileColor.a);
          ${o?O`
              vec4 overlayWaterMask = getOverlayColor(ovWaterTex, vtcOverlay);
              float waterNormalLength = length(overlayWaterMask);
              if (waterNormalLength > 0.95) {
                mat3 tbnMatrix = mat3(tbnTangent, tbnBiTangent, vnormal);
                vec4 waterOverlayColor = vec4(overlayColor.w > 0.0 ? overlayColorOpaque.xyz/overlayColor.w : vec3(1.0), overlayColor.w);
                vec4 viewPosition = view*vec4(vpos, 1.0);
                vec4 waterColorLinear = getOverlayWaterColor(overlayWaterMask, waterOverlayColor, -normalize(vpos - cameraPosition), shadow, vnormal, tbnMatrix, viewPosition.xyz,  vpos + localOrigin);
                vec4 waterColorNonLinear = delinearizeGamma(vec4(waterColorLinear.xyz, 1.0));
                // un-gamma the ground color to mix in linear space
                gl_FragColor = mix(groundColor, waterColorNonLinear, waterColorLinear.w);
              }`:""}
          ${i.screenSizePerspective?O`
            float perspectiveScale = screenSizePerspectiveScaleFloat(1.0, screenSizeCosAngle, screenSizeDistanceToCamera, vec4(0.0, 0.0, 0.0, 0.0));
            if (perspectiveScale <= 0.25) {
              gl_FragColor = mix(gl_FragColor, vec4(1.0, 0.0, 0.0, 1.0), perspectiveScale * 4.0);
            }
            else if (perspectiveScale <= 0.5) {
              gl_FragColor = mix(gl_FragColor, vec4(0.0, 0.0, 1.0, 1.0), (perspectiveScale - 0.25) * 4.0);
            }
            else if (perspectiveScale >= 0.99) {
              gl_FragColor = mix(gl_FragColor, vec4(0.0, 1.0, 0.0, 1.0), 0.2);
            }
            else {
              gl_FragColor = mix(gl_FragColor, vec4(1.0, 0.0, 1.0, 1.0), (perspectiveScale - 0.5) * 2.0);
            }`:""}
          ${i.visualizeNormals?i.spherical?O`
              vec3 localUp = normalize(vpos + localOrigin);
              vec3 right = normalize(cross(vec3(0.0,0.0,1.0),localUp));
              vec3 forward = normalize(cross(localUp,right));
              mat3 tbn = mat3(right, forward, localUp);
              vec3 tNormal = normalize(normal* tbn);
              gl_FragColor = vec4(vec3(0.5) + 0.5 * tNormal, 0.0);
          `:O`
          vec3 tNormal = normalize(normal);
          gl_FragColor = vec4(vec3(0.5) + 0.5 * tNormal, 0.0);
      `:""}
          ${i.tileBorders?O`
              vec2 dVuv = fwidth(vuv0);
              vec2 edgeFactors = smoothstep(vec2(0.0), 1.5 * dVuv, min(vuv0, 1.0 - vuv0));
              float edgeFactor = 1.0 - min(edgeFactors.x, edgeFactors.y);
              gl_FragColor = mix(gl_FragColor, vec4(1.0, 0.0, 0.0, 1.0), edgeFactor);`:""}
          gl_FragColor = highlightSlice(gl_FragColor, vpos);
        }
      `)}break;case k.Depth:e.include(YC,i),e.include(LI,i),D5(e),F5(e),t.code.add(O`
              void main(void) {
                ${a?O`setOverlayVTC(getUV0());`:""}
                gl_Position = transformPositionWithDepth(proj, view, position, nearFar, linearDepth);
              }
          `),r.code.add(O`
              void main() {
                ${a?O`
                  vec4 overlayColor = getCombinedOverlayColor();
                  ${i.transparent?O`if (overlayColor.a == 0.0) { discard; }`:""}`:""}
                outputDepth(linearDepth);
              }
          `);break;case k.Shadow:case k.ShadowHighlight:case k.ShadowExludeHighlight:e.include(LI,i),D5(e),F5(e),t.code.add(O`void main(void) {
gl_Position = transformPositionWithDepth(proj, view, position, nearFar, linearDepth);
}`),r.code.add(O`void main() {
outputDepth(linearDepth);
}`);break;case k.Normal:n.add("vnormal","vec3"),A5(t),s(),t.code.add(O`void main(void) {
vec3 normal = getNormal();
gl_Position = transformPosition(proj, view, position);
vnormal = normalize((viewNormal * vec4(normal, 1.0)).xyz);
}`),r.code.add(O`void main() {
vec3 normal = normalize(vnormal);
if (gl_FrontFacing == false) {
normal = -normal;
}
gl_FragColor = vec4(vec3(0.5) + 0.5 * normal, 0.0);
}`);break;case k.Highlight:e.include(YC,i),t.code.add(O`void main() {
setOverlayVTC(getUV0());
gl_Position = transformPosition(proj, view, position);
}`),e.include(hH,i),r.code.add(O`void main() {
vec4 overlayColor = getCombinedOverlayColor();
if (overlayColor.a == 0.0) {
discard;
}
outputHighlight();
}`)}return i.output===k.ObjectAndLayerIdColor&&(e.include(YC,{...i,pbrMode:zr.Disabled}),t.code.add(O`void main(void) {
gl_Position = transformPosition(proj, view, position);
setOverlayVTC(getUV0());
}`),r.code.add(O`
        void main() {
          vec2 texDim =  ${Nx(i,"ovColorTex")};
          gl_FragColor =  ${Ko(i,"ovColorTex","vec2(vtcOverlay.x * 0.5, vtcOverlay.y)*texDim")};
        }
    `)),e}const yAe=ve(),Fz=R(),vAe=Object.freeze(Object.defineProperty({__proto__:null,TerrainPassParameters:WK,build:_Ae},Symbol.toStringTag,{value:"Module"}));let XK=class QK extends ti{constructor(){super(...arguments),this.useStencil=!1}initializeConfiguration(e,t){t.hasWebGL2Context=e.rctx.type===Nn.WEBGL2,t.spherical=e.viewingMode===Se.Global}initializeProgram(e){return new Jt(e.rctx,QK.shader.get().build(this.configuration),ZK)}initializePipeline(){return this._stencilPipelineState=this._createPipeline(!0),this._createPipeline(!1)}_createPipeline(e){const t=this.configuration,r=t.backfaceCullingEnabled&&!t.renderOccluded;return Ke({blending:t.renderOccluded?lu(de.ONE,de.ONE_MINUS_SRC_ALPHA):null,culling:r&&wG,depthTest:!t.renderOccluded&&{func:hs.LESS},depthWrite:!t.renderOccluded&&nl,colorWrite:ht,stencilTest:e?$ne($b.IntegratedMeshMaskExcluded):null})}getPipelineState(e,t){return this.useStencil?this._stencilPipelineState:super.getPipelineState(e,t)}};XK.shader=new ii(vAe,()=>G(()=>import("./Terrain.glsl-e058c064.js"),["assets/Terrain.glsl-e058c064.js","assets/mat4-44a0988f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/mat4f64-1e28eae0.js","assets/vec3-e93e648f.js","assets/Matrix3PassUniform-ad9f953b.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/mat3f64-c6305894.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/Texture2DPassUniform-753de459.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/mathUtils-b4bb77e2.js","assets/vec4-790471c0.js","assets/context-util-a4ce3a7b.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/aaBoundingBox-657a9b82.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/aaBoundingRect-193543b5.js","assets/basicInterfaces-19ed850e.js","assets/ViewingMode-5d7d590b.js","assets/Util-a48361c6.js","assets/vec4f64-e407da96.js","assets/symbolColorUtils-b2b55883.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/compilerUtils-18d58939.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/sphere-2af0d852.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));const ZK=new Map([[P.POSITION,0],[P.UV0,1],[P.NORMALCOMPRESSED,2]]);let bAe=class{constructor(){this.geometryInfo=new CRe,this.intersectionData=null,this.geometryState=null,this._textureRef=new kK(()=>this.tile.surface.textureFadeDuration),this.overlay=new aAe,this._geometryStateChangedSinceLastUpdate=!0,this._hasGeometry=!1,this._numVerticesPerSideChanged=!1,this._samplerDataChanged=!1,this._clippingAreaChanged=!1,this._wireframeChanged=!1,this._shadingChanged=!1,this._dirtyEdgeResolutions=15,this._dirtyEdges=15,this._dirtyCorners=15}get tile(){return this._tile}init(e){this.clear(),this._tile=e;const t=this.geometryInfo;t.indices=null,t.vertexAttributes=null,Mi(t.boundingBox),t.indexCount=0,t.numVerticesPerSide=0,this.intersectionData=null,this.geometryState=new MRe,this.localOrigin=null,this.overlay.clear()}clear(){this._releaseGeometry(),this.releaseTexture(),this._textureRef.clear(),this._tile=null,this.intersectionData=null,this.geometryState=null}updateGeometryIfNeeded(e){if((!this._vao||this._geometryStateChangedSinceLastUpdate||this._wireframeChanged||this._shadingChanged||this._clippingAreaChanged||this._samplerDataChanged||this._numVerticesPerSideChanged||this._dirtyCorners||this._dirtyEdgeResolutions||this._dirtyEdges)&&(this._updateGeometry(e),this._geometryStateChangedSinceLastUpdate=!1),gn&&this.tile.intersectsClippingArea)for(let t=0;t<4;++t)pe(this.geometryInfo.outerEdges[t].count===this.geometryState.neighborData.edgeResolutions[t]+1)}_calculateEdgeResolution(e,t){var l;const r=this.tile,n=this.geometryState.numVerticesPerSide-1;if(!r.surface.isGlobal){const c=r.surface.extent;if(y(c)&&(e===0&&r.extent[3]>c[3]||e===1&&r.extent[2]>c[2]||e===2&&r.extent[1]<c[1]||e===3&&r.extent[0]<c[0]))return n}const s=r.level,a=jh[e];if(!t)return pe(S((l=r.surface)==null?void 0:l.rootTiles)||r.surface.updatingRootTiles||!r.shouldHaveNeighbor(a)),n;if(t.isLoaded){const c=t,u=c.renderData.geometryState,d=s-c.level;if(pe(d>=0),d===0){const _=u.numVerticesPerSide-1;return Math.max(_,n)}const m=2**d,f=u.neighborData.edgeResolutions[(e+2)%4]/m;return Math.max(1,f)}pe(!t.isLeaf);let o=n;return t.forAllSubtreeOnSide(dP(a),c=>c===r||(c.isLoaded?(o=Math.max(o,2**(c.level-s)),!0):(pe(!c.isLeaf),!1))),o}updateNeighborData(){var o;const e=this.tile;if(!e.intersectsClippingArea)return;const t=e.renderData.geometryState.neighborData,r=l=>(l.isLoaded||l.level===e.level)&&(l==null?void 0:l.intersectsClippingArea),n=t.edgePeerNeighbors,s=t.edgePeerNeighborSamplerVersions;for(let l=0;l<4;++l){const c=e.findNeighborTile(jh[l],r),u=Jp(e,c),d=((o=u==null?void 0:u.renderData)==null?void 0:o.geometryState.samplerDataVersion)??-1,m=n[l],f=u!==Jp(e,m),_=s[l]!==d;n[l]=c,(f||_)&&(s[l]=d,this._markEdgeDirty(l));const g=t.edgeResolutions[l],x=this._calculateEdgeResolution(l,c);pe(pw(x)),pe(x>=1),t.edgeResolutions[l]=x,g!==x&&this._markEdgeResolutionDirty(l)}const a=t.cornerPeerNeighbors;for(let l=0;l<4;++l){const c=e.findNeighborTile(pP[l],r);a[l]=c;const u=Jp(e,n[l]),d=Jp(e,n[(l+1)%4]),m=Jp(e,c);rc[l]=m,rc[(l+1)%4]=d,rc[(l+2)%4]=e,rc[(l+3)%4]=u,pe(rc.some(x=>(x==null?void 0:x.isLoaded)||x===e));const f=rc.reduce((x,b)=>Math.min(x,(b==null?void 0:b.level)??1/0),1/0);rc.forEach((x,b)=>{(x==null?void 0:x.level)>f&&(rc[b]=null)}),pe(rc.some(x=>(x==null?void 0:x.isLoaded)||x===e));const _=t.cornerNeighborData[l].cornerTiles,g=t.cornerNeighborData[l].cornerTileSamplerVersions;for(let x=0;x<4;++x){const b=rc[x],v=(b==null?void 0:b.renderData.geometryState.samplerDataVersion)??-1,w=_[x]!==b,T=!w&&g[x]!==v;(w||T)&&(_[x]=b,g[x]=v,this._markCornerDirty(l))}pe(_.some(x=>(x==null?void 0:x.isLoaded)||x===e))}gn&&pe(this.geometryState.neighborData.edgeResolutions.every(l=>l>0));for(let l=0;l<4;++l)rc[l]=null}_updateGeometry(e){if(!this.tile.intersectsClippingArea)return;gn&&pe(!this.tile.intersectsClippingArea||this.geometryState.neighborData.edgeResolutions.every(l=>l>0)),this.intersectionData=null;const t=this.tile,r=this._vao,n=this.geometryInfo.vertexAttributes,s=!r||!n||this._wireframeChanged||this._shadingChanged||this._numVerticesPerSideChanged||this._samplerDataChanged||this._clippingAreaChanged||this._dirtyEdgeResolutions,a=!s&&(this._dirtyEdges!==0||this._dirtyEdgeResolutions!==0),o=!a&&this._dirtyCorners!==0;s?(this._releaseGeometry(),this._createGeometry(e)):a||o?t.updateEdgeElevations():o?t.updateCornerElevations():console.warn("Update for no reason?"),this._numVerticesPerSideChanged=!1,this._samplerDataChanged=!1,this._dirtyEdgeResolutions=0,this._dirtyEdges=0,this._dirtyCorners=0,this._clippingAreaChanged=!1,this._wireframeChanged=!1}releaseGeometry(){return this._releaseGeometry()}get hasGeometry(){return this._hasGeometry}ensureTexture(e,t){return y(this._texture)&&this._texture.descriptor.width!==e&&this.releaseTexture(),S(this._texture)&&(this._texture=t(),this.tile.setMemoryDirty()),this._texture}releaseTexture(){y(this._texture)&&(this._texture.release(),this._texture=null,this.tile.setMemoryDirty())}_markCornerDirty(e){const t=1<<e;this._dirtyCorners|=t}_markEdgeDirty(e){const t=1<<e;this._dirtyEdges|=t}_markEdgeResolutionDirty(e){const t=1<<e;this._dirtyEdgeResolutions|=t,this._dirtyEdges|=t}_markAllEdgesAndCornersDirty(){this._dirtyCorners=15,this._dirtyEdges=15,this._dirtyEdgeResolutions=15}updateGeometryState(){const e=this._getElevationInfo(),t=this.tile,r=e.samplerData?t.getElevationBasedVerticesPerSide(e.maxTileLevel):t.getDefaultVerticesPerRowOnLevel(),n=Math.max(r,5);let s=t.clippingArea;t.intersectsClippingArea&&!t.isWithinClippingArea||(s=null);const a=this.geometryState;let o=!1;a.numVerticesPerSide!==n&&(this._numVerticesPerSideChanged=!0,a.numVerticesPerSide=n,a.samplerDataVersion++,o=!0),e.changed&&(this._samplerDataChanged=!0,a.samplerData=e.samplerData,a.samplerDataVersion++,o=!0),K$(a.clippingArea,s)||(this._clippingAreaChanged=!0,a.clippingArea=s,o=!0);const l=t.surface,c=l.wireframe;a.wireframe!==c&&(this._wireframeChanged=!0,a.wireframe=c,o=!0);const u=l.shading;return a.shading!==u&&(this._shadingChanged=u,a.shading=u,o=u),this._geometryStateChangedSinceLastUpdate||(this._geometryStateChangedSinceLastUpdate=o),o&&this._markAllEdgesAndCornersDirty(),this._hasGeometry=!0,this._geometryStateChangedSinceLastUpdate}_createGeometry(e){this.tile.createGeometry();const t=this.geometryInfo.vertexAttributes,r=this.geometryInfo.indices,n=e.gl;this._vao=new nu(e,ZK,{geometry:Wc(t.layout)},{geometry:hi.createVertex(e,n.STATIC_DRAW,t.buffer)},hi.createIndex(e,n.STATIC_DRAW,r)),this._hasGeometry=!0}_releaseGeometry(){return this._hasGeometry=!1,this.intersectionData=null,!!this._vao&&(this._vao.dispose(),this._vao=null,PRe(this.geometryInfo),!0)}get vao(){return this._vao}setTextureReference(e,t=yd.Immediate){y(e)&&e.texture!==this._texture&&this.releaseTexture(),this._textureRef.push(e,t)}get textureReference(){return this._textureRef.current}get nextTextureReference(){return this._textureRef.next}get textureFadeFactor(){return this._textureRef.fadeFactor}get textureIsFading(){return this._textureRef.isFading}_getElevationInfo(){const e=this.geometryState.samplerData,t=this.tile.layerInfo[ut.ELEVATION],r=t.length;let n=new Array(r),s=0,a=0,o=!1;for(let l=0;l<r;l++){const c=t[l];if(y(c.upsampleInfo)){const u=c.upsampleInfo.tile,d=u.layerInfo[ut.ELEVATION][l].data,m=d&&d.samplerData;e&&e[s]===m||(o=!0),n[s++]=m,a=Math.max(a,u.lij[0])}else if(c.data){const u=this.tile.surface.layerViewByIndex(l,ut.ELEVATION);if(aw(this.tile,u.layer,!1)){const d=c.data;e&&e[s]===d.samplerData||(o=!0),n[s++]=d.samplerData,a=this.tile.level}}}return y(e)&&e.length!==s&&(o=!0),s>0?n.length=s:n=null,{changed:o,samplerData:n,maxTileLevel:a}}get estimatedGeometryMemoryUsage(){var t,r;const e=Np(this.intersectionData,0,n=>n.estimatedMemoryUsage);return(((t=this.geometryInfo.indices)==null?void 0:t.byteLength)??0)+(((r=this.geometryInfo.vertexAttributes)==null?void 0:r.byteLength)??0)+e}get textureDescriptor(){return y(this._texture)?this._texture.descriptor:null}get test(){return{hasTexture:this._texture!=null}}checkGeometryWaterproofness(){if(!gn)return;const e=this.tile;if(pe(e==null?void 0:e.isLoaded),!e.isLoaded||!e.intersectsClippingArea||e.level===0)return;const t=e.surface.extent;if(y(t)&&!e.intersectsExtent(t))return;const r=jh.map((o,l)=>!!y(t)&&(l<2?-1:1)*(e.extent[3-l]-t[3-l])<0),n=e.level;pe(this._dirtyCorners===0),pe(this._dirtyEdges===0),pe(this._dirtyEdgeResolutions===0),pe(!this._numVerticesPerSideChanged),pe(!this._samplerDataChanged),pe(!this._clippingAreaChanged),pe(!this._wireframeChanged);const s=pP.map(o=>e.findNeighborCornerTileExact(o,l=>!l.intersectsClippingArea||l.isLoaded||l.level===e.level)??null).map(o=>o!=null&&o.intersectsClippingArea?o:null),a=this.geometryState.neighborData;for(let o=0;o<4;++o){const l=a.cornerPeerNeighbors[o],c=s[o];pe(c===l,`Tile[${e.lij}].corner[${o}] out of date: cur=[${l==null?void 0:l.lij}] exp=[${c==null?void 0:c.lij}]`)}jh.forEach((o,l)=>{if(r[l])return;const c=e.findNeighborTile(o,V=>(V.level===n||(V==null?void 0:V.isLoaded))&&(V==null?void 0:V.intersectsClippingArea));if(!c){const V=!e.surface.updatingRootTiles&&y(e.surface.rootTiles)&&e.surface.rootTiles.length>0&&e.shouldHaveNeighbor(o);return void pe(!V)}pe(c.isLoaded||c.level===e.level),pe(c===this.geometryState.neighborData.edgePeerNeighbors[l]);const u=n-c.level;if(!c.isLoaded)return pe(!c.isLeaf),void pe(u===0);pe(sAe(e,c,o)),pe(u>=0);const d=2**u;if(u<0)return void pe(!1);const m=e.renderData.geometryInfo,f=m.outerEdges[l],_=m.numVerticesPerSide-1,g=c.renderData.geometryInfo;if(!g)return void pe(!1);{const V=this.geometryState.neighborData.edgePeerNeighbors[l];(V!=null&&V.isLoaded||V.isLoaded)&&(pe(V==V),pe(e.renderData.geometryState.neighborData.edgePeerNeighborSamplerVersions[l]===V.renderData.geometryState.samplerDataVersion),pe(this.geometryState.neighborData.edgePeerNeighborSamplerVersions[l]===V.renderData.geometryState.samplerDataVersion))}const x=(l+2)%4,b=g.outerEdges[x],v=f.count-1,w=b.count-1;pe(v*d===w,`Tile[${e.lij}]:e${l},res=${v} edgeRes mismatch with Neighbor[${c.lij}]:e${x},res=${w} (expected:${v*d})`);const T=e.extent,E=o===ke.NORTH||o===ke.SOUTH,C=b.count-1,A=C/2**u,M=f.count-1;if(A<1)return void pe(M===1);pe(A===M),pe(pw(A));const I=g.numVerticesPerSide-1;pe(u>0||A===Math.max(I,_));const L=e.getNeighborEdgeStartVertexIndex(l,c);pe(0<=L&&L<d);const U=L*A;pe(0<=U&&U<=C-A);let j=0,re=U;f.getVertexPos(uh,0),f.getVertexPos(dh,f.count-1);const ee=Ii(uh,dh),H=Math.max(wAe,1e-4*ee);for(let V=0;V<=A;++V){f.getVertexPos(uh,j),b.getVertexPos(dh,re);const X=V/A,$=E?T[0]+X*(T[2]-T[0]):o===ke.WEST?T[0]:T[2],B=E?o===ke.SOUTH?T[1]:T[3]:T[1]+X*(T[3]-T[1]),W=e.surface.extent;if(S(W)||Kie(W,$,B)){const te=K7(uh,dh),ie=jd(uh)-lo.radius,Y=jd(dh)-lo.radius,se=te<H;if(!se){console.warn(`Tile edge vertex position mismatch: between [${e.lij}].edge${l}[${j}/${f.count}] and [${c.lij}].edge${x}[${re}/${b.count}]`),y(W)&&console.warn("  surface extent= ",W," x,y=",$,",",B);const Ee=R();ne(Ee,e.renderData.localOrigin,c.renderData.localOrigin),jd(Ee)>0&&console.warn(`   localOrigins: ${e.renderData.localOrigin} vs ${c.renderData.localOrigin} d=${jd(Ee)} [${Ee}]`),(()=>{const Re=as(uh),Ie=as(dh);e.updateEdgeElevations(),c.updateEdgeElevations(),f.getVertexPos(uh,j),b.getVertexPos(dh,re);const Ue=R();tl(Ue,uh,Re),jd(Ue)>0&&console.warn(`  XXX Tile[${e.lij}] edge out of date: ${Re} vs ${uh} d=${jd(Ue)} [${Ue}]`),tl(Ue,dh,Ie),jd(Ue)>0&&console.warn(`  XXX Neighbor[${c.lij}] edge out of date: ${Ie} vs ${dh} d=${jd(Ue)} [${Ue}]`)})(),pe(se,`Mismatch in tile [${e.lij}].edge[${l}][${j}/${f.count}] vs neighbor [${c.lij}].edge[${x}][${re}/${b.count}] ${Ru(uh)} vs ${Ru(dh)}  dist=${te} h(t|n|d)=${ie}|${Y}|${Y-ie}`)}if(e.surface.shading){f.getNormal(ey,j),b.getNormal(ty,re),he(Nz,ey),he(kz,ty);const Ee=me(Nz,kz),Re=!1,Ie=1-Ee<.01||Re||e===c;if(!Ie){const Ue=R();tl(Ue,ey,ty);const ye=()=>`Mismatch in tile edge normal ${vz(e.lij)} (${j}/${f.count-1}) edge ${l} vs neighbor ${vz(c.lij)}  (${re}/${b.count-1}) nedge ${x} :${Ru(ey)} vs ${Ru(ty)}  dot = ${Ee} : ${Ru(Ue)}`;console.warn("Mismatch in tile edge normal: ",ye());{e.updateEdgeElevations(),c.updateEdgeElevations();const we=R(),$e=R();f.getNormal(we,j),b.getNormal($e,re),Rg(ey,we)||console.warn("Missing update in tile normal: ",Ru(ey)," => ",Ru(we)),Rg(ty,$e)||console.warn("Missing update in neighbor normal: ",Ru(ty)," => ",Ru($e))}pe(Ie,ye())}}}j+=1,re+=1}})}};const uh=R(),dh=R(),ey=R(),ty=R(),Nz=R(),kz=R(),wAe=1,rc=[null,null,null,null];function Jp(i,e){return e!=null&&e.isLoaded||e===i?e:null}const xAe=65536;function TAe(i,e){const t=i.tile,{extent:r,extentInRadians:n,surface:s}=t,a=i.localOrigin,o=i.geometryState,l=s.isWebMercator,c=s.shading||Wg,u=o.numVerticesPerSide,d=u-1,m=(u-2)**2,f=l&&(e===Rl.HAS_SOUTH_POLE||e===Rl.HAS_BOTH_POLES),_=l&&(e===Rl.HAS_NORTH_POLE||e===Rl.HAS_BOTH_POLES),g=6,x=((f?1:0)+(_?1:0))*g*(d+1),b=o.neighborData,v=b.edgeResolutions.reduce((M,I)=>M+I+1,0),w=NK(m+x+v),T=i.geometryInfo;T.numVerticesPerSide=o.numVerticesPerSide,T.vertexAttributes=w;const E=T.boundingBox;Mi(E);const C=V4(i);Tr.update(d,n,C),CAe(i),sJ(i,m),YK(i);const A=[];if((()=>{let M=m+v;const I=a[0],L=a[1],U=a[2],j=t.ellipsoid.radius,re=r[1],ee=r[3],H=(V,X)=>{const $=X*u;Xs(-I,-L,V*j-U,E),A.push({connectedRowOffset:$,connectedOuterEdgeOffset:V===1?0:2,rowOffset:M,latitudeResolution:g});const B=eJ(V===-1?re:ee,j),W=V*Math.PI/2-B,te=.99*(V===1?1:-1),ie=j+0,Y=w.position,se=w.uv0,Ee=w.normalCompressed;for(let Re=1;Re<=g;++Re){const Ie=B+W*(Re/g),Ue=Math.cos(Ie),ye=Math.sin(Ie);for(let we=0;we<=d;we++){const $e=we/d,st=Tr.sinLonLUT[we],vt=Tr.cosLonLUT[we]*Ue,Ot=st*Ue,Ve=ye,De=vt*ie-I,ft=Ot*ie-L,Et=Ve*ie-U;Xs(De,ft,Et,E),Y.setValues(M,De,ft,Et),go(se,M,$e,te),c&&bx(Ee,M,vt,Ot,Ve),++M}}};f&&H(-1,0),_&&H(1,d)})(),nJ(T,o.numVerticesPerSide,A,[0,u-1],[0,u-1],o.wireframe),i.intersectionData=null,gn)for(let M=0;M<4;++M)pe(T.outerEdges[M].count===b.edgeResolutions[M]+1)}function CAe(i){const e=i.tile;e.intersectsClippingArea&&(e.surface.shading||Wg?EAe(i):SAe(i))}function SAe(i){const e=i.geometryState,t=e.numVerticesPerSide,r=t-2,n=t-1,s=i.geometryInfo,a=s.vertexAttributes,o=a.position,l=a.uv0,c=i.tile,u=c.extent,d=u[0],m=u[2],f=u[1],_=u[3],g=c.ellipsoid.radius,x=e.samplerData,b=i.localOrigin,v=b[0],w=b[1],T=b[2],E=s.boundingBox,C=o.typedBuffer,A=o.typedBufferStride;let M=0;for(let I=1;I<=r;I++){const L=I/n,U=f*(1-L)+_*L,j=Tr.sinLatLUT[I],re=Tr.cosLatLUT[I];for(let ee=1;ee<=r;ee++){const H=ee/n,V=d*(1-H)+m*H,X=Tr.sinLonLUT[ee],$=Tr.cosLonLUT[ee],B=g+Si(V,U,x),W=$*re*B-v,te=X*re*B-w,ie=j*B-T;Xs(W,te,ie,E);const Y=M*A;C[Y+0]=W,C[Y+1]=te,C[Y+2]=ie,go(l,M,H,L),++M}}}function EAe(i){const e=i.geometryState,t=e.numVerticesPerSide,r=t-2,n=t-1,s=i.geometryInfo,a=s.vertexAttributes,o=a.position,l=a.uv0,c=a.normalCompressed,u=i.tile,d=u.extent,m=d[0],f=d[2],_=d[1],g=d[3],x=u.ellipsoid.radius,b=e.samplerData,v=i.localOrigin,w=v[0],T=v[1],E=v[2],C=o.typedBuffer,A=o.typedBufferStride,M=1/n,I=s.boundingBox;let L=0;if(1<=r){const U=M,j=_*(1-U)+g*U,re=Tr.sinLatLUT[1],ee=Tr.cosLatLUT[1];for(let H=1;H<=r;H++){const V=H*M,X=m*(1-V)+f*V,$=Tr.sinLonLUT[H],B=Tr.cosLonLUT[H],W=x+Si(X,j,b),te=W*B*ee-w,ie=W*$*ee-T,Y=W*re-E;Xs(te,ie,Y,I);const se=(H-1)*A;C[se+0]=te,C[se+1]=ie,C[se+2]=Y,go(l,H-1,V,U)}}for(let U=1;U<=r;U++){const j=U*M,re=_*(1-j)+g*j,ee=Tr.sinLatLUT[U],H=Tr.cosLatLUT[U],V=U+1,X=V*M,$=_*(1-X)+g*X,B=Tr.sinLatLUT[V],W=Tr.cosLatLUT[V],te=Tr.sinLonLUT[0],ie=Tr.cosLonLUT[0],Y=x+Si(m,re,b);let se=ie*H*Y-w,Ee=te*H*Y-T,Re=ee*Y-E;const Ie=L*A;let Ue=C[Ie+0],ye=C[Ie+1],we=C[Ie+2];for(let $e=1;$e<=r;$e++){const st=$e*M,vt=m*(1-st)+f*st,Ot=Tr.sinLonLUT[$e],Ve=Tr.cosLonLUT[$e],De=Ve*H,ft=Ot*H,Et=ee;let qe=0,Ze=0,$i=0;{let Wt=0,bt=0,Vt=0;if($e<r){const Ut=(L+1)*A;Wt=C[Ut+0],bt=C[Ut+1],Vt=C[Ut+2]}else{const Ut=Tr.sinLonLUT[n],Hi=Tr.cosLonLUT[n],ji=x+Si(f,re,b);Wt=Hi*H*ji-w,bt=Ut*H*ji-T,Vt=ee*ji-E}const He=se,We=Ee,et=Re;se=Ue,Ee=ye,Re=we,Ue=Wt,ye=bt,we=Vt;const Pt=Wt-He,Nt=bt-We,wt=Vt-et,At=Nt*Et-wt*ft,at=wt*De-Pt*Et,li=Pt*ft-Nt*De;qe=at*wt-li*Nt,Ze=li*Pt-At*wt,$i=At*Nt-at*Pt}{let Wt=0,bt=0,Vt=0;if(U>1){const He=(L-r)*A;Wt=C[He+0],bt=C[He+1],Vt=C[He+2]}else{const He=Tr.sinLatLUT[0],We=Tr.cosLatLUT[0],et=x+Si(vt,_,b);Wt=Ve*We*et-w,bt=Ot*We*et-T,Vt=He*et-E}{const He=x+Si(vt,$,b),We=Ve*W*He-w,et=Ot*W*He-T,Pt=B*He-E;if(U<r){const Hi=L+r,ji=Hi*A;C[ji+0]=We,C[ji+1]=et,C[ji+2]=Pt,Xs(We,et,Pt,I),go(l,Hi,st,X)}const Nt=Wt-We,wt=bt-et,At=Vt-Pt,at=wt*Et-At*ft,li=At*De-Nt*Et,Ut=Nt*ft-wt*De;qe+=li*At-Ut*wt,Ze+=Ut*Nt-at*At,$i+=at*wt-li*Nt}}const mi=1/Math.sqrt(qe*qe+Ze*Ze+$i*$i);bx(c,L,qe*mi,Ze*mi,$i*mi),++L}}}function PAe(i){i.tile.intersectsClippingArea&&(YK(i),zR(i))}function RAe(i){i.tile.intersectsClippingArea&&(JK(i),KK(i,!0),zR(i))}function YK(i){i.tile.intersectsClippingArea&&(JK(i),KK(i))}function KK(i,e=!1){const t=i.geometryState,r=i.geometryInfo,n=t.neighborData,s=i.tile,a=s.level,o=s.extent,l=s.ellipsoid.radius,c=s.extentInRadians,u=c[0],d=c[2],m=c[1],f=c[3],_=t.samplerData,g=o[0],x=o[2],b=o[1],v=o[3],w=V4(i),T=r.boundingBox,E=i.localOrigin,C=E[0],A=E[1],M=E[2],I=s.surface.shading||Wg,L=r.vertexAttributes,U=L.position,j=U.typedBuffer,re=U.typedBufferStride,ee=L.uv0;for(let H=0;H<4;++H){const V=H===1||H===3,X=n.edgeResolutions[H];pe(pw(X));const $=X+1,B=Jp(s,n.edgePeerNeighbors[H]);if(lJ(s,B,H)){aJ(i,H);continue}const W=y(B);pe(!W||B.level===s.level),pe(!W||vd(s,B)<=0);const te=B==null?void 0:B.renderData,ie=te==null?void 0:te.geometryState;if(gn){const He=s.surface;if(!B&&He&&!He.updatingRootTiles){const We=jh[H],et=s.findNeighborTile(We,Pt=>Pt.isLoaded||Pt.isLeaf||Pt.level===s.level);et?et.intersectsClippingArea&&(pe(!et.isLoaded),pe(!et.isLeaf),pe(et.level===a)):pe(S(He==null?void 0:He.rootTiles)||!s.shouldHaveNeighbor(We))}}const Y=H===1?o[2]:o[0],se=B==null?void 0:B.extent,Ee=W&&V?H===1?se[0]:se[2]:Y,Re=H===0?o[3]:o[1],Ie=H===1?1:0,Ue=H===0?1:0,ye=H===1?d:u,we=H===0?f:m,$e=Math.sin(ye),st=Math.cos(ye),vt=Math.sin(we),Ot=Math.cos(we),Ve=ie==null?void 0:ie.samplerData,De=(He,We,et)=>Si(He,We,_),ft=(He,We,et)=>.5*(Si(He,We,_)+Si(et,We,Ve)),Et=W?ft:De,qe=r.outerEdges[H],Ze=e&&$>3?$-3:1,$i=y(_)&&_.some(He=>He!=null),mi=y(Ve)&&Ve.some(He=>He!=null),Wt=$i||mi,bt=1/X,Vt=qe.index0;I?(pe(!W||FPe(se[2]-se[0],o[2]-o[0])),(()=>{const He=H===1?-1:H===3?1:0,We=H===0?-1:H===2?1:0,et=(o[2]-o[0])*bt,Pt=He*et,Nt=We*et,wt=V?He*((d-u)*bt):0,At=V?0:We*bt,at=Ue,li=V?ye+wt:ye,Ut=V?Math.sin(li):$e,Hi=V?Math.cos(li):st,ji=V?ye-wt:ye,xn=V?Math.sin(ji):$e,jn=V?Math.cos(ji):st,an=V?we:w(at+At),cl=V?vt:Math.sin(an),vo=V?Ot:Math.cos(an),qn=V?we:w(at-At),Tn=V?vt:Math.sin(qn),Ki=V?Ot:Math.cos(qn),nr=(Vt+0)*re;let kt=j[nr+0]+C,bi=j[nr+1]+A,Lr=j[nr+2]+M,sr=0,on=0,bo=0;{const gr=1*bt,c_=V?Y:g*(1-gr)+x*gr,Pv=V?Ee:c_,Rv=V?b*(1-gr)+v*gr:Re,Av=V?ye:u*(1-gr)+d*gr,tT=V?$e:Math.sin(Av),iT=V?st:Math.cos(Av),h_=V?w(gr):we,Ov=V?Math.sin(h_):vt,u_=V?Math.cos(h_):Ot,Mv=l+Et(c_,Rv,Pv);sr=iT*u_*Mv,on=tT*u_*Mv,bo=Ov*Mv}for(let gr=1;gr<$-1;gr+=Ze){let c_=0,Pv=0,Rv=0;{const Zc=(Vt+gr+1)*re;if(gr<$-2){const Ls=(gr+1)*bt,Yc=V?Y:g*(1-Ls)+x*Ls,pu=V?Ee:Yc,us=V?b*(1-Ls)+v*Ls:Re,wo=V?ye:u*(1-Ls)+d*Ls,Gd=V?$e:Math.sin(wo),Qm=V?st:Math.cos(wo),Hd=V?w(Ls):we,Zm=V?Math.sin(Hd):vt,Iv=V?Math.cos(Hd):Ot,y_=l+Et(Yc,us,pu);c_=Qm*Iv*y_,Pv=Gd*Iv*y_,Rv=Zm*y_}else c_=j[Zc+0]+C,Pv=j[Zc+1]+A,Rv=j[Zc+2]+M}const Av=c_,tT=Pv,iT=Rv,h_=sr,Ov=on,u_=bo;sr=Av,on=tT,bo=iT;{const Zc=Vt+gr,Ls=Zc*re,Yc=h_-C,pu=Ov-A,us=u_-M;j[Ls+0]=Yc,j[Ls+1]=pu,j[Ls+2]=us,Xs(Yc,pu,us,T);const wo=gr*bt;go(ee,Zc,V?Ie:wo,V?wo:Ue)}const Mv=kt,Eee=bi,Pee=Lr;kt=h_,bi=Ov,Lr=u_;const d_=h_,p_=Ov,m_=u_;let f_=0,g_=0,__=0;if(Wt){const Zc=1/Math.sqrt(d_*d_+p_*p_+m_*m_),Ls=d_*Zc,Yc=p_*Zc,pu=m_*Zc;{const us=Av-Mv,wo=tT-Eee,Gd=iT-Pee,Qm=wo*pu-Gd*Yc,Hd=Gd*Ls-us*pu,Zm=us*Yc-wo*Ls;f_+=Hd*Gd-Zm*wo,g_+=Zm*us-Qm*Gd,__+=Qm*wo-Hd*us}{const us=gr*bt,wo=V?Y:g*(1-us)+x*us,Gd=V?Ee:wo,Qm=V?b*(1-us)+v*us:Re,Hd=V?ye:u*(1-us)+d*us,Zm=V?$e:Math.sin(Hd),Iv=V?st:Math.cos(Hd),y_=V?w(us):we,Q4=V?Math.sin(y_):vt,Z4=V?Math.cos(y_):Ot;let WR=d_,XR=p_,QR=m_;if(W){const Ym=l+Si(Gd-Pt,Qm-Nt,Ve),Lv=V?Z4:Ki;WR=(V?jn:Iv)*Lv*Ym,XR=(V?xn:Zm)*Lv*Ym,QR=(V?Q4:Tn)*Ym}{const Ym=l+Si(wo+Pt,Qm+Nt,_),Lv=V?Z4:vo,Y4=(V?Hi:Iv)*Lv*Ym,K4=(V?Ut:Zm)*Lv*Ym,J4=(V?Q4:cl)*Ym;W||(WR=2*d_-Y4,XR=2*p_-K4,QR=2*m_-J4);const rT=WR-Y4,nT=XR-K4,sT=QR-J4,e5=nT*pu-sT*Yc,t5=sT*Ls-rT*pu,i5=rT*Yc-nT*Ls;f_+=t5*sT-i5*nT,g_+=i5*rT-e5*sT,__+=e5*nT-t5*rT}}}else f_=d_,g_=p_,__=m_;const qR=1/Math.sqrt(f_*f_+g_*g_+__*__);qe.setNormalFromValues(gr,f_*qR,g_*qR,__*qR)}})()):(()=>{for(let He=1;He<$-1;He+=Ze){const We=He*bt,et=V?Ie:We,Pt=V?We:Ue,Nt=V?Y:g*(1-We)+x*We,wt=V?b*(1-We)+v*We:Re,At=V?Ee:Nt,at=V?ye:u*(1-We)+d*We,li=V?$e:Math.sin(at),Ut=V?st:Math.cos(at),Hi=V?w(We):we,ji=V?Math.sin(Hi):vt,xn=V?Math.cos(Hi):Ot,jn=Et(Nt,wt,At),an=l+jn,cl=Ut*xn*an-C,vo=li*xn*an-A,qn=ji*an-M;Xs(cl,vo,qn,T);const Tn=Vt+He,Ki=Tn*re;j[Ki+0]=cl,j[Ki+1]=vo,j[Ki+2]=qn,go(ee,Tn,et,Pt)}})()}}function JK(i){oJ(i)}function eJ(i,e){return Math.PI/2-2*Math.atan(Math.exp(-i/e))}function AAe(i,e,t,r){return eJ(i*(1-r)+e*r,t)}function OAe(i,e,t){return i*(1-t)+e*t}function V4(i){const e=i.tile;if(e.surface.isWebMercator){const r=e.extent,n=e.ellipsoid.radius;return s=>AAe(r[1],r[3],n,s)}const t=e.extentInRadians;return r=>OAe(t[1],t[3],r)}function MAe(i,e){const t=i.tile.extent,r=i.geometryState,n=t[0],s=t[1],a=t[2]-n,o=t[3]-s,l=r.clippingArea,c=y(l)?Math.max(0,(l[0]-n)/a):0,u=y(l)?Math.max(0,(l[1]-s)/o):0,d=y(l)?Math.min(1,(l[2]-n)/a):1,m=y(l)?Math.min(1,(l[3]-s)/o):1,f=r.numVerticesPerSide,_=(f-2)**2,g=r.neighborData.edgeResolutions.reduce((w,T)=>w+T+1,0),x=NK(_+g),b=i.geometryInfo,v=b.boundingBox;Mi(v),b.numVerticesPerSide=r.numVerticesPerSide,b.vertexAttributes=x,Qs(b.uvRange,c,u,d,m),IAe(i),sJ(i,_),tJ(i),nJ(b,r.numVerticesPerSide,[],[0,f-1],[0,f-1],r.wireframe),i.intersectionData=null}function IAe(i){const e=i.tile;e.intersectsClippingArea&&(e.surface.shading?$Ae(i):LAe(i))}function LAe(i){const e=i.geometryState,t=e.samplerData,r=i.tile,n=r.surface,s=i.localOrigin,a=n.isWebMercatorOnPlateeCarree,o=e.clippingArea,l=y(o)?o:BR,c=r.extent,u=c[0],d=c[1],m=c[2],f=c[3],_=Math.max(u,l[0]),g=Math.min(m,l[2]),x=Math.max(d,l[1]),b=Math.min(f,l[3]),v=s[0],w=s[1],T=s[2],E=r.ellipsoid.radius,C=r.horizontalScale,A=U4(a,E,C),M=e.numVerticesPerSide,I=M-1,L=M-2,U=i.geometryInfo,j=U.uvRange,re=j[0],ee=j[1],H=j[2],V=j[3],X=U.boundingBox,$=U.vertexAttributes,B=$.position,W=$.uv0;let te=0;for(let ie=1;ie<=L;ie++){const Y=ie/I,se=ce(d*(1-Y)+f*Y,x,b),Ee=ce(Y,ee,V),Re=A(se)-w;for(let Ie=1;Ie<=L;Ie++){const Ue=Ie/I,ye=ce(u*(1-Ue)+m*Ue,_,g),we=ce(Ue,re,H),$e=ye*C-v,st=Si(ye,se,t)-T;Xs($e,Re,st,X),B.setValues(te,$e,Re,st),go(W,te,we,Ee),++te}}}function $Ae(i){const e=i.tile,t=e.surface;if(!(t.shading||Wg))return;const r=i.geometryState,n=r.samplerData,s=i.localOrigin,a=t.isWebMercatorOnPlateeCarree,o=r.clippingArea,l=y(o)?o:BR,c=e.extent,u=c[0],d=c[1],m=c[2],f=c[3],_=Math.max(u,l[0]),g=Math.min(m,l[2]),x=Math.max(d,l[1]),b=Math.min(f,l[3]),v=e.ellipsoid.radius,w=e.horizontalScale,T=r.numVerticesPerSide,E=T-1,C=T-2,A=i.geometryInfo,M=A.vertexAttributes,I=M.position,L=M.uv0,U=M.normalCompressed,j=A.uvRange,re=j[0],ee=j[1],H=j[2],V=j[3],X=A.boundingBox,$=s[0],B=s[1],W=s[2],te=I.typedBuffer,ie=I.typedBufferStride;let Y=0;const se=ce(d,x,b),Ee=a?(Math.PI/2-2*Math.atan(Math.exp(-se/v)))*v:se*w,Re=1/E,Ie=ce(d*(1-Re)+f*Re,x,b);let Ue=Ee,ye=a?(Math.PI/2-2*Math.atan(Math.exp(-Ie/v)))*v:Ie*w;for(let we=1;we<=C;we++){const $e=we/E,st=ce(d*(1-$e)+f*$e,x,b),vt=ce($e,ee,V),Ot=ye,Ve=(we-1)/E,De=ce(d*(1-Ve)+f*Ve,x,b),ft=Ue,Et=(we+1)/E,qe=ce(d*(1-Et)+f*Et,x,b),Ze=a?(Math.PI/2-2*Math.atan(Math.exp(-qe/v)))*v:qe*w,$i=ce(Et,ee,V);Ue=ye,ye=Ze;const mi=ce(u,_,g);let Wt=mi*w,bt=Si(mi,st,n);const Vt=1/E,He=ce(Vt,re,H),We=ce(u*(1-He)+m*He,_,g);let et=He,Pt=We,Nt=We*w,wt=Si(We,st,n);if(we===1){const At=Nt-$,at=Ue-B,li=wt-W,Ut=0*ie;te[Ut+0]=At,te[Ut+1]=at,te[Ut+2]=li,Xs(At,at,li,X);const Hi=ce(Vt,re,H);go(L,Y,Hi,vt)}for(let At=1;At<=C;At++){const at=Nt,li=wt,Ut=(At+1)/E,Hi=ce(Ut,re,H),ji=ce(u*(1-Ut)+m*Ut,_,g),xn=Pt;Pt=ji;{const nr=Y+1,kt=nr*ie;if(we===1||At===C){const bi=ji*w,Lr=Ot,sr=Si(ji,st,n);if(we===1&&At<C){const on=bi-$,bo=Lr-B,gr=sr-W;te[kt+0]=on,te[kt+1]=bo,te[kt+2]=gr,Xs(on,bo,gr,X),go(L,nr,Hi,vt)}Nt=bi,wt=sr}else Nt=te[kt+0]+$,wt=te[kt+2]+W}const jn=Nt,an=wt,cl=Wt,vo=bt;Wt=at,bt=li;const qn=(Y-C)*ie,Tn=we===1?Si(xn,De,n):te[qn+2]+W,Ki=Si(xn,qe,n);if(we<C){const nr=Y+C,kt=nr*ie,bi=at-$,Lr=Ze-B,sr=Ki-W;te[kt+0]=bi,te[kt+1]=Lr,te[kt+2]=sr,Xs(bi,Lr,sr,X);const on=et;et=Hi,go(L,nr,on,$i)}{const nr=jn-cl,kt=-nr*(an-vo),bi=ft-Ze,Lr=-bi*(Tn-Ki),sr=nr*nr+bi*bi,on=kt*kt+Lr*Lr+sr*sr;if(on===0)bx(U,Y,0,0,1);else{const bo=1/Math.sqrt(on);bx(U,Y,kt*bo,Lr*bo,sr*bo)}}++Y}}}function DAe(i,e){i.tile.intersectsClippingArea&&(rJ(i),iJ(i,!0),zR(i))}function FAe(i,e){i.tile.intersectsClippingArea&&(tJ(i),zR(i))}function tJ(i,e){i.tile.intersectsClippingArea&&(rJ(i),iJ(i,!1))}function iJ(i,e){const t=i.geometryState,r=t.neighborData,n=i.tile,s=n.surface,a=s.shading||Wg,o=n.extent,l=t.clippingArea,c=y(l)?l:BR,u=o[0],d=o[2],m=o[1],f=o[3],_=[f>c[3],d>c[2],m<c[1],u<c[0]],g=i.geometryInfo,x=n.horizontalScale,b=U4(s.isWebMercatorOnPlateeCarree,n.ellipsoid.radius,x),v=g.boundingBox,w=g.uvRange[0],T=g.uvRange[1],E=g.uvRange[2],C=g.uvRange[3],A=Math.max(u,c[0]),M=Math.min(d,c[2]),I=Math.max(m,c[1]),L=Math.min(f,c[3]),U=i.localOrigin,j=U[0],re=U[1],ee=U[2],H=t.samplerData;for(let V=0;V<4;++V){const X=V===1||V===3,$=r.edgeResolutions[V];pe(pw($));const B=$+1,W=_[V],te=Jp(n,r.edgePeerNeighbors[V]);if(!W&&lJ(n,te,V)){aJ(i,V);continue}const ie=y(te)&&!W,Y=te==null?void 0:te.renderData,se=Y==null?void 0:Y.geometryState;if(gn&&(pe(!ie||te.level===n.level),pe(!ie||vd(n,te)<=0),n&&!te&&!s.updatingRootTiles)){const Ve=jh[V],De=n.findNeighborTile(Ve,ft=>ft.isLoaded||ft.isLeaf||ft.level===n.level);s.updatingRootTiles||(De?De.intersectsClippingArea&&(pe(!De.isLoaded),pe(!De.isLeaf),pe(De.level===n.level)):pe(S(s==null?void 0:s.rootTiles)||!n.shouldHaveNeighbor(Ve)))}const Ee=ce(V===1?d:u,A,M),Re=ce(V===0?f:m,I,L),Ie=se==null?void 0:se.samplerData,Ue=g.outerEdges[V],ye=e&&B>3?B-3:1,we=ce(V===1?1:0,w,E),$e=ce(V===0?1:0,T,C),st=(Ve,De)=>Si(Ve,De,H),vt=(Ve,De)=>.5*(Si(Ve,De,Ie)+Si(Ve,De,H)),Ot=ie?vt:st;if(a){const Ve=(d-u)/$,De=X?V===1?Ve:-Ve:0,ft=X?0:V===0?Ve:-Ve,Et=-De,qe=-ft,Ze=Ue.attributes.position.typedBuffer,$i=Ue.attributes.position.typedBufferStride,mi=Ue.index0,Wt=Ue.stride,bt=mi*$i;let Vt=Ze[bt+0]+j,He=Ze[bt+1]+re,We=Ze[bt+2]+ee,et=0,Pt=0,Nt=0;{const wt=1/$,At=X?Ee:ce(u*(1-wt)+d*wt,A,M),at=X?ce(m*(1-wt)+f*wt,I,L):Re,li=Ot(At,at),Ut=At*x,Hi=b(at);et=Ut,Pt=Hi,Nt=li}for(let wt=1;wt<B-1;wt+=ye){const At=wt/$,at=et,li=Pt,Ut=Nt;{const kt=X?we:ce(At,w,E),bi=X?ce(At,T,C):$e,Lr=at-j,sr=li-re,on=Ut-ee;Xs(at,sr,on,v),Ue.setVertexFromValuesRawPositionUV(wt,Lr,sr,on,kt,bi)}const Hi=wt+1;if(wt===B-1){const kt=(mi+Hi*Wt)*$i;et=Ze[kt+0]+j,Pt=Ze[kt+1]+re,Nt=Ze[kt+2]+ee}else{const kt=Hi/$,bi=X?Ee:ce(u*(1-kt)+d*kt,A,M),Lr=X?ce(m*(1-kt)+f*kt,I,L):Re,sr=Ot(bi,Lr);et=bi*x,Pt=b(Lr),Nt=sr}const ji=et,xn=Pt,jn=Nt,an=Vt,cl=He,vo=We;Vt=at,He=li,We=Ut;let qn=0,Tn=0,Ki=0;if(X){{const kt=xn-li,bi=cl-li;Tn-=bi*(vo-Ut)+kt*(jn-Ut),Ki+=bi*bi+kt*kt}{const kt=ce(m*(1-At)+f*At,I,L),bi=Ee+Et,Lr=bi*x-at;if(qn-=Lr*(Si(bi,kt,H)-Ut),Ki+=Lr*Lr,ie){const sr=Ee+De,on=sr*x-at;qn-=on*(Si(sr,kt,Ie)-Ut),Ki+=on*on}}}else{{const kt=ji-at,bi=an-at;qn-=kt*(jn-Ut)+bi*(vo-Ut),Ki+=kt*kt+bi*bi}{const kt=ce(u*(1-At)+d*At,A,M),bi=Re+qe,Lr=Si(kt,bi,H)-Ut,sr=b(bi)-li;if(Tn-=sr*Lr,Ki+=sr*sr,ie){const on=kt,bo=Re+ft,gr=b(bo)-li;Tn-=gr*(Si(on,bo,Ie)-Ut),Ki+=gr*gr}}}const nr=1/Math.sqrt(qn*qn+Tn*Tn+Ki*Ki);Ue.setNormalFromValues(wt,qn*nr,Tn*nr,Ki*nr)}}else for(let Ve=1;Ve<B-1;Ve+=ye){const De=Ve/$,ft=X?Ee:ce(u*(1-De)+d*De,A,M),Et=X?ce(m*(1-De)+f*De,I,L):Re,qe=X?we:ce(De,w,E),Ze=X?ce(De,T,C):$e,$i=Ot(ft,Et),mi=ft*x-j,Wt=b(Et)-re,bt=$i-ee;Xs(mi,Wt,bt,v),Ue.setVertexFromValuesRawPositionUV(Ve,mi,Wt,bt,qe,Ze)}}}function rJ(i,e){oJ(i)}function NAe(i,e){return(Math.PI/2-2*Math.atan(Math.exp(-i/e)))*e}function kAe(i,e){return i*e}function U4(i,e,t){return i?r=>NAe(r,e):r=>kAe(r,t)}function nJ(i,e,t,r,n,s){const a=e-1,o=i.vertexAttributes.count,l=2*(Math.min(e-2,r[1])-Math.max(1,r[0]))*(Math.min(e-2,n[1])-Math.max(1,n[0])),c=jh.map((v,w)=>w===0&&n[1]<e-2||w===1&&r[1]<e-2||w===2&&n[0]>1||w===3&&r[0]>1),u=i.outerEdges.reduce((v,w,T)=>v+(c[T]?0:a-2+w.count-1),0),d=t.reduce((v,w)=>v+a*(2*(w.latitudeResolution-1)+1),0),m=s?2:1,f=3*(l+u+d)*m,_=o>=xAe?new Uint32Array(f):new Uint16Array(f);let g=0;const x=e-2,b=a-2;if(pe(b>=0),s){const v=(T,E,C)=>{_[g++]=T,_[g++]=E,_[g++]=E,_[g++]=C,_[g++]=C,_[g++]=T,gn&&(pe(T<o),pe(E<o),pe(C<o),pe(g<=f))};(()=>{for(let T=Math.max(n[0],1)-1;T<Math.min(n[1],e-2)-1;++T)for(let E=Math.max(r[0],1)-1;E<Math.min(r[1],e-2)-1;++E){const C=T*x+E,A=C+1,M=A+x,I=M-1;v(C,A,M),v(M,I,C)}})(),pe(g===3*l*m),(()=>{for(let T=0;T<4;++T){const E=g;if(c[T])continue;const C=i.outerEdges[T],A=i.innerEdges[T];let M=0,I=0;const L=C.count,U=A.count;pe(U===a-1);let j=0;const re=T===1||T===2?(ee,H,V)=>v(ee,H,V):(ee,H,V)=>v(ee,V,H);for(;M<L-1||I<U-1;){const ee=A.getVertexIndex(I),H=C.getVertexIndex(M),V=M<L-1,X=I<U-1,$=V?0+a*(M+.5)/(L-1):0,B=X?1+b*(I+.5)/(U-1):0;V&&(!X||$<=B)?(++M,gn&&pe(M<L),re(ee,H,C.getVertexIndex(M)),j++):(++I,gn&&pe(I<U),re(ee,H,A.getVertexIndex(I)),j++)}gn&&(pe(M===L-1),pe(I===U-1),pe(j===L+U-2),pe(j===a-2+C.count-1),pe(g===E+3*j*m))}})(),pe(g===3*(l+u)*m);const w=T=>{const E=i.outerEdges[T.connectedOuterEdgeOffset];let C=E.getVertexIndex(0),A=E.stride;for(let M=0;M<T.latitudeResolution;++M){const I=M===0?T.rowOffset:C+e;for(let L=0;L<a;L++)v(C,C+1,I+L),M<T.latitudeResolution-1&&v(C+1,I+L+1,I+L),C+=A;C=I,A=1}};t.forEach(w)}else{(()=>{const w=Math.max(n[0],1)-1,T=Math.min(n[1],e-2)-1,E=Math.max(r[0],1)-1,C=Math.min(r[1],e-2)-1;for(let A=w;A<T;++A){const M=A*x;for(let I=E;I<C;++I){const L=M+I,U=L+1,j=U+x,re=j-1;_[g+0]=L,_[g+1]=U,_[g+2]=j,_[g+3]=j,_[g+4]=re,_[g+5]=L,g+=6}}})(),pe(g===3*l*m),(()=>{for(let w=0;w<4;++w){if(c[w])continue;const T=i.outerEdges[w],E=i.innerEdges[w];let C=0,A=0;const M=T.count,I=E.count;pe(I===a-1);const L=w===1||w===2,U=L?1:2,j=L?2:1,re=T.index0,ee=T.stride,H=E.index0,V=E.stride;for(;C<M-1||A<I-1;){const X=H+A*V,$=re+C*ee,B=C<M-1,W=A<I-1,te=B?0+a*(C+.5)/(M-1):0,ie=W?1+b*(A+.5)/(I-1):0,Y=B&&(!W||te<=ie);Y?++C:++A;const se=Y?$+ee:X+V;_[g+0]=X,_[g+U]=$,_[g+j]=se,g+=3}}})(),pe(g===3*(l+u)*m);const v=w=>{const T=i.outerEdges[w.connectedOuterEdgeOffset];let E=T.getVertexIndex(0),C=T.stride;for(let A=0;A<w.latitudeResolution;++A){const M=A===0?w.rowOffset:E+e;for(let I=0;I<a;I++){const L=M+I;_[g+0]=E,_[g+1]=E+1,_[g+2]=L,A<w.latitudeResolution-1?(_[g+3]=E+1,_[g+4]=L+1,_[g+5]=L,g+=6):g+=3,E+=C}E=M,C=1}};t.forEach(v)}pe(g===f),i.indices=_,i.indexCount=f}function sJ(i,e){const t=i.localOrigin,r=i.geometryInfo,n=i.geometryState.neighborData.edgeResolutions,s=r.numVerticesPerSide-2,a=r.vertexAttributes;let o=e;for(let l=0;l<4;++l){{const c=l===0||l===2,u=(l===0?s-1:0)*s+(l===1?s-1:0),d=(c?0:1)*s+(c?1:0);r.innerEdges[l]=new Ez(a,t,u,d,s)}{const c=o,u=n[l]+1;r.outerEdges[l]=new Ez(a,t,c,1,u),o+=u}}}function aJ(i,e){const t=(e+2)%4,r=i.geometryState,n=i.tile,s=r.neighborData,a=Jp(n,s.edgePeerNeighbors[e]),o=n.level-a.level,l=e===1||e===3,c=s.edgeResolutions[e];pe(pw(c));const u=c+1,d=i.geometryInfo,m=d.boundingBox,f=d.outerEdges[e],_=d.uvRange[0],g=d.uvRange[1],x=d.uvRange[2],b=d.uvRange[3],v=ce(e===1?1:0,_,x),w=ce(e===0?1:0,g,b),T=a.renderData,E=T.geometryState,C=T.geometryInfo.outerEdges[t],A=n.getNeighborEdgeStartVertexIndex(e,a)*c,M=c*2**o;pe(E.neighborData.edgeResolutions[t]===M),pe(C.count-1===M);const I=T.localOrigin[0]-i.localOrigin[0],L=T.localOrigin[1]-i.localOrigin[1],U=T.localOrigin[2]-i.localOrigin[2],j=f.attributes,re=f.index0,ee=f.stride,H=j.position.typedBuffer,V=j.position.typedBufferStride,X=j.normalCompressed.typedBuffer,$=j.normalCompressed.typedBufferStride,B=j.uv0,W=C.attributes,te=C.index0,ie=C.stride,Y=W.position.typedBuffer,se=W.position.typedBufferStride,Ee=W.normalCompressed.typedBuffer,Re=W.normalCompressed.typedBufferStride;for(let Ie=1;Ie<u-1;++Ie){const Ue=re+ee*Ie,ye=te+ie*(A+Ie),we=Ue*V,$e=ye*se,st=Y[$e+0]+I,vt=Y[$e+1]+L,Ot=Y[$e+2]+U;H[we+0]=st,H[we+1]=vt,H[we+2]=Ot,Xs(st,vt,Ot,m);const Ve=Ue*$,De=ye*Re;X[Ve+0]=Ee[De+0],X[Ve+1]=Ee[De+1];const ft=Ie/c,Et=l?v:ce(ft,_,x),qe=l?ce(ft,g,b):w;go(B,Ue,Et,qe)}}function oJ(i){var Ue;const e=i.geometryState,t=e.neighborData,r=i.localOrigin,n=t.cornerNeighborData,s=i.geometryInfo,a=s.outerEdges,o=s.boundingBox,l=i.tile,c=((Ue=i.tile.surface.view)==null?void 0:Ue.viewingMode)==="local",u=l.ellipsoid.radius,d=l.extentInRadians,m=l.horizontalScale;let f=0,_=0,g=0,x=0,b=0,v=0;const w=(ye,we,$e)=>{const st=d[we===0?1:3],vt=d[ye===0?0:2],Ot=Math.cos(st),Ve=Math.sin(st),De=Math.sin(vt),ft=Math.cos(vt),Et=u+$e;f=ft*Ot*Et,_=De*Ot*Et,g=Ve*Et},T=c?(()=>{const ye=i.geometryState.clippingArea,we=l.extent,$e=y(ye)&&(we[3]>ye[3]||we[2]>ye[2]||we[1]<ye[1]||we[0]<ye[0]),st=U4(l.surface.isWebMercatorOnPlateeCarree,l.ellipsoid.radius,m);return(vt,Ot,Ve)=>{const De=vt===0?L[0]:L[2],ft=Ot===0?L[1]:L[3],Et=$e?ce(De,ye[0],ye[2]):De,qe=$e?ce(ft,ye[1],ye[3]):ft,Ze=Ve;f=Et*m,_=st(qe),g=Ze}})():w;let E=0,C=0,A=0;const M=c&&i.tile.surface.isWebMercatorOnPlateeCarree,I=(ye,we,$e,st)=>{if(c){const vt=we*m,Ot=M?(Math.PI/2-2*Math.atan(Math.exp(-$e/u)))*u:$e*m,Ve=vt-f,De=Ot-_,ft=st-g;E+=-Ve*ft,C+=-De*ft,A+=Ve*Ve+De*De}else{const vt=V4(ye),Ot=ye.tile,Ve=Ot.extent,De=Ot.extentInRadians,ft=(we-Ve[0])/(Ve[2]-Ve[0]),Et=($e-Ve[1])/(Ve[3]-Ve[1]),qe=De[0]*(1-ft)+De[2]*ft,Ze=vt(Et),$i=Math.cos(Ze),mi=Math.sin(Ze),Wt=Math.sin(qe),bt=Math.cos(qe),Vt=u+st,He=bt*$i*Vt-f,We=Wt*$i*Vt-_,et=mi*Vt-g,Pt=We*v-et*b,Nt=et*x-He*v,wt=He*b-We*x;E+=Nt*et-wt*We,C+=wt*He-Pt*et,A+=Pt*We-Nt*He}},L=l.extent,U=e.clippingArea,j=y(U)?U:BR,re=L[0],ee=L[2],H=L[1],V=L[3],X=[V>j[3],ee>j[2],H<j[1],re<j[0]],$=Math.max(re,j[0]),B=Math.min(ee,j[2]),W=Math.max(H,j[1]),te=Math.min(V,j[3]),ie=s.uvRange[0],Y=s.uvRange[1],se=s.uvRange[2],Ee=s.uvRange[3],Re=l.surface.shading||Wg,Ie=ye=>{var Et;if(!c){const qe=1/Math.sqrt(f*f+_*_+g*g);x=f*qe,b=_*qe,v=g*qe}const we=n[ye].cornerTiles;E=0,C=0,A=0;let $e=1/0;for(let qe=0;qe<4;++qe)$e=Math.min($e,((Et=we[qe])==null?void 0:Et.level)??1/0);for(let qe=0;qe<4;++qe){const Ze=we[qe];P1[qe]=(Ze==null?void 0:Ze.level)===$e?Ze:null}let st=1,vt=0;for(let qe=0;qe<4;++qe){const Ze=P1[qe];Ze&&(st=Math.max(st,Ze==null?void 0:Ze.renderData.geometryState.numVerticesPerSide),vt=Ze.extent[2]-Ze.extent[0])}const Ot=vt,Ve=st;pe(Ve>1);const De=Ot/Ve;for(let qe=0;qe<4;++qe){const Ze=P1[(qe+3)%4],$i=P1[(qe+0)%4];if(!Ze&&!$i)continue;const mi=qe===0?1:qe===1?2:qe===2?3:0,Wt=qe===0?2:qe===1?3:qe===2?0:1;if(Ze&&$i){const bt=DM[qe][0]*De,Vt=DM[qe][1]*De,He=Ze.extent,We=He[mi===0||mi===1?2:0]+bt,et=He[mi===0||mi===3?3:1]+Vt,Pt=$i.extent,Nt=Pt[Wt===0||Wt===1?2:0]+bt,wt=Pt[Wt===0||Wt===3?3:1]+Vt,At=Ze.renderData,at=$i.renderData,li=Si(We,et,At.geometryState.samplerData),Ut=Si(Nt,wt,at.geometryState.samplerData);I(At,We,et,.5*(li+Ut))}else{const bt=Ze??$i,Vt=Ze?mi:Wt,He=bt.extent,We=DM[qe],et=He[Vt===0||Vt===1?2:0]+We[0]*De,Pt=He[Vt===0||Vt===3?3:1]+We[1]*De,Nt=bt.renderData,wt=Si(et,Pt,Nt.geometryState.samplerData);I(Nt,et,Pt,wt)}}const ft=1/Math.sqrt(E*E+C*C+A*A);E*=ft,C*=ft,A*=ft};for(let ye=0;ye<4;++ye){const we=ye,$e=(ye+1)%4,st=ye===0||ye===1?1:0,vt=ye===0||ye===3?1:0,Ot=ce(st,ie,se),Ve=ce(vt,Y,Ee),De=a[we],ft=ye===0||ye===3?De.count-1:0,Et=a[$e],qe=ye===0||ye===1?Et.count-1:0,Ze=n[ye].cornerTiles;let $i=-1;for(let bt=0;bt<4;++bt){const Vt=Ze[bt];Vt&&($i===-1||vd(Ze[$i],Vt)>0)&&($i=bt)}const mi=$i,Wt=Ze[mi];if(E=0,C=0,A=1,Wt!==l){const bt=l.level-Wt.level,Vt=2**bt,He=[Wt.lij[0]+bt,Wt.lij[1]*Vt,Wt.lij[2]*Vt],We=[He[1]+Vt===l.lij[1],ye===0&&(mi===1||mi===0&&Wt!==Ze[3])||ye===1&&(mi===0||mi===1&&Wt!==Ze[2]),He[1]===l.lij[1]+1,ye===2&&(mi===3||mi===2&&Wt!==Ze[1])||ye===3&&(mi===2||mi===3&&Wt!==Ze[0])],et=We.reduce((at,li)=>at+(li?1:0),0);pe(et===1||et===2);let Pt=-1,Nt=-1;const wt=Wt.renderData;if(et===1){const at=We.findIndex(Ut=>Ut);pe(0<=at&&at<=3),Pt=(at+2)%4;const li=i.geometryState.neighborData.edgeResolutions[at];Nt=l.getNeighborEdgeStartVertexIndex(at,Wt)*li+li*(at===0&&ye===0||at===1&&ye===0||at===2&&ye===1||at===3&&ye===3?1:0)}else{pe(We[1]||We[3]),Pt=We[1]?3:1;const at=wt.geometryState.neighborData.edgeResolutions[Pt];Nt=ye===0||ye===3?0:at}const At=wt.geometryInfo.outerEdges[Pt];{const at=De.index0+ft*De.stride,li=Et.index0+qe*Et.stride,Ut=At.index0+Nt*At.stride;{const Hi=At.attributes.position,ji=Hi.typedBuffer,xn=Ut*Hi.typedBufferStride,jn=i.localOrigin,an=At.localOrigin,cl=ji[xn+0]+an[0]-jn[0],vo=ji[xn+1]+an[1]-jn[1],qn=ji[xn+2]+an[2]-jn[2];Xs(cl,vo,qn,o);{const Tn=De.attributes.position,Ki=Tn.typedBuffer,nr=at*Tn.typedBufferStride;Ki[nr+0]=cl,Ki[nr+1]=vo,Ki[nr+2]=qn}{const Tn=Et.attributes.position,Ki=Tn.typedBuffer,nr=li*Tn.typedBufferStride;Ki[nr+0]=cl,Ki[nr+1]=vo,Ki[nr+2]=qn}}go(De.attributes.uv0,at,Ot,Ve),go(Et.attributes.uv0,li,Ot,Ve);{const Hi=At.attributes.normalCompressed.typedBuffer,ji=Ut*At.attributes.normalCompressed.typedBufferStride;{const xn=De.attributes.normalCompressed,jn=xn.typedBuffer,an=at*xn.typedBufferStride;jn[an+0]=Hi[ji+0],jn[an+1]=Hi[ji+1]}{const xn=Et.attributes.normalCompressed,jn=xn.typedBuffer,an=li*xn.typedBufferStride;jn[an+0]=Hi[ji+0],jn[an+1]=Hi[ji+1]}}}}else{const bt=X[we],Vt=X[$e];let He;if(bt||Vt){const Nt=ce(re*(1-st)+ee*st,$,B),wt=ce(H*(1-vt)+V*vt,W,te),At=e.samplerData;He=Si(Nt,wt,At)}else He=VAe(Ze);T(st,vt,He),(Re||Wg)&&Ie(ye);const We=f-r[0],et=_-r[1],Pt=g-r[2];Xs(We,et,Pt,o),De.setVertexFromValuesRawPositionUVNormal(ft,We,et,Pt,Ot,Ve,E,C,A),Et.setVertexFromValuesRawPositionUVNormal(qe,We,et,Pt,Ot,Ve,E,C,A)}}for(let ye=0;ye<4;++ye)P1[ye]=null}function VAe(i){var s,a;const e=i.reduce((o,l)=>Math.min(o,(l==null?void 0:l.level)??1/0),1/0);gn&&(pe(!i[0]||!i[2]||x$(i[0],i[2],ke.SOUTH_WEST)),pe(!i[1]||!i[3]||x$(i[1],i[3],ke.NORTH_WEST)));let t=0,r=0;for(let o=0;o<4;++o){const l=i[o];if(l&&l.level===e){const c=o===0||o===1,u=o===0||o===3,d=l.extent,m=d[c?0:2],f=d[u?1:3],_=(a=(s=l.renderData)==null?void 0:s.geometryState)==null?void 0:a.samplerData;r+=Si(m,f,_),t++}}const n=t?r/t:0;return pe(n!=null),n}function zR(i){const e=i.vao,t=i.geometryInfo.vertexAttributes.position.typedBuffer;e.vertexBuffers.geometry.setSubData(t,0,0,t.length)}const DM=[[0,1],[1,0],[0,-1],[-1,0]],Tr=new ARe,BR=tG(-1/0,-1/0,1/0,1/0),P1=[null,null,null,null];function lJ(i,e,t){if(!e)return!1;const r=vd(i,e);return r>0||r===0&&t<2}const Wg=!0;let UAe=class extends D4{constructor(e,t,r){super(),this._horizontalScaleFactor=1,this._extentInRenderSR=$t(),e!==void 0&&this.init(e,t,r)}get horizontalScale(){return this._horizontalScaleFactor}init(e,t,r){super.init(e,t,r);const n=r.view.renderSpatialReference,s=r.spatialReference,a=y(n)&&v7(n)&&y(s)&&s.isGeographic?this.ellipsoid.radius*Math.PI/180:1;this._horizontalScaleFactor=a;const o=this.surface.isWebMercatorOnPlateeCarree,l=this._extentInRenderSR,c=this.extent;if(o){const u=Ge(c[0],c[1],0);ss(u,Qt.WebMercator,u,Qt.PlateCarree);const d=Ge(c[2],c[3],0);ss(d,Qt.WebMercator,d,Qt.PlateCarree),l[0]=u[0],l[1]=u[1],l[2]=d[0],l[3]=d[1]}else for(let u=0;u<4;++u)l[u]=c[u]*a;this.centerAtSeaLevel[0]=.5*(l[0]+l[2]),this.centerAtSeaLevel[1]=.5*(l[1]+l[3]),this.centerAtSeaLevel[2]=0,this._edgeLen=Math.max(l[2]-l[0],l[3]-l[1]),this._edgeLen2=this._edgeLen*this._edgeLen,this.updateRadiusAndCenter()}updateRadiusAndCenter(){this._updateCenter();const e=this._extentInRenderSR,t=.5*(e[2]-e[0]),r=.5*(e[3]-e[1]),n=Math.sqrt(t*t+r*r),s=.5*(this.elevationBounds[0]-this.elevationBounds[1]),a=Math.max(n,s);this._center[Hs.MIDDLE][3]=a}_calculateFrustumVisibilityStatus(e){const t=this._aabb(),r=t[0],n=t[1],s=t[2],a=t[3],o=t[4],l=t[5];let c=!0;for(let u=0;u<6;u++){const d=e[u],m=d[0],f=d[1],_=d[2],g=d[3];if(m*(m>0?r:a)+f*(f>0?n:o)+_*(_>0?s:l)+g>=0)return xs.OUTSIDE;c=c&&m*(m<0?r:a)+f*(f<0?n:o)+_*(_<0?s:l)+g<=0}return c?xs.INSIDE:xs.INTERSECTS}_aabb(){const e=this._extentInRenderSR;return yse(e[0],e[1],this.elevationBounds[0],e[2],e[3],this.elevationBounds[1])}intersectsRay(e,t,r,n){return KC[0]=1/t[0],KC[1]=1/t[1],KC[2]=1/t[2],MG(this._aabb(),e,KC,r,n)}createGeometry(){MAe(this.renderData,this._horizontalScaleFactor),this.setMemoryDirty()}getDefaultVerticesPerRowOnLevel(){return this.level<9?3:2}updateCornerElevations(){DAe(this.renderData,this._horizontalScaleFactor)}updateEdgeElevations(){FAe(this.renderData,this._horizontalScaleFactor)}};const KC=R();var wx;(function(i){i[i.BACK_TO_FRONT=-1]="BACK_TO_FRONT",i[i.NONE=0]="NONE",i[i.FRONT_TO_BACK=1]="FRONT_TO_BACK"})(wx||(wx={}));let zAe=class extends D4{constructor(e,t,r){super(),this._obb=new Array(8);for(let n=0;n<8;n++)this._obb[n]=R();e!==void 0&&this.init(e,t,r)}init(e,t,r){super.init(e,t,r);const n=this.ellipsoid.radius,s=this.extentInRadians[0],a=this.extentInRadians[1],o=this.extentInRadians[2],l=this.extentInRadians[3],c=e[0],u=dt(a,l,.5),d=dt(s,o,.5),m=c===0?0:Math.min(Math.abs(a),Math.abs(l));this._edgeLen=(o-s)*Math.cos(m)*n,this._edgeLen2=this._edgeLen*this._edgeLen,this._curvatureHeight=n-Math.sqrt(n*n-this._edgeLen2/4),Dv(this.centerAtSeaLevel,d,u,this.ellipsoid.radius);const f=Tl(this.centerAtSeaLevel);he(f,f),this.up=f,this._updateOBB(),this.updateRadiusAndCenter()}updateRadiusAndCenter(){if(this.lij[0]===0)Z(this._center[mc.MIDDLE],0,0,0),Z(this._center[mc.TOP],0,0,0),Z(this._center[mc.BOTTOM],0,0,0),this.ellipsoid||(this.ellipsoid=Yt(this.surface.spatialReference)),this._center[mc.MIDDLE][3]=this.ellipsoid.radius+this.elevationBounds[1];else{this._updateCenter();const e=Math.max(Bl(this._center[mc.MIDDLE],this._obb[0]),Bl(this._center[mc.MIDDLE],this._obb[1]));this._center[mc.MIDDLE][3]=Math.sqrt(e)}}_calculateFrustumVisibilityStatus(e){if(!$P(e,this._center[mc.MIDDLE]))return xs.OUTSIDE;if(this.lij[0]<10)return xs.INTERSECTS;const t=this._obb,r=this.surface.view.state.camera.near;let n=!0;for(let s=0;s<hse.NUM;s++){const a=s===hr.NEAR,o=e[s],l=o[0],c=o[1],u=o[2],d=o[3]-(a?r:0);let m=!1;for(let f=0;f<8;++f){const _=t[f];if(l*_[0]+c*_[1]+u*_[2]+d<0){if(m=!0,!n)break}else n=!1}if(!m)return xs.OUTSIDE}return n?xs.INSIDE:xs.INTERSECTS}computeElevationBounds(){super.computeElevationBounds(),this._updateOBB()}createGeometry(){const e=this._getPatchType(this.lij[1],this.lij[0]);TAe(this.renderData,e),this.setMemoryDirty()}_updateOBB(){const e=this.extentInRadians,t=this._obb;for(let r=0;r<2;r++){const n=this.elevationBounds[r];let s=4*r;Dv(t[s++],e[0],e[1],this.ellipsoid.radius+n),Dv(t[s++],e[0],e[3],this.ellipsoid.radius+n),Dv(t[s++],e[2],e[3],this.ellipsoid.radius+n),Dv(t[s++],e[2],e[1],this.ellipsoid.radius+n)}if(this.surface.isWebMercator)switch(this._getPatchType(this.lij[1],this.lij[0])){case Rl.HAS_NORTH_POLE:Z(t[1],0,0,this.ellipsoid.radius),Z(t[2],0,0,this.ellipsoid.radius),Z(t[5],0,0,this.ellipsoid.radius),Z(t[6],0,0,this.ellipsoid.radius);break;case Rl.HAS_SOUTH_POLE:Z(t[0],0,0,-this.ellipsoid.radius),Z(t[3],0,0,-this.ellipsoid.radius),Z(t[4],0,0,-this.ellipsoid.radius),Z(t[7],0,0,-this.ellipsoid.radius)}}_getPatchType(e,t){return e===(1<<t)-1?e===0?Rl.HAS_BOTH_POLES:Rl.HAS_SOUTH_POLE:e===0?Rl.HAS_NORTH_POLE:Rl.REGULAR}intersectsRay(e,t,r,n){const s=this._center[mc.MIDDLE],a=s[3]+r,o=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],l=s[0]-e[0],c=s[1]-e[1],u=s[2]-e[2],d=(l*t[0]+c*t[1]+u*t[2])/o,m=t[0]*d-l,f=t[1]*d-c,_=t[2]*d-u;return m*m+f*f+_*_<a*a}getDefaultVerticesPerRowOnLevel(){return this.level<Vz.length?Vz[this.level]+1:2}updateCornerElevations(){RAe(this.renderData)}updateEdgeElevations(){PAe(this.renderData)}};const Vz=[128,64,32,16,16,8,8,4];var mc;(function(i){i[i.TOP=0]="TOP",i[i.MIDDLE=1]="MIDDLE",i[i.BOTTOM=2]="BOTTOM"})(mc||(mc={}));let BAe=class{constructor(){this.extent=_i(),this.minLevel=0,this.maxLevel=0,this.callback=null}},GAe=class{constructor(){this._queries=new Zt({initialSize:10}),this._queriesInvPtr=0,this._queryQueue=new Zt({initialSize:30}),this._queryPool=new Fl(BAe)}queryVisibleLevelRange(e,t,r,n){const s=this._queryPool.acquire();im(s.extent,e),s.minLevel=t||-Number.MAX_VALUE,s.maxLevel=r??Number.MAX_VALUE,s.callback=n,this._queryQueue.push(s)}hasPendingQueries(){return this._queryQueue.length!==0}prepareQueries(){for(;this._queries.length<this._queries.data.length&&this._queryQueue.length>0;){const e=this._queryQueue.pop();this._queries.push(e)}this._queriesInvPtr=this._queries.length}processQueries(){for(let e=0;e<this._queries.length;e++){const t=this._queries.data[e];this._queryPool.release(t),t.callback(e>=this._queriesInvPtr),t.callback=null}this._queries.clear()}scaleQueriesForTile(e){const t=e.level;let r=0;for(;r<this._queriesInvPtr;){const n=this._queries.data[r],s=n.extent;t>=n.minLevel&&t<=n.maxLevel&&s[0]<=e.extent[2]&&s[2]>=e.extent[0]&&s[1]<=e.extent[3]&&s[3]>=e.extent[1]?(this._queries.swapElements(r,this._queriesInvPtr-1),this._queriesInvPtr--):r++}}},cJ=class extends $a{constructor(){super(...arguments),this.blendMode=fe.Normal}};h([N({count:fe.COUNT})],cJ.prototype,"blendMode",void 0);let b0=class extends cJ{constructor(){super(...arguments),this.output=Zr.Composite,this.baseOpacityMode=Dc.NotRequired,this.premultipliedSource=bc.Off,this.hasWebGL2Context=!1}};h([N({count:Zr.COUNT})],b0.prototype,"output",void 0),h([N({count:Dc.COUNT})],b0.prototype,"baseOpacityMode",void 0),h([N()],b0.prototype,"premultipliedSource",void 0),h([N()],b0.prototype,"hasWebGL2Context",void 0);var Xg;function HAe(i){const e=new Yi;if(e.include(HK),i.background===Xg.Only){const t=i.output===Zr.ColorComposite;return t?e.fragment.uniforms.add(new Rs("backgroundColor",r=>r.backgroundColor)):(e.extensions.add("GL_OES_standard_derivatives"),e.fragment.include($4)),e.fragment.code.add(O`
    void main() {
      gl_FragColor = ${t?O`vec4(backgroundColor, 1.0)`:O`gridColor(uv)`};
    }
  `),e}return e.include(jK,i),e.fragment.uniforms.add(new Bt("tex",t=>t.texture)),e.fragment.uniforms.add(new Tt("opacity",t=>t.opacity)),e.fragment.code.add(O`void main() {
vec4 bgColor = getBackground(uv);
gl_FragColor = blendLayers(bgColor, texture2D(tex, uv), opacity);
}`),e}(function(i){i[i.BelowLayer=0]="BelowLayer",i[i.Only=1]="Only",i[i.COUNT=2]="COUNT"})(Xg||(Xg={}));const jAe=Object.freeze(Object.defineProperty({__proto__:null,get BackgroundMode(){return Xg},build:HAe},Symbol.toStringTag,{value:"Module"}));let qAe=class extends GK{constructor(){super(...arguments),this.opacity=1,this.baseOpacity=1,this.texture=null,this.fboTexture=null,this.backgroundColor=Gl}},hJ=class uJ extends ti{initializeConfiguration(e,t){t.hasWebGL2Context=e.rctx.type===Nn.WEBGL2}initializeProgram(e){return new Jt(e.rctx,uJ.shader.get().build(this.configuration),ai)}initializePipeline(){return Ke({blending:lu(de.ONE,de.ONE_MINUS_SRC_ALPHA),colorWrite:ht})}};hJ.shader=new ii(jAe,()=>G(()=>import("./BlendLayers.glsl-8c38de7e.js"),["assets/BlendLayers.glsl-8c38de7e.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/vec2f64-30dc1443.js","assets/VertexAttribute-9c5c630d.js","assets/vec2-528adfe4.js","assets/common-c186b691.js","assets/Texture2DPassUniform-753de459.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));let dJ=class extends b0{constructor(){super(...arguments),this.background=Xg.BelowLayer}};h([N()],dJ.prototype,"background",void 0);let FM=class{constructor(e,t,r,n,s,a){this.texture=e,this.type=t,e.retain(),this.offsetAndScale=Bi(r.offset[0],r.offset[1],r.scale,r.scale),this.opacities=Ge(n,s,a)}destroy(){this.texture.release()}};const WAe=.125;let XAe=class{constructor(){this._renderParams={context:null,drawPhase:1,state:new Z3({viewpoint:new rr({targetGeometry:new Ne(0,0),scale:1,rotation:0}),size:[256,256]}),stationary:!0,pixelRatio:1,displayLevel:-1,requiredLevel:-1,globalOpacity:1,renderPass:"background",styleLayer:null,styleLayerUID:-1,painter:null,glyphMosaic:null,spriteMosaic:null,profiler:null,renderingOptions:null,requestRender:null,allowDelayedRender:!1,deltaTime:-1,timeline:null,time:0,hasClipping:!1,blendMode:null,dataUploadCounter:0,effects:null,inFadeTransition:!1,requireFBO:!1}}dispose(){this._renderParams=null}render(e,t,r,n,s,a,o,l,c,u){const d=a.adjustLevel(t[0]),m=this._renderParams;m.context=e,m.painter=n,m.glyphMosaic=n.glyphMosaic,m.spriteMosaic=n.spriteMosaic,m.pixelRatio=u,m.displayLevel=d,m.requiredLevel=d;const f=a.getScale(t[0]),[_,g]=a.getShift(t,o*f),x=WAe*o*f/c,b=r.transforms.dvs;b[0]=x,b[4]=-x,b[6]=-1-_-l[0]*o*2,b[7]=1+g+(1-l[1])*o*2-2,m.state.size[0]=c,m.state.size[1]=c,r.stage||r.attachWithContext(e),r.triangleCount=0,n.drawTile(m,r,s)}},pJ=class mJ extends ti{initializeConfiguration(e,t){t.hasWebGL2Context=e.rctx.type===Nn.WEBGL2}initializeProgram(e){return new Jt(e.rctx,mJ.shader.get().build(this.configuration),ai)}initializePipeline(){return Ke({blending:lu(de.ONE,de.ONE_MINUS_SRC_ALPHA),colorWrite:ht})}};pJ.shader=new ii(ZRe,()=>G(()=>import("./RasterColorizer.glsl-7dcf3a0f.js"),["assets/RasterColorizer.glsl-7dcf3a0f.js","assets/vec3f64-2f9cef06.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/vec2-528adfe4.js","assets/common-c186b691.js","assets/vec2f64-30dc1443.js","assets/Texture2DPassUniform-753de459.js","assets/VertexAttribute-9c5c630d.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));let fE=class extends b0{constructor(){super(...arguments),this.colorizerType=Tg.Stretch,this.stretchType=qg.Noop,this.applyColormap=!0}};h([N({count:Tg.COUNT})],fE.prototype,"colorizerType",void 0),h([N({count:qg.COUNT})],fE.prototype,"stretchType",void 0),h([N()],fE.prototype,"applyColormap",void 0);let Uz=class{constructor(e){this._rctx=e,this._fbos=new Map}get(e){return this._getPool(e)}dispose(){this._fbos.forEach(e=>e.dispose()),this._fbos.clear()}_getPool(e){const t=this._fbos.get(e);if(t)return t;const r=new yn(this._rctx,{colorTarget:Vn.TEXTURE,depthStencilTarget:rs.DEPTH_RENDER_BUFFER,width:e,height:e});return this._fbos.set(e,r),r}};const QAe=J.getLogger("esri.views.3d.terrain");let ZAe=class{constructor(e,t){this._rctx=e,this._techniqueRepository=t,this._fbos=[],this._vectorTileHelper=new XAe,this._bindParameters=new yR(null,null,null),this._blendLayersTechniqueConfig=new dJ,this._current=0,this._lastUsedIds=new Array,this._lastCreatedBufferId=0,this._onHoldIds=new Array,this._vaoQuad=La(this._rctx,kx)}dispose(){this._fbos.forEach(e=>{e.dispose(),e=null}),this._fbos=null,this._vtFBO=Me(this._vtFBO),this._vaoQuad=Me(this._vaoQuad),this._vectorTileHelper=Me(this._vectorTileHelper),this._backgroundTechnique=Qi(this._backgroundTechnique),this._applyOpacityTechnique=Qi(this._applyOpacityTechnique),this._blendLayersTechnique=Qi(this._blendLayersTechnique)}_getBlendLayersTechnique(e,t,r,n=bc.Off,s=Xg.BelowLayer){return this._blendLayersTechniqueConfig.output=t,this._blendLayersTechniqueConfig.blendMode=e,this._blendLayersTechniqueConfig.baseOpacityMode=r,this._blendLayersTechniqueConfig.premultipliedSource=n,this._blendLayersTechniqueConfig.background=s,this._blendLayersTechnique=this._techniqueRepository.releaseAndAcquire(hJ,this._blendLayersTechniqueConfig,this._blendLayersTechnique),this._blendLayersTechnique}drawBackground(e,t){const r=this._getBlendLayersTechnique(fe.Normal,t?Zr.ColorComposite:Zr.GridComposite,Dc.NotRequired,bc.Off,Xg.Only),n=this._rctx.bindTechnique(r,e,this._bindParameters);this._render(n)}_render(e){this._rctx.bindVAO(this._vaoQuad),e.assertCompatibleVertexAttributeLocations(this._vaoQuad),this._rctx.drawArrays(Dt.TRIANGLE_STRIP,0,Ws(this._vaoQuad,"geometry"))}drawGroup(e,t,r,n,s,a=bc.On){t===Zr.Composite&&(e.fboTexture=this._fbos[this.getLastOnHoldId()].get(r).colorTexture),e.texture=this.currentFBO(r).colorTexture,this.closeGroup(r);const o=this._getBlendLayersTechnique(n,t,s,a),l=this._rctx.bindTechnique(o,e,this._bindParameters);this._render(l)}drawRasterData(e,t,r,n,s,a=bc.Off){if(S(e.texture))return;e.fboTexture=t===Zr.GroupBackgroundComposite||n===fe.Normal&&s===Dc.NotRequired&&a===bc.Off?null:this.switch(r).colorTexture;const o=this._getBlendLayersTechnique(n,t,s,a),l=this._rctx.bindTechnique(o,e,this._bindParameters);this._render(l)}drawImageryTileData(e,t,r,n,s,a){const o=a.sourceLayerInfo.data;if(!o.source||(a.tile.surface.layerViewByIndex(a.layerIndex,ut.MAP).ensureSymbolizerParameters(o),!o.bind(this._rctx)))return;e.fboTexture=n===fe.Normal&&s===Dc.NotRequired?null:this.switch(r).colorTexture;const l=this._getRasterColorizerTechnique(o,t,n,s);o.opacity=e.opacity;const c=o.getUniforms();c.scale=a.scale,c.offset=a.offset,c.backgroundColor=e.backgroundColor,c.fboTexture=e.fboTexture,c.baseOpacity=e.baseOpacity;const u=this._rctx.bindTechnique(l,c,null);this._render(u)}_getRasterColorizerTechnique(e,t,r,n){const s=e.symbolizerParameters,a=["stretch","lut","hillshade"].indexOf(s.type);return S(this._rasterColorizerConfig)&&(this._rasterColorizerConfig=new fE,this._rctx.gl.getExtension("WEBGL_color_buffer_float"),this._rctx.gl.getExtension("OES_texture_float")),this._rasterColorizerConfig.output=t,this._rasterColorizerConfig.blendMode=r,this._rasterColorizerConfig.baseOpacityMode=n,this._rasterColorizerConfig.colorizerType=a,this._rasterColorizerConfig.applyColormap=!!s.colormap,this._rasterColorizerConfig.stretchType=e.hasStretchTypeNone()?qg.Noop:qg.PerBand,this._rasterColorizerTechnique=this._techniqueRepository.releaseAndAcquire(pJ,this._rasterColorizerConfig,this._rasterColorizerTechnique),this._rasterColorizerTechnique}drawVectorData(e,t,r,n,s,a,o,l,c){const u=this._rctx,d=a.sourceLayerInfo.data,m=a.tile.surface.layerViewByIndex(a.layerIndex,ut.MAP),f=s===Dc.Required||e.opacity<1||n!==fe.Normal||t!==Zr.Composite,_=f?bc.On:bc.Off;this._getBlendLayersTechnique(n,t,s,_).bindPipelineState(u);let g=null,x=null;f?(x=this.currentFBO(r),S(this._vtFBO)&&(this._vtFBO=new Uz(this._rctx)),g=this._vtFBO.get(r),u.bindFramebuffer(g),this._clearCurrentFBO()):c&&u.clearSafe(Ai.DEPTH_BUFFER_BIT);try{this._vectorTileHelper.render(u,a.sourceLod,d,m.painter,m.layer.styleRepository,m.schemaHelper,Math.round(1/a.scale),a.offset,l,o)}catch(b){QAe.warnOnce("A render call containing vector tiles did not resolve correctly.",b)}return!y(g)||(u.bindFramebuffer(x),e.texture=g.colorTexture,e.offset=Pg,e.scale=1,this.drawRasterData(e,t,r,n,s,_),c)}copyFBOToTexture(e){const t=this._rctx,r=t.bindTexture(e.texture,Gi.TEXTURE_UNIT_FOR_UPDATES),n=e.descriptor;t.gl.copyTexImage2D(vi.TEXTURE_2D,0,n.pixelFormat,0,0,n.width,n.height,0),e.generateMipmap(),t.bindTexture(r,Gi.TEXTURE_UNIT_FOR_UPDATES)}_clearCurrentFBO(){this._rctx.setClearColor(0,0,0,0),this._rctx.setClearDepth(1),this._rctx.clearSafe(Ai.COLOR_BUFFER_BIT|Ai.DEPTH_BUFFER_BIT)}_initFBO(e,t,r){this._rctx.bindFramebuffer(e),r&&(this._rctx.setViewport(0,0,t,t),this._clearCurrentFBO())}ensureBuffer(e){this._lastUsedIds.length=0,this._lastUsedIds.push(1),this._lastCreatedBufferId=1,this._onHoldIds.length=0,this.bind(e)}bind(e,t=0,r=!0){if(this._current=t,t>=this._fbos.length)for(let n=this._fbos.length;n<=t;n++)this._fbos.push(new Uz(this._rctx));this._initFBO(this._fbos[t].get(e),e,r)}_bindNextFreeBuffer(e){this._lastUsedIds.length>0?this.bind(e,this._lastUsedIds.pop()):(this._lastCreatedBufferId++,this.bind(e,this._lastCreatedBufferId))}openGroup(e){this._onHoldIds.push(this._current),this._bindNextFreeBuffer(e)}switch(e){const t=this.currentFBO(e),r=this._current;return this._bindNextFreeBuffer(e),this._lastUsedIds.push(r),t}getLastOnHoldId(){return this._onHoldIds[this._onHoldIds.length-1]}closeGroup(e){const t=this._current;this._bindNextFreeBuffer(e),this._lastUsedIds.push(t),this._lastUsedIds.push(this._onHoldIds.pop())}unbind(){this._rctx.bindFramebuffer(null)}currentFBO(e){return this._fbos[this._current].get(e)}},YAe=class{constructor(e,t,r,n){this.start=e,this.end=t,this.blendMode=r,this.opacity=n}},KAe=class{constructor(e,t,r){this._rctx=e,this.tileSize=t,this._techniqueRepository=r,this._passParameters=new qAe,this._backgroundTexture=null,this._backgroundColor=null,this._backgroundDirty=!1,this._blackTex=null,this._maxAnisotropy=this._rctx.parameters.maxMaxAnisotropy,this._composition=new ZAe(this._rctx,this._techniqueRepository),this._blackTex=new My(lne(this._rctx,[0,0,0,1])),this._ensureBackgroundTexture(this.tileSize)}dispose(){this._composition=Me(this._composition),this._backgroundTexture=Qi(this._backgroundTexture),this._blackTex=Qi(this._blackTex)}get backgroundIsGrid(){return S(this._backgroundColor)}get backgroundColor(){return this._backgroundColor}updateTileTexture(e,t){if(!e.renderData)return;const r=e.surface,n=r.baseOpacity;let s=0,a=0,o=this.tileSize,l=!1;const c=r.view.state.pixelRatio;let u=!1;ow.clear(),iy.length=0;const d=e.layerInfo[ut.MAP];let m=d.length,f=0;for(;f<d.length;f++){const x=r.layerViewByIndex(f,ut.MAP),b=x.layer.opacity;zz[f]=b;const v=x.fullOpacity;if(Bz[f]=v,fG(x.layer)&&m>=d.length&&(m=f),uP(x)){Gz[f]=x.layer.blendMode;let T=x.layer.blendMode!=="normal";if(uv(x.layer.parent)){const E=C$(x.layer.parent);y(E)&&E!==""&&(T=fJ(x.layer.parent)||T)}T&&(u=T,l=!1)}if(b===0&&!u){d[f].pendingUpdates&=~(Fe.TEXTURE_NOFADING&Fe.TEXTURE_FADING);continue}++a;const w=NM(e,f);if(w){if(d[f].pendingUpdates&=~(Fe.TEXTURE_NOFADING&Fe.TEXTURE_FADING),uv(x.layer.parent)){const T=C$(x.layer.parent);y(T)&&T!==""&&gJ(x.layer.parent,f)}yx(x)?o=Math.max(o,this.tileSize*c):n===1&&v===1&&(x.isOpaque||this._dataToTexture(w)&&w.sourceLayerInfo.data.descriptor.isOpaque)&&(l=!0),++s}}o=JAe(o);const _=o/this.tileSize,g=f-1;this._ensureBackgroundTexture(this.tileSize),s!==0?s===1&&!u&&this._useLayerTexture(e,g,m,Bz[g])||this._composeMapLayers(e,t,g,m,zz,Gz,o,_,!l||u,ow,u):this._useBackgroundTexture(e,a)}_ensureBackgroundTexture(e){S(this._backgroundTexture)&&(this._backgroundTexture=this._buildTexture(e),this._backgroundDirty=!0),this._backgroundDirty&&(this._composition.bind(e),this._passParameters.offset=Pg,this._passParameters.scale=1,this._passParameters.opacity=1,y(this.backgroundColor)&&(this._passParameters.backgroundColor=this.backgroundColor),this._composition.drawBackground(this._passParameters,y(this.backgroundColor)),this._composition.copyFBOToTexture(this._backgroundTexture),this._composition.unbind(),this._backgroundDirty=!1)}_useBackgroundTexture(e,t){let r=yd.Immediate;(e.surface.view.layerViewManager.updating||t>0)&&(r=yd.Delayed),this._backgroundTexture&&S(e.renderData.textureReference)&&(r=yd.Immediate),e.renderData.setTextureReference(y(this._backgroundTexture)?new FM(this._backgroundTexture,fn.FADING,Hz,e.surface.baseOpacity,0,1):null,r)}_useLayerTexture(e,t,r,n){const s=t<r,a=s?1:e.surface.baseOpacity,o=s?e.surface.baseOpacity:1,l=NM(e,t);return!!this._dataToTexture(l)&&(e.renderData.setTextureReference(new FM(l.sourceLayerInfo.data,fn.FADING,l,a,o,n)),!0)}_composeMapLayers(e,t,r,n,s,a,o,l,c,u,d){this._composition.ensureBuffer(o);const m=e.surface.baseOpacity;let f=!1,_=Kt.LINEAR_MIPMAP_LINEAR,g=!1,x=0;for(let v=r;v>=0;v--){const w=NM(e,v);if(!w||s[v]===0&&!d)continue;const T=v<n&&m<1&&!f;this._passParameters.baseOpacity=T?m:1;const E=this._passParameters.baseOpacity<1?Dc.Required:Dc.NotRequired;T&&(f=!0);let C=!1;u.forEach(L=>{L.start===v&&(iy.push(L),this._composition.openGroup(o),C=!0)});const A=x===0,M=C?Zr.GroupBackgroundComposite:c&&A?this.backgroundIsGrid?Zr.GridComposite:Zr.ColorComposite:Zr.Composite,I=w$[a[v]];for(OPe(w)?(this._passParameters.opacity=s[v],g=this._composition.drawVectorData(this._passParameters,M,o,I,E,w,l,this.tileSize,g)):APe(w)?(this._passParameters.opacity=s[v],this._composition.drawImageryTileData(this._passParameters,M,o,I,E,w),this._hasNearestInterpolation(w)&&(_=Kt.NEAREST)):this._dataToTexture(w)&&(this._passParameters.texture=w.sourceLayerInfo.data.texture,this._passParameters.offset=w.offset,this._passParameters.scale=w.scale,this._passParameters.opacity=s[v],this._composition.drawRasterData(this._passParameters,M,o,I,E));iy.length>0&&iy[iy.length-1].end===v;){const L=iy.pop();this._passParameters.opacity=L.opacity,this._passParameters.offset=Pg,this._passParameters.scale=1;const U=c&&A?this.backgroundIsGrid?Zr.GridComposite:Zr.ColorComposite:Zr.Composite;this._composition.drawGroup(this._passParameters,U,o,w$[L.blendMode],E)}x++}const b=e.renderData.ensureTexture(o,()=>this._buildTexture(o,_));this._composition.copyFBOToTexture(b),this._composition.unbind(),e.renderData.setTextureReference(new FM(b,t,Hz,f?1:m,0,1))}_hasNearestInterpolation(e){const t=e.sourceLayerInfo.data;return!!t.source&&t.interpolation==="nearest"}_dataToTexture(e){if(IPe(e)){const t=e.sourceLayerInfo;t.data=this._buildTexture(t.data),e.tile.setMemoryDirty()}return MPe(e)}setBackground(e){this._backgroundColor!==e&&(this._backgroundColor=e,this._backgroundDirty=!0)}_buildTexture(e,t=Kt.LINEAR_MIPMAP_LINEAR){if(S(e))return null;const r={target:vi.TEXTURE_2D,pixelFormat:yt.RGBA,dataType:qt.UNSIGNED_BYTE,wrapMode:si.CLAMP_TO_EDGE,samplingMode:t,maxAnisotropy:this._maxAnisotropy,flipped:!0,hasMipmap:!0},n=this._rctx;let s;if(typeof e=="number")r.width=r.height=e,s=new My(new Gi(n,r));else if(e instanceof FR)r.isOpaque=e.isOpaque,s=new My(new Gi(n,r,e.image)),e.release();else try{r.width=e.width,r.height=e.height,s=new My(new Gi(n,r,e))}catch{s=new My(IG(n)),console.warn("TileRenderer: failed to execute 'texImage2D', cross-origin image may not be loaded.")}const a=n.bindTexture(s.texture,Gi.TEXTURE_UNIT_FOR_UPDATES);return s.generateMipmap(),n.bindTexture(a,Gi.TEXTURE_UNIT_FOR_UPDATES),s}get test(){return{backgroundTexture:this._backgroundTexture}}};function JAe(i){const e=Y$(i),t=e*e,r=i*i;if(t===r)return i;const n=e/2;return t-r<r-n*n?e:n}function NM(i,e){Oo.layerIndex=e;const t=i.layerInfo[ut.MAP][e];if(y(t.data))return Je(Oo.offset,0,0),Oo.tile=i,Oo.scale=1,Oo.sourceLod=i.lij,Oo.sourceLayerInfo=t,Oo;const r=t.upsampleInfo;if(y(r)){const n=r.tile.layerInfo[ut.MAP][e];return Oo.tile=r.tile,wn(Oo.offset,r.offset),Oo.scale=r.scale,Oo.sourceLod=r.tile.lij,Oo.sourceLayerInfo=n,Oo}return null}function C$(i){return i.get("uid")}function fJ(i){let e=i.blendMode!=="normal";return uv(i.parent)&&(e=fJ(i.parent)||e),e}function gJ(i,e){uv(i.parent)&&gJ(i.parent,e);const t=C$(i);y(t)&&t!==""&&(ow.has(t)?ow.get(t).start=e:ow.set(t,new YAe(e,e,i.blendMode,i.opacity)))}const zz=new Array,Bz=new Array,Gz=new Array,ow=new Map,iy=new Array,Oo={tile:null,sourceLayerInfo:null,sourceLod:null,offset:[0,0],scale:1,layerIndex:0},Hz={offset:[0,0],scale:1},_J=200,kM=40,eOe=.8,tOe=10,_b=1e-6;function iOe(i,e,t){const r=e,n=t;let s=0,a=1/0;for(let o=0;o<3;++o){{const l=i[o];if(r[o]<l){if(n[o]<=_b)return!1;const c=(l-r[o])/n[o];s=Math.max(s,c)}else if(n[o]<=-_b){const c=(l-r[o])/n[o];a=Math.min(a,c)}if(s>a)return!1}{const l=i[o+3];if(r[o]>l){if(n[o]>=-_b)return!1;const c=(l-r[o])/n[o];s=Math.max(s,c)}else if(n[o]>=_b){const c=(l-r[o])/n[o];a=Math.min(a,c)}if(s>a)return!1}}return!0}let jz=class{constructor(e,t,r,n,s){this.aabb=e,this.axis=t,this.d=r,this.midStartIndex=n,this.rightStartIndex=s}},z4=class S${constructor(e,t,r,n){this.globalTriangleVertexIndices=e,this.firstTriangleIndex=t,this.positionAttribute=n,this._rayDirection=R(),this.bspNodeTree=new Array,this.vertexPositionBuffer=n.data,this.vertexPositionStride=n.stride;const s=r-t,a=s<=yJ?new Uint16Array(s):new Uint32Array(s);this.indices=a;for(let o=0;o<s;++o)a[o]=o;{const o=oOe(e,t,r,n.data,n.stride),l=ce(Math.log2(s/kM),2,tOe),c=(u,d,m)=>{const f=sOe(a,o,u,d),_=d-u;if(_<=kM){const T=new jz(f,void 0,0,u,d);return this.bspNodeTree.push(T),T}const{axis:g,midValue:x}=aOe(f),b=nOe(a,o,u,d,g,x),v=(T,E)=>{if(m>l)return;const C=E-T;return C<kM||C>=eOe*_?void 0:c(T,E,m+1)},w=new jz(f,g,x,b.next,b.mid);return this.bspNodeTree.push(w),w.leftNode=v(u,b.next),w.rightNode=v(b.mid,d),w};c(0,s,0),this.triangleVertexIndices=lOe(a,e,t,r)}}intersectRayTriangleRange(e,t){{if(e>=t)return;const r=this.triangleVertexIndices,n=this.positionAttribute.data,s=this.positionAttribute.stride,a=this._rayOrigin,o=a[0],l=a[1],c=a[2],u=this._rayDirection,d=u[0],m=u[1],f=u[2];for(let _=e,g=3*e;_<t;++_){let x=r[g++]*s;const b=n[x++],v=n[x++],w=n[x];x=r[g++]*s;const T=n[x++],E=n[x++],C=n[x];x=r[g++]*s;const A=T-b,M=E-v,I=C-w,L=n[x++]-b,U=n[x++]-v,j=n[x]-w,re=m*j-U*f,ee=f*L-j*d,H=d*U-L*m,V=A*re+M*ee+I*H;if(Math.abs(V)<=Number.EPSILON)continue;const X=o-b,$=l-v,B=c-w,W=X*re+$*ee+B*H;if(V>0){if(W<0||W>V)continue}else if(W>0||W<V)continue;const te=$*I-M*B,ie=B*A-I*X,Y=X*M-A*$,se=d*te+m*ie+f*Y;if(V>0){if(se<0||W+se>V)continue}else if(se>0||W+se<V)continue;const Ee=(L*te+U*ie+j*Y)/V;if(Ee>=0){const Re=this.indices[_]+this.firstTriangleIndex,Ie=cne(A,M,I,L,U,j,rOe);this._callback(Ee,Ie,Re,!1)}}}S$.numFacesTested+=t-e}intersectRay(e,t){S$.numFacesTested=0;const r=Ge(e.r0[0],e.r0[1],e.r0[2]),n=Ge(e.r1[0],e.r1[1],e.r1[2]),s=n[0]-r[0],a=n[1]-r[1],o=n[2]-r[2];if(s*s+a*a+o*o<_b)return;this._rayOrigin=r;const l=this._rayDirection;l[0]=s,l[1]=a,l[2]=o;const c=this.triangleVertexIndices.length/3;this._callback=t;const u=this.bspNodeTree[0];this.intersectRayBSP(u,0,c)}intersectRayBSP(e,t,r){const n=this._rayOrigin,s=this._rayDirection;if(!iOe(e.aabb,n,s))return;const a=e.axis,o=e.d;if(n[a]<o||s[a]<0){const l=t,c=e.midStartIndex;if(l<c){const u=e.leftNode;u!==void 0?this.intersectRayBSP(u,l,c):this.intersectRayTriangleRange(l,c)}}if(this.intersectRayTriangleRange(e.midStartIndex,e.rightStartIndex),n[a]>o||s[a]>0){const l=e.rightStartIndex,c=r;if(l<c){const u=e.rightNode;u!==void 0?this.intersectRayBSP(u,l,c):this.intersectRayTriangleRange(l,c)}}}get estimatedMemoryUsage(){return this.triangleVertexIndices.byteLength+this.indices.byteLength}};z4.numFacesTested=0;const rOe=R(),ry=[1/0,1/0,1/0],ny=[-1/0,-1/0,-1/0];function nOe(i,e,t,r,n,s){let a=t,o=r;for(;a<o;){const c=i[a];e[6*c+n+3]<=s?++a:(--o,i[a]=i[o],i[o]=c)}let l=a;for(o=r;l<o;){const c=i[o-1];e[6*c+n]>=s?--o:(i[o-1]=i[l],i[l]=c,++l)}return{next:a,mid:l}}function sOe(i,e,t,r){if(r<=t)return II(NaN,NaN,NaN,NaN,NaN,NaN);{const n=6*i[t];for(let s=0;s<3;++s)ry[s]=e[n+0+s],ny[s]=e[n+3+s]}for(let n=t+1;n<r;++n){const s=6*i[n];for(let a=0;a<3;++a)ry[a]=Math.min(ry[a],e[s+0+a]),ny[a]=Math.max(ny[a],e[s+3+a])}return II(ry[0],ry[1],ry[2],ny[0],ny[1],ny[2])}function aOe(i){const e=i[3]-i[0],t=i[4]-i[1],r=i[5]-i[2],n=e>t?e>r?0:t>r?1:2:t>r?1:r>e?2:0;return{axis:n,midValue:(i[n]+i[n+3])/2}}function oOe(i,e,t,r,n){const s=t-e,a=new Float32Array(6*s);for(let o=0;o<s;++o){const l=3*(o+e),c=i[l+0]*n,u=i[l+1]*n,d=i[l+2]*n;for(let m=0;m<3;++m){const f=r[c+m],_=r[u+m],g=r[d+m];a[6*o+m]=Math.min(f,_,g),a[6*o+3+m]=Math.max(f,_,g)}}return a}function lOe(i,e,t,r){const n=r-t;let s=0;for(let o=t;o<r;++o)for(let l=0;l<3;++l)s=Math.max(e[3*o+l],s);const a=s<=yJ?new Uint16Array(3*n):new Uint32Array(3*n);for(let o=0;o<n;++o){const l=3*(i[o]+t);for(let c=0;c<3;++c){const u=e[l+c];a[3*o+c]=u}}return a}const yJ=65535;let Di=class extends cu{constructor(){super(...arguments),this.output=k.Color,this.overlayMode=bd.Disabled,this.tileBlendInput=qh.LayerOnly,this.spherical=!1,this.doublePrecisionRequiresObfuscation=!1,this.atmosphere=!1,this.receiveShadows=!1,this.hasSlicePlane=!1,this.backfaceCullingEnabled=!1,this.stencilEnabled=!1,this.textureFadingEnabled=!1,this.renderOccluded=!1,this.hasScreenSpaceReflections=!1,this.hasCloudsReflections=!1,this.shading=!jt.TERRAIN_USE_LEGACY_SHADING,this.useLegacyTerrainShading=jt.TERRAIN_USE_LEGACY_SHADING,this.transparent=!1,this.tileBorders=!1,this.visualizeNormals=!1,this.screenSizePerspective=!1,this.receiveAmbientOcclusion=!1}};h([N({count:k.COUNT})],Di.prototype,"output",void 0),h([N({count:bd.COUNT})],Di.prototype,"overlayMode",void 0),h([N({count:qh.COUNT})],Di.prototype,"tileBlendInput",void 0),h([N()],Di.prototype,"spherical",void 0),h([N()],Di.prototype,"doublePrecisionRequiresObfuscation",void 0),h([N()],Di.prototype,"atmosphere",void 0),h([N()],Di.prototype,"receiveShadows",void 0),h([N()],Di.prototype,"hasSlicePlane",void 0),h([N()],Di.prototype,"backfaceCullingEnabled",void 0),h([N()],Di.prototype,"stencilEnabled",void 0),h([N()],Di.prototype,"textureFadingEnabled",void 0),h([N()],Di.prototype,"renderOccluded",void 0),h([N()],Di.prototype,"hasScreenSpaceReflections",void 0),h([N()],Di.prototype,"hasCloudsReflections",void 0),h([N()],Di.prototype,"shading",void 0),h([N()],Di.prototype,"useLegacyTerrainShading",void 0),h([N()],Di.prototype,"transparent",void 0),h([N()],Di.prototype,"tileBorders",void 0),h([N()],Di.prototype,"visualizeNormals",void 0),h([N()],Di.prototype,"screenSizePerspective",void 0),h([N()],Di.prototype,"receiveAmbientOcclusion",void 0),h([N({constValue:zr.Disabled})],Di.prototype,"pbrMode",void 0),h([N({constValue:Il.CompressedAttribute})],Di.prototype,"normalType",void 0),h([N({constValue:Mm.Compressed})],Di.prototype,"textureCoordinateType",void 0),h([N({constValue:!1})],Di.prototype,"highStepCount",void 0),h([N({constValue:!1})],Di.prototype,"useCustomDTRExponentForWater",void 0),h([N({constValue:!1})],Di.prototype,"useFillLights",void 0);const VM=7,cOe=10,UM=Ms();var Ts;(function(i){i[i.Opaque=0]="Opaque",i[i.Semitransparent=1]="Semitransparent",i[i.Invisible=2]="Invisible"})(Ts||(Ts={}));let Za=class extends ue{constructor(e){super(e),this.type=Ui.TERRAIN,this.isGround=!0,this._tileSize=256,this._techniqueConfiguration=new Di,this._passParameters=new WK,this._rctx=null,this._scaleRangeQueries=new GAe,this._renderDataPool=new Fl(bAe),this._patchGroups=new Map,this._patchGroupsDirty=!0,this._patchSortingDirty=!0,this._tileIterator=new VK,this._highestVisibleLODTile=null,this._visible=!0,this._transparencyState=Ts.Opaque,this._velvetOverground=!0,this._castShadows=!0,this._emptyTex=null,this._tileRenderer=null,this._stencilEnabledLayerExtents=new Array,this._numTilesRendered=0,this._numTilesCulled=0,this._numOriginsRendered=0,this.needsHighlight=!1,this.renderOccludedFlags=cr.Occlude}get _isGlobal(){return this._stage.viewingMode===Se.Global}get shading(){return this._techniqueConfiguration.shading}set shading(e){this._techniqueConfiguration.shading=e}initialize(){const e=[ae.OPAQUE_TERRAIN,ae.TRANSPARENT_TERRAIN,ae.OCCLUDED_TERRAIN];this._stage.addRenderPlugin(e,this)}destroy(){this._stage.removeRenderPlugin(this),ERe()}get canRender(){return this._visible&&!!this._rootTiles&&!this.renderingDisabled}set renderingDisabled(e){this._set("renderingDisabled",!!e),this.setDirty()}set transparency(e){this._transparencyState!==e&&(this._techniqueConfiguration.transparent=e===Ts.Invisible,this._transparencyState=e,this.setNeedsRender())}get transparency(){return this._transparencyState}get needsLinearDepth(){return this._overlayRenderer.hasWater}get renderPatchBorders(){return!!this._techniqueConfiguration.tileBorders}set renderPatchBorders(e){this._techniqueConfiguration.tileBorders!==e&&(this._techniqueConfiguration.tileBorders=e,this.setNeedsRender(),this.notifyChange("renderPatchBorders"))}get visualizeNormals(){return!!this._techniqueConfiguration.visualizeNormals}set visualizeNormals(e){this._techniqueConfiguration.visualizeNormals!==e&&(this._techniqueConfiguration.visualizeNormals=e,this.setNeedsRender(),this.notifyChange("visualizeNormals"))}get cullBackFaces(){return this._techniqueConfiguration.backfaceCullingEnabled}set cullBackFaces(e){this._techniqueConfiguration.backfaceCullingEnabled!==e&&(this._techniqueConfiguration.backfaceCullingEnabled=e,this.notifyChange("cullBackFaces"),this.setNeedsRender())}set renderOrder(e){this._set("renderOrder",e),this._setSortingDirty()}set velvetOverground(e){this._velvetOverground!==e&&(this._velvetOverground=e,this.setNeedsRender())}get layerUid(){return Ac}get slicePlaneEnabled(){return this._techniqueConfiguration.hasSlicePlane}set slicePlaneEnabled(e){this._techniqueConfiguration.hasSlicePlane!==e&&(this._techniqueConfiguration.hasSlicePlane=e,this.setNeedsRender())}set textureFadingEnabled(e){this._techniqueConfiguration.textureFadingEnabled!==e&&(this._techniqueConfiguration.textureFadingEnabled=e,this.setNeedsRender())}setDebugScreenSizePerspective(e){this._techniqueConfiguration.screenSizePerspective!==e&&(this._techniqueConfiguration.screenSizePerspective=e,this.setNeedsRender())}setRootTiles(e){this._rootTiles=e,this.setDirty()}setNeedsHighlight(e){this.needsHighlight=e,this.setNeedsRender()}setRenderOccludedOverlay(e){this.renderOccludedFlags=e?rP:cr.Occlude,this.setNeedsRender()}setStencilEnabledLayerExtents(e){this._stencilEnabledLayerExtents=e,this._setSortingDirty()}setTileSize(e){this._tileSize=e,y(this._tileRenderer)&&(this._tileRenderer.tileSize=e),this.setDirty()}_prepareTileForLoading(e){e.renderData||(e.renderData=this._renderDataPool.acquire(),e.renderData.init(e),e.renderData.localOrigin=this._getLocalOriginOfTile(e))}loadTile(e){this._prepareTileForLoading(e),this.updateTileGeometryState(e),this.updateTileTexture(e,Fe.TEXTURE_FADING)}queryVisibleLevelRange(e,t,r,n){this._scaleRangeQueries.queryVisibleLevelRange(e,t,r,n),this.setNeedsRender()}updateTileTexture(e,t){y(this._tileRenderer)&&(this._tileRenderer.updateTileTexture(e,t===Fe.TEXTURE_FADING?fn.FADING:fn.UNFADED),this.setNeedsRender(),e.resetPendingUpdate(t))}updateTileGeometryState(e){for(const r of e.layerInfo[ut.ELEVATION])r.pendingUpdates&=~Fe.GEOMETRY;e.resetPendingUpdate(Fe.GEOMETRY);const t=e.renderData.updateGeometryState();return t&&this.setDirty(),t}updateGeometryIfNeeded(e){e.isLoaded&&e.renderData.updateGeometryIfNeeded(this._rctx)}unloadTile(e){const t=e.renderData;t&&(t.releaseGeometry(),this._renderDataPool.release(t),t.clear(),e.renderData=null,e.setMemoryDirty(),this.setDirty())}_getLocalOriginOfTile(e){const t=cOe-VM,r=Math.max(0,Math.floor((e.level-t)/VM)*VM);if(this._isGlobal&&r===0)return Gl;for(;e.parent&&e.level>r;)e=e.parent;return e.centerAtSeaLevel}setVisibility(e){this._visible=e,this.setDirty()}getStats(){return{numTilesRendered:this._numTilesRendered,numTilesCulled:this._numTilesCulled,numOriginsRendered:this._numOriginsRendered}}set wireframe(e){this._get("wireframe")!==e&&(this._set("wireframe",e),this.setNeedsRender())}setDirty(e=vr.UPDATE){this._patchGroupsDirty=!0,this._context.requestRender(e)}_setSortingDirty(e=vr.UPDATE){this._patchSortingDirty=!0,this._context.requestRender(e)}setNeedsRender(e=vr.UPDATE){this._context.requestRender(e)}initializeRenderContext(e){this._context=e,this._rctx=e.renderContext.rctx,this._techniqueRepository=e.shaderTechniqueRepository,this._tileRenderer=new KAe(this._rctx,this._tileSize,this._techniqueRepository),this.updateTileBackground(),this._emptyTex=IG(this._rctx)}uninitializeRenderContext(){this._emptyTex=Me(this._emptyTex),this._tileRenderer=Me(this._tileRenderer)}intersect(e,t,r,n){if(!this._rootTiles||e.options.selectOpaqueTerrainOnly&&e.options.selectionMode&&this.transparency!==Ts.Opaque)return;const s=hOe,a=uOe;ne(s,n,r),Z(a,1/s[0],1/s[1],1/s[2]);const o=e.results.min,l=e.results.max,c=e.results.ground,u=e.options.store===zn.MIN,d=!!e.results.ground.target,m=Dne(e.verticalOffset),f=e.tolerance;let _,g=u&&y(o.dist)?o.dist:1/0;const x=v=>{const w=v.renderData;if(!(w!=null&&w.vao))return;const T=w.geometryInfo;qD(UM,T.boundingBox);const E=w.localOrigin;y(m)&&(m.localOrigin=E,m.applyToAabb(UM));const C=UM;if(sy[0]=r[0]-E[0],sy[1]=r[1]-E[1],sy[2]=r[2]-E[2],!MG(C,sy,a,f,g))return;const A=(ee,H,V)=>{ee.set(this.type,v,H,V,rn),g=u&&y(o.dist)?o.dist:1/0},M=(ee,H)=>{if(y(H)&&ee>=0&&(e.options.backfacesTerrain||me(H,s)<0)&&(e.options.invisibleTerrain||!e.options.selectionMode||t==null||t(r,n,ee))){if((c.dist==null||ee<c.dist)&&A(c,ee,H),e.options.isFiltered)return;e.options.store===zn.ALL&&(S(_)?(_=NN(e.ray),A(_,ee,H),e.results.all.push(_)):ee<_.dist&&A(_,ee,H)),(o.dist==null||ee<o.dist)&&A(o,ee,H),e.options.store!==zn.MIN&&(l.dist==null||ee>l.dist)&&A(l,ee,H)}},I=dOe;ne(I,n,E);const L=T.indices,U=T.vertexAttributes,j={data:U.getField(P.POSITION,Dm).typedBuffer,size:3,stride:U.stride/4},re=T.indexCount/3;if(S(m)&&re>_J){const ee=v.renderData;S(ee.intersectionData)&&(ee.intersectionData=new z4(L,0,re,j)),ee.intersectionData.intersectRay({r0:sy,r1:I},M)}else ID(sy,I,0,re,L,j,null,m,M)},b=this._rootTiles;y(b)&&(()=>{const v=this._tileIterator;v.reset(b);const w=e.options.invisibleTerrain;for(;!v.done;){const T=v.next();!(T.visible||w&&T.intersectsClippingArea)||!y(m)&&!T.intersectsRay(r,s,f,g)||d&&this._useStencilForTile(T)?v.skipSubtree():x(T)}})()}prepareTechnique(e){if(e.bindParameters.slot===ae.OCCLUDED_TERRAIN){if(!(e.renderOccludedMask&rP))return null}else{const t=this.transparency===Ts.Opaque?ae.OPAQUE_TERRAIN:ae.TRANSPARENT_TERRAIN;if(e.bindParameters.slot!==t)return null}switch(e.output){case k.Color:{this._techniqueConfiguration.hasScreenSpaceReflections=e.bindParameters.ssr.enabled,this._techniqueConfiguration.hasCloudsReflections=y(e.bindParameters.cloudsFade.data),this._techniqueConfiguration.receiveShadows=e.bindParameters.shadowMap.ready,this._techniqueConfiguration.receiveAmbientOcclusion=e.bindParameters.ssaoHelper.ready,this._techniqueConfiguration.overlayMode=this._overlayRenderer.isEmpty()?bd.Disabled:this._overlayRenderer.hasWater?bd.EnabledWithWater:bd.Enabled;const t=e.bindParameters.slot===ae.OCCLUDED_TERRAIN?Zn.Occluded:Zn.ColorAndWater;return this._updateTechnique(k.Color,t===Zn.Occluded)}case k.Shadow:case k.ShadowExludeHighlight:return this._castShadows&&e.bindParameters.lighting.globalFactor===1?(this._techniqueConfiguration.receiveShadows=this._techniqueConfiguration.receiveAmbientOcclusion=!1,this._updateTechnique(k.Shadow,!1)):null;case k.Depth:return this.transparency===Ts.Invisible&&this._overlayRenderer.isEmpty()?null:(this._techniqueConfiguration.receiveShadows=this._techniqueConfiguration.receiveAmbientOcclusion=!1,this._updateTechnique(k.Depth,!1));case k.Normal:return this._techniqueConfiguration.receiveShadows=this._techniqueConfiguration.receiveAmbientOcclusion=!1,this._updateTechnique(k.Normal,!1);case k.ObjectAndLayerIdColor:return this._updateTechnique(k.ObjectAndLayerIdColor,!1);case k.Highlight:return this.needsHighlight?(this._techniqueConfiguration.receiveShadows=this._techniqueConfiguration.receiveAmbientOcclusion=!1,this._updateTechnique(k.Highlight,!1)):null}return null}render(e,t){const r=e.bindParameters.lighting.globalFactor===1;switch(this._updatePatchGroups(),t.useStencil=!1,e.output){case k.Color:{const n=e.bindParameters.slot===ae.OCCLUDED_TERRAIN?Zn.Occluded:Zn.ColorAndWater;this.transparency===Ts.Opaque?this._renderMaterialPass(e,t,n):e.offscreenRenderingHelper.renderToTargets(()=>this._renderMaterialPass(e,t,n),e.offscreenRenderingHelper.tmpColor,e.offscreenRenderingHelper.mainDepth,[0,0,0,0]);break}case k.Shadow:case k.ShadowExludeHighlight:this._castShadows&&r&&this._renderAuxiliaryPass(e,t,Zn.None);break;case k.Depth:this.transparency===Ts.Invisible&&this._overlayRenderer.isEmpty()||this._renderAuxiliaryPass(e,t,Zn.None);break;case k.Normal:this._renderAuxiliaryPass(e,t,Zn.None);break;case k.ObjectAndLayerIdColor:this._renderAuxiliaryPass(e,t,Zn.ObjectAndLayerIdColor);break;case k.Highlight:this.needsHighlight&&this._renderAuxiliaryPass(e,t,Zn.Highlight)}this._scaleRangeQueries.hasPendingQueries()&&this.setNeedsRender()}_renderMaterialPass(e,t,r){const{rctx:n}=e;this._passParameters.overlaySource=r,n.bindTechnique(t,this._passParameters,e.bindParameters),this._numTilesRendered=0,this._numTilesCulled=0,this._numOriginsRendered=0,this._scaleRangeQueries.prepareQueries(),this._renderPatchGroups(e,t,r),this._scaleRangeQueries.processQueries()}_renderAuxiliaryPass(e,t,r){const n=e.rctx;this._passParameters.overlaySource=r,n.bindTechnique(t,this._passParameters,e.bindParameters),this._renderPatchGroupsAuxiliary(e,t,r)}updateTileBackground(e=null){if(S(this._tileRenderer))return;const t=this._tileRenderer;let r=null;if(y(e)){const n=ei.toUnitRGBA(e);r=Ge(n[0]||0,n[1]||0,n[2]||0)}t.setBackground(r),this._allTiles.forAll(n=>t.updateTileTexture(n,fn.FADING)),this._techniqueConfiguration.tileBlendInput=t.backgroundIsGrid?qh.GridComposite:y(t.backgroundColor)?qh.ColorComposite:qh.LayerOnly,this.setNeedsRender()}_updatePatchGroups(){if(this._patchGroupsDirty&&(this._highestVisibleLODTile=null,this._rebuildPatchGroups(),this._patchGroupsDirty=!1,this._patchSortingDirty=!0),this._patchSortingDirty&&this.renderOrder!==wx.NONE){const e=Array.from(this._patchGroups.values());e.forEach(t=>UK(this.renderOrder,t,this._stencilEnabledLayerExtents)),e.sort((t,r)=>I4(t[0],r[0],this.renderOrder)),this._patchGroups=new Map(e.map(t=>[t[0].renderData.localOrigin,t])),this._patchSortingDirty=!1}}_rebuildPatchGroups(){var t;const e=this._rootTiles;if(!S(e)){(t=e[0])==null||t.surface.checkAllTilesWaterproofness(),this._patchGroups.clear();for(const r of e)this._rebuildPatchGroupsForRootTile(r)}}_rebuildPatchGroupsForRootTile(e){const t=this._tileIterator;for(t.resetOne(e);!t.done;){const r=t.next(),n=r.renderData;if(!n||r.visible)if(r.rendered){if(n){const s=this._patchGroups.get(n.localOrigin)||new Array;this._patchGroups.set(n.localOrigin,s),s.push(r),(!this._highestVisibleLODTile||r.vlevel>this._highestVisibleLODTile.vlevel)&&(this._highestVisibleLODTile=r),t.skipSubtree()}}else this._numTilesCulled++;else this._numTilesCulled++,t.skipSubtree()}}_useStencilForTile(e){for(const t of this._stencilEnabledLayerExtents)if(e.intersectsExtent(t))return!0;return!1}_renderPatchGroupsAuxiliary(e,t,r){const n=this._stencilEnabledLayerExtents.length>0;this._patchGroups.forEach(s=>{const a=s[0].renderData.localOrigin;t.program.bindDraw(new JL(a),e.bindParameters,this._passParameters);for(let o=0;o<s.length;o++)this._renderPatch(e,t,s[o],Dt.TRIANGLES,n,r)}),e.rctx.bindVAO(null)}_renderPatchGroups(e,t,r){const n=e.bindParameters.camera,s=t.program;if(this._techniqueConfiguration.screenSizePerspective&&this.pointsOfInterest){const u=OG(this._stage.viewingMode,this._ellipsoidRadius),d=this.pointsOfInterest.centerOnSurfaceFrequent.distance;u.update({distance:d,fovY:n.fovY})}const a=this._stencilEnabledLayerExtents.length>0,o=r===Zn.Occluded;o&&(s.bindTexture("tex",this._emptyTex),s.setUniform1f("blend",1),s.setUniform4fv("texOffsetAndScale",w0));const l=y(this._tileRenderer)&&y(this._tileRenderer.backgroundColor)?this._tileRenderer.backgroundColor:Gl;this._techniqueConfiguration.tileBlendInput===qh.ColorComposite&&s.setUniform3fv("backgroundColor",l);const c=this.wireframe?Dt.LINES:Dt.TRIANGLES;this._techniqueConfiguration.textureFadingEnabled&&s.bindTexture("texNext",this._emptyTex),this._patchGroups.forEach(u=>{const d=u[0].renderData.localOrigin;t.program.bindDraw(new JL(d),e.bindParameters,this._passParameters),this._numOriginsRendered++;for(let m=0;m<u.length;m++){const f=u[m],_=f.renderData.textureReference;if(!S(_)){if(!o){this._scaleRangeQueries.scaleQueriesForTile(f),s.setUniform4fv("texOffsetAndScale",_.offsetAndScale),s.bindTexture("tex",_.texture.texture);const g=f.renderData.textureFadeFactor,x=g<1?f.renderData.nextTextureReference:null;this._techniqueConfiguration.textureFadingEnabled&&y(x)&&g<1?(s.setUniform1f("fadeFactor",g),s.setUniform4fv("nextTexOffsetAndScale",x.offsetAndScale),s.setUniform3fv("nextTexOpacities",x.opacities),s.bindTexture("texNext",x.texture.texture)):s.setUniform1f("fadeFactor",1),f.renderData.textureIsFading&&this.setNeedsRender(),s.setUniform3fv("textureOpacities",_.opacities)}this._renderPatch(e,t,f,c,a,r),f.renderOrder=this._numTilesRendered,this._numTilesRendered++}}}),e.rctx.bindVAO(null)}_renderPatch(e,t,r,n,s,a){const o=r.renderData,l=o.vao,c=l.indexBuffer;if(S(c))return void(gn&&console.error("Rendered tile with no indices: ",r.lij," : ",o));const u=t.program;a!==Zn.None&&this._bindOverlayPatchData(u,o.overlay),s&&(t.useStencil=this._useStencilForTile(r),t.bindPipelineState(e.rctx,e.bindParameters.slot));const d=o.geometryInfo.indexCount;e.rctx.bindVAO(l),u.assertCompatibleVertexAttributeLocations(l),e.rctx.drawElements(n,d,c.indexType,0)}_bindOverlayPatchData(e,t){e.setUniform4fv("overlayTexOffset",t.offsets),e.setUniform4fv("overlayTexScale",t.scales)}_updateTechnique(e,t){return this._techniqueConfiguration.output=e,e===k.Color&&(this._techniqueConfiguration.atmosphere=this._isGlobal&&this._velvetOverground),this._techniqueConfiguration.renderOccluded=t,this._techniqueConfiguration.stencilEnabled=!1,this._shaderTechnique=this._techniqueRepository.releaseAndAcquire(XK,this._techniqueConfiguration,this._shaderTechnique),this._shaderTechnique}get test(){return{tileRenderer:this._tileRenderer}}};h([p({constructOnly:!0})],Za.prototype,"_overlayRenderer",void 0),h([p({constructOnly:!0})],Za.prototype,"_stage",void 0),h([p({readOnly:!0})],Za.prototype,"_isGlobal",null),h([p({constructOnly:!0})],Za.prototype,"_allTiles",void 0),h([p({constructOnly:!0})],Za.prototype,"_ellipsoidRadius",void 0),h([p({value:!1})],Za.prototype,"renderingDisabled",null),h([p()],Za.prototype,"renderPatchBorders",null),h([p()],Za.prototype,"visualizeNormals",null),h([p()],Za.prototype,"cullBackFaces",null),h([p({value:wx.FRONT_TO_BACK})],Za.prototype,"renderOrder",null),h([p()],Za.prototype,"wireframe",null),Za=h([D("esri.views.3d.terrain.TerrainRenderer")],Za);const hOe=R(),uOe=R(),sy=R(),dOe=R();let pOe=class{constructor(){this.numNodes=0,this.numLeaves=0,this.numVisible=0,this.numRendered=0,this.numSplit=0,this.numMerged=0,this.numRenderedPerLevel=new Array,this.numLoadedPerLevel=new Array}},Ch=class extends ue{constructor(e){super(e),this._handles=new Ft}initialize(){this._handles.add(this.layers.on("change",()=>this._update())),this._handles.add(z(()=>this.extentHelper.layerViewsExtent,()=>this._setAdHocTilingScheme())),this._update(),this.tilingSchemeLocked||this._setAdHocTilingScheme()}destroy(){this._handles=Te(this._handles),this._waitTask=null}_update(){if(this._waitTask=null,this.tilingSchemeLocked)return;let e;if(this.layers.some(t=>!(!Ib(t)||t.isRejected())&&!(t.isFulfilled()&&!mOe(t,this.viewSpatialReference,this.viewingMode))&&(e=t,!((t==null?void 0:t.type)==="vector-tile"||hP(t)))),e)if(e.isResolved()){const t=kR(e,this.viewSpatialReference,this.viewingMode);if(y(t)){const r=new so(t.tileInfo);this._lockTilingScheme(r)}}else this._updateWhen(e)}_updateWhen(e){const t=e.when().catch(()=>{}).then(()=>{t!==this._waitTask||this.destroyed||this._update()});this._waitTask=t}_lockTilingScheme(e){if(this.viewingMode===Se.Global){const t=e.levels.length-1;e.spatialReference.isWebMercator?e=so.makeWebMercatorAuxiliarySphere(t):Eg(e.spatialReference)&&(e=so.makeGCSWithTileSize(e.spatialReference,e.pixelSize,t))}this.tilingSchemeLocked=!0,this.tilingScheme=e,this.extentHelper.tilingScheme=this.tilingScheme,this._updateTiledLayerExtent(),this._handles.removeAll(),this._handles.add(z(()=>this.extentHelper.tiledLayersExtent,()=>this._updateTiledLayerExtent()))}_updateTiledLayerExtent(){this._set("extent",this.extentHelper.tiledLayersExtent)}_setAdHocTilingScheme(){if(this.viewingMode===Se.Global){const e=this.extentHelper.viewSpatialReference,t=Eg(e)||Rx(e)||Ax(e);e.isWebMercator?this.tilingScheme=so.WebMercatorAuxiliarySphere:t&&(this.tilingScheme=so.makeGCSWithTileSize(e,256)),this._set("extent",this.extentHelper.layerViewsExtent)}else{const e=this.extentHelper.layerViewsExtent;y(e)&&!mg(e,this.extent)&&(this.tilingScheme=so.fromExtent(e,this.extentHelper.viewSpatialReference),this._set("extent",e))}}get test(){return{lockTilingScheme:e=>this._lockTilingScheme(e),done:!this._waitTask}}};function mOe(i,e,t){return y(kR(i,e,t))}h([p()],Ch.prototype,"tilingScheme",void 0),h([p({readOnly:!0})],Ch.prototype,"extent",void 0),h([p({value:!1})],Ch.prototype,"tilingSchemeLocked",void 0),h([p({constructOnly:!0})],Ch.prototype,"viewSpatialReference",void 0),h([p({constructOnly:!0})],Ch.prototype,"layers",void 0),h([p({constructOnly:!0})],Ch.prototype,"extentHelper",void 0),h([p({constructOnly:!0})],Ch.prototype,"viewingMode",void 0),Ch=h([D("esri.views.3d.terrain.TilingSchemeLogic")],Ch);let fOe=class{constructor(){this.offset=be(),this.scale=0,this.tile=null}init(e,t,r,n){this.tile=e,this.offset[0]=t,this.offset[1]=r,this.scale=n}dispose(){this.tile=null,this.offset[0]=0,this.offset[1]=0,this.scale=0}},lt=class extends nn.EventedMixin(ue){constructor(i){var e,t;super(i),this._iteratorPool=new Fl(VK,r=>r.remove=()=>this._iteratorPool.release(r)),this._postorderIterator=new IRe,this._hasPendingUpdates=!1,this._pendingUpdates=0,this._asyncWorkItems=0,this._allTilesDirty=!0,this._allTilesSorted=!0,this._visibleCached=!1,this._usedMemory=null,this._performanceInfo=new pOe,this._viewChanged=!1,this._inFrameTask=!1,this._viewChangeUpdateDirty=!1,this._eyePosRenderSR=R(),this._eyePosSurfaceSR=R(),this._splitLimits=new eAe,this._frustum=Rw(),this._viewProjectionMatrix=ve(),this._layerViews=[new Array,new Array],this._layerIndexByUid=[new Map,new Map],this._basemapLayerViewHandles=new Map,this._handles=new Ft,this._watchUpdatingTracking=new mv,this._frameTask=oD,this._allTiles=new Zt,this._upsampleInfoPool=new Fl(fOe),this._rootTilesExtent=$t(),this._maxNumUpdating=1,this.maxTextureScale=1.2,this._spatialReference=Qt.WebMercator,this.visibleElevationBounds=new v0(1/0,-1/0),this.rootTileElevationBounds=new v0(1/0,-1/0),this._updatingRootTiles=!1,this._pendingTilesForElevationUpdateEvent=new Set,this._pendingTilesToUpdate=new Set,this.totalGeometryUpdates=0,this.totalTileUpdates=0,this.oneBatchPerFrameTask=!0,this._layerViewsDirty=!1,this._shading=!0,this._isWebMercator=!1,this._isWebMercatorOnPlateeCarree=!1,this._isGlobal=!((t=(e=i.view)==null?void 0:e.state)!=null&&t.isLocal)}initialize(){this._lercDecoder=bae(this.view.resourceController),this._tilePool=this.view.state.isLocal?new Fl(UAe):new Fl(zAe);const i=this.view.resourceController.memoryController;this._upsampleMapCache=i.newCache("esri.views.3d.terrain.upsample",n=>n.unloadMapData()),this._elevationQueryCache=new aRe(i.newCache("elevation-query")),this._set("overlayManager",new fa({surface:this})),this._handles.add([z(()=>this.overlayManager.hasHighlights,n=>this._renderer.setNeedsHighlight(n)),z(()=>this.overlayManager.rendersOccluded,n=>this._renderer.setRenderOccludedOverlay(n))],"overlayManager"),this._renderer=new Za({_overlayRenderer:this.overlayManager.renderer,_ellipsoidRadius:Yt(this.view.spatialReference).radius,_stage:this.view._stage,_allTiles:this._allTiles}),this._handles.add([z(()=>this.baseOpacity,n=>{this._handleLayerViewChanges(),this._updateBaseOpacity(n)},Oi),z(()=>this.hasCompositeBlendMode,()=>{this._updateBaseOpacity(this.baseOpacity)},Oi),z(()=>this.renderingDisabled,()=>{var n,s;return(s=(n=this.view)==null?void 0:n._stage)==null?void 0:s.renderView.setRenderParameters({terrainRenderingEnabled:!this.renderingDisabled})},ri),z(()=>this.backgroundColor,n=>{this._handleLayerViewChanges(),this._renderer.updateTileBackground(n)},Oi),z(()=>this.snapLevel,()=>this._viewChanged=!0,ri),z(()=>this.view.pointsOfInterest,n=>{this._renderer.pointsOfInterest=n,this._watchUpdatingTracking.removeAll(),n&&this._watchUpdatingTracking.add(()=>n.focus.renderLocation,()=>this._allTilesSorted=!1)}),z(()=>jt.TERRAIN_TILE_TREE_SHOW_TILES,n=>{n&&!this._treeDebugger?G(()=>import("./TerrainTileTree3DDebugger-5baba38c.js"),["assets/TerrainTileTree3DDebugger-5baba38c.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/reactiveUtils-4dabbb80.js","assets/aaBoundingRect-193543b5.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/TileTreeDebugger-36d5c9d2.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js"]).then(({TerrainTileTree3DDebugger:s})=>{!this._treeDebugger&&jt.TERRAIN_TILE_TREE_SHOW_TILES&&(this._treeDebugger=new s({view:this.view}))}):n||(this._treeDebugger=Te(this._treeDebugger))},Qe)]),this._extentHelper=yRe(this.viewingMode,{layers:this.view.map.allLayers,layerViews:this.view.allLayerViews,viewSpatialReference:this.view.spatialReference});const e=new mw({getCollections:()=>{var n,s,a;return(a=(s=(n=this.view)==null?void 0:n.defaultsFromMap)==null?void 0:s.mapCollections)==null?void 0:a.map(({layers:o})=>o)},getChildrenFunction:n=>n&&"layers"in n?n.layers:null}),t=new Ch({layers:e,extentHelper:this._extentHelper,viewingMode:this.viewingMode,viewSpatialReference:this.view.spatialReference});this._set("tilingSchemeLogic",t),this._updateTilingScheme(),this._elevationDataRequester=this.view.resourceController.createStreamDataRequester(Uh.ELEVATION),this._mapDataRequester=this.view.resourceController.createStreamDataRequester(Uh.BASEMAP);const r=this.view.resourceController.scheduler;this._frameTask=r.registerTask(dr.TERRAIN_SURFACE,this),this._handles.add([z(()=>this._extentHelper.stencilEnabledExtents,n=>this._renderer.setStencilEnabledLayerExtents(n),Qe),z(()=>this.tilingSchemeLogic.tilingScheme,()=>this._updateTilingScheme(),ri),z(()=>this.extent,()=>this._updateRootTiles(),Qe),this.view.on("resize",()=>this._viewChangeUpdate()),z(()=>{var a,o;const n=this.view,s=n.state;return[this._lodBias,this.lodSnapping,(o=(a=n.resourceController)==null?void 0:a.memoryController)==null?void 0:o.memoryFactor,s.camera,s.contentCamera,s.fixedContentCamera]},()=>this._viewChangeUpdate(),Oi),z(()=>{var n,s;return(s=(n=this.view.qualitySettings)==null?void 0:n.tiledSurface)==null?void 0:s.textureFadeDuration},n=>this._renderer.textureFadingEnabled=n>0,Qe),z(()=>this._userClippingExtent,()=>this._updateClippingExtent(),ri)]),this._handles.add(this.view.allLayerViews.on("after-changes",()=>this._layerViewsDirty=!0)),this._handles.add([z(()=>{var n;return(n=this.view)==null?void 0:n.map.ground.shading},()=>{this._updateShadingIfChanged()})]),this._updateShading(),this._layerViewsDirty=!0,this._handleLayerViewChanges()}destroy(){this._frameTask.remove(),this._handles.destroy(),this._watchUpdatingTracking.destroy(),this._lercDecoder=Qi(this._lercDecoder),this._removeAllTiles(),this._upsampleMapCache=Te(this._upsampleMapCache),this._elevationQueryCache=Te(this._elevationQueryCache);const i=this.tilingSchemeLogic.layers;this._set("tilingSchemeLogic",Te(this.tilingSchemeLogic)),i.destroy(),this._basemapLayerViewHandles.forEach((e,t)=>this._unregisterTiledLayerView(t)),this._elevationDataRequester=null,this._mapDataRequester=null,this._set("overlayManager",Te(this.overlayManager)),this._tilePool=Te(this._tilePool),D4.prune(),this._treeDebugger&&(this._treeDebugger.destroy(),this._treeDebugger=null),this._renderer=Te(this._renderer),this._iteratorPool=Te(this._iteratorPool),this._set("view",null),this._upsampleInfoPool=Te(this._upsampleInfoPool),mRe(),KRe()}get renderer(){return this._renderer}get frustum(){return this._frustum}get snapLevel(){var i,e;if(this.lodSnapping===tw.ON){const t=this.view,r=this.tilingScheme,n=(e=(i=t.pointsOfInterest)==null?void 0:i.contentCameraOnSurface)==null?void 0:e.scale;if(n&&r){const s=t.state.contentCamera;let a=SR(t,s.eye,s.viewForward,s.up).tilt;a>90&&(a=180-a);const o=2*(a/90)**2,l=r.levelAtScale(n)-o;return Math.round(l)}}return null}get lodSnapping(){return this.view.qualitySettings.tiledSurface.reduceTileLevelDifferences?tw.ON:tw.OFF}get upsampleInfoPool(){return this._upsampleInfoPool}get upsampleMapCache(){return this._upsampleMapCache}get elevationQueryCache(){return this._elevationQueryCache}get mapTileRequester(){return this._mapDataRequester}get _userClippingExtent(){const{spatialReference:i}=this,{clippingArea:e}=this.view;if(S(e)||S(i))return null;const t=$t(),r=AK(e,t,i)?t:null,n=this._get("extent");return mg(r,n)?n:r}get rootTilesExtent(){return this._rootTilesExtent}get extent(){const i=bI(this.groundExtent,this._userClippingExtent,$t()),e=this._get("extent");return mg(i,e)?e:i}get groundExtent(){return y(this._tilingSchemeExtent)?this._tilingSchemeExtent:this._rootTilesExtent}get _tilingSchemeExtent(){var i;return(i=this.tilingSchemeLogic)==null?void 0:i.extent}get updating(){return this._hasPendingUpdates||(this._maxNumUpdating=1),!!((this.running||this._watchUpdatingTracking.updating||this._asyncWorkItems>0)&&this.ready&&!this.suspended||this.overlayManager.updating)}get running(){return(this._hasPendingUpdates||this._viewChanged||this._allTilesDirty||!this._allTilesSorted||this._layerViewsDirty||this._frameTask.updating)&&this.ready&&!this.suspended}get updatingProgressValue(){return this._maxNumUpdating=Math.max(this._pendingUpdates,this._maxNumUpdating),1-this._pendingUpdates/this._maxNumUpdating}get baseOpacity(){return this.view.map.ground.opacity}set baseOpacity(i){this.view.map.ground.opacity=i}get viewingMode(){return this.view.state.viewingMode}get ready(){return y(this.rootTiles)}set renderOrder(i){this._renderer.renderOrder=i,this._set("renderOrder",i)}get spatialReference(){var i;return((i=this.tilingScheme)==null?void 0:i.spatialReference)??null}get backgroundColor(){return this.view.map.ground.surfaceColor}set backgroundColor(i){this.view.map.ground.surfaceColor=i}set slicePlaneEnabled(i){this._renderer.slicePlaneEnabled=i,this._set("slicePlaneEnabled",i),this._evaluateTransparency(this.baseOpacity)}get tilingSchemeLocked(){var i;return((i=this.tilingSchemeLogic)==null?void 0:i.tilingSchemeLocked)??!1}set velvetOverground(i){i!==this.velvetOverground&&(this._renderer.velvetOverground=i),this._set("velvetOverground",i)}get wireframe(){return this._renderer.wireframe}set wireframe(i){i!==this._renderer.wireframe&&(this._renderer.wireframe=i,this._updateAllTileGeometries())}set _visible(i){i!==this._visibleCached&&(this._visibleCached=i,this._renderer.setVisibility(i),this.suspended=!i)}get opaque(){return this._renderer.transparency===Ts.Opaque}set suspended(i){this._set("suspended",i),this._viewChangeUpdate()}get textureFadeDuration(){return this.view.qualitySettings.tiledSurface.textureFadeDuration??0}intersect(i,e,t,r){this._renderer.intersect(i,e,t,r)}getElevation(i,e,t,r){const n=this.rootTiles;if(S(n)||!n.length||n[0].layerInfo[ut.ELEVATION].length===0)return null;const s=la;return s[0]=i,s[1]=e,s[2]=t,ss(s,r,s,this._spatialReference)?Wz(n,s[0],s[1]):(J.getLogger(this.declaredClass).error("TerrainSurface.getElevation(): could not project given point to tiling scheme coordinate system"),null)}getElevations(i,e,t){const r=this.rootTiles,n=r?r[0].layerInfo[ut.ELEVATION].length:0;if(!S(r)&&r.length&&n!==0)for(let s=0;s<e;++s){const a=3*s;t(s,Wz(r,i[a+0],i[a+1]))}else for(let s=0;s<e;++s)t(s,null)}getScale(i){if(this.tilingScheme){if(!bn(i,la,this.spatialReference))return J.getLogger(this.declaredClass).error("TerrainSurface.getScale(): could not project given point to tiling scheme coordinate system"),null;const e=this.rootTiles;if(y(e)){for(let t of e)if(t!=null&&t.containsPoint(la)){for(;!t.isLeaf&&!t.rendered;){let r=0;la[0]>t.children[0].extent[2]&&(r+=1),la[1]<t.children[0].extent[1]&&(r+=2),t=t.children[r]}return this._getLodBiasCorrectedScale(t.level)}}}return 1e100}getSphereElevationBounds(i,e,t,r,n){var c;if(la[0]=i,la[1]=e,la[2]=t,la[3]=r,!ss(la,n,la,(c=this.tilingScheme)==null?void 0:c.spatialReference))return J.getLogger(this.declaredClass).error("TerrainSurface.getSphereElevationBounds(): could not project given point to tiling scheme coordinate system"),null;let s=1/0,a=-1/0;const o=u=>{if(u&&x5(u.extent,la))if(u.isLeaf||u.rendered)s=Math.min(s,u.elevationBounds[0]),a=Math.max(a,u.elevationBounds[1]);else for(const d of u.children)o(d)},l=this.rootTiles;if(y(l))for(const u of l)o(u);return{min:s,max:a}}getSphereScale(i,e){if(!this.tilingScheme)return null;if(!bn(i,la,this.spatialReference))return J.getLogger(this.declaredClass).error("TerrainSurface.getSphereScale(): could not project given point to tiling scheme coordinate system"),null;la[3]=e;let t=null;const r=s=>{if(s&&x5(s.extent,la))if(s.isLeaf||s.rendered){const a=this._getLodBiasCorrectedScale(s.level);t=t==null?a:Math.min(t,a)}else for(const a of s.children)r(a)},n=this.rootTiles;if(y(n))for(const s of n)r(s);return t}queryVisibleScaleRange(i,e,t,r){const n=e?this.tilingScheme.levelAtScale(e):0,s=t?this.tilingScheme.levelAtScale(t):1/0,a=this._lodBias;this._renderer.queryVisibleLevelRange(i,n+a,s+a,r)}_evaluateTransparency(i){var n,s;const e=this._renderer.transparency,t=this._allSurfaceLayersTransparent()?Ts.Invisible:i>=1&&!this.hasCompositeBlendMode&&!this._renderer.slicePlaneEnabled?Ts.Opaque:Ts.Semitransparent,r=e!==t;return r&&(this._renderer.transparency=t,(s=(n=this.view)==null?void 0:n._stage)==null||s.renderView.setRenderParameters({terrainTransparency:this._renderer.transparency})),r}_updateBaseOpacity(i){const e=this._evaluateTransparency(i);this._updateTileTextures(e?fn.UNFADED:fn.IMMEDIATE)}_updateTilingScheme(){var e,t,r,n;const i=this.tilingSchemeLogic.tilingScheme;i!==this.tilingScheme&&($h(!!i,"tiling scheme cannot be reset to undefined"),this._isGlobal=!((t=(e=this.view)==null?void 0:e.state)!=null&&t.isLocal),this.tilingScheme&&this._removeAllTiles(),this._spatialReference=(i==null?void 0:i.spatialReference)??Qt.WebMercator,this._set("tilingScheme",i),this._updateClippingExtent(),i&&(this._updateTiledLayers(),this._renderer.setTileSize(i.pixelSize),this.overlayManager.setSpatialReference(i.spatialReference),this._updateRootTiles()),this._isWebMercator=!!((r=this.tilingScheme)!=null&&r.spatialReference.isWebMercator),this._isWebMercatorOnPlateeCarree=this._isWebMercator&&v7((n=this.view)==null?void 0:n.renderSpatialReference))}_acquireTile(i,e,t,r){const n=this._tilePool.acquire();return JC[0]=i,JC[1]=e,JC[2]=t,n.init(JC,r,this),n}get updatingRootTiles(){return this._updatingRootTiles}_updateRootTiles(){const{extent:i,tilingScheme:e}=this;if(!e)return;const t=yOe;let r=e.rootTilesInExtent(i,t,5*c0);if(y(this.rootTiles)){if(r.length>c0)return void J.getLogger(this.declaredClass).warn(F_e);const n=this.rootTiles.map(a=>a.lij),s=Gee(n,r,qz);if(this._updatingRootTiles=!0,s.removed.length>0||s.added.length>0){const a=this.rootTiles.filter(o=>!(s.removed.findIndex(l=>qz(l,o.lij))>-1)||(this._purgeTile(o),!1));s.added.forEach(o=>a.push(this._newRootTile(o))),this._setRootTiles(a)}}else this._updatingRootTiles=!0,r.length>c0&&(J.getLogger(this.declaredClass).warn(N_e),r=e.rootTilesInExtent(i,t,c0)),this._setRootTiles(r.map(n=>this._newRootTile(n)));mg(t,this._rootTilesExtent)||(this._rootTilesExtent=$t(t)),this._visible=!0,this._viewChangeUpdate(),this.overlayManager.setPlacementDirty(),this.notifyChange("ready"),this._updateAllTileGeometries(),this._updatingRootTiles=!1,this.checkAllTilesWaterproofness()}_updateAllTileGeometries(){const i=this._allTiles.filter(e=>e.isLoaded&&e.intersectsClippingArea);i.forEach(e=>this._renderer.updateTileGeometryState(e)),i.forEach(e=>e.renderData.updateNeighborData()),this._updateTilesGeometries(i),this._pendingTilesToUpdate.clear()}_updateTilesGeometries(i){if(i.length===0)return;i.sort(vd);const e=this.renderer;i.forEach(t=>e.updateGeometryIfNeeded(t)),i.forEach(t=>this._pendingTilesForElevationUpdateEvent.add(t))}_shouldSplit(i){return i.shouldSplit(this._splitLimits,this._eyePosRenderSR,this.snapLevel)===Fe.SPLIT}_newRootTile(i){const e=this._acquireTile(0,i[1],i[2],null);return this._shouldSplit(e)&&e.setPendingUpdate(Fe.SPLIT),this._loadTile(e),this._markTileToUpdate(e),this._updateRootTileElevationBounds(),e}_setRootTiles(i){if(this._set("rootTiles",i),this._allTiles.clear(),y(i)){const e=this._iteratorPool.acquire();for(e.reset(i);!e.done;)this._allTiles.push(e.next());e.remove()}this._renderer.setRootTiles(this.rootTiles),this._updateTilesVisibility(i)}_runViewChangeUpdateIfDirty(){this._viewChangeUpdateDirty&&(this._viewChangeUpdateDirty=!1,this._viewChangeUpdate())}_viewChangeUpdate(){this.view&&!this.suspended&&this.tilingScheme&&this._visibleCached&&(this._inFrameTask?this._viewChangeUpdateDirty=!0:(this._viewChangeUpdateDirty=!1,this._updateViewDependentParameters(),this._updateTilesVisibility(this.rootTiles)))}_updateClippingStatus(i){i.updateClippingStatus(this.extent)&&i.resetPendingUpdate(Fe.GEOMETRY)&&this._updateTileGeometryState(i)}_updateTilesVisibility(i){if(S(i))return;const e=FRe(i),t=this.visibleElevationBounds;let r=e?t.min:1/0,n=e?t.max:-1/0;const s=this.extent,a=this._viewProjectionMatrix;this.setTileTreeDirty();const o=this._iteratorPool.acquire();for(o.reset(i);!o.done;){const l=o.next();l.updateClippingStatus(s)&&l.resetPendingUpdate(Fe.GEOMETRY)&&this._updateTileGeometryState(l),l.setPendingUpdate(Fe.RENDERDATA),l.computeVisibility(),l.updateScreenDepth(a),l.renderData&&(r=Math.min(l.elevationBounds[0],r),n=Math.max(l.elevationBounds[1],n))}o.remove(),this._viewChanged=!0,this._allTilesDirty=!0,this._batchUpdatePendingTileGeometries(),isFinite(r)&&isFinite(n)&&(t.min!==r||t.max!==n)&&(this.visibleElevationBounds=new v0(r,n))}_updateRootTileElevationBounds(){let i=1/0,e=-1/0;const t=this.rootTiles;y(t)&&t.forEach(({elevationBounds:n})=>{i=Math.min(i,n[0]),e=Math.max(e,n[1])});const r=this.rootTileElevationBounds;r.min===i&&r.max===e||(this.rootTileElevationBounds=new v0(i,e))}_updateViewDependentParameters(){const i=this.view.state.camera,e=this.view.state.contentCamera,t=Math.tan(.5*e.fovX),r=Math.tan(.5*e.fovY),n=this.tilingScheme.pixelSize,s=2**-this._lodBias*i.pixelRatio;this._splitLimits.aboveGround=i.aboveGround,this._splitLimits.fovX=t,this._splitLimits.fovY=r,this._splitLimits.relativeWidthLimit=n/i.width*this.maxTextureScale*s,this._splitLimits.relativeHeightLimit=n/i.height*this.maxTextureScale*s,this._splitLimits.maxLod=this.tilingScheme.getMaxLod(),this._splitLimits.angledSplitBias=this.view.qualitySettings.tiledSurface.angledSplitBias,this.view.state.fixedContentCamera?(S(this._splitLimits.frustum)&&(this._splitLimits.frustum=Rw()),BE(this._splitLimits.frustum,e.frustum)):this._splitLimits.frustum=null,BE(this._frustum,i.frustum),Hr(this._viewProjectionMatrix,e.projectionMatrix,e.viewMatrix),q(this._eyePosRenderSR,e.eye),ss(i.eye,this.view.renderSpatialReference,this._eyePosSurfaceSR,this.spatialReference)}_updateRenderData(i){i.rendered&&!i.shouldLoad&&(vJ(i)?this._loadChildren(i):_Oe(i)&&this._loadParent(i))}_updateTileGeometryState(i){i.updateVisibility(),this._renderer.updateTileGeometryState(i)&&this._markTileToUpdate(i),this._usedMemory=null}_markAllTileNeighborsForGeometryUpdate(i){const e=this._pendingTilesToUpdate;i.forEachLoadedNeighbor(t=>{e.add(t)})}_updateTileTexture(i,e){const t=i.resetPendingUpdate(Fe.TEXTURE_FADING)?Fe.TEXTURE_FADING:!!i.resetPendingUpdate(Fe.TEXTURE_NOFADING)&&Fe.TEXTURE_NOFADING;t&&(this._renderer.updateTileTexture(i,t),this._usedMemory=null,e.madeProgress())}_emitElevationUpdateEventForTiles(){const i=BM.extent;Uc(i),this._pendingTilesForElevationUpdateEvent.forEach(e=>hm(i,e.extent,i)),this._pendingTilesForElevationUpdateEvent.clear(),BM.spatialReference=this.spatialReference,this.emit("elevation-change",BM)}runTask(i){this._handleLayerViewChanges(i),this._frameTask.processQueue(i),this._inFrameTask=!0,this._pendingUpdates=0,this._hasPendingUpdates=!1,this._updateAllTilesStatus(i),this._sortTiles(i);const e=!this.view.state.fixedContentCamera;this._mergeAndSplit(i,e),this._updateElevation(i),this._updateTextures(i),e||this._mergeAndSplit(i,!0),this._inFrameTask=!1,this._runViewChangeUpdateIfDirty(),this._batchUpdatePendingTileGeometries(),this._emitElevationUpdateEventForTiles(),i.done?this.requestUpdate():this.getUsedMemory(),this.notifyChange("updatingProgressValue")}_updateAllTilesStatus(i){if(!this._viewChanged||!this.rootTiles||i.done)return;this._viewChanged=!1;const e=this._iteratorPool.acquire();e.reset(this.rootTiles);const t=this.snapLevel,r=this._splitLimits,n=this._eyePosRenderSR;for(;!e.done;){const s=e.next(),a=s.shouldSplit(r,n,t);if(a!==Fe.SPLIT){if(s.resetPendingUpdate(Fe.SPLIT)&&s.updateAgentSuspension(),a===Fe.VSPLITMERGE&&s.updateAgents(ut.ELEVATION),e.skipSubtree(),!s.isLeaf){s.setPendingUpdate(Fe.MERGE),s.resetPendingUpdate(Fe.SPLIT);const o=this._iteratorPool.acquire();o.resetOne(s);const l=this._viewProjectionMatrix;for(let c=o.next();!o.done;c=o.next())this._updateClippingStatus(c),c.updateVisibility(),c.updateScreenDepth(l);o.remove()}}else s.resetPendingUpdate(Fe.MERGE),s.isLeaf&&(s.setPendingUpdate(Fe.SPLIT),e.skipSubtree()),s.rendered&&s.setPendingUpdate(Fe.RENDERDATA)}e.remove(),this.requestUpdate(),(this.shortBatches||!this.oneBatchPerFrameTask)&&this._batchUpdatePendingTileGeometries(),i.madeProgress()}_sortTiles(i){i.done||this._allTilesSorted||($Re(this._allTiles,this.view.pointsOfInterest.focus.renderLocation),this._allTilesSorted=!0,this._treeDebugger&&this._treeDebugger.update(),i.madeProgress())}_markTileToUpdate(i){pe(i.isLoaded),i.intersectsClippingArea&&(this._pendingTilesToUpdate.add(i),this._markAllTileNeighborsForGeometryUpdate(i))}_batchUpdatePendingTileGeometries(){const i=this._pendingTilesToUpdate;if(i.size===0)return;const e=Array.from(this._pendingTilesToUpdate.keys()).filter(n=>n.isLoaded&&n.intersectsClippingArea),t=(n,s)=>{!(s!=null&&s.isLoaded)||!s.intersectsClippingArea||s.level<n.level||i.has(s)||(i.add(s),e.push(s),s.renderData.updateNeighborData())};e.sort(vd);const r=e.length;for(let n=0;n<r;++n){const s=e[n];pe(s.isLoaded),pe(s.intersectsClippingArea);const a=s.renderData;a.updateNeighborData();const o=a._dirtyEdgeResolutions,l=a.geometryState.neighborData;for(let c=0;c<4;++c)if(o&1<<c){const u=s.renderData.geometryState.neighborData.edgePeerNeighbors[c];u&&(u==null?void 0:u.level)>=s.level&&u.forAllSubtreeOnSide(dP(jh[c]),d=>!(!d.isLoaded||!d.intersectsClippingArea)&&(pe(i.has(d)||vd(s,d)<0),t(s,d),!0)),t(s,l.cornerPeerNeighbors[c]),t(s,l.cornerPeerNeighbors[(c+1)%4])}}i.clear(),this._updateTilesGeometries(e),gn&&cP&&this.checkAllTilesWaterproofness()}_mergeAndSplit(i,e){if(this.suspended||i.done||!this._allTilesDirty)return;this._allTilesDirty=!1,this.requestUpdate();let t=!1,r=!1;for(;!i.done;){r=!0;let n=!1;const s=!this._allTiles.some(a=>{var l;if(!t&&!a.loadable)return i.done;let o=a;if(a.resetPendingUpdate(Fe.MERGE)){if(!e)return a.setPendingUpdate(Fe.MERGE),i.done;for(;(l=o.parent)!=null&&l.resetPendingUpdate(Fe.MERGE);)o=o.parent;this._mergeTile(o),n=!0,i.madeProgress()}else a.resetPendingUpdate(Fe.SPLIT)&&(this._splitTile(a),n=!0,i.madeProgress());return!i.done&&o===a&&a.resetPendingUpdate(Fe.RENDERDATA)&&(this._updateRenderData(a),i.madeProgress()),i.done});if(n&&(this._allTilesSorted=!1,this._allTilesDirty=!0),s){if(!t){t=!0;continue}if(!n)break}else this._allTilesDirty=!0}r||(this._allTilesDirty=!0),!this.oneBatchPerFrameTask&&this._batchUpdatePendingTileGeometries(),this._sortTiles(i)}_updateElevation(i){i.done||(this._allTiles.some(e=>(e.resetPendingUpdate(Fe.GEOMETRY)&&(this._updateTileGeometryState(e),this._updateTileTexture(e,i),this.shortBatches&&this._batchUpdatePendingTileGeometries(),i.madeProgress()),i.done)),!this.oneBatchPerFrameTask&&this._batchUpdatePendingTileGeometries())}_updateTextures(i){i.done||this._allTiles.some(e=>(this._updateTileTexture(e,i),i.done))}_updateClippingExtent(){this.spatialReference&&(this.updateTileOverlayParams(vr.UPDATE),this.overlayManager.setPlacementDirty(),this._updateRootTiles())}get _lodBias(){const i=this.view.resourceController.memoryController.memoryFactor;return this.view.qualitySettings.tiledSurface.lodBias-(1-i)*$_e}_getLodBiasCorrectedScale(i){const e=this.tilingScheme.levels,t=ce(i-this._lodBias,0,e.length-1),r=t-Math.floor(t);return e[Math.floor(t)].scale*(1-r)+e[Math.ceil(t)].scale*r}_removeAllTiles(){y(this.rootTiles)&&(this.rootTiles.forEach(i=>this._purgeTile(i)),this._setRootTiles(null),this.notifyChange("ready")),this._allTiles.clear(),this._visible=!1}_purgeDescendantTiles(i){if(i.isLeaf)return!1;let e=!1;for(let t=0;t<4;++t)e=this._purgeTile(i.children[t])||e;return i.unsetChildren(),e}_purgeTile(i){const e=this._purgeDescendantTiles(i)||i.rendered;return this._allTiles.removeUnordered(i),this._unloadTile(i),this._tilePool.release(i),e}_unloadTile(i){this._pendingTilesToUpdate.delete(i),this._pendingTilesForElevationUpdateEvent.delete(i),i.unload(this._renderer)}_splitTile(i){$h(i.isLeaf,"tile that is already split should not be split again!");const e=i.level+1,t=2*i.lij[1],r=2*i.lij[2];i.setChildren(this._createTile(e,t,r,i),this._createTile(e,t,r+1,i),this._createTile(e,t+1,r,i),this._createTile(e,t+1,r+1,i)),i.setPendingUpdate(Fe.RENDERDATA),i.updateAgentSuspension(),this._allTiles.pushArray(i.children),this._allTilesDirty=!0,++this._performanceInfo.numSplit}_emitTileScaleChange(i,e=i.level){eS.spatialReference=this.spatialReference,eS.extent=i.extent,eS.scale=this._getLodBiasCorrectedScale(e),this.emit("scale-change",eS)}_createTile(i,e,t,r){$h(!!r,"_createTile sanity check");const n=this._acquireTile(i,e,t,r);return n.updateClippingStatus(this.extent),n.updateScreenDepth(this._viewProjectionMatrix),this._shouldSplit(n)&&n.setPendingUpdate(Fe.SPLIT),n}get shortBatches(){return this.view.state.mode!==Fh.IDLE}_mergeTile(i){$h(!i.hasPendingUpdate(Fe.SPLIT),"_mergeTile sanity check"),this._purgeDescendantTiles(i)&&($h(!i.renderData,"_mergeTile sanity check"),this._loadTile(i),this._markTileToUpdate(i),this._emitTileScaleChange(i),this.shortBatches&&this._batchUpdatePendingTileGeometries()),this._allTilesDirty=!0,++this._performanceInfo.numMerged}_loadChildren(i){$h(i.rendered,"parent should be rendered"),this._unloadTile(i);const e=i.children;e.forEach(t=>this._loadTile(t)),e.forEach(t=>this._pendingTilesToUpdate.add(t)),this._markAllTileNeighborsForGeometryUpdate(i),this._emitTileScaleChange(i,i.level+1),this.shortBatches&&this._batchUpdatePendingTileGeometries()}_loadParent(i){const e=i.parent;this._unloadChildren(e),this._loadTile(e),this._markTileToUpdate(e),this._emitTileScaleChange(e,e.level),this.shortBatches&&this._batchUpdatePendingTileGeometries()}_unloadChildren(i){if(!i.isLeaf)for(let e=0;e<4;++e){const t=i.children[e];this._unloadChildren(t),this._unloadTile(t)}}_loadTile(i){i.load(),i.setPendingUpdate(Fe.RENDERDATA),this.requestUpdate(),this._allTilesDirty=!0,this.overlayManager&&this.overlayManager.hasOverlays&&this.overlayManager.setTileParameters(i)}_elevationDataArrived(i,e,t){const r=new gRe(i.lij,i.extent,t);i.dataArrived(e,ut.ELEVATION,r);const n=[i],s=i.level,a=this._iteratorPool.acquire();for(a.reset(n);!a.done;){const o=a.next();o.findElevationBoundsForLayer(e,s),o.computeElevationBounds()}s===0&&this._updateRootTileElevationBounds(),a.remove(),this._updateTilesVisibility(n)}_handleLayerViewChanges(i=CP){if(!this._layerViewsDirty)return;this._layerViewsDirty=!1;let e=!1;const t=new Set;let r=-1;for(const n of this.view.allLayerViews.items)if(t.add(n.uid),vx(n)||C1(n))if(this._basemapLayerViewHandles.has(n.uid)&&!C1(n)){const s=this._layerClassFromLayerView(n),a=this._getLayerIdxByUID(s,n.uid);y(a)&&((a<r||S(r))&&(e=!0),r=a)}else this._registerTiledLayerView(n),n.layer.loaded&&(e=!0);this._basemapLayerViewHandles.forEach((n,s)=>{t.has(s)||(this._unregisterTiledLayerView(s),e=!0)}),e&&this._updateTiledLayers(),this._renderer.transparency=this._allSurfaceLayersTransparent()?Ts.Invisible:this._renderer.transparency,this.hasCompositeBlendMode=this._hasCompositeBlendMode(),i.madeProgress()}_allSurfaceLayersTransparent(){var e,t;let i=((t=(e=this.view.map)==null?void 0:e.ground)==null?void 0:t.opacity)===0;for(const r of this.view.allLayerViews.items)if(g$(r)&&!fG(r.layer)&&r.fullOpacity!==0)return i=!1,i;return i}_hasCompositeBlendMode(){for(const i of this.view.allLayerViews.items)if((uP(i)||C1(i))&&BRe(w$[i.layer.blendMode]))return!0;return!1}_layerClassFromLayerView(i){return f$(i)?ut.ELEVATION:ut.MAP}_registerTiledLayerView(i){const e=[];if((uP(i)||C1(i))&&e.push(z(()=>i.layer.blendMode,()=>{this.hasCompositeBlendMode=this._hasCompositeBlendMode(),this._updateTileTextures(fn.UNFADED)})),C1(i))return;const t=this._layerClassFromLayerView(i);e.push(z(()=>i.suspended,()=>this._updateTiledLayers())),e.push(z(()=>i.fullOpacity,()=>this._updateTileTextures(fn.UNFADED))),e.push(z(()=>"effectiveScaleRange"in i.layer?i.layer.effectiveScaleRange:null,()=>this._restartAllAgents(t))),i.on("data-changed",()=>{const r=this._getLayerIdxByUID(t,i.uid);y(r)&&this._invalidateLayerData(r,t)}),this._basemapLayerViewHandles.set(i.uid,e)}_unregisterTiledLayerView(i){const e=this._basemapLayerViewHandles.get(i);if(e){for(let t=0;t<e.length;t++)e[t].remove();this._basemapLayerViewHandles.delete(i)}}_updateTiledLayers(){if(!this.tilingScheme||this.view.suspended)return;const i=this.view.allLayerViews,e=[[],[]];let t=null;i.forEach(r=>{if(!r.layer||r.suspended||!vx(r)||!r.fullExtent)return;const n=this._layerClassFromLayerView(r);if(n===ut.MAP){const s=r.displayLevelRange.maxLevel;s!==1/0&&(t===null||s>t)&&(t=s)}e[n].push(r)});for(const r of Bf){const n=this._layerViews[r],s=e[r];s.reverse();const a=s.length;let o=n.length!==a;const l=new Array(a),c=new Array(n.length);this._layerIndexByUid[r].clear();for(let u=0;u<a;u++){const d=s[u].uid;this._layerIndexByUid[r].set(d,u);const m=n.indexOf(s[u]);l[u]=m,u!==m&&(o=!0),m>-1&&(c[m]=u)}if(o){const u=this._postorderIterator;for(u.reset(this.rootTiles);!u.done;)u.next().modifyLayers(c,l,r);this._layerViews[r]=s,this._restartAllAgents(r),this._updateTilesVisibility(this.rootTiles)}}this.tilingScheme.ensureMaxLod(t)&&this._viewChangeUpdate()}_restartAllAgents(i){const e=this._postorderIterator;for(e.reset(this.rootTiles);!e.done;){const t=e.next();t.restartAgents(i),i===ut.ELEVATION&&t.computeElevationBounds()}this._updateRootTileElevationBounds()}layerViewByIndex(i,e){return this._layerViews[e][i]}numLayers(i){return this._layerViews[i].length}_updateTileTextures(i){this._allTiles.forAll(e=>{e.updateAgents(ut.MAP),i===fn.IMMEDIATE?this.renderer.updateTileTexture(e,Fe.TEXTURE_NOFADING):e.updateRenderData(ut.MAP,i)}),this._renderer.transparency=this._allSurfaceLayersTransparent()?Ts.Invisible:this._renderer.transparency}_invalidateLayerData(i,e){this._allTiles.forAll(t=>t.removeLayerAgent(i,e)),this._allTiles.forAll(t=>t.invalidateLayerData(i,e))}setTileTreeDirty(){this._allTilesDirty=!0}requestRender(i=vr.UPDATE){this.renderer.setNeedsRender(i)}requestUpdate(){++this._pendingUpdates==1&&(this._hasPendingUpdates=!0)}requestTileData(i,e,t,r){const n=this.layerViewByIndex(e,t),s=n.layer;return!s.tilemapCache||yx(n)?this._requestTileData(i,t,n,r):(++this._asyncWorkItems,s.tilemapCache.fetchAvailability(i.lij[0],i.lij[1],i.lij[2],{...r,timeout:6e3}).then(()=>--this._asyncWorkItems).catch(a=>{throw--this._asyncWorkItems,xi(r),yo(a)||this._dataMissing(i,t,n,{notInTilemap:!0}),a}).then(()=>this._frameTask.schedule(()=>this._requestTileData(i,t,n,r),r.signal)))}_requestTileData(i,e,t,r){return e===ut.ELEVATION?f$(t)?this._requestElevationTileData(i,t,r):Promise.reject():g$(t)?this._requestMapTileData(i,t,r):Promise.reject()}_requestElevationTileData(i,e,t){++this._asyncWorkItems;const r=a=>{if(Ec(t))return;const o=this._layerIndexByUid[ut.ELEVATION].get(e.uid);o!=null?(this._usedMemory=null,this.requestUpdate(),this._elevationDataArrived(i,o,a)):J.getLogger(this.declaredClass).warn("TerrainSurface: received data from unknown layer %d %s",ut.ELEVATION,i.lij.toString())},n=a=>{yo(a)||(this._dataMissing(i,ut.ELEVATION,e,a),this.requestUpdate())};if(yz(e.layer))return e.layer.fetchTile(i.lij[0],i.lij[1],i.lij[2],{noDataValue:tx,signal:t.signal}).then(a=>{if(!Ec(t))return this._frameTask.schedule(()=>r(a),t.signal,n);J.getLogger(this.declaredClass).warnOnce("A call to fetchTile resolved even though the request was aborted. fetchTile should not resolve if options.signal.aborted is true.")},n).finally(()=>{--this._asyncWorkItems});const s=e.getTileUrl(i.lij[0],i.lij[1],i.lij[2]);return this._elevationDataRequester.request(s,"binary",t).then(a=>this._lercDecoder.decode(a,{noDataValue:tx},t.signal)).then(a=>{a?r({values:a.pixelData,width:a.width,height:a.height,noDataValue:a.noDataValue,minValue:a.minValue,maxValue:a.maxValue}):n(new Error("LERC decoding failed"))},n).finally(()=>{--this._asyncWorkItems})}_requestMapTileData(i,e,t){++this._asyncWorkItems;const r=(c,u)=>{--this._asyncWorkItems,N0(u),Ec(t)||(this._dataMissing(i,ut.MAP,e,c),this.requestUpdate())},n=c=>u=>r(u,c),s=c=>this._frameTask.schedule(()=>{--this._asyncWorkItems,this.requestUpdate(),Ec(t)?N0(c):this._mapTileDataArrived(i,e,c)},t.signal,n(c)).catch(n(c)),a=(c,u=null)=>this._frameTask.schedule(()=>r(c,u));if(yx(e)){const c=e.schemaHelper.getLevelRowColumn(i.lij);return e.fetchTile(c[0],c[1],c[2],t).then(s,a)}if(NR(e))return e.fetchTile(i.lij[0],i.lij[1],i.lij[2],t).then(s,a);if(A4(e)&&yz(e.layer))return e.layer.fetchTile(i.lij[0],i.lij[1],i.lij[2],t).then(c=>{if(Ec(t))return J.getLogger(this.declaredClass).warnOnce("A call to fetchTile resolved even though the request was aborted. fetchTile should not resolve if options.signal.aborted is true."),void a(ts());s(c)},a);let o=e.getTileUrl(i.lij[0],i.lij[1],i.lij[2]);vae(e.layer)&&e.layer.refreshTimestamp&&(o+=`${o.includes("?")?"&":"?"}_ts=${e.layer.refreshTimestamp}`);const l=e.hasMixedImageFormats?"image+type":"image";return this._mapDataRequester.request(o,l,t).then(s,a)}_mapTileDataArrived(i,e,t){const r=this._getLayerIdxByUID(ut.MAP,e.uid);y(r)?i.dataArrived(r,ut.MAP,t):(N0(t),J.getLogger(this.declaredClass).warn("TerrainSurface: received data from unknown layer"))}_getLayerIdxByUID(i,e){return this._layerIndexByUid[i].get(e)}_dataMissing(i,e,t,r){const n=this._getLayerIdxByUID(e,t.uid);y(n)?i.dataMissing(n,e,r):J.getLogger(this.declaredClass).warn("TerrainSurface: received data from unknown layer")}updateTileOverlayParams(i){this.rootTiles&&this.overlayManager&&(this._allTiles.forAll(e=>{e.renderData&&this.overlayManager.setTileParameters(e)}),this._renderer.setNeedsRender(i))}get performanceInfo(){const i=this._performanceInfo;return i.numNodes=this._allTiles.length,i.numLeaves=i.numVisible=i.numRendered=i.numLoadedPerLevel.length=i.numRenderedPerLevel.length=0,this._allTiles.forAll(e=>{e.isLeaf&&i.numLeaves++;const t=e.level;e.renderData&&(i.numLoadedPerLevel[t]=(i.numLoadedPerLevel[t]||0)+1),e.visible&&(i.numVisible++,e.rendered&&(i.numRenderedPerLevel[t]=(i.numRenderedPerLevel[t]||0)+1,i.numRendered++))}),i}getUsedMemory(){return this.tilingScheme?(S(this._usedMemory)&&(this._usedMemory=this._recalculateUsedMemory()),y(this._usedMemory)?this._usedMemory:0):0}_recalculateUsedMemory(){return this.tilingScheme?this._allTiles.reduce((i,e)=>i+e.usedMemory,0):null}getUsedMemoryForLayerView(i){let e=0;const t=this._layerClassFromLayerView(i),r=this._getLayerIdxByUID(t,i.uid);return y(r)&&this._allTiles.forAll(n=>e+=n.getUsedMemoryForLayer(t,r)),e}getTile(i){if(S(i)||S(this.rootTiles))return null;const e=i.split("/").map(a=>+a);if(e[0]===0)return this.rootTiles.find(a=>a.lij[1]===e[1]&&a.lij[2]===e[2]);const t=2**e[0],r=Math.floor(e[1]/t),n=Math.floor(e[2]/t);let s;if(this.rootTiles.some(a=>a.lij[1]===r&&a.lij[2]===n&&(s=a,!0)),s){let a=1<<e[0]-1;for(;s.lij[0]<e[0];){let o=e[1]&a?2:0;if((e[2]&a)>0&&o++,!s.children[o])return null;s=s.children[o],a>>=1}return $h(s.lij[0]===e[0]&&s.lij[1]===e[1]&&s.lij[2]===e[2],"not the right tile?"),s}return null}get renderPatchBorders(){return this._renderer.renderPatchBorders}set renderPatchBorders(i){this._renderer.renderPatchBorders=i}get visualizeNormals(){return this._renderer.visualizeNormals}set visualizeNormals(i){this._renderer.visualizeNormals=i}get renderingDisabled(){return this._renderer.renderingDisabled}set renderingDisabled(i){this._renderer.renderingDisabled=i}get test(){const i=this;return{renderer:i._renderer,lercDecoder:i._lercDecoder,forceReload:()=>{y(i.rootTiles)&&(i._mergeTile(i.rootTiles[0]),i._viewChangeUpdate())},getTiles:()=>i._allTiles.toArray(),getRenderedTiles(){zM.clear(),i._allTiles.forAll(t=>{t.visible&&t.rendered&&zM.push(t)});const e=zM.toArray();return UK(i.renderOrder,e),e},lockTilingScheme(e,t){i._extentHelper.defaultTiledLayersExtent=t,i.tilingSchemeLogic.test.lockTilingScheme(e)}}}checkAllTilesWaterproofness(){if(!cP)return;const i=this.rootTiles;if(S(i))return;const e=s=>{var a,o,l;return((l=(o=(a=s==null?void 0:s.renderData)==null?void 0:a.geometryInfo)==null?void 0:o.indices)==null?void 0:l.length)>0},t=(s,a)=>{e(s)&&console.error("Tile[",s.lij,"] has geometry although parent[",a.lij,"] has geom")},r=s=>{var a,o;if(s.intersectsClippingArea)if(s.renderData&&!s.renderData.geometryState&&console.error("Tile[",s.lij,"] has renderData but not geometryState"),s.renderData&&!s.renderData.geometryInfo&&console.error("Tile[",s.lij,"] has renderData but not geometryInfo"),!((a=s.renderData)!=null&&a.geometryInfo)||(((o=s.renderData.geometryInfo.indices)==null?void 0:o.length)??0)>0||console.error("Tile[",s.lij,"] has renderData but no indices - geometryInfo: ",s.renderData.geometryInfo),e(s)){s.checkGeometryWaterproofness();for(const l of s.children)t(l,s)}else if(s.isLeaf)console.error("Tile[",s.lij,"] has no geometry and no children, from root to leaf");else for(const l of s.children)r(l)},n=s=>{var c;const a=((c=s.parent)==null?void 0:c.visible)??!0,o=s.visible;s.computeVisibility();const l=s.visible;if(o!==l&&a&&console.error(" Tile[",s.lij,"] has out of date visibility: ",o," instead of ",l),!s.isLeaf)for(const u of s.children)n(u)};for(const s of i)r(s),n(s)}get isGlobal(){return this._isGlobal}get shading(){return this._shading}_updateShadingIfChanged(){var e,t,r;((r=(t=(e=this.view)==null?void 0:e.map)==null?void 0:t.ground)==null?void 0:r.shading)!==this._shading&&this._updateShading()}_updateShading(){var e,t,r;const i=(r=(t=(e=this.view)==null?void 0:e.map)==null?void 0:t.ground)==null?void 0:r.shading;this._shading=i,this.renderer&&(this.renderer.shading=i,this.renderer.setNeedsRender()),this._updateAllTileGeometries()}get isWebMercator(){return this._isWebMercator}get isWebMercatorOnPlateeCarree(){return this._isWebMercatorOnPlateeCarree}isEastEndWrap(i){return this.isGlobal&&i[2]===this.lijEastEnd(i[0])-1}isWestEndWrap(i){return this.isGlobal&&i[2]===0}lijEastEnd(i){return 2**(i+(y(this.spatialReference)&&this.spatialReference.isGeographic?1:0))}wrapEastWest(i){const e=this.lijEastEnd(i[0]),t=i[2];if(0<=t&&t<e)return i;if(!this.isGlobal)return null;const r=(t+(t<0?e:0))%e;return[i[0],i[1],r]}enableInternalChecks(i){RPe(i)}enableWaterproofnessChecks(i){PPe(i)}};h([p()],lt.prototype,"_renderer",void 0),h([p()],lt.prototype,"_hasPendingUpdates",void 0),h([p()],lt.prototype,"_asyncWorkItems",void 0),h([p()],lt.prototype,"_allTilesDirty",void 0),h([p()],lt.prototype,"_allTilesSorted",void 0),h([p()],lt.prototype,"_viewChanged",void 0),h([p({readOnly:!0})],lt.prototype,"_watchUpdatingTracking",void 0),h([p()],lt.prototype,"_frameTask",void 0),h([p({readOnly:!0})],lt.prototype,"snapLevel",null),h([p({readOnly:!0})],lt.prototype,"lodSnapping",null),h([p({constructOnly:!0})],lt.prototype,"view",void 0),h([p()],lt.prototype,"_userClippingExtent",null),h([p()],lt.prototype,"_rootTilesExtent",void 0),h([p({readOnly:!0})],lt.prototype,"extent",null),h([p({readOnly:!0})],lt.prototype,"groundExtent",null),h([p({readOnly:!0})],lt.prototype,"_tilingSchemeExtent",null),h([p({readOnly:!0})],lt.prototype,"updating",null),h([p({readOnly:!0})],lt.prototype,"running",null),h([p(fRe)],lt.prototype,"updatingProgress",void 0),h([p({readOnly:!0})],lt.prototype,"updatingProgressValue",null),h([p()],lt.prototype,"_maxNumUpdating",void 0),h([p()],lt.prototype,"baseOpacity",null),h([p()],lt.prototype,"hasCompositeBlendMode",void 0),h([p({readOnly:!0})],lt.prototype,"overlayManager",void 0),h([p({readOnly:!0})],lt.prototype,"viewingMode",null),h([p()],lt.prototype,"maxTextureScale",void 0),h([p({readOnly:!0})],lt.prototype,"ready",null),h([p({value:wx.FRONT_TO_BACK})],lt.prototype,"renderOrder",null),h([p({readOnly:!0})],lt.prototype,"rootTiles",void 0),h([p({readOnly:!0})],lt.prototype,"spatialReference",null),h([p({type:ei})],lt.prototype,"backgroundColor",null),h([p({value:!1})],lt.prototype,"slicePlaneEnabled",null),h([p({readOnly:!0})],lt.prototype,"tilingScheme",void 0),h([p({readOnly:!0})],lt.prototype,"tilingSchemeLocked",null),h([p({readOnly:!0})],lt.prototype,"tilingSchemeLogic",void 0),h([p({value:!0})],lt.prototype,"velvetOverground",null),h([p()],lt.prototype,"wireframe",null),h([p({value:!1})],lt.prototype,"suspended",null),h([p()],lt.prototype,"textureFadeDuration",null),h([p()],lt.prototype,"visibleElevationBounds",void 0),h([p()],lt.prototype,"rootTileElevationBounds",void 0),h([p()],lt.prototype,"_layerViewsDirty",void 0),h([p()],lt.prototype,"renderPatchBorders",null),h([p()],lt.prototype,"visualizeNormals",null),h([p()],lt.prototype,"renderingDisabled",null),lt=h([D("esri.views.3d.terrain.TerrainSurface")],lt);const gOe=lt;function qz(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]}function vJ(i){return!i.isLeaf&&(i.children.some(e=>e.shouldLoad)||i.children.some(e=>vJ(e)))}function _Oe(i){return i.isLeaf&&i.parent&&i.parent.shouldLoad}const la=_i(),yOe=$t(),JC=[0,0,0],zM=new Zt,BM={spatialReference:null,extent:$t(),context:"ground"},eS={spatialReference:null,extent:null,scale:0};function Wz(i,e,t){var r;for(const n of i){if(!n.containsPointXY(e,t))continue;let s=n;for(;s&&!s.renderData;){const o=(e>s.extentMidX?1:0)+(t<s.extentMidY?2:0);s=s.children[o]}const a=((r=s==null?void 0:s.renderData)==null?void 0:r.geometryState.samplerData)??null;return Si(e,t,a)}return null}let vOe=class{constructor(e,t){this.geometryRecord=e,this.renderGeometry=t}},bOe=class{constructor(e,t,r){this.operation=e,this.geometryRecord=t,this.states=r}},yb=class extends ue{constructor(e){super(e),this._residentGeomRecords=new Map,this._dirtyGeomRecords=new Map,this.dirty=!1}commit(e){this.dirty=!1,this._dirtyGeomRecords.forEach((t,r)=>this.commitLayer(r,e))}commitLayer(e,t){const r=this._dirtyGeomRecords.get(e);r&&(r.forEach((n,s)=>{const a=this._ensureGeomRecord(e,s);n.forEach(({geometryRecord:o,operation:l,states:c},u)=>{let d=!1;if(l===Fi.UPDATE){const m=a.get(u);if(m){const f=m.renderGeometry;if(c&Ur.TRANSFORMATION){const _=this.model.getObject(s);this.model.updateRenderGeometryTransformation(_,o,f)&&(d=!0)}d||t.updates.push({renderGeometry:f,updateType:c})}else it(!1,"ModelDirtySet.getAddRemoveListFilteredByLayers: invalid update")}if(l===Fi.REMOVE||d){const m=a.get(u);m?(t.removes.push(m.renderGeometry),a.delete(u),m.geometryRecord.disposed&&jg.pool.release(m.geometryRecord)):l===Fi.REMOVE&&it(!1,"ModelDirtySet.getAddRemoveListFilteredByLayers: invalid remove")}if(l===Fi.ADD||d){const m=this.model.getObject(s);if(y(m)){const f=this.model.getRenderGeometry(m,o),_=new vOe(o,f);t.adds.push(f),a.set(u,_)}}}),a.size===0&&this._residentGeomRecords.get(e).delete(s)}),this._residentGeomRecords.get(e).size===0&&this._residentGeomRecords.delete(e),this._dirtyGeomRecords.delete(e))}getResidentRenderGeometries(e,t){const r=this._residentGeomRecords.get(e);r&&r.forEach(n=>n.forEach(s=>t.push(s.renderGeometry)))}_objectStateChanged(e,t){for(const r of t.geometryRecords)this._updateOrCreateDirtyRecord(t,r,null,Fi.UPDATE,e)}visibilityChanged(e){this._objectStateChanged(Ur.VISIBILITIES,e)}highlightChanged(e){this._objectStateChanged(Ur.HIGHLIGHTS,e)}occlusionChanged(e){this._objectStateChanged(Ur.OCCLUDEES,e)}vertexAttrsUpdated(e){this._updateOrCreateDirtyRecord(e.object,e.record,null,Fi.UPDATE,Ur.VERTEXATTRS)}layerAdded(e){e.objects.forAll(t=>this._layerObjectAdded(e,t))}layerRemoved(e){e.objects.forAll(t=>this._layerObjectRemoved(e,t))}layerObjectAdded(e){this._layerObjectAdded(e.layer,e.object)}_layerObjectAdded(e,t){const r=e.id;for(const n of t.geometryRecords)this._objectGeometryAdded(t,n,r)}layerObjectRemoved(e){this._layerObjectRemoved(e.layer,e.object)}layerObjectsAdded(e){for(const t of e.objects)this._layerObjectAdded(e.layer,t)}layerObjectsRemoved(e){for(const t of e.objects)this._layerObjectRemoved(e.layer,t)}_layerObjectRemoved(e,t){const r=e.id;for(const n of t.geometryRecords)this._objectGeometryRemoved(t,n,r)}shaderTransformationChanged(e){const t=this._residentGeomRecords.get(e.id);t&&t.forEach((r,n)=>{const s=this.model.getObject(n);s&&s.hasVolativeTransformation()&&r.forEach(a=>{a.renderGeometry.shaderTransformationChanged()})})}objectTransformation(e){const t=this._getParentLayerId(e),r=e.id;this._ensureGeomRecord(t,r).forEach(n=>{this._updateOrCreateDirtyRecord(e,n.geometryRecord,t,Fi.UPDATE,Ur.TRANSFORMATION)})}objectGeometryAdded(e){this._objectGeometryAdded(e.object,e.record)}_objectGeometryAdded(e,t,r=null){this._updateOrCreateDirtyRecord(e,t,r,Fi.ADD)}objectGeometryRemoved(e){this._objectGeometryRemoved(e.object,e.record)}_objectGeometryRemoved(e,t,r=null){this._updateOrCreateDirtyRecord(e,t,r,Fi.REMOVE)}_updateOrCreateDirtyRecord(e,t,r,n,s=Ur.NONE){r=je(r,this._getParentLayerId(e));const a=e.id,o=t.id,l=this._ensureDirtyRecord(r,a),c=l.get(o);if(c){const u=c.operation;u===Fi.REMOVE&&n===Fi.ADD&&c.states!==Ur.NONE?c.operation=Fi.UPDATE:u===Fi.REMOVE&&n===Fi.ADD||u===Fi.ADD&&n===Fi.REMOVE?(l.delete(o),c.geometryRecord.disposed&&jg.pool.release(c.geometryRecord)):u!==Fi.UPDATE||n!==Fi.REMOVE&&n!==Fi.UPDATE?(it((u===Fi.REMOVE||u===Fi.ADD)&&n===Fi.UPDATE,"ModelDirtySet.objectGeometryAdded: inconsistent state"),c.states|=s):(c.operation=n,c.states|=s)}else l.set(o,new bOe(n,t,s));this.dirty=this._hasDirtyGeometryRecords}_ensureGeomRecord(e,t){let r=this._residentGeomRecords.get(e);r||(r=new Map,this._residentGeomRecords.set(e,r));let n=r.get(t);return n||(n=new Map,r.set(t,n)),n}get _hasDirtyGeometryRecords(){return Er(this._dirtyGeomRecords,e=>Er(e,t=>t&&t.size>0))}_ensureDirtyRecord(e,t){let r=this._dirtyGeomRecords.get(e);r||(r=new Map,this._dirtyGeomRecords.set(e,r));let n=r.get(t);return n||(n=new Map,r.set(t,n)),n}_getParentLayerId(e){return y(e.parentLayer)?e.parentLayer.id:Oee}formatDebugInfo(){const e=["ADD","UPD",void 0,"REM"];let t="";return this._dirtyGeomRecords.forEach((r,n)=>{r.forEach((s,a)=>{t.length>0&&(t+=`
`),t+=n+"."+a;const o=[];s.forEach(l=>{const c=l.operation;o[c]||(o[c]=[]),o[c].push(l.geometryRecord.geometry.id)});for(let l=0;l<o.length;l++)if(o[l]){t+=" "+e[l-1]+": ";for(let c=0;c<o[l].length;c++)t+=o[l][c]+", "}})}),t}get test(){const e=this;return{get residentLayerCount(){return e._residentGeomRecords.size},get residentObjectCount(){return Array.from(e._residentGeomRecords.values()).reduce((t,r)=>t+r.size,0)}}}};h([p({constructOnly:!0})],yb.prototype,"model",void 0),h([p()],yb.prototype,"dirty",void 0),yb=h([D("esri.views.3d.webgl-engine.lib.ModelDirtySet")],yb);const wOe=yb;let gE=class extends ue{constructor(){super(...arguments),this.dirtySet=new wOe({model:this}),this._content=new Map,this._originFactory=new m4(null)}getObject(e){return this._content.get(e)}add(e){const t=e.id;it(!this._content.has(t),"Model/Stage already contains object to be added"),this._content.set(t,e),iP(e)&&this.dirtySet.layerAdded(e)}remove(e){it(this._content.has(e.id),"Model/Stage doesn't contain object to be removed"),this._content.delete(e.id),e.unload(),iP(e)&&this.dirtySet.layerRemoved(e)}addMany(e){for(const t of e)y(t)&&(it(!this._content.has(t.id),"Model/Stage already contains object to be added"),this._content.set(t.id,t))}removeMany(e){for(const t of e)it(this._content.has(t.id),"Model/Stage doesn't contain object to be removed"),this._content.delete(t.id),t.unload()}has(e){return this._content.has(e.id)}forEachOfType(e,t){this._content.forEach(r=>{r.type===e&&t(r)})}getRenderGeometry(e,t){const{geometry:r,material:n,id:s,shaderTransformation:a,origin:o,instanceParameters:l}=t,c=new hv(r,n,{id:s,boundingInfo:r.boundingInfo,calculateShaderTransformation:a,castShadow:e.castShadow});return c.updateTransformation(u=>e.getCombinedStaticTransformation(t,u)),c.origin=y(o)?o:this._originFactory.getOrigin(c.boundingSphere),c.instanceParameters=l,c}updateRenderGeometryTransformation(e,t,r){if(S(e))return!1;r.updateTransformation(s=>e.getCombinedStaticTransformation(t,s));const n=this._originFactory.getOrigin(r.boundingSphere);return r.origin!==n}getStats(){const e={},t=Array.from(this._content.values());for(let r=0;r<gv.COUNT;++r)e[r]=t.filter(n=>n.type===r).length;return{contentTypes:e,dirtySet:this.dirtySet.formatDebugInfo()}}get test(){return{content:Array.from(this._content.values())}}};h([p({constructOnly:!0})],gE.prototype,"dirtySet",void 0),gE=h([D("esri.views.3d.webgl-engine.parts.Model")],gE);let xOe=class{constructor(e){this._totalCount=e,this._indexRanges=[0,e]}allVisible(){return this.componentCount()===this._totalCount}allInvisible(){return this._indexRanges.length===0}componentCount(){const e=this._indexRanges;let t=0;for(let r=0;r<e.length;r+=2)t+=e[r+1];return t}reset(e){e==="all"||e.length===this._totalCount?this._indexRanges=[0,this._totalCount]:this._indexRanges=TOe(e)}forEachComponent(e){const t=this._indexRanges;for(let r=0;r<t.length;r+=2){const n=t[r],s=n+t[r+1];for(let a=n;a<s;a++)if(!e(a))return!1}return!0}forEachComponentRange(e){const t=this._indexRanges;for(let r=0;r<t.length;r+=2){const n=t[r];if(!e(n,n+t[r+1]))return!1}return!0}computeOffsetRanges(e){const t=new Array(this._indexRanges.length),r=this._indexRanges;for(let n=0;n<r.length;n+=2){const s=r[n],a=s+r[n+1],o=e[s],l=e[a];t[n]=o,t[n+1]=l-o}return t}};function TOe(i){const e=new Array;if(i.length===0)return e;let t=i[0],r=1;for(let n=1;n<i.length;n++){const s=i[n];t+r===s?r+=1:(e.push(t),e.push(r),t=s,r=1)}return e.push(t),e.push(r),e}let COe=class extends IR{constructor(e,t){super(),this.pickability=null,this.highlightCounts=null,this.verticalOffsets=null,this.cachedGeometryRanges=null,this.cachedHighlightRanges=null,this.cachedDefaultRanges=null,this.offsets=p7(t);const r=this.count;this.visibility=new xOe(r),this.materialDataBuffer=e.getBuffer(r),this.materialDataIndices=new Uint16Array(r);for(let n=0;n<r;n++)this.materialDataIndices[n]=this.materialDataBuffer.acquireIndex()}dispose(){super.dispose();for(let e=0;e<this.count;e++)this.materialDataBuffer.releaseIndex(this.materialDataIndices[e])}get count(){return this.offsets.length-1}get geometryRanges(){return S(this.cachedGeometryRanges)&&(this.cachedGeometryRanges=this.visibility.computeOffsetRanges(this.offsets)),this.cachedGeometryRanges}get highlightRanges(){return S(this.highlightCounts)?null:(this._updateCachedHighlightRanges(),this.cachedHighlightRanges)}get defaultShadowMapRanges(){return S(this.highlightCounts)?this.geometryRanges:(this._updateCachedHighlightRanges(),this.cachedDefaultRanges)}highlightsDirty(){this.cachedHighlightRanges=null,this.cachedDefaultRanges=null}visibilityDirty(){this.cachedGeometryRanges=null,this.highlightsDirty()}_updateCachedHighlightRanges(){if((S(this.cachedHighlightRanges)||S(this.cachedDefaultRanges))&&y(this.highlightCounts)){const{highlightRanges:e,defaultRanges:t}=SOe(this.highlightCounts,this.visibility,this.offsets);this.cachedHighlightRanges=e,this.cachedDefaultRanges=t}}};function SOe(i,e,t){const r=[],n=[];let s=t.length,a=t.length;return e.forEachComponent(o=>(i[o]>0?(s!==o-1&&(r.length&&r.push(t[s+1]-r[r.length-1]),r.push(t[o])),s=o):(a!==o-1&&(n.length&&n.push(t[a+1]-n[n.length-1]),n.push(t[o])),a=o),!0)),r.length&&r.push(t[s+1]-r[r.length-1]),n.length&&n.push(t[a+1]-n[n.length-1]),{highlightRanges:r,defaultRanges:n}}let E$=class extends IR{constructor(){super(...arguments),this.visible=V0.Hidden}};var V0;h([Yn()],E$.prototype,"renderable",void 0),h([Yn()],E$.prototype,"components",void 0),function(i){i[i.Hidden=0]="Hidden",i[i.Visible=1]="Visible"}(V0||(V0={}));function EOe(i,e,t,r){if(t>=e)return i;i==null&&(i=POe());const n=i.isVisibleBit;let s=i.data;const a=wJ(s),o=t/a|0,l=t-a*o,c=(e-1)/a|0,u=s,d=r===n;if(!(t<u.length*a)&&d){const f=o+1,_=Math.ceil(u.length*1.5),g=c+1;let x=Math.max(f,_);x=Math.min(x,g),s=new Uint32Array(x),s.set(u)}return o<s.length&&(s[o]=AOe(s[o],l,d)),i.data=s,i}function bJ(i,e){if(i==null)return!0;const{isVisibleBit:t,data:r}=i,n=wJ(r);return e<r.length*n?ROe(t,r,e,n):!i.isVisibleBit}function POe(i=!0){return{isVisibleBit:!i,data:new Uint32Array(0)}}function ROe(i,e,t,r){const n=t/r|0,s=t-n*r;return OOe(e[n],s)===i}function wJ(i){return i.BYTES_PER_ELEMENT*8}function AOe(i,e,t){return i&~(1<<e)|(t?1:0)<<e}function OOe(i,e){return(i&1<<e)!=0}let MOe=class{constructor(e,t){this._indices=y(e.indices)?e.indices:zD(e.positions.length/3),this._positions=new Dm(e.positions),this._components=t,this._componentIntersectionData=new Array(t.count)}getComponentAabb(e,t){if(y(this._perComponentAabbs)){for(let r=0;r<6;r++)t[r]=this._perComponentAabbs[6*e+r];return t}return this._computePerComponentAabbs(),this.getComponentAabb(e,t)}getComponentPositions(e,t){t.indices=this._indices,t.data=this._positions.typedBuffer,t.stride=this._positions.typedBufferStride,t.startIndex=this._components.offsets[e],t.endIndex=this._components.offsets[e+1]}intersect(e,t,r,n,s,a,o){const l={data:this._positions.typedBuffer,stride:this._positions.typedBufferStride,size:3},c=this._indices,u=this._components.offsets,d=hne(e,t,IOe),m=e[2],f=t[2];this._components.visibility.forEachComponent(_=>{if(!bJ(this._components.pickability,_))return!0;const g=this.getComponentAabb(_,LOe);if(y(a)){const T=a[_];y(s)?s.componentOffset=T:(e[2]=m-T,t[2]=f-T)}if(y(s)&&s.applyToAabb(g),!AG(g,e,d,r))return!0;const x=u[_]/3,b=u[_+1]/3,v=(T,E,C)=>{o(_,T,Nl(E,E,n),C)},w=b-x;return S(s)&&w>_J?(this._componentIntersectionData[_]==null&&(this._componentIntersectionData[_]=new z4(this._indices,x,b,l)),this._componentIntersectionData[_].intersectRay({r0:e,r1:t},v)):ID(e,t,x,b,c,l,void 0,s,v),!0})}_computePerComponentAabbs(){const e=this._components.count;this._perComponentAabbs=new Float32Array(6*e);const t=this._indices,r=this._positions.typedBuffer,n=this._positions.typedBufferStride,s=this._components.offsets;let a=0;for(let o=0;o<e;o++){const l=s[o],c=s[o+1];let u=1/0,d=1/0,m=1/0,f=-1/0,_=-1/0,g=-1/0;for(let x=l;x<c;x++){const b=t[x]*n,v=r[b],w=r[b+1],T=r[b+2];u=Math.min(u,v),d=Math.min(d,w),m=Math.min(m,T),f=Math.max(f,v),_=Math.max(_,w),g=Math.max(g,T)}this._perComponentAabbs[a++]=u,this._perComponentAabbs[a++]=d,this._perComponentAabbs[a++]=m,this._perComponentAabbs[a++]=f,this._perComponentAabbs[a++]=_,this._perComponentAabbs[a++]=g}}get positions(){return this._positions}get indices(){return this._indices}};const IOe=R(),LOe=Ms();let $Oe=class{constructor(e,t,r){this.material=e,this.geometry=t,this.meta=r}dispose(){this.material.dispose(),this.geometry.dispose()}},xJ=class extends IR{constructor(e,t,r,n){super(),this.primitiveType=t,this.parameters=r,this.indexed=n,this.vao=e}};h([Yn()],xJ.prototype,"vao",void 0);function DOe(i,e){return{near:i,far:e}}function eT(i){return i?xx(i,1/0,-1/0):DOe(1/0,-1/0)}function xx(i,e,t){return i.near=e,i.far=t,i}function dv(i,e,t=i){return t.near=Math.min(i.near,e.near),t.far=Math.max(i.far,e.far),t}function tS(i,e){return i.near<=e&&e<=i.far}const P$={near:0,far:0};function FOe(i,e){const t=eT(),{eye:r,frustum:n,viewForward:s}=i;e.forAll(a=>{const o=y(a.offsetObb)?a.offsetObb:a.obb,l=me(tl($o,o.center,r),s),c=Pse(o,s);if(tS(t,l-c)&&tS(t,l+c))return;const u=zOe(o,n);if(u===-1)return;if(u===0)return Ou.far=l+c,Ou.near=l-c,void dv(t,Ou);const d=iS.pushNew();d.near=l-c,d.far=l+c,d.mask=u,d.object=a});for(let a=0;a<iS.length;a++){const o=iS.data[a];if(tS(t,o.near)&&tS(t,o.far))continue;Ou.far=o.far,Ou.near=1/0,UOe(y(o.object.offsetObb)?o.object.offsetObb:o.object.obb,r,NOe,c=>{let u=kOe;for(let d=0;d<TJ&&c.length>0;d++){if(!(o.mask&1<<d))continue;VOe(n[d],c,u);const m=c;c=u,u=m}for(let d=0;d<c.length;d+=3){Z(ya,c.data[d+0],c.data[d+1],c.data[d+2]);const m=me(tl(ya,ya,r),s);Ou.near=Math.min(Ou.near,m)}})===0&&(Ou.near=0),dv(t,Ou)}return iS.length=0,t}const iS=new Zt({allocator:i=>i||{near:1/0,far:-1/0,mask:0,object:null},deallocator:i=>(i.object=iI(i.object),i)}),Ou=eT(),ya=R(),Cf=R(),NOe=new Zt({deallocator:null}),kOe=new Zt({deallocator:null});function VOe(i,e,t){t.length=0;const r=e.length-3;GM(ya,e,r);const n=tr(i,ya);n<=0&&(t.push(ya[0]),t.push(ya[1]),t.push(ya[2]));let s=0,a=n;for(;s<r;s+=3){GM(Cf,e,s);const o=tr(i,Cf);a*o<0&&(Bn(ya,Cf,ya,o/(o-a)),va(t,ya)),o<=0&&va(t,Cf),a=o,q(ya,Cf)}a*n<0&&(GM(Cf,e,r),Bn(ya,Cf,ya,n/(n-a)),va(t,ya))}function GM(i,e,t){return Z(i,e.data[t+0],e.data[t+1],e.data[t+2])}function va(i,e){i.push(e[0]),i.push(e[1]),i.push(e[2])}function UOe(i,e,t,r){use(Qz,i.quaternion),tl($o,e,i.center),Gie($o,$o,Qz);const n=8*(($o[0]<-i.halfSize[0]?-1:$o[0]>i.halfSize[0]?1:0)+3*($o[1]<-i.halfSize[1]?-1:$o[1]>i.halfSize[1]?1:0)+9*($o[2]<-i.halfSize[2]?-1:$o[2]>i.halfSize[2]?1:0)+13),s=Xz[n];if(s===0)return s;Fie(rS,i.quaternion),Z7(rS,rS,i.halfSize);const a=(o,l)=>{const c=Xz[n+l+1];return Z(o,((1&c)<<1)-1,(2&c)-1,((4&c)>>1)-1),Nl(o,o,rS),oe(o,i.center,o)};return t.length=0,va(t,a(HM,0)),va(t,a(Zz,1)),va(t,a($o,2)),va(t,a(Yz,3)),r(t),s===1||(t.length=0,va(t,HM),va(t,Yz),va(t,a($o,4)),va(t,a(Kz,5)),r(t),s===2||(t.length=0,va(t,HM),va(t,Kz),va(t,a($o,6)),va(t,Zz),r(t))),s}const Xz=(()=>{const i=new Int8Array(216);let e=0;const t=r=>{for(let n=0;n<r.length;n++)i[e+n]=r[n];e+=8};return t([3,0,6,2,3,1,5,4]),t([2,0,2,3,1,5,4,0]),t([3,1,0,2,3,7,5,4]),t([2,0,1,3,2,6,4,0]),t([1,0,1,3,2,0,0,0]),t([2,1,5,7,3,2,0,0]),t([3,2,0,1,3,7,6,4]),t([2,2,0,1,3,7,6,0]),t([3,3,0,1,5,7,6,2]),t([2,0,1,5,4,6,2,0]),t([1,0,1,5,4,0,0,0]),t([2,1,3,7,5,4,0,0]),t([1,0,2,6,4,0,0,0]),t([0,0,0,0,0,0,0,0]),t([1,1,3,7,5,0,0,0]),t([2,2,3,7,6,4,0,0]),t([1,2,3,7,6,0,0,0]),t([2,3,1,5,7,6,2,0]),t([3,4,0,1,5,7,6,2]),t([2,5,7,6,4,0,1,0]),t([3,5,0,1,3,7,6,4]),t([2,4,5,7,6,2,0,0]),t([1,4,5,7,6,0,0,0]),t([2,5,1,3,7,6,4,0]),t([3,6,0,2,3,7,5,4]),t([2,6,2,3,7,5,4,0]),t([3,7,6,2,3,1,5,4]),i})(),TJ=4;function zOe(i,e){let t=0;for(let r=0;r<TJ;r++){const n=Rse(i,e[r]);if(n>0)return-1;n===0&&(t|=1<<r)}return t}const rS=Or(),Qz=dse(),$o=R(),HM=R(),Zz=R(),Yz=R(),Kz=R();let BOe=class{constructor(e){this._objects=e}submit(e,t){this._objects.preSubmit(t),this._objects.visibleObjects.forAll(r=>r.renderable.material.submit(e,t,r))}queryShadowCasterDepthRange(e){return this._objects.visibleObjects.length?FOe(e,this._objects.visibleObjects):null}};function GOe(i){const e=sn().vec3f(P.POSITION);return i.normals&&e.vec2i16(P.NORMALCOMPRESSED,{glNormalized:!0}),i.textureCoordinates===Mm.Default?e.vec2f(P.UV0):i.textureCoordinates===Mm.Atlas&&(e.vec2f(P.UV0),e.vec4u16(P.UVREGION,{glNormalized:!0})),i.colors&&e.vec4u8(P.COLOR,{glNormalized:!0}),e.alignTo(4)}let HOe=class extends Jg{constructor(e,t){super(e,"int",AD.Draw,(r,n,s)=>r.setUniform1i(e,t(n,s)))}};var Jh;(function(i){i[i.Uniform=0]="Uniform",i[i.Varying=1]="Varying",i[i.COUNT=2]="COUNT"})(Jh||(Jh={}));const B4=429496.7296;function CJ(i,e){$I(i/B4*.5+.5,e)}function jOe(i,e){switch(e.componentData){case Jh.Varying:return qOe(i,e);case Jh.Uniform:return WOe(i);case Jh.COUNT:return;default:Pa(e.componentData)}}function qOe(i,e){const{vertex:t,fragment:r}=i;t.include(e_),t.uniforms.add(NP("componentColorTex",s=>s.componentParameters.texture.texture,e.hasWebGL2Context?il.None:il.Size)),i.attributes.add(P.COMPONENTINDEX,"float"),i.varyings.add("vExternalColorMixMode","mediump float"),i.varyings.add("vExternalColor","vec4");const n=e.output===k.ObjectAndLayerIdColor;n&&i.varyings.add("vObjectAndLayerIdColor","vec4"),i.include(jse),t.constants.add("elevationScale","float",2*B4),t.constants.add("stride","float",St("enable-feature:objectAndLayerId-rendering")?3:2),t.code.add(O`
  vec2 getComponentTextureCoordinates(float componentIndex, float typeOffset) {
    vec2 textureSize = ${Nx(e,"componentColorTex")};

    float index = componentIndex * stride + typeOffset;
    float coordX = mod(index, textureSize.x);
    float coordY = floor(index / textureSize.x);

    return vec2(coordX, coordY) + 0.5;
  }
  `),t.code.add(O`
  vec4 _readComponentColor() {
    vec2 textureCoordinates = getComponentTextureCoordinates(componentIndex, 0.0);

    return ${Ko(e,"componentColorTex","textureCoordinates","1.0 / componentColorTexSize")};
   }

   float readElevationOffset() {
    vec2 textureCoordinates = getComponentTextureCoordinates(componentIndex, 1.0);

    vec4 encodedElevation = ${Ko(e,"componentColorTex","textureCoordinates","1.0 / componentColorTexSize")};
    return (rgba2float(encodedElevation) - 0.5) * elevationScale;
  }

  ${n?O`
          void forwardObjectAndLayerIdColor() {
            vec2 textureCoordinates = getComponentTextureCoordinates(componentIndex, 2.0);

            vObjectAndLayerIdColor = ${Ko(e,"componentColorTex","textureCoordinates","1.0 / componentColorTexSize")};
          }`:O`void forwardObjectAndLayerIdColor() {}`}

  vec4 forwardExternalColor(out bool castShadows) {
    vec4 componentColor = _readComponentColor() * 255.0;

    float shadowFlag = mod(componentColor.b * 255.0, 2.0);
    componentColor.b -= shadowFlag;
    castShadows = shadowFlag >= 1.0;

    int decodedColorMixMode;
    vExternalColor = decodeSymbolColor(componentColor, decodedColorMixMode) * 0.003921568627451; // = 1/255;
    vExternalColorMixMode = float(decodedColorMixMode) + 0.5; // add 0.5 to avoid interpolation artifacts

    return vExternalColor;
  }
`),r.code.add(O`
  void readExternalColor(out vec4 externalColor, out int externalColorMixMode) {
    externalColor = vExternalColor;
    externalColorMixMode = int(vExternalColorMixMode);
  }

  void outputObjectAndLayerIdColor() {
     ${n?O`gl_FragColor = vObjectAndLayerIdColor;`:""}
  }
`)}function WOe(i){const{vertex:e,fragment:t}=i;e.uniforms.add(new mP("externalColor",r=>r.componentParameters.externalColor)),t.uniforms.add(new HOe("externalColorMixMode",r=>r.componentParameters.externalColorMixMode)),i.varyings.add("vExternalColor","vec4"),e.code.add(O`float readElevationOffset() {
return 0.0;
}
void forwardObjectAndLayerIdColor() {
}
vec4 forwardExternalColor(out bool castShadows) {
vExternalColor = externalColor;
castShadows = true;
return externalColor;
}`),t.code.add(O`void readExternalColor(out vec4 color, out int colorMixMode) {
color = vExternalColor;
colorMixMode = externalColorMixMode;
}
void outputObjectAndLayerIdColor() {
gl_FragColor = vec4(1.0,0.0,0.0,0.0);
}`)}var $l;function XOe(i,e){const t=i.vertex;switch(t.code.add(O`#define VERTEX_DISCARD_CUTOFF (1.0 - 1.0 / 255.0)`),e.vertexDiscardMode){case $l.None:t.code.add(O`#define vertexDiscardByOpacity(_opacity_) {}`);break;case $l.Opaque:t.code.add(O`#define vertexDiscardByOpacity(_opacity_) { if (_opacity_ >  VERTEX_DISCARD_CUTOFF) {  gl_Position = vec4(1e38, 1e38, 1e38, 1.0); return; } }`);break;case $l.Transparent:t.code.add(O`#define vertexDiscardByOpacity(_opacity_) { if (_opacity_ <= VERTEX_DISCARD_CUTOFF) {  gl_Position = vec4(1e38, 1e38, 1e38, 1.0); return; } }`)}}(function(i){i[i.None=0]="None",i[i.Transparent=1]="Transparent",i[i.Opaque=2]="Opaque",i[i.COUNT=3]="COUNT"})($l||($l={}));var eu;function $7e(i){return i&&Rx(i)?eu.Mars:i&&Ax(i)?eu.Moon:eu.Earth}(function(i){i[i.Earth=1]="Earth",i[i.Mars=2]="Mars",i[i.Moon=3]="Moon",i[i.COUNT=4]="COUNT"})(eu||(eu={}));var qo;(function(i){i[i.None=0]="None",i[i.NoOverlay=1]="NoOverlay",i[i.ColorOverlay=2]="ColorOverlay",i[i.ColorOverlayWithWater=3]="ColorOverlayWithWater",i[i.COUNT=4]="COUNT"})(qo||(qo={}));let gt=class extends $a{constructor(){super(...arguments),this.output=k.Color,this.textureCoordinateType=Mm.None,this.componentData=Jh.Uniform,this.cullFace=tn.Back,this.vertexDiscardMode=$l.None,this.doubleSidedMode=ho.WindingOrder,this.alphaDiscardMode=Ho.Opaque,this.integratedMeshMode=qo.None,this.transparencyPassType=Ht.NONE,this.ellipsoidMode=eu.Earth,this.pbrMode=zr.Disabled,this.normalType=Il.Attribute,this.spherical=!1,this.doublePrecisionRequiresObfuscation=!1,this.hasVertexColors=!1,this.hasNormals=!1,this.hasSlicePlane=!1,this.hasBaseColorTexture=!1,this.receiveAmbientOcclusion=!0,this.receiveShadows=!0,this.blendingEnabled=!0,this.hasScreenSpaceReflections=!1,this.hasPolygonOffset=!1,this.hasMetallicRoughnessTexture=!1,this.hasEmissionTexture=!1,this.hasOcclusionTexture=!1,this.hasNormalTexture=!1,this.hasOccludees=!1,this.hasMultipassTerrain=!1,this.cullAboveGround=!1,this.useLegacyTerrainShading=!1,this.hasCloudsReflections=!0,this.snowCover=!1,this.objectAndLayerIdColor=!1,this.hasWebGL2Context=!1}};h([N({count:k.COUNT})],gt.prototype,"output",void 0),h([N({count:Mm.COUNT})],gt.prototype,"textureCoordinateType",void 0),h([N({count:Jh.COUNT})],gt.prototype,"componentData",void 0),h([N({count:tn.COUNT})],gt.prototype,"cullFace",void 0),h([N({count:$l.COUNT})],gt.prototype,"vertexDiscardMode",void 0),h([N({count:ho.COUNT})],gt.prototype,"doubleSidedMode",void 0),h([N({count:Ho.COUNT})],gt.prototype,"alphaDiscardMode",void 0),h([N({count:qo.COUNT})],gt.prototype,"integratedMeshMode",void 0),h([N({count:Ht.COUNT})],gt.prototype,"transparencyPassType",void 0),h([N({count:eu.COUNT})],gt.prototype,"ellipsoidMode",void 0),h([N({count:zr.COUNT})],gt.prototype,"pbrMode",void 0),h([N({count:Il.COUNT})],gt.prototype,"normalType",void 0),h([N()],gt.prototype,"spherical",void 0),h([N()],gt.prototype,"doublePrecisionRequiresObfuscation",void 0),h([N()],gt.prototype,"hasVertexColors",void 0),h([N()],gt.prototype,"hasNormals",void 0),h([N()],gt.prototype,"hasSlicePlane",void 0),h([N()],gt.prototype,"hasBaseColorTexture",void 0),h([N()],gt.prototype,"receiveAmbientOcclusion",void 0),h([N()],gt.prototype,"receiveShadows",void 0),h([N()],gt.prototype,"blendingEnabled",void 0),h([N()],gt.prototype,"hasScreenSpaceReflections",void 0),h([N()],gt.prototype,"hasPolygonOffset",void 0),h([N()],gt.prototype,"hasMetallicRoughnessTexture",void 0),h([N()],gt.prototype,"hasEmissionTexture",void 0),h([N()],gt.prototype,"hasOcclusionTexture",void 0),h([N()],gt.prototype,"hasNormalTexture",void 0),h([N()],gt.prototype,"hasOccludees",void 0),h([N()],gt.prototype,"hasMultipassTerrain",void 0),h([N()],gt.prototype,"cullAboveGround",void 0),h([N()],gt.prototype,"useLegacyTerrainShading",void 0),h([N()],gt.prototype,"hasCloudsReflections",void 0),h([N()],gt.prototype,"snowCover",void 0),h([N()],gt.prototype,"objectAndLayerIdColor",void 0),h([N()],gt.prototype,"hasWebGL2Context",void 0),h([N({constValue:AD.Draw})],gt.prototype,"pbrTextureBindType",void 0),h([N({constValue:!0})],gt.prototype,"hasSliceHighlight",void 0),h([N({constValue:!1})],gt.prototype,"hasSliceInVertexProgram",void 0),h([N({constValue:!1})],gt.prototype,"useCustomDTRExponentForWater",void 0),h([N({constValue:!1})],gt.prototype,"hasVertexTangents",void 0),h([N({constValue:!0})],gt.prototype,"supportsTextureAtlas",void 0),h([N({constValue:!1})],gt.prototype,"highStepCount",void 0),h([N({constValue:!1})],gt.prototype,"instancedDoublePrecision",void 0),h([N({constValue:!0})],gt.prototype,"useFillLights",void 0),h([N({constValue:!1})],gt.prototype,"objectAndLayerIdColorInstanced",void 0);function Jz(i,e){i.include(pH,e),i.fragment.include(qse);const t=i.fragment;t.uniforms.add(new mP("baseColor",r=>r.baseColor)),t.uniforms.add(new C0("objectOpacity",r=>r.objectOpacity)),e.hasVertexColors?t.code.add(O`vec3 _baseColor() {
return baseColor.rgb * vColor.rgb;
}
float _baseOpacity() {
return baseColor.a * vColor.a;
}`):t.code.add(O`vec3 _baseColor() {
return baseColor.rgb;
}
float _baseOpacity() {
return baseColor.a;
}`),t.code.add(O`vec4 computeMaterialColor(vec4 textureColor, vec4 externalColor, int externalColorMixMode) {
vec3 baseColor = _baseColor();
float baseOpacity = _baseOpacity();
vec3 color = mixExternalColor(
baseColor,
textureColor.rgb,
externalColor.rgb,
externalColorMixMode
);
float opacity = objectOpacity * mixExternalOpacity(
baseOpacity,
textureColor.a,
externalColor.a,
externalColorMixMode
);
return vec4(color, opacity);
}`)}function eB(i,e){const t=i.fragment;switch(e.doubleSidedMode){case ho.None:t.code.add(O`vec3 _adjustDoublesided(vec3 normal) {
return normal;
}`);break;case ho.View:i.include(vS,e),t.code.add(O`vec3 _adjustDoublesided(vec3 normal) {
return dot(normal, vPositionWorldCameraRelative) > 0.0 ? -normal : normal;
}`);break;case ho.WindingOrder:t.code.add(O`vec3 _adjustDoublesided(vec3 normal) {
return gl_FrontFacing ? normal : -normal;
}`);break;default:Pa(e.doubleSidedMode);case ho.COUNT:}switch(e.normalType){case Il.Attribute:case Il.CompressedAttribute:i.include(aH,e),t.code.add(O`vec3 shadingNormalWorld() {
return _adjustDoublesided(normalize(vNormalWorld));
}
vec3 shadingNormal_view() {
vec3 normal = normalize(vNormalView);
return gl_FrontFacing ? normal : -normal;
}`);break;case Il.ScreenDerivative:i.extensions.add("GL_OES_standard_derivatives"),i.include(vS,e),t.code.add(O`vec3 shadingNormalWorld() {
return normalize(cross(
dFdx(vPositionWorldCameraRelative),
dFdy(vPositionWorldCameraRelative)
));
}
vec3 shadingNormal_view() {
return normalize(cross(dFdx(vPosition_view),dFdy(vPosition_view)));
}`);break;case Il.Ground:e.spherical?(i.include(vS,e),t.code.add(O`vec3 shadingNormalWorld() {
return normalize(positionWorld());
}`)):t.code.add(O`vec3 shadingNormalWorld() {
return vec3(0.0, 0.0, 1.0);
}`),i.extensions.add("GL_OES_standard_derivatives"),t.code.add(O`vec3 shadingNormal_view() {
return normalize(cross(dFdx(vPosition_view),dFdy(vPosition_view))).xyz;
}`);break;default:Pa(e.normalType);case Il.COUNT:}}function QOe(i,e){const t=i.fragment;if(e.hasBaseColorTexture&&(e.output===k.Color||e.alphaDiscardMode!==Ho.Opaque)){i.include(Nre,e);const r=e.textureCoordinateType===Mm.Atlas;t.uniforms.add(NP("baseColorTexture",n=>n.texture,r?e.hasWebGL2Context?il.None:il.Size:il.None)),r?(i.include(kre),t.code.add(O`
        vec4 readBaseColorTexture() {
          vec2 textureSize = ${Nx(e,"baseColorTexture")};
          return textureAtlasLookup(baseColorTexture, textureSize, vuv0, vuvRegion);
        }
      `)):t.code.add(O`vec4 readBaseColorTexture() {
return texture2D(baseColorTexture, vuv0);
}`)}else t.code.add(O`vec4 readBaseColorTexture() { return vec4(1.0); }`)}function ZOe(i){const e=new Yi;e.include(vS,i),e.include(aH,i),e.include(pH,i),e.include(AP,i),e.include(DG,i),e.include(jOe,i),e.include(Wse,i),e.include(xae,i),e.include(QOe,i),e.include(XOe,i);const{vertex:t,fragment:r}=e;i.pbrMode!==zr.Normal&&i.pbrMode!==zr.Schematic||(e.include(Vre,i),i.hasNormalTexture&&e.include(Sae,i));const n=i.output===k.Shadow||i.output===k.ShadowHighlight||i.output===k.ShadowExludeHighlight;n&&i.componentData===Jh.Varying?t.code.add(O`#define discardShadows(castShadows) { if(!castShadows) { gl_Position = vec4(1e38, 1e38, 1e38, 1.0); return; } }`):t.code.add(O`#define discardShadows(castShadows) {}`);const s=i.integratedMeshMode===qo.ColorOverlay||i.integratedMeshMode===qo.ColorOverlayWithWater,a=s&&i.output===k.Color&&i.pbrMode===zr.WaterOnIntegratedMesh;return s&&(e.include(NE,i),e.include(uAe,i),i.spherical?t.code.add(O`
      const float invEllipsoidRadius = ${O.float(1/(i.ellipsoidMode===eu.Earth?lo.radius:i.ellipsoidMode===eu.Mars?Ore.radius:Mre.radius))};
      vec2 projectOverlay(vec3 pos) {
        return pos.xy / (1.0 + invEllipsoidRadius * pos.z);
      }
      `):t.code.add(O`vec2 projectOverlay(vec3 pos) { return pos.xy; }`)),a&&(e.varyings.add("tbnTangent","vec3"),e.varyings.add("tbnBiTangent","vec3"),e.varyings.add("groundNormal","vec3")),t.code.add(O`
    void main() {
      bool castShadows;
      vec4 externalColor = forwardExternalColor(castShadows);
      discardShadows(castShadows);

      vertexDiscardByOpacity(externalColor.a);

      if (externalColor.a < ${O.float(Eae)}) {
        // Discard this vertex
        gl_Position = vec4(1e38, 1e38, 1e38, 1.0);
        return;
      }

      forwardPosition(readElevationOffset());
      forwardNormal();
      forwardTextureCoordinates();
      forwardVertexColor();
      forwardLinearDepth();
      ${i.output===k.ObjectAndLayerIdColor?O`forwardObjectAndLayerIdColor();`:""}
      ${a?i.spherical?O`
                groundNormal = normalize(positionWorld());
                tbnTangent = normalize(cross(vec3(0.0, 0.0, 1.0), groundNormal));
                tbnBiTangent = normalize(cross(groundNormal, tbnTangent));`:O`
                groundNormal = vec3(0.0, 0.0, 1.0);
                tbnTangent = vec3(1.0, 0.0, 0.0);
                tbnBiTangent = vec3(0.0, 1.0, 0.0);`:""}
      ${s?O`setOverlayVTC(projectOverlay(position));`:""}
    }
  `),i.output===k.Alpha&&(r.include(Og),e.include(AI,i),e.include(Jz,i),s&&r.uniforms.add(new Bt("ovColorTex",(o,l)=>T$(o,l))),r.code.add(O`
      void main() {
        discardBySlice(vPositionWorldCameraRelative);
        ${i.hasMultipassTerrain?O`terrainDepthTest(gl_FragCoord, vPosition_view.z);`:""}

        vec4 textureColor = readBaseColorTexture();
        discardOrAdjustAlpha(textureColor);

        vec4 externalColor;
        int externalColorMixMode;
        readExternalColor(externalColor, externalColorMixMode);

        vec4 materialColor = computeMaterialColor(
          textureColor,
          externalColor,
          externalColorMixMode
        );
        ${s?O`
                vec4 overlayColor = getOverlayColor(ovColorTex, vtcOverlay);
                materialColor = materialColor * (1.0 - overlayColor.a) + overlayColor;`:""}

        gl_FragColor = vec4(materialColor.a);
      }
    `)),i.output===k.Color&&(r.include(Og),e.include(AI,i),e.include(Jz,i),e.include(eB,i),e.include(NE,i),i.receiveShadows?(e.include(yG,i),r.code.add(O`float evaluateShadow() {
return readShadowMap(vPositionWorldCameraRelative, linearDepth);
}`)):r.code.add(O`float evaluateShadow() { return 0.0; }`),s&&r.uniforms.add(new Bt("ovColorTex",(o,l)=>T$(o,l))),r.code.add(O`
      void main() {
        discardBySlice(vPositionWorldCameraRelative);
        ${i.hasMultipassTerrain?O`terrainDepthTest(gl_FragCoord, vPosition_view.z);`:""}

        vec4 textureColor = readBaseColorTexture();
        discardOrAdjustAlpha(textureColor);

        vec4 externalColor;
        int externalColorMixMode;
        readExternalColor(externalColor, externalColorMixMode);

        vec4 materialColor = computeMaterialColor(
          textureColor,
          externalColor,
          externalColorMixMode
        );
        ${s?O`vec4 overlayColor = getOverlayColor(ovColorTex, vtcOverlay);`:""}
    `),i.pbrMode===zr.Normal||i.pbrMode===zr.Schematic?(SD(r),r.code.add(O`
        ${i.pbrMode===zr.Normal?O`
                applyPBRFactors();
                if (int(externalColorMixMode) == 3) {
                  mrr = vec3(0.0, 0.6, 0.2);
                }`:""}
        vec3 normalVertex = shadingNormalWorld();
        float additionalIrradiance = 0.02 * mainLightIntensity[2];
      `),i.hasNormalTexture?r.code.add(O`mat3 tangentSpace = computeTangentSpace(normalVertex, vPositionWorldCameraRelative, vuv0);
vec3 shadingNormal = computeTextureNormal(tangentSpace, vuv0);`):r.code.add(O`vec3 shadingNormal = normalVertex;`),r.code.add(O`${i.spherical?O`vec3 normalGround = normalize(positionWorld());`:O`vec3 normalGround = vec3(0.0, 0.0, 1.0);`}
      `),r.code.add(O`
        vec3 viewDir = normalize(vPositionWorldCameraRelative);
        float ssao = 1.0 - occlusion * (1.0 - evaluateAmbientOcclusion());

        ${i.snowCover?O`
                vec3 surfaceNormal = normalize(shadingNormalWorld());
                float snow = smoothstep(0.5, 0.55, dot(surfaceNormal, normalize(positionWorld())));
                materialColor.rgb = mix(materialColor.rgb, vec3(1), snow);

                shadingNormal = mix(shadingNormal, surfaceNormal, snow);
                ssao = mix(ssao, 0.0, snow);
                mrr = mix(mrr, vec3(0.0, 1.0, 0.04), snow);
                emission = mix(emission, vec3(0.0), snow);`:""}

        ${s?O` materialColor = materialColor * (1.0 - overlayColor.a) + overlayColor;`:""}

        vec3 additionalLight = evaluateAdditionalLighting(ssao, positionWorld());
        vec4 shadedColor = vec4(evaluateSceneLightingPBR(shadingNormal, materialColor.rgb, evaluateShadow(), ssao, additionalLight, viewDir, normalGround, mrr, emission, additionalIrradiance), materialColor.a);
        `)):(i.receiveShadows?r.code.add(O`float shadow = evaluateShadow();`):i.spherical?(CG(r),r.code.add(O`float additionalAmbientScale = additionalDirectedAmbientLight(positionWorld());
float shadow = lightingGlobalFactor * (1.0 - additionalAmbientScale);`)):r.code.add(O`float shadow = 0.0;`),a&&r.uniforms.add(new Bt("ovNormalTex",(o,l)=>G4(l))),i.snowCover&&(e.extensions.add("GL_OES_standard_derivatives"),r.code.add(O`vec3 surfaceNormal = normalize(cross(dFdx(vPositionWorldCameraRelative), dFdy(vPositionWorldCameraRelative)));
float snow = smoothstep(0.5, 0.55, dot(surfaceNormal, normalize(positionWorld())));
materialColor.rgb = mix(materialColor.rgb, vec3(1), snow);`)),r.code.add(O`
        float ambientOcclusion = evaluateAmbientOcclusion();
        vec3 additionalLight = evaluateAdditionalLighting(ambientOcclusion, positionWorld());

        ${s?O` materialColor = materialColor * (1.0 - overlayColor.a) + overlayColor;`:""}

        vec4 shadedColor = vec4(evaluateSceneLighting(shadingNormalWorld(), materialColor.rgb, shadow, ambientOcclusion, additionalLight), materialColor.a);
      ${a?O`
              vec4 overlayWaterMask = getOverlayColor(ovNormalTex, vtcOverlay);
              float waterNormalLength = length(overlayWaterMask);
              if (waterNormalLength > 0.95) {
                mat3 tbnMatrix = mat3(tbnTangent, tbnBiTangent, groundNormal);
                vec4 waterColorLinear = getOverlayWaterColor(overlayWaterMask, overlayColor, -normalize(vPositionWorldCameraRelative), shadow, groundNormal, tbnMatrix, vPosition_view, positionWorld());
                vec4 waterColorNonLinear = delinearizeGamma(vec4(waterColorLinear.xyz, 1.0));
                // un-gamma the ground color to mix in linear space
                shadedColor = mix(shadedColor, waterColorNonLinear, waterColorLinear.w);
              }`:""}
      `)),r.code.add(O`
        gl_FragColor = highlightSlice(shadedColor, vPositionWorldCameraRelative);
        ${i.transparencyPassType===Ht.Color?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""}
      }
    `)),(i.output===k.Depth||n)&&(e.include(LI,i),r.code.add(O`void main() {
discardBySlice(vPositionWorldCameraRelative);
vec4 textureColor = readBaseColorTexture();
discardOrAdjustAlpha(textureColor);
outputDepth(linearDepth);
}`)),i.output===k.Normal&&(e.include(eB,i),r.code.add(O`
      void main() {
        discardBySlice(vPositionWorldCameraRelative);

        vec4 textureColor = readBaseColorTexture();
        discardOrAdjustAlpha(textureColor);

        // note: the alpha component needs to be 1.0 in order for this material
        // to influence ambient occlusion, see the ssao fragment shader
        float alpha = ${i.normalType===Il.Ground?"0.0":"1.0"};
        gl_FragColor = vec4(vec3(.5) + .5 * shadingNormal_view(), alpha);
      }
    `)),i.output===k.ObjectAndLayerIdColor&&e.fragment.code.add(O`void main() {
discardBySlice(vPositionWorldCameraRelative);
vec4 textureColor = readBaseColorTexture();
discardOrAdjustAlpha(textureColor);
outputObjectAndLayerIdColor();
}`),i.output===k.Highlight&&(e.include(hH,i),r.code.add(O`
      void main() {
        discardBySlice(vPositionWorldCameraRelative);

        vec4 textureColor = readBaseColorTexture();
        discardOrAdjustAlpha(textureColor);

        ${s?O`
                vec4 overlayColor = getCombinedOverlayColor();
                if (overlayColor.a == 0.0) {
                  gl_FragColor = vec4(0.0);
                  return;
                }`:""}

        outputHighlight();
      }
    `)),e}function G4(i){return i.overlays.length===0?null:i.overlays[ki.INNER].getValidTexture(er.Water)}const YOe=Object.freeze(Object.defineProperty({__proto__:null,build:ZOe,getOverlayNormalTexture:G4},Symbol.toStringTag,{value:"Module"}));let SJ=class EJ extends ti{initializeConfiguration(e,t){t.hasWebGL2Context=e.rctx.type===Nn.WEBGL2,t.spherical=e.viewingMode===Se.Global,t.doublePrecisionRequiresObfuscation=IP(e.rctx)}initializeProgram(e){return new Jt(e.rctx,EJ.shader.get().build(this.configuration),PJ)}_setPipelineState(e){const t=this.configuration,r=t.integratedMeshMode!==qo.None,n=e===Ht.NONE,s=e===Ht.FrontFace;return Ke({blending:t.output!==k.Color&&t.output!==k.Alpha||!t.blendingEnabled?null:n?Hl:jm(e),culling:OD(t.cullFace),depthTest:{func:i_(e)},depthWrite:n||s?nl:null,colorWrite:ht,stencilWrite:r||t.hasOccludees?Cd:null,stencilTest:r?Fne($b.IntegratedMeshMaskExcluded):t.hasOccludees?r_:null,polygonOffset:n||s?t.hasPolygonOffset?{factor:2,units:2}:null:$D})}initializePipeline(){return this._setPipelineState(this.configuration.transparencyPassType)}};SJ.shader=new ii(YOe,()=>G(()=>import("./ComponentShader.glsl-2877b174.js"),["assets/ComponentShader.glsl-2877b174.js","assets/Matrix3PassUniform-ad9f953b.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/mat3f64-c6305894.js","assets/mat4f64-1e28eae0.js","assets/vec3f32-c9aa289f.js","assets/vec3f64-2f9cef06.js","assets/VertexAttribute-9c5c630d.js","assets/mat4-44a0988f.js","assets/common-c186b691.js","assets/vec3-e93e648f.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/Texture2DPassUniform-753de459.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/mathUtils-b4bb77e2.js","assets/vec4-790471c0.js","assets/context-util-a4ce3a7b.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/aaBoundingBox-657a9b82.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/aaBoundingRect-193543b5.js","assets/basicInterfaces-19ed850e.js","assets/ViewingMode-5d7d590b.js","assets/Util-a48361c6.js","assets/vec4f64-e407da96.js","assets/symbolColorUtils-b2b55883.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/compilerUtils-18d58939.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/sphere-2af0d852.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));const PJ=new Map([[P.POSITION,0],[P.NORMAL,1],[P.NORMALCOMPRESSED,1],[P.COLOR,2],[P.UV0,3],[P.UVREGION,4],[P.COMPONENTINDEX,5]]);let KOe=class extends Ir{constructor(){super(...arguments),this._dirty=!0}_setDirty(){this._dirty=!0}_setClean(){if(this._dirty=!1,this._parameterBlocks!=null)for(const e of this._parameterBlocks)this[e]._setClean()}get dirty(){return this._dirty||this._checkParameterBlocksDirty()}_checkParameterBlocksDirty(){if(this._parameterBlocks==null)return!1;for(const e of this._parameterBlocks)if(this[e].dirty)return!0;return!1}},H4=class{constructor(){this._dirty=!0}_setDirty(){this._dirty=!0}_setClean(){this._dirty=!1}get dirty(){return this._dirty}};function Wi(i={}){return(e,t)=>{const r=e._parameterCount??0;if(e._parameterCount=r+1,i.vectorOps){const n=i.vectorOps;Object.defineProperty(e,t,{get(){return this[r]},set(s){const a=this[r];if(a==null)this[r]=s;else{if(n.equals(a,s))return;n.copy(a,s)}this._setDirty()}})}else Object.defineProperty(e,t,{get(){return this[r]},set(n){this[r]!==n&&(i.dispose&&this[r]&&this[r].dispose(),this[r]=n,this._setDirty())}})}}function tB(){return(i,e)=>{const t=i._parameterCount??0;i._parameterCount=t+1,i._parameterBlocks=i._parameterBlocks||[],i._parameterBlocks.push(t),Object.defineProperty(i,e,{get(){return this[t]},set(r){this[t]!==r&&(this[t]=r,this._setDirty())}})}}let GR=class{constructor(e){this._low=Xi(),this._high=Xi(),e&&this.set(e)}get low(){return this._low}get high(){return this._high}set(e){const t=this._low,r=this._high;q(t,e),tl(r,e,t)}setElements(e,t,r){Z(iB,e,t,r),this.set(iB)}get(e){return oe(e,this._low,this._high)}getLowScaled(e){return Q(e,this._low,1)}};const iB=R();let un=class extends KOe{constructor(e,t){super(),this.toMapSpace=t,this.baseColor=Z0(1,1,1,1),this.usePBR=!1,this.hasParametersFromSource=!1,this.mrrFactors=gi(1,1,.5),this.emissiveFactor=gi(0,0,0),this.baseColorTexture=null,this.metallicRoughnessTexture=null,this.emissionTexture=null,this.occlusionTexture=null,this.normalTexture=null,this.objectOpacity=1,this.commonMaterialParameters=new _E,this.componentParameters=new lw,this.textureAlphaCutoff=Pae,this.alphaDiscardMode=Ho.Opaque,this.isIntegratedMesh=!1,this.polygonOffsetEnabled=!1,this.ellipsoidMode=eu.Earth,this.hasOccludees=!1,this._techniqueConfiguration=new gt;const r=new GR(e.position),n=Nie(e.rotationScale);Zg(n,n),this.transformNormalGlobalFromModel=qc(n,n),this.transformWorldFromModelTL=r.low,this.transformWorldFromModelTH=r.high,this.transformWorldFromModelRS=e.rotationScale}dispose(){this._technique=Qi(this._technique),this.baseColorTexture=null,this.metallicRoughnessTexture=null,this.emissionTexture=null,this.occlusionTexture=null,this.normalTexture=null}get texture(){return y(this.baseColorTexture)?this.baseColorTexture.glTexture:null}get textureMetallicRoughness(){return y(this.metallicRoughnessTexture)?this.metallicRoughnessTexture.glTexture:null}get textureEmissive(){return y(this.emissionTexture)?this.emissionTexture.glTexture:null}get textureOcclusion(){return y(this.occlusionTexture)?this.occlusionTexture.glTexture:null}get textureNormal(){return y(this.normalTexture)?this.normalTexture.glTexture:null}prepareTechnique(e,t,r,n){const s=this._techniqueConfiguration;s.hasVertexColors=n.colors,s.hasNormals=n.normals,s.textureCoordinateType=n.textureCoordinates,s.hasMetallicRoughnessTexture=y(this.metallicRoughnessTexture),s.hasEmissionTexture=y(this.emissionTexture),s.hasOcclusionTexture=y(this.occlusionTexture),s.hasNormalTexture=y(this.normalTexture),s.transparencyPassType=t.identifier===Zo.Material&&r.transparencyPassType!=null?r.transparencyPassType:Ht.NONE,s.hasMultipassTerrain=t.identifier===Zo.Material&&r.multipassTerrain!=null&&r.multipassTerrain.enabled,s.cullAboveGround=t.identifier===Zo.Material&&r.multipassTerrain!=null&&r.multipassTerrain.cullAboveGround,s.ellipsoidMode=this.ellipsoidMode,s.componentData=this.componentParameters.type,s.cullFace=this.commonMaterialParameters.cullFace,s.doubleSidedMode=this.commonMaterialParameters.doubleSided?ho.View:ho.None,s.hasBaseColorTexture=y(this.baseColorTexture);const a=this._computeWhichMaterialPass();s.blendingEnabled=a===Gs.Transparent||a===Gs.OpaqueAndTransparent,s.alphaDiscardMode=this.alphaDiscardMode,s.integratedMeshMode=this.isIntegratedMesh?tMe(r)?G4(r)?qo.ColorOverlayWithWater:qo.ColorOverlay:qo.NoOverlay:qo.None,s.useLegacyTerrainShading=this.isIntegratedMesh&&jt.TERRAIN_USE_LEGACY_SHADING,s.hasPolygonOffset=this.polygonOffsetEnabled;const o=this.hasParametersFromSource&&S(this.baseColorTexture);return s.pbrMode=s.integratedMeshMode===qo.ColorOverlayWithWater?zr.WaterOnIntegratedMesh:this.usePBR?o?zr.Schematic:zr.Normal:zr.Disabled,s.normalType=s.integratedMeshMode===qo.None?s.hasNormals?Il.CompressedAttribute:Il.ScreenDerivative:Il.Ground,s.hasSlicePlane=y(r.slicePlane)&&this.commonMaterialParameters.hasSlicePlane,t.identifier===Zo.ShadowMap?(s.output=k.Shadow,s.vertexDiscardMode=$l.None):t.identifier===Zo.Highlight?(s.output=k.Highlight,s.vertexDiscardMode=$l.None):(this._computeWhichMaterialPass()===Gs.OpaqueAndTransparent?s.vertexDiscardMode=t.transparent?$l.Opaque:$l.Transparent:s.vertexDiscardMode=$l.None,s.output=JOe(t.subPass),t.subPass===yr.Alpha&&(s.hasOccludees=r.hasOccludees),t.subPass===yr.Color?(s.receiveAmbientOcclusion=r.ssaoHelper.ready,s.hasOccludees=r.hasOccludees,s.receiveShadows=r.shadowMap.ready,s.hasScreenSpaceReflections=r.ssr.enabled,s.hasCloudsReflections=y(r.cloudsFade.data)):(s.receiveAmbientOcclusion=!1,s.receiveShadows=!1),s.snowCover=this.hasSnowCover(r),t.subPass===yr.ObjectAndLayerIdColor&&(s.objectAndLayerIdColor=!0)),this._technique=e.releaseAndAcquire(SJ,s,this._technique),this._setClean(),this._technique}hasSnowCover(e){return y(e.weather)&&e.weatherVisible&&e.weather.type==="snowy"&&e.weather.snowCover==="enabled"}submit(e,t,r){if(this.objectOpacity===0)return;const n=r.renderable.geometry,s=r.components,a=r.renderable.meta.cameraDepthSquared,o=s.geometryRanges,l=s.highlightRanges,c=s.defaultShadowMapRanges;switch(this._computeWhichMaterialPass()){case Gs.Opaque:e.materialOpaque.submitDraw(this,n,o,a);break;case Gs.Transparent:e.materialTransparent.submitDraw(this,n,o,a);break;case Gs.OpaqueAndTransparent:e.materialOpaque.submitDraw(this,n,o,a),e.materialTransparent.submitDraw(this,n,o,a);break;case Gs.IntegratedMesh:e.materialIntegratedMesh.submitDraw(this,n,o,a),eMe(t)&&e.highlightIntegratedMesh.submitDraw(this,n,o,a)}const u=this.componentParameters.castShadows!==Yr.None;u&&e.shadowMap.submitDraw(this,n,o,a),y(l)&&(e.highlight.submitDraw(this,n,l,a),u&&e.highlightShadowMap.submitDraw(this,n,l,a)),u&&y(c)&&e.defaultShadowMap.submitDraw(this,n,c,a)}_computeWhichMaterialPass(){return this.isIntegratedMesh?Gs.IntegratedMesh:this.objectOpacity<1?Gs.Transparent:this.componentParameters.opaqueOverride===Yr.All?Gs.Opaque:this.baseColor[3]<1||this.alphaDiscardMode===Ho.Blend||this.alphaDiscardMode===Ho.MaskBlend?Gs.Transparent:this.componentParameters.transparent===Yr.None?Gs.Opaque:this.componentParameters.transparent===Yr.All?Gs.Transparent:Gs.OpaqueAndTransparent}};var Gs,Yr;h([Wi({vectorOps:gG})],un.prototype,"baseColor",void 0),h([Wi()],un.prototype,"usePBR",void 0),h([Wi()],un.prototype,"hasParametersFromSource",void 0),h([Wi({vectorOps:b5})],un.prototype,"mrrFactors",void 0),h([Wi({vectorOps:b5})],un.prototype,"emissiveFactor",void 0),h([Wi({dispose:!0})],un.prototype,"baseColorTexture",void 0),h([Wi({dispose:!0})],un.prototype,"metallicRoughnessTexture",void 0),h([Wi({dispose:!0})],un.prototype,"emissionTexture",void 0),h([Wi({dispose:!0})],un.prototype,"occlusionTexture",void 0),h([Wi({dispose:!0})],un.prototype,"normalTexture",void 0),h([Wi()],un.prototype,"objectOpacity",void 0),h([tB()],un.prototype,"commonMaterialParameters",void 0),h([tB()],un.prototype,"componentParameters",void 0),h([Wi()],un.prototype,"textureAlphaCutoff",void 0),h([Wi()],un.prototype,"alphaDiscardMode",void 0),h([Wi()],un.prototype,"isIntegratedMesh",void 0),h([Wi()],un.prototype,"polygonOffsetEnabled",void 0),h([Wi()],un.prototype,"ellipsoidMode",void 0),h([Wi()],un.prototype,"hasOccludees",void 0),function(i){i[i.Opaque=0]="Opaque",i[i.Transparent=1]="Transparent",i[i.OpaqueAndTransparent=2]="OpaqueAndTransparent",i[i.IntegratedMesh=3]="IntegratedMesh"}(Gs||(Gs={}));let _E=class extends H4{constructor(){super(...arguments),this.doubleSided=!1,this.cullFace=tn.Back,this.hasSlicePlane=!0}};h([Wi()],_E.prototype,"doubleSided",void 0),h([Wi()],_E.prototype,"cullFace",void 0),h([Wi()],_E.prototype,"hasSlicePlane",void 0);let lw=class extends H4{constructor(){super(...arguments),this.externalColor=Z0(1,1,1,1),this.externalColorMixMode=HE.Multiply,this.castShadows=Yr.All}get transparent(){return this.externalColor[3]<1?Yr.All:Yr.None}get opaqueOverride(){return this.externalColorMixMode===HE.Replace&&this.externalColor[3]===1?Yr.All:Yr.None}get visible(){return this.externalColor[3]>0?Yr.All:Yr.None}get type(){return Jh.Uniform}};h([Wi({vectorOps:gG})],lw.prototype,"externalColor",void 0),h([Wi()],lw.prototype,"externalColorMixMode",void 0),h([Wi()],lw.prototype,"castShadows",void 0),function(i){i[i.All=0]="All",i[i.Some=1]="Some",i[i.None=2]="None"}(Yr||(Yr={}));class vb extends H4{constructor(){super(...arguments),this.texture=null,this.transparent=Yr.None,this.opaqueOverride=Yr.None,this.castShadows=Yr.None}get type(){return Jh.Varying}}function JOe(i){switch(i){case yr.Color:return k.Color;case yr.Alpha:return k.Alpha;case yr.Depth:return k.Depth;case yr.Normal:return k.Normal;case yr.ObjectAndLayerIdColor:return k.ObjectAndLayerIdColor}}function eMe(i){return i.overlays.length!==0&&y(i.overlays[ki.INNER].getValidTexture(er.Highlight))}function tMe(i){return i.overlays.length!==0&&y(i.overlays[ki.INNER].getColorTextureNoRasterImage())}h([Wi()],vb.prototype,"texture",void 0),h([Wi()],vb.prototype,"transparent",void 0),h([Wi()],vb.prototype,"opaqueOverride",void 0),h([Wi()],vb.prototype,"castShadows",void 0);let iMe=class{constructor(e){this._maxCount=e,this._nextIndex=0,this._recycledIndices=[]}get activeCount(){return this._nextIndex-this._recycledIndices.length}get availableCount(){return this._recycledIndices.length+this._maxCount-this._nextIndex}acquire(){return this._recycledIndices.length>0?this._recycledIndices.pop():this.availableCount?this._nextIndex++:void 0}release(e){this._recycledIndices.push(e)}},rMe=class{constructor(e,t=1){this._rctx=e,this._fieldCount=t,this.textureWidth=4096,this._dirty=!0,this._texture=new Gi(this._rctx,{target:vi.TEXTURE_2D,pixelFormat:yt.RGBA,dataType:qt.UNSIGNED_BYTE,samplingMode:Kt.NEAREST,wrapMode:si.CLAMP_TO_EDGE,width:this.textureWidth,height:1,flipped:!1}),this._data=new Lm(new ArrayBuffer(4*this.textureWidth))}dispose(){this._texture.dispose(),this._texture=void 0,this._data=void 0}setData(e,t,r,n,s,a){const o=e*this._fieldCount+t;this._dirty=!0,this._data.set(o,0,r),this._data.set(o,1,n),this._data.set(o,2,s),this._data.set(o,3,a)}setDataElement(e,t,r,n){const s=e*this._fieldCount+t;this._dirty=!0,this._data.set(s,r,n)}resizeToFit(e){const t=e*this._fieldCount;if(t>=this._data.count){const r=Math.ceil((t+1)/this.textureWidth)*this.textureWidth,n=new Lm(new ArrayBuffer(4*r));n.typedBuffer.set(this._data.typedBuffer),this._data=n}}updateTexture(){if(!this._dirty)return;const e=this._texture.descriptor.width,t=this._texture.descriptor.height;this._data.count>e*t&&this._texture.resize(e,this._data.count/e),this._texture.setData(this._data.typedBuffer),this._dirty=!1}get texture(){return this._texture}};const RJ=65536;let nMe=class{constructor(e,t=1){this.textureBuffer=new rMe(e,t),this._indexManager=new iMe(RJ)}dispose(){this.textureBuffer.dispose(),this.textureBuffer=void 0}get availableCount(){return this._indexManager.availableCount}get activeCount(){return this._indexManager.activeCount}acquireIndex(){const e=this._indexManager.acquire();return this.textureBuffer.resizeToFit(e),e}releaseIndex(e){this._indexManager.release(e)}},AJ=class{constructor(e,t=1){this._rctx=e,this._fieldCount=t,this._buffers=[]}garbageCollect(){this._buffers=this._buffers.filter(e=>e.activeCount!==0||(e.dispose(),!1))}destroy(){this._buffers.forEach(e=>e.dispose()),this._buffers=[]}getBuffer(e){for(const r of this._buffers)if(r.availableCount>=e)return r;if(e>RJ)return null;const t=new nMe(this._rctx,this._fieldCount);return this._buffers.push(t),t}updateTextures(){for(const e of this._buffers)e.textureBuffer.updateTexture()}};const rB=J.getLogger("esri.views.3d.webgl-engine.collections.Component.ComponentObjectCollection");class sMe{constructor(e,t){this._renderManager=e,this._viewingMode=t,this._objects=[new Zt,new Zt],this._renderSubmit=new BOe(this),this._renderManager.register(this._renderSubmit),this._hasObjectAndLayerId=St("enable-feature:objectAndLayerId-rendering"),this._componentBufferManager=new AJ(e.rctx,2+(this._hasObjectAndLayerId?1:0))}dispose(){it(this._objects[V0.Hidden].length===0&&this._objects[V0.Visible].length===0,"ObjectCollection should be empty upon disposal"),this._componentBufferManager.destroy()}createObject(e){const t=new E$;return t.toMapSpace=e.toMapSpace,t.transform=e.transform,t.obb=Q5(e.obb),t.components=new COe(this._componentBufferManager,e.geometry.componentOffsets),t.renderable=this._createRenderable(e,t.components),t.intersectionGeometry=new MOe(e.geometry.positionData,t.components),this._objects[t.visible].push(t),t}destroyObject(e){const t=e;this._objects[t.visible].removeUnordered(t),t.dispose(),this._notifyDirty()}setObjectVisibility(e,t){const r=e;t!==r.visible&&(this._objects[r.visible].removeUnordered(r),this._objects[t].push(r),r.visible=t,this._notifyDirty())}preSubmit(e){const t=e.camera.eye;this.visibleObjects.forAll(r=>r.renderable.meta.cameraDepthSquared=Bl(t,r.obb.center))}getMaterial(e){return e.renderable.material}updateMaterial(e,t){const r=e.renderable.material;t(r),r.dirty&&this._notifyDirty()}setAllComponentVisibilities(e,t){const r=e;r.components.visibility.reset(t),r.components.visibilityDirty(),this._notifyDirty()}forEachVisibleComponent(e,t){return e.components.visibility.forEachComponent(t)}getComponentCount(e){const t=e,r=t.components.visibility.componentCount();return{visible:r,invisible:t.components.count-r}}setComponentData(e,t){const r=e,n=r.renderable.material,s=r.components,a=s.materialDataBuffer,o=s.materialDataIndices,l={castShadows:!0,pickable:!0,externalColor:ek(),externalColorMixMode:HE.Multiply,elevationOffset:0,objectAndLayerIdColor:this._hasObjectAndLayerId?ek():null},c=a.textureBuffer,u=new Uint8Array(4),d=new Uint32Array(u.buffer);let m=0,f=0,_=0,g=s.verticalOffsets,x=1/0,b=-1/0,v=!1,w=!1,T=0;for(let E=0;E<s.count;E++){if(t(E,l),m+=+(l.externalColor[3]<1),f+=+(l.externalColorMixMode===HE.Replace&&l.externalColor[3]===1),_+=+l.castShadows,lH(l.externalColor,l.externalColorMixMode,u),u[2]=254&u[2]|+l.castShadows,c.setData(o[E],0,u[0],u[1],u[2],u[3]),v||(v=E>0&&T!==d[0]),T=d[0],w||(w=l.elevationOffset!==0),w&&S(g)&&(g=new Array(E).fill(0)),y(g)&&(g[E]=l.elevationOffset),x=Math.min(x,l.elevationOffset),b=Math.max(b,l.elevationOffset),CJ(l.elevationOffset,u),c.setData(o[E],1,u[0],u[1],u[2],u[3]),this._hasObjectAndLayerId){const C=l.objectAndLayerIdColor;c.setData(o[E],2,C[0],C[1],C[2],C[3])}l.pickable!==bJ(s.pickability,E)&&(s.pickability=EOe(s.pickability,s.count,E,l.pickable))}s.verticalOffsets=w?g:null,r.offsetObb=w?Ase(r.obb,x,b,this._viewingMode,y(r.offsetObb)?r.offsetObb:Q5(r.obb)):null,v||w||this._hasObjectAndLayerId?(n.componentParameters=new vb,n.componentParameters.castShadows=jM(_,s.count),n.componentParameters.transparent=jM(m,s.count),n.componentParameters.opaqueOverride=jM(f,s.count),n.componentParameters.texture=c,c.updateTexture()):(n.componentParameters=new lw,n.componentParameters.castShadows=l.castShadows?Yr.All:Yr.None,n.componentParameters.externalColor=l.externalColor,n.componentParameters.externalColorMixMode=l.externalColorMixMode),this._notifyDirty()}getComponentAabb(e,t,r,n=!1){e.intersectionGeometry.getComponentAabb(t,r);const s=e,a=s.components.verticalOffsets;if(n||S(a))return r;const o=a[t];if(this._viewingMode===Se.Local||o===0)return r[2]+=o,r[5]+=o,r;const l=ct(Nne(o));return l.localOrigin=s.transform.position,l.applyToAabb(r)}getComponentObb(e){return e.obb}getObjectTransform(e){return e.transform}getComponentPositions(e,t,r){return e.intersectionGeometry.getComponentPositions(t,r)}intersect(e,t,r,n,s,a){const o=e;y(s)&&(s.localOrigin=o.transform.position);const l=Zg(nB,o.transform.rotationScale);tl(nS,t,o.transform.position),tl(sS,r,o.transform.position),Nl(nS,nS,l),Nl(sS,sS,l);const c=qc(nB,l);return o.intersectionGeometry.intersect(nS,sS,n,c,s,o.components.verticalOffsets,a)}addEdges(e,t,r,n){const s=e,{indices:a,positions:o}=s.intersectionGeometry,l=s.components.offsets;return t.addComponentObject(e,s.transform,{center:s.obb.center,radius:Ose(s.obb)},o,a,l,r,n)}async extractEdgeInformation(e,t,r){const n=e,s=n.components.visibility;if(s.allInvisible())return{buffer:Une.createBuffer(0),origin:[0,0,0]};const{indices:a,positions:o}=n.intersectionGeometry,l=n.components.offsets,c=OI.createBuffer(o.count);rH(c.position,o),GE(c.position,c.position,n.transform.rotationScale),this._setComponentIndices(c.componentIndex,a,l);const u=c.count,d=this._computeVisibilityIndices(a,s,l,u);return{origin:as(n.transform.position),buffer:await t.extractComponentsEdgeLocations({indices:d,indicesLength:d.length,skipDeduplicate:!0,data:c,writerSettings:{reducedPrecision:!1,variants:0}},r)}}_setComponentIndices(e,t,r){let n=0;for(let s=0;s<r.length-1;s++){const a=r[s],o=r[s+1];for(let l=a;l<o;l++){const c=t?t[l]:l;e.set(c,n)}n++}}_computeVisibilityIndices(e,t,r,n){if(e&&t.allVisible())return e;let s=0;t.forEachComponentRange((l,c)=>(s+=r[c]-r[l],!0));const a=Array.isArray(e)?new Array(s):(e==null?void 0:e.BYTES_PER_ELEMENT)===2||n<=65536?new Uint16Array(s):new Uint32Array(s);let o=0;return t.forEachComponentRange((l,c)=>{const u=r[l],d=r[c];for(let m=u;m<d;m++)a[o++]=e?e[m]:m;return!0}),a}addComponentHighlight(e,t){const r=e.components;S(r.highlightCounts)&&(r.highlightCounts=new Uint32Array(r.count+1)),r.highlightCounts[t]++===0&&(r.highlightsDirty(),this._notifyDirty()),r.highlightCounts[r.count]++}removeComponentHighlight(e,t){const r=e.components;if(S(r.highlightCounts))return void rB.warn("Removing non-existing highlight.");const n=r.highlightCounts[t],s=r.highlightCounts[r.count];if(n!==0){if(n>1)return r.highlightCounts[t]=n-1,void(r.highlightCounts[r.count]=s-1);r.highlightCounts[t]=0,r.highlightsDirty(),this._notifyDirty(),s===1?r.highlightCounts=null:r.highlightCounts[r.count]=s-1}else rB.warn("Removing non-existing highlight.")}clearHighlights(e){const t=e.components;y(t.highlightCounts)&&(t.highlightCounts=null,t.highlightsDirty(),this._notifyDirty())}getObjectGPUMemoryUsage(e){return e.renderable.meta.gpuMemoryEstimate}get visibleObjects(){return this._objects[V0.Visible]}_createRenderable(e,t){const r=this._renderManager.rctx,n=e.geometry,s=n.vertices.layoutParameters,a=hi.createVertex(r,di.STATIC_DRAW,n.vertices.data),o=co(n.indices,g=>hi.createIndex(r,di.STATIC_DRAW,g)),l=Wc(GOe(s)),c=new Uint16Array(n.vertices.count);for(let g=0;g<t.count;g++){const x=t.offsets[g],b=t.offsets[g+1],v=t.materialDataIndices[g];if(y(n.indices))for(let w=x;w<b;w++)c[n.indices[w]]=v;else for(let w=x;w<b;w++)c[w]=v}const u=hi.createVertex(r,di.STATIC_DRAW,c.buffer),d=new un(e.transform,e.toMapSpace),m=new Gc(r,PJ,{data:l,componentIndices:aMe},{data:a,componentIndices:u},ct(o)),f=new xJ(m,Dt.TRIANGLES,s,y(o)),_={cameraDepthSquared:.5,gpuMemoryEstimate:a.byteSize+u.byteSize+(y(o)?o.byteSize:0)};return new $Oe(d,f,_)}_notifyDirty(){this._renderManager.notifyDirty()}}const aMe=Wc(sn().u16(P.COMPONENTINDEX));function jM(i,e){return i===e?Yr.All:i===0?Yr.None:Yr.Some}const nB=cm(),nS=R(),sS=R();let OJ=class extends Ir{constructor(){super(...arguments),this.opacity=1}};function oMe(i){const e=new Yi;return e.include(Nd),e.fragment.uniforms.add(new Bt("tex",t=>t.texture)),i.hasOpacityFactor&&e.fragment.uniforms.add(new Tt("opacity",t=>t.opacity)),e.fragment.code.add(O`
    void main() {
      gl_FragColor = texture2D(tex, uv) ${i.hasOpacityFactor?"* opacity":""};
    }`),e}const lMe=Object.freeze(Object.defineProperty({__proto__:null,CompositingPassParameters:OJ,build:oMe},Symbol.toStringTag,{value:"Module"}));var Es;(function(i){i[i.None=0]="None",i[i.Alpha=1]="Alpha",i[i.PremultipliedAlpha=2]="PremultipliedAlpha",i[i.COUNT=3]="COUNT"})(Es||(Es={}));let R$=class extends $a{constructor(){super(...arguments),this.alphaMode=Es.None,this.hasOpacityFactor=!1}};h([N({count:Es.COUNT})],R$.prototype,"alphaMode",void 0),h([N()],R$.prototype,"hasOpacityFactor",void 0);let MJ=class IJ extends ti{initializeProgram(e){return new Jt(e.rctx,IJ.shader.get().build(this.configuration),ai)}initializePipeline(){switch(this.configuration.alphaMode){case Es.None:return Ke({colorWrite:ht});case Es.Alpha:return Ke({blending:Gn(de.SRC_ALPHA,de.ONE,de.ONE_MINUS_SRC_ALPHA,de.ONE_MINUS_SRC_ALPHA),colorWrite:ht});case Es.PremultipliedAlpha:case Es.COUNT:return Ke({blending:lu(de.ONE,de.ONE_MINUS_SRC_ALPHA),colorWrite:ht})}}};MJ.shader=new ii(lMe,()=>G(()=>import("./Compositing.glsl-e1762348.js"),["assets/Compositing.glsl-e1762348.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/VertexAttribute-9c5c630d.js","assets/vec2-528adfe4.js","assets/common-c186b691.js","assets/vec2f64-30dc1443.js","assets/Texture2DPassUniform-753de459.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));let LJ=class extends Ir{};function cMe(){const i=new Yi;return i.include(Nd),i.fragment.uniforms.add(new Bt("tex",e=>e.texture)),i.fragment.code.add(O`void main() {
gl_FragColor = vec4(1.0 - texture2D(tex, uv).a);
}`),i}const hMe=Object.freeze(Object.defineProperty({__proto__:null,HUDCompositingPassParameters:LJ,build:cMe},Symbol.toStringTag,{value:"Module"}));let $J=class DJ extends ti{initializeProgram(e){return new Jt(e.rctx,DJ.shader.get().build(),ai)}initializePipeline(){return Ke({colorWrite:{r:!1,g:!0,b:!1,a:!1}})}};$J.shader=new ii(hMe,()=>G(()=>import("./HUDCompositing.glsl-2e3ead7c.js"),["assets/HUDCompositing.glsl-2e3ead7c.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/VertexAttribute-9c5c630d.js","assets/vec2-528adfe4.js","assets/common-c186b691.js","assets/vec2f64-30dc1443.js","assets/Texture2DPassUniform-753de459.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));let FJ=class extends Ir{};function uMe(){const i=new Yi;return i.include(Nd),i.fragment.uniforms.add([new Bt("colorTexture",e=>e.colorTexture),new Bt("alphaTexture",e=>e.alphaTexture),new Bt("frontFaceTexture",e=>e.frontFaceTexture)]),i.fragment.code.add(O`void main() {
vec4 srcColor = texture2D(colorTexture, uv);
if(srcColor.a <= 1e-5){
discard;
}
float srcAlpha = texture2D(alphaTexture, uv).r;
vec4 frontFace = texture2D(frontFaceTexture, uv);
gl_FragColor = vec4(mix(srcColor.rgb/srcColor.a, frontFace.rgb, frontFace.a), 1.0 - srcAlpha);
}`),i}const dMe=Object.freeze(Object.defineProperty({__proto__:null,OITCompositingPassParameters:FJ,build:uMe},Symbol.toStringTag,{value:"Module"}));let NJ=class kJ extends ti{initializeProgram(e){return new Jt(e.rctx,kJ.shader.get().build(),ai)}initializePipeline(){return Ke({blending:Gn(de.SRC_ALPHA,de.ONE,de.ONE_MINUS_SRC_ALPHA,de.ONE_MINUS_SRC_ALPHA),colorWrite:ht})}};NJ.shader=new ii(dMe,()=>G(()=>import("./OITCompositing.glsl-c9864da2.js"),["assets/OITCompositing.glsl-c9864da2.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/VertexAttribute-9c5c630d.js","assets/vec2-528adfe4.js","assets/common-c186b691.js","assets/vec2f64-30dc1443.js","assets/Texture2DPassUniform-753de459.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));let VJ=class extends Ir{constructor(){super(...arguments),this.overlayIndex=ki.INNER,this.opacity=1}};function pMe(){const i=new Yi;return i.include(Nd),i.fragment.uniforms.add(new Bt("tex",e=>e.texture)),i.fragment.uniforms.add(new CD("overlayIdx",e=>e.overlayIndex)),i.fragment.uniforms.add(new Tt("opacity",e=>e.opacity)),i.fragment.code.add(O`void main() {
vec2 overlayUV = overlayIdx == 0 ? vec2(uv.x * 0.5, uv.y) : vec2(uv.x * 0.5 + 0.5, uv.y);
gl_FragColor = texture2D(tex, overlayUV) * opacity;
}`),i}const mMe=Object.freeze(Object.defineProperty({__proto__:null,OverlayCompositingPassParameters:VJ,build:pMe},Symbol.toStringTag,{value:"Module"}));let UJ=class zJ extends ti{initializeProgram(e){return new Jt(e.rctx,zJ.shader.get().build(),ai)}initializePipeline(){return Ke({blending:lu(de.ONE,de.ONE_MINUS_SRC_ALPHA),colorWrite:ht})}};UJ.shader=new ii(mMe,()=>G(()=>import("./OverlayCompositing.glsl-fcc2fd2b.js"),["assets/OverlayCompositing.glsl-fcc2fd2b.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/VertexAttribute-9c5c630d.js","assets/vec2-528adfe4.js","assets/common-c186b691.js","assets/vec2f64-30dc1443.js","assets/Texture2DPassUniform-753de459.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));let fMe=class{constructor(e,t){this._rctx=e,this._techniqueRepository=t,this._configuration=new R$,this._passParameters=new OJ,this._oitParameters=new FJ,this._hudParameters=new LJ,this._overlayParameters=new VJ}dispose(){this._vao=Me(this._vao)}compositeOIT(e,t,r,n){this._oitParameters.colorTexture=t,this._oitParameters.alphaTexture=r,this._oitParameters.frontFaceTexture=n;const s=this._rctx,a=this._techniqueRepository.acquire(NJ);s.bindTechnique(a,this._oitParameters,e);const o=this._ensureVAO();s.bindVAO(o),s.drawArrays(Dt.TRIANGLE_STRIP,0,Ws(o,"geometry")),a.release()}compositeHUD(e,t){this._hudParameters.texture=t;const r=this._rctx,n=this._techniqueRepository.acquire($J);r.bindTechnique(n,this._hudParameters,e);const s=this._ensureVAO();r.bindVAO(s),r.drawArrays(Dt.TRIANGLE_STRIP,0,Ws(s,"geometry")),n.release()}compositeOverlay(e,t,r,n){this._overlayParameters.texture=t,this._overlayParameters.opacity=r,this._overlayParameters.overlayIndex=n;const s=this._rctx,a=this._techniqueRepository.acquire(UJ);s.bindTechnique(a,this._overlayParameters,e);const o=this._ensureVAO();s.bindVAO(o),s.drawArrays(Dt.TRIANGLE_STRIP,0,Ws(o,"geometry")),a.release()}composite(e,t,r=Es.None,n=1){const s=this._rctx;this._configuration.alphaMode=r,this._configuration.hasOpacityFactor=n!==1,this._passParameters.texture=t,this._passParameters.opacity=n;const a=this._techniqueRepository.acquire(MJ,this._configuration);s.bindTechnique(a,this._passParameters,e);const o=this._ensureVAO();s.bindVAO(o),s.drawArrays(Dt.TRIANGLE_STRIP,0,Ws(o,"geometry")),a.release()}_ensureVAO(){return S(this._vao)&&(this._vao=La(this._rctx)),this._vao}};const gMe=1e4,A$=100,_Me=500,yMe=500,vMe=.1;function bMe(i,e,t){return uH(e,i)*(t[1]-t[0])+t[0]}function wMe(i,e,t){if(e.size<gMe)return AMe.compute(i,e);const r=eT();return t.forAll(n=>{n.isVisible&&dv(r,xMe(i,n))}),r}function xMe(i,e){if(!e.isVisible)return;const t=eT(),r=e.getSpatialQueryAccelerator();return y(r)?TMe(t,i,r):CMe(t,i,e.objects),t}function TMe(i,e,t){const r=e.eye,n=e.viewForward,s=e.frustum,a=l=>l.isVisible,o=t.objectCount;if(o<_Me)xx(wl,e.near,Math.min(i.near,e.far)),t.forEachInDepthRange(r,n,Mc.DepthOrder.FRONT_TO_BACK,wl,(l,c)=>{O$(i,e,l),wl.far=i.near,c.setRange(wl)},s,a),xx(wl,Math.max(i.far,e.near),e.far),t.forEachInDepthRange(r,n,Mc.DepthOrder.BACK_TO_FRONT,wl,(l,c)=>{O$(i,e,l),wl.near=i.far,c.setRange(wl)},s,a);else{const l=Math.max(Math.min(o,yMe),Math.ceil(o*vMe)),c=t.findClosest(n,Mc.DepthOrder.FRONT_TO_BACK,s,a,l),u=t.findClosest(n,Mc.DepthOrder.BACK_TO_FRONT,s,a,l);c&&u&&(sB(i,e,c.boundingVolumeWorldSpace.bounds),sB(i,e,u.boundingVolumeWorldSpace.bounds))}}function CMe(i,e,t){ay.clear(),t.forAll(r=>{r.isVisible&&r.geometryRecords.length!==0&&ay.add(r)}),ay.empty||(ay.sort(e),xx(wl,e.near,Math.min(i.near,e.far)),ay.forEachInDepthRange(wl,Mc.DepthOrder.FRONT_TO_BACK,(r,n)=>{n<i.near&&O$(i,e,r)}),xx(wl,Math.max(i.far,e.near),e.far),ay.forEachInDepthRange(wl,Mc.DepthOrder.BACK_TO_FRONT,(r,n,s)=>{i.far=Math.max(i.far,s)}))}function O$(i,e,t){if(!t.isVisible||!$P(e.frustum,t.boundingVolumeWorldSpace.bounds))return;const r=t.transformation,n=RMe;t.geometryRecords.forEach(s=>{Hr(n,r,s.getShaderTransformation());const a=zg(n);BJ(i,e,s.geometry.boundingInfo,n,a)})}function BJ(i,e,t,r,n){if(S(t))return;Ce(Kn,t.center,r);const{eye:s,viewForward:a}=e,o=a[0]*(Kn[0]-s[0])+a[1]*(Kn[1]-s[1])+a[2]*(Kn[2]-s[2]);if(Kn[3]=t.radius*n,!(o-Kn[3]>i.near&&o+Kn[3]<i.far)&&$P(e.frustum,Kn))if(t.radius>A$&&t.getChildren()){const l=t.getChildren();for(let c=0;c<8;++c)l[c]&&BJ(i,e,l[c],r,n)}else M$.unionDepthRangeWithAABB(i,e.viewProjectionMatrix,r,t.bbMin,t.bbMax)}function sB(i,e,t){const r=e.eye,n=e.viewForward,s=(t[0]-r[0])*n[0]+(t[1]-r[1])*n[1]+(t[2]-r[2])*n[2];i.near=Math.min(i.near,s-t[3]),i.far=Math.max(i.far,s+t[3])}let SMe=class{constructor(){this._items=new Zt({allocator:e=>e||{obj:null,distance:0,near:0,far:0},deallocator:e=>(e.obj=null,e.distance=0,e.near=0,e.far=0,e)})}get length(){return this._items.length}get empty(){return this._items.length===0}clear(){this._items.clear()}add(e){this._items.pushNew().obj=e}sort(e){const t=e.eye,r=e.viewForward;this._items.forAll(n=>{const s=n.obj.boundingVolumeWorldSpace.bounds,a=(s[0]-t[0])*r[0]+(s[1]-t[1])*r[1]+(s[2]-t[2])*r[2];n.distance=a,n.near=a-s[3],n.far=a+s[3]}),this._items.sort((n,s)=>n.distance-s.distance)}forEachInDepthRange(e,t,r){if(t===Mc.DepthOrder.FRONT_TO_BACK)for(let n=0;n<this._items.length;++n){const s=this._items.data[n];s.far<e.near||s.near>e.far||r(s.obj,s.near,s.far)}else for(let n=this._items.length-1;n>=0;--n){const s=this._items.data[n];s.far<e.near||s.near>e.far||r(s.obj,s.near,s.far)}}},EMe=class{constructor(){this._view=ve(),this._viewProj=ve(),this._frustum=Rw(),this._geometries=[],this._near=[],this._far=[],this._nearCandidates=[],this._farCandidates=[],this._range={near:0,far:0},this._looseRange={near:0,far:0}}compute(e,t){this._reset(),pn(this._view,e.viewMatrix),Hr(this._viewProj,e.projectionMatrix,this._view),BE(this._frustum,e.frustum);const r=this._view,n=r[2],s=r[6],a=r[10],o=r[14],l=this._range;let c=0;if(t.forEach(f=>{if(!f.instanceParameters.visible||!f.castShadow)return;let _;f.hasShaderTransformation?(f.computeBoundingSphere(f.getShaderTransformation(),Kn,1),_=Kn):_=f.boundingSphere;const g=n*_[0]+s*_[1]+a*_[2]+o,x=g-_[3],b=g+_[3];this._geometries[c]=f,this._near[c]=-b,this._far[c]=-x,++c}),this._geometries.length===0)return l;for(let f=0;f<this._geometries.length;++f)this._near[f]>l.far&&(l.far=this._near[f]),this._near[f]>2&&this._far[f]<l.near&&(l.near=this._far[f]);const u=this._looseRange;u.near=Math.max(.5*l.near,2),u.far=2*l.far;let d=0,m=0;for(let f=0;f<this._geometries.length;++f)this._near[f]<l.near&&(this._near[f]>=u.near?l.near=this._near[f]:this._nearCandidates[d++]=f),this._far[f]>l.far&&(this._far[f]<=u.far?l.far=this._far[f]:this._farCandidates[m++]=f);if(this._nearCandidates.length===0&&this._farCandidates.length===0)return l;this._nearCandidates.sort((f,_)=>this._near[f]<this._near[_]?-1:this._near[f]>this._near[_]?1:0),this._farCandidates.sort((f,_)=>this._far[f]<this._far[_]?1:this._far[f]>this._far[_]?-1:0);for(let f=0;f<this._nearCandidates.length;++f){const _=this._nearCandidates[f];if(this._near[_]<l.near){const g=this._geometries[_],x=g.boundingInfo;this._includeNearBoundingInfoRec(x,g.getShaderTransformation())}}for(let f=0;f<this._farCandidates.length;++f){const _=this._farCandidates[f];if(this._far[_]>l.far){const g=this._geometries[_],x=g.boundingInfo;this._includeFarBoundingInfoRec(x,g.getShaderTransformation())}}return l}_reset(){this._geometries.length=0,this._near.length=0,this._far.length=0,this._nearCandidates.length=0,this._farCandidates.length=0,this._range.near=Number.MAX_VALUE,this._range.far=-Number.MAX_VALUE}_includeNearBoundingInfoRec(e,t){if(S(e))return;const r=e.getCenter();Ce(Kn,r,t);const n=zg(t),s=Kn[0],a=Kn[1],o=Kn[2],l=e.getBSRadius()*n,c=this._frustum;if(c[0][0]*s+c[0][1]*a+c[0][2]*o+c[0][3]>l||c[1][0]*s+c[1][1]*a+c[1][2]*o+c[1][3]>l||c[2][0]*s+c[2][1]*a+c[2][2]*o+c[2][3]>l||c[3][0]*s+c[3][1]*a+c[3][2]*o+c[3][3]>l)return;const u=this._view[2]*s+this._view[6]*a+this._view[10]*o+this._view[14],d=u+l;if(!(-(u-l)<2||-d>=this._range.near))if(-d>this._looseRange.near)this._range.near=-d;else{if(l>A$){const m=e.getChildren();if(m!==void 0){for(let f=0;f<8;++f)m[f]!==void 0&&this._includeNearBoundingInfoRec(m[f],t);return}}M$.unionDepthRangeWithAABB(this._range,this._viewProj,t,e.getBBMin(),e.getBBMax())}}_includeFarBoundingInfoRec(e,t){if(S(e))return;let r=e.getBSRadius();const n=e.getCenter();Ce(Kn,n,t);const s=zg(t),a=Kn[0],o=Kn[1],l=Kn[2];r*=s;const c=this._frustum;if(c[0][0]*a+c[0][1]*o+c[0][2]*l+c[0][3]>r||c[1][0]*a+c[1][1]*o+c[1][2]*l+c[1][3]>r||c[2][0]*a+c[2][1]*o+c[2][2]*l+c[2][3]>r||c[3][0]*a+c[3][1]*o+c[3][2]*l+c[3][3]>r)return;const u=this._view[2]*a+this._view[6]*o+this._view[10]*l+this._view[14]-r;if(!(-u<=this._range.far))if(-u<this._looseRange.far)this._range.far=-u;else{if(r>A$){const d=e.getChildren();if(d!==void 0){for(let m=0;m<8;++m)d[m]!==void 0&&this._includeFarBoundingInfoRec(d[m],t);return}}M$.unionDepthRangeWithAABB(this._range,this._viewProj,t,e.getBBMin(),e.getBBMax())}}},PMe=class{constructor(){this._modelViewProj=ve(),this._clipPosition=[_i(),_i(),_i(),_i(),_i(),_i(),_i(),_i()]}unionDepthRangeWithAABB(e,t,r,n,s){const a=this._modelViewProj;Hr(a,t,r);let o=!1;for(let l=0;l<8;++l){const c=this._clipPosition[l],u=l===0||l===3||l===4||l===7?n[0]:s[0],d=l===0||l===1||l===4||l===5?n[1]:s[1],m=l<4?n[2]:s[2];c[0]=a[0]*u+a[4]*d+a[8]*m+a[12],c[1]=a[1]*u+a[5]*d+a[9]*m+a[13],c[2]=a[2]*u+a[6]*d+a[10]*m+a[14],c[3]=a[3]*u+a[7]*d+a[11]*m+a[15]}for(let l=0;l<12;++l){const c=this._clipPosition[qM[l][0]],u=this._clipPosition[qM[l][1]],d=this._clipPosition[qM[l][2]],m=this._clipTriangle(c,u,d);let f=!0;for(let _=0;_<m.length;++_)if(m[_][3]>=2){f=!1;break}if(!f){o=!0;for(let _=0;_<m.length;++_){const g=m[_][3];Number.isFinite(g)&&(e.near=Math.min(g,e.near),e.far=Math.max(g,e.far))}}}return o}_inside(e,t){return t===0?e[0]>=-e[3]:t===1?e[1]>=-e[3]:t===2?e[0]<=e[3]:t===3?e[1]<=e[3]:void it(!1)}_intersect(e,t,r){let n=0;return r===0?n=(-e[3]-e[0])/(t[0]-e[0]+t[3]-e[3]):r===1?n=(-e[3]-e[1])/(t[1]-e[1]+t[3]-e[3]):r===2?n=(e[3]-e[0])/(t[0]-e[0]-t[3]+e[3]):r===3&&(n=(e[3]-e[1])/(t[1]-e[1]-t[3]+e[3])),$re(_i(),e,t,n)}_clipTriangle(e,t,r){let n=[e,t,r];for(let s=0;s<4;++s){const a=n;n=[];for(let o=0;o<a.length;++o){const l=a[o],c=a[(o+1)%a.length];this._inside(c,s)?(this._inside(l,s)||n.push(this._intersect(l,c,s)),n.push(c)):this._inside(l,s)&&n.push(this._intersect(l,c,s))}}return n}};const qM=[[0,1,3],[2,3,1],[1,5,2],[6,2,5],[5,4,6],[7,6,4],[4,0,7],[3,7,0],[3,2,7],[6,7,2],[4,5,0],[1,0,5]],Kn=ou(),RMe=ve(),wl=eT(),ay=new SMe,AMe=new EMe,M$=new PMe;let OMe=class{},MMe=class extends Ir{constructor(){super(...arguments),this.textures=new OMe}};function IMe(){const i=new Yi;return i.attributes.add(P.POSITION,"vec2"),i.vertex.uniforms.add(new Xh("drawPosition",(e,t)=>LMe(e,t))),i.varyings.add("vUV","vec2"),i.vertex.code.add(O`void main(void) {
vUV = position;
gl_Position = vec4(drawPosition.xy + vec2(position - 0.5) * drawPosition.zw, 0.0, 1.0);
}`),i.fragment.uniforms.add(new Bt("textureInput",e=>e.textures.input)),i.fragment.uniforms.add(new Bt("textureMask",e=>e.textures.mask)),i.fragment.uniforms.add(new Bt("textureOverlay",e=>e.textures.overlay)),i.fragment.uniforms.add(new Tw("maskEnabled",e=>e.magnifier.maskEnabled)),i.fragment.uniforms.add(new Tw("overlayEnabled",e=>e.magnifier.overlayEnabled)),i.fragment.code.add(O`const float barrelFactor = 1.1;
vec2 barrel(vec2 uv) {
vec2 uvn = uv * 2.0 - 1.0;
if (uvn.x == 0.0 && uvn.y == 0.0) {
return vec2(0.5, 0.5);
}
float theta = atan(uvn.y, uvn.x);
float r = pow(length(uvn), barrelFactor);
return r * vec2(cos(theta), sin(theta)) * 0.5 + 0.5;
}
void main() {
float mask = maskEnabled ? texture2D(textureMask, vUV).a : 1.0;
vec4 inputColor = texture2D(textureInput, barrel(vUV)) * mask;
vec4 overlayColor = overlayEnabled ? texture2D(textureOverlay, vUV) : vec4(0);
gl_FragColor = overlayColor + (1.0 - overlayColor.a) * inputColor;
}`),i}function LMe(i,e){const t=e.camera.pixelRatio,r=i.magnifier.offset.x*t,n=i.magnifier.offset.y*t;Dh(i.magnifier.position,aB);const s=e.camera.screenToRender(aB,$Me),a=Math.ceil(t*i.magnifier.size),o=e.camera.fullWidth,l=e.camera.fullHeight;return Qs(DMe,(s[0]+r)/o*2-1,(s[1]-n)/l*2-1,a/o*2,a/l*2)}const aB=zi(),$Me=C7(),DMe=_i();async function FMe(i){const e=G(()=>import("./mask-svg-82caf882.js"),[]),t=G(()=>import("./overlay-svg-615b0a3b.js"),[]),r=Mg((await e).default,{signal:i}),n=Mg((await t).default,{signal:i}),s={mask:await r,overlay:await n};return xi(i),s}let Iy=class extends ue{constructor(){super(...arguments),this._handles=new Ft,this._magnifier=null,this._imageSources=null,this._imageLoadTask=null,this._resources=null,this._passParameters=new MMe,this.events=new nn,this.attributeLocations=new Map([[P.POSITION,0]]),this._tmpScreenPoint=zi(),this._tmpRenderPoint=C7()}get updating(){return S(this._imageSources)&&y(this._imageLoadTask)&&!this._imageLoadTask.task.finished}get magnifier(){return this._magnifier}set magnifier(e){if(e===this._magnifier)return;this._handles.removeAll(),this._magnifier=e;const t=()=>{this._updateResourceLoading(),this.events.emit("request-render")};y(this._magnifier)&&this._handles.add(z(()=>co(this._magnifier,r=>r.version),t)),t()}get enabled(){return y(this._validMagnifier)}get _validMagnifier(){return y(this._magnifier)&&this._magnifier.visible&&y(this._magnifier.position)&&this._magnifier.size>0?this._magnifier:null}get _factor(){return y(this._magnifier)&&this._magnifier.factor||1}dispose(){this._magnifier=null,this._handles.destroy(),y(this._imageLoadTask)&&(this._imageLoadTask.task.abort(),this._imageLoadTask=null),this._disposeResources()}render(e,t){const r=this._validMagnifier;if(S(r))return;const n=t.camera.pixelRatio,s=Math.ceil(n*r.size);if(this._updateResources(e,s),S(this._resources))return;const a=this._passParameters.textures,o=Math.ceil(1/this._factor*s);a.input.resize(o,o),Dh(r.position,this._tmpScreenPoint);const l=t.camera.screenToRender(this._tmpScreenPoint,this._tmpRenderPoint),c=t.camera.fullWidth,u=t.camera.fullHeight,d=.5*o,m=.5*o;l[0]=ce(l[0],d,c-d-1),l[1]=ce(l[1],m,u-m-1);const f=Math.floor(l[0]-d),_=Math.floor(l[1]-m),g=this._resources.program;g.bindTexture("textureInput",a.input),e.gl.copyTexImage2D(a.input.descriptor.target,0,a.input.descriptor.pixelFormat,f,_,o,o,0),this._passParameters.magnifier=r,e.useProgram(g),g.bindPass(this._passParameters,t),e.bindVAO(this._resources.vao),e.setPipelineState(this._resources.pipelineState),e.drawArrays(Dt.TRIANGLE_STRIP,0,4)}_updateResourceLoading(){const e=this._validMagnifier;if(S(e))return;const t=e.maskUrl,r=e.overlayUrl;!y(this._imageLoadTask)||this._imageLoadTask.maskUrl===t&&this._imageLoadTask.overlayUrl===r||(this._imageLoadTask.task.abort(),this._imageLoadTask=null,this._imageSources=null),y(this._imageSources)||y(this._imageLoadTask)||(this._imageLoadTask={maskUrl:t,overlayUrl:r,task:Dx(async n=>{const s=S(t)||S(r)?FMe(n):null,a=y(t)?Mg(t,{signal:n}):s.then(l=>l.mask),o=y(r)?Mg(r,{signal:n}):s.then(l=>l.overlay);this._imageSources={mask:await a,overlay:await o},this._disposeResources(),this.events.emit("request-render")})},this._imageLoadTask.task.promise.then(()=>this.notifyChange("updating"),()=>this.notifyChange("updating")))}_updateResources(e,t){if(!this.enabled)return void this._disposeResources();if(y(this._resources)){if(this._passParameters.textures.size!==t){const n=this._createTextureResources(e,t);if(S(n))return void this._disposeResources();this._disposeTextureResources(this._passParameters.textures),this._passParameters.textures=n}return}const r=this._createTextureResources(e,t);S(r)||(this._resources={program:this._createProgram(e),vao:La(e,une,this.attributeLocations,0,1),pipelineState:Ke({blending:lu(de.ONE,de.ONE_MINUS_SRC_ALPHA),depthTest:null,depthWrite:null,colorWrite:ht})},this._passParameters.textures=r)}_disposeResources(){S(this._resources)||(this._disposeTextureResources(this._passParameters.textures),this._resources.program.dispose(),this._resources.vao.dispose(),this._resources=null)}_disposeTextureResources(e){e.mask.dispose(),e.overlay.dispose(),e.input.dispose()}_createTextureResources(e,t){if(S(this._imageSources))return null;this._imageSources.overlay.width=t,this._imageSources.overlay.height=t,this._imageSources.mask.width=t,this._imageSources.mask.height=t;const r=new Gi(e,{target:vi.TEXTURE_2D,pixelFormat:yt.RGBA,internalFormat:yt.RGBA,dataType:qt.UNSIGNED_BYTE,wrapMode:si.CLAMP_TO_EDGE,samplingMode:Kt.LINEAR,flipped:!0,preMultiplyAlpha:!nD(this._imageSources.overlay.src)||!e.driverTest.svgAlwaysPremultipliesAlpha},this._imageSources.overlay),n=new Gi(e,{target:vi.TEXTURE_2D,pixelFormat:yt.ALPHA,internalFormat:yt.ALPHA,dataType:qt.UNSIGNED_BYTE,wrapMode:si.CLAMP_TO_EDGE,samplingMode:Kt.LINEAR,flipped:!0},this._imageSources.mask);return{input:new Gi(e,{target:vi.TEXTURE_2D,pixelFormat:yt.RGBA,internalFormat:yt.RGBA,dataType:qt.UNSIGNED_BYTE,wrapMode:si.CLAMP_TO_EDGE,samplingMode:Kt.LINEAR,flipped:!1}),mask:n,overlay:r,size:t}}_createProgram(e){return new Jt(e,IMe(),this.attributeLocations)}};h([p()],Iy.prototype,"_imageSources",void 0),h([p()],Iy.prototype,"_imageLoadTask",void 0),h([p({readOnly:!0})],Iy.prototype,"updating",null),Iy=h([D("esri/views/3d/webgl-engine/lib/MagnifierHelper")],Iy);let NMe=class{constructor(){this.declaredClass="esri.views.3d.webgl-engine.lib.ObjectAndLayerIdRenderHelper",this.colorZero=new Lm(new ArrayBuffer(4)),this._uidToRenderColor=new Map,this._colorToUID=new Map,this._layerUidToGraphicsUidToObjectId=new Map,this._layerUidToId=new Map,this._layerUidToPopupEnabled=new Map}setUidToObjectAndLayerId(e,t,r,n,s,a=null,o=null,l=null){if(!(e&&t&&r&&n)||(this._layerUidToId.set(n,r),this._layerUidToPopupEnabled.set(n,s),!s))return;let c=this._layerUidToGraphicsUidToObjectId.get(n);c||(c=new Map,this._layerUidToGraphicsUidToObjectId.set(n,c)),c.set(t,{objectId:e,attributeNodeId:a,attributeIndex:o,subLayerId:l})}getObjectAndLayerIdColor(e){const t=this.getObjectAndLayerIdColorArray(e);return Bi(t.get(0,1),t.get(0,2),t.get(0,3),255)}getObjectAndLayerIdColorArray(e){if(!e.layerUid||!e.graphicUid)return this.colorZero;const t=this._layerUidToPopupEnabled.get(e.layerUid);if(t===void 0)return J.getLogger(this.declaredClass).warn("popupEnabled is undefined for layerUid "+e.layerUid),this.colorZero;if(t===!1)return this.colorZero;let r=this._uidToRenderColor.get(e.layerUid);r||(r=new Map,this._uidToRenderColor.set(e.layerUid,r));let n=r.get(e.graphicUid);if(!n){for(;!n;){const a=Math.floor(16777214*Math.random())+1;this._colorToUID.has(a)||(n=a)}if(n>16777215)throw new Error("Object ID Overflow");r.set(e.graphicUid,n),this._colorToUID.set(n,e)}const s=new ArrayBuffer(4);return new DataView(s).setUint32(0,n,!1),new Lm(s)}getColorToObjectAndLayerIdMapping(){const e=new Map;for(const[t,r]of this._colorToUID.entries()){const n=this._layerUidToGraphicsUidToObjectId.get(r.layerUid);let s=null;n?(s=n.get(r.graphicUid),s||J.getLogger(this.declaredClass).warn("getColorMapping: no entry found for graphicsId "+r.graphicUid)):J.getLogger(this.declaredClass).warn("getColorMapping: no entry found for layerUid "+r.layerUid);const a=this._layerUidToId.get(r.layerUid);a||J.getLogger(this.declaredClass).warn("no layerId found for uid "+r.layerUid),s&&a&&e.set(t,s.attributeNodeId?{type:"object-and-layer-and-i3s-id",oid:s.objectId,lid:a,attrId:s.attributeNodeId,attrIdx:s.attributeIndex,subLayerId:s.subLayerId}:{type:"object-and-layer-id",oid:s.objectId,lid:a})}return e}};const kMe=.5,VMe=30,oB=Rt(1e3/1),UMe=Rt(1e3/VMe);var Tx;(function(i){i[i.FrontToBack=0]="FrontToBack",i[i.BackToFront=1]="BackToFront"})(Tx||(Tx={}));let gp=class{constructor(e,t,r=Tx.FrontToBack){this._rctx=e,this._techniqueRepository=t,this._sorting=r,this._draws=new Zt({initialSize:32,allocator:n=>n||{material:null,geometry:null,geometryRanges:null,bindDrawParams:null,depthSquaredHint:0,indexType:0}}),this._previouslyBoundDraw=new Map}submitDraw(e,t,r,n){const s=this._draws.pushNew();s.geometry=t,s.geometryRanges=r,s.material=e,s.depthSquaredHint=n,s.indexType=t.indexed?ct(t.vao.indexBuffer).indexType:0}dispatch(e,t){const r=this._rctx;this._previouslyBoundDraw.clear();let n=null;const s=this._draws.map(o=>o.material.prepareTechnique(this._techniqueRepository,e,t,o.geometry.parameters)),a=this._draws.length;for(let o=0;o<a;o++){const l=s[o];l===n&&l.configuration.transparencyPassType===Ht.NONE||(r.bindTechnique(l,e,t),n=l);const c=this._draws.data[o],u=c.geometry;r.bindVAO(u.vao),this._previouslyBoundDraw.get(l)!==c.material&&(l.program.bindDraw(c.material,t,e),this._previouslyBoundDraw.set(l,c.material));const d=c.geometryRanges,m=d.length;if(c.indexType!==0){const f=yE.get(c.indexType);for(let _=0;_<m;_+=2){const g=d[_],x=d[_+1];r.drawElements(u.primitiveType,x,c.indexType,g*f)}}else for(let f=0;f<m;f+=2){const _=d[f],g=d[f+1];r.drawArrays(u.primitiveType,_,g)}}}prepareSubmit(){this._draws.clear()}finishSubmit(){const e=this._sorting===Tx.FrontToBack?1:-1;this._draws.sort((t,r)=>{const n=e*(t.depthSquaredHint-r.depthSquaredHint);return n!==0?n:t.geometry.vao.size-r.geometry.vao.size})}get count(){return this._draws.length}};const yE=new Map;yE.set(um.UNSIGNED_BYTE,1),yE.set(um.UNSIGNED_SHORT,2),yE.set(um.UNSIGNED_INT,4);let zMe=class{constructor(e,t){this.rctx=e,this.shaderTechniqueRepository=t,this.canRender=!0,this._materialPassParameters=new lAe,this._shadowPassParameters=new cAe,this._highlightPassParameters=new hAe,this._systems=new Set,this._passes={materialOpaque:new gp(e,t),materialTransparent:new gp(e,t,Tx.BackToFront),materialIntegratedMesh:new gp(e,t),shadowMap:new gp(e,t),highlight:new gp(e,t),highlightIntegratedMesh:new gp(e,t),highlightShadowMap:new gp(e,t),defaultShadowMap:new gp(e,t)}}register(e){this._systems.add(e)}prepareRender(e){if(this._systems.size!==0){for(const t of Object.values(this._passes))t.prepareSubmit();this._systems.forEach(t=>t.submit(this._passes,e.bindParameters));for(const t of Object.values(this._passes))t.finishSubmit();this.shaderTechniqueRepository.frameUpdate()}}render(e){if(this._systems.size!==0)switch(this._configure(e),e.bindParameters.slot){case ae.OPAQUE_MATERIAL:switch(e.output){case k.Color:return this._materialPassParameters.subPass=yr.Color,this._passes.materialOpaque.dispatch(this._materialPassParameters,e.bindParameters);case k.Depth:return this._materialPassParameters.subPass=yr.Depth,this._passes.materialOpaque.dispatch(this._materialPassParameters,e.bindParameters);case k.Normal:return this._materialPassParameters.subPass=yr.Normal,this._passes.materialOpaque.dispatch(this._materialPassParameters,e.bindParameters);case k.Highlight:return this._passes.highlight.dispatch(this._highlightPassParameters,e.bindParameters);case k.Shadow:return this._passes.shadowMap.dispatch(this._shadowPassParameters,e.bindParameters);case k.ShadowHighlight:return this._passes.highlightShadowMap.dispatch(this._shadowPassParameters,e.bindParameters);case k.ShadowExludeHighlight:return this._passes.defaultShadowMap.dispatch(this._shadowPassParameters,e.bindParameters);case k.ObjectAndLayerIdColor:return this._materialPassParameters.subPass=yr.ObjectAndLayerIdColor,this._passes.materialOpaque.dispatch(this._materialPassParameters,e.bindParameters)}return;case ae.TRANSPARENT_MATERIAL:switch(e.output){case k.Color:return this._materialPassParameters.subPass=yr.Color,this._passes.materialTransparent.dispatch(this._materialPassParameters,e.bindParameters);case k.Alpha:return this._materialPassParameters.subPass=yr.Alpha,this._passes.materialTransparent.dispatch(this._materialPassParameters,e.bindParameters);case k.Depth:return this._materialPassParameters.subPass=yr.Depth,this._passes.materialTransparent.dispatch(this._materialPassParameters,e.bindParameters);case k.Normal:return this._materialPassParameters.subPass=yr.Normal,this._passes.materialTransparent.dispatch(this._materialPassParameters,e.bindParameters);case k.ObjectAndLayerIdColor:return this._materialPassParameters.subPass=yr.ObjectAndLayerIdColor,this._passes.materialTransparent.dispatch(this._materialPassParameters,e.bindParameters)}return;case ae.INTEGRATED_MESH:switch(e.output){case k.Color:return this._materialPassParameters.subPass=yr.Color,this._passes.materialIntegratedMesh.dispatch(this._materialPassParameters,e.bindParameters);case k.Depth:return this._materialPassParameters.subPass=yr.Depth,this._passes.materialIntegratedMesh.dispatch(this._materialPassParameters,e.bindParameters);case k.Normal:return this._materialPassParameters.subPass=yr.Normal,this._passes.materialIntegratedMesh.dispatch(this._materialPassParameters,e.bindParameters);case k.Highlight:return this._passes.highlightIntegratedMesh.dispatch(this._highlightPassParameters,e.bindParameters);case k.ObjectAndLayerIdColor:return this._materialPassParameters.subPass=yr.ObjectAndLayerIdColor,this._passes.materialIntegratedMesh.dispatch(this._materialPassParameters,e.bindParameters)}return}}notifyDirty(){this._context.requestRender()}slots(){return[ae.OPAQUE_MATERIAL,ae.TRANSPARENT_MATERIAL,ae.INTEGRATED_MESH]}initializeRenderContext(e){this._context=e}uninitializeRenderContext(){}queryDepthRange(e){const t={near:1/0,far:-1/0};return this._systems.forEach(r=>{const n=r.queryShadowCasterDepthRange(e);y(n)&&dv(t,n,t)}),t}_configure(e){const t=e.output===k.Shadow||e.output===k.ShadowHighlight||e.output===k.ShadowExludeHighlight?this._shadowPassParameters:e.output===k.Highlight?this._highlightPassParameters:this._materialPassParameters;this._updateParameters(e,t)}_updateParameters(e,t){const r=e.bindParameters.camera,n=r.viewInverseTransposeMatrix;Z(WM,n[3],n[7],n[11]),XM.set(WM),q(t.transformWorldFromViewTH,XM.high),q(t.transformWorldFromViewTL,XM.low),q(t.slicePlaneLocalOrigin,WM),Td(t.transformViewFromCameraRelativeRS,r.viewMatrix),pn(t.transformProjFromView,r.projectionMatrix),t.identifier===Zo.Material&&(this._materialPassParameters.transparent=e.bindParameters.slot===ae.TRANSPARENT_MATERIAL,this._materialPassParameters.integratedMesh=e.bindParameters.slot===ae.INTEGRATED_MESH,qc(lB,t.transformViewFromCameraRelativeRS),Zg(t.transformNormalViewFromGlobal,lB))}get needsHighlight(){return this._passes.highlight.count>0||this._passes.highlightIntegratedMesh.count>0}get needsTransparentPass(){return this._passes.materialTransparent.count>0}};const WM=R(),lB=Or(),XM=new GR,BMe=8.6,GMe=.4;function HMe(){const i=new Yi,{vertex:e,fragment:t}=i,r=e.code,n=t.code;return i.attributes.add(P.POSITION,"vec2"),i.varyings.add("uv","vec2"),i.attributes.add(P.UV0,"vec2"),e.uniforms.add(new Bt("coverageTex",s=>s.coverageTexture)),r.add(O`void main() {
vec4 cov = texture2D(coverageTex, uv0);
if (cov.r == 0.0) {
gl_Position = vec4(0.0);
return;
}
gl_Position = vec4(position, 0.0, 1.0);
uv = position.xy * 0.5 + vec2(0.5);
}`),t.uniforms.add(new Bt("tex",s=>s.blurColorTexture)),t.uniforms.add(new Bt("origin",s=>s.highlightColorTexture)),t.uniforms.add(new Xh("uColor",s=>s.color)),t.uniforms.add(new Xh("haloColor",s=>s.haloColor)),t.uniforms.add(new Xh("opacities",s=>Qs(jMe,s.haloOpacity,s.haloOpacityOccluded,s.fillOpacity,s.fillOpacityOccluded))),t.constants.add("outlineSize","float",BMe),t.constants.add("blurSize","float",GMe),n.add(O`void main() {
vec4 blurredHighlightValue = texture2D(tex, uv);
float highlightIntensity = blurredHighlightValue.a;
if (highlightIntensity == 0.0) {
discard;
}
vec4 origin_color = texture2D(origin, uv);
float outlineIntensity;
float fillIntensity;
if (blurredHighlightValue.g > blurredHighlightValue.b) {
outlineIntensity = haloColor.w * opacities[1];
fillIntensity = uColor.w * opacities[3];
}
else {
outlineIntensity = haloColor.w * opacities[0];
fillIntensity = uColor.w * opacities[2];
}
float inner = 1.0 - outlineSize / 9.0;
float outer = 1.0 - (outlineSize + blurSize) / 9.0;
float outlineFactor = smoothstep(outer, inner, highlightIntensity);
float fillFactor = any(notEqual(origin_color, vec4(0.0, 0.0, 0.0, 0.0))) ? 1.0 : 0.0;
float intensity = outlineIntensity * outlineFactor * (1.0 - fillFactor) + fillIntensity * fillFactor;
gl_FragColor = vec4(mix(haloColor.rgb, uColor.rgb, fillFactor), intensity);
}`),i}const jMe=_i(),qMe=Object.freeze(Object.defineProperty({__proto__:null,build:HMe},Symbol.toStringTag,{value:"Module"}));let GJ=class HJ extends ti{initializeProgram(e){return new Jt(e.rctx,HJ.shader.get().build(),ai)}initializePipeline(){return Ke({blending:Gn(de.SRC_ALPHA,de.ONE,de.ONE_MINUS_SRC_ALPHA,de.ONE_MINUS_SRC_ALPHA),colorWrite:ht})}};GJ.shader=new ii(qMe,()=>G(()=>import("./HighlightApply.glsl-eca33a62.js"),["assets/HighlightApply.glsl-eca33a62.js","assets/vec4-790471c0.js","assets/common-c186b691.js","assets/vec4f64-e407da96.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/Texture2DPassUniform-753de459.js","assets/VertexAttribute-9c5c630d.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));let jJ=class extends Ir{constructor(){super(...arguments),this.blurSize=be()}};function WMe(){const i=new Yi,{vertex:e,fragment:t}=i,r=e.code,n=t.code;return i.attributes.add(P.POSITION,"vec2"),i.attributes.add(P.UV0,"vec2"),i.varyings.add("blurCoordinate","vec3"),e.uniforms.add(new Bt("coverageTex",s=>s.coverageTexture)),t.uniforms.add(new dH("blurSize",s=>s.blurSize)),r.add(O`void main() {
gl_Position = vec4(position, 0.0, 1.0);
vec4 cov = texture2D(coverageTex, uv0);
if (cov.r == 0.0) {
gl_Position = vec4(0.0);
}
blurCoordinate = vec3(gl_Position.xy * 0.5 + vec2(0.5), max(cov.g, cov.b));
}`),t.uniforms.add(new WD("tex",s=>s.blurInputTexture)),n.add(O`void main() {
vec2 uv = blurCoordinate.xy;
vec4 center = texture2D(tex, uv);
if (blurCoordinate.z == 1.0) {
gl_FragColor = center;
} else {
vec4 sum = vec4(0.0);
sum += center * 0.204164;
sum += texture2D(tex, uv + blurSize * 1.407333) * 0.304005;
sum += texture2D(tex, uv - blurSize * 1.407333) * 0.304005;
sum += texture2D(tex, uv + blurSize * 3.294215) * 0.093913;
sum += texture2D(tex, uv - blurSize * 3.294215) * 0.093913;
gl_FragColor = sum;
}
}`),i}const XMe=Object.freeze(Object.defineProperty({__proto__:null,HighlightBlurDrawParameters:jJ,build:WMe},Symbol.toStringTag,{value:"Module"}));let qJ=class WJ extends ti{initializeProgram(e){return new Jt(e.rctx,WJ.shader.get().build(),ai)}initializePipeline(){return Ke({colorWrite:ht})}};qJ.shader=new ii(XMe,()=>G(()=>import("./HighlightBlur.glsl-71f3e63e.js"),["assets/HighlightBlur.glsl-71f3e63e.js","assets/vec2f64-30dc1443.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/vec2-528adfe4.js","assets/common-c186b691.js","assets/Texture2DPassUniform-753de459.js","assets/VertexAttribute-9c5c630d.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));let XJ=class extends Ir{constructor(){super(...arguments),this.invFramebufferDim=be()}};function QMe(){const i=new Yi,{vertex:e,fragment:t}=i,r=e.code,n=t.code;return i.attributes.add(P.POSITION,"vec2"),r.add(O`void main() {
gl_Position = vec4(vec2(1.0) - position * 2.0, 0.0, 1.0);
}`),t.uniforms.add(new WD("tex",s=>s.inputTexture)),t.uniforms.add(new dH("invFramebufferDim",s=>s.invFramebufferDim)),n.add(O`void main() {
vec2 coord = gl_FragCoord.xy * invFramebufferDim;
vec4 value = texture2D(tex, coord);
float mx = floor(max(value.g, value.b));
gl_FragColor = vec4(ceil(value.r), mx, mx, 1.0);
}`),i}const ZMe=Object.freeze(Object.defineProperty({__proto__:null,HighlightDownsampleDrawParameters:XJ,build:QMe},Symbol.toStringTag,{value:"Module"}));let QJ=class ZJ extends ti{initializeProgram(e){return new Jt(e.rctx,ZJ.shader.get().build(),ai)}initializePipeline(){return Ke({colorWrite:ht})}};QJ.shader=new ii(ZMe,()=>G(()=>import("./HighlightDownsample.glsl-533ed06a.js"),["assets/HighlightDownsample.glsl-533ed06a.js","assets/vec2f64-30dc1443.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/vec2-528adfe4.js","assets/common-c186b691.js","assets/Texture2DPassUniform-753de459.js","assets/VertexAttribute-9c5c630d.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));let cB=class extends Ir{constructor(){super(...arguments),this.color=Z0(1,0,1,1),this.haloColor=Z0(1,0,1,1),this.haloOpacity=1,this.haloOpacityOccluded=.25,this.fillOpacity=.2,this.fillOpacityOccluded=.05,this.shadowColor=Bi(1,0,1,1),this.shadowOpacity=.15,this.occludedShadowOpacity=.075}};const YMe=32;class KMe{constructor(e,t){this._techniqueRep=e,this._rctx=t,this._viewportToRestore=_i(),this._passParameters=new cB,this._downsampleDrawParameters=new XJ,this._blurDrawParameters=new jJ,this._grid={coverageMipmap:null,vao:null,verticalCellCount:0,horizontalCellCount:0,cellPixelSize:0,mipmapLevels:0,viewportWidth:0,viewportHeight:0}}_assertResources(){if(this._quadVAO)return;this._quadVAO=La(this._rctx);const e={colorTarget:Vn.TEXTURE,depthStencilTarget:rs.NONE,width:0,height:0},t={target:vi.TEXTURE_2D,pixelFormat:yt.RGBA,dataType:qt.UNSIGNED_BYTE,samplingMode:Kt.LINEAR,wrapMode:si.CLAMP_TO_EDGE,width:0,height:0};this._blur0Fbo=new yn(this._rctx,e,t),this._blur1Fbo=new yn(this._rctx,e,t),this._blurTechnique=this._techniqueRep.acquire(qJ),this._downsampleTechnique=this._techniqueRep.acquire(QJ),this._applyTechnique=this._techniqueRep.acquire(GJ)}dispose(){if(this._blurTechnique=Qi(this._blurTechnique),this._downsampleTechnique=Qi(this._downsampleTechnique),this._applyTechnique=Qi(this._applyTechnique),this._grid.coverageMipmap)for(let e=1;e<this._grid.coverageMipmap.length;e++)this._grid.coverageMipmap[e].dispose();this._grid.vao&&this._grid.vao.dispose(!0),this._quadVAO&&(this._quadVAO.dispose(!0),this._quadVAO=null),this._blur0Fbo=Me(this._blur0Fbo),this._blur1Fbo=Me(this._blur1Fbo)}setDefaultOptions(e){this._passParameters={...new cB,...e}}render(e,t,r){this._passParameters.highlightColorTexture=t.colorTexture,this._assertResources();const n=e.camera;im(this._viewportToRestore,n.fullViewport);const s=n.fullWidth,a=n.fullHeight,o=n.pixelRatio,l=Math.ceil(s/o),c=Math.ceil(a/o);this._blur0Fbo.resize(l,c),this._blur1Fbo.resize(l,c);const u=this._rctx;u.bindVAO(this._quadVAO);let d=null;this._gridUpdateResources(t,YMe),this._gridComputeMipmap(e),this._passParameters.coverageTexture=this._grid.coverageMipmap[this._grid.mipmapLevels].colorTexture,d=this._grid.vao;const m=u.bindTechnique(this._blurTechnique,this._passParameters,e);u.bindVAO(d),u.bindFramebuffer(this._blur0Fbo),u.setViewport(0,0,l,c),u.setClearColor(0,0,0,0),u.clear(Ai.COLOR_BUFFER_BIT),this._blurDrawParameters.blurInputTexture=t.colorTexture,Je(this._blurDrawParameters.blurSize,1/l,0),m.bindDraw(this._blurDrawParameters,e,this._passParameters),u.drawArrays(this._blurTechnique.primitiveType,0,Ws(d,"geometry")),u.bindFramebuffer(this._blur1Fbo),u.clear(Ai.COLOR_BUFFER_BIT),this._blurDrawParameters.blurInputTexture=this._blur0Fbo.colorTexture,Je(this._blurDrawParameters.blurSize,0,1/c),m.bindDraw(this._blurDrawParameters,e,this._passParameters),u.drawArrays(this._blurTechnique.primitiveType,0,Ws(d,"geometry")),u.bindFramebuffer(r),u.setViewport(this._viewportToRestore[0],this._viewportToRestore[1],this._viewportToRestore[2],this._viewportToRestore[3]),this._passParameters.blurColorTexture=this._blur1Fbo.colorTexture,u.bindTechnique(this._applyTechnique,this._passParameters,e),u.drawArrays(this._applyTechnique.primitiveType,0,Ws(d,"geometry")),u.bindVAO(null)}_gridUpdateResources(e,t){const r=this._rctx,n=this._grid;let s=!1;if(n.coverageMipmap===null&&(n.coverageMipmap=[e],s=!0),n.viewportWidth===e.width&&n.viewportHeight===e.height||(s=!0,n.viewportWidth=e.width,n.viewportHeight=e.height),n.coverageMipmap[0]=e,n.cellPixelSize!==t&&(n.cellPixelSize=t,s=!0),s){for(let l=1;l<n.coverageMipmap.length;l++)n.coverageMipmap[l].dispose();n.mipmapLevels=Math.ceil(Math.log(n.cellPixelSize)*Math.LOG2E),n.coverageMipmap.length=n.mipmapLevels+1;for(let l=0;l<n.mipmapLevels;l++){const c=n.coverageMipmap[l],u={target:vi.TEXTURE_2D,pixelFormat:yt.RGB,dataType:qt.UNSIGNED_SHORT_5_6_5,samplingMode:Kt.LINEAR,wrapMode:si.CLAMP_TO_EDGE,width:Math.ceil(c.width/2),height:Math.ceil(c.height/2)},d={colorTarget:Vn.TEXTURE,depthStencilTarget:rs.NONE,width:Math.ceil(c.width/2),height:Math.ceil(c.height/2)};n.coverageMipmap[l+1]=new yn(r,d,u)}}const a=Math.ceil(e.height/n.cellPixelSize),o=Math.ceil(e.width/n.cellPixelSize);if(!n.vao||n.verticalCellCount!==a||n.horizontalCellCount!==o){n.verticalCellCount=a,n.horizontalCellCount=o;const l=a+1,c=o+1,u=1/a,d=1/o,m=6,f=4,_=new Float32Array(m*f*l*c);let g=0;for(let x=0;x<l;x++)for(let b=0;b<c;b++)_[g+0]=(b-.5)*d*2-1,_[g+1]=(x-.5)*u*2-1,_[g+2]=b*d,_[g+3]=x*u,_[g+4]=(b+.5)*d*2-1,_[g+5]=(x-.5)*u*2-1,_[g+6]=b*d,_[g+7]=x*u,_[g+8]=(b-.5)*d*2-1,_[g+9]=(x+.5)*u*2-1,_[g+10]=b*d,_[g+11]=x*u,_[g+12]=(b-.5)*d*2-1,_[g+13]=(x+.5)*u*2-1,_[g+14]=b*d,_[g+15]=x*u,_[g+16]=(b+.5)*d*2-1,_[g+17]=(x-.5)*u*2-1,_[g+18]=b*d,_[g+19]=x*u,_[g+20]=(b+.5)*d*2-1,_[g+21]=(x+.5)*u*2-1,_[g+22]=b*d,_[g+23]=x*u,g+=m*f;n.vao&&n.vao.dispose(!0),n.vao=new nu(r,ai,{geometry:kx},{geometry:hi.createVertex(r,di.STATIC_DRAW,_)})}}_gridComputeMipmap(e){const t=this._rctx,r=this._grid,n=t.bindTechnique(this._downsampleTechnique,this._passParameters,e);t.bindVAO(this._quadVAO);for(let s=0;s<r.mipmapLevels;s++){t.bindFramebuffer(r.coverageMipmap[s+1]);const a=r.coverageMipmap[s+1].width,o=r.coverageMipmap[s+1].height;this._downsampleDrawParameters.inputTexture=r.coverageMipmap[s].colorTexture,Je(this._downsampleDrawParameters.invFramebufferDim,1/a,1/o),n.bindDraw(this._downsampleDrawParameters,e,this._passParameters),t.setViewport(0,0,a,o),t.drawArrays(Dt.TRIANGLE_STRIP,0,Ws(this._quadVAO,"geometry"))}}get gpuMemoryUsage(){let e=(y(this._blur0Fbo)?this._blur0Fbo.gpuMemoryUsage:0)+(y(this._blur1Fbo)?this._blur1Fbo.gpuMemoryUsage:0);if(this._grid.coverageMipmap)for(const t of this._grid.coverageMipmap)e+=t.gpuMemoryUsage;return e}get test(){return{coverage:this._grid.coverageMipmap,blur:[this._blur0Fbo,this._blur1Fbo]}}}const JMe={dataType:qt.UNSIGNED_BYTE,internalFormat:yt.RGBA},eIe={};let tIe=class{constructor(e){this._rctx=e,this._activeTargets=new Set,this._depthTextures=new Map,this._depthBuffers=new Map,this._colorTextures=new Map,this._framebuffers=new Map,this.depthTextureSupported=e.capabilities.depthTexture}dispose(){this._depthBuffers.forEach(e=>e.dispose()),this._depthBuffers.clear(),this._depthTextures.forEach(e=>e.dispose()),this._depthTextures.clear(),this._colorTextures.forEach(e=>e.dispose()),this._colorTextures.clear(),this._framebuffers.forEach(e=>e.dispose()),this._framebuffers.clear(),this._activeTargets.clear()}disposeTargetResource(e){const t=e.id;this._activeTargets.has(t)&&(this._activeTargets.delete(t),this._disposeWithFramebuffers(this._depthTextures,t),this._disposeWithFramebuffers(this._depthBuffers,t),this._disposeWithFramebuffers(this._colorTextures,t))}_disposeWithFramebuffers(e,t){const r=e.get(t);r&&(this._framebuffers.forEach((n,s)=>{n.colorAttachment!==r&&n.depthStencilAttachment!==r||(n.detachAll(),n.dispose(),this._framebuffers.delete(s))}),r.dispose(),e.delete(t))}getDepthTexture(e,t){if(!this.depthTextureSupported)return null;let r=this._depthTextures.get(e.id);return!r||r.descriptor.width===t.width&&r.descriptor.height===t.height||(r.dispose(),r=iI()),r||(r=new Gi(this._rctx,{target:vi.TEXTURE_2D,pixelFormat:yt.DEPTH_STENCIL,dataType:qt.UNSIGNED_INT_24_8,samplingMode:Kt.NEAREST,wrapMode:si.CLAMP_TO_EDGE,width:t.width,height:t.height}),this._depthTextures.set(e.id,r),this._activeTargets.add(e.id)),r}getAllocatedDepthTexture(e){return this._depthTextures.get(e.id)}getDepthBuffer(e,t){if(this.depthTextureSupported)return null;let r=this._depthBuffers.get(e.id);return r?r.descriptor.width===t.width&&r.descriptor.height===t.height||r.resize(t.width,t.height):(r=new wne(this._rctx,{internalFormat:pne.DEPTH_STENCIL,...t}),this._depthBuffers.set(e.id,r),this._activeTargets.add(e.id)),r}getColorTexture(e,t){let r=this._colorTextures.get(e.id);return r&&(r.descriptor.width===t.width&&r.descriptor.height===t.height||(r.dispose(),r=iI())),r||(r=new Gi(this._rctx,{target:vi.TEXTURE_2D,pixelFormat:yt.RGBA,internalFormat:e.internalFormat,dataType:e.dataType,samplingMode:e.samplingMode!=null?e.samplingMode:Kt.LINEAR,wrapMode:si.CLAMP_TO_EDGE,width:t.width,height:t.height}),this._colorTextures.set(e.id,r),this._activeTargets.add(e.id)),r}getAllocatedColorTexture(e){return this._colorTextures.get(e.id)}registerDepthTarget(e={}){return{id:Cm(),...eIe,...e}}registerColorTarget(e={}){return{id:Cm(),...JMe,...e}}getFramebuffer(e,t,r){const n=this._getKey(t,r);let s=this._framebuffers.get(n);const a=this.getColorTexture(t,e);if(this.depthTextureSupported){const l=r?this.getDepthTexture(r,e):void 0;return s?((s.width!==e.width||s.height!==e.height||s.colorTexture!==a||s.depthStencilTexture!==l)&&(s.detachAll(),s.resize(e.width,e.height),s.attachColorTexture(a),s.attachDepthStencilTexture(l)),s):(s=y(r)?new yn(this._rctx,{colorTarget:Vn.TEXTURE,depthStencilTarget:rs.DEPTH_STENCIL_TEXTURE},a,l):new yn(this._rctx,{colorTarget:Vn.TEXTURE,depthStencilTarget:rs.NONE},a),this._framebuffers.set(n,s),s)}const o=r?this.getDepthBuffer(r,e):void 0;return s?((s.width!==e.width||s.height!==e.height||s.colorTexture!==a)&&(s.detachAll(),s.resize(e.width,e.height),s.attachColorTexture(a),s.attachDepthStencilBuffer(o)),s):(s=new yn(this._rctx,{colorTarget:Vn.TEXTURE,depthStencilTarget:r?rs.DEPTH_STENCIL_RENDER_BUFFER:rs.NONE},a,o),this._framebuffers.set(n,s),s)}_getKey(e,t){return`${e.id}_${t?t.id:"X"}_${e.name}${t?"_"+t.name:""}`}get gpuMemoryUsage(){let e=0;const t=new Set,r=n=>{t.has(n)||(t.add(n),e+=kE(n))};return this._depthTextures.forEach(r),this._colorTextures.forEach(r),this._depthBuffers.forEach(r),e}},iIe=class{constructor(e,t){this._rctx=e,this._compositingHelper=t,this._mainColorTarget=0,this._dimensions={width:4,height:4},this._background={type:"color",color:[0,0,0,1]};const r=e.type===Nn.WEBGL2;this._renderTargetHelper=new tIe(e);const n=this._renderTargetHelper;this._mainColorTargets=[n.registerColorTarget({name:"mainColorTarget0"}),n.registerColorTarget({name:"mainColorTarget1"})],this.frontFaceTarget=n.registerColorTarget({name:"frontFaceTarget"});const s=a=>n.registerColorTarget({name:a,dataType:qt.FLOAT,internalFormat:r?yS.RGBA32F:yt.RGBA,samplingMode:Kt.NEAREST});this.colorFloatTarget=s("colorFloatTarget"),this.alphaFloatTarget=s("alphaFloatTarget"),this.mainDepth=n.registerDepthTarget({name:"mainDepth"}),this.linearDepth=n.registerColorTarget({name:"linearDepth",samplingMode:Kt.NEAREST}),this.terrainLinearDepth=n.registerColorTarget({name:"terrainLinearDepth"}),this.geometryLinearDepth=n.registerColorTarget({name:"geometryLinearDepth"}),this.normal=n.registerColorTarget({name:"normal"}),this.highlight=n.registerColorTarget({name:"highlight",internalFormat:r?yS.RGBA4:yt.RGBA,dataType:qt.UNSIGNED_SHORT_4_4_4_4}),this.hudVisibility=n.registerColorTarget({name:"hudVisibility",internalFormat:r?yS.RGBA4:yt.RGBA,dataType:qt.UNSIGNED_SHORT_4_4_4_4}),this.tmpColor=n.registerColorTarget({name:"tmpColor"}),this.tmpDepth=n.registerDepthTarget({name:"tmpDepth"}),this.hudColor=n.registerColorTarget({name:"hudColor"})}dispose(){this._renderTargetHelper.dispose()}get width(){return this._dimensions.width}get height(){return this._dimensions.height}set background(e){this._background=e}get background(){return this._background}get currentColorTarget(){return this._mainColorTargets[this._mainColorTarget]}get previousColorTarget(){return this._mainColorTargets[1-this._mainColorTarget]}get framebuffer(){return this.getFramebuffer(this.currentColorTarget,this.mainDepth)}getFramebuffer(e,t){return this._renderTargetHelper.getFramebuffer(this._dimensions,e,t)}get colorTexture(){return this._renderTargetHelper.getAllocatedColorTexture(this.currentColorTarget)}get depthTexture(){return this._renderTargetHelper.getAllocatedDepthTexture(this.mainDepth)}get linearDepthTexture(){return this._renderTargetHelper.getAllocatedColorTexture(this.linearDepth)}get terrainLinearDepthTexture(){return this._renderTargetHelper.getAllocatedColorTexture(this.terrainLinearDepth)}get geometryLinearDepthTexture(){return this._renderTargetHelper.getAllocatedColorTexture(this.geometryLinearDepth)}get lastFrameColorTexture(){return this._renderTargetHelper.getAllocatedColorTexture(this.previousColorTarget)}get normalTexture(){return this._renderTargetHelper.getAllocatedColorTexture(this.normal)}get highlightTexture(){return this._renderTargetHelper.getAllocatedColorTexture(this.highlight)}get hudVisibilityTexture(){return this._getColorTexture(this.hudVisibility)}get tmpColorTexture(){return this._getColorTexture(this.tmpColor)}get hudColorTexture(){return this._getColorTexture(this.hudColor)}get mainColorTexture(){return this._getColorTexture(this.currentColorTarget)}setupRenderTarget(e){e||(this._mainColorTarget=0,this.disposeTarget(this._mainColorTargets[1])),this._mainColorTarget=this._mainColorTarget===0&&e?1:0}initializeFrame(e){const t=this._rctx;this._dimensions.width=e.fullWidth,this._dimensions.height=e.fullHeight,this.bindTarget(this.currentColorTarget,this.mainDepth),t.setClearStencil(0);const r=this._background.color;t.setClearColor(r[0]*r[3],r[1]*r[3],r[2]*r[3],r[3]),t.clearSafe(Ai.COLOR_BUFFER_BIT|Ai.DEPTH_BUFFER_BIT|Ai.STENCIL_BUFFER_BIT)}composite(e){y(this.colorTexture)&&this._compositingHelper.composite(e,this.colorTexture,Es.None)}renderTmpAndCompositeToMain(e,t,r,n=!1){this.renderToTargets(e,this.tmpColor,n?this.tmpDepth:this.mainDepth,rIe),this._compositingHelper.composite(t,this._getColorTexture(this.tmpColor),r)}renderHUDVisibility(e,t=!1){this.renderToTargets(e,this.hudVisibility,t?this.tmpDepth:this.mainDepth,nIe)}compositeTransparentTerrainOntoHUDVisibility(e){this.renderToTargets(()=>this._compositingHelper.compositeHUD(e,this._getColorTexture(this.tmpColor)),this.hudVisibility,this.tmpDepth)}renderOITPass(e,t,r){let n,s;switch(t){case Ht.Color:n=this.colorFloatTarget,s=[0,0,0,0];break;case Ht.Alpha:n=this.alphaFloatTarget,s=[1,1,1,1];break;case Ht.FrontFace:n=this.frontFaceTarget,s=[0,0,0,0]}r?this.renderToTargets(e,n,this.tmpDepth,s,!0,!0):this.renderToTargets(e,n,this.mainDepth,s,!1)}compositeTransparentTerrainOntoMain(e){this.bindFramebuffer(),this._compositingHelper.composite(e,this._getColorTexture(this.tmpColor),Es.PremultipliedAlpha)}compositeOccludedOntoMain(e,t){this.bindFramebuffer(),this._compositingHelper.composite(e,this._getColorTexture(this.tmpColor),Es.PremultipliedAlpha,t)}compositeTransparentOntoOpaque(e,t){t?(this.bindTarget(this.hudColor,this.tmpDepth),this._rctx.setClearColor(0,0,0,1e-13),this._rctx.clearSafe(Ai.COLOR_BUFFER_BIT)):this.bindFramebuffer(),this._compositingHelper.compositeOIT(e,this._getColorTexture(this.colorFloatTarget),this._getColorTexture(this.alphaFloatTarget),this._getColorTexture(this.frontFaceTarget))}bindFramebuffer(){this._rctx.bindFramebuffer(this.framebuffer)}renderDepthDetached(e){this.bindTarget(this.currentColorTarget),e(),this.bindTarget(this.currentColorTarget,this.mainDepth)}disposeTarget(e){this._renderTargetHelper.disposeTargetResource(e)}renderToFBO(e,t,r=!1,n=!1){const s=this._rctx;let a=0;if(t){const l=Math.max(1e-13,t[3]);s.setClearColor(t[0],t[1],t[2],l),a|=Ai.COLOR_BUFFER_BIT}r&&(a|=Ai.DEPTH_BUFFER_BIT),n===!1?n=0:(n===!0&&(n=255),a|=Ai.STENCIL_BUFFER_BIT),a&&s.clearSafe(a,n),e(),s.gl.flush(),this.bindTarget(this.currentColorTarget,this.mainDepth)}renderToTargets(e,t,r,n,s=!1,a=!1){const o=this.bindTarget(t,r);return this.renderToFBO(e,n,s,a),o}bindTarget(e,t){const r=this._renderTargetHelper.getFramebuffer(this._dimensions,e,t);return this._rctx.bindFramebuffer(r),r}_getColorTexture(e){return this._renderTargetHelper.getColorTexture(e,this._dimensions)}get gpuMemoryUsage(){let e=0;return this._renderTargetHelper&&(e+=this._renderTargetHelper.gpuMemoryUsage),e}};const rIe=[0,0,0,0],nIe=[0,1,0,1];let sIe=class{constructor(e){this._context=e,this._renderPlugins=new Zt,this._slots=[];for(let t=0;t<ae.MAX_SLOTS;++t)this._slots[t]=[]}add(e,t,r){const n=()=>{if(r!=null&&r.aborted)throw t.uninitializeRenderContext(),ts();this._renderPlugins.push(t);for(const a of e)this._slots[a].push(t);this._context.requestRender()},s=t.initializeRenderContext(this._context,r);if(Mx(s))return s.then(n);n()}remove(e){if(this._renderPlugins.removeUnordered(e)!=null){for(let t=0;t<this._slots.length;++t)this._slots[t]=this._slots[t].filter(r=>r!==e);e.uninitializeRenderContext(),this._context.requestRender()}}prepareRender(){this._renderPlugins.forAll(e=>{e.prepareRender&&e.prepareRender(this._context.renderContext)})}updateAnimation(e){let t=!1;return this._renderPlugins.forAll(r=>{r.updateAnimation&&(t=r.updateAnimation(e)||t)}),t}render(){const e=this._slots[this._context.renderContext.bindParameters.slot],t=new Array;e.filter(r=>{if(!r.canRender)return!1;if(aIe(r)){const n=r.prepareTechnique(this._context.renderContext);return!!n&&(t.push(n),!0)}return t.push(null),!0}).forEach((r,n)=>r.render(this._context.renderContext,t[n]))}queryDepthRange(e){const t=oIe;return t.near=1/0,t.far=-1/0,this._renderPlugins.forAll(r=>{if(r.queryDepthRange){const n=r.queryDepthRange(e);n&&dv(t,n,t)}}),t}get needsTransparentPass(){return this._renderPlugins.some(e=>e.needsTransparentPass)}get needsHighlight(){return this._renderPlugins.some(e=>e.needsHighlight)}get needsLinearDepth(){return this._renderPlugins.some(e=>e.needsLinearDepth)}get needsLaserlineWithContrastControl(){const e=this._slots[ae.LASERLINES_CONTRAST_CONTROL];return!!e&&e.length>0}get renderOccludedFlags(){return this._renderPlugins.reduce((e,t)=>e|t.renderOccludedFlags,0)}};function aIe(i){return"prepareTechnique"in i}const oIe={near:0,far:0};let YJ=class extends vG{};const HR=255,lIe=1/HR;function cIe(i){const e=new Yi,t=e.fragment;return t.include(e_),t.include(Og),e.include(XD),e.include(Nd),e.include(yG,i),t.uniforms.add([new Bt("depthMap",r=>r.linearDepthTexture),new Ys("inverseViewMatrix",(r,n)=>kn(hB,ru(hB,n.camera.viewMatrix,n.camera.center))),new Zs("nearFar",(r,n)=>n.camera.nearFar)]),t.constants.add("sampleValue","float",lIe),t.code.add(O`void main(void) {
float depth = rgba2float(texture2D(depthMap, uv));
if (depth == 0.0) {
discard;
}
float currentPixelDepth = linearDepthFromFloat(depth, nearFar);
if (-currentPixelDepth > nearFar.y || -currentPixelDepth < nearFar.x) {
discard;
}
vec4 currentPixelPos = vec4(reconstructPosition(gl_FragCoord.xy, currentPixelDepth), 1.0);
vec4 worldSpacePos = inverseViewMatrix * currentPixelPos;
mat4 shadowMatrix;
float linearDepth = -currentPixelDepth;
int i = chooseCascade(linearDepth, shadowMatrix);
if (i >= numCascades) {
discard;
}
vec3 lvpos = lightSpacePosition(worldSpacePos.xyz, shadowMatrix);
if (lvpos.z >= 1.0 || lvpos.x < 0.0 || lvpos.x > 1.0 || lvpos.y < 0.0 || lvpos.y > 1.0) {
discard;
}
vec2 uvShadow = cascadeCoordinates(i, lvpos);
float depthShadow = readShadowMapDepth(uvShadow, shadowMapTex);
bool shadow = depthShadow < lvpos.z;
if (!shadow) {
discard;
}
gl_FragColor = vec4(sampleValue);
}`),e}const hB=ve(),hIe=Object.freeze(Object.defineProperty({__proto__:null,ShadowCastAccumulatePassParameters:YJ,shadowCastMaxSamples:HR,build:cIe},Symbol.toStringTag,{value:"Module"}));var Qg;(function(i){i[i.Gradient=0]="Gradient",i[i.Threshold=1]="Threshold",i[i.COUNT=2]="COUNT"})(Qg||(Qg={}));let I$=class extends $a{constructor(){super(...arguments),this.visualization=Qg.Gradient,this.bandsEnabled=!1}};h([N({count:Qg.COUNT})],I$.prototype,"visualization",void 0),h([N()],I$.prototype,"bandsEnabled",void 0);function uIe(i){const e=new Yi,t=e.fragment;t.include(e_),t.include(Og),e.include(XD),e.include(Nd);const{visualization:r,bandsEnabled:n}=i;t.constants.add("inverseSampleValue","float",HR),t.uniforms.add([new Bt("shadowCastMap",o=>o.shadowCastMap),new Tt("sampleScale",o=>o.sampleScale),new Tt("opacityFromElevation",o=>o.opacityFromElevation),new Xh("uColor",o=>o.color)]);const s=r===Qg.Gradient,a=r===Qg.Threshold;return s&&n?t.uniforms.add(new Tt("bandSize",o=>o.bandSize)):a&&t.uniforms.add(new Tt("threshold",o=>o.threshold)),t.code.add(O`
      void main(void) {
        vec4 record = texture2D(shadowCastMap, uv);
        float pixelSamples = record.r * inverseSampleValue;
        if (pixelSamples < 1.0) {
          discard;
        }

        float strength = pixelSamples * sampleScale;

        ${a?O`
            if (strength <= threshold) {
              discard;
            }`:""}

        ${s&&n?O`strength = ceil(strength / bandSize) * bandSize;`:""}

        gl_FragColor = vec4(uColor.xyz, uColor.a * opacityFromElevation ${s?O`* strength`:""});
      }
    `),e}const dIe=Object.freeze(Object.defineProperty({__proto__:null,build:uIe},Symbol.toStringTag,{value:"Module"}));let KJ=class JJ extends ti{constructor(e,t){super(e,t,()=>this.destroy())}initializeProgram(e){return new Jt(e.rctx,JJ.shader.get().build(this.configuration),ai)}initializePipeline(){return Ke({blending:Hl,colorWrite:ht,depthTest:null,depthWrite:null})}get primitiveType(){return Dt.TRIANGLE_STRIP}};KJ.shader=new ii(dIe,()=>G(()=>import("./ShadowCastVisualize.glsl-9adb2ed2.js"),["assets/ShadowCastVisualize.glsl-9adb2ed2.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/VertexAttribute-9c5c630d.js","assets/vec2-528adfe4.js","assets/common-c186b691.js","assets/vec2f64-30dc1443.js","assets/vec4-790471c0.js","assets/vec4f64-e407da96.js","assets/Texture2DPassUniform-753de459.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));const pIe=Bi(.01,0,.25,1),mIe=4e4,fIe=5e4,eee=1/512;let vE=class extends ue{constructor(i,e,t,r){super({}),this._techniqueRepository=i,this._rctx=e,this._shadowAccumulator=t,this._requestRender=r,this._passParameters={shadowCastMap:this._shadowCastTexture,sampleScale:0,color:pIe,threshold:.5,bandSize:.1,opacityFromElevation:1,__tagStrict:"NoParameters"},this._techniqueConfig=new I$,this._enabled=!1,this._vao=La(e),this._techniqueConfig.visualization=Qg.Gradient}normalizeCtorArgs(){return{}}dispose(){this._stop(),this._vao=Me(this._vao),this._techniqueRepository.release(this._technique),this._technique=null,this._shadowAccumulator=null}get _visualizeShadowCastTechnique(){return this._technique=this._techniqueRepository.releaseAndAcquire(KJ,this._techniqueConfig,this._technique),this._technique}render(i){if(!this._isRenderingVisualization)return;this._passParameters.sampleScale=1/this._computedSamples;const e=this._visualizeShadowCastTechnique;this._rctx.bindVAO(this._vao),this._rctx.bindTechnique(e,this._passParameters,i),this._rctx.drawArrays(e.primitiveType,0,Ws(this._vao,"geometry"))}setOptions(i){i.enabled!==void 0&&this._setEnabled(i.enabled),i.color!==void 0&&this._setColor(i.color),i.threshold!==void 0&&(this._threshold=i.threshold),i.visualization!==void 0&&(this._visualization=i.visualization),i.bandSize!==void 0&&(this._bandSize=i.bandSize),i.bandsEnabled!==void 0&&(this._bandsEnabled=i.bandsEnabled)}get opacityFromElevation(){return this._passParameters.opacityFromElevation}set opacityFromElevation(i){this._passParameters.opacityFromElevation!==i&&(this._passParameters.opacityFromElevation=i,this.notifyChange("opacityFromElevation"))}get _isRenderingVisualization(){return this._enabled&&this._computedSamples>0&&this.opacityFromElevation>eee}get _computedSamples(){return this._shadowAccumulator.computedSamples}get _shadowCastTexture(){return this._shadowAccumulator.shadowCastTexture}get _threshold(){return this._passParameters.threshold}set _threshold(i){this._threshold!==i&&(this._passParameters.threshold=i,this._requestRenderIfRunning())}get _visualization(){return this._techniqueConfig.visualization}set _visualization(i){i!==this._visualization&&(this._techniqueConfig.visualization=i,this._techniqueRepository.release(this._technique),this._technique=null,this._requestRenderIfRunning())}get _bandSize(){return this._passParameters.bandSize}set _bandSize(i){i!==this._bandSize&&(this._passParameters.bandSize=i,this._requestRenderIfRunning())}get _bandsEnabled(){return this._techniqueConfig.bandsEnabled}set _bandsEnabled(i){i!==this._bandsEnabled&&(this._techniqueConfig.bandsEnabled=i,this._techniqueRepository.release(this._technique),this._technique=null,this._requestRenderIfRunning())}_setColor(i){const e=this._passParameters.color;SI(i,e)||(im(this._passParameters.color,i),this._requestRenderIfRunning())}_setEnabled(i){i!==this._enabled&&(i?this._start():this._stop())}_requestRenderIfRunning(){this._enabled&&this._requestRender()}_start(){this._enabled=!0,this._requestRender()}_stop(){this._enabled=!1,this._requestRender()}};h([p()],vE.prototype,"opacityFromElevation",null),vE=h([D("esri.views.3d.webgl-engine.lib.ShadowCastRenderer")],vE);let gP=class extends $a{constructor(){super(...arguments),this.receiveShadows=!0,this.hasWebGL2Context=!1}};h([N()],gP.prototype,"receiveShadows",void 0),h([N()],gP.prototype,"hasWebGL2Context",void 0);let tee=class iee extends ti{constructor(e){super(e,new gP,()=>this.destroy())}initializeConfiguration(e,t){t.hasWebGL2Context=e.rctx.type===Nn.WEBGL2}initializeProgram(e){return new Jt(e.rctx,iee.shader.get().build(this.configuration),ai)}initializePipeline(){return Ke({blending:Gn(de.ONE,de.ONE,de.ONE,de.ONE),colorWrite:ht,depthTest:null,depthWrite:null})}get primitiveType(){return Dt.TRIANGLE_STRIP}};tee.shader=new ii(hIe,()=>G(()=>import("./ShadowCastAccumulate.glsl-9b880715.js"),["assets/ShadowCastAccumulate.glsl-9b880715.js","assets/mat4-44a0988f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/mat4f64-1e28eae0.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/VertexAttribute-9c5c630d.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/Texture2DPassUniform-753de459.js","assets/vec4-790471c0.js","assets/vec4f64-e407da96.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));var bb;let _s=bb=class extends ue{constructor(i,e,t,r,n,s){super({}),this._rctx=i,this._stage=t,this._prepareForShadowMapPass=r,this._renderToShadowMap=n,this._requestRender=s,this._progress=0,this._sampleCount=0,this._passParameters=new YJ,this._enabledInternal=!1,this._cachedLightDirections=[],this._depthRange=P$,this._previewingCached=!1,this._handles=new Ft,this._cameraForcedForScreenshot=!1,this._bindParameters=new yR(new f4(i,t.viewingMode),null,null),this._bindParameters.shadowMap.enabled=!0,this._bindParameters.camera=new yi,this._vao=La(i);const a={colorTarget:Vn.TEXTURE,depthStencilTarget:rs.NONE,width:0,height:0},o={target:vi.TEXTURE_2D,pixelFormat:yt.RGBA,dataType:qt.UNSIGNED_BYTE,samplingMode:Kt.LINEAR,wrapMode:si.CLAMP_TO_EDGE,width:0,height:0};this._fbo=new yn(i,a,o),this._accumulationRenderer=new vE(e,i,this,s);const l=this._stage.resourceController.scheduler;this._handles.add(l.registerTask(dr.SHADOW_ACCUMULATOR,this)),this._handles.add(z(()=>t.renderView,c=>{this._handles.remove(bb.renderViewHandleKey),S(c)||this._handles.add(c.events.on("force-camera-for-screenshot",()=>this._cameraForcedForScreenshot=!0),bb.renderViewHandleKey)},Oi))}normalizeCtorArgs(){return{}}get computedSamples(){return this._progress}get shadowCastTexture(){return this._fbo.colorTexture}get isAccumulating(){return this._isPreviewing||this._isRefining}get _accumulationTechnique(){if(S(this._accumulationTechniqueCached)){const i={rctx:this._rctx,viewingMode:this._stage.viewingMode};this._accumulationTechniqueCached=new tee(i)}return this._accumulationTechniqueCached}get _isRefining(){return this._isActive&&!this._isDoneAccumulating&&!this._previewingCached}get _isPreviewing(){return this._isActive&&this._previewingCached}get _isActive(){return this._enabledInternal&&this._sampleCount>0}get canAccumulate(){return this._passParameters.linearDepthTexture!==null&&this._depthRange!==P$&&this._opacityFromElevation>eee}get _isDoneAccumulating(){return this._progress>=this._sampleCount}get _lightDirectionsInternal(){return this._cachedLightDirections}set _lightDirectionsInternal(i){const e=this._cachedLightDirections;if(K$(e,i,Rg))return;const t=i.length;e.length=t,this._sampleCount=Math.min(HR,t);for(let r=0;r<t;++r){const n=i[r],s=e[r]||R();q(s,n),e[r]=s}this._invalidate()}get _opacityFromElevation(){return this._accumulationRenderer.opacityFromElevation}set _opacityFromElevation(i){this._accumulationRenderer.opacityFromElevation=i}get running(){return this._isRefining&&this.canAccumulate&&this._progress>0}runTask(i){for(this._prepareForShadowMapPass(this._bindParameters);!i.done&&!this._isDoneAccumulating;)this._accumulateShadow(),i.madeProgress();this._requestRender()}renderAccumulation(i,e,t,r){if(this._passParameters.linearDepthTexture=i,this._depthRange=e,this._updateCamera(t),this._bindParameters.contentCamera=r,this.notifyChange("canAccumulate"),!this.isAccumulating||!this.canAccumulate)return;(this._previewingCached||this._progress===0||this._cameraForcedForScreenshot)&&this._clear();const n=this._cameraForcedForScreenshot?this._sampleCount:Math.min(bb.previewSamples,this._sampleCount-this._progress);for(let s=0;s<n;++s)this._accumulateShadow();this._cameraForcedForScreenshot=!1}render(i){this._accumulationRenderer.render(i)}dispose(){this._stop(),this._handles.destroy(),this._accumulationRenderer=Me(this._accumulationRenderer),this._bindParameters.shadowMap.dispose(),this._fbo=Me(this._fbo),this._vao=Me(this._vao),this._accumulationTechniqueCached=Qi(this._accumulationTechniqueCached),this._cachedLightDirections.length=0,this._sampleCount=0}setOptions(i){i.enabled!==void 0&&(this._enabled=i.enabled),i.previewing!==void 0&&(this._previewing=i.previewing),i.lightDirections!==void 0&&(this._lightDirections=i.lightDirections),this._accumulationRenderer.setOptions(i)}set _previewing(i){this._previewingCached!==i&&(this._previewingCached=i,this._requestRenderIfEnabled())}set _lightDirections(i){this._lightDirectionsInternal=i}readAccumulatedShadow(i,e){if(!this._isActive||this._progress<1||i<0||i>this._fbo.width||e<0||e>this._fbo.height)return 0;const t=gIe;return this._fbo.readPixels(i,e,1,1,yt.RGBA,qt.UNSIGNED_BYTE,t),t[0]/this._progress}_start(){this._progress=0,this._enabledInternal=!0}_stop(){this._enabledInternal=!1}_invalidate(){this._progress=0,this._requestRenderIfEnabled()}_clear(){this._rctx.bindFramebuffer(this._fbo),this._rctx.setClearColor(0,0,0,0),this._rctx.clearSafe(Ai.COLOR_BUFFER_BIT),this._progress=0}_accumulateShadow(){const i=this._lightDirectionsInternal[this._progress];this._renderToShadowMap(this._bindParameters,i,this._depthRange),this._passParameters.origin=this._bindParameters.camera.center,this._rctx.bindFramebuffer(this._fbo);const e=this._accumulationTechnique;this._rctx.bindTechnique(e,this._passParameters,this._bindParameters),this._rctx.bindVAO(this._vao),this._rctx.drawArrays(e.primitiveType,0,Ws(this._vao,"geometry")),this._progress++}_updateCamera(i){i.equals(this._bindParameters.camera)||(this._bindParameters.camera.copyFrom(i),this._fbo.resize(i.fullWidth,i.fullHeight),this._opacityFromElevation=1-U0(mIe,fIe,i.relativeElevation))}set _enabled(i){i!==this._enabledInternal&&(i?this._start():this._stop())}_requestRenderIfEnabled(){this._enabledInternal&&this._requestRender()}get test(){const i=this;return{lightDirections:this._lightDirectionsInternal,get isDone(){return i._isDoneAccumulating},get isActive(){return i._isActive}}}};_s.previewSamples=6,_s.renderViewHandleKey="renderView",h([p()],_s.prototype,"_progress",void 0),h([p()],_s.prototype,"_sampleCount",void 0),h([p()],_s.prototype,"_enabledInternal",void 0),h([p()],_s.prototype,"_depthRange",void 0),h([p()],_s.prototype,"_previewingCached",void 0),h([p()],_s.prototype,"_accumulationRenderer",void 0),h([p()],_s.prototype,"_isRefining",null),h([p()],_s.prototype,"_isActive",null),h([p()],_s.prototype,"canAccumulate",null),h([p()],_s.prototype,"_isDoneAccumulating",null),h([p()],_s.prototype,"_opacityFromElevation",null),h([p()],_s.prototype,"running",null),_s=bb=h([D("esri.views.3d.webgl-engine.lib.ShadowAccumulator")],_s);const gIe=new Uint8Array(4),uB={highlightedThreshold:.99999,selfShadowThreshold:.025};function _Ie(i){const e=new Yi;e.include(_G,i);const t=e.fragment;return t.include(e_),t.include(Og),e.include(XD),e.include(Nd),t.uniforms.add([new Bt("defaultDepthTex",(r,n)=>n.shadowMap.getSnapshot(cv.Default)),new Bt("highlightDepthTex",(r,n)=>n.shadowMap.getSnapshot(cv.Highlight)),new Bt("depthMap",(r,n)=>n.linearDepthTexture),new Bt("highlightMap",(r,n)=>n.highlightColorTexture),new Xh("uColor",r=>r.shadowColor),new Zs("nearFar",(r,n)=>n.camera.nearFar),new Tt("opacity",r=>r.shadowOpacity),new Tt("occludedOpacity",r=>r.occludedShadowOpacity),new Tt("terminationFactor",r=>r.opacityElevation*r.dayNightTerminator),new Rs("lightingMainDirectionView",(r,n)=>he(pB,Ce(pB,n.lighting.mainLight.direction,n.camera.viewInverseTransposeMatrix))),new Zs("texelSize",(r,n)=>y(n.linearDepthTexture)?Je(yIe,1/n.linearDepthTexture.descriptor.width,1/n.linearDepthTexture.descriptor.height):Pg),new Ys("inverseViewMatrix",(r,n)=>kn(dB,ru(dB,n.camera.viewMatrix,n.camera.center)))]),t.constants.add("unoccludedHighlightFlag","vec4",Tae).add("highlightedThreshold","float",uB.highlightedThreshold).add("selfShadowThreshold","float",uB.selfShadowThreshold),t.code.add(O`vec3 normalFromDepth(vec3 pixelPos, vec2 fragCoord, vec2 uv, vec2 texelSize, sampler2D depthMap, vec2 nearFar) {
float leftPixelDepth = linearDepthFromTexture(depthMap, uv + vec2(-1.0, 0.0) * texelSize, nearFar);
float rightPixelDepth = linearDepthFromTexture(depthMap, uv + vec2(1.0, 0.0) * texelSize, nearFar);
float bottomPixelDepth = linearDepthFromTexture(depthMap, uv + vec2(0.0, -1.0) * texelSize, nearFar);
float topPixelDepth = linearDepthFromTexture(depthMap, uv + vec2(0.0, 1.0) * texelSize, nearFar);
bool pickLeft = abs(pixelPos.z - leftPixelDepth) < abs(pixelPos.z - rightPixelDepth);
bool pickBottom = abs(pixelPos.z - bottomPixelDepth) < abs(pixelPos.z - topPixelDepth);
vec3 fragCoordHorizontal = pickLeft
? vec3(fragCoord + vec2(-1.0, 0.0), leftPixelDepth)
: vec3(fragCoord + vec2(1.0, 0.0), rightPixelDepth);
vec3 fragCoordVertical = pickBottom
? vec3(fragCoord + vec2(0.0, -1.0), bottomPixelDepth)
: vec3(fragCoord + vec2(0.0, 1.0), topPixelDepth);
vec3 verticalPixelPos = reconstructPosition(fragCoordHorizontal.xy, fragCoordHorizontal.z);
vec3 horizontalPixelPos = reconstructPosition(fragCoordVertical.xy, fragCoordVertical.z);
vec3 normal = normalize(cross(verticalPixelPos - pixelPos, horizontalPixelPos - pixelPos));
return pickLeft == pickBottom ? normal : -normal;
}`),t.code.add(O`void main(void) {
vec4 highlightInfo = texture2D(highlightMap, uv);
float visiblyHighlighted = (1.0 - clamp(distance(unoccludedHighlightFlag, highlightInfo), 0.0, 1.0)) * highlightInfo.a;
if (visiblyHighlighted > highlightedThreshold) {
discard;
}
float depth = rgba2float(texture2D(depthMap, uv));
if (depth == 0.0) {
discard;
}
float currentPixelDepth = linearDepthFromFloat(depth, nearFar);
if (-currentPixelDepth>nearFar.y || -currentPixelDepth<nearFar.x) {
discard;
}
vec4 currentPixelPos = vec4(reconstructPosition(gl_FragCoord.xy, currentPixelDepth), 1.0);
vec4 worldSpacePos = inverseViewMatrix * currentPixelPos;
mat4 shadowMatrix;
float linearDepth = -currentPixelDepth;
int i = chooseCascade(linearDepth, shadowMatrix);
if (i >= numCascades) {
discard;
}
vec3 lvpos = lightSpacePosition(worldSpacePos.xyz, shadowMatrix);
if (lvpos.z >= 1.0 || lvpos.x < 0.0 || lvpos.x > 1.0 || lvpos.y < 0.0 || lvpos.y > 1.0) {
discard;
}
vec2 uvShadow = cascadeCoordinates(i, lvpos);
float depthHighlight = readShadowMapDepth(uvShadow, highlightDepthTex);
bool shadowHighlight = depthHighlight < lvpos.z;
if (!shadowHighlight) {
discard;
}
float depthDefault = readShadowMapDepth(uvShadow, defaultDepthTex);
bool shadowDefault = depthDefault < lvpos.z;
vec3 normal = normalFromDepth(currentPixelPos.xyz, gl_FragCoord.xy, uv, texelSize, depthMap, nearFar);
bool shaded = dot(normal, lightingMainDirectionView) < selfShadowThreshold;
float fragOpacity = (shadowDefault || shaded) ? occludedOpacity : opacity;
gl_FragColor = vec4(uColor.rgb, uColor.a * fragOpacity * terminationFactor);
}`),e}const dB=ve(),pB=R(),yIe=be(),vIe=Object.freeze(Object.defineProperty({__proto__:null,build:_Ie},Symbol.toStringTag,{value:"Module"}));let bIe=class extends Ir{constructor(){super(...arguments),this.shadowColor=Bi(1,0,1,1),this.shadowOpacity=.2,this.occludedShadowOpacity=.1,this.opacityElevation=1,this.dayNightTerminator=1}},ree=class nee extends ti{constructor(e){super(e,new gP,()=>this.destroy())}initializeConfiguration(e,t){t.hasWebGL2Context=e.rctx.type===Nn.WEBGL2}initializeProgram(e){return new Jt(e.rctx,nee.shader.get().build(this.configuration),ai)}initializePipeline(){return Ke({blending:Gn(de.SRC_ALPHA,de.ONE,de.ONE_MINUS_SRC_ALPHA,de.ONE_MINUS_SRC_ALPHA),colorWrite:ht,depthTest:null,depthWrite:null})}get primitiveType(){return Dt.TRIANGLE_STRIP}};ree.shader=new ii(vIe,()=>G(()=>import("./ShadowHighlight.glsl-1d5a9ceb.js"),["assets/ShadowHighlight.glsl-1d5a9ceb.js","assets/mat4-44a0988f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/mat4f64-1e28eae0.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/vec3-e93e648f.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/VertexAttribute-9c5c630d.js","assets/vec4f64-e407da96.js","assets/Texture2DPassUniform-753de459.js","assets/vec4-790471c0.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));const wIe=.001953125,xIe=4e4,TIe=5e4;let CIe=class{constructor(e,t){this._rctx=e,this._viewingMode=t,this._maxOpacity=1,this._passParameters=new bIe,this._drawParameters=new vG,this._vao=La(this._rctx)}get _technique(){return S(this._techniqueCached)&&(this._techniqueCached=new ree({rctx:this._rctx,viewingMode:this._viewingMode})),this._techniqueCached}render(e,t){if(!e.shadowMap.enabled||!e.linearDepthTexture||!this.isVisible)return;const r=this._technique;this._drawParameters.origin=e.camera.center,this._rctx.bindFramebuffer(t),this._rctx.bindTechnique(r,this._passParameters,e).bindDraw(this._drawParameters,e,this._passParameters),this._rctx.bindVAO(this._vao),this._rctx.drawArrays(r.primitiveType,0,Ws(this._vao,"geometry"))}get gpuMemoryUsage(){var e;return((e=this._vao)==null?void 0:e.size)??0}setDefaultOptions(e){this._passParameters={...this._passParameters,...e},this._updateMaxOpacity()}updateParameters(e,t){this._passParameters.opacityElevation=1-U0(xIe,TIe,e.relativeElevation);const r=this._viewingMode===Se.Global?he(mB,e.center):Z(mB,0,0,1),n=me(r,t);this._passParameters.dayNightTerminator=U0(0,1,ce(30*n,0,1))}dispose(){this._vao=Me(this._vao),this._techniqueCached=Qi(this._techniqueCached)}get isVisible(){const{opacityElevation:e,dayNightTerminator:t}=this._passParameters;return this._maxOpacity*e*t>=wIe}_updateMaxOpacity(){const e=Math.max(this._passParameters.shadowOpacity,this._passParameters.occludedShadowOpacity);this._maxOpacity=e*this._passParameters.shadowColor[3]}};const mB=R(),fB=zd();let SIe=class{constructor(){this._plane=zd()}get isEnabled(){return!eQ(this.plane,fB)}get plane(){return this._plane}set plane(e){o_(e||fB,this._plane)}},EIe=class extends Ir{};function Cx(i){i.uniforms.add(new Xh("resolution",e=>Qs(PIe,1/e.colorTexture.descriptor.width,1/e.colorTexture.descriptor.height,e.colorTexture.descriptor.width,e.colorTexture.descriptor.height)))}const PIe=_i(),oy={maxSearchSteps:8,maxDistanceAreaTex:16};function RIe(){const i=new Yi,{attributes:e,varyings:t,vertex:r,fragment:n}=i;return e.add(P.POSITION,"vec2"),t.add("fTexCoord","vec2"),t.add("fOffset[3]","vec4"),t.add("fPixCoord","vec2"),Cx(r),r.code.add(O`
      void SMAABlendingWeightCalculationVS( vec2 texcoord ) {
        fPixCoord = texcoord * resolution.zw;
        fOffset[0] = texcoord.xyxy + resolution.xyxy * vec4( -0.25, 0.125, 1.25, 0.125 );
        fOffset[1] = texcoord.xyxy + resolution.xyxy * vec4( -0.125, 0.25, -0.125, -1.25 );
        fOffset[2] = vec4( fOffset[0].xz, fOffset[1].yw ) + vec4( -2.0, 2.0, -2.0, 2.0 ) * resolution.xxyy * float( ${O.int(oy.maxSearchSteps)} );
      }

      void main() {
        fTexCoord = (position + 1.0 ) * 0.5;
        gl_Position = vec4(position, 0, 1);
        SMAABlendingWeightCalculationVS( fTexCoord );
      }
    `),n.uniforms.add(new Bt("tEdges",s=>s.edges.colorTexture)),n.uniforms.add(new Bt("tArea",s=>s.areaTexture)),n.uniforms.add(new Bt("tSearch",s=>s.searchTexture)),n.uniforms.add(new Bt("tColor",s=>s.colorTexture)),Cx(n),n.code.add(O`
      #define SMAA_AREATEX_PIXEL_SIZE ( 1.0 / vec2( 160.0, 560.0 ) )
      #define SMAA_AREATEX_SUBTEX_SIZE ( 1.0 / 7.0 )

      vec4 SMAASampleLevelZeroOffset(sampler2D texture, vec2 coord, vec2 offset) {
        return texture2D(texture, coord + offset.x * resolution.xy, 0.0);
      }

      vec2 round( vec2 x ) {
        return sign( x ) * floor( abs( x ) + 0.5 );
      }

      float SMAASearchLength( sampler2D searchTex, vec2 e, float bias, float scale ) {
        e.r = bias + e.r * scale;
        return 255.0 * texture2D( searchTex, e, 0.0 ).r;
      }

      float SMAASearchXLeft( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
        vec2 e = vec2( 0.0, 1.0 );
        for ( int i = 0; i < ${O.int(oy.maxSearchSteps)}; i ++ ) {
          e = texture2D( edgesTex, texcoord, 0.0 ).rg;
          texcoord -= vec2( 2.0, 0.0 ) * resolution.xy;
          if ( ! ( texcoord.x > end && e.g > 0.8281 && e.r == 0.0 ) ) break;
        }
        texcoord.x += 0.25 * resolution.x;
        texcoord.x += resolution.x;
        texcoord.x += 2.0 * resolution.x;
        texcoord.x -= resolution.x * SMAASearchLength(searchTex, e, 0.0, 0.5);
        return texcoord.x;
      }

      float SMAASearchXRight( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
        vec2 e = vec2( 0.0, 1.0 );
        for ( int i = 0; i < ${O.int(oy.maxSearchSteps)}; i ++ ) {
          e = texture2D( edgesTex, texcoord, 0.0 ).rg;
          texcoord += vec2( 2.0, 0.0 ) * resolution.xy;
          if ( ! ( texcoord.x < end && e.g > 0.8281 && e.r == 0.0 ) ) break;
        }
        texcoord.x -= 0.25 * resolution.x;
        texcoord.x -= resolution.x;
        texcoord.x -= 2.0 * resolution.x;
        texcoord.x += resolution.x * SMAASearchLength( searchTex, e, 0.5, 0.5 );
        return texcoord.x;
      }

      float SMAASearchYUp( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
        vec2 e = vec2( 1.0, 0.0 );
        for ( int i = 0; i < ${O.int(oy.maxSearchSteps)}; i ++ ) {
          e = texture2D( edgesTex, texcoord, 0.0 ).rg;
          texcoord += vec2( 0.0, 2.0 ) * resolution.xy;
          if ( ! ( texcoord.y > end && e.r > 0.8281 && e.g == 0.0 ) ) break;
        }
        texcoord.y -= 0.25 * resolution.y;
        texcoord.y -= resolution.y;
        texcoord.y -= 2.0 * resolution.y;
        texcoord.y += resolution.y * SMAASearchLength( searchTex, e.gr, 0.0, 0.5 );
        return texcoord.y;
      }

      float SMAASearchYDown( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
        vec2 e = vec2( 1.0, 0.0 );
        for ( int i = 0; i < ${O.int(oy.maxSearchSteps)}; i ++ ) {
          e = texture2D( edgesTex, texcoord, 0.0 ).rg;
          texcoord -= vec2( 0.0, 2.0 ) * resolution.xy;
          if ( ! ( texcoord.y < end && e.r > 0.8281 && e.g == 0.0 ) ) break;
        }
        texcoord.y += 0.25 * resolution.y;
        texcoord.y += resolution.y;
        texcoord.y += 2.0 * resolution.y;
        texcoord.y -= resolution.y * SMAASearchLength( searchTex, e.gr, 0.5, 0.5 );
        return texcoord.y;
      }

      vec2 SMAAArea( sampler2D areaTex, vec2 dist, float e1, float e2, float offset ) {
        vec2 texcoord = float( ${O.int(oy.maxDistanceAreaTex)} ) * round( 4.0 * vec2( e1, e2 ) ) + dist;
        texcoord = SMAA_AREATEX_PIXEL_SIZE * texcoord + ( 0.5 * SMAA_AREATEX_PIXEL_SIZE );
        texcoord.y += SMAA_AREATEX_SUBTEX_SIZE * offset;
        return texture2D( areaTex, texcoord, 0.0 ).rg;
      }

      vec4 SMAABlendingWeightCalculationPS( vec2 texcoord, vec2 pixcoord, vec4 offset[ 3 ], sampler2D edgesTex, sampler2D areaTex, sampler2D searchTex, ivec4 subsampleIndices ) {
        vec4 weights = vec4( 0.0, 0.0, 0.0, 0.0 );
        vec2 e = texture2D( edgesTex, texcoord ).rg;
        if ( e.g > 0.0 ) {
          vec2 d;
          vec2 coords;
          coords.x = SMAASearchXLeft( edgesTex, searchTex, offset[ 0 ].xy, offset[ 2 ].x );
          coords.y = offset[ 1 ].y;
          d.x = coords.x;
          float e1 = texture2D( edgesTex, coords, 0.0 ).r;
          coords.x = SMAASearchXRight( edgesTex, searchTex, offset[ 0 ].zw, offset[ 2 ].y );
          d.y = coords.x;
          d = d * resolution.z - pixcoord.x;
          vec2 sqrt_d = sqrt( abs( d ) );
          coords.y -= 1.0 * resolution.y;
          float e2 = SMAASampleLevelZeroOffset( edgesTex, coords, vec2( 1.0, 0.0 ) ).r;
          weights.rg = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.y ) );
        }

        if ( e.r > 0.0 ) {
          vec2 d;
          vec2 coords;
          coords.y = SMAASearchYUp( edgesTex, searchTex, offset[ 1 ].xy, offset[ 2 ].z );
          coords.x = offset[ 0 ].x;
          d.x = coords.y;
          float e1 = texture2D( edgesTex, coords, 0.0 ).g;
          coords.y = SMAASearchYDown( edgesTex, searchTex, offset[ 1 ].zw, offset[ 2 ].w );
          d.y = coords.y;
          d = d * resolution.w - pixcoord.y;
          vec2 sqrt_d = sqrt( abs( d ) );
          coords.y -= 1.0 * resolution.y;
          float e2 = SMAASampleLevelZeroOffset( edgesTex, coords, vec2( 0.0, 1.0 ) ).g;
          weights.ba = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.x ) );

          // for some reason the following lines are necessary to prevent
          // texture lookup precision issues on some Intel integrated graphics chips
          vec4 dbg = (offset[ 0 ]+offset[ 1 ]+offset[ 2 ] + coords.xyyx);
          weights.r += 0.00000001 * dot(vec4(0,1,0,1),dbg);
        }
        return weights;
      }

      void main() {
        gl_FragColor = SMAABlendingWeightCalculationPS( fTexCoord, fPixCoord, fOffset, tEdges, tArea, tSearch, ivec4( 0.0 ) );
      }
    `),i}const AIe=Object.freeze(Object.defineProperty({__proto__:null,build:RIe},Symbol.toStringTag,{value:"Module"}));let see=class aee extends ti{initializeProgram(e){return new Jt(e.rctx,aee.shader.get().build(),ai)}initializePipeline(){return Ke({colorWrite:ht})}};see.shader=new ii(AIe,()=>G(()=>import("./BlendWeights.glsl-a74b85d0.js"),["assets/BlendWeights.glsl-a74b85d0.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/vec2-528adfe4.js","assets/common-c186b691.js","assets/vec2f64-30dc1443.js","assets/Texture2DPassUniform-753de459.js","assets/VertexAttribute-9c5c630d.js","assets/vec4-790471c0.js","assets/vec4f64-e407da96.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));function OIe(){const i=new Yi,{attributes:e,varyings:t,vertex:r,fragment:n}=i;return e.add(P.POSITION,"vec2"),t.add("fTexCoord","vec2"),t.add("fOffset[2]","vec4"),Cx(r),r.code.add(O`void SMAANeighborhoodBlendingVS( vec2 texcoord ) {
fOffset[0] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0, 1.0 );
fOffset[1] = texcoord.xyxy + resolution.xyxy * vec4( 1.0, 0.0, 0.0, -1.0 );
}
void main() {
fTexCoord = (position + 1.0 ) * 0.5;
gl_Position = vec4(position, 0, 1);
SMAANeighborhoodBlendingVS(fTexCoord);
}`),n.uniforms.add(new Bt("tBlendWeights",s=>s.blend.colorTexture)),n.uniforms.add(new Bt("tColor",s=>s.colorTexture)),Cx(n),n.code.add(O`vec4 SMAANeighborhoodBlendingPS( vec2 texcoord, vec4 offset[ 2 ], sampler2D colorTex, sampler2D blendTex ) {
vec4 a;
a.xz = texture2D( blendTex, texcoord ).xz;
a.y = texture2D( blendTex, offset[ 1 ].zw ).g;
a.w = texture2D( blendTex, offset[ 1 ].xy ).a;
if ( dot(a, vec4( 1.0, 1.0, 1.0, 1.0 )) < 1e-5 ) {
return texture2D( colorTex, texcoord, 0.0 );
} else {
vec2 offset;
offset.x = a.a > a.b ? a.a : -a.b;
offset.y = a.g > a.r ? -a.g : a.r;
if ( abs( offset.x ) > abs( offset.y )) {
offset.y = 0.0;
} else {
offset.x = 0.0;
}
vec4 C = texture2D( colorTex, texcoord, 0.0 );
texcoord += sign( offset ) * resolution.xy;
vec4 Cop = texture2D( colorTex, texcoord, 0.0 );
float s = abs( offset.x ) > abs( offset.y ) ? abs( offset.x ) : abs( offset.y );
vec4 mixed = mix(C, Cop, s);
return mixed;
}
}
void main() {
gl_FragColor = SMAANeighborhoodBlendingPS( fTexCoord, fOffset, tColor, tBlendWeights );
}`),i}const MIe=Object.freeze(Object.defineProperty({__proto__:null,build:OIe},Symbol.toStringTag,{value:"Module"}));let oee=class lee extends ti{initializeProgram(e){return new Jt(e.rctx,lee.shader.get().build(),ai)}initializePipeline(){return Ke({colorWrite:ht})}};oee.shader=new ii(MIe,()=>G(()=>import("./Blur.glsl-5e0088f7.js"),["assets/Blur.glsl-5e0088f7.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/vec2-528adfe4.js","assets/common-c186b691.js","assets/vec2f64-30dc1443.js","assets/Texture2DPassUniform-753de459.js","assets/VertexAttribute-9c5c630d.js","assets/vec4-790471c0.js","assets/vec4f64-e407da96.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));const gB={threshold:.05,localConstrastAdaption:2};function IIe(){const i=new Yi,{attributes:e,varyings:t,vertex:r,fragment:n}=i;return e.add(P.POSITION,"vec2"),Cx(r),t.add("fTexCoord","vec2"),t.add("fOffset[3]","vec4"),r.code.add(O`void EdgeDetectEdgeDetectionVS( vec2 texcoord ) {
fOffset[0] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0,  1.0 );
fOffset[1] = texcoord.xyxy + resolution.xyxy * vec4(  1.0, 0.0, 0.0, -1.0 );
fOffset[2] = texcoord.xyxy + resolution.xyxy * vec4( -2.0, 0.0, 0.0,  2.0 );
}
void main() {
fTexCoord = (position + 1.0) * 0.5;
gl_Position = vec4(position, 0, 1);
EdgeDetectEdgeDetectionVS(fTexCoord);
}`),n.uniforms.add(new Bt("tColor",s=>s.colorTexture)),n.code.add(O`
    vec4 EdgeDetectColorEdgeDetectionPS(vec2 texcoord, vec4 offset[3], sampler2D colorTex) {
      vec2 threshold = vec2( ${O.float(gB.threshold)} );

      // Calculate color deltas:
      vec4 delta;
      vec3 C = texture2D( colorTex, texcoord ).rgb;

      vec3 Cleft = texture2D( colorTex, offset[0].xy ).rgb;
      vec3 t = abs( C - Cleft );
      delta.x = max( max( t.r, t.g ), t.b );

      vec3 Ctop = texture2D( colorTex, offset[0].zw ).rgb;
      t = abs( C - Ctop );
      delta.y = max( max( t.r, t.g ), t.b );

      // We do the usual threshold:
      vec2 edges = step( threshold, delta.xy );

      // Then discard if there is no edge:
      if ( dot( edges, vec2( 1.0, 1.0 ) ) == 0.0 )
          discard;

      // Calculate right and bottom deltas:
      vec3 Cright = texture2D( colorTex, offset[1].xy ).rgb;
      t = abs( C - Cright );
      delta.z = max( max( t.r, t.g ), t.b );

      vec3 Cbottom  = texture2D( colorTex, offset[1].zw ).rgb;
      t = abs( C - Cbottom );
      delta.w = max( max( t.r, t.g ), t.b );

      // Calculate the maximum delta in the direct neighborhood:
      float maxDelta = max( max( max( delta.x, delta.y ), delta.z ), delta.w );

      // Calculate left-left and top-top deltas:
      vec3 Cleftleft  = texture2D( colorTex, offset[2].xy ).rgb;
      t = abs( C - Cleftleft );
      delta.z = max( max( t.r, t.g ), t.b );

      vec3 Ctoptop = texture2D( colorTex, offset[2].zw ).rgb;
      t = abs( C - Ctoptop );
      delta.w = max( max( t.r, t.g ), t.b );

      // Calculate the final maximum delta:
      maxDelta = max( max( maxDelta, delta.z ), delta.w );

      // Local contrast adaptation in action:
      edges.xy *= step( maxDelta, float(${O.float(gB.localConstrastAdaption)}) * delta.xy );

      return vec4( edges, 0.0, 0.0 );
    }

    void main() {
      gl_FragColor = EdgeDetectColorEdgeDetectionPS(fTexCoord, fOffset, tColor);
    }
  `),i}const LIe=Object.freeze(Object.defineProperty({__proto__:null,build:IIe},Symbol.toStringTag,{value:"Module"}));let cee=class hee extends ti{initializeProgram(e){return new Jt(e.rctx,hee.shader.get().build(),ai)}initializePipeline(){return Ke({colorWrite:ht})}};cee.shader=new ii(LIe,()=>G(()=>import("./EdgeDetect.glsl-d2664d35.js"),["assets/EdgeDetect.glsl-d2664d35.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/vec2-528adfe4.js","assets/common-c186b691.js","assets/vec2f64-30dc1443.js","assets/Texture2DPassUniform-753de459.js","assets/VertexAttribute-9c5c630d.js","assets/vec4-790471c0.js","assets/vec4f64-e407da96.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));let wb=class extends ue{constructor(e,t){super({}),this._rctx=e,this._techniqueRep=t,this._passParameters=new EIe,this._isEnabled=!1}normalizeCtorArgs(){return{}}dispose(){this._abortController=iu(this._abortController),this.disable()}_loadResources(e){if(y(this._abortController))return!1;if(y(this._passParameters.searchTexture))return!0;this._abortController=new AbortController;const t=this._abortController.signal;return G(()=>import("./SmaaRenderPassData-660b7d34.js"),[]).then(r=>this._loadTextures(r,t)).then(()=>e()).finally(()=>this._abortController=null),!1}_loadTextures(e,t){return xi(t),Promise.all([this._loadTextureFromBase64(e.areaTexture,Kt.LINEAR,yt.RGB),this._loadTextureFromBase64(e.searchTexure,Kt.NEAREST,yt.LUMINANCE)]).then(([r,n])=>{Ec(t)?(r.dispose(),n.dispose(),xi(t)):(this._passParameters.areaTexture=r,this._passParameters.searchTexture=n)})}get updating(){return y(this._abortController)}enable(e){if(this._isEnabled)return!0;if(!this._edgeDetectTechnique||!this._blendWeightsTechnique||!this._blurTechnique){const t=new $a;this._edgeDetectTechnique=this._techniqueRep.releaseAndAcquire(cee,t,this._edgeDetectTechnique),this._blendWeightsTechnique=this._techniqueRep.releaseAndAcquire(see,t,this._blendWeightsTechnique),this._blurTechnique=this._techniqueRep.releaseAndAcquire(oee,t,this._blurTechnique)}return!!this._loadResources(e)&&(this._vao=dne(this._rctx),this._passParameters.edges=new yn(this._rctx,{colorTarget:Vn.TEXTURE,depthStencilTarget:rs.NONE},{target:vi.TEXTURE_2D,pixelFormat:yt.RGB,dataType:qt.UNSIGNED_BYTE,samplingMode:Kt.LINEAR,wrapMode:si.CLAMP_TO_EDGE,width:4,height:4}),this._passParameters.blend=new yn(this._rctx,{colorTarget:Vn.TEXTURE,depthStencilTarget:rs.NONE},{target:vi.TEXTURE_2D,pixelFormat:yt.RGBA,dataType:qt.UNSIGNED_BYTE,samplingMode:Kt.LINEAR,wrapMode:si.CLAMP_TO_EDGE,width:4,height:4}),this._isEnabled=!0,!0)}disable(){this._isEnabled&&(this._vao=Me(this._vao),this._passParameters.areaTexture=Me(this._passParameters.areaTexture),this._passParameters.searchTexture=Me(this._passParameters.searchTexture),this._passParameters.blend=Me(this._passParameters.blend),this._passParameters.edges=Me(this._passParameters.edges),this._isEnabled=!1)}get _validPassParameters(){return this._isEnabled?this._passParameters:null}render(e){const t=this._validPassParameters;if(S(t))return;t.colorTexture=e;const r=this._rctx,n=r.getBoundFramebufferObject(),s=e.descriptor.width,a=e.descriptor.height;r.bindVAO(this._vao),r.setViewport(0,0,s,a),t.edges.resize(s,a),r.bindFramebuffer(t.edges),r.setClearColor(0,0,0,1),r.clear(Ai.COLOR_BUFFER_BIT),r.bindTechnique(this._edgeDetectTechnique,t,null),r.drawArrays(Dt.TRIANGLES,0,3),t.blend.resize(s,a),r.bindFramebuffer(t.blend),r.setClearColor(0,0,1,1),r.clear(Ai.COLOR_BUFFER_BIT),r.bindTechnique(this._blendWeightsTechnique,t,null),r.drawArrays(Dt.TRIANGLES,0,3),r.bindFramebuffer(n),r.setClearColor(0,1,0,1),r.clear(Ai.COLOR_BUFFER_BIT),r.bindTechnique(this._blurTechnique,t,null),r.drawArrays(Dt.TRIANGLES,0,3)}_loadTextureFromBase64(e,t,r){return Mg(e).then(n=>new Gi(this._rctx,{pixelFormat:r,dataType:qt.UNSIGNED_BYTE,wrapMode:si.CLAMP_TO_EDGE,width:n.width,height:n.height,samplingMode:t},n))}};h([p()],wb.prototype,"_abortController",void 0),h([p({readOnly:!0})],wb.prototype,"updating",null),wb=h([D("esri.views.3d.webgl-engine.lib.SmaaRenderPass")],wb);function $Ie(i,e){const t=-i[0],r=-i[1],n=-i[2],s=e[3],a=e[7],o=e[11],l=e[15];e[0]+=s*t,e[1]+=s*r,e[2]+=s*n,e[4]+=a*t,e[5]+=a*r,e[6]+=a*n,e[8]+=o*t,e[9]+=o*r,e[10]+=o*n,e[12]+=l*t,e[13]+=l*r,e[14]+=l*n}function DIe(i,e){const t=i[0],r=i[1],n=i[2];e[12]+=t*e[0]+r*e[4]+n*e[8],e[13]+=t*e[1]+r*e[5]+n*e[9],e[14]+=t*e[2]+r*e[6]+n*e[10],e[14]+=t*e[3]+r*e[7]+n*e[11]}let FIe=class{constructor(e){this._factory=e,this._originData=new Map}acquire(e){return this.register(this._factory.getOrigin(e))}register(e){const t=this._originData.get(e.id)||new NIe(e);return t.refCount++,this._originData.has(t.origin.id)||this._originData.set(t.origin.id,t),t}release(e){e.refCount--,e.refCount===0&&this._originData.delete(e.origin.id)}updateViewMatrices(e){this._originData.forEach(t=>{pn(t.viewMatrix,e),DIe(t.origin.vec3,t.viewMatrix)})}},NIe=class{constructor(e){this.origin=e,this.refCount=0,this.viewMatrix=ve()}},kIe=class extends vne{constructor(e,t){super(),this.distanceFalloffFactor=e,this.transparency=t,this.transformNormalViewFromGlobal=Or()}},VIe=class extends bne{constructor(){super(...arguments),this.transformNormalViewFromGlobal=Or(),this.slicePlaneLocalOrigin=R(),this.transformNormalGlobalFromModel=Or()}};function UIe(i){const e=O`bool isNaN( float val )
{
return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true;
}`;i.code.add(e)}const zIe=Xt(.5,-4e-4);function BIe(i,e){const t=i.vertex;t.include(UIe),t.constants.add("depthBias","vec2",zIe),t.uniforms.add(new Zs("inverseViewport",(r,n)=>n.inverseViewport)),e.legacy?(t.uniforms.add(new Ys("proj",(r,n)=>n.camera.projectionMatrix)),t.code.add(O`vec2 calculateProjectedBiasXY(vec4 projPos, vec3 globalNormal) {
float offsetXY = depthBias.x;
vec4 projNormal = proj * localView * vec4(globalNormal, 0.0);
return offsetXY * projPos.w * 2.0 * inverseViewport * normalize(projNormal.xyz).xy;
}`)):(t.uniforms.add(new qG("transformNormalViewFromGlobal",r=>r.transformNormalViewFromGlobal)),t.uniforms.add(new Ys("transformProjFromView",r=>r.transformProjFromView)),t.code.add(O`vec2 calculateProjectedBiasXY(vec4 projPos, vec3 globalNormal) {
float offsetXY = depthBias.x;
vec4 projNormal = transformProjFromView * vec4(transformNormalViewFromGlobal * globalNormal, 0.0);
return offsetXY * projPos.w * 2.0 * inverseViewport * normalize(projNormal.xyz).xy;
}`)),t.code.add(O`float _calculateProjectedBiasZ(vec4 projPos) {
float offsetZ = depthBias.y;
return sqrt(max(projPos.z,0.0)) * offsetZ;
}
vec4 adjustProjectedPosition(vec4 projPos, vec3 worldNormal, float lineWidth) {
vec2 offsetXY = calculateProjectedBiasXY(projPos, worldNormal);
if (!isNaN(offsetXY.x) && !isNaN(offsetXY.y)) {
projPos.xy += offsetXY;
}
projPos.z += _calculateProjectedBiasZ(projPos);
return projPos;
}`)}function GIe(i,e){const t=i.fragment;t.constants.add("coverageTestThreshold","float",.01),e.antialiasing?t.code.add(O`#define discardByCoverage(radius, coverage) { if (coverage < coverageTestThreshold) discard; }`):t.code.add(O`#define discardByCoverage(radius, coverage) { float coverageLimit = radius <= 0.5 ? coverageTestThreshold : 0.75; if (coverage < coverageLimit) discard; }`)}function HIe(i,e){const t=i.vertex;e.silhouette?(t.code.add(O`bool isSilhouetteEdge(vec3 viewDir, vec3 normalA, vec3 normalB) {
float faceAVisible = dot(viewDir, normalA);
float faceBVisible = dot(viewDir, normalB);
return faceAVisible * faceBVisible < 0.0;
}`),e.legacy?t.code.add(O`bool discardNonSilhouetteEdges(vec3 viewPos, vec3 worldPos) {
vec3 viewNormalA = _modelToViewNormal(normalA);
vec3 viewNormalB = _modelToViewNormal(normalB);
vec3 viewDir = -viewPos;
if (isSilhouetteEdge(viewDir, viewNormalA, viewNormalB)) {
return false;
}
gl_Position = vec4(10.0, 10.0, 10.0, 1.0);
return true;
}`):t.code.add(O`bool discardNonSilhouetteEdges(vec3 viewPos, vec3 worldPos) {
vec3 worldNormalA = _modelToWorldNormal(normalA);
vec3 worldNormalB = _modelToWorldNormal(normalB);
vec3 viewDir = -worldPos;
if (isSilhouetteEdge(viewDir, worldNormalA, worldNormalB)) {
return false;
}
gl_Position = vec4(10.0, 10.0, 10.0, 1.0);
return true;
}`)):t.code.add(O`bool discardNonSilhouetteEdges(vec3 viewPos, vec3 worldPos) {
return false;
}`)}function jIe(i,e){const t=i.vertex;t.include(e_),t.uniforms.add(new Tt("distanceFalloffFactor",r=>r.distanceFalloffFactor)),t.code.add(O`float distanceBasedPerspectiveFactor(float distance) {
return clamp(sqrt(distanceFalloffFactor / distance), 0.0, 1.0);
}`),t.uniforms.add(NP("componentDataTex",r=>r.componentDataTexture,e.hasWebGL2Context?il.None:il.InvSize)),i.attributes.add(P.COMPONENTINDEX,"float"),t.constants.add("componentColorFieldOffset","float",0),t.constants.add("componentOtherFieldOffset","float",1),t.constants.add("componentVerticalOffsetFieldOffset","float",2),t.constants.add("componentFieldCount","float",3),t.constants.add("lineWidthFractionFactor","float",8),t.constants.add("extensionLengthOffset","float",128),t.constants.add("verticalOffsetScale","float",2*B4),t.code.add(O`
    vec2 _componentTextureCoords(float componentIndex, float fieldOffset) {
      float fieldIndex = componentFieldCount * componentIndex + fieldOffset;

      vec2 textureSizeInverse = ${Nx(e,"componentDataTex",!0)};

      float colIndex = mod(fieldIndex, 1.0 / textureSizeInverse.x);
      float rowIndex = floor(fieldIndex * textureSizeInverse.x);

      vec2 textureCoordinates = vec2(colIndex, rowIndex) + 0.5;

      return textureCoordinates;
    }

    struct ComponentData {
      vec4 color;
      float lineWidth;
      float extensionLength;
      float type;
      float verticalOffset;
    };

    ComponentData readComponentData() {
      vec2 colorIndex = _componentTextureCoords(componentIndex, componentColorFieldOffset);
      vec2 otherIndex = _componentTextureCoords(componentIndex, componentOtherFieldOffset);
      vec2 verticalOffsetIndex = _componentTextureCoords(componentIndex, componentVerticalOffsetFieldOffset);

      vec4 colorValue = ${Ko(e,"componentDataTex","colorIndex")};
      vec4 otherValue = ${Ko(e,"componentDataTex","otherIndex")};
      float verticalOffset = (rgba2float(${Ko(e,"componentDataTex","verticalOffsetIndex")}) - 0.5) * verticalOffsetScale;

      return ComponentData(
        vec4(colorValue.rgb, colorValue.a * otherValue.w), // otherValue.w stores separate opacity
        otherValue.x * (255.0 / lineWidthFractionFactor),
        otherValue.y * 255.0 - extensionLengthOffset,
        -(otherValue.z * 255.0) + 0.5, // SOLID (=0/255) needs to be > 0.0, SKETCHY (=1/255) needs to be <= 0;
        verticalOffset
      );
    }
  `),e.legacy?t.code.add(O`vec3 _modelToWorldNormal(vec3 normal) {
return (model * vec4(normal, 0.0)).xyz;
}
vec3 _modelToViewNormal(vec3 normal) {
return (localView * model * vec4(normal, 0.0)).xyz;
}`):(t.uniforms.add(new RI("transformNormalGlobalFromModel",r=>r.transformNormalGlobalFromModel)),t.code.add(O`vec3 _modelToWorldNormal(vec3 normal) {
return transformNormalGlobalFromModel * normal;
}`)),e.silhouette?(i.attributes.add(P.NORMALA,"vec3"),i.attributes.add(P.NORMALB,"vec3"),t.code.add(O`vec3 worldNormal() {
return _modelToWorldNormal(normalize(normalA + normalB));
}`)):(i.attributes.add(P.NORMAL,"vec3"),t.code.add(O`vec3 worldNormal() {
return _modelToWorldNormal(normal);
}`)),e.legacy?t.code.add(O`void worldAndViewFromModelPosition(vec3 modelPos, float verticalOffset, out vec3 worldPos, out vec3 viewPos) {
worldPos = (model * vec4(modelPos, 1.0)).xyz;
viewPos = (localView * vec4(worldPos, 1.0)).xyz;
}`):(t.include(N5,e),t.include(N5,e),t.uniforms.add([new qG("transformViewFromCameraRelativeRS",r=>r.transformViewFromCameraRelativeRS),new RI("transformWorldFromModelRS",r=>r.transformWorldFromModelRS),new O5("transformWorldFromModelTL",r=>r.transformWorldFromModelTL),new O5("transformWorldFromModelTH",r=>r.transformWorldFromModelTH),new Rs("transformWorldFromViewTL",r=>r.transformWorldFromViewTL),new Rs("transformWorldFromViewTH",r=>r.transformWorldFromViewTH)]),t.code.add(O`
      void worldAndViewFromModelPosition(vec3 modelPos, float verticalOffset, out vec3 worldPos, out vec3 viewPos) {
        vec3 rotatedModelPosition = transformWorldFromModelRS * modelPos;

        vec3 transformCameraRelativeFromModel = dpAdd(
          transformWorldFromModelTL,
          transformWorldFromModelTH,
          -transformWorldFromViewTL,
          -transformWorldFromViewTH
        );

        worldPos = transformCameraRelativeFromModel + rotatedModelPosition;

        if (verticalOffset != 0.0) {
          vec3 vUp = ${e.spherical?O`normalize(transformWorldFromModelTL + rotatedModelPosition);`:O`vec3(0.0, 0.0, 1.0);`}
          worldPos += verticalOffset * vUp;
        }

        viewPos = transformViewFromCameraRelativeRS * worldPos;
      }
    `)),t.uniforms.add(new Ys("transformProjFromView",(r,n)=>n.camera.projectionMatrix)),t.code.add(O`vec4 projFromViewPosition(vec3 position) {
return transformProjFromView * vec4(position, 1.0);
}`),t.code.add(O`float calculateExtensionLength(float extensionLength, float lineLength) {
return extensionLength / (log2(max(1.0, 256.0 / lineLength)) * 0.2 + 1.0);
}`)}function qIe(i){return i.mode===Pr.SKETCH||i.mode===Pr.MIXED}var Pr;(function(i){i[i.SOLID=0]="SOLID",i[i.SKETCH=1]="SKETCH",i[i.MIXED=2]="MIXED",i[i.COUNT=3]="COUNT"})(Pr||(Pr={}));function WIe(i,e){const t=i.vertex;switch(e.mode){case Pr.SKETCH:t.code.add(O`#define discardShortEdges(unpackedAttributes, lineLengthPixels) { if (lineLengthPixels <= 3.0) { gl_Position = vec4(10.0, 10.0, 10.0, 1.0); return; }}`);break;case Pr.MIXED:t.code.add(O`#define discardShortEdges(unpackedAttributes, lineLengthPixels) { if (unpackedAttributes.type <= 0.0 && lineLengthPixels <= 3.0) { gl_Position = vec4(10.0, 10.0, 10.0, 1.0); return; }}`);break;case Pr.SOLID:t.code.add(O`#define discardShortEdges(unpackedAttributes, lineLengthPixels) {}`)}}function j4(i,e){const t=i.vertex;switch(i.attributes.add(P.SIDENESS,"vec2"),e.mode===Pr.MIXED?t.code.add(O`struct UnpackedAttributes {
vec2 sideness;
vec2 sidenessNorm;
float lineWidthPixels;
float extensionLengthPixels;
float type;
};`):t.code.add(O`struct UnpackedAttributes {
vec2 sideness;
vec2 sidenessNorm;
float lineWidthPixels;
float extensionLengthPixels;
};`),e.mode){case Pr.MIXED:t.code.add(O`UnpackedAttributes unpackAttributes(ComponentData component) {
vec2 sidenessNorm = sideness;
vec2 sideness = sidenessNorm * 2.0 - 1.0;
float fType = component.type;
float extensionLengthPixels = component.extensionLength;
float lineWidth = component.lineWidth;
if (fType <= 0.0) {
extensionLengthPixels *= variantExtension * 2.0 - 1.0;
}
return UnpackedAttributes(sideness, sidenessNorm, lineWidth, extensionLengthPixels, fType);
}`);break;case Pr.SKETCH:t.code.add(O`UnpackedAttributes unpackAttributes(ComponentData component) {
vec2 sidenessNorm = sideness;
vec2 sideness = sidenessNorm * 2.0 - 1.0;
float extensionLengthPixels = component.extensionLength;
extensionLengthPixels *= variantExtension * 2.0 - 1.0;
float lineWidth = component.lineWidth;
return UnpackedAttributes(sideness, sidenessNorm, lineWidth, extensionLengthPixels);
}`);break;case Pr.SOLID:t.code.add(O`UnpackedAttributes unpackAttributes(ComponentData component) {
vec2 sidenessNorm = sideness;
vec2 sideness = sidenessNorm * 2.0 - 1.0;
float extensionLengthPixels = component.extensionLength;
float lineWidth = component.lineWidth;
return UnpackedAttributes(sideness, sidenessNorm, lineWidth, extensionLengthPixels);
}`);break;case Pr.COUNT:break;default:Pa(e.mode)}}function XIe(i,e){const t=i.vertex;switch(i.include(j4,e),e.mode){case Pr.SOLID:t.code.add(O`float calculateLineAmplitude(UnpackedAttributes unpackedAttributes) {
return 0.0;
}`);break;case Pr.SKETCH:t.uniforms.add(new C0("strokesAmplitude",r=>r.strokesTexture.amplitude)),t.code.add(O`float calculateLineAmplitude(UnpackedAttributes unpackedAttributes) {
return strokesAmplitude;
}`);break;case Pr.MIXED:t.uniforms.add(new C0("strokesAmplitude",r=>r.strokesTexture.amplitude)),t.code.add(O`float calculateLineAmplitude(UnpackedAttributes unpackedAttributes) {
float type = unpackedAttributes.type;
if (type <= 0.0) {
return strokesAmplitude;
}
else {
return 0.0;
}
}`)}}function QIe(i,e){i.include(j4,e);const{vertex:t,fragment:r}=i;switch(qIe(e)&&(t.uniforms.add(NP("strokesTexture",n=>n.strokesTexture.texture,e.hasWebGL2Context?il.None:il.InvSize)),t.uniforms.add([new C0("strokesLog2Resolution",n=>Math.log2(n.strokesTexture.resolution)),new C0("strokeVariants",n=>n.strokesTexture.variants)]),i.varyings.add("vStrokeUV","vec2"),r.uniforms.add([new WD("strokesTexture",n=>n.strokesTexture.texture),new C0("strokesNormalizationScale",n=>n.strokesTexture.normalizationScale)]),t.code.add(O`
      void calculateStyleOutputsSketch(float lineLength, UnpackedAttributes unpackedAttributes) {
        vec2 sidenessNorm = unpackedAttributes.sidenessNorm;

        float lineIndex = clamp(ceil(log2(lineLength)), 0.0, strokesLog2Resolution);

        vec2 textureSizeInverse = ${Nx(e,"strokesTexture",!0)};
        vStrokeUV = vec2(exp2(lineIndex) * sidenessNorm.y, lineIndex * strokeVariants + variantStroke + 0.5) * textureSizeInverse;
        vStrokeUV.x += variantOffset;
      }
    `),i.fragment.include(e_),r.code.add(O`float calculateLineOffsetSketch() {
float offsetNorm = rgba2float(texture2D(strokesTexture, vStrokeUV));
return (offsetNorm - 0.5) * strokesNormalizationScale;
}
float calculateLinePressureSketch() {
return rgba2float(texture2D(strokesTexture, vStrokeUV + vec2(0.0, 0.5)));
}`)),e.mode){case Pr.SOLID:t.code.add(O`void calculateStyleOutputs(UnpackedAttributes unpackedAttributes) {}`),r.code.add(O`float calculateLineOffset() {
return 0.0;
}
float calculateLinePressure() {
return 1.0;
}`);break;case Pr.SKETCH:t.code.add(O`void calculateStyleOutputs(UnpackedAttributes unpackedAttributes)
{
calculateStyleOutputsSketch(vLineLengthPixels, unpackedAttributes);
}`),r.code.add(O`float calculateLineOffset() {
return calculateLineOffsetSketch();
}
float calculateLinePressure() {
return calculateLinePressureSketch();
}`);break;case Pr.MIXED:i.varyings.add("vType","float"),t.code.add(O`void calculateStyleOutputs(UnpackedAttributes unpackedAttributes)
{
vType = unpackedAttributes.type;
if (unpackedAttributes.type <= 0.0) {
calculateStyleOutputsSketch(vLineLengthPixels, unpackedAttributes);
}
}`),r.code.add(O`float calculateLineOffset() {
if (vType <= 0.0) {
return calculateLineOffsetSketch();
}
else {
return 0.0;
}
}
float calculateLinePressure() {
if (vType <= 0.0) {
return calculateLinePressureSketch();
}
else {
return 1.0;
}
}`)}}function ZIe(i){const e=new Yi,{vertex:t,fragment:r}=e;return i.antialiasing&&(t.code.add(O`#define ANTIALIASING 1`),r.code.add(O`#define ANTIALIASING 1`)),i.legacy&&t.uniforms.add([new _B("model"),new _B("localView")]),e.include(BIe,i),e.include(jIe,i),e.include(XIe,i),e.include(j4,i),e.include(QIe,i),e.include(cH,i),e.include(HIe,i),e.include(GIe,i),e.include(WIe,i),e.include(AI,i),e.varyings.add("vColor","vec4"),e.varyings.add("vRadius","float"),e.varyings.add("vPosition","vec3"),e.varyings.add("vWorldPosition","vec3"),e.varyings.add("vViewPos","vec3"),e.varyings.add("vLineLengthPixels","float"),e.varyings.add("vSizeFalloffFactor","float"),t.uniforms.add([new Zs("pixelToNDC",(n,s)=>Je(YIe,2/s.camera.fullViewport[2],2/s.camera.fullViewport[3])),new Xh("viewport",(n,s)=>s.camera.fullViewport),new Tt("pixelRatio",(n,s)=>s.camera.pixelRatio)]),e.attributes.add(P.POSITION0,"vec3"),e.attributes.add(P.POSITION1,"vec3"),e.attributes.add(P.VARIANTOFFSET,"float"),e.attributes.add(P.VARIANTSTROKE,"float"),e.attributes.add(P.VARIANTEXTENSION,"float"),t.code.add(O`const float opaqueCutoff = 1.0 / 255.0;
void calculateGeometricOutputs(vec3 viewPosV0, vec3 viewPosV1, vec3 worldPosV0, vec3 worldPosV1, vec3 worldNormal, UnpackedAttributes unpackedAttributes) {
vec2 sideness = unpackedAttributes.sideness;
vec2 sidenessNorm = unpackedAttributes.sidenessNorm;
vWorldPosition = mix(worldPosV0, worldPosV1, sidenessNorm.y).xyz;
vec3 viewPos = mix(viewPosV0, viewPosV1, sidenessNorm.y);
vViewPos = viewPos;
vec4 projPosV0 = projFromViewPosition(viewPosV0);
vec4 projPosV1 = projFromViewPosition(viewPosV1);
vec4 projPos = projFromViewPosition(viewPos);
vec3 screenSpaceLineNDC = (projPosV1.xyz / projPosV1.w - projPosV0.xyz / projPosV0.w);
vec2 ndcToPixel = viewport.zw * 0.5;
vec2 screenSpaceLinePixels = screenSpaceLineNDC.xy * ndcToPixel;
float lineLengthPixels = length(screenSpaceLinePixels);
float dzPerPixel = screenSpaceLineNDC.z / lineLengthPixels;
vec2 screenSpaceDirection = screenSpaceLinePixels / lineLengthPixels;
vec2 perpendicularScreenSpaceDirection = vec2(screenSpaceDirection.y, -screenSpaceDirection.x) * sideness.x;
float falloffFactor = distanceBasedPerspectiveFactor(-viewPos.z) * pixelRatio;
float lineWidthPixels = unpackedAttributes.lineWidthPixels * falloffFactor;
float extensionLengthPixels = calculateExtensionLength(unpackedAttributes.extensionLengthPixels, lineLengthPixels) * falloffFactor;
float lineAmplitudePixels = calculateLineAmplitude(unpackedAttributes) * pixelRatio;
vSizeFalloffFactor = falloffFactor;
float lineWidthAndAmplitudePixels = lineWidthPixels + lineAmplitudePixels + lineAmplitudePixels;
float extendedLineLengthPixels = lineLengthPixels + extensionLengthPixels + extensionLengthPixels;
#ifdef ANTIALIASING
const float aaPaddingPixels = 1.0;
float halfAAPaddedLineWidthAndAmplitudePixels = lineWidthAndAmplitudePixels * 0.5 + aaPaddingPixels;
float aaPaddedRoundedCapSizePixels = lineWidthPixels * 0.5 + aaPaddingPixels;
#else
float halfAAPaddedLineWidthAndAmplitudePixels = max(lineWidthAndAmplitudePixels, 1.0) * 0.5;
float aaPaddedRoundedCapSizePixels = max(lineWidthPixels, 1.0) * 0.5;
#endif
vec2 halfAAPaddedLineWidthAndAmplitudeNDC = halfAAPaddedLineWidthAndAmplitudePixels * pixelToNDC;
vec2 aaPaddedRoundedCapSizeNDC = aaPaddedRoundedCapSizePixels * pixelToNDC;
vec2 extensionLengthNDC = extensionLengthPixels * pixelToNDC;
vec2 ndcOffset = (
screenSpaceDirection * sideness.y * (aaPaddedRoundedCapSizeNDC + extensionLengthNDC)
+ perpendicularScreenSpaceDirection * halfAAPaddedLineWidthAndAmplitudeNDC
);
projPos.xy += ndcOffset * projPos.w;
projPos.z += (dzPerPixel * (aaPaddedRoundedCapSizePixels + extensionLengthPixels)) * sideness.y * projPos.w;
projPos = adjustProjectedPosition(projPos, worldNormal, 1.0 + max((lineWidthAndAmplitudePixels - 1.0) * 0.5, 0.0));
float aaPaddedLineWithCapsLengthPixels = extendedLineLengthPixels + aaPaddedRoundedCapSizePixels + aaPaddedRoundedCapSizePixels;
float pixelPositionAlongLine = aaPaddedLineWithCapsLengthPixels * sidenessNorm.y - aaPaddedRoundedCapSizePixels;
vPosition = vec3(
halfAAPaddedLineWidthAndAmplitudePixels * sideness.x,
pixelPositionAlongLine,
pixelPositionAlongLine / extendedLineLengthPixels
);
vRadius = lineWidthPixels * 0.5;
vLineLengthPixels = extendedLineLengthPixels;
discardShortEdges(unpackedAttributes, lineLengthPixels);
gl_Position = projPos;
}
void main() {
ComponentData component = readComponentData();
UnpackedAttributes unpackedAttributes = unpackAttributes(component);
vec3 worldPosV0, worldPosV1, viewPosV0, viewPosV1;
worldAndViewFromModelPosition(position0, component.verticalOffset, worldPosV0, viewPosV0);
worldAndViewFromModelPosition(position1, component.verticalOffset, worldPosV1, viewPosV1);
vColor = component.color;
if (vColor.a < opaqueCutoff) {
gl_Position = vec4(10.0, 10.0, 10.0, 1.0);
return;
}
if (discardNonSilhouetteEdges(viewPosV0, worldPosV0)) {
return;
}
calculateGeometricOutputs(viewPosV0, viewPosV1, worldPosV0, worldPosV1, worldNormal(), unpackedAttributes);
calculateStyleOutputs(unpackedAttributes);
}`),e.fragment.code.add(O`
    vec2 lineWithCapsDistance(float radius, vec2 position, float lineLength) {
      float lineOffset = calculateLineOffset();
      float positionX = position.x - lineOffset;

      if (radius < 1.0) {
        // Handle this specifically for subpixel sizes:
        // 1. Compute correct coverage (note coverage is computed by
        //    0.5 - dist, so we make sure that that will lead to correct
        //    subpixel coverage
        // 2. Ignore rounded caps
        float coverageX = clamp(min(radius, positionX + 0.5) - max(-radius, positionX - 0.5), 0.0, 1.0);
        float coverageY = clamp(min(lineLength, position.y + 0.5) - max(0.0, position.y - 0.5), 0.0, 1.0);

        float coverage = min(coverageX, coverageY);

        return vec2(0.5 - coverage, 0.0);
      }
      else {
        // Between -radius -> 0 for start cap, 0 for line, 0 -> radius
        float positionOnCap = position.y - clamp(position.y, 0.0, lineLength);

        vec2 lineToPosition = vec2(positionX, positionOnCap);
        return vec2(length(lineToPosition) - radius, positionOnCap / radius);
      }
    }

    void main() {
      ${i.hasMultipassTerrain?"terrainDepthTest(gl_FragCoord, vViewPos.z);":""}
      float radius = vRadius * calculateLinePressure();

      vec2 distance = lineWithCapsDistance(radius, vPosition.xy, vLineLengthPixels);
      float coverage = clamp(0.5 - distance.x, 0.0, 1.0);

      discardByCoverage(radius, coverage);
      discardBySlice(vWorldPosition);

      float alpha = vColor.a * coverage;

      gl_FragColor = vec4(vColor.rgb, alpha);

    }
  `),e}const YIe=be();let _B=class extends Jg{constructor(e){super(e,"mat4")}};const KIe=Object.freeze(Object.defineProperty({__proto__:null,build:ZIe},Symbol.toStringTag,{value:"Module"}));let uee=class dee extends ti{initializeConfiguration(e,t){t.hasWebGL2Context=e.rctx.type===Nn.WEBGL2}initializeProgram(e){return new Jt(e.rctx,dee.shader.get().build(this.configuration),MI)}initializePipeline(e){return e.blendMinMax?Ke({blending:Gn(de.ONE,de.ONE,de.ZERO,de.ONE,Cw.ADD,e.blendMinMax.MAX),depthTest:{func:hs.LEQUAL},colorWrite:ht}):Ke({depthTest:{func:hs.LEQUAL},depthWrite:nl,colorWrite:ht})}};uee.shader=new ii(KIe,()=>G(()=>import("./EdgeShader.glsl-8f187112.js"),["assets/EdgeShader.glsl-8f187112.js","assets/vec2-528adfe4.js","assets/common-c186b691.js","assets/vec2f64-30dc1443.js","assets/mat4-44a0988f.js","assets/vec3f64-2f9cef06.js","assets/mat4f64-1e28eae0.js","assets/vec3-e93e648f.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/Texture2DPassUniform-753de459.js","assets/VertexAttribute-9c5c630d.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));let Sh=class extends cu{constructor(){super(...arguments),this.mode=Pr.SOLID,this.hasSlicePlane=!1,this.silhouette=!1,this.legacy=!1,this.antialiasing=!1,this.doublePrecisionRequiresObfuscation=!1,this.hasMultipassTerrain=!1,this.cullAboveGround=!1,this.spherical=!1}};h([N({count:Pr.COUNT})],Sh.prototype,"mode",void 0),h([N()],Sh.prototype,"hasSlicePlane",void 0),h([N()],Sh.prototype,"silhouette",void 0),h([N()],Sh.prototype,"legacy",void 0),h([N()],Sh.prototype,"antialiasing",void 0),h([N()],Sh.prototype,"doublePrecisionRequiresObfuscation",void 0),h([N()],Sh.prototype,"hasMultipassTerrain",void 0),h([N()],Sh.prototype,"cullAboveGround",void 0),h([N()],Sh.prototype,"spherical",void 0);const JIe=8,QM=128,e3e={type:"uber",hasSlicePlane:!1,strokesTexture:null,legacy:!0,spherical:!0},t3e={solid:Pr.SOLID,sketch:Pr.SKETCH,uber:Pr.MIXED};let ZM=class pee{constructor(e,t,r){this._rctx=e,this._shaderTechniqueRepository=t,this._configuration=new Sh,this.refCount=0,this._renderables=new Set,this._sortedRenderables={[_t.TRANSPARENT]:{[_t.TRANSPARENT]:new Zt,[_t.OPAQUE]:new Zt},[_t.OPAQUE]:{[_t.TRANSPARENT]:new Zt,[_t.OPAQUE]:new Zt}},this._renderablesDirty=!1,this._drawParameters=new VIe,this._settings={...e3e,...r},this.key=pee.getKey(this._settings.type,this._settings.hasSlicePlane,this._settings.legacy);const n=this._settings.strokesTexture.variants;this.writerSettings={variants:n,reducedPrecision:jt.TESTS_DISABLE_OPTIMIZATIONS},this._configuration.legacy=this._settings.legacy,this._configuration.mode=t3e[this._settings.type],this._configuration.silhouette=!1,this._configuration.antialiasing=!!this._rctx.capabilities.blendMinMax,this._configuration.hasSlicePlane=this._settings.hasSlicePlane,this._configuration.doublePrecisionRequiresObfuscation=IP(e),this._configuration.spherical=r.spherical}dispose(){this._technique=Qi(this._technique)}addRenderable(e){this._renderables.add(e),this._renderablesDirty=!0}removeRenderable(e){this._renderables.delete(e),this._renderablesDirty=!0}setRenderablesDirty(){this._renderablesDirty=!0}forEachRenderable(e,t){this._renderablesDirty&&this._sortRenderables(),this._sortedRenderables[t][_t.TRANSPARENT].forAll(e),this._sortedRenderables[t][_t.OPAQUE].forAll(e)}updateTechnique(e,t){return this._configuration.hasMultipassTerrain=!!e.multipassTerrain.enabled,this._configuration.cullAboveGround=!!e.multipassTerrain.cullAboveGround,this._configuration.silhouette=t,this._technique=this._shaderTechniqueRepository.releaseAndAcquire(uee,this._configuration,this._technique),this._technique}bindRegularEdges(e,t){return this._lastOriginId=null,this._rctx.bindTechnique(this.updateTechnique(t,!1),e,t)}bindSilhouetteEdges(e,t){return this._lastOriginId=null,this._rctx.bindTechnique(this.updateTechnique(t,!0),e,t)}renderRegularEdges(e,t,r,n,s){this._render(e,t,t.regular.vao,r,n,s)}renderSilhouetteEdges(e,t,r,n,s){this._render(e,t,t.silhouette.vao,r,n,s)}_render(e,t,r,n,s,a){a>0&&(this._bindDraw(e,t,n,s),this._rctx.bindVAO(r),this._rctx.capabilities.instancing.drawArraysInstanced(Dt.TRIANGLE_FAN,0,4,a))}_bindDraw(e,t,r,n){if(this._drawParameters.componentDataTexture=t.components.buffer.textureBuffer.texture,this._drawParameters.strokesTexture=this._settings.strokesTexture,"origin"in t.transform)this._lastOriginId!==t.transform.origin.origin.id&&(e.setUniformMatrix4fv("localView",t.transform.origin.viewMatrix),this._lastOriginId=t.transform.origin.origin.id),e.setUniformMatrix4fv("model",t.transform.modelMatrix),this._drawParameters.slicePlaneLocalOrigin=t.transform.origin.origin.vec3;else{const s=new GR(t.transform.position),a=qc(yB,Zg(yB,t.transform.rotationScale));this._drawParameters.transformWorldFromModelTL=s.low,this._drawParameters.transformWorldFromModelTH=s.high,this._drawParameters.transformWorldFromModelRS=t.transform.rotationScale,this._drawParameters.transformNormalGlobalFromModel=a;const o=n.camera.viewInverseTransposeMatrix;Z(this._drawParameters.slicePlaneLocalOrigin,o[3],o[7],o[11])}e.bindDraw(this._drawParameters,n,r)}_sortRenderables(){this._renderablesDirty=!1,this._sortedRenderables[_t.TRANSPARENT][_t.TRANSPARENT].clear(),this._sortedRenderables[_t.TRANSPARENT][_t.OPAQUE].clear(),this._sortedRenderables[_t.OPAQUE][_t.TRANSPARENT].clear(),this._sortedRenderables[_t.OPAQUE][_t.OPAQUE].clear(),this._renderables.forEach(t=>{t.objectTransparency!==_t.INVISIBLE&&t.edgeTransparency!==_t.INVISIBLE&&this._sortedRenderables[t.objectTransparency][t.edgeTransparency].push(t)});const e=(t,r)=>"origin"in t.transform?"origin"in r.transform?t.transform.origin.origin.id<r.transform.origin.origin.id?-1:t.transform.origin.origin.id>r.transform.origin.origin.id?1:0:1:0;this._sortedRenderables[_t.TRANSPARENT][_t.TRANSPARENT].sort(e),this._sortedRenderables[_t.TRANSPARENT][_t.OPAQUE].sort(e),this._sortedRenderables[_t.OPAQUE][_t.TRANSPARENT].sort(e),this._sortedRenderables[_t.OPAQUE][_t.OPAQUE].sort(e)}static getKey(e,t,r){return`edges-t:${e}:${t}:${r}`}};const yB=cm();let i3e=class extends wae{constructor(e){super("EdgeProcessingWorker","extract",{extract:t=>[t.dataBuffer],extractComponentsEdgeLocations:t=>[t.dataBuffer],extractEdgeLocations:t=>[t.dataBuffer]},e)}async process(e,t,r){if(r)return zne(e);const n=await this.invoke(new YM(e),t);return this._unpackOutput(n)}async extractEdgeLocations(e,t){const r=await this.invokeMethod("extractEdgeLocations",new YM(e),t);return uT(r)}async extractComponentsEdgeLocations(e,t){const r=await this.invokeMethod("extractComponentsEdgeLocations",new YM(e),t);return uT(r)}_unpackOutput(e){return{regular:{instancesData:uT(e.regular.instancesData),lodInfo:{lengths:new Float32Array(e.regular.lodInfo.lengths)}},silhouette:{instancesData:uT(e.silhouette.instancesData),lodInfo:{lengths:new Float32Array(e.silhouette.lodInfo.lengths)}},averageEdgeLength:e.averageEdgeLength}}},YM=class{constructor(e){this.dataBuffer=e.data.buffer,this.writerSettings=e.writerSettings,this.skipDeduplicate=e.skipDeduplicate,this.indices=Array.isArray(e.indices)?e.indices:e.indices.buffer,this.indicesType=Array.isArray(e.indices)?"Array":Hee(e.indices)?"Uint32Array":"Uint16Array",this.indicesLength=e.indicesLength}};function r3e(i){const t=R1.resolution,r=t/2,n=new Uint8Array(4*t*t),s=4*t*r,a=R1.amplitude,o=2*a,l=4*t,c=Math.log2(t)+1,u=R1.strokes.length;let d=(c-1)*u*l;for(const{distance:f,pressure:_}of R1.strokes){let g=f,x=_,b=d;for(let v=0;v<c;v++){v!==0&&(g=vB(g,Sx.DISTANCE),x=vB(x,Sx.PRESSURE));for(let w=0;w<R1.resolution;w++){const T=.5+(g?g[w%g.length]/o:0),E=x?x[w%x.length]:1;$I(T,n,b),$I(E,n,b+s),b+=4}b-=l*(u+1)}d+=l}const m=new Gi(i,{pixelFormat:yt.RGBA,dataType:qt.UNSIGNED_BYTE,hasMipmap:!1,samplingMode:Kt.LINEAR,width:t,height:t,wrapMode:si.REPEAT},n);return new s3e(t,o,a,u,m)}function vB(i,e){if(!i)return null;const t=i.length/2,r=n3e*t,n=new Array(t);let s=0;const a=e===Sx.PRESSURE;for(let o=0;o<i.length;o+=2){const l=(i[o]+i[o+1])/2;n[s++]=a?Math.min(r,1-(1-l)*bB):Math.min(r,l*bB)}return n}var Sx;(function(i){i[i.DISTANCE=0]="DISTANCE",i[i.PRESSURE=1]="PRESSURE"})(Sx||(Sx={}));const n3e=.1,bB=.5;let s3e=class{constructor(e,t,r,n,s){this.resolution=e,this.normalizationScale=t,this.amplitude=r,this.variants=n,this.texture=s}dispose(){this.texture=Me(this.texture)}};const R1={amplitude:8,resolution:256,strokes:[{distance:[-1.59027,-1.59426,-1.59674,-1.59766,-1.59702,-1.59479,-1.59095,-1.5855,-1.57843,-1.56973,-1.55942,-1.5475,-1.53398,-1.5189,-1.50226,-1.4841,-1.46446,-1.44337,-1.42088,-1.39703,-1.37188,-1.34547,-1.31786,-1.28912,-1.2593,-1.22847,-1.19668,-1.16402,-1.13053,-1.09629,-1.06137,-1.02582,-.98972,-.95313,-.91611,-.87872,-.84102,-.80306,-.76488,-.72654,-.68807,-.64952,-.61092,-.57232,-.53375,-.49527,-.45692,-.41874,-.38078,-.34309,-.3057,-.26867,-.23204,-.19585,-.16015,-.12497,-.09036,-.05634,-.02296,.00977,.04183,.07321,.10389,.13386,.16313,.19169,.21956,.24672,.27321,.299,.32413,.34858,.37237,.3955,.41798,.43981,.461,.48154,.50145,.52073,.53939,.55744,.57488,.5917,.6079,.62347,.63837,.65259,.66609,.67885,.69083,.70201,.71235,.72183,.73042,.73812,.7449,.75076,.7557,.75973,.76284,.76507,.76642,.76692,.76659,.76545,.76352,.76083,.7574,.75324,.74837,.74279,.73652,.72959,.72199,.71377,.70493,.69553,.68558,.67515,.66426,.65298,.64135,.62944,.6173,.60499,.59257,.58008,.56759,.55513,.54275,.5305,.51842,.50654,.4949,.48353,.47246,.4617,.45128,.44121,.43149,.42213,.41313,.40448,.39617,.38818,.3805,.37309,.36594,.35902,.35229,.34572,.33927,.33292,.32663,.32035,.31407,.30774,.30135,.29486,.28824,.28148,.27454,.26739,.26002,.25241,.24454,.23639,.22796,.21922,.21016,.20076,.19098,.18082,.17023,.1592,.14768,.13566,.1231,.10996,.09624,.08188,.06688,.05121,.03485,.01778,0,-.0185,-.03771,-.05763,-.07824,-.09952,-.12144,-.14396,-.16706,-.19069,-.21481,-.23938,-.26436,-.28971,-.31539,-.34136,-.36759,-.39404,-.42067,-.44746,-.47437,-.50136,-.52839,-.55544,-.58248,-.60948,-.63642,-.66329,-.6901,-.71684,-.74352,-.77015,-.79675,-.82332,-.84988,-.87644,-.90301,-.92958,-.95615,-.98272,-1.00926,-1.03575,-1.06217,-1.08847,-1.11463,-1.1406,-1.16633,-1.19178,-1.2169,-1.24164,-1.26595,-1.28979,-1.31312,-1.3359,-1.35809,-1.37963,-1.4005,-1.42064,-1.44,-1.45853,-1.47616,-1.49285,-1.50853,-1.52313,-1.53659,-1.54886,-1.55986,-1.56955,-1.57788,-1.5848],pressure:[-.01365,-.00206,.01025,.02327,.03696,.05129,.06619,.08163,.09755,.11393,.1307,.14784,.16531,.18308,.20111,.21938,.23786,.25651,.2753,.29419,.31315,.33215,.35115,.37015,.38913,.40806,.42694,.44576,.46449,.48313,.50167,.5201,.53839,.55653,.57448,.59222,.60971,.62692,.6438,.66033,.67648,.69221,.70753,.72242,.73688,.75093,.76456,.77779,.79063,.80309,.81517,.82686,.83817,.84911,.85967,.86987,.87972,.88924,.89845,.90734,.91594,.92425,.93229,.94005,.94754,.95475,.96166,.96826,.97451,.9804,.98588,.99092,.99549,.99957,.99685,.99381,.99131,.98936,.98796,.98711,.98681,.98706,.98787,.98923,.99113,.99357,.99654,1,.99607,.99171,.98695,.98181,.97634,.97057,.96452,.95824,.95175,.94506,.93818,.93113,.92389,.91647,.90887,.90109,.89314,.88501,.87672,.86831,.85978,.85119,.84256,.83393,.82533,.8168,.80836,.80002,.79181,.78374,.77582,.7681,.76059,.75331,.74629,.73955,.73311,.72697,.72116,.71568,.71054,.70572,.70121,.697,.69304,.68931,.68576,.68236,.67905,.67582,.67262,.66941,.66619,.66291,.65957,.65613,.65259,.64892,.6451,.6411,.6369,.63248,.62783,.62295,.61783,.61247,.60688,.60104,.59498,.58868,.58216,.57542,.56845,.56125,.5538,.5461,.53813,.52986,.52129,.51239,.50316,.49359,.4837,.47349,.46299,.45223,.44124,.43005,.41869,.40719,.39557,.38386,.37207,.36023,.34836,.33648,.32464,.31287,.30119,.28963,.27822,.26698,.25594,.2451,.23448,.22409,.21391,.20394,.19415,.18452,.17503,.16565,.15636,.14713,.13794,.1288,.11968,.11058,.10151,.09247,.08346,.07447,.06552,.05659,.0477,.03885,.03007,.02137,.01278,.00433,-.00393,-.012,-.01983,-.02738,-.03463,-.04155,-.0481,-.05429,-.0601,-.06553,-.07057,-.07524,-.07954,-.08347,-.08703,-.09022,-.09303,-.09544,-.09744,-.09898,-.10004,-.10059,-.1006,-.10005,-.09892,-.0972,-.09487,-.09192,-.08833,-.08409,-.07918,-.07357,-.06724,-.06019,-.0524,-.04386,-.03455,-.02448]},{distance:[-3.46259,-3.47131,-3.47668,-3.47863,-3.47712,-3.4721,-3.46352,-3.45138,-3.43566,-3.41635,-3.39347,-3.36704,-3.33709,-3.30368,-3.26684,-3.22667,-3.18322,-3.1366,-3.08689,-3.0342,-2.97865,-2.92036,-2.85946,-2.79607,-2.73034,-2.66241,-2.59242,-2.52052,-2.44686,-2.37159,-2.29485,-2.2168,-2.13757,-2.05731,-1.97616,-1.89426,-1.81174,-1.72875,-1.64543,-1.56191,-1.47833,-1.39483,-1.3115,-1.22847,-1.14581,-1.06361,-.98193,-.90083,-.82036,-.74054,-.66141,-.583,-.50532,-.4284,-.35228,-.277,-.20261,-.12916,-.05672,.01463,.08485,.15384,.22153,.28784,.35269,.41602,.47776,.53787,.59629,.653,.70799,.76123,.81274,.86253,.9106,.95698,1.0017,1.04477,1.0862,1.126,1.16415,1.20065,1.23546,1.26857,1.29994,1.32953,1.35731,1.38321,1.40719,1.42921,1.44922,1.46719,1.48309,1.49691,1.50862,1.51825,1.52581,1.53133,1.53486,1.53644,1.53616,1.53409,1.53031,1.52493,1.51803,1.50972,1.50009,1.48924,1.47725,1.46421,1.45019,1.43527,1.4195,1.40295,1.38568,1.36778,1.34929,1.3303,1.31087,1.29108,1.27099,1.25066,1.23018,1.2096,1.18898,1.16838,1.14785,1.12745,1.10721,1.08719,1.06741,1.04791,1.02871,1.00986,.99136,.97324,.95551,.93819,.92127,.90476,.88866,.87296,.85767,.84277,.82823,.81406,.80022,.7867,.77346,.76049,.74774,.73519,.72278,.71049,.69827,.68606,.67381,.66145,.64893,.63618,.62313,.60973,.5959,.5816,.56675,.5513,.53516,.51826,.50053,.4819,.46231,.44169,.42002,.39725,.37336,.34834,.32219,.2949,.2665,.23698,.20638,.17469,.14193,.10809,.07316,.03714,0,-.03827,-.07772,-.11836,-.16022,-.20332,-.24768,-.29332,-.34024,-.38844,-.43788,-.48854,-.54036,-.59329,-.64724,-.70211,-.75782,-.81425,-.87128,-.92881,-.98674,-1.04498,-1.10346,-1.1621,-1.22086,-1.27969,-1.33854,-1.3974,-1.45625,-1.51511,-1.57396,-1.63283,-1.69173,-1.75067,-1.80968,-1.86875,-1.9279,-1.98712,-2.04639,-2.10568,-2.16495,-2.22416,-2.28322,-2.34208,-2.40063,-2.4588,-2.51647,-2.57354,-2.62989,-2.68543,-2.74002,-2.79357,-2.84597,-2.89711,-2.94689,-2.99521,-3.04195,-3.087,-3.13023,-3.17152,-3.21075,-3.24779,-3.28252,-3.3148,-3.34451,-3.37154,-3.39577,-3.41709,-3.43539,-3.45059],pressure:[.87183,.87151,.87129,.87118,.87117,.87128,.87149,.87182,.87225,.8728,.87347,.87424,.87513,.87613,.87723,.87845,.87978,.88122,.88276,.88441,.88616,.88801,.88996,.892,.89414,.89637,.89868,.90108,.90356,.90611,.90874,.91144,.91421,.91704,.91993,.92287,.92587,.92892,.93201,.93514,.93831,.94151,.94474,.94799,.95126,.95456,.95786,.96118,.9645,.96783,.97116,.97448,.9778,.98111,.98441,.9877,.99096,.99421,.99742,.99938,.99622,.9931,.99001,.98697,.98397,.98101,.97811,.97526,.97246,.96972,.96703,.96441,.96185,.95935,.95691,.95455,.95225,.95002,.94786,.94577,.94376,.94182,.93995,.93817,.93646,.93483,.93328,.93181,.93042,.92911,.92788,.92673,.92566,.92467,.92376,.92293,.92217,.92149,.92088,.92034,.91987,.91947,.91913,.91886,.91864,.91849,.91838,.91833,.91834,.91839,.91849,.91863,.91883,.91907,.91935,.91968,.92005,.92046,.92092,.92142,.92195,.92253,.92314,.9238,.92449,.92521,.92598,.92677,.9276,.92847,.92936,.93029,.93125,.93224,.93325,.9343,.93537,.93646,.93758,.93872,.93988,.94106,.94225,.94346,.94469,.94593,.94718,.94844,.94971,.95098,.95226,.95354,.95482,.9561,.95738,.95867,.95995,.96122,.9625,.96377,.96504,.9663,.96757,.96883,.97009,.97135,.97261,.97387,.97513,.9764,.97767,.97895,.98023,.98153,.98284,.98416,.98549,.98684,.98821,.9896,.99101,.99244,.99389,.99537,.99688,.99842,1,.99839,.99675,.99508,.99336,.99161,.98982,.98799,.98613,.98422,.98228,.98029,.97827,.97622,.97414,.97202,.96987,.9677,.96551,.9633,.96107,.95882,.95656,.9543,.95202,.94975,.94747,.94519,.94292,.94065,.93838,.93613,.93388,.93164,.92941,.9272,.92499,.9228,.92062,.91846,.91631,.91418,.91207,.90998,.90792,.90588,.90387,.90189,.89995,.89804,.89617,.89434,.89256,.89083,.88914,.88752,.88595,.88443,.88299,.88161,.8803,.87907,.87791,.87683,.87584,.87494,.87412,.8734,.87278,.87225]},{distance:[.39335,.43437,.47737,.52234,.56923,.61801,.66864,.72109,.7753,.83123,.88882,.94801,1.00875,1.07097,1.13461,1.1996,1.26586,1.33333,1.40193,1.47158,1.54221,1.61373,1.68607,1.75913,1.83284,1.90711,1.98186,2.05699,2.13243,2.20809,2.28387,2.35971,2.4355,2.51117,2.58663,2.66179,2.73658,2.81092,2.88473,2.95792,3.03043,3.10217,3.17308,3.24309,3.31211,3.3801,3.44697,3.51267,3.57712,3.64028,3.70208,3.76247,3.8214,3.87881,3.93467,3.98892,4.04152,4.09244,4.14164,4.18908,4.23474,4.27859,4.32061,4.36077,4.39905,4.43544,4.46992,4.50249,4.53314,4.56185,4.58864,4.61349,4.63642,4.65745,4.67657,4.69381,4.7092,4.72274,4.73447,4.74441,4.75259,4.75903,4.76376,4.76682,4.76822,4.768,4.76618,4.76279,4.75786,4.75142,4.74348,4.73409,4.72326,4.71102,4.69739,4.68241,4.6661,4.64849,4.6296,4.60948,4.58816,4.56567,4.54204,4.51732,4.49154,4.46473,4.43694,4.4082,4.37854,4.348,4.31662,4.28443,4.25145,4.21773,4.1833,4.14819,4.11243,4.07606,4.03912,4.00162,3.96361,3.92512,3.88618,3.84683,3.80708,3.76697,3.72653,3.68579,3.64478,3.60351,3.56202,3.52033,3.47845,3.43642,3.39425,3.35196,3.30957,3.2671,3.22455,3.18196,3.13933,3.09668,3.05402,3.01136,2.96873,2.92613,2.88357,2.84108,2.79865,2.75631,2.71407,2.67195,2.62994,2.58807,2.54634,2.50477,2.46338,2.42216,2.38114,2.34032,2.29971,2.25933,2.21916,2.17923,2.13954,2.10008,2.06087,2.02189,1.98316,1.94468,1.90644,1.86845,1.83069,1.79316,1.75586,1.71877,1.68189,1.6452,1.60868,1.57232,1.53611,1.50004,1.46407,1.4282,1.39241,1.35668,1.321,1.28535,1.24972,1.2141,1.17849,1.14286,1.10723,1.07158,1.03593,1.00028,.96464,.92902,.89344,.85793,.8225,.78719,.75203,.71705,.68231,.64784,.61369,.57991,.54656,.51368,.48134,.44959,.41849,.3881,.35848,.32967,.30174,.27474,.24872,.22373,.19982,.17702,.15539,.13497,.11579,.09791,.08137,.06621,.05248,.04022,.02948,.02029,.01271,.00677,.00252,0,-76e-5,27e-5,.00314,.00788,.01451,.02307,.03357,.04604,.0605,.07697,.09546,.11599,.13858,.16322,.18992,.21869,.24952,.28241,.31735,.35434],pressure:[.95248,.95236,.95228,.95223,.95222,.95224,.95231,.95241,.95256,.95274,.95296,.95322,.95352,.95385,.95423,.95465,.9551,.9556,.95613,.9567,.95731,.95796,.95864,.95936,.96012,.96091,.96173,.96259,.96348,.9644,.96535,.96633,.96734,.96838,.96944,.97053,.97164,.97277,.97393,.9751,.97629,.9775,.97873,.97997,.98122,.98249,.98376,.98505,.98634,.98763,.98893,.99023,.99154,.99284,.99414,.99544,.99673,.99802,.9993,.99942,.99816,.99691,.99568,.99445,.99324,.99205,.99087,.98972,.98858,.98746,.98636,.98528,.98423,.9832,.98219,.98121,.98025,.97931,.9784,.97752,.97666,.97582,.97501,.97423,.97347,.97274,.97203,.97135,.9707,.97007,.96948,.9689,.96836,.96784,.96735,.96689,.96646,.96605,.96567,.96533,.965,.96471,.96445,.96421,.964,.96382,.96367,.96355,.96346,.96339,.96335,.96334,.96336,.9634,.96348,.96358,.9637,.96385,.96403,.96423,.96446,.96471,.96499,.96529,.96561,.96595,.96631,.96669,.96709,.96751,.96795,.9684,.96887,.96935,.96984,.97035,.97087,.9714,.97194,.97249,.97304,.97361,.97418,.97476,.97534,.97592,.97651,.97711,.9777,.9783,.9789,.9795,.9801,.9807,.9813,.9819,.9825,.98309,.98369,.98428,.98486,.98545,.98603,.98661,.98718,.98775,.98832,.98888,.98944,.99,.99056,.99112,.99167,.99223,.99279,.99335,.99392,.99449,.99507,.99565,.99624,.99684,.99745,.99807,.9987,.99934,1,.99933,.99866,.99797,.99727,.99656,.99583,.9951,.99435,.99359,.99283,.99205,.99126,.99046,.98966,.98885,.98803,.9872,.98637,.98554,.9847,.98387,.98303,.98219,.98134,.9805,.97967,.97883,.978,.97717,.97634,.97552,.97471,.97389,.97309,.97229,.9715,.97071,.96993,.96915,.96838,.96762,.96687,.96612,.96539,.96466,.96395,.96324,.96255,.96187,.9612,.96055,.95991,.95929,.95869,.95811,.95754,.957,.95648,.95599,.95552,.95508,.95467,.95428,.95393,.9536,.95331,.95305,.95283,.95264]},{distance:[2.85606,2.86149,2.86432,2.8645,2.862,2.85686,2.84912,2.83886,2.82618,2.81117,2.79393,2.77456,2.75314,2.72975,2.70447,2.67734,2.64844,2.61784,2.58564,2.55196,2.5169,2.48057,2.44305,2.40438,2.36462,2.32383,2.28208,2.23943,2.19591,2.15153,2.10628,2.06016,2.01321,1.96548,1.91702,1.86793,1.8183,1.76829,1.71803,1.66767,1.61737,1.56726,1.51746,1.46803,1.41902,1.37044,1.32228,1.27452,1.22716,1.18023,1.13376,1.08781,1.04244,.99769,.95357,.91003,.86701,.82447,.78238,.74069,.69938,.65836,.61758,.57699,.53656,.49627,.45611,.41611,.37632,.33683,.29776,.25924,.22141,.18441,.14839,.11346,.07972,.04727,.01619,-.01348,-.0417,-.0684,-.09351,-.11698,-.13875,-.1588,-.17713,-.19381,-.20889,-.22242,-.23444,-.24501,-.25421,-.26216,-.26897,-.27473,-.27951,-.28336,-.28631,-.28836,-.28948,-.28963,-.28873,-.28673,-.28355,-.27916,-.27354,-.26673,-.25878,-.2498,-.23992,-.22929,-.21802,-.20623,-.19398,-.18134,-.16836,-.1551,-.14163,-.12809,-.11461,-.1013,-.08826,-.07557,-.06335,-.0517,-.04077,-.03065,-.02143,-.01321,-.00606,0,.00496,.00888,.01181,.01385,.01511,.0157,.01574,.01533,.01458,.01358,.0124,.01112,.00979,.00851,.00738,.0065,.006,.00596,.00646,.00754,.00924,.01161,.01471,.01858,.02323,.02865,.03481,.04169,.0493,.05765,.06677,.07671,.08754,.09934,.11222,.12628,.14159,.15823,.17624,.19561,.21632,.23828,.26142,.28563,.31083,.33696,.36397,.39185,.42057,.4501,.48036,.51125,.54264,.5744,.60646,.63871,.67105,.70337,.73556,.76751,.79918,.83048,.86139,.8919,.92202,.95184,.98144,1.01094,1.04045,1.0701,1.10002,1.13029,1.16103,1.1923,1.22416,1.25664,1.28979,1.32364,1.35824,1.39363,1.42985,1.4669,1.50475,1.54332,1.58252,1.62227,1.6625,1.70312,1.744,1.78501,1.82598,1.8668,1.90734,1.94754,1.98732,2.02666,2.06555,2.10402,2.1421,2.17985,2.2173,2.25448,2.29139,2.328,2.36424,2.4,2.43515,2.46955,2.50309,2.53565,2.56717,2.59761,2.62692,2.65505,2.68191,2.7074,2.73138,2.75375,2.7744,2.79324,2.81017,2.82504,2.83772,2.8481],pressure:[.22758,.23641,.24578,.25568,.26609,.27699,.28835,.30016,.31237,.32495,.33789,.35113,.36466,.37843,.39241,.40658,.4209,.43535,.44989,.4645,.47916,.49385,.50853,.5232,.53784,.55243,.56696,.58141,.59578,.61004,.62419,.63821,.65209,.6658,.67934,.69268,.70582,.71873,.73139,.7438,.75594,.76779,.77935,.79061,.80156,.81221,.82254,.83258,.84231,.85176,.86091,.86978,.87837,.88669,.89473,.9025,.91,.91725,.92425,.931,.93752,.9438,.94985,.95566,.96124,.96658,.97168,.97652,.98109,.98539,.98939,.99309,.99646,.99949,.99783,.99552,.99361,.99209,.99098,.99029,.99003,.99019,.99079,.99181,.99324,.9951,.99735,1,.99698,.99361,.98992,.98592,.98163,.97709,.97231,.96731,.96212,.95676,.95122,.94554,.93973,.93378,.92773,.92157,.91532,.90899,.90258,.89612,.88961,.88308,.87653,.87,.8635,.85705,.85068,.8444,.83823,.83219,.82628,.82052,.81493,.80952,.8043,.79929,.7945,.78994,.78561,.78151,.77765,.77402,.77062,.76742,.76443,.76161,.75896,.75645,.75406,.75175,.74951,.7473,.74511,.74289,.74064,.73833,.73592,.73341,.73078,.728,.72507,.72197,.71869,.71522,.71156,.70769,.70363,.69936,.69489,.69021,.68533,.68023,.67492,.66939,.66363,.65765,.65145,.64501,.63833,.63143,.62428,.61691,.60931,.60148,.59344,.58521,.57679,.5682,.55948,.55063,.54167,.53264,.52354,.51439,.50522,.49603,.48686,.47773,.46865,.45964,.45072,.44192,.43324,.42469,.41629,.40804,.39994,.392,.3842,.37655,.36903,.36164,.35437,.3472,.34012,.33312,.3262,.31933,.31251,.30574,.299,.2923,.28563,.27899,.27239,.26583,.25933,.25288,.24652,.24025,.2341,.22808,.22221,.21653,.21104,.20576,.20072,.19592,.19138,.18712,.18313,.17943,.17602,.17292,.17013,.16766,.16551,.16369,.16222,.1611,.16036,.16001,.16007,.16055,.16148,.16286,.16471,.16705,.16988,.17321,.17706,.18144,.18636,.19182,.19785,.20443,.21158,.2193]},{distance:[-2.31317,-2.3191,-2.32189,-2.32154,-2.31811,-2.31174,-2.30254,-2.29062,-2.27609,-2.25904,-2.23954,-2.21767,-2.19355,-2.16732,-2.13907,-2.10885,-2.07672,-2.04268,-2.00677,-1.96911,-1.92985,-1.88914,-1.84713,-1.80397,-1.75979,-1.71467,-1.66864,-1.62171,-1.57395,-1.52546,-1.47625,-1.42628,-1.3755,-1.32384,-1.27131,-1.218,-1.16408,-1.10972,-1.05508,-1.00031,-.94551,-.89077,-.83615,-.7817,-.72757,-.6739,-.62076,-.56821,-.51625,-.46484,-.41397,-.36366,-.314,-.26506,-.21689,-.16957,-.12316,-.07766,-.03301,.01085,.05399,.09643,.13827,.17967,.22079,.26176,.30265,.34342,.38397,.42414,.46381,.50285,.54115,.57863,.61524,.65093,.6856,.71914,.75153,.78275,.81283,.84182,.86972,.89651,.92208,.94634,.96919,.99052,1.01025,1.02835,1.04484,1.05976,1.07309,1.08479,1.09492,1.1036,1.11096,1.11714,1.12224,1.12627,1.12916,1.13083,1.13125,1.13036,1.12816,1.12466,1.11992,1.11397,1.10677,1.09827,1.08849,1.07746,1.06527,1.05203,1.03786,1.02283,1.00695,.99025,.97279,.9546,.93573,.9163,.8965,.8765,.85647,.83652,.81687,.79775,.77939,.76199,.74568,.73049,.71635,.70316,.69082,.67925,.66834,.65804,.64831,.63911,.63032,.62184,.61363,.60564,.59788,.59036,.58308,.57597,.5689,.56177,.55447,.5469,.53896,.53062,.5219,.51283,.5034,.49355,.48335,.47287,.46223,.45154,.44085,.43012,.41923,.40805,.39648,.38441,.37176,.35849,.34458,.32999,.31461,.29833,.28109,.26288,.2437,.22361,.20265,.18082,.15807,.13434,.1096,.0838,.0569,.02894,0,-.0298,-.0604,-.09173,-.12364,-.15594,-.18843,-.22092,-.25331,-.28559,-.31781,-.35006,-.38244,-.41502,-.44785,-.48098,-.5144,-.54811,-.58218,-.61666,-.65153,-.68677,-.72232,-.75807,-.79397,-.83002,-.86628,-.90281,-.93968,-.97693,-1.01465,-1.05282,-1.09139,-1.13031,-1.16956,-1.20917,-1.24905,-1.28907,-1.32908,-1.36891,-1.40844,-1.44765,-1.48658,-1.52527,-1.56376,-1.60206,-1.64016,-1.67801,-1.71552,-1.75264,-1.78936,-1.8257,-1.86161,-1.89702,-1.93182,-1.96584,-1.99894,-2.03102,-2.06203,-2.0919,-2.12056,-2.14794,-2.17397,-2.19852,-2.22138,-2.24235,-2.26129,-2.27805,-2.29243,-2.30422],pressure:[.9681,.97424,.98046,.98674,.99309,.9995,.99404,.98754,.981,.97444,.96785,.96124,.95462,.94801,.94139,.93479,.92822,.92167,.91515,.90868,.90225,.89589,.88959,.88336,.87722,.87115,.86519,.85932,.85356,.84792,.84239,.83699,.83173,.8266,.82162,.81679,.81211,.80759,.80324,.79906,.79505,.79121,.78756,.78409,.78081,.77771,.77481,.77211,.76959,.76728,.76516,.76324,.76153,.76001,.75869,.75757,.75665,.75593,.7554,.75507,.75493,.75498,.75523,.75565,.75627,.75706,.75803,.75917,.76049,.76197,.76361,.76541,.76737,.76947,.77172,.77409,.7766,.77923,.78198,.78484,.7878,.79086,.79401,.79724,.80055,.80394,.8074,.81092,.8145,.81813,.82182,.82556,.82934,.83317,.83703,.84093,.84487,.84884,.85284,.85687,.86094,.86503,.86915,.87329,.87746,.88166,.88587,.89011,.89436,.89863,.90291,.9072,.91149,.91579,.92009,.92438,.92867,.93295,.9372,.94144,.94566,.94985,.954,.95812,.96219,.96623,.97021,.97415,.97802,.98184,.9856,.9893,.99293,.9965,1,.99657,.9932,.98991,.98668,.98352,.98042,.97738,.9744,.97148,.9686,.96577,.96298,.96023,.95751,.95482,.95214,.94949,.94684,.9442,.94156,.93892,.93627,.93361,.93094,.92825,.92555,.92284,.9201,.91735,.91458,.91179,.90899,.90616,.90332,.90047,.8976,.89472,.89183,.88893,.88603,.88314,.88024,.87735,.87448,.87162,.86878,.86597,.86319,.86044,.85774,.85508,.85247,.84993,.84744,.84503,.84269,.84042,.83825,.83616,.83417,.83227,.83048,.8288,.82724,.82578,.82445,.82324,.82215,.82119,.82037,.81967,.81911,.81868,.81839,.81824,.81823,.81835,.81862,.81903,.81957,.82026,.82109,.82206,.82317,.82443,.82583,.82737,.82906,.83089,.83287,.83499,.83726,.83968,.84223,.84494,.84778,.85077,.8539,.85717,.86058,.86412,.86781,.87163,.87559,.87968,.88391,.88826,.89275,.89737,.90211,.90698,.91198,.91709,.92233,.92768,.93315,.93873,.94441,.95019,.95607,.96205]},{distance:[4.72925,4.81721,4.9037,4.98859,5.07177,5.15311,5.23249,5.3098,5.38491,5.45772,5.52811,5.59598,5.66122,5.72375,5.78346,5.84028,5.8941,5.94486,5.99248,6.03689,6.07803,6.11584,6.15028,6.18128,6.20882,6.23285,6.25336,6.27031,6.28369,6.29348,6.29969,6.3023,6.30133,6.29678,6.28867,6.27703,6.26187,6.24324,6.22116,6.19567,6.16683,6.13468,6.09928,6.06068,6.01896,5.97417,5.92639,5.87569,5.82217,5.76589,5.70696,5.64545,5.58147,5.5151,5.44644,5.37559,5.30265,5.2277,5.15085,5.0722,4.99184,4.90987,4.82639,4.74151,4.65533,4.56794,4.47945,4.38996,4.29959,4.20843,4.11658,4.02416,3.93125,3.83796,3.74437,3.65057,3.55666,3.46272,3.36884,3.27509,3.18155,3.08831,2.99545,2.90303,2.81114,2.71984,2.62922,2.53933,2.45026,2.36207,2.27484,2.18862,2.10349,2.01951,1.93675,1.85528,1.77515,1.69644,1.61919,1.54348,1.46935,1.39685,1.32605,1.25698,1.18967,1.12417,1.06049,.99863,.93862,.88044,.82408,.76953,.71676,.66574,.61644,.56882,.52282,.47841,.43553,.39413,.35414,.31551,.27817,.24206,.20712,.17328,.14048,.10866,.07776,.04772,.01848,-.00999,-.03776,-.06487,-.09134,-.11721,-.14251,-.16725,-.19144,-.21509,-.2382,-.26076,-.28275,-.30416,-.32496,-.34511,-.36459,-.38334,-.40134,-.41852,-.43485,-.45026,-.46471,-.47815,-.49052,-.50179,-.51189,-.52081,-.52849,-.5349,-.54003,-.54383,-.54627,-.54734,-.54702,-.54528,-.54211,-.53752,-.53149,-.52403,-.51515,-.50487,-.4932,-.48015,-.46575,-.45001,-.43297,-.41463,-.39503,-.37419,-.35213,-.32887,-.30443,-.27885,-.25214,-.22432,-.19541,-.16544,-.13442,-.10235,-.06926,-.03514,0,.03616,.07336,.11159,.15088,.19125,.23272,.27531,.31906,.36401,.41019,.45764,.5064,.55651,.60802,.66096,.71538,.77129,.82874,.88776,.94836,1.01056,1.07438,1.13982,1.20687,1.27554,1.34581,1.41766,1.49107,1.56599,1.64239,1.72025,1.79951,1.88013,1.96209,2.04532,2.12979,2.21546,2.30226,2.39017,2.47911,2.56905,2.65991,2.75164,2.84416,2.93742,3.03133,3.12582,3.2208,3.31619,3.41191,3.50785,3.60393,3.70006,3.79612,3.89202,3.98765,4.08291,4.17767,4.27182,4.36525,4.45783,4.54944,4.63995],pressure:[.30942,.30838,.30765,.30724,.30715,.30738,.30795,.30884,.31007,.31164,.31354,.31578,.31837,.32129,.32455,.32815,.33209,.33636,.34097,.34591,.35117,.35675,.36265,.36887,.37539,.38221,.38933,.39674,.40442,.41238,.4206,.42907,.43779,.44675,.45593,.46533,.47493,.48473,.49471,.50486,.51517,.52563,.53623,.54694,.55777,.5687,.57971,.59079,.60194,.61313,.62435,.6356,.64686,.65811,.66935,.68056,.69174,.70286,.71391,.72489,.73579,.74659,.75728,.76785,.7783,.7886,.79876,.80877,.81861,.82827,.83776,.84706,.85617,.86507,.87378,.88227,.89056,.89863,.90649,.91412,.92153,.92872,.93568,.94241,.94892,.95519,.96122,.96702,.97258,.97791,.98299,.98783,.99242,.99677,.99911,.99525,.99164,.98827,.98515,.98228,.97966,.97728,.97514,.97324,.97159,.97017,.96898,.96801,.96727,.96674,.96641,.96629,.96635,.96661,.96703,.96762,.96838,.96928,.97032,.97149,.97279,.9742,.97572,.97734,.97905,.98085,.98273,.98468,.98669,.98877,.99091,.99311,.99535,.99765,1,.9976,.99516,.99267,.99014,.98755,.98491,.98222,.97947,.97666,.97378,.97083,.96781,.96471,.96153,.95826,.9549,.95144,.94787,.9442,.94042,.93651,.93249,.92834,.92407,.91966,.91512,.91045,.90564,.90069,.8956,.89037,.885,.87949,.87384,.86806,.86214,.85608,.84988,.84356,.83711,.83053,.82383,.81702,.81009,.80306,.79594,.78872,.78141,.77403,.76657,.75905,.75148,.74385,.73619,.72849,.72076,.71302,.70526,.69749,.68972,.68195,.67419,.66644,.65871,.65099,.64329,.63561,.62795,.62032,.61271,.60512,.59755,.59001,.58248,.57497,.56749,.56002,.55256,.54512,.5377,.5303,.52291,.51554,.50819,.50087,.49358,.48632,.4791,.47192,.4648,.45773,.45072,.44378,.43692,.43015,.42346,.41687,.41039,.40403,.39779,.39168,.38571,.37989,.37423,.36873,.36342,.35828,.35335,.34862,.34409,.3398,.33573,.3319,.32831,.32498,.32192,.31912,.3166,.31436,.31242,.31077]}]};function wB(i){let e=null;for(const t of i){const r=t.type;if(a3e(t)){if(S(e))e=r;else if(e!==r)return"uber"}}return y(e)?e:"uber"}function xB(i){let e=_t.INVISIBLE;for(const{material:t}of i)if(mee(t)){if(t.color[3]*t.opacity<1)return _t.TRANSPARENT;e=_t.OPAQUE}return e}function TB(i){let e=_t.INVISIBLE;for(const{material:t}of i)if(mee(t)){switch(t.objectTransparency){case _t.TRANSPARENT:case _t.INVISIBLE:return _t.TRANSPARENT;case _t.OPAQUE:if(t.opacity<1)return _t.TRANSPARENT}e=_t.OPAQUE}return e}function mee(i){return i.size*i.color[3]*i.opacity>0}function a3e(i){return i.size*i.color[3]>0}function CB(i,e,t,r){for(let n=0;n<i.length;n++){const s=i[n].index,a=e[n],o=e[n+1];if(r)for(let l=a;l<o;l++){const c=r[l];t.set(c,s)}else for(let l=a;l<o;l++)t.set(l,s)}}let lc=class extends ue{constructor(e){super(e),this._updatingHandles=new mv,this._perObjectData=new Map,this._perObjectDataEvictionCache=new Set,this._renderers=new Map,this._gpuMemoryUsage=0,this._workerAbort=new AbortController,this._tmpModelPosition=R(),this._localOrigins=new FIe(new m4(e.renderSR))}initialize(){this._worker=new i3e(this.schedule),this._componentColorManager=new AJ(this.rctx,3);const e=Bne.createBuffer(4);for(let t=0;t<4;t++)e.sideness.set(t,0,t===0||t===3?0:1),e.sideness.set(t,1,t===0||t===1?0:1);this._verticesBufferObject=hi.createVertex(this.rctx,di.STATIC_DRAW,e.buffer)}destroy(){this.destroyed||(this._perObjectData.forEach(e=>this._discardObjectEntry(e)),this._perObjectData.clear(),this._strokesTexture=Me(this._strokesTexture),this._componentColorManager=Te(this._componentColorManager),this._workerAbort.abort(),this._worker.destroy(),this._verticesBufferObject=Me(this._verticesBufferObject),this._renderers.clear(),this._updatingHandles.destroy())}get updating(){return this._updatingHandles.updating}get usedMemory(){return this._gpuMemoryUsage}shouldRender(){return this._renderers.size>0}async addComponentObject(e,t,r,n,s,a,o,l){if(this.hasObject(e))return this.getObjectMemoryUsage(e);let c;const u=new SB(new Promise(m=>c=m),r.center,r.radius);this._perObjectData.set(e,u);const d=await this._updatingHandles.addPromise(this._addComponentGeometry(t,u,n,s,a,o,l));return this.setNeedsRender(),c(),d}async addOrUpdateObject3D(e,t,r,n){if(this.destroyed)return void J.getLogger(this.declaredClass).warn("Attempt to add an object to a destroyed instance");const s=this._perObjectData.get(e);let a;(s==null?void 0:s.renderables.length)>0&&this._perObjectDataEvictionCache.add(s);const o=e.boundingVolumeWorldSpace.bounds,l=new SB(new Promise(u=>a=u),_D(o),sG(o));this._perObjectData.set(e,l);const c=new Array;if(r.mergeGeometries&&e.geometries.length>1&&l3e(e))c.push(this._addObjectMergedGeometries(e,l,t,r,n));else for(let u=0;u<e.geometries.length;u++){const d=e.geometryRecords[u];if(!d.material.supportsEdges)continue;const m=e.geometries[u];c.push(this._addGeometry(e,l,m,d,t[0],r,n))}await this._updatingHandles.addPromise(Promise.all(c)),this._perObjectDataEvictionCache.delete(l),this._discardObjectEntry(s),this.setNeedsRender(),a()}_discardObjectEntry(e){e&&(e.renderables.length&&(e.renderables.forEach(t=>this._removeRenderable(t)),this.setNeedsRender()),e.loaded=null)}hasObject(e){return this._perObjectData.has(e)}async updateAllComponentOpacities(e,t){const r=await this._updatingHandles.addPromise(this._getObjectEntry(e));if(S(r))return;const n=t instanceof Array?s=>t[s]:()=>t;r.renderables.forEach(s=>{const a=s.components.meta.length;for(let o=0;o<a;o++){const l=n(o),c=s.components.meta[o],u=c.index;c.material.opacity=l,s.components.buffer.textureBuffer.setDataElement(u,1,3,255*l)}this._updateTransparency(s)}),this.setNeedsRender()}async getObjectMemoryUsage(e){const t=await this._getObjectEntry(e);return y(t)?t.renderables.reduce((r,n)=>r+n.statistics.gpuMemoryUsage,0):0}async updateAllComponentMaterials(e,t,r,n){const s=e instanceof Bd,a=!!r.hasSlicePlane,o=wB(t),l=ZM.getKey(o,a,s),c=await this._updatingHandles.addPromise(this._getObjectEntry(e));S(c)||(c.renderables.forEach(u=>{if(l!==u.rendererKey){const d=this._renderers.get(u.rendererKey),m=this._acquireRenderer(o,a,s);d.removeRenderable(u),--d.refCount,u.rendererKey=l,m.addRenderable(u)}for(let d=0;d<t.length;d++)u.components.meta[d].material=t[d];n&&this._updateComponentBuffer(u.components),this._updateTransparency(u)}),this.setNeedsRender())}async updateAllVerticalOffsets(e,t){const r=await this._updatingHandles.addPromise(this._getObjectEntry(e));S(r)||(r.renderables.forEach(n=>{const s=n.components.meta;for(let a=0;a<s.length;a++)n.components.meta[a].verticalOffset=(t==null?void 0:t[a])??0;this._updateComponentBuffer(n.components)}),this.setNeedsRender())}async updateObjectVisibility(e,t){const r=await this._updatingHandles.addPromise(this._getObjectEntry(e));y(r)&&(r.renderables.forEach(n=>n.visible=t),this.setNeedsRender())}removeObject(e){const t=this._perObjectData.get(e);t&&(this._perObjectData.delete(e),this._discardObjectEntry(t))}async _getObjectEntry(e){const t=this._perObjectData.get(e);if(!t)throw"no object";return await t.loaded,t.loaded==null?null:t}render(e,t){if(S(this._componentColorManager))return;this._localOrigins.updateViewMatrices(e.camera.viewMatrix);const r=e.camera.viewInverseTransposeMatrix,n=R(),s=new GR;let a=0,o=0;if(this._renderers.forEach(c=>{if(c.refCount===0)this._renderers.delete(c.key),c.dispose();else{let u=!0,d=!0;c.forEachRenderable(m=>{m.visible&&(a+=m.statistics.averageEdgeLength,o++,u&&m.regular&&(c.updateTechnique(e,!1),u=!1),d&&m.silhouette&&(c.updateTechnique(e,!0),d=!1))},t)}}),this._componentColorManager.garbageCollect(),this._componentColorManager.updateTextures(),o===0)return;const l=new kIe(40*a/o,t);Z(n,r[3],r[7],r[11]),s.set(n),q(l.transformWorldFromViewTH,s.high),q(l.transformWorldFromViewTL,s.low),Td(l.transformViewFromCameraRelativeRS,e.camera.viewMatrix),qc(OB,l.transformViewFromCameraRelativeRS),Zg(l.transformNormalViewFromGlobal,OB),l.transformProjFromView=e.camera.projectionMatrix,this._updateObjectCameraDistances(e),this._renderers.forEach(c=>{this._renderRegularEdges(c,e,l),this._renderSilhouetteEdges(c,e,l)})}_updateTransparency(e){const t=xB(e.components.meta),r=TB(e.components.meta);t===e.edgeTransparency&&r===e.objectTransparency||(e.edgeTransparency=t,e.objectTransparency=r,this._renderers.get(e.rendererKey).setRenderablesDirty())}_computeModelTransformWithLocalOrigin(e,t,r){e.getCombinedStaticTransformation(t,r);const n=y(t.origin)?this._localOrigins.register(t.origin):this._localOrigins.acquire(Z(this._tmpModelPosition,r[12],r[13],r[14]));return t.origin=n.origin,$Ie(n.origin.vec3,r),n}_updateComponentBuffer(e){const{meta:t,buffer:r}=e,n=new Uint8Array(4);for(let s=0;s<t.length;s++){const a=t[s].material,o=t[s].index,l=ce(Math.round(a.size*JIe),0,255),c=ce(a.extensionLength,-QM,255-QM)+QM,u=a.type==="solid"?z5.SOLID:z5.SKETCH,d=255*a.opacity,m=a.color,f=255*m[0],_=255*m[1],g=255*m[2],x=255*m[3];r.textureBuffer.setData(o,0,f,_,g,x),r.textureBuffer.setData(o,1,l,c,u,d),CJ(t[s].verticalOffset,n),r.textureBuffer.setData(o,2,n[0],n[1],n[2],n[3])}}_createComponentBuffers(e){if(S(this._componentColorManager))return null;const t=new Array,r=this._componentColorManager.getBuffer(e.length);for(let s=0;s<e.length;s++){const a=e[s],o=r.acquireIndex();t.push({index:o,verticalOffset:0,material:a})}const n=new c3e(r,t);return this._updateComponentBuffer(n),n}_extractEdges(e,t,r,n,s,a=s.length){return this._worker.process({data:t,indices:s,indicesLength:a,writerSettings:e,skipDeduplicate:r},this._workerAbort.signal,n)}_createRenderable(e,t,r,n,s){const a=y(this._verticesBufferObject)&&e.regular.lodInfo.lengths.length>0?new EB(new nu(this.rctx,MI,{vertices:B5,instances:Gne.glLayout},{vertices:this._verticesBufferObject,instances:hi.createVertex(this.rctx,di.STATIC_DRAW,e.regular.instancesData.buffer)}),e.regular.lodInfo):null,o=y(this._verticesBufferObject)&&e.silhouette.lodInfo.lengths.length>0?new EB(new nu(this.rctx,MI,{vertices:B5,instances:Hne.glLayout},{vertices:this._verticesBufferObject,instances:hi.createVertex(this.rctx,di.STATIC_DRAW,e.silhouette.instancesData.buffer)}),e.silhouette.lodInfo):null,l=(y(a)?a.vao.size:0)+(y(o)?o.vao.size:0);return new u3e(a,o,{gpuMemoryUsage:l,externalMemoryUsage:s,averageEdgeLength:e.averageEdgeLength},r,xB(t.meta),TB(t.meta),t,n)}async _addGeometry(e,t,r,n,s,a,o){const l=r.vertexAttributes.get(P.POSITION),c=r.indices.get(P.POSITION),u=ve(),d=this._computeModelTransformWithLocalOrigin(e,n,u),m=new AB(l,c,u,d);return this._addPositionData(t,m,r.edgeIndicesLength,s,a,o)}async _addPositionData(e,t,r,n,s,a=!1){if(e.loaded==null)return;const o=this._createComponentBuffers([n]);if(S(o)||r<=0)return;const l=this._acquireRenderer(n.type,!!s.hasSlicePlane,!0),{modelTransform:c,origin:u}=t,d=t.indices,m=t.position,f=m.data.length/m.size,_=OI.createBuffer(f);for(let b=0;b<f;b++)_.position.set(b,0,m.data[b*m.size+0]),_.position.set(b,1,m.data[b*m.size+1]),_.position.set(b,2,m.data[b*m.size+2]);CB(o.meta,[0,_.componentIndex.count],_.componentIndex);const g=await this._updatingHandles.addPromise(this._extractEdges(l.writerSettings,_,!1,a,d,r));if(e.loaded==null)return;const x=this._createRenderable(g,o,new h3e(c,u),l.key,!1);e.renderables.push(x),l.addRenderable(x),this._gpuMemoryUsage+=x.statistics.gpuMemoryUsage}async _addComponentGeometry(e,t,r,n,s,a,o){if(t.loaded==null)return 0;const l=this._createComponentBuffers(a);if(S(l))return 0;const c=wB(a),u=this._acquireRenderer(c,o.hasSlicePlane||!1,!1),d=OI.createBuffer(r.count);rH(d.position,r),CB(l.meta,s,d.componentIndex,n);const m=!0,f=u.writerSettings,_=await this._updatingHandles.addPromise(this._extractEdges(f,d,m,!1,n));if(t.loaded==null)return 0;const g=this._createRenderable(_,l,e,u.key,!0);return t.renderables.push(g),u.addRenderable(g),g.statistics.gpuMemoryUsage}async _addObjectMergedGeometries(e,t,r,n,s){const a=new Map;let o=0,l=null,c=0;for(let v=0;v<e.geometries.length;v++){const w=e.geometries[v],T=e.geometryRecords[v];if(!T.material.supportsEdges)continue;!l&&T.origin&&(l=T);const E=w.vertexAttributes.get(P.POSITION);c+=E.data.length/E.size,o+=w.edgeIndicesLength}const u=c>=65536?Uint32Array:Uint16Array,d=o?new u(o):null,m=[];let f=0;for(let v=0;v<e.geometries.length;v++){const w=e.geometries[v];if(!e.geometryRecords[v].material.supportsEdges)continue;const T=w.vertexAttributes.get(P.POSITION),E=w.indices.get(P.POSITION);let C=a.get(T.data);if(C==null){C=m.length/3;for(let A=0;A<T.data.length;A+=T.size)m.push(T.data[A+0]),m.push(T.data[A+1]),m.push(T.data[A+2]);a.set(T.data,C)}if(E)for(let A=0;A<w.edgeIndicesLength;A++)d[f++]=C+E[A]}const _=l||e.geometryRecords[0],g=ve(),x=this._computeModelTransformWithLocalOrigin(e,_,g);for(let v=0;v<e.geometryRecords.length;v++)e.geometryRecords[v].origin=x.origin;const b=new AB({data:m,size:3},d,g,x);await this._updatingHandles.addPromise(this._addPositionData(t,b,d.length,r[0],n,s))}_acquireRenderer(e,t,r){const n=ZM.getKey(e,t,r);let s=this._renderers.get(n);return S(this._strokesTexture)&&(this._strokesTexture=r3e(this.rctx)),s||(s=new ZM(this.rctx,this.techniqueRepository,{type:e,hasSlicePlane:t,strokesTexture:this._strokesTexture,legacy:r,spherical:this.viewingMode===Se.Global}),this._renderers.set(n,s)),++s.refCount,s}_removeRenderable(e){o3e(e);const t=this._renderers.get(e.rendererKey);if(t){t.removeRenderable(e),--t.refCount,"origin"in e.transform&&this._localOrigins.release(e.transform.origin),this._gpuMemoryUsage-=e.statistics.externalMemoryUsage?0:e.statistics.gpuMemoryUsage;for(const r of e.components.meta)e.components.buffer.releaseIndex(r.index)}}_updateObjectCameraDistances(e){const t=e.camera.eye,r=e.camera.viewForward,n=R(),s=a=>{tl(n,a.center,t);const o=me(n,r),l=a.radius,c=o<-l?1/0:o<l?0:o-l;a.renderables.forEach(u=>u.distanceToCamera=c)};this._perObjectData.forEach(s),this._perObjectDataEvictionCache.forEach(s)}_renderRegularEdges(e,t,r){const n=e.bindRegularEdges(r,t),s=r.transparency,a=t.camera.perScreenPixelRatio;e.forEachRenderable(o=>{if(!PB(o)||!o.visible)return;const l=aS(o.regular.lod.lengths,o.distanceToCamera,a);e.renderRegularEdges(n,o,r,t,l)},s)}_renderSilhouetteEdges(e,t,r){const n=e.bindSilhouetteEdges(r,t),s=r.transparency,a=t.camera.perScreenPixelRatio;e.forEachRenderable(o=>{if(!RB(o)||!o.visible)return;const l=aS(o.silhouette.lod.lengths,o.distanceToCamera,a);e.renderSilhouetteEdges(n,o,r,t,l)},s)}get test(){return{hasRenderedPrimitives:e=>{let t=!1;const r=e.perScreenPixelRatio,n=(s,a)=>s.forEachRenderable(o=>{o.visible&&!t&&(PB(o)&&(t=aS(o.regular.lod.lengths,o.distanceToCamera,r)>0),!t&&RB(o)&&(t=aS(o.silhouette.lod.lengths,o.distanceToCamera,r)>0))},a);return this._renderers.forEach(s=>{t||(n(s,_t.OPAQUE),n(s,_t.TRANSPARENT))}),t}}}};function o3e(i){y(i.regular)&&(i.regular.vao.vertexBuffers.instances.dispose(),i.regular.vao.dispose(!1),i.regular.vao=null),y(i.silhouette)&&(i.silhouette.vao.vertexBuffers.instances.dispose(),i.silhouette.vao.dispose(!1),i.silhouette.vao=null)}function l3e(i){let e=null,t=null;for(let r=0;r<i.geometries.length;r++){const n=i.geometryRecords[r];if(n.material.supportsEdges){if(e){if(!K$(e,n.transformation))return!1}else e=n.transformation;if(!t&&y(n.origin))t=n;else if(y(t==null?void 0:t.origin)&&y(n.origin)&&t.origin.id!==n.origin.id)return!1}}return!0}h([p({constructOnly:!0})],lc.prototype,"rctx",void 0),h([p({constructOnly:!0})],lc.prototype,"renderSR",void 0),h([p({constructOnly:!0})],lc.prototype,"viewingMode",void 0),h([p({constructOnly:!0})],lc.prototype,"techniqueRepository",void 0),h([p({constructOnly:!0})],lc.prototype,"setNeedsRender",void 0),h([p({constructOnly:!0})],lc.prototype,"schedule",void 0),h([p({readOnly:!0})],lc.prototype,"_updatingHandles",void 0),h([p({readOnly:!0})],lc.prototype,"updating",null),lc=h([D("esri.views.3d.webgl-engine.lib.edgeRendering.EdgeView")],lc);let SB=class{constructor(e,t,r){this.center=t,this.radius=r,this.renderables=new Array,this.loaded=e,this.loaded.then(()=>{this.loaded!=null&&(this.loaded=!0)})}},c3e=class{constructor(e,t){this.buffer=e,this.meta=t}},EB=class{constructor(e,t){this.vao=e,this.lod=t}},h3e=class{constructor(e,t){this.modelMatrix=e,this.origin=t}},u3e=class{constructor(e,t,r,n,s,a,o,l){this.regular=e,this.silhouette=t,this.statistics=r,this.transform=n,this.edgeTransparency=s,this.objectTransparency=a,this.components=o,this.rendererKey=l,this.distanceToCamera=0,this.visible=!0}};function PB(i){return y(i.regular)}function RB(i){return y(i.silhouette)}function aS(i,e,t){const r=e*t,n=jee(i,r,!0);return n===-1?r<i[0]?i.length:0:i.length-n}let AB=class{constructor(e,t,r,n){this.position=e,this.indices=t,this.modelTransform=r,this.origin=n}};const OB=Or();let MB=class{constructor(e,t,r,n,s,a,o,l,c){this.createQuery=e,this.deleteQuery=t,this.resultAvailable=r,this.getResult=n,this.disjoint=s,this.beginTimeElapsed=a,this.endTimeElapsed=o,this.createTimestamp=l,this.timestampBits=c}},Gu=!1;function d3e(i,e){if(e.disjointTimerQuery)return null;let t=i.getExtension("EXT_disjoint_timer_query_webgl2");return t&&Ca(i)?new MB(()=>i.createQuery(),r=>{i.deleteQuery(r),Gu=!1},r=>i.getQueryParameter(r,i.QUERY_RESULT_AVAILABLE),r=>i.getQueryParameter(r,i.QUERY_RESULT),()=>i.getParameter(t.GPU_DISJOINT_EXT),r=>{Gu||(Gu=!0,i.beginQuery(t.TIME_ELAPSED_EXT,r))},()=>{i.endQuery(t.TIME_ELAPSED_EXT),Gu=!1},r=>t.queryCounterEXT(r,t.TIMESTAMP_EXT),()=>i.getQuery(t.TIMESTAMP_EXT,t.QUERY_COUNTER_BITS_EXT)):(t=i.getExtension("EXT_disjoint_timer_query"),t?new MB(()=>t.createQueryEXT(),r=>{t.deleteQueryEXT(r),Gu=!1},r=>t.getQueryObjectEXT(r,t.QUERY_RESULT_AVAILABLE_EXT),r=>t.getQueryObjectEXT(r,t.QUERY_RESULT_EXT),()=>i.getParameter(t.GPU_DISJOINT_EXT),r=>{Gu||(Gu=!0,t.beginQueryEXT(t.TIME_ELAPSED_EXT,r))},()=>{t.endQueryEXT(t.TIME_ELAPSED_EXT),Gu=!1},r=>t.queryCounterEXT(r,t.TIMESTAMP_EXT),()=>t.getQueryEXT(t.TIMESTAMP_EXT,t.QUERY_COUNTER_BITS_EXT)):null)}function p3e(i,e){const t=i.capabilities.disjointTimerQuery;return S(t)?null:new m3e(t,e)}let m3e=class{constructor(e,t){this._timer=e,this._queryPool=new Array,this._queryResults=new Map,this._currentQuery=null,t.forEach(r=>{const n=this._timer.createQuery(),s=this._timer.createQuery();this._queryPool.push(n,s),this._queryResults.set(r,null)})}start(){Gu||(this._currentQuery=this._queryPool.pop(),S(this._currentQuery)||(this._timer.disjoint(),this._timer.beginTimeElapsed(this._currentQuery)))}stop(e){if(this._timer.disjoint()||S(this._currentQuery)||!this._queryResults.has(e))return this.abort(),null;this._timer.endTimeElapsed();const t=this._queryResults.get(e);if(S(t))return this._queryResults.set(e,this._currentQuery),this._currentQuery=null,null;if(!this._timer.resultAvailable(t))return this._queryPool.unshift(this._currentQuery),this._currentQuery=null,null;const r=this._timer.getResult(t)/1e6;return this._queryPool.unshift(t),this._queryResults.set(e,this._currentQuery),this._currentQuery=null,r}abort(){y(this._currentQuery)&&(this._timer.deleteQuery(this._currentQuery),this._queryPool.unshift(this._timer.createQuery()),this._currentQuery=null)}dispose(){y(this._currentQuery)&&this._timer.deleteQuery(this._currentQuery),this._queryPool.forEach(e=>{this._timer.deleteQuery(e)}),this._queryResults.forEach(e=>{S(e)||this._timer.deleteQuery(e)})}};var fi;(function(i){i.OVERLAY="overlay",i.PREPARE="prepare",i.SHADOW_MAP="shadow map",i.LINEAR_DEPTH="linear depth",i.ACCUMULATED_SHADOWS="accumulated shadows",i.NORMALS="normals",i.OBJECT_AND_LAYER_ID_COLOR="object/layer id color",i.SSAO="SSAO",i.OPAQUE="opaque",i.OPAQUE_EDGES="opaque edges",i.VOXEL="voxel",i.TRANSPARENT="transparent",i.TRANSPARENT_EDGES="transparent edges",i.HUD_VISIBILITY="HUD visibility",i.TRANSPARENT_TERRAIN="transparent terrain",i.ENVIRONMENT="environment",i.LASER_LINE="laser line",i.OCCLUDED="occluded",i.ANTIALIASING="antialiasing",i.HIGHLIGHTS="highlights",i.HUD_OCCLUDED="HUD occluded",i.HUD_NOT_OCCLUDED="HUD not occluded",i.FINISH="finish"})(fi||(fi={}));const IB="Total";let f3e=class{constructor(e){this._rctx=e,this._startTimeStampCPU=Rt(0),this._lastTimeStampCPU=Rt(0),this._totalCPUTime=new aT(IB),this._cpuTimeSamplers=new Map(Object.values(fi).map(t=>[t,new aT(t)])),this._enableGPUTimer=0,this._totalGPUTime=new aT("GPU"),this._gpuTimeSamplers=new Map(Object.values(fi).map(t=>[t,new aT(t)])),this._totalTime=Rt(0),this._totalFrameCount=0}get totalCPUTimeSampler(){return this._totalCPUTime}get cpuTimeSamplers(){return Array.from(this._cpuTimeSamplers.values())}get totalGPUTimeSampler(){return this._totalGPUTime}get gpuTimeSamplers(){return Array.from(this._gpuTimeSamplers.values())}get gpuSamplingEnabled(){return y(this._gpuTimerPool)}get totalTime(){return this._totalTime}get totalFrameCount(){return this._totalFrameCount}get elapsedTime(){return Rt(performance.now()-this._startTimeStampCPU)}enableGPUPerformanceInfo(){if(S(this._gpuTimerPool)){const e=[...Object.values(fi),IB];this._gpuTimerPool=p3e(this._rctx,e)}return S(this._gpuTimerPool)?{hasGPUTimerSupport:!1,remove:()=>{}}:(++this._enableGPUTimer,{hasGPUTimerSupport:!0,remove:Mee(()=>{--this._enableGPUTimer,this._enableGPUTimer===0&&(this._gpuTimerPool=Me(this._gpuTimerPool))})})}startFrame(){this._startTimeStampCPU=this._lastTimeStampCPU=Rt(performance.now()),y(this._gpuTimerPool)&&this._gpuTimerPool.start()}advance(e){const t=Rt(performance.now());if(this._cpuTimeSamplers.get(e).record(t-this._lastTimeStampCPU),this._lastTimeStampCPU=t,y(this._gpuTimerPool)){const r=this._gpuTimerPool.stop(e);this._gpuTimeSamplers.get(e).record(r),this._gpuTimerPool.start()}}finishFrame(){if(y(this._gpuTimerPool)){const t=this._gpuTimerPool.stop(fi.FINISH);this._gpuTimeSamplers.get(fi.FINISH).record(t)}const e=Rt(performance.now()-this._startTimeStampCPU);this._totalTime=Rt(this._totalTime+e),this._totalCPUTime.record(e),y(this._gpuTimerPool)&&this._totalGPUTime.record(this.gpuTimeSamplers.reduce((t,r)=>t+(r.last||0),0)),++this._totalFrameCount}};const LB=.9;let Hu=class extends ue{constructor(e,t,r,n,s,a,o,l,c){super({}),this._materialRepository=e,this._shaderTechniqueRepository=r,this._rctx=n,this._compositingHelper=s,this._magnifierHelper=a,this._requestRender=o,this._stage=c,this._materialRenderers=new Map,this._needsTransparentPass=!1,this._hasHUDElements=!1,this._hasHighlights=!1,this._hasWater=!1,this._hasOverlayWater=!1,this._renderOverlay=u=>{},this._content=new Map,this._isRendering=!1,this._fallbackDepthStencilTexture=null,this._sliceHelper=new SIe,this._antialiasing=!0,this._oitEnabled=!1,this._multipassTerrain=!0,this._terrainRenderingEnabled=!0,this._terrainTransparency=Ts.Opaque,this._waterReflectionEnabled=!1,this._hasAnimations=!1,this._animationTimestep=oB,this._handles=new Ft,this._renderHiddenTransparentEdges=()=>{},this._oitUsed=!1,this._smaaPass=new wb(this._rctx,r),this._oitEnabled=this._hasOITSupport,this._requestRender(),this._offscreenRendering=new iIe(this._rctx,this._compositingHelper),this.performanceInfo=new f3e(this._rctx),this._shadowMap=new f4(this._rctx,c.viewingMode),this._ssaoHelper=new TG(r,this._rctx,()=>this._requestRender()),this._highlight=new KMe(r,this._rctx),this._shadowHighlight=new CIe(this._rctx,c.viewingMode),this._shadowAccumulator=new _s(this._rctx,r,c,u=>{const d=this.shadowsEnabled;this._shadowMap.enabled=!0,this._prepare(u.camera,u.contentCamera),this._renderPlugins.prepareRender(),this._shadowMap.enabled=d},(u,d,m)=>{u.shadowMap.start(u.camera,d,m),this._renderShadowCascades(k.Shadow,u.shadowMap),u.camera.setGLViewport(this._rctx),this._prepare(u.camera,u.contentCamera)},()=>this._requestRender()),this._renderContext=new vTe(this._rctx,this._offscreenRendering,this._shadowMap,this._ssaoHelper,this._sliceHelper),this._renderPlugins=new sIe({renderContext:this._renderContext,shaderTechniqueRepository:r,textureRep:t,materialRep:this._materialRepository,requestRender:this._requestRender,schedule:l}),this.renderPassManager=new zMe(this._rctx,this._shaderTechniqueRepository),this._renderPlugins.add(this.renderPassManager.slots(),this.renderPassManager),this._handles.add([z(()=>this._stage.state.camera,()=>this._requestRender(),Oi),z(()=>jt.EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES,u=>{this._renderHiddenTransparentEdges=u?()=>this._renderEdges(_t.TRANSPARENT):()=>{},this._requestRender()},Qe)])}get _bindParameters(){return this._renderContext.bindParameters}get hasWater(){return this._hasWater||this._hasOverlayWater}get hasWaterReflection(){return this.hasWater&&this._waterReflectionEnabled}normalizeCtorArgs(){return{}}dispose(){this._handles.destroy(),this._smaaPass.dispose(),this._materialRenderers.forEach(e=>e.dispose()),this._materialRenderers.clear(),this._edgeView=Te(this._edgeView),this._offscreenRendering.dispose(),this._fallbackDepthStencilTexture=Me(this._fallbackDepthStencilTexture),this._shadowMap.enabled=!1,this._shadowMap.dispose(),this._ssaoHelper.enabled=!1,this._ssaoHelper.dispose(),this._highlight.dispose(),this._shadowHighlight.dispose(),this._shadowAccumulator.dispose(),kne.prune(),this._content.clear()}disposeOffscreenBuffers(){this._offscreenRendering.dispose(),this._shadowMap.dispose(),this._smaaPass.disable(),this._ssaoHelper.disposeOffscreenBuffers()}get updating(){return this._antialiasing&&this._smaaPass.updating||y(this._edgeView)&&this._edgeView.updating||this._shadowAccumulator.running||!this.isCameraFinal}ensureEdgeView(){return S(this._edgeView)&&(this._edgeView=new lc({rctx:this._rctx,renderSR:this._stage.renderSR,viewingMode:this._stage.viewingMode,techniqueRepository:this._shaderTechniqueRepository,setNeedsRender:()=>this._requestRender(),schedule:e=>this._stage.resourceController.schedule(e)}),this._handles.add(z(()=>co(this._edgeView,e=>e.updating),()=>this._requestRender(),ri)),this._requestRender()),this._edgeView}get edgeView(){return this._edgeView}get isCameraFinal(){return gre(this._bindParameters.ssr.reprojectionMatrix,rn)}set _reprojectionMatrix(e){qee(this._bindParameters.ssr.reprojectionMatrix,e)&&this.notifyChange("isCameraFinal")}get shadowsEnabled(){var e;return!!((e=this._shadowMap)!=null&&e.enabled)}setRenderParameters(e){const{_shadowMap:t,_ssaoHelper:r,_bindParameters:n}=this;if(e.screenSpaceReflectionsEnabled!==void 0&&n.ssr.enabled!==e.screenSpaceReflectionsEnabled&&(n.ssr.enabled=e.screenSpaceReflectionsEnabled,this._requestRender()),e.shadowMap!==void 0&&t.enabled!==e.shadowMap&&(t.enabled=e.shadowMap,this._requestRender()),e.shadowMapMaxCascades!==void 0&&t.maxCascades!==e.shadowMapMaxCascades&&(t.maxCascades=e.shadowMapMaxCascades,this._requestRender()),y(e.environment)){y(e.environment.weather)&&(this._bindParameters.weather=e.environment.weather,this._bindParameters.weatherVisible=e.weatherVisible),e.environment.lighting.ambientOcclusionEnabled!==void 0&&r.enabled!==e.environment.lighting.ambientOcclusionEnabled&&(r.enabled=e.environment.lighting.ambientOcclusionEnabled,this._requestRender()),e.environment.lighting.waterReflectionEnabled!==void 0&&this._waterReflectionEnabled!==e.environment.lighting.waterReflectionEnabled&&(this._waterReflectionEnabled=e.environment.lighting.waterReflectionEnabled,this._requestRender());const s=e.environment.lighting.type!=="virtual";n.enableFillLights!==s&&(n.enableFillLights=s,this._requestRender())}e.background&&this._offscreenRendering.background!==e.background&&(this._offscreenRendering.background=e.background,this._requestRender()),e.antialiasingEnabled!==void 0&&this._antialiasing!==e.antialiasingEnabled&&(this._antialiasing=e.antialiasingEnabled,this._requestRender()),e.highQualityTransparency!==void 0&&this._multipassTerrain!==e.highQualityTransparency&&(this._multipassTerrain=e.highQualityTransparency,this._oitEnabled=e.highQualityTransparency&&this._hasOITSupport,this._requestRender()),e.defaultHighlightOptions!==void 0&&(this._highlight.setDefaultOptions(e.defaultHighlightOptions),this._shadowHighlight.setDefaultOptions(e.defaultHighlightOptions),this._requestRender()),e.overlays!==void 0&&this._bindParameters.overlays!==e.overlays&&(this._bindParameters.overlays=e.overlays,this._requestRender()),e.hasOverlayWater!==void 0&&this._hasOverlayWater!==e.hasOverlayWater&&(this._hasOverlayWater=e.hasOverlayWater,this._requestRender()),e.renderOverlay!==void 0&&this._renderOverlay!==e.renderOverlay&&(this._renderOverlay=e.renderOverlay,this._requestRender()),e.slicePlane!==void 0&&this._sliceHelper.plane!==e.slicePlane&&(this._sliceHelper.plane=ct(e.slicePlane),this._requestRender()),e.terrainRenderingEnabled!==void 0&&this._terrainRenderingEnabled!==e.terrainRenderingEnabled&&(this._terrainRenderingEnabled=e.terrainRenderingEnabled,this._requestRender()),e.terrainTransparency!==void 0&&this._terrainTransparency!==e.terrainTransparency&&(this._terrainTransparency=e.terrainTransparency,this._requestRender()),e.shadowCastOptions!==void 0&&this._shadowAccumulator.setOptions(e.shadowCastOptions)}get hasSlicePlane(){return!!this._sliceHelper.plane}get renderPlugins(){return this._renderPlugins}get _hasOITSupport(){return this._rctx.driverTest.floatBufferBlendWorking}modify(e){this._isRendering&&console.warn("Renderer.modify called while rendering");const{adds:t,removes:r,updates:n}=e;if(t.length===0&&r.length===0&&n.length===0)return;r.forAll(({id:o})=>this._content.delete(o)),t.forAll(o=>this._content.set(o.id,o));const s=MY(e);let a=!1;s.forEach((o,l)=>{let c=this._materialRenderers.get(l);if(!c){if(!(o.adds.length>0))return;c=new kY(this._rctx,this._materialRepository,l),this._materialRenderers.set(l,c)}c.modify(o),c.isEmpty&&(a=!0)}),a&&this._materialRenderers.forEach((o,l)=>{o.isEmpty&&(this._materialRenderers.delete(l),o.dispose())}),this._hasHighlights=Er(this._materialRenderers,o=>o.hasHighlights),this._bindParameters.hasOccludees=Er(this._materialRenderers,o=>o.hasOccludees),this._hasWater=Er(this._materialRenderers,o=>o.hasWater),this._hasHUDElements=Er(this._materialRenderers,o=>o.requiresSlot(ae.LINE_CALLOUTS_HUD_DEPTH,k.Color)||o.requiresSlot(ae.HUD_MATERIAL,k.Color)||o.requiresSlot(ae.LABEL_MATERIAL,k.Color)),this._requestRender()}updateAnimation(e){return this._hasAnimations=!1,this._materialRenderers.forEach(t=>this._hasAnimations=t.updateAnimation(e)||this._hasAnimations),this._hasAnimations=this._renderPlugins.updateAnimation(e)||this._hasAnimations,this._hasAnimations}get animationTimestep(){return this._animationTimestep}render(e,t,r,n,s){this._isRendering=!0;const{camera:a,contentCamera:o}=r;this._renderContext.time=s,this.performanceInfo.startFrame(),this._renderOverlay(s),this.performanceInfo.advance(fi.OVERLAY),this._bindParameters.transparencyPassType=Ht.NONE;const l=this._offscreenRendering;l.setupRenderTarget(this.hasWaterReflection);const c=zd(this._sliceHelper.plane);n===Pw.OFF&&(this._sliceHelper.plane=null),this._rctx.bindFramebuffer(e),a.setGLViewport(this._rctx),this._prepare(a,o),this._renderPlugins.prepareRender(),this.performanceInfo.advance(fi.PREPARE);const u=this._computeDepthRange(a);this._renderShadowMap(e,a,this._bindParameters.lighting.mainLight.direction,u),this.performanceInfo.advance(fi.SHADOW_MAP),l.initializeFrame(a),this._ensureBindParameters(a,o),this._renderLinearDepth(),this.performanceInfo.advance(fi.LINEAR_DEPTH),this._accumulateShadows(u,a,o),this.performanceInfo.advance(fi.ACCUMULATED_SHADOWS),this._renderNormal(),this.performanceInfo.advance(fi.NORMALS),this._ensureBindParametersSSR(),this._renderSSAO(),this.performanceInfo.advance(fi.SSAO),this._renderContext.output=k.Color,l.bindFramebuffer(),this._renderOpaqueGeometry(),this.performanceInfo.advance(fi.OPAQUE);const d=this._terrainRenderingEnabled&&this._terrainTransparency!==Ts.Opaque,m=this._multipassTerrain&&d;this._renderTerrainLinearDepth(m),this._setMultipassEnabled(m),this._setTerrainCulling(m),this._renderEdges(_t.OPAQUE),this.performanceInfo.advance(fi.OPAQUE_EDGES),this._offscreenRendering.bindTarget(this._offscreenRendering.currentColorTarget,this._offscreenRendering.mainDepth),this._renderSlot(ae.VOXEL),this.performanceInfo.advance(fi.VOXEL),this._renderHiddenTransparentEdges();const f=this._needsTransparentPass||this._renderPlugins.needsTransparentPass;f&&(this._oitEnabled?this._renderOrderIndependentTransparency(()=>this._renderTransparentGeometry(),!1):this._renderTransparentGeometry()),this.performanceInfo.advance(fi.TRANSPARENT),this._renderGeometryLinearDepth(m);const _=this._renderHUDVisibility(this._multipassTerrain&&d);m||this._renderInternalSlot(ae.LINE_CALLOUTS),this.performanceInfo.advance(fi.HUD_VISIBILITY),this._renderObjectAndLayerIdColor(t),this.performanceInfo.advance(fi.OBJECT_AND_LAYER_ID_COLOR),this._renderEdges(_t.TRANSPARENT,m),this.performanceInfo.advance(fi.TRANSPARENT_EDGES),this._renderTransparentTerrain(),d&&_&&(m?this._renderLineCallouts(mu.Occluded):l.compositeTransparentTerrainOntoHUDVisibility(this._bindParameters),this._renderHUD(mu.Occluded,l.framebuffer),this.performanceInfo.advance(fi.HUD_OCCLUDED)),this.performanceInfo.advance(fi.TRANSPARENT_TERRAIN),this._setTerrainCulling(!1),d&&(l.compositeTransparentTerrainOntoMain(this._bindParameters),m&&(this._renderEdges(_t.OPAQUE),this.performanceInfo.advance(fi.OPAQUE_EDGES),f&&(this._oitEnabled?this._renderOrderIndependentTransparency(()=>this._renderTransparentGeometry(),!1):this._renderTransparentGeometry()),this.performanceInfo.advance(fi.TRANSPARENT),this._renderEdges(_t.TRANSPARENT),this.performanceInfo.advance(fi.TRANSPARENT_EDGES))),m&&this._renderLineCallouts(mu.NotOccluded),this._setMultipassEnabled(!1),this._shadowAccumulator.render(this._bindParameters),l.renderToTargets(()=>{this._renderInternalSlot(ae.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL),this._renderSlot(ae.POSTPROCESSING_ENVIRONMENT_TRANSPARENT),this._renderSlot(ae.LASERLINES)},l.currentColorTarget,l.mainDepth),this.performanceInfo.advance(fi.ENVIRONMENT),this._renderPlugins.needsLaserlineWithContrastControl&&l.renderTmpAndCompositeToMain(()=>this._renderSlot(ae.LASERLINES_CONTRAST_CONTROL),this._bindParameters,Es.PremultipliedAlpha),this.performanceInfo.advance(fi.LASER_LINE),this._renderOccluded(),this.performanceInfo.advance(fi.OCCLUDED);const g=n===Pw.ON&&this._magnifierHelper.enabled,x=g&&S(e)?this._offscreenRendering.getFramebuffer(this._offscreenRendering.tmpColor,this._offscreenRendering.tmpDepth):e;this._rctx.bindFramebuffer(x);const b=this._offscreenRendering.colorTexture;!this._renderAntiAliasing(b)&&y(b)&&this._compositingHelper.composite(this._bindParameters,b,Es.None),this.performanceInfo.advance(fi.ANTIALIASING),this._renderHUD(mu.NotOccluded,x),this.performanceInfo.advance(fi.HUD_NOT_OCCLUDED),this._renderHighlights(x,this._bindParameters),this.performanceInfo.advance(fi.HIGHLIGHTS),g&&this._magnifierHelper.render(this._rctx,this._bindParameters),x!==e&&(this._rctx.bindFramebuffer(e),this._compositingHelper.composite(this._bindParameters,this._offscreenRendering.tmpColorTexture,Es.None)),this._disposeOITBuffers(),this._renderContext.lastFrameCamera.copyFrom(this._bindParameters.camera),this._sliceHelper.plane=c,this._isRendering=!1,this.onPostRender&&this.onPostRender(),this.performanceInfo.finishFrame()}_renderObjectAndLayerIdColor(e){y(e)&&St("enable-feature:objectAndLayerId-rendering")&&(this._rctx.bindFramebuffer(e),this._offscreenRendering.renderToFBO(()=>this._renderGeometryAndTransparentTerrainPass(k.ObjectAndLayerIdColor),[0,0,0,0],!0,!0),this._rctx.bindFramebuffer(e),this._offscreenRendering.renderToFBO(()=>{this._bindParameters.renderTransparentlyOccludedHUD=mu.NotOccluded,this._renderInternalSlot(ae.HUD_MATERIAL)},null,!0,!0))}finish(e){if(this._hasAnimations||(this._animationTimestep=Rt(0)),e===vr.BACKGROUND){let t=0;this.performanceInfo.gpuSamplingEnabled?t=this.performanceInfo.totalGPUTimeSampler.last:this._rctx.gl.getError();const r=this.performanceInfo.elapsedTime,n=Math.max(r,t),s=ce(n/kMe,UMe,oB);this._animationTimestep=Rt(this._animationTimestep*LB+s*(1-LB))}}readDepthPixels(e,t,r){const n=this._offscreenRendering.bindTarget(this._offscreenRendering.linearDepth,this._offscreenRendering.tmpDepth);if(!this._needsLinearDepth){this._ensureBindParameters(e,e),this._bindParameters.camera.setGLViewport(this._rctx),this._rctx.setClearColor(0,0,0,0);const s=Ai.COLOR_BUFFER_BIT|Ai.DEPTH_BUFFER_BIT|Ai.STENCIL_BUFFER_BIT;this._rctx.clearSafe(s),this._renderGeometryAndTransparentTerrainPass(k.Depth)}n.readPixels(t[0],t[1],t[2],t[3],yt.RGBA,qt.UNSIGNED_BYTE,r)}readHUDVisibility(e,t,r,n,s){this._offscreenRendering.bindTarget(this._offscreenRendering.hudVisibility).readPixels(e,t,r,n,yt.RGBA,qt.UNSIGNED_BYTE,s)}readAccumulatedShadow(e,t){return this._shadowAccumulator.readAccumulatedShadow(e,t)}_setMultipassEnabled(e){this._bindParameters.multipassTerrain.enabled=this._bindParameters.multipassGeometry.enabled=e}_setTerrainCulling(e){this._bindParameters.multipassTerrain.cullAboveGround=e}_renderSlot(e){this._bindParameters.slot=e,this._renderPlugins.render()}_renderEdges(e,t=!1){const r=this._edgeView;y(r)&&r.shouldRender()&&this._offscreenRendering.renderTmpAndCompositeToMain(()=>r.render(this._bindParameters,e),this._bindParameters,Es.Alpha,t)}_renderShadowMap(e,t,r,n){const s=this._shadowMap;s.enabled&&(s.start(t,r,n),this._shadowHighlight.updateParameters(t,r),this._needsShadowHighlight?(this._renderShadowCascades(k.ShadowHighlight,this._shadowMap,a=>s.takeCascadeSnapshotTo(a,cv.Highlight)),s.clear(),this._renderShadowCascades(k.ShadowExludeHighlight,this._shadowMap,a=>{s.takeCascadeSnapshotTo(a,cv.Default),this._renderGeometryAndTransparentTerrainPass(k.ShadowHighlight)})):this._renderShadowCascades(k.Shadow),s.finish(e),t.setGLViewport(this._rctx))}_renderShadowCascades(e,t=this._shadowMap,r=n=>{}){for(const n of t.getCascades())n.camera.setGLViewport(this._rctx),this._prepare(n.camera,n.camera),this._renderGeometryAndTransparentTerrainPass(e),r(n)}get _needsLinearDepth(){return this._ssaoHelper.ready||this._renderPlugins.needsLinearDepth||this._hasWater&&this._waterReflectionEnabled||this._needsShadowHighlight||this._needsShadowCast}_renderLinearDepth(){this._needsLinearDepth?this._offscreenRendering.renderToTargets(()=>this._renderGeometryAndTransparentTerrainPass(k.Depth),this._offscreenRendering.linearDepth,this._offscreenRendering.tmpDepth,[0,0,0,0],!0,!0):this._offscreenRendering.disposeTarget(this._offscreenRendering.linearDepth),this._bindParameters.linearDepthTexture=this._offscreenRendering.linearDepthTexture}_renderTerrainLinearDepth(e){if(e){const t=this._renderContext.output;this._renderContext.output=k.Depth,this._offscreenRendering.renderToTargets(()=>this._renderTransparentTerrain(),this._offscreenRendering.terrainLinearDepth,this._offscreenRendering.tmpDepth,[-1e10,-1e10,-1e10,1],!0,!0),this._renderContext.output=t}else this._offscreenRendering.disposeTarget(this._offscreenRendering.terrainLinearDepth);this._bindParameters.multipassTerrain.linearDepthTexture=this._offscreenRendering.terrainLinearDepthTexture}_renderGeometryLinearDepth(e){if(e){const t=this._renderContext.output;this._offscreenRendering.renderToTargets(()=>this._renderGeometryPass(k.Depth),this._offscreenRendering.geometryLinearDepth,this._offscreenRendering.tmpDepth,[1,1,1,1],!0,!0),this._renderContext.output=t}else this._offscreenRendering.disposeTarget(this._offscreenRendering.geometryLinearDepth);this._bindParameters.multipassGeometry.linearDepthTexture=this._offscreenRendering.geometryLinearDepthTexture}get _needsNormal(){return this._ssaoHelper.ready}_renderNormal(){this._needsNormal?this._offscreenRendering.renderToTargets(()=>{this._renderGeometryAndTransparentTerrainPass(k.Normal)},this._offscreenRendering.normal,this._offscreenRendering.tmpDepth,[0,0,0,0],!0,!0):this._offscreenRendering.disposeTarget(this._offscreenRendering.normal)}get _needsDepthRange(){return this._shadowMap.enabled||this._needsShadowCast}_computeDepthRange(e){if(!this._needsDepthRange)return P$;const t=wMe(e,this._content,this._stage.layers);return dv(t,this.renderPlugins.queryDepthRange(e)),t.near=Math.max(e.near,t.near),t.far=Math.min(e.far,t.far),t}_renderGeometryAndTransparentTerrainPass(e){this._renderContext.output=e,this._renderGeometryPass(e),this._renderTransparentTerrain()}_renderGeometryPass(e){this._renderContext.output=e,this._renderOpaqueGeometry(),this._renderTransparentGeometry()}_renderSSAO(){this._ssaoHelper.loading?this._requestRender():this._ssaoHelper.computeSSAO(this._bindParameters,this._offscreenRendering.linearDepthTexture,this._offscreenRendering.normalTexture)}_renderOpaqueGeometry(){this._renderSlot(ae.INTEGRATED_MESH),this._renderSlot(ae.OPAQUE_TERRAIN),this._renderInternalSlot(ae.OPAQUE_MATERIAL),this._renderSlot(ae.OPAQUE_MATERIAL),this._renderSlot(ae.POSTPROCESSING_ENVIRONMENT_OPAQUE)}_renderTransparentGeometry(){this._renderInternalSlot(ae.TRANSPARENT_MATERIAL),this._renderSlot(ae.TRANSPARENT_MATERIAL)}_renderTransparentTerrain(){this._renderSlot(ae.TRANSPARENT_TERRAIN)}_renderHUDVisibility(e){let t=!1;return this._renderContext.offscreenRenderingHelper&&this._renderContext.offscreenRenderingHelper.renderHUDVisibility(()=>{this._bindParameters.hudVisibilityTexture=this._renderContext.offscreenRenderingHelper.hudVisibilityTexture,t=this._renderInternalSlot(ae.OCCLUSION_PIXELS)},e),t}_renderLineCallouts(e){this._bindParameters.renderTransparentlyOccludedHUD=e,e===mu.Occluded?this._offscreenRendering.renderToTargets(()=>this._renderInternalSlot(ae.LINE_CALLOUTS),this._offscreenRendering.currentColorTarget,this._offscreenRendering.tmpDepth,void 0,!0,!0):this._renderInternalSlot(ae.LINE_CALLOUTS)}_renderHUD(e,t){this._hasHUDElements&&(this._oitEnabled?(this._renderOrderIndependentTransparency(()=>this._renderHUDElements(e),!0),this._rctx.bindFramebuffer(t),this._compositingHelper.composite(this._bindParameters,this._offscreenRendering.hudColorTexture,Es.PremultipliedAlpha)):e===mu.Occluded?this._offscreenRendering.renderToTargets(()=>this._renderHUDElements(mu.Occluded),this._offscreenRendering.currentColorTarget,this._offscreenRendering.tmpDepth,void 0,!0,!0):this._renderHUDElements(e))}_renderHUDElements(e){this._bindParameters.renderTransparentlyOccludedHUD=e,this._renderInternalSlot(ae.LINE_CALLOUTS_HUD_DEPTH),this._renderInternalSlot(ae.HUD_MATERIAL),this._renderInternalSlot(ae.LABEL_MATERIAL)}get _needsHighlight(){return this._hasHighlights||this._renderPlugins.needsHighlight}get _needsShadowHighlight(){return this._shadowMap.enabled&&this._shadowHighlight.isVisible&&this._needsHighlight}_renderHighlights(e,t){if(!this._needsHighlight)return void this._offscreenRendering.disposeTarget(this._offscreenRendering.highlight);const r=this._highlight,n=this._offscreenRendering.renderToTargets(()=>{this._renderGeometryAndTransparentTerrainPass(k.Highlight),this._rctx.clearSafe(Ai.DEPTH_BUFFER_BIT),this._renderHUDElements(mu.Both)},this._offscreenRendering.highlight,this._offscreenRendering.tmpDepth,[0,0,0,0],!0,!0);this._bindParameters.highlightColorTexture=n.colorTexture,this._needsShadowHighlight&&this._shadowHighlight.render(t,e),r.render(this._bindParameters,n,e)}get _needsShadowCast(){return this._shadowAccumulator.isAccumulating}_accumulateShadows(e,t,r){this._needsShadowCast&&this._shadowAccumulator.renderAccumulation(this._offscreenRendering.linearDepthTexture,e,t,r)}_renderOrderIndependentTransparency(e,t){const r=s=>{this._bindParameters.transparencyPassType=s,this._offscreenRendering.renderOITPass(()=>e(),s,t)},n=this._renderContext.output;this._renderContext.output=k.Alpha,r(Ht.Alpha),this._renderContext.output=k.Color,r(Ht.Color),r(Ht.FrontFace),this._offscreenRendering.compositeTransparentOntoOpaque(this._bindParameters,t),this._bindParameters.transparencyPassType=Ht.NONE,this._renderContext.output=n,this._oitUsed=!0}_disposeOITBuffers(){this._oitUsed||(this._offscreenRendering.disposeTarget(this._offscreenRendering.alphaFloatTarget),this._offscreenRendering.disposeTarget(this._offscreenRendering.colorFloatTarget),this._offscreenRendering.disposeTarget(this._offscreenRendering.frontFaceTarget)),this._oitUsed=!1}_renderOccluded(){let e=0;this._materialRenderers.forEach((a,o)=>{o&&o.isVisible()&&o.renderOccluded===cr.OccludeAndTransparentStencil&&(e|=o.renderOccluded,O1.push(o))});const t=this._offscreenRendering,r=(a,o,l,c,u)=>{e&o&&(t.renderToTargets(l,t.tmpColor,t.mainDepth,[0,0,0,0],c,u),t.compositeOccludedOntoMain(this._bindParameters,a))};O1.length!==0&&(this._renderInternalSlot(ae.OCCLUDER_MATERIAL,O1),r(.5,cr.OccludeAndTransparentStencil,()=>this._renderInternalSlot(ae.TRANSPARENT_OCCLUDER_MATERIAL,O1),!1,!1),O1.length=0),this._materialRenderers.forEach((a,o)=>{o&&o.isVisible()&&(o.renderOccluded===cr.OccludeAndTransparent||o.renderOccluded===cr.Transparent||o.renderOccluded===cr.Opaque)&&(e|=o.renderOccluded,A1.push(o))});const n=this._renderPlugins.renderOccludedFlags;if(e|=n,!e)return;const s=a=>{this._renderContext.renderOccludedMask=a,n>cr.Occlude&&this._renderSlot(ae.OCCLUDED_TERRAIN),this._renderInternalSlot(ae.OPAQUE_MATERIAL,A1),this._renderInternalSlot(ae.TRANSPARENT_MATERIAL,A1),this._renderInternalSlot(ae.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL,A1),this._renderContext.resetRenderOccludedMask()};this._renderContext.output=k.Color,r(.5,cr.OccludeAndTransparent,()=>s(cr.OccludeAndTransparent),!0,$b.OutlineVisualElementMask),r(.5,cr.Transparent,()=>s(cr.Transparent),!0,$b.OutlineVisualElementMask),r(1,cr.Opaque,()=>s(cr.Opaque),!0,$b.OutlineVisualElementMask),A1.length=0}_renderAntiAliasing(e){if(this._antialiasing){if(this._smaaPass.enable(()=>this._requestRender())&&y(e))return this._smaaPass.render(e),!0}else this._smaaPass.disable();return!1}_prepare(e,t){this._needsTransparentPass=Er(this._materialRenderers,r=>r.requiresSlot(ae.TRANSPARENT_MATERIAL,k.Color)),this._bindParameters.camera=e,this._bindParameters.contentCamera=t}_ensureBindParameters(e,t){this._bindParameters.camera=e,this._bindParameters.contentCamera=t;const r=this._renderContext.offscreenRenderingHelper;this._bindParameters.hudVisibilityTexture=r.hudVisibilityTexture,this._bindParameters.mainColorTexture=r.mainColorTexture,this._bindParameters.highlightDepthTexture=r.depthTexture??this._getFallbackDepthTexture()}_ensureBindParametersSSR(){this.hasWaterReflection?(this._renderContext.lastFrameCamera.equals(this._bindParameters.camera)?this._reprojectionMatrix=rn:(kn(DB,this._bindParameters.camera.viewMatrix),kn($B,this._bindParameters.camera.projectionMatrix),Hr(ly,DB,$B),Hr(ly,this._renderContext.lastFrameCamera.viewMatrix,ly),Hr(ly,this._renderContext.lastFrameCamera.projectionMatrix,ly),this._reprojectionMatrix=ly),this._bindParameters.ssr.lastFrameColorTexture=this._offscreenRendering.lastFrameColorTexture):this._bindParameters.ssr.lastFrameColorTexture=null,this._bindParameters.ssr.enabled=this.hasWaterReflection}_renderInternalSlot(e,t){let r=!1;return this._bindParameters.slot=e,y(t)?t.forEach(n=>{if(!n.shouldRender(this._renderContext))return;const s=this._materialRenderers.get(n);y(s)&&(r=s.render(this._renderContext.output,this._bindParameters)||r)}):this._materialRenderers.forEach((n,s)=>{s.shouldRender(this._renderContext)&&n.render(this._renderContext.output,this._bindParameters)&&(r=!0)}),r}_getFallbackDepthTexture(){return this._fallbackDepthStencilTexture||(this._fallbackDepthStencilTexture=RG(this._rctx)),this._fallbackDepthStencilTexture}get gpuMemoryUsage(){var e,t,r,n,s;return{offscreen:((e=this._offscreenRendering)==null?void 0:e.gpuMemoryUsage)??0,highlights:(((t=this._highlight)==null?void 0:t.gpuMemoryUsage)??0)+(((r=this._shadowHighlight)==null?void 0:r.gpuMemoryUsage)??0),shadows:((n=this._shadowMap)==null?void 0:n.gpuMemoryUsage)??0,ssao:((s=this._ssaoHelper)==null?void 0:s.gpuMemoryUsage)??0}}get test(){const e=this;return{offscreen:this._offscreenRendering,shadowMap:this._shadowMap,ssao:this._ssaoHelper,highlight:this._highlight,lighting:this._bindParameters.lighting,materialRenderers:this._materialRenderers,shadowAccumulator:this._shadowAccumulator,weatherIsFading:this._bindParameters.cloudsFade.isFading,getFramebufferTexture:t=>{switch(t){case Wp.Color:return e._offscreenRendering.colorTexture;case Wp.LinearDepth:return e._offscreenRendering.linearDepthTexture;case Wp.Normals:return e._offscreenRendering.normalTexture;case Wp.ShadowMap:return e._shadowMap.depthTexture;case Wp.HudVisibility:return e._offscreenRendering.hudVisibilityTexture;case Wp.Highlight:return e._offscreenRendering.highlightTexture}}}}};var Wp;h([p()],Hu.prototype,"_shadowAccumulator",void 0),h([p()],Hu.prototype,"_smaaPass",void 0),h([p()],Hu.prototype,"_antialiasing",void 0),h([p()],Hu.prototype,"_edgeView",void 0),h([p()],Hu.prototype,"updating",null),h([p()],Hu.prototype,"isCameraFinal",null),Hu=h([D("esri.views.3d.webgl-engine.lib.Renderer")],Hu),function(i){i[i.Color=0]="Color",i[i.LinearDepth=1]="LinearDepth",i[i.Normals=2]="Normals",i[i.ShadowMap=3]="ShadowMap",i[i.HudVisibility=4]="HudVisibility",i[i.Highlight=5]="Highlight"}(Wp||(Wp={}));const A1=[],O1=[],$B=ve(),DB=ve(),ly=ve();let FB=class{constructor(){this.blend=!1,this.blendColor={r:0,g:0,b:0,a:0},this.blendFunction={srcRGB:de.ONE,dstRGB:de.ZERO,srcAlpha:de.ONE,dstAlpha:de.ZERO},this.blendEquation={mode:Cw.ADD,modeAlpha:Cw.ADD},this.colorMask={r:!0,g:!0,b:!0,a:!0},this.faceCulling=!1,this.cullFace=tg.BACK,this.frontFace=LG.CCW,this.scissorTest=!1,this.scissorRect={x:0,y:0,width:0,height:0},this.depthTest=!1,this.depthFunction=hs.LESS,this.clearDepth=1,this.depthWrite=!0,this.depthRange={zNear:0,zFar:1},this.viewport=null,this.stencilTest=!1,this.polygonOffsetFill=!1,this.polygonOffset=[0,0],this.stencilFunction={face:tg.FRONT_AND_BACK,func:hs.ALWAYS,ref:0,mask:1},this.clearStencil=0,this.stencilWriteMask=1,this.stencilOperation={face:tg.FRONT_AND_BACK,fail:x0.KEEP,zFail:x0.KEEP,zPass:x0.KEEP},this.clearColor={r:0,g:0,b:0,a:0},this.program=null,this.vertexBuffer=null,this.indexBuffer=null,this.uniformBuffer=null,this.pixelPackBuffer=null,this.pixelUnpackBuffer=null,this.copyReadBuffer=null,this.copyWriteBuffer=null,this.uniformBufferBindingPoints=new Array,this.readFramebuffer=null,this.drawFramebuffer=null,this.renderbuffer=null,this.activeTexture=0,this.textureUnitMap=new Array,this.vertexArrayObject=null}},g3e=class{constructor(e){this._allocations=new Map,e?Error.stackTraceLimit=1/0:(this.add=()=>{},this.remove=()=>{})}add(e){this._allocations.set(e,new Error().stack)}remove(e){this._allocations.delete(e)}print(){if(this._allocations.size>0){console.log(`${this._allocations.size} live object allocations:`);const e=new Map;this._allocations.forEach(t=>{e.set(t,(e.get(t)??0)+1)}),e.forEach((t,r)=>{const n=r.split(`
`);n.shift(),n.shift(),console.log(`${t}: ${n.shift()}`),n.forEach(s=>console.log("   ",s))})}}};const _3e={RECORD_ALLOCATIONS:!1};let y3e=class{constructor(){for(this._current=new Array,this._max=new Array,this._allocations=new g3e(_3e.RECORD_ALLOCATIONS);this._current.length<Lb.COUNT;)this._current.push(0),this._max.push(0)}resetMax(){for(this._max.length=0;this._max.length<this._current.length;)this._max.push(0)}increment(e,t){const r=++this._current[e];this._max[e]=Math.max(r,this._max[e]),this._allocations.add(t)}decrement(e,t){--this._current[e],this._allocations.remove(t)}get max(){return this._max}get current(){return this._current}get total(){return this.current.reduce((e,t)=>e+t,0)}printResourceCount(){if(this.total>0){console.log("Live objects:");for(let e=0;e<Lb.COUNT;++e){const t=this._current[e];t>0&&console.log(`${Lb[e]}: ${t}`)}}this._allocations.print()}},v3e=class{constructor(e){this._rctx=e,this._store=new p4}dispose(){this._store.forEach(e=>e.forEach(t=>t.dispose())),this._store.clear()}acquire(e,t,r,n){const s=this._store.get(e,t);if(y(s))return s.ref(),s;const a=new _ae(this._rctx,e,t,r,n);return a.ref(),this._store.set(e,t,a),a}get test(){let e=0;return this._store.forEach(t=>t.forEach(r=>e+=r.hasGLName?2:1)),{cachedWebGLObjects:e}}};function NB(i,e){i.resetState();const t=new yn(i,{colorTarget:Vn.TEXTURE,depthStencilTarget:rs.NONE},{target:vi.TEXTURE_2D,wrapMode:si.CLAMP_TO_EDGE,pixelFormat:yt.RGBA,dataType:qt.UNSIGNED_BYTE,samplingMode:Kt.NEAREST,width:1,height:1}),r=hi.createVertex(i,di.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),n=new Gc(i,new Map([["position",0]]),{geometry:[new QD("position",2,um.UNSIGNED_SHORT,0,4)]},{geometry:r}),s=Ge(5633261287538229e-9,2626832878767164e-9,1.4349880495278358e6),a=Ge(563327146742708e-8,2.6268736381334523e6,1434963231608387e-9),o=b3e(i,s,a,e);i.bindFramebuffer(t),i.setViewport(0,0,1,1),i.bindVAO(n),i.drawArrays(Dt.TRIANGLE_STRIP,0,4);const l=new Uint8Array(4);t.readPixels(0,0,1,1,yt.RGBA,qt.UNSIGNED_BYTE,l),o.dispose(),n.dispose(!1),r.dispose(),t.dispose();const c=(s[2]-a[2])/25,u=uH(l);return Math.abs(c-u)}function b3e(i,e,t,r){const n=`

  precision highp float;

  attribute vec2 position;

  uniform vec3 u_highA;
  uniform vec3 u_lowA;
  uniform vec3 u_highB;
  uniform vec3 u_lowB;

  varying vec4 v_color;

  ${r?"#define DOUBLE_PRECISION_REQUIRES_OBFUSCATION":""}

  #ifdef DOUBLE_PRECISION_REQUIRES_OBFUSCATION

  vec3 dpPlusFrc(vec3 a, vec3 b) {
    return mix(a, a + b, vec3(notEqual(b, vec3(0))));
  }

  vec3 dpMinusFrc(vec3 a, vec3 b) {
    return mix(vec3(0), a - b, vec3(notEqual(a, b)));
  }

  vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {
    vec3 t1 = dpPlusFrc(hiA, hiB);
    vec3 e = dpMinusFrc(t1, hiA);
    vec3 t2 = dpMinusFrc(hiB, e) + dpMinusFrc(hiA, dpMinusFrc(t1, e)) + loA + loB;
    return t1 + t2;
  }

  #else

  vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {
    vec3 t1 = hiA + hiB;
    vec3 e = t1 - hiA;
    vec3 t2 = ((hiB - e) + (hiA - (t1 - e))) + loA + loB;
    return t1 + t2;
  }

  #endif

  const float MAX_RGBA_FLOAT =
    255.0 / 256.0 +
    255.0 / 256.0 / 256.0 +
    255.0 / 256.0 / 256.0 / 256.0 +
    255.0 / 256.0 / 256.0 / 256.0 / 256.0;

  const vec4 FIXED_POINT_FACTORS = vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);

  vec4 float2rgba(const float value) {
    // Make sure value is in the domain we can represent
    float valueInValidDomain = clamp(value, 0.0, MAX_RGBA_FLOAT);

    // Decompose value in 32bit fixed point parts represented as
    // uint8 rgba components. Decomposition uses the fractional part after multiplying
    // by a power of 256 (this removes the bits that are represented in the previous
    // component) and then converts the fractional part to 8bits.
    vec4 fixedPointU8 = floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);

    // Convert uint8 values (from 0 to 255) to floating point representation for
    // the shader
    const float toU8AsFloat = 1.0 / 255.0;

    return fixedPointU8 * toU8AsFloat;
  }

  void main() {
    vec3 val = dpAdd(u_highA, u_lowA, -u_highB, -u_lowB);

    v_color = float2rgba(val.z / 25.0);

    gl_Position = vec4(position * 2.0 - 1.0, 0.0, 1.0);
  }
  `,s=`
  precision highp float;

  varying vec4 v_color;

  void main() {
    gl_FragColor = v_color;
  }
  `,a=i.programCache.acquire(n,s,new Map([["position",0]])),o=new Float32Array(6);I5(e,o,3);const l=new Float32Array(6);return I5(t,l,3),i.useProgram(a),a.setUniform3f("u_highA",o[0],o[2],o[4]),a.setUniform3f("u_lowA",o[1],o[3],o[5]),a.setUniform3f("u_highB",l[0],l[2],l[4]),a.setUniform3f("u_lowB",l[1],l[3],l[5]),a}var kB,VB,UB,fee={exports:{}};function w3e(i){var _,g,x,b,v;if(!i.gl)return!1;if(i.type===Nn.WEBGL1)return!(!((_=i.capabilities.textureFloat)!=null&&_.textureFloat)||!((g=i.capabilities.colorBufferFloat)!=null&&g.textureFloat));if(!((x=i.capabilities.textureFloat)!=null&&x.textureFloat&&((b=i.capabilities.colorBufferFloat)!=null&&b.textureFloat)&&((v=i.capabilities.colorBufferFloat)!=null&&v.floatBlend)))return!1;const e=new yn(i,{colorTarget:Vn.TEXTURE,depthStencilTarget:rs.NONE},{target:vi.TEXTURE_2D,wrapMode:si.CLAMP_TO_EDGE,pixelFormat:yt.RGBA,dataType:qt.FLOAT,internalFormat:yS.RGBA32F,samplingMode:Kt.NEAREST,width:1,height:1}),t=hi.createVertex(i,di.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),r=new Gc(i,new Map([["a_pos",0]]),{geometry:[new QD("a_pos",2,um.UNSIGNED_SHORT,0,4)]},{geometry:t}),n=`
  precision highp float;
  attribute vec2 a_pos;

  void main() {
    gl_Position = vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);
  }
  `,s=`
   precision highp float;

   void main() {
    gl_FragColor = vec4(0.5, 0.5, 0.5, 0.5);
   }
  `,a=i.programCache.acquire(n,s,new Map([["a_pos",0]]));i.useProgram(a);const o=i.getBoundFramebufferObject(),{x:l,y:c,width:u,height:d}=i.getViewport();i.bindFramebuffer(e),i.setViewport(0,0,1,1),i.bindVAO(r),i.drawArrays(Dt.TRIANGLE_STRIP,0,4);const m=Ke({blending:Vne});i.setPipelineState(m),i.drawArrays(Dt.TRIANGLE_STRIP,0,4),fee.exports.init(i);const f=i.gl.getError();return i.setViewport(l,c,u,d),i.bindFramebuffer(o),a.dispose(),r.dispose(!1),t.dispose(),e.dispose(),f!==1282||(console.warn("Device claims support for WebGL extension EXT_float_blend but does not support it. Using fall back."),!1)}kB=fee,VB=function(){var i=function(g){window.console&&window.console.log&&window.console.log(g)},e=function(g){window.console&&window.console.error?window.console.error(g):i(g)},t={enable:{1:{0:!0}},disable:{1:{0:!0}},getParameter:{1:{0:!0}},drawArrays:{3:{0:!0}},drawElements:{4:{0:!0,2:!0}},createShader:{1:{0:!0}},getShaderParameter:{2:{1:!0}},getProgramParameter:{2:{1:!0}},getShaderPrecisionFormat:{2:{0:!0,1:!0}},getVertexAttrib:{2:{1:!0}},vertexAttribPointer:{6:{2:!0}},bindTexture:{2:{0:!0}},activeTexture:{1:{0:!0}},getTexParameter:{2:{0:!0,1:!0}},texParameterf:{3:{0:!0,1:!0}},texParameteri:{3:{0:!0,1:!0,2:!0}},texImage2D:{9:{0:!0,2:!0,6:!0,7:!0},6:{0:!0,2:!0,3:!0,4:!0}},texSubImage2D:{9:{0:!0,6:!0,7:!0},7:{0:!0,4:!0,5:!0}},copyTexImage2D:{8:{0:!0,2:!0}},copyTexSubImage2D:{8:{0:!0}},generateMipmap:{1:{0:!0}},compressedTexImage2D:{7:{0:!0,2:!0}},compressedTexSubImage2D:{8:{0:!0,6:!0}},bindBuffer:{2:{0:!0}},bufferData:{3:{0:!0,2:!0}},bufferSubData:{3:{0:!0}},getBufferParameter:{2:{0:!0,1:!0}},pixelStorei:{2:{0:!0,1:!0}},readPixels:{7:{4:!0,5:!0}},bindRenderbuffer:{2:{0:!0}},bindFramebuffer:{2:{0:!0}},checkFramebufferStatus:{1:{0:!0}},framebufferRenderbuffer:{4:{0:!0,1:!0,2:!0}},framebufferTexture2D:{5:{0:!0,1:!0,2:!0}},getFramebufferAttachmentParameter:{3:{0:!0,1:!0,2:!0}},getRenderbufferParameter:{2:{0:!0,1:!0}},renderbufferStorage:{4:{0:!0,1:!0}},clear:{1:{0:{enumBitwiseOr:["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]}}},depthFunc:{1:{0:!0}},blendFunc:{2:{0:!0,1:!0}},blendFuncSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},blendEquation:{1:{0:!0}},blendEquationSeparate:{2:{0:!0,1:!0}},stencilFunc:{3:{0:!0}},stencilFuncSeparate:{4:{0:!0,1:!0}},stencilMaskSeparate:{2:{0:!0}},stencilOp:{3:{0:!0,1:!0,2:!0}},stencilOpSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},cullFace:{1:{0:!0}},frontFace:{1:{0:!0}},drawArraysInstancedANGLE:{4:{0:!0}},drawElementsInstancedANGLE:{5:{0:!0,2:!0}},blendEquationEXT:{1:{0:!0}}},r=null,n=null;function s(g){if(r==null)for(var x in r={},n={},g)typeof g[x]=="number"&&(r[g[x]]=x,n[x]=g[x])}function a(){if(r==null)throw"WebGLDebugUtils.init(ctx) not called"}function o(g){return a(),r[g]!==void 0}function l(g){a();var x=r[g];return x!==void 0?"gl."+x:"/*UNKNOWN WebGL ENUM*/ 0x"+g.toString(16)}function c(g,x,b,v){var w;if((w=t[g])!==void 0&&(w=w[x])!==void 0&&w[b]){if(typeof w[b]=="object"&&w[b].enumBitwiseOr!==void 0){for(var T=w[b].enumBitwiseOr,E=0,C=[],A=0;A<T.length;++A){var M=n[T[A]];v&M&&(E|=M,C.push(l(M)))}return E===v?C.join(" | "):l(v)}return l(v)}return v===null?"null":v===void 0?"undefined":v.toString()}function u(g,x){for(var b="",v=x.length,w=0;w<v;++w)b+=(w==0?"":", ")+c(g,v,w,x[w]);return b}function d(g,x,b){g.__defineGetter__(b,function(){return x[b]}),g.__defineSetter__(b,function(v){x[b]=v})}function m(g,x,b,v){v=v||g,s(g),x=x||function(M,I,L){for(var U="",j=L.length,re=0;re<j;++re)U+=(re==0?"":", ")+c(I,j,re,L[re]);e("WebGL error "+l(M)+" in "+I+"("+U+")")};var w={};function T(M,I){return function(){b&&b(I,arguments);var L=M[I].apply(M,arguments),U=v.getError();return U!=0&&(w[U]=!0,x(U,I,arguments)),L}}var E={};for(var C in g)if(typeof g[C]=="function")if(C!="getExtension")E[C]=T(g,C);else{var A=T(g,C);E[C]=function(){return m(A.apply(g,arguments),x,b,v)}}else d(E,g,C);return E.getError=function(){for(var M in w)if(w.hasOwnProperty(M)&&w[M])return w[M]=!1,M;return g.NO_ERROR},E}function f(g){var x=g.getParameter(g.MAX_VERTEX_ATTRIBS),b=g.createBuffer();g.bindBuffer(g.ARRAY_BUFFER,b);for(var v=0;v<x;++v)g.disableVertexAttribArray(v),g.vertexAttribPointer(v,4,g.FLOAT,!1,0,0),g.vertexAttrib1f(v,0);g.deleteBuffer(b);var w=g.getParameter(g.MAX_TEXTURE_IMAGE_UNITS);for(v=0;v<w;++v)g.activeTexture(g.TEXTURE0+v),g.bindTexture(g.TEXTURE_CUBE_MAP,null),g.bindTexture(g.TEXTURE_2D,null);for(g.activeTexture(g.TEXTURE0),g.useProgram(null),g.bindBuffer(g.ARRAY_BUFFER,null),g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,null),g.bindFramebuffer(g.FRAMEBUFFER,null),g.bindRenderbuffer(g.RENDERBUFFER,null),g.disable(g.BLEND),g.disable(g.CULL_FACE),g.disable(g.DEPTH_TEST),g.disable(g.DITHER),g.disable(g.SCISSOR_TEST),g.blendColor(0,0,0,0),g.blendEquation(g.FUNC_ADD),g.blendFunc(g.ONE,g.ZERO),g.clearColor(0,0,0,0),g.clearDepth(1),g.clearStencil(-1),g.colorMask(!0,!0,!0,!0),g.cullFace(g.BACK),g.depthFunc(g.LESS),g.depthMask(!0),g.depthRange(0,1),g.frontFace(g.CCW),g.hint(g.GENERATE_MIPMAP_HINT,g.DONT_CARE),g.lineWidth(1),g.pixelStorei(g.PACK_ALIGNMENT,4),g.pixelStorei(g.UNPACK_ALIGNMENT,4),g.pixelStorei(g.UNPACK_FLIP_Y_WEBGL,!1),g.pixelStorei(g.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),g.UNPACK_COLORSPACE_CONVERSION_WEBGL&&g.pixelStorei(g.UNPACK_COLORSPACE_CONVERSION_WEBGL,g.BROWSER_DEFAULT_WEBGL),g.polygonOffset(0,0),g.sampleCoverage(1,!1),g.scissor(0,0,g.canvas.width,g.canvas.height),g.stencilFunc(g.ALWAYS,0,4294967295),g.stencilMask(4294967295),g.stencilOp(g.KEEP,g.KEEP,g.KEEP),g.viewport(0,0,g.canvas.width,g.canvas.height),g.clear(g.COLOR_BUFFER_BIT|g.DEPTH_BUFFER_BIT|g.STENCIL_BUFFER_BIT);g.getError(););}function _(g){var x,b,v=[],w=[],T={},E=1,C=!1,A=[],M=0,I=0,L=!1,U=0,j={};function re(Y){return typeof Y=="function"?Y:function(se){Y.handleEvent(se)}}g.getContext=(b=g.getContext,function(){var Y=b.apply(g,arguments);if(Y instanceof WebGLRenderingContext){if(Y!=x){if(x)throw"got different context";T=ie(x=Y)}return T}return Y});var ee=function(Y){v.push(re(Y))},H=function(Y){w.push(re(Y))};function V(Y){var se=Y.addEventListener;Y.addEventListener=function(Ee,Re,Ie){switch(Ee){case"webglcontextlost":ee(Re);break;case"webglcontextrestored":H(Re);break;default:se.apply(Y,arguments)}}}function X(){for(var Y=Object.keys(j),se=0;se<Y.length;++se)delete j[Y]}function $(){++I,C||M==I&&g.loseContext()}function B(Y,se){var Ee=Y[se];return function(){if($(),!C)return Ee.apply(Y,arguments)}}function W(){for(var Y=0;Y<A.length;++Y){var se=A[Y];se instanceof WebGLBuffer?x.deleteBuffer(se):se instanceof WebGLFramebuffer?x.deleteFramebuffer(se):se instanceof WebGLProgram?x.deleteProgram(se):se instanceof WebGLRenderbuffer?x.deleteRenderbuffer(se):se instanceof WebGLShader?x.deleteShader(se):se instanceof WebGLTexture&&x.deleteTexture(se)}}function te(Y){return{statusMessage:Y,preventDefault:function(){L=!0}}}return V(g),g.loseContext=function(){if(!C){for(C=!0,M=0,++E;x.getError(););X(),j[x.CONTEXT_LOST_WEBGL]=!0;var Y=te("context lost"),se=v.slice();setTimeout(function(){for(var Ee=0;Ee<se.length;++Ee)se[Ee](Y);U>=0&&setTimeout(function(){g.restoreContext()},U)},0)}},g.restoreContext=function(){C&&w.length&&setTimeout(function(){if(!L)throw"can not restore. webglcontestlost listener did not call event.preventDefault";W(),f(x),C=!1,I=0,L=!1;for(var Y=w.slice(),se=te("context restored"),Ee=0;Ee<Y.length;++Ee)Y[Ee](se)},0)},g.loseContextInNCalls=function(Y){if(C)throw"You can not ask a lost contet to be lost";M=I+Y},g.getNumCalls=function(){return I},g.setRestoreTimeout=function(Y){U=Y},g;function ie(Y){for(var se in Y)typeof Y[se]=="function"?T[se]=B(Y,se):d(T,Y,se);T.getError=function(){if($(),!C)for(;we=x.getError();)j[we]=!0;for(var we in j)if(j[we])return delete j[we],we;return T.NO_ERROR};for(var Ee=["createBuffer","createFramebuffer","createProgram","createRenderbuffer","createShader","createTexture"],Re=0;Re<Ee.length;++Re){var Ie=Ee[Re];T[Ie]=function(we){return function(){if($(),C)return null;var $e=we.apply(Y,arguments);return $e.__webglDebugContextLostId__=E,A.push($e),$e}}(Y[Ie])}var Ue=["getActiveAttrib","getActiveUniform","getBufferParameter","getContextAttributes","getAttachedShaders","getFramebufferAttachmentParameter","getParameter","getProgramParameter","getProgramInfoLog","getRenderbufferParameter","getShaderParameter","getShaderInfoLog","getShaderSource","getTexParameter","getUniform","getUniformLocation","getVertexAttrib"];for(Re=0;Re<Ue.length;++Re)Ie=Ue[Re],T[Ie]=function(we){return function(){return $(),C?null:we.apply(Y,arguments)}}(T[Ie]);var ye=["isBuffer","isEnabled","isFramebuffer","isProgram","isRenderbuffer","isShader","isTexture"];for(Re=0;Re<ye.length;++Re)Ie=ye[Re],T[Ie]=function(we){return function(){return $(),!C&&we.apply(Y,arguments)}}(T[Ie]);return T.checkFramebufferStatus=function(we){return function(){return $(),C?T.FRAMEBUFFER_UNSUPPORTED:we.apply(Y,arguments)}}(T.checkFramebufferStatus),T.getAttribLocation=function(we){return function(){return $(),C?-1:we.apply(Y,arguments)}}(T.getAttribLocation),T.getVertexAttribOffset=function(we){return function(){return $(),C?0:we.apply(Y,arguments)}}(T.getVertexAttribOffset),T.isContextLost=function(){return C},T}}return{init:s,mightBeEnum:o,glEnumToString:l,glFunctionArgToString:c,glFunctionArgsToString:u,makeDebugContext:m,makeLostContextSimulatingCanvas:_,resetToInitialState:f}},(UB=VB())!==void 0&&(kB.exports=UB);function x3e(i){const e=new yn(i,{colorTarget:Vn.TEXTURE,depthStencilTarget:rs.NONE},{target:vi.TEXTURE_2D,wrapMode:si.CLAMP_TO_EDGE,pixelFormat:yt.RGBA,dataType:qt.UNSIGNED_BYTE,samplingMode:Kt.NEAREST,width:1,height:1}),t=`
precision highp float;
attribute vec2 a_pos;
uniform highp sampler2D u_texture;
varying vec4 v_color;

float getBit(in float bitset, in int bitIndex) {
  float offset = pow(2.0, float(bitIndex));
  return mod(floor(bitset / offset), 2.0);
}

void main() {
  vec4 value = texture2D(u_texture, vec2(0.0));
  float bit = getBit(value.x * 255.0, 1);

  v_color = bit * vec4(1.0);
  gl_Position = vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);
}
`,r=`
precision highp float;
varying vec4 v_color;

void main() {
  gl_FragColor = v_color;
}
`,n=new Uint8Array(4),s=hi.createVertex(i,di.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),a=new Gc(i,new Map([["a_position",0]]),{geometry:[new QD("a_position",2,um.SHORT,0,4)]},{geometry:s}),o=i.programCache.acquire(t,r,new Map([["a_pos",0]]));i.useProgram(o);const l=new Gi(i,{target:vi.TEXTURE_2D,wrapMode:si.CLAMP_TO_EDGE,pixelFormat:yt.RGBA,dataType:qt.UNSIGNED_BYTE,samplingMode:Kt.NEAREST,width:1,height:1},new Uint8Array([2,255,0,0]));o.setUniform1i("u_texture",0),i.bindTexture(l,0);const c=i.getBoundFramebufferObject();i.bindFramebuffer(e),i.useProgram(o);const{x:u,y:d,width:m,height:f}=i.getViewport();i.setViewport(0,0,1,1),i.bindVAO(a),i.drawArrays(Dt.TRIANGLE_STRIP,0,4),i.setViewport(u,d,m,f),e.readPixels(0,0,1,1,yt.RGBA,qt.UNSIGNED_BYTE,n),o.dispose(),a.dispose(!1),s.dispose(),e.dispose();const _=n[0]!==255||n[1]!==255||n[2]!==255||n[3]!==255;return _&&J.getLogger("esri.views.webgl.testSamplerPrecision").warn(`A problem was detected with your graphics driver. Your driver does not appear to honor sampler precision specifiers, which may result in rendering issues due to numerical instability. We recommend ensuring that your drivers have been updated to the latest version. Applying lowp sampler workaround. [${n[0]}.${n[1]}.${n[2]}.${n[3]}]`),i.bindFramebuffer(c),_}async function T3e(i){const e=new Image;if(e.src="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='5' height='5' version='1.1' viewBox='0 0 5 5' xmlns='http://www.w3.org/2000/svg'%3E%3Crect width='5' height='5' fill='%23f00' fill-opacity='.5'/%3E%3C/svg%3E%0A",e.width=5,e.height=5,await e.decode(),!i.gl)return!0;const t=new yn(i,{colorTarget:Vn.TEXTURE,depthStencilTarget:rs.NONE},{target:vi.TEXTURE_2D,wrapMode:si.CLAMP_TO_EDGE,pixelFormat:yt.RGBA,dataType:qt.UNSIGNED_BYTE,samplingMode:Kt.NEAREST,width:1,height:1}),r=hi.createVertex(i,di.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),n=new Gc(i,new Map([["a_pos",0]]),yae,{geometry:r}),s=`
  precision highp float;

  attribute vec2 a_pos;
  varying vec2 v_uv;

  void main() {
    v_uv = a_pos;
    gl_Position = vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);
  }
  `,a=`
  precision highp float;

  varying vec2 v_uv;
  uniform sampler2D u_texture;

  void main() {
    gl_FragColor = texture2D(u_texture, v_uv);
  }
  `,o=i.programCache.acquire(s,a,new Map([["a_pos",0]]));i.useProgram(o);const l=new Gi(i,{dataType:qt.UNSIGNED_BYTE,pixelFormat:yt.RGBA,preMultiplyAlpha:!1,wrapMode:si.CLAMP_TO_EDGE,samplingMode:Kt.LINEAR},e);i.bindTexture(l,0),o.setUniform1i("u_texture",0);const c=i.getBoundFramebufferObject(),{x:u,y:d,width:m,height:f}=i.getViewport();i.bindFramebuffer(t),i.setViewport(0,0,1,1),i.setClearColor(0,0,0,0),i.setBlendingEnabled(!1),i.clearSafe(Ai.COLOR_BUFFER_BIT),i.bindVAO(n),i.drawArrays(Dt.TRIANGLE_STRIP,0,4);const _=new Uint8Array(4);return t.readPixels(0,0,1,1,yt.RGBA,qt.UNSIGNED_BYTE,_),o.dispose(),n.dispose(!1),r.dispose(),t.dispose(),l.dispose(),i.setViewport(u,d,m,f),i.bindFramebuffer(c),e.src="",_[0]===255}let C3e=class{constructor(e){this.context=e,this._floatBufferBlendWorking=w3e(e),T3e(e).then(t=>this._svgAlwaysPremultipliesAlpha=!t)}get floatBufferBlendWorking(){if(S(this._floatBufferBlendWorking))throw new Error("floatBufferBlendWorking test not yet available");return this._floatBufferBlendWorking}get svgAlwaysPremultipliesAlpha(){if(S(this._svgAlwaysPremultipliesAlpha))throw new Error("svgAlwaysPremultipliesAlpha test not yet available");return this._svgAlwaysPremultipliesAlpha}get doublePrecisionRequiresObfuscation(){if(S(this._doublePrecisionRequiresObfuscation)){const e=NB(this.context,!1),t=NB(this.context,!0);this._doublePrecisionRequiresObfuscation=e!==0&&(t===0||e/t>5)}return this._doublePrecisionRequiresObfuscation}get ignoresSamplerPrecision(){return S(this._ignoresSamplerPrecision)&&(this._ignoresSamplerPrecision=x3e(this.context)),this._ignoresSamplerPrecision}};function S3e(i,e){if(e.disjointTimerQuery)return null;if(Ca(i))return{drawBuffers:i.drawBuffers.bind(i),MAX_DRAW_BUFFERS:i.MAX_DRAW_BUFFERS,MAX_COLOR_ATTACHMENTS:i.MAX_COLOR_ATTACHMENTS};if(e.drawBuffers)return null;const t=i.getExtension("WEBGL_draw_buffers");return t?{drawBuffers:t.drawBuffersWEBGL.bind(t),MAX_DRAW_BUFFERS:t.MAX_DRAW_BUFFERS_WEBGL,MAX_COLOR_ATTACHMENTS:t.MAX_COLOR_ATTACHMENTS_WEBGL}:null}function E3e(i){if(Ca(i))return i;const e=i.getExtension("ANGLE_instanced_arrays");return e?{drawArraysInstanced:e.drawArraysInstancedANGLE.bind(e),drawElementsInstanced:e.drawElementsInstancedANGLE.bind(e),vertexAttribDivisor:e.vertexAttribDivisorANGLE.bind(e)}:null}function P3e(i,e){if(e.compressedTextureETC)return null;const t=i.getExtension("WEBGL_compressed_texture_etc");return t?{COMPRESSED_R11_EAC:t.COMPRESSED_R11_EAC,COMPRESSED_SIGNED_R11_EAC:t.COMPRESSED_SIGNED_R11_EAC,COMPRESSED_RG11_EAC:t.COMPRESSED_RG11_EAC,COMPRESSED_SIGNED_RG11_EAC:t.COMPRESSED_SIGNED_RG11_EAC,COMPRESSED_RGB8_ETC2:t.COMPRESSED_RGB8_ETC2,COMPRESSED_SRGB8_ETC2:t.COMPRESSED_SRGB8_ETC2,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2,COMPRESSED_RGBA8_ETC2_EAC:t.COMPRESSED_RGBA8_ETC2_EAC,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC}:null}function R3e(i,e){if(e.compressedTextureS3TC)return null;const t=i.getExtension("WEBGL_compressed_texture_s3tc");return t?{COMPRESSED_RGB_S3TC_DXT1:t.COMPRESSED_RGB_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT1:t.COMPRESSED_RGBA_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT3:t.COMPRESSED_RGBA_S3TC_DXT3_EXT,COMPRESSED_RGBA_S3TC_DXT5:t.COMPRESSED_RGBA_S3TC_DXT5_EXT}:null}function A3e(i,e){if(Ca(i))return{MIN:i.MIN,MAX:i.MAX};if(e.blendMinMax)return null;{const t=i.getExtension("EXT_blend_minmax");return t?{MIN:t.MIN_EXT,MAX:t.MAX_EXT}:null}}function O3e(i,e){if(e.textureFilterAnisotropic)return null;const t=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");return t?{MAX_TEXTURE_MAX_ANISOTROPY:t.MAX_TEXTURE_MAX_ANISOTROPY_EXT,TEXTURE_MAX_ANISOTROPY:t.TEXTURE_MAX_ANISOTROPY_EXT}:null}function M3e(i,e){if(Ca(i))return{textureFloat:!0,textureFloatLinear:!e.textureFloatLinear&&!!i.getExtension("OES_texture_float_linear"),textureHalfFloat:!0,textureHalfFloatLinear:!0,HALF_FLOAT:i.HALF_FLOAT,R16F:i.R16F,RG16F:i.RG16F,RGBA16F:i.RGBA16F,R32F:i.R32F,RG32F:i.RG32F,RGBA32F:i.RGBA32F,R11F_G11F_B10F:i.R11F_G11F_B10F,RGB16F:i.RGB16F};if(i instanceof WebGLRenderingContext){const t=!e.textureHalfFloat&&i.getExtension("OES_texture_half_float");return{textureFloat:!e.textureFloat&&!!i.getExtension("OES_texture_float"),textureFloatLinear:!e.textureFloatLinear&&!!i.getExtension("OES_texture_float_linear"),textureHalfFloat:!!t,textureHalfFloatLinear:!e.textureHalfFloatLinear&&!!i.getExtension("OES_texture_half_float_linear"),HALF_FLOAT:t?t.HALF_FLOAT_OES:void 0}}return null}function I3e(i,e){if(Ca(i)){const t=!e.colorBufferHalfFloat&&i.getExtension("EXT_color_buffer_half_float")||!e.colorBufferFloat&&i.getExtension("EXT_color_buffer_float"),r=!e.colorBufferFloat&&i.getExtension("EXT_color_buffer_float"),n=!e.floatBlend&&!e.colorBufferFloat&&i.getExtension("EXT_float_blend");return t||r||n?{textureFloat:!!r,textureHalfFloat:!!t,floatBlend:!!n,R16F:i.R16F,RG16F:i.RG16F,RGBA16F:i.RGBA16F,R32F:i.R32F,RG32F:i.RG32F,RGBA32F:i.RGBA32F,R11F_G11F_B10F:i.R11F_G11F_B10F,RGB16F:i.RGB16F}:null}if(i instanceof WebGLRenderingContext){const t=!e.colorBufferHalfFloat&&i.getExtension("EXT_color_buffer_half_float"),r=!e.colorBufferFloat&&i.getExtension("WEBGL_color_buffer_float"),n=!e.floatBlend&&!e.colorBufferFloat&&i.getExtension("EXT_float_blend");return t||r||n?{textureFloat:!!r,textureHalfFloat:!!t,floatBlend:!!n,RGBA16F:t?t.RGBA16F_EXT:void 0,RGB16F:t?t.RGB16F_EXT:void 0,RGBA32F:r?r.RGBA32F_EXT:void 0}:null}return null}function M1(i,e,t,r,n){if(r&&Ca(i))return!0;if(e[t])return!1;for(const s of n)if(i.getExtension(s))return!0;return!1}function L3e(i,e){if(!Ca(i)||e.textureNorm16)return null;const t=i.getExtension("EXT_texture_norm16");return t?{R16:t.R16_EXT,RG16:t.RG16_EXT,RGB16:t.RGB16_EXT,RGBA16:t.RGBA16_EXT,R16_SNORM:t.R16_SNORM_EXT,RG16_SNORM:t.RG16_SNORM_EXT,RGB16_SNORM:t.RGB16_SNORM_EXT,RGBA16_SNORM:t.RGBA16_SNORM_EXT}:null}function $3e(i,e){const t=e.loseContext&&i.getExtension("WEBGL_lose_context");return t?{loseRenderingContext:()=>t.loseContext()}:null}function D3e(i,e){if(Ca(i))return{createVertexArray:i.createVertexArray.bind(i),deleteVertexArray:i.deleteVertexArray.bind(i),bindVertexArray:i.bindVertexArray.bind(i)};if(e.vao)return null;const t=i.getExtension("OES_vertex_array_object")||i.getExtension("MOZ_OES_vertex_array_object")||i.getExtension("WEBKIT_OES_vertex_array_object");return t?{createVertexArray:t.createVertexArrayOES.bind(t),deleteVertexArray:t.deleteVertexArrayOES.bind(t),bindVertexArray:t.bindVertexArrayOES.bind(t)}:null}class F3e{constructor(e,t){this._gl=e,this._instancing=null,this._vertexArrayObject=null,this._compressedTextureETC=null,this._compressedTextureS3TC=null,this._textureFilterAnisotropic=null,this._textureFloat=null,this._colorBufferFloat=null,this._minMaxBlending=null,this._loseContext=null,this._drawBuffers=null,this._textureNorm16=null,this._depthTexture=null,this._standardDerivatives=null,this._shaderTextureLOD=null,this._fragDepth=null,this._textureFloatLinear=null,this._disabledExtensions=t.disabledExtensions||{},this._debugWebGLExtensions=t.debugWebGLExtensions||{}}get drawBuffers(){return this._drawBuffers||(this._drawBuffers=S3e(this._gl,this._disabledExtensions)),this._drawBuffers}get instancing(){return this._instancing||(this._instancing=E3e(this._gl)),this._instancing}get vao(){return this._vertexArrayObject||(this._vertexArrayObject=D3e(this._gl,this._disabledExtensions)),this._vertexArrayObject}get compressedTextureETC(){return this._compressedTextureETC||(this._compressedTextureETC=P3e(this._gl,this._disabledExtensions)),this._compressedTextureETC}get compressedTextureS3TC(){return this._compressedTextureS3TC||(this._compressedTextureS3TC=R3e(this._gl,this._disabledExtensions)),this._compressedTextureS3TC}get textureFilterAnisotropic(){return this._textureFilterAnisotropic||(this._textureFilterAnisotropic=O3e(this._gl,this._disabledExtensions)),this._textureFilterAnisotropic}get disjointTimerQuery(){return this._disjointTimerQuery||(this._disjointTimerQuery=d3e(this._gl,this._disabledExtensions)),this._disjointTimerQuery}get textureFloat(){return this._textureFloat||(this._textureFloat=M3e(this._gl,this._disabledExtensions)),this._textureFloat}get colorBufferFloat(){return this._colorBufferFloat||(this._colorBufferFloat=I3e(this._gl,this._disabledExtensions)),this._colorBufferFloat}get blendMinMax(){return this._minMaxBlending||(this._minMaxBlending=A3e(this._gl,this._disabledExtensions)),this._minMaxBlending}get depthTexture(){return this._depthTexture===null&&(this._depthTexture=M1(this._gl,this._disabledExtensions,"depthTexture",!0,["WEBGL_depth_texture","MOZ_WEBGL_depth_texture","WEBKIT_WEBGL_depth_texture"])),this._depthTexture}get standardDerivatives(){return this._standardDerivatives===null&&(this._standardDerivatives=M1(this._gl,this._disabledExtensions,"standardDerivatives",!0,["OES_standard_derivatives"])),this._standardDerivatives}get shaderTextureLOD(){return this._shaderTextureLOD===null&&(this._shaderTextureLOD=M1(this._gl,this._disabledExtensions,"shaderTextureLOD",!0,["EXT_shader_texture_lod"])),this._shaderTextureLOD}get fragDepth(){return this._fragDepth===null&&(this._fragDepth=M1(this._gl,this._disabledExtensions,"fragDepth",!0,["EXT_frag_depth"])),this._fragDepth}get loseContext(){return this._loseContext||(this._loseContext=$3e(this._gl,this._debugWebGLExtensions)),this._loseContext}get textureNorm16(){return this._textureNorm16||(this._textureNorm16=L3e(this._gl,this._disabledExtensions)),this._textureNorm16}get textureFloatLinear(){return this._textureFloatLinear===null&&(this._textureFloatLinear=M1(this._gl,this._disabledExtensions,"textureFloatLinear",!1,["OES_texture_float_linear"])),this._textureFloatLinear}enable(e){return this[e]}}let N3e=class{constructor(e,t){this.gl=e,this.instanceCounter=new y3e,this.programCache=new v3e(this),this._state=new FB,this._numOfDrawCalls=0,this._numOfTriangles=0,this.type=Ca(e)?Nn.WEBGL2:Nn.WEBGL1,this._loadExtensions(),this.configure(t)}configure(e){this._capabilities=new F3e(this.gl,e),this._parameters=this._loadParameters(e);const t=this.gl.getParameter(this.gl.VIEWPORT);this._state=new FB,this._state.viewport={x:t[0],y:t[1],width:t[2],height:t[3]},this._stateTracker=new ene({setBlending:r=>{if(r){this.setBlendingEnabled(!0),this.setBlendEquationSeparate(r.opRgb,r.opAlpha),this.setBlendFunctionSeparate(r.srcRgb,r.dstRgb,r.srcAlpha,r.dstAlpha);const n=r.color;this.setBlendColor(n.r,n.g,n.b,n.a)}else this.setBlendingEnabled(!1)},setCulling:r=>{r?(this.setFaceCullingEnabled(!0),this.setCullFace(r.face),this.setFrontFace(r.mode)):this.setFaceCullingEnabled(!1)},setPolygonOffset:r=>{r?(this.setPolygonOffsetFillEnabled(!0),this.setPolygonOffset(r.factor,r.units)):this.setPolygonOffsetFillEnabled(!1)},setDepthTest:r=>{r?(this.setDepthTestEnabled(!0),this.setDepthFunction(r.func)):this.setDepthTestEnabled(!1)},setStencilTest:r=>{if(r){this.setStencilTestEnabled(!0);const n=r.function;this.setStencilFunction(n.func,n.ref,n.mask);const s=r.operation;this.setStencilOp(s.fail,s.zFail,s.zPass)}else this.setStencilTestEnabled(!1)},setDepthWrite:r=>{r?(this.setDepthWriteEnabled(!0),this.setDepthRange(r.zNear,r.zFar)):this.setDepthWriteEnabled(!1)},setColorWrite:r=>{r?this.setColorMask(r.r,r.g,r.b,r.a):this.setColorMask(!1,!1,!1,!1)},setStencilWrite:r=>{r?this.setStencilWriteMask(r.mask):this.setStencilWriteMask(0)}}),this.enforceState(),this._driverTest=new C3e(this)}get driverTest(){return this._driverTest}get contextAttributes(){return this.gl.getContextAttributes()}get parameters(){return this._parameters}dispose(){this.programCache.dispose(),this.bindVAO(null),this.unbindBuffer(Mt.ARRAY_BUFFER),this.unbindBuffer(Mt.ELEMENT_ARRAY_BUFFER),Ca(this.gl)&&(this.unbindBuffer(Mt.UNIFORM_BUFFER),this._state.uniformBufferBindingPoints.length=0,this.unbindBuffer(Mt.PIXEL_PACK_BUFFER),this.unbindBuffer(Mt.PIXEL_UNPACK_BUFFER),this.unbindBuffer(Mt.COPY_READ_BUFFER),this.unbindBuffer(Mt.COPY_WRITE_BUFFER)),this._state.textureUnitMap.length=0,qd()&&this.instanceCounter.printResourceCount()}setPipelineState(e){this._stateTracker.setPipeline(e)}setBlendingEnabled(e){this._state.blend!==e&&(e===!0?this.gl.enable(this.gl.BLEND):this.gl.disable(this.gl.BLEND),this._state.blend=e,this._stateTracker.invalidateBlending())}externalProgramUpdate(){var e;(e=this._state.program)==null||e.stop(),this._state.program=null}externalTextureUnitUpdate(e,t){for(let r=0;r<e.length;++r)this._state.textureUnitMap[e[r]]=null;t>=0&&(this._state.activeTexture=t)}externalVertexArrayObjectUpdate(){const e=this.capabilities.vao;e&&(e.bindVertexArray(null),this._state.vertexArrayObject=null),this._state.vertexBuffer=null,this._state.indexBuffer=null}externalVertexBufferUpdate(){this._state.vertexBuffer=null}externalIndexBufferUpdate(){this._state.indexBuffer=null}setBlendColor(e,t,r,n){e===this._state.blendColor.r&&t===this._state.blendColor.g&&r===this._state.blendColor.b&&n===this._state.blendColor.a||(this.gl.blendColor(e,t,r,n),this._state.blendColor.r=e,this._state.blendColor.g=t,this._state.blendColor.b=r,this._state.blendColor.a=n,this._stateTracker.invalidateBlending())}setBlendFunction(e,t){e===this._state.blendFunction.srcRGB&&t===this._state.blendFunction.dstRGB||(this.gl.blendFunc(e,t),this._state.blendFunction.srcRGB=e,this._state.blendFunction.srcAlpha=e,this._state.blendFunction.dstRGB=t,this._state.blendFunction.dstAlpha=t,this._stateTracker.invalidateBlending())}setBlendFunctionSeparate(e,t,r,n){this._state.blendFunction.srcRGB===e&&this._state.blendFunction.srcAlpha===r&&this._state.blendFunction.dstRGB===t&&this._state.blendFunction.dstAlpha===n||(this.gl.blendFuncSeparate(e,t,r,n),this._state.blendFunction.srcRGB=e,this._state.blendFunction.srcAlpha=r,this._state.blendFunction.dstRGB=t,this._state.blendFunction.dstAlpha=n,this._stateTracker.invalidateBlending())}setBlendEquation(e){this._state.blendEquation.mode!==e&&(this.gl.blendEquation(e),this._state.blendEquation.mode=e,this._state.blendEquation.modeAlpha=e,this._stateTracker.invalidateBlending())}setBlendEquationSeparate(e,t){this._state.blendEquation.mode===e&&this._state.blendEquation.modeAlpha===t||(this.gl.blendEquationSeparate(e,t),this._state.blendEquation.mode=e,this._state.blendEquation.modeAlpha=t,this._stateTracker.invalidateBlending())}setColorMask(e,t,r,n){this._state.colorMask.r===e&&this._state.colorMask.g===t&&this._state.colorMask.b===r&&this._state.colorMask.a===n||(this.gl.colorMask(e,t,r,n),this._state.colorMask.r=e,this._state.colorMask.g=t,this._state.colorMask.b=r,this._state.colorMask.a=n,this._stateTracker.invalidateColorWrite())}setClearColor(e,t,r,n){this._state.clearColor.r===e&&this._state.clearColor.g===t&&this._state.clearColor.b===r&&this._state.clearColor.a===n||(this.gl.clearColor(e,t,r,n),this._state.clearColor.r=e,this._state.clearColor.g=t,this._state.clearColor.b=r,this._state.clearColor.a=n)}setFaceCullingEnabled(e){this._state.faceCulling!==e&&(e===!0?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this._state.faceCulling=e,this._stateTracker.invalidateCulling())}setPolygonOffsetFillEnabled(e){this._state.polygonOffsetFill!==e&&(e===!0?this.gl.enable(this.gl.POLYGON_OFFSET_FILL):this.gl.disable(this.gl.POLYGON_OFFSET_FILL),this._state.polygonOffsetFill=e,this._stateTracker.invalidatePolygonOffset())}setPolygonOffset(e,t){this._state.polygonOffset[0]===e&&this._state.polygonOffset[1]===t||(this._state.polygonOffset[0]=e,this._state.polygonOffset[1]=t,this.gl.polygonOffset(e,t),this._stateTracker.invalidatePolygonOffset())}setCullFace(e){this._state.cullFace!==e&&(this.gl.cullFace(e),this._state.cullFace=e,this._stateTracker.invalidateCulling())}setFrontFace(e){this._state.frontFace!==e&&(this.gl.frontFace(e),this._state.frontFace=e,this._stateTracker.invalidateCulling())}setScissorTestEnabled(e){this._state.scissorTest!==e&&(e===!0?this.gl.enable(this.gl.SCISSOR_TEST):this.gl.disable(this.gl.SCISSOR_TEST),this._state.scissorTest=e)}setScissorRect(e,t,r,n){this._state.scissorRect.x===e&&this._state.scissorRect.y===t&&this._state.scissorRect.width===r&&this._state.scissorRect.height===n||(this.gl.scissor(e,t,r,n),this._state.scissorRect.x=e,this._state.scissorRect.y=t,this._state.scissorRect.width=r,this._state.scissorRect.height=n)}setDepthTestEnabled(e){this._state.depthTest!==e&&(e===!0?this.gl.enable(this.gl.DEPTH_TEST):this.gl.disable(this.gl.DEPTH_TEST),this._state.depthTest=e,this._stateTracker.invalidateDepthTest())}setClearDepth(e){this._state.clearDepth!==e&&(this.gl.clearDepth(e),this._state.clearDepth=e)}setDepthFunction(e){this._state.depthFunction!==e&&(this.gl.depthFunc(e),this._state.depthFunction=e,this._stateTracker.invalidateDepthTest())}setDepthWriteEnabled(e){this._state.depthWrite!==e&&(this.gl.depthMask(e),this._state.depthWrite=e,this._stateTracker.invalidateDepthWrite())}setDepthRange(e,t){this._state.depthRange.zNear===e&&this._state.depthRange.zFar===t||(this.gl.depthRange(e,t),this._state.depthRange.zNear=e,this._state.depthRange.zFar=t,this._stateTracker.invalidateDepthWrite())}setStencilTestEnabled(e){this._state.stencilTest!==e&&(e===!0?this.gl.enable(this.gl.STENCIL_TEST):this.gl.disable(this.gl.STENCIL_TEST),this._state.stencilTest=e,this._stateTracker.invalidateStencilTest())}setClearStencil(e){e!==this._state.clearStencil&&(this.gl.clearStencil(e),this._state.clearStencil=e)}setStencilFunction(e,t,r){this._state.stencilFunction.func===e&&this._state.stencilFunction.ref===t&&this._state.stencilFunction.mask===r||(this.gl.stencilFunc(e,t,r),this._state.stencilFunction.face=tg.FRONT_AND_BACK,this._state.stencilFunction.func=e,this._state.stencilFunction.ref=t,this._state.stencilFunction.mask=r,this._stateTracker.invalidateStencilTest())}setStencilFunctionSeparate(e,t,r,n){this._state.stencilFunction.face===e&&this._state.stencilFunction.func===t&&this._state.stencilFunction.ref===r&&this._state.stencilFunction.mask===n||(this.gl.stencilFuncSeparate(e,t,r,n),this._state.stencilFunction.face=e,this._state.stencilFunction.func=t,this._state.stencilFunction.ref=r,this._state.stencilFunction.mask=n,this._stateTracker.invalidateStencilTest())}setStencilWriteMask(e){this._state.stencilWriteMask!==e&&(this.gl.stencilMask(e),this._state.stencilWriteMask=e,this._stateTracker.invalidateStencilWrite())}setStencilOp(e,t,r){this._state.stencilOperation.face===tg.FRONT_AND_BACK&&this._state.stencilOperation.fail===e&&this._state.stencilOperation.zFail===t&&this._state.stencilOperation.zPass===r||(this.gl.stencilOp(e,t,r),this._state.stencilOperation.face=tg.FRONT_AND_BACK,this._state.stencilOperation.fail=e,this._state.stencilOperation.zFail=t,this._state.stencilOperation.zPass=r,this._stateTracker.invalidateStencilTest())}setStencilOpSeparate(e,t,r,n){this._state.stencilOperation.face===e&&this._state.stencilOperation.fail===t&&this._state.stencilOperation.zFail===r&&this._state.stencilOperation.zPass===n||(this.gl.stencilOpSeparate(e,t,r,n),this._state.stencilOperation.face=e,this._state.stencilOperation.fail=t,this._state.stencilOperation.zFail=r,this._state.stencilOperation.zPass=n,this._stateTracker.invalidateStencilTest())}setActiveTexture(e,t=!1){const r=this._state.activeTexture;return e>=0&&(t||e!==this._state.activeTexture)&&(this.gl.activeTexture(rA+e),this._state.activeTexture=e),r}clear(e){e&&this.gl.clear(e)}clearSafe(e,t=255){e&&(e&Ai.COLOR_BUFFER_BIT&&this.setColorMask(!0,!0,!0,!0),e&Ai.DEPTH_BUFFER_BIT&&this.setDepthWriteEnabled(!0),e&Ai.STENCIL_BUFFER_BIT&&this.setStencilWriteMask(t),this.gl.clear(e))}drawArrays(e,t,r){if(qd()&&(this._numOfDrawCalls++,this._numOfTriangles+=zB(e,r)),this.gl.drawArrays(e,t,r),qd()){const n=k5(this);n&&console.error("drawArrays:",n)}}drawElements(e,t,r,n){if(qd()&&(this._numOfDrawCalls++,this._numOfTriangles+=zB(e,t)),this.gl.drawElements(e,t,r,n),qd()){const s=k5(this);if(s){const a=this.getBoundVAO(),o=a==null?void 0:a.indexBuffer,l=a==null?void 0:a.vertexBuffers,c={indexBuffer:o,vertexBuffers:l},u={mode:e,count:t,type:r,offset:n},d=co(o,_=>_.size)??0,m=n+t,f=d<m?`. Buffer is too small. Attempted to draw index ${m} of ${d}`:"";console.error(`drawElements: ${s}${f}`,{args:u,vao:c})}}}logInfo(){qd()&&console.log(`DrawCalls: ${this._numOfDrawCalls}, Triangles: ${this._numOfTriangles}`)}resetInfo(){qd()&&(this._numOfDrawCalls=0,this._numOfTriangles=0)}get capabilities(){return this._capabilities}setViewport(e,t,r,n){r=Math.max(Math.round(r),1),n=Math.max(Math.round(n),1);const s=this._state.viewport;s.x===e&&s.y===t&&s.width===r&&s.height===n||(s.x=e,s.y=t,s.width=r,s.height=n,this.gl.viewport(e,t,r,n))}getViewport(){const e=this._state.viewport;return{x:e.x,y:e.y,width:e.width,height:e.height}}useProgram(e){var t;this._state.program!==e&&((t=this._state.program)==null||t.stop(),this._state.program=e,this.gl.useProgram((e==null?void 0:e.glName)??null))}bindTexture(e,t,r=!1){(t>=this.parameters.maxTextureImageUnits||t<0)&&console.error("Input texture unit is out of range of available units!");const n=this._state.textureUnitMap[t];return S(e)||e.glName==null?(y(n)&&(this.setActiveTexture(t,r),this.gl.bindTexture(n.descriptor.target,null)),this._state.textureUnitMap[t]=null,n):r||n!==e?(this.setActiveTexture(t,r),this.gl.bindTexture(e.descriptor.target,e.glName),e.applyChanges(),this._state.textureUnitMap[t]=e,n):(e.isDirty&&(this.setActiveTexture(t,r),e.applyChanges()),n)}unbindTexture(e){if(!S(e))for(let t=0;t<this.parameters.maxTextureImageUnits;t++)this._state.textureUnitMap[t]===e&&(this.bindTexture(null,t),this._state.textureUnitMap[t]=null)}bindFramebuffer(e,t=!1){if(t||this._state.readFramebuffer!==e||this._state.drawFramebuffer!==e){if(S(e))return this.gl.bindFramebuffer(Kl.FRAMEBUFFER,null),this._state.readFramebuffer=null,void(this._state.drawFramebuffer=null);e.initializeAndBind(Kl.FRAMEBUFFER),this._state.readFramebuffer=e,this._state.drawFramebuffer=e}}bindFramebufferSeparate(e,t,r=!1){const n=t===Kl.READ_FRAMEBUFFER,s=n?this._state.readFramebuffer:this._state.drawFramebuffer;(r||s!==e)&&(S(e)?this.gl.bindFramebuffer(t,null):e.initializeAndBind(t),n?this._state.readFramebuffer=je(e,null):this._state.drawFramebuffer=je(e,null))}blitFramebuffer(e,t,r=0,n=0,s=e.width,a=e.height,o=0,l=0,c=t.width,u=t.height,d=Ai.COLOR_BUFFER_BIT,m=Kt.NEAREST){this.bindFramebufferSeparate(e,Kl.READ_FRAMEBUFFER),this.bindFramebufferSeparate(t,Kl.DRAW_FRAMEBUFFER),this.gl.blitFramebuffer(r,n,s,a,o,l,c,u,d,m)}bindBuffer(e,t){if(e)switch(t??(t=e.bufferType),t){case Mt.ARRAY_BUFFER:this._state.vertexBuffer=Ba(this.gl,e,t,this._state.vertexBuffer);break;case Mt.ELEMENT_ARRAY_BUFFER:this._state.indexBuffer=Ba(this.gl,e,t,this._state.indexBuffer);break;case Mt.UNIFORM_BUFFER:this._state.uniformBuffer=Ba(this.gl,e,t,this._state.uniformBuffer);break;case Mt.PIXEL_PACK_BUFFER:this._state.pixelPackBuffer=Ba(this.gl,e,t,this._state.pixelPackBuffer);break;case Mt.PIXEL_UNPACK_BUFFER:this._state.pixelUnpackBuffer=Ba(this.gl,e,t,this._state.pixelUnpackBuffer);break;case Mt.COPY_READ_BUFFER:this._state.copyReadBuffer=Ba(this.gl,e,t,this._state.copyReadBuffer);break;case Mt.COPY_WRITE_BUFFER:this._state.copyWriteBuffer=Ba(this.gl,e,t,this._state.copyWriteBuffer)}}bindRenderbuffer(e){const t=this.gl;e||(t.bindRenderbuffer(t.RENDERBUFFER,null),this._state.renderbuffer=null),this._state.renderbuffer!==e&&(t.bindRenderbuffer(t.RENDERBUFFER,e.glName),this._state.renderbuffer=e)}_getBufferBinding(e,t){if(t>=this.parameters.maxUniformBufferBindings||t<0)return console.error("Uniform buffer binding point is out of range!"),null;const r=this._state.uniformBufferBindingPoints;let n=r[t];return S(n)&&(n={buffer:null,offset:0,size:0},r[t]=n),n}bindBufferBase(e,t,r){const n=this._getBufferBinding(e,t);S(n)||n.buffer===r&&n.offset===0&&n.size===0||(this.gl.bindBufferBase(e,t,r?r.glName:null),n.buffer=r,n.offset=0,n.size=0)}bindBufferRange(e,t,r,n,s){const a=this._getBufferBinding(e,t);if(!S(a)&&!(a.buffer===r&&a.offset===n&&a.size===s)){if(n%this._parameters.uniformBufferOffsetAlignment!=0)return void console.error("Uniform buffer binding offset is not a multiple of the context offset alignment");this.gl.bindBufferRange(e,t,r.glName,n,s),a.buffer=r,a.offset=n,a.size=s}}bindUBO(e,t,r,n){S(t)?this.bindBufferBase(Mt.UNIFORM_BUFFER,e,null):(qd()&&(n??t.byteLength)>this._parameters.maxUniformBlockSize&&console.error("Attempting to bind more data than the maximum uniform block size"),t.initialize(),r!==void 0&&n!==void 0?this.bindBufferRange(Mt.UNIFORM_BUFFER,e,t.buffer,r,n):this.bindBufferBase(Mt.UNIFORM_BUFFER,e,t.buffer))}unbindUBO(e){for(let t=0,r=this._state.uniformBufferBindingPoints.length;t<r;t++){const n=this._state.uniformBufferBindingPoints[t];y(n)&&n.buffer===e.buffer&&this.bindBufferBase(Mt.UNIFORM_BUFFER,t,null)}}unbindBuffer(e){switch(e){case Mt.ARRAY_BUFFER:this._state.vertexBuffer=Ba(this.gl,null,e,this._state.vertexBuffer);break;case Mt.ELEMENT_ARRAY_BUFFER:this._state.indexBuffer=Ba(this.gl,null,e,this._state.indexBuffer);break;case Mt.UNIFORM_BUFFER:this._state.uniformBuffer=Ba(this.gl,null,e,this._state.uniformBuffer);break;case Mt.PIXEL_PACK_BUFFER:this._state.pixelPackBuffer=Ba(this.gl,null,e,this._state.pixelPackBuffer);break;case Mt.PIXEL_UNPACK_BUFFER:this._state.pixelUnpackBuffer=Ba(this.gl,null,e,this._state.pixelUnpackBuffer);break;case Mt.COPY_READ_BUFFER:this._state.copyReadBuffer=Ba(this.gl,null,e,this._state.copyReadBuffer);break;case Mt.COPY_WRITE_BUFFER:this._state.copyWriteBuffer=Ba(this.gl,null,e,this._state.copyWriteBuffer)}}bindVAO(e=null){S(e)?this._state.vertexArrayObject&&(this._state.vertexArrayObject.unbind(),this._state.vertexArrayObject=null):this._state.vertexArrayObject!==e&&(e.bind(),this._state.vertexArrayObject=e)}async clientWaitAsync(e=Rt(10)){const t=this.gl,r=t.fenceSync(mne.SYNC_GPU_COMMANDS_COMPLETE,0);if(!r)throw new Error("Client wait failed, could not create sync object");let n;this.instanceCounter.increment(Lb.Sync,r),t.flush();do await B0(e),n=t.clientWaitSync(r,0,0);while(n===L5.TIMEOUT_EXPIRED);if(this.instanceCounter.decrement(Lb.Sync,r),t.deleteSync(r),n===L5.WAIT_FAILED)throw new Error("Client wait failed")}getBoundFramebufferObject(e=Kl.FRAMEBUFFER){return e===Kl.READ_FRAMEBUFFER?this._state.readFramebuffer:this._state.drawFramebuffer}getBoundVAO(){return this._state.vertexArrayObject}resetState(){this.useProgram(null),this.bindVAO(null),this.bindFramebuffer(null,!0),this.unbindBuffer(Mt.ARRAY_BUFFER),this.unbindBuffer(Mt.ELEMENT_ARRAY_BUFFER),Ca(this.gl)&&(this.unbindBuffer(Mt.UNIFORM_BUFFER),this._state.uniformBufferBindingPoints.length=0,this.unbindBuffer(Mt.PIXEL_PACK_BUFFER),this.unbindBuffer(Mt.PIXEL_UNPACK_BUFFER),this.unbindBuffer(Mt.COPY_READ_BUFFER),this.unbindBuffer(Mt.COPY_WRITE_BUFFER));for(let e=0;e<this.parameters.maxTextureImageUnits;++e)this.bindTexture(null,e);this.setBlendingEnabled(!1),this.setBlendFunction(de.ONE,de.ZERO),this.setBlendEquation(Cw.ADD),this.setBlendColor(0,0,0,0),this.setFaceCullingEnabled(!1),this.setCullFace(tg.BACK),this.setFrontFace(LG.CCW),this.setPolygonOffsetFillEnabled(!1),this.setPolygonOffset(0,0),this.setScissorTestEnabled(!1),this.setScissorRect(0,0,this.gl.canvas.width,this.gl.canvas.height),this.setDepthTestEnabled(!1),this.setDepthFunction(hs.LESS),this.setDepthRange(0,1),this.setStencilTestEnabled(!1),this.setStencilFunction(hs.ALWAYS,0,0),this.setStencilOp(x0.KEEP,x0.KEEP,x0.KEEP),this.setClearColor(0,0,0,0),this.setClearDepth(1),this.setClearStencil(0),this.setColorMask(!0,!0,!0,!0),this.setStencilWriteMask(4294967295),this.setDepthWriteEnabled(!0),this.setViewport(0,0,this.gl.canvas.width,this.gl.canvas.height)}enforceState(){var n,s,a;const e=this.gl,t=this.capabilities.vao;t&&t.bindVertexArray(null);for(let o=0;o<this.parameters.maxVertexAttributes;o++)e.disableVertexAttribArray(o);if(this._state.vertexBuffer?e.bindBuffer(this._state.vertexBuffer.bufferType,this._state.vertexBuffer.glName):e.bindBuffer(Mt.ARRAY_BUFFER,null),this._state.indexBuffer?e.bindBuffer(this._state.indexBuffer.bufferType,this._state.indexBuffer.glName):e.bindBuffer(Mt.ELEMENT_ARRAY_BUFFER,null),Ca(e)){this._state.uniformBuffer?e.bindBuffer(this._state.uniformBuffer.bufferType,this._state.uniformBuffer.glName):e.bindBuffer(Mt.UNIFORM_BUFFER,null);for(let o=0;o<this._parameters.maxUniformBufferBindings;o++){const l=this._state.uniformBufferBindingPoints[o];if(y(l)){const{buffer:c,offset:u,size:d}=l;c!==null?u===0&&d===0?e.bindBufferBase(Mt.UNIFORM_BUFFER,o,c.glName):e.bindBufferRange(Mt.UNIFORM_BUFFER,o,c.glName,u,d):e.bindBufferBase(Mt.UNIFORM_BUFFER,o,null)}}this._state.pixelPackBuffer?e.bindBuffer(this._state.pixelPackBuffer.bufferType,this._state.pixelPackBuffer.glName):e.bindBuffer(Mt.PIXEL_PACK_BUFFER,null),this._state.pixelUnpackBuffer?e.bindBuffer(this._state.pixelUnpackBuffer.bufferType,this._state.pixelUnpackBuffer.glName):e.bindBuffer(Mt.PIXEL_UNPACK_BUFFER,null),this._state.copyReadBuffer?e.bindBuffer(this._state.copyReadBuffer.bufferType,this._state.copyReadBuffer.glName):e.bindBuffer(Mt.COPY_READ_BUFFER,null),this._state.copyWriteBuffer?e.bindBuffer(this._state.copyWriteBuffer.bufferType,this._state.copyWriteBuffer.glName):e.bindBuffer(Mt.COPY_WRITE_BUFFER,null),e.bindFramebuffer(Kl.READ_FRAMEBUFFER,null),e.readBuffer(e.BACK),this._state.readFramebuffer&&(e.bindFramebuffer(Kl.READ_FRAMEBUFFER,this._state.readFramebuffer.glName),e.readBuffer(fne.COLOR_ATTACHMENT0)),e.bindFramebuffer(Kl.DRAW_FRAMEBUFFER,((n=this._state.drawFramebuffer)==null?void 0:n.glName)??null)}else this._state.readFramebuffer=this._state.drawFramebuffer,e.bindFramebuffer(Kl.FRAMEBUFFER,((s=this._state.drawFramebuffer)==null?void 0:s.glName)??null);if(t&&this._state.vertexArrayObject){const o=this._state.vertexArrayObject;this._state.vertexArrayObject&&(this._state.vertexArrayObject.unbind(),this._state.vertexArrayObject=null),this.bindVAO(o)}e.useProgram(((a=this._state.program)==null?void 0:a.glName)??null),e.blendColor(this._state.blendColor.r,this._state.blendColor.g,this._state.blendColor.b,this._state.blendColor.a),e.bindRenderbuffer(e.RENDERBUFFER,this._state.renderbuffer?this._state.renderbuffer.glName:null),this._state.blend===!0?e.enable(this.gl.BLEND):e.disable(this.gl.BLEND),e.blendEquationSeparate(this._state.blendEquation.mode,this._state.blendEquation.modeAlpha),e.blendFuncSeparate(this._state.blendFunction.srcRGB,this._state.blendFunction.dstRGB,this._state.blendFunction.srcAlpha,this._state.blendFunction.dstAlpha),e.clearColor(this._state.clearColor.r,this._state.clearColor.g,this._state.clearColor.b,this._state.clearColor.a),e.clearDepth(this._state.clearDepth),e.clearStencil(this._state.clearStencil),e.colorMask(this._state.colorMask.r,this._state.colorMask.g,this._state.colorMask.b,this._state.colorMask.a),e.cullFace(this._state.cullFace),e.depthFunc(this._state.depthFunction),e.depthRange(this._state.depthRange.zNear,this._state.depthRange.zFar),this._state.depthTest===!0?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),e.depthMask(this._state.depthWrite),e.frontFace(this._state.frontFace),e.lineWidth(1),this._state.faceCulling===!0?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),e.polygonOffset(this._state.polygonOffset[0],this._state.polygonOffset[1]),this._state.polygonOffsetFill===!0?e.enable(e.POLYGON_OFFSET_FILL):e.disable(e.POLYGON_OFFSET_FILL),e.scissor(this._state.scissorRect.x,this._state.scissorRect.y,this._state.scissorRect.width,this._state.scissorRect.height),this._state.scissorTest===!0?e.enable(e.SCISSOR_TEST):e.disable(e.SCISSOR_TEST),e.stencilFunc(this._state.stencilFunction.func,this._state.stencilFunction.ref,this._state.stencilFunction.mask),e.stencilOpSeparate(this._state.stencilOperation.face,this._state.stencilOperation.fail,this._state.stencilOperation.zFail,this._state.stencilOperation.zPass),this._state.stencilTest===!0?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),e.stencilMask(this._state.stencilWriteMask);for(let o=0;o<this.parameters.maxTextureImageUnits;o++){e.activeTexture(rA+o),e.bindTexture(vi.TEXTURE_2D,null),e.bindTexture(vi.TEXTURE_CUBE_MAP,null),Ca(e)&&(e.bindTexture(vi.TEXTURE_3D,null),e.bindTexture(vi.TEXTURE_2D_ARRAY,null));const l=this._state.textureUnitMap[o];y(l)&&e.bindTexture(l.descriptor.target,l.glName)}e.activeTexture(rA+this._state.activeTexture);const r=this._state.viewport;e.viewport(r.x,r.y,r.width,r.height),this.resetInfo()}_loadExtensions(){this.type===Nn.WEBGL1&&this.gl.getExtension("OES_element_index_uint"),this.gl.getExtension("KHR_parallel_shader_compile")}_loadParameters(e){const t=this.capabilities.textureFilterAnisotropic,r=e.maxAnisotropy??1/0,n=Ca(this.gl),s=this.gl,a={versionString:this.gl.getParameter(this.gl.VERSION),maxVertexTextureImageUnits:this.gl.getParameter(this.gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxVertexAttributes:this.gl.getParameter(this.gl.MAX_VERTEX_ATTRIBS),maxMaxAnisotropy:t?Math.min(this.gl.getParameter(t.MAX_TEXTURE_MAX_ANISOTROPY),r):1,maxTextureImageUnits:this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),maxTextureSize:this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE),maxUniformBufferBindings:n?s.getParameter(s.MAX_UNIFORM_BUFFER_BINDINGS):0,maxVertexUniformBlocks:n?s.getParameter(s.MAX_VERTEX_UNIFORM_BLOCKS):0,maxFragmentUniformBlocks:n?s.getParameter(s.MAX_FRAGMENT_UNIFORM_BLOCKS):0,maxUniformBlockSize:n?s.getParameter(s.MAX_UNIFORM_BLOCK_SIZE):0,uniformBufferOffsetAlignment:n?s.getParameter(s.UNIFORM_BUFFER_OFFSET_ALIGNMENT):1,maxArrayTextureLayers:n?s.getParameter(s.MAX_ARRAY_TEXTURE_LAYERS):1,maxSamples:n?s.getParameter(s.MAX_SAMPLES):1};return Gi.TEXTURE_UNIT_FOR_UPDATES=a.maxTextureImageUnits-1,a}};function Ba(i,e,t,r){return e?r!==e&&i.bindBuffer(t,e.glName):i.bindBuffer(t,null),e}function zB(i,e){switch(i){case Dt.POINTS:return 2*e;case Dt.TRIANGLES:return e/3;case Dt.TRIANGLE_STRIP:case Dt.TRIANGLE_FAN:return e-2;default:return 0}}let k3e=class extends N3e{constructor(e,t,r){super(e,t),this.newCache=r,this._refCount=1}dispose(){--this._refCount>0||super.dispose()}ref(){++this._refCount}bindTechnique(e,t,r,n){return this.useProgram(e.program),e.bindPipelineState(this,r==null?void 0:r.slot,n),e.program.bindPass(t,r),e.program}get test(){return this.programCache.test}},Ly=class extends ue{constructor(e,t,r){super({}),this._stage=e,this._techniqueRepository=t,this._rctx=r,this._textures=new Map,this._loadingCount=0,this._frameUpdates=new Map,this.events=new nn,this._frameTask=e.resourceController.scheduler.registerTask(dr.TEXTURE_UNLOAD)}normalizeCtorArgs(){return{}}dispose(){this._frameTask.remove(),this._stage.forEachOfType(gv.Texture,e=>e.unload())}get updating(){return this._loadingCount>0||this._frameTask.updating}get textureTechnique(){return S(this._textureTechnique)&&(this._textureTechnique=this._techniqueRepository.acquire(g4,new _4)),this._textureTechnique}acquire(e){const t=this._textures.get(e);return t?(t.ref(),je(t.loadingPromise,t)):this._createNewRef(e)}update(){let e=!1;this._frameUpdates.forEach(t=>{const r=t.texture.frameUpdate(this._rctx,this.textureTechnique,t.previousToken);r>=0&&r!==t.previousToken&&(t.previousToken=r,e=!0)}),e&&this.events.emit("changed",vr.BACKGROUND)}_createNewRef(e){const t=this._stage.getObject(e);if(S(t))return it(t!==void 0),null;const r=t.events.on("unloaded",()=>{r.remove(),this._onTextureUnloaded(e)}),n=new V3e(e,()=>{this._frameTask.schedule(()=>{n.isUnreferenced&&t.unload()})});return this._textures.set(e,n),n.ref(),y(t.glTexture)?(this._updateGLTexture(n,t.glTexture),t.requiresFrameUpdates&&this._frameUpdates.set(e,{texture:t,previousToken:-1}),n):(this._loadingCount++,n.loadingPromise=this._stage.schedule(()=>{const s=t.load(this._rctx,()=>this.textureTechnique),a=l=>(this._loadingCount--,n.loadingPromise=null,this._updateGLTexture(n,l),t.requiresFrameUpdates&&this._frameUpdates.set(e,{texture:t,previousToken:-1}),n),o=l=>(this._loadingCount--,n.loadingPromise=null,yo(l)||J.getLogger(this.declaredClass).error(l),null);return Mx(s)?s.then(a,o):a(s)}),n.loadingPromise)}_updateGLTexture(e,t){e.glTexture=t,this.events.emit("changed",vr.UPDATE)}_onTextureUnloaded(e){this._textures.delete(e),this._frameUpdates.delete(e)}};h([p()],Ly.prototype,"_loadingCount",void 0),h([p()],Ly.prototype,"_frameTask",void 0),h([p()],Ly.prototype,"updating",null),Ly=h([D("esri.views.3d.webgl-engine.lib.TextureRepository")],Ly);let V3e=class{constructor(e,t){this.id=e,this._release=t,this._refCount=0}get isUnreferenced(){return this._refCount===0}ref(){++this._refCount}release(){--this._refCount,this._refCount>0||(this._refCount!==0?(J.getLogger("esri.views.3d.webgl-engine.lib.TextureRepository.RefCountedTextureImpl").error("Cannot dereference texture that has no references!"),this._refCount=0):this._release())}};const U3e="esri.views.3d.webgl-engine.materials.internal.WaterTextureRepository";let xb=class extends ue{constructor(){super(...arguments),this._passParameters=new z3e,this._loading=0}get passParameters(){return this._passParameters}dispose(){this._passParameters.waveNormal=Me(this._passParameters.waveNormal),this._passParameters.wavePertubation=Me(this._passParameters.wavePertubation)}get updating(){return this._loading>0}ensureResources(e){if(this._loading>0)return bS.LOADING;if(y(this._passParameters.waveNormal)&&y(this._passParameters.wavePertubation))return bS.LOADED;const t={target:vi.TEXTURE_2D,pixelFormat:yt.RGBA,dataType:qt.UNSIGNED_BYTE,wrapMode:si.REPEAT,samplingMode:Kt.LINEAR_MIPMAP_LINEAR,hasMipmap:!0,maxAnisotropy:8};return++this._loading,Mg(cI("esri/images/materials/water/normals.jpg")).then(r=>this._passParameters.waveNormal=new Gi(e,{...t,width:r.width,height:r.height},r)).catch(r=>J.getLogger(this.declaredClass).error("Failed to load water material normal texture.",r)).finally(()=>--this._loading),++this._loading,Mg(cI("esri/images/materials/water/perturbation.jpg")).then(r=>this._passParameters.wavePertubation=new Gi(e,{...t,width:r.width,height:r.height},r)).catch(r=>J.getLogger(this.declaredClass).error("Failed to load water material pertubation texture.",r)).finally(()=>--this._loading),bS.LOADING}};h([p()],xb.prototype,"_loading",void 0),h([p({type:Boolean,readOnly:!0})],xb.prototype,"updating",null),xb=h([D(U3e)],xb);class z3e extends Ir{}let B3e=class{constructor(e,t){this.viewCamera=e,this.frameHasDecorations=t}},G3e=class extends IR{constructor(e,t,r,n){super(),this._rctx=e,this._renderFunctions=t,this._forceCameraHook=r,this._disposeOffscreenBuffers=n,this.supersample=!0,this._screenshotQueue=new Array}dispose(){this._rctx=null}async takeScreenshot(e){await this._renderFunctions.prepareOverlay(),this._renderFunctions.requestRenderScene(vr.BACKGROUND);const t=Ix();return this._screenshotQueue.push({settings:e,resolver:t}),t.promise}update(e,t){for(const r of this._screenshotQueue){if(this.isDisposed){r.resolver.reject();continue}const n={...r.settings,pixelRatio:r.settings.pixelRatio*e.viewCamera.pixelRatio},s=this._renderScreenshot(e,n,t);r.resolver(s)}this._screenshotQueue.length=0}_renderScreenshotOverlay(e,t,r){e.width=t.width,e.height=t.height;const n=e.getContext("2d"),s=r.pixelRatio;return n.save(),n.translate(0,t.height),n.scale(1,-1),r.region&&n.translate(-r.region.x,-r.region.y),n.scale(s,s),t=this._renderFunctions.renderOverlay(e,t),n.restore(),t}_readbackScreenshot(e,t){return e.resample?this._readbackScreenshotResampled(e,t):this._readbackScreenshotImmediate(e,t)}_readbackScreenshotResampled(e,t){const{framebufferWidth:r,framebufferHeight:n,region:s,resample:a}=e,o=this._ensureScreenshotEncodeCanvas();let l=nA(r,n,o);this._rctx.gl.readPixels(0,0,r,n,yt.RGBA,um.UNSIGNED_BYTE,new Uint8Array(l.data.buffer)),t(),l=this._renderScreenshotOverlay(o,l,{...e,region:null});const c=nA(s.width,s.height,o);return yme(l,c,!0,a.region.x,n-(a.region.y+a.region.height),a.region.width,a.region.height)}_readbackScreenshotImmediate(e,t){const{framebufferHeight:r,region:n}=e,s=this._ensureScreenshotEncodeCanvas(),a=nA(n.width,n.height,s);return this._rctx.gl.readPixels(n.x,r-(n.y+n.height),n.width,n.height,yt.RGBA,um.UNSIGNED_BYTE,new Uint8Array(a.data.buffer)),t(),this._renderScreenshotOverlay(s,a,e)}_renderScreenshot(e,t,r){let n=null,s=null;const a=e.viewCamera,{framebufferWidth:o,framebufferHeight:l}=t;let c=!1;const u=t.disableDecorations&&e.frameHasDecorations,d=o!==a.fullWidth||l!==a.fullHeight,m=t.ignorePadding&&a.pixelRatio!==t.pixelRatio,f=d||u||m||t.objectAndLayerIdColor;if(t.objectAndLayerIdColor&&(s=new yn(this._rctx,{width:o,height:l,colorTarget:Vn.TEXTURE,depthStencilTarget:rs.DEPTH_STENCIL_RENDER_BUFFER})),f){const b=a.clone();if(t.ignorePadding){const T=xD(b.padding);for(let E=0;E<4;E++)T[E]=Math.round(T[E]/b.pixelRatio*t.pixelRatio);b.padding=T}b.fullWidth=o,b.fullHeight=l,b.pixelRatio=t.pixelRatio;const v=a.fovX-b.fovX,w=a.fovY-b.fovY;v<0&&v<w?b.fovX=a.fovX:w<0&&w<v&&(b.fovY=a.fovY),this._forceCameraHook(b),c=!0,n=new yn(this._rctx,{width:b.fullWidth,height:b.fullHeight,colorTarget:Vn.TEXTURE,depthStencilTarget:rs.DEPTH_STENCIL_RENDER_BUFFER}),this._renderFunctions.renderScene(n,s,b,t.disableDecorations?Pw.OFF:Pw.ON,r),this._disposeOffscreenBuffers()}const _=()=>{this._rctx.bindFramebuffer(null),Me(n)},g=this._readbackScreenshot(t,_);_();let x=null;if(t.objectAndLayerIdColor){const b=()=>{this._rctx.bindFramebuffer(null),Me(s)};this._rctx.bindFramebuffer(s),x=this._readbackScreenshot(t,b),this._rctx.bindFramebuffer(null),b()}if(f&&!this._rctx.contextAttributes.alpha)for(let b=3;b<g.data.length;b+=4)g.data[b]=255;if(x&&!this._rctx.contextAttributes.alpha)for(let b=3;b<x.data.length;b+=4)x.data[b]=255;return c&&this._forceCameraHook(a),[g,x]}_ensureScreenshotEncodeCanvas(){return this._screenshotEncodeCanvas||(this._screenshotEncodeCanvas=document.createElement("canvas")),this._screenshotEncodeCanvas}},Rn=class extends MR(ue){constructor(e){super({}),this.events=new nn,this.waterTextureRepository=new xb,this._magnifierHelper=new Iy,this._objectAndLayerIdRenderHelper=St("enable-feature:objectAndLayerId-rendering")?new NMe:null,this._needsUpdate=!0,this._needsRender=!0,this._idleSuspend=!0,this._needsWaterReflectionUpdate=!1,this._lastAnimationUpdate=0,this._container=e.container,this._viewingMode=e.viewingMode,this._initializeContext(e),z(()=>{var r;return(r=this.waterTextureRepository)==null?void 0:r.updating},()=>this.requestRender(),Qe),this._magnifierHelper.events.on("request-render",()=>this.requestRender()),this._stippleTextureRepository=new oH(this._rctx),this._shaderTechniqueRepository=new xY({rctx:this._rctx,viewingMode:e.viewingMode,stippleTextureRepository:this._stippleTextureRepository,waterTextureRepository:this.waterTextureRepository}),this._textureRepository=new Ly(e,this._shaderTechniqueRepository,this._rctx),this._textureRepository.events.on("changed",r=>this.requestRender(r)),this._materialRepository=new TY(this._textureRepository,this._shaderTechniqueRepository,()=>this.requestRender(),()=>this.requestRender()),this._compositingHelper=new fMe(this._rctx,this._shaderTechniqueRepository),this._renderer=new Hu(this._materialRepository,this._textureRepository,this._shaderTechniqueRepository,this._rctx,this._compositingHelper,this._magnifierHelper,r=>this.requestRender(r),(r,n)=>e.schedule(r,n),e);const t={renderScene:(r,n,s,a,o)=>this._renderer.render(r,n,{camera:s,contentCamera:s,mode:Fh.IDLE},a,o),requestRenderScene:r=>this.requestRender(r),prepareOverlay:()=>e.options.screenshot.prepareOverlay(),renderOverlay:(r,n)=>e.options.screenshot.renderOverlay(r,n)};this._screenshotManager=new G3e(this._rctx,t,r=>this.events.emit("force-camera-for-screenshot",r),()=>this._renderer.disposeOffscreenBuffers()),this._registerFrameTask(e)}normalizeCtorArgs(){return{}}dispose(){this._container.contains(this._canvas)&&this._container.removeChild(this._canvas),this._frameTask=Os(this._frameTask),this._shaderTechniqueRepository=Me(this._shaderTechniqueRepository),super.dispose(),this._tmpDepthBuffer=null,this._rctx=null}get performanceInfo(){const e=this._rctx.gl;return{renderer:this._renderer.performanceInfo,textureMemory:e.getUsedTextureMemory!==void 0?e.getUsedTextureMemory():void 0,renderbufferMemory:e.getUsedRenderbufferMemory!==void 0?e.getUsedRenderbufferMemory():void 0,VBOMemory:e.getUsedVBOMemory!==void 0?e.getUsedVBOMemory():void 0}}requestRender(e=vr.UPDATE){this._needsRender=!0,e===vr.UPDATE&&(this._needsUpdate=!0)}get updating(){return this._needsUpdate||this._needsWaterReflectionUpdate||this._renderer.updating||this._textureRepository.updating||this.waterTextureRepository.updating||this._magnifierHelper.updating}ensureEdgeView(){return this._renderer.ensureEdgeView()}get edgeView(){return this._renderer.edgeView}get textureRepository(){return this._textureRepository}get compositingHelper(){return this._compositingHelper}set magnifier(e){this._magnifierHelper.magnifier=e}setRenderParameters(e){e.idleSuspend!==void 0&&this._idleSuspend!==!!e.idleSuspend&&(this._idleSuspend=!!e.idleSuspend,this.requestRender()),this._renderer.setRenderParameters(e)}get renderingContext(){return this._rctx}get capabilities(){return this._rctx.capabilities}modify(e){this._renderer.modify(e),e.clear()}get canvas(){return this._canvas}takeScreenshot(e){return this._screenshotManager.takeScreenshot(e).then(t=>t[0])}takeScreenshotWithOID(e){return e.objectAndLayerIdColor=!0,this._screenshotManager.takeScreenshot(e)}getAlpha(){return this._rctx.contextAttributes.alpha}get shadowsEnabled(){return this._renderer.shadowsEnabled}readAccumulatedShadow(e){return this._renderer.readAccumulatedShadow(e[0],e[1])}readHUDVisibility(e,t,r,n,s){this._renderer.readHUDVisibility(e,t,r,n,s)}getMinimalDepthForArea(e,t,r,n,s,a=s){const o=n.constrainWindowSize(t,r,s*n.pixelRatio,a*n.pixelRatio),l=this._ensureDepthBuffer(o);this._renderer.readDepthPixels(n,o,l);let c=Number.MAX_VALUE;for(let u=0;u<o[2]*o[3];u++){const d=bMe(4*u,l,n.nearFar);c>d&&d!==n.nearFar[0]&&d!==n.nearFar[1]&&(c=d)}if(y(e)){const u=e.pickDepth(t*n.pixelRatio,r*n.pixelRatio,n);y(u)&&c>u&&u!==n.nearFar[0]&&u!==n.nearFar[1]&&(c=u)}return c===Number.MAX_VALUE?void 0:c}_ensureDepthBuffer(e){const t=4*e[2]*e[3];return(S(this._tmpDepthBuffer)||this._tmpDepthBuffer.byteLength<t)&&(this._tmpDepthBuffer=new Uint8Array(t)),this._tmpDepthBuffer}get renderPlugins(){return this._renderer.renderPlugins}get test(){return{renderer:this._renderer}}get gpuMemoryUsage(){return this._renderer.gpuMemoryUsage}async reloadShaders(){DK(),await this._shaderTechniqueRepository.reloadAll(),this.requestRender()}get animationTimestep(){return this._renderer.animationTimestep}_registerFrameTask(e){const t=e.state;let r=!1,n=vr.BACKGROUND,s=!1;const a={preRender:({time:o})=>{r=this.updating,n=this._needsUpdate?vr.UPDATE:vr.BACKGROUND,e.processSyncLayers(),(o-this._lastAnimationUpdate>this.animationTimestep||y(t.forcedAnimationTime)||r||this._needsRender)&&(o=je(t.forcedAnimationTime,o),this._renderer.updateAnimation({camera:t.camera,time:o})&&this.requestRender(vr.BACKGROUND),this._lastAnimationUpdate=o)},render:({time:o})=>{if((this._needsRender||!this._idleSuspend||!this._renderer.isCameraFinal||this._needsWaterReflectionUpdate)&&t.camera.fullWidth>0&&t.camera.fullHeight>0){const l=this._needsUpdate&&this._idleSuspend&&this._renderer.isCameraFinal;this._needsRender=!1,this._needsUpdate=!1,this._needsWaterReflectionUpdate=!1,this._renderer.render(null,null,t,Pw.ON,o),s=!0,l&&this._renderer.hasWaterReflection&&(this.requestRender(vr.BACKGROUND),this._needsWaterReflectionUpdate=!0)}},update:({time:o})=>{const l=new B3e(t.camera,this._renderer.hasSlicePlane||this._magnifierHelper.enabled);this._textureRepository.update(),this._screenshotManager.update(l,o)},finish:()=>{s&&(this._renderer.finish(t.mode===Fh.IDLE?n:vr.UPDATE),s=!1)}};this._frameTask=wd(a)}_initializeContext(e){const t=e.options;this._canvas=t.canvas,this._canvas||(this._canvas=document.createElement("canvas")),this._canvas.setAttribute("style","width: 100%; height:100%; display:block;");const r={alpha:t.alpha||!1,premultipliedAlpha:!0,antialias:!1,depth:!0,stencil:t.stencil==null||t.stencil,powerPreference:"high-performance",preserveDrawingBuffer:t.preserveDrawingBuffer??!1},n=jie("3d",this._canvas,r);if(S(n)){const s=St("esri-force-webgl");J.getLogger(this.declaredClass).error(s)}else this._rctx=this._newRenderingContext(n,e),this._loadShaderOnlyExtensions(),!t.alpha&&this._rctx.contextAttributes.alpha&&J.getLogger(this.declaredClass).error("WebGL context has alpha channel even though no alpha channel was requested"),!this._rctx.contextAttributes.alpha&&St("safari")>=11&&(this._container.style.backgroundColor="black"),this._container.appendChild(this._canvas)}_newRenderingContext(e,t){const r={disabledExtensions:t.options.deactivatedWebGLExtensions||{},debugWebGLExtensions:t.options.debugWebGLExtensions||{},maxAnisotropy:8},n=(s,a)=>t.resourceController.memoryController.newCache(s,a);return new k3e(e,r,n)}_loadShaderOnlyExtensions(){this._rctx.capabilities.enable("standardDerivatives"),this._rctx.capabilities.enable("shaderTextureLOD"),this._rctx.capabilities.enable("textureFloat")}_getObjectAndLayerIdColor(e){return this._objectAndLayerIdRenderHelper?this._objectAndLayerIdRenderHelper.getObjectAndLayerIdColor(e):null}get componentObjectCollection(){return S(this._componentObjectCollection)&&(this._componentObjectCollection=new sMe(this._renderer.renderPassManager,this._viewingMode)),this._componentObjectCollection}set componentObjectCollection(e){this._componentObjectCollection=e}};h([p({type:Boolean,readOnly:!0})],Rn.prototype,"updating",null),h([Yn()],Rn.prototype,"_rctx",void 0),h([Yn()],Rn.prototype,"_container",void 0),h([Yn()],Rn.prototype,"_canvas",void 0),h([Yn()],Rn.prototype,"_stippleTextureRepository",void 0),h([Yn(),p()],Rn.prototype,"waterTextureRepository",void 0),h([Yn(),p()],Rn.prototype,"_magnifierHelper",void 0),h([p()],Rn.prototype,"_objectAndLayerIdRenderHelper",void 0),h([Yn(),p()],Rn.prototype,"_textureRepository",void 0),h([Yn()],Rn.prototype,"_compositingHelper",void 0),h([Yn()],Rn.prototype,"_renderer",void 0),h([Yn()],Rn.prototype,"_screenshotManager",void 0),h([Yn()],Rn.prototype,"componentObjectCollection",null),h([Yn()],Rn.prototype,"_componentObjectCollection",void 0),h([p()],Rn.prototype,"_needsUpdate",void 0),h([p()],Rn.prototype,"_needsWaterReflectionUpdate",void 0),Rn=h([D("esri.views.3d.webgl-engine.parts.RenderView")],Rn);var bE;let ga=bE=class extends MR(ue){constructor(i){super(i),this._handles=new Ft,this._model=new gE,this._layers=new Zt,this._changeSet=new OY,this._layerSyncSet=new Set}initialize(){this._set("renderView",new Rn(this)),this._frameTask=this.resourceController.scheduler.registerTask(dr.STAGE,this),this._handles.add(this._frameTask)}destroy(){jg.pool.prune(0),this._handles.destroy(),this.dispose()}get viewingMode(){return this.state.viewingMode}get updating(){return this._model.dirtySet.dirty||this.renderView.updating||this._frameTask.updating}add(i){this._model.add(i),iP(i)&&(i.attachStage(this),this._addLayer(i)),this.renderView.requestRender()}remove(i){S(i)||(this.renderView.requestRender(),this._model.remove(i),iP(i)&&(this._removeLayer(i),i.detachStage()))}addMany(i){y(i)&&(this._model.addMany(i),this.renderView.requestRender())}removeMany(i){y(i)&&(this._model.removeMany(i),this.renderView.requestRender())}async load(i){S(i)||(Array.isArray(i)||(i=[i]),await Promise.all(i.filter(e=>S(e.glTexture)).map(e=>this.schedule(()=>this._model.has(e)?e.load(this.renderView.renderingContext,()=>this.renderView.textureRepository.textureTechnique):null))))}loadImmediate(i){return i.load(this.renderView.renderingContext,()=>this.renderView.textureRepository.textureTechnique)}forEachOfType(i,e){this._model.forEachOfType(i,e)}handleEvent(i,e){this.destroyed||(this._model.dirtySet[i](e),this.renderView.requestRender())}get running(){return this._model.dirtySet.dirty}runTask(i){this._frameTask.processQueue(i),i.done||this._commit()}_commit(){const i=this._model.dirtySet;bE.DebugSettings.logDirtySet&&console.log("Dirty set: "+i.formatDebugInfo()),i.commit(this._changeSet),bE.DebugSettings.logDirtySet&&(console.log("RGs add: "+this._changeSet.adds.map(e=>e.id)),console.log("RGs remove: "+this._changeSet.removes.map(e=>e.id))),this._layerSyncSet.clear(),this.renderView.modify(this._changeSet),this.renderView.requestRender()}schedule(i,e){return this._frameTask.schedule(i,e)}syncLayer(i){this._layerSyncSet.add(i),this.renderView.requestRender()}processSyncLayers(){const i=this._model.dirtySet;this._layers.forAll(e=>{(this._layerSyncSet.has(e.id)||e.updatePolicy===zE.SYNC)&&(i.commitLayer(e.id,this._changeSet),this._layerSyncSet.delete(e.id))});for(const e of this._layerSyncSet)i.commitLayer(e,this._changeSet);this._layerSyncSet.clear(),this.renderView.modify(this._changeSet)}getObject(i){return this._model.getObject(i)}get layers(){return this._layers}_addLayer(i){this._layers.includes(i)||this._layers.push(i)}_removeLayer(i){this._commit(),this._layers.removeUnordered(i)!=null&&(this._model.dirtySet.getResidentRenderGeometries(i.id,this._changeSet.removes),this.renderView.modify(this._changeSet))}addRenderPlugin(i,e,t){const r=this.renderView.renderPlugins.add(i,e,t),n=()=>{pz(e)&&this.sceneIntersectionHelper.addIntersectionHandler(e)};if(Mx(r))return r.then(n);n()}removeRenderPlugin(i){pz(i)&&this.sceneIntersectionHelper.removeIntersectionHandler(i),this.renderView.renderPlugins.remove(i)}get performanceInfo(){return{renderView:this.renderView.performanceInfo,model:this._model.getStats()}}get test(){const i=this;return{getCount:e=>i._model.test.content.filter(t=>t.type===e).length,model:i._model}}};ga.DebugSettings={endFrameContentValidation:!1,logDirtySet:!1},h([p({constructOnly:!0})],ga.prototype,"resourceController",void 0),h([p({constructOnly:!0})],ga.prototype,"options",void 0),h([p({constructOnly:!0})],ga.prototype,"state",void 0),h([p({constructOnly:!0})],ga.prototype,"sceneIntersectionHelper",void 0),h([p({readOnly:!0})],ga.prototype,"viewingMode",null),h([p({constructOnly:!0})],ga.prototype,"container",void 0),h([p({constructOnly:!0})],ga.prototype,"renderSR",void 0),h([p({constructOnly:!0})],ga.prototype,"_handles",void 0),h([p({readOnly:!0})],ga.prototype,"updating",null),h([p({constructOnly:!0})],ga.prototype,"_model",void 0),h([Yn(),p()],ga.prototype,"renderView",void 0),ga=bE=h([D("esri.views.3d.webgl-engine.Stage")],ga);function gee(i){return hu(i)&&i.intersector===Ui.PCL&&!!i.target}function jR(i){return hu(i)&&i.intersector===Ui.I3S&&!!i.target}function H3e(i){return hu(i)&&i.intersector===Ui.TERRAIN&&!!i.target}function _ee(i){return hu(i)&&i.intersector===Ui.OVERLAY&&!!i.target}function q4(i){return hu(i)&&i.intersector===Ui.LOD&&!!i.target}function BB(i,e){var t;return vR(i)||bR(i)?Ex(i.target.object.metadata,e):H3e(i)?(t=e.map)==null?void 0:t.ground:gee(i)||jR(i)||_ee(i)?Ex(i.target,e):null}function eHe(i,e){const t=L$(i,e);return y(t)&&t.type==="graphic"?t.graphic:null}function L$(i,e){if(S(i))return null;if(vR(i)||bR(i))return GB(i.target.object.metadata,e);if(gee(i)){const t=i.target.createGraphic();return{type:"graphic",graphic:t,layer:t.layer}}return _ee(i)||q4(i)?GB(i.target,e):jR(i)?j3e(i.target,e):null}function GB(i,e){if(S(i)||S(i.graphicUid))return null;const t=Ex(i,e);if(S(t))return null;if(t===e.graphics)return S(e.graphicsView)||typeof i.graphicUid!="number"?null:e.graphicsView.getHit(i.graphicUid);const r=e.allLayerViews.find(n=>n.layer===t);return!r||r.suspended||S(i.graphicUid)?null:"getHit"in r?r.getHit(i.graphicUid):null}function j3e(i,e){const t=Ex(i,e);if(S(t))return null;const r=e.allLayerViews.find(n=>n.layer===t);return r&&!r.suspended&&"getGraphicFromIntersectorTarget"in r?W3e(r.getGraphicFromIntersectorTarget(i)):null}function q3e(i,e){const t=Ex(i,e);if(S(t))return null;const r=e.allLayerViews.find(n=>n.layer===t);return r&&!r.suspended&&"getAABBFromIntersectorTarget"in r?r.getAABBFromIntersectorTarget(i):null}function W3e(i){return y(i)?{type:"graphic",graphic:i,layer:i.layer}:null}function Ex(i,e){return S(i.layerUid)?null:y(e.graphicsView)&&i.layerUid===e.graphicsView.processor.layer.id?e.graphics:e.map.findLayerByUid(i.layerUid)}function tHe(i,e){if(vR(i)||bR(i))return sG(i.target.object.boundingVolumeWorldSpace.bounds);if(q4(i)){_re(oS,i.transformation);const t=Math.max(oS[0],oS[1],oS[2]);return i.target.baseBoundingSphere.radius*t}return jR(i)?co(q3e(i.target,e),t=>.5*KG(t)):null}function iHe(i){return!vR(i)&&!bR(i)&&(q4(i)?i.target.numLodLevels>1:!!jR(i))}const oS=R();async function X3e(i,e){if(i.type==="2d")return i.hitTest(e);const t=await i.hitTest(e);if(t.results.length===0)return t;const r=t.results[0],n=y(r.distance)?r.distance*(1+Q3e):r.distance,s=t.results.findIndex(a=>a.distance>n);return s!==-1&&(t.results=t.results.slice(0,s)),t}const Q3e=.05;let wE=class extends eX{constructor(e){super(e),this.components=["attribution","zoom","navigation-toggle","compass"]}};h([p()],wE.prototype,"components",void 0),wE=h([D("esri.views.ui.3d.DefaultUI3D")],wE);const yee=wE;let Oe=class extends Dq(aW(oW(xW))){constructor(i){super(i),this._userClippingArea=null,this._clippingArea=null,this._initialDefaultSpatialReference=null,this._defaults={},this._externallySet={environment:!1},this._createGraphicsViewController=null,this._resolveWhenReady=[],this._propertiesPool=new Od({slicePlane:WX},this),this._resourceController=mPe(this),this._defaultToMapOptions={include:new Set},this._defaultHitTestOptions={exclude:new Set},this.deconflictor=new QL({view:this}),this.labeler=new Uf({view:this,deconflictor:this.deconflictor.labels}),this.sharedSymbolResources=null,this.analyses=new nv,this.basemapTerrain=null,this.elevationProvider=null,this.canvas=null,this.constraints=new Jf,this.environmentManager=new sc,this.floors=new pt,this.fullOpacity=1,this.graphicsView=null,this.analysisViewManager=new B_e({view:this}),this.groundView=null,this.map=null,this.screenSizePerspectiveEnabled=!0,this.state=new G2e,this.spatialReference=null,this.alphaCompositingEnabled=!1,this.preserveDrawingBufferEnabled=!1,this.supersampleScreenshotsEnabled=!0,this.type="3d",this.ui=new yee,this._numUpdating=0,this._lastUpdateTime=0,this.updatingProgress=.5,this.highlightOptions=new u$,this.voxelWasm=null,this.voxelWasmPromise=null,S7(),i&&i.environment||(this._defaults.environment=new Py,this.environment=this._defaults.environment);const e=(t=null)=>{y(t)&&t.type===o5.MOVE||(this._updatingChanged(),this.map&&this.map.allLayers.forEach(async r=>{try{await r.when()}catch{}this._updatingChanged()}))};this.handles.add([wr(()=>{var t;return(t=this.map)==null?void 0:t.allLayers},"after-changes",t=>e(t),{onListenerAdd:()=>e(),onListenerRemove:()=>e(),sync:!0}),this.allLayerViews.on("after-changes",t=>this._updateUpdatingMonitors(t)),z(()=>this.map,t=>{t&&"load"in t&&t.load&&t.load().catch(()=>{})})]),this.inputManager=new bwe({view:this}),this.stateManager=new Xr({view:this})}initialize(){this.groundView=new U_e({view:this}),this._updateUpdatingMonitors();const i=()=>this._updateDefaultToMapOptions();this.handles.add(wr(()=>{var e;return(e=this.map)==null?void 0:e.allLayers},"after-changes",i,{onListenerAdd:i,onListenerRemove:i})),this.updatingHandles.add(()=>this.qualitySettings.memoryLimit,e=>{this.resourceController&&(this.resourceController.memoryController.maxMemory=e)},Qe),this.updatingHandles.add(()=>this.qualitySettings.additionalCacheMemory,e=>{this.resourceController&&(this.resourceController.memoryController.additionalCacheMemory=e)},Qe),this.updatingHandles.add(()=>this.qualitySettings.frameRate,e=>Iee(e>0?1e3/Math.ceil(e):0),Qe),this.updatingHandles.add(()=>{var e;return(e=this.map)==null?void 0:e.ground},i,Oi),this.updatingHandles.add(()=>{var e,t;return(t=(e=this.map)==null?void 0:e.ground)==null?void 0:t.opacity},()=>this._updateDefaultHitTestOptions(),Oi),this.handles.add(z(()=>this.spatialReference,()=>this.notifyChange("clippingArea"),ri))}destroy(){this.destroyed||(this.invalidate(),this.activeTool=null,this.layerViewManager.clear(),this._exitSurface(),this._disposeGraphicsView(),this.sharedSymbolResources=Te(this.sharedSymbolResources),this._set("labeler",Te(this.labeler)),this._set("deconflictor",Te(this.deconflictor)),this._resourceController=Te(this._resourceController),this._set("stateManager",Te(this.stateManager)),this._set("inputManager",Te(this.inputManager)),this.state.destroy(),this._propertiesPool.destroy(),this.handles.remove("updatingMonitors"),this._set("environmentManager",Te(this.environmentManager)),this.groundView=Te(this.groundView))}get renderSpatialReference(){return this.renderCoordsHelper&&this.renderCoordsHelper.spatialReference}get basemapSpatialReference(){var i;return(i=this.basemapTerrain)==null?void 0:i.spatialReference}get animation(){var i;return(i=this.state)==null?void 0:i.animation}get camera(){var i;return(i=this.stateManager)==null?void 0:i.camera}set camera(i){this.stateManager&&(this.stateManager.camera=i)}get contentCamera(){var i;return(i=this.stateManager)==null?void 0:i.contentCamera}set contentCamera(i){this.stateManager&&(this.stateManager.contentCamera=i)}installContentCameraReset(i={sticky:!1}){return this.stateManager.installContentCameraReset(i)}get center(){var i;return(i=this.stateManager)==null?void 0:i.center}set center(i){this.stateManager&&(this.stateManager.center=i)}get clippingArea(){if(this.viewingMode==="global")return null;let i=this._userClippingArea||this.get("map.clippingArea");return!(this._userClippingArea||this.get("map.clippingEnabled"))||S(i)?(this._clippingArea=null,null):i instanceof ui?this.spatialReference&&(i=lS(i,this.spatialReference),S(i))?(J.getLogger(this.declaredClass).error("#clippingArea","setting clippingArea with incompatible SpatialReference"),this._clippingArea):(i=i.clone(),S(i.intersection(this._groundAndLayersExtent))&&(i.xmin=i.xmax,i.ymin=i.ymax),i.zmin=void 0,i.zmax=void 0,i.equals(this._clippingArea)||(this._clippingArea=i),this._clippingArea):(J.getLogger(this.declaredClass).error("#clippingArea","only clippingArea geometries of type Extent are supported"),this._clippingArea)}set clippingArea(i){this.ready&&this.viewingMode==="global"&&y(i)?J.getLogger(this.declaredClass).error("#clippingArea=","Clipping area is only supported in local viewingMode"):this._userClippingArea=i}get renderDataExtent(){if(this.state.viewingMode===Se.Global)return null;const i=this.renderSpatialReference,e=this.dataExtent;return S(e)||S(i)||e.spatialReference.equals(i)?e:lS(e,i)}get dataExtent(){let i=this._groundAndLayersExtent;const e=this.spatialReference||Qt.WGS84,t=lS(this.clippingArea,e);y(t)&&(i=y(i)?i.intersection(t):t);const r=this._get("dataExtent");return y(i)&&i.equals(r)?r:i}get _groundAndLayersExtent(){const i=this.spatialReference||Qt.WGS84;let e;const t=s=>{const a=lS(s,i);S(a)||(y(e)?e.union(a):e=a.clone())},r=this.basemapTerrain;if(r!=null&&r.spatialReference){const s=r.groundExtent;t(new ui({xmin:s[0],ymin:s[1],zmin:0,xmax:s[2],ymax:s[3],zmax:0,spatialReference:r.spatialReference}))}if(this.map){const s=a=>{!y(a.fullExtent)||a.type==="graphics"&&a.internal||t(a.fullExtent)};this.map.allLayers.forEach(a=>s(a))}if(S(e))return null;e.hasZ?(e.zmin=Math.min(0,e.zmin),e.zmax=Math.max(0,e.zmax)):(e.zmin=0,e.zmax=0);const n=this._get("_groundAndLayersExtent");return e.equals(n)?n:e}set environment(i){i!==this._defaults.environment&&(this._externallySet.environment=!0),this._set("environment",i)}castEnvironment(i){return i?i instanceof Py?i:i instanceof mQ?this.environment!=null?this.environment.cloneWithWebsceneEnvironment(i):Py.fromWebsceneEnvironment(i):Ox(Py,i):new Py}get extent(){var i;return(i=this.stateManager)==null?void 0:i.extent}set extent(i){this.stateManager&&(this.stateManager.extent=i)}get screenCenter(){var i;return(i=this.stateManager)==null?void 0:i.screenCenter}get frustum(){var i;return(i=this.stateManager)==null?void 0:i.frustum}get initialExtentRequired(){return this.stateManager&&!this.stateManager.hasInitialView}get _defaultsFromMapSettings(){return{required:{tileInfo:!1,heightModelInfo:!0,extent:!1}}}get interacting(){return this.navigating||y(this.activeTool)}get stationary(){return!this.animation&&!this.resizing&&(S(this.state)||this.state.stationary)}get navigating(){var i;return((i=this.state)==null?void 0:i.navigating)??!1}get padding(){var i;return(i=this.stateManager)==null?void 0:i.padding}set padding(i){this.stateManager&&(this.stateManager.padding=i)}set qualityProfile(i){cE.isValidProfile(i)&&(cE.apply(i,this.qualitySettings),this._set("qualityProfile",i))}get qualityProfile(){return this._get("qualityProfile")||cE.getDefaultProfile()}set slicePlane(i){if(y(this._stage)&&this._stage.renderView.setRenderParameters({slicePlane:i}),S(i))return void this._set("slicePlane",null);const e=this._propertiesPool.get("slicePlane");o_(i,e),this._set("slicePlane",e)}get typeSpecificPreconditionsReady(){return!!this.viewingMode}get resolution(){return this.spatialReference!=null?Sre(this.scale,this.spatialReference):0}get scale(){var i;return(i=this.stateManager)==null?void 0:i.scale}set scale(i){this.stateManager&&(this.stateManager.scale=i)}get heightModelInfo(){const i=this.getDefaultHeightModelInfo();return i!=null?Fx.deriveUnitFromSR(i,this.spatialReference):null}get updating(){var r,n,s;if(this.destroyed)return!1;let i=0,e=this.layerViewManager.updating,t=e?this.layerViewManager.updatingRemaining:0;this.allLayerViews.forEach(a=>{if(a.isFulfilled()){if(a.updating){if(e=!0,a.suspended||vx(a))return;++t,i+=a.updatingProgress}}else++t});for(const a of[this.graphicsView,this.basemapView,this._resourceController,this._stage,this.featureTiles,this.pointsOfInterest,this.environmentManager,this.overlay,this._featureTreeDebugger,this.toolViewManager,this.analysisViewManager])y(a)&&a.updating&&(t+=.1,i+=.5*.1);for(const a of[this.deconflictor,this.labeler,this.basemapTerrain])y(a)&&a.updating&&(++t,i+=a.updatingProgress);if(e=!!(e||t>0||this.updatingHandles.updating||!this.ready||!this.stationary||this._createGraphicsViewController||(r=this.inputManager)!=null&&r.hasPendingInputs||(s=(n=this.map)==null?void 0:n.allLayers)!=null&&s.some(a=>!a.isFulfilled())),e?(this._numUpdating=Math.max(t,this._numUpdating),i+=this._numUpdating-t):this._numUpdating=0,this._numUpdating>0?i/=this._numUpdating:i=e?0:1,this._get("updatingProgress")!==i){const a=performance.now();if(i<1){const o=Math.min((a-this._lastUpdateTime)/2e3,1);i=this.updatingProgress*(1-o)+i*o}this._set("updatingProgress",i),this._lastUpdateTime=e&&i<1?a:0}return e}get viewingMode(){var t;const i=this._predeterminedViewingMode;if(y(i))return tA(i);const e=this.spatialReference;return e?y((t=this.defaultsFromMap)==null?void 0:t.viewingMode)&&e.equals(this.defaultsFromMap.spatialReference)?tA(this.defaultsFromMap.viewingMode):X2(e,Se.Global)?"global":"local":"global"}set viewingMode(i){this.ready?J.getLogger(this.declaredClass).error("#viewingMode","viewingMode cannot be set once view is ready"):this._overrideIfSome("viewingMode",i)}get viewpoint(){var i;return(i=this.stateManager)==null?void 0:i.viewpoint}set viewpoint(i){this.stateManager&&(this.stateManager.viewpoint=i)}get zoom(){var i;return(i=this.stateManager)==null?void 0:i.zoom}set zoom(i){this.stateManager&&(this.stateManager.zoom=i)}get resourceController(){return this._resourceController}get performanceInfo(){return new zPe(this)}on(i,e,t,r){return this.viewEvents.on(i,e,t,r)||super.on(i,e)}hasEventListener(i){return super.hasEventListener(i)||this.viewEvents.hasHandler(i)}toMap(i,e){if(!this.ready)return J.getLogger(this.declaredClass).error("#toMap()","Scene view cannot be used before it is ready"),null;const t=e?this.externalToInternalIntersectOptions(e):this._defaultToMapOptions,r=y(t.graphics)&&(y(t.graphics.include)||y(t.graphics.exclude)),n=S2(i)?C2(this,i):i,s=Dh(n);t.enableDraped=t.include&&!t.include.has(Ac)||t.exclude&&t.exclude.has(Ac);const a=this.sceneIntersectionHelper,o=Xl(this.state.viewingMode);if(o.options.selectionMode=!0,o.options.store=r?zn.ALL:zn.MIN,a.intersectIntersectorScreen(s,o,t),r){for(const l of o.results.all){const c=L$(l,this);if(S(c))return this._intersectResultToMapPoint(l);if(c.type!=="graphic"||this._testGraphicUidFilter(t.graphics,c.graphic))return this._intersectResultToMapPoint(l)}return null}return this._intersectResultToMapPoint(o.results.min)}toScreen(i){if(!this.ready)return J.getLogger(this.declaredClass).error("#toScreen()","Scene view cannot be used before it is ready"),null;const e=je(i.z==null&&Gh(this.elevationProvider,i),0);return bn(i,cy,this.renderSpatialReference,e),this.state.camera.projectToScreen(cy,KM),Ps(KM[0],KM[1])}pixelSizeAt(i){return this.ready?i?(bn(i,cy,this.renderSpatialReference),this.state.camera.computeScreenPixelSizeAt(cy)):0:(J.getLogger(this.declaredClass).error("#pixelSizeAt()","Scene view cannot be used before it is ready"),null)}overlayPixelSizeInMapUnits(i){const e=this.basemapTerrain.overlayManager;return e?e.overlayPixelSizeInMapUnits(i):1}hitTest(i,e){if(!this.ready)return J.getLogger(this.declaredClass).error("#hitTest()","Scene view cannot be used before it is ready"),null;const t=S2(i)?C2(this,i):i,r=zi(t.x,t.y),n=e?this.externalToInternalIntersectOptions(e):this._defaultHitTestOptions;n.requiresGroundFeedback=!0,n.enableDraped=!0;const s=Xl(this.state.viewingMode);s.options.selectionMode=!0,s.options.store=zn.ALL,this.sceneIntersectionHelper.intersectIntersectorScreen(r,s,n);const a=this._intersectResultsToHits(s.results.all,n.graphics),o=s.results.ground,l=BB(o,this),c=y(l)&&"type"in l&&l.type==="integrated-mesh"?l:null,u={screenPoint:t,results:a,ground:{mapPoint:this._intersectResultToMapPoint(o),distance:hu(o)?o.distanceInRenderSpace:0,layer:c}};return jt.SCENEVIEW_HITTEST_RETURN_INTERSECTOR&&(u.intersector=s),Promise.resolve(u)}async popupHitTest(i){const{results:e,ground:t}=await X3e(this,i);let r=null;return!(e.length===0||Math.abs(je(e[0].distance,0)-t.distance)<1e-5)||t.layer&&t.layer.type==="integrated-mesh"||(r=t.mapPoint),{results:e,screenPoint:i,mapPoint:r}}goTo(i,e){return this.updatingHandles.addPromise(this.stateManager.goTo(i,e))}async whenAnalysisView(i){if(S(i.parent))throw new K("view:no-analysisview-for-analysis","The analysis has not been added to view.analyses",{analysis:i});switch(i.parent.type){case"line-of-sight":case"dimension":return(await this.whenLayerView(i.parent)).whenAnalysisView();default:return this.analysisViewManager.whenAnalysisView(i)}}whenLayerView(i){return super.whenLayerView(i)}async takeScreenshot(i){const e=this._completeSettings(i);await this.whenReady();const t=await this._stage.renderView.takeScreenshot(e);return GS(t,e,this._pixelFormat())}async _takeScreenshot(i){const e=this._completeSettings(i);await this.whenReady();const t=await this._stage.renderView.takeScreenshot(e);return GW(t,this._pixelFormat())}_completeSettings(i){const e=pme(i,this);return e.pixelRatio/=this.state.pixelRatio,vme(e,this.supersampleScreenshotsEnabled,this.padding)}_pixelFormat(){return{flipY:!0,premultipliedAlpha:this._stage.renderView.getAlpha()}}get test(){return{takeScreenshot:i=>this._takeScreenshot(i)}}async takeScreenshotWithObjectAndLayerId(i){if(!St("enable-feature:objectAndLayerId-rendering"))throw new Error("has enable-feature:objectAndLayerId-rendering must be true");const e=this._completeSettings(i);await this.whenReady();const t=await this._stage.renderView.takeScreenshotWithOID(e),r=GS(t[0],e,this._pixelFormat()),n=this._completeSettings(i);return n.format="png",[r,GS(t[1],n,this._pixelFormat())]}getColorToObjectAndLayerIdMapping(){if(!St("enable-feature:objectAndLayerId-rendering"))throw new Error("has enable-feature:objectAndLayerId-rendering must be true");return this._stage.renderView._objectAndLayerIdRenderHelper.getColorToObjectAndLayerIdMapping()}addUpdatingPromise(i){return this.updatingHandles.addPromise(i)}importLayerView(i){return a6.importLayerView(i)}hasLayerViewModule(i){return a6.hasLayerViewModule(i)}forceDOMReadyCycle(){this.forceReadyCycle()}getDefaultSpatialReference(){var i,e,t,r;return this.map&&"initialViewProperties"in this.map&&((e=(i=this.map)==null?void 0:i.initialViewProperties)==null?void 0:e.spatialReference)||((t=this.defaultsFromMap)==null?void 0:t.spatialReference)||((r=this.defaultsFromMap)==null?void 0:r.ready)&&this._initialDefaultSpatialReference||null}async validate(){let i=XW(this.type);if(St("safari")&&St("safari")<9&&(i=new K("sceneview:browser-not-supported","This browser is not supported by SceneView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:St("safari")})),y(i))throw J.getLogger(this.declaredClass).warn("#validate()",i.message),i}get _predeterminedViewingMode(){var e;const i=this._isOverridden("viewingMode")?this._get("viewingMode"):(this.map&&"initialViewProperties"in this.map?(e=this.map.initialViewProperties)==null?void 0:e.viewingMode:null)??null;return y(i)?f5(i):null}getSpatialReferenceSupport({spatialReference:i,layer:e}){const t=this._predeterminedViewingMode;if(y(t))return this._validateSpatialReferenceForViewingMode(i,e,t)?{constraints:this._makeSpatialReferenceConstraints(i,e,t)}:null;const r=this._validateSpatialReferenceForViewingMode(i,e,Se.Local),n=this._validateSpatialReferenceForViewingMode(i,e,Se.Global);return r||n?r&&n?{constraints:this._makeSpatialReferenceConstraints(i,e,null)}:r?{constraints:this._makeSpatialReferenceConstraints(i,e,Se.Local)}:{constraints:this._makeSpatialReferenceConstraints(i,e,Se.Global)}:null}_validateSpatialReferenceForViewingMode(i,e,t){return!!X2(i,t)&&(!!S(e)||!!S5(e)||(!Ib(e)||!S(kR(e,i,t)))&&(!E5(e)||t!==Se.Global))}_makeSpatialReferenceConstraints(i,e,t){if(S(e))return[{spatialReference:i,viewingMode:t}];const r=i.isWebMercator,n=i.isWGS84;return S5(e)&&(r||n)?!n||t===Se.Local||O4(e.tileInfo,e.fullExtent,i,Se.Global)===null?[{spatialReference:i,viewingMode:t},{spatialReference:Qt.WebMercator,viewingMode:t}]:[{spatialReference:r?Qt.WGS84:Qt.WebMercator,viewingMode:t}]:Ib(e)||E5(e)||!r&&!n?Ib(e)&&r&&t!==Se.Global?[{spatialReference:i,viewingMode:t},{spatialReference:Qt.WGS84,viewingMode:Se.Local}]:[{spatialReference:i,viewingMode:t}]:[{spatialReference:i,viewingMode:t},{spatialReference:r?Qt.WGS84:Qt.WebMercator,viewingMode:t}]}_validateSpatialReference(i){const e=y(this.getSpatialReferenceSupport({spatialReference:i})),t=this._predeterminedViewingMode;return e||(y(t)?J.getLogger(this.declaredClass).warnOnce(`Spatial reference defined on view not supported in ${tA(t)} viewing mode.`):i.isGeographic&&J.getLogger(this.declaredClass).warnOnce("Spatial reference is geographic but not supported.")),e}whenReady(){return new Promise(i=>{this.ready?i(this):this._resolveWhenReady.push(i)})}computeMapPointFromVec3d(i,e){let t=this.spatialReference||Qt.WGS84;return ss(i,this.renderSpatialReference,i,t)||(t=Qt.WGS84,ss(i,this.renderSpatialReference,i,t)),e?(e.x=i[0],e.y=i[1],e.z=i[2],e.spatialReference=t):e=new Ne(i,t),e}trackGraphicState(i){if(!i.graphic)return J.getLogger(this.declaredClass).error("trackGraphicState","GraphicState.graphic must not be null or undefined to start tracking"),null;const e=this.getViewForGraphic(i.graphic);let t=null,r=!1;const n=s=>{var a;!r&&y(s)&&"processor"in s&&((a=s.processor)==null?void 0:a.type)==="graphics-3d"&&s.processor.graphicsCore&&(t=s.processor.graphicsCore.trackGraphicState(i))};return y(e)?n(e):this.whenViewForGraphic(i.graphic,{waitForLayer:!0}).then(s=>n(s),()=>{}).catch(()=>{}),{remove:()=>{r=!0,y(t)&&(t.remove(),t=null)}}}highlight(i){if(Array.isArray(i))return s5(i.map(t=>this.highlight(t)));if(pt.isCollection(i))return s5(i.toArray().map(t=>this.highlight(t)));const e=this.getViewForGraphic(i);return e&&"highlight"in e?e.highlight(i):uw()}maskOccludee(i){if(!i)return J.getLogger(this.declaredClass).error("maskOccludee","GraphicState.graphic must not be null or undefined to mask an occludee"),null;const e=this.getViewForGraphic(i);let t=null,r=!1;const n=s=>{!r&&y(s)&&fde(s)&&(t=s.maskOccludee(i))};return y(e)?n(e):this.whenViewForGraphic(i,{waitForLayer:!0}).then(s=>n(s),()=>{}).catch(()=>{}),{remove:()=>{r=!0,y(t)&&(t.remove(),t=null)}}}getViewForGraphic(i){return i.layer===this.graphics?this.graphicsView:i.layer?this.allLayerViews.find(e=>e.layer===i.layer):null}graphicChanged(i){y(this.graphicsView)&&this.graphicsView.graphicChanged(i)}async whenViewForGraphic(i,e){if(i.layer===this)return await Pm(()=>this.graphicsView),this.graphicsView;if(!i.layer||!this.map)throw new K("no-view-for-graphic");return e&&e.waitForLayer&&!this.map.allLayers.includes(i.layer)?new Promise((t,r)=>{const n=this.map.allLayers.on("change",s=>{s.added.includes(i.layer)&&(n.remove(),this.whenLayerView(i.layer).then(t,r))})}):this.whenLayerView(i.layer)}externalToInternalIntersectOptions(i){const e=this._externalToInternalRenderItems(i.include,cw.INCLUDE),t=this._externalToInternalRenderItems(i.exclude,cw.EXCLUDE);return{include:e.layerUids,exclude:t.layerUids,graphics:{include:e.graphicUids,exclude:t.graphicUids}}}_intersectResultToMapPoint(i,e){return i.getIntersectionPoint(cy)?(e=this.computeMapPointFromVec3d(cy,e),i.intersector===Ui.TERRAIN&&this.basemapTerrain&&(e.z=je(Gh(this.basemapTerrain,e),0)),e):null}_intersectResultsToHits(i,e){const t=new Array;let r=null;for(let n=0;n<i.length;n++){const s=i[n],a=BB(s,this);if(y(a)&&(a===this.map.ground||"type"in a&&a.type==="integrated-mesh"))break;const o=L$(s,this);if(S(o))continue;if(o.type==="graphic"){if(S(r)&&n!==i.length-1&&(r=new Set),y(r)){const u=this._getGraphicFilterUid(o.graphic);if(r.has(u))continue;r.add(u)}if(!this._testGraphicUidFilter(e,o.graphic))continue}const l=this._intersectResultToMapPoint(s),c=s.distanceInRenderSpace;t.push({...o,mapPoint:l,distance:c})}return t}_getGraphicFilterUid(i){const e=i.sourceLayer,t=i.layer,r=e&&"objectIdField"in e?e:t&&"objectIdField"in t?t:e;if(r){const n=r.objectIdField??tW,s=i.attributes[n];if(s)return`o-${r.id}-${s}`}return`u-${i.uid}`}_testGraphicUidFilter(i,e){const t=this._getGraphicFilterUid(e);return S(i)||(S(i.include)||i.include.has(t))&&(S(i.exclude)||!i.exclude.has(t))}_externalToInternalRenderItems(i,e,t={layerUids:null,graphicUids:null}){if(!i)return t;if(i instanceof jc)Z3e(t,this._getGraphicFilterUid(i)),e===cw.INCLUDE&&(y(this.graphicsView)&&i.layer===this?I1(t,this.graphicsView.processor.layer.id):i.layer&&I1(t,i.layer.uid));else if(eI(i))for(const r of i)r===this.graphics&&y(this.graphicsView)?I1(t,this.graphicsView.processor.layer.id):r===this.map.ground?I1(t,Ac):this._externalToInternalRenderItems(r,e,t);else"uid"in i&&I1(t,i.uid);return t}_initBasemapTerrain(){this._set("basemapTerrain",new gOe({view:this})),this._set("elevationProvider",new fb({view:this})),this.elevationProvider.register("ground",this.basemapTerrain)}_exitBasemapTerrain(){this.basemapTerrain&&(this.elevationProvider.unregister(this.basemapTerrain),this.elevationProvider.destroy(),this._set("elevationProvider",null),this.basemapTerrain.destroy(),this._set("basemapTerrain",null))}_initGlobe(){this._initCoordinateSystem(),this.state.createInitialCamera(),this._initBasemapTerrain(),this._set("pointsOfInterest",new vs({view:this})),this._set("featureTiles",new Mn({renderCoordsHelper:this.renderCoordsHelper,cameraOnSurface:this.pointsOfInterest.contentCameraOnSurface,focus:this.pointsOfInterest.focus,tilingSchemeOwner:this.basemapTerrain,viewState:this.state,scheduler:this._resourceController.scheduler,terrain:this.basemapTerrain}));const i=()=>{var t;const e=(t=this.basemapTerrain)==null?void 0:t.extent;if(this.clippingArea||e)if(e&&this.basemapTerrain.spatialReference){const r=y(this.basemapTerrain.extent)&&y(this.basemapTerrain.spatialReference)?Dd(J7(this.basemapTerrain.extent,this.basemapTerrain.spatialReference),this.spatialReference):null;y(this.clippingArea)?this.featureTiles.filterExtent=this.clippingArea.intersection(r):this.featureTiles.filterExtent=r}else this.featureTiles.filterExtent=this.clippingArea;else this.featureTiles.filterExtent=null};this.handles.add([this.updatingHandles.add(()=>jt.FEATURE_TILE_TREE_SHOW_TILES,e=>{e&&this.featureTiles&&!this._featureTreeDebugger?this.updatingHandles.addPromise(G(()=>import("./FeatureTileTree3DDebugger-e86d4e2f.js"),["assets/FeatureTileTree3DDebugger-e86d4e2f.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/reactiveUtils-4dabbb80.js","assets/HandleOwner-9b396af1.js","assets/TileTreeDebugger-36d5c9d2.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js"])).then(({FeatureTileTree3DDebugger:t})=>{!this._featureTreeDebugger&&jt.FEATURE_TILE_TREE_SHOW_TILES&&(this._featureTreeDebugger=new t({view:this}))}):e||!this._featureTreeDebugger||jt.FEATURE_TILE_TREE_SHOW_TILES||(this._featureTreeDebugger.destroy(),this._featureTreeDebugger=null)},Oi),this.updatingHandles.add(()=>this.clippingArea,i,Oi),this.updatingHandles.add(()=>this.basemapTerrain.extent,i,Oi)],"feature-tiles"),this.stateManager.init()}_exitGlobe(){this.state&&(this.stateManager.exit(),this.handles.remove("render-coords-helper"),this.handles.remove("feature-tiles"),this.featureTiles.destroy(),this._set("featureTiles",null),this.pointsOfInterest.destroy(),this._set("pointsOfInterest",null),this._exitBasemapTerrain(),this.state.exit(),this._exitCoordinateSystem())}_initCoordinateSystem(){if(this.spatialReference){const i=this.spatialReference;this.mapCoordsHelper&&this.mapCoordsHelper.spatialReference.equals(i)||this._set("mapCoordsHelper",new Z2e(this.map,i));const e=this.state.isGlobal,t=oQ(e,i);t!==this.renderSpatialReference&&(this._set("renderCoordsHelper",ePe.create(this.state.viewingMode,t)),e||this.handles.add(z(()=>{var r;return(r=this.basemapTerrain)==null?void 0:r.extent},r=>{const n=this.renderCoordsHelper.spatialReference;r&&(r[0]!==0||r[1]!==0||r[2]!==0||r[3]!==0)&&bP(r,this.basemapTerrain.spatialReference,HB,n)&&(this.renderCoordsHelper.extent=HB)},ri),"render-coords-helper"),this.sceneIntersectionHelper&&this.sceneIntersectionHelper.setTolerance(sv/this.renderCoordsHelper.unitInMeters))}else this._set("mapCoordsHelper",null),this._set("renderCoordsHelper",null)}_exitCoordinateSystem(){this.mapCoordsHelper&&(this.handles.remove("render-coords-helper"),this._set("renderCoordsHelper",null),this._set("mapCoordsHelper",null))}_updatingChanged(){this.notifyChange("updating")}_updateUpdatingMonitors(i=null){y(i)&&i.type===o5.MOVE||(this.handles.remove("updatingMonitors"),this.allLayerViews.forEach(e=>{e.destroyed||(this.handles.add(z(()=>[e.updating,e.updatingProgress],()=>this._updatingChanged(),ri),"updatingMonitors"),e.when(()=>this._updatingChanged(),()=>this._updatingChanged()))}),this._updatingChanged())}async _prepareScreenshotOverlay(){this.overlay&&await this.overlay.prepare()}_renderScreenshotOverlay(i,e){if(!this.overlay||!this.overlay.hasVisibleItems)return e;const t=i.getContext("2d");return t.putImageData(e,0,0),this.overlay.renderCanvas(i),t.getImageData(0,0,e.width,e.height)}_initStage(){const i={deactivatedWebGLExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions,alpha:this.alphaCompositingEnabled,preserveDrawingBuffer:this.preserveDrawingBufferEnabled,canvas:this.renderCanvas,screenshot:{prepareOverlay:()=>this._prepareScreenshotOverlay(),renderOverlay:(o,l)=>this._renderScreenshotOverlay(o,l)}},e=new H2e(this.state.viewingMode,o=>this._stage.layers.forAll(o),this);this._set("sceneIntersectionHelper",e);const t=eD(this.surface),{resourceController:r,state:n,renderSpatialReference:s}=this;this._stage=new ga({options:i,container:t,resourceController:r,state:n,sceneIntersectionHelper:e,renderSR:s}),this._stage.renderView.setRenderParameters({slicePlane:this.slicePlane}),this._lostWebGLContextHandle=cte(this._stage.renderView.canvas,"webglcontextlost",()=>this.fatalError=new K("webgl-context-lost")),this.handles.add([this.updatingHandles.add(()=>this.qualitySettings.antialiasingEnabled,()=>this._stage.renderView.setRenderParameters({antialiasingEnabled:this.qualitySettings.antialiasingEnabled}),Qe),this.updatingHandles.add(()=>this.qualitySettings.highQualityTransparency,()=>this._stage.renderView.setRenderParameters({highQualityTransparency:this.qualitySettings.highQualityTransparency}),Qe),z(()=>this.magnifier,o=>this._stage.renderView.magnifier=o,Oi)],"stage");const a=()=>{this._stage.renderView.setRenderParameters({defaultHighlightOptions:u$.toEngineOptions(this.highlightOptions)})};this.handles.add(this.updatingHandles.add(()=>[this.highlightOptions.color,this.highlightOptions.haloColor,this.highlightOptions.haloOpacity,this.highlightOptions.fillOpacity,this.highlightOptions.shadowOpacity,this.highlightOptions.shadowColor,this.highlightOptions.shadowDifference],a),"stage"),a(),this.renderCoordsHelper&&this.sceneIntersectionHelper.setTolerance(sv/this.renderCoordsHelper.unitInMeters),this._set("canvas",this._stage.renderView.canvas)}_exitStage(){this._set("sceneIntersectionHelper",null),this._stage.destroy(),this._stage=null,this._lostWebGLContextHandle.remove(),this._lostWebGLContextHandle=null,this.handles.remove("stage"),this._set("canvas",null)}_initSurface(i){this._exitSurface(),this.state.init(i,this.spatialReference),this._initStage(),this._initGlobe(),this.sharedSymbolResources=new HPe({view:this,viewingMode:i,resourceController:this._resourceController,pointsOfInterest:this.pointsOfInterest,viewState:this.state})}_exitSurface(){this.sharedSymbolResources&&(this.sharedSymbolResources.objectResourceCache.destroy(),this.sharedSymbolResources.destroy(),this.sharedSymbolResources=null,this._exitGlobe(),this._exitStage())}_createGraphicsViewIfNeeded(){if(this.graphicsView||this._createGraphicsViewController||this.graphics.length===0)return;this.handles.remove("graphics-view"),this._createGraphicsViewController=new AbortController;const i=()=>{this._createGraphicsViewController=null,this._updatingChanged()};this._createGraphicsViewAsync(this._createGraphicsViewController.signal).then(i,i),this._updatingChanged()}async _createGraphicsViewAsync(i){const e=(await G(()=>import("./GraphicsView3D-52797fe4.js"),["assets/GraphicsView3D-52797fe4.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Identifiable-bfe1ff30.js","assets/GraphicsProcessor-e3db4c8c.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/HandleOwner-9b396af1.js","assets/reactiveUtils-4dabbb80.js","assets/diffUtils-68b89c71.js","assets/Layer-5ffe0eda.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Graphics3DObjectStates-1e0ab5c6.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/MemCache-18a255ed.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/projection-290b739f.js","assets/mat4-44a0988f.js","assets/assets-8d3e737a.js","assets/zscale-89472cba.js","assets/dehydratedFeatures-0557137d.js","assets/byteSizeEstimations-f0cab514.js","assets/quantizationUtils-4dd81f85.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OptimizedFeature-4ab8d380.js","assets/optimizedFeatureQueryEngineAdapter-d72f082e.js","assets/centroid-5c988df3.js","assets/asyncUtils-437defc4.js","assets/PooledRBush-3e149119.js","assets/quickselect-322ec8e1.js","assets/ElevationInfo-215614d8.js","assets/basicInterfaces-19ed850e.js","assets/Scheduler-540208b6.js","assets/GraphicsView-d3b9d029.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/RelationshipQuery-0dda77ad.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])).default;xi(i),await Pm(()=>{var t;return(t=this.basemapTerrain)==null?void 0:t.ready},i),this._set("graphicsView",new e({view:this}))}_disposeGraphicsView(){this._createGraphicsViewController&&(this._createGraphicsViewController.abort(),this._createGraphicsViewController=null),this.handles.remove("graphics-view"),y(this.graphicsView)&&(this.handles.remove(this.graphicsView.processor.layer.id),this.graphicsView.destroy(),this._set("graphicsView",null))}_startup(){const i=f5(this.viewingMode);if(i===Se.Global&&(this._clippingArea=null),this._initSurface(i),this._set("ready",!0),this.handles.add(wr(()=>this.graphics,"after-changes",()=>this._createGraphicsViewIfNeeded()),"graphics-view"),this._createGraphicsViewIfNeeded(),!this._externallySet.environment){const t=this.get("map.initialViewProperties.environment");t&&(this.environment=t)}this.labeler.setup(),this.environmentManager.connectView(this),this.inputManager.connect();const e=this._resolveWhenReady;this._resolveWhenReady=[],e.forEach(t=>t(this))}_teardown(){this._initialDefaultSpatialReference=null,this.inputManager.disconnect(),this.environmentManager.disconnectView(),this.labeler.dispose(),this._disposeGraphicsView(),this.handles.remove("graphics-view"),this._exitSurface(),this._set("ready",!1)}_updateDefaultToMapOptions(){if(this._defaultToMapOptions.include.clear(),this.map){this.map.ground&&this._defaultToMapOptions.include.add(Ac);for(const i of this.map.allLayers.items)i.type==="integrated-mesh"&&this._defaultToMapOptions.include.add(i.uid)}}_updateDefaultHitTestOptions(){if(this._defaultHitTestOptions.exclude.clear(),this.map){this.map.ground&&this.map.ground.opacity<1&&this._defaultHitTestOptions.exclude.add(Ac);for(const i of this.map.allLayers.items)i.type==="integrated-mesh"&&i.opacity<1&&this._defaultToMapOptions.exclude.add(i.uid)}}addVoxelLayerViewToWasm(i){return S(this.voxelWasm)?(S(this.voxelWasmPromise)&&(this.voxelWasmPromise=G(()=>import("./VoxelWasmPerSceneView-fc0b261d.js"),["assets/VoxelWasmPerSceneView-fc0b261d.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/typedArrayUtil-4d7bb04c.js","assets/promiseUtils-1e54421e.js","assets/reactiveUtils-4dabbb80.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/Octree-0a267ea2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/sphere-2af0d852.js","assets/mathUtils-b4bb77e2.js","assets/vec4-790471c0.js","assets/mat4-44a0988f.js","assets/vec4f64-e407da96.js","assets/byteSizeEstimations-f0cab514.js","assets/mat3f64-c6305894.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/vec2f64-30dc1443.js","assets/plane-b575face.js","assets/Util-a48361c6.js","assets/assets-8d3e737a.js","assets/ViewingMode-5d7d590b.js","assets/Matrix3PassUniform-ad9f953b.js","assets/ShaderBuilder-a7d0da4e.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/mat3-3fc68e72.js","assets/aaBoundingBox-657a9b82.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/aaBoundingRect-193543b5.js","assets/BufferView-903d1848.js","assets/vec2-528adfe4.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/asyncUtils-437defc4.js","assets/enums-64ab819c.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/compilerUtils-18d58939.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/VisualVariablePassParameters-d460182b.js","assets/VertexAttribute-9c5c630d.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/basicInterfaces-19ed850e.js","assets/lineSegment-10422ca0.js","assets/Texture-46c8c2cb.js","assets/Evented-a45c8b0f.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/ScreenSpacePass-d5e48a9b.js","assets/Float4PassUniform-d7bdbc81.js","assets/Texture2DPassUniform-753de459.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/vec3f32-c9aa289f.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/symbolColorUtils-b2b55883.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/FloatPassUniform-68d54f51.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/NormalUtils.glsl-c12729bf.js","assets/HUD.glsl-d3a072ad.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]).then(e=>(this.voxelWasm=new e.default(this),this.voxelWasm))),this.voxelWasmPromise.then(e=>e.addVoxelLayer(i))):this.voxelWasm.addVoxelLayer(i)}removeVoxelLayerViewFromWasm(i){y(this.voxelWasm)&&this.voxelWasm.removeVoxelLayer(i)<1&&(this.voxelWasm=null,this.voxelWasmPromise=null)}};function I1(i,e){i.layerUids||(i.layerUids=new Set),i.layerUids.add(e)}function Z3e(i,e){i.graphicUids||(i.graphicUids=new Set),i.graphicUids.add(e)}function lS(i,e){return y(i)&&pv(i.spatialReference,e)?Dd(i,e):null}var cw;Oe.type="3d",h([p()],Oe.prototype,"_userClippingArea",void 0),h([p()],Oe.prototype,"_resourceController",void 0),h([p()],Oe.prototype,"_stage",void 0),h([p({readOnly:!0})],Oe.prototype,"deconflictor",void 0),h([p({readOnly:!0})],Oe.prototype,"labeler",void 0),h([p(pI(nv,"analyses"))],Oe.prototype,"analyses",void 0),h([p({type:Md,readOnly:!0})],Oe.prototype,"animation",null),h([p({readOnly:!0})],Oe.prototype,"basemapTerrain",void 0),h([p({readOnly:!0})],Oe.prototype,"elevationProvider",void 0),h([p()],Oe.prototype,"camera",null),h([p({type:al})],Oe.prototype,"contentCamera",null),h([p({readOnly:!0})],Oe.prototype,"canvas",void 0),h([p({type:Ne})],Oe.prototype,"center",null),h([p({type:ui})],Oe.prototype,"clippingArea",null),h([p({type:Jf})],Oe.prototype,"constraints",void 0),h([p({type:ui,readOnly:!0})],Oe.prototype,"renderDataExtent",null),h([p({type:ui,readOnly:!0})],Oe.prototype,"dataExtent",null),h([p({type:ui,readOnly:!0})],Oe.prototype,"_groundAndLayersExtent",null),h([p({value:null,type:Py})],Oe.prototype,"environment",null),h([qr("environment")],Oe.prototype,"castEnvironment",null),h([p({readOnly:!0})],Oe.prototype,"environmentManager",void 0),h([p({type:ui})],Oe.prototype,"extent",null),h([p()],Oe.prototype,"floors",void 0),h([p()],Oe.prototype,"screenCenter",null),h([p()],Oe.prototype,"frustum",null),h([p({type:Number,readOnly:!0})],Oe.prototype,"fullOpacity",void 0),h([p({readOnly:!0})],Oe.prototype,"graphicsView",void 0),h([p({readOnly:!0})],Oe.prototype,"analysisViewManager",void 0),h([p()],Oe.prototype,"groundView",void 0),h([p({type:Boolean})],Oe.prototype,"initialExtentRequired",null),h([p()],Oe.prototype,"_defaultsFromMapSettings",null),h([p()],Oe.prototype,"interacting",null),h([p()],Oe.prototype,"stationary",null),h([p()],Oe.prototype,"navigating",null),h([p()],Oe.prototype,"map",void 0),h([p({readOnly:!0})],Oe.prototype,"mapCoordsHelper",void 0),h([p()],Oe.prototype,"padding",null),h([p({type:vs,readOnly:!0})],Oe.prototype,"pointsOfInterest",void 0),h([p({type:Mn,readOnly:!0})],Oe.prototype,"featureTiles",void 0),h([p()],Oe.prototype,"_featureTreeDebugger",void 0),h([p({type:Boolean})],Oe.prototype,"screenSizePerspectiveEnabled",void 0),h([p({constructOnly:!0})],Oe.prototype,"deactivatedWebGLExtensions",void 0),h([p({constructOnly:!0})],Oe.prototype,"debugWebGLExtensions",void 0),h([p({constructOnly:!0})],Oe.prototype,"renderCanvas",void 0),h([p({constructOnly:!0})],Oe.prototype,"state",void 0),h([p({readOnly:!0})],Oe.prototype,"inputManager",void 0),h([p({readOnly:!0})],Oe.prototype,"stateManager",void 0),h([p({type:["low","medium","high"]})],Oe.prototype,"qualityProfile",null),h([p({type:fz,get(){let i=this._get("qualitySettings");return i||(i=new fz,cE.apply(this.qualityProfile,i)),i}})],Oe.prototype,"qualitySettings",void 0),h([p()],Oe.prototype,"slicePlane",null),h([p({readOnly:!0})],Oe.prototype,"typeSpecificPreconditionsReady",null),h([p({readOnly:!0})],Oe.prototype,"renderCoordsHelper",void 0),h([p({readOnly:!0})],Oe.prototype,"sceneIntersectionHelper",void 0),h([p({type:Number,dependsOn:["scale","spatialReference"],readOnly:!0})],Oe.prototype,"resolution",null),h([p({type:Number})],Oe.prototype,"scale",null),h([p()],Oe.prototype,"heightModelInfo",null),h([p()],Oe.prototype,"spatialReference",void 0),h([p({type:Boolean,constructOnly:!0})],Oe.prototype,"alphaCompositingEnabled",void 0),h([p({constructOnly:!0})],Oe.prototype,"preserveDrawingBufferEnabled",void 0),h([p({type:Boolean})],Oe.prototype,"supersampleScreenshotsEnabled",void 0),h([p({readOnly:!0})],Oe.prototype,"type",void 0),h([p({type:yee})],Oe.prototype,"ui",void 0),h([p({type:Boolean,readOnly:!0,dependsOn:["graphicsView.updating","basemapView.updating","basemapTerrain.updating","layerViewManager.updating","layerViewManager.updatingRemaining","_resourceController.updating","_stage.updating","featureTiles.updating","pointsOfInterest.updating","environmentManager.updating","overlay.updating","updatingHandles.updating","featureTreeDebugger.updating","labeler.updating","deconflictor.updating","ready","stationary","inputManager.hasPendingInputs","toolViewManager.updating","analysisViewManager.updating"]})],Oe.prototype,"updating",null),h([p({type:Number,readOnly:!0,dependsOn:["updating"]})],Oe.prototype,"updatingProgress",void 0),h([p({type:["global","local"]})],Oe.prototype,"viewingMode",null),h([p({type:rr})],Oe.prototype,"viewpoint",null),h([p({type:Number})],Oe.prototype,"zoom",null),h([p({type:u$})],Oe.prototype,"highlightOptions",void 0),Oe=h([D("esri.views.SceneView")],Oe),function(i){i[i.INCLUDE=0]="INCLUDE",i[i.EXCLUDE=1]="EXCLUDE"}(cw||(cw={}));const cy=R(),KM=zi(),HB=$t(),Y3e=Oe;let _a=class extends ue{constructor(e){super(e),this.precision=4,this.thumbsConstrained=!0}set effectiveMax(e){this.setEffectiveMax(e)}set effectiveMin(e){this.setEffectiveMin(e)}set labelFormatFunction(e){this._set("labelFormatFunction",e)}set inputFormatFunction(e){this._set("inputFormatFunction",e)}set inputParseFunction(e){this._set("inputParseFunction",e)}get labels(){const{max:e,min:t,values:r}=this,n=r&&r.length?r.map((s,a)=>this.getLabelForValue(s,"value",a)):[];return{max:this.getLabelForValue(e,"max"),min:this.getLabelForValue(t,"min"),values:n}}set max(e){this.setMax(e)}set min(e){this.setMin(e)}get state(){const{max:e,min:t}=this;return e!=null&&t!=null&&e>t?"ready":"disabled"}set values(e){const{max:t,min:r}=this,n=this.values;n&&e&&n.length===e.length&&n.every((s,a)=>s===e[a])||(this._set("values",null),e&&e.length&&(r!=null&&e.some(s=>s<r)&&(this.min=Math.min(...e)),t!=null&&e.some(s=>s>t)&&(this.max=Math.max(...e))),this._set("values",e))}toPrecision(e){return parseFloat(e.toFixed(this.precision))}defaultLabelFormatFunction(e){const{max:t,min:r,precision:n}=this,s=t!=null&&r!=null&&t-r>10?2:n;return parseFloat(e.toFixed(s)).toString()}defaultInputFormatFunction(e){return e.toString()}defaultInputParseFunction(e){return parseFloat(e)}getBounds(){const{effectiveMax:e,effectiveMin:t,max:r,min:n}=this;return{min:t!=null&&n!=null?Math.max(n,t):n,max:e!=null&&r!=null?Math.min(r,e):r}}getBoundsForValueAtIndex(e){const{thumbsConstrained:t,values:r}=this,{min:n,max:s}=this.getBounds();if(t&&r){const a=e-1,o=e+1;return{min:r[a]!=null?r[a]:n,max:r[o]!=null?r[o]:s}}return{min:n,max:s}}getLabelForValue(e,t,r){return e==null?null:this.labelFormatFunction?this.labelFormatFunction(e,t,r):this.defaultLabelFormatFunction(e)}setMax(e){const{max:t,values:r}=this;if(e==null)return void this._set("max",null);if(isNaN(e))return void this._logError("slider:invalid-value","Supplied value for property 'max' is NaN.");const n=this.toPrecision(e);if(t!==n&&(this._set("max",n),r&&r.length))for(let s=0;s<r.length;s++)n<r[s]&&this.setValue(s,n)}setMin(e){const{min:t,values:r}=this;if(e==null)return void this._set("min",null);if(isNaN(e))return void this._logError("slider:invalid-value","Supplied value for property 'min' is NaN.");const n=this.toPrecision(e);if(t!==n&&(this._set("min",n),r&&r.length))for(let s=0;s<r.length;s++)n>r[s]&&this.setValue(s,n)}setEffectiveMax(e){if(e==null)return void this._set("effectiveMax",null);if(isNaN(e))return void this._logError("slider:invalid-value","Supplied value for property 'effectiveMax' is NaN.");const t=this.toPrecision(e);this.effectiveMax!==t&&this._set("effectiveMax",this._applyBoundsToValue(t))}setEffectiveMin(e){if(e==null)return void this._set("effectiveMin",null);if(isNaN(e))return void this._logError("slider:invalid-value","Supplied value for property 'effectiveMin' is NaN.");const t=this.toPrecision(e);this.effectiveMin!==t&&this._set("effectiveMin",this._applyBoundsToValue(t))}setValue(e,t){if(isNaN(t))return void this._logError("slider:invalid-value","Supplied value for member of property 'values' is NaN.");const{values:r}=this;if(r==null)return void this._logError("slider:invalid-value","Supplied value for member of property 'values' is null.");const n=r[e],s=this.toPrecision(t);if(n===s)return;const a=[...r];a[e]=s,this._set("values",a),this.notifyChange("labels")}_applyBoundsToValue(e){const{max:t,min:r}=this;return r!=null&&e<r?r:t!=null&&e>t?t:e}_logError(e,t,r){J.getLogger(this.declaredClass).error(new K(e,t,r))}};h([p()],_a.prototype,"effectiveMax",null),h([p()],_a.prototype,"effectiveMin",null),h([p()],_a.prototype,"labelFormatFunction",null),h([p()],_a.prototype,"inputFormatFunction",null),h([p()],_a.prototype,"inputParseFunction",null),h([p({readOnly:!0})],_a.prototype,"labels",null),h([p()],_a.prototype,"max",null),h([p()],_a.prototype,"min",null),h([p()],_a.prototype,"precision",void 0),h([p({readOnly:!0})],_a.prototype,"state",null),h([p()],_a.prototype,"thumbsConstrained",void 0),h([p()],_a.prototype,"values",null),_a=h([D("esri.widgets.Slider.SliderViewModel")],_a);const K3e=_a,xt={base:"esri-slider",reversed:"esri-slider--reversed",horizontalLayout:"esri-slider--horizontal",verticalLayout:"esri-slider--vertical",contentElement:"esri-slider__content",extraContentElement:"esri-slider__extra-content",trackElement:"esri-slider__track",ticksContainerElement:"esri-slider__ticks",tickElement:"esri-slider__tick",tickLabelElement:"esri-slider__tick-label",maxElement:"esri-slider__max",minElement:"esri-slider__min",maxElementInteractive:"esri-slider__max--interactive",minElementInteractive:"esri-slider__min--interactive",rangeElementActive:"esri-slider__range--active",rangeInput:"esri-slider__range-input",anchorElement:"esri-slider__anchor",movingAnchorElement:"esri-slider__anchor--moving",lastMovedAnchorElement:"esri-slider__anchor--moved",anchorElementActive:"esri-slider__anchor--active",anchorElementIndexPrefix:"esri-slider__anchor-",segmentElement:"esri-slider__segment",segmentElementIndexPrefix:"esri-slider__segment-",segmentElementInteractive:"esri-slider__segment--interactive",segmentElementActive:"esri-slider__segment--active",effectiveSegmentElement:"esri-slider__effective-segment",effectiveMaxSegmentElement:"esri-slider__effective-max-segment",effectiveMinSegmentElement:"esri-slider__effective-min-segment",thumbElement:"esri-slider__thumb",labelElement:"esri-slider__label",labelElementInteractive:"esri-slider__label--interactive",labelInput:"esri-slider__label-input",esriWidget:"esri-widget",widgetIcon:"esri-icon-edit",disabled:"esri-disabled",hidden:"esri-hidden"},Ga={showInput:"Enter",hideInput1:"Enter",hideInput2:"Escape",hideInput3:"Tab",moveAnchorUp:"ArrowUp",moveAnchorDown:"ArrowDown",moveAnchorLeft:"ArrowLeft",moveAnchorRight:"ArrowRight",moveAnchorToMax:"End",moveAnchorToMin:"Home"},J3e="esri.widgets.Slider",jB={labels:!1,rangeLabels:!1};let zt=class extends Hn{constructor(e,t){super(e,t),this._activeLabelInputIndex=null,this._anchorElements=[],this._dragged=!1,this._dragStartInfo=null,this._focusedAnchorIndex=null,this._isMinInputActive=!1,this._isMaxInputActive=!1,this._lastMovedHandleIndex=null,this._positionPrecision=5,this._segmentDragStartInfo=null,this._trackHeight=null,this._trackWidth=null,this._zIndices=null,this._zIndexOffset=3,this.disabled=!1,this.draggableSegmentsEnabled=!0,this.effectiveSegmentElements=new pt,this.extraNodes=[],this.inputCreatedFunction=null,this.labelElements=new pt,this.labelInputsEnabled=!1,this.maxLabelElement=null,this.messages=null,this.minLabelElement=null,this.rangeLabelInputsEnabled=!1,this.segmentElements=new pt,this.snapOnClickEnabled=!0,this.steps=null,this.syncedSegmentsEnabled=!1,this.thumbCreatedFunction=null,this.thumbElements=new pt,this.tickElements=new pt,this.trackElement=null,this.viewModel=new K3e,this.visibleElements={...jB},this._onAnchorPointerDown=this._onAnchorPointerDown.bind(this),this._onAnchorPointerMove=this._onAnchorPointerMove.bind(this),this._onAnchorPointerUp=this._onAnchorPointerUp.bind(this),this._onLabelPointerDown=this._onLabelPointerDown.bind(this),this._onLabelPointerUp=this._onLabelPointerUp.bind(this),this._onSegmentPointerDown=this._onSegmentPointerDown.bind(this),this._onSegmentPointerMove=this._onSegmentPointerMove.bind(this),this._onSegmentPointerUp=this._onSegmentPointerUp.bind(this),this._onTrackPointerDown=this._onTrackPointerDown.bind(this),this._onTrackPointerMove=this._onTrackPointerMove.bind(this),this._onTrackPointerUp=this._onTrackPointerUp.bind(this)}destroy(){document.removeEventListener("pointerup",this._onLabelPointerUp),document.removeEventListener("pointermove",this._onLabelPointerMove),document.removeEventListener("pointerup",this._onAnchorPointerUp),document.removeEventListener("pointermove",this._onAnchorPointerMove),this.labelElements.removeAll(),this.labelElements.destroy(),this.segmentElements.removeAll(),this.segmentElements.destroy(),this.effectiveSegmentElements.removeAll(),this.effectiveSegmentElements.destroy(),this.thumbElements.removeAll(),this.thumbElements.destroy(),this.tickElements.removeAll(),this.tickElements.destroy()}get effectiveMax(){return this.viewModel.effectiveMax}set effectiveMax(e){this.viewModel.effectiveMax=e}get effectiveMin(){return this.viewModel.effectiveMin}set effectiveMin(e){this.viewModel.effectiveMin=e}get inputFormatFunction(){return this.viewModel.inputFormatFunction}set inputFormatFunction(e){this.viewModel.inputFormatFunction=e}get inputParseFunction(){return this.viewModel.inputParseFunction}set inputParseFunction(e){this.viewModel.inputParseFunction=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get labelFormatFunction(){return this.viewModel.labelFormatFunction}set labelFormatFunction(e){this.viewModel.labelFormatFunction=e}get labels(){return this.viewModel.labels}set layout(e){["vertical","vertical-reversed","horizontal","horizontal-reversed"].includes(e)||(e="horizontal"),this._set("layout",e)}get max(){return this.viewModel.max}set max(e){this.viewModel.max=e}get min(){return this.viewModel.min}set min(e){this.viewModel.min=e}get precision(){return this.viewModel.precision}set precision(e){this.viewModel.precision=e}get state(){const{_activeLabelInputIndex:e,_isMaxInputActive:t,_isMinInputActive:r,_dragStartInfo:n,_segmentDragStartInfo:s,disabled:a,viewModel:o}=this,l=y(n)||y(s);return a?"disabled":e===null&&!t&&!r?l?"dragging":o.state:"editing"}get thumbsConstrained(){return this.viewModel.thumbsConstrained}set thumbsConstrained(e){this.viewModel.thumbsConstrained=e}set tickConfigs(e){this._set("tickConfigs",e),this.scheduleRender()}get values(){return this.viewModel.values}set values(e){this.viewModel.values=e}castVisibleElements(e){return{...jB,...e}}render(){const{label:e}=this,t=this.classes(xt.base,xt.esriWidget,this._isHorizontalLayout()?xt.horizontalLayout:xt.verticalLayout,this._isReversedLayout()?xt.reversed:null,this._isDisabled()?xt.disabled:null);return this._storeTrackDimensions(),F("div",{"aria-label":e,class:t,"touch-action":"none",bind:this,afterCreate:this._afterContainerCreate},this.renderContent())}toNextStep(e){this._toStep(e,1)}toPreviousStep(e){this._toStep(e,-1)}renderContent(){const{max:e,min:t}=this;if(!(S(t)||S(e)||t>=e))return[this.renderMin(),this.renderSliderContainer(),this.renderMax()]}renderSliderContainer(){return F("div",{key:"slider-container",bind:this,class:xt.contentElement},this.renderTrackElement(),this.renderTicksContainer(),this.renderExtraContentElements())}renderTrackElement(){return F("div",{afterCreate:this._afterTrackCreate,afterRemoved:this._afterTrackRemoved,bind:this,class:xt.trackElement,"touch-action":"none"},this.renderEffectiveSegmentElements(),this.renderSegmentElements(),this.renderAnchorElements())}renderEffectiveSegmentElements(){if(!this.trackElement||!this.values||!this.values.length)return;const e=y(this.effectiveMax),t=y(this.effectiveMin);if(!e&&!t)return;const{max:r,min:n,viewModel:s}=this,a=s.getBounds(),o=[];return t&&o.push(this.renderEffectiveSegmentElement(n,a.min,!0)),e&&o.push(this.renderEffectiveSegmentElement(a.max,r,!1)),o}renderSegmentElements(){if(!this.trackElement||!this.values||!this.values.length)return;const e=this.values.length,t=[];for(let r=0;r<=e;r++)t.push(this.renderSegmentElement(r));return t}renderSegmentElement(e){const{_trackHeight:t,_trackWidth:r,draggableSegmentsEnabled:n,id:s,state:a,values:o}=this,l=this._isHorizontalLayout(),c=l?r:t,u=this.viewModel.getBounds(),d=this._positionFromValue(u.max),m=this._positionFromValue(u.min),f=e===o.length?null:e,_=e===0?null:e-1,g=y(f),x=y(_);let b,v;const w=[...o].sort((M,I)=>M-I);this._isReversedLayout()?(b=x?this._positionFromValue(w[_]):m,v=g?this._positionFromValue(w[f]):d):(b=g?this._positionFromValue(w[f]):d,v=x?this._positionFromValue(w[_]):m);const T=this._applyPrecisionToPosition(100*v/c),E=(b-v)/c,C=l?`transform: translate(${T}%, 0px) scale(${E}, 1);`:`transform: translate(0px, ${T}%) scale(1, ${E});`,A=this.classes(xt.segmentElement,xt.segmentElementIndexPrefix+e,n&&g&&x&&a!=="disabled"?xt.segmentElementInteractive:null);return F("div",{afterCreate:this._afterSegmentCreate,afterRemoved:this._afterSegmentRemoved,bind:this,class:A,"data-max-thumb-index":f,"data-min-thumb-index":_,"data-segment-index":e,key:`${s}-segment-${e}`,style:C,"touch-action":"none"})}renderEffectiveSegmentElement(e,t,r){const{_trackHeight:n,_trackWidth:s,layout:a}=this,o=this._positionFromValue(e),l=this._positionFromValue(t),c=this._isHorizontalLayout(),u=c?s:n,d=this._applyPrecisionToPosition(100*o/u);let m=null;if(a==="horizontal"){const g=r?u-l:l,x=o===u?0:d;m=`clip-path: inset(0% ${l===u?0:this._applyPrecisionToPosition(g/u*100)}% 0% ${x}%);`}else{const g=(l-o)/u;m=c?`transform: translate(${d}%, 0px) scale(${g}, 1);`:`transform: translate(0px, ${d}%) scale(1, ${g});`}const f=r?xt.effectiveMinSegmentElement:xt.effectiveMaxSegmentElement,_=this.classes(xt.segmentElement,xt.effectiveSegmentElement,f);return F("div",{afterCreate:this._afterEffectiveSegmentCreate,afterRemoved:this._afterEffectiveSegmentRemoved,bind:this,class:_,style:m,"touch-action":"none"})}renderAnchorElements(){const{trackElement:e,values:t}=this;if(t&&t.length)return this._zIndices=t.map((r,n)=>{const s=this._positionFromValue(r),a=this._positionToPercent(s),o=(this._isHorizontalLayout()?a>50:a<50)?-1:1;return this._zIndexOffset+(t.length+o*n)}),e&&t&&t.length?t.map((r,n)=>this.renderAnchorElement(r,n)):null}renderAnchorElement(e,t){const r=this._positionFromValue(e),n=this._valueFromPosition(r);if(S(n)||isNaN(n))return;const{_dragStartInfo:s,_lastMovedHandleIndex:a,id:o,layout:l,values:c,visibleElements:{labels:u}}=this,d=s&&s.index===t,m=a===t,f=this.classes(xt.anchorElement,xt.anchorElementIndexPrefix+t,d?xt.movingAnchorElement:null,m?xt.lastMovedAnchorElement:null),_=this.labels.values[t],g=this._getStyleForAnchor(e,t,d||m),{min:x,max:b}=this.viewModel.getBoundsForValueAtIndex(t),{disabled:v,messages:w}=this,T=c.length===2?gc(t===0?w.rangeMinimum:w.rangeMaximum,{value:e}):_,E=c.length===1?null:t===0?`${o}-handle-${t+1}`:t===c.length-1?`${o}-handle-${t-1}`:`${o}-handle-${t-1} ${o}-handle-${t+1}`;return F("div",{afterCreate:this._afterAnchorCreate,afterUpdate:this._afterAnchorUpdate,afterRemoved:this._afterAnchorRemoved,"aria-controls":E,"aria-label":w.sliderValue,"aria-labelledby":u?`${o}-label-${t}`:null,"aria-orientation":l,"aria-valuemax":b.toString(),"aria-valuemin":x.toString(),"aria-valuenow":e.toString(),"aria-valuetext":T,bind:this,class:f,"data-thumb-index":t,"data-value":e,id:`${o}-handle-${t}`,key:`${o}-handle-${t}`,onkeydown:this._onAnchorKeyDown,"touch-action":"none",role:"slider",style:g,tabIndex:v?-1:0},F("span",{afterCreate:this._afterThumbCreate,afterRemoved:this._afterThumbRemoved,bind:this,class:xt.thumbElement,"data-thumb-index":t,"touch-action":"none"}),this.renderThumbLabel(t))}renderThumbLabel(e){const{id:t,labels:r,labelInputsEnabled:n,state:s}=this,a=this.visibleElements.labels,o=r.values[e],l=this.classes(xt.labelElement,a?null:xt.hidden,n&&s!=="disabled"?xt.labelElementInteractive:null);return F("span",{afterCreate:this._afterLabelCreate,afterRemoved:this._afterLabelRemoved,"aria-hidden":(!a).toString(),bind:this,class:l,"data-thumb-index":e,key:`${t}-label-${e}`,id:`${t}-label-${e}`,role:n?"button":null,"touch-action":"none"},this._activeLabelInputIndex===e?this.renderValueInput(e):o)}renderValueInput(e){const{disabled:t,values:r}=this,n=r[e];return F("input",{key:`value-input-${e}`,afterCreate:this._afterInputCreate,"aria-label":this.messages.sliderValue,bind:this,class:xt.labelInput,"data-input-type":"thumb","data-input-index":e,required:!0,tabIndex:t?-1:0,type:"text",value:this._formatInputValue(n,"value",e),onblur:this._onLabelInputBlur,onkeydown:this._onInputKeyDown})}renderMax(){const{_isMaxInputActive:e,labels:t,rangeLabelInputsEnabled:r,state:n}=this,s=this.visibleElements.rangeLabels,a=this.classes(xt.maxElement,{[xt.hidden]:!s,[xt.maxElementInteractive]:r&&n!=="disabled",[xt.rangeElementActive]:e});return F("div",{"aria-hidden":(!s).toString(),afterCreate:this._afterMaxLabelCreate,bind:this,class:a,onclick:this._onMaxLabelClick,onkeydown:this._onMaxLabelKeyDown,role:r?"button":null,tabIndex:!this.disabled&&r?0:-1},e?this.renderMaxInput():t.max)}renderMin(){const{_isMinInputActive:e,labels:t,rangeLabelInputsEnabled:r,state:n}=this,s=this.visibleElements.rangeLabels,a=this.classes(xt.minElement,{[xt.hidden]:!s,[xt.minElementInteractive]:r&&n!=="disabled",[xt.rangeElementActive]:e});return F("div",{"aria-hidden":(!s).toString(),afterCreate:this._afterMinLabelCreate,bind:this,class:a,onclick:this._onMinLabelClick,onkeydown:this._onMinLabelKeyDown,role:r?"button":null,tabIndex:!this.disabled&&r?0:-1},e?this.renderMinInput():t.min)}renderMaxInput(){return F("input",{afterCreate:this._afterInputCreate,"aria-label":this.messages.maximumValue,bind:this,class:xt.rangeInput,"data-input-type":"max",required:!0,tabIndex:this.disabled?-1:0,type:"text",value:this._formatInputValue(this.max,"max"),onblur:this._onMaxInputBlur,onkeydown:this._onInputKeyDown})}renderMinInput(){return F("input",{afterCreate:this._afterInputCreate,"aria-label":this.messages.minimumValue,bind:this,class:xt.rangeInput,"data-input-type":"min",required:!0,tabIndex:this.disabled?-1:0,type:"text",value:this._formatInputValue(this.min,"min"),onblur:this._onMinInputBlur,onkeydown:this._onInputKeyDown})}renderExtraContentElements(){return F("div",{bind:this,class:xt.extraContentElement},this.extraNodes)}renderTicksContainer(){if(this.tickConfigs&&this.trackElement&&(this._trackHeight!==0||this._trackWidth!==0))return this.tickConfigs.map((e,t)=>F("div",{key:"ticks-container",class:this.classes(xt.ticksContainerElement)},this.renderTicks(e,t)))}renderTicks(e,t){const{mode:r,values:n}=e;if(this.tickElements.getItemAt(t)||this.tickElements.add(new pt,t),r==="position"){const o=Array.isArray(n)?n:[n];return this._calculateTickPositions(o).map((l,c)=>this.renderTickGroup(e,c,t,l))}if(r==="percent"&&Array.isArray(n)){const{max:o,min:l}=this,c=o-l,u=n.map(d=>this._applyPrecisionToPosition(d/100*c+l));return this._calculateTickPositions(u).map((d,m)=>this.renderTickGroup(e,m,t,d))}const s=Array.isArray(n)&&n.length?n[0]:isNaN(n)?null:n,a=this._getTickCounts(s,e);return this._calculateEquidistantTickPositions(a).map((o,l)=>this.renderTickGroup(e,l,t,o))}renderTickGroup(e,t,r,n){const s=e.mode==="position"?Array.isArray(e.values)?e.values[t]:e.values:this._valueFromPosition(n);if(!S(s)&&!isNaN(s))return F("div",{afterCreate:this._afterTickGroupCreate,afterRemoved:this._afterTickGroupRemoved,bind:this,"data-config":e,"data-position":n,"data-tick-config-index":r,"data-tick-group-index":t,"data-value":s,onclick:this._onTickGroupClick,key:`tick-group-${t}`},this.renderTickLine(e,t,r,s),e.labelsVisible?this.renderTickLabel(e,t,r,s):null)}renderTickLine(e,t,r,n){return F("div",{afterCreate:this._afterTickLineCreate,"aria-valuenow":n.toString(),bind:this,class:xt.tickElement,"data-config":e,"data-tick-config-index":r,"data-tick-group-index":t,"data-value":n,key:`tick-label-${t}`,style:this._getPositionStyleForElement(n)})}renderTickLabel(e,t,r,n){const s=e.labelFormatFunction?e.labelFormatFunction(n,"tick",t):this.viewModel.getLabelForValue(n,"tick",t);return F("div",{afterCreate:this._afterTickLabelCreate,"aria-label":s,"aria-valuenow":n.toString(),"aria-valuetext":s,bind:this,class:xt.tickLabelElement,"data-config":e,"data-tick-config-index":r,"data-tick-group-index":t,"data-value":n,key:`tick-label-${t}`,style:`transform: translate(-50%); ${this._getPositionStyleForElement(n)}`},s)}_afterContainerCreate(e){this.addHandles(vte(e,()=>this.scheduleRender()))}_afterTrackCreate(e){this._set("trackElement",e),e.addEventListener("pointerdown",this._onTrackPointerDown),this.scheduleRender()}_afterTrackRemoved(e){e.removeEventListener("pointerdown",this._onTrackPointerDown),document.removeEventListener("pointermove",this._onTrackPointerMove),document.removeEventListener("pointerup",this._onTrackPointerUp)}_afterSegmentCreate(e){this.segmentElements.add(e),e.addEventListener("pointerdown",this._onSegmentPointerDown)}_afterSegmentRemoved(e){this.segmentElements.remove(e),e.removeEventListener("pointerdown",this._onSegmentPointerDown)}_afterEffectiveSegmentCreate(e){this.effectiveSegmentElements.add(e)}_afterEffectiveSegmentRemoved(e){this.effectiveSegmentElements.remove(e)}_afterAnchorCreate(e){if(this._anchorElements.push(e),e.addEventListener("pointerdown",this._onAnchorPointerDown),this.thumbCreatedFunction){const t=e["data-thumb-index"],r=e["data-value"],n=this.thumbElements.getItemAt(t)||null,s=this.labelElements.getItemAt(t)||null;this.thumbCreatedFunction(t,r,n,s)}}_afterAnchorUpdate(e){y(this._focusedAnchorIndex)&&e["data-thumb-index"]===this._focusedAnchorIndex&&(e.focus(),this._focusedAnchorIndex=null)}_afterAnchorRemoved(e){const t=this._anchorElements.indexOf(e,0);t>-1&&this._anchorElements.splice(t,1),e.removeEventListener("pointerdown",this._onAnchorPointerDown)}_afterThumbCreate(e){this.thumbElements.add(e)}_afterThumbRemoved(e){this.thumbElements.remove(e)}_afterLabelCreate(e){this.labelElements.add(e),e.addEventListener("pointerdown",this._onLabelPointerDown),e.addEventListener("pointerup",this._onLabelPointerUp)}_afterLabelRemoved(e){this.labelElements.remove(e),e.removeEventListener("pointerdown",this._onLabelPointerDown),e.removeEventListener("pointerup",this._onLabelPointerUp)}_afterInputCreate(e){if(e.focus(),e.select(),this.inputCreatedFunction){const t=e.getAttribute("data-input-type"),r=t==="thumb"?e["data-input-index"]:null;this.inputCreatedFunction(e,t,r)}}_afterTickLineCreate(e){const t=e["data-tick-config-index"],r=e["data-tick-group-index"],n=this.tickElements.getItemAt(t);n.getItemAt(r)?n.getItemAt(r).tickElement=e:n.add({groupElement:null,tickElement:e,labelElement:null},r)}_afterTickLabelCreate(e){const t=e["data-tick-config-index"],r=e["data-tick-group-index"],n=this.tickElements.getItemAt(t);n.getItemAt(r)?n.getItemAt(r).labelElement=e:n.add({groupElement:null,labelElement:e,tickElement:null},r)}_afterTickGroupRemoved(e){const t=e["data-tick-config-index"],r=this.tickElements.items[t],n=r==null?void 0:r.find(s=>s.groupElement===e);n&&r.remove(n)}_afterTickGroupCreate(e){var r,n;const t=e["data-config"];if(t&&t.tickCreatedFunction){const s=e["data-tick-config-index"],a=e["data-tick-group-index"],o=e["data-value"],l=(n=(r=this.tickElements)==null?void 0:r.getItemAt(s))==null?void 0:n.getItemAt(a);if(l){l.groupElement=e;const c=l.tickElement||null,u=l.labelElement||null;t.tickCreatedFunction(o,c,u)}}}_afterMaxLabelCreate(e){this._set("maxLabelElement",e)}_afterMinLabelCreate(e){this._set("minLabelElement",e)}_onAnchorKeyDown(e){if(this._isDisabled()||this.state==="editing")return;const{target:t}=e,r=Ol(e),{_anchorElements:n,values:s}=this,a=t["data-thumb-index"],o=n[a],l=s[a],c=[Ga.moveAnchorUp,Ga.moveAnchorDown,Ga.moveAnchorLeft,Ga.moveAnchorRight];if(r===Ga.showInput&&this.labelInputsEnabled)this._activeLabelInputIndex=a,this.notifyChange("state");else if(c.includes(r)){e.preventDefault();const{steps:u}=this,d=r===Ga.moveAnchorUp||r===Ga.moveAnchorRight?1:-1;if(y(u))this._toStep(a,this._isReversedLayout()?-1*d:d);else{const{precision:f}=this,_=this._getPositionOfElement(o),g=this._valueFromPosition(_),x=this._isHorizontalLayout()?d:-1*d;let b;b=f===0?this._positionFromValue(g+x):f===1?this._positionFromValue(g+.1*x):_+x,this._toPosition(a,b)}const m=this.values[a];l!==m&&this._emitThumbChangeEvent({index:a,oldValue:l,value:m})}else if(r===Ga.moveAnchorToMax||r===Ga.moveAnchorToMin){e.preventDefault();const{min:u,max:d}=this._getAnchorBoundsInPixels(a),m=this._isPositionInverted()?r===Ga.moveAnchorToMax?u:d:r===Ga.moveAnchorToMin?u:d;this._toPosition(a,m);const f=this.values[a];l!==f&&this._emitThumbChangeEvent({index:a,oldValue:l,value:f})}}_onAnchorPointerDown(e){if(this._isDisabled())return;const{target:t,clientX:r,clientY:n}=e,s=t["data-thumb-index"];s!==void 0&&(e.preventDefault(),this._anchorElements[s]&&this._anchorElements[s].focus(),this._storeTrackDimensions(),this._dragStartInfo={clientX:r,clientY:n,index:s,position:this._getPositionOfElement(this._anchorElements[s])},this.notifyChange("state"),document.addEventListener("pointerup",this._onAnchorPointerUp),document.addEventListener("pointermove",this._onAnchorPointerMove))}_onAnchorPointerMove(e){if(this.state==="editing"||!this._dragStartInfo)return;e.preventDefault();const{values:t,_anchorElements:r,_dragged:n,_dragStartInfo:s,_dragStartInfo:{index:a,position:o}}=this,{clientX:l,clientY:c}=e,u=n?"drag":"start",d=r[a],m=this._getPositionOfElement(d),f=this._applyPrecisionToPosition(this._isHorizontalLayout()?o+l-s.clientX:o+c-s.clientY);if(m===f)return;const _=t[a];this._dragged=!0,this._toPosition(a,f);const g=this.values[a];n?_!==g&&this._emitThumbDragEvent({index:a,state:u,value:g}):this._emitThumbDragEvent({index:a,state:u,value:_})}_onAnchorPointerUp(e){if(document.removeEventListener("pointerup",this._onAnchorPointerUp),document.removeEventListener("pointermove",this._onAnchorPointerMove),!this._dragStartInfo)return;e.preventDefault();const{index:t}=this._dragStartInfo,r=this._dragged,n=this.values[t];this._dragged=!1,this._dragStartInfo=null,this._lastMovedHandleIndex=t,this.notifyChange("state"),r?this._emitThumbDragEvent({index:t,state:"stop",value:n}):(this.scheduleRender(),this.state!=="editing"&&this._emitThumbClickEvent({index:t,value:n}))}_onTrackPointerDown(e){const{_dragStartInfo:t,snapOnClickEnabled:r,state:n,values:s}=this;if(this._isDisabled()||n==="editing"||t||(document.addEventListener("pointermove",this._onTrackPointerMove),document.addEventListener("pointerup",this._onTrackPointerUp),!r||!s.length))return;const{steps:a}=this,{clientX:o,clientY:l}=e,c=this._getCursorPositionFromEvent(e),u=this._valueFromPosition(c),d=this._getIndexOfNearestValue(u),m=s[d],f=s.some((b,v)=>b===m&&v!==d)&&u>m?this.values.lastIndexOf(m):d;if(S(f))return;const _=s[f],g=y(a)?this._calculateNearestStepPosition(c):c;this._toPosition(f,g),this._dragged=!0,this._dragStartInfo={clientX:o,clientY:l,index:f,position:g},this._focusedAnchorIndex=f,this.notifyChange("state"),this._emitThumbDragEvent({index:f,state:"start",value:_});const x=this.values[f];_!==x&&this._emitThumbDragEvent({index:f,state:"drag",value:x}),document.addEventListener("pointerup",this._onAnchorPointerUp),document.addEventListener("pointermove",this._onAnchorPointerMove)}_onTrackPointerMove(e){e.preventDefault(),this._dragged=!0}_onTrackPointerUp(e){if(e.preventDefault(),document.removeEventListener("pointermove",this._onTrackPointerMove),document.removeEventListener("pointerup",this._onTrackPointerUp),this.snapOnClickEnabled||(this._dragged=!1),!this._dragged){const t=this._getCursorPositionFromEvent(e),r=this._valueFromPosition(t);this._emitTrackClickEvent({value:r})}}_onSegmentPointerDown(e){var l,c;e.preventDefault();const t=e.target,r=t["data-segment-index"],n=t["data-min-thumb-index"],s=t["data-max-thumb-index"];if(this._isDisabled()||S(n)||S(s))return;e.stopPropagation(),this._storeTrackDimensions(),document.addEventListener("pointerup",this._onSegmentPointerUp);const a=this._getAnchorDetails(n),o=this._getAnchorDetails(s);this.syncedSegmentsEnabled?(this.segmentElements.forEach(u=>u.classList.add(xt.segmentElementActive)),this._anchorElements.forEach(u=>u.classList.add(xt.anchorElementActive))):(this.segmentElements.getItemAt(r).classList.add(xt.segmentElementActive),(l=this._anchorElements[a.index])==null||l.classList.add(xt.anchorElementActive),(c=this._anchorElements[o.index])==null||c.classList.add(xt.anchorElementActive)),this._segmentDragStartInfo={cursorPosition:this._getCursorPositionFromEvent(e),index:r,details:this._normalizeSegmentDetails({min:a,max:o})},this.draggableSegmentsEnabled&&(document.addEventListener("pointermove",this._onSegmentPointerMove),this.notifyChange("state"),this._emitSegmentDragEvent({index:r,state:"start",thumbIndices:[n,s]}))}_onSegmentPointerMove(e){if(!this._segmentDragStartInfo)return;e.preventDefault();const{_trackHeight:t,_trackWidth:r,_segmentDragStartInfo:{index:n,cursorPosition:s,details:{min:a,max:o}}}=this,{index:l,position:c,value:u}=a,{index:d,position:m,value:f}=o;this._dragged=!0;const _=this._getCursorPositionFromEvent(e);if(_===s)return;const g=this._positionToPercent(s),x=this._positionToPercent(_)-g,b=this._positionToPercent(c)+x,v=this._positionToPercent(m)+x,{min:w}=this._getAnchorBoundsAsPercents(l),{max:T}=this._getAnchorBoundsAsPercents(d);let E=!1,C=!1;if(b<w?E=!0:v>T&&(C=!0),E){const{min:ee,max:H}=this.viewModel.getBoundsForValueAtIndex(l),V=this._isPositionInverted()?H:ee,X=V,$=f+(V-u),B=$-this.values[d];return void(this.syncedSegmentsEnabled?this._updateAnchorValuesByDifference(B):this._updateAnchorValues([l,d],[X,$]))}if(C){const{min:ee,max:H}=this.viewModel.getBoundsForValueAtIndex(d),V=this._isPositionInverted()?ee:H,X=V,$=u+(V-f),B=$-this.values[l];return void(this.syncedSegmentsEnabled?this._updateAnchorValuesByDifference(B):this._updateAnchorValues([l,d],[$,X]))}const A=this._isHorizontalLayout()?r:t,M=v/100*A,I=b/100*A,L=this.values,U=[L[l],L[d]],j=this._getValueForAnchorAtPosition(l,I),re=this._getValueForAnchorAtPosition(d,M);this.syncedSegmentsEnabled?this._updateAnchorValuesByDifference(j-U[0]):this._updateAnchorValues([l,d],[j,re]),[this.values[l],this.values[d]].every((ee,H)=>ee===U[H])||this._emitSegmentDragEvent({index:n,state:"drag",thumbIndices:[l,d]})}_onSegmentPointerUp(e){if(e.preventDefault(),document.removeEventListener("pointerup",this._onSegmentPointerUp),document.removeEventListener("pointermove",this._onSegmentPointerMove),!this._segmentDragStartInfo)return;const{_dragged:t,max:r,min:n,values:s}=this,{index:a,details:{min:{index:o},max:{index:l}}}=this._segmentDragStartInfo;if(this.segmentElements.forEach(c=>c.classList.remove(xt.segmentElementActive)),this._anchorElements.forEach(c=>c.classList.remove(xt.anchorElementActive)),this.draggableSegmentsEnabled){const c=r-n,u=s[o],d=s[l];this._lastMovedHandleIndex=u===d?u>c/2?o:l:null,this._dragged=!1,this._segmentDragStartInfo=null,this.notifyChange("state"),this._emitSegmentDragEvent({index:a,state:"stop",thumbIndices:[o,l]})}if(!t){const c=this._getCursorPositionFromEvent(e),u=this._valueFromPosition(c);this._emitSegmentClickEvent({index:a,value:u,thumbIndices:[o,l]})}}_onTickGroupClick(e){const t=e.target;if(t["data-config"]){const r=t["data-tick-config-index"],n=t["data-tick-group-index"],s=t["data-value"];this._emitTickClickEvent({configIndex:r,groupIndex:n,value:s})}}_storeTrackDimensions(){if(this.trackElement){const e=this._getDimensions(this.trackElement);this._trackHeight=e.height,this._trackWidth=e.width}}_onLabelPointerDown(){this._isDisabled()||(this._dragged=!1,document.addEventListener("pointerup",this._onAnchorPointerUp),document.addEventListener("pointermove",this._onAnchorPointerMove))}_onLabelPointerMove(){this._isDisabled()||(this._dragged=!0)}_onLabelPointerUp(e){if(this._isDisabled())return;const t=e.target["data-thumb-index"];this.labelInputsEnabled&&!this._dragged&&y(t)&&(this._activeLabelInputIndex=t),this._dragged=!1,this.notifyChange("state"),document.removeEventListener("pointerup",this._onLabelPointerUp),document.removeEventListener("pointermove",this._onLabelPointerMove)}_onLabelInputBlur(e){const{_activeLabelInputIndex:t,values:r,viewModel:n}=this,s=e.target.value;if(this._activeLabelInputIndex=null,this.notifyChange("state"),!s)return;const a=this._parseInputValue(s,"value",t),o=r[t],{min:l,max:c}=this.viewModel.getBoundsForValueAtIndex(t);if(a<l||a>c)return;n.setValue(t,a);const u=this.values[t];o!==u&&this._emitThumbChangeEvent({index:t,oldValue:o,value:u})}_onInputKeyDown(e){if(this._isDisabled())return;const{target:t}=e,r=Ol(e),{hideInput1:n,hideInput2:s,hideInput3:a}=Ga,{_activeLabelInputIndex:o,_anchorElements:l}=this,c=t;if(r===n||r===s||r===a){e.stopPropagation();const u=o;c.blur(),y(u)?l[u].focus():c.parentElement.focus()}}_onMaxLabelClick(){this._isDisabled()||(this._emitRangeLabelClickEvent({type:"max-click",value:this.max}),this.rangeLabelInputsEnabled&&(this._isMaxInputActive=!0,this.notifyChange("state")))}_onMaxLabelKeyDown(e){this._isDisabled()||Ol(e)!==Ga.showInput||(this._isMaxInputActive=!0,this.notifyChange("state"))}_onMaxInputBlur(e){const t=e.target.value;if(this._isMaxInputActive=!1,this.notifyChange("state"),!t)return;const r=this.max,n=this._parseInputValue(t,"max");n<=this.min||(this.viewModel.set("max",n),this.max!==r&&this._emitMaxChangeEvent({oldValue:r,value:this.max}))}_onMinLabelClick(){this._isDisabled()||(this._emitRangeLabelClickEvent({type:"min-click",value:this.min}),this.rangeLabelInputsEnabled&&(this._isMinInputActive=!0,this.notifyChange("state")))}_onMinLabelKeyDown(e){this._isDisabled()||Ol(e)!==Ga.showInput||(this._isMinInputActive=!0,this.notifyChange("state"))}_onMinInputBlur(e){const t=e.target.value;if(this._isMinInputActive=!1,this.notifyChange("state"),!t)return;const r=this.min,n=this._parseInputValue(t,"min");n>=this.max||(this.viewModel.set("min",n),this.min!==r&&this._emitMinChangeEvent({oldValue:r,value:this.min}))}_isDisabled(){return this.disabled||this.state==="disabled"}_positionFromValue(e){const{max:t,min:r}=this,n=t-r;if(n===0)return 0;const{_trackHeight:s,_trackWidth:a}=this,o=this._isHorizontalLayout();let l=parseFloat(o?(a*(e-r)/n).toFixed(2):(s*(t-e)/n).toFixed(2));return this._isReversedLayout()&&(l=o?a-l:s-l),l}_valueFromPosition(e){const{_trackHeight:t,_trackWidth:r,max:n,min:s,precision:a}=this,o=n-s;let l=this._isHorizontalLayout()?e*o/r+s:o*(1e3-e/t*1e3)/1e3+s;return this._isReversedLayout()&&(l=n+s-l),parseFloat(l.toFixed(a))}_positionToPercent(e){const{_trackHeight:t,_trackWidth:r}=this,n=100*e/(this._isHorizontalLayout()?r:t);return this._applyPrecisionToPosition(n)}_applyPrecisionToPosition(e){return parseFloat(e.toFixed(this._positionPrecision))}_isPositionInverted(){const{layout:e}=this;return e==="horizontal-reversed"||e==="vertical"}_isHorizontalLayout(){return this.layout.includes("horizontal")}_isReversedLayout(){return this.layout.includes("reversed")}_normalizeSegmentDetails(e){if(this._isPositionInverted()){const{min:t,max:r}=e;return{min:r,max:t}}return e}_parseInputValue(e,t,r){return this.inputParseFunction?this.inputParseFunction(e,t,r):this.viewModel.defaultInputParseFunction(e)}_formatInputValue(e,t,r){return this.inputFormatFunction?this.inputFormatFunction(e,t,r):this.viewModel.defaultInputFormatFunction(e)}_getAnchorDetails(e){const t=[...this.values].sort((n,s)=>n-s)[e],r=this.values.indexOf(t);return{index:r,position:this._getPositionOfElement(this._anchorElements[r]),value:t}}_updateAnchorStyle(e,t){const r=this._anchorElements[e];r&&(this._isHorizontalLayout()?r.style.left=`${t}`:r.style.top=`${t}`)}_getStyleForAnchor(e,t,r){const n=this._getPositionStyleForElement(e);if(this.values.length===1)return`${n}`;const s=this._zIndices[t];return`${n}; z-index: ${r?this._zIndexOffset+s:s}`}_getPositionStyleForElement(e){const t=this._positionFromValue(e),r=this._positionToPercent(t);return`${this._isHorizontalLayout()?"left":"top"}: ${r+"%"}`}_getPositionOfElement(e){const t=this._getDimensions(e.offsetParent),r=this._getDimensions(e);return this._isHorizontalLayout()?this._applyPrecisionToPosition(r.left-t.left):this._applyPrecisionToPosition(r.top-t.top)}_updateAnchorValues(e,t){e.forEach((r,n)=>this._toValue(r,t[n]))}_updateAnchorValuesByDifference(e){const{min:t,max:r,values:n}=this;n.forEach((s,a)=>this._toValue(a,Math.max(Math.min(s+e,r),t)))}_toValue(e,t){y(this.steps)&&(t=this._getStepValues()[this._getIndexOfNearestStepValue(t)]),this._updateAnchorStyle(e,this._getPositionStyleForElement(t)),this.viewModel.setValue(e,t)}_toPosition(e,t){const r=y(this.steps)?this._getStepValueForAnchorAtPosition(e,t):this._getValueForAnchorAtPosition(e,t);this._updateAnchorStyle(e,this._getPositionStyleForElement(r)),this.viewModel.setValue(e,r)}_getValueForAnchorAtPosition(e,t){const{min:r,max:n}=this._getAnchorBoundsInPixels(e),{min:s,max:a}=this.viewModel.getBoundsForValueAtIndex(e);let o,l,c=null;return this._isPositionInverted()?(o=s,l=a):(o=a,l=s),c=t>n?o:t<r?l:this._valueFromPosition(t),c>a?c=a:c<s&&(c=s),c}_getStepValueForAnchorAtPosition(e,t){const r=this._getStepValues(),n=this._calculateNearestStepPosition(t),s=this._getValueForAnchorAtPosition(e,n);return r[this._getIndexOfNearestStepValue(s)]}_getAnchorBoundsAsPercents(e){const{min:t,max:r}=this._getAnchorBoundsInPixels(e);return{min:this._positionToPercent(t),max:this._positionToPercent(r)}}_getAnchorBoundsInPixels(e){const{_anchorElements:t,_trackHeight:r,_trackWidth:n,effectiveMax:s,effectiveMin:a,thumbsConstrained:o}=this,l=t[e-1],c=t[e+1],u=this._isHorizontalLayout()?n:r;let d,m;return this._isPositionInverted()?(d=y(a)?this._positionFromValue(a):u,m=y(s)?this._positionFromValue(s):0):(d=y(s)?this._positionFromValue(s):u,m=y(a)?this._positionFromValue(a):0),o?this._isPositionInverted()?{max:l?this._getPositionOfElement(l):d,min:c?this._getPositionOfElement(c):m}:{max:c?this._getPositionOfElement(c):d,min:l?this._getPositionOfElement(l):m}:{max:d,min:m}}_getIndexOfNearestValue(e){return this.values.indexOf(this.values.reduce((t,r)=>Math.abs(r-e)<Math.abs(t-e)?r:t))}_getCursorPositionFromEvent(e){const t=this._getDimensions(this.trackElement);return this._isHorizontalLayout()?e.clientX-t.left:e.clientY-t.top}_getStepValues(){const{steps:e}=this;if(Array.isArray(e))return e;const{max:t,min:r}=this,n=Math.ceil((t-r)/e),s=[];for(let a=0;a<=n;a++){const o=r+e*a;s.push(o>t?t:o)}return s}_toStep(e,t){const{values:r,viewModel:n}=this,s=r[e],a=this._getStepValues(),o=a.indexOf(s);let l=null;if(o>-1){let c=a[o+t];isNaN(c)&&(c=a[o]);const u=this._positionFromValue(c);l=this._getStepValueForAnchorAtPosition(e,u)}else l=a[this._getIndexOfNearestStepValue(s)+t];n.setValue(e,l)}_getIndexOfNearestStepValue(e){const{steps:t}=this;if(S(t))return null;const r=this._getStepValues(),n=r.reduce((s,a)=>Math.abs(a-e)<Math.abs(s-e)?a:s);return r.indexOf(n)}_calculateNearestStepPosition(e){const t=this._valueFromPosition(e),r=this._getIndexOfNearestStepValue(t),n=this._getStepValues();return this._positionFromValue(n[r])}_getTickCounts(e,t){const{mode:r}=t;return r==="count"||r==="position"?e||0:r==="percent"&&100/e||0}_calculateTickPositions(e){return e.map(t=>this._positionFromValue(t))}_calculateEquidistantTickPositions(e){const{_trackWidth:t,_trackHeight:r}=this,n=this._isHorizontalLayout()?t:r,s=n/(e-1),a=[];if(e===1)return[n/2];for(let o=0;o<e;o++){const l=o*s;l<=n&&a.push(l)}return a}_getDimensions(e){try{return e.getBoundingClientRect()}catch(t){if(typeof t=="object"&&t!==null)return new DOMRect(0,0,0,0);throw t}}_emitTrackClickEvent(e){this.emit("track-click",{...e,type:"track-click"})}_emitTickClickEvent(e){this.emit("tick-click",{...e,type:"tick-click"})}_emitMaxChangeEvent(e){this.emit("max-change",{...e,type:"max-change"})}_emitMinChangeEvent(e){this.emit("min-change",{...e,type:"min-change"})}_emitThumbChangeEvent(e){this.emit("thumb-change",{...e,type:"thumb-change"})}_emitThumbClickEvent(e){this.emit("thumb-click",{...e,type:"thumb-click"})}_emitThumbDragEvent(e){this.emit("thumb-drag",{...e,type:"thumb-drag"})}_emitSegmentClickEvent(e){this.emit("segment-click",{...e,type:"segment-click"})}_emitSegmentDragEvent(e){this.emit("segment-drag",{...e,type:"segment-drag"})}_emitRangeLabelClickEvent(e){this.emit(e.type,{...e})}};h([p()],zt.prototype,"disabled",void 0),h([p()],zt.prototype,"draggableSegmentsEnabled",void 0),h([p()],zt.prototype,"effectiveMax",null),h([p()],zt.prototype,"effectiveMin",null),h([p({readOnly:!0})],zt.prototype,"effectiveSegmentElements",void 0),h([p()],zt.prototype,"extraNodes",void 0),h([p()],zt.prototype,"inputCreatedFunction",void 0),h([p()],zt.prototype,"inputFormatFunction",null),h([p()],zt.prototype,"inputParseFunction",null),h([p()],zt.prototype,"label",null),h([p({readOnly:!0})],zt.prototype,"labelElements",void 0),h([p()],zt.prototype,"labelInputsEnabled",void 0),h([p()],zt.prototype,"labelFormatFunction",null),h([p({readOnly:!0})],zt.prototype,"labels",null),h([p({value:"horizontal"})],zt.prototype,"layout",null),h([p()],zt.prototype,"max",null),h([p({readOnly:!0})],zt.prototype,"maxLabelElement",void 0),h([p(),_n("esri/widgets/Slider/t9n/Slider")],zt.prototype,"messages",void 0),h([p()],zt.prototype,"min",null),h([p({readOnly:!0})],zt.prototype,"minLabelElement",void 0),h([p()],zt.prototype,"precision",null),h([p()],zt.prototype,"rangeLabelInputsEnabled",void 0),h([p({readOnly:!0})],zt.prototype,"segmentElements",void 0),h([p()],zt.prototype,"snapOnClickEnabled",void 0),h([p({readOnly:!0})],zt.prototype,"state",null),h([p()],zt.prototype,"steps",void 0),h([p()],zt.prototype,"syncedSegmentsEnabled",void 0),h([p()],zt.prototype,"thumbsConstrained",null),h([p()],zt.prototype,"thumbCreatedFunction",void 0),h([p({readOnly:!0})],zt.prototype,"thumbElements",void 0),h([p()],zt.prototype,"tickConfigs",null),h([p({readOnly:!0})],zt.prototype,"tickElements",void 0),h([p({readOnly:!0})],zt.prototype,"trackElement",void 0),h([p()],zt.prototype,"values",null),h([p()],zt.prototype,"viewModel",void 0),h([p()],zt.prototype,"visibleElements",void 0),h([qr("visibleElements")],zt.prototype,"castVisibleElements",null),zt=h([D(J3e)],zt);const eLe=zt;function tLe(){const i=Pe.useRef(null),e=Pe.useRef(null),t=Pe.useRef(null),[r,n]=Pe.useState(null),[s,a]=Pe.useState(null);Pe.useEffect(()=>{o()},[]);async function o(){if(qX.highlightAll(),!(i!=null&&i.current))return;Sg.portalUrl="http://arcgis.com/";const u=new lR({basemap:{portalItem:{id:"eb303185d14e45e9be8bbbc1c0daf7ab"}}}),d=new Y3e({container:i==null?void 0:i.current,map:u,center:[-80,40],constraints:{altitude:{min:2e6}}});d.ui.add([new Z1({view:d,content:e==null?void 0:e.current,expanded:!0,group:"group1",expandTooltip:"MediaLayer"})],"top-left"),n(d)}async function l(){const u=new dX({video:"https://arcgis.github.io/arcgis-samples-javascript/sample-data/media-layer/videos/hurricanes_aerosol-aug.mp4",georeference:new E2({extent:new ui({xmin:-150,ymin:1,xmax:20,ymax:80,spatialReference:{wkid:4326}})})}),d=new pX({source:[u],title:"2017 Hurricanes and Aerosols Simulation",copyright:"NASA's Goddard Space Flight Center"});r.map.layers.add(d),await r.when(),await d.when(),a(d),new eLe({min:0,max:1,precision:2,values:[1],visibleElements:{labels:!0,rangeLabels:!0},container:t.current}).on("thumb-drag",f=>{const{value:_}=f;d.opacity=_})}return nd("div",{className:"App",children:[Lt("div",{id:"view",ref:i}),nd("div",{ref:e,className:"card",children:[Lt("p",{children:"MediaLayer"}),Lt("pre",{className:"line-numbers",children:Lt("code",{className:"language-js",children:`new MediaLayer({ 
    source: [
      new VideoElement({
        video: "video url",
        georeference: new ExtentAndRotationGeoreference({
          extent: new Extent({
            xmin: -150, ymin: 1, xmax: 20, ymax: 80,
            spatialReference: { wkid: 4326 }
          }),
        }),
      })
    ] 
  });`})}),Lt("div",{ref:t,className:"slider"}),Lt(Y1,{className:"btn","icon-start":"play",onClick:l})]})]})}async function iLe(i,e,t){e=e.clone(),i.capabilities.query.supportsMaxRecordCountFactor&&(e.maxRecordCountFactor=vee(i));const r=rLe(i),n=i.capabilities.query.supportsPagination;e.start=0,e.num=r;let s=null;for(;;){const a=await i.source.queryFeaturesJSON(e,t);if(S(s)?s=a:s.features=s.features.concat(a.features),s.exceededTransferLimit=a.exceededTransferLimit,!n||!a.exceededTransferLimit)break;e.start+=r}return s}function rLe(i){return vee(i)*nLe(i)}function nLe(i){return i.capabilities.query.maxRecordCount||2e3}function vee(i){return i.capabilities.query.supportsMaxRecordCountFactor?Ob.MAX_MAX_RECORD_COUNT_FACTOR:1}async function qB(i,e){if(i==="Utility Network Layer"){const{default:t}=await G(()=>Promise.resolve().then(()=>fLe),void 0);return new t({layerUrl:e})}return null}async function sLe(i){let e="portalItem"in i?i:{portalItem:i};!e.portalItem||e.portalItem instanceof jE||(e={...e,portalItem:new jE(e.portalItem)});const t=e.portalItem;if(await t.load(),t.type!=="Feature Service")throw new K("portal:unknown-item-type","Unknown item type '${type}'",{type:t.type});const r=t.url,n=await Wh(r,{responseType:"json",query:{f:"json"}}),s="Network Layer";if(n.data.type&&n.data.type.includes(s))return qB(n.data.type,r);if(n.data.layers){const a=n.data.layers.find(o=>o.type.includes(s));if(a){const o=`${r}/${a.id}`;return qB(a.type,o)}}return null}let Gf=class extends mt{constructor(e){super(e),this.globalIds=[],this.creators=[],this.tags=[],this.names=[]}};h([p({type:[String],json:{write:!0}})],Gf.prototype,"globalIds",void 0),h([p({type:[String],json:{write:!0}})],Gf.prototype,"creators",void 0),h([p({type:[String],json:{write:!0}})],Gf.prototype,"tags",void 0),h([p({type:[String],json:{write:!0}})],Gf.prototype,"names",void 0),Gf=h([D("esri.rest.networks.support.QueryNamedTraceConfigurationsParameters")],Gf);const aLe=Gf;var Wo;(function(i){i[i.RTJunctionJunctionConnectivity=1]="RTJunctionJunctionConnectivity",i[i.RTContainment=2]="RTContainment",i[i.RTAttachment=3]="RTAttachment",i[i.RTJunctionEdgeConnectivity=4]="RTJunctionEdgeConnectivity",i[i.RTEdgeJunctionEdgeConnectivity=5]="RTEdgeJunctionEdgeConnectivity"})(Wo||(Wo={}));const cS=new Vd({connected:"connected",upstream:"upstream",downstream:"downstream",shortestPath:"shortest-path",subnetwork:"subnetwork",subnetworkController:"subnetwork-controller",loops:"loops",isolation:"isolation"});new Vd({connectivity:"connectivity",attachment:"attachment",containment:"containment",junctionEdgeFromConnectivity:"junction-edge-from-connectivity",junctionMidspanConnectivity:"junction-midspan-connectivity",junctionEdgeToConnectivity:"junction-edge-to-connectivity"});const hS=new Vd({normal:"normal",rebuild:"rebuild",forceRebuild:"force-rebuild"});let ju=class extends mt{constructor(e){super(e),this.gdbVersion=null,this.sessionID=null,this.validationType=null,this.validateArea=null,this.validationSet=null,this.returnEdits=!1}};h([p({type:String,json:{write:!0}})],ju.prototype,"gdbVersion",void 0),h([p({type:String,json:{write:!0}})],ju.prototype,"sessionID",void 0),h([p({type:hS.apiValues,json:{type:hS.jsonValues,read:hS.read,write:hS.write}})],ju.prototype,"validationType",void 0),h([p({type:ui,json:{write:!0}})],ju.prototype,"validateArea",void 0),h([p({type:[Object],json:{write:!0}})],ju.prototype,"validationSet",void 0),h([p({type:Boolean,json:{write:!0}})],ju.prototype,"returnEdits",void 0),ju=h([D("esri.rest.networks.support.ValidateNetworkTopologyParameters")],ju);const oLe=ju;let An=class extends mH(Am){constructor(i){super(i),this.id=null,this.title=null,this.layerUrl=null,this.dataElement=null,this.fullExtent=null,this.spatialReference=null,this.type=null,this.sourceJSON=null}static fromPortalItem(i){return sLe(i)}initialize(){this.when().catch(i=>{yo(i)||J.getLogger(this.declaredClass).error("#load()",`Failed to load layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}')`,{error:i})})}get datasetName(){var i;return((i=this.dataElement)==null?void 0:i.name)??null}get owner(){var i;return((i=this.dataElement)==null?void 0:i.userIdentity)??null}get schemaGeneration(){var i;return((i=this.dataElement)==null?void 0:i.schemaGeneration)??null}get parsedUrl(){return hI(this.layerUrl)}get featureServiceUrl(){const i=this.parsedUrl&&mI(this.parsedUrl.path);return y(i)?i.url.path:null}get networkServiceUrl(){return this.featureServiceUrl?this.featureServiceUrl.replace(/\/FeatureServer/i,"/UtilityNetworkServer"):null}get layerId(){const i=this.parsedUrl&&mI(this.parsedUrl.path);return y(i)?i.sublayer:null}get networkSystemLayers(){return null}async load(i){return this.addResolvingPromise(this._fetchDataElement(this.featureServiceUrl,this.layerId.toString(),i)),this.addResolvingPromise(this._fetchLayerMetaData(this.layerUrl,i)),this}getLayerIdBySourceId(i){if(this.dataElement){const e=this.dataElement.domainNetworks;for(const t of e){for(const r of t.edgeSources?t.edgeSources:[])if(r.sourceId===i)return r.layerId;for(const r of t.junctionSources?t.junctionSources:[])if(r.sourceId===i)return r.layerId}return null}return null}async queryNamedTraceConfigurations(i,e){var s;const{queryNamedTraceConfigurations:t}=await G(()=>import("./queryNamedTraceConfigurations-7bfdcb28.js"),["assets/queryNamedTraceConfigurations-7bfdcb28.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/typedArrayUtil-4d7bb04c.js","assets/promiseUtils-1e54421e.js","assets/normalizeUtils-27e29a72.js","assets/Polyline-ff2d7c6b.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/jsonUtils-229211af.js","assets/geometry-b7901087.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),r=this.networkServiceUrl,n=new aLe({...i});return((s=await t(r,n,{...e}))==null?void 0:s.namedTraceConfigurations)??null}async validateNetworkTopology(i,e){if(!i.validateArea)throw new K("network:undefined-validateArea","the network must have validateArea defined in the validate network topology parameters.");const{validateNetworkTopology:t}=await G(()=>import("./validateNetworkTopology-611f19f6.js"),["assets/validateNetworkTopology-611f19f6.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/typedArrayUtil-4d7bb04c.js","assets/promiseUtils-1e54421e.js","assets/normalizeUtils-27e29a72.js","assets/Polyline-ff2d7c6b.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/jsonUtils-229211af.js","assets/geometry-b7901087.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js"]),r=this.networkServiceUrl,n=new oLe({...i,returnEdits:!0}),s=await t(r,n,{...e});if(s!=null&&s.serviceEdits){const a={edits:null,addedFeatures:[],updatedFeatures:[],deletedFeatures:[],addedAttachments:[],updatedAttachments:[],deletedAttachments:[],editedFeatures:s.serviceEdits};Aae.emit("edits",{serviceUrl:this.featureServiceUrl??"",layerId:null,event:a})}return s}async _fetchLayerMetaData(i,e){const t=await Wh(i,{responseType:"json",query:{f:"json"},...e});this.sourceJSON=t.data,this.read(t.data,{origin:"service"})}async _fetchDataElement(i,e,t){if(this.dataElement)return;const r=await Wh(`${i}/queryDataElements`,{responseType:"json",query:{layers:JSON.stringify([e]),f:"json"},...t}).then(n=>{var s;return(s=n.data.layerDataElements)==null?void 0:s[0]});r&&this.read(r,{origin:"service"})}};h([p({type:String,nonNullable:!0,json:{origins:{"web-map":{read:!0,write:{isRequired:!0}},service:{read:!0}},read:!1}})],An.prototype,"id",void 0),h([p({type:String,nonNullable:!0,json:{origins:{"web-map":{read:!0,write:{isRequired:!0}},service:{read:{source:"name"}}},read:!1}})],An.prototype,"title",void 0),h([p({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"url"},write:{target:"url",isRequired:!0}}},read:!1}})],An.prototype,"layerUrl",void 0),h([p({type:Object,json:{origins:{service:{read:!0}},read:!1}})],An.prototype,"dataElement",void 0),h([p({type:ui,json:{origins:{service:{read:{source:"extent"}}},read:!1}})],An.prototype,"fullExtent",void 0),h([p({type:Qt,json:{origins:{service:{read:{source:"extent.spatialReference"}}},read:!1}})],An.prototype,"spatialReference",void 0),h([p({type:["utility","trace"],readOnly:!0,json:{read:!1,write:!1}})],An.prototype,"type",void 0),h([p({readOnly:!0})],An.prototype,"datasetName",null),h([p({readOnly:!0})],An.prototype,"owner",null),h([p({readOnly:!0})],An.prototype,"schemaGeneration",null),h([p({readOnly:!0})],An.prototype,"parsedUrl",null),h([p({readOnly:!0})],An.prototype,"featureServiceUrl",null),h([p({readOnly:!0})],An.prototype,"networkServiceUrl",null),h([p({readOnly:!0})],An.prototype,"layerId",null),h([p()],An.prototype,"sourceJSON",void 0),h([p({readOnly:!0})],An.prototype,"networkSystemLayers",null),An=h([D("esri.networks.Network")],An);const lLe=An;let Hf=class extends l7(Am){constructor(e){super(e),this.request=Wh}initialize(){}async load(e){const t=this.layer.load(e).then(()=>this._initializeRulesTable());return this.addResolvingPromise(t),this}getFeatureSQL(e,t){var c,u;const r=e.layerId.toString(),n=(c=e.fieldsIndex)==null?void 0:c.normalizeFieldName("assetGroup"),s=(u=e.fieldsIndex)==null?void 0:u.normalizeFieldName("assetType"),a=n?t.attributes[n]:null,o=s?t.attributes[s]:null,l=this.rulesHash[r];if(l){const d=l.assetGroupHash[a];if(d)return d.assetTypeHash[o]||null}return null}async _initializeRulesTable(){var n,s,a,o,l,c,u,d,m,f;const e={};let t;(function(_){_[_.from=0]="from",_[_.to=1]="to",_[_.via=2]="via"})(t||(t={}));const r=[{networkSourceId:"fromNetworkSource",assetGroupId:"fromAssetGroup",assetTypeId:"fromAssetType"},{networkSourceId:"toNetworkSource",assetGroupId:"toAssetGroup",assetTypeId:"toAssetType"},{networkSourceId:"viaNetworkSource",assetGroupId:"viaAssetGroup",assetTypeId:"viaAssetType"}];for(const _ of this.rules){if(_.ruleType!==Wo.RTJunctionJunctionConnectivity&&_.ruleType!==Wo.RTJunctionEdgeConnectivity&&_.ruleType!==Wo.RTEdgeJunctionEdgeConnectivity)continue;let g=[[t.from,t.to],[t.to,t.from]];_.ruleType===Wo.RTEdgeJunctionEdgeConnectivity&&(g=[[t.from,t.via],[t.via,t.from],[t.to,t.via],[t.via,t.to]]);for(const x of g){const b=x.shift(),v=x.shift();let w=!1;switch(_.ruleType){case Wo.RTEdgeJunctionEdgeConnectivity:w=b===t.from||b===t.to;break;case Wo.RTJunctionEdgeConnectivity:w=b===t.to}const T=r[b],E=_[T.networkSourceId].layerId.toString(),C=(s=(n=_[T.assetGroupId])==null?void 0:n.assetGroupCode)==null?void 0:s.toString(),A=(o=(a=_[T.assetTypeId])==null?void 0:a.assetTypeCode)==null?void 0:o.toString(),M=r[v],I=_[M.networkSourceId].layerId.toString(),L=(c=(l=_[M.assetGroupId])==null?void 0:l.assetGroupCode)==null?void 0:c.toString(),U=_[M.assetTypeId],j=(u=U==null?void 0:U.assetTypeCode)==null?void 0:u.toString(),re=e[E]?e[E]:{assetGroupHash:{}};if(!(C&&A&&L&&j))continue;const ee=re.assetGroupHash[C]?re.assetGroupHash[C]:{assetTypeHash:{}},H=ee.assetTypeHash[A]?ee.assetTypeHash[A]:{};if(H[I]=H[I]?H[I]:{},w){H[E]=H[E]?H[E]:{};const X=`(assetgroup = ${C} AND assettype = ${A})`;H[E].anyVertex=H[E].anyVertex?`${H[E].anyVertex}`:`${X}`,U.connectivityPolicy==="esriNECPEndVertex"&&(H[E].endVertex=(d=H[E])!=null&&d.endVertex?`${H[E].endVertex}`:`${X}`)}const V=`(assetgroup = ${L} AND assettype = ${j})`;H[I].anyVertex=(m=H[I])!=null&&m.anyVertex?`${H[I].anyVertex} OR ${V}`:`${V}`,U.connectivityPolicy==="esriNECPEndVertex"&&(H[I].endVertex=(f=H[I])!=null&&f.endVertex?`${H[I].endVertex} OR ${V}`:`${V}`),ee.assetTypeHash[A]=H,re.assetGroupHash[C]=ee,e[E]=re}}this.rulesHash=e}};h([p({constructOnly:!0})],Hf.prototype,"layer",void 0),h([p({constructOnly:!0})],Hf.prototype,"rules",void 0),h([p()],Hf.prototype,"rulesHash",void 0),h([p({constructOnly:!0})],Hf.prototype,"request",void 0),Hf=h([D("esri.networks.RulesTable")],Hf);const cLe=Hf;let yl=class extends mt{constructor(e){super(e),this.conditionBarriers=[],this.outputConditions=[],this.functions=[],this.functionBarriers=[],this.traversabilityScope=null,this.shortestPathNetworkAttributeName=null,this.includeBarriers=null,this.validateConsistency=null,this.ignoreBarriersAtStartingPoints=null}};h([p({type:[Object],json:{write:!0}})],yl.prototype,"conditionBarriers",void 0),h([p({type:[Object],json:{write:!0}})],yl.prototype,"outputConditions",void 0),h([p({type:[Object],json:{write:!0}})],yl.prototype,"functions",void 0),h([p({type:[Object],json:{write:!0}})],yl.prototype,"functionBarriers",void 0),h([p({type:["junctions","edges","junctionsAndEdges"],json:{write:!0}})],yl.prototype,"traversabilityScope",void 0),h([p({type:String,json:{write:!0}})],yl.prototype,"shortestPathNetworkAttributeName",void 0),h([p({type:Boolean,json:{write:!0}})],yl.prototype,"includeBarriers",void 0),h([p({type:Boolean,json:{write:!0}})],yl.prototype,"validateConsistency",void 0),h([p({type:Boolean,json:{write:!0}})],yl.prototype,"ignoreBarriersAtStartingPoints",void 0),yl=h([D("esri.networks.support.TraceConfiguration")],yl);const W4=yl;let Qr=class extends W4{constructor(e){super(e),this.filterBarriers=[],this.domainNetworkName=null,this.filterBitsetNetworkAttributeName=null,this.filterFunctionBarriers=[],this.filterScope=null,this.includeContainers=null,this.includeContent=null,this.includeIsolated=null,this.includeStructures=null,this.includeUpToFirstSpatialContainer=null,this.nearestNeighbor=null,this.outputFilterCategories=[],this.outputFilters=[],this.propagators=[],this.subnetworkName=null,this.targetTierName=null,this.tierName=null,this.validateLocatability=null}};h([p({type:[Object],json:{write:!0}})],Qr.prototype,"filterBarriers",void 0),h([p({type:String,json:{write:!0}})],Qr.prototype,"domainNetworkName",void 0),h([p({type:String,json:{write:!0}})],Qr.prototype,"filterBitsetNetworkAttributeName",void 0),h([p({type:[Object],json:{write:!0}})],Qr.prototype,"filterFunctionBarriers",void 0),h([p({type:["junctions","edges","junctionsAndEdges"],json:{write:!0}})],Qr.prototype,"filterScope",void 0),h([p({type:Boolean,json:{write:!0}})],Qr.prototype,"includeContainers",void 0),h([p({type:Boolean,json:{write:!0}})],Qr.prototype,"includeContent",void 0),h([p({type:Boolean,json:{write:!0}})],Qr.prototype,"includeIsolated",void 0),h([p({type:Boolean,json:{write:!0}})],Qr.prototype,"includeStructures",void 0),h([p({type:Boolean,json:{write:!0}})],Qr.prototype,"includeUpToFirstSpatialContainer",void 0),h([p({type:Object,json:{write:!0}})],Qr.prototype,"nearestNeighbor",void 0),h([p({type:[Object],json:{write:!0}})],Qr.prototype,"outputFilterCategories",void 0),h([p({type:[Object],json:{write:!0}})],Qr.prototype,"outputFilters",void 0),h([p({type:[Object],json:{write:!0}})],Qr.prototype,"propagators",void 0),h([p({type:String,json:{write:!0}})],Qr.prototype,"subnetworkName",void 0),h([p({type:String,json:{write:!0}})],Qr.prototype,"targetTierName",void 0),h([p({type:String,json:{write:!0}})],Qr.prototype,"tierName",void 0),h([p({type:Boolean,json:{write:!0}})],Qr.prototype,"validateLocatability",void 0),Qr=h([D("esri.networks.support.UNTraceConfiguration")],Qr);const hLe=Qr;let Ya=class extends fH{constructor(e){super(e),this.globalId=null,this.title=null,this.traceConfiguration=null,this.creationDate=null,this.creator=null,this.description=null,this.minStartingPoints=null,this.resultTypes=[],this.tags=[],this.traceType=null}readTraceConfiguration(e,t){return e.tierName!==void 0?hLe.fromJSON(e):W4.fromJSON(e)}};h([p({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"id"},write:{target:"id",isRequired:!0}},service:{read:{source:"globalId"},write:{target:"globalId",isRequired:!0}}},read:!1}})],Ya.prototype,"globalId",void 0),h([p({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"title"},write:{target:"title",isRequired:!0}},service:{read:{source:"name"},write:{target:"name",isRequired:!0}}},read:!1}})],Ya.prototype,"title",void 0),h([p({type:W4,json:{origins:{service:{read:!0,write:!0}},read:!1}})],Ya.prototype,"traceConfiguration",void 0),h([Dl("service","traceConfiguration")],Ya.prototype,"readTraceConfiguration",null),h([p({type:Date,json:{origins:{service:{read:!0,write:!0}},read:!1}})],Ya.prototype,"creationDate",void 0),h([p({type:String,json:{origins:{service:{read:!0,write:!0}},read:!1}})],Ya.prototype,"creator",void 0),h([p({type:String,json:{origins:{service:{read:!0,write:!0}},read:!1}})],Ya.prototype,"description",void 0),h([p({type:["none","one","many"],json:{origins:{service:{read:{source:"minNumStartingPoints"},write:{target:"minNumStartingPoints"}}},read:!1}})],Ya.prototype,"minStartingPoints",void 0),h([p({type:[Object],json:{origins:{service:{read:!0,write:!0}},read:!1}})],Ya.prototype,"resultTypes",void 0),h([p({type:[String],json:{origins:{service:{read:!0,write:!0}},read:!1}})],Ya.prototype,"tags",void 0),h([p({type:cS.apiValues,json:{type:cS.jsonValues,origins:{service:{read:cS.read,write:cS.write}},read:!1}})],Ya.prototype,"traceType",void 0),Ya=h([D("esri.networks.support.NamedTraceConfiguration")],Ya);const uLe=Ya;let qu=class extends ue{constructor(e){super(e),this.rulesTableId=null,this.rulesTableUrl=null,this.subnetworksTableId=null,this.subnetworksTableUrl=null,this.dirtyAreasLayerId=null,this.dirtyAreasLayerUrl=null}};h([p({constructOnly:!0})],qu.prototype,"rulesTableId",void 0),h([p({constructOnly:!0})],qu.prototype,"rulesTableUrl",void 0),h([p({constructOnly:!0})],qu.prototype,"subnetworksTableId",void 0),h([p({constructOnly:!0})],qu.prototype,"subnetworksTableUrl",void 0),h([p({constructOnly:!0})],qu.prototype,"dirtyAreasLayerId",void 0),h([p({constructOnly:!0})],qu.prototype,"dirtyAreasLayerUrl",void 0),qu=h([D("esri.networks.support.NetworkSystemLayers")],qu);const dLe=qu;let $y=class extends mt{constructor(e){super(e),this.id=null,this.name=null}};h([p({type:Number,json:{read:{source:"terminalId"},write:{target:"terminalId"}}})],$y.prototype,"id",void 0),h([p({type:String,json:{read:{source:"terminalName"},write:{target:"terminalName"}}})],$y.prototype,"name",void 0),h([p({type:Boolean,json:{write:!0}})],$y.prototype,"isUpstreamTerminal",void 0),$y=h([D("esri.networks.support.Terminal")],$y);const pLe=$y,uS=new Vd({esriUNTMBidirectional:"bidirectional",esriUNTMDirectional:"directional"});let Dp=class extends mt{constructor(e){super(e),this.defaultConfiguration=null,this.id=null,this.name=null,this.terminals=[],this.traversabilityModel=null}};h([p({type:String,json:{write:!0}})],Dp.prototype,"defaultConfiguration",void 0),h([p({type:Number,json:{read:{source:"terminalConfigurationId"},write:{target:"terminalConfigurationId"}}})],Dp.prototype,"id",void 0),h([p({type:String,json:{read:{source:"terminalConfigurationName"},write:{target:"terminalConfigurationName"}}})],Dp.prototype,"name",void 0),h([p({type:[pLe],json:{write:!0}})],Dp.prototype,"terminals",void 0),h([p({type:uS.apiValues,json:{type:uS.jsonValues,read:uS.read,write:uS.write}})],Dp.prototype,"traversabilityModel",void 0),Dp=h([D("esri.networks.support.TerminalConfiguration")],Dp);const WB=Dp,mLe="esri.networks.UtilityNetwork",dS=J.getLogger(mLe);let Do=class extends lLe{constructor(e){super(e),this.sharedNamedTraceConfigurations=[],this.type="utility"}get serviceTerritoryFeatureLayerId(){var e;return((e=this.dataElement)==null?void 0:e.serviceTerritoryFeatureLayerId)??null}get networkSystemLayers(){var e,t,r,n,s,a;return new dLe({rulesTableId:(e=this.sourceJSON)==null?void 0:e.systemLayers.rulesTableId,rulesTableUrl:this.sourceJSON?`${this.featureServiceUrl}/${(t=this.sourceJSON)==null?void 0:t.systemLayers.rulesTableId}`:null,subnetworksTableId:(r=this.sourceJSON)==null?void 0:r.systemLayers.subnetworksTableId,subnetworksTableUrl:this.sourceJSON?`${this.featureServiceUrl}/${(n=this.sourceJSON)==null?void 0:n.systemLayers.subnetworksTableId}`:null,dirtyAreasLayerId:(s=this.sourceJSON)==null?void 0:s.systemLayers.dirtyAreasLayerId,dirtyAreasLayerUrl:this.sourceJSON?`${this.featureServiceUrl}/${(a=this.sourceJSON)==null?void 0:a.systemLayers.dirtyAreasLayerId}`:null})}get rulesTableId(){var e;return dT(dS,"rulesTableId",{replacement:"networkSystemLayers.rulesTableId"}),(e=this.sourceJSON)==null?void 0:e.systemLayers.rulesTableId}get rulesTableUrl(){return dT(dS,"rulesTableUrl",{replacement:"networkSystemLayers.rulesTableUrl"}),this.sourceJSON?`${this.featureServiceUrl}/${this.networkSystemLayers.rulesTableId}`:null}get subnetworksTableId(){var e;return dT(dS,"subnetworksTableId",{replacement:"networkSystemLayers.subnetworksTableId"}),(e=this.sourceJSON)==null?void 0:e.systemLayers.subnetworksTableId}get subnetworksTableUrl(){return dT(dS,"subnetworksTableUrl",{replacement:"networkSystemLayers.subnetworksTableUrl"}),this.sourceJSON?`${this.featureServiceUrl}/${this.networkSystemLayers.subnetworksTableId}`:null}get terminalConfigurations(){var e;return((e=this.dataElement)==null?void 0:e.terminalConfigurations.map(t=>WB.fromJSON(t)))||[]}get domainNetworkNames(){var e;return((e=this.dataElement)==null?void 0:e.domainNetworks.map(t=>t.domainNetworkName))||[]}get _utilityLayerList(){var t,r;const e=new Set;return(r=(t=this.dataElement)==null?void 0:t.domainNetworks)==null||r.map(n=>{n.edgeSources.map(s=>{e.add(s.layerId)}),n.junctionSources.map(s=>{e.add(s.layerId)})}),e}async load(e){return this.addResolvingPromise(super.load(e)),this.addResolvingPromise(this._loadNamedTraceConfigurationsFromNetwork(e)),this}getTerminalConfiguration(e){var c,u,d,m;let t=null,r=null;const n=e.layer;let s=null;if((n==null?void 0:n.type)!=="feature"||(s=n.layerId,s===null))return null;const a=e.attributes;if(a==null)return null;for(const f of Object.keys(a))f.toUpperCase()==="ASSETGROUP"&&(t=e.getAttribute(f)),f.toUpperCase()==="ASSETTYPE"&&(r=e.getAttribute(f));if(!this.dataElement)return null;let o=null;const l=this.dataElement.domainNetworks;for(const f of l){const _=(c=f.junctionSources)==null?void 0:c.find(g=>g.layerId===s);if(_){const g=(u=_.assetGroups)==null?void 0:u.find(x=>x.assetGroupCode===t);if(g){const x=(d=g.assetTypes)==null?void 0:d.find(b=>b.assetTypeCode===r);if(x){o=x.terminalConfigurationId;break}}}}if(o!=null){const f=(m=this.dataElement.terminalConfigurations)==null?void 0:m.find(_=>_.terminalConfigurationId===o);return f?WB.fromJSON(f):null}return null}getTierNames(e){var r;const t=(r=this.dataElement)==null?void 0:r.domainNetworks.find(n=>n.domainNetworkName===e);return(t==null?void 0:t.tiers.map(n=>n.name))||[]}async getRulesTable(){return this._createRulesTable()}isUtilityLayer(e){return this._utilityLayerList.has(e.layerId)}async _loadNamedTraceConfigurationsFromNetwork(e){var n;if(((n=this.sharedNamedTraceConfigurations)==null?void 0:n.length)===0)return;const t=this.sharedNamedTraceConfigurations.map(s=>s.globalId),r=await this.queryNamedTraceConfigurations({globalIds:t},e);for(const s of this.sharedNamedTraceConfigurations){const a=r==null?void 0:r.find(o=>o.globalId===s.globalId);if(a){const o=a.write({},{origin:"service"});s.read(o,{origin:"service"})}}}async _createRulesTable(){var s;const e=new k7({url:this.rulesTableUrl});await e.load();const t=(s=this.dataElement)==null?void 0:s.domainNetworks;if(!t)return null;const r=t.flatMap(a=>[...a.edgeSources,...a.junctionSources]),n=(await this._queryRulesTable(e)).map(a=>this._hydrateRuleInfo(e,r,a));return new cLe({layer:e,rules:n})}async _queryRulesTable(e){const t=new Ob({where:"1=1",outFields:["*"]});return(await iLe(e,t)).features}_hydrateRuleInfo(e,t,r){const n=e.fieldsIndex,s=n.get("RULETYPE"),a=n.get("CREATIONDATE"),o=n.get("FROMNETWORKSOURCEID"),l=n.get("FROMASSETGROUP"),c=n.get("FROMASSETTYPE"),u=n.get("FROMTERMINALID"),d=n.get("TONETWORKSOURCEID"),m=n.get("TOASSETGROUP"),f=n.get("TOASSETTYPE"),_=n.get("TOTERMINALID"),g=n.get("VIANETWORKSOURCEID"),x=n.get("VIAASSETGROUP"),b=n.get("VIAASSETTYPE"),v=n.get("VIATERMINALID"),w=r.attributes[s.name],T=new Date(r.attributes[a.name]),E=[{networkSourceId:r.attributes[o.name],assetGroupId:r.attributes[l.name],assetTypeId:r.attributes[c.name],terminalId:r.attributes[u.name]},{networkSourceId:r.attributes[d.name],assetGroupId:r.attributes[m.name],assetTypeId:r.attributes[f.name],terminalId:r.attributes[_.name]},{networkSourceId:r.attributes[g.name],assetGroupId:r.attributes[x.name],assetTypeId:r.attributes[b.name],terminalId:r.attributes[v.name]}];let C;(function(M){M[M.from=0]="from",M[M.to=1]="to",M[M.via=2]="via"})(C||(C={}));const A={ruleType:w,creationDate:T};for(const M of[C.from,C.to,C.via]){if(w!==Wo.RTEdgeJunctionEdgeConnectivity&&M===C.via)continue;const I=E[M],L=t.find(H=>H.sourceId===I.networkSourceId),U=L==null?void 0:L.assetGroups.find(H=>H.assetGroupCode===I.assetGroupId),j=U==null?void 0:U.assetTypes.find(H=>H.assetTypeCode===I.assetTypeId);let re=this._getTerminal(w,j,I);w!==Wo.RTContainment&&w!==Wo.RTAttachment||(re=null);let ee="";switch(M){case C.from:ee="from";break;case C.to:ee="to";break;case C.via:ee="via"}A[`${ee}NetworkSource`]=L,A[`${ee}AssetGroup`]=U,A[`${ee}AssetType`]=j,A[`${ee}Terminal`]=re}return A}_getTerminal(e,t,r){var a,o;if(e===Wo.RTAttachment||e===Wo.RTContainment)return null;const n=t==null?void 0:t.terminalConfigurationId,s=(a=this.terminalConfigurations)==null?void 0:a.find(l=>l.id===n);return((o=s==null?void 0:s.terminals)==null?void 0:o.find(l=>l.id===r.terminalId))??null}};h([p({type:[uLe],json:{origins:{"web-map":{read:{source:"traceConfigurations"},write:{target:"traceConfigurations"}},service:{read:{source:"traceConfigurations"}}},read:!1}})],Do.prototype,"sharedNamedTraceConfigurations",void 0),h([p({type:["utility"],readOnly:!0,json:{read:!1,write:!1}})],Do.prototype,"type",void 0),h([p({readOnly:!0})],Do.prototype,"serviceTerritoryFeatureLayerId",null),h([p({readOnly:!0})],Do.prototype,"networkSystemLayers",null),h([p({readOnly:!0})],Do.prototype,"rulesTableId",null),h([p({readOnly:!0})],Do.prototype,"rulesTableUrl",null),h([p({readOnly:!0})],Do.prototype,"subnetworksTableId",null),h([p({readOnly:!0})],Do.prototype,"subnetworksTableUrl",null),h([p({readOnly:!0})],Do.prototype,"terminalConfigurations",null),h([p({readOnly:!0})],Do.prototype,"domainNetworkNames",null),Do=h([D("esri.networks.UtilityNetwork")],Do);const bee=Do,fLe=Object.freeze(Object.defineProperty({__proto__:null,default:bee},Symbol.toStringTag,{value:"Module"}));let Fp=class extends mt{constructor(e){super(e),this.facilityIdField=null,this.layerId=null,this.nameField=null,this.siteIdField=null,this.sublayerId=null}};h([p({type:String,json:{write:!0}})],Fp.prototype,"facilityIdField",void 0),h([p({type:String,json:{write:!0}})],Fp.prototype,"layerId",void 0),h([p({type:String,json:{write:!0}})],Fp.prototype,"nameField",void 0),h([p({type:String,json:{write:!0}})],Fp.prototype,"siteIdField",void 0),h([p({type:Number,json:{read:{source:"subLayerId"},write:{target:"subLayerId"},origins:{"web-scene":{read:!1,write:!1}}}})],Fp.prototype,"sublayerId",void 0),Fp=h([D("esri.layers.support.FacilityLayerInfo")],Fp);const gLe=Fp;let cc=class extends mt{constructor(e){super(e),this.facilityIdField=null,this.layerId=null,this.levelIdField=null,this.levelNumberField=null,this.longNameField=null,this.shortNameField=null,this.sublayerId=null,this.verticalOrderField=null}};h([p({type:String,json:{write:!0}})],cc.prototype,"facilityIdField",void 0),h([p({type:String,json:{write:!0}})],cc.prototype,"layerId",void 0),h([p({type:String,json:{write:!0}})],cc.prototype,"levelIdField",void 0),h([p({type:String,json:{write:!0}})],cc.prototype,"levelNumberField",void 0),h([p({type:String,json:{write:!0}})],cc.prototype,"longNameField",void 0),h([p({type:String,json:{write:!0}})],cc.prototype,"shortNameField",void 0),h([p({type:Number,json:{read:{source:"subLayerId"},write:{target:"subLayerId"},origins:{"web-scene":{read:!1,write:!1}}}})],cc.prototype,"sublayerId",void 0),h([p({type:String,json:{write:!0}})],cc.prototype,"verticalOrderField",void 0),cc=h([D("esri.layers.support.LevelLayerInfo")],cc);const _Le=cc;let jf=class extends mt{constructor(e){super(e),this.layerId=null,this.nameField=null,this.siteIdField=null,this.sublayerId=null}};h([p({type:String,json:{write:!0}})],jf.prototype,"layerId",void 0),h([p({type:String,json:{write:!0}})],jf.prototype,"nameField",void 0),h([p({type:String,json:{write:!0}})],jf.prototype,"siteIdField",void 0),h([p({type:Number,json:{read:{source:"subLayerId"},write:{target:"subLayerId"},origins:{"web-scene":{read:!1,write:!1}}}})],jf.prototype,"sublayerId",void 0),jf=h([D("esri.layers.support.SiteLayerInfo")],jf);const yLe=jf;let Dy=class extends mt{constructor(e){super(e),this.levelLayer=null,this.facilityLayer=null,this.siteLayer=null}};h([p({type:_Le,json:{write:!0}})],Dy.prototype,"levelLayer",void 0),h([p({type:gLe,json:{write:!0}})],Dy.prototype,"facilityLayer",void 0),h([p({type:yLe,json:{write:!0}})],Dy.prototype,"siteLayer",void 0),Dy=h([D("esri.support.MapFloorInfo")],Dy);const vLe=Dy;let Fy=class extends au(mt){constructor(e){super(e),this.expression=null,this.returnType="string",this.title=null}};h([p({type:String,json:{write:{isRequired:!0}}})],Fy.prototype,"expression",void 0),h([p({type:["number","string"],json:{write:!0}})],Fy.prototype,"returnType",void 0),h([p({type:String,json:{write:!0}})],Fy.prototype,"title",void 0),Fy=h([D("esri.webdoc.geotriggersInfo.ExpressionInfo")],Fy);const wee=Fy,pS=new Vd({deviceLocation:"device-location"});let Tb=class extends au(mt){constructor(e){super(e),this.filterExpression=null,this.type="device-location"}};h([p({type:wee,json:{write:!0}})],Tb.prototype,"filterExpression",void 0),h([p({type:pS.apiValues,readOnly:!0,json:{type:pS.jsonValues,read:pS.read,write:pS.write}})],Tb.prototype,"type",void 0),Tb=h([D("esri.webdoc.geotriggersInfo.DeviceLocationFeed")],Tb);const bLe=Tb;let Cb=class extends au(mt){constructor(e){super(e),this.geometry=null,this.where=null}};h([p({types:b7,json:{read:AE,write:!0}})],Cb.prototype,"geometry",void 0),h([p({type:String,json:{write:!0}})],Cb.prototype,"where",void 0),Cb=h([D("esri.webdoc.geotriggersInfo.FeatureFilter")],Cb);const wLe=Cb;let Ny=class extends au(mt){constructor(e){super(e),this.layerId=null,this.layerUrl=null,this.type="feature-layer"}};h([p({type:String,json:{write:{overridePolicy(){return{isRequired:this.layerUrl===null}}}}})],Ny.prototype,"layerId",void 0),h([p({type:String,json:{write:{overridePolicy(){return{isRequired:this.layerId===null}}}}})],Ny.prototype,"layerUrl",void 0),h([Ra({featureLayer:"feature-layer"},{readOnly:!0})],Ny.prototype,"type",void 0),Ny=h([D("esri.webdoc.geotriggersInfo.FeatureLayerSource")],Ny);const xLe=Ny;let qf=class extends au(mt){constructor(e){super(e),this.fenceSource=null,this.filter=null,this.bufferDistance=null,this.type="features"}};h([p({type:xLe,json:{write:{isRequired:!0}}})],qf.prototype,"fenceSource",void 0),h([p({type:wLe,json:{write:!0}})],qf.prototype,"filter",void 0),h([p({type:Number,json:{write:!0}})],qf.prototype,"bufferDistance",void 0),h([Ra({features:"features"},{readOnly:!0})],qf.prototype,"type",void 0),qf=h([D("esri.webdoc.geotriggersInfo.FeatureFenceParameters")],qf);const TLe=qf;let xE=class extends au(mt){constructor(e){super(e),this.type="fence"}};h([Ra({fence:"fence"},{readOnly:!0})],xE.prototype,"type",void 0),xE=h([D("esri.webdoc.geotriggersInfo.Geotrigger")],xE);const xee=xE;let Sb=class extends au(mt){constructor(e){super(e),this.expressionInfo=null,this.requestedActions=null}};h([p({type:wee,json:{write:!0}})],Sb.prototype,"expressionInfo",void 0),h([p({type:[String],json:{write:!0}})],Sb.prototype,"requestedActions",void 0),Sb=h([D("esri.webdoc.geotriggersInfo.GeotriggerNotificationOptions")],Sb);const CLe=Sb,SLe=new Vd({enterContainsAndExitDoesNotContain:"enter-contains-and-exit-does-not-contain",enterContainsAndExitDoesNotIntersect:"enter-contains-and-exit-does-not-intersect",enterIntersectsAndExitDoesNotIntersect:"enter-intersects-and-exit-does-not-intersect"}),ELe=new Vd({useGeometry:"use-geometry",useGeometryWithAccuracy:"use-geometry-with-accuracy"}),mS=new Vd({enter:"enter",enterOrExit:"enter-or-exit",exit:"exit"});let hc=class extends xee{constructor(e){super(e),this.enterExitRule="enter-contains-and-exit-does-not-intersect",this.feed=null,this.feedAccuracyMode="use-geometry",this.fenceNotificationRule=null,this.fenceParameters=null,this.name=null,this.notificationOptions=null,this.type="fence"}};h([Ra(SLe)],hc.prototype,"enterExitRule",void 0),h([p({type:bLe,json:{write:{isRequired:!0}}})],hc.prototype,"feed",void 0),h([Ra(ELe)],hc.prototype,"feedAccuracyMode",void 0),h([p({type:mS.apiValues,json:{type:mS.jsonValues,read:mS.read,write:{writer:mS.write,isRequired:!0}}})],hc.prototype,"fenceNotificationRule",void 0),h([p({type:TLe,json:{write:{isRequired:!0}}})],hc.prototype,"fenceParameters",void 0),h([p({type:String,json:{write:!0}})],hc.prototype,"name",void 0),h([p({type:CLe,json:{write:!0}})],hc.prototype,"notificationOptions",void 0),h([Ra({fence:"fence"},{readOnly:!0})],hc.prototype,"type",void 0),hc=h([D("esri.webdoc.geotriggersInfo.FenceGeotrigger")],hc);const PLe=hc,RLe={base:xee,key:"type",typeMap:{fence:PLe}};let TE=class extends au(mt){constructor(e){super(e),this.geotriggers=null}};h([p({types:[RLe],json:{write:{isRequired:!0}}})],TE.prototype,"geotriggers",void 0),TE=h([D("esri.webdoc.GeotriggersInfo")],TE);const ALe=TE;var $$;let ky=$$=class extends mt{constructor(i){super(i),this.activeRange=null,this.currentRangeExtent=null,this.fullRangeExtent=null}clone(){return new $$(Rr({activeRange:this.activeRange,currentRangeExtent:this.currentRangeExtent,fullRangeExtent:this.fullRangeExtent}))}};h([p({type:String,nonNullable:!0,json:{read:{source:"activeRangeName"},write:{target:"activeRangeName",isRequired:!0}}})],ky.prototype,"activeRange",void 0),h([p({type:[Number],json:{write:!0}})],ky.prototype,"currentRangeExtent",void 0),h([p({type:[Number],json:{write:!0}})],ky.prototype,"fullRangeExtent",void 0),ky=$$=h([D("esri.webdoc.RangeInfo")],ky);const X4=ky;var D$;let Eh=D$=class extends mt{constructor(i){super(i),this.enabled=!1,this.longNames=!1,this.minimized=!1,this.pinnedLevels=!1,this.site=null,this.facility=null,this.level=null}clone(){return new D$(Rr({enabled:this.enabled,longNames:this.longNames,minimized:this.minimized,pinnedLevels:this.pinnedLevels,site:this.site,facility:this.facility,level:this.level}))}};h([p({type:Boolean,json:{read:{source:"enabled"},write:{target:"enabled"}}})],Eh.prototype,"enabled",void 0),h([p({type:Boolean,json:{read:{source:"longNames"},write:{target:"longNames"}}})],Eh.prototype,"longNames",void 0),h([p({type:Boolean,json:{read:{source:"minimized"},write:{target:"minimized"}}})],Eh.prototype,"minimized",void 0),h([p({type:Boolean,json:{read:{source:"pinnedLevels"},write:{target:"pinnedLevels"}}})],Eh.prototype,"pinnedLevels",void 0),h([p({type:String,json:{read:{source:"site"},write:{target:"site"}}})],Eh.prototype,"site",void 0),h([p({type:String,json:{read:{source:"facility"},write:{target:"facility"}}})],Eh.prototype,"facility",void 0),h([p({type:String,json:{read:{source:"level"},write:{target:"level"}}})],Eh.prototype,"level",void 0),Eh=D$=h([D("esri.webdoc.widgets.FloorFilter")],Eh);const OLe=Eh;var F$;const fS=new Vd({slider:"slider",picker:"picker"});let Vy=F$=class extends mt{constructor(i){super(i),this.interactionMode=null,this.numStops=null,this.stopInterval=null}clone(){return new F$({interactionMode:this.interactionMode,numStops:this.numStops,stopInterval:this.stopInterval})}};h([p({type:fS.apiValues,nonNullable:!0,json:{type:fS.jsonValues,default:null,read:{reader:fS.read},write:{isRequired:!0,writer:fS.write}}})],Vy.prototype,"interactionMode",void 0),h([p({type:Number,json:{read:{source:"numberOfStops"},write:{target:"numberOfStops",overridePolicy(){const i=this.stopInterval!=null;return{enabled:!i,isRequired:!i}}}}})],Vy.prototype,"numStops",void 0),h([p({type:Number,json:{write:{overridePolicy(){return{isRequired:this.numStops==null}}}}})],Vy.prototype,"stopInterval",void 0),Vy=F$=h([D("esri.webdoc.widgets.Range")],Vy);const MLe=Vy;var N$;let On=N$=class extends mt{constructor(i){super(i),this.currentTimeExtent=null,this.fullTimeExtent=null,this.loop=!1,this.numStops=null,this.numThumbs=null,this.stopDelay=null,this.stopInterval=null,this.stops=null}readCurrentTimeExtent(i){if(!i)return;const e=i[0]!=null?new Date(i[0]):null,t=i[1]!=null?new Date(i[1]):null;return new H0({start:e,end:t})}writeCurrentTimeExtent(i,e,t){i&&KR(t,[y(i.start)?i.start.getTime():null,y(i.end)?i.end.getTime():null],e)}readFullTimeExtent(i,e){const t=e.properties;if(!t)return;const r=t.endTime!=null?new Date(t.endTime):null,n=t.startTime!=null?new Date(t.startTime):null;return new H0({start:n,end:r})}writeFullTimeExtent(i,e){if(!i)return;const t=e.properties=e.properties||{},r=i.end,n=i.start;r&&(t.endTime=y(r)?r.getTime():null),n&&(t.startTime=y(n)?n.getTime():null)}readStopInterval(i,e,t){return i?gH.fromJSON({value:i.interval,unit:i.units},t):null}writeStopInterval(i,e,t,r){if(!i)return;const n=i.toJSON(r);KR(t,{interval:n.value,units:n.unit},e)}readStops(i){return i&&i.length?i.map(e=>new Date(e)):null}writeStops(i,e,t){i&&i.length&&KR(t,i.map(r=>r.getTime()),e)}clone(){return new N$(Rr({currentTimeExtent:this.currentTimeExtent,fullTimeExtent:this.fullTimeExtent,loop:this.loop,numStops:this.numStops,numThumbs:this.numThumbs,stopDelay:this.stopDelay,stopInterval:this.stopInterval,stops:this.stops}))}};h([p({type:H0,json:{read:{source:"properties.currentTimeExtent"},write:{target:"properties.currentTimeExtent"}}})],On.prototype,"currentTimeExtent",void 0),h([Dl("currentTimeExtent")],On.prototype,"readCurrentTimeExtent",null),h([Cs("currentTimeExtent")],On.prototype,"writeCurrentTimeExtent",null),h([p({type:H0,json:{read:{source:["properties.endTime","properties.startTime"]},write:{target:{"properties.endTime":{type:Number},"properties.startTime":{type:Number}}}}})],On.prototype,"fullTimeExtent",void 0),h([Dl("fullTimeExtent")],On.prototype,"readFullTimeExtent",null),h([Cs("fullTimeExtent")],On.prototype,"writeFullTimeExtent",null),h([p({type:Boolean,nonNullable:!0,json:{default:!1,read:{source:"properties.loop"},write:{target:"properties.loop"}}})],On.prototype,"loop",void 0),h([p({type:Number,json:{read:{source:"properties.numberOfStops"},write:{target:"properties.numberOfStops",overridePolicy(){var r;const i=!!this.stopInterval,e=!!((r=this.stops)!=null&&r.length),t=!(i||e);return{enabled:t,isRequired:t}}}}})],On.prototype,"numStops",void 0),h([p({type:[1,2],nonNullable:!0,json:{read:{source:"properties.thumbCount"},write:{target:"properties.thumbCount",isRequired:!0}}})],On.prototype,"numThumbs",void 0),h([p({type:Number,nonNullable:!0,json:{read:{source:"properties.thumbMovingRate"},write:{target:"properties.thumbMovingRate",isRequired:!0}}})],On.prototype,"stopDelay",void 0),h([p({type:gH,json:{read:{source:"properties.timeStopInterval"},write:{target:"properties.timeStopInterval",overridePolicy(){var t;const i=this.numStops!=null,e=!!((t=this.stops)!=null&&t.length);return{enabled:!e,isRequired:!(i||e)}}}}})],On.prototype,"stopInterval",void 0),h([Dl("stopInterval")],On.prototype,"readStopInterval",null),h([Cs("stopInterval")],On.prototype,"writeStopInterval",null),h([p({type:[Date],json:{read:{source:"properties.stops"},write:{target:"properties.stops",overridePolicy(){return{isRequired:this.numStops==null&&!this.stopInterval}}}}})],On.prototype,"stops",void 0),h([Dl("stops")],On.prototype,"readStops",null),h([Cs("stops")],On.prototype,"writeStops",null),On=N$=h([D("esri.webdoc.widgets.TimeSlider")],On);const ILe=On;var k$;let Uy=k$=class extends mt{constructor(i){super(i),this.range=null,this.timeSlider=null,this.floorFilter=null}clone(){return new k$(Rr({range:this.range,timeSlider:this.timeSlider,floorFilter:this.floorFilter}))}};h([p({type:MLe,json:{write:!0}})],Uy.prototype,"range",void 0),h([p({type:ILe,json:{write:!0}})],Uy.prototype,"timeSlider",void 0),h([p({type:OLe,json:{write:!0}})],Uy.prototype,"floorFilter",void 0),Uy=k$=h([D("esri.webdoc.Widgets")],Uy);const LLe=Uy,$Le={width:600,height:400},gS=1.5;function DLe(i,e){e=e||$Le;let{width:t,height:r}=e;const n=t/r;return n<gS?r=t/gS:n>gS&&(t=r*gS),t>i.width&&(r*=i.width/t,t=i.width),r>i.height&&(t*=i.height/r,r=i.height),{width:Math.round(t),height:Math.round(r)}}function XB(i){return{enabled:!!(i!=null&&i.length)}}var V$;let zy=V$=class extends mt{constructor(i){super(i),this.exactMatch=!1,this.name=null,this.type=null}clone(){return new V$({exactMatch:this.exactMatch,type:this.type,name:this.name})}};h([p({type:Boolean,json:{write:!0}})],zy.prototype,"exactMatch",void 0),h([p({type:String,json:{write:!0}})],zy.prototype,"name",void 0),h([Ra(_H)],zy.prototype,"type",void 0),zy=V$=h([D("esri.webdoc.applicationProperties.SearchLayerField")],zy);const FLe=zy;var U$;let By=U$=class extends mt{constructor(i){super(i),this.field=null,this.id=null,this.subLayer=null}clone(){return new U$(Rr({field:this.field,id:this.id,subLayer:this.subLayer}))}};h([p({type:FLe,json:{write:{isRequired:!0}}})],By.prototype,"field",void 0),h([p({type:String,json:{write:{isRequired:!0}}})],By.prototype,"id",void 0),h([p({type:nI,json:{write:!0}})],By.prototype,"subLayer",void 0),By=U$=h([D("esri.webdoc.applicationProperties.SearchLayer")],By);const NLe=By;var z$;let Gy=z$=class extends mt{constructor(i){super(i),this.exactMatch=!1,this.name=null,this.type=null}clone(){return new z$({exactMatch:this.exactMatch,type:this.type,name:this.name})}};h([p({type:Boolean,json:{write:!0}})],Gy.prototype,"exactMatch",void 0),h([p({type:String,json:{write:!0}})],Gy.prototype,"name",void 0),h([Ra(_H)],Gy.prototype,"type",void 0),Gy=z$=h([D("esri.webdoc.applicationProperties.SearchTableField")],Gy);const kLe=Gy;var B$;let Eb=B$=class extends mt{constructor(i){super(i),this.field=null,this.id=null}clone(){return new B$(Rr({field:this.field,id:this.id}))}};h([p({type:kLe,json:{write:{isRequired:!0}}})],Eb.prototype,"field",void 0),h([p({type:String,json:{write:{isRequired:!0}}})],Eb.prototype,"id",void 0),Eb=B$=h([D("esri.webdoc.applicationProperties.SearchTable")],Eb);const VLe=Eb;var G$;const Tee=pt.ofType(NLe),Cee=pt.ofType(VLe);let Ph=G$=class extends mt{constructor(i){super(i),this.addressSearchEnabled=!0,this.enabled=!0,this.hintText=null,this.layers=new Tee,this.tables=new Cee}readAddressSearchEnabled(i){return!i}writeAddressSearchEnabled(i,e,t){e[t]=!i}clone(){return new G$(Rr({addressSearchEnabled:this.addressSearchEnabled,enabled:this.enabled,hintText:this.hintText,layers:this.layers,tables:this.tables}))}};h([p({type:Boolean,nonNullable:!0,json:{read:{source:"disablePlaceFinder"},write:{target:"disablePlaceFinder",isRequired:!0},origins:{"web-scene":{read:!1,write:!1}}}})],Ph.prototype,"addressSearchEnabled",void 0),h([Dl("addressSearchEnabled")],Ph.prototype,"readAddressSearchEnabled",null),h([Cs("addressSearchEnabled")],Ph.prototype,"writeAddressSearchEnabled",null),h([p({type:Boolean,nonNullable:!0,json:{write:!0,origins:{"web-map":{write:{isRequired:!0}},"web-scene":{default:!0,write:!0}}}})],Ph.prototype,"enabled",void 0),h([p({type:String,json:{write:!0}})],Ph.prototype,"hintText",void 0),h([p({type:Tee,json:{write:{overridePolicy:XB},origins:{"web-scene":{write:{isRequired:!0}}}}})],Ph.prototype,"layers",void 0),h([p({type:Cee,json:{read:!0,write:{overridePolicy:XB}}})],Ph.prototype,"tables",void 0),Ph=G$=h([D("esri.webdoc.applicationProperties.Search")],Ph);const ULe=Ph;var H$;let CE=H$=class extends mt{constructor(i){super(i),this.search=null}clone(){return new H$(Rr({search:this.search}))}};h([p({type:ULe,json:{write:!0}})],CE.prototype,"search",void 0),CE=H$=h([D("esri.webdoc.applicationProperties.Viewing")],CE);const zLe=CE;var j$;let Hy=j$=class extends mt{constructor(i){super(i),this.editing=null,this.offline=null,this.viewing=null}clone(){return new j$(Rr({editing:this.editing,offline:this.offline,viewing:this.viewing}))}};h([p({json:{write:!0}})],Hy.prototype,"editing",void 0),h([p({json:{write:!0}})],Hy.prototype,"offline",void 0),h([p({type:zLe,json:{write:!0}})],Hy.prototype,"viewing",void 0),Hy=j$=h([D("esri.webmap.ApplicationProperties")],Hy);const BLe=Hy;var q$;let Cg=q$=class extends mt{constructor(){super(...arguments),this.url=""}destroy(){this.url=""}clone(){return new q$({url:this.url})}};h([p({type:String,json:{write:{isRequired:!0}}})],Cg.prototype,"url",void 0),Cg=q$=h([D("esri.webdoc.support.SlideThumbnail")],Cg);var W$;let Rh=W$=class extends sD(mt){constructor(i){super(i),this.name=null,this.thumbnail=new Cg,this.timeExtent=null}castThumbnail(i){return typeof i=="string"?new Cg({url:i}):Ox(Cg,i)}set viewpoint(i){const{targetGeometry:e,scale:t}=i;y(e)&&e.type==="point"&&S(t)&&J.getLogger(this.declaredClass).warn("Bookmark.viewpoint should include 'scale' when its targetGeometry is a point.",i),this._set("viewpoint",i)}readViewpoint(i,e){const{extent:t,viewpoint:r}=e;return rr.fromJSON(r||{targetGeometry:t})}writeViewpoint(i,e,t,r){if(!i)return;const{targetGeometry:n}=i;if(y(n)&&n.type!=="extent"){const s="Bookmark.viewpoint cannot be written to JSON when the viewpoint's targetGeometry is not an extent.";r!=null&&r.messages?r.messages.push(new K("property:unsupported",s)):J.getLogger(this.declaredClass).error(s)}else y(n)&&(e.extent=n.toJSON()),e[t]=i.toJSON()}clone(){return new W$(Rr({name:this.name,thumbnail:this.thumbnail,timeExtent:this.timeExtent,viewpoint:this.viewpoint}))}};h([p({type:String,nonNullable:!0,json:{write:{isRequired:!0}}})],Rh.prototype,"name",void 0),h([p({type:Cg,json:{write:{overridePolicy:i=>({enabled:!(!i||!i.url)})}}})],Rh.prototype,"thumbnail",void 0),h([qr("thumbnail")],Rh.prototype,"castThumbnail",null),h([p({type:H0,json:{write:!0}})],Rh.prototype,"timeExtent",void 0),h([p({type:rr,nonNullable:!0,json:{write:!0}})],Rh.prototype,"viewpoint",null),h([Dl("viewpoint",["extent","viewpoint"])],Rh.prototype,"readViewpoint",null),h([Cs("viewpoint")],Rh.prototype,"writeViewpoint",null),Rh=W$=h([D("esri.webmap.Bookmark")],Rh);const GLe=Rh;var X$;let Wf=X$=class extends ue{constructor(i){super(i),this.background=null,this.rangeInfo=null,this.spatialReference=null,this.viewpoint=null}clone(){return new X$(Rr({background:this.background,rangeInfo:this.rangeInfo,spatialReference:this.spatialReference,viewpoint:this.viewpoint}))}};h([p({type:uR})],Wf.prototype,"background",void 0),h([p({type:X4})],Wf.prototype,"rangeInfo",void 0),h([p({type:Qt})],Wf.prototype,"spatialReference",void 0),h([p({type:rr})],Wf.prototype,"viewpoint",void 0),Wf=X$=h([D("esri.webmap.InitialViewProperties")],Wf);const SE=Wf;class hw extends Mae{constructor(e,t){super(e,t,"webmap")}}const EE=new hw(2,26),JM="Web Map",See=pt.ofType(GLe),HLe=pt.ofType(bee),Pb=new Map;Pb.set("image/jpeg","jpeg"),Pb.set("image/jpg","jpg"),Pb.set("image/png","png"),Pb.set("image/gif","gif");const jLe="ArcGIS Pro",QB=ZD.JSAPI,ZB="CollectorDisabled",YB="Collector",KB="Data Editing",JB="OfflineDisabled",e7="Offline",t7="Workforce Project",i7="Workforce Worker",r7="Workforce Dispatcher",qLe="Offline Map Areas",WLe="FieldMapsDisabled",n7=ZD.DEVELOPER_BASEMAP,s7="UtilityNetwork",XLe=["NatGeo_World_Map","Ocean_Basemap","USA_Topo_Maps","World_Imagery","World_Street_Map","World_Terrain_Base","World_Topo_Map","World_Hillshade","Canvas/World_Light_Gray_Base","Canvas/World_Light_Gray_Reference","Canvas/World_Dark_Gray_Base","Canvas/World_Dark_Gray_Reference","Ocean/World_Ocean_Base","Ocean/World_Ocean_Reference","Reference/World_Boundaries_and_Places","Reference/World_Reference_Overlay","Reference/World_Transportation"].map(i=>i.toLowerCase());let Ri=class extends mH(Am.LoadableMixin(cD(lR))){constructor(i){super(i),this.applicationProperties=null,this.bookmarks=new See,this.floorInfo=null,this.geotriggersInfo=null,this.initialViewProperties=new SE,this.portalItem=null,this.presentation=null,this.sourceVersion=null,this.widgets=null,this.utilityNetworks=null,this.authoringApp=this.authoringAppVersion=null,this._isAuthoringAppSetByUser=this._isAuthoringAppVersionSetByUser=!1}destroy(){const i=this.portalItem;this.portalItem=null,i==null||i.destroy()}initialize(){if(this.when().catch(i=>{J.getLogger(this.declaredClass).error("#load()","Failed to load web map",i)}),this.resourceInfo){let i;try{i=this._validateJSON(this.resourceInfo)}catch(e){return void this.addResolvingPromise(Promise.reject(e))}this.read(i)}}set authoringApp(i){this._isAuthoringAppSetByUser=!0,this._set("authoringApp",i)}writeAuthoringApp(i,e){i&&this._isAuthoringAppSetByUser?e.authoringApp=i:e.authoringApp=QB}set authoringAppVersion(i){this._isAuthoringAppVersionSetByUser=!0,this._set("authoringAppVersion",i)}writeAuthoringAppVersion(i,e){i&&this._isAuthoringAppVersionSetByUser?e.authoringAppVersion=i:e.authoringAppVersion=eie}readInitialViewProperties(i,e){var n;const t=new SE;e.background&&(t.background=uR.fromJSON(e.background));const r=(n=e.initialState)==null?void 0:n.viewpoint;return r&&(r.rotation&&hw.parse(e.version||"","webmap").lessThan(2,20)&&e.authoringApp===jLe&&(r.rotation*=-1),t.viewpoint=rr.fromJSON(r)),e.mapRangeInfo&&(t.rangeInfo=X4.fromJSON(e.mapRangeInfo)),e.spatialReference&&(t.spatialReference=Qt.fromJSON(e.spatialReference)),t}writeInitialViewProperties(i,e,t,r){if(!i)return;const n=i.background;n&&n.color&&(e.background=n.write({},r)),i.viewpoint&&(e.initialState={viewpoint:i.viewpoint.write({},r)}),i.rangeInfo&&(e.mapRangeInfo=i.rangeInfo.toJSON(r)),i.spatialReference&&(e.spatialReference=i.spatialReference.write({},r))}writeLayers(i,e,t,r){e[t]=this._writeLayers(i,r,"operational-layers")}readSourceVersion(i,e){const[t,r]=e.version.split(".");return new hw(parseInt(t,10),parseInt(r,10))}writeSourceVersion(i,e,t){e[t]=`${EE.major}.${EE.minor}`}writeTables(i,e,t,r){const n=this._writeLayers(i,r,"tables");n.length&&(e[t]=n)}get thumbnailUrl(){return this.portalItem&&this.portalItem.thumbnailUrl||null}set thumbnailUrl(i){i?(this._override("thumbnailUrl",i),this._thumbnailFilename=this._generateCustomThumbnailFilename(i)):this._clearThumbnailOverride()}load(i){return this.addResolvingPromise(this._loadFromSource()),Promise.resolve(this)}loadAll(){return G7(this,i=>{i(this.ground,this.basemap,this.layers,this.tables)})}read(i,e){e={...e,origin:"web-map"};const t=this._getAuthoringPropsState();Lee(this,i,r=>super.read(i,r),e),this._restoreAuthoringPropsFromState(t)}write(i,e){if(this.loadStatus!=="loaded"){const t=new K("webmap:not-loaded","Web map must be loaded before it can be serialized");throw J.getLogger(this.declaredClass).error("#toJSON()","Web map must be loaded before it can be serialized",this.loadError||this.loadStatus),t}return this._removeDanglingLayerRefs(),e={...e,origin:"web-map",restrictedWebMapWriting:!0,webmap:this},super.write(i,e)}async save(i){i=i||{},this._validateItem(),await this._updateFromPromise,await this.load(),await this._loadLayerContainers(),await this._beforeSave(),await this._validateMap();const e=this.portalItem,t={origin:"web-map",messages:[],writtenProperties:[],url:e.itemUrl&&hI(e.itemUrl),portal:e.portal||$1.getDefault()},r=this.write({},t);return this._validateJSONForWriting(t,i),await this._updateItemProperties(e),await this._updateItem(e,r,t),await this._updateItemThumbnail(),e}async saveAs(i,e){e=e||{};const t=this._getPortalItem(i);await this._updateFromPromise,await this.load(),await this._loadLayerContainers(),await this._beforeSave(),await this._validateMap();const r={origin:"web-map",messages:[],writtenProperties:[],url:null,portal:t.portal},n=this.write({},r);this._validateJSONForWriting(r,e),await this._updateItemPropertiesForSaveAs(t);const s=this._getThumbnailState();return await this._createItem(t,n,r,e),this._restoreThumbnailFromState(s),await this._updateItemThumbnail(),t}async updateFrom(i,e){const t=this._updateFromInternal(i,e);this._updateFromPromise=t,await t,t===this._updateFromPromise&&(this._updateFromPromise=null)}getLayerJSONFromResourceInfo(i){var t,r,n,s;const e=this.resourceInfo;return this._collectAllLayersJSON([...((t=e==null?void 0:e.baseMap)==null?void 0:t.baseMapLayers)||[],...(e==null?void 0:e.operationalLayers)||[],...((s=(n=(r=this.basemap)==null?void 0:r.resourceInfo)==null?void 0:n.data)==null?void 0:s.baseMapLayers)||[]]).find(a=>a.id===i.id)}_collectAllLayersJSON(i){return i.reduce((e,t)=>(e.push(t),t.layerType==="GroupLayer"&&(e=e.concat(this._collectAllLayersJSON(t.layers||[]))),e),[])}_writeLayers(i,e,t){return e={...e,layerContainerType:t},i.map(r=>ct(Oae(r,t==="tables"?null:this.getLayerJSONFromResourceInfo(r),e))).filter(Boolean).toArray()}_loadFromSource(){return this.resourceInfo?this._loadFromJSON(this.resourceInfo,{origin:"web-map"}):this.portalItem&&this.portalItem.id?this._loadFromItem(this.portalItem):Promise.resolve(null)}_loadFromItem(i){return i.load().catch(e=>{throw new K("webmap:load-portal-item","Failed to load portal item",{error:e})}).then(()=>{if(i.type!=="Web Map")throw new K("webmap:invalid-portal-item","Invalid portal item type '${type}', expected 'Web Map'",{type:i.type})}).then(()=>i.fetchData()).then(e=>(this.resourceInfo=e,this._readAndLoadFromJSON(e,{origin:"web-map",portal:i.portal||$1.getDefault()}))).then(()=>this._computeInitialViewpoint())}_readAndLoadFromJSON(i,e){const t=this._validateJSON(i);return this.read(t,e),this._loadFromJSON(t,e)}_validateJSON(i){const e=hw.parse(i.version||"","webmap");return EE.validate(e),i.version=`${e.major}.${e.minor}`,i}_loadFromJSON(i,e){const t={context:{...e,layerContainerType:"operational-layers"}};return this.portalItem&&(t.context.portal=this.portalItem.portal||$1.getDefault()),G(()=>import("./layersCreator-af14d2eb.js"),["assets/layersCreator-af14d2eb.js","assets/Collection-910b6f71.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/lazyLayerLoader-41b90a4f.js","assets/preload-helper-3bce6601.js","assets/PortalItem-bb7e98a6.js","assets/assets-8d3e737a.js","assets/request-6fc81c4c.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Portal-2bb189b3.js","assets/locale-30120714.js","assets/PortalGroup-8e41557a.js","assets/jsonMap-7b8332c9.js","assets/PortalUser-659cc1d2.js","assets/portalLayers-bc22a371.js","assets/layersLoader-89454f28.js","assets/Layer-5ffe0eda.js","assets/geometry-b7901087.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/Identifiable-bfe1ff30.js","assets/arcgisLayerUrl-c09f09b4.js","assets/persistableUrlUtils-5f719c3b.js","assets/jsonContext-a007a25f.js","assets/portalItemUtils-2ccd793f.js","assets/projection-290b739f.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/aaBoundingRect-193543b5.js","assets/zscale-89472cba.js","assets/styleUtils-a989c0af.js","assets/asyncUtils-437defc4.js"]).then(({populateOperationalLayers:r})=>{const n=[],s=i.operationalLayers;s&&s.length&&n.push(r(this.layers,s,t));const a={...t,context:{...t.context,layerContainerType:"tables"},defaultLayerType:"ArcGISFeatureLayer"},o=i.tables;return o&&o.length&&n.push(r(this.tables,o,a)),Yo(n).then(()=>{})})}async _computeInitialViewpoint(){var r;let i=this.initialViewProperties;if((r=i==null?void 0:i.viewpoint)==null?void 0:r.targetGeometry)return;const t=await this._getExtentFromItem();t&&(i=i?i.clone():new SE,i.viewpoint=new rr,i.viewpoint.targetGeometry=t,this.initialViewProperties=i)}async _getExtentFromItem(){var t,r;const i=(t=this.initialViewProperties)==null?void 0:t.spatialReference,e=(r=this.portalItem)==null?void 0:r.extent;return i&&e?i.isWGS84?e.clone():i.isWebMercator?_P(e):(await G(()=>Promise.resolve().then(()=>d$),void 0)).getGeometryServiceURL(this.portalItem).then(n=>{const s=new _x;return s.geometries=[e],s.outSpatialReference=i,oP(n,s)}).then(n=>n[0]).catch(n=>(J.getLogger(this.declaredClass).error("Error projecting item's extent:",n),null)):null}_removeDanglingLayerRefs(){const i=this.applicationProperties,e=i&&i.viewing&&i.viewing.search,t=s=>this.allLayers.some(a=>a.id===s);e&&e.layers&&(e.layers=e.layers.filter(s=>t(s.id))),e&&e.tables&&(e.tables=e.tables.filter(s=>this.tables.some(a=>a.id===s.id)));const r=i&&i.editing&&i.editing.locationTracking;r&&r.info&&!t(r.info.layerId)&&(i.editing=null);const n=this.presentation&&this.presentation.slides;n&&n.forEach(s=>{s.visibleLayers&&(s.visibleLayers=s.visibleLayers.filter(a=>t(a.id)))})}async _validateMap(){var e;if(!((e=this.basemap)!=null&&e.baseLayers.length))throw new K("webmap:save","Map does not have a valid basemap with a base layer.");let i=null;if(await Pm(()=>{const t=Nde(this.initialViewProperties,this.basemap);return i=t.spatialReference,!t.updating}),!Bm(i,this.initialViewProperties.spatialReference))throw new K("webmap:save","The spatial reference of the basemap is not compatible with the one from the map.",{expected:this.initialViewProperties.spatialReference,actual:i})}_validateItem(){if(!this.portalItem)throw J.getLogger(this.declaredClass).error("save: requires the portalItem property to be set"),new K("webmap:portal-item-not-set","Portal item to save to has not been set on the WebMap");this._validateItemType(this.portalItem)}_validateItemType(i){if(i.type!==JM)throw new K("webmap:portal-item-wrong-type",`Portal item needs to have type "${JM}"`)}_loadLayerContainers(){const i=[];return this.basemap&&i.push(this.basemap.load()),this.ground&&i.push(this.ground.load()),Yo(i).then(()=>{})}async _beforeSave(){const i=[];for(const e of this.allLayers)if("beforeSave"in e&&typeof e.beforeSave=="function"){const t=e.beforeSave();t&&i.push(t)}await Yo(i)}_loadAllLayers(){const i=this._getAllLayersAndTables().map(e=>e.load());return Yo(i).then(()=>{})}_getAllLayersAndTables(){return this.allLayers.concat(this.allTables)}_validateJSONForWriting(i,e){let t=i.messages.filter(r=>r.type==="error").map(r=>new K(r.name,r.message,r.details));if(e.ignoreUnsupported&&(t=t.filter(r=>r.name!=="layer:unsupported"&&r.name!=="symbol:unsupported"&&r.name!=="symbol-layer:unsupported"&&r.name!=="property:unsupported"&&r.name!=="url:unsupported")),t.length>0)throw new K("webmap:save","Failed to save webmap due to unsupported or invalid content. See 'details.errors' for more detailed information",{errors:t})}async _updateItemProperties(i){i.extent=await this._getWGS84Extent(this.initialViewProperties.viewpoint.targetGeometry),await this._updateTypeKeywords(i)}async _updateItemPropertiesForSaveAs(i){xo(i,ZB),xo(i,WLe),xo(i,ZD.METADATA),xo(i,JB),xo(i,qLe),xo(i,r7),xo(i,t7),xo(i,i7),await this._updateItemProperties(i)}async _getWGS84Extent(i){const e=i.clone().normalize();let t;if(e.length>1)for(const r of e)t?r.width>t.width&&(t=r):t=r;else t=e[0];return this._projectToWGS84(t)}async _projectToWGS84(i){const e=i.spatialReference;if(e.isWGS84)return i.clone();if(e.isWebMercator)return Kee(i);const t=await G(()=>Promise.resolve().then(()=>d$),void 0),r=await t.getGeometryServiceURL(this.portalItem),n=new _x;return n.geometries=[i],n.outSpatialReference=Qt.WGS84,(await oP(r,n))[0]}async _updateTypeKeywords(i){x_(i,QB),await this._loadAllLayers(),this._evalCollectorKeyword(i),this._evalDataEditingKeyword(i),this._evalOfflineKeyword(i),this._evalDeveloperBasemapKeyword(i),this._evalUtilityNetworkKeyword(i),i.typeKeywords&&(i.typeKeywords=i.typeKeywords.filter((e,t,r)=>r.indexOf(e)===t))}_evalCollectorKeyword(i){Nv(i,ZB)||Nv(i,t7)||Nv(i,i7)||Nv(i,r7)||!this._hasEditableFeatureLayer()?xo(i,YB):x_(i,YB)}_evalDataEditingKeyword(i){this._hasEditableFeatureLayer()?x_(i,KB):xo(i,KB)}_evalOfflineKeyword(i){!Nv(i,JB)&&this._isOfflineCapableMap()?x_(i,e7):xo(i,e7)}_evalDeveloperBasemapKeyword(i){Fde(this.basemap)?x_(i,n7):xo(i,n7)}_evalUtilityNetworkKeyword(i){var e;(e=this.utilityNetworks)!=null&&e.length?x_(i,s7):xo(i,s7)}_hasEditableFeatureLayer(){return this._getAllLayersAndTables().some(i=>i.loaded&&P5(i)&&i.capabilities.operations.supportsEditing&&i.editingEnabled)}_isOfflineCapableMap(){return this._getAllLayersAndTables().filter(i=>i.type!=="group").every(i=>i.loaded&&this._isOfflineCapableLayer(i))}_isFeatureCollectionLike(i){return Pre(i)||i.type==="map-notes"||i.type==="route"}_isOfflineCapableLayer(i){return P5(i)&&i.capabilities.operations.supportsSync||this._isFeatureCollectionLike(i)&&!i.portalItem||(i.type==="tile"||i.type==="vector-tile")&&(i.capabilities.operations.supportsExportTiles||this._isExportableAGOLTileLayer(i)||lW(i))&&i.spatialReference.equals(this.initialViewProperties.spatialReference)}_isExportableAGOLTileLayer(i){return i.type==="tile"&&Rie(i.url)&&XLe.some(e=>i.url.toLowerCase().includes("/"+e+"/"))}async _updateItem(i,e,t){await i.update({data:e}),this._syncUpInstanceWithItem(i,e,t)}async _createItem(i,e,t,r){const n=this.portalItem,s=!!(n&&n.id&&n.portal.user),a=i.portal;if(await a._signIn(),!await this._canCopyItem(n,s,a))throw new K("webmap:save-as-copy-not-allowed","Owner of this map does not allow others to save a copy");await a.user.addItem({item:i,folder:r.folder,data:e}),this.portalItem=i,this._syncUpInstanceWithItem(i,e,t)}async _canCopyItem(i,e,t){return!(y(i)&&i.id&&i.typeKeywords&&i.typeKeywords.includes("useOnly"))||i.portal.portalHostname===t.portalHostname&&(e||await i.reload(),i.itemControl==="admin"||i.itemControl==="update")}_syncUpInstanceWithItem(i,e,t){fH.prototype.read.call(this,{version:e.version,authoringApp:e.authoringApp,authoringAppVersion:e.authoringAppVersion},{origin:"web-map",ignoreDefaults:!0,url:i.itemUrl&&hI(i.itemUrl)}),Rae(t),this.resourceInfo=e}async _updateItemThumbnail(){this.thumbnailUrl&&this._isOverridden("thumbnailUrl")&&(await this.portalItem.updateThumbnail({thumbnail:this.thumbnailUrl,filename:this._thumbnailFilename}),this._clearThumbnailOverride())}_getPortalItem(i){let e=jE.from(i);return e.id&&(e=e.clone(),e.id=null),e.type||(e.type=JM),e.portal||(e.portal=$1.getDefault()),this._validateItemType(e),e}async _updateFromInternal(i,e){if(e=e||{},await Pm(()=>i.ready),this._updateInitialViewProperties(i,e),i.map===this)for(const t of i.allLayerViews)for(const r of["visible","featureEffect"])r in t&&r in t.layer&&t._isOverridden(r)&&(t.layer[r]=t[r]);await this._updateThumbnailUrl(i,e)}_updateInitialViewProperties(i,e){var t;if(e.backgroundExcluded||(this.initialViewProperties.background=(t=i.background)==null?void 0:t.clone()),this.initialViewProperties.spatialReference=i.spatialReference.clone(),e.viewpointExcluded||(this.initialViewProperties.viewpoint=new rr({rotation:i.rotation,scale:e.scalePreserved?i.scale:null,targetGeometry:this._getViewExtent(i)})),!e.widgetsExcluded)for(const r of i.persistableViewModels)r.updateWebDocument(this)}_getViewExtent(i){const e=i.center.clone().normalize(),t=i.extent.clone(),r=t.width/2;return t.xmin=e.x-r,t.xmax=e.x+r,t}async _updateThumbnailUrl(i,e){if(e.thumbnailExcluded)return;const t=DLe(i,e.thumbnailSize),r=await i.takeScreenshot({format:"png",width:t.width,height:t.height});this._setAutoGeneratedThumbnail(r.dataUrl)}_setAutoGeneratedThumbnail(i){this.thumbnailUrl=i,this._thumbnailFilename=null}_clearThumbnailOverride(){this._clearOverride("thumbnailUrl"),this.clear("thumbnailUrl","user"),this._thumbnailFilename=null}_generateCustomThumbnailFilename(i){if(tie(i)){const e=D7(i),t=e&&e.mediaType,r=t&&Pb.get(t.toLowerCase())||null,n=`thumbnail${Date.now()}`;return r?`${n}.${r}`:n}return null}_getThumbnailState(){let i=this.thumbnailUrl;return i&&(i=this._isOverridden("thumbnailUrl")?i:iie(i,"w","8192")),{thumbnailUrl:i,filename:this._thumbnailFilename}}_restoreThumbnailFromState(i){this.thumbnailUrl=i.thumbnailUrl,this._thumbnailFilename=i.filename}_getAuthoringPropsState(){return{authoringApp:this.authoringApp,authoringAppVersion:this.authoringAppVersion,isAuthoringAppSetByUser:this._isAuthoringAppSetByUser,isAuthoringAppVersionSetByUser:this._isAuthoringAppVersionSetByUser}}_restoreAuthoringPropsFromState(i){i.isAuthoringAppSetByUser?this.authoringApp=i.authoringApp:this._isAuthoringAppSetByUser=!1,i.isAuthoringAppVersionSetByUser?this.authoringAppVersion=i.authoringAppVersion:this._isAuthoringAppVersionSetByUser=!1}static fromJSON(i){const e=i;if(!e)throw new K("webmap:empty-resource","Expected a JSON resource but got nothing");return new this({resourceInfo:e})}};Ri.VERSION=EE,h([p({type:BLe,json:{write:!0}})],Ri.prototype,"applicationProperties",void 0),h([p({type:String,json:{write:{allowNull:!0,ignoreOrigin:!0}}})],Ri.prototype,"authoringApp",null),h([Cs("authoringApp")],Ri.prototype,"writeAuthoringApp",null),h([p({type:String,json:{write:{allowNull:!0,ignoreOrigin:!0}}})],Ri.prototype,"authoringAppVersion",null),h([Cs("authoringAppVersion")],Ri.prototype,"writeAuthoringAppVersion",null),h([p({json:{read:{source:"baseMap"},write:{target:"baseMap"}}})],Ri.prototype,"basemap",void 0),h([p({type:See,json:{write:{overridePolicy:i=>({enabled:!!(i&&i.length>0),ignoreOrigin:!0})}}})],Ri.prototype,"bookmarks",void 0),h([p({type:vLe,json:{read:{source:"mapFloorInfo"},write:{target:"mapFloorInfo"}}})],Ri.prototype,"floorInfo",void 0),h([p({type:ALe,json:{write:!0}})],Ri.prototype,"geotriggersInfo",void 0),h([p({type:SE,nonNullable:!0,json:{read:{source:["background","initialState.viewpoint","mapRangeInfo","spatialReference"]},write:{ignoreOrigin:!0,target:{background:{type:uR},"initialState.viewpoint":{type:rr},mapRangeInfo:{type:X4},spatialReference:{type:Qt}}}}})],Ri.prototype,"initialViewProperties",void 0),h([Dl("initialViewProperties")],Ri.prototype,"readInitialViewProperties",null),h([Cs("initialViewProperties")],Ri.prototype,"writeInitialViewProperties",null),h([p({json:{read:!1,write:{target:"operationalLayers",ignoreOrigin:!0}}})],Ri.prototype,"layers",void 0),h([Cs("layers")],Ri.prototype,"writeLayers",null),h([p({type:jE})],Ri.prototype,"portalItem",void 0),h([p({json:{write:!0}})],Ri.prototype,"presentation",void 0),h([p()],Ri.prototype,"resourceInfo",void 0),h([p({readOnly:!0,type:hw,json:{read:{source:"version"},write:{allowNull:!0,ignoreOrigin:!0,target:"version",isRequired:!0}}})],Ri.prototype,"sourceVersion",void 0),h([Dl("sourceVersion")],Ri.prototype,"readSourceVersion",null),h([Cs("sourceVersion")],Ri.prototype,"writeSourceVersion",null),h([p({json:{read:!1,write:{ignoreOrigin:!0}}})],Ri.prototype,"tables",void 0),h([Cs("tables")],Ri.prototype,"writeTables",null),h([p()],Ri.prototype,"thumbnailUrl",null),h([p({type:LLe,json:{write:!0}})],Ri.prototype,"widgets",void 0),h([p({type:HLe,json:{read:!0,write:!0}})],Ri.prototype,"utilityNetworks",void 0),Ri=h([D("esri.WebMap")],Ri);const QLe=Ri;function ZLe(){const i=Pe.useRef(null),[e,t]=Pe.useState(null);Pe.useEffect(()=>{r()},[]);async function r(){if(!(i!=null&&i.current))return;Sg.portalUrl="http://devtesting.mapsdevext.arcgis.com/";const n=new QLe({portalItem:{id:"d8ec80ff66324308b4abd36edf9263e4"}}),s=new lX({container:i==null?void 0:i.current,map:n});t(s)}return Lt("div",{className:"App",children:Lt("div",{id:"view",ref:i})})}function YLe(){return Lt(ohe,{children:nd(ihe,{children:[Lt(V1,{path:"/",element:Lt(hhe,{})}),Lt(V1,{path:"/media-layer-images",element:Lt(n_e,{})}),Lt(V1,{path:"/media-layer-video",element:Lt(tLe,{})}),Lt(V1,{path:"/media-layer-webmap",element:Lt(ZLe,{})})]})})}/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.7
 */function a7(){const{classList:i}=document.body,e=window.matchMedia("(prefers-color-scheme: dark)").matches,t=()=>i.contains(ige)||i.contains(tge)&&e?"dark":"light",r=a=>document.body.dispatchEvent(new CustomEvent("calciteModeChange",{bubbles:!0,detail:{mode:a}})),n=a=>{s!==a&&r(a),s=a};let s=t();r(s),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",a=>n(a.matches?"dark":"light")),new MutationObserver(()=>n(t())).observe(document.body,{attributes:!0,attributeFilter:["class"]})}function KLe(){typeof window<"u"&&typeof location<"u"&&typeof document<"u"&&window.location===location&&window.document===document&&(document.readyState==="interactive"?a7():document.addEventListener("DOMContentLoaded",()=>a7(),{once:!0}))}const JLe=KLe;JLe();dfe(window.location.href);const e$e=FI.createRoot(document.getElementById("root"));e$e.render(Lt(Mw.StrictMode,{children:Lt(YLe,{})}));export{hpe as $,L6e as A,fze as B,Qo as C,m4 as D,$n as E,O6e as F,RW as G,A6e as H,CY as I,jo as J,jxe as K,d2e as L,n4 as M,Gr as N,AK as O,Yh as P,P5e as Q,eke as R,cR as S,d3e as T,A2e as U,ePe as V,oQ as W,Yp as X,cfe as Y,kT as Z,vpe as _,M0 as a,Z4e as a$,Wme as a0,ku as a1,tBe as a2,aBe as a3,MM as a4,nBe as a5,rBe as a6,tpe as a7,Z5e as a8,fRe as a9,PBe as aA,so as aB,Oh as aC,KA as aD,y4 as aE,Ur as aF,tY as aG,$d as aH,Jx as aI,YL as aJ,tP as aK,cze as aL,YRe as aM,$Pe as aN,DPe as aO,h9e as aP,o9e as aQ,l9e as aR,Gh as aS,r8e as aT,Bd as aU,g0 as aV,KUe as aW,s$ as aX,rR as aY,X4e as aZ,Q4e as a_,dBe as aa,O4 as ab,G9e as ac,jt as ad,Fi as ae,ki as af,hv as ag,R5e as ah,Q2e as ai,LR as aj,PTe as ak,Ui as al,NN as am,GOe as an,tW as ao,V0 as ap,E6e as aq,$7e as ar,Qc as as,R6e as at,pxe as au,Uh as av,A5e as aw,iPe as ax,rLe as ay,iLe as az,HZ as b,VJ as b$,Y4e as b0,c9e as b1,a_e as b2,lxe as b3,lV as b4,j9e as b5,oV as b6,sY as b7,B9e as b8,B5e as b9,o_ as bA,uLe as bB,WK as bC,_Ae as bD,Wb as bE,sye as bF,cye as bG,wQ as bH,bQ as bI,gye as bJ,MN as bK,Cye as bL,AQ as bM,LN as bN,Aye as bO,Vye as bP,r0e as bQ,Xg as bR,HAe as bS,ZOe as bT,G4 as bU,OJ as bV,oMe as bW,LJ as bX,cMe as bY,FJ as bZ,uMe as b_,HCe as ba,yi as bb,C6e as bc,rZ as bd,C8 as be,W8 as bf,Yw as bg,lv as bh,AL as bi,jR as bj,H3e as bk,eHe as bl,iHe as bm,tHe as bn,aV as bo,gh as bp,TN as bq,C1e as br,CN as bs,zd as bt,g_e as bu,Id as bv,fR as bw,q9e as bx,g6 as by,H9e as bz,jZ as c,pMe as c0,CQ as c1,vye as c2,jRe as c3,HRe as c4,UR as c5,qRe as c6,HMe as c7,jJ as c8,WMe as c9,XJ as ca,QMe as cb,YJ as cc,cIe as cd,HR as ce,_Ie as cf,RIe as cg,OIe as ch,IIe as ci,uIe as cj,ZIe as ck,QX as cl,d_e as cm,ws as cn,i3e as co,J5e as d,BW as e,FMe as f,Qke as g,ew as h,W6e as i,X6e as j,sxe as k,BZ as l,yme as m,PW as n,WUe as o,wpe as p,u2e as q,Gxe as r,v3e as s,zn as t,rr as u,Od as v,$6e as w,Xl as x,N3e as y,S6e as z};
