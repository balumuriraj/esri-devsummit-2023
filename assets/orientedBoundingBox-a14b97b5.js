import{aM as c0,R as A0,$ as g0,bo as F0,aw as Y0,d4 as z0,t as L0,f0 as w,f as X,iX as R0,q as r0,bR as v0,f1 as B0,m as O0,eQ as Q0,an as U0,jx as S0,jy as G0,aW as _0,g as P0,u as i0,o as j0,k as x0,ea as H,jz as k0,e2 as K0}from"./calcite-8912bd40.js";import{e as W0}from"./mat3f64-50f3b9f6.js";import{S as n0,B as V0}from"./quat-7b70e9a8.js";import{r as X0,n as H0}from"./quatf32-51a323b8.js";import{e as f0}from"./quatf64-f8f1c132.js";import{t as J0,e as C0}from"./vec3f32-01c06d8d.js";import{V as u0,Y as h0}from"./plane-5e2b046c.js";import{s as D0}from"./symbolColorUtils-c9d24716.js";var e0;(function(t){t[t.INVISIBLE=0]="INVISIBLE",t[t.TRANSPARENT=1]="TRANSPARENT",t[t.OPAQUE=2]="OPAQUE"})(e0||(e0={}));function Z0(t){return t.type==="fill"}function tt(t){return t.type==="extrude"}function pt(t){return t&&t.enabled&&(tt(t)||Z0(t))&&A0(t.edges)}function nt(t){return t&&t.enabled&&t.edges||null}function wt(t,n){return et(nt(t),n)}function et(t,n){if(g0(t))return null;const e=A0(t.color)?F0(Y0.toUnitRGBA(t.color)):c0(0,0,0,0),r=z0(t.size),i=z0(t.extensionLength);switch(t.type){case"solid":return at({color:e,size:r,extensionLength:i,...n});case"sketch":return rt({color:e,size:r,extensionLength:i,...n});default:return}}function at(t){return{...it,...t,type:"solid"}}function rt(t){return{...ot,...t,type:"sketch"}}const it={color:c0(0,0,0,.2),size:1,extensionLength:0,opacity:1,objectTransparency:e0.OPAQUE,hasSlicePlane:!1},ot={color:c0(0,0,0,.2),size:1,extensionLength:0,opacity:1,objectTransparency:e0.OPAQUE,hasSlicePlane:!1},U=1e-6,G=[0,0,0],J=[0,0,0];function st(t,n){const{data:e,size:r}=t,i=e.length/r;if(i<=0)return;const o=new zt(t);t0(G,o.minProj,o.maxProj),d(G,G,.5),P(J,o.maxProj,o.minProj);const s=o0(J),c=new St;c.quality=s,i<14&&(t=new D0(new Float64Array(o.buffer,112,42),3));const a=[0,0,0],f=[0,0,0],x=[0,0,0],E=[0,0,0],m0=[0,0,0],$0=[0,0,0],b0=[0,0,0];switch(ct(o,t,b0,a,f,x,E,m0,$0,c)){case 1:return void M0(G,J,n);case 2:return void bt(t,E,n)}ft(t,b0,a,f,x,E,m0,$0,c),d0(t,c.b0,c.b1,c.b2,O,Q);const a0=[0,0,0];P(a0,Q,O),c.quality=o0(a0),c.quality<s?p0(c.b0,c.b1,c.b2,O,Q,a0,n):M0(G,J,n)}function ct(t,n,e,r,i,o,s,c,a,f){return ut(t,r,i),s0(r,i)<U?1:(P(s,r,i),h(s,s),ht(n,r,s,o)<U?2:(P(c,i,o),h(c,c),P(a,o,r),h(a,a),j(e,c,s),h(e,e),V(n,e,s,c,a,f),0))}const _=[0,0,0],k=[0,0,0],$=[0,0,0],b=[0,0,0],z=[0,0,0],y=[0,0,0],M=[0,0,0],N=[0,0,0];function ft(t,n,e,r,i,o,s,c,a){lt(t,n,e,_,k),_[0]!==void 0&&(P($,_,e),h($,$),P(b,_,r),h(b,b),P(z,_,i),h(z,z),j(y,b,o),h(y,y),j(M,z,s),h(M,M),j(N,$,c),h(N,N),V(t,y,o,b,$,a),V(t,M,s,z,b,a),V(t,N,c,$,z,a)),k[0]!==void 0&&(P($,k,e),h($,$),P(b,k,r),h(b,b),P(z,k,i),h(z,z),j(y,b,o),h(y,y),j(M,z,s),h(M,M),j(N,$,c),h(N,N),V(t,y,o,b,$,a),V(t,M,s,z,b,a),V(t,N,c,$,z,a))}function ut(t,n,e){let r=s0(t.maxVert[0],t.minVert[0]),i=0;for(let o=1;o<7;++o){const s=s0(t.maxVert[o],t.minVert[o]);s>r&&(r=s,i=o)}l(n,t.minVert[i]),l(e,t.maxVert[i])}const S=[0,0,0];function ht(t,n,e,r){const{data:i,size:o}=t;let s=Number.NEGATIVE_INFINITY,c=0;for(let a=0;a<i.length;a+=o){S[0]=i[a]-n[0],S[1]=i[a+1]-n[1],S[2]=i[a+2]-n[2];const f=e[0]*S[0]+e[1]*S[1]+e[2]*S[2],x=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],E=S[0]*S[0]+S[1]*S[1]+S[2]*S[2]-f*f/x;E>s&&(s=E,c=a)}return l(r,i,c),s}const u=[0,0];function lt(t,n,e,r,i){$t(t,n,u,i,r);const o=E0(e,n);u[1]-U<=o&&(r[0]=void 0),u[0]+U>=o&&(i[0]=void 0)}const q0=[0,0,0],I0=[0,0,0],y0=[0,0,0],T=[0,0,0],g=[0,0,0],C=[0,0,0];function V(t,n,e,r,i,o){if(w0(n)<U)return;j(q0,e,n),j(I0,r,n),j(y0,i,n),B(t,n,u),g[1]=u[0],T[1]=u[1],C[1]=T[1]-g[1];const s=[e,r,i],c=[q0,I0,y0];for(let a=0;a<3;++a){B(t,s[a],u),g[0]=u[0],T[0]=u[1],B(t,c[a],u),g[2]=u[0],T[2]=u[1],C[0]=T[0]-g[0],C[2]=T[2]-g[2];const f=o0(C);f<o.quality&&(l(o.b0,s[a]),l(o.b1,n),l(o.b2,c[a]),o.quality=f)}}const mt=[0,0,0];function B(t,n,e){const{data:r,size:i}=t;e[0]=Number.POSITIVE_INFINITY,e[1]=Number.NEGATIVE_INFINITY;for(let o=0;o<r.length;o+=i){const s=r[o]*n[0]+r[o+1]*n[1]+r[o+2]*n[2];e[0]=Math.min(e[0],s),e[1]=Math.max(e[1],s)}}function $t(t,n,e,r,i){const{data:o,size:s}=t;l(r,o),l(i,r),e[0]=E0(mt,n),e[1]=e[0];for(let c=s;c<o.length;c+=s){const a=o[c]*n[0]+o[c+1]*n[1]+o[c+2]*n[2];a<e[0]&&(e[0]=a,l(r,o,c)),a>e[1]&&(e[1]=a,l(i,o,c))}}function M0(t,n,e){l(e.center,t),d(e.halfSize,n,.5),e.quaternion[0]=0,e.quaternion[1]=0,e.quaternion[2]=0,e.quaternion[3]=1}const I=[0,0,0],F=[0,0,0],K=[0,0,0],O=[0,0,0],Q=[0,0,0],N0=[0,0,0];function bt(t,n,e){l(I,n),Math.abs(n[0])>Math.abs(n[1])&&Math.abs(n[0])>Math.abs(n[2])?I[0]=0:Math.abs(n[1])>Math.abs(n[2])?I[1]=0:I[2]=0,w0(I)<U&&(I[0]=I[1]=I[2]=1),j(F,n,I),h(F,F),j(K,n,F),h(K,K),d0(t,n,F,K,O,Q),P(N0,Q,O),p0(n,F,K,O,Q,N0,e)}function d0(t,n,e,r,i,o){B(t,n,u),i[0]=u[0],o[0]=u[1],B(t,e,u),i[1]=u[0],o[1]=u[1],B(t,r,u),i[2]=u[0],o[2]=u[1]}const D=[0,0,0],q=[1,0,0,0,1,0,0,0,1],Y=[0,0,0];function p0(t,n,e,r,i,o,s){q[0]=t[0],q[1]=t[1],q[2]=t[2],q[3]=n[0],q[4]=n[1],q[5]=n[2],q[6]=e[0],q[7]=e[1],q[8]=e[2],Pt(s.quaternion,q),t0(Y,r,i),d(Y,Y,.5),d(s.center,t,Y[0]),d(D,n,Y[1]),t0(s.center,s.center,D),d(D,e,Y[2]),t0(s.center,s.center,D),d(s.halfSize,o,.5)}const m=7;class zt{constructor(n){this.minVert=new Array(m),this.maxVert=new Array(m);const e=64*m;this.buffer=new ArrayBuffer(e);let r=0;this.minProj=new Float64Array(this.buffer,r,m),r+=8*m,this.maxProj=new Float64Array(this.buffer,r,m),r+=8*m;for(let a=0;a<m;++a)this.minVert[a]=new Float64Array(this.buffer,r,3),r+=24;for(let a=0;a<m;++a)this.maxVert[a]=new Float64Array(this.buffer,r,3),r+=24;for(let a=0;a<m;++a)this.minProj[a]=Number.POSITIVE_INFINITY,this.maxProj[a]=Number.NEGATIVE_INFINITY;const i=new Array(m),o=new Array(m),{data:s,size:c}=n;for(let a=0;a<s.length;a+=c){let f=s[a];f<this.minProj[0]&&(this.minProj[0]=f,i[0]=a),f>this.maxProj[0]&&(this.maxProj[0]=f,o[0]=a),f=s[a+1],f<this.minProj[1]&&(this.minProj[1]=f,i[1]=a),f>this.maxProj[1]&&(this.maxProj[1]=f,o[1]=a),f=s[a+2],f<this.minProj[2]&&(this.minProj[2]=f,i[2]=a),f>this.maxProj[2]&&(this.maxProj[2]=f,o[2]=a),f=s[a]+s[a+1]+s[a+2],f<this.minProj[3]&&(this.minProj[3]=f,i[3]=a),f>this.maxProj[3]&&(this.maxProj[3]=f,o[3]=a),f=s[a]+s[a+1]-s[a+2],f<this.minProj[4]&&(this.minProj[4]=f,i[4]=a),f>this.maxProj[4]&&(this.maxProj[4]=f,o[4]=a),f=s[a]-s[a+1]+s[a+2],f<this.minProj[5]&&(this.minProj[5]=f,i[5]=a),f>this.maxProj[5]&&(this.maxProj[5]=f,o[5]=a),f=s[a]-s[a+1]-s[a+2],f<this.minProj[6]&&(this.minProj[6]=f,i[6]=a),f>this.maxProj[6]&&(this.maxProj[6]=f,o[6]=a)}for(let a=0;a<m;++a){let f=i[a];l(this.minVert[a],s,f),f=o[a],l(this.maxVert[a],s,f)}}}let St=class{constructor(){this.b0=[1,0,0],this.b1=[0,1,0],this.b2=[0,0,1],this.quality=0}};function o0(t){return t[0]*t[1]+t[0]*t[2]+t[1]*t[2]}function t0(t,n,e){t[0]=n[0]+e[0],t[1]=n[1]+e[1],t[2]=n[2]+e[2]}function P(t,n,e){t[0]=n[0]-e[0],t[1]=n[1]-e[1],t[2]=n[2]-e[2]}function d(t,n,e){t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e}function l(t,n,e=0){t[0]=n[e+0],t[1]=n[e+1],t[2]=n[e+2]}function j(t,n,e){const r=n[0],i=n[1],o=n[2],s=e[0],c=e[1],a=e[2];t[0]=i*a-o*c,t[1]=o*s-r*a,t[2]=r*c-i*s}function h(t,n){const e=n[0]*n[0]+n[1]*n[1]+n[2]*n[2];if(e>0){const r=1/Math.sqrt(e);t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r}}function w0(t){return t[0]*t[0]+t[1]*t[1]+t[2]*t[2]}function s0(t,n){const e=n[0]-t[0],r=n[1]-t[1],i=n[2]-t[2];return e*e+r*r+i*i}function E0(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]}function Pt(t,n){const e=n[0]+n[4]+n[8];if(e>0){let r=Math.sqrt(e+1);t[3]=.5*r,r=.5/r,t[0]=(n[5]-n[7])*r,t[1]=(n[6]-n[2])*r,t[2]=(n[1]-n[3])*r}else{let r=0;n[4]>n[0]&&(r=1),n[8]>n[3*r+r]&&(r=2);const i=(r+1)%3,o=(r+2)%3;let s=Math.sqrt(n[3*r+r]-n[3*i+i]-n[3*o+o]+1);t[r]=.5*s,s=.5/s,t[3]=(n[3*i+o]-n[3*o+i])*s,t[i]=(n[3*i+r]+n[3*r+i])*s,t[o]=(n[3*o+r]+n[3*r+o])*s}}const W=f0(),p=X(),jt=X(),xt=W0();class Tt{constructor(n){const s=n*56;this.buffer=new ArrayBuffer(s),this.obbs=new Array(n);for(let c=0;c<n;c++)this.obbs[c]={center:R0(this.buffer,56*c+0),halfSize:C0(this.buffer,56*c+24),quaternion:H0(this.buffer,56*c+36)}}}function T0(t=[0,0,0],n=[-1,-1,-1],e=f0()){return{center:L0(t),halfSize:J0(n),quaternion:X0(e)}}function gt(t){return T0(t.center,t.halfSize,t.quaternion)}function Ft(t,n){r0(n.center,t.center),r0(n.halfSize,t.halfSize),V0(n.quaternion,t.quaternion)}function Yt(t,n){return n=n||T0(),st(t,n),n}function L(t,n){const e=u0(n,t.center),r=l0(t,h0(n));return e>r?1:e<-r?-1:0}function Lt(t,n){n||(n=v0());const e=B0(xt,t.quaternion),r=t.halfSize[0]*Math.abs(e[0])+t.halfSize[1]*Math.abs(e[3])+t.halfSize[2]*Math.abs(e[6]),i=t.halfSize[0]*Math.abs(e[1])+t.halfSize[1]*Math.abs(e[4])+t.halfSize[2]*Math.abs(e[7]),o=t.halfSize[0]*Math.abs(e[2])+t.halfSize[1]*Math.abs(e[5])+t.halfSize[2]*Math.abs(e[8]);return n[0]=t.center[0]-r,n[1]=t.center[1]-i,n[2]=t.center[2]-o,n[3]=t.center[0]+r,n[4]=t.center[1]+i,n[5]=t.center[2]+o,n}function Rt(t,n){return u0(n,t.center)-l0(t,h0(n))}function vt(t,n){return u0(n,t.center)+l0(t,h0(n))}function Bt(t,n){return L(t,n[0])<=0&&L(t,n[1])<=0&&L(t,n[2])<=0&&L(t,n[3])<=0&&L(t,n[4])<=0&&L(t,n[5])<=0}function Ot(t,n,e,r=0){n0(W,t.quaternion),O0(p,n,t.center);const i=w(p,p,W),o=w(jt,e,W);let s=-1/0,c=1/0;for(let a=0;a<3;a++)if(Math.abs(o[a])>1e-6){const f=(r+t.halfSize[a]-i[a])/o[a],x=(-r-t.halfSize[a]-i[a])/o[a];s=Math.max(s,Math.min(f,x)),c=Math.min(c,Math.max(f,x))}else if(i[a]>t.halfSize[a]+r||i[a]<-t.halfSize[a]-r)return!1;return s<=c}(()=>{const t=new Int8Array(162);let n=0;const e=r=>{for(let i=0;i<r.length;i++)t[n+i]=r[i];n+=6};return e([6,2,3,1,5,4]),e([0,2,3,1,5,4]),e([0,2,3,7,5,4]),e([0,1,3,2,6,4]),e([0,1,3,2,0,0]),e([0,1,5,7,3,2]),e([0,1,3,7,6,4]),e([0,1,3,7,6,2]),e([0,1,5,7,6,2]),e([0,1,5,4,6,2]),e([0,1,5,4,0,0]),e([0,1,3,7,5,4]),e([0,2,6,4,0,0]),e([0,0,0,0,0,0]),e([1,3,7,5,0,0]),e([2,3,7,6,4,0]),e([2,3,7,6,0,0]),e([2,3,1,5,7,6]),e([0,1,5,7,6,2]),e([0,1,5,7,6,4]),e([0,1,3,7,6,4]),e([4,5,7,6,2,0]),e([4,5,7,6,0,0]),e([4,5,1,3,7,6]),e([0,2,3,7,5,4]),e([6,2,3,7,5,4]),e([6,2,3,1,5,4]),t})();function l0(t,n){n0(W,t.quaternion),w(p,n,W);const e=t.halfSize;return Math.abs(p[0]*e[0])+Math.abs(p[1]*e[1])+Math.abs(p[2]*e[2])}function Qt(t,n){for(let e=0;e<8;++e){const r=n[e];r[0]=1&e?-t.halfSize[0]:t.halfSize[0],r[1]=2&e?-t.halfSize[1]:t.halfSize[1],r[2]=4&e?-t.halfSize[2]:t.halfSize[2],w(r,r,t.quaternion),i0(r,r,t.center)}}function Ut(t){return Q0(t.halfSize)}function Gt(t,n,e,r,i){if(V0(i.quaternion,t.quaternion),r===U0.Global){n0(Z,t.quaternion),w(A,t.center,Z),S0(R,A),G0(v,R,t.halfSize),_0(v,R,v);const o=P0(v);i0(v,R,t.halfSize);const s=P0(v);if(o<e)r0(i.center,t.center),j0(A,e,e,e),i0(i.halfSize,t.halfSize,A);else{const c=s>0?1+n/s:1,a=o>0?1+e/o:1,f=(a+c)/2,x=(a-c)/2;x0(i.halfSize,R,x),H(i.halfSize,i.halfSize,t.halfSize,f),x0(i.center,R,f),H(i.center,i.center,t.halfSize,x),k0(A,A),K0(i.center,i.center,A),w(i.center,i.center,i.quaternion)}}else{const o=j0(A,0,0,1);H(i.center,t.center,o,(e+n)/2),n0(Z,t.quaternion),w(o,o,Z),S0(o,o),H(i.halfSize,t.halfSize,o,(e-n)/2)}return i}const A=X(),R=X(),v=X(),Z=f0();export{e0 as A,Tt as L,T0 as N,gt as O,Ft as P,Yt as Q,L as R,Lt as T,Rt as U,vt as W,Bt as X,Ot as Y,pt as a,Ut as b,l0 as e,wt as f,at as m,Gt as n,et as p,Qt as t};
