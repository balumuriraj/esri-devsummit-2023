import{P as s,_ as v,R as k,k as b,m as F,u as q,ao as z,q as j,f as _,o as C,F as L,z as p}from"./calcite-c5ae4991.js";import{r as w,c as E}from"./sphere-5ce3b13c.js";function x(r=g){return[r[0],r[1],r[2],r[3]]}function Z(r=g[0],n=g[1],u=g[2],c=g[3]){return O(r,n,u,c,w.get())}function B(r,n){return O(n[0],n[1],n[2],n[3],r)}function O(r,n,u,c,t=x()){return t[0]=r,t[1]=n,t[2]=u,t[3]=c,t}function D(r,n,u){return j(u,r),u[3]=n,u}function G(r,n,u){const c=n[0]*n[0]+n[1]*n[1]+n[2]*n[2],t=Math.abs(c-1)>1e-5&&c>1e-12?1/Math.sqrt(c):1;return u[0]=n[0]*t,u[1]=n[1]*t,u[2]=n[2]*t,u[3]=-(u[0]*r[0]+u[1]*r[1]+u[2]*r[2]),u}function H(r,n,u,c=x()){const t=u[0]-n[0],I=u[1]-n[1],e=u[2]-n[2],o=r[0]-n[0],i=r[1]-n[1],l=r[2]-n[2],h=I*l-e*i,m=e*o-t*l,P=t*i-I*o,X=h*h+m*m+P*P,y=Math.abs(X-1)>1e-5&&X>1e-12?1/Math.sqrt(X):1;return c[0]=h*y,c[1]=m*y,c[2]=P*y,c[3]=-(c[0]*r[0]+c[1]*r[1]+c[2]*r[2]),c}function J(r,n,u,c,t){const I=r.length/3;if(I<3)return!1;C(M,r[3*u],r[3*u+1],r[3*u+2]);let e=c,o=!1;for(;e<I-1&&!o;){const i=3*e;C(N,r[i],r[i+1],r[i+2]),e++,o=!L(M,N)}if(!o)return!1;for(e=Math.max(e,t),o=!1;e<I&&!o;){const i=3*e;C(a,r[i],r[i+1],r[i+2]),e++,F($,M,N),p($,$),F(A,N,a),p(A,A),o=!L(M,a)&&!L(N,a)&&Math.abs(s($,A))<Q}return o?(H(M,N,a,n),!0):(u!==0||c!==1||t!==2)&&J(r,n,0,1,2)}const Q=.99619469809,M=_(),N=_(),a=_(),$=_(),A=_();function K(r,n,u){return n!==r&&B(r,n),r[3]=-s(r,u),r}function S(r,n){return n[0]=-r[0],n[1]=-r[1],n[2]=-r[2],n[3]=-r[3],n}function rr(r,n,u,c){return v(a,n,r),G(u,a,c)}function nr(r,n,u,c){return T(r,n,F(E.get(),u,n),U,c)}function ur(r,n,u){return!!k(n)&&T(r,n.origin,n.direction,V,u)}function cr(r,n,u){return T(r,n.origin,n.vector,f.NONE,u)}function tr(r,n,u){return T(r,n.origin,n.vector,f.CLAMP,u)}function er(r,n){return d(r,n)>=0}function or(r,n){const u=s(r,n.ray.direction),c=-d(r,n.ray.origin);if(c<0&&u>=0)return!1;if(u>-1e-6&&u<1e-6)return c>0;if((c<0||u<0)&&!(c<0&&u<0))return!0;const t=c/u;return u>0?t<n.c1&&(n.c1=t):t>n.c0&&(n.c0=t),n.c0<=n.c1}function ir(r,n){const u=s(r,n.ray.direction),c=-d(r,n.ray.origin);if(u>-1e-6&&u<1e-6)return c>0;const t=c/u;return u>0?t<n.c1&&(n.c1=t):t>n.c0&&(n.c0=t),n.c0<=n.c1}function fr(r,n,u){const c=b(E.get(),r,-r[3]),t=R(r,F(E.get(),n,c),E.get());return q(u,t,c),u}function R(r,n,u){const c=b(E.get(),r,s(r,n));return F(u,n,c),u}function d(r,n){return s(r,n)+r[3]}function T(r,n,u,c,t){const I=s(r,u);if(I===0)return!1;let e=-(s(r,n)+r[3])/I;return c&f.CLAMP&&(e=z(e,0,1)),!(!(c&f.INFINITE_MIN)&&e<0||!(c&f.INFINITE_MAX)&&e>1)&&(q(t,n,b(t,u,e)),!0)}function Ir(r){return r}const g=[0,0,1,0];var f;(function(r){r[r.NONE=0]="NONE",r[r.CLAMP=1]="CLAMP",r[r.INFINITE_MIN=4]="INFINITE_MIN",r[r.INFINITE_MAX=8]="INFINITE_MAX"})(f||(f={}));const U=f.INFINITE_MIN|f.INFINITE_MAX,V=f.INFINITE_MAX;export{B as A,er as B,Z as E,O as F,or as G,ir as H,fr as J,K as L,rr as O,S as P,R as Q,D as T,cr as U,d as V,Ir as Y,G as _,J as b,H as j,x as p,nr as q,tr as w,ur as x};
