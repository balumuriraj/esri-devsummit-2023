import{t as h,r as i}from"./typedArrayUtil-4d7bb04c.js";import{j as o,y as w,Q as g,C as c,A as f,G as S}from"./request-6fc81c4c.js";import{f as C}from"./persistableUrlUtils-5f719c3b.js";const v={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer"},p=Object.values(v),d=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${p.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),I=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^\\/\\n]+)\\/(${p.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),L=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function U(e){return!!d.test(e)}function m(e){if(h(e))return null;const r=o(e),t=r.path.match(d)||r.path.match(I);if(!t)return null;const[,s,n,l,u]=t,a=n.indexOf("/");return{title:y(a!==-1?n.slice(a+1):n),serverType:v[l.toLowerCase()],sublayer:u!=null&&u!==""?parseInt(u,10):null,url:{path:s}}}function b(e){const r=o(e).path.match(L);return r?{serviceUrl:r[1],sublayerId:Number(r[2])}:null}function y(e){return(e=e.replace(/\s*[/_]+\s*/g," "))[0].toUpperCase()+e.slice(1)}function A(e,r){const t=[];if(e){const s=m(e);i(s)&&s.title&&t.push(s.title)}if(r){const s=y(r);t.push(s)}if(t.length===2){if(t[0].toLowerCase().includes(t[1].toLowerCase()))return t[0];if(t[1].toLowerCase().includes(t[0].toLowerCase()))return t[1]}return t.join(" - ")}function E(e){if(!e)return!1;const r=".arcgis.com/",t="//services",s="//tiles",n="//features",l=(e=e.toLowerCase()).includes(r),u=e.includes(t)||e.includes(s)||e.includes(n);return l&&u}function O(e,r){return e&&c(f(e,r))}function R(e){let{url:r}=e;if(!r)return{url:r};r=f(r,e.logger);const t=o(r),s=m(t.path);let n;if(i(s))s.sublayer!=null&&e.layer.layerId==null&&(n=s.sublayer),r=s.url.path;else if(e.nonStandardUrlAllowed){const l=b(t.path);i(l)&&(r=l.serviceUrl,n=l.sublayerId)}return{url:c(r),layerId:n}}function T(e,r,t,s,n){C(r,s,"url",n),s.url&&e.layerId!=null&&(s.url=S(s.url,t,e.layerId.toString()))}function F(e){if(!e)return!1;const r=e.toLowerCase(),t=r.includes("/services/"),s=r.includes("/mapserver/wmsserver"),n=r.includes("/imageserver/wmsserver"),l=r.includes("/wmsserver");return t&&(s||n||l)}function G(e){var t;if(!e)return!1;const r=(t=new w(g(e)).authority)==null?void 0:t.toLowerCase();return r==="server.arcgisonline.com"||r==="services.arcgisonline.com"}export{F as I,R as L,O as S,T as b,U as d,E as g,y as h,G as j,m,b as w,A as y};
