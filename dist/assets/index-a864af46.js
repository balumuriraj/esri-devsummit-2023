import{_ as j}from"./preload-helper-3bce6601.js";import{e as h,y as p,s as qr,n as F,l as xt,t as Vt,m as pe,a as ute,b as M7,x as b5,A as wd,u as I7,v as L7,o as dte,c as fw,d as It,f as w5,g as dI,h as aD,i as fc,r as $7,j as Yt,k as Sm,p as oA,q as pte,w as pT,z as mte,F as fte,B as x5,C as gte}from"./cast-fcb46737.js";import{g as jc}from"./Graphic-f0e54e86.js";import{i as au,l as _te}from"./Clonable-545593ce.js";import{s as oD,r as Em,i as gw,o as yte}from"./Cyclical-151bcc41.js";import{a as ue,b as _o,l as ls,m as At,g as lA,j as vte,A as bte,D as wte,h as bt,v as G0,N as tu,i as lD,F as pI,c as _w}from"./mathUtils-b4bb77e2.js";import{t as C,r as y,s as Oe,u as $x,o as co,e as ft,f as xte,h as Os,p as iu,q as en,i as Ke,w as Qi,a as ke,b as Np,c as Tte,l as Cte,y as D7,A as F7,d as N7,n as w_,C as Ste,v as k7,g as cD,j as Ete,k as mI,m as Rte,M as Pte,x as Ate}from"./typedArrayUtil-4d7bb04c.js";import{w as He,r as Cs,o as Dl,R as ER,E as Gm,a as pi,k as Zt,I as V7,p as U7,b as z7,c as B7,d as Ote,M as hD,e as Mte,x as Ite,P as Dx,s as Fx,f as T5,g as fI,h as Lte,A as DE,S as kv,i as FE,u as $te,T as G7,j as Dte}from"./Extent-da876e26.js";import{a as kp,t as mT,r as Fte,T as gI,b as Nx,n as Er,S as Nte,e as Fl}from"./ArrayPool-a8ee9378.js";import{i as H7}from"./geometry-b7901087.js";import{v as NE,s as kte,l as Vte,u as Ute,y as zte,f as j7,c as q7}from"./jsonUtils-229211af.js";import{j as wt,E as C5}from"./Collection-910b6f71.js";import{l as yw}from"./CollectionFlattener-8f4d518b.js";import{s as ee,a as J,b as Rg}from"./Error-ec6249b9.js";import{n as H0,h as Ot,y as Pr,o as cA}from"./string-a318751c.js";import{E as Yo,i as Ol,g as Ib,U as j0,j as yo,b as Bte,L as Gte,f as Ti,A as W7,a as ts,v as Rm,p as Ec,C as kx,t as RR,D as Vx,w as Hte,d as jte,r as qte}from"./promiseUtils-1e54421e.js";import{l as B,h as et,a as wr,f as cs,U as ni,j as Pm,w as Mi,P as Wte}from"./reactiveUtils-4dabbb80.js";import{c as Rs,i as zi,x as is,p as q0,d as Dh,u as Sa,e as _I,s as X7}from"./screenUtils-410d12c0.js";import{l as Q7}from"./workers-6e30d081.js";import{e as vw,A as gv,r as Dd,t as PR,u as kE,_ as Xte,R as Pg,y as Qte,g as bn,j as ss,d as Am,x as Ma,Z as xd,p as Zte,v as AR,a as Z7,H as Y7,P as Yte,f as Vv}from"./projection-290b739f.js";import{p as Kte,j as Lb}from"./TileInfo-b0eb8c90.js";import{i as yI,e as _n,M as Hn,n as N,v as VE,h as S5,f as zh,p as Jte,k as eie,a as UE,t as K7,w as tie,b as uD,r as E5,c as J7,o as R5,g as iie}from"./widget-fb292a2f.js";import{c as _v,a as Ux,d as dD}from"./HandleOwner-9b396af1.js";import{s as gc}from"./intl-65a3e389.js";import{s as vI,t as rie}from"./byteSizeEstimations-f0cab514.js";import{O as nie,E as OR,J as sie,K as aie,R as oie,$ as Hm,a as lie,u as Kt,L as cie}from"./unitUtils-45d1147c.js";import{m as MR,L as zE,u as hie,S as eG}from"./number-27cf8195.js";import{a as uie,s as hA}from"./executeQueryJSON-2fe748db.js";import{c as P5,d as bI}from"./RelationshipQuery-0dda77ad.js";import{x as die,h as pie,i as mie}from"./fieldUtils-7f54c4b1.js";import{u as fie,i as gie,c as tG,a as _ie,I as yie,b as iG,d as vie,e as bie,f as zx,g as wie,h as xie}from"./PopupTemplate-40f3c9aa.js";import{i as pD,o as Tie}from"./arcadeOnDemand-281a01eb.js";import{a as wI,n as Cie}from"./assets-8d3e737a.js";import"./LegendOptions-010d0873.js";import{j as x_,x as uA,M as Sie,N as Eie,g as Rie}from"./utils-6786b611.js";import{l as ti}from"./Color-fb64d77d.js";import{S as Pie,p as Aie,d as rG,l as nG,i as mD,j as Oie,h as Mie,a as Iie,b as Lie}from"./symbols-f8232671.js";import{a as $ie}from"./jsonUtils-f5674613.js";import{U as Wh,y as Die,Q as Fie,n as sG,I as fD,j as xI,a as Nie,X as kie,S as Vie}from"./request-6fc81c4c.js";import{m as Uie,x as $b}from"./Query-b96bcde0.js";import{n as zie}from"./featureConversionUtils-03a03f40.js";import{i as Bie,v as jm,c as Gie,m as Hie,u as aG,a as oG,o as jie,b as qie}from"./Polyline-ff2d7c6b.js";import{r as A5,s as Wie,i as N1,f as Xie,a as Qie,o as Zie}from"./normalizeUtils-27e29a72.js";import"./pbf-0e99a620.js";import"./FeatureSet-d32b0eb8.js";import"./TopFeaturesQuery-cad97c37.js";import{l as Yie}from"./locale-30120714.js";import lG from"./FeatureLayer-041050b6.js";import{s as gD,i as IR}from"./Identifiable-bfe1ff30.js";import{n as nn}from"./Evented-a45c8b0f.js";import{b as TI}from"./Layer-5ffe0eda.js";import{h as Kie,c as cG,f as hG,e as _D,i as BE,M as Jie,r as uG,n as ere}from"./mat2d-2bbb5feb.js";import{e as O5}from"./Queue-b7d3cd48.js";import{t as tre,I as dr,y as yD,a as Fh,F as LR,g as ire}from"./Scheduler-540208b6.js";import{s as M5,x as CI}from"./Basemap-af7f62f8.js";import{n as dG}from"./collectionUtils-803d9ba8.js";import{o as rre,n as Ra}from"./compilerUtils-18d58939.js";import{m as Om}from"./Loadable-268c900a.js";import{n as pG}from"./loadAll-b5bfa7ab.js";import{r as Pa}from"./enumeration-3a03bd31.js";import{r as nre,n as sre}from"./opacityUtils-1f7f5126.js";import{l as are,d as ore,t as lre}from"./TablesMixin-bc97d131.js";import{T as W0}from"./TimeExtent-23e282b9.js";import{j as Bx,b as bw,c as vD}from"./asyncUtils-437defc4.js";import{m as bD,_ as cre}from"./Promise-376ab9f6.js";import{l as hre,i as mG,a as SI}from"./GraphicsCollection-c37a9ffd.js";import{v as Gx}from"./HeightModelInfo-5d01231e.js";import{m as EI,j as ure}from"./arcgisLayerUrl-c09f09b4.js";import{l as Ie,a as dA,o as I5}from"./ViewingMode-5d7d590b.js";import{t as RI,r as dre,I as xl}from"./enums-0fc02184.js";import{r as $R,a as wD}from"./common-c186b691.js";import{o as Rc,v as X0,y as pre,j as Fr,q as PI,C as fG,l as qs,r as rt,z as Yu,g as gG,a as wn,s as yc,m as Q0,L as Xy,A as Qf,k as mre,E as fre,b as L5,H as gre,_ as $5}from"./vec2-528adfe4.js";import{r as Qt,n as Te,f as Ag,t as fT,e as _re}from"./vec2f64-30dc1443.js";import{s as AI,r as _G,M as OI,h as yG,i as xD,o as qc,c as vG,u as Kg,a as Td,g as yre,f as bG,p as vre}from"./mat3-3fc68e72.js";import{e as hm,r as bre}from"./mat3f32-d3d088e8.js";import{t as Vp,n as wre}from"./vec2f32-461e65a9.js";import"./TileStrategy-a90cd1af.js";import{d as xre,h as Tre}from"./TileStore-00ac650f.js";import"./TileKey-5aef17b6.js";import{g as Q,o as Y,S as Nl,z as de,P as _e,_ as ut,s as we,u as ce,A as Bn,e as ae,r as X,x as Li,H as Jg,F as Oc,O as Me,v as Ml,M as Cre,J as tl,G as Og,p as Bl,Z as D5,X as wG,j as Aa,U as xG,c as Sre,q as F5,Y as jd,E as Ere,V as N5}from"./vec3-e93e648f.js";import{l as Rre}from"./capabilities-302cf20d.js";import{r as Nn,o as Pre}from"./context-util-a4ce3a7b.js";import{n as Are}from"./BlendLayer-20d0571b.js";import{t as Ore}from"./ScaleRangeLayer-4be07229.js";import{u as Nt,c as ww,f as TG,b as CG,H as Mre,D as Uc,z as GE,s as Nh,l as Mm,h as um,E as DR,M as MI,a as xw,m as TD,p as CD,o as SG,d as Ire,K as Lre,q as $re,I as fg,U as II,R as k5,y as EG,w as Dre,g as V5}from"./aaBoundingRect-193543b5.js";import{o as Fre}from"./BoundsStore-b9fa27cc.js";import{e as Or}from"./mat3f64-c6305894.js";import{n as P,r as Ze,t as as,b as Nre,e as Tl,f as Gl,l as em,i as kre}from"./vec3f64-2f9cef06.js";import{s as SD,c as Xe,b as Vre,f as Db,n as tm,E as Ure,$ as zre,p as zc,z as FR,q as Bre,d as oo,h as Gre,k as LI,Y as NR,O as ED,W as RD,r as Hre,a as RG,e as jre,R as ou,F as qre,g as PD,C as Wre,w as Xre,i as PG,T as AG}from"./sphere-2af0d852.js";import{h as kn,o as AD,g as Bc,n as pn,k as Qre,Q as OD,u as Hr,m as Tw,f as kl,r as Mg,b as Cw,l as MD,A as Zre,B as Yre,R as Kre,c as ru,F as OG,x as MG,s as IG,i as LG,C as Jre,v as ene}from"./mat4-44a0988f.js";import{e as xe,t as $G,o as rn,r as SS}from"./mat4f64-1e28eae0.js";import{v as yv,A as U5,M as ID,b as gg,k as DG}from"./lineSegment-10422ca0.js";import{p as fr,E as tne,A as FG,O as Sw,F as ine,q as e_,x as rne,U as nne,z as NG,H as sne,Y as Ia,L as $I,_ as Ew,R as tr,T as kG,P as DI,j as Bh,b as ane,K as z5}from"./plane-b575face.js";import{o as one,r as lne}from"./scaleUtils-93ad8d0c.js";import{s as FI,c as cne,t as Fb,i as VG,r as B5,n as G5,o as H5,l as hne}from"./layerUtils-f4d08f94.js";import{h as une,t as dne}from"./ElevationSamplerData-b87e0e50.js";import{s as lo,t as pne,e as mne}from"./Ellipsoid-89682c5e.js";import{n as yi,e as fne,r as Bi,t as LD,_ as Pc,l as C0}from"./vec4f64-e407da96.js";import{r as Qs,w as sd,a as im,D as NI,b as j5,l as $D,s as gne,G as UG,j as _ne}from"./vec4-790471c0.js";import{o as kR,d as Im,a as VR,m as yne,b as zr,r as vne,s as Rw,e as DD,c as FD,v as zG,f as bne,t as wne,x as xne,h as BG,n as GG}from"./PhysicallyBasedRendering.glsl-d457fff5.js";import{a as Ig}from"./ReadLinearDepth.glsl-9c87a54a.js";import{e as ND,v as Tne,I as kD,c as Cne,i as Sne,E as Kr,r as Ih,a as ba,R as VD,n as HE,b as Ene,_ as Rne,d as Pne}from"./WaterSurface.glsl-c64cb8f1.js";import{e as Zs,f as Ht,i as Ko,u as HG,a as il,r as Hx}from"./Texture2DPassUniform-753de459.js";import{e as Ys,a as Ps,v as Ane,d as q5,c as One,o as Mne,b as W5}from"./View.glsl-3ce196d4.js";import{e as Xh}from"./Float4PassUniform-d7bdbc81.js";import{o as Pt}from"./FloatPassUniform-68d54f51.js";import{o as Yi,n as A,t as Ir,i as t_,a as UD}from"./ShaderBuilder-a7d0da4e.js";import{O as S}from"./VertexAttribute-9c5c630d.js";import{e as ii,o as ei,W as it,l as Gn,_ as gt,t as ri,s as lu,L as pA,r as jG,n as Ine,i as qG,c as Lne,a as nl,P as WG,b as $ne,h as zD,p as jE,d as Dne,f as Fne,u as XG,M as Nne}from"./EvaluateSceneLighting.glsl-189abc15.js";import{E as oi,u as La,A as jx,r as nu,a as UR,d as Fd,o as kne,f as QG,b as X5,L as Vne,c as cr,e as ZG,g as vv,h as kI,i as VI,j as qx,v as YG,x as BD,l as Une,s as KG,k as zne,U as Bne,p as Gne,m as GD,O as JG,n as eH,q as Hne,t as rd,V as tH,w as jne,y as iH,z as qne,N as Wne,B as Lg,C as Xne,D as Qne,F as Q5}from"./VisualVariablePassParameters-d460182b.js";import{R as me,I as hs,E as kt,T as Pw,Y as Vn,M as bi,P as St,G as Xt,D as ai,L as Jt,F as mi,V as rs,_ as Oi,C as dm,B as Zne,U as ES,N as ig,S as rH,O as S0,t as Nb,A as $t,X as mA,n as Kl,W as Yne,r as Z5,f as Kne}from"./enums-64ab819c.js";import{e as k,t as $a}from"./ShaderTechniqueConfiguration-9f5b4555.js";import{t as Jne}from"./PiUtils.glsl-db6418ee.js";import{e as nH,o as qt}from"./TransparencyPassType-a11868d2.js";import{a as i_}from"./RgbaFloatEncoding.glsl-52af7fcf.js";import{r as _i,a as ese,n as Xi,t as Y5}from"./vec3f32-c9aa289f.js";import{o as Nd}from"./ScreenSpacePass-d5e48a9b.js";import{o as UI,i as zR,a as tse,t as K5,b as J5,d as sH,F as RS,c as ise,W as rse,e as ek}from"./ForwardLinearDepth.glsl-56affafd.js";import{x as yn,n as Ws,E as ui,R as aH,a as oH,u as qE,b as Gc,s as nse,i as tk}from"./FramebufferObject-a3b9c52c.js";import{s as sse,c as ase,p as Lm,a as mu}from"./HUD.glsl-d3a072ad.js";import{o as ose,n as zI}from"./MultipassTerrainTest.glsl-bb236672.js";import{E as le,d as jr,u as lse,y as ik,j as Ac,A as qm,a as cse,h as lH,o as hse,b as HD,B as cH,c as hH,e as Aw,f as use,t as r_,g as Hl,l as n_,i as BR,k as Cd,m as $g,n as s_,_ as jD,s as WE,p as uH,q as dH,P as pH,r as qD,v as WD,w as XD,x as QD,S as ZD,C as Ow,z as dse,D as Uv,F as pse,G as mse,Y as fse,H as rk,I as gse,J as _se,L as yse,K as vse,V as bse,M as wse,N as xse}from"./objectResourceUtils-d556a033.js";import{s as cu}from"./DefaultTechniqueConfiguration-588e5ab2.js";import{r as mH}from"./Transform.glsl-6d2e2fd9.js";import{o as Wc,m as Tse,A as BI,a as GI,f as Cse,e as Sse,u as nk,T as sk,d as Ese,w as Rse}from"./edgeProcessing-f733ce76.js";import{T as sn}from"./InterleavedLayout-984d67b2.js";import{a as Fc,u as Dg,l as XE,i as QE,O as PS,n as tn,c as YD,C as Ho,N as vr,t as kb,D as Mw}from"./basicInterfaces-19ed850e.js";import{u as KD,m as Pse,n as Ase}from"./DefaultMaterial_COLOR_GAMMA-fe26fda8.js";import{e as ct,i as ak,g as Ose,l as Mse,k as Ise,m as Lse,M as fH,f as $se,s as T_,u as gT,h as Dse}from"./Util-a48361c6.js";import{E as Gi,n as Ca,a as qd}from"./Texture-243be4d7.js";import{a as Fse,q as ok,g as lk,R as Nse,v as kse,j as Vse,V as Use,k as zse}from"./projection-a69d43d0.js";import{h as V,e as gH}from"./Matrix3PassUniform-ad9f953b.js";import{H as Iw,u as ZE,s as _H,l as Ci,I as Bse,L as Gse,i as GR,P as Hse,m as jse,p as yH,k as qse,G as Mc,U as hr,v as Wse}from"./Octree-0a267ea2.js";import{S as Xse}from"./quat-3d5eec2d.js";import{e as Qse}from"./quatf64-7fd38d64.js";import{a as Ms,A as Ii,p as Ic,P as JD,B as eF,c as Z0,f as Y0,I as vH,N as tF,y as bH,d as Zse,q as Yse,V as wH,E as iF,w as rF,D as Kse,l as Jse,M as Jo,R as Lc,h as eae,g as xH,F as _T,u as HI,k as tae}from"./aaBoundingBox-657a9b82.js";import{x as $m,T as Dm,i as Fm,u as TH,b as ck,l as Lw,h as iae,c as Sd,d as hk,a as CH}from"./BufferView-903d1848.js";import{V as rae,H as uk}from"./HUDMaterial.glsl-32cf019c.js";import{v as kd,J as nae,w as sae}from"./dehydratedFeatures-0557137d.js";import{createLabelFunction as aae}from"./labelFormatUtils-d25d1d9e.js";import{r as oae,n as lae}from"./ElevationInfo-215614d8.js";import{A as Ct,a as cae,f as SH,U as hae,J as uae,F as dk,O as dae,W as pae}from"./I3SUtil-f31a4571.js";import{u as mae}from"./LineCallout.glsl-358ef89b.js";import{x as $w}from"./earcut-58237617.js";import{t as EH,r as YE,e as RH}from"./vec33-e98769e8.js";import{t as fae,e as pk}from"./SnappingCandidate-970faec6.js";import{N as PH}from"./UniqueValueRenderer-08f8851c.js";import{l as HR,c as K0,g as gae,a as _ae,e as fA}from"./MeshComponent-a43522cc.js";import{d as yae,i as vae}from"./TextureOnly.glsl-1ec9a9ef.js";import{s as AH,a as bae,p as gA,f as wae}from"./MarkerSizing.glsl-566261cc.js";import{A as xae,s as Tae,r as E0,j as Cae}from"./RibbonLine.glsl-0f7c2bbc.js";import{c as Sae,f as Eae,o as Rae,i as Il,e as Pae,a as Aae,b as R0,n as OH,t as Oae}from"./MixExternalColor.glsl-ab0706f7.js";import{i as Mae,s as Iae,h as Lae,r as $ae}from"./MemCache-18a255ed.js";import{u as MH}from"./LineStipple.glsl-ed22a88b.js";import{i as Dae}from"./callExpressionWithFeature-55effb7b.js";import{m as mk}from"./lengthUtils-fa751420.js";import{e as fk,o as Fae,a as Nae}from"./sdfPrimitives-9858c36d.js";import{L as jR}from"./Texture-46c8c2cb.js";import{d as kae}from"./CIMSymbol-539bd447.js";import{M as Vae}from"./LineMarker.glsl-8166d610.js";import{n as Uae,o as IH,r as KE}from"./symbolColorUtils-b2b55883.js";import{v as zae}from"./NativeLine.glsl-742e9e29.js";import{c as Bae,t as _A}from"./symbolLayerUtils3D-76acc268.js";import{i as ho}from"./Normals.glsl-76f97814.js";import{_ as Gae,p as Hae}from"./Path.glsl-9f6bab44.js";import{f as jae}from"./ColorMaterial.glsl-3a70e4a7.js";import{a as Up,T as qae}from"./Pattern.glsl-67f4595b.js";import{r as J0,a as Wae,c as Xae,_ as Qae,p as Zae,T as Yae,E as Kae,m as Jae,l as gk,n as _k,h as eoe,b as toe}from"./DefaultVertexAttributeLayouts-2bcf3941.js";import{j as k1}from"./Portal-2bb189b3.js";import{n as ioe}from"./RefreshableLayer-7f154951.js";import{n as roe,h as noe}from"./LercDecoder-4c9b29b3.js";import{e as yk}from"./config-1337d16e.js";import{u as LH,p as soe}from"./Slice.glsl-3b39b1f7.js";import{o as jI}from"./OutputDepth.glsl-470c8e2a.js";import{a as $H,i as aoe}from"./OutputHighlight.glsl-fbac199a.js";import{r as ooe}from"./NormalUtils.glsl-c12729bf.js";import{o as qI,r as DH}from"./floatRGBA-9ad35d39.js";import{u as qR,o as FH,f as nF}from"./Texture2DDrawUniform-053796dc.js";import{e as NH}from"./VertexColor.glsl-8c022fa8.js";import{c as loe}from"./DefaultMaterial.glsl-885671b3.js";import{t as coe,o as hoe}from"./AlphaCutoff-96178e0d.js";import{n as sF}from"./SSAO.glsl-980b3771.js";import{D as yT}from"./workerHelper-e756ac3a.js";import{t as aF}from"./VertexElementDescriptor-2925c6af.js";import{O as kH,S as VH}from"./MultiOriginJSONSupport-aae3bc0c.js";import{i as uoe}from"./originUtils-1469eeaf.js";import{t as vT}from"./deprecate-035b199e.js";import{d as doe}from"./EditBusLayer-e750b15b.js";import JE from"./PortalItem-bb7e98a6.js";import{s as Vd}from"./jsonMap-7b8332c9.js";import{c as xo,i as C_,s as zv,f as oF}from"./portalItemUtils-2ccd793f.js";import{l as UH}from"./TimeInfo-1d30dc7c.js";import{y as poe}from"./writeUtils-e686bd33.js";import{i as zH}from"./fieldType-f31285f7.js";import{r as moe}from"./Version-2946cc03.js";import"./nextTick-3ee5a785.js";import"./typeUtils-35750739.js";import"./SimpleObservable-23231131.js";import"./Connection-9a1cf8da.js";import"./zscale-89472cba.js";import"./uuid-73213768.js";import"./messages-2289086c.js";import"./query-694f7287.js";import"./pbfQueryUtils-4adda2cc.js";import"./OptimizedFeature-4ab8d380.js";import"./OptimizedFeatureSet-1d1ac4b9.js";import"./queryZScale-1481fa99.js";import"./parser-498c8be0.js";import"./colorUtils-639f4d25.js";import"./mat4f32-77b3d8ac.js";import"./ItemCache-fd3aceaf.js";import"./Symbol-f93ed9fd.js";import"./persistableUrlUtils-5f719c3b.js";import"./Symbol3DAnchorPosition2D-5726d999.js";import"./DictionaryLoader-1cbfea53.js";import"./LRUCache-64ec42ee.js";import"./heatmapUtils-aaea3f32.js";import"./Field-61ec9870.js";import"./LayerFloorInfo-54b916a2.js";import"./FeatureLayerBase-ad5cfa1a.js";import"./OperationalLayer-97084f13.js";import"./editsZScale-6a661299.js";import"./APIKeyMixin-a0a8917a.js";import"./ArcGISService-21dc1d06.js";import"./CustomParametersMixin-47aab0a6.js";import"./FeatureReductionLayer-d69dae71.js";import"./labelingInfo-607e66b8.js";import"./labelUtils-3108e8d7.js";import"./defaultsJSON-59981e75.js";import"./jsonUtils-0ff4ff96.js";import"./sizeVariableUtils-d4870b0d.js";import"./OrderedLayer-af7a6030.js";import"./PortalLayer-b2643f87.js";import"./PortalUser-659cc1d2.js";import"./PortalGroup-8e41557a.js";import"./TemporalLayer-61549309.js";import"./FeatureTemplate-c1d0bb70.js";import"./FeatureType-34d71ade.js";import"./fieldProperties-e2eeb1d5.js";import"./FieldsIndex-f104cc5f.js";import"./versionUtils-fd91f55f.js";import"./styleUtils-a989c0af.js";import"./popupUtils-86dc6b94.js";import"./rbush-8e36784a.js";import"./quickselect-322ec8e1.js";import"./PooledRBush-3e149119.js";import"./SSAOBlur.glsl-8bf33b65.js";import"./VerticalOffset.glsl-87cbb2e3.js";import"./devEnvironmentUtils-5002a058.js";import"./RealisticTree.glsl-b6cc03f2.js";import"./VisualVariables.glsl-2b937327.js";import"./deduplicate-03981d62.js";import"./types-e1c0a5bf.js";import"./ObjectAndLayerIdColor.glsl-ad468647.js";import"./quantizationUtils-4dd81f85.js";import"./I3SBinaryReader-f4829435.js";import"./diffUtils-68b89c71.js";import"./colorRamps-9dac42c1.js";import"./styleUtils-22b14a8b.js";import"./DiscardOrAdjustAlphaBlend.glsl-73258f38.js";import"./multiOriginJSONSupportUtils-c978f4c3.js";function foe(i,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const n in r)if(n!=="default"&&!(n in i)){const s=Object.getOwnPropertyDescriptor(r,n);s&&Object.defineProperty(i,n,s.get?s:{enumerable:!0,get:()=>r[n]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(n){if(n.ep)return;n.ep=!0;const s=t(n);fetch(n.href,s)}})();function goe(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var e2={},_oe={get exports(){return e2},set exports(i){e2=i}},WR={},$e={},yoe={get exports(){return $e},set exports(i){$e=i}},li={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wx=Symbol.for("react.element"),voe=Symbol.for("react.portal"),boe=Symbol.for("react.fragment"),woe=Symbol.for("react.strict_mode"),xoe=Symbol.for("react.profiler"),Toe=Symbol.for("react.provider"),Coe=Symbol.for("react.context"),Soe=Symbol.for("react.forward_ref"),Eoe=Symbol.for("react.suspense"),Roe=Symbol.for("react.memo"),Poe=Symbol.for("react.lazy"),vk=Symbol.iterator;function Aoe(i){return i===null||typeof i!="object"?null:(i=vk&&i[vk]||i["@@iterator"],typeof i=="function"?i:null)}var BH={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},GH=Object.assign,HH={};function bv(i,e,t){this.props=i,this.context=e,this.refs=HH,this.updater=t||BH}bv.prototype.isReactComponent={};bv.prototype.setState=function(i,e){if(typeof i!="object"&&typeof i!="function"&&i!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,i,e,"setState")};bv.prototype.forceUpdate=function(i){this.updater.enqueueForceUpdate(this,i,"forceUpdate")};function jH(){}jH.prototype=bv.prototype;function lF(i,e,t){this.props=i,this.context=e,this.refs=HH,this.updater=t||BH}var cF=lF.prototype=new jH;cF.constructor=lF;GH(cF,bv.prototype);cF.isPureReactComponent=!0;var bk=Array.isArray,qH=Object.prototype.hasOwnProperty,hF={current:null},WH={key:!0,ref:!0,__self:!0,__source:!0};function XH(i,e,t){var r,n={},s=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)qH.call(e,r)&&!WH.hasOwnProperty(r)&&(n[r]=e[r]);var o=arguments.length-2;if(o===1)n.children=t;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];n.children=l}if(i&&i.defaultProps)for(r in o=i.defaultProps,o)n[r]===void 0&&(n[r]=o[r]);return{$$typeof:Wx,type:i,key:s,ref:a,props:n,_owner:hF.current}}function Ooe(i,e){return{$$typeof:Wx,type:i.type,key:e,ref:i.ref,props:i.props,_owner:i._owner}}function uF(i){return typeof i=="object"&&i!==null&&i.$$typeof===Wx}function Moe(i){var e={"=":"=0",":":"=2"};return"$"+i.replace(/[=:]/g,function(t){return e[t]})}var wk=/\/+/g;function yA(i,e){return typeof i=="object"&&i!==null&&i.key!=null?Moe(""+i.key):e.toString(36)}function AS(i,e,t,r,n){var s=typeof i;(s==="undefined"||s==="boolean")&&(i=null);var a=!1;if(i===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(i.$$typeof){case Wx:case voe:a=!0}}if(a)return a=i,n=n(a),i=r===""?"."+yA(a,0):r,bk(n)?(t="",i!=null&&(t=i.replace(wk,"$&/")+"/"),AS(n,e,t,"",function(c){return c})):n!=null&&(uF(n)&&(n=Ooe(n,t+(!n.key||a&&a.key===n.key?"":(""+n.key).replace(wk,"$&/")+"/")+i)),e.push(n)),1;if(a=0,r=r===""?".":r+":",bk(i))for(var o=0;o<i.length;o++){s=i[o];var l=r+yA(s,o);a+=AS(s,e,t,l,n)}else if(l=Aoe(i),typeof l=="function")for(i=l.call(i),o=0;!(s=i.next()).done;)s=s.value,l=r+yA(s,o++),a+=AS(s,e,t,l,n);else if(s==="object")throw e=String(i),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function bT(i,e,t){if(i==null)return i;var r=[],n=0;return AS(i,r,"","",function(s){return e.call(t,s,n++)}),r}function Ioe(i){if(i._status===-1){var e=i._result;e=e(),e.then(function(t){(i._status===0||i._status===-1)&&(i._status=1,i._result=t)},function(t){(i._status===0||i._status===-1)&&(i._status=2,i._result=t)}),i._status===-1&&(i._status=0,i._result=e)}if(i._status===1)return i._result.default;throw i._result}var Da={current:null},OS={transition:null},Loe={ReactCurrentDispatcher:Da,ReactCurrentBatchConfig:OS,ReactCurrentOwner:hF};li.Children={map:bT,forEach:function(i,e,t){bT(i,function(){e.apply(this,arguments)},t)},count:function(i){var e=0;return bT(i,function(){e++}),e},toArray:function(i){return bT(i,function(e){return e})||[]},only:function(i){if(!uF(i))throw Error("React.Children.only expected to receive a single React element child.");return i}};li.Component=bv;li.Fragment=boe;li.Profiler=xoe;li.PureComponent=lF;li.StrictMode=woe;li.Suspense=Eoe;li.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Loe;li.cloneElement=function(i,e,t){if(i==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+i+".");var r=GH({},i.props),n=i.key,s=i.ref,a=i._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=hF.current),e.key!==void 0&&(n=""+e.key),i.type&&i.type.defaultProps)var o=i.type.defaultProps;for(l in e)qH.call(e,l)&&!WH.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=t;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];r.children=o}return{$$typeof:Wx,type:i.type,key:n,ref:s,props:r,_owner:a}};li.createContext=function(i){return i={$$typeof:Coe,_currentValue:i,_currentValue2:i,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},i.Provider={$$typeof:Toe,_context:i},i.Consumer=i};li.createElement=XH;li.createFactory=function(i){var e=XH.bind(null,i);return e.type=i,e};li.createRef=function(){return{current:null}};li.forwardRef=function(i){return{$$typeof:Soe,render:i}};li.isValidElement=uF;li.lazy=function(i){return{$$typeof:Poe,_payload:{_status:-1,_result:i},_init:Ioe}};li.memo=function(i,e){return{$$typeof:Roe,type:i,compare:e===void 0?null:e}};li.startTransition=function(i){var e=OS.transition;OS.transition={};try{i()}finally{OS.transition=e}};li.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};li.useCallback=function(i,e){return Da.current.useCallback(i,e)};li.useContext=function(i){return Da.current.useContext(i)};li.useDebugValue=function(){};li.useDeferredValue=function(i){return Da.current.useDeferredValue(i)};li.useEffect=function(i,e){return Da.current.useEffect(i,e)};li.useId=function(){return Da.current.useId()};li.useImperativeHandle=function(i,e,t){return Da.current.useImperativeHandle(i,e,t)};li.useInsertionEffect=function(i,e){return Da.current.useInsertionEffect(i,e)};li.useLayoutEffect=function(i,e){return Da.current.useLayoutEffect(i,e)};li.useMemo=function(i,e){return Da.current.useMemo(i,e)};li.useReducer=function(i,e,t){return Da.current.useReducer(i,e,t)};li.useRef=function(i){return Da.current.useRef(i)};li.useState=function(i){return Da.current.useState(i)};li.useSyncExternalStore=function(i,e,t){return Da.current.useSyncExternalStore(i,e,t)};li.useTransition=function(){return Da.current.useTransition()};li.version="18.2.0";(function(i){i.exports=li})(yoe);const Dw=goe($e),WI=foe({__proto__:null,default:Dw},[$e]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $oe=$e,Doe=Symbol.for("react.element"),Foe=Symbol.for("react.fragment"),Noe=Object.prototype.hasOwnProperty,koe=$oe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Voe={key:!0,ref:!0,__self:!0,__source:!0};function QH(i,e,t){var r,n={},s=null,a=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)Noe.call(e,r)&&!Voe.hasOwnProperty(r)&&(n[r]=e[r]);if(i&&i.defaultProps)for(r in e=i.defaultProps,e)n[r]===void 0&&(n[r]=e[r]);return{$$typeof:Doe,type:i,key:s,ref:a,props:n,_owner:koe.current}}WR.Fragment=Foe;WR.jsx=QH;WR.jsxs=QH;(function(i){i.exports=WR})(_oe);const Ft=e2.jsx,nd=e2.jsxs;var XI={},QI={},Uoe={get exports(){return QI},set exports(i){QI=i}},ol={},ZI={},zoe={get exports(){return ZI},set exports(i){ZI=i}},ZH={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(i){function e(L,z){var q=L.length;L.push(z);e:for(;0<q;){var K=q-1>>>1,ie=L[K];if(0<n(ie,z))L[K]=z,L[q]=ie,q=K;else break e}}function t(L){return L.length===0?null:L[0]}function r(L){if(L.length===0)return null;var z=L[0],q=L.pop();if(q!==z){L[0]=q;e:for(var K=0,ie=L.length,Z=ie>>>1;K<Z;){var ne=2*(K+1)-1,Ae=L[ne],Fe=ne+1,ze=L[Fe];if(0>n(Ae,q))Fe<ie&&0>n(ze,Ae)?(L[K]=ze,L[Fe]=q,K=Fe):(L[K]=Ae,L[ne]=q,K=ne);else if(Fe<ie&&0>n(ze,q))L[K]=ze,L[Fe]=q,K=Fe;else break e}}return z}function n(L,z){var q=L.sortIndex-z.sortIndex;return q!==0?q:L.id-z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;i.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();i.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,d=null,m=3,f=!1,_=!1,g=!1,w=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(L){for(var z=t(c);z!==null;){if(z.callback===null)r(c);else if(z.startTime<=L)r(c),z.sortIndex=z.expirationTime,e(l,z);else break;z=t(c)}}function T(L){if(g=!1,x(L),!_)if(t(l)!==null)_=!0,M(R);else{var z=t(c);z!==null&&U(T,z.startTime-L)}}function R(L,z){_=!1,g&&(g=!1,v($),$=-1),f=!0;var q=m;try{for(x(z),d=t(l);d!==null&&(!(d.expirationTime>z)||L&&!G());){var K=d.callback;if(typeof K=="function"){d.callback=null,m=d.priorityLevel;var ie=K(d.expirationTime<=z);z=i.unstable_now(),typeof ie=="function"?d.callback=ie:d===t(l)&&r(l),x(z)}else r(l);d=t(l)}if(d!==null)var Z=!0;else{var ne=t(c);ne!==null&&U(T,ne.startTime-z),Z=!1}return Z}finally{d=null,m=q,f=!1}}var E=!1,O=null,$=-1,D=5,I=-1;function G(){return!(i.unstable_now()-I<D)}function W(){if(O!==null){var L=i.unstable_now();I=L;var z=!0;try{z=O(!0,L)}finally{z?re():(E=!1,O=null)}}else E=!1}var re;if(typeof b=="function")re=function(){b(W)};else if(typeof MessageChannel<"u"){var te=new MessageChannel,H=te.port2;te.port1.onmessage=W,re=function(){H.postMessage(null)}}else re=function(){w(W,0)};function M(L){O=L,E||(E=!0,re())}function U(L,z){$=w(function(){L(i.unstable_now())},z)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(L){L.callback=null},i.unstable_continueExecution=function(){_||f||(_=!0,M(R))},i.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<L?Math.floor(1e3/L):5},i.unstable_getCurrentPriorityLevel=function(){return m},i.unstable_getFirstCallbackNode=function(){return t(l)},i.unstable_next=function(L){switch(m){case 1:case 2:case 3:var z=3;break;default:z=m}var q=m;m=z;try{return L()}finally{m=q}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(L,z){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var q=m;m=L;try{return z()}finally{m=q}},i.unstable_scheduleCallback=function(L,z,q){var K=i.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?K+q:K):q=K,L){case 1:var ie=-1;break;case 2:ie=250;break;case 5:ie=1073741823;break;case 4:ie=1e4;break;default:ie=5e3}return ie=q+ie,L={id:u++,callback:z,priorityLevel:L,startTime:q,expirationTime:ie,sortIndex:-1},q>K?(L.sortIndex=q,e(c,L),t(l)===null&&L===t(c)&&(g?(v($),$=-1):g=!0,U(T,q-K))):(L.sortIndex=ie,e(l,L),_||f||(_=!0,M(R))),L},i.unstable_shouldYield=G,i.unstable_wrapCallback=function(L){var z=m;return function(){var q=m;m=z;try{return L.apply(this,arguments)}finally{m=q}}}})(ZH);(function(i){i.exports=ZH})(zoe);/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var YH=$e,sl=ZI;function ve(i){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+i,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+i+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var KH=new Set,Fw={};function a_(i,e){ev(i,e),ev(i+"Capture",e)}function ev(i,e){for(Fw[i]=e,i=0;i<e.length;i++)KH.add(e[i])}var Ed=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),YI=Object.prototype.hasOwnProperty,Boe=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,xk={},Tk={};function Goe(i){return YI.call(Tk,i)?!0:YI.call(xk,i)?!1:Boe.test(i)?Tk[i]=!0:(xk[i]=!0,!1)}function Hoe(i,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function joe(i,e,t,r){if(e===null||typeof e>"u"||Hoe(i,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Fa(i,e,t,r,n,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=n,this.mustUseProperty=t,this.propertyName=i,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var Is={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){Is[i]=new Fa(i,0,!1,i,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var e=i[0];Is[e]=new Fa(e,1,!1,i[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(i){Is[i]=new Fa(i,2,!1,i.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){Is[i]=new Fa(i,2,!1,i,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){Is[i]=new Fa(i,3,!1,i.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(i){Is[i]=new Fa(i,3,!0,i,null,!1,!1)});["capture","download"].forEach(function(i){Is[i]=new Fa(i,4,!1,i,null,!1,!1)});["cols","rows","size","span"].forEach(function(i){Is[i]=new Fa(i,6,!1,i,null,!1,!1)});["rowSpan","start"].forEach(function(i){Is[i]=new Fa(i,5,!1,i.toLowerCase(),null,!1,!1)});var dF=/[\-:]([a-z])/g;function pF(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var e=i.replace(dF,pF);Is[e]=new Fa(e,1,!1,i,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var e=i.replace(dF,pF);Is[e]=new Fa(e,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(i){var e=i.replace(dF,pF);Is[e]=new Fa(e,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(i){Is[i]=new Fa(i,1,!1,i.toLowerCase(),null,!1,!1)});Is.xlinkHref=new Fa("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(i){Is[i]=new Fa(i,1,!1,i.toLowerCase(),null,!0,!0)});function mF(i,e,t,r){var n=Is.hasOwnProperty(e)?Is[e]:null;(n!==null?n.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(joe(e,t,n,r)&&(t=null),r||n===null?Goe(e)&&(t===null?i.removeAttribute(e):i.setAttribute(e,""+t)):n.mustUseProperty?i[n.propertyName]=t===null?n.type===3?!1:"":t:(e=n.attributeName,r=n.attributeNamespace,t===null?i.removeAttribute(e):(n=n.type,t=n===3||n===4&&t===!0?"":""+t,r?i.setAttributeNS(r,e,t):i.setAttribute(e,t))))}var Ud=YH.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,wT=Symbol.for("react.element"),Qy=Symbol.for("react.portal"),Zy=Symbol.for("react.fragment"),fF=Symbol.for("react.strict_mode"),KI=Symbol.for("react.profiler"),JH=Symbol.for("react.provider"),ej=Symbol.for("react.context"),gF=Symbol.for("react.forward_ref"),JI=Symbol.for("react.suspense"),eL=Symbol.for("react.suspense_list"),_F=Symbol.for("react.memo"),zp=Symbol.for("react.lazy"),tj=Symbol.for("react.offscreen"),Ck=Symbol.iterator;function Bv(i){return i===null||typeof i!="object"?null:(i=Ck&&i[Ck]||i["@@iterator"],typeof i=="function"?i:null)}var Mr=Object.assign,vA;function V1(i){if(vA===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);vA=e&&e[1]||""}return`
`+vA+i}var bA=!1;function wA(i,e){if(!i||bA)return"";bA=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(i,[],e)}else{try{e.call()}catch(c){r=c}i.call(e.prototype)}else{try{throw Error()}catch(c){r=c}i()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var n=c.stack.split(`
`),s=r.stack.split(`
`),a=n.length-1,o=s.length-1;1<=a&&0<=o&&n[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(n[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||n[a]!==s[o]){var l=`
`+n[a].replace(" at new "," at ");return i.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",i.displayName)),l}while(1<=a&&0<=o);break}}}finally{bA=!1,Error.prepareStackTrace=t}return(i=i?i.displayName||i.name:"")?V1(i):""}function qoe(i){switch(i.tag){case 5:return V1(i.type);case 16:return V1("Lazy");case 13:return V1("Suspense");case 19:return V1("SuspenseList");case 0:case 2:case 15:return i=wA(i.type,!1),i;case 11:return i=wA(i.type.render,!1),i;case 1:return i=wA(i.type,!0),i;default:return""}}function tL(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case Zy:return"Fragment";case Qy:return"Portal";case KI:return"Profiler";case fF:return"StrictMode";case JI:return"Suspense";case eL:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case ej:return(i.displayName||"Context")+".Consumer";case JH:return(i._context.displayName||"Context")+".Provider";case gF:var e=i.render;return i=i.displayName,i||(i=e.displayName||e.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case _F:return e=i.displayName||null,e!==null?e:tL(i.type)||"Memo";case zp:e=i._payload,i=i._init;try{return tL(i(e))}catch{}}return null}function Woe(i){var e=i.type;switch(i.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=e.render,i=i.displayName||i.name||"",e.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return tL(e);case 8:return e===fF?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Nm(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function ij(i){var e=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Xoe(i){var e=ij(i)?"checked":"value",t=Object.getOwnPropertyDescriptor(i.constructor.prototype,e),r=""+i[e];if(!i.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var n=t.get,s=t.set;return Object.defineProperty(i,e,{configurable:!0,get:function(){return n.call(this)},set:function(a){r=""+a,s.call(this,a)}}),Object.defineProperty(i,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){i._valueTracker=null,delete i[e]}}}}function xT(i){i._valueTracker||(i._valueTracker=Xoe(i))}function rj(i){if(!i)return!1;var e=i._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return i&&(r=ij(i)?i.checked?"true":"false":i.value),i=r,i!==t?(e.setValue(i),!0):!1}function t2(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function iL(i,e){var t=e.checked;return Mr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??i._wrapperState.initialChecked})}function Sk(i,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=Nm(e.value!=null?e.value:t),i._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function nj(i,e){e=e.checked,e!=null&&mF(i,"checked",e,!1)}function rL(i,e){nj(i,e);var t=Nm(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&i.value===""||i.value!=t)&&(i.value=""+t):i.value!==""+t&&(i.value=""+t);else if(r==="submit"||r==="reset"){i.removeAttribute("value");return}e.hasOwnProperty("value")?nL(i,e.type,t):e.hasOwnProperty("defaultValue")&&nL(i,e.type,Nm(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(i.defaultChecked=!!e.defaultChecked)}function Ek(i,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+i._wrapperState.initialValue,t||e===i.value||(i.value=e),i.defaultValue=e}t=i.name,t!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,t!==""&&(i.name=t)}function nL(i,e,t){(e!=="number"||t2(i.ownerDocument)!==i)&&(t==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+t&&(i.defaultValue=""+t))}var U1=Array.isArray;function P0(i,e,t,r){if(i=i.options,e){e={};for(var n=0;n<t.length;n++)e["$"+t[n]]=!0;for(t=0;t<i.length;t++)n=e.hasOwnProperty("$"+i[t].value),i[t].selected!==n&&(i[t].selected=n),n&&r&&(i[t].defaultSelected=!0)}else{for(t=""+Nm(t),e=null,n=0;n<i.length;n++){if(i[n].value===t){i[n].selected=!0,r&&(i[n].defaultSelected=!0);return}e!==null||i[n].disabled||(e=i[n])}e!==null&&(e.selected=!0)}}function sL(i,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ve(91));return Mr({},e,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function Rk(i,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(ve(92));if(U1(t)){if(1<t.length)throw Error(ve(93));t=t[0]}e=t}e==null&&(e=""),t=e}i._wrapperState={initialValue:Nm(t)}}function sj(i,e){var t=Nm(e.value),r=Nm(e.defaultValue);t!=null&&(t=""+t,t!==i.value&&(i.value=t),e.defaultValue==null&&i.defaultValue!==t&&(i.defaultValue=t)),r!=null&&(i.defaultValue=""+r)}function Pk(i){var e=i.textContent;e===i._wrapperState.initialValue&&e!==""&&e!==null&&(i.value=e)}function aj(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function aL(i,e){return i==null||i==="http://www.w3.org/1999/xhtml"?aj(e):i==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var TT,oj=function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,n){MSApp.execUnsafeLocalFunction(function(){return i(e,t,r,n)})}:i}(function(i,e){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=e;else{for(TT=TT||document.createElement("div"),TT.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=TT.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;e.firstChild;)i.appendChild(e.firstChild)}});function Nw(i,e){if(e){var t=i.firstChild;if(t&&t===i.lastChild&&t.nodeType===3){t.nodeValue=e;return}}i.textContent=e}var Vb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Qoe=["Webkit","ms","Moz","O"];Object.keys(Vb).forEach(function(i){Qoe.forEach(function(e){e=e+i.charAt(0).toUpperCase()+i.substring(1),Vb[e]=Vb[i]})});function lj(i,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||Vb.hasOwnProperty(i)&&Vb[i]?(""+e).trim():e+"px"}function cj(i,e){i=i.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,n=lj(t,e[t],r);t==="float"&&(t="cssFloat"),r?i.setProperty(t,n):i[t]=n}}var Zoe=Mr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function oL(i,e){if(e){if(Zoe[i]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ve(137,i));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ve(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ve(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ve(62))}}function lL(i,e){if(i.indexOf("-")===-1)return typeof e.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var cL=null;function yF(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var hL=null,A0=null,O0=null;function Ak(i){if(i=Zx(i)){if(typeof hL!="function")throw Error(ve(280));var e=i.stateNode;e&&(e=KR(e),hL(i.stateNode,i.type,e))}}function hj(i){A0?O0?O0.push(i):O0=[i]:A0=i}function uj(){if(A0){var i=A0,e=O0;if(O0=A0=null,Ak(i),e)for(i=0;i<e.length;i++)Ak(e[i])}}function dj(i,e){return i(e)}function pj(){}var xA=!1;function mj(i,e,t){if(xA)return i(e,t);xA=!0;try{return dj(i,e,t)}finally{xA=!1,(A0!==null||O0!==null)&&(pj(),uj())}}function kw(i,e){var t=i.stateNode;if(t===null)return null;var r=KR(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(i=i.type,r=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!r;break e;default:i=!1}if(i)return null;if(t&&typeof t!="function")throw Error(ve(231,e,typeof t));return t}var uL=!1;if(Ed)try{var Gv={};Object.defineProperty(Gv,"passive",{get:function(){uL=!0}}),window.addEventListener("test",Gv,Gv),window.removeEventListener("test",Gv,Gv)}catch{uL=!1}function Yoe(i,e,t,r,n,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(t,c)}catch(u){this.onError(u)}}var Ub=!1,i2=null,r2=!1,dL=null,Koe={onError:function(i){Ub=!0,i2=i}};function Joe(i,e,t,r,n,s,a,o,l){Ub=!1,i2=null,Yoe.apply(Koe,arguments)}function ele(i,e,t,r,n,s,a,o,l){if(Joe.apply(this,arguments),Ub){if(Ub){var c=i2;Ub=!1,i2=null}else throw Error(ve(198));r2||(r2=!0,dL=c)}}function o_(i){var e=i,t=i;if(i.alternate)for(;e.return;)e=e.return;else{i=e;do e=i,e.flags&4098&&(t=e.return),i=e.return;while(i)}return e.tag===3?t:null}function fj(i){if(i.tag===13){var e=i.memoizedState;if(e===null&&(i=i.alternate,i!==null&&(e=i.memoizedState)),e!==null)return e.dehydrated}return null}function Ok(i){if(o_(i)!==i)throw Error(ve(188))}function tle(i){var e=i.alternate;if(!e){if(e=o_(i),e===null)throw Error(ve(188));return e!==i?null:i}for(var t=i,r=e;;){var n=t.return;if(n===null)break;var s=n.alternate;if(s===null){if(r=n.return,r!==null){t=r;continue}break}if(n.child===s.child){for(s=n.child;s;){if(s===t)return Ok(n),i;if(s===r)return Ok(n),e;s=s.sibling}throw Error(ve(188))}if(t.return!==r.return)t=n,r=s;else{for(var a=!1,o=n.child;o;){if(o===t){a=!0,t=n,r=s;break}if(o===r){a=!0,r=n,t=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===t){a=!0,t=s,r=n;break}if(o===r){a=!0,r=s,t=n;break}o=o.sibling}if(!a)throw Error(ve(189))}}if(t.alternate!==r)throw Error(ve(190))}if(t.tag!==3)throw Error(ve(188));return t.stateNode.current===t?i:e}function gj(i){return i=tle(i),i!==null?_j(i):null}function _j(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var e=_j(i);if(e!==null)return e;i=i.sibling}return null}var yj=sl.unstable_scheduleCallback,Mk=sl.unstable_cancelCallback,ile=sl.unstable_shouldYield,rle=sl.unstable_requestPaint,Jr=sl.unstable_now,nle=sl.unstable_getCurrentPriorityLevel,vF=sl.unstable_ImmediatePriority,vj=sl.unstable_UserBlockingPriority,n2=sl.unstable_NormalPriority,sle=sl.unstable_LowPriority,bj=sl.unstable_IdlePriority,XR=null,Qh=null;function ale(i){if(Qh&&typeof Qh.onCommitFiberRoot=="function")try{Qh.onCommitFiberRoot(XR,i,void 0,(i.current.flags&128)===128)}catch{}}var Nc=Math.clz32?Math.clz32:cle,ole=Math.log,lle=Math.LN2;function cle(i){return i>>>=0,i===0?32:31-(ole(i)/lle|0)|0}var CT=64,ST=4194304;function z1(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function s2(i,e){var t=i.pendingLanes;if(t===0)return 0;var r=0,n=i.suspendedLanes,s=i.pingedLanes,a=t&268435455;if(a!==0){var o=a&~n;o!==0?r=z1(o):(s&=a,s!==0&&(r=z1(s)))}else a=t&~n,a!==0?r=z1(a):s!==0&&(r=z1(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&n)&&(n=r&-r,s=e&-e,n>=s||n===16&&(s&4194240)!==0))return e;if(r&4&&(r|=t&16),e=i.entangledLanes,e!==0)for(i=i.entanglements,e&=r;0<e;)t=31-Nc(e),n=1<<t,r|=i[t],e&=~n;return r}function hle(i,e){switch(i){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ule(i,e){for(var t=i.suspendedLanes,r=i.pingedLanes,n=i.expirationTimes,s=i.pendingLanes;0<s;){var a=31-Nc(s),o=1<<a,l=n[a];l===-1?(!(o&t)||o&r)&&(n[a]=hle(o,e)):l<=e&&(i.expiredLanes|=o),s&=~o}}function pL(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function wj(){var i=CT;return CT<<=1,!(CT&4194240)&&(CT=64),i}function TA(i){for(var e=[],t=0;31>t;t++)e.push(i);return e}function Xx(i,e,t){i.pendingLanes|=e,e!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,e=31-Nc(e),i[e]=t}function dle(i,e){var t=i.pendingLanes&~e;i.pendingLanes=e,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=e,i.mutableReadLanes&=e,i.entangledLanes&=e,e=i.entanglements;var r=i.eventTimes;for(i=i.expirationTimes;0<t;){var n=31-Nc(t),s=1<<n;e[n]=0,r[n]=-1,i[n]=-1,t&=~s}}function bF(i,e){var t=i.entangledLanes|=e;for(i=i.entanglements;t;){var r=31-Nc(t),n=1<<r;n&e|i[r]&e&&(i[r]|=e),t&=~n}}var $i=0;function xj(i){return i&=-i,1<i?4<i?i&268435455?16:536870912:4:1}var Tj,wF,Cj,Sj,Ej,mL=!1,ET=[],pm=null,mm=null,fm=null,Vw=new Map,Uw=new Map,Xp=[],ple="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ik(i,e){switch(i){case"focusin":case"focusout":pm=null;break;case"dragenter":case"dragleave":mm=null;break;case"mouseover":case"mouseout":fm=null;break;case"pointerover":case"pointerout":Vw.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Uw.delete(e.pointerId)}}function Hv(i,e,t,r,n,s){return i===null||i.nativeEvent!==s?(i={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:s,targetContainers:[n]},e!==null&&(e=Zx(e),e!==null&&wF(e)),i):(i.eventSystemFlags|=r,e=i.targetContainers,n!==null&&e.indexOf(n)===-1&&e.push(n),i)}function mle(i,e,t,r,n){switch(e){case"focusin":return pm=Hv(pm,i,e,t,r,n),!0;case"dragenter":return mm=Hv(mm,i,e,t,r,n),!0;case"mouseover":return fm=Hv(fm,i,e,t,r,n),!0;case"pointerover":var s=n.pointerId;return Vw.set(s,Hv(Vw.get(s)||null,i,e,t,r,n)),!0;case"gotpointercapture":return s=n.pointerId,Uw.set(s,Hv(Uw.get(s)||null,i,e,t,r,n)),!0}return!1}function Rj(i){var e=rg(i.target);if(e!==null){var t=o_(e);if(t!==null){if(e=t.tag,e===13){if(e=fj(t),e!==null){i.blockedOn=e,Ej(i.priority,function(){Cj(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){i.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}i.blockedOn=null}function MS(i){if(i.blockedOn!==null)return!1;for(var e=i.targetContainers;0<e.length;){var t=fL(i.domEventName,i.eventSystemFlags,e[0],i.nativeEvent);if(t===null){t=i.nativeEvent;var r=new t.constructor(t.type,t);cL=r,t.target.dispatchEvent(r),cL=null}else return e=Zx(t),e!==null&&wF(e),i.blockedOn=t,!1;e.shift()}return!0}function Lk(i,e,t){MS(i)&&t.delete(e)}function fle(){mL=!1,pm!==null&&MS(pm)&&(pm=null),mm!==null&&MS(mm)&&(mm=null),fm!==null&&MS(fm)&&(fm=null),Vw.forEach(Lk),Uw.forEach(Lk)}function jv(i,e){i.blockedOn===e&&(i.blockedOn=null,mL||(mL=!0,sl.unstable_scheduleCallback(sl.unstable_NormalPriority,fle)))}function zw(i){function e(n){return jv(n,i)}if(0<ET.length){jv(ET[0],i);for(var t=1;t<ET.length;t++){var r=ET[t];r.blockedOn===i&&(r.blockedOn=null)}}for(pm!==null&&jv(pm,i),mm!==null&&jv(mm,i),fm!==null&&jv(fm,i),Vw.forEach(e),Uw.forEach(e),t=0;t<Xp.length;t++)r=Xp[t],r.blockedOn===i&&(r.blockedOn=null);for(;0<Xp.length&&(t=Xp[0],t.blockedOn===null);)Rj(t),t.blockedOn===null&&Xp.shift()}var M0=Ud.ReactCurrentBatchConfig,a2=!0;function gle(i,e,t,r){var n=$i,s=M0.transition;M0.transition=null;try{$i=1,xF(i,e,t,r)}finally{$i=n,M0.transition=s}}function _le(i,e,t,r){var n=$i,s=M0.transition;M0.transition=null;try{$i=4,xF(i,e,t,r)}finally{$i=n,M0.transition=s}}function xF(i,e,t,r){if(a2){var n=fL(i,e,t,r);if(n===null)LA(i,e,r,o2,t),Ik(i,r);else if(mle(n,i,e,t,r))r.stopPropagation();else if(Ik(i,r),e&4&&-1<ple.indexOf(i)){for(;n!==null;){var s=Zx(n);if(s!==null&&Tj(s),s=fL(i,e,t,r),s===null&&LA(i,e,r,o2,t),s===n)break;n=s}n!==null&&r.stopPropagation()}else LA(i,e,r,null,t)}}var o2=null;function fL(i,e,t,r){if(o2=null,i=yF(r),i=rg(i),i!==null)if(e=o_(i),e===null)i=null;else if(t=e.tag,t===13){if(i=fj(e),i!==null)return i;i=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;i=null}else e!==i&&(i=null);return o2=i,null}function Pj(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(nle()){case vF:return 1;case vj:return 4;case n2:case sle:return 16;case bj:return 536870912;default:return 16}default:return 16}}var rm=null,TF=null,IS=null;function Aj(){if(IS)return IS;var i,e=TF,t=e.length,r,n="value"in rm?rm.value:rm.textContent,s=n.length;for(i=0;i<t&&e[i]===n[i];i++);var a=t-i;for(r=1;r<=a&&e[t-r]===n[s-r];r++);return IS=n.slice(i,1<r?1-r:void 0)}function LS(i){var e=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&e===13&&(i=13)):i=e,i===10&&(i=13),32<=i||i===13?i:0}function RT(){return!0}function $k(){return!1}function ll(i){function e(t,r,n,s,a){this._reactName=t,this._targetInst=n,this.type=r,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in i)i.hasOwnProperty(o)&&(t=i[o],this[o]=t?t(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?RT:$k,this.isPropagationStopped=$k,this}return Mr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=RT)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=RT)},persist:function(){},isPersistent:RT}),e}var wv={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},CF=ll(wv),Qx=Mr({},wv,{view:0,detail:0}),yle=ll(Qx),CA,SA,qv,QR=Mr({},Qx,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:SF,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==qv&&(qv&&i.type==="mousemove"?(CA=i.screenX-qv.screenX,SA=i.screenY-qv.screenY):SA=CA=0,qv=i),CA)},movementY:function(i){return"movementY"in i?i.movementY:SA}}),Dk=ll(QR),vle=Mr({},QR,{dataTransfer:0}),ble=ll(vle),wle=Mr({},Qx,{relatedTarget:0}),EA=ll(wle),xle=Mr({},wv,{animationName:0,elapsedTime:0,pseudoElement:0}),Tle=ll(xle),Cle=Mr({},wv,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Sle=ll(Cle),Ele=Mr({},wv,{data:0}),Fk=ll(Ele),Rle={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ple={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ale={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ole(i){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(i):(i=Ale[i])?!!e[i]:!1}function SF(){return Ole}var Mle=Mr({},Qx,{key:function(i){if(i.key){var e=Rle[i.key]||i.key;if(e!=="Unidentified")return e}return i.type==="keypress"?(i=LS(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Ple[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:SF,charCode:function(i){return i.type==="keypress"?LS(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?LS(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Ile=ll(Mle),Lle=Mr({},QR,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Nk=ll(Lle),$le=Mr({},Qx,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:SF}),Dle=ll($le),Fle=Mr({},wv,{propertyName:0,elapsedTime:0,pseudoElement:0}),Nle=ll(Fle),kle=Mr({},QR,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Vle=ll(kle),Ule=[9,13,27,32],EF=Ed&&"CompositionEvent"in window,zb=null;Ed&&"documentMode"in document&&(zb=document.documentMode);var zle=Ed&&"TextEvent"in window&&!zb,Oj=Ed&&(!EF||zb&&8<zb&&11>=zb),kk=String.fromCharCode(32),Vk=!1;function Mj(i,e){switch(i){case"keyup":return Ule.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ij(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Yy=!1;function Ble(i,e){switch(i){case"compositionend":return Ij(e);case"keypress":return e.which!==32?null:(Vk=!0,kk);case"textInput":return i=e.data,i===kk&&Vk?null:i;default:return null}}function Gle(i,e){if(Yy)return i==="compositionend"||!EF&&Mj(i,e)?(i=Aj(),IS=TF=rm=null,Yy=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Oj&&e.locale!=="ko"?null:e.data;default:return null}}var Hle={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Uk(i){var e=i&&i.nodeName&&i.nodeName.toLowerCase();return e==="input"?!!Hle[i.type]:e==="textarea"}function Lj(i,e,t,r){hj(r),e=l2(e,"onChange"),0<e.length&&(t=new CF("onChange","change",null,t,r),i.push({event:t,listeners:e}))}var Bb=null,Bw=null;function jle(i){Hj(i,0)}function ZR(i){var e=e0(i);if(rj(e))return i}function qle(i,e){if(i==="change")return e}var $j=!1;if(Ed){var RA;if(Ed){var PA="oninput"in document;if(!PA){var zk=document.createElement("div");zk.setAttribute("oninput","return;"),PA=typeof zk.oninput=="function"}RA=PA}else RA=!1;$j=RA&&(!document.documentMode||9<document.documentMode)}function Bk(){Bb&&(Bb.detachEvent("onpropertychange",Dj),Bw=Bb=null)}function Dj(i){if(i.propertyName==="value"&&ZR(Bw)){var e=[];Lj(e,Bw,i,yF(i)),mj(jle,e)}}function Wle(i,e,t){i==="focusin"?(Bk(),Bb=e,Bw=t,Bb.attachEvent("onpropertychange",Dj)):i==="focusout"&&Bk()}function Xle(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return ZR(Bw)}function Qle(i,e){if(i==="click")return ZR(e)}function Zle(i,e){if(i==="input"||i==="change")return ZR(e)}function Yle(i,e){return i===e&&(i!==0||1/i===1/e)||i!==i&&e!==e}var Hc=typeof Object.is=="function"?Object.is:Yle;function Gw(i,e){if(Hc(i,e))return!0;if(typeof i!="object"||i===null||typeof e!="object"||e===null)return!1;var t=Object.keys(i),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var n=t[r];if(!YI.call(e,n)||!Hc(i[n],e[n]))return!1}return!0}function Gk(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Hk(i,e){var t=Gk(i);i=0;for(var r;t;){if(t.nodeType===3){if(r=i+t.textContent.length,i<=e&&r>=e)return{node:t,offset:e-i};i=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=Gk(t)}}function Fj(i,e){return i&&e?i===e?!0:i&&i.nodeType===3?!1:e&&e.nodeType===3?Fj(i,e.parentNode):"contains"in i?i.contains(e):i.compareDocumentPosition?!!(i.compareDocumentPosition(e)&16):!1:!1}function Nj(){for(var i=window,e=t2();e instanceof i.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)i=e.contentWindow;else break;e=t2(i.document)}return e}function RF(i){var e=i&&i.nodeName&&i.nodeName.toLowerCase();return e&&(e==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||e==="textarea"||i.contentEditable==="true")}function Kle(i){var e=Nj(),t=i.focusedElem,r=i.selectionRange;if(e!==t&&t&&t.ownerDocument&&Fj(t.ownerDocument.documentElement,t)){if(r!==null&&RF(t)){if(e=r.start,i=r.end,i===void 0&&(i=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(i,t.value.length);else if(i=(e=t.ownerDocument||document)&&e.defaultView||window,i.getSelection){i=i.getSelection();var n=t.textContent.length,s=Math.min(r.start,n);r=r.end===void 0?s:Math.min(r.end,n),!i.extend&&s>r&&(n=r,r=s,s=n),n=Hk(t,s);var a=Hk(t,r);n&&a&&(i.rangeCount!==1||i.anchorNode!==n.node||i.anchorOffset!==n.offset||i.focusNode!==a.node||i.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(n.node,n.offset),i.removeAllRanges(),s>r?(i.addRange(e),i.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),i.addRange(e)))}}for(e=[],i=t;i=i.parentNode;)i.nodeType===1&&e.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)i=e[t],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var Jle=Ed&&"documentMode"in document&&11>=document.documentMode,Ky=null,gL=null,Gb=null,_L=!1;function jk(i,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;_L||Ky==null||Ky!==t2(r)||(r=Ky,"selectionStart"in r&&RF(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Gb&&Gw(Gb,r)||(Gb=r,r=l2(gL,"onSelect"),0<r.length&&(e=new CF("onSelect","select",null,e,t),i.push({event:e,listeners:r}),e.target=Ky)))}function PT(i,e){var t={};return t[i.toLowerCase()]=e.toLowerCase(),t["Webkit"+i]="webkit"+e,t["Moz"+i]="moz"+e,t}var Jy={animationend:PT("Animation","AnimationEnd"),animationiteration:PT("Animation","AnimationIteration"),animationstart:PT("Animation","AnimationStart"),transitionend:PT("Transition","TransitionEnd")},AA={},kj={};Ed&&(kj=document.createElement("div").style,"AnimationEvent"in window||(delete Jy.animationend.animation,delete Jy.animationiteration.animation,delete Jy.animationstart.animation),"TransitionEvent"in window||delete Jy.transitionend.transition);function YR(i){if(AA[i])return AA[i];if(!Jy[i])return i;var e=Jy[i],t;for(t in e)if(e.hasOwnProperty(t)&&t in kj)return AA[i]=e[t];return i}var Vj=YR("animationend"),Uj=YR("animationiteration"),zj=YR("animationstart"),Bj=YR("transitionend"),Gj=new Map,qk="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Wm(i,e){Gj.set(i,e),a_(e,[i])}for(var OA=0;OA<qk.length;OA++){var MA=qk[OA],ece=MA.toLowerCase(),tce=MA[0].toUpperCase()+MA.slice(1);Wm(ece,"on"+tce)}Wm(Vj,"onAnimationEnd");Wm(Uj,"onAnimationIteration");Wm(zj,"onAnimationStart");Wm("dblclick","onDoubleClick");Wm("focusin","onFocus");Wm("focusout","onBlur");Wm(Bj,"onTransitionEnd");ev("onMouseEnter",["mouseout","mouseover"]);ev("onMouseLeave",["mouseout","mouseover"]);ev("onPointerEnter",["pointerout","pointerover"]);ev("onPointerLeave",["pointerout","pointerover"]);a_("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));a_("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));a_("onBeforeInput",["compositionend","keypress","textInput","paste"]);a_("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));a_("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));a_("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var B1="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ice=new Set("cancel close invalid load scroll toggle".split(" ").concat(B1));function Wk(i,e,t){var r=i.type||"unknown-event";i.currentTarget=t,ele(r,e,void 0,i),i.currentTarget=null}function Hj(i,e){e=(e&4)!==0;for(var t=0;t<i.length;t++){var r=i[t],n=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var a=r.length-1;0<=a;a--){var o=r[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&n.isPropagationStopped())break e;Wk(n,o,c),s=l}else for(a=0;a<r.length;a++){if(o=r[a],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&n.isPropagationStopped())break e;Wk(n,o,c),s=l}}}if(r2)throw i=dL,r2=!1,dL=null,i}function ar(i,e){var t=e[xL];t===void 0&&(t=e[xL]=new Set);var r=i+"__bubble";t.has(r)||(jj(e,i,2,!1),t.add(r))}function IA(i,e,t){var r=0;e&&(r|=4),jj(t,i,r,e)}var AT="_reactListening"+Math.random().toString(36).slice(2);function Hw(i){if(!i[AT]){i[AT]=!0,KH.forEach(function(t){t!=="selectionchange"&&(ice.has(t)||IA(t,!1,i),IA(t,!0,i))});var e=i.nodeType===9?i:i.ownerDocument;e===null||e[AT]||(e[AT]=!0,IA("selectionchange",!1,e))}}function jj(i,e,t,r){switch(Pj(e)){case 1:var n=gle;break;case 4:n=_le;break;default:n=xF}t=n.bind(null,e,t,i),n=void 0,!uL||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(n=!0),r?n!==void 0?i.addEventListener(e,t,{capture:!0,passive:n}):i.addEventListener(e,t,!0):n!==void 0?i.addEventListener(e,t,{passive:n}):i.addEventListener(e,t,!1)}function LA(i,e,t,r,n){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var o=r.stateNode.containerInfo;if(o===n||o.nodeType===8&&o.parentNode===n)break;if(a===4)for(a=r.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===n||l.nodeType===8&&l.parentNode===n))return;a=a.return}for(;o!==null;){if(a=rg(o),a===null)return;if(l=a.tag,l===5||l===6){r=s=a;continue e}o=o.parentNode}}r=r.return}mj(function(){var c=s,u=yF(t),d=[];e:{var m=Gj.get(i);if(m!==void 0){var f=CF,_=i;switch(i){case"keypress":if(LS(t)===0)break e;case"keydown":case"keyup":f=Ile;break;case"focusin":_="focus",f=EA;break;case"focusout":_="blur",f=EA;break;case"beforeblur":case"afterblur":f=EA;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=Dk;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=ble;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=Dle;break;case Vj:case Uj:case zj:f=Tle;break;case Bj:f=Nle;break;case"scroll":f=yle;break;case"wheel":f=Vle;break;case"copy":case"cut":case"paste":f=Sle;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=Nk}var g=(e&4)!==0,w=!g&&i==="scroll",v=g?m!==null?m+"Capture":null:m;g=[];for(var b=c,x;b!==null;){x=b;var T=x.stateNode;if(x.tag===5&&T!==null&&(x=T,v!==null&&(T=kw(b,v),T!=null&&g.push(jw(b,T,x)))),w)break;b=b.return}0<g.length&&(m=new f(m,_,null,t,u),d.push({event:m,listeners:g}))}}if(!(e&7)){e:{if(m=i==="mouseover"||i==="pointerover",f=i==="mouseout"||i==="pointerout",m&&t!==cL&&(_=t.relatedTarget||t.fromElement)&&(rg(_)||_[Rd]))break e;if((f||m)&&(m=u.window===u?u:(m=u.ownerDocument)?m.defaultView||m.parentWindow:window,f?(_=t.relatedTarget||t.toElement,f=c,_=_?rg(_):null,_!==null&&(w=o_(_),_!==w||_.tag!==5&&_.tag!==6)&&(_=null)):(f=null,_=c),f!==_)){if(g=Dk,T="onMouseLeave",v="onMouseEnter",b="mouse",(i==="pointerout"||i==="pointerover")&&(g=Nk,T="onPointerLeave",v="onPointerEnter",b="pointer"),w=f==null?m:e0(f),x=_==null?m:e0(_),m=new g(T,b+"leave",f,t,u),m.target=w,m.relatedTarget=x,T=null,rg(u)===c&&(g=new g(v,b+"enter",_,t,u),g.target=x,g.relatedTarget=w,T=g),w=T,f&&_)t:{for(g=f,v=_,b=0,x=g;x;x=S_(x))b++;for(x=0,T=v;T;T=S_(T))x++;for(;0<b-x;)g=S_(g),b--;for(;0<x-b;)v=S_(v),x--;for(;b--;){if(g===v||v!==null&&g===v.alternate)break t;g=S_(g),v=S_(v)}g=null}else g=null;f!==null&&Xk(d,m,f,g,!1),_!==null&&w!==null&&Xk(d,w,_,g,!0)}}e:{if(m=c?e0(c):window,f=m.nodeName&&m.nodeName.toLowerCase(),f==="select"||f==="input"&&m.type==="file")var R=qle;else if(Uk(m))if($j)R=Zle;else{R=Xle;var E=Wle}else(f=m.nodeName)&&f.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(R=Qle);if(R&&(R=R(i,c))){Lj(d,R,t,u);break e}E&&E(i,m,c),i==="focusout"&&(E=m._wrapperState)&&E.controlled&&m.type==="number"&&nL(m,"number",m.value)}switch(E=c?e0(c):window,i){case"focusin":(Uk(E)||E.contentEditable==="true")&&(Ky=E,gL=c,Gb=null);break;case"focusout":Gb=gL=Ky=null;break;case"mousedown":_L=!0;break;case"contextmenu":case"mouseup":case"dragend":_L=!1,jk(d,t,u);break;case"selectionchange":if(Jle)break;case"keydown":case"keyup":jk(d,t,u)}var O;if(EF)e:{switch(i){case"compositionstart":var $="onCompositionStart";break e;case"compositionend":$="onCompositionEnd";break e;case"compositionupdate":$="onCompositionUpdate";break e}$=void 0}else Yy?Mj(i,t)&&($="onCompositionEnd"):i==="keydown"&&t.keyCode===229&&($="onCompositionStart");$&&(Oj&&t.locale!=="ko"&&(Yy||$!=="onCompositionStart"?$==="onCompositionEnd"&&Yy&&(O=Aj()):(rm=u,TF="value"in rm?rm.value:rm.textContent,Yy=!0)),E=l2(c,$),0<E.length&&($=new Fk($,i,null,t,u),d.push({event:$,listeners:E}),O?$.data=O:(O=Ij(t),O!==null&&($.data=O)))),(O=zle?Ble(i,t):Gle(i,t))&&(c=l2(c,"onBeforeInput"),0<c.length&&(u=new Fk("onBeforeInput","beforeinput",null,t,u),d.push({event:u,listeners:c}),u.data=O))}Hj(d,e)})}function jw(i,e,t){return{instance:i,listener:e,currentTarget:t}}function l2(i,e){for(var t=e+"Capture",r=[];i!==null;){var n=i,s=n.stateNode;n.tag===5&&s!==null&&(n=s,s=kw(i,t),s!=null&&r.unshift(jw(i,s,n)),s=kw(i,e),s!=null&&r.push(jw(i,s,n))),i=i.return}return r}function S_(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function Xk(i,e,t,r,n){for(var s=e._reactName,a=[];t!==null&&t!==r;){var o=t,l=o.alternate,c=o.stateNode;if(l!==null&&l===r)break;o.tag===5&&c!==null&&(o=c,n?(l=kw(t,s),l!=null&&a.unshift(jw(t,l,o))):n||(l=kw(t,s),l!=null&&a.push(jw(t,l,o)))),t=t.return}a.length!==0&&i.push({event:e,listeners:a})}var rce=/\r\n?/g,nce=/\u0000|\uFFFD/g;function Qk(i){return(typeof i=="string"?i:""+i).replace(rce,`
`).replace(nce,"")}function OT(i,e,t){if(e=Qk(e),Qk(i)!==e&&t)throw Error(ve(425))}function c2(){}var yL=null,vL=null;function bL(i,e){return i==="textarea"||i==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var wL=typeof setTimeout=="function"?setTimeout:void 0,sce=typeof clearTimeout=="function"?clearTimeout:void 0,Zk=typeof Promise=="function"?Promise:void 0,ace=typeof queueMicrotask=="function"?queueMicrotask:typeof Zk<"u"?function(i){return Zk.resolve(null).then(i).catch(oce)}:wL;function oce(i){setTimeout(function(){throw i})}function $A(i,e){var t=e,r=0;do{var n=t.nextSibling;if(i.removeChild(t),n&&n.nodeType===8)if(t=n.data,t==="/$"){if(r===0){i.removeChild(n),zw(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=n}while(t);zw(e)}function gm(i){for(;i!=null;i=i.nextSibling){var e=i.nodeType;if(e===1||e===3)break;if(e===8){if(e=i.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return i}function Yk(i){i=i.previousSibling;for(var e=0;i;){if(i.nodeType===8){var t=i.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return i;e--}else t==="/$"&&e++}i=i.previousSibling}return null}var xv=Math.random().toString(36).slice(2),kh="__reactFiber$"+xv,qw="__reactProps$"+xv,Rd="__reactContainer$"+xv,xL="__reactEvents$"+xv,lce="__reactListeners$"+xv,cce="__reactHandles$"+xv;function rg(i){var e=i[kh];if(e)return e;for(var t=i.parentNode;t;){if(e=t[Rd]||t[kh]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(i=Yk(i);i!==null;){if(t=i[kh])return t;i=Yk(i)}return e}i=t,t=i.parentNode}return null}function Zx(i){return i=i[kh]||i[Rd],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function e0(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(ve(33))}function KR(i){return i[qw]||null}var TL=[],t0=-1;function Xm(i){return{current:i}}function mr(i){0>t0||(i.current=TL[t0],TL[t0]=null,t0--)}function ir(i,e){t0++,TL[t0]=i.current,i.current=e}var km={},Ks=Xm(km),po=Xm(!1),Fg=km;function tv(i,e){var t=i.type.contextTypes;if(!t)return km;var r=i.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var n={},s;for(s in t)n[s]=e[s];return r&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=e,i.__reactInternalMemoizedMaskedChildContext=n),n}function mo(i){return i=i.childContextTypes,i!=null}function h2(){mr(po),mr(Ks)}function Kk(i,e,t){if(Ks.current!==km)throw Error(ve(168));ir(Ks,e),ir(po,t)}function qj(i,e,t){var r=i.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var n in r)if(!(n in e))throw Error(ve(108,Woe(i)||"Unknown",n));return Mr({},t,r)}function u2(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||km,Fg=Ks.current,ir(Ks,i),ir(po,po.current),!0}function Jk(i,e,t){var r=i.stateNode;if(!r)throw Error(ve(169));t?(i=qj(i,e,Fg),r.__reactInternalMemoizedMergedChildContext=i,mr(po),mr(Ks),ir(Ks,i)):mr(po),ir(po,t)}var Ku=null,JR=!1,DA=!1;function Wj(i){Ku===null?Ku=[i]:Ku.push(i)}function hce(i){JR=!0,Wj(i)}function Qm(){if(!DA&&Ku!==null){DA=!0;var i=0,e=$i;try{var t=Ku;for($i=1;i<t.length;i++){var r=t[i];do r=r(!0);while(r!==null)}Ku=null,JR=!1}catch(n){throw Ku!==null&&(Ku=Ku.slice(i+1)),yj(vF,Qm),n}finally{$i=e,DA=!1}}return null}var i0=[],r0=0,d2=null,p2=0,El=[],Rl=0,Ng=null,ad=1,od="";function Ef(i,e){i0[r0++]=p2,i0[r0++]=d2,d2=i,p2=e}function Xj(i,e,t){El[Rl++]=ad,El[Rl++]=od,El[Rl++]=Ng,Ng=i;var r=ad;i=od;var n=32-Nc(r)-1;r&=~(1<<n),t+=1;var s=32-Nc(e)+n;if(30<s){var a=n-n%5;s=(r&(1<<a)-1).toString(32),r>>=a,n-=a,ad=1<<32-Nc(e)+n|t<<n|r,od=s+i}else ad=1<<s|t<<n|r,od=i}function PF(i){i.return!==null&&(Ef(i,1),Xj(i,1,0))}function AF(i){for(;i===d2;)d2=i0[--r0],i0[r0]=null,p2=i0[--r0],i0[r0]=null;for(;i===Ng;)Ng=El[--Rl],El[Rl]=null,od=El[--Rl],El[Rl]=null,ad=El[--Rl],El[Rl]=null}var rl=null,el=null,br=!1,wc=null;function Qj(i,e){var t=Vl(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=i,e=i.deletions,e===null?(i.deletions=[t],i.flags|=16):e.push(t)}function e9(i,e){switch(i.tag){case 5:var t=i.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(i.stateNode=e,rl=i,el=gm(e.firstChild),!0):!1;case 6:return e=i.pendingProps===""||e.nodeType!==3?null:e,e!==null?(i.stateNode=e,rl=i,el=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=Ng!==null?{id:ad,overflow:od}:null,i.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Vl(18,null,null,0),t.stateNode=e,t.return=i,i.child=t,rl=i,el=null,!0):!1;default:return!1}}function CL(i){return(i.mode&1)!==0&&(i.flags&128)===0}function SL(i){if(br){var e=el;if(e){var t=e;if(!e9(i,e)){if(CL(i))throw Error(ve(418));e=gm(t.nextSibling);var r=rl;e&&e9(i,e)?Qj(r,t):(i.flags=i.flags&-4097|2,br=!1,rl=i)}}else{if(CL(i))throw Error(ve(418));i.flags=i.flags&-4097|2,br=!1,rl=i}}}function t9(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;rl=i}function MT(i){if(i!==rl)return!1;if(!br)return t9(i),br=!0,!1;var e;if((e=i.tag!==3)&&!(e=i.tag!==5)&&(e=i.type,e=e!=="head"&&e!=="body"&&!bL(i.type,i.memoizedProps)),e&&(e=el)){if(CL(i))throw Zj(),Error(ve(418));for(;e;)Qj(i,e),e=gm(e.nextSibling)}if(t9(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ve(317));e:{for(i=i.nextSibling,e=0;i;){if(i.nodeType===8){var t=i.data;if(t==="/$"){if(e===0){el=gm(i.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}i=i.nextSibling}el=null}}else el=rl?gm(i.stateNode.nextSibling):null;return!0}function Zj(){for(var i=el;i;)i=gm(i.nextSibling)}function iv(){el=rl=null,br=!1}function OF(i){wc===null?wc=[i]:wc.push(i)}var uce=Ud.ReactCurrentBatchConfig;function _c(i,e){if(i&&i.defaultProps){e=Mr({},e),i=i.defaultProps;for(var t in i)e[t]===void 0&&(e[t]=i[t]);return e}return e}var m2=Xm(null),f2=null,n0=null,MF=null;function IF(){MF=n0=f2=null}function LF(i){var e=m2.current;mr(m2),i._currentValue=e}function EL(i,e,t){for(;i!==null;){var r=i.alternate;if((i.childLanes&e)!==e?(i.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),i===t)break;i=i.return}}function I0(i,e){f2=i,MF=n0=null,i=i.dependencies,i!==null&&i.firstContext!==null&&(i.lanes&e&&(uo=!0),i.firstContext=null)}function ql(i){var e=i._currentValue;if(MF!==i)if(i={context:i,memoizedValue:e,next:null},n0===null){if(f2===null)throw Error(ve(308));n0=i,f2.dependencies={lanes:0,firstContext:i}}else n0=n0.next=i;return e}var ng=null;function $F(i){ng===null?ng=[i]:ng.push(i)}function Yj(i,e,t,r){var n=e.interleaved;return n===null?(t.next=t,$F(e)):(t.next=n.next,n.next=t),e.interleaved=t,Pd(i,r)}function Pd(i,e){i.lanes|=e;var t=i.alternate;for(t!==null&&(t.lanes|=e),t=i,i=i.return;i!==null;)i.childLanes|=e,t=i.alternate,t!==null&&(t.childLanes|=e),t=i,i=i.return;return t.tag===3?t.stateNode:null}var Bp=!1;function DF(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Kj(i,e){i=i.updateQueue,e.updateQueue===i&&(e.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function fd(i,e){return{eventTime:i,lane:e,tag:0,payload:null,callback:null,next:null}}function _m(i,e,t){var r=i.updateQueue;if(r===null)return null;if(r=r.shared,fi&2){var n=r.pending;return n===null?e.next=e:(e.next=n.next,n.next=e),r.pending=e,Pd(i,t)}return n=r.interleaved,n===null?(e.next=e,$F(r)):(e.next=n.next,n.next=e),r.interleaved=e,Pd(i,t)}function $S(i,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=i.pendingLanes,t|=r,e.lanes=t,bF(i,t)}}function i9(i,e){var t=i.updateQueue,r=i.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var n=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var a={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?n=s=a:s=s.next=a,t=t.next}while(t!==null);s===null?n=s=e:s=s.next=e}else n=s=e;t={baseState:r.baseState,firstBaseUpdate:n,lastBaseUpdate:s,shared:r.shared,effects:r.effects},i.updateQueue=t;return}i=t.lastBaseUpdate,i===null?t.firstBaseUpdate=e:i.next=e,t.lastBaseUpdate=e}function g2(i,e,t,r){var n=i.updateQueue;Bp=!1;var s=n.firstBaseUpdate,a=n.lastBaseUpdate,o=n.shared.pending;if(o!==null){n.shared.pending=null;var l=o,c=l.next;l.next=null,a===null?s=c:a.next=c,a=l;var u=i.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==a&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(s!==null){var d=n.baseState;a=0,u=c=l=null,o=s;do{var m=o.lane,f=o.eventTime;if((r&m)===m){u!==null&&(u=u.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var _=i,g=o;switch(m=e,f=t,g.tag){case 1:if(_=g.payload,typeof _=="function"){d=_.call(f,d,m);break e}d=_;break e;case 3:_.flags=_.flags&-65537|128;case 0:if(_=g.payload,m=typeof _=="function"?_.call(f,d,m):_,m==null)break e;d=Mr({},d,m);break e;case 2:Bp=!0}}o.callback!==null&&o.lane!==0&&(i.flags|=64,m=n.effects,m===null?n.effects=[o]:m.push(o))}else f={eventTime:f,lane:m,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=f,l=d):u=u.next=f,a|=m;if(o=o.next,o===null){if(o=n.shared.pending,o===null)break;m=o,o=m.next,m.next=null,n.lastBaseUpdate=m,n.shared.pending=null}}while(1);if(u===null&&(l=d),n.baseState=l,n.firstBaseUpdate=c,n.lastBaseUpdate=u,e=n.shared.interleaved,e!==null){n=e;do a|=n.lane,n=n.next;while(n!==e)}else s===null&&(n.shared.lanes=0);Vg|=a,i.lanes=a,i.memoizedState=d}}function r9(i,e,t){if(i=e.effects,e.effects=null,i!==null)for(e=0;e<i.length;e++){var r=i[e],n=r.callback;if(n!==null){if(r.callback=null,r=t,typeof n!="function")throw Error(ve(191,n));n.call(r)}}}var Jj=new YH.Component().refs;function RL(i,e,t,r){e=i.memoizedState,t=t(r,e),t=t==null?e:Mr({},e,t),i.memoizedState=t,i.lanes===0&&(i.updateQueue.baseState=t)}var eP={isMounted:function(i){return(i=i._reactInternals)?o_(i)===i:!1},enqueueSetState:function(i,e,t){i=i._reactInternals;var r=Oa(),n=vm(i),s=fd(r,n);s.payload=e,t!=null&&(s.callback=t),e=_m(i,s,n),e!==null&&(kc(e,i,n,r),$S(e,i,n))},enqueueReplaceState:function(i,e,t){i=i._reactInternals;var r=Oa(),n=vm(i),s=fd(r,n);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=_m(i,s,n),e!==null&&(kc(e,i,n,r),$S(e,i,n))},enqueueForceUpdate:function(i,e){i=i._reactInternals;var t=Oa(),r=vm(i),n=fd(t,r);n.tag=2,e!=null&&(n.callback=e),e=_m(i,n,r),e!==null&&(kc(e,i,r,t),$S(e,i,r))}};function n9(i,e,t,r,n,s,a){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(r,s,a):e.prototype&&e.prototype.isPureReactComponent?!Gw(t,r)||!Gw(n,s):!0}function eq(i,e,t){var r=!1,n=km,s=e.contextType;return typeof s=="object"&&s!==null?s=ql(s):(n=mo(e)?Fg:Ks.current,r=e.contextTypes,s=(r=r!=null)?tv(i,n):km),e=new e(t,s),i.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=eP,i.stateNode=e,e._reactInternals=i,r&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=n,i.__reactInternalMemoizedMaskedChildContext=s),e}function s9(i,e,t,r){i=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==i&&eP.enqueueReplaceState(e,e.state,null)}function PL(i,e,t,r){var n=i.stateNode;n.props=t,n.state=i.memoizedState,n.refs=Jj,DF(i);var s=e.contextType;typeof s=="object"&&s!==null?n.context=ql(s):(s=mo(e)?Fg:Ks.current,n.context=tv(i,s)),n.state=i.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(RL(i,e,s,t),n.state=i.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(e=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),e!==n.state&&eP.enqueueReplaceState(n,n.state,null),g2(i,t,n,r),n.state=i.memoizedState),typeof n.componentDidMount=="function"&&(i.flags|=4194308)}function Wv(i,e,t){if(i=t.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(ve(309));var r=t.stateNode}if(!r)throw Error(ve(147,i));var n=r,s=""+i;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var o=n.refs;o===Jj&&(o=n.refs={}),a===null?delete o[s]:o[s]=a},e._stringRef=s,e)}if(typeof i!="string")throw Error(ve(284));if(!t._owner)throw Error(ve(290,i))}return i}function IT(i,e){throw i=Object.prototype.toString.call(e),Error(ve(31,i==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":i))}function a9(i){var e=i._init;return e(i._payload)}function tq(i){function e(v,b){if(i){var x=v.deletions;x===null?(v.deletions=[b],v.flags|=16):x.push(b)}}function t(v,b){if(!i)return null;for(;b!==null;)e(v,b),b=b.sibling;return null}function r(v,b){for(v=new Map;b!==null;)b.key!==null?v.set(b.key,b):v.set(b.index,b),b=b.sibling;return v}function n(v,b){return v=bm(v,b),v.index=0,v.sibling=null,v}function s(v,b,x){return v.index=x,i?(x=v.alternate,x!==null?(x=x.index,x<b?(v.flags|=2,b):x):(v.flags|=2,b)):(v.flags|=1048576,b)}function a(v){return i&&v.alternate===null&&(v.flags|=2),v}function o(v,b,x,T){return b===null||b.tag!==6?(b=BA(x,v.mode,T),b.return=v,b):(b=n(b,x),b.return=v,b)}function l(v,b,x,T){var R=x.type;return R===Zy?u(v,b,x.props.children,T,x.key):b!==null&&(b.elementType===R||typeof R=="object"&&R!==null&&R.$$typeof===zp&&a9(R)===b.type)?(T=n(b,x.props),T.ref=Wv(v,b,x),T.return=v,T):(T=US(x.type,x.key,x.props,null,v.mode,T),T.ref=Wv(v,b,x),T.return=v,T)}function c(v,b,x,T){return b===null||b.tag!==4||b.stateNode.containerInfo!==x.containerInfo||b.stateNode.implementation!==x.implementation?(b=GA(x,v.mode,T),b.return=v,b):(b=n(b,x.children||[]),b.return=v,b)}function u(v,b,x,T,R){return b===null||b.tag!==7?(b=yg(x,v.mode,T,R),b.return=v,b):(b=n(b,x),b.return=v,b)}function d(v,b,x){if(typeof b=="string"&&b!==""||typeof b=="number")return b=BA(""+b,v.mode,x),b.return=v,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case wT:return x=US(b.type,b.key,b.props,null,v.mode,x),x.ref=Wv(v,null,b),x.return=v,x;case Qy:return b=GA(b,v.mode,x),b.return=v,b;case zp:var T=b._init;return d(v,T(b._payload),x)}if(U1(b)||Bv(b))return b=yg(b,v.mode,x,null),b.return=v,b;IT(v,b)}return null}function m(v,b,x,T){var R=b!==null?b.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return R!==null?null:o(v,b,""+x,T);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case wT:return x.key===R?l(v,b,x,T):null;case Qy:return x.key===R?c(v,b,x,T):null;case zp:return R=x._init,m(v,b,R(x._payload),T)}if(U1(x)||Bv(x))return R!==null?null:u(v,b,x,T,null);IT(v,x)}return null}function f(v,b,x,T,R){if(typeof T=="string"&&T!==""||typeof T=="number")return v=v.get(x)||null,o(b,v,""+T,R);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case wT:return v=v.get(T.key===null?x:T.key)||null,l(b,v,T,R);case Qy:return v=v.get(T.key===null?x:T.key)||null,c(b,v,T,R);case zp:var E=T._init;return f(v,b,x,E(T._payload),R)}if(U1(T)||Bv(T))return v=v.get(x)||null,u(b,v,T,R,null);IT(b,T)}return null}function _(v,b,x,T){for(var R=null,E=null,O=b,$=b=0,D=null;O!==null&&$<x.length;$++){O.index>$?(D=O,O=null):D=O.sibling;var I=m(v,O,x[$],T);if(I===null){O===null&&(O=D);break}i&&O&&I.alternate===null&&e(v,O),b=s(I,b,$),E===null?R=I:E.sibling=I,E=I,O=D}if($===x.length)return t(v,O),br&&Ef(v,$),R;if(O===null){for(;$<x.length;$++)O=d(v,x[$],T),O!==null&&(b=s(O,b,$),E===null?R=O:E.sibling=O,E=O);return br&&Ef(v,$),R}for(O=r(v,O);$<x.length;$++)D=f(O,v,$,x[$],T),D!==null&&(i&&D.alternate!==null&&O.delete(D.key===null?$:D.key),b=s(D,b,$),E===null?R=D:E.sibling=D,E=D);return i&&O.forEach(function(G){return e(v,G)}),br&&Ef(v,$),R}function g(v,b,x,T){var R=Bv(x);if(typeof R!="function")throw Error(ve(150));if(x=R.call(x),x==null)throw Error(ve(151));for(var E=R=null,O=b,$=b=0,D=null,I=x.next();O!==null&&!I.done;$++,I=x.next()){O.index>$?(D=O,O=null):D=O.sibling;var G=m(v,O,I.value,T);if(G===null){O===null&&(O=D);break}i&&O&&G.alternate===null&&e(v,O),b=s(G,b,$),E===null?R=G:E.sibling=G,E=G,O=D}if(I.done)return t(v,O),br&&Ef(v,$),R;if(O===null){for(;!I.done;$++,I=x.next())I=d(v,I.value,T),I!==null&&(b=s(I,b,$),E===null?R=I:E.sibling=I,E=I);return br&&Ef(v,$),R}for(O=r(v,O);!I.done;$++,I=x.next())I=f(O,v,$,I.value,T),I!==null&&(i&&I.alternate!==null&&O.delete(I.key===null?$:I.key),b=s(I,b,$),E===null?R=I:E.sibling=I,E=I);return i&&O.forEach(function(W){return e(v,W)}),br&&Ef(v,$),R}function w(v,b,x,T){if(typeof x=="object"&&x!==null&&x.type===Zy&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case wT:e:{for(var R=x.key,E=b;E!==null;){if(E.key===R){if(R=x.type,R===Zy){if(E.tag===7){t(v,E.sibling),b=n(E,x.props.children),b.return=v,v=b;break e}}else if(E.elementType===R||typeof R=="object"&&R!==null&&R.$$typeof===zp&&a9(R)===E.type){t(v,E.sibling),b=n(E,x.props),b.ref=Wv(v,E,x),b.return=v,v=b;break e}t(v,E);break}else e(v,E);E=E.sibling}x.type===Zy?(b=yg(x.props.children,v.mode,T,x.key),b.return=v,v=b):(T=US(x.type,x.key,x.props,null,v.mode,T),T.ref=Wv(v,b,x),T.return=v,v=T)}return a(v);case Qy:e:{for(E=x.key;b!==null;){if(b.key===E)if(b.tag===4&&b.stateNode.containerInfo===x.containerInfo&&b.stateNode.implementation===x.implementation){t(v,b.sibling),b=n(b,x.children||[]),b.return=v,v=b;break e}else{t(v,b);break}else e(v,b);b=b.sibling}b=GA(x,v.mode,T),b.return=v,v=b}return a(v);case zp:return E=x._init,w(v,b,E(x._payload),T)}if(U1(x))return _(v,b,x,T);if(Bv(x))return g(v,b,x,T);IT(v,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,b!==null&&b.tag===6?(t(v,b.sibling),b=n(b,x),b.return=v,v=b):(t(v,b),b=BA(x,v.mode,T),b.return=v,v=b),a(v)):t(v,b)}return w}var rv=tq(!0),iq=tq(!1),Yx={},Zh=Xm(Yx),Ww=Xm(Yx),Xw=Xm(Yx);function sg(i){if(i===Yx)throw Error(ve(174));return i}function FF(i,e){switch(ir(Xw,e),ir(Ww,i),ir(Zh,Yx),i=e.nodeType,i){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:aL(null,"");break;default:i=i===8?e.parentNode:e,e=i.namespaceURI||null,i=i.tagName,e=aL(e,i)}mr(Zh),ir(Zh,e)}function nv(){mr(Zh),mr(Ww),mr(Xw)}function rq(i){sg(Xw.current);var e=sg(Zh.current),t=aL(e,i.type);e!==t&&(ir(Ww,i),ir(Zh,t))}function NF(i){Ww.current===i&&(mr(Zh),mr(Ww))}var Sr=Xm(0);function _2(i){for(var e=i;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===i)break;for(;e.sibling===null;){if(e.return===null||e.return===i)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var FA=[];function kF(){for(var i=0;i<FA.length;i++)FA[i]._workInProgressVersionPrimary=null;FA.length=0}var DS=Ud.ReactCurrentDispatcher,NA=Ud.ReactCurrentBatchConfig,kg=0,Ar=null,Ln=null,es=null,y2=!1,Hb=!1,Qw=0,dce=0;function $s(){throw Error(ve(321))}function VF(i,e){if(e===null)return!1;for(var t=0;t<e.length&&t<i.length;t++)if(!Hc(i[t],e[t]))return!1;return!0}function UF(i,e,t,r,n,s){if(kg=s,Ar=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,DS.current=i===null||i.memoizedState===null?gce:_ce,i=t(r,n),Hb){s=0;do{if(Hb=!1,Qw=0,25<=s)throw Error(ve(301));s+=1,es=Ln=null,e.updateQueue=null,DS.current=yce,i=t(r,n)}while(Hb)}if(DS.current=v2,e=Ln!==null&&Ln.next!==null,kg=0,es=Ln=Ar=null,y2=!1,e)throw Error(ve(300));return i}function zF(){var i=Qw!==0;return Qw=0,i}function Ah(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return es===null?Ar.memoizedState=es=i:es=es.next=i,es}function Wl(){if(Ln===null){var i=Ar.alternate;i=i!==null?i.memoizedState:null}else i=Ln.next;var e=es===null?Ar.memoizedState:es.next;if(e!==null)es=e,Ln=i;else{if(i===null)throw Error(ve(310));Ln=i,i={memoizedState:Ln.memoizedState,baseState:Ln.baseState,baseQueue:Ln.baseQueue,queue:Ln.queue,next:null},es===null?Ar.memoizedState=es=i:es=es.next=i}return es}function Zw(i,e){return typeof e=="function"?e(i):e}function kA(i){var e=Wl(),t=e.queue;if(t===null)throw Error(ve(311));t.lastRenderedReducer=i;var r=Ln,n=r.baseQueue,s=t.pending;if(s!==null){if(n!==null){var a=n.next;n.next=s.next,s.next=a}r.baseQueue=n=s,t.pending=null}if(n!==null){s=n.next,r=r.baseState;var o=a=null,l=null,c=s;do{var u=c.lane;if((kg&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:i(r,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=d,a=r):l=l.next=d,Ar.lanes|=u,Vg|=u}c=c.next}while(c!==null&&c!==s);l===null?a=r:l.next=o,Hc(r,e.memoizedState)||(uo=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=l,t.lastRenderedState=r}if(i=t.interleaved,i!==null){n=i;do s=n.lane,Ar.lanes|=s,Vg|=s,n=n.next;while(n!==i)}else n===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function VA(i){var e=Wl(),t=e.queue;if(t===null)throw Error(ve(311));t.lastRenderedReducer=i;var r=t.dispatch,n=t.pending,s=e.memoizedState;if(n!==null){t.pending=null;var a=n=n.next;do s=i(s,a.action),a=a.next;while(a!==n);Hc(s,e.memoizedState)||(uo=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,r]}function nq(){}function sq(i,e){var t=Ar,r=Wl(),n=e(),s=!Hc(r.memoizedState,n);if(s&&(r.memoizedState=n,uo=!0),r=r.queue,BF(lq.bind(null,t,r,i),[i]),r.getSnapshot!==e||s||es!==null&&es.memoizedState.tag&1){if(t.flags|=2048,Yw(9,oq.bind(null,t,r,n,e),void 0,null),os===null)throw Error(ve(349));kg&30||aq(t,e,n)}return n}function aq(i,e,t){i.flags|=16384,i={getSnapshot:e,value:t},e=Ar.updateQueue,e===null?(e={lastEffect:null,stores:null},Ar.updateQueue=e,e.stores=[i]):(t=e.stores,t===null?e.stores=[i]:t.push(i))}function oq(i,e,t,r){e.value=t,e.getSnapshot=r,cq(e)&&hq(i)}function lq(i,e,t){return t(function(){cq(e)&&hq(i)})}function cq(i){var e=i.getSnapshot;i=i.value;try{var t=e();return!Hc(i,t)}catch{return!0}}function hq(i){var e=Pd(i,1);e!==null&&kc(e,i,1,-1)}function o9(i){var e=Ah();return typeof i=="function"&&(i=i()),e.memoizedState=e.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Zw,lastRenderedState:i},e.queue=i,i=i.dispatch=fce.bind(null,Ar,i),[e.memoizedState,i]}function Yw(i,e,t,r){return i={tag:i,create:e,destroy:t,deps:r,next:null},e=Ar.updateQueue,e===null?(e={lastEffect:null,stores:null},Ar.updateQueue=e,e.lastEffect=i.next=i):(t=e.lastEffect,t===null?e.lastEffect=i.next=i:(r=t.next,t.next=i,i.next=r,e.lastEffect=i)),i}function uq(){return Wl().memoizedState}function FS(i,e,t,r){var n=Ah();Ar.flags|=i,n.memoizedState=Yw(1|e,t,void 0,r===void 0?null:r)}function tP(i,e,t,r){var n=Wl();r=r===void 0?null:r;var s=void 0;if(Ln!==null){var a=Ln.memoizedState;if(s=a.destroy,r!==null&&VF(r,a.deps)){n.memoizedState=Yw(e,t,s,r);return}}Ar.flags|=i,n.memoizedState=Yw(1|e,t,s,r)}function l9(i,e){return FS(8390656,8,i,e)}function BF(i,e){return tP(2048,8,i,e)}function dq(i,e){return tP(4,2,i,e)}function pq(i,e){return tP(4,4,i,e)}function mq(i,e){if(typeof e=="function")return i=i(),e(i),function(){e(null)};if(e!=null)return i=i(),e.current=i,function(){e.current=null}}function fq(i,e,t){return t=t!=null?t.concat([i]):null,tP(4,4,mq.bind(null,e,i),t)}function GF(){}function gq(i,e){var t=Wl();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&VF(e,r[1])?r[0]:(t.memoizedState=[i,e],i)}function _q(i,e){var t=Wl();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&VF(e,r[1])?r[0]:(i=i(),t.memoizedState=[i,e],i)}function yq(i,e,t){return kg&21?(Hc(t,e)||(t=wj(),Ar.lanes|=t,Vg|=t,i.baseState=!0),e):(i.baseState&&(i.baseState=!1,uo=!0),i.memoizedState=t)}function pce(i,e){var t=$i;$i=t!==0&&4>t?t:4,i(!0);var r=NA.transition;NA.transition={};try{i(!1),e()}finally{$i=t,NA.transition=r}}function vq(){return Wl().memoizedState}function mce(i,e,t){var r=vm(i);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},bq(i))wq(e,t);else if(t=Yj(i,e,t,r),t!==null){var n=Oa();kc(t,i,r,n),xq(t,e,r)}}function fce(i,e,t){var r=vm(i),n={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(bq(i))wq(e,n);else{var s=i.alternate;if(i.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,t);if(n.hasEagerState=!0,n.eagerState=o,Hc(o,a)){var l=e.interleaved;l===null?(n.next=n,$F(e)):(n.next=l.next,l.next=n),e.interleaved=n;return}}catch{}finally{}t=Yj(i,e,n,r),t!==null&&(n=Oa(),kc(t,i,r,n),xq(t,e,r))}}function bq(i){var e=i.alternate;return i===Ar||e!==null&&e===Ar}function wq(i,e){Hb=y2=!0;var t=i.pending;t===null?e.next=e:(e.next=t.next,t.next=e),i.pending=e}function xq(i,e,t){if(t&4194240){var r=e.lanes;r&=i.pendingLanes,t|=r,e.lanes=t,bF(i,t)}}var v2={readContext:ql,useCallback:$s,useContext:$s,useEffect:$s,useImperativeHandle:$s,useInsertionEffect:$s,useLayoutEffect:$s,useMemo:$s,useReducer:$s,useRef:$s,useState:$s,useDebugValue:$s,useDeferredValue:$s,useTransition:$s,useMutableSource:$s,useSyncExternalStore:$s,useId:$s,unstable_isNewReconciler:!1},gce={readContext:ql,useCallback:function(i,e){return Ah().memoizedState=[i,e===void 0?null:e],i},useContext:ql,useEffect:l9,useImperativeHandle:function(i,e,t){return t=t!=null?t.concat([i]):null,FS(4194308,4,mq.bind(null,e,i),t)},useLayoutEffect:function(i,e){return FS(4194308,4,i,e)},useInsertionEffect:function(i,e){return FS(4,2,i,e)},useMemo:function(i,e){var t=Ah();return e=e===void 0?null:e,i=i(),t.memoizedState=[i,e],i},useReducer:function(i,e,t){var r=Ah();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:e},r.queue=i,i=i.dispatch=mce.bind(null,Ar,i),[r.memoizedState,i]},useRef:function(i){var e=Ah();return i={current:i},e.memoizedState=i},useState:o9,useDebugValue:GF,useDeferredValue:function(i){return Ah().memoizedState=i},useTransition:function(){var i=o9(!1),e=i[0];return i=pce.bind(null,i[1]),Ah().memoizedState=i,[e,i]},useMutableSource:function(){},useSyncExternalStore:function(i,e,t){var r=Ar,n=Ah();if(br){if(t===void 0)throw Error(ve(407));t=t()}else{if(t=e(),os===null)throw Error(ve(349));kg&30||aq(r,e,t)}n.memoizedState=t;var s={value:t,getSnapshot:e};return n.queue=s,l9(lq.bind(null,r,s,i),[i]),r.flags|=2048,Yw(9,oq.bind(null,r,s,t,e),void 0,null),t},useId:function(){var i=Ah(),e=os.identifierPrefix;if(br){var t=od,r=ad;t=(r&~(1<<32-Nc(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=Qw++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=dce++,e=":"+e+"r"+t.toString(32)+":";return i.memoizedState=e},unstable_isNewReconciler:!1},_ce={readContext:ql,useCallback:gq,useContext:ql,useEffect:BF,useImperativeHandle:fq,useInsertionEffect:dq,useLayoutEffect:pq,useMemo:_q,useReducer:kA,useRef:uq,useState:function(){return kA(Zw)},useDebugValue:GF,useDeferredValue:function(i){var e=Wl();return yq(e,Ln.memoizedState,i)},useTransition:function(){var i=kA(Zw)[0],e=Wl().memoizedState;return[i,e]},useMutableSource:nq,useSyncExternalStore:sq,useId:vq,unstable_isNewReconciler:!1},yce={readContext:ql,useCallback:gq,useContext:ql,useEffect:BF,useImperativeHandle:fq,useInsertionEffect:dq,useLayoutEffect:pq,useMemo:_q,useReducer:VA,useRef:uq,useState:function(){return VA(Zw)},useDebugValue:GF,useDeferredValue:function(i){var e=Wl();return Ln===null?e.memoizedState=i:yq(e,Ln.memoizedState,i)},useTransition:function(){var i=VA(Zw)[0],e=Wl().memoizedState;return[i,e]},useMutableSource:nq,useSyncExternalStore:sq,useId:vq,unstable_isNewReconciler:!1};function sv(i,e){try{var t="",r=e;do t+=qoe(r),r=r.return;while(r);var n=t}catch(s){n=`
Error generating stack: `+s.message+`
`+s.stack}return{value:i,source:e,stack:n,digest:null}}function UA(i,e,t){return{value:i,source:null,stack:t??null,digest:e??null}}function AL(i,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var vce=typeof WeakMap=="function"?WeakMap:Map;function Tq(i,e,t){t=fd(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){w2||(w2=!0,VL=r),AL(i,e)},t}function Cq(i,e,t){t=fd(-1,t),t.tag=3;var r=i.type.getDerivedStateFromError;if(typeof r=="function"){var n=e.value;t.payload=function(){return r(n)},t.callback=function(){AL(i,e)}}var s=i.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){AL(i,e),typeof r!="function"&&(ym===null?ym=new Set([this]):ym.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),t}function c9(i,e,t){var r=i.pingCache;if(r===null){r=i.pingCache=new vce;var n=new Set;r.set(e,n)}else n=r.get(e),n===void 0&&(n=new Set,r.set(e,n));n.has(t)||(n.add(t),i=Lce.bind(null,i,e,t),e.then(i,i))}function h9(i){do{var e;if((e=i.tag===13)&&(e=i.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return i;i=i.return}while(i!==null);return null}function u9(i,e,t,r,n){return i.mode&1?(i.flags|=65536,i.lanes=n,i):(i===e?i.flags|=65536:(i.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=fd(-1,1),e.tag=2,_m(t,e,1))),t.lanes|=1),i)}var bce=Ud.ReactCurrentOwner,uo=!1;function wa(i,e,t,r){e.child=i===null?iq(e,null,t,r):rv(e,i.child,t,r)}function d9(i,e,t,r,n){t=t.render;var s=e.ref;return I0(e,n),r=UF(i,e,t,r,s,n),t=zF(),i!==null&&!uo?(e.updateQueue=i.updateQueue,e.flags&=-2053,i.lanes&=~n,Ad(i,e,n)):(br&&t&&PF(e),e.flags|=1,wa(i,e,r,n),e.child)}function p9(i,e,t,r,n){if(i===null){var s=t.type;return typeof s=="function"&&!YF(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,Sq(i,e,s,r,n)):(i=US(t.type,null,r,e,e.mode,n),i.ref=e.ref,i.return=e,e.child=i)}if(s=i.child,!(i.lanes&n)){var a=s.memoizedProps;if(t=t.compare,t=t!==null?t:Gw,t(a,r)&&i.ref===e.ref)return Ad(i,e,n)}return e.flags|=1,i=bm(s,r),i.ref=e.ref,i.return=e,e.child=i}function Sq(i,e,t,r,n){if(i!==null){var s=i.memoizedProps;if(Gw(s,r)&&i.ref===e.ref)if(uo=!1,e.pendingProps=r=s,(i.lanes&n)!==0)i.flags&131072&&(uo=!0);else return e.lanes=i.lanes,Ad(i,e,n)}return OL(i,e,t,r,n)}function Eq(i,e,t){var r=e.pendingProps,n=r.children,s=i!==null?i.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ir(a0,Vo),Vo|=t;else{if(!(t&1073741824))return i=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:i,cachePool:null,transitions:null},e.updateQueue=null,ir(a0,Vo),Vo|=i,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:t,ir(a0,Vo),Vo|=r}else s!==null?(r=s.baseLanes|t,e.memoizedState=null):r=t,ir(a0,Vo),Vo|=r;return wa(i,e,n,t),e.child}function Rq(i,e){var t=e.ref;(i===null&&t!==null||i!==null&&i.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function OL(i,e,t,r,n){var s=mo(t)?Fg:Ks.current;return s=tv(e,s),I0(e,n),t=UF(i,e,t,r,s,n),r=zF(),i!==null&&!uo?(e.updateQueue=i.updateQueue,e.flags&=-2053,i.lanes&=~n,Ad(i,e,n)):(br&&r&&PF(e),e.flags|=1,wa(i,e,t,n),e.child)}function m9(i,e,t,r,n){if(mo(t)){var s=!0;u2(e)}else s=!1;if(I0(e,n),e.stateNode===null)NS(i,e),eq(e,t,r),PL(e,t,r,n),r=!0;else if(i===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,c=t.contextType;typeof c=="object"&&c!==null?c=ql(c):(c=mo(t)?Fg:Ks.current,c=tv(e,c));var u=t.getDerivedStateFromProps,d=typeof u=="function"||typeof a.getSnapshotBeforeUpdate=="function";d||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==r||l!==c)&&s9(e,a,r,c),Bp=!1;var m=e.memoizedState;a.state=m,g2(e,r,a,n),l=e.memoizedState,o!==r||m!==l||po.current||Bp?(typeof u=="function"&&(RL(e,t,u,r),l=e.memoizedState),(o=Bp||n9(e,t,o,r,m,l,c))?(d||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),a.props=r,a.state=l,a.context=c,r=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,Kj(i,e),o=e.memoizedProps,c=e.type===e.elementType?o:_c(e.type,o),a.props=c,d=e.pendingProps,m=a.context,l=t.contextType,typeof l=="object"&&l!==null?l=ql(l):(l=mo(t)?Fg:Ks.current,l=tv(e,l));var f=t.getDerivedStateFromProps;(u=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==d||m!==l)&&s9(e,a,r,l),Bp=!1,m=e.memoizedState,a.state=m,g2(e,r,a,n);var _=e.memoizedState;o!==d||m!==_||po.current||Bp?(typeof f=="function"&&(RL(e,t,f,r),_=e.memoizedState),(c=Bp||n9(e,t,c,r,m,_,l)||!1)?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,_,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,_,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===i.memoizedProps&&m===i.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===i.memoizedProps&&m===i.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=_),a.props=r,a.state=_,a.context=l,r=c):(typeof a.componentDidUpdate!="function"||o===i.memoizedProps&&m===i.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===i.memoizedProps&&m===i.memoizedState||(e.flags|=1024),r=!1)}return ML(i,e,t,r,s,n)}function ML(i,e,t,r,n,s){Rq(i,e);var a=(e.flags&128)!==0;if(!r&&!a)return n&&Jk(e,t,!1),Ad(i,e,s);r=e.stateNode,bce.current=e;var o=a&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,i!==null&&a?(e.child=rv(e,i.child,null,s),e.child=rv(e,null,o,s)):wa(i,e,o,s),e.memoizedState=r.state,n&&Jk(e,t,!0),e.child}function Pq(i){var e=i.stateNode;e.pendingContext?Kk(i,e.pendingContext,e.pendingContext!==e.context):e.context&&Kk(i,e.context,!1),FF(i,e.containerInfo)}function f9(i,e,t,r,n){return iv(),OF(n),e.flags|=256,wa(i,e,t,r),e.child}var IL={dehydrated:null,treeContext:null,retryLane:0};function LL(i){return{baseLanes:i,cachePool:null,transitions:null}}function Aq(i,e,t){var r=e.pendingProps,n=Sr.current,s=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=i!==null&&i.memoizedState===null?!1:(n&2)!==0),o?(s=!0,e.flags&=-129):(i===null||i.memoizedState!==null)&&(n|=1),ir(Sr,n&1),i===null)return SL(e),i=e.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?(e.mode&1?i.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,i=r.fallback,s?(r=e.mode,s=e.child,a={mode:"hidden",children:a},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=nP(a,r,0,null),i=yg(i,r,t,null),s.return=e,i.return=e,s.sibling=i,e.child=s,e.child.memoizedState=LL(t),e.memoizedState=IL,i):HF(e,a));if(n=i.memoizedState,n!==null&&(o=n.dehydrated,o!==null))return wce(i,e,a,r,o,n,t);if(s){s=r.fallback,a=e.mode,n=i.child,o=n.sibling;var l={mode:"hidden",children:r.children};return!(a&1)&&e.child!==n?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=bm(n,l),r.subtreeFlags=n.subtreeFlags&14680064),o!==null?s=bm(o,s):(s=yg(s,a,t,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,a=i.child.memoizedState,a=a===null?LL(t):{baseLanes:a.baseLanes|t,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=i.childLanes&~t,e.memoizedState=IL,r}return s=i.child,i=s.sibling,r=bm(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,i!==null&&(t=e.deletions,t===null?(e.deletions=[i],e.flags|=16):t.push(i)),e.child=r,e.memoizedState=null,r}function HF(i,e){return e=nP({mode:"visible",children:e},i.mode,0,null),e.return=i,i.child=e}function LT(i,e,t,r){return r!==null&&OF(r),rv(e,i.child,null,t),i=HF(e,e.pendingProps.children),i.flags|=2,e.memoizedState=null,i}function wce(i,e,t,r,n,s,a){if(t)return e.flags&256?(e.flags&=-257,r=UA(Error(ve(422))),LT(i,e,a,r)):e.memoizedState!==null?(e.child=i.child,e.flags|=128,null):(s=r.fallback,n=e.mode,r=nP({mode:"visible",children:r.children},n,0,null),s=yg(s,n,a,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&rv(e,i.child,null,a),e.child.memoizedState=LL(a),e.memoizedState=IL,s);if(!(e.mode&1))return LT(i,e,a,null);if(n.data==="$!"){if(r=n.nextSibling&&n.nextSibling.dataset,r)var o=r.dgst;return r=o,s=Error(ve(419)),r=UA(s,r,void 0),LT(i,e,a,r)}if(o=(a&i.childLanes)!==0,uo||o){if(r=os,r!==null){switch(a&-a){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}n=n&(r.suspendedLanes|a)?0:n,n!==0&&n!==s.retryLane&&(s.retryLane=n,Pd(i,n),kc(r,i,n,-1))}return ZF(),r=UA(Error(ve(421))),LT(i,e,a,r)}return n.data==="$?"?(e.flags|=128,e.child=i.child,e=$ce.bind(null,i),n._reactRetry=e,null):(i=s.treeContext,el=gm(n.nextSibling),rl=e,br=!0,wc=null,i!==null&&(El[Rl++]=ad,El[Rl++]=od,El[Rl++]=Ng,ad=i.id,od=i.overflow,Ng=e),e=HF(e,r.children),e.flags|=4096,e)}function g9(i,e,t){i.lanes|=e;var r=i.alternate;r!==null&&(r.lanes|=e),EL(i.return,e,t)}function zA(i,e,t,r,n){var s=i.memoizedState;s===null?i.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:n}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=t,s.tailMode=n)}function Oq(i,e,t){var r=e.pendingProps,n=r.revealOrder,s=r.tail;if(wa(i,e,r.children,t),r=Sr.current,r&2)r=r&1|2,e.flags|=128;else{if(i!==null&&i.flags&128)e:for(i=e.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&g9(i,t,e);else if(i.tag===19)g9(i,t,e);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break e;for(;i.sibling===null;){if(i.return===null||i.return===e)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}r&=1}if(ir(Sr,r),!(e.mode&1))e.memoizedState=null;else switch(n){case"forwards":for(t=e.child,n=null;t!==null;)i=t.alternate,i!==null&&_2(i)===null&&(n=t),t=t.sibling;t=n,t===null?(n=e.child,e.child=null):(n=t.sibling,t.sibling=null),zA(e,!1,n,t,s);break;case"backwards":for(t=null,n=e.child,e.child=null;n!==null;){if(i=n.alternate,i!==null&&_2(i)===null){e.child=n;break}i=n.sibling,n.sibling=t,t=n,n=i}zA(e,!0,t,null,s);break;case"together":zA(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function NS(i,e){!(e.mode&1)&&i!==null&&(i.alternate=null,e.alternate=null,e.flags|=2)}function Ad(i,e,t){if(i!==null&&(e.dependencies=i.dependencies),Vg|=e.lanes,!(t&e.childLanes))return null;if(i!==null&&e.child!==i.child)throw Error(ve(153));if(e.child!==null){for(i=e.child,t=bm(i,i.pendingProps),e.child=t,t.return=e;i.sibling!==null;)i=i.sibling,t=t.sibling=bm(i,i.pendingProps),t.return=e;t.sibling=null}return e.child}function xce(i,e,t){switch(e.tag){case 3:Pq(e),iv();break;case 5:rq(e);break;case 1:mo(e.type)&&u2(e);break;case 4:FF(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,n=e.memoizedProps.value;ir(m2,r._currentValue),r._currentValue=n;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ir(Sr,Sr.current&1),e.flags|=128,null):t&e.child.childLanes?Aq(i,e,t):(ir(Sr,Sr.current&1),i=Ad(i,e,t),i!==null?i.sibling:null);ir(Sr,Sr.current&1);break;case 19:if(r=(t&e.childLanes)!==0,i.flags&128){if(r)return Oq(i,e,t);e.flags|=128}if(n=e.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),ir(Sr,Sr.current),r)break;return null;case 22:case 23:return e.lanes=0,Eq(i,e,t)}return Ad(i,e,t)}var Mq,$L,Iq,Lq;Mq=function(i,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)i.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};$L=function(){};Iq=function(i,e,t,r){var n=i.memoizedProps;if(n!==r){i=e.stateNode,sg(Zh.current);var s=null;switch(t){case"input":n=iL(i,n),r=iL(i,r),s=[];break;case"select":n=Mr({},n,{value:void 0}),r=Mr({},r,{value:void 0}),s=[];break;case"textarea":n=sL(i,n),r=sL(i,r),s=[];break;default:typeof n.onClick!="function"&&typeof r.onClick=="function"&&(i.onclick=c2)}oL(t,r);var a;t=null;for(c in n)if(!r.hasOwnProperty(c)&&n.hasOwnProperty(c)&&n[c]!=null)if(c==="style"){var o=n[c];for(a in o)o.hasOwnProperty(a)&&(t||(t={}),t[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Fw.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in r){var l=r[c];if(o=n!=null?n[c]:void 0,r.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(t||(t={}),t[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(t||(t={}),t[a]=l[a])}else t||(s||(s=[]),s.push(c,t)),t=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Fw.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&ar("scroll",i),s||o===l||(s=[])):(s=s||[]).push(c,l))}t&&(s=s||[]).push("style",t);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};Lq=function(i,e,t,r){t!==r&&(e.flags|=4)};function Xv(i,e){if(!br)switch(i.tailMode){case"hidden":e=i.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?i.tail=null:t.sibling=null;break;case"collapsed":t=i.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||i.tail===null?i.tail=null:i.tail.sibling=null:r.sibling=null}}function Ds(i){var e=i.alternate!==null&&i.alternate.child===i.child,t=0,r=0;if(e)for(var n=i.child;n!==null;)t|=n.lanes|n.childLanes,r|=n.subtreeFlags&14680064,r|=n.flags&14680064,n.return=i,n=n.sibling;else for(n=i.child;n!==null;)t|=n.lanes|n.childLanes,r|=n.subtreeFlags,r|=n.flags,n.return=i,n=n.sibling;return i.subtreeFlags|=r,i.childLanes=t,e}function Tce(i,e,t){var r=e.pendingProps;switch(AF(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ds(e),null;case 1:return mo(e.type)&&h2(),Ds(e),null;case 3:return r=e.stateNode,nv(),mr(po),mr(Ks),kF(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(i===null||i.child===null)&&(MT(e)?e.flags|=4:i===null||i.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,wc!==null&&(BL(wc),wc=null))),$L(i,e),Ds(e),null;case 5:NF(e);var n=sg(Xw.current);if(t=e.type,i!==null&&e.stateNode!=null)Iq(i,e,t,r,n),i.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ve(166));return Ds(e),null}if(i=sg(Zh.current),MT(e)){r=e.stateNode,t=e.type;var s=e.memoizedProps;switch(r[kh]=e,r[qw]=s,i=(e.mode&1)!==0,t){case"dialog":ar("cancel",r),ar("close",r);break;case"iframe":case"object":case"embed":ar("load",r);break;case"video":case"audio":for(n=0;n<B1.length;n++)ar(B1[n],r);break;case"source":ar("error",r);break;case"img":case"image":case"link":ar("error",r),ar("load",r);break;case"details":ar("toggle",r);break;case"input":Sk(r,s),ar("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},ar("invalid",r);break;case"textarea":Rk(r,s),ar("invalid",r)}oL(t,s),n=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?r.textContent!==o&&(s.suppressHydrationWarning!==!0&&OT(r.textContent,o,i),n=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&OT(r.textContent,o,i),n=["children",""+o]):Fw.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&ar("scroll",r)}switch(t){case"input":xT(r),Ek(r,s,!0);break;case"textarea":xT(r),Pk(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=c2)}r=n,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=n.nodeType===9?n:n.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=aj(t)),i==="http://www.w3.org/1999/xhtml"?t==="script"?(i=a.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof r.is=="string"?i=a.createElement(t,{is:r.is}):(i=a.createElement(t),t==="select"&&(a=i,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):i=a.createElementNS(i,t),i[kh]=e,i[qw]=r,Mq(i,e,!1,!1),e.stateNode=i;e:{switch(a=lL(t,r),t){case"dialog":ar("cancel",i),ar("close",i),n=r;break;case"iframe":case"object":case"embed":ar("load",i),n=r;break;case"video":case"audio":for(n=0;n<B1.length;n++)ar(B1[n],i);n=r;break;case"source":ar("error",i),n=r;break;case"img":case"image":case"link":ar("error",i),ar("load",i),n=r;break;case"details":ar("toggle",i),n=r;break;case"input":Sk(i,r),n=iL(i,r),ar("invalid",i);break;case"option":n=r;break;case"select":i._wrapperState={wasMultiple:!!r.multiple},n=Mr({},r,{value:void 0}),ar("invalid",i);break;case"textarea":Rk(i,r),n=sL(i,r),ar("invalid",i);break;default:n=r}oL(t,n),o=n;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?cj(i,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&oj(i,l)):s==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&Nw(i,l):typeof l=="number"&&Nw(i,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Fw.hasOwnProperty(s)?l!=null&&s==="onScroll"&&ar("scroll",i):l!=null&&mF(i,s,l,a))}switch(t){case"input":xT(i),Ek(i,r,!1);break;case"textarea":xT(i),Pk(i);break;case"option":r.value!=null&&i.setAttribute("value",""+Nm(r.value));break;case"select":i.multiple=!!r.multiple,s=r.value,s!=null?P0(i,!!r.multiple,s,!1):r.defaultValue!=null&&P0(i,!!r.multiple,r.defaultValue,!0);break;default:typeof n.onClick=="function"&&(i.onclick=c2)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ds(e),null;case 6:if(i&&e.stateNode!=null)Lq(i,e,i.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ve(166));if(t=sg(Xw.current),sg(Zh.current),MT(e)){if(r=e.stateNode,t=e.memoizedProps,r[kh]=e,(s=r.nodeValue!==t)&&(i=rl,i!==null))switch(i.tag){case 3:OT(r.nodeValue,t,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&OT(r.nodeValue,t,(i.mode&1)!==0)}s&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[kh]=e,e.stateNode=r}return Ds(e),null;case 13:if(mr(Sr),r=e.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(br&&el!==null&&e.mode&1&&!(e.flags&128))Zj(),iv(),e.flags|=98560,s=!1;else if(s=MT(e),r!==null&&r.dehydrated!==null){if(i===null){if(!s)throw Error(ve(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ve(317));s[kh]=e}else iv(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ds(e),s=!1}else wc!==null&&(BL(wc),wc=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(i!==null&&i.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(i===null||Sr.current&1?Fn===0&&(Fn=3):ZF())),e.updateQueue!==null&&(e.flags|=4),Ds(e),null);case 4:return nv(),$L(i,e),i===null&&Hw(e.stateNode.containerInfo),Ds(e),null;case 10:return LF(e.type._context),Ds(e),null;case 17:return mo(e.type)&&h2(),Ds(e),null;case 19:if(mr(Sr),s=e.memoizedState,s===null)return Ds(e),null;if(r=(e.flags&128)!==0,a=s.rendering,a===null)if(r)Xv(s,!1);else{if(Fn!==0||i!==null&&i.flags&128)for(i=e.child;i!==null;){if(a=_2(i),a!==null){for(e.flags|=128,Xv(s,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)s=t,i=r,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=i,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,i=a.dependencies,s.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),t=t.sibling;return ir(Sr,Sr.current&1|2),e.child}i=i.sibling}s.tail!==null&&Jr()>av&&(e.flags|=128,r=!0,Xv(s,!1),e.lanes=4194304)}else{if(!r)if(i=_2(a),i!==null){if(e.flags|=128,r=!0,t=i.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Xv(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!br)return Ds(e),null}else 2*Jr()-s.renderingStartTime>av&&t!==1073741824&&(e.flags|=128,r=!0,Xv(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(t=s.last,t!==null?t.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Jr(),e.sibling=null,t=Sr.current,ir(Sr,r?t&1|2:t&1),e):(Ds(e),null);case 22:case 23:return QF(),r=e.memoizedState!==null,i!==null&&i.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Vo&1073741824&&(Ds(e),e.subtreeFlags&6&&(e.flags|=8192)):Ds(e),null;case 24:return null;case 25:return null}throw Error(ve(156,e.tag))}function Cce(i,e){switch(AF(e),e.tag){case 1:return mo(e.type)&&h2(),i=e.flags,i&65536?(e.flags=i&-65537|128,e):null;case 3:return nv(),mr(po),mr(Ks),kF(),i=e.flags,i&65536&&!(i&128)?(e.flags=i&-65537|128,e):null;case 5:return NF(e),null;case 13:if(mr(Sr),i=e.memoizedState,i!==null&&i.dehydrated!==null){if(e.alternate===null)throw Error(ve(340));iv()}return i=e.flags,i&65536?(e.flags=i&-65537|128,e):null;case 19:return mr(Sr),null;case 4:return nv(),null;case 10:return LF(e.type._context),null;case 22:case 23:return QF(),null;case 24:return null;default:return null}}var $T=!1,js=!1,Sce=typeof WeakSet=="function"?WeakSet:Set,Ue=null;function s0(i,e){var t=i.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){Vr(i,e,r)}else t.current=null}function DL(i,e,t){try{t()}catch(r){Vr(i,e,r)}}var _9=!1;function Ece(i,e){if(yL=a2,i=Nj(),RF(i)){if("selectionStart"in i)var t={start:i.selectionStart,end:i.selectionEnd};else e:{t=(t=i.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var n=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var a=0,o=-1,l=-1,c=0,u=0,d=i,m=null;t:for(;;){for(var f;d!==t||n!==0&&d.nodeType!==3||(o=a+n),d!==s||r!==0&&d.nodeType!==3||(l=a+r),d.nodeType===3&&(a+=d.nodeValue.length),(f=d.firstChild)!==null;)m=d,d=f;for(;;){if(d===i)break t;if(m===t&&++c===n&&(o=a),m===s&&++u===r&&(l=a),(f=d.nextSibling)!==null)break;d=m,m=d.parentNode}d=f}t=o===-1||l===-1?null:{start:o,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(vL={focusedElem:i,selectionRange:t},a2=!1,Ue=e;Ue!==null;)if(e=Ue,i=e.child,(e.subtreeFlags&1028)!==0&&i!==null)i.return=e,Ue=i;else for(;Ue!==null;){e=Ue;try{var _=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(_!==null){var g=_.memoizedProps,w=_.memoizedState,v=e.stateNode,b=v.getSnapshotBeforeUpdate(e.elementType===e.type?g:_c(e.type,g),w);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var x=e.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ve(163))}}catch(T){Vr(e,e.return,T)}if(i=e.sibling,i!==null){i.return=e.return,Ue=i;break}Ue=e.return}return _=_9,_9=!1,_}function jb(i,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var n=r=r.next;do{if((n.tag&i)===i){var s=n.destroy;n.destroy=void 0,s!==void 0&&DL(e,t,s)}n=n.next}while(n!==r)}}function iP(i,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&i)===i){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function FL(i){var e=i.ref;if(e!==null){var t=i.stateNode;switch(i.tag){case 5:i=t;break;default:i=t}typeof e=="function"?e(i):e.current=i}}function $q(i){var e=i.alternate;e!==null&&(i.alternate=null,$q(e)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(e=i.stateNode,e!==null&&(delete e[kh],delete e[qw],delete e[xL],delete e[lce],delete e[cce])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function Dq(i){return i.tag===5||i.tag===3||i.tag===4}function y9(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Dq(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function NL(i,e,t){var r=i.tag;if(r===5||r===6)i=i.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(i,e):t.insertBefore(i,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(i,t)):(e=t,e.appendChild(i)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=c2));else if(r!==4&&(i=i.child,i!==null))for(NL(i,e,t),i=i.sibling;i!==null;)NL(i,e,t),i=i.sibling}function kL(i,e,t){var r=i.tag;if(r===5||r===6)i=i.stateNode,e?t.insertBefore(i,e):t.appendChild(i);else if(r!==4&&(i=i.child,i!==null))for(kL(i,e,t),i=i.sibling;i!==null;)kL(i,e,t),i=i.sibling}var bs=null,vc=!1;function Wd(i,e,t){for(t=t.child;t!==null;)Fq(i,e,t),t=t.sibling}function Fq(i,e,t){if(Qh&&typeof Qh.onCommitFiberUnmount=="function")try{Qh.onCommitFiberUnmount(XR,t)}catch{}switch(t.tag){case 5:js||s0(t,e);case 6:var r=bs,n=vc;bs=null,Wd(i,e,t),bs=r,vc=n,bs!==null&&(vc?(i=bs,t=t.stateNode,i.nodeType===8?i.parentNode.removeChild(t):i.removeChild(t)):bs.removeChild(t.stateNode));break;case 18:bs!==null&&(vc?(i=bs,t=t.stateNode,i.nodeType===8?$A(i.parentNode,t):i.nodeType===1&&$A(i,t),zw(i)):$A(bs,t.stateNode));break;case 4:r=bs,n=vc,bs=t.stateNode.containerInfo,vc=!0,Wd(i,e,t),bs=r,vc=n;break;case 0:case 11:case 14:case 15:if(!js&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){n=r=r.next;do{var s=n,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&DL(t,e,a),n=n.next}while(n!==r)}Wd(i,e,t);break;case 1:if(!js&&(s0(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(o){Vr(t,e,o)}Wd(i,e,t);break;case 21:Wd(i,e,t);break;case 22:t.mode&1?(js=(r=js)||t.memoizedState!==null,Wd(i,e,t),js=r):Wd(i,e,t);break;default:Wd(i,e,t)}}function v9(i){var e=i.updateQueue;if(e!==null){i.updateQueue=null;var t=i.stateNode;t===null&&(t=i.stateNode=new Sce),e.forEach(function(r){var n=Dce.bind(null,i,r);t.has(r)||(t.add(r),r.then(n,n))})}}function Jl(i,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var n=t[r];try{var s=i,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:bs=o.stateNode,vc=!1;break e;case 3:bs=o.stateNode.containerInfo,vc=!0;break e;case 4:bs=o.stateNode.containerInfo,vc=!0;break e}o=o.return}if(bs===null)throw Error(ve(160));Fq(s,a,n),bs=null,vc=!1;var l=n.alternate;l!==null&&(l.return=null),n.return=null}catch(c){Vr(n,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Nq(e,i),e=e.sibling}function Nq(i,e){var t=i.alternate,r=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(Jl(e,i),Kc(i),r&4){try{jb(3,i,i.return),iP(3,i)}catch(g){Vr(i,i.return,g)}try{jb(5,i,i.return)}catch(g){Vr(i,i.return,g)}}break;case 1:Jl(e,i),Kc(i),r&512&&t!==null&&s0(t,t.return);break;case 5:if(Jl(e,i),Kc(i),r&512&&t!==null&&s0(t,t.return),i.flags&32){var n=i.stateNode;try{Nw(n,"")}catch(g){Vr(i,i.return,g)}}if(r&4&&(n=i.stateNode,n!=null)){var s=i.memoizedProps,a=t!==null?t.memoizedProps:s,o=i.type,l=i.updateQueue;if(i.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&nj(n,s),lL(o,a);var c=lL(o,s);for(a=0;a<l.length;a+=2){var u=l[a],d=l[a+1];u==="style"?cj(n,d):u==="dangerouslySetInnerHTML"?oj(n,d):u==="children"?Nw(n,d):mF(n,u,d,c)}switch(o){case"input":rL(n,s);break;case"textarea":sj(n,s);break;case"select":var m=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!s.multiple;var f=s.value;f!=null?P0(n,!!s.multiple,f,!1):m!==!!s.multiple&&(s.defaultValue!=null?P0(n,!!s.multiple,s.defaultValue,!0):P0(n,!!s.multiple,s.multiple?[]:"",!1))}n[qw]=s}catch(g){Vr(i,i.return,g)}}break;case 6:if(Jl(e,i),Kc(i),r&4){if(i.stateNode===null)throw Error(ve(162));n=i.stateNode,s=i.memoizedProps;try{n.nodeValue=s}catch(g){Vr(i,i.return,g)}}break;case 3:if(Jl(e,i),Kc(i),r&4&&t!==null&&t.memoizedState.isDehydrated)try{zw(e.containerInfo)}catch(g){Vr(i,i.return,g)}break;case 4:Jl(e,i),Kc(i);break;case 13:Jl(e,i),Kc(i),n=i.child,n.flags&8192&&(s=n.memoizedState!==null,n.stateNode.isHidden=s,!s||n.alternate!==null&&n.alternate.memoizedState!==null||(WF=Jr())),r&4&&v9(i);break;case 22:if(u=t!==null&&t.memoizedState!==null,i.mode&1?(js=(c=js)||u,Jl(e,i),js=c):Jl(e,i),Kc(i),r&8192){if(c=i.memoizedState!==null,(i.stateNode.isHidden=c)&&!u&&i.mode&1)for(Ue=i,u=i.child;u!==null;){for(d=Ue=u;Ue!==null;){switch(m=Ue,f=m.child,m.tag){case 0:case 11:case 14:case 15:jb(4,m,m.return);break;case 1:s0(m,m.return);var _=m.stateNode;if(typeof _.componentWillUnmount=="function"){r=m,t=m.return;try{e=r,_.props=e.memoizedProps,_.state=e.memoizedState,_.componentWillUnmount()}catch(g){Vr(r,t,g)}}break;case 5:s0(m,m.return);break;case 22:if(m.memoizedState!==null){w9(d);continue}}f!==null?(f.return=m,Ue=f):w9(d)}u=u.sibling}e:for(u=null,d=i;;){if(d.tag===5){if(u===null){u=d;try{n=d.stateNode,c?(s=n.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=d.stateNode,l=d.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=lj("display",a))}catch(g){Vr(i,i.return,g)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(g){Vr(i,i.return,g)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===i)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===i)break e;for(;d.sibling===null;){if(d.return===null||d.return===i)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Jl(e,i),Kc(i),r&4&&v9(i);break;case 21:break;default:Jl(e,i),Kc(i)}}function Kc(i){var e=i.flags;if(e&2){try{e:{for(var t=i.return;t!==null;){if(Dq(t)){var r=t;break e}t=t.return}throw Error(ve(160))}switch(r.tag){case 5:var n=r.stateNode;r.flags&32&&(Nw(n,""),r.flags&=-33);var s=y9(i);kL(i,s,n);break;case 3:case 4:var a=r.stateNode.containerInfo,o=y9(i);NL(i,o,a);break;default:throw Error(ve(161))}}catch(l){Vr(i,i.return,l)}i.flags&=-3}e&4096&&(i.flags&=-4097)}function Rce(i,e,t){Ue=i,kq(i)}function kq(i,e,t){for(var r=(i.mode&1)!==0;Ue!==null;){var n=Ue,s=n.child;if(n.tag===22&&r){var a=n.memoizedState!==null||$T;if(!a){var o=n.alternate,l=o!==null&&o.memoizedState!==null||js;o=$T;var c=js;if($T=a,(js=l)&&!c)for(Ue=n;Ue!==null;)a=Ue,l=a.child,a.tag===22&&a.memoizedState!==null?x9(n):l!==null?(l.return=a,Ue=l):x9(n);for(;s!==null;)Ue=s,kq(s),s=s.sibling;Ue=n,$T=o,js=c}b9(i)}else n.subtreeFlags&8772&&s!==null?(s.return=n,Ue=s):b9(i)}}function b9(i){for(;Ue!==null;){var e=Ue;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:js||iP(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!js)if(t===null)r.componentDidMount();else{var n=e.elementType===e.type?t.memoizedProps:_c(e.type,t.memoizedProps);r.componentDidUpdate(n,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&r9(e,s,r);break;case 3:var a=e.updateQueue;if(a!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}r9(e,a,t)}break;case 5:var o=e.stateNode;if(t===null&&e.flags&4){t=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&zw(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ve(163))}js||e.flags&512&&FL(e)}catch(m){Vr(e,e.return,m)}}if(e===i){Ue=null;break}if(t=e.sibling,t!==null){t.return=e.return,Ue=t;break}Ue=e.return}}function w9(i){for(;Ue!==null;){var e=Ue;if(e===i){Ue=null;break}var t=e.sibling;if(t!==null){t.return=e.return,Ue=t;break}Ue=e.return}}function x9(i){for(;Ue!==null;){var e=Ue;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{iP(4,e)}catch(l){Vr(e,t,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var n=e.return;try{r.componentDidMount()}catch(l){Vr(e,n,l)}}var s=e.return;try{FL(e)}catch(l){Vr(e,s,l)}break;case 5:var a=e.return;try{FL(e)}catch(l){Vr(e,a,l)}}}catch(l){Vr(e,e.return,l)}if(e===i){Ue=null;break}var o=e.sibling;if(o!==null){o.return=e.return,Ue=o;break}Ue=e.return}}var Pce=Math.ceil,b2=Ud.ReactCurrentDispatcher,jF=Ud.ReactCurrentOwner,jl=Ud.ReactCurrentBatchConfig,fi=0,os=null,mn=null,As=0,Vo=0,a0=Xm(0),Fn=0,Kw=null,Vg=0,rP=0,qF=0,qb=null,no=null,WF=0,av=1/0,Wu=null,w2=!1,VL=null,ym=null,DT=!1,nm=null,x2=0,Wb=0,UL=null,kS=-1,VS=0;function Oa(){return fi&6?Jr():kS!==-1?kS:kS=Jr()}function vm(i){return i.mode&1?fi&2&&As!==0?As&-As:uce.transition!==null?(VS===0&&(VS=wj()),VS):(i=$i,i!==0||(i=window.event,i=i===void 0?16:Pj(i.type)),i):1}function kc(i,e,t,r){if(50<Wb)throw Wb=0,UL=null,Error(ve(185));Xx(i,t,r),(!(fi&2)||i!==os)&&(i===os&&(!(fi&2)&&(rP|=t),Fn===4&&Qp(i,As)),fo(i,r),t===1&&fi===0&&!(e.mode&1)&&(av=Jr()+500,JR&&Qm()))}function fo(i,e){var t=i.callbackNode;ule(i,e);var r=s2(i,i===os?As:0);if(r===0)t!==null&&Mk(t),i.callbackNode=null,i.callbackPriority=0;else if(e=r&-r,i.callbackPriority!==e){if(t!=null&&Mk(t),e===1)i.tag===0?hce(T9.bind(null,i)):Wj(T9.bind(null,i)),ace(function(){!(fi&6)&&Qm()}),t=null;else{switch(xj(r)){case 1:t=vF;break;case 4:t=vj;break;case 16:t=n2;break;case 536870912:t=bj;break;default:t=n2}t=qq(t,Vq.bind(null,i))}i.callbackPriority=e,i.callbackNode=t}}function Vq(i,e){if(kS=-1,VS=0,fi&6)throw Error(ve(327));var t=i.callbackNode;if(L0()&&i.callbackNode!==t)return null;var r=s2(i,i===os?As:0);if(r===0)return null;if(r&30||r&i.expiredLanes||e)e=T2(i,r);else{e=r;var n=fi;fi|=2;var s=zq();(os!==i||As!==e)&&(Wu=null,av=Jr()+500,_g(i,e));do try{Mce();break}catch(o){Uq(i,o)}while(1);IF(),b2.current=s,fi=n,mn!==null?e=0:(os=null,As=0,e=Fn)}if(e!==0){if(e===2&&(n=pL(i),n!==0&&(r=n,e=zL(i,n))),e===1)throw t=Kw,_g(i,0),Qp(i,r),fo(i,Jr()),t;if(e===6)Qp(i,r);else{if(n=i.current.alternate,!(r&30)&&!Ace(n)&&(e=T2(i,r),e===2&&(s=pL(i),s!==0&&(r=s,e=zL(i,s))),e===1))throw t=Kw,_g(i,0),Qp(i,r),fo(i,Jr()),t;switch(i.finishedWork=n,i.finishedLanes=r,e){case 0:case 1:throw Error(ve(345));case 2:Rf(i,no,Wu);break;case 3:if(Qp(i,r),(r&130023424)===r&&(e=WF+500-Jr(),10<e)){if(s2(i,0)!==0)break;if(n=i.suspendedLanes,(n&r)!==r){Oa(),i.pingedLanes|=i.suspendedLanes&n;break}i.timeoutHandle=wL(Rf.bind(null,i,no,Wu),e);break}Rf(i,no,Wu);break;case 4:if(Qp(i,r),(r&4194240)===r)break;for(e=i.eventTimes,n=-1;0<r;){var a=31-Nc(r);s=1<<a,a=e[a],a>n&&(n=a),r&=~s}if(r=n,r=Jr()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Pce(r/1960))-r,10<r){i.timeoutHandle=wL(Rf.bind(null,i,no,Wu),r);break}Rf(i,no,Wu);break;case 5:Rf(i,no,Wu);break;default:throw Error(ve(329))}}}return fo(i,Jr()),i.callbackNode===t?Vq.bind(null,i):null}function zL(i,e){var t=qb;return i.current.memoizedState.isDehydrated&&(_g(i,e).flags|=256),i=T2(i,e),i!==2&&(e=no,no=t,e!==null&&BL(e)),i}function BL(i){no===null?no=i:no.push.apply(no,i)}function Ace(i){for(var e=i;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var n=t[r],s=n.getSnapshot;n=n.value;try{if(!Hc(s(),n))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===i)break;for(;e.sibling===null;){if(e.return===null||e.return===i)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Qp(i,e){for(e&=~qF,e&=~rP,i.suspendedLanes|=e,i.pingedLanes&=~e,i=i.expirationTimes;0<e;){var t=31-Nc(e),r=1<<t;i[t]=-1,e&=~r}}function T9(i){if(fi&6)throw Error(ve(327));L0();var e=s2(i,0);if(!(e&1))return fo(i,Jr()),null;var t=T2(i,e);if(i.tag!==0&&t===2){var r=pL(i);r!==0&&(e=r,t=zL(i,r))}if(t===1)throw t=Kw,_g(i,0),Qp(i,e),fo(i,Jr()),t;if(t===6)throw Error(ve(345));return i.finishedWork=i.current.alternate,i.finishedLanes=e,Rf(i,no,Wu),fo(i,Jr()),null}function XF(i,e){var t=fi;fi|=1;try{return i(e)}finally{fi=t,fi===0&&(av=Jr()+500,JR&&Qm())}}function Ug(i){nm!==null&&nm.tag===0&&!(fi&6)&&L0();var e=fi;fi|=1;var t=jl.transition,r=$i;try{if(jl.transition=null,$i=1,i)return i()}finally{$i=r,jl.transition=t,fi=e,!(fi&6)&&Qm()}}function QF(){Vo=a0.current,mr(a0)}function _g(i,e){i.finishedWork=null,i.finishedLanes=0;var t=i.timeoutHandle;if(t!==-1&&(i.timeoutHandle=-1,sce(t)),mn!==null)for(t=mn.return;t!==null;){var r=t;switch(AF(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&h2();break;case 3:nv(),mr(po),mr(Ks),kF();break;case 5:NF(r);break;case 4:nv();break;case 13:mr(Sr);break;case 19:mr(Sr);break;case 10:LF(r.type._context);break;case 22:case 23:QF()}t=t.return}if(os=i,mn=i=bm(i.current,null),As=Vo=e,Fn=0,Kw=null,qF=rP=Vg=0,no=qb=null,ng!==null){for(e=0;e<ng.length;e++)if(t=ng[e],r=t.interleaved,r!==null){t.interleaved=null;var n=r.next,s=t.pending;if(s!==null){var a=s.next;s.next=n,r.next=a}t.pending=r}ng=null}return i}function Uq(i,e){do{var t=mn;try{if(IF(),DS.current=v2,y2){for(var r=Ar.memoizedState;r!==null;){var n=r.queue;n!==null&&(n.pending=null),r=r.next}y2=!1}if(kg=0,es=Ln=Ar=null,Hb=!1,Qw=0,jF.current=null,t===null||t.return===null){Fn=1,Kw=e,mn=null;break}e:{var s=i,a=t.return,o=t,l=e;if(e=As,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var m=u.alternate;m?(u.updateQueue=m.updateQueue,u.memoizedState=m.memoizedState,u.lanes=m.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=h9(a);if(f!==null){f.flags&=-257,u9(f,a,o,s,e),f.mode&1&&c9(s,c,e),e=f,l=c;var _=e.updateQueue;if(_===null){var g=new Set;g.add(l),e.updateQueue=g}else _.add(l);break e}else{if(!(e&1)){c9(s,c,e),ZF();break e}l=Error(ve(426))}}else if(br&&o.mode&1){var w=h9(a);if(w!==null){!(w.flags&65536)&&(w.flags|=256),u9(w,a,o,s,e),OF(sv(l,o));break e}}s=l=sv(l,o),Fn!==4&&(Fn=2),qb===null?qb=[s]:qb.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var v=Tq(s,l,e);i9(s,v);break e;case 1:o=l;var b=s.type,x=s.stateNode;if(!(s.flags&128)&&(typeof b.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(ym===null||!ym.has(x)))){s.flags|=65536,e&=-e,s.lanes|=e;var T=Cq(s,o,e);i9(s,T);break e}}s=s.return}while(s!==null)}Gq(t)}catch(R){e=R,mn===t&&t!==null&&(mn=t=t.return);continue}break}while(1)}function zq(){var i=b2.current;return b2.current=v2,i===null?v2:i}function ZF(){(Fn===0||Fn===3||Fn===2)&&(Fn=4),os===null||!(Vg&268435455)&&!(rP&268435455)||Qp(os,As)}function T2(i,e){var t=fi;fi|=2;var r=zq();(os!==i||As!==e)&&(Wu=null,_g(i,e));do try{Oce();break}catch(n){Uq(i,n)}while(1);if(IF(),fi=t,b2.current=r,mn!==null)throw Error(ve(261));return os=null,As=0,Fn}function Oce(){for(;mn!==null;)Bq(mn)}function Mce(){for(;mn!==null&&!ile();)Bq(mn)}function Bq(i){var e=jq(i.alternate,i,Vo);i.memoizedProps=i.pendingProps,e===null?Gq(i):mn=e,jF.current=null}function Gq(i){var e=i;do{var t=e.alternate;if(i=e.return,e.flags&32768){if(t=Cce(t,e),t!==null){t.flags&=32767,mn=t;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{Fn=6,mn=null;return}}else if(t=Tce(t,e,Vo),t!==null){mn=t;return}if(e=e.sibling,e!==null){mn=e;return}mn=e=i}while(e!==null);Fn===0&&(Fn=5)}function Rf(i,e,t){var r=$i,n=jl.transition;try{jl.transition=null,$i=1,Ice(i,e,t,r)}finally{jl.transition=n,$i=r}return null}function Ice(i,e,t,r){do L0();while(nm!==null);if(fi&6)throw Error(ve(327));t=i.finishedWork;var n=i.finishedLanes;if(t===null)return null;if(i.finishedWork=null,i.finishedLanes=0,t===i.current)throw Error(ve(177));i.callbackNode=null,i.callbackPriority=0;var s=t.lanes|t.childLanes;if(dle(i,s),i===os&&(mn=os=null,As=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||DT||(DT=!0,qq(n2,function(){return L0(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=jl.transition,jl.transition=null;var a=$i;$i=1;var o=fi;fi|=4,jF.current=null,Ece(i,t),Nq(t,i),Kle(vL),a2=!!yL,vL=yL=null,i.current=t,Rce(t),rle(),fi=o,$i=a,jl.transition=s}else i.current=t;if(DT&&(DT=!1,nm=i,x2=n),s=i.pendingLanes,s===0&&(ym=null),ale(t.stateNode),fo(i,Jr()),e!==null)for(r=i.onRecoverableError,t=0;t<e.length;t++)n=e[t],r(n.value,{componentStack:n.stack,digest:n.digest});if(w2)throw w2=!1,i=VL,VL=null,i;return x2&1&&i.tag!==0&&L0(),s=i.pendingLanes,s&1?i===UL?Wb++:(Wb=0,UL=i):Wb=0,Qm(),null}function L0(){if(nm!==null){var i=xj(x2),e=jl.transition,t=$i;try{if(jl.transition=null,$i=16>i?16:i,nm===null)var r=!1;else{if(i=nm,nm=null,x2=0,fi&6)throw Error(ve(331));var n=fi;for(fi|=4,Ue=i.current;Ue!==null;){var s=Ue,a=s.child;if(Ue.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(Ue=c;Ue!==null;){var u=Ue;switch(u.tag){case 0:case 11:case 15:jb(8,u,s)}var d=u.child;if(d!==null)d.return=u,Ue=d;else for(;Ue!==null;){u=Ue;var m=u.sibling,f=u.return;if($q(u),u===c){Ue=null;break}if(m!==null){m.return=f,Ue=m;break}Ue=f}}}var _=s.alternate;if(_!==null){var g=_.child;if(g!==null){_.child=null;do{var w=g.sibling;g.sibling=null,g=w}while(g!==null)}}Ue=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,Ue=a;else e:for(;Ue!==null;){if(s=Ue,s.flags&2048)switch(s.tag){case 0:case 11:case 15:jb(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,Ue=v;break e}Ue=s.return}}var b=i.current;for(Ue=b;Ue!==null;){a=Ue;var x=a.child;if(a.subtreeFlags&2064&&x!==null)x.return=a,Ue=x;else e:for(a=b;Ue!==null;){if(o=Ue,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:iP(9,o)}}catch(R){Vr(o,o.return,R)}if(o===a){Ue=null;break e}var T=o.sibling;if(T!==null){T.return=o.return,Ue=T;break e}Ue=o.return}}if(fi=n,Qm(),Qh&&typeof Qh.onPostCommitFiberRoot=="function")try{Qh.onPostCommitFiberRoot(XR,i)}catch{}r=!0}return r}finally{$i=t,jl.transition=e}}return!1}function C9(i,e,t){e=sv(t,e),e=Tq(i,e,1),i=_m(i,e,1),e=Oa(),i!==null&&(Xx(i,1,e),fo(i,e))}function Vr(i,e,t){if(i.tag===3)C9(i,i,t);else for(;e!==null;){if(e.tag===3){C9(e,i,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ym===null||!ym.has(r))){i=sv(t,i),i=Cq(e,i,1),e=_m(e,i,1),i=Oa(),e!==null&&(Xx(e,1,i),fo(e,i));break}}e=e.return}}function Lce(i,e,t){var r=i.pingCache;r!==null&&r.delete(e),e=Oa(),i.pingedLanes|=i.suspendedLanes&t,os===i&&(As&t)===t&&(Fn===4||Fn===3&&(As&130023424)===As&&500>Jr()-WF?_g(i,0):qF|=t),fo(i,e)}function Hq(i,e){e===0&&(i.mode&1?(e=ST,ST<<=1,!(ST&130023424)&&(ST=4194304)):e=1);var t=Oa();i=Pd(i,e),i!==null&&(Xx(i,e,t),fo(i,t))}function $ce(i){var e=i.memoizedState,t=0;e!==null&&(t=e.retryLane),Hq(i,t)}function Dce(i,e){var t=0;switch(i.tag){case 13:var r=i.stateNode,n=i.memoizedState;n!==null&&(t=n.retryLane);break;case 19:r=i.stateNode;break;default:throw Error(ve(314))}r!==null&&r.delete(e),Hq(i,t)}var jq;jq=function(i,e,t){if(i!==null)if(i.memoizedProps!==e.pendingProps||po.current)uo=!0;else{if(!(i.lanes&t)&&!(e.flags&128))return uo=!1,xce(i,e,t);uo=!!(i.flags&131072)}else uo=!1,br&&e.flags&1048576&&Xj(e,p2,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;NS(i,e),i=e.pendingProps;var n=tv(e,Ks.current);I0(e,t),n=UF(null,e,r,i,n,t);var s=zF();return e.flags|=1,typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,mo(r)?(s=!0,u2(e)):s=!1,e.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,DF(e),n.updater=eP,e.stateNode=n,n._reactInternals=e,PL(e,r,i,t),e=ML(null,e,r,!0,s,t)):(e.tag=0,br&&s&&PF(e),wa(null,e,n,t),e=e.child),e;case 16:r=e.elementType;e:{switch(NS(i,e),i=e.pendingProps,n=r._init,r=n(r._payload),e.type=r,n=e.tag=Nce(r),i=_c(r,i),n){case 0:e=OL(null,e,r,i,t);break e;case 1:e=m9(null,e,r,i,t);break e;case 11:e=d9(null,e,r,i,t);break e;case 14:e=p9(null,e,r,_c(r.type,i),t);break e}throw Error(ve(306,r,""))}return e;case 0:return r=e.type,n=e.pendingProps,n=e.elementType===r?n:_c(r,n),OL(i,e,r,n,t);case 1:return r=e.type,n=e.pendingProps,n=e.elementType===r?n:_c(r,n),m9(i,e,r,n,t);case 3:e:{if(Pq(e),i===null)throw Error(ve(387));r=e.pendingProps,s=e.memoizedState,n=s.element,Kj(i,e),g2(e,r,null,t);var a=e.memoizedState;if(r=a.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){n=sv(Error(ve(423)),e),e=f9(i,e,r,t,n);break e}else if(r!==n){n=sv(Error(ve(424)),e),e=f9(i,e,r,t,n);break e}else for(el=gm(e.stateNode.containerInfo.firstChild),rl=e,br=!0,wc=null,t=iq(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(iv(),r===n){e=Ad(i,e,t);break e}wa(i,e,r,t)}e=e.child}return e;case 5:return rq(e),i===null&&SL(e),r=e.type,n=e.pendingProps,s=i!==null?i.memoizedProps:null,a=n.children,bL(r,n)?a=null:s!==null&&bL(r,s)&&(e.flags|=32),Rq(i,e),wa(i,e,a,t),e.child;case 6:return i===null&&SL(e),null;case 13:return Aq(i,e,t);case 4:return FF(e,e.stateNode.containerInfo),r=e.pendingProps,i===null?e.child=rv(e,null,r,t):wa(i,e,r,t),e.child;case 11:return r=e.type,n=e.pendingProps,n=e.elementType===r?n:_c(r,n),d9(i,e,r,n,t);case 7:return wa(i,e,e.pendingProps,t),e.child;case 8:return wa(i,e,e.pendingProps.children,t),e.child;case 12:return wa(i,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,n=e.pendingProps,s=e.memoizedProps,a=n.value,ir(m2,r._currentValue),r._currentValue=a,s!==null)if(Hc(s.value,a)){if(s.children===n.children&&!po.current){e=Ad(i,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=fd(-1,t&-t),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=t,l=s.alternate,l!==null&&(l.lanes|=t),EL(s.return,t,e),o.lanes|=t;break}l=l.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(ve(341));a.lanes|=t,o=a.alternate,o!==null&&(o.lanes|=t),EL(a,t,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}wa(i,e,n.children,t),e=e.child}return e;case 9:return n=e.type,r=e.pendingProps.children,I0(e,t),n=ql(n),r=r(n),e.flags|=1,wa(i,e,r,t),e.child;case 14:return r=e.type,n=_c(r,e.pendingProps),n=_c(r.type,n),p9(i,e,r,n,t);case 15:return Sq(i,e,e.type,e.pendingProps,t);case 17:return r=e.type,n=e.pendingProps,n=e.elementType===r?n:_c(r,n),NS(i,e),e.tag=1,mo(r)?(i=!0,u2(e)):i=!1,I0(e,t),eq(e,r,n),PL(e,r,n,t),ML(null,e,r,!0,i,t);case 19:return Oq(i,e,t);case 22:return Eq(i,e,t)}throw Error(ve(156,e.tag))};function qq(i,e){return yj(i,e)}function Fce(i,e,t,r){this.tag=i,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vl(i,e,t,r){return new Fce(i,e,t,r)}function YF(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Nce(i){if(typeof i=="function")return YF(i)?1:0;if(i!=null){if(i=i.$$typeof,i===gF)return 11;if(i===_F)return 14}return 2}function bm(i,e){var t=i.alternate;return t===null?(t=Vl(i.tag,e,i.key,i.mode),t.elementType=i.elementType,t.type=i.type,t.stateNode=i.stateNode,t.alternate=i,i.alternate=t):(t.pendingProps=e,t.type=i.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=i.flags&14680064,t.childLanes=i.childLanes,t.lanes=i.lanes,t.child=i.child,t.memoizedProps=i.memoizedProps,t.memoizedState=i.memoizedState,t.updateQueue=i.updateQueue,e=i.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=i.sibling,t.index=i.index,t.ref=i.ref,t}function US(i,e,t,r,n,s){var a=2;if(r=i,typeof i=="function")YF(i)&&(a=1);else if(typeof i=="string")a=5;else e:switch(i){case Zy:return yg(t.children,n,s,e);case fF:a=8,n|=8;break;case KI:return i=Vl(12,t,e,n|2),i.elementType=KI,i.lanes=s,i;case JI:return i=Vl(13,t,e,n),i.elementType=JI,i.lanes=s,i;case eL:return i=Vl(19,t,e,n),i.elementType=eL,i.lanes=s,i;case tj:return nP(t,n,s,e);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case JH:a=10;break e;case ej:a=9;break e;case gF:a=11;break e;case _F:a=14;break e;case zp:a=16,r=null;break e}throw Error(ve(130,i==null?i:typeof i,""))}return e=Vl(a,t,e,n),e.elementType=i,e.type=r,e.lanes=s,e}function yg(i,e,t,r){return i=Vl(7,i,r,e),i.lanes=t,i}function nP(i,e,t,r){return i=Vl(22,i,r,e),i.elementType=tj,i.lanes=t,i.stateNode={isHidden:!1},i}function BA(i,e,t){return i=Vl(6,i,null,e),i.lanes=t,i}function GA(i,e,t){return e=Vl(4,i.children!==null?i.children:[],i.key,e),e.lanes=t,e.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},e}function kce(i,e,t,r,n){this.tag=e,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=TA(0),this.expirationTimes=TA(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=TA(0),this.identifierPrefix=r,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function KF(i,e,t,r,n,s,a,o,l){return i=new kce(i,e,t,o,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Vl(3,null,null,e),i.current=s,s.stateNode=i,s.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},DF(s),i}function Vce(i,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Qy,key:r==null?null:""+r,children:i,containerInfo:e,implementation:t}}function Wq(i){if(!i)return km;i=i._reactInternals;e:{if(o_(i)!==i||i.tag!==1)throw Error(ve(170));var e=i;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(mo(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ve(171))}if(i.tag===1){var t=i.type;if(mo(t))return qj(i,t,e)}return e}function Xq(i,e,t,r,n,s,a,o,l){return i=KF(t,r,!0,i,n,s,a,o,l),i.context=Wq(null),t=i.current,r=Oa(),n=vm(t),s=fd(r,n),s.callback=e??null,_m(t,s,n),i.current.lanes=n,Xx(i,n,r),fo(i,r),i}function sP(i,e,t,r){var n=e.current,s=Oa(),a=vm(n);return t=Wq(t),e.context===null?e.context=t:e.pendingContext=t,e=fd(s,a),e.payload={element:i},r=r===void 0?null:r,r!==null&&(e.callback=r),i=_m(n,e,a),i!==null&&(kc(i,n,a,s),$S(i,n,a)),a}function C2(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function S9(i,e){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var t=i.retryLane;i.retryLane=t!==0&&t<e?t:e}}function JF(i,e){S9(i,e),(i=i.alternate)&&S9(i,e)}function Uce(){return null}var Qq=typeof reportError=="function"?reportError:function(i){console.error(i)};function eN(i){this._internalRoot=i}aP.prototype.render=eN.prototype.render=function(i){var e=this._internalRoot;if(e===null)throw Error(ve(409));sP(i,e,null,null)};aP.prototype.unmount=eN.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var e=i.containerInfo;Ug(function(){sP(null,i,null,null)}),e[Rd]=null}};function aP(i){this._internalRoot=i}aP.prototype.unstable_scheduleHydration=function(i){if(i){var e=Sj();i={blockedOn:null,target:i,priority:e};for(var t=0;t<Xp.length&&e!==0&&e<Xp[t].priority;t++);Xp.splice(t,0,i),t===0&&Rj(i)}};function tN(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function oP(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function E9(){}function zce(i,e,t,r,n){if(n){if(typeof r=="function"){var s=r;r=function(){var c=C2(a);s.call(c)}}var a=Xq(e,r,i,0,null,!1,!1,"",E9);return i._reactRootContainer=a,i[Rd]=a.current,Hw(i.nodeType===8?i.parentNode:i),Ug(),a}for(;n=i.lastChild;)i.removeChild(n);if(typeof r=="function"){var o=r;r=function(){var c=C2(l);o.call(c)}}var l=KF(i,0,!1,null,null,!1,!1,"",E9);return i._reactRootContainer=l,i[Rd]=l.current,Hw(i.nodeType===8?i.parentNode:i),Ug(function(){sP(e,l,t,r)}),l}function lP(i,e,t,r,n){var s=t._reactRootContainer;if(s){var a=s;if(typeof n=="function"){var o=n;n=function(){var l=C2(a);o.call(l)}}sP(e,a,i,n)}else a=zce(t,e,i,n,r);return C2(a)}Tj=function(i){switch(i.tag){case 3:var e=i.stateNode;if(e.current.memoizedState.isDehydrated){var t=z1(e.pendingLanes);t!==0&&(bF(e,t|1),fo(e,Jr()),!(fi&6)&&(av=Jr()+500,Qm()))}break;case 13:Ug(function(){var r=Pd(i,1);if(r!==null){var n=Oa();kc(r,i,1,n)}}),JF(i,1)}};wF=function(i){if(i.tag===13){var e=Pd(i,134217728);if(e!==null){var t=Oa();kc(e,i,134217728,t)}JF(i,134217728)}};Cj=function(i){if(i.tag===13){var e=vm(i),t=Pd(i,e);if(t!==null){var r=Oa();kc(t,i,e,r)}JF(i,e)}};Sj=function(){return $i};Ej=function(i,e){var t=$i;try{return $i=i,e()}finally{$i=t}};hL=function(i,e,t){switch(e){case"input":if(rL(i,t),e=t.name,t.type==="radio"&&e!=null){for(t=i;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==i&&r.form===i.form){var n=KR(r);if(!n)throw Error(ve(90));rj(r),rL(r,n)}}}break;case"textarea":sj(i,t);break;case"select":e=t.value,e!=null&&P0(i,!!t.multiple,e,!1)}};dj=XF;pj=Ug;var Bce={usingClientEntryPoint:!1,Events:[Zx,e0,KR,hj,uj,XF]},Qv={findFiberByHostInstance:rg,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},Gce={bundleType:Qv.bundleType,version:Qv.version,rendererPackageName:Qv.rendererPackageName,rendererConfig:Qv.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ud.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=gj(i),i===null?null:i.stateNode},findFiberByHostInstance:Qv.findFiberByHostInstance||Uce,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var FT=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!FT.isDisabled&&FT.supportsFiber)try{XR=FT.inject(Gce),Qh=FT}catch{}}ol.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Bce;ol.createPortal=function(i,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!tN(e))throw Error(ve(200));return Vce(i,e,null,t)};ol.createRoot=function(i,e){if(!tN(i))throw Error(ve(299));var t=!1,r="",n=Qq;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(n=e.onRecoverableError)),e=KF(i,1,!1,null,null,t,!1,r,n),i[Rd]=e.current,Hw(i.nodeType===8?i.parentNode:i),new eN(e)};ol.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var e=i._reactInternals;if(e===void 0)throw typeof i.render=="function"?Error(ve(188)):(i=Object.keys(i).join(","),Error(ve(268,i)));return i=gj(e),i=i===null?null:i.stateNode,i};ol.flushSync=function(i){return Ug(i)};ol.hydrate=function(i,e,t){if(!oP(e))throw Error(ve(200));return lP(null,i,e,!0,t)};ol.hydrateRoot=function(i,e,t){if(!tN(i))throw Error(ve(405));var r=t!=null&&t.hydratedSources||null,n=!1,s="",a=Qq;if(t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),e=Xq(e,null,i,1,t??null,n,!1,s,a),i[Rd]=e.current,Hw(i),r)for(i=0;i<r.length;i++)t=r[i],n=t._getVersion,n=n(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,n]:e.mutableSourceEagerHydrationData.push(t,n);return new aP(e)};ol.render=function(i,e,t){if(!oP(e))throw Error(ve(200));return lP(null,i,e,!1,t)};ol.unmountComponentAtNode=function(i){if(!oP(i))throw Error(ve(40));return i._reactRootContainer?(Ug(function(){lP(null,null,i,!1,function(){i._reactRootContainer=null,i[Rd]=null})}),!0):!1};ol.unstable_batchedUpdates=XF;ol.unstable_renderSubtreeIntoContainer=function(i,e,t,r){if(!oP(t))throw Error(ve(200));if(i==null||i._reactInternals===void 0)throw Error(ve(38));return lP(i,e,t,!1,r)};ol.version="18.2.0-next-9e3b772b8-20220608";(function(i){function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}e(),i.exports=ol})(Uoe);var R9=QI;XI.createRoot=R9.createRoot,XI.hydrateRoot=R9.hydrateRoot;/**
 * @remix-run/router v1.3.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Jw(){return Jw=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},Jw.apply(this,arguments)}var sm;(function(i){i.Pop="POP",i.Push="PUSH",i.Replace="REPLACE"})(sm||(sm={}));const P9="popstate";function Hce(i){i===void 0&&(i={});function e(r,n){let{pathname:s,search:a,hash:o}=r.location;return GL("",{pathname:s,search:a,hash:o},n.state&&n.state.usr||null,n.state&&n.state.key||"default")}function t(r,n){return typeof n=="string"?n:S2(n)}return qce(e,t,null,i)}function Un(i,e){if(i===!1||i===null||typeof i>"u")throw new Error(e)}function jce(){return Math.random().toString(36).substr(2,8)}function A9(i,e){return{usr:i.state,key:i.key,idx:e}}function GL(i,e,t,r){return t===void 0&&(t=null),Jw({pathname:typeof i=="string"?i:i.pathname,search:"",hash:""},typeof e=="string"?Tv(e):e,{state:t,key:e&&e.key||r||jce()})}function S2(i){let{pathname:e="/",search:t="",hash:r=""}=i;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Tv(i){let e={};if(i){let t=i.indexOf("#");t>=0&&(e.hash=i.substr(t),i=i.substr(0,t));let r=i.indexOf("?");r>=0&&(e.search=i.substr(r),i=i.substr(0,r)),i&&(e.pathname=i)}return e}function qce(i,e,t,r){r===void 0&&(r={});let{window:n=document.defaultView,v5Compat:s=!1}=r,a=n.history,o=sm.Pop,l=null,c=u();c==null&&(c=0,a.replaceState(Jw({},a.state,{idx:c}),""));function u(){return(a.state||{idx:null}).idx}function d(){o=sm.Pop;let w=u(),v=w==null?null:w-c;c=w,l&&l({action:o,location:g.location,delta:v})}function m(w,v){o=sm.Push;let b=GL(g.location,w,v);t&&t(b,w),c=u()+1;let x=A9(b,c),T=g.createHref(b);try{a.pushState(x,"",T)}catch{n.location.assign(T)}s&&l&&l({action:o,location:g.location,delta:1})}function f(w,v){o=sm.Replace;let b=GL(g.location,w,v);t&&t(b,w),c=u();let x=A9(b,c),T=g.createHref(b);a.replaceState(x,"",T),s&&l&&l({action:o,location:g.location,delta:0})}function _(w){let v=n.location.origin!=="null"?n.location.origin:n.location.href,b=typeof w=="string"?w:S2(w);return Un(v,"No window.location.(origin|href) available to create URL for href: "+b),new URL(b,v)}let g={get action(){return o},get location(){return i(n,a)},listen(w){if(l)throw new Error("A history only accepts one active listener");return n.addEventListener(P9,d),l=w,()=>{n.removeEventListener(P9,d),l=null}},createHref(w){return e(n,w)},createURL:_,encodeLocation(w){let v=_(w);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:m,replace:f,go(w){return a.go(w)}};return g}var O9;(function(i){i.data="data",i.deferred="deferred",i.redirect="redirect",i.error="error"})(O9||(O9={}));function Wce(i,e,t){t===void 0&&(t="/");let r=typeof e=="string"?Tv(e):e,n=Kq(r.pathname||"/",t);if(n==null)return null;let s=Zq(i);Xce(s);let a=null;for(let o=0;a==null&&o<s.length;++o)a=rhe(s[o],ahe(n));return a}function Zq(i,e,t,r){e===void 0&&(e=[]),t===void 0&&(t=[]),r===void 0&&(r="");let n=(s,a,o)=>{let l={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:a,route:s};l.relativePath.startsWith("/")&&(Un(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let c=wm([r,l.relativePath]),u=t.concat(l);s.children&&s.children.length>0&&(Un(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),Zq(s.children,e,u,c)),!(s.path==null&&!s.index)&&e.push({path:c,score:the(c,s.index),routesMeta:u})};return i.forEach((s,a)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))n(s,a);else for(let l of Yq(s.path))n(s,a,l)}),e}function Yq(i){let e=i.split("/");if(e.length===0)return[];let[t,...r]=e,n=t.endsWith("?"),s=t.replace(/\?$/,"");if(r.length===0)return n?[s,""]:[s];let a=Yq(r.join("/")),o=[];return o.push(...a.map(l=>l===""?s:[s,l].join("/"))),n&&o.push(...a),o.map(l=>i.startsWith("/")&&l===""?"/":l)}function Xce(i){i.sort((e,t)=>e.score!==t.score?t.score-e.score:ihe(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}const Qce=/^:\w+$/,Zce=3,Yce=2,Kce=1,Jce=10,ehe=-2,M9=i=>i==="*";function the(i,e){let t=i.split("/"),r=t.length;return t.some(M9)&&(r+=ehe),e&&(r+=Yce),t.filter(n=>!M9(n)).reduce((n,s)=>n+(Qce.test(s)?Zce:s===""?Kce:Jce),r)}function ihe(i,e){return i.length===e.length&&i.slice(0,-1).every((r,n)=>r===e[n])?i[i.length-1]-e[e.length-1]:0}function rhe(i,e){let{routesMeta:t}=i,r={},n="/",s=[];for(let a=0;a<t.length;++a){let o=t[a],l=a===t.length-1,c=n==="/"?e:e.slice(n.length)||"/",u=nhe({path:o.relativePath,caseSensitive:o.caseSensitive,end:l},c);if(!u)return null;Object.assign(r,u.params);let d=o.route;s.push({params:r,pathname:wm([n,u.pathname]),pathnameBase:hhe(wm([n,u.pathnameBase])),route:d}),u.pathnameBase!=="/"&&(n=wm([n,u.pathnameBase]))}return s}function nhe(i,e){typeof i=="string"&&(i={path:i,caseSensitive:!1,end:!0});let[t,r]=she(i.path,i.caseSensitive,i.end),n=e.match(t);if(!n)return null;let s=n[0],a=s.replace(/(.)\/+$/,"$1"),o=n.slice(1);return{params:r.reduce((c,u,d)=>{if(u==="*"){let m=o[d]||"";a=s.slice(0,s.length-m.length).replace(/(.)\/+$/,"$1")}return c[u]=ohe(o[d]||"",u),c},{}),pathname:s,pathnameBase:a,pattern:i}}function she(i,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),iN(i==="*"||!i.endsWith("*")||i.endsWith("/*"),'Route path "'+i+'" will be treated as if it were '+('"'+i.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+i.replace(/\*$/,"/*")+'".'));let r=[],n="^"+i.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(a,o)=>(r.push(o),"/([^\\/]+)"));return i.endsWith("*")?(r.push("*"),n+=i==="*"||i==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?n+="\\/*$":i!==""&&i!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,e?void 0:"i"),r]}function ahe(i){try{return decodeURI(i)}catch(e){return iN(!1,'The URL path "'+i+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),i}}function ohe(i,e){try{return decodeURIComponent(i)}catch(t){return iN(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+i+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+t+").")),i}}function Kq(i,e){if(e==="/")return i;if(!i.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=i.charAt(t);return r&&r!=="/"?null:i.slice(t)||"/"}function iN(i,e){if(!i){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function lhe(i,e){e===void 0&&(e="/");let{pathname:t,search:r="",hash:n=""}=typeof i=="string"?Tv(i):i;return{pathname:t?t.startsWith("/")?t:che(t,e):e,search:uhe(r),hash:dhe(n)}}function che(i,e){let t=e.replace(/\/+$/,"").split("/");return i.split("/").forEach(n=>{n===".."?t.length>1&&t.pop():n!=="."&&t.push(n)}),t.length>1?t.join("/"):"/"}function HA(i,e,t,r){return"Cannot include a '"+i+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Jq(i){return i.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function eW(i,e,t,r){r===void 0&&(r=!1);let n;typeof i=="string"?n=Tv(i):(n=Jw({},i),Un(!n.pathname||!n.pathname.includes("?"),HA("?","pathname","search",n)),Un(!n.pathname||!n.pathname.includes("#"),HA("#","pathname","hash",n)),Un(!n.search||!n.search.includes("#"),HA("#","search","hash",n)));let s=i===""||n.pathname==="",a=s?"/":n.pathname,o;if(r||a==null)o=t;else{let d=e.length-1;if(a.startsWith("..")){let m=a.split("/");for(;m[0]==="..";)m.shift(),d-=1;n.pathname=m.join("/")}o=d>=0?e[d]:"/"}let l=lhe(n,o),c=a&&a!=="/"&&a.endsWith("/"),u=(s||a===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const wm=i=>i.join("/").replace(/\/\/+/g,"/"),hhe=i=>i.replace(/\/+$/,"").replace(/^\/*/,"/"),uhe=i=>!i||i==="?"?"":i.startsWith("?")?i:"?"+i,dhe=i=>!i||i==="#"?"":i.startsWith("#")?i:"#"+i;function phe(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.internal=="boolean"&&"data"in i}const mhe=["post","put","patch","delete"];[...mhe];/**
 * React Router v6.8.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function HL(){return HL=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},HL.apply(this,arguments)}function fhe(i,e){return i===e&&(i!==0||1/i===1/e)||i!==i&&e!==e}const ghe=typeof Object.is=="function"?Object.is:fhe,{useState:_he,useEffect:yhe,useLayoutEffect:vhe,useDebugValue:bhe}=WI;function whe(i,e,t){const r=e(),[{inst:n},s]=_he({inst:{value:r,getSnapshot:e}});return vhe(()=>{n.value=r,n.getSnapshot=e,jA(n)&&s({inst:n})},[i,r,e]),yhe(()=>(jA(n)&&s({inst:n}),i(()=>{jA(n)&&s({inst:n})})),[i]),bhe(r),r}function jA(i){const e=i.getSnapshot,t=i.value;try{const r=e();return!ghe(t,r)}catch{return!0}}function xhe(i,e,t){return e()}const The=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Che=!The,She=Che?xhe:whe;"useSyncExternalStore"in WI&&(i=>i.useSyncExternalStore)(WI);const tW=$e.createContext(null),iW=$e.createContext(null),cP=$e.createContext(null),hP=$e.createContext(null),Cv=$e.createContext({outlet:null,matches:[]}),rW=$e.createContext(null);function Ehe(i,e){let{relative:t}=e===void 0?{}:e;Kx()||Un(!1);let{basename:r,navigator:n}=$e.useContext(cP),{hash:s,pathname:a,search:o}=nW(i,{relative:t}),l=a;return r!=="/"&&(l=a==="/"?r:wm([r,a])),n.createHref({pathname:l,search:o,hash:s})}function Kx(){return $e.useContext(hP)!=null}function uP(){return Kx()||Un(!1),$e.useContext(hP).location}function Rhe(){Kx()||Un(!1);let{basename:i,navigator:e}=$e.useContext(cP),{matches:t}=$e.useContext(Cv),{pathname:r}=uP(),n=JSON.stringify(Jq(t).map(o=>o.pathnameBase)),s=$e.useRef(!1);return $e.useEffect(()=>{s.current=!0}),$e.useCallback(function(o,l){if(l===void 0&&(l={}),!s.current)return;if(typeof o=="number"){e.go(o);return}let c=eW(o,JSON.parse(n),r,l.relative==="path");i!=="/"&&(c.pathname=c.pathname==="/"?i:wm([i,c.pathname])),(l.replace?e.replace:e.push)(c,l.state,l)},[i,e,n,r])}function nW(i,e){let{relative:t}=e===void 0?{}:e,{matches:r}=$e.useContext(Cv),{pathname:n}=uP(),s=JSON.stringify(Jq(r).map(a=>a.pathnameBase));return $e.useMemo(()=>eW(i,JSON.parse(s),n,t==="path"),[i,s,n,t])}function Phe(i,e){Kx()||Un(!1);let{navigator:t}=$e.useContext(cP),r=$e.useContext(iW),{matches:n}=$e.useContext(Cv),s=n[n.length-1],a=s?s.params:{};s&&s.pathname;let o=s?s.pathnameBase:"/";s&&s.route;let l=uP(),c;if(e){var u;let g=typeof e=="string"?Tv(e):e;o==="/"||(u=g.pathname)!=null&&u.startsWith(o)||Un(!1),c=g}else c=l;let d=c.pathname||"/",m=o==="/"?d:d.slice(o.length)||"/",f=Wce(i,{pathname:m}),_=Ihe(f&&f.map(g=>Object.assign({},g,{params:Object.assign({},a,g.params),pathname:wm([o,t.encodeLocation?t.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:g.pathnameBase==="/"?o:wm([o,t.encodeLocation?t.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})),n,r||void 0);return e&&_?$e.createElement(hP.Provider,{value:{location:HL({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:sm.Pop}},_):_}function Ahe(){let i=Fhe(),e=phe(i)?i.status+" "+i.statusText:i instanceof Error?i.message:JSON.stringify(i),t=i instanceof Error?i.stack:null,n={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},s=null;return $e.createElement($e.Fragment,null,$e.createElement("h2",null,"Unexpected Application Error!"),$e.createElement("h3",{style:{fontStyle:"italic"}},e),t?$e.createElement("pre",{style:n},t):null,s)}class Ohe extends $e.Component{constructor(e){super(e),this.state={location:e.location,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location?{error:e.error,location:e.location}:{error:e.error||t.error,location:t.location}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error?$e.createElement(Cv.Provider,{value:this.props.routeContext},$e.createElement(rW.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Mhe(i){let{routeContext:e,match:t,children:r}=i,n=$e.useContext(tW);return n&&n.static&&n.staticContext&&t.route.errorElement&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),$e.createElement(Cv.Provider,{value:e},r)}function Ihe(i,e,t){if(e===void 0&&(e=[]),i==null)if(t!=null&&t.errors)i=t.matches;else return null;let r=i,n=t==null?void 0:t.errors;if(n!=null){let s=r.findIndex(a=>a.route.id&&(n==null?void 0:n[a.route.id]));s>=0||Un(!1),r=r.slice(0,Math.min(r.length,s+1))}return r.reduceRight((s,a,o)=>{let l=a.route.id?n==null?void 0:n[a.route.id]:null,c=t?a.route.errorElement||$e.createElement(Ahe,null):null,u=e.concat(r.slice(0,o+1)),d=()=>$e.createElement(Mhe,{match:a,routeContext:{outlet:s,matches:u}},l?c:a.route.element!==void 0?a.route.element:s);return t&&(a.route.errorElement||o===0)?$e.createElement(Ohe,{location:t.location,component:c,error:l,children:d(),routeContext:{outlet:null,matches:u}}):d()},null)}var I9;(function(i){i.UseBlocker="useBlocker",i.UseRevalidator="useRevalidator"})(I9||(I9={}));var E2;(function(i){i.UseLoaderData="useLoaderData",i.UseActionData="useActionData",i.UseRouteError="useRouteError",i.UseNavigation="useNavigation",i.UseRouteLoaderData="useRouteLoaderData",i.UseMatches="useMatches",i.UseRevalidator="useRevalidator"})(E2||(E2={}));function Lhe(i){let e=$e.useContext(iW);return e||Un(!1),e}function $he(i){let e=$e.useContext(Cv);return e||Un(!1),e}function Dhe(i){let e=$he(),t=e.matches[e.matches.length-1];return t.route.id||Un(!1),t.route.id}function Fhe(){var i;let e=$e.useContext(rW),t=Lhe(E2.UseRouteError),r=Dhe(E2.UseRouteError);return e||((i=t.errors)==null?void 0:i[r])}function G1(i){Un(!1)}function Nhe(i){let{basename:e="/",children:t=null,location:r,navigationType:n=sm.Pop,navigator:s,static:a=!1}=i;Kx()&&Un(!1);let o=e.replace(/^\/*/,"/"),l=$e.useMemo(()=>({basename:o,navigator:s,static:a}),[o,s,a]);typeof r=="string"&&(r=Tv(r));let{pathname:c="/",search:u="",hash:d="",state:m=null,key:f="default"}=r,_=$e.useMemo(()=>{let g=Kq(c,o);return g==null?null:{pathname:g,search:u,hash:d,state:m,key:f}},[o,c,u,d,m,f]);return _==null?null:$e.createElement(cP.Provider,{value:l},$e.createElement(hP.Provider,{children:t,value:{location:_,navigationType:n}}))}function khe(i){let{children:e,location:t}=i,r=$e.useContext(tW),n=r&&!e?r.router.routes:jL(e);return Phe(n,t)}var L9;(function(i){i[i.pending=0]="pending",i[i.success=1]="success",i[i.error=2]="error"})(L9||(L9={}));new Promise(()=>{});function jL(i,e){e===void 0&&(e=[]);let t=[];return $e.Children.forEach(i,(r,n)=>{if(!$e.isValidElement(r))return;if(r.type===$e.Fragment){t.push.apply(t,jL(r.props.children,e));return}r.type!==G1&&Un(!1),!r.props.index||!r.props.children||Un(!1);let s=[...e,n],a={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,hasErrorBoundary:r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle};r.props.children&&(a.children=jL(r.props.children,s)),t.push(a)}),t}/**
 * React Router DOM v6.8.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function qL(){return qL=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},qL.apply(this,arguments)}function Vhe(i,e){if(i==null)return{};var t={},r=Object.keys(i),n,s;for(s=0;s<r.length;s++)n=r[s],!(e.indexOf(n)>=0)&&(t[n]=i[n]);return t}function Uhe(i){return!!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)}function zhe(i,e){return i.button===0&&(!e||e==="_self")&&!Uhe(i)}const Bhe=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"];function Ghe(i){let{basename:e,children:t,window:r}=i,n=$e.useRef();n.current==null&&(n.current=Hce({window:r,v5Compat:!0}));let s=n.current,[a,o]=$e.useState({action:s.action,location:s.location});return $e.useLayoutEffect(()=>s.listen(o),[s]),$e.createElement(Nhe,{basename:e,children:t,location:a.location,navigationType:a.action,navigator:s})}const Hhe=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",qA=$e.forwardRef(function(e,t){let{onClick:r,relative:n,reloadDocument:s,replace:a,state:o,target:l,to:c,preventScrollReset:u}=e,d=Vhe(e,Bhe),m,f=!1;if(Hhe&&typeof c=="string"&&/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i.test(c)){m=c;let v=new URL(window.location.href),b=c.startsWith("//")?new URL(v.protocol+c):new URL(c);b.origin===v.origin?c=b.pathname+b.search+b.hash:f=!0}let _=Ehe(c,{relative:n}),g=jhe(c,{replace:a,state:o,target:l,preventScrollReset:u,relative:n});function w(v){r&&r(v),v.defaultPrevented||g(v)}return $e.createElement("a",qL({},d,{href:m||_,onClick:f||s?r:w,ref:t,target:l}))});var $9;(function(i){i.UseScrollRestoration="useScrollRestoration",i.UseSubmitImpl="useSubmitImpl",i.UseFetcher="useFetcher"})($9||($9={}));var D9;(function(i){i.UseFetchers="useFetchers",i.UseScrollRestoration="useScrollRestoration"})(D9||(D9={}));function jhe(i,e){let{target:t,replace:r,state:n,preventScrollReset:s,relative:a}=e===void 0?{}:e,o=Rhe(),l=uP(),c=nW(i,{relative:a});return $e.useCallback(u=>{if(zhe(u,t)){u.preventDefault();let d=r!==void 0?r:S2(l)===S2(c);o(i,{replace:d,state:n,preventScrollReset:s,relative:a})}},[l,o,c,r,n,t,i,s,a])}function qhe(){return nd("div",{className:"home",children:[Ft("div",{className:"link",children:Ft(qA,{to:"/media-layer-images",children:"MediaLayerImages"})}),Ft("div",{className:"link",children:Ft(qA,{to:"/media-layer-video",children:"MediaLayerVideo"})}),Ft("div",{className:"link",children:Ft(qA,{to:"/media-layer-webmap",children:"MediaLayerWebmap"})})]})}let Mu=class extends au(xt){constructor(...e){super(...e),this.position=new He([0,0,0]),this.heading=0,this.tilt=0,this.fov=55}normalizeCtorArgs(e,t,r,n){if(e&&typeof e=="object"&&("x"in e||Array.isArray(e))){const s={position:e};return t!=null&&(s.heading=t),r!=null&&(s.tilt=r),n!=null&&(s.fov=n),s}return e}writePosition(e,t,r,n){const s=e.clone();s.x=kp(e.x||0),s.y=kp(e.y||0),s.z=e.hasZ?kp(e.z||0):e.z,t[r]=s.write({},n)}readPosition(e,t){const r=new He;return r.read(e,t),r.x=kp(r.x||0),r.y=kp(r.y||0),r.z=r.hasZ?kp(r.z||0):r.z,r}equals(e){return!C(e)&&this.tilt===e.tilt&&this.heading===e.heading&&this.fov===e.fov&&this.position.equals(e.position)}};h([p({type:He,json:{write:{isRequired:!0}}})],Mu.prototype,"position",void 0),h([Cs("position")],Mu.prototype,"writePosition",null),h([Dl("position")],Mu.prototype,"readPosition",null),h([p({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),qr(i=>oD.normalize(kp(i)))],Mu.prototype,"heading",void 0),h([p({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),qr(i=>ue(kp(i),-180,180))],Mu.prototype,"tilt",void 0),h([p({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],Mu.prototype,"fov",void 0),Mu=h([F("esri.Camera")],Mu);const al=Mu;var WL;let _p=WL=class extends xt{constructor(i){super(i),this.rotation=0,this.scale=0,this.targetGeometry=null,this.camera=null}castRotation(i){return(i%=360)<0&&(i+=360),i}clone(){return new WL({rotation:this.rotation,scale:this.scale,targetGeometry:y(this.targetGeometry)?this.targetGeometry.clone():null,camera:y(this.camera)?this.camera.clone():null})}};function WA(){return{enabled:!this.camera}}h([p({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:WA}}}}})],_p.prototype,"rotation",void 0),h([qr("rotation")],_p.prototype,"castRotation",null),h([p({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:WA}}}}})],_p.prototype,"scale",void 0),h([p({types:H7,json:{read:NE,write:!0,origins:{"web-scene":{read:NE,write:{overridePolicy:WA}}}}})],_p.prototype,"targetGeometry",void 0),h([p({type:al,json:{write:!0}})],_p.prototype,"camera",void 0),_p=WL=h([F("esri.Viewpoint")],_p);const rr=_p,zS={widthBreakpoint:{getValue(i){const e=i.viewSize[0],t=i.breakpoints,r=this.values;return e<=t.xsmall?r.xsmall:e<=t.small?r.small:e<=t.medium?r.medium:e<=t.large?r.large:r.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(i){const e=i.viewSize[1],t=i.breakpoints,r=this.values;return e<=t.xsmall?r.xsmall:e<=t.small?r.small:e<=t.medium?r.medium:e<=t.large?r.large:r.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(i){const e=i.viewSize,t=e[0],r=e[1],n=this.values;return r>=t?n.portrait:n.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},XA={xsmall:544,small:768,medium:992,large:1200};function Whe(i){const e=i;return e&&e.xsmall<e.small&&e.small<e.medium&&e.medium<e.large}function QA(i,e){return e?zS[i].valueToClassName[e].split(" "):[]}const sW=i=>{let e=class extends i{constructor(...t){super(...t),this._breakpointsHandles=new Vt,this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=XA}initialize(){this._breakpointsHandles.add(B(()=>[this.breakpoints,this.size],()=>this._updateClassNames(),et))}destroy(){this.destroyed||(this._removeActiveClassNames(),this._breakpointsHandles=Oe(this._breakpointsHandles))}set breakpoints(t){if(t===this._get("breakpoints"))return;const r=Whe(t);if(!r){const n=JSON.stringify(XA,null,2);console.warn("provided breakpoints are not valid, using defaults:"+n)}t=r?t:XA,this._set("breakpoints",{...t})}_updateClassNames(){if(!this.container)return;const t=mT.acquire(),r=mT.acquire();let n,s=!1;for(n in zS){const a=this[n],o=zS[n].getValue({viewSize:this.size,breakpoints:this.breakpoints});a!==o&&(s=!0,this[n]=o,QA(n,a).forEach(l=>r.push(l)),QA(n,o).forEach(l=>t.push(l)))}s&&(this._applyClassNameChanges(t,r),mT.release(t),mT.release(r))}_applyClassNameChanges(t,r){const n=this.container;n&&(r.forEach(s=>n.classList.remove(s)),t.forEach(s=>n.classList.add(s)))}_removeActiveClassNames(){const t=this.container;if(!t)return;let r;for(r in zS)QA(r,this[r]).forEach(n=>t.classList.remove(n))}};return h([p()],e.prototype,"breakpoints",null),h([p()],e.prototype,"orientation",void 0),h([p()],e.prototype,"widthBreakpoint",void 0),h([p()],e.prototype,"heightBreakpoint",void 0),e=h([F("esri.views.BreakpointsOwner")],e),e};let yp=class extends pe{constructor(){super(...arguments),this.items=new wt,this._watchUpdatingTracking=new _v,this._callbacks=new Map,this._projector=yI(),this._hiddenProjector=yI()}get needsRender(){return this.items.length>0}get updating(){var e;return((e=this._watchUpdatingTracking)==null?void 0:e.updating)??!1}initialize(){const e=document.createElement("div");e.className="esri-overlay-surface",this._set("surface",e),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),e.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange(()=>this.items,t=>{for(const r of t.added){const n=()=>r.render();this._callbacks.set(r,n),this._projector.append(this.surface,n)}for(const r of t.removed){const n=this._projector.detach(this._callbacks.get(r));this.surface.removeChild(n.domNode),this._callbacks.delete(r)}})}addItem(e){this.items.add(e)}removeItem(e){this.items.remove(e)}destroy(){this.items.removeAll(),this._callbacks.forEach(e=>this._projector.detach(e)),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}render(){this._projector.renderNow()}computeBoundingRect(e){const t=this._hiddenSurface,r=this._hiddenProjector;let n=null;const s=()=>(n=e.render(),n);r.append(t,s),r.renderNow();const a={left:0,top:0,right:0,bottom:0};if(n&&n.domNode){const o=n.domNode.getBoundingClientRect();a.left=o.left,a.top=o.top,a.right=o.right,a.bottom=o.bottom}for(r.detach(s);t.firstChild;)t.removeChild(t.firstChild);return a}overlaps(e,t){const r=this.computeBoundingRect(e),n=this.computeBoundingRect(t);return Math.max(r.left,n.left)<=Math.min(r.right,n.right)&&Math.max(r.top,n.top)<=Math.min(r.bottom,n.bottom)}get hasVisibleItems(){return this.items.some(e=>e.visible)}async prepare(){await document.fonts.load(this._fontString()).catch(()=>{})}renderCanvas(e){if(!this.items.some(r=>r.visible))return;const t=e.getContext("2d");t.save(),t.font=this._fontString(),this.items.forEach(r=>{t.save(),r.renderCanvas(t),t.restore()}),t.restore()}_fontString(){return`10px ${getComputedStyle(this.surface).fontFamily}`}};h([p({readOnly:!0})],yp.prototype,"surface",void 0),h([p({readOnly:!0})],yp.prototype,"items",void 0),h([p({readOnly:!0})],yp.prototype,"needsRender",null),h([p({readOnly:!0})],yp.prototype,"_watchUpdatingTracking",void 0),h([p({readOnly:!0})],yp.prototype,"updating",null),yp=h([F("esri.views.overlay.ViewOverlay")],yp);const F9=yp;function $0(i,e,t,r){let n=null,s=1e3;typeof e=="number"?(s=e,r=t):(n=e??null,s=t);let a,o=0;const l=()=>{o=0,i.apply(r,a)},c=(...u)=>{n&&n.apply(r,u),a=u,s?o||(o=setTimeout(l,s)):l()};return c.remove=()=>{o&&(clearTimeout(o),o=0)},c.forceUpdate=()=>{o&&(clearTimeout(o),l())},c.hasPendingUpdates=()=>!!o,c}function Xhe(i,e,t){return i.units[e][t]}function dP(i,e,t,r=2,n="abbr"){return`${MR(e,{minimumFractionDigits:r,maximumFractionDigits:r,signDisplay:e>0?"never":"exceptZero"})} ${Xhe(i,t,n)}`}function Rke(i,e,t,r=2,n="abbr"){const s=nie(e,t);return dP(i,OR(e,t,s),s,r,n)}function Pke(i,e,t,r=2,n="abbr"){const s=sie(e,t);return dP(i,OR(e,t,s),s,r,n)}function Ake(i,e,t,r=2,n="abbr"){const s=aie(e,t);return dP(i,OR(e,t,s),s,r,n)}function Oke(i,e,t,r=2,n="abbr"){const s=oie(e,t);return dP(i,OR(e,t,s),s,r,n)}const N9=["B","kB","MB","GB","TB"];function Qhe(i,e){let t=e===0?0:Math.floor(Math.log(e)/Math.log(vI.KILOBYTES));t=ue(t,0,N9.length-1);const r=MR(e/vI.KILOBYTES**t,{maximumFractionDigits:2});return H0(i.units.bytes[N9[t]],{fileSize:r})}const Zhe="esri.widgets.Feature.support.featureUtils",k9=ee.getLogger(Zhe),Yhe=/href=(""|'')/gi,Khe=/(\{([^\{\r\n]+)\})/g,Jhe=/\'/g,aW=/^\s*expression\//i,eue=/(\n)/gi,tue=/[\u00A0-\u9999<>\&]/gim,iue=/href\s*=\s*(?:\"([^\"]+)\"|\'([^\']+)\')/gi,rue=/^(?:mailto:|tel:)/,oW="relationships/",XL=eG("short-date-short-time");function lW(i){if(!C(i))return i.get("sourceLayer")||i.get("layer")}async function R2(i,e){return typeof i=="function"?i.call(null,e):i}function cW(i=""){if(i)return!rue.test(i.trim().toLowerCase())}function rN(i){return!!i&&aW.test(i)}function nue(i,e){if(!rN(e)||!i)return null;const t=e.replace(aW,"").toLowerCase();let r;return i.some(n=>n.name.toLowerCase()===t&&(r=n,!0)),r}function hW(i,e){const t=nue(e,i==null?void 0:i.fieldName);return t?t.title||null:i?i.label||i.fieldName:null}function sue(i,e){const t=e.get(i.toLowerCase());return`{${t&&t.fieldName||i}}`}function aue(i){return i.replace(Yhe,"")}function ex(i,e){const t=nN(e,i);return t?t.name:i}function oue(i,e){return i&&i.map(t=>ex(t,e))}function nN(i,e){return i&&typeof i.getField=="function"?i.getField(e):null}function uW(i){return`${i}`.trim()}function ag({attributes:i,globalAttributes:e,layer:t,text:r,expressionAttributes:n,fieldInfoMap:s}){return r?QL({formattedAttributes:e,template:uue(r,{...e,...n,...i},t),fieldInfoMap:s}):""}function QL({formattedAttributes:i,template:e,fieldInfoMap:t}){return uW(aue(H0(H0(e,r=>sue(r,t)),i)))}function lue(i,e,t=!1){const r=e[i];if(typeof r=="string"){const n="%27",s=(t?encodeURIComponent(r):r).replace(Jhe,n);e[i]=s}}function cue(i,e=!1){const t={...i};return Object.keys(t).forEach(r=>lue(r,t,e)),t}function hue(i,e,t){const r=(e=uW(e))&&e[0]!=="{";return H0(i,cue(t,r))}function ZL(i,e){return i.replace(Khe,(t,r,n)=>{const s=nN(e,n);return s?`{${s.name}}`:r})}function uue(i,e,t){const r=ZL(i,t);return r&&r.replace(iue,(n,s,a)=>hue(n,s||a,e))}function due(i,e){if(typeof i=="string"&&e&&e.dateFormat==null&&(e.places!=null||e.digitSeparator!=null)){const t=Number(i);if(!isNaN(t))return t}return i}function pue(i){return(i==null?void 0:i.type)==="feature"}function V9(i){return!!(i!=null&&i.layer)}function mue(i){return(i==null?void 0:i.type)==="map-image"}function fue(i,e){var c;const t=e.fieldInfos,r=e.fieldName,n=(c=dW(t,r))==null?void 0:c.clone(),s=e.preventPlacesFormatting,a=e.layer,o=nN(a,r);if(n&&(o==null?void 0:o.type)==="date"){const u=n.format||new fie;u.dateFormat=u.dateFormat||"short-date-short-time",u.dateTimeFormatOptions=!V9(a)&&pue(a)&&a.datesInUnknownTimezone||V9(a)&&mue(a.layer)&&a.layer.datesInUnknownTimezone?{timeZone:"UTC"}:null,n.format=u}const l=n&&n.format;return typeof i=="string"&&pie(r)&&l?l.formatRasterPixelValue(i):typeof(i=due(i,l))=="string"||i==null||l==null?Jx(i):s?MR(i,{...hie(l),minimumFractionDigits:0,maximumFractionDigits:20}):l.format(i)}function dW(i,e){if(!i||!i.length||!e)return;const t=e.toLowerCase();let r;return i.some(n=>!(!n.fieldName||n.fieldName.toLowerCase()!==t)&&(r=n,!0)),r}function gue({fieldName:i,graphic:e,layer:t}){if(ld(i)||!t||typeof t.getFeatureType!="function")return null;const{typeIdField:r}=t;if(!r||i!==r)return null;const n=t.getFeatureType(e);return n?n.name:null}function _ue({fieldName:i,value:e,graphic:t,layer:r}){if(ld(i)||!r||typeof r.getFieldDomain!="function")return null;const n=r.getFieldDomain(i,{feature:t});return n&&n.type==="coded-value"?n.getName(e):null}function yue(i,e){const{creatorField:t,creationDateField:r,editorField:n,editDateField:s}=i;if(!e)return;const a=e[s];if(typeof a=="number"){const l=e[n];return{type:"edit",date:zE(a,XL),user:l}}const o=e[r];if(typeof o=="number"){const l=e[t];return{type:"create",date:zE(o,XL),user:l}}return null}function vue(i,e){const t=new Map;return i&&i.forEach(r=>{const n=ex(r.fieldName,e);r.fieldName=n,t.set(n.toLowerCase(),r)}),t}function U9(i){const e=[];if(!i)return e;const{fieldInfos:t,content:r}=i;return t&&e.push(...t),r&&Array.isArray(r)&&r.forEach(n=>{if(n.type==="fields"){const s=n&&n.fieldInfos;s&&e.push(...s)}}),e}function sN(i){return i.replace(tue,e=>`&#${e.charCodeAt(0)};`)}function Jx(i){return typeof i=="string"?i.replace(eue,'<br class="esri-text-new-line" />'):i}function pW(i){const{value:e,fieldName:t,fieldInfos:r,fieldInfoMap:n,layer:s,graphic:a}=i;if(e==null)return"";const o=_ue({fieldName:t,value:e,graphic:a,layer:s});if(o)return o;const l=gue({fieldName:t,graphic:a,layer:s});if(l)return l;if(n.get(t.toLowerCase()))return fue(e,{fieldInfos:r||Array.from(n.values()),fieldName:t,layer:s});const c=s&&s.fieldsIndex;return c&&c.isDateField(t)?zE(e,XL):Jx(e)}function ZA({fieldInfos:i,attributes:e,layer:t,graphic:r,fieldInfoMap:n,relatedInfos:s}){const a={};return s==null||s.forEach(o=>Cue({attributes:a,relatedInfo:o,fieldInfoMap:n,fieldInfos:i,layer:t})),Object.keys(e).forEach(o=>{const l=e[o];a[o]=pW({fieldName:o,fieldInfos:i,fieldInfoMap:n,layer:t,value:l,graphic:r})}),a}async function bue(i,e){var u,d;const{layer:t,graphic:r,outFields:n,objectIds:s,returnGeometry:a,spatialReference:o}=i,l=s[0];if(typeof l!="number"&&typeof l!="string"){const m="Could not query required fields for the specified feature. The feature's ID is invalid.",f={layer:t,graphic:r,objectId:l,requiredFields:n};return k9.warn(m,f),null}if(!((d=(u=t.capabilities)==null?void 0:u.operations)!=null&&d.supportsQuery)){const m="The specified layer cannot be queried. The following fields will not be available.",f={layer:t,graphic:r,requiredFields:n,returnGeometry:a};return k9.warn(m,f),null}const c=t.createQuery();return c.objectIds=s,c.outFields=n!=null&&n.length?n:[t.objectIdField],c.returnGeometry=!!a,c.returnZ=!!a,c.returnM=!!a,c.outSpatialReference=o,(await t.queryFeatures(c,e)).features[0]}async function wue(i){var r;if(!((r=i.expressionInfos)!=null&&r.length))return!1;const e=await pD(),{arcadeUtils:{hasGeometryFunctions:t}}=e;return t(i)}async function xue({graphic:i,popupTemplate:e,layer:t,spatialReference:r},n){if(!t||!e||(typeof t.load=="function"&&await t.load(n),!i.attributes))return;const s=i.attributes[t.objectIdField];if(s==null)return;const a=[s],o=await e.getRequiredFields(t.fieldsIndex),l=die(o,i),c=l?[]:o,u=e.returnGeometry||await wue(e);if(l&&!u)return;const d=await bue({layer:t,graphic:i,outFields:c,objectIds:a,returnGeometry:u,spatialReference:r},n);d&&(d.geometry&&(i.geometry=d.geometry),d.attributes&&(i.attributes={...i.attributes,...d.attributes}))}function ld(i=""){return!!i&&i.includes(oW)}function Tue(i){return i?`${oW}${i.layerId}/${i.fieldName}`:""}function z9({attributes:i,graphic:e,relatedInfo:t,fieldInfos:r,fieldInfoMap:n,layer:s}){i&&e&&t&&Object.keys(e.attributes).forEach(a=>{const o=Tue({layerId:t.relation.id.toString(),fieldName:a}),l=e.attributes[a];i[o]=pW({fieldName:o,fieldInfos:r,fieldInfoMap:n,layer:s,value:l,graphic:e})})}function Cue({attributes:i,relatedInfo:e,fieldInfoMap:t,fieldInfos:r,layer:n}){i&&e&&(e.relatedFeatures&&e.relatedFeatures&&e.relatedFeatures.forEach(s=>z9({attributes:i,graphic:s,relatedInfo:e,fieldInfoMap:t,fieldInfos:r,layer:n})),e.relatedStatsFeatures&&e.relatedStatsFeatures&&e.relatedStatsFeatures.forEach(s=>z9({attributes:i,graphic:s,relatedInfo:e,fieldInfoMap:t,fieldInfos:r,layer:n})))}const B9=i=>{if(!i)return!1;const e=i.toUpperCase();return e.includes("CURRENT_TIMESTAMP")||e.includes("CURRENT_DATE")||e.includes("CURRENT_TIME")},mW=({layer:i,method:e,query:t,definitionExpression:r})=>{var a,o;if(!((o=(a=i.capabilities)==null?void 0:a.query)!=null&&o.supportsCacheHint)||e==="attachments")return;const n=y(t.where)&&t.where,s=y(t.geometry)&&t.geometry;B9(r)||B9(n)||(s==null?void 0:s.type)==="extent"||t.resultType==="tile"||(t.cacheHint=!0)},Sue=({query:i,layer:e,method:t})=>{mW({layer:e,method:t,query:i,definitionExpression:`${e.definitionExpression} ${e.serviceDefinitionExpression}`})},Eue=({queryPayload:i,layer:e,method:t})=>{mW({layer:e,method:t,query:i,definitionExpression:`${e.definitionExpression} ${e.serviceDefinitionExpression}`})};function Rue(i,e,t){return i&&e&&t?G9(i.allLayers,e,t)||G9(i.allTables,e,t):null}function G9(i,e,t){return i.find(r=>r!==e&&r.type==="feature"&&r.url===e.url&&r.layerId===t.relatedTableId)}const H9={editing:!1,operations:{add:!0,update:!0,delete:!0}},fW=wt.ofType(uie);let Ha=class extends pe{constructor(e){super(e),this._getAttachmentsPromise=null,this._attachmentLayer=null,this.abilities={...H9},this.activeAttachmentInfo=null,this.activeFileInfo=null,this.attachmentInfos=new fW,this.fileInfos=new wt,this.graphic=null,this.mode="view",this.filesEnabled=!1,this.addHandles(B(()=>this.graphic,()=>this._graphicChanged(),et))}destroy(){this._attachmentLayer=null,this.graphic=null}castAbilities(e){return{...H9,...e}}get state(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}get supportsResizeAttachments(){const{graphic:e}=this;if(!e)return!1;const t=e.layer||e.sourceLayer;return(t==null?void 0:t.loaded)&&"capabilities"in t&&"operations"in t.capabilities&&"supportsResizeAttachments"in t.capabilities.operations&&t.capabilities.operations.supportsResizeAttachments||!1}async getAttachments(){const{_attachmentLayer:e,attachmentInfos:t}=this;if(!e||typeof e.queryAttachments!="function")throw new J("invalid-layer","getAttachments(): A valid layer is required.");const r=this._getObjectId(),n=new P5({objectIds:[r],returnMetadata:!0}),s=[],a=e.queryAttachments(n).then(l=>l[r]||s).catch(()=>s);this._getAttachmentsPromise=a,this.notifyChange("state");const o=await a;return t.removeAll(),o.length&&t.addMany(o),this._getAttachmentsPromise=null,this.notifyChange("state"),o}async addAttachment(e,t=this.graphic){const{_attachmentLayer:r,attachmentInfos:n,abilities:s}=this;if(!t)throw new J("invalid-graphic","addAttachment(): A valid graphic is required.",{graphic:t});if(!e)throw new J("invalid-attachment","addAttachment(): An attachment is required.",{attachment:e});if(!s.operations.add)throw new J("invalid-abilities","addAttachment(): add abilities are required.");if(!r||typeof r.addAttachment!="function")throw new J("invalid-layer","addAttachment(): A valid layer is required.");const a=r.addAttachment(t,e).then(l=>this._queryAttachment(l.objectId,t)),o=await a;return n.add(o),o}async deleteAttachment(e){const{_attachmentLayer:t,attachmentInfos:r,graphic:n,abilities:s}=this;if(!e)throw new J("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:e});if(!s.operations.delete)throw new J("invalid-abilities","deleteAttachment(): delete abilities are required.");if(!t||typeof t.deleteAttachments!="function")throw new J("invalid-layer","deleteAttachment(): A valid layer is required.");const a=t.deleteAttachments(n,[e.id]).then(()=>e),o=await a;return r.remove(o),o}async updateAttachment(e,t=this.activeAttachmentInfo){const{_attachmentLayer:r,attachmentInfos:n,graphic:s,abilities:a}=this;if(!e)throw new J("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:e});if(!t)throw new J("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:t});if(!a.operations.update)throw new J("invalid-abilities","updateAttachment(): Update abilities are required.");const o=n.findIndex(u=>u===t);if(!r||typeof r.updateAttachment!="function")throw new J("invalid-layer","updateAttachment(): A valid layer is required.");const l=r.updateAttachment(s,t.id,e).then(u=>this._queryAttachment(u.objectId)),c=await l;return n.splice(o,1,c),c}async commitFiles(){return await Promise.all(this.fileInfos.items.map(e=>this.addAttachment(e.form))),this.fileInfos.removeAll(),this.getAttachments()}addFile(e,t){if(!e||!t)return null;const r={file:e,form:t};return this.fileInfos.add(r),r}updateFile(e,t,r=this.activeFileInfo){if(!e||!t||!r)return null;const n=this.fileInfos.findIndex(s=>r===s);return n>-1&&this.fileInfos.splice(n,1,{file:e,form:t}),this.fileInfos.items[n]}deleteFile(e){const t=this.fileInfos.find(r=>r.file===e);return this.fileInfos.remove(t)??null}async _queryAttachment(e,t){if(!e)throw new J("invalid-attachment-id","Could not query attachment.");const{_attachmentLayer:r}=this,n=this._getObjectId(t),s=new P5({objectIds:[n],attachmentsWhere:`AttachmentId=${e}`,returnMetadata:!0});return r.queryAttachments(s).then(a=>a[n][0])}_getObjectId(e=this.graphic){return(e==null?void 0:e.getObjectId())??null}_graphicChanged(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch(()=>{}))}_setAttachmentLayer(){const{graphic:e}=this,t=lW(e);this._attachmentLayer=t?t.type==="scene"&&y(t.associatedLayer)?t.associatedLayer:t:null}};h([p()],Ha.prototype,"abilities",void 0),h([qr("abilities")],Ha.prototype,"castAbilities",null),h([p()],Ha.prototype,"activeAttachmentInfo",void 0),h([p()],Ha.prototype,"activeFileInfo",void 0),h([p({readOnly:!0,type:fW})],Ha.prototype,"attachmentInfos",void 0),h([p()],Ha.prototype,"fileInfos",void 0),h([p({type:jc})],Ha.prototype,"graphic",void 0),h([p()],Ha.prototype,"mode",void 0),h([p({readOnly:!0})],Ha.prototype,"state",null),h([p()],Ha.prototype,"filesEnabled",void 0),h([p({readOnly:!0})],Ha.prototype,"supportsResizeAttachments",null),Ha=h([F("esri.widgets.Attachments.AttachmentsViewModel")],Ha);const aN=Ha;function j9(i){const e=i.toLowerCase();return e==="image/bmp"||e==="image/emf"||e==="image/exif"||e==="image/gif"||e==="image/x-icon"||e==="image/jpeg"||e==="image/png"||e==="image/tiff"||e==="image/x-wmf"}function Pue(i){const e=wI("esri/themes/base/images/files/");return i?i==="text/plain"?`${e}text-32.svg`:i==="application/pdf"?`${e}pdf-32.svg`:i==="text/csv"?`${e}csv-32.svg`:i==="application/gpx+xml"?`${e}gpx-32.svg`:i==="application/x-dwf"?`${e}cad-32.svg`:i==="application/postscript"||i==="application/json"||i==="text/xml"||i==="model/vrml"?`${e}code-32.svg`:i==="application/x-zip-compressed"||i==="application/x-7z-compressed"||i==="application/x-gzip"||i==="application/x-tar"||i==="application/x-gtar"||i==="application/x-bzip2"||i==="application/gzip"||i==="application/x-compress"||i==="application/x-apple-diskimage"||i==="application/x-rar-compressed"||i==="application/zip"?`${e}zip-32.svg`:i.includes("image/")?`${e}image-32.svg`:i.includes("audio/")?`${e}sound-32.svg`:i.includes("video/")?`${e}video-32.svg`:i.includes("msexcel")||i.includes("ms-excel")||i.includes("spreadsheetml")?`${e}excel-32.svg`:i.includes("msword")||i.includes("ms-word")||i.includes("wordprocessingml")?`${e}word-32.svg`:i.includes("powerpoint")||i.includes("presentationml")?`${e}report-32.svg`:`${e}generic-32.svg`:`${e}generic-32.svg`}const q9={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},Se={base:"esri-attachments",loaderContainer:"esri-attachments__loader-container",loader:"esri-attachments__loader",fadeIn:"esri-attachments--fade-in",container:"esri-attachments__container",containerList:"esri-attachments__container--list",containerPreview:"esri-attachments__container--preview",actions:"esri-attachments__actions",deleteButton:"esri-attachments__delete-button",addAttachmentButton:"esri-attachments__add-attachment-button",errorMessage:"esri-attachments__error-message",items:"esri-attachments__items",item:"esri-attachments__item",itemButton:"esri-attachments__item-button",itemMask:"esri-attachments__item-mask",itemMaskIcon:"esri-attachments__item-mask--icon",itemImage:"esri-attachments__image",itemImageResizable:"esri-attachments__image--resizable",itemLabel:"esri-attachments__label",itemFilename:"esri-attachments__filename",itemChevronIcon:"esri-attachments__item-chevron-icon",itemLink:"esri-attachments__item-link",itemLinkOverlay:"esri-attachments__item-link-overlay",itemLinkOverlayIcon:"esri-attachments__item-link-overlay-icon",itemEditIcon:"esri-attachments__item-edit-icon",itemAddIcon:"esri-attachments__item-add-icon",itemAddButton:"esri-attachments__item-add-button",formNode:"esri-attachments__form-node",fileFieldset:"esri-attachments__file-fieldset",fileLabel:"esri-attachments__file-label",fileName:"esri-attachments__file-name",fileInput:"esri-attachments__file-input",metadata:"esri-attachments__metadata",metadataFieldset:"esri-attachments__metadata-fieldset",progressBar:"esri-attachments__progress-bar",esriWidget:"esri-widget",esriButton:"esri-button",buttonDisabled:"esri-button--disabled",esriButtonSecondary:"esri-button--secondary",esriButtonTertiary:"esri-button--tertiary",esriButtonThird:"esri-button--third",esriButtonSmall:"esri-button--small",esriButtonHalf:"esri-button--half",empty:"esri-widget__content--empty",iconExternalLink:"esri-icon-link-external",iconEdit:"esri-icon-edit",iconRight:"esri-icon-right",iconLeft:"esri-icon-left",iconPlus:"esri-icon-plus"},YA=window.CSS;let ks=class extends Hn{constructor(e,t){super(e,t),this.displayType="auto",this.messages=null,this.messagesUnits=null,this.selectedFile=null,this.submitting=!1,this.viewModel=new aN,this.visibleElements={...q9},this._supportsImageOrientation=YA&&YA.supports&&YA.supports("image-orientation","from-image"),this._addAttachmentForm=null,this._updateAttachmentForm=null}initialize(){this.addHandles([wr(()=>{var e;return(e=this.viewModel)==null?void 0:e.attachmentInfos},"change",()=>this.scheduleRender()),wr(()=>{var e;return(e=this.viewModel)==null?void 0:e.fileInfos},"change",()=>this.scheduleRender()),B(()=>{var e;return(e=this.viewModel)==null?void 0:e.mode},()=>this._modeChanged(),et)])}loadDependencies(){return Promise.all([j(()=>import("./calcite-icon-938ab0b8.js"),["assets/calcite-icon-938ab0b8.js","assets/icon-40b00e67.js","assets/widget-fb292a2f.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/intl-65a3e389.js","assets/number-27cf8195.js","assets/jsonMap-7b8332c9.js","assets/locale-30120714.js","assets/messages-2289086c.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/assets-8d3e737a.js","assets/Evented-a45c8b0f.js","assets/Promise-376ab9f6.js","assets/reactiveUtils-4dabbb80.js","assets/uuid-73213768.js","assets/observers-edc9938f.js"])])}get abilities(){return this.viewModel.abilities}set abilities(e){this.viewModel.abilities=e}get effectiveDisplayType(){const{displayType:e}=this;return e&&e!=="auto"?e:this.viewModel.supportsResizeAttachments?"preview":"list"}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}castVisibleElements(e){return{...q9,...e}}addAttachment(){const{_addAttachmentForm:e,viewModel:t}=this;return this._set("submitting",!0),this._set("error",null),t.addAttachment(e).then(r=>(this._set("submitting",!1),this._set("error",null),t.mode="view",r)).catch(r=>{throw this._set("submitting",!1),this._set("error",new J("attachments:add-attachment",this.messages.addErrorMessage,r)),r})}deleteAttachment(e){const{viewModel:t}=this;return this._set("submitting",!0),this._set("error",null),t.deleteAttachment(e).then(r=>(this._set("submitting",!1),this._set("error",null),t.mode="view",r)).catch(r=>{throw this._set("submitting",!1),this._set("error",new J("attachments:delete-attachment",this.messages.deleteErrorMessage,r)),r})}updateAttachment(){const{viewModel:e}=this,{_updateAttachmentForm:t}=this;return this._set("submitting",!0),this._set("error",null),e.updateAttachment(t).then(r=>(this._set("submitting",!1),this._set("error",null),e.mode="view",r)).catch(r=>{throw this._set("submitting",!1),this._set("error",new J("attachments:update-attachment",this.messages.updateErrorMessage,r)),r})}addFile(){const e=this.viewModel.addFile(this.selectedFile,this._addAttachmentForm);return this.viewModel.mode="view",e}updateFile(){const{viewModel:e}=this,t=e.updateFile(this.selectedFile,this._updateAttachmentForm,e.activeFileInfo);return e.mode="view",t}deleteFile(e){const t=this.viewModel.deleteFile(e||this.viewModel.activeFileInfo.file);return this.viewModel.mode="view",t}render(){const{submitting:e,viewModel:t}=this,{state:r}=t;return N("div",{class:this.classes(Se.base,Se.esriWidget)},e?this.renderProgressBar():null,r==="loading"?this.renderLoading():this.renderAttachments(),this.renderErrorMessage())}renderErrorMessage(){const{error:e,visibleElements:t}=this;return e&&t.errorMessage?N("div",{key:"error-message",class:Se.errorMessage},e.message):null}renderAttachments(){const{activeFileInfo:e,mode:t,activeAttachmentInfo:r}=this.viewModel;return t==="add"?this.renderAddForm():t==="edit"?this.renderDetailsForm(r||e):this.renderAttachmentContainer()}renderLoading(){return N("div",{class:Se.loaderContainer,key:"loader"},N("div",{class:Se.loader}))}renderProgressBar(){return this.visibleElements.progressBar?N("div",{class:Se.progressBar,key:"progress-bar"}):null}renderAddForm(){const{submitting:e,selectedFile:t}=this,r=e||!t,n=this.visibleElements.cancelAddButton?N("button",{type:"button",bind:this,disabled:e,onclick:this._cancelForm,class:this.classes(Se.esriButton,Se.esriButtonTertiary,Se.esriButtonSmall,Se.esriButtonHalf,e&&Se.buttonDisabled)},this.messages.cancel):null,s=this.visibleElements.addSubmitButton?N("button",{type:"submit",disabled:r,class:this.classes(Se.esriButton,Se.esriButtonSecondary,Se.esriButtonSmall,Se.esriButtonHalf,{[Se.buttonDisabled]:r})},this.messages.add):null,a=t?N("span",{key:"file-name",class:Se.fileName},t.name):null,o=N("form",{bind:this,afterCreate:VE,afterRemoved:S5,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},N("fieldset",{class:Se.fileFieldset},a,N("label",{class:this.classes(Se.fileLabel,Se.esriButton,Se.esriButtonSecondary)},t?this.messages.changeFile:this.messages.selectFile,N("input",{class:Se.fileInput,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))),s,n);return N("div",{key:"add-form-container",class:Se.formNode},o)}renderDetailsForm(e){const{visibleElements:t,viewModel:r,selectedFile:n,submitting:s}=this,{abilities:a}=r,o=s||!n;let l,c,u,d;n?(l=n.type,c=n.name,u=n.size):"file"in e?(l=e.file.type,c=e.file.name,u=e.file.size):(l=e.contentType,c=e.name,u=e.size,d=e.url);const m=a.editing&&a.operations.delete&&t.deleteButton?N("button",{key:"delete-button",type:"button",disabled:s,bind:this,onclick:T=>this._submitDeleteAttachment(T,e),class:this.classes(Se.esriButton,Se.esriButtonSmall,Se.esriButtonTertiary,Se.deleteButton,{[Se.buttonDisabled]:s})},this.messages.delete):void 0,f=a.editing&&a.operations.update&&t.updateButton?N("button",{disabled:o,key:"update-button",type:"submit",class:this.classes(Se.esriButton,Se.esriButtonSmall,Se.esriButtonThird,{[Se.buttonDisabled]:o})},this.messages.update):void 0,_=this.visibleElements.cancelUpdateButton?N("button",{disabled:s,key:"cancel-button",type:"button",bind:this,onclick:this._cancelForm,class:this.classes(Se.esriButton,Se.esriButtonSmall,Se.esriButtonTertiary,Se.esriButtonThird,{[Se.buttonDisabled]:s})},this.messages.cancel):void 0,g=a.editing&&a.operations.update?N("fieldset",{key:"file",class:Se.fileFieldset},N("span",{key:"file-name",class:Se.fileName},c),N("label",{class:this.classes(Se.fileLabel,Se.esriButton,Se.esriButtonSecondary)},this.messages.changeFile,N("input",{class:Se.fileInput,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))):void 0,w=N("fieldset",{key:"size",class:Se.metadataFieldset},N("label",null,Qhe(this.messagesUnits,u))),v=N("fieldset",{key:"content-type",class:Se.metadataFieldset},N("label",null,l)),b=y(d)?N("a",{class:Se.itemLink,href:d,rel:"noreferrer",target:"_blank"},this.renderImageMask(e,400),N("div",{class:Se.itemLinkOverlay},N("span",{class:Se.itemLinkOverlayIcon},N("calcite-icon",{icon:"launch"})))):this.renderImageMask(e,400),x=N("form",{bind:this,afterCreate:VE,afterRemoved:S5,"data-node-ref":"_updateAttachmentForm",onsubmit:T=>this._submitUpdateAttachment(T,e)},N("div",{class:Se.metadata},w,v),g,N("div",{class:Se.actions},m,_,f));return N("div",{key:"edit-form-container",class:Se.formNode},b,x)}renderImageMask(e,t){return"file"in e?this.renderGenericImageMask(e.file.name,e.file.type):this.renderImageMaskForAttachment(e,t)}renderGenericImageMask(e,t){const{supportsResizeAttachments:r}=this.viewModel,n=Pue(t),s={[Se.itemImageResizable]:r};return N("div",{class:this.classes(Se.itemMaskIcon,Se.itemMask)},N("img",{title:e,alt:e,src:n,class:this.classes(s,Se.itemImage)}))}renderImageMaskForAttachment(e,t){const{supportsResizeAttachments:r}=this.viewModel,{contentType:n,name:s,url:a}=e;if(!r||!j9(n))return this.renderGenericImageMask(s,n);const o=this._getCSSTransform(e),l=o?{transform:o,"image-orientation":"none"}:{},c=`${a}${a.includes("?")?"&":"?"}w=${t}`,u={[Se.itemImageResizable]:r};return N("div",{class:this.classes(Se.itemMask)},N("img",{styles:l,alt:s,title:s,src:c,class:this.classes(u,Se.itemImage)}))}renderFile(e){const{file:t}=e;return N("li",{class:Se.item,key:t},N("button",{key:"details-button",bind:this,class:Se.itemButton,title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,onclick:()=>this._startEditFile(e),type:"button"},this.renderImageMask(e),N("label",{class:Se.itemLabel},N("span",{class:Se.itemFilename},t.name||this.messages.noTitle),N("span",{"aria-hidden":"true",class:this.classes(Se.itemChevronIcon,zh(this.container)?Se.iconLeft:Se.iconRight)}))))}renderAttachmentInfo({attachmentInfo:e,displayType:t}){const{viewModel:r,effectiveDisplayType:n}=this,{abilities:s,supportsResizeAttachments:a}=r,{contentType:o,name:l,url:c}=e,u=this.renderImageMask(e,t==="list"?48:400),d=s.editing?N("span",{"aria-hidden":"true",class:this.classes(Se.itemChevronIcon,zh(this.container)?Se.iconLeft:Se.iconRight)}):null,m=[u,n==="preview"&&a&&j9(o)?null:N("label",{class:Se.itemLabel},N("span",{class:Se.itemFilename},l||this.messages.noTitle),d)],f=s.editing?N("button",{key:"details-button",bind:this,class:Se.itemButton,title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,"data-attachment-info-id":e.id,onclick:()=>this._startEditAttachment(e),type:"button"},m):N("a",{key:"details-link",class:Se.itemButton,href:c,target:"_blank"},m);return N("li",{class:Se.item,key:e},f)}renderAttachmentContainer(){const{effectiveDisplayType:e,viewModel:t,visibleElements:r}=this,{attachmentInfos:n,abilities:s,fileInfos:a}=t,o=!!(n!=null&&n.length),l=!!(a!=null&&a.length),c={[Se.containerList]:e!=="preview",[Se.containerPreview]:e==="preview"},u=s.editing&&s.operations.add&&r.addButton?N("button",{bind:this,onclick:()=>this._startAddAttachment(),class:this.classes(Se.esriButton,Se.esriButtonTertiary,Se.addAttachmentButton),type:"button"},N("span",{"aria-hidden":"true",class:this.classes(Se.itemAddIcon,Se.iconPlus)}),this.messages.add):void 0,d=o?N("ul",{key:"attachments-list",class:Se.items},n.toArray().map(_=>this.renderAttachmentInfo({attachmentInfo:_,displayType:e}))):void 0,m=l?N("ul",{key:"file-list",class:Se.items},a.toArray().map(_=>this.renderFile(_))):void 0,f=l||o?void 0:N("div",{class:Se.empty},this.messages.noAttachments);return N("div",{key:"attachments-container",class:this.classes(Se.container,c)},d,m,f,u)}_modeChanged(){this._set("error",null),this._set("selectedFile",null)}_handleFileInputChange(e){const t=e.target,r=t&&t.files&&t.files.item(0);this._set("selectedFile",r)}_submitDeleteAttachment(e,t){e.preventDefault(),"file"in t?this.deleteFile(t.file):this.deleteAttachment(t)}_submitAddAttachment(e){e.preventDefault(),this.viewModel.filesEnabled?this.addFile():this.addAttachment()}_submitUpdateAttachment(e,t){e.preventDefault(),"file"in t?this.updateFile():this.updateAttachment()}_startEditAttachment(e){const{viewModel:t}=this;t.activeFileInfo=null,t.activeAttachmentInfo=e,t.mode="edit"}_startEditFile(e){const{viewModel:t}=this;t.activeAttachmentInfo=null,t.activeFileInfo=e,t.mode="edit"}_startAddAttachment(){this.viewModel.mode="add"}_cancelForm(e){e.preventDefault(),this.viewModel.mode="view"}_getCSSTransform(e){const{orientationInfo:t}=e;return!this._supportsImageOrientation&&t?[t.rotation?`rotate(${t.rotation}deg)`:"",t.mirrored?"scaleX(-1)":""].join(" "):""}};h([p()],ks.prototype,"abilities",null),h([p()],ks.prototype,"displayType",void 0),h([p({readOnly:!0})],ks.prototype,"effectiveDisplayType",null),h([p()],ks.prototype,"graphic",null),h([p()],ks.prototype,"label",null),h([p(),_n("esri/widgets/Attachments/t9n/Attachments")],ks.prototype,"messages",void 0),h([p(),_n("esri/core/t9n/Units")],ks.prototype,"messagesUnits",void 0),h([p({readOnly:!0})],ks.prototype,"selectedFile",void 0),h([p({readOnly:!0})],ks.prototype,"submitting",void 0),h([p({readOnly:!0})],ks.prototype,"error",void 0),h([p({type:aN})],ks.prototype,"viewModel",void 0),h([p()],ks.prototype,"visibleElements",void 0),h([qr("visibleElements")],ks.prototype,"castVisibleElements",null),ks=h([F("esri.widgets.Attachments")],ks);const Aue=ks;let H1=class extends aN{constructor(e){super(e),this.description=null,this.title=null}};h([p()],H1.prototype,"description",void 0),h([p()],H1.prototype,"title",void 0),H1=h([F("esri.widgets.Feature.FeatureAttachments.FeatureAttachmentsViewModel")],H1);const oN=H1,Oue={heading:"esri-widget__heading"};function lN(i,e){const t=Mue(i.level),r=`h${t}`;return delete i.level,N(r,{...i,class:Jte(Oue.heading,i.class),role:"heading","aria-level":String(t)},e)}function Mue(i){return ue(Math.ceil(i),1,6)}const KA={base:"esri-feature-element-info",title:"esri-feature-element-info__title",description:"esri-feature-element-info__description"};let py=class extends Hn{constructor(e,t){super(e,t),this.description=null,this.headingLevel=2,this.title=null}render(){return N("div",{class:KA.base},this.renderTitle(),this.renderDescription())}renderTitle(){const{title:e}=this;return e?N(lN,{level:this.headingLevel,class:KA.title},e):null}renderDescription(){const{description:e}=this;return e?N("div",{key:"description",class:KA.description},e):null}};h([p()],py.prototype,"description",void 0),h([p()],py.prototype,"headingLevel",void 0),h([p()],py.prototype,"title",void 0),py=h([F("esri.widgets.Feature.support.FeatureElementInfo")],py);const pP=py,Iue={base:"esri-feature-attachments"};let ph=class extends Hn{constructor(e,t){super(e,t),this._featureElementInfo=null,this.attachmentsWidget=new Aue,this.headingLevel=2,this.viewModel=new oN}initialize(){this._featureElementInfo=new pP,this.addHandles([B(()=>{var e,t;return[(e=this.viewModel)==null?void 0:e.description,(t=this.viewModel)==null?void 0:t.title,this.headingLevel]},()=>this._setupFeatureElementInfo(),et),B(()=>{var e;return(e=this.viewModel)==null?void 0:e.graphic},e=>this.attachmentsWidget.graphic=e,et)])}destroy(){this.attachmentsWidget.destroy(),this._featureElementInfo.destroy()}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get displayType(){return this.attachmentsWidget.displayType}set displayType(e){this.attachmentsWidget.displayType=e}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}render(){var t;const{attachmentsWidget:e}=this;return N("div",{class:Iue.base},(t=this._featureElementInfo)==null?void 0:t.render(),e==null?void 0:e.render())}_setupFeatureElementInfo(){const{description:e,title:t,headingLevel:r}=this;this._featureElementInfo.set({description:e,title:t,headingLevel:r})}};h([p({readOnly:!0})],ph.prototype,"attachmentsWidget",void 0),h([p()],ph.prototype,"description",null),h([p()],ph.prototype,"displayType",null),h([p()],ph.prototype,"graphic",null),h([p()],ph.prototype,"headingLevel",void 0),h([p()],ph.prototype,"title",null),h([p({type:oN})],ph.prototype,"viewModel",void 0),ph=h([F("esri.widgets.Feature.FeatureAttachments")],ph);const Lue=ph;let vp=class extends Ux(pe){constructor(e){super(e),this._loadingPromise=null,this.created=null,this.creator=null,this.destroyer=null,this.graphic=null,this.handles.add(B(()=>this.creator,t=>{this._destroyContent(),this._createContent(t)},et))}destroy(){this._destroyContent()}get state(){return this._loadingPromise?"loading":"ready"}_destroyContent(){const{created:e,graphic:t,destroyer:r}=this;e&&(R2(r,{graphic:t}).catch(()=>null),this._set("created",null))}async _createContent(e){const{graphic:t}=this,r=R2(e,{graphic:t}).catch(()=>null);this._loadingPromise=r,this.notifyChange("state");const n=await r;r===this._loadingPromise&&(this._loadingPromise=null,this.notifyChange("state"),this._set("created",n))}};h([p({readOnly:!0})],vp.prototype,"created",void 0),h([p()],vp.prototype,"creator",void 0),h([p()],vp.prototype,"destroyer",void 0),h([p({type:jc})],vp.prototype,"graphic",void 0),h([p({readOnly:!0})],vp.prototype,"state",null),vp=h([F("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")],vp);const P2=vp;function Uo(){return function(i,e){if(!i[e])throw new TypeError(`Cannot auto bind undefined function '${e}'`);return{value:Due(i[e])}}}function $ue(i){const{type:e}=i;return i instanceof KeyboardEvent||e==="keyup"||e==="keydown"||e==="keypress"}function Due(i){return function(e,...t){$ue(e)?eie(e.key)&&(e.preventDefault(),e.stopPropagation(),e.target.click()):i.call(this,e,...t)}}function Fue(i){return e=>{e.hasOwnProperty("_delegatedEventNames")||(e._delegatedEventNames=e._delegatedEventNames?e._delegatedEventNames.slice():[]);const t=e._delegatedEventNames,r=Array.isArray(i)?i:Nue(i);t.push(...r)}}function Nue(i){return i.split(",").map(e=>e.trim())}const gW="calcite-theme-";function kue(){return getComputedStyle(document.body).getPropertyValue("--esri-calcite-theme-name").replace(/\s|'|"/g,"")}function A2(){return kue().startsWith("dark")}function Vue(){return`${gW}${A2()?"dark":"light"}`}function Uue(i){zue(i),i.classList.add(Vue())}function zue(i){Array.from(i.classList).forEach(e=>{e.startsWith(gW)&&i.classList.remove(e)})}const JA={base:"esri-feature-content",loaderContainer:"esri-feature-content__loader-container",loader:"esri-feature-content__loader"};let my=class extends Hn{constructor(e,t){super(e,t),this.viewModel=null,this._addTargetToAnchors=r=>{Array.from(r.querySelectorAll("a")).forEach(n=>{cW(n.href)&&!n.hasAttribute("target")&&n.setAttribute("target","_blank")})}}get creator(){return this.viewModel.creator}set creator(e){this.viewModel.creator=e}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}renderLoading(){return N("div",{class:JA.loaderContainer,key:"loader"},N("div",{class:JA.loader}))}renderCreated(){var t;const e=(t=this.viewModel)==null?void 0:t.created;return e?e instanceof HTMLElement?N("div",{key:e,bind:e,afterCreate:this._attachToNode}):UE(e)?N("div",{key:e},!e.destroyed&&e.render()):N("div",{key:e,innerHTML:e,afterCreate:this._addTargetToAnchors}):null}render(){var t;const e=(t=this.viewModel)==null?void 0:t.state;return N("div",{class:JA.base},e==="loading"?this.renderLoading():this.renderCreated())}_attachToNode(e){const t=this;e.appendChild(t)}};h([p()],my.prototype,"creator",null),h([p()],my.prototype,"graphic",null),h([p({type:P2})],my.prototype,"viewModel",void 0),my=h([F("esri.widgets.Feature.FeatureContent")],my);const BS=my;let Iu=class extends pe{constructor(e){super(e),this.attributes=null,this.expressionInfos=null,this.description=null,this.fieldInfos=null,this.title=null}get formattedFieldInfos(){const{expressionInfos:e,fieldInfos:t}=this,r=[];return t==null||t.forEach(n=>{if(!(!n.hasOwnProperty("visible")||n.visible))return;const s=n.clone();s.label=hW(s,e),r.push(s)}),r}};h([p()],Iu.prototype,"attributes",void 0),h([p({type:[gie]})],Iu.prototype,"expressionInfos",void 0),h([p()],Iu.prototype,"description",void 0),h([p({type:[tG]})],Iu.prototype,"fieldInfos",void 0),h([p({readOnly:!0})],Iu.prototype,"formattedFieldInfos",null),h([p()],Iu.prototype,"title",void 0),Iu=h([F("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")],Iu);const mP=Iu,Bue=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];function Gue(i){let e=null;return Bue.some(t=>(t.pattern.test(i)&&(e=t),!!e)),e}function Hue(i,e){if(typeof e!="string"||!e)return e;const t=Gue(e);if(!t)return e;const r=e.match(t.pattern),n=r&&r[2],s=H0(H0(t.label,{messages:i,hierPart:n}),{appName:t.appName}),a=t.target?` target="${t.target}"`:"",o=t.target==="_blank"?' rel="noreferrer"':"";return e.replace(t.pattern,`<a${a} href="$1"${o}>${s}</a>`)}const Zv={base:"esri-feature-fields",fieldHeader:"esri-feature-fields__field-header",fieldData:"esri-feature-fields__field-data",fieldDataDate:"esri-feature-fields__field-data--date",esriTable:"esri-widget__table"};let nc=class extends Hn{constructor(e,t){super(e,t),this._featureElementInfo=null,this.viewModel=new mP,this.messages=null,this.messagesURIUtils=null}initialize(){this._featureElementInfo=new pP,this.addHandles(B(()=>{var e,t;return[(e=this.viewModel)==null?void 0:e.description,(t=this.viewModel)==null?void 0:t.title]},()=>this._setupFeatureElementInfo(),et))}destroy(){this._featureElementInfo.destroy()}get attributes(){return this.viewModel.attributes}set attributes(e){this.viewModel.attributes=e}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get expressionInfos(){return this.viewModel.expressionInfos}set expressionInfos(e){this.viewModel.expressionInfos=e}get fieldInfos(){return this.viewModel.fieldInfos}set fieldInfos(e){this.viewModel.fieldInfos=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}renderFieldInfo(e,t){const{attributes:r}=this.viewModel,n=e.fieldName,s=e.label||n,a=r?r[n]==null?"":r[n]:"",o=!(!e.format||!e.format.dateFormat),l=typeof a=="number"&&!o?this._forceLTR(a):Hue(this.messagesURIUtils,a),c={[Zv.fieldDataDate]:o};return N("tr",{key:`fields-element-info-row-${n}-${t}`},N("th",{key:`fields-element-info-row-header-${n}-${t}`,class:Zv.fieldHeader,innerHTML:s}),N("td",{key:`fields-element-info-row-data-${n}-${t}`,class:this.classes(Zv.fieldData,c),innerHTML:l}))}renderFields(){const{formattedFieldInfos:e}=this.viewModel;return e!=null&&e.length?N("table",{class:Zv.esriTable,summary:this.messages.fieldsSummary},N("tbody",null,e.map((t,r)=>this.renderFieldInfo(t,r)))):null}render(){var e;return N("div",{class:Zv.base},(e=this._featureElementInfo)==null?void 0:e.render(),this.renderFields())}_setupFeatureElementInfo(){const{description:e,title:t}=this;this._featureElementInfo.set({description:e,title:t})}_forceLTR(e){return`&lrm;${e}`}};h([p()],nc.prototype,"attributes",null),h([p()],nc.prototype,"description",null),h([p()],nc.prototype,"expressionInfos",null),h([p()],nc.prototype,"fieldInfos",null),h([p()],nc.prototype,"title",null),h([p({type:mP,nonNullable:!0})],nc.prototype,"viewModel",void 0),h([p(),_n("esri/widgets/Feature/t9n/Feature")],nc.prototype,"messages",void 0),h([p(),_n("esri/widgets/support/t9n/uriUtils")],nc.prototype,"messagesURIUtils",void 0),nc=h([F("esri.widgets.Feature.FeatureFields")],nc);const _W=nc,jue={maximumFractionDigits:20};function que(i){return MR(i,jue)}const Wue="<",Xue=">",Que=eG("short-date");function Zue(i,e,t,r){let n="";e===0?n=`${Wue} `:e===t&&(n=`${Xue} `);let s=null;return s=r?zE(i,Que):que(i),n+s}const Yue=new ti([64,64,64]);function Kue(i,e){const t=[],r=i.length-1;return i.length===5?t.push(0,2,4):t.push(0,r),i.map((n,s)=>t.includes(s)?Zue(n,s,r,e):null)}async function Jue(i,e,t){let r=!1,n=[],s=[];if(i.stops){const c=i.stops;n=c.map(u=>u.value),r=c.some(u=>!!u.label),r&&(s=c.map(u=>u.label))}const a=n[0],o=n[n.length-1];if(a==null&&o==null)return null;const l=r?null:Kue(n,t);return(await Promise.all(n.map(async(c,u)=>({value:c,color:i.type==="opacity"?await ede(c,i,e):(await j(()=>import("./UniqueValueRenderer-08f8851c.js").then(d=>d.v),["assets/UniqueValueRenderer-08f8851c.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/enumeration-3a03bd31.js","assets/jsonMap-7b8332c9.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/geometry-b7901087.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/locale-30120714.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/Clonable-545593ce.js","assets/LegendOptions-010d0873.js","assets/reactiveUtils-4dabbb80.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/number-27cf8195.js","assets/Identifiable-bfe1ff30.js","assets/jsonUtils-229211af.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js"])).getColor(i,c),label:r?s[u]:l[u]})))).reverse()}async function ede(i,e,t=Yue){const r=new ti(t),n=(await j(()=>import("./UniqueValueRenderer-08f8851c.js").then(s=>s.v),["assets/UniqueValueRenderer-08f8851c.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/enumeration-3a03bd31.js","assets/jsonMap-7b8332c9.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/geometry-b7901087.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/locale-30120714.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/Clonable-545593ce.js","assets/LegendOptions-010d0873.js","assets/reactiveUtils-4dabbb80.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/number-27cf8195.js","assets/Identifiable-bfe1ff30.js","assets/jsonUtils-229211af.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js"])).getOpacity(e,i);return n!=null&&(r.a=n),r}function tde(i){if(!i.colorStops)return[];const e=[...i.colorStops].filter(r=>{var n;return((n=r.color)==null?void 0:n.a)>0});let t=e.length-1;if(e&&e[0]){const r=e[t];r&&r.ratio!==1&&(e.push(new $ie({ratio:1,color:r.color})),t++)}return e.map((r,n)=>{var a,o;let s="";return n===0?s=((a=i.legendOptions)==null?void 0:a.minLabel)||"low":n===t&&(s=((o=i.legendOptions)==null?void 0:o.maxLabel)||"high"),{color:r.color,label:s,ratio:r.ratio}}).reverse()}ee.getLogger("esri.renderers.support.utils");async function To(i,e,t){Fte(i,e,()=>[]).push(...t)}async function ide(i){var t,r;const e=new Map;if(!i)return e;if("visualVariables"in i&&i.visualVariables){const n=i.visualVariables.filter(s=>s.type==="color");for(const s of n){const a=(await Jue(s)).map(o=>o.color);await To(e,s.field||s.valueExpression,a)}}if(i.type==="heatmap"){const n=tde(i).map(s=>s.color);await To(e,i.field||i.valueExpression,n)}else if(i.type==="pie-chart"){for(const n of i.attributes)await To(e,n.field||n.valueExpression,[n.color]);await To(e,"default",[(t=i==null?void 0:i.othersCategory)==null?void 0:t.color,x_(i.backgroundFillSymbol,null)])}else if(i.type==="dot-density"){for(const n of i.attributes)await To(e,n.field||n.valueExpression,[n.color]);await To(e,"default",[i.backgroundColor])}else if(i.type==="unique-value")if(((r=i.authoringInfo)==null?void 0:r.type)==="predominance")for(const n of i.uniqueValueInfos??[])await To(e,n.value.toString(),[x_(n.symbol,null)]);else{const n=(i.uniqueValueInfos??[]).map(c=>x_(c.symbol,null)),{field:s,field2:a,field3:o,valueExpression:l}=i;(s||l)&&await To(e,s||l,n),a&&await To(e,a,n),o&&await To(e,o,n)}else if(i.type==="class-breaks"){const n=i.classBreakInfos.map(o=>x_(o.symbol,null)),{field:s,valueExpression:a}=i;await To(e,s??a,n)}else i.type==="simple"&&await To(e,"default",[x_(i.symbol,null)]);return"defaultSymbol"in i&&i.defaultSymbol&&await To(e,"default",[x_(i.defaultSymbol,null)]),e.forEach((n,s)=>{const a=$x(n.filter(Boolean),(o,l)=>JSON.stringify(o)===JSON.stringify(l));e.set(s,a)}),e}const rde="esri.widgets.Feature.support.relatedFeatureUtils",W9=ee.getLogger(rde),X9=new Map;function YL(i){if(!ld(i))return null;const[e,t]=i.split("/").slice(1);return{layerId:e,fieldName:t}}function nde(i,e){if(!e.relationships)return null;let t=null;const{relationships:r}=e;return r.some(n=>n.id===parseInt(i,10)&&(t=n,!0)),t}function sde({originRelationship:i,relationships:e,layerId:t}){let r;return e&&e.some(n=>(`${n.relatedTableId}`===t&&n.id===i.id&&(r=n),!!r)),r}function ade(i,e){const t=e.toLowerCase();for(const r in i)if(r.toLowerCase()===t)return i[r];return null}function ode(i,e){const t=nde(i,e);if(t)return{url:`${e.url}/${t.relatedTableId}`,sourceSpatialReference:e.spatialReference,relation:t,relatedFields:[],outStatistics:[]}}function lde(i,e){if(!e||!i)return;const{features:t,statsFeatures:r}=i,n=t&&t.value;e.relatedFeatures=n?n.features:[];const s=r&&r.value;e.relatedStatsFeatures=s?s.features:[]}function cde(i,e,t,r){const n=new bI;return n.outFields=["*"],n.relationshipId=typeof e.id=="number"?e.id:parseInt(e.id,10),n.objectIds=[i.attributes[t.objectIdField]],t.queryRelatedFeatures(n,r)}function hde(i,e,t){let r=0;const n=[];for(;r<e.length;)n.push(`${i} IN (${e.slice(r,t+r)})`),r+=t;return n.join(" OR ")}async function ude(i,e,t,r){const n=t.layerId.toString(),{layerInfo:s,relation:a,relatedFields:o,outStatistics:l,url:c,sourceSpatialReference:u}=e,d=sde({originRelationship:a,relationships:s.relationships,layerId:n});if(d.relationshipTableId&&d.keyFieldInRelationshipTable){const f=(await cde(i,d,t,r))[i.attributes[t.objectIdField]];if(!f)return null;const _=f.features.map(g=>g.attributes[s.objectIdField]);if((l==null?void 0:l.length)>0&&s.supportsStatistics){const g=new $b;g.where=hde(s.objectIdField,_,1e3),g.outFields=o,g.outStatistics=l,g.sourceSpatialReference=u;const w={features:Promise.resolve(f),statsFeatures:hA(c,g)};return Yo(w)}}const m=d==null?void 0:d.keyField;if(m){const f=mie(gde(s.fields,m)),_=ade(i.attributes,a.keyField),g=f?`${m}=${_}`:`${m}='${_}'`,w=hA(c,new $b({where:g,outFields:e.relatedFields,sourceSpatialReference:u}),r),v=e.outStatistics&&e.outStatistics.length>0&&s.supportsStatistics?hA(c,new $b({where:g,outFields:e.relatedFields,outStatistics:e.outStatistics,sourceSpatialReference:u}),r):null,b={features:w};return v&&(b.statsFeatures=v),Yo(b)}return null}function dde(i,e){return Wh(i,{query:{f:"json"},signal:e&&e.signal})}function pde({relatedInfos:i,layer:e},t){const r={};return i.forEach((n,s)=>{const{relation:a}=n;if(!a){const d=new J("relation-required","A relation is required on a layer to retrieve related records.");throw W9.error(d),d}const{relatedTableId:o}=a;if(typeof o!="number"){const d=new J("A related table ID is required on a layer to retrieve related records.");throw W9.error(d),d}const l=`${e.url}/${o}`,c=X9.get(l),u=c||dde(l,t);c||X9.set(l,u),r[s]=u}),Yo(r)}function mde({graphic:i,relatedInfos:e,layer:t},r){const n={};return e.forEach((s,a)=>{s.layerInfo&&(n[a]=ude(i,s,t,r))}),Yo(n)}function fde({relatedInfo:i,fieldName:e,fieldInfo:t}){if(i.relatedFields.push(e),t.statisticType){const r=new Uie({statisticType:t.statisticType,onStatisticField:e,outStatisticFieldName:e});i.outStatistics.push(r)}}function gde(i,e){if(i!=null){e=e.toLowerCase();for(const t of i)if(t&&t.name.toLowerCase()===e)return t}return null}const Q9={chartAnimation:!0};let En=class extends pe{constructor(e){super(e),this.abilities={...Q9},this.activeMediaInfoIndex=0,this.attributes=null,this.description=null,this.fieldInfoMap=null,this.formattedAttributes=null,this.expressionAttributes=null,this.layer=null,this.mediaInfos=null,this.popupTemplate=null,this.relatedInfos=null,this.title=null}castAbilities(e){return{...Q9,...e}}get activeMediaInfo(){return this.formattedMediaInfos[this.activeMediaInfoIndex]||null}get formattedMediaInfos(){return this._formatMediaInfos()||[]}get formattedMediaInfoCount(){return this.formattedMediaInfos.length}setActiveMedia(e){this._setContentElementMedia(e)}next(){this._pageContentElementMedia(1)}previous(){this._pageContentElementMedia(-1)}_setContentElementMedia(e){const{formattedMediaInfoCount:t}=this,r=(e+t)%t;this.activeMediaInfoIndex=r}_pageContentElementMedia(e){const{activeMediaInfoIndex:t}=this,r=t+e;this._setContentElementMedia(r)}_formatMediaInfos(){const{attributes:e,mediaInfos:t,formattedAttributes:r,expressionAttributes:n,fieldInfoMap:s,layer:a}=this;return t==null?void 0:t.map(o=>{const l=o==null?void 0:o.clone();if(!l)return null;if(l.title=ag({attributes:e,fieldInfoMap:s,globalAttributes:r,expressionAttributes:n,layer:a,text:l.title}),l.caption=ag({attributes:e,fieldInfoMap:s,globalAttributes:r,expressionAttributes:n,layer:a,text:l.caption}),l.altText=ag({attributes:e,fieldInfoMap:s,globalAttributes:r,expressionAttributes:n,layer:a,text:l.altText}),l.type==="image"){const{value:c}=l;return this._setImageValue({value:c,formattedAttributes:r,layer:a}),l.value.sourceURL?l:void 0}if(l.type==="pie-chart"||l.type==="line-chart"||l.type==="column-chart"||l.type==="bar-chart"){const{value:c}=l;return this._setChartValue({value:c,chartType:l.type,attributes:e,formattedAttributes:r,layer:a,expressionAttributes:n}),l}return null}).filter(Boolean)}_setImageValue(e){const{fieldInfoMap:t}=this,{value:r,formattedAttributes:n,layer:s}=e,{linkURL:a,sourceURL:o}=r;if(o){const l=ZL(o,s);r.sourceURL=QL({formattedAttributes:n,template:l,fieldInfoMap:t})}if(a){const l=ZL(a,s);r.linkURL=QL({formattedAttributes:n,template:l,fieldInfoMap:t})}}_setChartValue(e){const{value:t,attributes:r,formattedAttributes:n,chartType:s,layer:a,expressionAttributes:o}=e,{popupTemplate:l,relatedInfos:c}=this,{fields:u,normalizeField:d}=t;if(t.fields=oue(u,a),d&&(t.normalizeField=ex(d,a)),!u.some(f=>!!(n[f]!=null||ld(f)&&c.size)))return;const m=l==null?void 0:l.fieldInfos;u.forEach(f=>{if(ld(f))return void(t.series=[...t.series,...this._getRelatedChartInfos({fieldInfos:m,fieldName:f,formattedAttributes:n,chartType:s,value:t})]);const _=this._getChartOption({value:t,attributes:r,chartType:s,formattedAttributes:n,expressionAttributes:o,fieldName:f,fieldInfos:m});t.series.push(_)})}_getRelatedChartInfos(e){var g;const{fieldInfos:t,fieldName:r,formattedAttributes:n,chartType:s,value:a}=e,o=[],l=YL(r),{layerId:c,fieldName:u}=l,d=(g=this.relatedInfos)==null?void 0:g.get(c.toString());if(!d)return o;const{relatedFeatures:m,relation:f}=d;if(!f||!m)return o;const{cardinality:_}=f;return m.forEach(w=>{const{attributes:v}=w;v&&Object.keys(v).forEach(b=>{b===u&&o.push(this._getChartOption({value:a,attributes:v,formattedAttributes:n,fieldName:r,chartType:s,relatedFieldName:b,fieldInfos:t}))})}),_==="one-to-many"||_==="many-to-many"?o:[o[0]]}_getTooltip({label:e,value:t,chartType:r}){return r==="pie-chart"?`${e}`:`${e}: ${t}`}_getChartOption(e){var R;const{value:t,attributes:r,formattedAttributes:n,expressionAttributes:s,fieldName:a,relatedFieldName:o,fieldInfos:l,chartType:c}=e,{layer:u,fieldInfoMap:d}=this,{normalizeField:m,tooltipField:f}=t,_=m?ld(m)?r[YL(m).fieldName]:r[m]:null,g=rN(a)&&s&&s[a]!==void 0?s[a]:o&&r[o]!==void 0?r[o]:r[a]!==void 0?r[a]:n[a],w=new _ie({fieldName:a,value:g===void 0?null:g&&_?g/_:g});if(ld(a)){const E=d.get(a.toLowerCase()),O=d.get(f.toLowerCase()),$=(E==null?void 0:E.fieldName)??a,D=n[(O==null?void 0:O.fieldName)??f]??(E==null?void 0:E.label)??(E==null?void 0:E.fieldName)??o,I=n[$];return w.tooltip=this._getTooltip({label:D,value:I,chartType:c}),w}const v=dW(l,a),b=ex(a,u),x=f&&n[f]!==void 0?n[f]:hW(v||new tG({fieldName:b}),(R=this.popupTemplate)==null?void 0:R.expressionInfos),T=n[b];return w.tooltip=this._getTooltip({label:x,value:T,chartType:c}),w}};h([p()],En.prototype,"abilities",void 0),h([qr("abilities")],En.prototype,"castAbilities",null),h([p()],En.prototype,"activeMediaInfoIndex",void 0),h([p({readOnly:!0})],En.prototype,"activeMediaInfo",null),h([p()],En.prototype,"attributes",void 0),h([p()],En.prototype,"description",void 0),h([p()],En.prototype,"fieldInfoMap",void 0),h([p()],En.prototype,"formattedAttributes",void 0),h([p()],En.prototype,"expressionAttributes",void 0),h([p({readOnly:!0})],En.prototype,"formattedMediaInfos",null),h([p()],En.prototype,"layer",void 0),h([p({readOnly:!0})],En.prototype,"formattedMediaInfoCount",null),h([p()],En.prototype,"mediaInfos",void 0),h([p()],En.prototype,"popupTemplate",void 0),h([p()],En.prototype,"relatedInfos",void 0),h([p()],En.prototype,"title",void 0),En=h([F("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")],En);const og=En;var Z9=["#ffffff","#858585","#ffbebe","#ffebbe","#ffebaf","#ffffbe","#e9ffbe","#d3ffbe","#beffe8","#bee8ff","#bed2ff","#e8beff","#ffbee8","#ebebeb","#707070","#ff7f7f","#ffa77f","#ffd37f","#ffff73","#d1ff73","#a3ff73","#73ffdf","#73dfff","#73b2ff","#df73ff","#ff73df","#d6d6d6","#5c5c5c","#ff0000","#ff5500","#ffaa00","#ffff00","#aaff00","#55ff00","#00ffc5","#00c5ff","#0070ff","#c500ff","#ff00c5","#c2c2c2","#474747","#e60000","#e64c00","#e69800","#e6e600","#98e600","#4ce600","#00e6a9","#00a9e6","#005ce6","#a900e6","#e600a9","#adadad","#242424","#a80000","#a83800","#a87000","#a8a800","#70a800","#38a800","#00a884","#0084a8","#004da8","#8400a8","#a80084","#999999","#1a1a1a","#730000","#732600","#734c00","#737300","#4c7300","#267300","#00734c","#004c73","#002673","#4c0073","#73004"],_de=[].concat(Z9.slice(30,39),Z9.slice(28,30).reverse()),yde=[{name:"default",colors:_de},{name:"cat-dark",colors:["#ed5151","#149ece","#a7c636","#9e559c","#fc921f","#ffde3e","#f789d8","#b7814a","#3caf99","#6b6bd6","#b54779","#7f7f7f"]},{name:"tropical-bliss",colors:["#fce138","#ff9399","#fcd27e","#f1983c","#a553b7","#b1a9d0","#6ecffc","#4c81cd","#fc6f84","#fc3e5a","#6af689","#48885c"]},{name:"desert-blooms",colors:["#102432","#144d59","#ffc730","#ed9310","#a64f1b","#661510","#d9351a","#b31515","#4a0932","#8c213f","#18382e","#2c6954"]},{name:"under-the-sea",colors:["#bf9727","#607100","#00734c","#704489","#01acca","#024e76","#f09100","#ea311f","#c6004b","#7570b3","#666666","#333333"]},{name:"vibrant-rainbow",colors:["#fffb00","#f5cb11","#9fd40c","#46e39c","#32b8a6","#7ff2fa","#ac08cc","#dd33ff","#eb7200","#e8a784","#bf2e2e","#6c7000"]},{name:"ocean-bay",colors:["#191921","#11495c","#78b1c2","#454f4b","#8f8f82","#9be0c0","#87b051","#f7ec88","#ebdcc1","#dbb658","#c43541","#75351e"]},{name:"prairie-summer",colors:["#332424","#751555","#d47013","#d68989","#211173","#82aad6","#7bfaeb","#6ec9a8","#6b6408","#eada40","#ccc54a","#1fc235"]},{name:"pastel-chalk",colors:["#fffd99","#f5e6a4","#c1d48c","#b8e3d0","#a0b8b5","#cbf7fa","#d791f2","#dfc1eb","#f2b983","#e8c4b2","#bf8e8e","#94995c"]},{name:"seq-yellow-orange-red-bright",colors:["#910000","#b1260b","#c0370f","#e05919","#ef6a1d","#ff7b22","#ffa143","#ffb454","#ffda74","#ffed85"]},{name:"seq-reds-bright",colors:["#57453b","#7b4238","#9f4036","#c23d33","#d7483c","#ec5244","#f3696c","#f9816c","#ffc4ae","#fff0dc"]},{name:"seq-purples-bright",colors:["#4e465c","#5a4a78","#695291","#775baa","#8663c3","#946bdc","#aa89e8","#c1a6f3","#d7c4ff","#e6e1ff"]},{name:"seq-blues-bright",colors:["#404d54","#435c6c","#48799d","#4b88b6","#4d96ce","#50a5e7","#74bbed","#98d0f3","#bce6f9","#e6faff"]},{name:"seq-greens-bright",colors:["#39544c","#386757","#368165","#359b73","#33b581","#4bc392","#64d2a2","#7ce0b3","#cbf6d9","#f4ffea"]},{name:"seq-browns-bright",colors:["#524834","#715b38","#8f6e3c","#ae8140","#cc9444","#eba748","#eeb664","#f0c47f","#f9e0b7","#fff8eb"]}];const Y9="en-us",cN=new Map([["ar",()=>j(()=>import("./ar-7e4d7001.js"),["assets/ar-7e4d7001.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.a)],["bg-bg",()=>j(()=>import("./bg_BG-fa0eaeae.js"),["assets/bg_BG-fa0eaeae.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.b)],["bs-ba",()=>j(()=>import("./bs_BA-4f949e9b.js"),["assets/bs_BA-4f949e9b.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.b)],["ca-es",()=>j(()=>import("./ca_ES-ac250c21.js"),["assets/ca_ES-ac250c21.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.c)],["cs-cz",()=>j(()=>import("./cs_CZ-41aa2dde.js"),["assets/cs_CZ-41aa2dde.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.c)],["da-dk",()=>j(()=>import("./da_DK-3cc83778.js"),["assets/da_DK-3cc83778.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.d)],["de-de",()=>j(()=>import("./de_DE-7cf156b8.js"),["assets/de_DE-7cf156b8.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.d)],["de-ch",()=>j(()=>import("./de_CH-b40119c2.js"),["assets/de_CH-b40119c2.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.d)],["el-gr",()=>j(()=>import("./el_GR-f5b4e421.js"),["assets/el_GR-f5b4e421.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.e)],["en-us",()=>j(()=>import("./en_US-b653138f.js"),["assets/en_US-b653138f.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.e)],["en-ca",()=>j(()=>import("./en_CA-b653138f.js"),["assets/en_CA-b653138f.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.e)],["es-es",()=>j(()=>import("./es_ES-21713ea8.js"),["assets/es_ES-21713ea8.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.e)],["et-ee",()=>j(()=>import("./et_EE-7e4a5525.js"),["assets/et_EE-7e4a5525.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.e)],["fi-fi",()=>j(()=>import("./fi_FI-9ff24319.js"),["assets/fi_FI-9ff24319.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.f)],["fr-fr",()=>j(()=>import("./fr_FR-51c37695.js"),["assets/fr_FR-51c37695.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.f)],["he-il",()=>j(()=>import("./he_IL-5c441159.js"),["assets/he_IL-5c441159.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.h)],["hr-hr",()=>j(()=>import("./hr_HR-f42ffa87.js"),["assets/hr_HR-f42ffa87.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.h)],["hu-hu",()=>j(()=>import("./hu_HU-5fba6ab9.js"),["assets/hu_HU-5fba6ab9.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.h)],["id-id",()=>j(()=>import("./id_ID-981fbb86.js"),["assets/id_ID-981fbb86.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.i)],["it-it",()=>j(()=>import("./it_IT-c635b784.js"),["assets/it_IT-c635b784.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.i)],["ja-jp",()=>j(()=>import("./ja_JP-e2cf7b21.js"),["assets/ja_JP-e2cf7b21.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.j)],["ko-kr",()=>j(()=>import("./ko_KR-32aae4f2.js"),["assets/ko_KR-32aae4f2.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.k)],["lt-lt",()=>j(()=>import("./lt_LT-3c0b9d54.js"),["assets/lt_LT-3c0b9d54.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.l)],["lv-lv",()=>j(()=>import("./lv_LV-c1cc4a4c.js"),["assets/lv_LV-c1cc4a4c.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.l)],["nb-no",()=>j(()=>import("./nb_NO-5958d98d.js"),["assets/nb_NO-5958d98d.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.n)],["nl-nl",()=>j(()=>import("./nl_NL-004b20fd.js"),["assets/nl_NL-004b20fd.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.n)],["pl-pl",()=>j(()=>import("./pl_PL-d6d01c5e.js"),["assets/pl_PL-d6d01c5e.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.p)],["pt-br",()=>j(()=>import("./pt_BR-a08a6ce1.js"),["assets/pt_BR-a08a6ce1.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.p)],["pt-pt",()=>j(()=>import("./pt_PT-d532c840.js"),["assets/pt_PT-d532c840.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.p)],["ro-ro",()=>j(()=>import("./ro_RO-e4007f77.js"),["assets/ro_RO-e4007f77.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.r)],["ru-ru",()=>j(()=>import("./ru_RU-905ac2e8.js"),["assets/ru_RU-905ac2e8.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.r)],["sk-sk",()=>j(()=>import("./sk_SK-cae815ce.js"),["assets/sk_SK-cae815ce.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.s)],["sl-sl",()=>j(()=>import("./sl_SL-50353bbe.js"),["assets/sl_SL-50353bbe.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.s)],["sr-rs",()=>j(()=>import("./sr_RS-9a9b8450.js"),["assets/sr_RS-9a9b8450.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.s)],["sv-se",()=>j(()=>import("./sv_SE-346c1643.js"),["assets/sv_SE-346c1643.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.s)],["th-th",()=>j(()=>import("./th_TH-210af5ed.js"),["assets/th_TH-210af5ed.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.t)],["tr-tr",()=>j(()=>import("./tr_TR-855c517f.js"),["assets/tr_TR-855c517f.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.t)],["uk-ua",()=>j(()=>import("./uk_UA-7de21af4.js"),["assets/uk_UA-7de21af4.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.u)],["vi-vn",()=>j(()=>import("./vi_VN-f87f03fa.js"),["assets/vi_VN-f87f03fa.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.v)],["zh-cn",()=>j(()=>import("./zh_Hans-79f10982.js"),["assets/zh_Hans-79f10982.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.z)],["zh-hk",()=>j(()=>import("./zh_Hant-abc409cd.js"),["assets/zh_Hant-abc409cd.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.z)],["zh-tw",()=>j(()=>import("./zh_Hant-abc409cd.js"),["assets/zh_Hant-abc409cd.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.z)]]);function vde(i){const e=i.split("-")[0].toLowerCase();let t=null;for(const r of cN.keys())if(r.startsWith(e)){t=r;break}return t}function bde(i){return i?cN.has(i.toLowerCase())?i.toLowerCase():vde(i)||Y9:Y9}let E_,Yv;async function wde(i=Yie()){if(i=bde(i),E_&&i===Yv)return E_;E_=j(()=>import("./index-3c8f1bc3.js"),["assets/index-3c8f1bc3.js","assets/_commonjsHelpers-a430e9ea.js"]).then(e=>e.i),Yv=i;try{const[e,t]=await Promise.all([E_,cN.get(Yv)()]);Yv===i&&(e.am4core.options.defaultLocale=t.default),e.am4core.options.suppressWarnings=!0,e.am4core.options.autoDispose=!0}catch{return E_=null,Yv=null,null}return E_}function xde(i,e="default"){const t=yde.find(r=>r.name===e);return t?t.colors.map(r=>i.color(r)):null}const xr={base:"esri-feature-media",mediaContainer:"esri-feature-media__container",mediaItemContainer:"esri-feature-media__item-container",mediaItem:"esri-feature-media__item",mediaItemTitle:"esri-feature-media__item-title",mediaItemCaption:"esri-feature-media__item-caption",mediaPrevious:"esri-feature-media__previous",mediaPreviousIconLTR:"esri-feature-media__previous-icon",mediaPreviousIconRTL:"esri-feature-media__previous-icon--rtl",mediaNext:"esri-feature-media__next",mediaNextIconLTR:"esri-feature-media__next-icon",mediaNextIconRTL:"esri-feature-media__next-icon--rtl",mediaChart:"esri-feature-media__chart",mediaButton:"esri-feature-media__button",mediaIcon:"esri-feature-media__icon",iconLeftTriangleArrow:"esri-icon-left-triangle-arrow",iconRightTriangleArrow:"esri-icon-right-triangle-arrow"},eO=.05,tO=.95,iO=15,fu="color",Xd="tooltip",Kv="value",K9="default-line-value";let ja=class extends Hn{constructor(e,t){super(e,t),this._refreshTimer=null,this._refreshIntervalInfo=null,this._featureElementInfo=null,this.viewModel=new og,this.messages=null,this._getChartDependencies=async r=>{const n=await wde(),{destroyed:s,viewModel:a}=this;if(s||!a||!r)return;const{activeMediaInfo:o}=a,l=await this._getRendererColors(n);this._renderChart({chartDiv:r,mediaInfo:o,chartsModule:n,colorMap:l})}}initialize(){this._featureElementInfo=new pP,this.addHandles([B(()=>{var e,t;return[(e=this.viewModel)==null?void 0:e.activeMediaInfo,(t=this.viewModel)==null?void 0:t.activeMediaInfoIndex]},()=>this._setupMediaRefreshTimer(),et),B(()=>{var e,t;return[(e=this.viewModel)==null?void 0:e.description,(t=this.viewModel)==null?void 0:t.title]},()=>this._setupFeatureElementInfo(),et)])}destroy(){this._clearMediaRefreshTimer(),this._featureElementInfo.destroy()}get attributes(){return this.viewModel.attributes}set attributes(e){this.viewModel.attributes=e}get activeMediaInfoIndex(){return this.viewModel.activeMediaInfoIndex}set activeMediaInfoIndex(e){this.viewModel.activeMediaInfoIndex=e}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get fieldInfoMap(){return this.viewModel.fieldInfoMap}set fieldInfoMap(e){this.viewModel.fieldInfoMap=e}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}get mediaInfos(){return this.viewModel.mediaInfos}set mediaInfos(e){this.viewModel.mediaInfos=e}get popupTemplate(){return this.viewModel.popupTemplate}set popupTemplate(e){this.viewModel.popupTemplate=e}get relatedInfos(){return this.viewModel.relatedInfos}set relatedInfos(e){this.viewModel.relatedInfos=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}render(){var e;return N("div",{bind:this,class:xr.base,onkeyup:this._handleMediaKeyup},(e=this._featureElementInfo)==null?void 0:e.render(),this.renderMedia())}renderMedia(){const{formattedMediaInfoCount:e}=this.viewModel;return e?N("div",{key:"media-element-container",class:xr.mediaContainer},this.renderMediaPageButton("previous"),this.renderMediaInfo(),this.renderMediaPageButton("next")):null}renderImageMediaInfo(e){const{_refreshIntervalInfo:t}=this,{activeMediaInfoIndex:r,formattedMediaInfoCount:n}=this.viewModel,{value:s,refreshInterval:a,altText:o,title:l,type:c}=e,{sourceURL:u,linkURL:d}=s,m=cW(d)?"_blank":"_self",f=m==="_blank"?"noreferrer":"",_=a?t:null,g=_?_.timestamp:0,w=_?_.sourceURL:u,v=N("img",{alt:o||l,key:`media-${c}-${r}-${n}-${g}`,src:w});return(d?N("a",{title:l,href:d,rel:f,target:m},v):null)||v}renderChartMediaInfo(e){const{activeMediaInfoIndex:t,formattedMediaInfoCount:r}=this.viewModel;return N("div",{key:`media-${e.type}-${t}-${r}`,bind:this,class:xr.mediaChart,afterCreate:this._getChartDependencies})}renderMediaInfoType(){const{activeMediaInfo:e}=this.viewModel;return e?e.type==="image"?this.renderImageMediaInfo(e):e.type.includes("chart")?this.renderChartMediaInfo(e):null:null}renderMediaInfo(){const{activeMediaInfo:e}=this.viewModel;if(!e)return null;const t=e.title?N("div",{key:"media-title",class:xr.mediaItemTitle,innerHTML:e.title}):null,r=e.caption?N("div",{key:"media-caption",class:xr.mediaItemCaption,innerHTML:e.caption}):null;return N("div",{key:"media-container",class:xr.mediaItemContainer},N("div",{key:"media-item-container",class:xr.mediaItem},this.renderMediaInfoType()),t,r)}renderMediaPageButton(e){if(this.viewModel.formattedMediaInfoCount<2)return null;const t=e==="previous",r=t?this.messages.previous:this.messages.next,n=t?this.classes(xr.mediaButton,xr.mediaPrevious):this.classes(xr.mediaButton,xr.mediaNext),s=t?this.classes(xr.mediaIcon,xr.mediaPreviousIconLTR,xr.iconLeftTriangleArrow):this.classes(xr.mediaIcon,xr.mediaNextIconLTR,xr.iconRightTriangleArrow),a=t?this.classes(xr.mediaIcon,xr.mediaPreviousIconRTL,xr.iconRightTriangleArrow):this.classes(xr.mediaIcon,xr.mediaNextIconRTL,xr.iconLeftTriangleArrow),o=t?"media-previous":"media-next",l=t?this._previous:this._next;return N("button",{type:"button",key:o,title:r,"aria-label":r,tabIndex:0,class:n,bind:this,onclick:l},N("span",{"aria-hidden":"true",class:s}),N("span",{"aria-hidden":"true",class:a}))}_setupFeatureElementInfo(){const{description:e,title:t}=this;this._featureElementInfo.set({description:e,title:t})}_next(){this.viewModel.next()}_previous(){this.viewModel.previous()}async _getRendererColors(e){var o,l;const{am4core:t}=e,r=new Map,n=(l=(o=this.viewModel)==null?void 0:o.layer)==null?void 0:l.renderer,s="default";if(!n)return r;const a=await ide(n);return a.delete(s),Array.from(a.values()).every(c=>(c==null?void 0:c.length)===1)&&(r.set(K9,t.color({r:50,g:50,b:50,a:1})),Array.from(a.keys()).forEach(c=>{c&&r.set(c,t.color(a.get(c)[0].toCss(!0)))})),r}_handleMediaKeyup(e){const t=Ol(e);t==="ArrowLeft"&&(e.stopPropagation(),this.viewModel.previous()),t==="ArrowRight"&&(e.stopPropagation(),this.viewModel.next())}_renderChart(e){const{abilities:t}=this.viewModel,{chartsModule:r,chartDiv:n,mediaInfo:s,colorMap:a}=e,{value:o,type:l}=s,{am4core:c}=r,u=xde(c);function d(_){_ instanceof c.ColorSet&&u&&(_.list=u)}A2()&&c.useTheme(r.am4themes_dark);const m=window.matchMedia("(prefers-reduced-motion: reduce)");t.chartAnimation&&!m.matches?c.useTheme(r.am4themes_animated):c.unuseTheme(r.am4themes_animated),c.useTheme(d);const f=l==="pie-chart"?this._createPieChart(e):this._createXYChart(e);n.setAttribute("aria-label",s.altText||s.title),f.data=o.series.map(_=>({[Xd]:_.tooltip,[Kv]:_.value,[fu]:a.get(_.fieldName)})).filter(_=>l!=="pie-chart"||_.value>0)}_customizeChartTooltip(e,t){e.label.wrap=!0,e.label.maxWidth=200,e.autoTextColor=!1,e.getFillFromObject=!1,e.label.fill=t.color("#ffffff"),e.background.fill=t.color({r:0,g:0,b:0,a:.7})}_createPieChart(e){const{chartDiv:t,chartsModule:r}=e,{am4core:n,am4charts:s}=r,a=n.create(t,s.PieChart);a.rtl=zh(this.container);const o=a.series.push(new s.PieSeries);return o.labels.template.disabled=!0,o.ticks.template.disabled=!0,o.dataFields.value=Kv,o.dataFields.category=Xd,this._customizeChartTooltip(o.tooltip,n),o.slices.template.propertyFields.fill=fu,o.slices.template.propertyFields.stroke=fu,a}_getMinSeriesValue(e){let t=0;return e.forEach(r=>t=Math.min(r.value,t)),t}_createColumnChart(e,t){const{chartsModule:r,mediaInfo:n}=t,{value:s}=n,{am4core:a,am4charts:o}=r,l=e.xAxes.push(new o.CategoryAxis);l.dataFields.category=Xd,l.renderer.labels.template.disabled=!0,this._customizeChartTooltip(l.tooltip,a),l.tooltip.events.on("sizechanged",()=>{l.tooltip.dy=-l.tooltip.contentHeight});const c=e.yAxes.push(new o.ValueAxis),u=c.renderer.labels.template;c.renderer.minLabelPosition=eO,c.renderer.maxLabelPosition=tO,c.min=this._getMinSeriesValue(s.series),this._customizeChartTooltip(c.tooltip,a),u.wrap=!0;const d=e.series.push(new o.ColumnSeries);d.dataFields.valueY=Kv,d.dataFields.categoryX=Xd,d.columns.template.propertyFields.fill=fu,d.columns.template.propertyFields.stroke=fu,e.cursor=new o.XYCursor,s.series.length>iO&&(e.scrollbarX=new a.Scrollbar)}_createBarChart(e,t){const{chartsModule:r,mediaInfo:n}=t,{value:s}=n,{am4core:a,am4charts:o}=r,l=e.yAxes.push(new o.CategoryAxis);l.dataFields.category=Xd,l.renderer.inversed=!0,l.renderer.labels.template.disabled=!0,this._customizeChartTooltip(l.tooltip,a),l.tooltip.events.on("sizechanged",()=>{l.tooltip.dx=l.tooltip.contentWidth});const c=e.xAxes.push(new o.ValueAxis),u=c.renderer.labels.template;c.renderer.minLabelPosition=eO,c.renderer.maxLabelPosition=tO,c.min=this._getMinSeriesValue(s.series),this._customizeChartTooltip(c.tooltip,a),u.wrap=!0;const d=e.series.push(new o.ColumnSeries);d.dataFields.valueX=Kv,d.dataFields.categoryY=Xd,d.columns.template.propertyFields.fill=fu,d.columns.template.propertyFields.stroke=fu,e.cursor=new o.XYCursor,s.series.length>iO&&(e.scrollbarY=new a.Scrollbar)}_createLineChart(e,t){const{chartsModule:r,mediaInfo:n,colorMap:s}=t,{value:a}=n,{am4core:o,am4charts:l}=r,c=e.xAxes.push(new l.CategoryAxis);c.dataFields.category=Xd,c.renderer.labels.template.disabled=!0,this._customizeChartTooltip(c.tooltip,o),c.tooltip.events.on("sizechanged",()=>{c.tooltip.dy=-c.tooltip.contentHeight});const u=e.yAxes.push(new l.ValueAxis),d=u.renderer.labels.template;u.renderer.minLabelPosition=eO,u.renderer.maxLabelPosition=tO,u.min=this._getMinSeriesValue(a.series),this._customizeChartTooltip(u.tooltip,o),d.wrap=!0;const m=e.series.push(new l.LineSeries);m.dataFields.categoryX=Xd,m.dataFields.valueY=Kv,m.strokeWidth=1;const f=s.get(K9);f&&(m.stroke=f);const _=m.bullets.push(new l.CircleBullet);_.propertyFields.fill=fu,_.propertyFields.stroke=fu,e.cursor=new l.XYCursor,a.series.length>iO&&(e.scrollbarX=new o.Scrollbar)}_createXYChart(e){const{chartDiv:t,chartsModule:r,mediaInfo:n}=e,{type:s}=n,{am4core:a,am4charts:o}=r,l=a.create(t,o.XYChart);return l.rtl=zh(this.container),s==="column-chart"&&this._createColumnChart(l,e),s==="bar-chart"&&this._createBarChart(l,e),s==="line-chart"&&this._createLineChart(l,e),l}_clearMediaRefreshTimer(){const{_refreshTimer:e}=this;e&&(clearTimeout(e),this._refreshTimer=null)}_updateMediaInfoTimestamp(e){const t=Date.now();this._refreshIntervalInfo={timestamp:t,sourceURL:this._getImageSource(e,t)},this.scheduleRender()}_setupMediaRefreshTimer(){this._clearMediaRefreshTimer();const{activeMediaInfo:e}=this.viewModel;e&&e.type==="image"&&e.refreshInterval&&this._setRefreshTimeout(e)}_setRefreshTimeout(e){const{refreshInterval:t,value:r}=e;if(!t)return;const n=6e4*t;this._updateMediaInfoTimestamp(r.sourceURL);const s=setInterval(()=>{this._updateMediaInfoTimestamp(r.sourceURL)},n);this._refreshTimer=s}_getImageSource(e,t){const r=e.includes("?")?"&":"?",[n,s=""]=e.split("#");return`${n}${r}timestamp=${t}${s?"#":""}${s}`}};h([p()],ja.prototype,"attributes",null),h([p()],ja.prototype,"activeMediaInfoIndex",null),h([p()],ja.prototype,"description",null),h([p()],ja.prototype,"fieldInfoMap",null),h([p()],ja.prototype,"layer",null),h([p()],ja.prototype,"mediaInfos",null),h([p()],ja.prototype,"popupTemplate",null),h([p()],ja.prototype,"relatedInfos",null),h([p()],ja.prototype,"title",null),h([p({type:og})],ja.prototype,"viewModel",void 0),h([p(),_n("esri/widgets/Feature/t9n/Feature")],ja.prototype,"messages",void 0),ja=h([F("esri.widgets.Feature.FeatureMedia")],ja);const yW=ja,Tde=["$datastore","$map","$layer","$aggregatedfeatures"],Cde="esri.widgets.Feature.support.arcadeFeatureUtils",Sde=ee.getLogger(Cde);function Ede(i){return typeof i=="string"?Jx(sN(i)):Array.isArray(i)?Rde(i):(i==null?void 0:i.declaredClass)==="esri.arcade.Dictionary"?Pde(i):i}function Rde(i){return`<ul class="esri-widget__list">${i.map(e=>`<li>${typeof e=="string"?Jx(sN(e)):e}</li>`).join("")}</ul>`}function Pde(i){return`<table class="esri-widget__table">${i.keys().map(e=>{const t=i.field(e);return`<tr><th>${e}</th><td>${typeof t=="string"?Jx(sN(t)):t}</td></tr>`}).join("")}</table>`}function Ade({aggregatedFeatures:i,arcadeUtils:e,featureSetVars:t,context:r,viewInfo:n,map:s,graphic:a,interceptor:o}){t.forEach(l=>{const c=l.toLowerCase(),u={map:s,spatialReference:n.sr,interceptor:o};if(c==="$map"&&(r.vars[c]=e.convertMapToFeatureSetCollection(u)),c==="$layer"&&(r.vars[c]=e.convertFeatureLayerToFeatureSet({layer:a.sourceLayer,spatialReference:n.sr,interceptor:o})),c==="$datastore"&&(r.vars[c]=e.convertServiceUrlToWorkspace({url:a.sourceLayer.url,spatialReference:n.sr,interceptor:o})),c==="$aggregatedfeatures"){const d=a.layer,{fields:m,objectIdField:f,geometryType:_,spatialReference:g,displayField:w}=d,v=new lG({fields:m,objectIdField:f,geometryType:_,spatialReference:g,displayField:w,...d.type==="feature"?{templates:d.templates,typeIdField:d.typeIdField,types:d.types}:null,source:i});r.vars[c]=e.convertFeatureLayerToFeatureSet({layer:v,spatialReference:n.sr,interceptor:o})}})}function vW(){return j(()=>import("./arcadeUtils-e61dca8e.js").then(i=>i.ay),["assets/arcadeUtils-e61dca8e.js","assets/geometry-b7901087.js","assets/ArrayPool-a8ee9378.js","assets/string-a318751c.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/Extent-da876e26.js","assets/cast-fcb46737.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/preload-helper-3bce6601.js","assets/number-8d860409.js","assets/locale-30120714.js","assets/Field-61ec9870.js","assets/enumeration-3a03bd31.js","assets/fieldType-f31285f7.js","assets/jsonUtils-229211af.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/request-6fc81c4c.js","assets/unitUtils-45d1147c.js","assets/hash-0ddfbf4b.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/sizeVariableUtils-d4870b0d.js"])}function Ode(i){return"createQuery"in i&&"queryFeatures"in i}async function Mde({graphic:i,view:e}){const{isAggregate:t,layer:r}=i;if(!t||!r||(e==null?void 0:e.type)!=="2d")return[];const n=await e.whenLayerView(r);if(!Ode(n))return[];const s=n.createQuery();s.aggregateIds=[i.getObjectId()];const{features:a}=await n.queryFeatures(s);return a}async function bW({expressionInfo:i,arcadeUtils:e,interceptor:t,spatialReference:r,map:n,graphic:s,view:a}){if(!i||!i.expression)return null;const o=e.createSyntaxTree(i.expression),l=Tde.filter(f=>e.hasVariable(o,f)),[c]=await Promise.all([Mde({graphic:s,view:a}),e.loadScriptDependencies(o,!0,l)]),u=e.getViewInfo({spatialReference:r}),d=e.createExecContext(s,u);d.interceptor=t,d.useAsync=!0,Ade({aggregatedFeatures:c,arcadeUtils:e,featureSetVars:l,context:d,viewInfo:u,map:n,graphic:s,interceptor:t});const m=e.createFunction(o,d);return e.executeAsyncFunction(m,d).catch(f=>Sde.error("arcade-execution-error",{error:f,graphic:s,expressionInfo:i}))}async function Ide({expressionInfos:i,spatialReference:e,graphic:t,interceptor:r,map:n,view:s}){if(!i||!i.length)return{};const a=await vW(),o={};for(const u of i)o[`expression/${u.name}`]=bW({expressionInfo:u,arcadeUtils:a,interceptor:r,spatialReference:e,map:n,graphic:t,view:s});const l=await Yo(o),c={};for(const u in l)c[u]=Ede(l[u].value);return c}const Lde=1;let Mo=class extends Ux(pe){constructor(e){super(e),this._abortController=null,this.expressionInfo=null,this.graphic=null,this.contentElement=null,this.contentElementViewModel=null,this.interceptor=null,this.view=null,this._cancelQuery=()=>{const{_abortController:t}=this;t&&t.abort(),this._abortController=null},this._createVM=()=>{var n,s;const t=(n=this.contentElement)==null?void 0:n.type;(s=this.contentElementViewModel)==null||s.destroy();const r=t==="fields"?new mP:t==="media"?new og:t==="text"?new P2:null;this._set("contentElementViewModel",r)},this._compile=async()=>{this._cancelQuery();const t=new AbortController;this._abortController=t,await this._compileExpression(),this._abortController===t&&(this._abortController=null)},this._compileThrottled=$0(this._compile,Lde,this),this._compileExpression=async()=>{const{expressionInfo:t,graphic:r,interceptor:n,spatialReference:s,map:a,view:o,_abortController:l}=this;if(!(t&&r&&s&&a))return void this._set("contentElement",null);const c=await vW();if(l!==this._abortController)return;const u=await bW({arcadeUtils:c,expressionInfo:t,graphic:r,interceptor:n,map:a,spatialReference:s,view:o});if(!u||u.declaredClass!=="esri.arcade.Dictionary")return void this._set("contentElement",null);const d=await u.castAsJsonAsync(l.signal),m=d==null?void 0:d.type,f=m==="media"?yie.fromJSON(d):m==="text"?iG.fromJSON(d):m==="fields"?vie.fromJSON(d):null;this._set("contentElement",f)},this.handles.add([B(()=>[this.expressionInfo,this.graphic,this.map,this.spatialReference,this.view],()=>this._compileThrottled(),et),B(()=>[this.contentElement],()=>this._createVM(),et)])}destroy(){var e;this._cancelQuery(),(e=this.contentElementViewModel)==null||e.destroy(),this._set("contentElementViewModel",null),this._set("contentElement",null)}get spatialReference(){var e;return((e=this.view)==null?void 0:e.spatialReference)??null}set spatialReference(e){this._override("spatialReference",e)}get state(){const{_abortController:e,contentElement:t,contentElementViewModel:r}=this;return e?"loading":t||r?"ready":"disabled"}get map(){var e;return((e=this.view)==null?void 0:e.map)??null}set map(e){this._override("map",e)}};h([p()],Mo.prototype,"_abortController",void 0),h([p({type:bie})],Mo.prototype,"expressionInfo",void 0),h([p({type:jc})],Mo.prototype,"graphic",void 0),h([p({readOnly:!0})],Mo.prototype,"contentElement",void 0),h([p({readOnly:!0})],Mo.prototype,"contentElementViewModel",void 0),h([p()],Mo.prototype,"interceptor",void 0),h([p()],Mo.prototype,"spatialReference",null),h([p({readOnly:!0})],Mo.prototype,"state",null),h([p()],Mo.prototype,"map",null),h([p()],Mo.prototype,"view",void 0),Mo=h([F("esri.widgets.Feature.FeatureExpression.FeatureExpressionViewModel")],Mo);const hN=Mo,NT={iconLoading:"esri-icon-loading-indicator esri-rotating",base:"esri-feature-expression",loadingSpinnerContainer:"esri-feature__loading-container",spinner:"esri-feature__loading-spinner"};let GS=class extends Hn{constructor(e,t){super(e,t),this.viewModel=new hN}initialize(){this.addHandles(B(()=>{var e;return(e=this.viewModel)==null?void 0:e.contentElementViewModel},()=>this._setupExpressionWidget(),et))}destroy(){this._destroyContentWidget()}renderLoading(){return N("div",{key:"loading-container",class:NT.loadingSpinnerContainer},N("span",{class:this.classes(NT.iconLoading,NT.spinner)}))}render(){var t;const{state:e}=this.viewModel;return N("div",{class:NT.base},e==="loading"?this.renderLoading():e==="disabled"?null:(t=this._contentWidget)==null?void 0:t.render())}_destroyContentWidget(){const{_contentWidget:e}=this;e&&(e.viewModel=null,e.destroy()),this._contentWidget=null}_setupExpressionWidget(){const{contentElementViewModel:e,contentElement:t}=this.viewModel,r=t==null?void 0:t.type;this._destroyContentWidget();const n=e?r==="fields"?new _W({viewModel:e}):r==="media"?new yW({viewModel:e}):r==="text"?new BS({viewModel:e}):null:null;this._contentWidget=n,this.scheduleRender()}};h([p({type:hN})],GS.prototype,"viewModel",void 0),GS=h([F("esri.widgets.Feature.FeatureExpression")],GS);const $de=GS,rO=100;let qi=class extends au(gD(Ux(pe))){constructor(e){super(e),this._queryAbortController=null,this._queryPageAbortController=null,this._queryFeatureCountAbortController=null,this.featuresPerPage=10,this.description=null,this.graphic=null,this.layer=null,this.map=null,this.orderByFields=null,this.featureCount=0,this.relationshipId=null,this.showAllEnabled=!1,this.title=null,this._cancelQuery=()=>{const{_queryAbortController:t}=this;t&&t.abort(),this._queryAbortController=null},this._cancelQueryFeatureCount=()=>{const{_queryFeatureCountAbortController:t}=this;t&&t.abort(),this._queryFeatureCountAbortController=null},this._cancelQueryPage=()=>{const{_queryPageAbortController:t}=this;t&&t.abort(),this._queryPageAbortController=null},this._queryController=async()=>{this._cancelQuery();const t=new AbortController;this._queryAbortController=t,await Ib(this._query()),this._queryAbortController===t&&(this._queryAbortController=null)},this._queryFeatureCountController=async()=>{this._cancelQueryFeatureCount();const t=new AbortController;this._queryFeatureCountAbortController=t,await Ib(this._queryFeatureCount()),this._queryFeatureCountAbortController===t&&(this._queryFeatureCountAbortController=null)},this._queryPageController=async()=>{const t=new AbortController;this._queryPageAbortController=t,await Ib(this._queryPage()),this._queryPageAbortController===t&&(this._queryPageAbortController=null)},this._queryThrottled=$0(this._queryController,rO,this),this._queryFeatureCountThrottled=$0(this._queryFeatureCountController,rO,this),this._queryPageThrottled=$0(this._queryPageController,rO,this),this._query=async()=>{const{_queryAbortController:t,relatedFeatures:r}=this;this._destroyRelatedFeatureViewModels(),this.featurePage=1,r.removeAll(),r.addMany(this._sliceFeatures(await this._queryRelatedFeatures({signal:t==null?void 0:t.signal})))},this.handles.add([B(()=>[this.displayCount,this.graphic,this.layer,this.map,this.orderByFieldsFixedCasing,this.relationshipId,this.featuresPerPage,this.showAllEnabled],()=>this._queryThrottled(),et),B(()=>[this.featurePage,this.showAllEnabled],()=>this._queryPageThrottled()),B(()=>[this.layer,this.relationshipId,this.objectId],()=>this._queryFeatureCountThrottled())])}destroy(){this._destroyRelatedFeatureViewModels(),this.relatedFeatures.removeAll(),this._cancelQuery(),this._cancelQueryFeatureCount(),this._cancelQueryPage()}set featurePage(e){const{featuresPerPage:t,featureCount:r}=this,n=1,s=Math.ceil(r/t)||1;this._set("featurePage",Math.min(Math.max(e,n),s))}get featurePage(){return this._get("featurePage")}get orderByFieldsFixedCasing(){const{orderByFields:e,relatedLayer:t}=this;return e&&(t!=null&&t.loaded)?e.map(r=>{const n=r.clone(),s=ex(r.field,t);return n.field=s,n}):e}get itemDescriptionFieldName(){var e,t;return((t=(e=this.orderByFieldsFixedCasing)==null?void 0:e[0])==null?void 0:t.field)||null}set displayCount(e){this._set("displayCount",Math.min(Math.max(e,0),10))}get displayCount(){return this._get("displayCount")}get objectId(){var e,t;return((t=(e=this.graphic)==null?void 0:e.attributes)==null?void 0:t[this.objectIdField])??null}get objectIdField(){var e;return((e=this.layer)==null?void 0:e.objectIdField)||null}get relatedFeatures(){return this._get("relatedFeatures")||new wt}get relatedLayer(){const{layer:e,map:t,relationship:r}=this;return e!=null&&e.loaded?Rue(t,e,r):null}get relationship(){var r;const{relationshipId:e,layer:t}=this;return typeof e=="number"?((r=t==null?void 0:t.relationships)==null?void 0:r.find(({id:n})=>n===e))??null:null}get relatedFeatureViewModels(){return this._get("relatedFeatureViewModels")||new wt}get state(){const{_queryAbortController:e,_queryFeatureCountAbortController:t,_queryPageAbortController:r,graphic:n,relatedLayer:s}=this;return t?"loading":e||r?"querying":n&&s?"ready":"disabled"}_destroyRelatedFeatureViewModels(){var e;(e=this.relatedFeatureViewModels)==null||e.forEach(t=>!t.destroyed&&t.destroy()),this.relatedFeatureViewModels.removeAll()}async _queryFeatureCount(){var u,d,m,f;const{layer:e,relatedLayer:t,relationshipId:r,objectId:n,_queryFeatureCountAbortController:s}=this;if(await(e==null?void 0:e.load()),!t||typeof n!="number"||!((d=(u=e==null?void 0:e.capabilities)==null?void 0:u.queryRelated)!=null&&d.supportsCount))return void this._set("featureCount",0);await t.load();const a=t.createQuery(),o=((f=(m=e.capabilities)==null?void 0:m.queryRelated)==null?void 0:f.supportsCacheHint)??!1,l=new bI({cacheHint:o,relationshipId:r,returnGeometry:!1,objectIds:[n],where:a.where}),c=await e.queryRelatedFeaturesCount(l,{signal:s==null?void 0:s.signal});this._set("featureCount",c[n]||0)}_sliceFeatures(e){const{showAllEnabled:t,displayCount:r}=this;return t?e:r?e.slice(0,r):[]}async _queryPage(){const{relatedFeatures:e,featurePage:t,showAllEnabled:r,_queryPageAbortController:n}=this;!r||t<2||e.addMany(await this._queryRelatedFeatures({signal:n==null?void 0:n.signal}))}async _queryRelatedFeatures(e){var E,O,$,D,I;const{orderByFieldsFixedCasing:t,showAllEnabled:r,featuresPerPage:n,displayCount:s,layer:a,relationshipId:o,featurePage:l,featureCount:c,relatedLayer:u}=this;await(a==null?void 0:a.load());const{relationship:d,objectId:m}=this;if(!d||typeof m!="number"||!((O=(E=a==null?void 0:a.capabilities)==null?void 0:E.queryRelated)!=null&&O.supportsPagination))return[];const f=r?((l-1)*n+c)%c:0,_=r?n:s;if(!u)return[];await u.load();const g=u.objectIdField,w=[...t==null?void 0:t.map(G=>G.field),g],v=t==null?void 0:t.map(G=>`${G.field} ${G.order}`),b=((D=($=a.capabilities)==null?void 0:$.queryRelated)==null?void 0:D.supportsCacheHint)||!1,x=u.createQuery(),T=new bI({orderByFields:v,start:f,num:_,outFields:w,cacheHint:b,relationshipId:o,returnGeometry:!1,objectIds:[m],where:x.where}),R=((I=(await a.queryRelatedFeatures(T,{signal:e==null?void 0:e.signal}))[m])==null?void 0:I.features)||[];return R.forEach(G=>G.sourceLayer=u),R}};h([p()],qi.prototype,"_queryAbortController",void 0),h([p()],qi.prototype,"_queryPageAbortController",void 0),h([p()],qi.prototype,"_queryFeatureCountAbortController",void 0),h([p({value:1})],qi.prototype,"featurePage",null),h([p()],qi.prototype,"featuresPerPage",void 0),h([p({readOnly:!0})],qi.prototype,"orderByFieldsFixedCasing",null),h([p()],qi.prototype,"description",void 0),h([p({readOnly:!0})],qi.prototype,"itemDescriptionFieldName",null),h([p({value:3})],qi.prototype,"displayCount",null),h([p({type:jc})],qi.prototype,"graphic",void 0),h([p()],qi.prototype,"layer",void 0),h([p()],qi.prototype,"map",void 0),h([p({readOnly:!0})],qi.prototype,"objectId",null),h([p({readOnly:!0})],qi.prototype,"objectIdField",null),h([p()],qi.prototype,"orderByFields",void 0),h([p({readOnly:!0})],qi.prototype,"relatedFeatures",null),h([p({readOnly:!0})],qi.prototype,"relatedLayer",null),h([p({readOnly:!0})],qi.prototype,"relationship",null),h([p({readOnly:!0})],qi.prototype,"featureCount",void 0),h([p({readOnly:!0})],qi.prototype,"relatedFeatureViewModels",null),h([p()],qi.prototype,"relationshipId",void 0),h([p()],qi.prototype,"showAllEnabled",void 0),h([p({readOnly:!0})],qi.prototype,"state",null),h([p()],qi.prototype,"title",void 0),qi=h([F("esri.widgets.Feature.FeatureRelationship.FeatureRelationshipViewModel")],qi);const uN=qi,gu={base:"esri-feature-relationship",esriWidget:"esri-widget",listContainer:"esri-feature-relationship__list",listContainerQuerying:"esri-feature-relationship__list--querying",featureObserver:"esri-feature__feature-observer",stickySpinnerContainer:"esri-feature__sticky-loading-container",loadingSpinnerContainer:"esri-feature__loading-container",spinner:"esri-feature__loading-spinner",iconLoading:"esri-icon-loading-indicator esri-rotating"},J9={title:!0,description:!0};let ca=class extends Hn{constructor(e,t){super(e,t),this._featureElementInfo=null,this._relatedFeatureIntersectionObserver=new IntersectionObserver(([r])=>{r!=null&&r.isIntersecting&&this._increaseFeaturePage()},{root:window.document}),this.headingLevel=2,this.viewModel=new uN,this.messages=null,this.messagesCommon=null,this.visibleElements={...J9},this._increaseFeaturePage=()=>{const{state:r,showAllEnabled:n,relatedFeatures:s,featuresPerPage:a,featurePage:o}=this.viewModel;r==="ready"&&n&&s.length>=a*o&&this.viewModel.featurePage++}}initialize(){this._featureElementInfo=new pP,this.addHandles([B(()=>[this.viewModel.description,this.viewModel.title,this.headingLevel],()=>this._setupFeatureElementInfo(),et),B(()=>[this.viewModel.state,this.viewModel.showAllEnabled,this._relatedFeatureIntersectionObserverNode],()=>this._handleRelatedFeatureObserverChange()),wr(()=>this.viewModel.relatedFeatureViewModels,"change",()=>this._setupRelatedFeatureViewModels())])}loadDependencies(){return Promise.all([j(()=>import("./calcite-list-8d7e37dc.js"),["assets/calcite-list-8d7e37dc.js","assets/widget-fb292a2f.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/intl-65a3e389.js","assets/number-27cf8195.js","assets/jsonMap-7b8332c9.js","assets/locale-30120714.js","assets/messages-2289086c.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/assets-8d3e737a.js","assets/Evented-a45c8b0f.js","assets/Promise-376ab9f6.js","assets/reactiveUtils-4dabbb80.js","assets/uuid-73213768.js","assets/interactive-52dcf836.js"]),j(()=>import("./calcite-list-item-83bb520f.js"),["assets/calcite-list-item-83bb520f.js","assets/widget-fb292a2f.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/intl-65a3e389.js","assets/number-27cf8195.js","assets/jsonMap-7b8332c9.js","assets/locale-30120714.js","assets/messages-2289086c.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/assets-8d3e737a.js","assets/Evented-a45c8b0f.js","assets/Promise-376ab9f6.js","assets/reactiveUtils-4dabbb80.js","assets/uuid-73213768.js","assets/conditionalSlot-ff2173e3.js","assets/observers-edc9938f.js","assets/interactive-52dcf836.js"]),j(()=>import("./calcite-icon-938ab0b8.js"),["assets/calcite-icon-938ab0b8.js","assets/icon-40b00e67.js","assets/widget-fb292a2f.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/intl-65a3e389.js","assets/number-27cf8195.js","assets/jsonMap-7b8332c9.js","assets/locale-30120714.js","assets/messages-2289086c.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/assets-8d3e737a.js","assets/Evented-a45c8b0f.js","assets/Promise-376ab9f6.js","assets/reactiveUtils-4dabbb80.js","assets/uuid-73213768.js","assets/observers-edc9938f.js"]),j(()=>import("./calcite-notice-3d8b5086.js"),["assets/calcite-notice-3d8b5086.js","assets/widget-fb292a2f.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/intl-65a3e389.js","assets/number-27cf8195.js","assets/jsonMap-7b8332c9.js","assets/locale-30120714.js","assets/messages-2289086c.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/assets-8d3e737a.js","assets/Evented-a45c8b0f.js","assets/Promise-376ab9f6.js","assets/reactiveUtils-4dabbb80.js","assets/uuid-73213768.js","assets/conditionalSlot-ff2173e3.js","assets/observers-edc9938f.js","assets/icon-40b00e67.js"])])}destroy(){this._unobserveRelatedFeatureObserver(),this._featureElementInfo=Oe(this._featureElementInfo)}get displayShowAllButton(){const{showAllEnabled:e,featureCount:t,displayCount:r}=this.viewModel;return!e&&(t>r||r===0)}get displayListItems(){return this.displayShowAllButton||this.viewModel.relatedFeatureViewModels.length>0}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get featureCountDescription(){const{messages:e}=this,{featureCount:t}=this.viewModel;return gc(t===1?e==null?void 0:e.numberRecord:e==null?void 0:e.numberRecords,{number:t})}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}castVisibleElements(e){return{...J9,...e}}renderStickyLoading(){return this.viewModel.state==="querying"?N("div",{key:"sticky-loader",class:gu.stickySpinnerContainer},this.renderLoadingIcon()):null}renderLoadingIcon(){return N("span",{class:this.classes(gu.iconLoading,gu.spinner)})}renderLoading(){return N("div",{key:"loading-container",class:gu.loadingSpinnerContainer},this.renderLoadingIcon())}renderShowAllIconNode(){return N("calcite-icon",{scale:"s",icon:"list",slot:"content-end"})}renderChevronIconNode(){const e=zh(this.container)?"chevron-left":"chevron-right";return N("calcite-icon",{scale:"s",icon:e,slot:"content-end"})}renderRelatedFeature(e){var s,a;const{itemDescriptionFieldName:t}=this.viewModel,r=e.title;e.description=t&&((s=e.formattedAttributes)==null?void 0:s.global[t]);const n=e.state==="loading";return N("calcite-list-item",{key:e.uid,label:n?`${(a=this.messagesCommon)==null?void 0:a.loading}`:r,description:n?"":e.description,onclick:()=>this.emit("select-record",{featureViewModel:e})},this.renderChevronIconNode())}renderShowAllListItem(){var e;return this.displayShowAllButton?N("calcite-list-item",{key:"show-all-item",label:(e=this.messages)==null?void 0:e.showAll,description:this.featureCountDescription,onclick:()=>this.emit("show-all-records")},this.renderShowAllIconNode()):null}renderNoRelatedFeaturesMessage(){var e;return N("calcite-notice",{key:"no-related-features-message",icon:"information",open:!0,color:"blue",scale:"s",width:"full"},N("div",{slot:"message"},(e=this.messages)==null?void 0:e.noRelatedFeatures))}renderFeatureObserver(){return N("div",{key:"feature-observer",class:gu.featureObserver,bind:this,afterCreate:this._relatedFeatureIntersectionObserverCreated})}renderList(){const{relatedFeatureViewModels:e}=this.viewModel;return N("calcite-list",null,e.toArray().map(t=>this.renderRelatedFeature(t)),this.renderShowAllListItem())}renderRelatedFeatures(){const{displayListItems:e}=this,{state:t}=this.viewModel;return N("div",{key:"list-container",class:this.classes(gu.listContainer,{[gu.listContainerQuerying]:t==="querying"})},e?this.renderList():t==="ready"?this.renderNoRelatedFeaturesMessage():null,this.renderStickyLoading(),this.renderFeatureObserver())}renderRelationshipNotFound(){var e;return N("calcite-notice",{key:"relationship-not-found",icon:"exclamation-mark-triangle",open:!0,color:"red",scale:"s",width:"full"},N("div",{slot:"message"},(e=this.messages)==null?void 0:e.relationshipNotFound))}render(){var t;const{state:e}=this.viewModel;return N("div",{class:this.classes(gu.base,gu.esriWidget)},(t=this._featureElementInfo)==null?void 0:t.render(),e==="loading"?this.renderLoading():e==="disabled"?this.renderRelationshipNotFound():this.renderRelatedFeatures())}_setupRelatedFeatureViewModels(){const{relatedFeatureViewModels:e}=this.viewModel,t="related-feature-viewmodels";this.removeHandles(t),e==null||e.forEach(r=>{this.addHandles(B(()=>[r.title,r.state],()=>this.scheduleRender(),et),t)}),this.scheduleRender()}_setupFeatureElementInfo(){const{headingLevel:e,visibleElements:t}=this,r=t.description&&this.description,n=t.title&&this.title;this._featureElementInfo.set({description:r,title:n,headingLevel:e})}async _handleRelatedFeatureObserverChange(){this._unobserveRelatedFeatureObserver();const{state:e,showAllEnabled:t}=this.viewModel;await j0(0),this._relatedFeatureIntersectionObserverNode&&e==="ready"&&t&&this._relatedFeatureIntersectionObserver.observe(this._relatedFeatureIntersectionObserverNode)}_relatedFeatureIntersectionObserverCreated(e){this._relatedFeatureIntersectionObserverNode=e}_unobserveRelatedFeatureObserver(){this._relatedFeatureIntersectionObserverNode&&this._relatedFeatureIntersectionObserver.unobserve(this._relatedFeatureIntersectionObserverNode)}};h([p()],ca.prototype,"_relatedFeatureIntersectionObserverNode",void 0),h([p({readOnly:!0})],ca.prototype,"displayShowAllButton",null),h([p({readOnly:!0})],ca.prototype,"displayListItems",null),h([p()],ca.prototype,"description",null),h([p({readOnly:!0})],ca.prototype,"featureCountDescription",null),h([p()],ca.prototype,"headingLevel",void 0),h([p()],ca.prototype,"title",null),h([p({type:uN})],ca.prototype,"viewModel",void 0),h([p(),_n("esri/widgets/Feature/t9n/Feature")],ca.prototype,"messages",void 0),h([p(),_n("esri/t9n/common")],ca.prototype,"messagesCommon",void 0),h([p()],ca.prototype,"visibleElements",void 0),h([qr("visibleElements")],ca.prototype,"castVisibleElements",null),ca=h([F("esri.widgets.Feature.FeatureRelationship")],ca);const eV=ca;let Dde=class{constructor(e,t){this.preLayerQueryCallback=e,this.preRequestCallback=t,this.preLayerQueryCallback||(this.preLayerQueryCallback=r=>{}),this.preRequestCallback||(this.preLayerQueryCallback=r=>{})}};var j1;const Fde=1,tV="content-view-models",iV="relationship-view-models",rV={attachmentsContent:!0,chartAnimation:!0,customContent:!0,expressionContent:!0,fieldsContent:!0,mediaContent:!0,textContent:!0,relationshipContent:!0};let or=j1=class extends gD(pe){constructor(i){super(i),this._handles=new Vt,this._error=null,this._featureAbortController=null,this._graphicChangedThrottled=$0(this._graphicChanged,Fde,this),this._expressionAttributes=null,this._graphicExpressionAttributes=null,this.abilities={...rV},this.content=null,this.contentViewModels=[],this.description=null,this.defaultPopupTemplateEnabled=!1,this.formattedAttributes=null,this.lastEditInfo=null,this.relatedInfos=new Map,this.title="",this.view=null,this._isAllowedContentType=e=>{const{abilities:t}=this;return e.type==="attachments"&&t.attachmentsContent||e.type==="custom"&&t.customContent||e.type==="fields"&&t.fieldsContent||e.type==="media"&&t.mediaContent||e.type==="text"&&t.textContent||e.type==="expression"&&t.expressionContent||e.type==="relationship"&&t.relationshipContent},this._handles.add(B(()=>[this.graphic,this._effectivePopupTemplate,this.abilities],()=>this._graphicChangedThrottled(),et))}destroy(){this._clear(),this._cancelFeatureQuery(),this._error=null,this._handles.destroy(),this._handles=null,this.graphic=null,this._destroyContentViewModels(),this.relatedInfos.clear()}get _effectivePopupTemplate(){return y(this.graphic)?this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled):null}get _fieldInfoMap(){return vue(U9(this._effectivePopupTemplate),this._sourceLayer)}get _sourceLayer(){return lW(this.graphic)}castAbilities(i){return{...rV,...i}}get state(){return this.graphic?this._error?"error":this.waitingForContent?"loading":"ready":"disabled"}set graphic(i){this._set("graphic",i?i.clone():null)}get spatialReference(){var i;return((i=this.view)==null?void 0:i.spatialReference)??null}set spatialReference(i){this._override("spatialReference",i)}get map(){var i;return((i=this.view)==null?void 0:i.map)||null}set map(i){this._override("map",i)}get waitingForContent(){return!!this._featureAbortController}setActiveMedia(i,e){const t=this.contentViewModels[i];t instanceof og&&t.setActiveMedia(e)}nextMedia(i){const e=this.contentViewModels[i];e instanceof og&&e.next()}previousMedia(i){const e=this.contentViewModels[i];e instanceof og&&e.previous()}_clear(){this._set("title",""),this._set("content",null),this._set("formattedAttributes",null)}async _graphicChanged(){this._cancelFeatureQuery(),this._error=null,this._clear();const{graphic:i}=this;if(!i)return;const e=new AbortController;this._featureAbortController=e;try{await this._queryFeature({signal:e.signal})}catch(t){yo(t)||(this._error=t,ee.getLogger(this.declaredClass).error("error","The popupTemplate could not be displayed for this feature.",{error:t,graphic:i,popupTemplate:this._effectivePopupTemplate}))}this._featureAbortController===e&&(this._featureAbortController=null)}_cancelFeatureQuery(){const{_featureAbortController:i}=this;i&&i.abort(),this._featureAbortController=null}_compileContentElement(i,e){return i.type==="attachments"?this._compileAttachments(i,e):i.type==="custom"?this._compileCustom(i,e):i.type==="fields"?this._compileFields(i,e):i.type==="media"?this._compileMedia(i,e):i.type==="text"?this._compileText(i,e):i.type==="expression"?this._compileExpression(i,e):i.type==="relationship"?this._compileRelationship(i,e):void 0}_compileContent(i){if(this._destroyContentViewModels(),this.graphic)return Array.isArray(i)?i.filter(this._isAllowedContentType).map((e,t)=>this._compileContentElement(e,t)):typeof i=="string"?this._compileText(new iG({text:i}),0).text:i}_destroyContentViewModels(){var i,e;(i=this._handles)==null||i.remove(iV),(e=this._handles)==null||e.remove(tV),this.contentViewModels.forEach(t=>t&&!t.destroyed&&t.destroy()),this._set("contentViewModels",[])}_matchesFeature(i,e){var n;const t=(n=i==null?void 0:i.graphic)==null?void 0:n.getObjectId(),r=e==null?void 0:e.getObjectId();return y(t)&&y(r)&&t===r}_setRelatedFeaturesViewModels({relatedFeatureViewModels:i,relatedFeatures:e,map:t}){e==null||e.filter(Boolean).forEach(r=>{i.find(n=>this._matchesFeature(n,r))||i.add(new j1({abilities:{relationshipContent:!1},map:t,graphic:r}))}),i.forEach(r=>{(e==null?void 0:e.find(s=>this._matchesFeature(r,s)))||i.remove(r)})}_setExpressionContentVM(i,e){const{formattedAttributes:t}=this,{contentElement:r,contentElementViewModel:n}=i,s=r==null?void 0:r.type;n&&s&&(s==="fields"&&(this._createFieldsFormattedAttributes({contentElement:r,contentElementIndex:e,formattedAttributes:t}),n.set(this._createFieldsVMParams(r,e))),s==="media"&&(this._createMediaFormattedAttributes({contentElement:r,contentElementIndex:e,formattedAttributes:t}),n.set(this._createMediaVMParams(r,e))),s==="text"&&n.set(this._createTextVMParams(r)))}_compileRelationship(i,e){const{displayCount:t,orderByFields:r,relationshipId:n,title:s,description:a}=i,{_sourceLayer:o,graphic:l,map:c}=this,u=new uN({displayCount:t,graphic:l,orderByFields:r,relationshipId:n,layer:o,map:c,...this._compileTitleAndDesc({title:s,description:a})});return this.contentViewModels[e]=u,this._handles.add(wr(()=>u.relatedFeatures,"change",()=>this._setRelatedFeaturesViewModels(u)),iV),i}_compileExpression(i,e){const{expressionInfo:t}=i,{graphic:r,map:n,spatialReference:s,view:a}=this,o=new hN({expressionInfo:t,graphic:r,interceptor:j1.interceptor,map:n,spatialReference:s,view:a});return this.contentViewModels[e]=o,this._handles.add(B(()=>o.contentElementViewModel,()=>this._setExpressionContentVM(o,e),et),tV),i}_compileAttachments(i,e){const{graphic:t}=this,{description:r,title:n}=i;return this.contentViewModels[e]=new oN({graphic:t,...this._compileTitleAndDesc({title:n,description:r})}),i}_compileCustom(i,e){const{graphic:t}=this,{creator:r,destroyer:n}=i;return this.contentViewModels[e]=new P2({graphic:t,creator:r,destroyer:n}),i}_compileTitleAndDesc({title:i,description:e}){const{_fieldInfoMap:t,_sourceLayer:r,graphic:n,formattedAttributes:s,_expressionAttributes:a}=this,{attributes:o}=n,l=s.global;return{title:ag({attributes:o,fieldInfoMap:t,globalAttributes:l,expressionAttributes:a,layer:r,text:i}),description:ag({attributes:o,fieldInfoMap:t,globalAttributes:l,expressionAttributes:a,layer:r,text:e})}}_createFieldsVMParams(i,e){var c;const{_effectivePopupTemplate:t,formattedAttributes:r}=this,n={...r.global,...r.content[e]},s=(c=(i==null?void 0:i.fieldInfos)||(t==null?void 0:t.fieldInfos))==null?void 0:c.filter(({fieldName:u})=>rN(u)||ld(u)||n.hasOwnProperty(u)),a=t==null?void 0:t.expressionInfos,{description:o,title:l}=i;return{attributes:n,expressionInfos:a,fieldInfos:s,...this._compileTitleAndDesc({title:l,description:o})}}_compileFields(i,e){const t=i.clone(),r=new mP(this._createFieldsVMParams(i,e));return this.contentViewModels[e]=r,t.fieldInfos=r.formattedFieldInfos.slice(0),t}_createMediaVMParams(i,e){const{abilities:t,graphic:r,_fieldInfoMap:n,formattedAttributes:s,_effectivePopupTemplate:a,relatedInfos:o,_sourceLayer:l,_expressionAttributes:c}=this,{attributes:u}=r,{description:d,mediaInfos:m,title:f}=i;return{abilities:{chartAnimation:t.chartAnimation},activeMediaInfoIndex:i.activeMediaInfoIndex||0,attributes:u,layer:l,fieldInfoMap:n,formattedAttributes:{...s.global,...s.content[e]},expressionAttributes:c,mediaInfos:m,popupTemplate:a,relatedInfos:o,...this._compileTitleAndDesc({title:f,description:d})}}_compileMedia(i,e){const t=i.clone(),r=new og(this._createMediaVMParams(i,e));return t.mediaInfos=r.formattedMediaInfos.slice(0),this.contentViewModels[e]=r,t}_createTextVMParams(i){const{graphic:e,_fieldInfoMap:t,_sourceLayer:r,_expressionAttributes:n}=this;if(i&&i.text){const{attributes:s}=e,a=this.formattedAttributes.global;i.text=ag({attributes:s,fieldInfoMap:t,globalAttributes:a,expressionAttributes:n,layer:r,text:i.text})}return{graphic:e,creator:i.text}}_compileText(i,e){const t=i.clone();return this.contentViewModels[e]=new P2(this._createTextVMParams(t)),t}_compileLastEditInfo(){const{_effectivePopupTemplate:i,_sourceLayer:e,graphic:t}=this;if(!i)return;const{lastEditInfoEnabled:r}=i,n=e==null?void 0:e.editFieldsInfo;return r&&n?yue(n,t.attributes):void 0}_compileTitle(i){const{_fieldInfoMap:e,_sourceLayer:t,graphic:r,_expressionAttributes:n}=this,{attributes:s}=r,a=this.formattedAttributes.global;return ag({attributes:s,fieldInfoMap:e,globalAttributes:a,expressionAttributes:n,layer:t,text:i})}async _getTitle(){const{_effectivePopupTemplate:i,graphic:e}=this,t=i==null?void 0:i.title;return R2(t,{graphic:e})}async _getContent(){const{_effectivePopupTemplate:i,graphic:e}=this,t=i==null?void 0:i.content;return R2(t,{graphic:e})}async _queryFeature(i){const{_featureAbortController:e,_sourceLayer:t,graphic:r,_effectivePopupTemplate:n,spatialReference:s,map:a,view:o}=this;if(e!==this._featureAbortController||!r)return;await xue({graphic:r,popupTemplate:n,layer:t,spatialReference:s},i);const{content:{value:l},title:{value:c}}=await Yo({content:this._getContent(),title:this._getTitle()}),{expressionAttributes:{value:u}}=await Yo({checkForRelatedFeatures:this._checkForRelatedFeatures(i),expressionAttributes:Ide({expressionInfos:n==null?void 0:n.expressionInfos,spatialReference:s,graphic:r,map:a,interceptor:j1.interceptor,view:o})});e===this._featureAbortController&&r&&(this._expressionAttributes=u,this._graphicExpressionAttributes={...r.attributes,...u},this._set("formattedAttributes",this._createFormattedAttributes(l)),this._set("title",this._compileTitle(c)),this._set("lastEditInfo",this._compileLastEditInfo()||null),this._set("content",this._compileContent(l)||null))}_createMediaFormattedAttributes({contentElement:i,contentElementIndex:e,formattedAttributes:t}){const{_effectivePopupTemplate:r,graphic:n,relatedInfos:s,_sourceLayer:a,_fieldInfoMap:o,_graphicExpressionAttributes:l}=this;t.content[e]=ZA({fieldInfos:r==null?void 0:r.fieldInfos,graphic:n,attributes:{...l,...i.attributes},layer:a,fieldInfoMap:o,relatedInfos:s})}_createFieldsFormattedAttributes({contentElement:i,contentElementIndex:e,formattedAttributes:t}){if(i.fieldInfos){const{graphic:r,relatedInfos:n,_sourceLayer:s,_fieldInfoMap:a,_graphicExpressionAttributes:o}=this;t.content[e]=ZA({fieldInfos:i.fieldInfos,graphic:r,attributes:{...o,...i.attributes},layer:s,fieldInfoMap:a,relatedInfos:n})}}_createFormattedAttributes(i){const{_effectivePopupTemplate:e,graphic:t,relatedInfos:r,_sourceLayer:n,_fieldInfoMap:s,_graphicExpressionAttributes:a}=this,o=e==null?void 0:e.fieldInfos,l={global:ZA({fieldInfos:o,graphic:t,attributes:a,layer:n,fieldInfoMap:s,relatedInfos:r}),content:[]};return Array.isArray(i)&&i.forEach((c,u)=>{c.type==="fields"&&this._createFieldsFormattedAttributes({contentElement:c,contentElementIndex:u,formattedAttributes:l}),c.type==="media"&&this._createMediaFormattedAttributes({contentElement:c,contentElementIndex:u,formattedAttributes:l})}),l}_checkForRelatedFeatures(i){const{graphic:e,_effectivePopupTemplate:t}=this;return this._queryRelatedInfos(e,U9(t),i)}async _queryRelatedInfos(i,e,t){const{relatedInfos:r,_sourceLayer:n}=this;r.clear();const s=y(n.associatedLayer)?await n.associatedLayer.load(t):n;if(!s)return;const a=e.filter(c=>c&&ld(c.fieldName));if(!a||!a.length)return;e.forEach(c=>this._configureRelatedInfo(c,s));const o=await pde({relatedInfos:r,layer:s},t);Object.keys(o).forEach(c=>{var m;const u=r.get(c.toString()),d=(m=o[c])==null?void 0:m.value;u&&d&&(u.layerInfo=d.data)});const l=await mde({graphic:i,relatedInfos:r,layer:s},t);Object.keys(l).forEach(c=>{var u;lde((u=l[c])==null?void 0:u.value,r.get(c.toString()))})}_configureRelatedInfo(i,e){const{relatedInfos:t}=this,r=YL(i.fieldName);if(!r)return;const{layerId:n,fieldName:s}=r;if(!n)return;const a=t.get(n.toString())||ode(n,e);a&&(fde({relatedInfo:a,fieldName:s,fieldInfo:i}),this.relatedInfos.set(n,a))}};or.interceptor=new Dde(Sue,Eue),h([p()],or.prototype,"_error",void 0),h([p()],or.prototype,"_featureAbortController",void 0),h([p({readOnly:!0})],or.prototype,"_effectivePopupTemplate",null),h([p({readOnly:!0})],or.prototype,"_fieldInfoMap",null),h([p({readOnly:!0})],or.prototype,"_sourceLayer",null),h([p()],or.prototype,"abilities",void 0),h([qr("abilities")],or.prototype,"castAbilities",null),h([p({readOnly:!0})],or.prototype,"content",void 0),h([p({readOnly:!0})],or.prototype,"contentViewModels",void 0),h([p()],or.prototype,"description",void 0),h([p({type:Boolean})],or.prototype,"defaultPopupTemplateEnabled",void 0),h([p({readOnly:!0})],or.prototype,"state",null),h([p({readOnly:!0})],or.prototype,"formattedAttributes",void 0),h([p({type:jc,value:null})],or.prototype,"graphic",null),h([p({readOnly:!0})],or.prototype,"lastEditInfo",void 0),h([p({readOnly:!0})],or.prototype,"relatedInfos",void 0),h([p()],or.prototype,"spatialReference",null),h([p({readOnly:!0})],or.prototype,"title",void 0),h([p()],or.prototype,"map",null),h([p({readOnly:!0})],or.prototype,"waitingForContent",null),h([p()],or.prototype,"view",void 0),or=j1=h([F("esri.widgets.FeatureViewModel")],or);const dN=or,_r={iconText:"esri-icon-font-fallback-text",iconLoading:"esri-icon-loading-indicator esri-rotating",esriTable:"esri-widget__table",esriWidget:"esri-widget",base:"esri-feature",container:"esri-feature__size-container",title:"esri-feature__title",main:"esri-feature__main-container",btn:"esri-feature__button",icon:"esri-feature__icon",content:"esri-feature__content",contentNode:"esri-feature__content-node",contentElement:"esri-feature__content-element",text:"esri-feature__text",lastEditedInfo:"esri-feature__last-edited-info",fields:"esri-feature__fields",fieldHeader:"esri-feature__field-header",fieldData:"esri-feature__field-data",fieldDataDate:"esri-feature__field-data--date",loadingSpinnerContainer:"esri-feature__loading-container",spinner:"esri-feature__loading-spinner"},wW=i=>{let e=class extends i{constructor(){super(...arguments),this.renderNodeContent=t=>UE(t)&&!t.destroyed?N("div",{class:_r.contentNode,key:t},t.render()):t instanceof HTMLElement?N("div",{class:_r.contentNode,key:t,bind:t,afterCreate:this._attachToNode}):K7(t)?N("div",{class:_r.contentNode,key:t,bind:t.domNode,afterCreate:this._attachToNode}):null}_attachToNode(t){const r=this;t.appendChild(r)}};return e=h([F("esri.widgets.Feature.ContentMixin")],e),e};var KL;const nV={title:!0,content:!0,lastEditedInfo:!0},sV="relationship-handles";let Qn=KL=class extends wW(Hn){constructor(i,e){super(i,e),this._contentWidgets=[],this.flowItems=null,this.headingLevel=2,this.messages=null,this.messagesCommon=null,this.messagesURIUtils=null,this.visibleElements={...nV},this.viewModel=new dN}initialize(){this.addHandles(B(()=>{var i;return(i=this.viewModel)==null?void 0:i.contentViewModels},()=>this._setupContentWidgets(),et))}loadDependencies(){return j(()=>import("./calcite-notice-3d8b5086.js"),["assets/calcite-notice-3d8b5086.js","assets/widget-fb292a2f.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/intl-65a3e389.js","assets/number-27cf8195.js","assets/jsonMap-7b8332c9.js","assets/locale-30120714.js","assets/messages-2289086c.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/assets-8d3e737a.js","assets/Evented-a45c8b0f.js","assets/Promise-376ab9f6.js","assets/reactiveUtils-4dabbb80.js","assets/uuid-73213768.js","assets/conditionalSlot-ff2173e3.js","assets/observers-edc9938f.js","assets/icon-40b00e67.js"])}destroy(){this._destroyContentWidgets()}get graphic(){return this.viewModel.graphic}set graphic(i){this.viewModel.graphic=i}get defaultPopupTemplateEnabled(){return this.viewModel.defaultPopupTemplateEnabled}set defaultPopupTemplateEnabled(i){this.viewModel.defaultPopupTemplateEnabled=i}get label(){var i;return((i=this.messages)==null?void 0:i.widgetLabel)??""}set label(i){this._overrideIfSome("label",i)}get spatialReference(){return this.viewModel.spatialReference}set spatialReference(i){this.viewModel.spatialReference=i}get title(){return this.viewModel.title}castVisibleElements(i){return{...nV,...i}}get map(){return this.viewModel.map}set map(i){this.viewModel.map=i}get view(){return this.viewModel.view}set view(i){this.viewModel.view=i}render(){const{state:i}=this.viewModel,e=N("div",{class:_r.container,key:"container"},this.renderTitle(),i==="error"?this.renderError():i==="loading"?this.renderLoading():this.renderContentContainer());return N("div",{class:this.classes(_r.base,_r.esriWidget)},e)}setActiveMedia(i,e){return this.viewModel.setActiveMedia(i,e)}nextMedia(i){return this.viewModel.nextMedia(i)}previousMedia(i){return this.viewModel.previousMedia(i)}renderError(){const{messagesCommon:i,messages:e,visibleElements:t}=this;return N("calcite-notice",{active:!0,color:"red",icon:"exclamation-mark-circle",scale:"s"},t.title?N("div",{key:"error-title",slot:"title"},i.errorMessage):null,N("div",{key:"error-message",slot:"message"},e.loadingError))}renderLoading(){return N("div",{key:"loading-container",class:_r.loadingSpinnerContainer},N("span",{class:this.classes(_r.iconLoading,_r.spinner)}))}renderContentContainer(){const{visibleElements:i}=this;return i.content?N("div",{class:_r.main},[this.renderContent(),this.renderLastEditInfo()]):null}renderTitle(){const{visibleElements:i,title:e}=this;return i.title?N(lN,{level:this.headingLevel,class:_r.title,innerHTML:e}):null}renderContent(){const i=this.viewModel.content,e="content";if(!i)return null;if(Array.isArray(i))return i.length?N("div",{class:_r.contentNode,key:`${e}-content-elements`},i.map(this.renderContentElement,this)):null;if(typeof i=="string"){const t=this._contentWidgets[0];return!t||t.destroyed?null:N("div",{class:_r.contentNode,key:`${e}-content`},t.render())}return this.renderNodeContent(i)}renderContentElement(i,e){const{visibleElements:t}=this;if(typeof t.content!="boolean"&&!t.content[i.type])return null;switch(i.type){case"attachments":return this.renderAttachments(e);case"custom":return this.renderCustom(i,e);case"fields":return this.renderFields(e);case"media":return this.renderMedia(e);case"text":return this.renderText(i,e);case"expression":return this.renderExpression(e);case"relationship":return this.renderRelationship(e);default:return null}}renderAttachments(i){const e=this._contentWidgets[i];if(!e||e.destroyed)return null;const{state:t,attachmentInfos:r}=e.viewModel;return t==="loading"||r.length>0?N("div",{key:this._buildKey("attachments-element",i),class:this.classes(_r.contentElement)},e.render()):null}renderRelationship(i){const e=this._contentWidgets[i];return e&&!e.destroyed&&this.flowItems?N("div",{key:this._buildKey("relationship-element",i),class:_r.contentElement},e.render()):null}renderExpression(i){const e=this._contentWidgets[i];return!e||e.destroyed?null:N("div",{key:this._buildKey("expression-element",i),class:_r.contentElement},e.render())}renderCustom(i,e){const{creator:t}=i,r=this._contentWidgets[e];return!r||r.destroyed?null:t?N("div",{key:this._buildKey("custom-element",e),class:_r.contentElement},r.render()):null}renderFields(i){const e=this._contentWidgets[i];return!e||e.destroyed?null:N("div",{key:this._buildKey("fields-element",i),class:_r.contentElement},e.render())}renderMedia(i){const e=this._contentWidgets[i];return!e||e.destroyed?null:N("div",{key:this._buildKey("media-element",i),class:_r.contentElement},e.render())}renderLastEditInfo(){const{visibleElements:i,messages:e}=this,{lastEditInfo:t}=this.viewModel;if(!t||!i.lastEditedInfo)return null;const{date:r,user:n}=t,s=t.type==="edit"?n?e.lastEditedByUser:e.lastEdited:n?e.lastCreatedByUser:e.lastCreated,a=gc(s,{date:r,user:n});return N("div",{key:"edit-info-element",class:this.classes(_r.lastEditedInfo,_r.contentElement)},a)}renderText(i,e){const t=i.text,r=this._contentWidgets[e];return!r||r.destroyed?null:t?N("div",{key:this._buildKey("text-element",e),class:this.classes(_r.contentElement,_r.text)},r.render()):null}_buildKey(i,...e){return`${i}__${this.get("viewModel.graphic.uid")||"0"}-${e.join("-")}`}_destroyContentWidget(i){i&&(i.viewModel=null,!i.destroyed&&i.destroy())}_destroyContentWidgets(){this.removeHandles(sV),this._contentWidgets.forEach(i=>this._destroyContentWidget(i)),this._contentWidgets=[]}_addFeatureRelationshipHandles(i){const{flowItems:e,visibleElements:t}=this;this.addHandles([wr(()=>i,"select-record",({featureViewModel:r})=>{e&&(r.abilities={relationshipContent:!0},e.push(new KL({flowItems:e,viewModel:r,visibleElements:t})))}),wr(()=>i,"show-all-records",()=>{if(!e)return;const{viewModel:r}=i;r.showAllEnabled=!0;const n=new eV({visibleElements:{title:!1,description:!1},viewModel:r});this._addFeatureRelationshipHandles(n),e.push(n)})],sV)}_setupContentWidgets(){this._destroyContentWidgets();const{headingLevel:i,visibleElements:e}=this,t=this.get("viewModel.content"),{contentViewModels:r}=this.viewModel;if(Array.isArray(t))t.forEach((n,s)=>{if(n.type==="attachments"&&(this._contentWidgets[s]=new Lue({displayType:n.displayType,headingLevel:e.title?i+1:i,viewModel:r[s]})),n.type==="fields"&&(this._contentWidgets[s]=new _W({viewModel:r[s]})),n.type==="media"&&(this._contentWidgets[s]=new yW({viewModel:r[s]})),n.type==="text"&&(this._contentWidgets[s]=new BS({viewModel:r[s]})),n.type==="custom"&&(this._contentWidgets[s]=new BS({viewModel:r[s]})),n.type==="expression"&&(this._contentWidgets[s]=new $de({viewModel:r[s]})),n.type==="relationship"){const a=new eV({viewModel:r[s]});this._addFeatureRelationshipHandles(a),this._contentWidgets[s]=a}},this);else{const n=r[0];n&&!n.destroyed&&(this._contentWidgets[0]=new BS({viewModel:n}))}this.scheduleRender()}};h([p()],Qn.prototype,"graphic",null),h([p()],Qn.prototype,"defaultPopupTemplateEnabled",null),h([p()],Qn.prototype,"flowItems",void 0),h([p()],Qn.prototype,"headingLevel",void 0),h([p()],Qn.prototype,"label",null),h([p(),_n("esri/widgets/Feature/t9n/Feature")],Qn.prototype,"messages",void 0),h([p(),_n("esri/t9n/common")],Qn.prototype,"messagesCommon",void 0),h([p(),_n("esri/widgets/support/t9n/uriUtils")],Qn.prototype,"messagesURIUtils",void 0),h([p()],Qn.prototype,"spatialReference",null),h([p({readOnly:!0})],Qn.prototype,"title",null),h([p()],Qn.prototype,"visibleElements",void 0),h([qr("visibleElements")],Qn.prototype,"castVisibleElements",null),h([p()],Qn.prototype,"map",null),h([p()],Qn.prototype,"view",null),h([p({type:dN})],Qn.prototype,"viewModel",void 0),Qn=KL=h([F("esri.widgets.Feature")],Qn);const Nde=Qn;var xW;const HS=Symbol("anchorHandles");let Pf=class extends nn.EventedAccessor{constructor(e){super(e),this[xW]=new Vt,this.location=null,this.screenLocationEnabled=!1,this.view=null,this[HS].add([cs(()=>co(this.screenLocationEnabled?this.view:null,t=>[t.size,t.type==="3d"?t.camera:t.viewpoint]),()=>this.notifyChange("screenLocation")),B(()=>this.screenLocation,(t,r)=>{y(t)&&y(r)&&this.emit("view-change")})])}destroy(){this.view=null,this[HS]=Oe(this[HS])}get screenLocation(){const{location:e,view:t,screenLocationEnabled:r}=this;return r&&y(e)&&y(t)&&t.ready?t.toScreen(e):null}};xW=HS,h([p()],Pf.prototype,"location",void 0),h([p()],Pf.prototype,"screenLocation",null),h([p()],Pf.prototype,"screenLocationEnabled",void 0),h([p()],Pf.prototype,"view",void 0),Pf=h([F("esri.widgets.support.AnchorElementViewModel")],Pf);const TW=Pf,kde="esri.widgets.CompassViewModel";let jS=class extends TW{constructor(e){super(e),this.visible=!1}};h([p()],jS.prototype,"visible",void 0),jS=h([F(kde)],jS);const CW=jS,nO={base:"esri-spinner",spinnerStart:"esri-spinner--start",spinnerFinish:"esri-spinner--finish"};let Af=class extends Hn{constructor(e,t){super(e,t),this._animationDelay=500,this._animationPromise=null,this.viewModel=new CW}initialize(){this.addHandles(B(()=>this.visible,e=>this._visibleChange(e)))}destroy(){this._animationPromise=null}get location(){return this.viewModel.location}set location(e){this.viewModel.location=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get visible(){return this.viewModel.visible}set visible(e){this.viewModel.visible=e}show(e){const{location:t,promise:r}=e;t&&(this.viewModel.location=t),this.visible=!0;const n=()=>this.hide();r&&r.catch(()=>{}).then(n)}hide(){this.visible=!1}render(){const{visible:e}=this,{screenLocation:t}=this.viewModel,r=!!t,n=e&&r,s=!e&&r,a={[nO.spinnerStart]:n,[nO.spinnerFinish]:s},o=this._getPositionStyles();return N("div",{class:this.classes(nO.base,a),styles:o})}_visibleChange(e){if(e)return void(this.viewModel.screenLocationEnabled=!0);const t=j0(this._animationDelay);this._animationPromise=t,t.catch(()=>{}).then(()=>{this._animationPromise===t&&(this.viewModel.screenLocationEnabled=!1,this._animationPromise=null)})}_getPositionStyles(){const{screenLocation:e,view:t}=this.viewModel;if(C(t)||C(e))return{};const{padding:r}=t;return{left:e.x-r.left+"px",top:e.y-r.top+"px"}}};h([p()],Af.prototype,"location",null),h([p()],Af.prototype,"view",null),h([p({type:CW})],Af.prototype,"viewModel",void 0),h([p()],Af.prototype,"visible",null),Af=h([F("esri.widgets.Spinner")],Af);const Vde=Af,SW="OBJECTID";var aV;(function(i){i[i.size=22]="size",i[i.lineWidth=50]="lineWidth",i[i.maxSize=120]="maxSize",i[i.maxOutlineSize=80]="maxOutlineSize",i[i.tallSymbolWidth=20]="tallSymbolWidth"})(aV||(aV={}));const oV=Ot("android");Ot("chrome")||oV&&oV>=4;yI();function EW(i){return i&&"opacity"in i?i.opacity*EW(i.parent):1}async function Ude(i,e){if(!i)return;const t=i.sourceLayer,r=(y(e)&&e.useSourceLayer?t:i.layer)??t,n=EW(r);if(y(i.symbol)&&(!y(e)||e.ignoreGraphicSymbol!==!0)){const w=i.symbol.type==="web-style"?await i.symbol.fetchSymbol({...e,cache:y(e)?e.webStyleCache:null}):i.symbol.clone();return uA(w,null,n),w}const s=(y(e)?e.renderer:null)??(r&&"renderer"in r?r.renderer:null);let a=s&&"getSymbolAsync"in s?await s.getSymbolAsync(i,e):null;if(!a)return;if(a=a.type==="web-style"?await a.fetchSymbol({...e,cache:y(e)?e.webStyleCache:null}):a.clone(),!(s&&"visualVariables"in s&&s.visualVariables&&s.visualVariables.length))return uA(a,null,n),a;if("arcadeRequiredForVisualVariables"in s&&s.arcadeRequiredForVisualVariables&&(C(e)||C(e.arcade))){const w={...ft(e)};w.arcade=await pD(),e=w}const o=await j(()=>import("./UniqueValueRenderer-08f8851c.js").then(w=>w.v),["assets/UniqueValueRenderer-08f8851c.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/enumeration-3a03bd31.js","assets/jsonMap-7b8332c9.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/geometry-b7901087.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/locale-30120714.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/Clonable-545593ce.js","assets/LegendOptions-010d0873.js","assets/reactiveUtils-4dabbb80.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/number-27cf8195.js","assets/Identifiable-bfe1ff30.js","assets/jsonUtils-229211af.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js"]),l=[],c=[],u=[],d=[];for(const w of s.visualVariables)switch(w.type){case"color":l.push(w);break;case"opacity":c.push(w);break;case"rotation":d.push(w);break;case"size":w.target||u.push(w)}const m=!!l.length&&l[l.length-1],f=m?o.getColor(m,i,e):null,_=!!c.length&&c[c.length-1];let g=_?o.getOpacity(_,i,e):null;if(n!=null&&(g=g!=null?g*n:n),uA(a,f,g),u.length){const w=o.getAllSizes(u,i,e);await Sie(a,w)}for(const w of d)Eie(a,o.getRotationAngle(w,i,e),w.axis);return a}let Od=class{constructor(e,t){this._owner=t,this._properties={},this._afterDispatchHandle=null;for(const r in e){const n=e[r],s=new ute(n,void 0,void 0,2,2);this._properties[r]={pool:s,acquired:[]}}this._afterDispatchHandle=M7(()=>this._release())}destroy(){this._afterDispatchHandle&&(this._afterDispatchHandle.remove(),this._afterDispatchHandle=null);for(const e in this._properties){const t=this._properties[e];for(const r of t.acquired)b5(r)||t.pool.release(r);t.pool.destroy(),t.pool=null,t.acquired=null}this._properties=null,this._owner=null}get(e){const t=this._owner._get(e),r=this._properties[e];let n=r.pool.acquire();for(r.acquired.push(n);n===t;)r.acquired.push(n),n=r.pool.acquire();return n}_release(){for(const e in this._properties){const t=this._properties[e];let r=0;for(const n of t.acquired)b5(n)?t.acquired[r++]=n:t.pool.release(n);t.acquired.length=r}}};const zde=Ot("mac")?"Meta":"Ctrl",fP={8:"Backspace",9:"Tab",13:"Enter",27:"Escape",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete"};for(let i=48;i<58;i++)fP[i]=String.fromCharCode(i);for(let i=1;i<25;i++)fP[111+i]=`F${i}`;for(let i=65;i<91;i++)fP[i]=[String.fromCharCode(i+32),String.fromCharCode(i)];function Bde(i){if(i.key!==void 0)return Ol(i);const e=fP[i.keyCode];return Array.isArray(e)?i.shiftKey?e[1]:e[0]:e}function Gde(i){switch(i){case"Ctrl":case"Alt":case"Shift":case"Meta":case"Primary":return!0}return!1}let Hde=class{constructor(e,t=[]){this.eventType=e,this.keyModifiers=t}matches(e){if(e.type!==this.eventType)return!1;if(this.keyModifiers.length===0)return!0;const t=e.modifiers;for(const r of this.keyModifiers)if(!t.has(r))return!1;return!0}};const lV=ee.getLogger("esri.views.input.InputHandler");let Ri=class{constructor(e){this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=e}get incomingEventMatches(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(const e in this._incoming){const t=this._incoming[e];for(const r of t)this._incomingEventMatches.push(r.match)}}return this._incomingEventMatches}get incomingEventTypes(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map(e=>e.eventType)),this._incomingEventTypes}get outgoingEventTypes(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}get hasSideEffects(){return this._hasSideEffects}get hasPendingInputs(){return!1}onInstall(e){this._manager?lV.error("This InputHandler has already been registered with an InputManager"):(e.setEventCallback(t=>this._handleEvent(t)),e.setUninstallCallback(()=>this._onUninstall()),this._manager=e)}onUninstall(){}registerIncoming(e,t,r){let n;typeof t=="function"?(r=t,n=[]):n=t||[];const s=typeof e=="string"?new Hde(e,n):e,a=()=>{this._incomingEventTypes=null,this._incomingEventMatches=null},o=u=>{const d=this._incoming[u.match.eventType];if(d){const m=d.indexOf(u);d.splice(m,1),a(),this._manager&&this._manager.updateDependencies()}},l=new jde(s,r,{onPause:o,onRemove:o,onResume:u=>{const d=this._incoming[u.match.eventType];d&&!d.includes(u)&&(d.push(u),a(),this._manager&&this._manager.updateDependencies())}});let c=this._incoming[s.eventType];return c||(c=[],this._incoming[s.eventType]=c),c.push(l),a(),this._manager&&this._manager.updateDependencies(),l}registerOutgoing(e){if(this._outgoing[e])throw new Error("There is already a callback registered for this outgoing InputEvent: "+e);const t=new qde(e,{onEmit:(r,n,s,a)=>{var o;(o=this._manager)==null||o.emit(r.eventType,n,s,a)},onRemove:r=>{var n;delete this._outgoing[r.eventType],(n=this._manager)==null||n.updateDependencies()}});return this._outgoing[e]=t,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),t}startCapturingPointer(e){var t;(t=this._manager)==null||t.setPointerCapture(e,!0)}stopCapturingPointer(e){var t;(t=this._manager)==null||t.setPointerCapture(e,!1)}refreshHasPendingInputs(){var e;(e=this._manager)==null||e.refreshHasPendingInputs()}_onUninstall(){this._manager?(this.onUninstall(),this._manager=null):lV.error("This InputHandler is not registered with an InputManager")}_handleEvent(e){var r;const t=this._incoming[e.type];if(t){for(const n of t)if(n.match.matches(e)&&((r=n.callback)==null||r.call(n,e),e.shouldStopPropagation()))break}}},jde=class{constructor(e,t,r){this.match=e,this._callback=t,this._handler=r}pause(){this._handler.onPause(this)}resume(){this._handler.onResume(this)}remove(){this._handler.onRemove(this)}get callback(){return this._callback}},qde=class{constructor(e,t){this.eventType=e,this._removed=!1,this._handler=t}emit(e,t,r){this._removed||this._handler.onEmit(this,e,t,r)}remove(){this._removed=!0,this._handler.onRemove(this)}},Wde=class extends Ri{constructor(e){super(!0),this._onChange=e,this._value="mouse",this._x=null,this._y=null,this.registerIncoming("pointer-move",t=>{this._update(t.data)})}_update(e){const t=e.native.pointerType==="touch"?"touch":"mouse",{x:r,y:n}=e;t===this._value&&this._x===r&&this._y===n||(this._value=t,this._x=r,this._y=n,this._onChange(t,r,n))}},Xde=class extends Ri{constructor(){super(!0),this._activeTouchPointerIds=new Set,this._multiTouchActive=new tre(!1),this._onPointerAdd=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.add(e.native.pointerId),this._update())},this._onPointerRemove=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.delete(e.native.pointerId),this._update())},this.registerIncoming("pointer-down",this._onPointerAdd),this.registerIncoming("pointer-up",this._onPointerRemove),this.registerIncoming("pointer-capture-lost",this._onPointerRemove),this.registerIncoming("pointer-cancel",this._onPointerRemove)}get multiTouchActive(){return this._multiTouchActive.get()}_update(){this._multiTouchActive.set(this._activeTouchPointerIds.size>1)}},uc=class extends pe{constructor(e){super(e),this._pointerCaptures=new Map,this._nameToGroup={},this._handlers=[],this._handlersPriority=[],this._currentPropagation=null,this._updateDependenciesAfterPropagation=!1,this._sourceEvents=new Set,this._keyModifiers=new Set,this._activeKeyModifiers=new Set,this._stoppedPropagationEventIds=new Set,this.primaryKey=zde,this._latestPointerType="mouse",this._propertiesPool=new Od({latestPointerLocation:Zde},this),this.latestPointerLocation=null,this.test={timestamp:void 0,hasCurrentPropagation:()=>!!this._currentPropagation}}initialize(){this.eventSource.onEventReceived=this._onEventReceived.bind(this),this._installRecognizers()}destroy(){const e=Object.keys(this._nameToGroup);for(const t of e)this.uninstallHandlers(t);this.eventSource.destroy(),this._currentPropagation=null,this._propertiesPool.destroy()}get hasPendingInputs(){return this._handlers.some(e=>e.handler.hasPendingInputs)}get latestPointerType(){return this._latestPointerType}get multiTouchActive(){return this._multiTouchHandler.multiTouchActive}installHandlers(e,t,r=Yh.INTERNAL){if(this._nameToGroup[e])return void ee.getLogger(this.declaredClass).error("There is already an InputHandler group registered under the name `"+e+"`");if(t.length===0)return void ee.getLogger(this.declaredClass).error("Can't register a group of zero handlers");const n={name:e,handlers:t.map(s=>({handler:s,active:!0,removed:!1,priorityIndex:0,groupPriority:r,eventCallback:null,uninstallCallback:null}))};this._nameToGroup[e]=n;for(let s=n.handlers.length-1;s>=0;s--){const a=n.handlers[s];this._handlers.push(a),a.handler.onInstall({updateDependencies:()=>{this.updateDependencies()},emit:(o,l,c,u,d)=>{this._emitInputEvent(a.priorityIndex+1,o,l,c,d,u)},setPointerCapture:(o,l)=>{this._setPointerCapture(n,a,o,l)},setEventCallback:o=>{a.eventCallback=o},setUninstallCallback:o=>{a.uninstallCallback=o},refreshHasPendingInputs:()=>{this.notifyChange("hasPendingInputs")}})}this.updateDependencies()}uninstallHandlers(e){const t=this._nameToGroup[e];t?(t.handlers.forEach(r=>{var n;r.removed=!0,(n=r.uninstallCallback)==null||n.call(r)}),delete this._nameToGroup[e],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):ee.getLogger(this.declaredClass).error("There is no InputHandler group registered under the name `"+e+"`")}hasHandlers(e){return this._nameToGroup[e]!==void 0}updateDependencies(){if(this._currentPropagation)return void(this._updateDependenciesAfterPropagation=!0);this._updateDependenciesAfterPropagation=!1;const e=new Set,t=new Set;this._handlersPriority=[];for(let r=this._handlers.length-1;r>=0;r--){const n=this._handlers[r];n.priorityIndex=r,this._handlersPriority.push(n)}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(let r=this._handlersPriority.length-1;r>=0;r--){const n=this._handlersPriority[r];n.priorityIndex=r;let s=n.handler.hasSideEffects;if(!s){for(const a of n.handler.outgoingEventTypes)if(e.has(a)){s=!0;break}}if(s)for(const a of n.handler.incomingEventMatches){e.add(a.eventType);for(const o of a.keyModifiers)Gde(o)||t.add(o)}n.active=s}this._sourceEvents=e,this._keyModifiers=t,this._pointerCaptures.size>0&&this._sourceEvents.add("pointer-capture-lost"),this._keyModifiers.size>0&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up")),this.eventSource&&(this.eventSource.activeEvents=this._sourceEvents)}_setLatestPointer(e,t,r){this._latestPointerType=e;const n=this._get("latestPointerLocation");if(C(n)||n.x!==t||n.y!==r){const s=this._propertiesPool.get("latestPointerLocation");s.x=t,s.y=r,this._set("latestPointerLocation",s)}}_onEventReceived(e,t){if(e==="pointer-capture-lost"){const s=t;this._pointerCaptures.delete(s.native.pointerId)}this._updateKeyModifiers(e,t);const r=this.test.timestamp!=null?this.test.timestamp:t.native?t.native.timestamp:void 0,n=t.native?t.native.cancelable:void 0;this._emitInputEventFromSource(e,t,r,n)}_updateKeyModifiers(e,t){if(!t)return;let r=!1;const n=()=>{if(!r){const o=new Set;this._activeKeyModifiers.forEach(l=>{o.add(l)}),this._activeKeyModifiers=o,r=!0}},s=(o,l)=>{l&&!this._activeKeyModifiers.has(o)?(n(),this._activeKeyModifiers.add(o)):!l&&this._activeKeyModifiers.has(o)&&(n(),this._activeKeyModifiers.delete(o))};if(e==="key-down"||e==="key-up"){const o=t.key;this._keyModifiers.has(o)&&s(o,e==="key-down")}const a=t.native;s("Alt",!(!a||!a.altKey)),s("Ctrl",!(!a||!a.ctrlKey)),s("Shift",!(!a||!a.shiftKey)),s("Meta",!(!a||!a.metaKey)),s("Primary",this._activeKeyModifiers.has(this.primaryKey))}_installRecognizers(){this._latestPointerHandler=new Wde((e,t,r)=>this._setLatestPointer(e,t,r)),this._multiTouchHandler=new Xde,this.installHandlers("input-manager-logic",[this._latestPointerHandler,this._multiTouchHandler],Yh.ALWAYS),this.recognizers.length>0&&this.installHandlers("default",this.recognizers,Yh.INTERNAL)}_setPointerCapture(e,t,r,n){const s=e.name+"-"+t.priorityIndex,a=this._pointerCaptures.get(r.pointerId)||new Set;this._pointerCaptures.set(r.pointerId,a),n?(a.add(s),a.size===1&&this.eventSource&&this.eventSource.setPointerCapture(r,!0)):a.has(s)&&(a.delete(s),a.size===0&&(this._pointerCaptures.delete(r.pointerId),this.eventSource&&this.eventSource.setPointerCapture(r,!1)))}_garbageCollectRemovedHandlers(){this._handlers=this._handlers.filter(e=>!e.removed),this.updateDependencies()}_emitInputEventFromSource(e,t,r,n){this._emitInputEvent(0,e,t,r,n)}_emitInputEvent(e,t,r,n,s,a){const o=n!==void 0?n:this._currentPropagation?this._currentPropagation.timestamp:performance.now(),l=s!==void 0&&s,c={event:new Qde(t,r,o,a||this._activeKeyModifiers,l),priorityIndex:e};this._currentPropagation?this._currentPropagation.events.push(c):this._doNewPropagation(c)}_doNewPropagation(e){this._currentPropagation={events:new O5,currentHandler:null,needsHandlerGarbageCollect:!1,timestamp:e.event.timestamp},this._currentPropagation.events.push(e),this._continuePropagation()}_continuePropagation(){var t,r;const e=xte(this._currentPropagation);for(;e.events.length>0;){const{event:n,priorityIndex:s}=e.events.pop(),a=n.data&&n.data.eventId;if(!(a!=null&&this._stoppedPropagationEventIds.has(a)))for(e.currentHandler=this._handlersPriority[s];e.currentHandler;){if(e.currentHandler.removed)e.needsHandlerGarbageCollect=!0;else{if(e.currentHandler.active&&!n.shouldStopPropagation()&&((r=(t=e.currentHandler).eventCallback)==null||r.call(t,n)),n.shouldStopPropagation()){a!=null&&this._stoppedPropagationEventIds.add(a);break}if(n.shouldPausePropagation(()=>this._continuePropagation()))return void this._pausePropagation({event:n,priorityIndex:e.currentHandler.priorityIndex+1})}e.currentHandler=this._handlersPriority[e.currentHandler.priorityIndex+1]}}e.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers(),this.hasPendingInputs||this._stoppedPropagationEventIds.clear(),this._currentPropagation=null,this._updateDependenciesAfterPropagation&&this.updateDependencies()}_pausePropagation(e){const t=new O5;t.push(e);const r=this._currentPropagation;if(r){for(;r.events.length;)t.push(r.events.pop());r.events=t,r.currentHandler=null}}_compareHandlerPriority(e,t){if(e.handler.hasSideEffects!==t.handler.hasSideEffects)return e.handler.hasSideEffects?1:-1;if(e.groupPriority!==t.groupPriority)return e.groupPriority>t.groupPriority?-1:1;for(const r of e.handler.incomingEventMatches)for(const n of t.handler.incomingEventMatches){if(r.eventType!==n.eventType)continue;const s=r.keyModifiers.filter(a=>n.keyModifiers.includes(a));if(s.length===r.keyModifiers.length!=(s.length===n.keyModifiers.length))return r.keyModifiers.length>n.keyModifiers.length?-1:1}return e.priorityIndex>t.priorityIndex?-1:1}_sortHandlersPriority(e){const t=[];for(const r of e){let n=0;for(;n<t.length&&this._compareHandlerPriority(r,t[n])>=0;)n++;t.splice(n,0,r)}return t}get debug(){const e=t=>{const r=this._setPointerCapture;this._setPointerCapture=()=>{},t(),this._setPointerCapture=r};return{injectEvent:(t,r)=>{e(()=>{this._onEventReceived(t,r)})},disablePointerCapture:e}}};h([p({readOnly:!0})],uc.prototype,"hasPendingInputs",null),h([p({constructOnly:!0})],uc.prototype,"eventSource",void 0),h([p({constructOnly:!0})],uc.prototype,"recognizers",void 0),h([p()],uc.prototype,"_latestPointerType",void 0),h([p()],uc.prototype,"latestPointerType",null),h([p()],uc.prototype,"multiTouchActive",null),h([p({readOnly:!0})],uc.prototype,"latestPointerLocation",void 0),uc=h([F("esri.views.input.InputManager")],uc);let Qde=class{constructor(e,t,r,n,s){this.type=e,this.data=t,this.timestamp=r,this.modifiers=n,this.cancelable=s,this._propagationState=Gp.NONE,this._resumeCallback=null}stopPropagation(){this._propagationState|=Gp.STOPPED}shouldStopPropagation(){return(this._propagationState&Gp.STOPPED)!=0}async(e){this._propagationState|=Gp.PAUSED;const t=(r,n)=>{this._propagationState&=~Gp.PAUSED;const s=this._resumeCallback;if(this._resumeCallback=null,s&&s(),n)throw r;return r};return(typeof e=="function"?e():e).then(r=>t(r,!1),r=>t(r,!0))}shouldPausePropagation(e){return!!(this._propagationState&Gp.PAUSED)&&(this._resumeCallback=e,!0)}preventDefault(){this.data.native.preventDefault()}};var Gp;(function(i){i[i.NONE=0]="NONE",i[i.STOPPED=1]="STOPPED",i[i.PAUSED=2]="PAUSED"})(Gp||(Gp={}));const Yh={ALWAYS:1,DEFAULT:0,TOOL:-1,WIDGET:-2,INTERNAL:-3};let Zde=class{};function cV(i){return i&&typeof i.highlight=="function"}function Yde(i){return i&&typeof i.maskOccludee=="function"}function a9e(i,e,t){return C(i)||i>t&&(e===0||i<e)}function o9e(i,e){return i>0||e>0}function l9e(i){const e=i.effectiveScaleRange;return{minScale:(e==null?void 0:e.minScale)??0,maxScale:(e==null?void 0:e.maxScale)??0}}const gP={iconZoom:"esri-icon-zoom-in-magnifying-glass",iconTrash:"esri-icon-trash",iconBrowseClusteredFeatures:"esri-icon-table"},lg=new zx({id:"zoom-to-feature",title:"{messages.zoom}",className:gP.iconZoom}),hV=new zx({id:"remove-selected-feature",title:"{messages.remove}",className:gP.iconTrash}),o0=new zx({id:"zoom-to-clustered-features",title:"{messages.zoom}",className:gP.iconZoom}),l0=new zx({id:"browse-clustered-features",title:"{messages.browseClusteredFeatures}",className:gP.iconBrowseClusteredFeatures}),Kde="esri.widgets.Popup.PopupViewModel",O2=ee.getLogger(Kde),Jde=i=>{const{event:e,view:t}=i,{action:r}=e,n=t&&t.popup;if(!r)return Promise.reject(new J("trigger-action:missing-arguments","Event has no action"));if(!n)return Promise.reject(new J("trigger-action:missing-arguments","view.popup is missing"));const{disabled:s,id:a}=r;if(!a)return Promise.reject(new J("trigger-action:invalid-action","action.id is missing"));if(s)return Promise.reject(new J("trigger-action:invalid-action","Action is disabled"));if(a===lg.id)return tpe(n.viewModel).catch(Bte);if(a===o0.id)return ipe(n.viewModel);if(a===l0.id)return n.featureMenuOpen=!n.featureMenuOpen,n.viewModel.browseClusterEnabled=!n.viewModel.browseClusterEnabled,Promise.resolve();if(n.viewModel.browseClusterEnabled=!1,a===hV.id){n.close();const{selectedFeature:o}=n;if(!o)return Promise.reject(new J(`trigger-action:${hV.id}`,"selectedFeature is required",{selectedFeature:o}));const{sourceLayer:l}=o;return l?l.remove(o):t.graphics.remove(o),Promise.resolve()}return Promise.resolve()};function RW(i){const{selectedFeature:e,location:t,view:r}=i;return r?r.type==="3d"?e||t:i.get("selectedFeature.geometry")||t:null}function Zf(i){var e,t;return(i==null?void 0:i.isAggregate)&&((t=(e=i==null?void 0:i.sourceLayer)==null?void 0:e.featureReduction)==null?void 0:t.type)==="cluster"}async function epe(i,e){if((e==null?void 0:e.type)!=="3d"||!i||i.declaredClass!=="esri.Graphic")return!0;const t=e.getViewForGraphic(i);if(t&&"whenGraphicBounds"in t){let r;try{r=await t.whenGraphicBounds(i,{useViewElevation:!0})}catch{}return!r||!r.boundingBox||r.boundingBox[0]===r.boundingBox[3]&&r.boundingBox[1]===r.boundingBox[4]&&r.boundingBox[2]===r.boundingBox[5]}return!0}async function tpe(i){const{location:e,selectedFeature:t,view:r,zoomFactor:n}=i,s=RW(i);if(!s){const c=new J("zoom-to:invalid-target-or-view","Cannot zoom to location without a target and view.",{target:s,view:r});throw O2.error(c),c}const a=r.scale/n,o=i.get("selectedFeature.geometry")||e,l=o&&o.type==="point"&&await epe(t,r);lg.active=!0,lg.disabled=!0;try{await i.zoomTo({target:{target:s,scale:l?a:void 0}})}catch{const u=new J("zoom-to:invalid-graphic","Could not zoom to the location of the graphic.",{graphic:t});O2.error(u)}finally{lg.active=!1,lg.disabled=!1,i.zoomToLocation=null,l&&(i.location=o)}}async function ipe(i){const{selectedFeature:e,view:t}=i;if((t==null?void 0:t.type)!=="2d"){const o=new J("zoomToCluster:invalid-view","View must be 2d MapView.",{view:t});throw O2.error(o),o}if(!Zf(e)){const o=new J("zoomToCluster:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:e});throw O2.error(o),o}const r=e.sourceLayer,n=await t.whenLayerView(r),s=n.createQuery();s.aggregateIds=[e.getObjectId()],o0.active=!0,o0.disabled=!0;const{extent:a}=await n.queryExtent(s);await i.zoomTo({target:a}),o0.active=!1,o0.disabled=!1}async function rpe(i){const{selectedFeature:e,view:t}=i,r=e.sourceLayer,n=await t.whenLayerView(r),s=n.createQuery();s.aggregateIds=[e.getObjectId()];const{extent:a}=await n.queryExtent(s);i.selectedClusterBoundaryFeature.geometry=a,t.graphics.add(i.selectedClusterBoundaryFeature)}async function npe(i){const{selectedFeature:e,view:t}=i,r=e.sourceLayer,n=await t.whenLayerView(r),s=n.createQuery();s.aggregateIds=[e.getObjectId()],l0.active=!0,l0.disabled=!0;const{features:a}=await n.queryFeatures(s);l0.active=!1,l0.disabled=!1,t.popup.open({features:[e].concat(a),featureMenuOpen:!0})}function spe(i){const e=i.features.filter(t=>Zf(t));e.length&&(i.features=e)}const PW=i=>{let e=class extends i{constructor(...t){super(...t),this.goToOverride=null,this.view=null}callGoTo(t){const{view:r}=this;return this.goToOverride?this.goToOverride(r,t):r.goTo(t.target,t.options)}};return h([p()],e.prototype,"goToOverride",void 0),h([p()],e.prototype,"view",void 0),e=h([F("esri.widgets.support.GoTo")],e),e},Xb=wt.ofType({key:"type",defaultKeyValue:"button",base:wie,typeMap:{button:zx,toggle:xie}}),ape=()=>[lg.clone()],ope=()=>[o0.clone(),l0.clone()];let jt=class extends PW(TW){constructor(e){super(e),this._handles=new Vt,this._pendingPromises=new Set,this._fetchFeaturesController=null,this._selectedClusterFeature=null,this.featurePage=null,this.actions=new Xb,this.activeFeature=null,this.defaultPopupTemplateEnabled=!1,this.autoCloseEnabled=!1,this.autoOpenEnabled=!0,this.browseClusterEnabled=!1,this.content=null,this.featuresPerPage=20,this.featureViewModelAbilities=null,this.featureViewModels=[],this.highlightEnabled=!0,this.includeDefaultActions=!0,this.selectedClusterBoundaryFeature=new jc({symbol:new Pie({outline:{width:1.5,color:"cyan"},style:"none"})}),this.title=null,this.updateLocationEnabled=!1,this.view=null,this.visible=!1,this.zoomFactor=4,this.zoomToLocation=null}get isLoadingFeature(){return this.featureViewModels.some(e=>e.waitingForContent)}initialize(){this._handles.add([B(()=>[this.autoOpenEnabled,this.view],()=>this._autoOpenEnabledChange()),this.on("view-change",()=>this._autoClose()),B(()=>[this.highlightEnabled,this.selectedFeature,this.visible,this.view],()=>this._highlightSelectedFeature()),B(()=>[this.highlightEnabled,this.activeFeature,this.visible,this.view],()=>this._highlightActiveFeature()),B(()=>{var e,t;return(t=(e=this.view)==null?void 0:e.animation)==null?void 0:t.state},e=>this._animationStateChange(e)),B(()=>this.location,e=>this._locationChange(e)),B(()=>this.selectedFeature,e=>this._selectedFeatureChange(e)),B(()=>[this.selectedFeatureIndex,this.featureCount,this.featuresPerPage],()=>this._selectedFeatureIndexChange()),B(()=>[this.featurePage,this.selectedFeatureIndex,this.featureCount,this.featuresPerPage,this.featureViewModels],()=>this._setGraphicOnFeatureViewModels()),B(()=>this.featureViewModels,()=>this._featureViewModelsChange()),this.on("trigger-action",e=>Jde({event:e,view:this.view})),cs(()=>!this.waitingForResult,()=>this._waitingForResultChange(),ni),B(()=>{var e,t;return[this.features,(e=this.view)==null?void 0:e.map,(t=this.view)==null?void 0:t.spatialReference]},()=>this._updateFeatureVMs()),B(()=>{var e;return(e=this.view)==null?void 0:e.scale},()=>this._viewScaleChange()),cs(()=>!this.visible,()=>this.browseClusterEnabled=!1),B(()=>this.browseClusterEnabled,e=>e?this.enableClusterBrowsing():this.disableClusterBrowsing())])}destroy(){this._cancelFetchingFeatures(),this._handles.destroy(),this._handles=null,this._pendingPromises.clear(),this.browseClusterEnabled=!1,this.view=null}get active(){return!(!this.visible||this.waitingForResult)}get allActions(){const e=this._get("allActions")||new Xb;e.removeAll();const{actions:t,defaultActions:r,defaultPopupTemplateEnabled:n,includeDefaultActions:s,selectedFeature:a}=this,o=s?r.concat(t):t,l=a&&(typeof a.getEffectivePopupTemplate=="function"&&a.getEffectivePopupTemplate(n)||a.popupTemplate),c=l&&l.actions,u=l&&l.overwriteActions?c:c?c.concat(o):o;return u&&u.filter(Boolean).forEach(d=>e.add(d)),e}get defaultActions(){const e=this._get("defaultActions")||new Xb;return e.removeAll(),e.addMany(Zf(this.selectedFeature)?ope():ape()),e}get featureCount(){return this.features.length}get features(){return this._get("features")||[]}set features(e){const t=e||[];this._set("features",t);const{pendingPromisesCount:r,promiseCount:n,selectedFeatureIndex:s}=this,a=n&&t.length;a&&r&&s===-1?this.selectedFeatureIndex=0:a&&s!==-1||(this.selectedFeatureIndex=t.length?0:-1)}get location(){return this._get("location")||null}set location(e){const t=this.get("view.spatialReference.isWebMercator");e&&e.get("spatialReference.isWGS84")&&t&&(e=ER(e)),this._set("location",e)}get pendingPromisesCount(){return this._pendingPromises.size}get waitingForResult(){return!(!(this._fetchFeaturesController||this.pendingPromisesCount>0)||this.featureCount!==0)}get promiseCount(){return this.promises.length}get promises(){return this._get("promises")||[]}set promises(e){if(this._pendingPromises.clear(),this.features=[],!Array.isArray(e)||!e.length)return this._set("promises",[]),void this.notifyChange("pendingPromisesCount");this._set("promises",e),(e=e.slice(0)).forEach(t=>{this._pendingPromises.add(t);const r=s=>{this._pendingPromises.has(t)&&this._updateFeatures(s),this._updatePendingPromises(t)},n=()=>this._updatePendingPromises(t);t.then(r,n)}),this.notifyChange("pendingPromisesCount")}get selectedFeature(){const{features:e,selectedFeatureIndex:t}=this;return t===-1?null:e[t]||null}get selectedFeatureIndex(){const e=this._get("selectedFeatureIndex");return typeof e=="number"?e:-1}set selectedFeatureIndex(e){const{featureCount:t}=this;e=isNaN(e)||e<-1||!t?-1:(e+t)%t,this.activeFeature=null,this._set("selectedFeatureIndex",e)}get selectedFeatureViewModel(){return this.featureViewModels[this.selectedFeatureIndex]||null}get state(){return this.get("view.ready")?"ready":"disabled"}centerAtLocation(){const{view:e}=this,t=RW(this);return t?this.callGoTo({target:{target:t,scale:e.scale}}):Promise.reject(new J("center-at-location:invalid-target-or-view","Cannot center at a location without a target and view.",{target:t,view:e}))}zoomTo(e){return this.callGoTo(e)}clear(){this.set({promises:[],features:[],content:null,title:null,location:null,activeFeature:null})}fetchFeatures(e,t){const{view:r}=this;if(!r||!e)throw new J("fetch-features:invalid-screenpoint-or-view","Cannot fetch features without a screenPoint and view.",{screenPoint:e,view:r});return r.fetchPopupFeatures(e,{event:t&&t.event,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,signal:t&&t.signal})}open(e){const t={updateLocationEnabled:!1,promises:[],fetchFeatures:!1,...e,visible:!0},{fetchFeatures:r}=t;delete t.fetchFeatures,r&&this._setFetchFeaturesPromises(t.location);const n=["actionsMenuOpen","collapsed","featureMenuOpen"];for(const s of n)delete t[s];this.set(t)}triggerAction(e){const t=this.allActions.getItemAt(e);t&&!t.disabled&&this.emit("trigger-action",{action:t})}next(){return this.selectedFeatureIndex=this.selectedFeatureIndex+1,this}previous(){return this.selectedFeatureIndex=this.selectedFeatureIndex-1,this}disableClusterBrowsing(){spe(this),this._clearBrowsedClusterGraphics()}async enableClusterBrowsing(){const{view:e,selectedFeature:t}=this;(e==null?void 0:e.type)==="2d"?Zf(t)?(await rpe(this),await npe(this)):ee.getLogger(this.declaredClass).warn("enableClusterBrowsing:invalid-selectedFeature: Selected feature must represent an aggregate/cluster graphic.",t):ee.getLogger(this.declaredClass).warn("enableClusterBrowsing:invalid-view: View must be 2d MapView.",t)}_animationStateChange(e){this.zoomToLocation||(lg.disabled=e==="waiting-for-target")}_clearBrowsedClusterGraphics(){var t;const e=(t=this.view)==null?void 0:t.graphics;e&&(e.remove(this.selectedClusterBoundaryFeature),e.remove(this._selectedClusterFeature)),this._selectedClusterFeature=null,this.selectedClusterBoundaryFeature.geometry=null}_viewScaleChange(){if(Zf(this.selectedFeature))return this.browseClusterEnabled=!1,this.visible=!1,void this.clear();this.browseClusterEnabled&&(this.features=[this.selectedFeature])}_locationChange(e){const{selectedFeature:t,updateLocationEnabled:r}=this;r&&e&&(!t||t.geometry)&&this.centerAtLocation()}_selectedFeatureIndexChange(){this.featurePage=this.featureCount>1?Math.floor(this.selectedFeatureIndex/this.featuresPerPage)+1:null}_featureViewModelsChange(){this.featurePage=this.featureCount>1?1:null}_setGraphicOnFeatureViewModels(){const{features:e,featureCount:t,featurePage:r,featuresPerPage:n,featureViewModels:s}=this;if(r===null)return;const a=((r-1)*n+t)%t,o=a+n;s.slice(a,o).forEach((l,c)=>{l&&!l.graphic&&(l.graphic=e[a+c])})}async _selectedFeatureChange(e){if(!e)return;const{location:t,updateLocationEnabled:r,view:n}=this;if(this.browseClusterEnabled)return this._selectedClusterFeature&&(n.graphics.remove(this._selectedClusterFeature),this._selectedClusterFeature=null),Zf(e)?void 0:(e.symbol=await Ude(e),this._selectedClusterFeature=e,void n.graphics.add(this._selectedClusterFeature));!r&&t||!e.geometry?r&&!e.geometry&&this.centerAtLocation().then(()=>{this.location=n.center.clone()}):this.location=ft(this._getPointFromGeometry(e.geometry))}_waitingForResultChange(){!this.featureCount&&this.promises&&(this.visible=!1)}_setFetchFeaturesPromises(e){return this._fetchFeaturesWithController(this._getScreenPoint(e||this.location)).then(t=>{const{clientOnlyGraphics:r,promisesPerLayerView:n}=t,s=Promise.resolve(r),a=n.map(o=>o.promise);this.promises=[s,...a]})}_destroyFeatureVMs(){this.featureViewModels.forEach(e=>e&&!e.destroyed&&e.destroy()),this._set("featureViewModels",[])}_updateFeatureVMs(){const{selectedFeature:e,features:t,featureViewModels:r}=this;if(Zf(e)||(this.browseClusterEnabled=!1),this._destroyFeatureVMs(),!t||!t.length)return;const n=r.slice(0),s=[];t.forEach((a,o)=>{var c,u;if(!a)return;let l=null;if(n.some((d,m)=>(d&&d.graphic===a&&(l=d,n.splice(m,1)),!!l)),l)s[o]=l;else{const d=new dN({abilities:this.featureViewModelAbilities,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,spatialReference:(c=this.view)==null?void 0:c.spatialReference,graphic:a===e?a:null,map:(u=this.view)==null?void 0:u.map,view:this.view});s[o]=d}}),n.forEach(a=>a&&!a.destroyed&&a.destroy()),this._set("featureViewModels",s)}_getScreenPoint(e){const{view:t}=this;return t&&e&&typeof t.toScreen=="function"?t.toScreen(e):null}_autoOpenEnabledChange(){const e="auto-fetch-features",{_handles:t,autoOpenEnabled:r}=this;if(t.remove(e),r&&this.view){const n=this.view.on("click",s=>{s.pointerType==="mouse"&&s.button!==0||this._fetchFeaturesAndOpen(s)},Yh.WIDGET);t.add(n,e)}}_cancelFetchingFeatures(){const e=this._fetchFeaturesController;e&&e.abort(),this._fetchFeaturesController=null,this.notifyChange("waitingForResult")}_fetchFeaturesWithController(e,t){this._cancelFetchingFeatures();const r=new AbortController,{signal:n}=r;this._fetchFeaturesController=r,this.notifyChange("waitingForResult");const s=this.fetchFeatures(e,{signal:n,event:t});return s.catch(()=>{}).then(()=>{this._fetchFeaturesController=null,this.notifyChange("waitingForResult")}),s}_fetchFeaturesAndOpen(e){const{screenPoint:t,mapPoint:r}=e,{view:n}=this;this._fetchFeaturesWithController(t,e).then(s=>{const{clientOnlyGraphics:a,promisesPerLayerView:o,location:l}=s,c=[Promise.resolve(a),...o.map(u=>u.promise)];return n.popup.open({location:l||r,promises:c}),s})}_updatePendingPromises(e){e&&this._pendingPromises.has(e)&&(this._pendingPromises.delete(e),this.notifyChange("pendingPromisesCount"))}_autoClose(){this.autoCloseEnabled&&(this.visible=!1)}_getPointFromGeometry(e){var t;return C(e)?null:e.type==="point"?e:e.type==="extent"?e.center:e.type==="polygon"?e.centroid:e.type==="multipoint"||e.type==="polyline"?(t=e.extent)==null?void 0:t.center:null}async _getLayerView(e,t){return await e.when(),e.whenLayerView(t)}_getHighlightLayer(e){const{layer:t,sourceLayer:r}=e;return r&&"layer"in r&&r.layer?r.layer:(r==null?void 0:r.type)==="map-notes"||(r==null?void 0:r.type)==="subtype-group"?r:t}_getHighlightTarget(e,t){const r=t.type==="imagery"?void 0:"objectIdField"in t?t.objectIdField||SW:null,n=e.attributes;return n&&r&&n[r]||e}async _highlightActiveFeature(){const e="highlight-active-feature";this._handles.remove(e);const{highlightEnabled:t,view:r,activeFeature:n,visible:s}=this;if(!(n&&r&&t&&s))return;const a=this._getHighlightLayer(n);if(!(a&&a instanceof TI))return;const o=this._getLayerView(r,a);this._highlightActiveFeaturePromise=o;const l=await o;if(!(l&&cV(l)&&this._highlightActiveFeaturePromise===o&&this.activeFeature&&this.highlightEnabled))return;const c=l.highlight(this._getHighlightTarget(n,a));this._handles.add(c,e)}async _highlightSelectedFeature(){const e="highlight-selected-feature";this._handles.remove(e);const{selectedFeature:t,highlightEnabled:r,view:n,visible:s}=this;if(!(t&&n&&r&&s))return;const a=this._getHighlightLayer(t);if(!(a&&a instanceof TI))return;const o=this._getLayerView(n,a);this._highlightSelectedFeaturePromise=o;const l=await o;if(!(l&&cV(l)&&this._highlightSelectedFeaturePromise===o&&this.selectedFeature&&this.highlightEnabled&&this.visible))return;const c=l.highlight(this._getHighlightTarget(t,a));this._handles.add(c,e)}_updateFeatures(e){const{features:t}=this;if(!e||!e.length)return;if(!t.length)return void(this.features=e);const r=e.filter(n=>!t.includes(n));this.features=t.concat(r)}};h([p()],jt.prototype,"featurePage",void 0),h([p()],jt.prototype,"isLoadingFeature",null),h([p({type:Xb})],jt.prototype,"actions",void 0),h([p({readOnly:!0})],jt.prototype,"active",null),h([p()],jt.prototype,"activeFeature",void 0),h([p({readOnly:!0})],jt.prototype,"allActions",null),h([p({type:Boolean})],jt.prototype,"defaultPopupTemplateEnabled",void 0),h([p()],jt.prototype,"autoCloseEnabled",void 0),h([p()],jt.prototype,"autoOpenEnabled",void 0),h([p()],jt.prototype,"browseClusterEnabled",void 0),h([p()],jt.prototype,"content",void 0),h([p({type:Xb,readOnly:!0})],jt.prototype,"defaultActions",null),h([p({readOnly:!0})],jt.prototype,"featureCount",null),h([p()],jt.prototype,"features",null),h([p()],jt.prototype,"featuresPerPage",void 0),h([p()],jt.prototype,"featureViewModelAbilities",void 0),h([p({readOnly:!0})],jt.prototype,"featureViewModels",void 0),h([p()],jt.prototype,"highlightEnabled",void 0),h([p()],jt.prototype,"includeDefaultActions",void 0),h([p({type:He})],jt.prototype,"location",null),h([p({readOnly:!0})],jt.prototype,"pendingPromisesCount",null),h([p({readOnly:!0})],jt.prototype,"selectedClusterBoundaryFeature",void 0),h([p({readOnly:!0})],jt.prototype,"waitingForResult",null),h([p({readOnly:!0})],jt.prototype,"promiseCount",null),h([p()],jt.prototype,"promises",null),h([p({value:null,readOnly:!0})],jt.prototype,"selectedFeature",null),h([p({value:-1})],jt.prototype,"selectedFeatureIndex",null),h([p({readOnly:!0})],jt.prototype,"selectedFeatureViewModel",null),h([p({readOnly:!0})],jt.prototype,"state",null),h([p()],jt.prototype,"title",void 0),h([p()],jt.prototype,"updateLocationEnabled",void 0),h([p()],jt.prototype,"view",void 0),h([p()],jt.prototype,"visible",void 0),h([p()],jt.prototype,"zoomFactor",void 0),h([p()],jt.prototype,"zoomToLocation",void 0),h([p()],jt.prototype,"centerAtLocation",null),jt=h([F("esri.widgets.Popup.PopupViewModel")],jt);const AW=jt,uV="selected-index",lpe=0,dV="popup-spinner",he={calciteThemeLight:"calcite-theme-light",calciteThemeDark:"calcite-theme-dark",iconLeftTriangleArrow:"esri-icon-left-triangle-arrow",iconRightTriangleArrow:"esri-icon-right-triangle-arrow",iconDockToTop:"esri-icon-maximize",iconDockToBottom:"esri-icon-dock-bottom",iconDockToLeft:"esri-icon-dock-left",iconDockToRight:"esri-icon-dock-right",iconClose:"esri-icon-close",iconUndock:"esri-icon-minimize",iconCheckMark:"esri-icon-check-mark",iconLoading:"esri-icon-loading-indicator",iconDefaultAction:"esri-icon-default-action",iconActionsMenu:"esri-icon-handle-horizontal",rotating:"esri-rotating",base:"esri-popup",widget:"esri-widget",main:"esri-popup__main-container",loadingContainer:"esri-popup__loading-container",isCollapsible:"esri-popup--is-collapsible",isCollapsed:"esri-popup--is-collapsed",shadow:"esri-popup--shadow",isDocked:"esri-popup--is-docked",isDockedTopLeft:"esri-popup--is-docked-top-left",isDockedTopCenter:"esri-popup--is-docked-top-center",isDockedTopRight:"esri-popup--is-docked-top-right",isDockedBottomLeft:"esri-popup--is-docked-bottom-left",isDockedBottomCenter:"esri-popup--is-docked-bottom-center",isDockedBottomRight:"esri-popup--is-docked-bottom-right",alignTopCenter:"esri-popup--aligned-top-center",alignBottomCenter:"esri-popup--aligned-bottom-center",alignTopLeft:"esri-popup--aligned-top-left",alignBottomLeft:"esri-popup--aligned-bottom-left",alignTopRight:"esri-popup--aligned-top-right",alignBottomRight:"esri-popup--aligned-bottom-right",isFeatureMenuOpen:"esri-popup--feature-menu-open",isActionsMenuOpen:"esri-popup--actions-menu-open",hasFeatureUpdated:"esri-popup--feature-updated",header:"esri-popup__header",headerButtons:"esri-popup__header-buttons",headerContainer:"esri-popup__header-container",headerContainerButton:"esri-popup__header-container--button",headerTitle:"esri-popup__header-title",content:"esri-popup__content",contentHasFlows:"esri-content--has-flows",contentFlowItem:"esri-content__flow-item",footer:"esri-popup__footer",footerHasPagination:"esri-popup__footer--has-pagination",footerHasActions:"esri-popup__footer--has-actions",footerHasActionsMenu:"esri-popup__footer--has-actions-menu",button:"esri-popup__button",buttonDisabled:"esri-popup__button--disabled",buttonDock:"esri-popup__button--dock",icon:"esri-popup__icon",iconDock:"esri-popup__icon--dock-icon",inlineActionsContainer:"esri-popup__inline-actions-container",actionsMenuButton:"esri-popup__actions-menu-button",actions:"esri-popup__actions",action:"esri-popup__action",actionImage:"esri-popup__action-image",actionText:"esri-popup__action-text",actionToggle:"esri-popup__action-toggle",actionToggleOn:"esri-popup__action-toggle--on",actionExit:"esri-popup__action--exit",pointer:"esri-popup__pointer",pointerDirection:"esri-popup__pointer-direction",navigation:"esri-popup__navigation",paginationPrevious:"esri-popup__pagination-previous",paginationNext:"esri-popup__pagination-next",paginationPreviousIconLTR:"esri-popup__pagination-previous-icon",paginationPreviousIconRTL:"esri-popup__pagination-previous-icon--rtl",paginationNextIconLTR:"esri-popup__pagination-next-icon",paginationNextIconRTL:"esri-popup__pagination-next-icon--rtl",featureMenu:"esri-popup__feature-menu",featureMenuList:"esri-popup__feature-menu-list",featureMenuItem:"esri-popup__feature-menu-item",featureMenuViewport:"esri-popup__feature-menu-viewport",featureMenuHeader:"esri-popup__feature-menu-header",featureMenuNote:"esri-popup__feature-menu-note",featureMenuSelected:"esri-popup__feature-menu-item--selected",featureMenuButton:"esri-popup__feature-menu-button",featureMenuTitle:"esri-popup__feature-menu-title",featureMenuObserver:"esri-popup__feature-menu-observer",featureMenuLoader:"esri-popup__feature-menu-loader",collapseButton:"esri-popup__collapse-button",collapseIcon:"esri-popup__collapse-icon"},pV={buttonEnabled:!0,position:"auto",breakpoint:{width:544}},mV="esri-popup";function _u(i,e){return e===void 0?`${mV}__${i}`:`${mV}__${i}-${e}`}const fV={closeButton:!0,featureNavigation:!0};let Qe=class extends wW(Hn){constructor(e,t){super(e,t),this._blurClose=!1,this._blurContainer=!1,this._containerNode=null,this._mainContainerNode=null,this._featureMenuNode=null,this._actionsMenuNode=null,this._focusClose=!1,this._focusContainer=!1,this._focusDockButton=!1,this._focusFeatureMenuButton=!1,this._focusActionsMenuButton=!1,this._focusFirstFeature=!1,this._focusFirstAction=!1,this._handles=new Vt,this._pointerOffsetInPx=16,this._spinner=null,this._feature=null,this._featureMenuIntersectionObserverCallback=([r])=>{r!=null&&r.isIntersecting&&this.viewModel.featurePage++},this._featureMenuIntersectionObserver=new IntersectionObserver(this._featureMenuIntersectionObserverCallback,{root:window.document}),this._displaySpinnerThrottled=$0(()=>this._displaySpinner(),lpe),this._exitRelatedRecordsActions=new WeakMap,this._flowItems=new wt,this.alignment="auto",this.collapsed=!1,this.collapseEnabled=!0,this.dockEnabled=!1,this.featureMenuOpen=!1,this.headingLevel=2,this.maxInlineActions=3,this.messages=null,this.messagesCommon=null,this.spinnerEnabled=!0,this.viewModel=new AW,this.visibleElements={...fV},this._addSelectedFeatureIndexHandle(),this.addHandles([B(()=>{var r;return(r=this.viewModel)==null?void 0:r.screenLocation},()=>this._positionContainer()),B(()=>{var r;return[(r=this.viewModel)==null?void 0:r.active,this.dockEnabled]},()=>this._toggleScreenLocationEnabled()),B(()=>{var r;return(r=this.viewModel)==null?void 0:r.screenLocation},(r,n)=>{!!r!=!!n&&this.reposition()}),B(()=>{var r,n,s,a,o,l;return[(n=(r=this.viewModel)==null?void 0:r.view)==null?void 0:n.padding,(a=(s=this.viewModel)==null?void 0:s.view)==null?void 0:a.size,(o=this.viewModel)==null?void 0:o.active,(l=this.viewModel)==null?void 0:l.location,this.alignment]},()=>this.reposition()),B(()=>this.spinnerEnabled,r=>this._spinnerEnabledChange(r)),B(()=>{var r,n;return(n=(r=this.viewModel)==null?void 0:r.view)==null?void 0:n.size},(r,n)=>this._updateDockEnabledForViewSize(r,n)),B(()=>{var r;return(r=this.viewModel)==null?void 0:r.view},(r,n)=>this._viewChange(r,n)),B(()=>{var r,n;return(n=(r=this.viewModel)==null?void 0:r.view)==null?void 0:n.ready},(r,n)=>this._viewReadyChange(r,n)),B(()=>{var r,n;return[(r=this.viewModel)==null?void 0:r.waitingForResult,(n=this.viewModel)==null?void 0:n.location]},()=>{this._hideSpinner(),this._displaySpinnerThrottled()}),B(()=>this.selectedFeatureWidget,()=>this._destroyFlowItemWidgets()),B(()=>{var r,n,s,a;return[(n=(r=this.selectedFeatureWidget)==null?void 0:r.viewModel)==null?void 0:n.title,(a=(s=this.selectedFeatureWidget)==null?void 0:s.viewModel)==null?void 0:a.state]},()=>this._setTitleFromFeatureWidget()),B(()=>{var r,n,s,a;return[(n=(r=this.selectedFeatureWidget)==null?void 0:r.viewModel)==null?void 0:n.content,(a=(s=this.selectedFeatureWidget)==null?void 0:s.viewModel)==null?void 0:a.state]},()=>this._setContentFromFeatureWidget()),cs(()=>!this.collapsed,()=>{var r,n;((n=(r=this.viewModel)==null?void 0:r.view)==null?void 0:n.widthBreakpoint)==="xsmall"&&this.viewModel.active&&this.collapseEnabled&&this.viewModel.centerAtLocation()}),wr(()=>{var r;return(r=this.viewModel)==null?void 0:r.allActions},"change",()=>this._watchActions()),B(()=>{var r;return(r=this.viewModel)==null?void 0:r.allActions},()=>this._watchActions(),et),B(()=>{var r;return(r=this.viewModel)==null?void 0:r.featureViewModels},()=>this._featureMenuViewportScrollTop()),wr(()=>this._flowItems,"change",()=>{this.notifyChange("_activeFlowItemWidget"),this.scheduleRender()}),B(()=>{var r,n,s,a;return[(n=(r=this._activeFlowItemWidget)==null?void 0:r.viewModel)==null?void 0:n.state,(a=(s=this._activeFlowItemWidget)==null?void 0:s.viewModel)==null?void 0:a.title]},()=>this.scheduleRender())])}loadDependencies(){return Promise.all([j(()=>import("./calcite-flow-2e30cea8.js"),["assets/calcite-flow-2e30cea8.js","assets/widget-fb292a2f.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/intl-65a3e389.js","assets/number-27cf8195.js","assets/jsonMap-7b8332c9.js","assets/locale-30120714.js","assets/messages-2289086c.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/assets-8d3e737a.js","assets/Evented-a45c8b0f.js","assets/Promise-376ab9f6.js","assets/reactiveUtils-4dabbb80.js","assets/uuid-73213768.js","assets/observers-edc9938f.js"]),j(()=>import("./calcite-flow-item-8e6353bf.js"),["assets/calcite-flow-item-8e6353bf.js","assets/widget-fb292a2f.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/intl-65a3e389.js","assets/number-27cf8195.js","assets/jsonMap-7b8332c9.js","assets/locale-30120714.js","assets/messages-2289086c.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/assets-8d3e737a.js","assets/Evented-a45c8b0f.js","assets/Promise-376ab9f6.js","assets/reactiveUtils-4dabbb80.js","assets/uuid-73213768.js","assets/guid-e49c4e43.js","assets/action-0ae695b2.js","assets/observers-edc9938f.js","assets/interactive-52dcf836.js","assets/icon-40b00e67.js","assets/tooltip-a9404009.js"]),j(()=>import("./calcite-action-a94942fd.js"),["assets/calcite-action-a94942fd.js","assets/action-0ae695b2.js","assets/widget-fb292a2f.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/intl-65a3e389.js","assets/number-27cf8195.js","assets/jsonMap-7b8332c9.js","assets/locale-30120714.js","assets/messages-2289086c.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/assets-8d3e737a.js","assets/Evented-a45c8b0f.js","assets/Promise-376ab9f6.js","assets/reactiveUtils-4dabbb80.js","assets/uuid-73213768.js","assets/observers-edc9938f.js","assets/interactive-52dcf836.js","assets/icon-40b00e67.js","assets/guid-e49c4e43.js"]),j(()=>import("./calcite-tooltip-deda8ecc.js"),["assets/calcite-tooltip-deda8ecc.js","assets/tooltip-a9404009.js","assets/widget-fb292a2f.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/intl-65a3e389.js","assets/number-27cf8195.js","assets/jsonMap-7b8332c9.js","assets/locale-30120714.js","assets/messages-2289086c.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/assets-8d3e737a.js","assets/Evented-a45c8b0f.js","assets/Promise-376ab9f6.js","assets/reactiveUtils-4dabbb80.js","assets/uuid-73213768.js","assets/guid-e49c4e43.js"]),j(()=>import("./calcite-icon-938ab0b8.js"),["assets/calcite-icon-938ab0b8.js","assets/icon-40b00e67.js","assets/widget-fb292a2f.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/intl-65a3e389.js","assets/number-27cf8195.js","assets/jsonMap-7b8332c9.js","assets/locale-30120714.js","assets/messages-2289086c.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/assets-8d3e737a.js","assets/Evented-a45c8b0f.js","assets/Promise-376ab9f6.js","assets/reactiveUtils-4dabbb80.js","assets/uuid-73213768.js","assets/observers-edc9938f.js"])])}destroy(){var e,t;this._destroyFlowItemWidgets(),this._destroySelectedFeatureWidget(),this._destroySpinner(),(e=this._handles)==null||e.destroy(),this._unobserveFeatureMenuObserver(),(t=this._featureMenuIntersectionObserver)==null||t.disconnect(),this._handles=null}get actionsMenuId(){return`${this.id}-actions-menu`}get actionsMenuButtonId(){return`${this.id}-actions-menu-button`}get featureMenuId(){return`${this.id}-feature-menu`}get titleId(){return`${this.id}-popup-title`}get contentId(){return`${this.id}-popup-content`}get hasContent(){const{selectedFeatureWidget:e,viewModel:t}=this;if(!e)return!!(t!=null&&t.content);const r=e.viewModel;if(r!=null&&r.waitingForContent||(r==null?void 0:r.state)==="error")return!0;const n=r==null?void 0:r.content;return Array.isArray(n)?!!n.length:!!n}get featureNavigationVisible(){return this.viewModel.active&&this.viewModel.featureCount>1&&this.visibleElements.featureNavigation}get collapsible(){return!!(this.collapseEnabled&&this.viewModel.title&&this.hasContent)}get featureMenuVisible(){return this.featureNavigationVisible&&this.featureMenuOpen}get contentCollapsed(){return this.collapsible&&!this.featureMenuVisible&&this.collapsed}get dividedActions(){return this._divideActions()}get _activeFlowItemWidget(){const{_flowItems:e}=this;return e.getItemAt(e.length-1)||null}get actions(){return this.viewModel.actions}set actions(e){this.viewModel.actions=e}set actionsMenuOpen(e){this._set("actionsMenuOpen",!!e)}get actionsMenuOpen(){return!!this.viewModel.active&&this._get("actionsMenuOpen")}get autoCloseEnabled(){return this.viewModel.autoCloseEnabled}set autoCloseEnabled(e){this.viewModel.autoCloseEnabled=e}get autoOpenEnabled(){return this.viewModel.autoOpenEnabled}set autoOpenEnabled(e){this.viewModel.autoOpenEnabled=e}get defaultPopupTemplateEnabled(){return this.viewModel.defaultPopupTemplateEnabled}set defaultPopupTemplateEnabled(e){this.viewModel.defaultPopupTemplateEnabled=e}get content(){return this.viewModel.content}set content(e){this.viewModel.content=e}get currentAlignment(){return this._getCurrentAlignment()}get currentDockPosition(){return this._getCurrentDockPosition()}get dockOptions(){return this._get("dockOptions")||pV}set dockOptions(e){const t={...pV},r=this.get("viewModel.view.breakpoints"),n={};r&&(n.width=r.xsmall,n.height=r.xsmall);const s={...t,...e},a={...t.breakpoint,...n},{breakpoint:o}=s;o===!0?s.breakpoint=a:typeof o=="object"&&(s.breakpoint={...a,...o}),this._set("dockOptions",s),this._setCurrentDockPosition(),this.reposition()}get featureCount(){return this.viewModel.featureCount}get features(){return this.viewModel.features}set features(e){this.viewModel.features=e}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get highlightEnabled(){return this.viewModel.highlightEnabled}set highlightEnabled(e){this.viewModel.highlightEnabled=e}get location(){return this.viewModel.location}set location(e){this.viewModel.location=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get promises(){return this.viewModel.promises}set promises(e){this.viewModel.promises=e}get selectedFeature(){return this.viewModel.selectedFeature}get selectedFeatureIndex(){return this.viewModel.selectedFeatureIndex}set selectedFeatureIndex(e){this.viewModel.selectedFeatureIndex=e}get selectedFeatureWidget(){const{_feature:e,visibleElements:t,headingLevel:r,_flowItems:n}=this,{selectedFeatureViewModel:s}=this.viewModel,a={...t,title:!1};return s?(e?(e.viewModel=s,e.visibleElements=a):this._feature=new Nde({flowItems:n,headingLevel:r+1,viewModel:s,visibleElements:a}),this._feature):null}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}get updateLocationEnabled(){return this.viewModel.updateLocationEnabled}set updateLocationEnabled(e){this.viewModel.updateLocationEnabled=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get visible(){return this.viewModel.visible}set visible(e){this.viewModel.visible=e}castVisibleElements(e){return{...fV,...e}}blur(){const{active:e}=this.viewModel;e||ee.getLogger(this.declaredClass).warn("Popup can only be blurred when currently active."),this.visibleElements.closeButton?this._blurClose=!0:this._blurContainer=!0,this.scheduleRender()}clear(){return this.viewModel.clear()}close(){this.visible=!1}fetchFeatures(e,t){return this.viewModel.fetchFeatures(e,t)}focus(){const{active:e}=this.viewModel;e||ee.getLogger(this.declaredClass).warn("Popup can only be focused when currently active."),this.visibleElements.closeButton?this._focusClose=!0:this._focusContainer=!0,this.scheduleRender()}next(){return this.viewModel.next()}open(e){var s,a;this._handles.remove(uV);const t=!!e&&!!e.featureMenuOpen,r=!!e&&!!e.actionsMenuOpen,n={collapsed:!!e&&!!e.collapsed,actionsMenuOpen:r,featureMenuOpen:t};((a=(s=this.viewModel)==null?void 0:s.view)==null?void 0:a.widthBreakpoint)==="xsmall"&&(n.collapsed=!0),this.set(n),this.viewModel.open(e),this._shouldFocus(e),this._addSelectedFeatureIndexHandle()}previous(){return this.viewModel.previous()}reposition(){this.renderNow(),this._positionContainer(),this._setCurrentAlignment()}triggerAction(e){return this.viewModel.triggerAction(e)}render(){var g,w,v,b;const{actionsMenuOpen:e,dockEnabled:t,featureMenuVisible:r,dividedActions:n,currentAlignment:s,currentDockPosition:a}=this,{active:o}=this.viewModel,{menuActions:l}=n,c=o&&l.length>1&&e,u=o&&t,d=o&&!t,m=(w=(g=this.selectedFeature)==null?void 0:g.layer)==null?void 0:w.title,f=(b=(v=this.selectedFeature)==null?void 0:v.layer)==null?void 0:b.id,_={[he.alignTopCenter]:s==="top-center",[he.alignBottomCenter]:s==="bottom-center",[he.alignTopLeft]:s==="top-left",[he.alignBottomLeft]:s==="bottom-left",[he.alignTopRight]:s==="top-right",[he.alignBottomRight]:s==="bottom-right",[he.isDocked]:u,[he.shadow]:d,[he.isDockedTopLeft]:a==="top-left",[he.isDockedTopCenter]:a==="top-center",[he.isDockedTopRight]:a==="top-right",[he.isDockedBottomLeft]:a==="bottom-left",[he.isDockedBottomCenter]:a==="bottom-center",[he.isDockedBottomRight]:a==="bottom-right",[he.isFeatureMenuOpen]:r,[he.isActionsMenuOpen]:c};return N("div",{class:this.classes(he.base,_),role:"presentation","data-layer-title":m,"data-layer-id":f,bind:this,afterCreate:this._positionContainer,afterUpdate:this._positionContainer},o?[this.renderMainContainer(),this.renderPointer()]:null)}renderLoadingIcon(){return N("span",{"aria-hidden":"true",class:this.classes(he.icon,he.iconLoading,he.rotating)})}renderNavigationLoading(){const{messagesCommon:e}=this;return this.viewModel.pendingPromisesCount?N("div",{key:_u("loading-container"),role:"presentation",class:he.loadingContainer,"aria-label":e.loading,title:e.loading},this.renderLoadingIcon()):null}renderPreviousIcon(){const e=zh(this.container),t={[he.iconRightTriangleArrow]:e,[he.paginationPreviousIconRTL]:e,[he.iconLeftTriangleArrow]:!e,[he.paginationPreviousIconLTR]:!e};return N("span",{"aria-hidden":"true",class:this.classes(he.icon,t)})}renderPreviousButton(){const{messages:e}=this;return N("div",{role:"button",tabIndex:0,bind:this,onclick:this._previous,onkeydown:this._previous,class:this.classes(he.button,he.paginationPrevious),"aria-label":e.previous,title:e.previous},this.renderPreviousIcon())}renderNextIcon(){const e=zh(this.container),t={[he.iconLeftTriangleArrow]:e,[he.paginationNextIconRTL]:e,[he.iconRightTriangleArrow]:!e,[he.paginationNextIconLTR]:!e};return N("span",{"aria-hidden":"true",class:this.classes(he.icon,t)})}renderNextButton(){const{messages:e}=this;return N("div",{role:"button",tabIndex:0,bind:this,onclick:this._next,onkeydown:this._next,class:this.classes(he.button,he.paginationNext),"aria-label":e.next,title:e.next},this.renderNextIcon())}renderFeatureMenuButton(){const{featureMenuOpen:e,featureMenuId:t,messagesCommon:r}=this,{featureCount:n,selectedFeatureIndex:s}=this.viewModel;return N("div",{role:"button",tabIndex:0,bind:this,onclick:this._toggleFeatureMenu,onkeydown:this._toggleFeatureMenu,afterCreate:this._focusFeatureMenuButtonNode,afterUpdate:this._focusFeatureMenuButtonNode,class:this.classes(he.button,he.featureMenuButton),"aria-haspopup":"true","aria-controls":t,"aria-expanded":e.toString(),"aria-label":r.menu,title:r.menu},this._getPageText(n,s))}renderNavigationButtons(){return this.featureNavigationVisible?[this.renderPreviousButton(),this.renderNavigationLoading()||this.renderFeatureMenuButton(),this.renderNextButton()]:null}renderDockIcon(){const{dockEnabled:e}=this,t=this._wouldDockTo(),r={[he.iconUndock]:e,[he.iconDock]:!e,[he.iconDockToRight]:!e&&(t==="top-right"||t==="bottom-right"),[he.iconDockToLeft]:!e&&(t==="top-left"||t==="bottom-left"),[he.iconDockToTop]:!e&&t==="top-center",[he.iconDockToBottom]:!e&&t==="bottom-center"};return N("span",{"aria-hidden":"true",class:this.classes(r,he.icon)})}renderDockButton(){var s,a,o;const{dockEnabled:e,messages:t}=this,r=(a=(s=this.viewModel)==null?void 0:s.view)==null?void 0:a.widthBreakpoint,n=e?t.undock:t.dock;return r!=="xsmall"&&((o=this.dockOptions)!=null&&o.buttonEnabled)?N("div",{role:"button","aria-label":n,title:n,tabIndex:0,bind:this,onclick:this._toggleDockEnabled,onkeydown:this._toggleDockEnabled,afterCreate:this._focusDockButtonNode,afterUpdate:this._focusDockButtonNode,class:this.classes(he.button,he.buttonDock)},this.renderDockIcon()):null}renderTitle(){const{title:e}=this.viewModel,{titleId:t,collapsible:r,contentCollapsed:n,messagesCommon:s}=this,a={[he.headerContainerButton]:r},o=N(lN,{level:this.headingLevel,class:he.headerTitle,innerHTML:e}),l=r?N("button",{key:`${e}--collapsible`,id:t,title:n?s.expand:s.collapse,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes(he.headerContainer,a),"aria-expanded":n?"false":"true",onclick:this._toggleCollapsed,type:"button"},o,N("calcite-icon",{class:he.collapseIcon,key:"collapse-icon",icon:n?"chevron-down":"chevron-up",scale:"m"})):N("div",{key:e,id:t,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes(he.headerContainer,a)},o);return e?l:null}renderCloseIcon(){return N("span",{"aria-hidden":"true",class:this.classes(he.icon,he.iconClose)})}renderCloseButton(){const{visibleElements:e,messagesCommon:t}=this;return e.closeButton?N("div",{role:"button",tabIndex:0,bind:this,onclick:this._close,onkeydown:this._close,class:he.button,"aria-label":t.close,title:t.close,afterCreate:this._closeButtonNodeUpdated,afterUpdate:this._closeButtonNodeUpdated},this.renderCloseIcon()):null}renderHeader(){return N("header",{class:he.header},this.renderTitle(),N("div",{class:he.headerButtons},this.renderDockButton(),this.renderCloseButton()))}renderContentContainer(){const{contentId:e,hasContent:t,contentCollapsed:r,_flowItems:n,messagesCommon:s}=this,{content:a}=this.viewModel,o=n.toArray(),l={[he.contentHasFlows]:!!o.length};return t&&!r?N("div",{key:a,enterAnimation:this._createFeatureUpdatedAnimation(),id:e,class:this.classes(he.content,l)},N("calcite-flow",{bind:this,onCalciteFlowItemBack:this._handleBackClick},N("calcite-flow-item",{bind:this,"data-node-ref":"_rootFlowItemNode","intl-back":s.back,afterCreate:VE,key:"root-flow-item"},this.renderContent()),o.map(c=>this.renderFlowItem(c))),o.map(c=>this.renderFlowItemTooltip(c))):null}renderFlowItem(e){const{messages:t,messagesCommon:r}=this,n=A2();return N("calcite-flow-item",{class:this.classes({[he.calciteThemeDark]:!n,[he.calciteThemeLight]:n}),heading:e.title,"intl-back":r.back,description:this._getFlowItemDescription(e),key:`flow-item-${e.viewModel.uid}`},N("calcite-action",{class:he.actionExit,icon:"move-up",label:t==null?void 0:t.exitRelatedRecords,text:t==null?void 0:t.exitRelatedRecords,slot:"header-actions-start",bind:this,afterCreate:s=>this._storeExitRelatedRecordsAction(e,s),onclick:this._destroyFlowItemWidgets}),N("div",{class:this.classes(he.contentFlowItem,{[he.calciteThemeDark]:n,[he.calciteThemeLight]:!n})},e.render()))}renderFlowItemTooltip(e){const{messages:t,_exitRelatedRecordsActions:r}=this,n=A2();return N("calcite-tooltip",{class:this.classes({[he.calciteThemeDark]:!n,[he.calciteThemeLight]:n}),key:`exit-related-records-tooltip-${e.viewModel.uid}`,label:t==null?void 0:t.exitRelatedRecords,overlayPositioning:"fixed",referenceElement:r.get(e),placement:"top"},t==null?void 0:t.exitRelatedRecords)}renderActionsMenuButton(){const{actionsMenuId:e,actionsMenuButtonId:t,actionsMenuOpen:r,dividedActions:n,messagesCommon:s}=this,a=r?s.close:s.open,{menuActions:o}=n;return o.length?N("div",{key:_u("actions-menu-button"),class:this.classes(he.button,he.actionsMenuButton),role:"button",id:t,"aria-haspopup":"true","aria-controls":r?e:null,tabIndex:0,bind:this,onclick:this._toggleActionsMenu,onkeydown:this._toggleActionsMenu,afterCreate:this._focusActionsMenuButtonNode,afterUpdate:this._focusActionsMenuButtonNode,"aria-label":a,title:a},N("span",{"aria-hidden":"true",class:he.iconActionsMenu})):null}renderMenuActions(){const{actionsMenuId:e,actionsMenuButtonId:t,actionsMenuOpen:r,dividedActions:n}=this,{menuActions:s}=n;return s.length&&r?N("ul",{id:e,role:"menu","aria-labelledby":t,key:_u("actions"),class:he.actions,bind:this,onkeyup:this._handleActionMenuKeyup,afterCreate:this._actionsMenuNodeUpdated,afterUpdate:this._actionsMenuNodeUpdated},s.toArray().map(a=>this.renderAction({action:a,type:"menu-item"}))):null}renderInlineActions(){const{inlineActions:e}=this.dividedActions;return!!e.length&&e.toArray().map(t=>this.renderAction({action:t,type:"inline"}))}renderInlineActionsContainer(){const{inlineActions:e,menuActions:t}=this.dividedActions,r=!!e.length,n=!!t.length;return r||n?N("div",{key:"inline-actions-container","data-inline-actions":r.toString(),"data-menu-actions":n.toString(),class:he.inlineActionsContainer},this.renderInlineActions(),this.renderActionsMenuButton(),this.renderMenuActions()):null}renderNavigation(){return this.featureNavigationVisible?N("section",{key:_u("navigation"),class:this.classes(he.navigation)},this.renderNavigationButtons()):null}renderFooter(){const{featureNavigationVisible:e,dividedActions:t}=this,{inlineActions:r,menuActions:n}=t,s=!!r.length,a=!!n.length,o={[he.footerHasPagination]:e,[he.footerHasActions]:s,[he.footerHasActionsMenu]:a};return e||s?N("div",{key:_u("feature-buttons"),class:this.classes(he.footer,o)},this.renderInlineActionsContainer(),this.renderNavigation()):null}renderFeatureMenuContainer(){const{messages:e}=this,{featureViewModels:t,isLoadingFeature:r}=this.viewModel,n=gc(e.selectedFeatures,{total:t.length});return N("section",{key:_u("menu"),class:he.featureMenu},N("strong",{class:he.featureMenuHeader},n),N("nav",{bind:this,class:he.featureMenuViewport,"data-node-ref":"_featureMenuViewportNode",afterCreate:VE},this.renderFeatureMenu(),N("div",{class:he.featureMenuObserver,bind:this,afterCreate:this._featureMenuIntersectionObserverCreated}),r?N("div",{class:he.featureMenuLoader},this.renderLoadingIcon()):null))}renderPointer(){return this.dockEnabled?null:N("div",{key:_u("pointer"),class:he.pointer,role:"presentation"},N("div",{class:this.classes(he.pointerDirection,he.shadow)}))}renderMainContainer(){const{dockEnabled:e,currentAlignment:t,currentDockPosition:r,titleId:n,contentId:s,collapsible:a,hasContent:o,contentCollapsed:l,visibleElements:c}=this,{title:u}=this.viewModel,d=t==="bottom-left"||t==="bottom-center"||t==="bottom-right"||r==="top-left"||r==="top-center"||r==="top-right",m=t==="top-left"||t==="top-center"||t==="top-right"||r==="bottom-left"||r==="bottom-center"||r==="bottom-right",f={[he.shadow]:e,[he.isCollapsible]:a,[he.isCollapsed]:l};return N("div",{class:this.classes(he.main,he.widget,f),tabIndex:c.closeButton?null:-1,role:"dialog","aria-labelledby":u?n:"","aria-describedby":o&&!l?s:"",bind:this,onkeyup:this._handleMainKeyup,afterCreate:this._mainContainerNodeUpdated,afterUpdate:this._mainContainerNodeUpdated},d?this.renderFooter():null,d?this.renderFeatureMenuContainer():null,this.renderHeader(),this.renderContentContainer(),m?this.renderFooter():null,m?this.renderFeatureMenuContainer():null)}renderContent(){var t;const e=(t=this.viewModel)==null?void 0:t.content;return e?typeof e=="string"?N("div",{class:_r.contentNode,key:e,innerHTML:e}):this.renderNodeContent(e):null}renderActionText(e){return N("span",{key:"text",class:he.actionText},e)}renderActionIcon(e){const t=this._getActionClass(e),r=this._getActionImage(e),n={[he.iconLoading]:e.active,[he.rotating]:e.active,[he.icon]:!!t,[he.actionImage]:!e.active&&!!r};return t&&(n[t]=!e.active),N("span",{key:"icon","aria-hidden":"true",class:this.classes(he.icon,n),styles:this._getIconStyles(r)})}renderAction(e){const{action:t,type:r}=e,n=this._getActionTitle(t),s={[he.action]:t.type!=="toggle",[he.actionToggle]:t.type==="toggle",[he.actionToggleOn]:t.type==="toggle"&&t.value,[he.buttonDisabled]:t.disabled},a=[this.renderActionIcon(t),this.renderActionText(n)],o=r==="menu-item"?N("li",{key:t.uid,role:"menuitem",tabIndex:0,title:n,"aria-label":n,class:this.classes(he.button,s),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-uid":t.uid,onclick:this._triggerAction,onkeydown:this._triggerAction},a):N("div",{key:t.uid,role:"button",tabIndex:0,title:n,"aria-label":n,class:this.classes(he.button,s),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-uid":t.uid,onclick:this._triggerAction,onkeydown:this._triggerAction},a);return t.visible?o:null}renderFeatureMenuItem(e,t){const{messages:r,messagesCommon:n}=this,{selectedFeatureIndex:s,selectedFeatureViewModel:a}=this.viewModel,o=e===a,l={[he.featureMenuSelected]:o},c=o?N("span",{key:_u(`feature-menu-selected-feature-${s}`),title:r.selectedFeature,"aria-label":r.selectedFeature,class:he.iconCheckMark}):null,u=N("span",{innerHTML:e.title||n.untitled});return N("li",{role:"menuitem",tabIndex:-1,key:_u(`feature-menu-feature-${s}`),class:this.classes(l,he.featureMenuItem),bind:this,"data-feature-index":t,onblur:this._removeActiveFeature,onfocus:this._setActiveFeature,onkeyup:this._handleFeatureMenuItemKeyup,onclick:this._selectFeature,onkeydown:this._selectFeature,onmouseover:this._setActiveFeature,onmouseleave:this._removeActiveFeature},N("span",{class:he.featureMenuTitle},u,c))}renderFeatureMenu(){const{featureMenuId:e}=this,{featureViewModels:t}=this.viewModel;return t.length>1?N("ol",{class:he.featureMenuList,id:e,bind:this,afterCreate:this._featureMenuNodeUpdated,afterUpdate:this._featureMenuNodeUpdated,onkeyup:this._handleFeatureMenuKeyup,role:"menu"},t.filter(r=>!!r.graphic).map((r,n)=>this.renderFeatureMenuItem(r,n))):null}_storeExitRelatedRecordsAction(e,t){this._exitRelatedRecordsActions.set(e,t),this.scheduleRender()}_getFlowItemDescription(e){return"featureCountDescription"in e?e.featureCountDescription:e.viewModel.description}_destroyFlowItemWidgets(){this._flowItems.removeAll().forEach(e=>{"showAllEnabled"in e.viewModel&&(e.viewModel.showAllEnabled=!1),e.viewModel=null,e.destroy()})}_handleBackClick(){const e=this._flowItems.pop();this._exitRelatedRecordsActions.delete(e),"showAllEnabled"in e.viewModel&&(e.viewModel.showAllEnabled=!1),e&&(e.viewModel=null,e.destroy())}_getActionTitle(e){const{messages:t,selectedFeature:r,messagesCommon:n}=this,{id:s}=e,a=r==null?void 0:r.attributes,o=s==="zoom-to-feature"?gc(e.title,{messages:t}):s==="remove-selected-feature"?gc(e.title,{messages:n}):s==="zoom-to-clustered-features"||s==="browse-clustered-features"?gc(e.title,{messages:t}):e.title;return o&&a?gc(o,a):o}_getActionClass(e){const{selectedFeature:t}=this,r=t==null?void 0:t.attributes,{className:n,image:s}=e,a=s||n?n:he.iconDefaultAction;return a&&r?gc(a,r):a}_getActionImage(e){const{selectedFeature:t}=this,r=t==null?void 0:t.attributes,{image:n}=e;return n&&r?gc(n,r):n}_createFeatureUpdatedAnimation(){return tie("enter",he.hasFeatureUpdated)}_getInlineActionCount(){const{maxInlineActions:e,featureNavigationVisible:t}=this;if(typeof e!="number")return null;const r=Math.round(e);return Math.max(t?r-1:r,0)}_watchActions(){const{allActions:e}=this.viewModel;this.notifyChange("dividedActions");const t="actions";this._handles.remove(t),e&&e.forEach(r=>{this._handles.add(B(()=>[r.uid,r.active,r.className,r.disabled,r.id,r.title,r.image,r.visible],()=>this.scheduleRender()),t)})}_divideActions(){const{allActions:e}=this.viewModel,t=e.filter(a=>a.visible),r=this._getInlineActionCount(),n=r===null,s=r===0;return{inlineActions:n?t.slice(0):s?new wt:t.slice(0,r),menuActions:n?new wt:s?t.slice(0):t.slice(r)}}_featureMenuOpenChanged(e){e?this._focusFirstFeature=!0:this._focusFeatureMenuButton=!0}_actionsMenuOpenChanged(e){e?this._focusFirstAction=!0:this._focusActionsMenuButton=!0}_setTitleFromFeatureWidget(){var r,n;const{selectedFeatureWidget:e,messagesCommon:t}=this;e&&(this.viewModel.title=((r=e.viewModel)==null?void 0:r.state)==="error"?t.errorMessage:((n=e.viewModel)==null?void 0:n.title)||"")}_setContentFromFeatureWidget(){const{selectedFeatureWidget:e}=this;e&&(this.viewModel.content=e)}_unobserveFeatureMenuObserver(){this._featureMenuIntersectionObserverNode&&this._featureMenuIntersectionObserver.unobserve(this._featureMenuIntersectionObserverNode)}_featureMenuIntersectionObserverCreated(e){this._unobserveFeatureMenuObserver(),this._featureMenuIntersectionObserver.observe(e),this._featureMenuIntersectionObserverNode=e}_handleFeatureMenuKeyup(e){Ol(e)==="Escape"&&(e.stopPropagation(),this._focusFeatureMenuButton=!0,this.featureMenuOpen=!1,this.scheduleRender())}_handleActionMenuKeyup(e){Ol(e)==="Escape"&&(e.stopPropagation(),this._focusActionsMenuButton=!0,this.actionsMenuOpen=!1,this.scheduleRender())}_setActiveFeature(e){const{viewModel:t}=this,r=e.currentTarget["data-feature-index"];t.activeFeature=t.features[r]||null}_removeActiveFeature(){this.viewModel.activeFeature=null}_handleFeatureMenuItemKeyup(e){const t=Ol(e),{_featureMenuNode:r}=this,n=e.currentTarget["data-feature-index"];if(!r)return;const s=r.querySelectorAll("li"),a=s.length;t!=="ArrowUp"?t!=="ArrowDown"?t!=="Home"?t!=="End"||(e.stopPropagation(),s[s.length-1].focus()):(e.stopPropagation(),s[0].focus()):(e.stopPropagation(),s[(n+1+a)%a].focus()):(e.stopPropagation(),s[(n-1+a)%a].focus())}_handleActionMenuItemKeyup(e){const t=Ol(e),{_actionsMenuNode:r}=this,n=e.currentTarget.dataset.actionUid,{menuActions:s}=this.dividedActions,a=s.findIndex(c=>c.uid===n);if(!r)return;const o=r.querySelectorAll("li"),l=o.length;t!=="ArrowUp"?t!=="ArrowDown"?t!=="Home"?t!=="End"||(e.stopPropagation(),o[o.length-1].focus()):(e.stopPropagation(),o[0].focus()):(e.stopPropagation(),o[(a+1+l)%l].focus()):(e.stopPropagation(),o[(a-1+l)%l].focus())}_handleMainKeyup(e){const t=Ol(e);t==="ArrowLeft"&&(e.stopPropagation(),this.previous()),t==="ArrowRight"&&(e.stopPropagation(),this.next())}_spinnerEnabledChange(e){if(this._destroySpinner(),!e)return;const t=this.get("viewModel.view");this._createSpinner(t)}_hideSpinner(){const{_spinner:e}=this;e&&(e.location=null,e.hide())}_displaySpinner(){const{_spinner:e}=this;if(!e)return;const{location:t,waitingForResult:r}=this.viewModel;r?e.show({location:t}):e.hide()}_getIconStyles(e){return{"background-image":e?`url(${e})`:""}}async _shouldFocus(e){e.shouldFocus&&(await Pm(()=>{var t;return((t=this.viewModel)==null?void 0:t.active)===!0}),this.focus())}_addSelectedFeatureIndexHandle(){const e=B(()=>{var t;return(t=this.viewModel)==null?void 0:t.selectedFeatureIndex},(t,r)=>this._selectedFeatureIndexUpdated(t,r));this._handles.add(e,uV)}_selectedFeatureIndexUpdated(e,t){const{featureCount:r}=this;r&&e!==t&&e!==-1&&(this._destroyFlowItemWidgets(),this.actionsMenuOpen=!1,this.featureMenuOpen=!1,this._mainContainerNode&&(this._mainContainerNode.scrollTop=0),this._rootFlowItemNode&&this._rootFlowItemNode.scrollContentTo({top:0}))}_destroySelectedFeatureWidget(){const{_feature:e}=this;e&&(e.viewModel=null,e&&!e.destroyed&&e.destroy()),this._feature=null}_isScreenLocationWithinView(e,t){return e.x>-1&&e.y>-1&&e.x<=t.width&&e.y<=t.height}_isOutsideView(e){const{popupHeight:t,popupWidth:r,screenLocation:n,side:s,view:a}=e;if(isNaN(r)||isNaN(t)||!a||!n)return!1;const o=a.padding;return s==="right"&&n.x+r/2>a.width-o.right||s==="left"&&n.x-r/2<o.left||s==="top"&&n.y-t<o.top||s==="bottom"&&n.y+t>a.height-o.bottom}_calculateAutoAlignment(e){if(e!=="auto")return e;const{_pointerOffsetInPx:t,_containerNode:r,_mainContainerNode:n,viewModel:s}=this,{screenLocation:a,view:o}=s;if(C(a)||!o||!r)return"top-center";if(!this._isScreenLocationWithinView(a,o))return this._get("currentAlignment")||"top-center";function l(T){return parseInt(T.replace(/[^-\d\.]/g,""),10)}const c=n?window.getComputedStyle(n,null):null,u=c?l(c.getPropertyValue("max-height")):0,d=c?l(c.getPropertyValue("height")):0,{height:m,width:f}=r.getBoundingClientRect(),_=f+t,g=Math.max(m,u,d)+t,w=this._isOutsideView({popupHeight:g,popupWidth:_,screenLocation:a,side:"right",view:o}),v=this._isOutsideView({popupHeight:g,popupWidth:_,screenLocation:a,side:"left",view:o}),b=this._isOutsideView({popupHeight:g,popupWidth:_,screenLocation:a,side:"top",view:o}),x=this._isOutsideView({popupHeight:g,popupWidth:_,screenLocation:a,side:"bottom",view:o});return v?b?"bottom-right":"top-right":w?b?"bottom-left":"top-left":b?x?"top-center":"bottom-center":"top-center"}_callCurrentAlignment(e){return typeof e=="function"?e.call(this):e}_getCurrentAlignment(){const{alignment:e,dockEnabled:t}=this;return t||!this.viewModel.active?null:this._calculatePositionResult(this._calculateAutoAlignment(this._callCurrentAlignment(e)))}_setCurrentAlignment(){this._set("currentAlignment",this._getCurrentAlignment())}_setCurrentDockPosition(){this._set("currentDockPosition",this._getCurrentDockPosition())}_calculatePositionResult(e){const t=["left","right"];return zh(this.container)&&t.reverse(),e.replace(/leading/gi,t[0]).replace(/trailing/gi,t[1])}_callDockPosition(e){return typeof e=="function"?e.call(this):e}_getDockPosition(){var e;return this._calculatePositionResult(this._calculateAutoDockPosition(this._callDockPosition((e=this.dockOptions)==null?void 0:e.position)))}_getCurrentDockPosition(){return this.dockEnabled&&this.viewModel.active?this._getDockPosition():null}_wouldDockTo(){return this.dockEnabled?null:this._getDockPosition()}_calculateAutoDockPosition(e){var o;if(e!=="auto")return e;const t=(o=this.viewModel)==null?void 0:o.view,r=zh(this.container)?"top-left":"top-right";if(!t)return r;const n=t.padding||{left:0,right:0,top:0,bottom:0},s=t.width-n.left-n.right,{breakpoints:a}=t;return a&&s<=a.xsmall?"bottom-center":r}_positionContainer(e=this._containerNode){if(e&&(this._containerNode=e),!e)return;const{screenLocation:t}=this.viewModel,{width:r}=e.getBoundingClientRect(),n=this._calculatePositionStyle(t,r);n&&(e.style.top=n.top,e.style.left=n.left,e.style.bottom=n.bottom,e.style.right=n.right)}_calculateFullWidth(e){const{currentAlignment:t,_pointerOffsetInPx:r}=this;return t==="top-left"||t==="bottom-left"||t==="top-right"||t==="bottom-right"?e+r:e}_calculateAlignmentPosition(e,t,r,n){const{currentAlignment:s,_pointerOffsetInPx:a}=this,o=n/2,l=r.height-t,c=r.width-e,{padding:u}=this.view;return s==="bottom-center"?{top:t+a-u.top,left:e-o-u.left}:s==="top-left"?{bottom:l+a-u.bottom,right:c+a-u.right}:s==="bottom-left"?{top:t+a-u.top,right:c+a-u.right}:s==="top-right"?{bottom:l+a-u.bottom,left:e+a-u.left}:s==="bottom-right"?{top:t+a-u.top,left:e+a-u.left}:s==="top-center"?{bottom:l+a-u.bottom,left:e-o-u.left}:void 0}_calculatePositionStyle(e,t){const{dockEnabled:r,view:n}=this;if(!n)return;if(r)return{left:"",top:"",right:"",bottom:""};if(C(e)||!t)return;const s=this._calculateFullWidth(t),a=this._calculateAlignmentPosition(e.x,e.y,n,s);return a?{top:a.top!==void 0?`${a.top}px`:"auto",left:a.left!==void 0?`${a.left}px`:"auto",bottom:a.bottom!==void 0?`${a.bottom}px`:"auto",right:a.right!==void 0?`${a.right}px`:"auto"}:void 0}_viewChange(e,t){e&&t&&(this.close(),this.clear())}_viewReadyChange(e,t){if(e){const r=this.get("viewModel.view");this._wireUpView(r)}else t&&(this.close(),this.clear())}_wireUpView(e){if(this._destroySpinner(),!e)return;const{spinnerEnabled:t}=this;t&&this._createSpinner(e),this._setDockEnabledForViewSize(this.dockOptions)}_dockingThresholdCrossed(e,t,r){const[n,s]=e,[a,o]=t,{width:l,height:c}=r;return n<=l&&a>l||n>l&&a<=l||s<=c&&o>c||s>c&&o<=c}_updateDockEnabledForViewSize(e,t){if(!e||!t)return;const r=this.get("viewModel.view.padding")||{left:0,right:0,top:0,bottom:0},n=r.left+r.right,s=r.top+r.bottom,a=[],o=[];a[0]=e[0]-n,a[1]=e[1]-s,o[0]=t[0]-n,o[1]=t[1]-s;const{dockOptions:l}=this,c=l.breakpoint;this._dockingThresholdCrossed(a,o,c)&&this._setDockEnabledForViewSize(l),this._setCurrentDockPosition()}_focusDockButtonNode(e){this._focusDockButton&&(this._focusDockButton=!1,e.focus())}_closeButtonNodeUpdated(e){return this._focusClose?(this._focusClose=!1,void e.focus()):this._blurClose?(this._blurClose=!1,void e.blur()):void 0}_mainContainerNodeUpdated(e){return this._mainContainerNode=e,this._focusContainer?(this._focusContainer=!1,void e.focus()):this._blurContainer?(this._blurContainer=!1,void e.blur()):void 0}_featureMenuNodeUpdated(e){if(this._featureMenuNode=e,!e||!this._focusFirstFeature)return;this._focusFirstFeature=!1;const t=e.querySelectorAll("li");t.length&&t[0].focus()}_actionsMenuNodeUpdated(e){if(this._actionsMenuNode=e,!e||!this._focusFirstAction)return;this._focusFirstAction=!1;const t=e.querySelectorAll("li");t.length&&t[0].focus()}_focusFeatureMenuButtonNode(e){this._focusFeatureMenuButton&&(this._focusFeatureMenuButton=!1,e.focus())}_focusActionsMenuButtonNode(e){this._focusActionsMenuButton&&(this._focusActionsMenuButton=!1,e.focus())}_featureMenuViewportScrollTop(){this._featureMenuViewportNode&&(this._featureMenuViewportNode.scrollTop=0)}_toggleScreenLocationEnabled(){const{dockEnabled:e,viewModel:t}=this;if(!t)return;const r=t.active&&!e;t.screenLocationEnabled=r}_shouldDockAtCurrentViewSize(e){var l,c;const t=e.breakpoint,r=(c=(l=this.viewModel)==null?void 0:l.view)==null?void 0:c.ui;if(!r)return!1;const{width:n,height:s}=r;if(isNaN(n)||isNaN(s))return!1;const a=t.hasOwnProperty("width")&&n<=t.width,o=t.hasOwnProperty("height")&&s<=t.height;return a||o}_setDockEnabledForViewSize(e){e.breakpoint&&(this.dockEnabled=this._shouldDockAtCurrentViewSize(e))}_getPageText(e,t){return this.featureNavigationVisible?gc(this.messages.pageText,{index:t+1,total:e}):null}_destroySpinner(){const{_spinner:e,view:t}=this;e&&(t&&t.ui&&t.ui.remove(this._spinner,dV),e.destroy(),this._spinner=null)}_createSpinner(e){e&&(this._spinner=new Vde({view:e}),e.ui.add(this._spinner,{key:dV,position:"manual"}))}_toggleCollapsed(){this.collapsed=!this.collapsed}_close(){this.close(),this.view&&this.view.focus()}_toggleDockEnabled(){this.dockEnabled=!this.dockEnabled,this._focusDockButton=!0,this.scheduleRender()}_toggleFeatureMenu(){const e=!this.featureMenuOpen;this._featureMenuOpenChanged(e),this.actionsMenuOpen=!1,this.featureMenuOpen=e}_toggleActionsMenu(){const e=!this.actionsMenuOpen;this._actionsMenuOpenChanged(e),this.featureMenuOpen=!1,this.actionsMenuOpen=e}_triggerAction(e){const t=e.currentTarget.dataset.actionUid,{allActions:r}=this.viewModel,n=r.findIndex(a=>a.uid===t),s=r.getItemAt(n);s&&s.type==="toggle"&&(s.value=!s.value),this.actionsMenuOpen=!1,this.viewModel.triggerAction(n)}_selectFeature(e){const t=e.currentTarget["data-feature-index"];isNaN(t)||(this.viewModel.selectedFeatureIndex=t),this.featureMenuOpen=!1,this._focusFeatureMenuButton=!0,this.scheduleRender()}_next(){this.next()}_previous(){this.previous()}};h([p({readOnly:!0})],Qe.prototype,"actionsMenuId",null),h([p({readOnly:!0})],Qe.prototype,"actionsMenuButtonId",null),h([p({readOnly:!0})],Qe.prototype,"featureMenuId",null),h([p({readOnly:!0})],Qe.prototype,"titleId",null),h([p({readOnly:!0})],Qe.prototype,"contentId",null),h([p({readOnly:!0})],Qe.prototype,"hasContent",null),h([p({readOnly:!0})],Qe.prototype,"featureNavigationVisible",null),h([p({readOnly:!0})],Qe.prototype,"collapsible",null),h([p({readOnly:!0})],Qe.prototype,"featureMenuVisible",null),h([p({readOnly:!0})],Qe.prototype,"contentCollapsed",null),h([p({readOnly:!0})],Qe.prototype,"dividedActions",null),h([p({readOnly:!0,dependsOn:["_flowItems.length"]})],Qe.prototype,"_activeFlowItemWidget",null),h([p()],Qe.prototype,"actions",null),h([p()],Qe.prototype,"actionsMenuOpen",null),h([p()],Qe.prototype,"alignment",void 0),h([p()],Qe.prototype,"autoCloseEnabled",null),h([p()],Qe.prototype,"autoOpenEnabled",null),h([p()],Qe.prototype,"defaultPopupTemplateEnabled",null),h([p()],Qe.prototype,"content",null),h([p()],Qe.prototype,"collapsed",void 0),h([p()],Qe.prototype,"collapseEnabled",void 0),h([p({readOnly:!0})],Qe.prototype,"currentAlignment",null),h([p({readOnly:!0})],Qe.prototype,"currentDockPosition",null),h([p()],Qe.prototype,"dockOptions",null),h([p()],Qe.prototype,"dockEnabled",void 0),h([p({readOnly:!0})],Qe.prototype,"featureCount",null),h([p()],Qe.prototype,"featureMenuOpen",void 0),h([p()],Qe.prototype,"features",null),h([p()],Qe.prototype,"goToOverride",null),h([p()],Qe.prototype,"headingLevel",void 0),h([p()],Qe.prototype,"highlightEnabled",null),h([p()],Qe.prototype,"location",null),h([p()],Qe.prototype,"label",null),h([p()],Qe.prototype,"maxInlineActions",void 0),h([p(),_n("esri/widgets/Popup/t9n/Popup")],Qe.prototype,"messages",void 0),h([p(),_n("esri/t9n/common")],Qe.prototype,"messagesCommon",void 0),h([p()],Qe.prototype,"promises",null),h([p({readOnly:!0})],Qe.prototype,"selectedFeature",null),h([p()],Qe.prototype,"selectedFeatureIndex",null),h([p({readOnly:!0})],Qe.prototype,"selectedFeatureWidget",null),h([p()],Qe.prototype,"spinnerEnabled",void 0),h([p()],Qe.prototype,"title",null),h([p()],Qe.prototype,"updateLocationEnabled",null),h([p()],Qe.prototype,"view",null),h([p({type:AW}),Fue(["triggerAction","trigger-action"])],Qe.prototype,"viewModel",void 0),h([p()],Qe.prototype,"visible",null),h([p()],Qe.prototype,"visibleElements",void 0),h([qr("visibleElements")],Qe.prototype,"castVisibleElements",null),h([Uo()],Qe.prototype,"_close",null),h([Uo()],Qe.prototype,"_toggleDockEnabled",null),h([Uo()],Qe.prototype,"_toggleFeatureMenu",null),h([Uo()],Qe.prototype,"_toggleActionsMenu",null),h([Uo()],Qe.prototype,"_triggerAction",null),h([Uo()],Qe.prototype,"_selectFeature",null),h([Uo()],Qe.prototype,"_next",null),h([Uo()],Qe.prototype,"_previous",null),Qe=h([F("esri.widgets.Popup")],Qe);const gV=Qe,sO=[0,0];function cpe(i){const e=(i.ownerDocument||window.document).defaultView,t=i.getBoundingClientRect();return sO[0]=t.left+((e==null?void 0:e.pageXOffset)??0),sO[1]=t.top+((e==null?void 0:e.pageYOffset)??0),sO}function _V(i){i&&(J7(i),i.parentNode&&i.parentNode.removeChild(i))}function hpe(i){const e=document.createElement("div");return i.appendChild(e),e}const Jv=16,kT=750,upe=512,dpe=2,OW=i=>{let e=class extends i{constructor(...t){var r;super(...t),this._freqInfo={freq:Jv,time:kT},this._overlayRenderTaskHandle=null,this.height=0,this.overlay=null,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.ui=null,this.userContent=null,this.width=0,this.widthBreakpoint=null,t.length!==0&&((r=t[0])==null?void 0:r.popup)!==void 0||(this.popup=new gV({view:this})),this.handles.add([B(()=>this.cursor,n=>{const{surface:s}=this;s&&s.setAttribute("data-cursor",n)}),B(()=>this.interacting,n=>{const{surface:s}=this;s&&s.setAttribute("data-interacting",n.toString())})])}initialize(){this.handles.add(B(()=>this.ui,(t,r)=>this._handleUIChange(t,r))),this._wireUI(this.ui),this.handles.add([this.on("focus",()=>this.notifyChange("focused")),this.on("blur",()=>this.notifyChange("focused"))])}destroy(){this.destroyed||(this.ui=Oe(this.ui),this.popup&&!this.popup.destroyed&&this.popup.destroy(),this.container=null)}get container(){return this._get("container")??null}set container(t){const r=this._get("container"),n=uD(t),s=n instanceof HTMLDivElement?n:null;if(s||typeof t!="string"||ee.getLogger(this.declaredClass).error("#container",`element with id '${t}' not found`),r===s)return;const a="dom-size";if(this.handles.remove(a),this._stopMeasuring(),r&&(r.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay&&(this.overlay.destroy(),this._set("overlay",null)),this.root&&(_V(this.root),this._set("root",null)),this.userContent&&(E5(this.userContent,r),_V(this.userContent),this._set("userContent",null))),!s)return this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),void this._set("container",null);s.classList.add("esri-view");const o=document.createElement("div");o.className="esri-view-user-storage",E5(s,o),s.appendChild(o),this._set("userContent",o);const l=document.createElement("div");l.className="esri-view-root",s.insertBefore(l,s.firstChild),this._set("root",l);const c=document.createElement("div");c.className="esri-view-surface",c.setAttribute("role","application"),c.tabIndex=0,l.appendChild(c),this._set("surface",c);const u=new F9;l.appendChild(u.surface),this._set("overlay",u),B(()=>u.needsRender,d=>{d&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=wd({render:()=>{var m;return(m=this.overlay)==null?void 0:m.render()}}):this._overlayRenderTaskHandle=Os(this._overlayRenderTaskHandle)}),this.forceDOMReadyCycle(),this.handles.add(B(()=>this.size,d=>{const[m,f]=d,_="esri-view-surface--inset-outline";m>=document.body.clientWidth||f>=document.body.clientHeight?c.classList.add(_):c.classList.remove(_)},et),a),this._set("container",s),this._startMeasuring()}get focused(){const t=document.activeElement===this.surface;return document.hasFocus()&&t}set popup(t){const r=this._get("popup");r&&r!==t&&r.destroy(),this._set("popup",t)}get size(){return[this.width,this.height]}blur(){this.surface&&this.surface.blur()}focus(){this.surface&&this.surface.focus()}pageToContainer(t,r,n){const s=this.position;return t-=s?s[0]:0,r-=s?s[1]:0,n?(n[0]=t,n[1]=r):n=[t,r],n}containerToPage(t,r,n){const s=this.position;return t+=s?s[0]:0,r+=s?s[1]:0,n?(n[0]=t,n[1]=r):n=[t,r],n}_handleUIChange(t,r){r&&(this.handles.remove("ui"),r.destroy()),t&&this._wireUI(t),this._set("ui",t)}_wireUI(t){this.handles.remove("ui"),t&&(t.view=this,this.handles.add([B(()=>this.root,r=>{t.container=r?hpe(r):null},et),B(()=>this.popup,(r,n)=>{const s="popup",a="manual";n&&t.remove(n,s),r&&(r.view=t.view,t.add(r,{key:s,position:a}))},et)],"ui"))}_stopMeasuring(){this.handles.remove("measuring"),this._get("resizing")&&this._set("resizing",!1)}_startMeasuring(){const t=this._freqInfo;t.freq=Jv,t.time=kT,this.handles.add([(()=>{const r=()=>{t.freq=Jv,t.time=kT};return window.addEventListener("resize",r),{remove(){window.removeEventListener("resize",r)}}})(),wd({prepare:r=>{const n=this._measure(),s=this._freqInfo;if(s.time+=r.deltaTime,n&&(s.freq=Jv,this._get("resizing")||this._set("resizing",!0)),s.time<s.freq)return;s.time=0;const a=this._position();s.freq=a||n?Jv:Math.min(kT,s.freq*dpe),!n&&s.freq>=upe&&this._get("resizing")&&this._set("resizing",!1)}})],"measuring"),this._measure(),this._position()}_measure(){const t=this.container,r=t?t.clientWidth:0,n=t?t.clientHeight:0;if(r===0||n===0)return this.suspended||this._set("suspended",!0),!1;const s=this.width,a=this.height;return r===s&&n===a?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",r),this._set("height",n),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:s,oldHeight:a,width:r,height:n}),!0)}_position(){const t=this.container,r=this.position,n=t&&cpe(t);return!!n&&(!r||n[0]!==r[0]||n[1]!==r[1])&&(this._set("position",[n[0],n[1]]),!0)}forceDOMReadyCycle(){}};return h([p()],e.prototype,"container",null),h([p({readOnly:!0})],e.prototype,"focused",null),h([p({readOnly:!0})],e.prototype,"height",void 0),h([p({type:gV})],e.prototype,"popup",null),h([p({type:F9})],e.prototype,"overlay",void 0),h([p({readOnly:!0})],e.prototype,"position",void 0),h([p({readOnly:!0})],e.prototype,"resizing",void 0),h([p({readOnly:!0})],e.prototype,"root",void 0),h([p({value:null,readOnly:!0})],e.prototype,"size",null),h([p({readOnly:!0})],e.prototype,"surface",void 0),h([p({readOnly:!0})],e.prototype,"suspended",void 0),h([p()],e.prototype,"ui",void 0),h([p({readOnly:!0})],e.prototype,"userContent",void 0),h([p({readOnly:!0})],e.prototype,"width",void 0),h([p()],e.prototype,"widthBreakpoint",void 0),e=h([F("esri.views.DOMContainer")],e),e},MW=i=>{let e=class extends i{async fetchPopupFeatures(t,r){await this.when();const{location:n,queryArea:s,layerViewsAndGraphics:a,clientOnlyGraphics:o}=await this._prepareFetchPopupFeatures(t,r),l=Promise.resolve(o),c=this._queryLayerPopupFeatures(s,a,r),u=c.map(d=>d.promise);return{location:n,clientOnlyGraphics:o,allGraphicsPromise:Gte([l,...u]).then(d=>Array.from(new Set(d.flat()))),promisesPerLayerView:c}}_queryLayerPopupFeatures(t,r,n){return r.map(({layerView:s,graphics:a})=>{const o={clientGraphics:a,event:y(n)?n.event:null,signal:y(n)?n.signal:null,defaultPopupTemplateEnabled:!!y(n)&&!!n.defaultPopupTemplateEnabled},l=s.fetchPopupFeatures(t,o);return{layerView:s,promise:l}})}_isValidPopupGraphic(t,r){return t&&!!t.getEffectivePopupTemplate(y(r)&&r.defaultPopupTemplateEnabled)}async _prepareFetchPopupFeatures(t,r){const{clientGraphics:n,queryArea:s,location:a}=await this._popupHitTestGraphics(t,r),o=this._getFetchPopupLayerViews(),{layerViewsAndGraphics:l,clientOnlyGraphics:c}=this._graphicsPerFetchPopupLayerView(n,o);return{clientOnlyGraphics:c,layerViewsAndGraphics:l,queryArea:s,location:a}}async _popupHitTestGraphics(t,r){const{results:n,mapPoint:s}=await this.popupHitTest(t),a=n.filter(l=>l.type==="graphic"&&this._isValidPopupGraphic(l.graphic,r)),o=a.length?a[0].mapPoint:null;return{clientGraphics:a.map(l=>l.graphic),queryArea:s,location:s||o}}_getFetchPopupLayerViews(){const t=[];return this.allLayerViews.forEach(r=>{this._isValidPopupLayerView(r)&&t.push(r)}),y(this.graphicsView)&&this._isValidPopupLayerView(this.graphicsView)&&t.push(this.graphicsView),t.reverse()}_isValidPopupLayerView(t){return y(t)&&(!("layer"in t)||!t.suspended)&&"fetchPopupFeatures"in t}_graphicsPerFetchPopupLayerView(t,r){const n=[],s=new Map,a=r.map(o=>{const l=[];return"layer"in o?s.set(o.layer,l):s.set(o.graphics,l),{layerView:o,graphics:l}});for(const o of t){const l=s.get(o.layer)||s.get(o.sourceLayer)||null;l?l.push(o):n.push(o)}return{layerViewsAndGraphics:a,clientOnlyGraphics:n}}};return e=h([F("esri.views.PopupView")],e),e};var JL;let qS=JL=class extends xt{constructor(i){super(i),this.type="none"}clone(){return new JL({type:this.type})}};h([Pa({none:"none",stayAbove:"stay-above"})],qS.prototype,"type",void 0),qS=JL=h([F("esri.ground.NavigationConstraint")],qS);let Ji=class extends pe{constructor(){super(...arguments),this.SCENEVIEW_HITTEST_RETURN_INTERSECTOR=!1,this.DECONFLICTOR_SHOW_VISIBLE=!1,this.DECONFLICTOR_SHOW_INVISIBLE=!1,this.DECONFLICTOR_SHOW_GRID=!1,this.LABELS_SHOW_BORDER=!1,this.TEXT_SHOW_BASELINE=!1,this.TEXT_SHOW_BORDER=!1,this.OVERLAY_DRAW_DEBUG_TEXTURE=!1,this.OVERLAY_SHOW_CENTER=!1,this.SHOW_POI=!1,this.TESTS_DISABLE_OPTIMIZATIONS=!1,this.TESTS_DISABLE_FAST_UPDATES=!1,this.DRAW_MESH_GEOMETRY_NORMALS=!1,this.FEATURE_TILE_FETCH_SHOW_TILES=!1,this.FEATURE_TILE_TREE_SHOW_TILES=!1,this.TERRAIN_TILE_TREE_SHOW_TILES=!1,this.I3S_TREE_SHOW_TILES=!1,this.I3S_SHOW_MODIFICATIONS=!1,this.LOD_INSTANCE_RENDERER_DISABLE_UPDATES=!1,this.LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL=!1,this.EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES=!1,this.LINE_WIREFRAMES=!1,this.TERRAIN_USE_LEGACY_SHADING=!1}};h([p()],Ji.prototype,"SCENEVIEW_HITTEST_RETURN_INTERSECTOR",void 0),h([p()],Ji.prototype,"DECONFLICTOR_SHOW_VISIBLE",void 0),h([p()],Ji.prototype,"DECONFLICTOR_SHOW_INVISIBLE",void 0),h([p()],Ji.prototype,"DECONFLICTOR_SHOW_GRID",void 0),h([p()],Ji.prototype,"LABELS_SHOW_BORDER",void 0),h([p()],Ji.prototype,"TEXT_SHOW_BASELINE",void 0),h([p()],Ji.prototype,"TEXT_SHOW_BORDER",void 0),h([p()],Ji.prototype,"OVERLAY_DRAW_DEBUG_TEXTURE",void 0),h([p()],Ji.prototype,"OVERLAY_SHOW_CENTER",void 0),h([p()],Ji.prototype,"SHOW_POI",void 0),h([p()],Ji.prototype,"TESTS_DISABLE_OPTIMIZATIONS",void 0),h([p()],Ji.prototype,"TESTS_DISABLE_FAST_UPDATES",void 0),h([p()],Ji.prototype,"DRAW_MESH_GEOMETRY_NORMALS",void 0),h([p()],Ji.prototype,"FEATURE_TILE_FETCH_SHOW_TILES",void 0),h([p()],Ji.prototype,"FEATURE_TILE_TREE_SHOW_TILES",void 0),h([p()],Ji.prototype,"TERRAIN_TILE_TREE_SHOW_TILES",void 0),h([p()],Ji.prototype,"I3S_TREE_SHOW_TILES",void 0),h([p()],Ji.prototype,"I3S_SHOW_MODIFICATIONS",void 0),h([p()],Ji.prototype,"LOD_INSTANCE_RENDERER_DISABLE_UPDATES",void 0),h([p()],Ji.prototype,"LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL",void 0),h([p()],Ji.prototype,"EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES",void 0),h([p()],Ji.prototype,"LINE_WIREFRAMES",void 0),h([p()],Ji.prototype,"TERRAIN_USE_LEGACY_SHADING",void 0),Ji=h([F("esri.views.3d.support.DebugFlags")],Ji);const Wt=new Ji;var e3;let mh=e3=class extends I7(Om){constructor(i){super(i),this.opacity=1,this.shading=!Wt.TERRAIN_USE_LEGACY_SHADING,this.surfaceColor=null,this.navigationConstraint=null,this.layers=new wt;const e=r=>{r.parent&&r.parent!==this&&"remove"in r.parent&&r.parent.remove(r),r.parent=this,r.type!=="elevation"&&r.type!=="base-elevation"&&ee.getLogger(this.declaredClass).error(`Layer '${r.title}, id:${r.id}' of type '${r.type}' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.`)},t=r=>{r.parent=null};this.layers.on("after-add",r=>e(r.item)),this.layers.on("after-remove",r=>t(r.item))}initialize(){this.when().catch(i=>{ee.getLogger(this.declaredClass).error("#load()","Failed to load ground",i)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const i=this.layers.removeAll();for(const e of i)e.destroy();this.layers.destroy()}normalizeCtorArgs(i){return i&&"resourceInfo"in i&&(this._set("resourceInfo",i.resourceInfo),delete(i={...i}).resourceInfo),i}set layers(i){this._set("layers",dG(i,this._get("layers")))}writeLayers(i,e,t,r){const n=[];i&&(r={...r,layerContainerType:"ground"},i.forEach(s=>{if("write"in s){const a={};rre(s)().write(a,r)&&n.push(a)}else r&&r.messages&&r.messages.push(new J("layer:unsupported",`Layers (${s.title}, ${s.id}) of type '${s.declaredClass}' cannot be persisted in the ground`,{layer:s}))})),e.layers=n}load(i){return this.addResolvingPromise(this._loadFromSource(i)),Promise.resolve(this)}loadAll(){return pG(this,i=>{i(this.layers)})}async queryElevation(i,e){await this.load({signal:e==null?void 0:e.signal});const{ElevationQuery:t}=await j(()=>import("./ElevationQuery-d57239e1.js"),["assets/ElevationQuery-d57239e1.js","assets/asyncUtils-437defc4.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/unitUtils-45d1147c.js","assets/jsonMap-7b8332c9.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/projection-290b739f.js","assets/preload-helper-3bce6601.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/SimpleObservable-23231131.js","assets/mat4-44a0988f.js","assets/assets-8d3e737a.js","assets/request-6fc81c4c.js","assets/aaBoundingRect-193543b5.js","assets/zscale-89472cba.js","assets/ElevationSamplerData-b87e0e50.js","assets/geometry-b7901087.js","assets/typeUtils-35750739.js","assets/TileInfo-b0eb8c90.js"]);Ti(e);const r=new t,n=this.layers.filter(yV).toArray();return r.queryAll(n,i,e)}async createElevationSampler(i,e){await this.load({signal:e==null?void 0:e.signal});const{ElevationQuery:t}=await j(()=>import("./ElevationQuery-d57239e1.js"),["assets/ElevationQuery-d57239e1.js","assets/asyncUtils-437defc4.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/unitUtils-45d1147c.js","assets/jsonMap-7b8332c9.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/projection-290b739f.js","assets/preload-helper-3bce6601.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/SimpleObservable-23231131.js","assets/mat4-44a0988f.js","assets/assets-8d3e737a.js","assets/request-6fc81c4c.js","assets/aaBoundingRect-193543b5.js","assets/zscale-89472cba.js","assets/ElevationSamplerData-b87e0e50.js","assets/geometry-b7901087.js","assets/typeUtils-35750739.js","assets/TileInfo-b0eb8c90.js"]);Ti(e);const r=new t,n=this.layers.filter(yV).toArray();return r.createSamplerAll(n,i,e)}clone(){const i={opacity:this.opacity,surfaceColor:Pr(this.surfaceColor),navigationConstraint:Pr(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(i.loadStatus="loaded"),new e3({resourceInfo:this.resourceInfo}).set(i)}read(i,e){this.resourceInfo||this._set("resourceInfo",{data:i,context:e}),super.read(i,e)}_loadFromSource(i){const e=this.resourceInfo;return e?this._loadLayersFromJSON(e.data,e.context,i):Promise.resolve()}_loadLayersFromJSON(i,e,t){const r=e&&e.origin||"web-scene",n=e&&e.portal||null,s=e&&e.url||null;return j(()=>import("./layersCreator-af14d2eb.js"),["assets/layersCreator-af14d2eb.js","assets/Collection-910b6f71.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/lazyLayerLoader-41b90a4f.js","assets/preload-helper-3bce6601.js","assets/PortalItem-bb7e98a6.js","assets/assets-8d3e737a.js","assets/request-6fc81c4c.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Portal-2bb189b3.js","assets/locale-30120714.js","assets/PortalGroup-8e41557a.js","assets/jsonMap-7b8332c9.js","assets/PortalUser-659cc1d2.js","assets/portalLayers-bc22a371.js","assets/layersLoader-89454f28.js","assets/Layer-5ffe0eda.js","assets/geometry-b7901087.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/Identifiable-bfe1ff30.js","assets/arcgisLayerUrl-c09f09b4.js","assets/persistableUrlUtils-5f719c3b.js","assets/jsonContext-a007a25f.js","assets/portalItemUtils-2ccd793f.js","assets/projection-290b739f.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/aaBoundingRect-193543b5.js","assets/zscale-89472cba.js","assets/styleUtils-a989c0af.js","assets/asyncUtils-437defc4.js"]).then(({populateOperationalLayers:a})=>{Ti(t);const o=[];if(i.layers&&Array.isArray(i.layers)){const l={context:{origin:r,url:s,portal:n,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};o.push(a(this.layers,i.layers,l))}return Yo(o)}).then(()=>{})}};function ppe(i){return i&&"createElevationSampler"in i}function yV(i){return i.type==="elevation"||ppe(i)}h([p({json:{read:!1}})],mh.prototype,"layers",null),h([Cs("layers")],mh.prototype,"writeLayers",null),h([p({readOnly:!0})],mh.prototype,"resourceInfo",void 0),h([p({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:gI,read:{reader:nre,source:"transparency"},write:{writer:(i,e)=>{e.transparency=sre(i)},target:"transparency"}}})],mh.prototype,"opacity",void 0),h([p({type:Boolean,nonNullable:!0,json:{read:!1}})],mh.prototype,"shading",void 0),h([p({type:ti,json:{type:[gI],write:(i,e)=>{e.surfaceColor=i.toJSON().slice(0,3)}}})],mh.prototype,"surfaceColor",void 0),h([p({type:qS,json:{write:!0}})],mh.prototype,"navigationConstraint",void 0),mh=e3=h([F("esri.Ground")],mh);const M2=mh;function mpe(i){var e;return!!(i&&i.loaded&&"capabilities"in i&&((e=i==null?void 0:i.capabilities)!=null&&e.operations)&&"supportsEditing"in i.capabilities.operations&&i.capabilities.operations.supportsEditing===!0)&&!("editingEnabled"in i&&!i.editingEnabled)}const vV=ee.getLogger("esri.support.basemapUtils");function fpe(){return{}}function gpe(i){for(const e in i){const t=i[e];(t==null?void 0:t.destroyed)===!1&&t.destroy(),delete i[e]}}function _pe(i,e){let t;if(typeof i=="string"){if(!(i in M5)){const r=Object.entries(M5).filter(([n,s])=>Rg.apiKey&&!s.classic||!Rg.apiKey&&s.classic&&!s.deprecated).map(([n])=>`"${n}"`).join(", ");return vV.warn(`Unable to find basemap definition for: ${i}. Try one of these: ${r}`),null}e&&(t=e[i]),t||(t=CI.fromId(i),e&&(e[i]=t))}else t=Nx(CI,i);return t!=null&&t.destroyed&&(vV.warn("The provided basemap is already destroyed",{basemap:t}),t=null),t}function ype(i){return!!(i!=null&&i.baseLayers.concat(i.referenceLayers).some(IW))}function IW(i){var e;if(bV(i.url))return!0;if(i.type==="vector-tile"){for(const t in i.sourceNameToSource)if(bV((e=i.sourceNameToSource[t])==null?void 0:e.sourceUrl))return!0}return!1}function vpe(i,e){var n;if(C(e)||C(i))return{spatialReference:null,updating:!1};if(e.loadStatus==="not-loaded")return e.load(),{spatialReference:null,updating:!0};if(e.spatialReference)return{spatialReference:e.spatialReference,updating:!1};if(e.baseLayers.length===0)return{spatialReference:null,updating:!1};const t=e.baseLayers.getItemAt(0);switch(t.loadStatus){case"not-loaded":t.load();case"loading":return{spatialReference:null,updating:!0};case"failed":return{spatialReference:null,updating:!1}}const r=(("supportedSpatialReferences"in t?t.supportedSpatialReferences:null)||["tileInfo"in t?(n=t.tileInfo)==null?void 0:n.spatialReference:t.spatialReference]).filter(Boolean);return i.spatialReference?{spatialReference:r.find(s=>i.spatialReference.equals(s))??r[0]??null,updating:!1}:{spatialReference:r[0],updating:!1}}const bpe=/^(basemaps|ibasemaps).*-api\.arcgis\.com$/i;function bV(i){if(!i)return!1;const e=new Die(Fie(i));return bpe.test(e.authority)}const wV={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}};function wpe(i){let e=null;if(typeof i=="string")if(i in wV){const t=wV[i];e=new M2({resourceInfo:{data:{layers:[t]}}})}else ee.getLogger("esri.support.groundUtils").warn(`Unable to find ground definition for: ${i}. Try "world-elevation"`);else e=Nx(M2,i);return e}let fh=class extends are(ore(nn.EventedMixin(pe))){constructor(e){super(e),this.allLayers=new yw({getCollections:()=>{var t,r,n;return[(t=this.basemap)==null?void 0:t.baseLayers,(r=this.ground)==null?void 0:r.layers,this.layers,(n=this.basemap)==null?void 0:n.referenceLayers]},getChildrenFunction:t=>"layers"in t?t.layers:null}),this.allTables=lre(this),this.basemap=null,this.editableLayers=new yw({getCollections:()=>[this.allLayers],itemFilterFunction:mpe}),this.ground=new M2,this._basemapCache=fpe()}destroy(){var e,t;this.allLayers.destroy(),this.allTables.destroy(),this.editableLayers.destroy(),(e=this.ground)==null||e.destroy(),(t=this.basemap)==null||t.destroy(),gpe(this._basemapCache),this._basemapCache=null}castBasemap(e){return _pe(e,this._basemapCache)}castGround(e){const t=wpe(e);return C(t)?this._get("ground"):t}findLayerById(e){return this.allLayers.find(t=>t.id===e)}findTableById(e){return this.allTables.find(t=>t.id===e)}};h([p({readOnly:!0,dependsOn:[]})],fh.prototype,"allLayers",void 0),h([p({readOnly:!0})],fh.prototype,"allTables",void 0),h([p({type:CI})],fh.prototype,"basemap",void 0),h([qr("basemap")],fh.prototype,"castBasemap",null),h([p({readOnly:!0})],fh.prototype,"editableLayers",void 0),h([p({type:M2,nonNullable:!0})],fh.prototype,"ground",void 0),h([qr("ground")],fh.prototype,"castGround",null),fh=h([F("esri.Map")],fh);const _P=fh;let ov=class extends hre{constructor(e){super(e),this.handles.add(this.on("before-add",t=>{C(t.item)||t.item.parent===this.owner&&(ee.getLogger(this.declaredClass).warn("Analysis inside the collection must be unique. Not adding this element again."),t.preventDefault())}))}_own(e){e.parent=this.owner}_release(e){e.parent=null}};ov=h([F("esri.support.AnalysesCollection")],ov);let bp=class extends pe{constructor(e){super(e),this.view=null,this.baseLayerViews=new wt,this.referenceLayerViews=new wt,this._loadingHandle=B(()=>{var t,r;return(r=(t=this.view)==null?void 0:t.map)==null?void 0:r.basemap},t=>{t&&t.load().catch(()=>{})},et)}destroy(){this._set("view",null),this._loadingHandle&&(this._loadingHandle.remove(),this._loadingHandle=null)}get suspended(){return!this.view||this.view.suspended}get updating(){var t,r;if(this.view&&this.view.suspended)return!1;const e=(r=(t=this.view)==null?void 0:t.map)==null?void 0:r.basemap;return!!e&&!!e.loaded&&(this.baseLayerViews.some(n=>n.updating)||this.referenceLayerViews.some(n=>n.updating))}};h([p({constructOnly:!0})],bp.prototype,"view",void 0),h([p({readOnly:!0})],bp.prototype,"baseLayerViews",void 0),h([p({readOnly:!0})],bp.prototype,"referenceLayerViews",void 0),h([p({readOnly:!0})],bp.prototype,"suspended",null),h([p({type:Boolean,readOnly:!0})],bp.prototype,"updating",null),bp=h([F("esri.views.BasemapView")],bp);let xpe=class{constructor(e,t,r){this.layer=e,this.view=t,this.layerViewImporter=r,this._controller=new AbortController,this._deferred=W7(),this._started=!1,this.done=!1,Rm(this._controller.signal,()=>{const n=new J("cancelled:layerview-create","layerview creation cancelled",{layer:e});this._deferred.reject(n)})}get promise(){return this._deferred.promise}destroy(){this._controller.abort();const{layerView:e}=this;if(!e)return;const{layer:t,view:r}=this;t.emit("layerview-destroy",{view:r,layerView:e}),r.emit("layerview-destroy",{layer:t,layerView:e}),this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null}async start(){var n,s;if(this._started)return;this._started=!0;const{_controller:{signal:e},layer:t,view:r}=this;this._map=r.map;try{let a,o;if(await t.load({signal:e}),"prefetchResources"in t&&await t.prefetchResources({signal:e}),t.createLayerView)a=await t.createLayerView(r,{signal:e});else{if(!this.layerViewImporter.hasLayerViewModule(t))throw new J("layer:view-not-supported","No layerview implementation was found");const u=await this.layerViewImporter.importLayerView(t);Ti(e),a="default"in u?new u.default({layer:t,view:r}):new u({layer:t,view:r})}const l=()=>{o=Os(o),a.destroyed||a.destroy(),a.layer=null,a.parent=null,a.view=null,this.done=!0};o=Rm(e,l),Ti(e);try{await a.when()}catch(u){throw l(),u}if(!((s=(n=this._map)==null?void 0:n.allLayers)==null?void 0:s.includes(t)))return l(),void this._deferred.reject(new J("view:no-layerview-for-layer","The layer has been removed from the map",{layer:t}));this.layerView=a,t.emit("layerview-create",{view:r,layerView:a}),r.emit("layerview-create",{layer:t,layerView:a}),this.done=!0,this._deferred.resolve(a)}catch(a){t.emit("layerview-create-error",{view:r,error:a}),r.emit("layerview-create-error",{layer:t,error:a}),this.done=!0,this._deferred.reject(new J("layerview:create-error","layerview creation failed",{layer:t,error:a}))}}},ml=class extends pe{constructor(e){super(e),this._layerLayerViewInfoMap=new Map,this._watchUpdatingTracking=new _v,this.supportsGround=!0,this._preloadLayerViewModules=()=>{var r;const t=(r=this.view.map)==null?void 0:r.allLayers;if(t)for(const n of t)this.layerViewImporter.hasLayerViewModule(n)&&this.layerViewImporter.importLayerView(n)},this._reschedule=()=>(C(this._workPromise)&&(this._workPromise=W7(),this._workPromise.promise.catch(()=>{})),this.removeHandles("reschedule"),this.addHandles(L7(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{var o,l,c;const t=this.view.map;if(this._map!==t&&(this.clear(),this._map=t),C(this._workPromise))return void this.notifyChange("updating");this.removeHandles("reschedule"),this.removeHandles("collection-change");const r=[],n=u=>{if(!C(u))for(const d of u)d&&(r.push(d),this._createLayerView(d),"layers"in d&&d.layers&&n(d.layers))};for(const u of this._rootCollectionNames)n(this.get(u));this._refreshCollections();for(const[u,d]of this._layerLayerViewInfoMap)r.includes(u)||(this._layerLayerViewInfoMap.delete(d.layer),d.destroy());const s=r.filter(u=>u.type==="group").map(u=>u.layers),a=[(o=t==null?void 0:t.ground)==null?void 0:o.layers,(l=t==null?void 0:t.basemap)==null?void 0:l.baseLayers,(c=t==null?void 0:t.basemap)==null?void 0:c.referenceLayers,t==null?void 0:t.layers,...s].filter(u=>!!u);this.addHandles(a.map(u=>this._watchUpdatingTracking.addOnCollectionChange(()=>u,this._reschedule)),"collection-change"),this._workPromise.resolve(),this._workPromise=null}}initialize(){this.own([wr(()=>{var e,t;return(t=(e=this.view)==null?void 0:e.map)==null?void 0:t.allLayers},"change",this._preloadLayerViewModules,{onListenerAdd:this._preloadLayerViewModules}),B(()=>{const e=this.view,t=e==null?void 0:e.map;return[t==null?void 0:t.basemap,t==null?void 0:t.ground,t==null?void 0:t.layers,e==null?void 0:e.ready]},()=>this._reschedule(),Mi)]),this._preloadLayerViewModules(),this._reschedule()}destroy(){this.clear(),this._watchUpdatingTracking.destroy(),this._map=null,y(this._workPromise)&&(this._workPromise.reject(ts()),this._workPromise=null)}get _layersToLayerViews(){const e=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.layers","view.layerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"]];return this.supportsGround&&e.push(["view.map.ground.layers","view.groundView.layerViews"]),new Map(e)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return y(this._workPromise)||this._watchUpdatingTracking.updating||Er(this._layerLayerViewInfoMap,e=>!e.done)}get updatingRemaining(){let e=0;for(const t of this._layerLayerViewInfoMap.values())t.done||++e;return e}clear(){if(!this.destroyed){for(const e of this._layerLayerViewInfoMap.values())e.destroy();this._layerLayerViewInfoMap.clear(),this._refreshCollections()}}async whenLayerView(e){if(await this._reschedule(),!this._layerLayerViewInfoMap.has(e))throw new J("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:e});return this._layerLayerViewInfoMap.get(e).promise}_refreshCollections(){for(const[e,t]of this._layersToLayerViews)this._populateLayerViewsOwners(this.get(e),this.get(t),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining")}_populateLayerViewsOwners(e,t,r){if(!e||!t)return void(t&&t.removeAll());let n=0;for(const s of e){const a=this._layerLayerViewInfoMap.get(s);if(!a||!a.layerView)continue;const o=a.layerView;o.layer=s,o.parent=r,t.getItemAt(n)!==o&&t.splice(n,0,o),s.layers&&this._populateLayerViewsOwners(s.layers,o.layerViews,o),n+=1}n<t.length&&t.splice(n,t.length)}_createLayerView(e){if(this._layerLayerViewInfoMap.has(e))return this.view.ready&&this._layerLayerViewInfoMap.get(e).start(),this.notifyChange("updating"),void this.notifyChange("updatingRemaining");e.load().catch(()=>{}),this.layerViewImporter.hasLayerViewModule(e)&&this.layerViewImporter.importLayerView(e);const t=new xpe(e,this.view,this.layerViewImporter);t.promise.then(()=>this._refreshCollections(),r=>{r&&(yo(r)||r.name==="cancelled:layerview-create")||ee.getLogger(this.declaredClass).error(`Failed to create layerview for layer title:'${e.title??"no title"}', id:'${e.id??"no id"}' of type '${e.type}'.`,{layer:e,error:r}),this._refreshCollections()}),this._layerLayerViewInfoMap.set(e,t),this.view.ready&&t.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining")}};h([p()],ml.prototype,"_workPromise",void 0),h([p({readOnly:!0})],ml.prototype,"_watchUpdatingTracking",void 0),h([p({readOnly:!0})],ml.prototype,"_layersToLayerViews",null),h([p({readOnly:!0})],ml.prototype,"_rootCollectionNames",null),h([p()],ml.prototype,"layerViewImporter",void 0),h([p()],ml.prototype,"supportsGround",void 0),h([p({readOnly:!0})],ml.prototype,"updating",null),h([p({readOnly:!0})],ml.prototype,"updatingRemaining",null),h([p({constructOnly:!0})],ml.prototype,"view",void 0),ml=h([F("esri.views.LayerViewManager")],ml);const Tpe=ml;let Io=class extends pe{constructor(e){super(e),this.factor=1.5,this.offset=Rs(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};h([p({type:Number})],Io.prototype,"factor",void 0),h([p({nonNullable:!0})],Io.prototype,"offset",void 0),h([p()],Io.prototype,"position",void 0),h([p({type:Number,range:{min:0}})],Io.prototype,"size",void 0),h([p()],Io.prototype,"maskUrl",void 0),h([p()],Io.prototype,"maskEnabled",void 0),h([p()],Io.prototype,"overlayUrl",void 0),h([p()],Io.prototype,"overlayEnabled",void 0),h([p({readOnly:!0})],Io.prototype,"version",null),h([p({type:Boolean})],Io.prototype,"visible",void 0),Io=h([F("esri.views.Magnifier")],Io);const LW=Io;let c0=class extends pe{constructor(e,t){super({}),this._stage=e,this._textureRequests=new Map,this._frameTask=(t==null?void 0:t.registerTask(dr.TEXTURE_UNLOAD))??yD}normalizeCtorArgs(){return{}}destroy(){super.destroy(),this._frameTask.remove(),this._textureRequests.forEach(e=>this._releaseTextureRequest(e)),this._textureRequests.clear()}get updating(){return this._frameTask.updating}fromData(e,t,r){const n=this.makeUid(e);let s=this._textureRequests.get(n);return s||(s={referenceCount:0,texture:t(),textureAsync:null,abortController:null,onRemove:r},this._stage&&(this._stage.add(s.texture),this._stage.loadImmediate(s.texture)),this._textureRequests.set(n,s)),s.referenceCount++,{uid:n,texture:s.texture,release:()=>this._release(n)}}_release(e){const t=this._textureRequests.get(e);t?(t.referenceCount<1&&console.warn("TextureCollection: reference count is < 1 for "+e),t.referenceCount--,t.referenceCount<1&&this._frameTask.schedule(()=>this._releaseNow(e))):console.warn(`TextureCollection: texture doesn't exist: '${e}'`)}get test(){return{textureRequests:this._textureRequests}}_releaseNow(e){if(!this._textureRequests)return;const t=this._textureRequests.get(e);!t||t.referenceCount>0||(this._releaseTextureRequest(t),this._textureRequests.delete(e))}_releaseTextureRequest(e){var t;e.onRemove&&e.onRemove(),e.texture?(t=this._stage)==null||t.remove(e.texture):e.abortController&&(e.abortController.abort(),e.abortController=null)}makeUid(e,t=null){return y(t)?`${e}.${t}px`:e}};h([p()],c0.prototype,"_frameTask",void 0),h([p()],c0.prototype,"updating",null),c0=h([F("esri.views.3d.support.TextureCollection")],c0);var xV;(function(i){i[i.Left=0]="Left",i[i.Middle=1]="Middle",i[i.Right=2]="Right"})(xV||(xV={}));const $W=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],DW={};function FW(i){return!!DW[i]}function Cpe(i){for(const e of i)if(!FW(e))return!1;return!0}$W.forEach(i=>{DW[i]=!0});let Spe=class{constructor(e){this._handlers=new Map,this._counter=0,this._handlerCounts=new Map,this.view=e,this.inputManager=null}connect(e){e&&this.disconnect(),this.inputManager=e,this._handlers.forEach(({handler:t,priority:r},n)=>this.inputManager.installHandlers(n,[t],r))}disconnect(){this.inputManager&&this._handlers.forEach((e,t)=>this.inputManager.uninstallHandlers(t)),this.inputManager=null}destroy(){this.disconnect(),this._handlers.clear(),this.view=null}on(e,t,r,n){const s=Array.isArray(e)?e:e.split(",");if(!Cpe(s))return s.some(FW)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let a,o;Array.isArray(t)?o=t:(a=t,o=[]),typeof r=="function"?a=r:n=r,n=n??Yh.DEFAULT;const l=this._createUniqueGroupName(),c=new Epe(this.view,s,o,a);this._handlers.set(l,{handler:c,priority:n});for(const u of s){const d=this._handlerCounts.get(u)||0;this._handlerCounts.set(u,d+1)}return this.inputManager&&this.inputManager.installHandlers(l,[c],n),{remove:()=>this._removeHandler(l,s)}}hasHandler(e){return!!this._handlerCounts.get(e)}_removeHandler(e,t){if(this._handlers.has(e)){this._handlers.delete(e);for(const r of t){const n=this._handlerCounts.get(r);n===void 0?console.error("Trying to remove handler for event that has no handlers registered: ",r):n===1?this._handlerCounts.delete(r):this._handlerCounts.set(r,n-1)}}this.inputManager&&this.inputManager.uninstallHandlers(e)}_createUniqueGroupName(){return this._counter+=1,`viewEvents_${this._counter}`}},Epe=class extends Ri{constructor(e,t,r,n){super(!0),this.view=e;for(const s of t)switch(s){case"click":this.registerIncoming("click",r,a=>n(this._wrapClick(a)));break;case"double-click":this.registerIncoming("double-click",r,a=>n(this._wrapDoubleClick(a)));break;case"immediate-click":this.registerIncoming("immediate-click",r,a=>n(this._wrapImmediateClick(a)));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",r,a=>n(this._wrapImmediateDoubleClick(a)));break;case"hold":this.registerIncoming("hold",r,a=>n(this._wrapHold(a)));break;case"drag":this.registerIncoming("drag",r,a=>{const o=this._wrapDrag(a);o&&n(o)});break;case"key-down":this.registerIncoming("key-down",r,a=>n(this._wrapKeyDown(a)));break;case"key-up":this.registerIncoming("key-up",r,a=>n(this._wrapKeyUp(a)));break;case"pointer-down":this.registerIncoming("pointer-down",r,a=>n(this._wrapPointer(a,"pointer-down")));break;case"pointer-move":this.registerIncoming("pointer-move",r,a=>n(this._wrapPointer(a,"pointer-move")));break;case"pointer-up":this.registerIncoming("pointer-up",r,a=>n(this._wrapPointer(a,"pointer-up")));break;case"pointer-drag":this.registerIncoming("pointer-drag",r,a=>n(this._wrapPointerDrag(a)));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",r,a=>n(this._wrapMouseWheel(a)));break;case"pointer-enter":this.registerIncoming("pointer-enter",r,a=>n(this._wrapPointer(a,"pointer-enter")));break;case"pointer-leave":this.registerIncoming("pointer-leave",r,a=>n(this._wrapPointer(a,"pointer-leave")));break;case"gamepad":this.registerIncoming("gamepad",r,a=>{n(this._wrapGamepad(a))});break;case"focus":this.registerIncoming("focus",r,a=>{n(this._wrapFocus(a))});break;case"blur":this.registerIncoming("blur",r,a=>{n(this._wrapBlur(a))})}}_wrapFocus(e){return{type:"focus",timestamp:e.timestamp,native:e.data.native,cancelable:e.cancelable,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}_wrapBlur(e){return{type:"blur",timestamp:e.timestamp,native:e.data.native,cancelable:e.cancelable,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}_wrapClick(e){const{pointerType:t,button:r,buttons:n,x:s,y:a,native:o,eventId:l}=e.data,{cancelable:c,timestamp:u}=e;return{type:"click",pointerType:t,button:r,buttons:n,x:s,y:a,native:o,timestamp:u,screenPoint:Rs(s,a),mapPoint:this._getMapPoint(s,a),eventId:l,cancelable:c,stopPropagation:()=>e.stopPropagation(),async:d=>e.async(d),preventDefault:()=>e.preventDefault()}}_wrapDoubleClick(e){const{pointerType:t,button:r,buttons:n,x:s,y:a,native:o,eventId:l}=e.data,{cancelable:c,timestamp:u}=e;return{type:"double-click",pointerType:t,button:r,buttons:n,x:s,y:a,native:o,timestamp:u,mapPoint:this._getMapPoint(s,a),eventId:l,cancelable:c,stopPropagation:()=>e.stopPropagation(),async:d=>e.async(d),preventDefault:()=>e.preventDefault()}}_wrapImmediateClick(e){const{pointerType:t,button:r,buttons:n,x:s,y:a,native:o,eventId:l}=e.data,c=o.pointerId,{cancelable:u,timestamp:d}=e;return{type:"immediate-click",pointerId:c,pointerType:t,button:r,buttons:n,x:s,y:a,native:o,timestamp:d,mapPoint:this._getMapPoint(s,a),eventId:l,cancelable:u,stopPropagation:()=>e.stopPropagation(),async:m=>e.async(m),preventDefault:()=>e.preventDefault()}}_wrapImmediateDoubleClick(e){const{pointerType:t,button:r,buttons:n,x:s,y:a,native:o,eventId:l}=e.data,c=o.pointerId,{cancelable:u,timestamp:d}=e;return{type:"immediate-double-click",pointerId:c,pointerType:t,button:r,buttons:n,x:s,y:a,native:o,timestamp:d,mapPoint:this._getMapPoint(s,a),eventId:l,cancelable:u,stopPropagation:()=>e.stopPropagation(),async:m=>e.async(m),preventDefault:()=>e.preventDefault()}}_wrapHold(e){const{pointerType:t,button:r,buttons:n,x:s,y:a,native:o}=e.data,{cancelable:l,timestamp:c}=e;return{type:"hold",pointerType:t,button:r,buttons:n,x:s,y:a,native:o,timestamp:c,mapPoint:this._getMapPoint(s,a),cancelable:l,stopPropagation:()=>e.stopPropagation(),async:u=>e.async(u),preventDefault:()=>e.preventDefault()}}_getMapPoint(e,t){return this.view.toMap(Rs(e,t),{exclude:[]})}_wrapDrag(e){const t=e.data,{x:r,y:n}=t.center,{action:s,pointerType:a,button:o}=t;if(s==="start"&&(this._latestDragStart=t),!this._latestDragStart)return;const l=t.pointer.native,c=t.buttons,{cancelable:u,timestamp:d}=e,m={x:this._latestDragStart.center.x,y:this._latestDragStart.center.y};return s==="end"&&(this._latestDragStart=void 0),{type:"drag",action:s,x:r,y:n,origin:m,pointerType:a,button:o,buttons:c,radius:t.radius,angle:_o(t.angle),native:l,timestamp:d,cancelable:u,stopPropagation:()=>e.stopPropagation(),async:f=>e.async(f),preventDefault:()=>e.preventDefault()}}_wrapKeyDown(e){const{key:t,repeat:r,native:n}=e.data,{cancelable:s,timestamp:a}=e;return{type:"key-down",key:t,repeat:r,native:n,timestamp:a,cancelable:s,stopPropagation:()=>e.stopPropagation(),async:o=>e.async(o),preventDefault:()=>e.preventDefault()}}_wrapKeyUp(e){const{key:t,native:r}=e.data,{cancelable:n,timestamp:s}=e;return{type:"key-up",key:t,native:r,timestamp:s,cancelable:n,stopPropagation:()=>e.stopPropagation(),async:a=>e.async(a),preventDefault:()=>e.preventDefault()}}_wrapPointer(e,t){const{x:r,y:n,button:s,buttons:a,native:o,eventId:l}=e.data,c=o.pointerId,u=o.pointerType,{cancelable:d,timestamp:m}=e;return{type:t,x:r,y:n,pointerId:c,pointerType:u,button:s,buttons:a,native:o,timestamp:m,eventId:l,cancelable:d,stopPropagation:()=>e.stopPropagation(),async:f=>e.async(f),preventDefault:()=>e.preventDefault()}}_wrapPointerDrag(e){const{x:t,y:r,buttons:n,native:s,eventId:a}=e.data.currentEvent,{button:o}=e.data.startEvent,l=e.data.startEvent.native.pointerId,c=e.data.startEvent.native.pointerType,u=e.data.action,d={x:e.data.startEvent.x,y:e.data.startEvent.y},{cancelable:m,timestamp:f}=e;return{type:"pointer-drag",x:t,y:r,pointerId:l,pointerType:c,button:o,buttons:n,action:u,origin:d,native:s,timestamp:f,eventId:a,cancelable:m,stopPropagation:()=>e.stopPropagation(),async:_=>e.async(_),preventDefault:()=>e.preventDefault()}}_wrapMouseWheel(e){const{cancelable:t,data:r,timestamp:n}=e,{x:s,y:a,deltaY:o,native:l}=r;return{type:"mouse-wheel",x:s,y:a,deltaY:o,native:l,timestamp:n,cancelable:t,stopPropagation:()=>e.stopPropagation(),async:c=>e.async(c),preventDefault:()=>e.preventDefault()}}_wrapGamepad(e){const{action:t,state:r,device:n}=e.data,{cancelable:s,timestamp:a}=e,{buttons:o,axes:l}=r;return{type:"gamepad",device:n,timestamp:a,action:t,buttons:o,axes:l,cancelable:s,stopPropagation:()=>e.stopPropagation(),async:c=>e.async(c),preventDefault:()=>e.preventDefault()}}};var tx,TV,CV;(function(i){i[i.USER=0]="USER",i[i.MANAGER=1]="MANAGER"})(tx||(tx={})),function(i){i[i.None=0]="None",i[i.Unfocused=1]="Unfocused",i[i.Focused=2]="Focused",i[i.Unselected=4]="Unselected",i[i.Selected=8]="Selected",i[i.All=15]="All"}(TV||(TV={})),function(i){i[i.None=0]="None",i[i.Custom1=16]="Custom1",i[i.Custom2=32]="Custom2",i[i.Custom3=64]="Custom3",i[i.Custom4=128]="Custom4",i[i.Custom5=256]="Custom5",i[i.Custom6=512]="Custom6",i[i.Custom7=1024]="Custom7",i[i.Custom8=2048]="Custom8",i[i.Custom9=4096]="Custom9",i[i.Custom10=8192]="Custom10",i[i.Custom11=16384]="Custom11",i[i.Custom12=32768]="Custom12",i[i.All=65520]="All"}(CV||(CV={}));function Rpe(i){return[i.on("before-add",e=>{const t=e.item;if(t==null||i.includes(t))return ee.getLogger("esri.views.interactive.interactiveToolUtils").warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void e.preventDefault();t.onAdd()}),i.on("after-remove",e=>{const t=e.item;t.active&&(t.view.activeTool=null),t.destroy()})]}function t3(i){return i.visible&&i.getEditableFlag(tx.USER)&&i.getEditableFlag(tx.MANAGER)}function gh(i){return Rs(i.x,i.y)}function w9e(i){return zi(i.x,i.y)}function NW(i,e){const t=(i instanceof HTMLElement?i:i.surface).getBoundingClientRect();return Rs(e.clientX-t.left,e.clientY-t.top)}function I2(i,e){return e instanceof Event?NW(i,e):gh(e)}function L2(i){if(i instanceof Event)return!0;if(typeof i=="object"&&"type"in i)switch(i.type){case"click":case"double-click":case"pointer-down":case"pointer-drag":case"pointer-enter":case"pointer-leave":case"pointer-up":case"pointer-move":case"immediate-click":case"immediate-double-click":case"hold":case"drag":case"mouse-wheel":return!0;default:return!1}return!1}let Ppe=class{constructor(){this._pointerLocations=new Map,this._hoveredManipulators=new Map,this._grabbedManipulators=new Map,this._draggedManipulators=new Map,this._stopDrag=!1,this._revertToNullActiveTool=!1,this._cursor=null}get cursor(){return this._cursor}handleInputEvent(e,t){const r=()=>e.stopPropagation();switch(e.type){case"pointer-move":SV(e.pointerType)&&this._pointerLocations.set(e.pointerId,{x:e.x,y:e.y,pointerType:e.pointerType});break;case"drag":this._grabbedManipulators.size>0&&(this._stopDrag=!0),this._stopDrag&&(r(),e.action==="end"&&(this._stopDrag=!1));break;case"pointer-down":{if(!EV(e))break;const n=gh(e),s=this._intersect(n,e.pointerType,t.forEachTool);if(C(s))break;const a=s.manipulator,o=s.tool;!(y(a)&&y(o)&&a.interactive)||a.grabbable&&a.grabbableForEvent(e)||!a.grabbing||a.dragging||this._ungrabManipulatorBeforeDragging(a,e,t),y(a)&&y(o)&&a.interactive&&a.grabbable&&a.grabbableForEvent(e)&&!a.grabbing&&(this._grabbedManipulators.set(e.pointerId,{manipulator:a,tool:o,start:n,pointerType:e.pointerType}),this._grabbedManipulators.size===1&&C(t.activeTool)&&(this._revertToNullActiveTool=!0,t.setActiveTool(s.tool)),a.grabbing=!0,a.events.emit("grab-changed",{action:"start",pointerType:e.pointerType,screenPoint:n}),r());break}case"pointer-up":this._draggedManipulators.has(e.pointerId)||this._handlePointerEnd(e,t);break;case"pointer-drag":{if(!EV(e))break;const n=this._grabbedManipulators.get(e.pointerId),s=co(n,({manipulator:u})=>u),a=co(n,({tool:u})=>u);if(C(s)||C(a))break;const o=gh(e);o.x=ue(o.x,0,t.view.width),o.y=ue(o.y,0,t.view.height);const l=ft(n).start,c=this._draggedManipulators.get(e.pointerId);switch(e.action){case"start":case"update":e.action!=="update"&&this._grabbedManipulators.size!==1||(s.dragging=!0,c?s.events.emit("drag",{action:"update",start:l,screenPoint:o}):s.events.emit("drag",{action:"start",start:l,screenPoint:o,pointerType:e.pointerType}),this._draggedManipulators.set(e.pointerId,{tool:a,manipulator:s,start:l}));break;case"end":s.dragging=!1,c&&s.events.emit("drag",{action:"end",start:l,screenPoint:o}),this._draggedManipulators.delete(e.pointerId),this._handlePointerEnd(e,t)}r();break}case"immediate-click":{const n=gh(e),s=this._intersect(n,e.pointerType,t.forEachTool);if(Ape(e)||t.forEachTool(c=>{if((!y(s)||s.tool!==c||c.automaticManipulatorSelection)&&c.manipulators){let u=!1;c.manipulators.forEach(({manipulator:d})=>{d.selected&&(d.selected=!1,u=!0)}),u&&c.onManipulatorSelectionChanged&&c.onManipulatorSelectionChanged()}}),C(s))break;const{manipulator:a,tool:o}=s;if(!a.interactive)break;a.selectable&&o.automaticManipulatorSelection&&(a.selected=!a.selected,o.onManipulatorSelectionChanged&&o.onManipulatorSelectionChanged());const l=e.native.shiftKey;a.events.emit("immediate-click",{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:l,stopPropagation:r});break}case"click":{const n=gh(e),s=this._intersect(n,e.pointerType,t.forEachTool),a=y(s)?s.manipulator:null;if(C(a)||!a.interactive)break;const o=e.native.shiftKey;a.events.emit(e.type,{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:o}),r();break}case"double-click":{const n=gh(e),s=this._intersect(n,e.pointerType,t.forEachTool),a=y(s)?s.manipulator:null;if(C(a)||!a.interactive)break;const o=e.native.shiftKey;a.events.emit("double-click",{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:o,stopPropagation:r});break}case"immediate-double-click":{const n=gh(e),s=this._intersect(n,e.pointerType,t.forEachTool),a=y(s)?s.manipulator:null;if(C(a)||!a.interactive)break;const o=e.native.shiftKey;a.events.emit("immediate-double-click",{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:o,stopPropagation:r});break}}this._onFocusChange(t.forEachTool)}_ungrabManipulatorBeforeDragging(e,t,r){e.grabbing=!1,e.events.emit("grab-changed",{action:"end",pointerType:t.pointerType,screenPoint:gh(t)}),this._grabbedManipulators.forEach(({manipulator:n},s)=>{n===e&&this._grabbedManipulators.delete(s)}),this._afterManipulatorUngrab(r.setActiveTool)}_handlePointerEnd(e,t){const r=co(this._grabbedManipulators.get(e.pointerId),({manipulator:n})=>n);C(r)||r.grabbing&&(r.grabbing=!1,r.events.emit("grab-changed",{action:"end",pointerType:e.pointerType,screenPoint:gh(e)}),this._grabbedManipulators.delete(e.pointerId),this._afterManipulatorUngrab(t.setActiveTool))}_cursorFromMap(e){let t=null;return Er(e,({manipulator:r})=>!(C(r)||!r.interactive)&&(r.grabbing&&r.grabCursor?(t=r.grabCursor,!0):!!r.cursor&&(t=r.cursor,!0))),t}_onFocusChange(e){this._updateCursor(),this._updateFocusedManipulatorTools(e)}_updateCursor(){this._grabbedManipulators.size>0?this._cursor=this._cursorFromMap(this._grabbedManipulators)||"grabbing":this._hoveredManipulators.size>0?this._cursor=this._cursorFromMap(this._hoveredManipulators)||"pointer":this._cursor=null}_updateFocusedManipulatorTools(e){const t=new Set,r=new Set;this._grabbedManipulators.forEach(({tool:n})=>{t.add(n)}),this._hoveredManipulators.forEach(({tool:n})=>{r.add(n)}),e(n=>{n.hasGrabbedManipulators=t.has(n),n.hasHoveredManipulators=r.has(n);const s=this._grabbedManipulators.values(),a=dte(s,({tool:o})=>o===n);n.firstGrabbedManipulator=y(a)?a.manipulator:null})}clearPointers(e,{forEachTool:t,setActiveTool:r},n=!0,s){const a=(o,l)=>o===e&&(C(s)||s===l);this._grabbedManipulators.forEach(({tool:o,manipulator:l,pointerType:c},u)=>{a(o,l)&&(this._grabbedManipulators.delete(u),l.grabbing=!1,l.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:c}))}),this._draggedManipulators.forEach(({tool:o,manipulator:l},c)=>{a(o,l)&&(this._draggedManipulators.delete(c),l.dragging=!1,l.events.emit("drag",{action:"cancel"}))}),n&&this._hoveredManipulators.forEach(({tool:o,manipulator:l},c)=>{a(o,l)&&(this._hoveredManipulators.delete(c),l.hovering=!1)}),this._afterManipulatorUngrab(r),this._onFocusChange(t)}_intersect(e,t,r){let n=null;return r(s=>{if(s.manipulators==null||!t3(s))return!1;const a=s.manipulators.intersect(e,t);return!C(a)&&(n={tool:s,manipulator:a},!0)}),n}updateHoveredStateFromKnownPointers(e){this._pointerLocations.forEach((t,r)=>{this._updateHoveredStateForPointerAtScreenPosition(Rs(t.x,t.y),r,t.pointerType,e)})}handleHoverEvent(e,t){e.type!=="pointer-up"&&e.type!=="immediate-click"&&e.type!=="pointer-move"||!SV(e.pointerType)||this._updateHoveredStateForPointerAtScreenPosition(gh(e),e.pointerId,e.pointerType,t)}_updateHoveredStateForPointerAtScreenPosition(e,t,r,n){let s=this._intersect(e,r,n);const a=co(this._hoveredManipulators.get(t),({manipulator:o})=>o);y(s)&&!s.manipulator.interactive&&(s=null),y(s)&&a===s.manipulator||(y(a)&&(a.hovering=!1),y(s)?(s.manipulator.hovering=!0,this._hoveredManipulators.set(t,s)):this._hoveredManipulators.delete(t),this._onFocusChange(n))}_afterManipulatorUngrab(e){this._grabbedManipulators.size===0&&this._revertToNullActiveTool&&(e(null),this._revertToNullActiveTool=!1)}};function SV(i){return i==="mouse"}function EV(i){return i.pointerType!=="mouse"||i.button===0}function Ape(i){return!!i.native.shiftKey}const RV="attached",aO="tools";let Lu=class extends dD{constructor(e){super(e),this._manipulatorState=new Ppe,this.tools=new wt,this.cursor=null,this._forEachTool=t=>{for(const r of this.tools.items)if(t(r))return}}initialize(){this.handles.add([this.view.on($W,e=>{this._handleInputEvent(e)},Yh.TOOL),...Rpe(this.tools),this.tools.on("before-add",({item:e})=>{this._updateToolEditableFlag(e)}),this.tools.on("before-remove",({item:e})=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()}),this.tools.on("change",()=>{this._refreshToolWatchers()})])}destroy(){this.detach(),this.handles.removeAll()}get _manipulatorStateEventArgs(){return{forEachTool:this._forEachTool,activeTool:this.activeTool,setActiveTool:e=>{this.activeTool=e},view:this.view}}set activeTool(e){if(y(e)&&!this.view.ready)return void ee.getLogger(this.declaredClass).error("Cannot set active tool while view is not ready.");if(e===this.activeTool)return;const t=this.activeTool;this._set("activeTool",e),y(t)&&t.deactivate(),y(e)&&e.activate(),this._removeIncompleteTools(e);for(const r of this.tools){this._updateToolEditableFlag(r);const n=t3(r);!C(this.activeTool)&&n||this._manipulatorState.clearPointers(r,this._manipulatorStateEventArgs,!n)}this._updateCursor()}get updating(){var e;return this.updatingHandles.updating||this.tools.some(t=>t.updating)||(((e=this.textures)==null?void 0:e.updating)??!1)}attach(){this.view.type==="3d"?(this._set("textures",new c0(this.view._stage,this.view.resourceController.scheduler)),this.handles.add([B(()=>{const{state:e}=this.view;return"camera"in e&&e.camera},()=>{this._forEachManipulator(e=>{e.onViewChange!=null&&e.onViewChange()})}),this.view.elevationProvider.on("elevation-change",e=>{this._forEachManipulator(t=>{t.onElevationChange!=null&&t.onElevationChange(e)})}),fw(()=>this._set("textures",Oe(this.textures)))],RV)):this.handles.add(B(()=>this.view.extent,()=>{this._forEachManipulator(e=>{e.onViewChange!=null&&e.onViewChange()})}))}detach(){y(this.activeTool)&&(this.activeTool=null),this.tools.removeAll(),this.handles.remove(RV)}_forEachManipulator(e){this._forEachTool(t=>{t.manipulators&&t.manipulators.forEach(({manipulator:r})=>e(r,t))})}_handleInputEvent(e){let t=!1;const r={...e,stopPropagation:()=>{t=!0,e.stopPropagation()}};y(this.activeTool)?this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(r):this._forEachTool(n=>{!t&&n.visible&&n.handleInputEvent(r)}),!t&&e.type==="key-down"&&e.key==="Escape"&&this.activeTool&&(e.stopPropagation(),this.activeTool=null),this._manipulatorState.handleInputEvent(r,this._manipulatorStateEventArgs),!t&&y(this.activeTool)&&this.activeTool.handleInputEventAfter(r),this._manipulatorState.handleHoverEvent(r,this._forEachTool),this._updateCursor()}_refreshToolWatchers(){this.handles.remove(aO),this._forEachTool(e=>{if(e instanceof pe){const t=B(()=>[e.cursor,e.visible,e.editable],()=>{t3(e)||this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()});this.handles.add(t,aO)}e.manipulators&&this.handles.add([e.manipulators.on("after-remove",t=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs,!0,t.item.manipulator)}),e.manipulators.on("change",()=>{this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()})],aO)}),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()}_updateToolEditableFlag(e){e.setEditableFlag(tx.MANAGER,C(this.activeTool)||e===this.activeTool)}_updateCursor(){let e=this._manipulatorState.cursor;C(e)&&this._forEachTool(t=>!(!y(t.cursor)||!t.visible)&&(e=t.cursor,!0)),this._get("cursor")!==e&&this._set("cursor",e)}_removeIncompleteTools(e){this.tools.filter(t=>(C(e)||t!==e)&&!t.created&&t.removeIncompleteOnCancel).forEach(t=>{this.tools.remove(t)})}};h([p({constructOnly:!0,nonNullable:!0})],Lu.prototype,"view",void 0),h([p({readOnly:!0,nonNullable:!0})],Lu.prototype,"textures",void 0),h([p({value:null})],Lu.prototype,"activeTool",null),h([p({readOnly:!0,type:wt})],Lu.prototype,"tools",void 0),h([p({readOnly:!0})],Lu.prototype,"cursor",void 0),h([p({readOnly:!0})],Lu.prototype,"updating",null),Lu=h([F("esri.views.ToolViewManager")],Lu);const Ope=Lu;let fy=class extends pe{constructor(e){super(),this.nativeIndex=null,this._detectedDeviceType="unknown",e.mapping==="standard"?this._detectedDeviceType="standard":Mpe.test(e.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=e.index}get native(){const e=navigator.getGamepads?navigator.getGamepads():[];return this.nativeIndex!=null&&this.nativeIndex<e.length?e[this.nativeIndex]:null}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return Ipe[this.deviceType]}};h([p({nonNullable:!0,readOnly:!0})],fy.prototype,"nativeIndex",void 0),h([p({type:String,readOnly:!0})],fy.prototype,"deviceType",null),h([p({type:Number,readOnly:!0})],fy.prototype,"axisThreshold",null),fy=h([F("esri.views.input.gamepad.GamepadInputDevice")],fy);const Mpe=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),Ipe={standard:.15,spacemouse:.025,unknown:0},pN=fy;let q1=class extends pe{constructor(...e){super(...e),this.devices=new wt,this.enabledFocusMode="document"}};h([p({type:wt.ofType(pN),readOnly:!0})],q1.prototype,"devices",void 0),h([p({type:["document","view","none"]})],q1.prototype,"enabledFocusMode",void 0),q1=h([F("esri.views.input.gamepad.GamepadSettings")],q1);const Lpe=q1;let WS=class extends pe{constructor(){super(...arguments),this.gamepad=new Lpe}};h([p({readOnly:!0})],WS.prototype,"gamepad",void 0),WS=h([F("esri.views.input.Input")],WS);const $pe=WS;let wp=class extends pe{constructor(e){super(e),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1}};h([p({type:Boolean,nonNullable:!0})],wp.prototype,"enabled",void 0),h([p({type:pN})],wp.prototype,"device",void 0),h([p({type:["pan","zoom"],nonNullable:!0})],wp.prototype,"mode",void 0),h([p({type:["forward-down","forward-up"],nonNullable:!0})],wp.prototype,"tiltDirection",void 0),h([p({type:Number,nonNullable:!0})],wp.prototype,"velocityFactor",void 0),wp=h([F("esri.views.navigation.gamepad.GamepadSettings")],wp);const kW=wp;let Of=class extends pe{constructor(e){super(e),this.browserTouchPanEnabled=!0,this.gamepad=new kW,this.momentumEnabled=!0,this.mouseWheelZoomEnabled=!0}};h([p({type:Boolean})],Of.prototype,"browserTouchPanEnabled",void 0),h([p({type:kW,nonNullable:!0})],Of.prototype,"gamepad",void 0),h([p({type:Boolean})],Of.prototype,"momentumEnabled",void 0),h([p({type:Boolean})],Of.prototype,"mouseWheelZoomEnabled",void 0),Of=h([F("esri.views.navigation.Navigation")],Of);const VW=Of;function A9e(i,e,t){const r=UW(i),n=e,s=Dpe(r,n,t);if(r){const a=Gx.deriveUnitFromSR(r,i.spatialReference).heightUnit;if(!t&&a!==r.heightUnit){const o=new J("layerview:unmatched-height-unit",`The vertical units of the layer must match the horizontal units (${a})`,{horizontalUnit:a});return new J("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:r,error:o})}}if(!Fpe(i)||s===io.Unsupported)return new J("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:r});switch(s){case io.Units:{const a=(r==null?void 0:r.heightUnit)||"unknown",o=(n==null?void 0:n.heightUnit)||"unknown",l=new J("layerview:incompatible-height-unit",`The vertical units of the layer (${a}) must match the vertical units of the scene (${o})`,{layerUnit:a,sceneUnit:o});return new J("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:r,sceneHeightModelInfo:n,error:l})}case io.HeightModel:{const a=(r==null?void 0:r.heightModel)||"unknown",o=(n==null?void 0:n.heightModel)||"unknown",l=new J("layerview:incompatible-height-model",`The height model of the layer (${a}) must match the height model of the scene (${o})`,{layerHeightModel:a,sceneHeightModel:o});return new J("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:r,sceneHeightModelInfo:n,error:l})}case io.CRS:{const a=(r==null?void 0:r.vertCRS)||"unknown",o=(n==null?void 0:n.vertCRS)||"unknown",l=new J("layerview:incompatible-vertical-datum",`The vertical datum of the layer (${a}) must match the vertical datum of the scene (${o})`,{layerDatum:a,sceneDatum:o});return new J("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:r,sceneHeightModelInfo:n,error:l})}}return null}function Dpe(i,e,t){if(!PV(i)||!PV(e))return io.Unsupported;if(i==null||e==null)return io.Ok;if(!t&&i.heightUnit!==e.heightUnit)return io.Units;if(i.heightModel!==e.heightModel)return io.HeightModel;switch(i.heightModel){case"gravity-related-height":return io.Ok;case"ellipsoidal":return i.vertCRS===e.vertCRS?io.Ok:io.CRS;default:return io.Unsupported}}var io;function PV(i){return i==null||i.heightModel!=null&&i.heightUnit!=null}function Fpe(i){return"heightModelInfo"in i&&i.heightModelInfo!=null||i.spatialReference!=null||!GW(i)}function UW(i){var r;const e=i.url?EI(i.url):void 0;return!(((r=i.spatialReference)==null?void 0:r.vcsWkid)==null&&y(e)&&e.serverType==="ImageServer")&&zW(i)&&i.heightModelInfo?i.heightModelInfo:GW(i)?Gx.deriveUnitFromSR(kpe,i.spatialReference):null}function zW(i){return"heightModelInfo"in i}function BW(i){if(i.type==="unknown"||!("capabilities"in i))return!1;switch(i.type){case"csv":case"feature":case"geojson":case"subtype-group":case"ogc-feature":case"oriented-imagery":case"wfs":return!0;default:return!1}}function GW(i){return BW(i)?!!(i.capabilities&&i.capabilities.data&&i.capabilities.data.supportsZ):HW(i)}function Npe(i){return i.layers!=null||HW(i)||BW(i)||zW(i)}function HW(i){switch(i.type){case"building-scene":case"elevation":case"integrated-mesh":case"point-cloud":case"scene":case"voxel":return!0;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"csv":case"dimension":case"geojson":case"feature":case"subtype-group":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"line-of-sight":case"map-image":case"map-notes":case"media":case"ogc-feature":case"open-street-map":case"oriented-imagery":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"wcs":case"web-tile":case"wfs":case"wms":case"wmts":case null:return!1}return!1}(function(i){i[i.Ok=0]="Ok",i[i.Units=1]="Units",i[i.HeightModel=2]="HeightModel",i[i.CRS=3]="CRS",i[i.Unsupported=4]="Unsupported"})(io||(io={}));const kpe=new Gx({heightModel:"gravity-related-height"});let i3,oO=null;async function Vpe(i){oO||(oO=j(()=>Promise.resolve().then(()=>T$),void 0).then(e=>i3=e)),await oO,Ti(i)}async function jW(i,e,t,r){if(!i)return null;const n=i.spatialReference;return vw()||gv(n,e)?Dd(i,e):i3?i3.projectGeometry(i,e,t,r):(await Promise.race([Vpe(r),PR(r)]),jW(i,e,t,r))}let Pi=class extends pe{constructor(e){super(e),this.required={tileInfo:!1,heightModelInfo:!1,extent:!1},this.defaultSpatialReference=null,this.userSpatialReference=null,this.sourcePreloadCount=10,this.priorityCollection=null,this.requiresExtentInSpatialReference=!0,this.suspended=!1,this._projectExtentTask={task:null,input:null,output:null,spatialReference:null}}destroy(){this._projectExtentTask.task&&(this._projectExtentTask.task=iu(this._projectExtentTask.task)),this._set("map",null)}get ready(){return!this._spatialReferenceTask.updating&&!this._tileInfoTask.updating&&!this._extentTask.updating}get heightModelInfoReady(){return!this._heightModelInfoTask.updating}get spatialReference(){return y(this.userSpatialReference)?this.userSpatialReference:ft(this._spatialReferenceTask.spatialReference)}get extent(){return ft(this._extentTask.extent)}get heightModelInfo(){return ft(this._heightModelInfoTask.heightModelInfo)}get vcsWkid(){return ft(this._heightModelInfoTask.vcsWkid)}get latestVcsWkid(){return ft(this._heightModelInfoTask.latestVcsWkid)}get viewingMode(){return C(this.userSpatialReference)||this.userSpatialReference.equals(ft(this._spatialReferenceTask.spatialReference))?ft(this._spatialReferenceTask.viewingMode):null}get tileInfo(){return ft(this._tileInfoTask.tileInfo)}get mapCollections(){var r,n,s,a;const e=(r=this.map)==null?void 0:r.call(this),t=[];return y(this.priorityCollection)&&t.push(this.priorityCollection),t.push({parent:e==null?void 0:e.basemap,layers:(n=e==null?void 0:e.basemap)==null?void 0:n.baseLayers},{layers:e==null?void 0:e.layers},{parent:e==null?void 0:e.ground,layers:(s=e==null?void 0:e.ground)==null?void 0:s.layers},{parent:e==null?void 0:e.basemap,layers:(a=e==null?void 0:e.basemap)==null?void 0:a.referenceLayers}),t}get _allLayers(){return this._collectLayers(this.mapCollections)}get _spatialReferenceTask(){if(this.suspended)return this._get("_spatialReferenceTask")??{updating:!1};const{layers:e,updating:t}=this._allLayers;let r=null;for(const s of e){const a=this._getSupportedSpatialReferences(s);if(a.length>0){const o=this._narrowDownSpatialReferenceCandidates(r,a);y(o)&&(r=o)}if(y(r)&&r.length===1)break}if(t&&(C(r)||r.length!==1))return{updating:!0};const n=this._pickSpatialReferenceCandidate(r);return{spatialReference:y(n)?n.spatialReference:null,viewingMode:y(n)?n.viewingMode:null,updating:!1}}get _tileInfoTask(){var r,n,s,a,o,l,c;if(!this.required.tileInfo)return this._get("_tileInfoTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const{layers:e,updating:t}=this._collectLayers([{parent:(n=(r=this.map)==null?void 0:r.call(this))==null?void 0:n.basemap,layers:(o=(a=(s=this.map)==null?void 0:s.call(this))==null?void 0:a.basemap)==null?void 0:o.baseLayers},{layers:(c=(l=this.map)==null?void 0:l.call(this))==null?void 0:c.layers}]);if(e&&e.length>0&&"tileInfo"in e[0]){const u=e[0].tileInfo;return{tileInfo:u&&u.spatialReference.equals(this.spatialReference)?u:null,updating:!1}}return{updating:t}}get _heightModelInfoTask(){var r,n,s;if(!this.required.heightModelInfo||this.suspended&&((r=this._get("_heightModelInfoTask"))!=null&&r.heightModelInfo))return this._get("_heightModelInfoTask")??{updating:!1};const{layers:e,updating:t}=this._allLayers;for(const a of e)if(Npe(a)){const o=UW(a);if(o)return{heightModelInfo:o,vcsWkid:(n=a.spatialReference)==null?void 0:n.vcsWkid,latestVcsWkid:(s=a.spatialReference)==null?void 0:s.latestVcsWkid,updating:!1}}return{updating:t}}get _extentCandidatesTask(){if(this.suspended||!this.required.extent)return this._get("_extentCandidatesTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const e=this._allLayers,t=e.updating,r=[];for(const n of e.layers){const s="fullExtents"in n&&n.fullExtents||(y(n.fullExtent)?[n.fullExtent]:[]),a=this.requiresExtentInSpatialReference?null:s[0],o=s.find(l=>l.spatialReference.equals(this.spatialReference))??a;if(o)return{candidates:[{extent:o,layer:n}],updating:!1};if(this._getSupportedSpatialReferences(n).length>0)for(const l of s)r.push({extent:l,layer:n})}return{candidates:r,updating:t}}get _extentTask(){const{candidates:e,updating:t}=this._extentCandidatesTask;if(t)return{updating:t};if(C(e)||e.length===0)return{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const r=this._pickExtentCandidate(e),n=this.spatialReference;return r.extent.equals(this._projectExtentTask.input)&&n.equals(this._projectExtentTask.spatialReference)?{extent:this._projectExtentTask.output,updating:y(this._projectExtentTask.task)&&!this._projectExtentTask.task.finished}:(y(this._projectExtentTask.task)&&(this._projectExtentTask.task=iu(this._projectExtentTask.task)),this._projectExtentTask={input:r.extent.clone(),output:null,spatialReference:n.clone(),task:Bx(async s=>{try{const a=await jW(r.extent,n,r.layer.portalItem,s);this._projectExtentTask={...this._projectExtentTask,task:null,output:a}}catch{if(Ec(s))return;this._projectExtentTask={...this._projectExtentTask,task:null}}})},{updating:!0})}_narrowDownSpatialReferenceCandidates(e,t){if(C(e))return t;const r=[],n=(s,a)=>y(s)?y(a)?s===a&&s:s:a;for(const s of e)for(const a of t){if(!s.spatialReference.equals(a.spatialReference))continue;const o=n(s.viewingMode,a.viewingMode);if(o!==!1){r.push({spatialReference:s.spatialReference,viewingMode:o});break}}return r.length>0?r:null}_pickSpatialReferenceCandidate(e){const t=this.defaultSpatialReference;return C(e)||e.length<1?y(t)?{spatialReference:t,viewingMode:null}:null:(y(t)&&e.length>1&&e.some(({spatialReference:r})=>r.equals(t))&&(e=e.filter(({spatialReference:r})=>r.equals(t))),e.length>1&&e.some(({viewingMode:r})=>r!==Ie.Local)&&(e=e.filter(({viewingMode:r})=>r!==Ie.Local)),e[0])}_getSupportedSpatialReferences(e){const t="supportedSpatialReferences"in e&&e.supportedSpatialReferences||(e.spatialReference?[e.spatialReference]:[]);if(t.length===0)return[];const r=[];for(const n of t){const s=this.getSpatialReferenceSupport({spatialReference:n,layer:e});if(y(s)){const a=y(s.constraints)?s.constraints:[{spatialReference:n,viewingMode:null}];for(const{spatialReference:o,viewingMode:l}of a)(!this.requiresExtentInSpatialReference||C(this.userSpatialReference)||o.equals(this.userSpatialReference))&&r.push({spatialReference:o,viewingMode:l})}}return r}_pickExtentCandidate(e){const t=this.spatialReference;return e.find(({extent:r})=>t.equals(r.spatialReference))||e[0]}_collectLayers(e){var r;if(this._loadMaybe((r=this.map)==null?void 0:r.call(this))!=="loaded")return{layers:[],updating:!0};const t={layers:[],preloading:-1,updating:!1};for(const n of e)if(this._collectCollection(n,t),t.preloading===this.sourcePreloadCount)break;return{layers:t.layers,updating:t.updating}}_collectCollection(e,t){if(e.layers){switch(this._loadMaybe(e.parent)){case"loading":return t.updating=!0,void++t.preloading;case"failed":return}for(const r of e.layers){switch(this._loadMaybe(r)){case"failed":continue;case"loading":t.updating=!0,++t.preloading;break;case"loaded":t.updating||t.layers.push(r),"layers"in r&&this._collectCollection({layers:r.layers},t)}if(t.preloading===this.sourcePreloadCount)break}}}_loadMaybe(e){return e&&"loadStatus"in e?e.loadStatus==="not-loaded"?(e.load().catch(()=>{}),"loading"):e.loadStatus:"loaded"}};h([p()],Pi.prototype,"required",void 0),h([p({constructOnly:!0})],Pi.prototype,"map",void 0),h([p({constructOnly:!0})],Pi.prototype,"getSpatialReferenceSupport",void 0),h([p()],Pi.prototype,"defaultSpatialReference",void 0),h([p()],Pi.prototype,"userSpatialReference",void 0),h([p()],Pi.prototype,"sourcePreloadCount",void 0),h([p()],Pi.prototype,"priorityCollection",void 0),h([p()],Pi.prototype,"requiresExtentInSpatialReference",void 0),h([p()],Pi.prototype,"suspended",void 0),h([p({readOnly:!0})],Pi.prototype,"ready",null),h([p({readOnly:!0})],Pi.prototype,"heightModelInfoReady",null),h([p({readOnly:!0})],Pi.prototype,"spatialReference",null),h([p({readOnly:!0})],Pi.prototype,"extent",null),h([p({readOnly:!0})],Pi.prototype,"heightModelInfo",null),h([p({readOnly:!0})],Pi.prototype,"vcsWkid",null),h([p({readOnly:!0})],Pi.prototype,"latestVcsWkid",null),h([p({readOnly:!0})],Pi.prototype,"viewingMode",null),h([p({readOnly:!0})],Pi.prototype,"tileInfo",null),h([p({readOnly:!0})],Pi.prototype,"mapCollections",null),h([p({readOnly:!0})],Pi.prototype,"_allLayers",null),h([p({readOnly:!0})],Pi.prototype,"_spatialReferenceTask",null),h([p({readOnly:!0})],Pi.prototype,"_tileInfoTask",null),h([p({readOnly:!0})],Pi.prototype,"_heightModelInfoTask",null),h([p({readOnly:!0})],Pi.prototype,"_extentCandidatesTask",null),h([p()],Pi.prototype,"_extentTask",null),h([p()],Pi.prototype,"_projectExtentTask",void 0),Pi=h([F("esri.views.support.DefaultsFromMap")],Pi);var XS;let tt=XS=class extends Ux(nn.EventedMixin(bD(pe))){constructor(i){super(i),this._userSpatialReference=null,this._cursor=null,this.allLayerViews=new yw({getCollections:()=>{var e,t,r;return[(e=this.basemapView)==null?void 0:e.baseLayerViews,(t=this.groundView)==null?void 0:t.layerViews,this.layerViews,(r=this.basemapView)==null?void 0:r.referenceLayerViews]},getChildrenFunction:e=>e.layerViews}),this.groundView=null,this.basemapView=null,this.fatalError=null,this.graphics=new mG,this.analyses=new ov,this.typeSpecificPreconditionsReady=!0,this.layerViews=new wt,this.magnifier=new LW,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this.spatialReferenceWarningDelay=1e3,this.supportsGround=!0,this.timeExtent=null,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this.input=new $pe,this.navigation=new VW,this.layerViewManager=null,this.analysisViewManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new Spe(this),this.persistableViewModels=new wt,this._isValid=!1,this._readyCycleForced=!1,this.handles.add(B(()=>this.preconditionsReady,e=>{var t,r;e?(this._currentSpatialReference=this.spatialReference,XS.views.add(this)):(this._currentSpatialReference=null,XS.views.remove(this)),this.notifyChange("spatialReference"),!e&&this.ready?((t=this.toolViewManager)==null||t.detach(),y(this.analysisViewManager)&&this.analysisViewManager.detach(),(r=this.layerViewManager)==null||r.clear(),this._teardown()):e&&!this.ready&&(this._startup(),y(this.analysisViewManager)&&this.analysisViewManager.attach(),this.toolViewManager.attach())},ni))}initialize(){this.addResolvingPromise(this.validate().then(()=>(this._isValid=!0,Pm(()=>this.ready)))),this.basemapView=new bp({view:this}),this.layerViewManager=new Tpe({view:this,layerViewImporter:{importLayerView:i=>this.importLayerView(i),hasLayerViewModule:i=>this.hasLayerViewModule(i)},supportsGround:this.supportsGround}),this.toolViewManager=new Ope({view:this}),this._setupSpatialReferenceLogger(),this.handles.add([B(()=>this.initialExtentRequired,i=>this.defaultsFromMap.required={...this.defaultsFromMap.required,extent:i},{sync:!0,initial:!0}),B(()=>this.ready,i=>{this.defaultsFromMap&&(this.defaultsFromMap.suspended=i,this.defaultsFromMap.userSpatialReference=i?this.spatialReference:this._userSpatialReference)},{sync:!0}),B(()=>this._userSpatialReference,i=>{this.defaultsFromMap&&(this.defaultsFromMap.userSpatialReference=i)},{sync:!0,initial:!0})])}_setupSpatialReferenceLogger(){let i=null;this.handles.add([B(()=>{var e;return(e=this.defaultsFromMap)==null?void 0:e.ready},e=>{var r;const t=((r=this.map)==null?void 0:r.allLayers.length)>0;if(e&&!this.spatialReference&&t){if(y(i))return;const n=fw(()=>i=iu(i));i=Bx(async s=>{try{await j0(this.spatialReferenceWarningDelay,null,s)}catch{return}finally{i=null}ee.getLogger(this.declaredClass).warn("#spatialReference","no spatial reference could be derived from the currently added map layers")}),this.handles.add(n,"spatial-reference-logger-task")}else this.handles.remove("spatial-reference-logger-task")},{sync:!0})])}destroy(){if(this.destroyed)return;this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=Oe(this.graphics),this.analyses=Oe(this.analyses),this.handles.remove("defaultsFromMap"),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),Oe(this.analysisViewManager),this.toolViewManager=Oe(this.toolViewManager),this.layerViewManager=Oe(this.layerViewManager),this.basemapView=Oe(this.basemapView),this.invalidate(),this._emitter.clear(),this.handles.removeAll();const i=this.map;this.map=null,i==null||i.destroy()}_startup(){this._set("ready",!0)}_teardown(){this._set("ready",!1)}whenReady(){return Promise.resolve(this)}toMap(){return ee.getLogger(this.declaredClass).error("#toMap()","Not implemented on this instance of View"),null}get activeTool(){var i;return(i=this.toolViewManager)==null?void 0:i.activeTool}set activeTool(i){this.toolViewManager&&(this.toolViewManager.activeTool=i)}get animation(){return this._get("animation")}set animation(i){this._set("animation",i)}get _defaultsFromMapSettings(){return{}}get defaultsFromMap(){return new Pi({required:{tileInfo:!1,heightModelInfo:!1,extent:!1},map:()=>this.map,getSpatialReferenceSupport:i=>this.getSpatialReferenceSupport(i),...this._defaultsFromMapSettings})}get extent(){return this._get("extent")}set extent(i){this._set("extent",i)}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get interacting(){return this.navigating}get navigating(){return!1}get preconditionsReady(){var i;return!(this.fatalError||!this._isValid||this._readyCycleForced||!this.map||Om.isLoadable(this.map)&&!this.map.loaded||this.width===0||this.height===0||!this.spatialReference||!this._validateSpatialReference(this.spatialReference)||!this._currentSpatialReference&&!((i=this.defaultsFromMap)!=null&&i.ready)||!this.typeSpecificPreconditionsReady)}set map(i){i!==this._get("map")&&(i!=null&&i.destroyed&&(ee.getLogger(this.declaredClass).warn("#map","The provided map is already destroyed",{map:i}),i=null),Om.isLoadable(i)&&i.load().catch(()=>{}),this.constructed&&(this.forceReadyCycle(),this._currentSpatialReference=null),this._set("map",i))}get spatialReference(){var e,t;let i=this._userSpatialReference||this._currentSpatialReference||this.getDefaultSpatialReference()||null;return i&&((t=(e=this.defaultsFromMap)==null?void 0:e.required)!=null&&t.heightModelInfo)&&(i=i.clone(),i.vcsWkid=this.defaultsFromMap.vcsWkid,i.latestVcsWkid=this.defaultsFromMap.latestVcsWkid),i}set spatialReference(i){const e=!Gm(i,this._get("spatialReference"));this._set("_userSpatialReference",i),e&&(this._set("spatialReference",i),this._spatialReferenceChanged(i))}_spatialReferenceChanged(i){}get stationary(){return!this.animation&&!this.navigating&&!this.resizing}get tools(){var i;return(i=this.toolViewManager)==null?void 0:i.tools}get initialExtent(){var i;return(i=this.defaultsFromMap)==null?void 0:i.extent}get cursor(){const i=this.toolViewManager?this.toolViewManager.cursor:null;return y(i)?i:this._cursor||"default"}set cursor(i){this._cursor=i,this.notifyChange("cursor")}get size(){return[this.width,this.height]}whenLayerView(i){return this.layerViewManager.whenLayerView(i)}getDefaultSpatialReference(){var i;return(i=this.defaultsFromMap)==null?void 0:i.spatialReference}getDefaultHeightModelInfo(){var i;return(this.map&&"heightModelInfo"in this.map?this.map.heightModelInfo:void 0)??((i=this.defaultsFromMap)==null?void 0:i.heightModelInfo)??null}importLayerView(i){throw new J("importLayerView() not implemented")}hasLayerViewModule(i){return!1}async validate(){}invalidate(){this._isValid=!1}getSpatialReferenceSupport(){return{constraints:null}}_validateSpatialReference(i){return y(this.getSpatialReferenceSupport({spatialReference:i}))}when(i,e){return this.isResolved()&&!this.ready&&ee.getLogger(this.declaredClass).warn("#when()","Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use reactiveUtils.whenOnce(() => view.ready).then(...) instead."),super.when(i,e)}forceReadyCycle(){this.ready&&(cs(()=>this.preconditionsReady===!1,()=>this._readyCycleForced=!1,{once:!0}),this._readyCycleForced=!0)}addAndActivateTool(i){this.toolViewManager.tools.add(i),this.activeTool=i}tryFatalErrorRecovery(){this.fatalError=null}};tt.views=new wt,h([p()],tt.prototype,"_userSpatialReference",void 0),h([p()],tt.prototype,"activeTool",null),h([p({readOnly:!0})],tt.prototype,"allLayerViews",void 0),h([p()],tt.prototype,"groundView",void 0),h([p()],tt.prototype,"animation",null),h([p()],tt.prototype,"basemapView",void 0),h([p({readOnly:!0})],tt.prototype,"_defaultsFromMapSettings",null),h([p()],tt.prototype,"defaultsFromMap",null),h([p()],tt.prototype,"fatalError",void 0),h([p({type:pi})],tt.prototype,"extent",null),h([p(SI(mG,"graphics"))],tt.prototype,"graphics",void 0),h([p(SI(ov,"analyses"))],tt.prototype,"analyses",void 0),h([p({readOnly:!0,type:Gx})],tt.prototype,"heightModelInfo",null),h([p({readOnly:!0})],tt.prototype,"interacting",null),h([p({readOnly:!0})],tt.prototype,"navigating",null),h([p({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_currentSpatialReference","defaultsFromMap.ready","typeSpecificPreconditionsReady"]})],tt.prototype,"preconditionsReady",null),h([p({readOnly:!0})],tt.prototype,"typeSpecificPreconditionsReady",void 0),h([p({type:wt,readOnly:!0})],tt.prototype,"layerViews",void 0),h([p({type:LW})],tt.prototype,"magnifier",void 0),h([p({value:null,type:_P})],tt.prototype,"map",null),h([p()],tt.prototype,"padding",void 0),h([p({readOnly:!0})],tt.prototype,"ready",void 0),h([p({type:Zt})],tt.prototype,"spatialReference",null),h([p()],tt.prototype,"spatialReferenceWarningDelay",void 0),h([p()],tt.prototype,"stationary",null),h([p({readOnly:!0})],tt.prototype,"supportsGround",void 0),h([p({type:W0})],tt.prototype,"timeExtent",void 0),h([p()],tt.prototype,"tools",null),h([p()],tt.prototype,"toolViewManager",void 0),h([p({readOnly:!0})],tt.prototype,"type",void 0),h([p({type:Number})],tt.prototype,"scale",void 0),h([p({readOnly:!0})],tt.prototype,"updating",void 0),h([p({readOnly:!0})],tt.prototype,"initialExtentRequired",void 0),h([p({readOnly:!0})],tt.prototype,"initialExtent",null),h([p()],tt.prototype,"cursor",null),h([p({readOnly:!0})],tt.prototype,"input",void 0),h([p({type:VW,nonNullable:!0})],tt.prototype,"navigation",void 0),h([p()],tt.prototype,"layerViewManager",void 0),h([p()],tt.prototype,"analysisViewManager",void 0),h([p()],tt.prototype,"width",void 0),h([p()],tt.prototype,"height",void 0),h([p({readOnly:!0})],tt.prototype,"resizing",void 0),h([p({value:null,readOnly:!0})],tt.prototype,"size",null),h([p({readOnly:!0})],tt.prototype,"suspended",void 0),h([p({readOnly:!0})],tt.prototype,"viewEvents",void 0),h([p({readOnly:!0})],tt.prototype,"persistableViewModels",void 0),h([p()],tt.prototype,"_isValid",void 0),h([p()],tt.prototype,"_readyCycleForced",void 0),h([p()],tt.prototype,"_currentSpatialReference",void 0),tt=XS=h([F("esri.views.View")],tt);const qW=tt;let xp=class extends cre{constructor(e){super(e),this.state="running",this.target=null,this._dfd=null}initialize(){this.addResolvingPromise(new Promise((e,t)=>this._dfd={resolve:e,reject:t}))}get done(){return this.state==="finished"||this.state==="stopped"}stop(){var e;this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","stopped"),(e=this._dfd)==null||e.reject(new J("ViewAnimation stopped")))}finish(){var e;this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","finished"),(e=this._dfd)==null||e.resolve())}update(e,t){t||(t=kx(e)?"waiting-for-target":"running"),this._set("target",e),this._set("state",t)}};h([p({readOnly:!0})],xp.prototype,"done",null),h([p({readOnly:!0,type:String})],xp.prototype,"state",void 0),h([p()],xp.prototype,"target",void 0),xp=h([F("esri.views.ViewAnimation")],xp),function(i){i.State={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"}}(xp||(xp={}));const Md=xp;function xm(){return[1,0,0,1,0,0]}function Upe(i){return[i[0],i[1],i[2],i[3],i[4],i[5]]}function zpe(i,e,t,r,n,s){return[i,e,t,r,n,s]}function Bpe(i,e){return new Float64Array(i,e,6)}Object.freeze(Object.defineProperty({__proto__:null,create:xm,clone:Upe,fromValues:zpe,createView:Bpe},Symbol.toStringTag,{value:"Module"}));const WW=96,XW=39.37,Gpe=180/Math.PI;function QW(i){return i.wkid?i:i.spatialReference||Zt.WGS84}function mN(i,e){return e.type?rt(i,e.x,e.y):wn(i,e)}function ZW(i){return Hm(i)}function Qb(i,e){const t=Math.max(1,e[0]),r=Math.max(1,e[1]);return Math.max(i.width/t,i.height/r)*Kpe(i.spatialReference)}async function W1(i,e,t,r){let n,s;if(!i||Array.isArray(i)&&!i.length)return null;if(wt.isCollection(i)&&(i=i.toArray()),Array.isArray(i)&&i.length&&typeof i[0]=="object"){const o=i.every(u=>"attributes"in u),l=i.some(u=>!u.geometry);let c=i;if(o&&l&&e&&e.allLayerViews){const u=new Map;for(const _ of i){const g=_.layer,w=u.get(g)||[],v=_.attributes[g.objectIdField];v!=null&&w.push(v),u.set(g,w)}const d=[];u.forEach((_,g)=>{const w=e.allLayerViews.find(v=>v.layer.id===g.id);if("queryFeatures"in w){const v=g.createQuery();v.objectIds=_,v.returnGeometry=!0,d.push(w.queryFeatures(v))}});const m=await Promise.all(d),f=[];for(const _ of m)if(_&&_.features&&_.features.length)for(const g of _.features)y(g.geometry)&&f.push(g.geometry);c=f}for(const u of c)r=await W1(u,e,t,r);return r}if(Array.isArray(i)&&i.length===2&&typeof i[0]=="number"&&typeof i[1]=="number")n=new He(i);else if(i instanceof U7)n=i;else if("geometry"in i){if(i.geometry)n=i.geometry;else if(i.layer){const o=i.layer,l=e.allLayerViews.find(c=>c.layer.id===o.id);if("queryFeatures"in l){const c=o.createQuery();c.objectIds=[i.attributes[o.objectIdField]],c.returnGeometry=!0;const u=await l.queryFeatures(c);n=en(u,"features",0,"geometry")}}}if(C(n)||(s=n.type==="point"?new pi({xmin:n.x,ymin:n.y,xmax:n.x,ymax:n.y,spatialReference:n.spatialReference}):n.extent,!s))return null;vw()||gv(s.spatialReference,t)||await PR();const a=Dd(s,t);return a?r=r?r.union(a):a:null}function Hpe(i){if(i&&(!Array.isArray(i)||typeof i[0]!="number")&&(typeof i=="object"||Array.isArray(i)&&typeof i[0]=="object")){if("layer"in i&&i.layer&&i.layer.minScale&&i.layer.maxScale){const e=i.layer;return{min:e.minScale,max:e.maxScale}}if(Array.isArray(i)&&i.length&&i.every(e=>"layer"in e)){let e=0,t=0;for(const r of i){const n=r.layer;n&&n.minScale&&n.maxScale&&(e=n.minScale<e?n.minScale:e,t=n.maxScale>t?n.maxScale:t)}return e&&t?{min:e,max:t}:null}}}function lO(i,e){return Gm(QW(i),e)?i:Dd(i,e)}async function jpe(i,e){if(!i||!e)return new rr({targetGeometry:new He,scale:0,rotation:0});let t=e.spatialReference;const{constraints:r,padding:n,viewpoint:s,size:a}=e,o=[n?a[0]-n.left-n.right:a[0],n?a[1]-n.top-n.bottom:a[1]];let l=null;i instanceof rr?l=i:i.viewpoint?l=i.viewpoint:i.target&&i.target.declaredClass==="esri.Viewpoint"&&(l=i.target);let c=null;l&&l.targetGeometry?c=l.targetGeometry:i instanceof pi?c=i:(i||i&&("center"in i||"extent"in i||"target"in i))&&(c=await W1(i.center,e,t)||await W1(i.extent,e,t)||await W1(i.target,e,t)||await W1(i,e,t)),!c&&s&&s.targetGeometry?c=s.targetGeometry:!c&&e.extent&&(c=e.extent),t||(t=QW(e.spatialReference||e.extent||c)),vw()||Gm(c.spatialReference,t)||gv(c,t)||await PR();const u=lO(c.center?c.center:c,t);let d=null;if(l&&y(l.targetGeometry)&&l.targetGeometry.type==="point")d=l.scale;else if("scale"in i&&i.scale)d=i.scale;else if("zoom"in i&&i.zoom!==-1&&r&&r.effectiveLODs)d=r.zoomToScale(i.zoom);else if(Array.isArray(c)||c.type==="point"||c.type==="extent"&&c.width===0&&c.height===0){const g=lO(e.extent,t);d=y(g)?Qb(g,o):e.extent?Qb(e.extent,o):s.scale}else d=Qb(lO(c.extent,t),o);const m=Hpe(i);m&&(m.min&&m.min>d?d=m.min:m.max&&m.max<d&&(d=m.max));let f=0;l?f=l.rotation:i.hasOwnProperty("rotation")?f=i.rotation:s&&(f=s.rotation);let _=new rr({targetGeometry:u,scale:d,rotation:f});return r&&(_=r.fit(_),r.constrainByGeometry(_),r.rotationEnabled||(_.rotation=f)),_}function Xc(i,e){const t=i.targetGeometry,r=e.targetGeometry;return t.x=r.x,t.y=r.y,t.spatialReference=r.spatialReference,i.scale=e.scale,i.rotation=e.rotation,i}function qpe(i,e,t){return t?rt(i,.5*(e[0]-t.right+t.left),.5*(e[1]-t.bottom+t.top)):qs(i,e,.5)}const Wpe=function(){const i=Te();return function(e,t,r){const n=t.targetGeometry;mN(i,n);const s=.5*Sv(t);return e.xmin=i[0]-s*r[0],e.ymin=i[1]-s*r[1],e.xmax=i[0]+s*r[0],e.ymax=i[1]+s*r[1],e.spatialReference=n.spatialReference,e}}();function Xpe(i,e,t,r,n){return r3(i,e,t.center),i.scale=Qb(t,r),n&&n.constraints&&n.constraints.constrain(i),i}function Qpe(i,e,t,r){return _N(i,e,t,r),uG(i,i)}const YW=function(){const i=Te();return function(e,t,r){return fG(e,Jpe(e,t),qpe(i,t,r))}}(),Zpe=function(){const i=xm(),e=Te();return function(t,r,n,s){const a=Sv(r),o=fN(r);return rt(e,a,a),Jie(i,e),_D(i,i,o),BE(i,i,YW(e,n,s)),BE(i,i,[0,s.top-s.bottom]),rt(t,i[4],i[5])}}();function Sv(i){return i.scale*Ype(i.targetGeometry)}function Ype(i){return y(i)&&V7(i.spatialReference)?1/(ZW(i.spatialReference)*XW*WW):1}function fN(i){return $R(i.rotation)||0}function Kpe(i){return V7(i)?ZW(i)*XW*WW:1}function Jpe(i,e){return qs(i,e,.5)}const gN=function(){const i=Te(),e=Te(),t=Te();return function(r,n,s,a,o,l){return gG(i,n),qs(e,s,.5*l),rt(t,1/a*l,-1/a*l),hG(r,e),o&&_D(r,r,o),cG(r,r,t),BE(r,r,i),r}}(),_N=function(){const i=Te();return function(e,t,r,n){const s=Sv(t),a=fN(t);return mN(i,t.targetGeometry),gN(e,i,r,s,a,n)}}(),eme=function(){const i=Te();return function(e,t,r,n){const s=Sv(t);return mN(i,t.targetGeometry),gN(e,i,r,s,0,n)}}();function tme(i){const e=z7(i);return e?e.valid[1]-e.valid[0]:0}function ime(i,e){return Math.round(tme(i)/e)}const rme=function(){const i=Te(),e=Te(),t=[0,0,0];return function(r,n,s){Rc(i,r,n),X0(i,i),Rc(e,r,s),X0(e,e),pre(t,i,e);let a=Math.acos(Fr(i,e)/(PI(i)*PI(e)))*Gpe;return t[2]<0&&(a=-a),isNaN(a)&&(a=0),a}}(),nme=function(){const i=Te();return function(e,t,r,n){const s=e.targetGeometry;return Xc(e,t),Zpe(i,t,r,n),s.x+=i[0],s.y+=i[1],e}}(),r3=function(i,e,t){Xc(i,e);const r=i.targetGeometry;return r.x=t.x,r.y=t.y,r.spatialReference=t.spatialReference,i},sme=function(){const i=Te();return function(e,t,r,n,s){s||(s="center"),fG(i,r,n),qs(i,i,.5);const a=i[0],o=i[1];switch(s){case"center":rt(i,0,0);break;case"left":rt(i,-a,0);break;case"top":rt(i,0,o);break;case"right":rt(i,a,0);break;case"bottom":rt(i,0,-o);break;case"top-left":rt(i,-a,o);break;case"bottom-left":rt(i,-a,-o);break;case"top-right":rt(i,a,o);break;case"bottom-right":rt(i,a,-o)}return yP(e,t,i),e}}();function I9e(i,e,t){return Xc(i,e),i.rotation+=t,i}function ame(i,e,t){return Xc(i,e),i.rotation=t,i}const ome=function(){const i=Te();return function(e,t,r,n,s){return Xc(e,t),isNaN(r)||r===0||(JW(i,n,t,s),e.scale=t.scale*r,eX(i,i,e,s),yP(e,e,rt(i,i[0]-n[0],n[1]-i[1]))),e}}();function AV(i,e,t){return Xc(i,e),i.scale=t,i}const KW=function(){const i=Te();return function(e,t,r,n,s,a){return Xc(e,t),isNaN(r)||r===0||(JW(i,s,t,a),e.scale=t.scale*r,e.rotation+=n,eX(i,i,e,a),yP(e,e,rt(i,i[0]-s[0],s[1]-i[1]))),e}}(),L9e=function(){const i=Te(),e=Te();return function(t,r,n,s,a,o,l){return YW(e,o,l),yc(i,a,e),s?KW(t,r,n,s,i,o):ome(t,r,n,i,o)}}(),JW=function(){const i=xm();return function(e,t,r,n){return Yu(e,t,Qpe(i,r,n,1))}}(),eX=function(){const i=xm();return function(e,t,r,n){return Yu(e,t,_N(i,r,n,1))}}(),yP=function(){const i=Te(),e=xm();return function(t,r,n){Xc(t,r);const s=Sv(r),a=t.targetGeometry;return Kie(e,fN(r)),cG(e,e,Qt(s,s)),Yu(i,n,e),a.x+=i[0],a.y+=i[1],t}}();let lme=class{constructor(e,t,r,n){const s=e.targetGeometry,a=t.targetGeometry;n?typeof n=="string"&&(n=dre(n)||RI.ease):n=RI.ease,this.easing=n,this.duration=r,this.sCenterX=s.x,this.sCenterY=s.y,this.sScale=e.scale,this.sRotation=e.rotation,this.tCenterX=a.x,this.tCenterY=a.y,this.tScale=t.scale,this.tRotation=t.rotation,this.dCenterX=this.tCenterX-this.sCenterX,this.dCenterY=this.tCenterY-this.sCenterY,this.dScale=this.tScale-this.sScale,this.dRotation=this.tRotation-this.sRotation,this.dRotation>180?this.dRotation-=360:this.dRotation<-180&&(this.dRotation+=360)}applyRatio(e,t){const r=this.easing(t);let n,s,a,o;t>=1?(n=this.tCenterX,s=this.tCenterY,a=this.tRotation,o=this.tScale):(n=this.sCenterX+r*this.dCenterX,s=this.sCenterY+r*this.dCenterY,a=this.sRotation+r*this.dRotation,o=this.sScale+r*this.dScale),e.targetGeometry.x=n,e.targetGeometry.y=s,e.scale=o,e.rotation=a}},$u=class extends pe{constructor(e){super(e),this.duration=200,this.transition=null,this.easing=RI.ease,this.view=null,this.viewpoint=null,this.viewpoint=new rr({targetGeometry:new He,scale:0,rotation:0}),this._updateTask=wd({postRender:this._postRender.bind(this)}),this._updateTask.pause()}destroy(){this._updateTask.remove(),this._updateTask=null}animate(e,t,r){this.stop();const n=this.viewpoint;Xc(n,t),this.transition=new lme(this.viewpoint,e.target,r&&r.duration||this.duration,r&&r.easing||this.easing);const s=()=>{this.animation===e&&this._updateTask&&(e.state==="finished"&&(this.transition.applyRatio(this.viewpoint,1),this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.animation=null,this.updateFunction=null)};return e.when(s,s),this._startTime=performance.now(),this._updateTask.resume(),this.animation=e,e}animateContinous(e,t){this.stop(),this.updateFunction=t,this.viewpoint=e;const r=new Md({target:e.clone()}),n=()=>{this.animation===r&&this._updateTask&&(this.animation=null,this.updateFunction=null)};return r.when(n,n),this._startTime=performance.now(),this._updateTask.resume(),this.animation=r,r}stop(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null)}_postRender(e){const t=this.animation;if(t&&t.state!==Md.State.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,e.deltaTime);else{const r=(performance.now()-this._startTime)/this.transition.duration,n=r>=1;this.transition.applyRatio(this.viewpoint,r),n&&this.animation.finish()}this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())}else this._updateTask.pause()}};h([p()],$u.prototype,"animation",void 0),h([p()],$u.prototype,"duration",void 0),h([p()],$u.prototype,"transition",void 0),h([p()],$u.prototype,"easing",void 0),h([p()],$u.prototype,"view",void 0),h([p()],$u.prototype,"viewpoint",void 0),$u=h([F("esri.views.2d.AnimationManager")],$u);const cme=$u;let hme=class{constructor(e){this.view=e,this._frameTaskHandle=null,this._updateRequested=!1,this.stationary=!0,this.animationInProgress=!1,this.prepare=()=>{this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions},this.update=()=>{this._updateRequested=!1;const{basemapView:t,graphicsView:r,labelManager:n,layerViews:s,state:{id:a}}=this.view;t.baseLayerViews.forEach(this._updateLayerView,this),s.forEach(this._updateLayerView,this),t.referenceLayerViews.forEach(this._updateLayerView,this),y(n)&&(n.lastUpdateId!==a&&(n.viewChange(),n.lastUpdateId=a),n.updateRequested&&n.processUpdate(this._updateParameters)),y(r)&&(r.lastUpdateId!==a&&(r.viewChange(),r.lastUpdateId=a),r.updateRequested&&r.processUpdate(this._updateParameters)),this.view.graphicsTileStore.setViewState(this._updateParameters.state),this.animationInProgress||this._updateRequested||this._frameTaskHandle.pause()}}destroy(){this.stop()}start(){if(this._frameTaskHandle)return;const e=this.view;this.stationary=e.stationary,this._updateParameters={state:e.state,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:e.renderingOptions},this._stationaryHandle=B(()=>e.stationary,t=>{this.stationary=t,this.requestFrame()}),this._frameTaskHandle=wd(this),this.requestUpdate()}stop(){this._frameTaskHandle&&(this._updateRequested=!1,this._stationaryHandle.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0,this.animationInProgress=!1)}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame())}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume()}_updateLayerView(e){const t=this.view.state,r=e.lastUpdateId;r!=null&&(this.stationary||e.moving)||(e.moving=!0,e.moveStart()),r!==t.id&&e.viewChange(),this.stationary&&e.moving&&(e.moving=!1,e.moveEnd()),e.lastUpdateId=t.id,e.updateRequested&&e.processUpdate(this._updateParameters),"layerViews"in e&&e.layerViews.forEach(this._updateLayerView,this)}};function dn(){return Promise.all([j(()=>import("./webglDeps-c0ee13fe.js"),["assets/webglDeps-c0ee13fe.js","assets/FramebufferObject-a3b9c52c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/typedArrayUtil-4d7bb04c.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/context-util-a4ce3a7b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/Evented-a45c8b0f.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/VertexElementDescriptor-2925c6af.js","assets/ShaderCompiler-77d0dcb6.js","assets/programUtils-f035fe8a.js","assets/ProgramTemplate-cc7f8b69.js","assets/preload-helper-3bce6601.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/vec2-528adfe4.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),j(()=>import("./mapViewDeps-f66618ba.js"),["assets/mapViewDeps-f66618ba.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/typedArrayUtil-4d7bb04c.js","assets/promiseUtils-1e54421e.js","assets/reactiveUtils-4dabbb80.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/mat3f32-d3d088e8.js","assets/Rasterizer-dce80cb8.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/_commonjsHelpers-a430e9ea.js","assets/imageutils-c0676a73.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/cimAnalyzer-38842966.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/arcadeOnDemand-281a01eb.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-193543b5.js","assets/jsonUtils-229211af.js","assets/enums-2658a65c.js","assets/alignmentUtils-ae955d28.js","assets/mat2d-2bbb5feb.js","assets/vec2-528adfe4.js","assets/vec2f32-461e65a9.js","assets/number-954e4ab6.js","assets/Rect-ea14f53a.js","assets/callExpressionWithFeature-55effb7b.js","assets/quantizationUtils-4dd81f85.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-9ad35d39.js","assets/rasterizingUtils-ec11e94c.js","assets/utils-317368cb.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/Evented-a45c8b0f.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/enums-4ca4641f.js","assets/MaterialKey-0093a242.js","assets/Utils-69cc114d.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/BufferPool-b74ae6cb.js","assets/WGLContainer-8a3733a0.js","assets/WGLBrushVTLSymbol-d778c554.js","assets/FramebufferObject-a3b9c52c.js","assets/StyleDefinition-ff072275.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/pixelUtils-d9cd2e49.js","assets/ShaderCompiler-77d0dcb6.js","assets/ProgramTemplate-cc7f8b69.js","assets/heatmapTextureUtils-2627384f.js","assets/earcut-58237617.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/VTLMaterialManager-2c63b5e3.js","assets/enums-0fc02184.js","assets/programUtils-f035fe8a.js","assets/MaterialPrograms-b885dd99.js","assets/pbf-0e99a620.js","assets/Matcher-f2620e9f.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/Queue-b7d3cd48.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/enumeration-3a03bd31.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Clonable-545593ce.js","assets/visualVariablesUtils-0d4b5279.js","assets/visualVariablesUtils-ecd70012.js","assets/tileUtils-55e656c2.js","assets/TileClipper-4637f47d.js","assets/assets-8d3e737a.js","assets/Geometry-daada628.js","assets/defaultsJSON-59981e75.js","assets/LRUCache-64ec42ee.js","assets/MemCache-18a255ed.js","assets/ExpandedCIM-b7ed8ce5.js","assets/devEnvironmentUtils-5002a058.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/locale-30120714.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/persistableUrlUtils-5f719c3b.js","assets/styleUtils-22b14a8b.js","assets/CircularArray-f4b6cd92.js","assets/MeshComponent-a43522cc.js","assets/deduplicate-03981d62.js","assets/HandleOwner-9b396af1.js","assets/FeatureSetReader-7e79a15e.js","assets/centroid-5c988df3.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/sizeVariableUtils-d4870b0d.js","assets/BaseGraphicContainer-76f5ab54.js","assets/projectionSupport-aa5eaa0d.js","assets/projection-290b739f.js","assets/SimpleObservable-23231131.js","assets/zscale-89472cba.js","assets/json-48e3ea08.js","assets/labelingInfo-607e66b8.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/fieldUtils-7f54c4b1.js","assets/Symbol-f93ed9fd.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/Collection-910b6f71.js","assets/collectionUtils-803d9ba8.js","assets/labelUtils-3108e8d7.js","assets/jsonUtils-0ff4ff96.js","assets/FeatureContainer-934cc4cc.js","assets/TileContainer-21007653.js","assets/capabilities-302cf20d.js","assets/schemaUtils-9c08f5e8.js","assets/LayerFloorInfo-54b916a2.js","assets/diffUtils-68b89c71.js","assets/createSymbolSchema-36503ad8.js","assets/rendererUtils-0bcb63a1.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/PopupTemplate-40f3c9aa.js","assets/number-27cf8195.js","assets/Identifiable-bfe1ff30.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/colorRamps-9dac42c1.js","assets/Graphic-f0e54e86.js","assets/compilerUtils-18d58939.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/deprecate-035b199e.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/util-4239daf3.js","assets/ComputedAttributeStorage-2b4316ba.js","assets/FieldsIndex-f104cc5f.js","assets/normalizeUtils-27e29a72.js","assets/GraphicsView-d3b9d029.js","assets/vec3f32-c9aa289f.js","assets/GraphicContainer-ce27fa6a.js","assets/asyncUtils-437defc4.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/RelationshipQuery-0dda77ad.js","assets/utils-6786b611.js","assets/ItemCache-fd3aceaf.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/dehydratedFeatures-0557137d.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/SnappingCandidate-970faec6.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])])}const e1=()=>dn().then(()=>j(()=>import("./TileLayerView2D-1b9544ba.js"),["assets/TileLayerView2D-1b9544ba.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/reactiveUtils-4dabbb80.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/imageUtils-5e882683.js","assets/BitmapTileContainer-d91c0937.js","assets/aaBoundingRect-193543b5.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/mat3f32-d3d088e8.js","assets/Bitmap-479ee434.js","assets/mat3-3fc68e72.js","assets/vec2f32-461e65a9.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/Evented-a45c8b0f.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/WGLContainer-8a3733a0.js","assets/WGLBrushVTLSymbol-d778c554.js","assets/enums-2658a65c.js","assets/enums-4ca4641f.js","assets/number-954e4ab6.js","assets/FramebufferObject-a3b9c52c.js","assets/StyleDefinition-ff072275.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/pixelUtils-d9cd2e49.js","assets/Utils-69cc114d.js","assets/ShaderCompiler-77d0dcb6.js","assets/ProgramTemplate-cc7f8b69.js","assets/MaterialKey-0093a242.js","assets/alignmentUtils-ae955d28.js","assets/utils-317368cb.js","assets/parser-498c8be0.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/Color-fb64d77d.js","assets/heatmapTextureUtils-2627384f.js","assets/earcut-58237617.js","assets/vec2-528adfe4.js","assets/featureConversionUtils-03a03f40.js","assets/jsonUtils-229211af.js","assets/Polyline-ff2d7c6b.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/TileContainer-21007653.js","assets/LayerView2D-2775dd38.js","assets/Collection-910b6f71.js","assets/SimpleObservable-23231131.js","assets/collectionUtils-803d9ba8.js","assets/geometry-b7901087.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/TileStore-00ac650f.js","assets/Queue-b7d3cd48.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/enumeration-3a03bd31.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Clonable-545593ce.js","assets/TileStrategy-a90cd1af.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/Identifiable-bfe1ff30.js","assets/Promise-376ab9f6.js","assets/RefreshableLayerView-7c1c2c75.js","assets/TileLayerView-80cc70bb.js","assets/clickToleranceUtils-a273d161.js","assets/drapedUtils-f6534f49.js","assets/unitUtils-45d1147c.js","assets/preload-helper-3bce6601.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/capabilities-302cf20d.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])),t1=()=>dn().then(()=>j(()=>import("./FeatureLayerView2D-9ae7c9fa.js"),["assets/FeatureLayerView2D-9ae7c9fa.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/reactiveUtils-4dabbb80.js","assets/utils-317368cb.js","assets/mat3f32-d3d088e8.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/enums-4ca4641f.js","assets/MaterialKey-0093a242.js","assets/alignmentUtils-ae955d28.js","assets/Utils-69cc114d.js","assets/number-954e4ab6.js","assets/enums-2658a65c.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/TimeExtent-23e282b9.js","assets/Query-b96bcde0.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/MemCache-18a255ed.js","assets/deprecate-035b199e.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/FeatureSet-d32b0eb8.js","assets/LayerView2D-2775dd38.js","assets/schemaUtils-9c08f5e8.js","assets/LayerFloorInfo-54b916a2.js","assets/visualVariablesUtils-ecd70012.js","assets/createSymbolSchema-36503ad8.js","assets/cimAnalyzer-38842966.js","assets/BidiEngine-836b7ef6.js","assets/mat2d-2bbb5feb.js","assets/vec2-528adfe4.js","assets/vec2f32-461e65a9.js","assets/Rect-ea14f53a.js","assets/callExpressionWithFeature-55effb7b.js","assets/quantizationUtils-4dd81f85.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-9ad35d39.js","assets/ExpandedCIM-b7ed8ce5.js","assets/rendererUtils-0bcb63a1.js","assets/capabilities-302cf20d.js","assets/util-4239daf3.js","assets/TileStore-00ac650f.js","assets/Queue-b7d3cd48.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/FeatureLayerView-e9178bab.js","assets/floorFilterUtils-080a7cd2.js","assets/popupUtils-af06d391.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/RefreshableLayerView-7c1c2c75.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/projection-290b739f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/RelationshipQuery-0dda77ad.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/ItemCache-fd3aceaf.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/FramebufferObject-a3b9c52c.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/dehydratedFeatures-0557137d.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])),OV={"base-dynamic":()=>dn().then(()=>j(()=>import("./BaseDynamicLayerView2D-3da0a30d.js"),["assets/BaseDynamicLayerView2D-3da0a30d.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/BitmapContainer-5fb5f7d8.js","assets/WGLContainer-8a3733a0.js","assets/mat3f32-d3d088e8.js","assets/WGLBrushVTLSymbol-d778c554.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/Evented-a45c8b0f.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/enums-2658a65c.js","assets/enums-4ca4641f.js","assets/number-954e4ab6.js","assets/FramebufferObject-a3b9c52c.js","assets/StyleDefinition-ff072275.js","assets/vec2f32-461e65a9.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/pixelUtils-d9cd2e49.js","assets/Utils-69cc114d.js","assets/ShaderCompiler-77d0dcb6.js","assets/ProgramTemplate-cc7f8b69.js","assets/MaterialKey-0093a242.js","assets/alignmentUtils-ae955d28.js","assets/utils-317368cb.js","assets/parser-498c8be0.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/Color-fb64d77d.js","assets/heatmapTextureUtils-2627384f.js","assets/reactiveUtils-4dabbb80.js","assets/earcut-58237617.js","assets/vec2-528adfe4.js","assets/featureConversionUtils-03a03f40.js","assets/jsonUtils-229211af.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView2D-2775dd38.js","assets/Collection-910b6f71.js","assets/SimpleObservable-23231131.js","assets/collectionUtils-803d9ba8.js","assets/geometry-b7901087.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/ExportStrategy-913accc5.js","assets/aaBoundingRect-193543b5.js","assets/TileInfo-b0eb8c90.js","assets/unitUtils-45d1147c.js","assets/Bitmap-479ee434.js","assets/TileStore-00ac650f.js","assets/Queue-b7d3cd48.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/enumeration-3a03bd31.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Clonable-545593ce.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/Identifiable-bfe1ff30.js","assets/Promise-376ab9f6.js","assets/RefreshableLayerView-7c1c2c75.js","assets/preload-helper-3bce6601.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/zscale-89472cba.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/capabilities-302cf20d.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])),"base-tile":e1,"bing-maps":e1,csv:t1,"geo-rss":()=>dn().then(()=>j(()=>import("./GeoRSSLayerView2D-0421031a.js"),["assets/GeoRSSLayerView2D-0421031a.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/geometry-b7901087.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/reactiveUtils-4dabbb80.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/LegendOptions-010d0873.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/Graphic-f0e54e86.js","assets/jsonUtils-229211af.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/MemCache-18a255ed.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/LayerView2D-2775dd38.js","assets/utils-317368cb.js","assets/mat3f32-d3d088e8.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/enums-4ca4641f.js","assets/MaterialKey-0093a242.js","assets/alignmentUtils-ae955d28.js","assets/Utils-69cc114d.js","assets/number-954e4ab6.js","assets/enums-2658a65c.js","assets/GraphicContainer-ce27fa6a.js","assets/BaseGraphicContainer-76f5ab54.js","assets/cimAnalyzer-38842966.js","assets/BidiEngine-836b7ef6.js","assets/mat2d-2bbb5feb.js","assets/vec2-528adfe4.js","assets/vec2f32-461e65a9.js","assets/Rect-ea14f53a.js","assets/callExpressionWithFeature-55effb7b.js","assets/quantizationUtils-4dd81f85.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-9ad35d39.js","assets/HandleOwner-9b396af1.js","assets/projectionSupport-aa5eaa0d.js","assets/projection-290b739f.js","assets/assets-8d3e737a.js","assets/zscale-89472cba.js","assets/json-48e3ea08.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/FramebufferObject-a3b9c52c.js","assets/FeatureContainer-934cc4cc.js","assets/Queue-b7d3cd48.js","assets/visualVariablesUtils-0d4b5279.js","assets/visualVariablesUtils-ecd70012.js","assets/TileContainer-21007653.js","assets/WGLContainer-8a3733a0.js","assets/WGLBrushVTLSymbol-d778c554.js","assets/StyleDefinition-ff072275.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/pixelUtils-d9cd2e49.js","assets/ShaderCompiler-77d0dcb6.js","assets/ProgramTemplate-cc7f8b69.js","assets/heatmapTextureUtils-2627384f.js","assets/earcut-58237617.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/capabilities-302cf20d.js","assets/Matcher-f2620e9f.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/tileUtils-55e656c2.js","assets/TileClipper-4637f47d.js","assets/Geometry-daada628.js","assets/ExpandedCIM-b7ed8ce5.js","assets/devEnvironmentUtils-5002a058.js","assets/schemaUtils-9c08f5e8.js","assets/LayerFloorInfo-54b916a2.js","assets/createSymbolSchema-36503ad8.js","assets/rendererUtils-0bcb63a1.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/util-4239daf3.js","assets/ComputedAttributeStorage-2b4316ba.js","assets/FeatureSetReader-7e79a15e.js","assets/centroid-5c988df3.js","assets/FieldsIndex-f104cc5f.js","assets/normalizeUtils-27e29a72.js","assets/GraphicsView-d3b9d029.js","assets/vec3f32-c9aa289f.js","assets/LayerView-bd9a2316.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/RelationshipQuery-0dda77ad.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/ItemCache-fd3aceaf.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/dehydratedFeatures-0557137d.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])),feature:t1,geojson:t1,graphics:()=>dn().then(()=>j(()=>import("./GraphicsLayerView2D-20bbb8e2.js"),["assets/GraphicsLayerView2D-20bbb8e2.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/LayerView2D-2775dd38.js","assets/reactiveUtils-4dabbb80.js","assets/utils-317368cb.js","assets/mat3f32-d3d088e8.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/enums-4ca4641f.js","assets/MaterialKey-0093a242.js","assets/alignmentUtils-ae955d28.js","assets/Utils-69cc114d.js","assets/number-954e4ab6.js","assets/enums-2658a65c.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/GraphicContainer-ce27fa6a.js","assets/BaseGraphicContainer-76f5ab54.js","assets/cimAnalyzer-38842966.js","assets/BidiEngine-836b7ef6.js","assets/mat2d-2bbb5feb.js","assets/vec2-528adfe4.js","assets/vec2f32-461e65a9.js","assets/Rect-ea14f53a.js","assets/callExpressionWithFeature-55effb7b.js","assets/quantizationUtils-4dd81f85.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-9ad35d39.js","assets/HandleOwner-9b396af1.js","assets/projectionSupport-aa5eaa0d.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/assets-8d3e737a.js","assets/zscale-89472cba.js","assets/json-48e3ea08.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/jsonUtils-0ff4ff96.js","assets/FramebufferObject-a3b9c52c.js","assets/FeatureContainer-934cc4cc.js","assets/Queue-b7d3cd48.js","assets/visualVariablesUtils-0d4b5279.js","assets/visualVariablesUtils-ecd70012.js","assets/TileContainer-21007653.js","assets/WGLContainer-8a3733a0.js","assets/WGLBrushVTLSymbol-d778c554.js","assets/StyleDefinition-ff072275.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/pixelUtils-d9cd2e49.js","assets/ShaderCompiler-77d0dcb6.js","assets/ProgramTemplate-cc7f8b69.js","assets/heatmapTextureUtils-2627384f.js","assets/earcut-58237617.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/lengthUtils-fa751420.js","assets/capabilities-302cf20d.js","assets/Matcher-f2620e9f.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/tileUtils-55e656c2.js","assets/TileClipper-4637f47d.js","assets/Geometry-daada628.js","assets/LRUCache-64ec42ee.js","assets/MemCache-18a255ed.js","assets/ExpandedCIM-b7ed8ce5.js","assets/devEnvironmentUtils-5002a058.js","assets/styleUtils-22b14a8b.js","assets/schemaUtils-9c08f5e8.js","assets/LayerFloorInfo-54b916a2.js","assets/diffUtils-68b89c71.js","assets/createSymbolSchema-36503ad8.js","assets/rendererUtils-0bcb63a1.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/deprecate-035b199e.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/util-4239daf3.js","assets/ComputedAttributeStorage-2b4316ba.js","assets/FeatureSetReader-7e79a15e.js","assets/centroid-5c988df3.js","assets/FieldsIndex-f104cc5f.js","assets/normalizeUtils-27e29a72.js","assets/GraphicsView-d3b9d029.js","assets/vec3f32-c9aa289f.js","assets/LayerView-bd9a2316.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/RelationshipQuery-0dda77ad.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/ItemCache-fd3aceaf.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/dehydratedFeatures-0557137d.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])),group:()=>dn().then(()=>j(()=>import("./GroupLayerView2D-68b9baf4.js"),["assets/GroupLayerView2D-68b9baf4.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/GroupContainer-9db6cc15.js","assets/WGLContainer-8a3733a0.js","assets/mat3f32-d3d088e8.js","assets/WGLBrushVTLSymbol-d778c554.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/Evented-a45c8b0f.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/enums-2658a65c.js","assets/enums-4ca4641f.js","assets/number-954e4ab6.js","assets/FramebufferObject-a3b9c52c.js","assets/StyleDefinition-ff072275.js","assets/vec2f32-461e65a9.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/pixelUtils-d9cd2e49.js","assets/Utils-69cc114d.js","assets/ShaderCompiler-77d0dcb6.js","assets/ProgramTemplate-cc7f8b69.js","assets/MaterialKey-0093a242.js","assets/alignmentUtils-ae955d28.js","assets/utils-317368cb.js","assets/parser-498c8be0.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/Color-fb64d77d.js","assets/heatmapTextureUtils-2627384f.js","assets/reactiveUtils-4dabbb80.js","assets/earcut-58237617.js","assets/vec2-528adfe4.js","assets/featureConversionUtils-03a03f40.js","assets/jsonUtils-229211af.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView2D-2775dd38.js","assets/Collection-910b6f71.js","assets/SimpleObservable-23231131.js","assets/collectionUtils-803d9ba8.js","assets/geometry-b7901087.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/GroupLayerView-6f5d18e8.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/Identifiable-bfe1ff30.js","assets/Promise-376ab9f6.js","assets/preload-helper-3bce6601.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])),imagery:()=>dn().then(()=>j(()=>import("./ImageryLayerView2D-644e9010.js"),["assets/ImageryLayerView2D-644e9010.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/reactiveUtils-4dabbb80.js","assets/GraphicsCollection-c37a9ffd.js","assets/HandleOwner-9b396af1.js","assets/RasterVFDisplayObject-0676fcf6.js","assets/FramebufferObject-a3b9c52c.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/VertexElementDescriptor-2925c6af.js","assets/dataUtils-a534a9c7.js","assets/pixelUtils-d9cd2e49.js","assets/WGLContainer-8a3733a0.js","assets/mat3f32-d3d088e8.js","assets/WGLBrushVTLSymbol-d778c554.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/enums-2658a65c.js","assets/enums-4ca4641f.js","assets/number-954e4ab6.js","assets/StyleDefinition-ff072275.js","assets/vec2f32-461e65a9.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/Utils-69cc114d.js","assets/ShaderCompiler-77d0dcb6.js","assets/ProgramTemplate-cc7f8b69.js","assets/MaterialKey-0093a242.js","assets/alignmentUtils-ae955d28.js","assets/utils-317368cb.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/heatmapTextureUtils-2627384f.js","assets/earcut-58237617.js","assets/vec2-528adfe4.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView2D-2775dd38.js","assets/BaseGraphicContainer-76f5ab54.js","assets/cimAnalyzer-38842966.js","assets/BidiEngine-836b7ef6.js","assets/mat2d-2bbb5feb.js","assets/Rect-ea14f53a.js","assets/callExpressionWithFeature-55effb7b.js","assets/quantizationUtils-4dd81f85.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-9ad35d39.js","assets/projectionSupport-aa5eaa0d.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/assets-8d3e737a.js","assets/zscale-89472cba.js","assets/json-48e3ea08.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/jsonUtils-0ff4ff96.js","assets/FeatureContainer-934cc4cc.js","assets/Queue-b7d3cd48.js","assets/visualVariablesUtils-0d4b5279.js","assets/visualVariablesUtils-ecd70012.js","assets/TileContainer-21007653.js","assets/lengthUtils-fa751420.js","assets/capabilities-302cf20d.js","assets/Matcher-f2620e9f.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/tileUtils-55e656c2.js","assets/TileClipper-4637f47d.js","assets/Geometry-daada628.js","assets/LRUCache-64ec42ee.js","assets/MemCache-18a255ed.js","assets/ExpandedCIM-b7ed8ce5.js","assets/devEnvironmentUtils-5002a058.js","assets/styleUtils-22b14a8b.js","assets/schemaUtils-9c08f5e8.js","assets/LayerFloorInfo-54b916a2.js","assets/diffUtils-68b89c71.js","assets/createSymbolSchema-36503ad8.js","assets/rendererUtils-0bcb63a1.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/deprecate-035b199e.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/util-4239daf3.js","assets/ComputedAttributeStorage-2b4316ba.js","assets/FeatureSetReader-7e79a15e.js","assets/centroid-5c988df3.js","assets/FieldsIndex-f104cc5f.js","assets/normalizeUtils-27e29a72.js","assets/GraphicsView-d3b9d029.js","assets/vec3f32-c9aa289f.js","assets/HighlightGraphicContainer-92f548bb.js","assets/BitmapContainer-5fb5f7d8.js","assets/Bitmap-479ee434.js","assets/ExportStrategy-913accc5.js","assets/TileInfo-b0eb8c90.js","assets/rasterProjectionHelper-a7452876.js","assets/ImageryLayerView-31e9d56f.js","assets/popupUtils-af06d391.js","assets/LayerView-bd9a2316.js","assets/RefreshableLayerView-7c1c2c75.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/RelationshipQuery-0dda77ad.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/ItemCache-fd3aceaf.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/dehydratedFeatures-0557137d.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])),"imagery-tile":()=>dn().then(()=>j(()=>import("./ImageryTileLayerView2D-521cfa35.js"),["assets/ImageryTileLayerView2D-521cfa35.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/reactiveUtils-4dabbb80.js","assets/multidimensionalUtils-98b0907f.js","assets/RasterVFDisplayObject-0676fcf6.js","assets/HandleOwner-9b396af1.js","assets/FramebufferObject-a3b9c52c.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/VertexElementDescriptor-2925c6af.js","assets/dataUtils-a534a9c7.js","assets/pixelUtils-d9cd2e49.js","assets/WGLContainer-8a3733a0.js","assets/mat3f32-d3d088e8.js","assets/WGLBrushVTLSymbol-d778c554.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/enums-2658a65c.js","assets/enums-4ca4641f.js","assets/number-954e4ab6.js","assets/StyleDefinition-ff072275.js","assets/vec2f32-461e65a9.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/Utils-69cc114d.js","assets/ShaderCompiler-77d0dcb6.js","assets/ProgramTemplate-cc7f8b69.js","assets/MaterialKey-0093a242.js","assets/alignmentUtils-ae955d28.js","assets/utils-317368cb.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/heatmapTextureUtils-2627384f.js","assets/earcut-58237617.js","assets/vec2-528adfe4.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView2D-2775dd38.js","assets/TileContainer-21007653.js","assets/TileInfo-b0eb8c90.js","assets/unitUtils-45d1147c.js","assets/RawBlockCache-f270ede9.js","assets/rasterProjectionHelper-a7452876.js","assets/projection-290b739f.js","assets/assets-8d3e737a.js","assets/zscale-89472cba.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/Queue-b7d3cd48.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/capabilities-302cf20d.js","assets/util-4239daf3.js","assets/ImageryTileLayerView-f97d6c38.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/lengthUtils-fa751420.js","assets/popupUtils-af06d391.js","assets/LayerView-bd9a2316.js","assets/RefreshableLayerView-7c1c2c75.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])),kml:()=>dn().then(()=>j(()=>import("./KMLLayerView2D-59574735.js"),["assets/KMLLayerView2D-59574735.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/reactiveUtils-4dabbb80.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/projection-290b739f.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/unitUtils-45d1147c.js","assets/jsonMap-7b8332c9.js","assets/mat4-44a0988f.js","assets/Polyline-ff2d7c6b.js","assets/assets-8d3e737a.js","assets/aaBoundingRect-193543b5.js","assets/zscale-89472cba.js","assets/kmlUtils-83fc7c0c.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/geometry-b7901087.js","assets/typeUtils-35750739.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/aaBoundingBox-657a9b82.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/LegendOptions-010d0873.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/Graphic-f0e54e86.js","assets/jsonUtils-229211af.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/MemCache-18a255ed.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/normalizeUtils-27e29a72.js","assets/GraphicsCollection-c37a9ffd.js","assets/HandleOwner-9b396af1.js","assets/Bitmap-479ee434.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/BitmapContainer-5fb5f7d8.js","assets/WGLContainer-8a3733a0.js","assets/WGLBrushVTLSymbol-d778c554.js","assets/enums-2658a65c.js","assets/enums-4ca4641f.js","assets/number-954e4ab6.js","assets/FramebufferObject-a3b9c52c.js","assets/StyleDefinition-ff072275.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/pixelUtils-d9cd2e49.js","assets/Utils-69cc114d.js","assets/ShaderCompiler-77d0dcb6.js","assets/ProgramTemplate-cc7f8b69.js","assets/MaterialKey-0093a242.js","assets/alignmentUtils-ae955d28.js","assets/utils-317368cb.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/heatmapTextureUtils-2627384f.js","assets/earcut-58237617.js","assets/vec2-528adfe4.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView2D-2775dd38.js","assets/GraphicContainer-ce27fa6a.js","assets/BaseGraphicContainer-76f5ab54.js","assets/cimAnalyzer-38842966.js","assets/BidiEngine-836b7ef6.js","assets/mat2d-2bbb5feb.js","assets/Rect-ea14f53a.js","assets/callExpressionWithFeature-55effb7b.js","assets/quantizationUtils-4dd81f85.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-9ad35d39.js","assets/projectionSupport-aa5eaa0d.js","assets/json-48e3ea08.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/FeatureContainer-934cc4cc.js","assets/Queue-b7d3cd48.js","assets/visualVariablesUtils-0d4b5279.js","assets/visualVariablesUtils-ecd70012.js","assets/TileContainer-21007653.js","assets/capabilities-302cf20d.js","assets/Matcher-f2620e9f.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/tileUtils-55e656c2.js","assets/TileClipper-4637f47d.js","assets/Geometry-daada628.js","assets/ExpandedCIM-b7ed8ce5.js","assets/devEnvironmentUtils-5002a058.js","assets/schemaUtils-9c08f5e8.js","assets/LayerFloorInfo-54b916a2.js","assets/createSymbolSchema-36503ad8.js","assets/rendererUtils-0bcb63a1.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/util-4239daf3.js","assets/ComputedAttributeStorage-2b4316ba.js","assets/FeatureSetReader-7e79a15e.js","assets/centroid-5c988df3.js","assets/FieldsIndex-f104cc5f.js","assets/GraphicsView-d3b9d029.js","assets/vec3f32-c9aa289f.js","assets/LayerView-bd9a2316.js","assets/rasterProjectionHelper-a7452876.js","assets/MaterialPrograms-b885dd99.js","assets/programUtils-f035fe8a.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/RelationshipQuery-0dda77ad.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/ItemCache-fd3aceaf.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/dehydratedFeatures-0557137d.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])),"map-image":()=>dn().then(()=>j(()=>import("./MapImageLayerView2D-dbe90322.js"),["assets/MapImageLayerView2D-dbe90322.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/reactiveUtils-4dabbb80.js","assets/BitmapContainer-5fb5f7d8.js","assets/WGLContainer-8a3733a0.js","assets/mat3f32-d3d088e8.js","assets/WGLBrushVTLSymbol-d778c554.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/enums-2658a65c.js","assets/enums-4ca4641f.js","assets/number-954e4ab6.js","assets/FramebufferObject-a3b9c52c.js","assets/StyleDefinition-ff072275.js","assets/vec2f32-461e65a9.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/pixelUtils-d9cd2e49.js","assets/Utils-69cc114d.js","assets/ShaderCompiler-77d0dcb6.js","assets/ProgramTemplate-cc7f8b69.js","assets/MaterialKey-0093a242.js","assets/alignmentUtils-ae955d28.js","assets/utils-317368cb.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/heatmapTextureUtils-2627384f.js","assets/earcut-58237617.js","assets/vec2-528adfe4.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView2D-2775dd38.js","assets/BaseGraphicContainer-76f5ab54.js","assets/cimAnalyzer-38842966.js","assets/BidiEngine-836b7ef6.js","assets/mat2d-2bbb5feb.js","assets/Rect-ea14f53a.js","assets/callExpressionWithFeature-55effb7b.js","assets/quantizationUtils-4dd81f85.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-9ad35d39.js","assets/HandleOwner-9b396af1.js","assets/projectionSupport-aa5eaa0d.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/assets-8d3e737a.js","assets/zscale-89472cba.js","assets/json-48e3ea08.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/jsonUtils-0ff4ff96.js","assets/FeatureContainer-934cc4cc.js","assets/Queue-b7d3cd48.js","assets/visualVariablesUtils-0d4b5279.js","assets/visualVariablesUtils-ecd70012.js","assets/TileContainer-21007653.js","assets/lengthUtils-fa751420.js","assets/capabilities-302cf20d.js","assets/Matcher-f2620e9f.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/tileUtils-55e656c2.js","assets/TileClipper-4637f47d.js","assets/Geometry-daada628.js","assets/LRUCache-64ec42ee.js","assets/MemCache-18a255ed.js","assets/ExpandedCIM-b7ed8ce5.js","assets/devEnvironmentUtils-5002a058.js","assets/styleUtils-22b14a8b.js","assets/schemaUtils-9c08f5e8.js","assets/LayerFloorInfo-54b916a2.js","assets/diffUtils-68b89c71.js","assets/createSymbolSchema-36503ad8.js","assets/rendererUtils-0bcb63a1.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/deprecate-035b199e.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/util-4239daf3.js","assets/ComputedAttributeStorage-2b4316ba.js","assets/FeatureSetReader-7e79a15e.js","assets/centroid-5c988df3.js","assets/FieldsIndex-f104cc5f.js","assets/normalizeUtils-27e29a72.js","assets/GraphicsView-d3b9d029.js","assets/vec3f32-c9aa289f.js","assets/HighlightGraphicContainer-92f548bb.js","assets/ExportStrategy-913accc5.js","assets/TileInfo-b0eb8c90.js","assets/Bitmap-479ee434.js","assets/LayerView-bd9a2316.js","assets/MapImageLayerView-7b24456f.js","assets/scaleUtils-93ad8d0c.js","assets/ExportImageParameters-4b588db2.js","assets/floorFilterUtils-080a7cd2.js","assets/sublayerUtils-96c8a85b.js","assets/clickToleranceUtils-a273d161.js","assets/GraphicsCollection-c37a9ffd.js","assets/popupUtils-af06d391.js","assets/RefreshableLayerView-7c1c2c75.js","assets/drapedUtils-f6534f49.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/RelationshipQuery-0dda77ad.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/ItemCache-fd3aceaf.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/dehydratedFeatures-0557137d.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])),"map-notes":()=>dn().then(()=>j(()=>import("./MapNotesLayerView2D-d48aa700.js"),["assets/MapNotesLayerView2D-d48aa700.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/reactiveUtils-4dabbb80.js","assets/utils-317368cb.js","assets/mat3f32-d3d088e8.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/enums-4ca4641f.js","assets/MaterialKey-0093a242.js","assets/alignmentUtils-ae955d28.js","assets/Utils-69cc114d.js","assets/number-954e4ab6.js","assets/enums-2658a65c.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/GroupContainer-9db6cc15.js","assets/WGLContainer-8a3733a0.js","assets/WGLBrushVTLSymbol-d778c554.js","assets/FramebufferObject-a3b9c52c.js","assets/StyleDefinition-ff072275.js","assets/vec2f32-461e65a9.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/pixelUtils-d9cd2e49.js","assets/ShaderCompiler-77d0dcb6.js","assets/ProgramTemplate-cc7f8b69.js","assets/heatmapTextureUtils-2627384f.js","assets/earcut-58237617.js","assets/vec2-528adfe4.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView2D-2775dd38.js","assets/GraphicContainer-ce27fa6a.js","assets/BaseGraphicContainer-76f5ab54.js","assets/cimAnalyzer-38842966.js","assets/BidiEngine-836b7ef6.js","assets/mat2d-2bbb5feb.js","assets/Rect-ea14f53a.js","assets/callExpressionWithFeature-55effb7b.js","assets/quantizationUtils-4dd81f85.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-9ad35d39.js","assets/HandleOwner-9b396af1.js","assets/projectionSupport-aa5eaa0d.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/assets-8d3e737a.js","assets/zscale-89472cba.js","assets/json-48e3ea08.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/jsonUtils-0ff4ff96.js","assets/FeatureContainer-934cc4cc.js","assets/Queue-b7d3cd48.js","assets/visualVariablesUtils-0d4b5279.js","assets/visualVariablesUtils-ecd70012.js","assets/TileContainer-21007653.js","assets/lengthUtils-fa751420.js","assets/capabilities-302cf20d.js","assets/Matcher-f2620e9f.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/tileUtils-55e656c2.js","assets/TileClipper-4637f47d.js","assets/Geometry-daada628.js","assets/LRUCache-64ec42ee.js","assets/MemCache-18a255ed.js","assets/ExpandedCIM-b7ed8ce5.js","assets/devEnvironmentUtils-5002a058.js","assets/styleUtils-22b14a8b.js","assets/schemaUtils-9c08f5e8.js","assets/LayerFloorInfo-54b916a2.js","assets/diffUtils-68b89c71.js","assets/createSymbolSchema-36503ad8.js","assets/rendererUtils-0bcb63a1.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/deprecate-035b199e.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/util-4239daf3.js","assets/ComputedAttributeStorage-2b4316ba.js","assets/FeatureSetReader-7e79a15e.js","assets/centroid-5c988df3.js","assets/FieldsIndex-f104cc5f.js","assets/normalizeUtils-27e29a72.js","assets/GraphicsView-d3b9d029.js","assets/vec3f32-c9aa289f.js","assets/LayerView-bd9a2316.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/RelationshipQuery-0dda77ad.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/ItemCache-fd3aceaf.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/dehydratedFeatures-0557137d.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])),media:()=>dn().then(()=>j(()=>import("./MediaLayerView2D-33755e98.js"),["assets/MediaLayerView2D-33755e98.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/reactiveUtils-4dabbb80.js","assets/aaBoundingRect-193543b5.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/TileStrategy-a90cd1af.js","assets/vec2-528adfe4.js","assets/TileStore-00ac650f.js","assets/Queue-b7d3cd48.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/enumeration-3a03bd31.js","assets/jsonUtils-229211af.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Clonable-545593ce.js","assets/mat3f64-c6305894.js","assets/vec2f64-30dc1443.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/screenUtils-410d12c0.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/vec3f32-c9aa289f.js","assets/normalizeUtils-27e29a72.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/WGLContainer-8a3733a0.js","assets/WGLBrushVTLSymbol-d778c554.js","assets/enums-2658a65c.js","assets/enums-4ca4641f.js","assets/number-954e4ab6.js","assets/StyleDefinition-ff072275.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/pixelUtils-d9cd2e49.js","assets/Utils-69cc114d.js","assets/ShaderCompiler-77d0dcb6.js","assets/ProgramTemplate-cc7f8b69.js","assets/MaterialKey-0093a242.js","assets/alignmentUtils-ae955d28.js","assets/utils-317368cb.js","assets/parser-498c8be0.js","assets/colorUtils-639f4d25.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/Color-fb64d77d.js","assets/heatmapTextureUtils-2627384f.js","assets/earcut-58237617.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView2D-2775dd38.js","assets/collectionUtils-803d9ba8.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/Identifiable-bfe1ff30.js","assets/Promise-376ab9f6.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/capabilities-302cf20d.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])),"ogc-feature":()=>dn().then(()=>j(()=>import("./OGCFeatureLayerView2D-b9a5a36d.js"),["assets/OGCFeatureLayerView2D-b9a5a36d.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/FeatureLayerView2D-9ae7c9fa.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/reactiveUtils-4dabbb80.js","assets/utils-317368cb.js","assets/mat3f32-d3d088e8.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/enums-4ca4641f.js","assets/MaterialKey-0093a242.js","assets/alignmentUtils-ae955d28.js","assets/Utils-69cc114d.js","assets/number-954e4ab6.js","assets/enums-2658a65c.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/TimeExtent-23e282b9.js","assets/Query-b96bcde0.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/MemCache-18a255ed.js","assets/deprecate-035b199e.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/FeatureSet-d32b0eb8.js","assets/LayerView2D-2775dd38.js","assets/schemaUtils-9c08f5e8.js","assets/LayerFloorInfo-54b916a2.js","assets/visualVariablesUtils-ecd70012.js","assets/createSymbolSchema-36503ad8.js","assets/cimAnalyzer-38842966.js","assets/BidiEngine-836b7ef6.js","assets/mat2d-2bbb5feb.js","assets/vec2-528adfe4.js","assets/vec2f32-461e65a9.js","assets/Rect-ea14f53a.js","assets/callExpressionWithFeature-55effb7b.js","assets/quantizationUtils-4dd81f85.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-9ad35d39.js","assets/ExpandedCIM-b7ed8ce5.js","assets/rendererUtils-0bcb63a1.js","assets/capabilities-302cf20d.js","assets/util-4239daf3.js","assets/TileStore-00ac650f.js","assets/Queue-b7d3cd48.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/FeatureLayerView-e9178bab.js","assets/floorFilterUtils-080a7cd2.js","assets/popupUtils-af06d391.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/RefreshableLayerView-7c1c2c75.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/projection-290b739f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/RelationshipQuery-0dda77ad.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/ItemCache-fd3aceaf.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/FramebufferObject-a3b9c52c.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/dehydratedFeatures-0557137d.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js","assets/OGCFeatureLayerView-409b7077.js"])),"open-street-map":e1,"oriented-imagery":t1,route:()=>dn().then(()=>j(()=>import("./RouteLayerView2D-09a0d584.js"),["assets/RouteLayerView2D-09a0d584.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/Stop-8921a099.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/LayerView2D-2775dd38.js","assets/utils-317368cb.js","assets/mat3f32-d3d088e8.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/enums-4ca4641f.js","assets/MaterialKey-0093a242.js","assets/alignmentUtils-ae955d28.js","assets/Utils-69cc114d.js","assets/number-954e4ab6.js","assets/enums-2658a65c.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/GraphicContainer-ce27fa6a.js","assets/BaseGraphicContainer-76f5ab54.js","assets/cimAnalyzer-38842966.js","assets/BidiEngine-836b7ef6.js","assets/mat2d-2bbb5feb.js","assets/vec2-528adfe4.js","assets/vec2f32-461e65a9.js","assets/Rect-ea14f53a.js","assets/callExpressionWithFeature-55effb7b.js","assets/quantizationUtils-4dd81f85.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-9ad35d39.js","assets/HandleOwner-9b396af1.js","assets/projectionSupport-aa5eaa0d.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/assets-8d3e737a.js","assets/zscale-89472cba.js","assets/json-48e3ea08.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/jsonUtils-0ff4ff96.js","assets/FramebufferObject-a3b9c52c.js","assets/FeatureContainer-934cc4cc.js","assets/Queue-b7d3cd48.js","assets/visualVariablesUtils-0d4b5279.js","assets/visualVariablesUtils-ecd70012.js","assets/TileContainer-21007653.js","assets/WGLContainer-8a3733a0.js","assets/WGLBrushVTLSymbol-d778c554.js","assets/StyleDefinition-ff072275.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/pixelUtils-d9cd2e49.js","assets/ShaderCompiler-77d0dcb6.js","assets/ProgramTemplate-cc7f8b69.js","assets/heatmapTextureUtils-2627384f.js","assets/earcut-58237617.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/lengthUtils-fa751420.js","assets/capabilities-302cf20d.js","assets/Matcher-f2620e9f.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/tileUtils-55e656c2.js","assets/TileClipper-4637f47d.js","assets/Geometry-daada628.js","assets/LRUCache-64ec42ee.js","assets/MemCache-18a255ed.js","assets/ExpandedCIM-b7ed8ce5.js","assets/devEnvironmentUtils-5002a058.js","assets/styleUtils-22b14a8b.js","assets/schemaUtils-9c08f5e8.js","assets/LayerFloorInfo-54b916a2.js","assets/diffUtils-68b89c71.js","assets/createSymbolSchema-36503ad8.js","assets/rendererUtils-0bcb63a1.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/deprecate-035b199e.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/util-4239daf3.js","assets/ComputedAttributeStorage-2b4316ba.js","assets/FeatureSetReader-7e79a15e.js","assets/centroid-5c988df3.js","assets/FieldsIndex-f104cc5f.js","assets/normalizeUtils-27e29a72.js","assets/GraphicsView-d3b9d029.js","assets/vec3f32-c9aa289f.js","assets/LayerView-bd9a2316.js","assets/Cyclical-151bcc41.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/RelationshipQuery-0dda77ad.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/ItemCache-fd3aceaf.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/dehydratedFeatures-0557137d.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])),stream:()=>dn().then(()=>j(()=>import("./StreamLayerView2D-08c1aecd.js"),["assets/StreamLayerView2D-08c1aecd.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/reactiveUtils-4dabbb80.js","assets/FeatureSet-d32b0eb8.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/FeatureLayerView2D-9ae7c9fa.js","assets/utils-317368cb.js","assets/mat3f32-d3d088e8.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/enums-4ca4641f.js","assets/MaterialKey-0093a242.js","assets/alignmentUtils-ae955d28.js","assets/Utils-69cc114d.js","assets/number-954e4ab6.js","assets/enums-2658a65c.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/TimeExtent-23e282b9.js","assets/Query-b96bcde0.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/MemCache-18a255ed.js","assets/deprecate-035b199e.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/LayerView2D-2775dd38.js","assets/schemaUtils-9c08f5e8.js","assets/LayerFloorInfo-54b916a2.js","assets/visualVariablesUtils-ecd70012.js","assets/createSymbolSchema-36503ad8.js","assets/cimAnalyzer-38842966.js","assets/BidiEngine-836b7ef6.js","assets/mat2d-2bbb5feb.js","assets/vec2-528adfe4.js","assets/vec2f32-461e65a9.js","assets/Rect-ea14f53a.js","assets/callExpressionWithFeature-55effb7b.js","assets/quantizationUtils-4dd81f85.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-9ad35d39.js","assets/ExpandedCIM-b7ed8ce5.js","assets/rendererUtils-0bcb63a1.js","assets/capabilities-302cf20d.js","assets/util-4239daf3.js","assets/TileStore-00ac650f.js","assets/Queue-b7d3cd48.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/FeatureLayerView-e9178bab.js","assets/floorFilterUtils-080a7cd2.js","assets/popupUtils-af06d391.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/RefreshableLayerView-7c1c2c75.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/projection-290b739f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/RelationshipQuery-0dda77ad.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/ItemCache-fd3aceaf.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/FramebufferObject-a3b9c52c.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/dehydratedFeatures-0557137d.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])),"subtype-group":()=>dn().then(()=>j(()=>import("./SubtypeGroupLayerView2D-52dffafa.js"),["assets/SubtypeGroupLayerView2D-52dffafa.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/reactiveUtils-4dabbb80.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/parser-498c8be0.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/TimeExtent-23e282b9.js","assets/Query-b96bcde0.js","assets/enumeration-3a03bd31.js","assets/jsonUtils-229211af.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Clonable-545593ce.js","assets/PopupTemplate-40f3c9aa.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/UniqueValueRenderer-08f8851c.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec4-790471c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/LegendOptions-010d0873.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/Graphic-f0e54e86.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/MemCache-18a255ed.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/FeatureLayerView2D-9ae7c9fa.js","assets/utils-317368cb.js","assets/mat3f32-d3d088e8.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/enums-4ca4641f.js","assets/MaterialKey-0093a242.js","assets/alignmentUtils-ae955d28.js","assets/Utils-69cc114d.js","assets/number-954e4ab6.js","assets/enums-2658a65c.js","assets/FeatureSet-d32b0eb8.js","assets/LayerView2D-2775dd38.js","assets/schemaUtils-9c08f5e8.js","assets/LayerFloorInfo-54b916a2.js","assets/visualVariablesUtils-ecd70012.js","assets/createSymbolSchema-36503ad8.js","assets/cimAnalyzer-38842966.js","assets/BidiEngine-836b7ef6.js","assets/mat2d-2bbb5feb.js","assets/vec2-528adfe4.js","assets/vec2f32-461e65a9.js","assets/Rect-ea14f53a.js","assets/callExpressionWithFeature-55effb7b.js","assets/quantizationUtils-4dd81f85.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-9ad35d39.js","assets/ExpandedCIM-b7ed8ce5.js","assets/rendererUtils-0bcb63a1.js","assets/capabilities-302cf20d.js","assets/util-4239daf3.js","assets/TileStore-00ac650f.js","assets/Queue-b7d3cd48.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/FeatureLayerView-e9178bab.js","assets/floorFilterUtils-080a7cd2.js","assets/popupUtils-af06d391.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/RefreshableLayerView-7c1c2c75.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/projection-290b739f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/RelationshipQuery-0dda77ad.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/ItemCache-fd3aceaf.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/FramebufferObject-a3b9c52c.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/dehydratedFeatures-0557137d.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])),tile:e1,"vector-tile":()=>dn().then(()=>j(()=>import("./VectorTileLayerView2D-2e4437ee.js"),["assets/VectorTileLayerView2D-2e4437ee.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/reactiveUtils-4dabbb80.js","assets/diffUtils-68b89c71.js","assets/enums-0fc02184.js","assets/TileInfoViewPOT-07a81608.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/Rect-ea14f53a.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/pbf-0e99a620.js","assets/rasterizingUtils-ec11e94c.js","assets/floatRGBA-9ad35d39.js","assets/TileKey-5aef17b6.js","assets/mat3f32-d3d088e8.js","assets/config-1337d16e.js","assets/StyleDefinition-ff072275.js","assets/enums-2658a65c.js","assets/TileInfo-b0eb8c90.js","assets/unitUtils-45d1147c.js","assets/TileStore-00ac650f.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/LRUCache-64ec42ee.js","assets/MemCache-18a255ed.js","assets/enums-4ca4641f.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/vec2f64-30dc1443.js","assets/VertexElementDescriptor-2925c6af.js","assets/TileContainer-21007653.js","assets/WGLContainer-8a3733a0.js","assets/WGLBrushVTLSymbol-d778c554.js","assets/number-954e4ab6.js","assets/FramebufferObject-a3b9c52c.js","assets/vec2f32-461e65a9.js","assets/GeometryUtils-c093d234.js","assets/pixelUtils-d9cd2e49.js","assets/Utils-69cc114d.js","assets/ShaderCompiler-77d0dcb6.js","assets/ProgramTemplate-cc7f8b69.js","assets/MaterialKey-0093a242.js","assets/alignmentUtils-ae955d28.js","assets/utils-317368cb.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/heatmapTextureUtils-2627384f.js","assets/earcut-58237617.js","assets/vec2-528adfe4.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/StyleRepository-0c36ed5d.js","assets/colorUtils-0c057879.js","assets/GeometryUtils-eebff0a0.js","assets/Geometry-daada628.js","assets/LayerView2D-2775dd38.js","assets/TileStrategy-a90cd1af.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/projection-290b739f.js","assets/zscale-89472cba.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/ItemCache-fd3aceaf.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/deprecate-035b199e.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/capabilities-302cf20d.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])),wcs:()=>dn().then(()=>j(()=>import("./ImageryTileLayerView2D-521cfa35.js"),["assets/ImageryTileLayerView2D-521cfa35.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/reactiveUtils-4dabbb80.js","assets/multidimensionalUtils-98b0907f.js","assets/RasterVFDisplayObject-0676fcf6.js","assets/HandleOwner-9b396af1.js","assets/FramebufferObject-a3b9c52c.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/VertexElementDescriptor-2925c6af.js","assets/dataUtils-a534a9c7.js","assets/pixelUtils-d9cd2e49.js","assets/WGLContainer-8a3733a0.js","assets/mat3f32-d3d088e8.js","assets/WGLBrushVTLSymbol-d778c554.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/enums-2658a65c.js","assets/enums-4ca4641f.js","assets/number-954e4ab6.js","assets/StyleDefinition-ff072275.js","assets/vec2f32-461e65a9.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/Utils-69cc114d.js","assets/ShaderCompiler-77d0dcb6.js","assets/ProgramTemplate-cc7f8b69.js","assets/MaterialKey-0093a242.js","assets/alignmentUtils-ae955d28.js","assets/utils-317368cb.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/heatmapTextureUtils-2627384f.js","assets/earcut-58237617.js","assets/vec2-528adfe4.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView2D-2775dd38.js","assets/TileContainer-21007653.js","assets/TileInfo-b0eb8c90.js","assets/unitUtils-45d1147c.js","assets/RawBlockCache-f270ede9.js","assets/rasterProjectionHelper-a7452876.js","assets/projection-290b739f.js","assets/assets-8d3e737a.js","assets/zscale-89472cba.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/Queue-b7d3cd48.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/capabilities-302cf20d.js","assets/util-4239daf3.js","assets/ImageryTileLayerView-f97d6c38.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/lengthUtils-fa751420.js","assets/popupUtils-af06d391.js","assets/LayerView-bd9a2316.js","assets/RefreshableLayerView-7c1c2c75.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])),"web-tile":e1,wfs:t1,wms:()=>dn().then(()=>j(()=>import("./WMSLayerView2D-23203f3f.js"),["assets/WMSLayerView2D-23203f3f.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/reactiveUtils-4dabbb80.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/BitmapContainer-5fb5f7d8.js","assets/WGLContainer-8a3733a0.js","assets/mat3f32-d3d088e8.js","assets/WGLBrushVTLSymbol-d778c554.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/Evented-a45c8b0f.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/enums-2658a65c.js","assets/enums-4ca4641f.js","assets/number-954e4ab6.js","assets/FramebufferObject-a3b9c52c.js","assets/StyleDefinition-ff072275.js","assets/vec2f32-461e65a9.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/pixelUtils-d9cd2e49.js","assets/Utils-69cc114d.js","assets/ShaderCompiler-77d0dcb6.js","assets/ProgramTemplate-cc7f8b69.js","assets/MaterialKey-0093a242.js","assets/alignmentUtils-ae955d28.js","assets/utils-317368cb.js","assets/parser-498c8be0.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/Color-fb64d77d.js","assets/heatmapTextureUtils-2627384f.js","assets/earcut-58237617.js","assets/vec2-528adfe4.js","assets/featureConversionUtils-03a03f40.js","assets/jsonUtils-229211af.js","assets/Polyline-ff2d7c6b.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView2D-2775dd38.js","assets/Collection-910b6f71.js","assets/SimpleObservable-23231131.js","assets/collectionUtils-803d9ba8.js","assets/geometry-b7901087.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/ExportStrategy-913accc5.js","assets/aaBoundingRect-193543b5.js","assets/TileInfo-b0eb8c90.js","assets/unitUtils-45d1147c.js","assets/Bitmap-479ee434.js","assets/TileStore-00ac650f.js","assets/Queue-b7d3cd48.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/enumeration-3a03bd31.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Clonable-545593ce.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/Identifiable-bfe1ff30.js","assets/Promise-376ab9f6.js","assets/RefreshableLayerView-7c1c2c75.js","assets/WMSLayerView-ccaae110.js","assets/OperationalLayer-97084f13.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/persistableUrlUtils-5f719c3b.js","assets/ElevationInfo-215614d8.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/lengthUtils-fa751420.js","assets/opacityUtils-1f7f5126.js","assets/ExportWMSImageParameters-e7eb0d55.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/zscale-89472cba.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/capabilities-302cf20d.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])),wmts:()=>dn().then(()=>j(()=>import("./WMTSLayerView2D-7cf905b5.js"),["assets/WMTSLayerView2D-7cf905b5.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/reactiveUtils-4dabbb80.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/imageUtils-5e882683.js","assets/BitmapTileContainer-d91c0937.js","assets/aaBoundingRect-193543b5.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/mat3f32-d3d088e8.js","assets/Bitmap-479ee434.js","assets/mat3-3fc68e72.js","assets/vec2f32-461e65a9.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/Evented-a45c8b0f.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/WGLContainer-8a3733a0.js","assets/WGLBrushVTLSymbol-d778c554.js","assets/enums-2658a65c.js","assets/enums-4ca4641f.js","assets/number-954e4ab6.js","assets/FramebufferObject-a3b9c52c.js","assets/StyleDefinition-ff072275.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/pixelUtils-d9cd2e49.js","assets/Utils-69cc114d.js","assets/ShaderCompiler-77d0dcb6.js","assets/ProgramTemplate-cc7f8b69.js","assets/MaterialKey-0093a242.js","assets/alignmentUtils-ae955d28.js","assets/utils-317368cb.js","assets/parser-498c8be0.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/Color-fb64d77d.js","assets/heatmapTextureUtils-2627384f.js","assets/earcut-58237617.js","assets/vec2-528adfe4.js","assets/featureConversionUtils-03a03f40.js","assets/jsonUtils-229211af.js","assets/Polyline-ff2d7c6b.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/TileContainer-21007653.js","assets/LayerView2D-2775dd38.js","assets/Collection-910b6f71.js","assets/SimpleObservable-23231131.js","assets/collectionUtils-803d9ba8.js","assets/geometry-b7901087.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/TileStore-00ac650f.js","assets/Queue-b7d3cd48.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/enumeration-3a03bd31.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Clonable-545593ce.js","assets/TileStrategy-a90cd1af.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/Identifiable-bfe1ff30.js","assets/Promise-376ab9f6.js","assets/RefreshableLayerView-7c1c2c75.js","assets/preload-helper-3bce6601.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/capabilities-302cf20d.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])),"line-of-sight":null,"base-elevation":null,"building-scene":null,dimension:null,elevation:null,"integrated-mesh":null,"point-cloud":null,voxel:null,scene:null,unknown:null,unsupported:null};function ume(i){const e=i.declaredClass?i.declaredClass.slice(i.declaredClass.lastIndexOf(".")+1):"Unknown",t=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new J(`${t}:view-not-supported`,`${e} is not supported in 2D`)}const MV={hasLayerViewModule:i=>y(OV[i.type]),importLayerView:i=>{const e=OV[i.type];if(C(e))throw ume(i);return e(i)}};function dme(i,e){const{spatialReference:t}=e,r=[e.x,e.y];let n=Number.POSITIVE_INFINITY,s=0,a=0;const o=[0,0],l=i.type==="extent"?[[[i.xmin,i.ymin],[i.xmin,i.ymax],[i.xmax,i.ymax],[i.xmax,i.ymin],[i.xmin,i.ymin]]]:i.rings;for(const c of l)for(let u=0;u<c.length-1;u++){Bie(o,r,c,u);const d=Q0(r,o);d<n&&(n=d,s=o[0],a=o[1])}return{coordinate:new He({x:s,y:a,spatialReference:t}),distance:n}}var n3;let Yf=n3=class extends IR(pe){constructor(i){super(i),this.geometry=null,this.spatialReference=null}get normalizedGeometry(){if(C(this.geometry)||!this.spatialReference)return null;if(!this.spatialReference.equals(this.geometry.spatialReference))try{return Dd(this.geometry,this.spatialReference)}catch(i){return ee.getLogger(this.declaredClass).error("#constraints.geometry","could not project the geometry to the view's spatial reference",{geometry:this.geometry,spatialReference:this.spatialReference,error:i}),null}return this.geometry}constrain(i,e){if(C(this.normalizedGeometry))return i;const t=i.targetGeometry;if(this.normalizedGeometry.type==="extent"?B7(this.normalizedGeometry,t):Ote(this.normalizedGeometry,t))return i;const{coordinate:r}=dme(this.normalizedGeometry,t);return r&&(i.targetGeometry=r),i}clone(){var i,e;return new n3({geometry:(i=this.geometry)==null?void 0:i.clone(),spatialReference:(e=this.spatialReference)==null?void 0:e.clone()})}};h([p({constructOnly:!0})],Yf.prototype,"geometry",void 0),h([p({readOnly:!0})],Yf.prototype,"normalizedGeometry",null),h([p({constructOnly:!0})],Yf.prototype,"spatialReference",void 0),Yf=n3=h([F("esri.views.2d.constraints.GeometryConstraint")],Yf);var s3;let X1=s3=class extends IR(pe){constructor(){super(...arguments),this.enabled=!0,this.rotationEnabled=!0}constrain(i,e){return this.enabled&&e&&(this.rotationEnabled||(i.rotation=e.rotation)),i}clone(){return new s3({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}};h([p()],X1.prototype,"enabled",void 0),h([p()],X1.prototype,"rotationEnabled",void 0),X1=s3=h([F("esri.views.2d.constraints.RotationConstraint")],X1);const tX=X1;var a3;let qa=a3=class extends IR(pe){constructor(i){super(i),this._lodByScale={},this._scales=[],this.effectiveLODs=null,this.effectiveMinZoom=-1,this.effectiveMaxZoom=-1,this.effectiveMinScale=0,this.effectiveMaxScale=0,this.lods=null,this.minZoom=-1,this.maxZoom=-1,this.minScale=0,this.maxScale=0,this.snapToZoom=!0}initialize(){let i,{lods:e,minScale:t,maxScale:r,minZoom:n,maxZoom:s}=this,a=-1,o=-1,l=!1,c=!1;if(t!==0&&r!==0&&t<r&&([t,r]=[r,t]),!e||!e.length)return this._set("effectiveMinScale",t),void this._set("effectiveMaxScale",r);e=e.map(u=>u.clone()),e.sort((u,d)=>d.scale-u.scale),e.forEach((u,d)=>u.level=d);for(const u of e)!l&&t>0&&t>=u.scale&&(a=u.level,l=!0),!c&&r>0&&r>=u.scale&&(o=i?i.level:-1,c=!0),i=u;n===-1&&(n=t===0?0:a),s===-1&&(s=r===0?e.length-1:o),n=Math.max(n,0),n=Math.min(n,e.length-1),s=Math.max(s,0),s=Math.min(s,e.length-1),n>s&&([n,s]=[s,n]),t=e[n].scale,r=e[s].scale,e.splice(0,n),e.splice(s-n+1,e.length),e.forEach((u,d)=>{this._lodByScale[u.scale]=u,this._scales[d]=u.scale}),this._set("effectiveLODs",e),this._set("effectiveMinZoom",n),this._set("effectiveMaxZoom",s),this._set("effectiveMinScale",t),this._set("effectiveMaxScale",r)}constrain(i,e){if(e&&i.scale===e.scale)return i;const t=this.effectiveMinScale,r=this.effectiveMaxScale,n=i.targetGeometry,s=e&&e.targetGeometry,a=r!==0&&i.scale<r,o=t!==0&&i.scale>t;if(a||o){const l=o?t:r;if(e&&s){const c=(l-e.scale)/(i.scale-e.scale);n.x=s.x+(n.x-s.x)*c,n.y=s.y+(n.y-s.y)*c}i.scale=l}return this.snapToZoom&&this.effectiveLODs&&(i.scale=this._getClosestScale(i.scale)),i}fit(i){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(i,null);const e=this.scaleToZoom(i.scale),t=Math.abs(e-Math.floor(e));return i.scale=this.zoomToScale(t>.99?Math.round(e):Math.floor(e)),i}zoomToScale(i){if(!this.effectiveLODs)return 0;i-=this.effectiveMinZoom,i=Math.max(0,i);const e=this._scales;if(i<=0)return e[0];if(i>=e.length)return e[e.length-1];const t=Math.round(i-.5),r=Math.round(i);return e[r]+(r-i)*(e[t]-e[r])}scaleToZoom(i){if(!this.effectiveLODs)return-1;const e=this._scales;let t,r;if(i>=e[0])return this.effectiveMinZoom;if(i<=e[e.length-1])return this.effectiveMaxZoom;for(let n=0;n<e.length-1;n++){if(t=e[n],r=e[n+1],r===i)return n+this.effectiveMinZoom+1;if(t>i&&r<i)return n+this.effectiveMinZoom+1-(i-r)/(t-r)}return-1}snapToClosestScale(i){if(!this.effectiveLODs)return i;const e=this.scaleToZoom(i);return this.zoomToScale(Math.round(e))}snapToNextScale(i,e=.5){if(!this.effectiveLODs)return i*e;const t=Math.round(this.scaleToZoom(i));return this.zoomToScale(t+1)}snapToPreviousScale(i,e=2){if(!this.effectiveLODs)return i*e;const t=Math.round(this.scaleToZoom(i));return this.zoomToScale(t-1)}clone(){return new a3({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}_getClosestScale(i){return this._lodByScale[i]||(i=this._scales.reduce((e,t)=>Math.abs(t-i)<=Math.abs(e-i)?t:e,this._scales[0])),this._lodByScale[i].scale}};h([p({readOnly:!0})],qa.prototype,"effectiveLODs",void 0),h([p({readOnly:!0})],qa.prototype,"effectiveMinZoom",void 0),h([p({readOnly:!0})],qa.prototype,"effectiveMaxZoom",void 0),h([p({readOnly:!0})],qa.prototype,"effectiveMinScale",void 0),h([p({readOnly:!0})],qa.prototype,"effectiveMaxScale",void 0),h([p()],qa.prototype,"lods",void 0),h([p()],qa.prototype,"minZoom",void 0),h([p()],qa.prototype,"maxZoom",void 0),h([p()],qa.prototype,"minScale",void 0),h([p()],qa.prototype,"maxScale",void 0),h([p()],qa.prototype,"snapToZoom",void 0),qa=a3=h([F("esri.views.2d.constraints.ZoomConstraint")],qa);const iX=qa,pme={base:null,key:"type",typeMap:{extent:pi,polygon:jm}};let $r=class extends pe{constructor(e){super(e),this.lods=null,this.minScale=0,this.maxScale=0,this.minZoom=-1,this.maxZoom=-1,this.rotationEnabled=!0,this.snapToZoom=!0}destroy(){this.view=null}get effectiveLODs(){return this._zoom.effectiveLODs}get effectiveMinScale(){return this._zoom.effectiveMinScale}get effectiveMaxScale(){return this._zoom.effectiveMaxScale}get effectiveMinZoom(){return this._zoom.effectiveMinZoom}get effectiveMaxZoom(){return this._zoom.effectiveMaxZoom}set geometry(e){e?this._set("geometry",e):this._set("geometry",null)}get version(){var e,t,r;return`${(e=this._zoom)==null?void 0:e.uid}/${(t=this._rotation)==null?void 0:t.uid}/${(r=this._geometry)==null?void 0:r.uid}`}get _defaultLODs(){var r,n,s;const e=(n=(r=this.view)==null?void 0:r.defaultsFromMap)==null?void 0:n.tileInfo,t=(s=this.view)==null?void 0:s.spatialReference;return e&&t&&e.spatialReference.equals(t)?e.lods:null}get _geometry(){var e;return new Yf({geometry:this.geometry,spatialReference:(e=this.view)==null?void 0:e.spatialReference})}get _rotation(){return new tX({rotationEnabled:this.rotationEnabled})}get _zoom(){const e=this._get("_zoom"),t=this.lods||this._defaultLODs,r=this.minZoom,n=this.maxZoom,s=this.minScale,a=this.maxScale,o=this.snapToZoom;return e&&e.lods===t&&e.minZoom===r&&e.maxZoom===n&&e.minScale===s&&e.maxScale===a&&e.snapToZoom===o?e:new iX({lods:t,minZoom:r,maxZoom:n,minScale:s,maxScale:a,snapToZoom:o})}canZoomInTo(e){const t=this.effectiveMaxScale;return t===0||e>=t}canZoomOutTo(e){const t=this.effectiveMinScale;return t===0||e<=t}constrain(e,t){return this._zoom.constrain(e,t),this._rotation.constrain(e,t),this._geometry.constrain(e,t),e}constrainByGeometry(e){return this._geometry.constrain(e)}fit(e){return this._zoom.fit(e)}zoomToScale(e){return this._zoom.zoomToScale(e)}scaleToZoom(e){return this._zoom.scaleToZoom(e)}snapScale(e){return this._zoom.snapToClosestScale(e)}snapToNextScale(e){return this._zoom.snapToNextScale(e)}snapToPreviousScale(e){return this._zoom.snapToPreviousScale(e)}};h([p({readOnly:!0})],$r.prototype,"effectiveLODs",null),h([p({readOnly:!0})],$r.prototype,"effectiveMinScale",null),h([p({readOnly:!0})],$r.prototype,"effectiveMaxScale",null),h([p({readOnly:!0})],$r.prototype,"effectiveMinZoom",null),h([p({readOnly:!0})],$r.prototype,"effectiveMaxZoom",null),h([p({types:pme,value:null})],$r.prototype,"geometry",null),h([p({type:[Kte]})],$r.prototype,"lods",void 0),h([p()],$r.prototype,"minScale",void 0),h([p()],$r.prototype,"maxScale",void 0),h([p()],$r.prototype,"minZoom",void 0),h([p()],$r.prototype,"maxZoom",void 0),h([p()],$r.prototype,"rotationEnabled",void 0),h([p()],$r.prototype,"snapToZoom",void 0),h([p()],$r.prototype,"view",void 0),h([p({readOnly:!0})],$r.prototype,"version",null),h([p()],$r.prototype,"_defaultLODs",null),h([p({type:Yf})],$r.prototype,"_geometry",null),h([p({type:tX})],$r.prototype,"_rotation",null),h([p({readOnly:!0,type:iX})],$r.prototype,"_zoom",null),$r=h([F("esri.views.2d.MapViewConstraints")],$r);const rX=$r;function mme(i){return i instanceof Float32Array&&i.length>=2}function fme(i){return Array.isArray(i)&&i.length>=2}function cO(i){return mme(i)||fme(i)}var o3;const yu=[0,0];let Tp=o3=class extends xt{constructor(i){super(i),this._viewpoint2D={center:Te(),rotation:0,scale:0,spatialReference:null},this.center=[0,0],this.extent=new pi,this.id=0,this.inverseTransform=xm(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=xm(),this.transformNoRotation=xm(),this.displayMat3=hm(),this.displayViewMat3=hm(),this.viewMat3=hm(),this.viewMat2d=ere(),this.worldScreenWidth=0,this.size=[0,0]}set pixelRatio(i){this._set("pixelRatio",i),this._update()}set size(i){this._set("size",i),this._update()}set viewpoint(i){if(i){const e=this._viewpoint2D,t=i.targetGeometry;e.center[0]=t.x,e.center[1]=t.y,e.rotation=i.rotation,e.scale=i.scale,e.spatialReference=t.spatialReference}this._update()}copy(i){const e=this.size,t=this.viewpoint;return t&&e?(this.viewpoint=Xc(t,i.viewpoint),this._set("size",wn(e,i.size))):(this.viewpoint=i.viewpoint.clone(),this._set("size",[i.size[0],i.size[1]])),this._set("pixelRatio",i.pixelRatio),this}clone(){return new o3({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(i,e,t){return cO(e)?Yu(i,e,this.inverseTransform):(yu[0]=e,yu[1]=t,Yu(i,yu,this.inverseTransform))}toScreen(i,e,t){return cO(e)?Yu(i,e,this.transform):(yu[0]=e,yu[1]=t,Yu(i,yu,this.transform))}toScreenNoRotation(i,e,t){return cO(e)?Yu(i,e,this.transformNoRotation):(yu[0]=e,yu[1]=t,Yu(i,yu,this.transformNoRotation))}getScreenTransform(i,e){const{center:t}=this._viewpoint2D,r=this._get("pixelRatio")||1,n=this._get("size");return gN(i,t,n,e,0,r),i}_update(){const{center:i,spatialReference:e,scale:t,rotation:r}=this._viewpoint2D,n=this._get("pixelRatio")||1,s=this._get("size"),a=new rr({targetGeometry:new He(i[0],i[1],e),scale:t,rotation:r});if(this._set("viewpoint",a),!s||!e||!t)return;this.resolution=Sv(a),this.rotation=r,this.scale=t,this.spatialReference=e,wn(this.center,i);const o=s[0]!==0?2/s[0]:0,l=s[1]!==0?-2/s[1]:0;AI(this.displayMat3,o,0,0,0,l,0,-1,1,1);const c=_G(this.viewMat3),u=Vp(s[0]/2,s[1]/2),d=Vp(-s[0]/2,-s[1]/2),m=$R(r);OI(c,c,u),yG(c,c,m),OI(c,c,d),xD(this.displayViewMat3,this.displayMat3,c);const f=hG(this.viewMat2d,u);return _D(f,f,m),BE(f,f,d),Wpe(this.extent,a,s),_N(this.transform,a,s,n),uG(this.inverseTransform,this.transform),eme(this.transformNoRotation,a,s,n),this.worldScreenWidth=ime(this.spatialReference,this.resolution),this._set("id",this.id+1),this}};h([p({readOnly:!0})],Tp.prototype,"id",void 0),h([p({value:1,json:{write:!0}})],Tp.prototype,"pixelRatio",null),h([p({json:{write:!0}})],Tp.prototype,"size",null),h([p()],Tp.prototype,"spatialReference",void 0),h([p({type:rr,json:{write:!0}})],Tp.prototype,"viewpoint",null),Tp=o3=h([F("esri.views.2d.ViewState")],Tp);const l3=Tp;var c3,h3;let Ju=c3=class extends pe{constructor(){super(...arguments),this.left=0,this.top=0,this.right=0,this.bottom=0}clone(){return new c3({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}};h([p()],Ju.prototype,"left",void 0),h([p()],Ju.prototype,"top",void 0),h([p()],Ju.prototype,"right",void 0),h([p()],Ju.prototype,"bottom",void 0),Ju=c3=h([F("esri.views.2d.PaddedViewState.Padding")],Ju);let gy=h3=class extends l3{constructor(...i){super(...i),this.paddedViewState=new l3,this._updateContent=(()=>{const e=Te();return()=>{const t=this._get("size"),r=this._get("padding");if(!t||!r)return;const n=this.paddedViewState;rt(e,r.left+r.right,r.top+r.bottom),Rc(e,t,e),wn(n.size,e);const s=n.viewpoint;s&&(this.viewpoint=s)}})(),this.addHandles(B(()=>[this.size,this.padding],()=>this._updateContent(),ni)),this.padding=new Ju,this.size=[0,0]}set padding(i){this._set("padding",i||new Ju)}set viewpoint(i){if(i){const e=i.clone();this.paddedViewState.viewpoint=i,nme(e,i,this._get("size"),this._get("padding"));const t=this._viewpoint2D,r=e.targetGeometry;t.center[0]=r.x,t.center[1]=r.y,t.rotation=e.rotation,t.scale=e.scale,t.spatialReference=r.spatialReference,this._update()}}clone(){return new h3({padding:this.padding.clone(),size:this.size.slice(),viewpoint:this.paddedViewState.viewpoint.clone(),pixelRatio:this.pixelRatio})}};h([p()],gy.prototype,"paddedViewState",void 0),h([p({type:Ju})],gy.prototype,"padding",null),h([p()],gy.prototype,"viewpoint",null),gy=h3=h([F("esri.views.2d.PaddedViewState")],gy);const gme=gy;function vP(i,e){switch(e){case"primary":return i.pointerType==="touch"||i.button===0;case"secondary":return i.pointerType!=="touch"&&i.button===2;case"tertiary":return i.pointerType!=="touch"&&i.button===1}}function yN(i,e){if(i.pointerType==="touch")return!1;switch(e){case"primary":return i.button===0;case"secondary":return i.button===2;case"tertiary":return i.button===1}}let IV=class extends Ri{constructor(e,t){super(!0),this._view=e,this.registerIncoming("double-click",t,r=>this._handleDoubleClick(r,t))}_handleDoubleClick(e,t){vP(e.data,"primary")&&(e.stopPropagation(),t?this._view.mapViewNavigation.zoomOut([e.data.x,e.data.y]):this._view.mapViewNavigation.zoomIn([e.data.x,e.data.y]))}},_me=class extends Ri{constructor(e,t,r){super(!0),this.view=e,this.pointerType=t,this.registerIncoming("double-tap-drag",r,n=>this._handleDoubleTapDrag(n))}_handleDoubleTapDrag(e){const{data:t}=e,{pointerType:r}=t;if(r!==this.pointerType)return;e.stopPropagation();const{action:n,delta:s}=t,{view:a}=this,{mapViewNavigation:o}=a;switch(n){case"begin":{const{scale:l}=a;this._startScale=l,this._currentScale=l,this._previousDelta=s,o.begin();break}case"update":{if(this._previousDelta.y===s.y)return;this._previousDelta=s;const l=1.015**s.y,c=this._startScale*l,u=c/this._currentScale;o.setViewpointImmediate(u),this._currentScale=c;break}case"end":{const{constraints:l}=a,{effectiveLODs:c,snapToZoom:u}=l;if(!u||!c)return void o.end();const d=l.snapScale(this._currentScale),m=(s.y>0?Math.max(d,l.snapToPreviousScale(this._startScale)):Math.min(d,l.snapToNextScale(this._startScale)))/this._currentScale;o.zoom(m);break}}}},eT=class{constructor(e){this._callbacks=e,this._currentCount=0,this._callbacks.condition||(this._callbacks.condition=()=>!0)}handle(e){const t=e.data,r=t.pointers.size;switch(t.action){case"start":this._currentCount=r,this._emitStart(e);break;case"added":this._emitEnd(this._previousEvent),this._currentCount=r,this._emitStart(e);break;case"update":this._emitUpdate(e);break;case"removed":this._startEvent&&this._emitEnd(this._previousEvent),this._currentCount=r,this._emitStart(e);break;case"end":this._emitEnd(e),this._currentCount=0}this._previousEvent=e}_emitStart(e){var t,r;this._startEvent=e,(r=(t=this._callbacks).condition)!=null&&r.call(t,this._currentCount,e)&&this._callbacks.start(this._currentCount,e,this._startEvent)}_emitUpdate(e){var t,r;(r=(t=this._callbacks).condition)!=null&&r.call(t,this._currentCount,e)&&this._callbacks.update(this._currentCount,e,this._startEvent)}_emitEnd(e){var t,r;(r=(t=this._callbacks).condition)!=null&&r.call(t,this._currentCount,e)&&this._callbacks.end(this._currentCount,e,this._startEvent),this._startEvent=null}},yme=class extends Ri{constructor(e,t,r){super(!0),this.view=e,this.pointerAction=t,this.registerIncoming("drag",r,n=>this._handleDrag(n)),this.registerIncoming("pointer-down",()=>this.stopMomentumNavigation())}onInstall(e){super.onInstall(e),this._dragEventSeparator=new eT({start:(t,r)=>{this.view.mapViewNavigation.pan.begin(this.view,r.data),r.stopPropagation()},update:(t,r)=>{this.view.mapViewNavigation.pan.update(this.view,r.data),r.stopPropagation()},end:(t,r)=>{this.view.mapViewNavigation.pan.end(this.view,r.data),r.stopPropagation()},condition:(t,r)=>t===1&&vP(r.data,this.pointerAction)})}_handleDrag(e){const t=this.view.mapViewNavigation;t.pinch.zoomMomentum||t.pinch.rotateMomentum?this.stopMomentumNavigation():this._dragEventSeparator.handle(e)}stopMomentumNavigation(){this.view.mapViewNavigation.pan.stopMomentumNavigation()}},vme=class extends Ri{constructor(e,t,r){super(!0),this._view=e,this.pointerAction=t;const n=this._view.mapViewNavigation;this._dragEventSeparator=new eT({start:(s,a)=>{n.rotate.begin(this._view,a.data),a.stopPropagation()},update:(s,a)=>{n.rotate.update(this._view,a.data),a.stopPropagation()},end:(s,a)=>{n.rotate.end(),a.stopPropagation()},condition:(s,a)=>s===1&&vP(a.data,this.pointerAction)}),this.registerIncoming("drag",r,s=>this._dragEventSeparator.handle(s))}};function ec(i){let e=i*i;return i<0&&(e*=-1),e}function bme(i){return i.translation[0]=0,i.translation[1]=0,i.translation[2]=0,i.heading=0,i.tilt=0,i}function u3(i,e,t){const r=t,n=i.state,s=i.device,a=e.tiltDirection==="forward-down"?1:-1,o=1;return s.deviceType==="standard"?(r.translation[0]=ec(n.axes[0]),r.translation[1]=ec(n.axes[1]),r.translation[2]=ec(n.buttons[7])-ec(n.buttons[6]),r.heading=ec(n.axes[2]),r.tilt=ec(n.axes[3])):s.deviceType==="spacemouse"&&(r.translation[0]=1.2*ec(n.axes[0]),r.translation[1]=1.2*ec(n.axes[1]),r.translation[2]=2*-ec(n.axes[2]),r.heading=1.2*ec(n.axes[5]),r.tilt=1.2*ec(n.axes[3])),r.tilt*=a,Q(r.translation,r.translation,o),r}function LV(i,e){const t=e;return t.translation[0]=i[1]-i[0],t.translation[1]=i[3]-i[2],t.translation[2]=i[4]-i[5],t.heading=i[7]-i[6],t.tilt=i[8]-i[9],t.zoom=i[10]-i[11],t}function QS(i){return i.translation[0]===0&&i.translation[1]===0&&i.translation[2]===0&&i.heading===0&&i.tilt===0&&i.zoom===0}let wme=class extends Ri{constructor(e){super(!0),this._view=e,this._frameTask=null,this._watchHandles=new Vt,this._currentDevice=null,this._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this._handle=this.registerIncoming("gamepad",t=>this._handleGamePadEvent(t)),this._handle.pause()}onInstall(e){super.onInstall(e),this._watchHandles.add([B(()=>{var t;return(t=this._view.navigation.gamepad)==null?void 0:t.enabled},t=>{t?(this._handle.resume(),this._frameTask||(this._frameTask=wd({update:r=>this._frameUpdate(r.deltaTime)}))):(this._handle.pause(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null))},et)])}onUninstall(){this._watchHandles.removeAll(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null),super.onUninstall()}_handleGamePadEvent(e){const t=this._view.navigation.gamepad.device;t&&e.data.device!==t||this._currentDevice&&this._currentDevice!==e.data.device||(e.data.action==="end"?(this._currentDevice=null,bme(this._transformation)):(this._currentDevice=e.data.device,u3(e.data,this._view.navigation.gamepad,this._transformation)))}_frameUpdate(e){const t=this._transformation;if(QS(t))return;const r=this._view.viewpoint.clone(),n=this._view.navigation.gamepad.velocityFactor,s=Tme*n*e;yP(r,r,[t.translation[0]*s,-t.translation[1]*s]);const a=1+t.translation[2]*Cme*e,o=this._view.constraints.rotationEnabled?-t.heading*xme*e:0,l=this._view.size,c=[l[0]/2,l[1]];KW(r,r,a,o,c,l);const u=this._view.constraints.constrain(r,this._view.viewpoint);this._view.viewpoint=u}};const xme=.06,Tme=.7,Cme=6e-4;let Sme=class extends Ri{constructor(e,t,r){super(!0),this.view=e,this.keys=t,this._pressed=!1,this._keyMap={[t.left]:"left",[t.right]:"right",[t.up]:"up",[t.down]:"down"},this.registerIncoming("key-down",r,n=>this._handleKeyDown(n)),this.registerIncoming("key-up",r,n=>this._handleKeyUp(n)),this.registerIncoming("blur",r,()=>this._handleBlur())}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0)}_handleKeyUp(e){this._handleKey(e,!1)}_handleBlur(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(e,t){const r=this._keyMap[e.data.key];if(this._pressed=r!=null,this._pressed){if(t)switch(this.view.mapViewNavigation.begin(),r){case"left":this.view.mapViewNavigation.continousPanLeft();break;case"right":this.view.mapViewNavigation.continousPanRight();break;case"up":this.view.mapViewNavigation.continousPanUp();break;case"down":this.view.mapViewNavigation.continousPanDown()}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation()}}},Eme=class extends Ri{constructor(e,t,r){super(!0),this.view=e,this.keys=t,this._pressed=!1,this._keyToDirection={[t.clockwiseOption1]:"clockwise",[t.clockwiseOption2]:"clockwise",[t.counterClockwiseOption1]:"counterClockwise",[t.counterClockwiseOption2]:"counterClockwise",[t.resetOption1]:"reset",[t.resetOption2]:"reset"},this.registerIncoming("key-down",r,n=>this._handleKeyDown(n)),this.registerIncoming("key-up",r,n=>this._handleKeyUp(n)),this.registerIncoming("blur",r,()=>this._handleBlur())}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0)}_handleKeyUp(e){this._handleKey(e,!1)}_handleBlur(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(e,t){const r=e.modifiers;if(r.size>0&&!r.has("Shift")||!this.view.constraints.rotationEnabled)return;const n=this._keyToDirection[e.data.key];if(this._pressed=n!=null,this._pressed){if(t)switch(this.view.mapViewNavigation.begin(),n){case"clockwise":this.view.mapViewNavigation.continousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation()}}};var h0;(function(i){i[i.IN=0]="IN",i[i.OUT=1]="OUT"})(h0||(h0={}));let Rme=class extends Ri{constructor(e,t,r){super(!0),this.view=e,this.keys=t,this._keysToZoomAction={},this.registerIncoming("key-down",r,n=>this._handleKeyDown(n)),t.zoomIn.forEach(n=>this._keysToZoomAction[n]=h0.IN),t.zoomOut.forEach(n=>this._keysToZoomAction[n]=h0.OUT)}_handleKeyDown(e){this._handleKey(e)}_handleKey(e){const t=e.modifiers;if(t.size>0&&!t.has("Shift"))return;const{key:r}=e.data;if(!(r in this._keysToZoomAction))return;const n=this._keysToZoomAction[r],{mapViewNavigation:s}=this.view;let a=null;switch(n){case h0.IN:a=s.zoomIn();break;case h0.OUT:a=s.zoomOut();break;default:return}s.begin(),a.then(()=>s.end()),e.stopPropagation()}};const Pme=.6;let Ame=class extends Ri{constructor(e,t){super(!0),this._view=e,this._canZoom=!0,this.registerIncoming("mouse-wheel",t,r=>this._handleMouseWheel(r))}_handleMouseWheel(e){if(!this._view.navigation.mouseWheelZoomEnabled||(e.preventDefault(),e.stopPropagation(),!this._canZoom))return;const t=this._view.mapViewNavigation,{x:r,y:n,deltaY:s}=e.data,a=1/Pme**(1/60*s),o=t.zoom(a,[r,n]);o&&(this._canZoom=!1,o.catch(()=>{}).then(()=>{this._canZoom=!0,t.end()}))}},Ome=class extends Ri{constructor(e){super(!0),this.view=e,this.registerIncoming("drag",r=>this._handleDrag(r)),this.registerIncoming("pointer-down",()=>this._stopMomentumNavigation());const t=this.view.mapViewNavigation;this._dragEventSeparator=new eT({start:(r,n)=>{t.pinch.begin(this.view,n.data),n.stopPropagation()},update:(r,n)=>{t.pinch.update(this.view,n.data),n.stopPropagation()},end:(r,n)=>{t.pinch.end(this.view),n.stopPropagation()},condition:r=>r>=2})}_handleDrag(e){this._dragEventSeparator.handle(e)}_stopMomentumNavigation(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()}};function $V(i){const e=i.native;return e?{buttons:e.buttons.map(t=>t.pressed?t.value?t.value:1:0),axes:e.axes.map(t=>Lme(t,i.axisThreshold))}:{buttons:[],axes:[]}}function Mme(i,e){if(i.axes.length!==e.axes.length||i.buttons.length!==e.buttons.length)return!1;for(let t=0;t<i.axes.length;t++)if(i.axes[t]!==e.axes[t])return!1;for(let t=0;t<i.buttons.length;t++)if(i.buttons[t]!==e.buttons[t])return!1;return!0}function Ime(i){for(let e=0;e<i.axes.length;e++)if(i.axes[e]!==0)return!1;for(let e=0;e<i.buttons.length;e++)if(i.buttons[e]!==0)return!1;return!0}function Lme(i,e){const t=Math.abs(i);return t<e?0:Math.sign(i)*(t-e)/(1-e)}let $me=class{constructor(e,t){this._element=e,this._input=t,this._hasEventListeners=!1,this._onConnectGamepad=s=>{this._connectGamepad(s.gamepad)},this._onDisconnectGamepad=s=>{const a=s.gamepad,o=a.index,l=this._inputDevices[o];l&&(this._emitGamepadEvent(a,$V(l),!1),this._inputDevices.splice(o,1),this._latestUpdate.splice(o,1),this._input.gamepad.devices.remove(l),this.ensurePollingState())},this._frameTask=null,this._latestUpdate=new Array,this._inputDevices=new Array,this._callback=null;const r="getGamepads"in window.navigator,n=window.isSecureContext;this.supported=r&&n,this.supported&&(this._forEachGamepad(s=>this._connectGamepad(s)),window.addEventListener("gamepadconnected",this._onConnectGamepad),window.addEventListener("gamepaddisconnected",this._onDisconnectGamepad),this.ensurePollingState())}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this._onConnectGamepad),window.removeEventListener("gamepaddisconnected",this._onDisconnectGamepad))}set hasEventListeners(e){this._hasEventListeners!==e&&(this._hasEventListeners=e,this.ensurePollingState())}get _eventsEnabled(){return this.supported&&this._inputDevices.length>0&&this._hasEventListeners}set onEvent(e){this._callback=e}_connectGamepad(e){const t=new pN(e);t.deviceType!=="unknown"&&(this._inputDevices[e.index]=t,this._input.gamepad.devices.add(t)),this.ensurePollingState()}ensurePollingState(){this._eventsEnabled?this._startPolling():this._stopPolling()}_startPolling(){this._frameTask==null&&(this._frameTask=wd({update:()=>this._readGamepadState()}))}_stopPolling(){this._frameTask!=null&&(this._frameTask.remove(),this._frameTask=null,this._latestUpdate=new Array)}_readGamepadState(){const e=document.hasFocus(),t=this._element.contains(document.activeElement),r=this._input.gamepad.enabledFocusMode==="document"&&!e||this._input.gamepad.enabledFocusMode==="view"&&!t;this._forEachGamepad(n=>{const s=this._inputDevices[n.index];if(!s)return;const a=this._latestUpdate[n.index],o=$V(s),l=r||Ime(o);a&&(a.timestamp===n.timestamp||!a.active&&l||Mme(a.state,o))||this._emitGamepadEvent(n,o,!l)})}_forEachGamepad(e){const t=window.navigator.getGamepads();for(let r=0;r<t.length;r++){const n=t[r];this._validate(n)&&e(n)}}_emitGamepadEvent(e,t,r){const n=this._latestUpdate[e.index],s=n&&n.active;if(!s&&!r)return;const a=!s&&r?"start":s&&r?"update":"end";this._latestUpdate[e.index]={timestamp:e.timestamp,state:t,active:r},this._callback&&this._callback({device:this._inputDevices[e.index],state:t,action:a})}_validate(e){if(!e||!e.connected)return!1;for(let t=0;t<e.axes.length;t++)if(isNaN(e.axes[t]))return!1;return!0}};const DV=Ot("trident"),FV=Ot("edge"),Dme=Ot("chrome"),Fme=Ot("ff"),Nme=Ot("safari"),R_={touchNone:"esri-view-surface--touch-none",touchPan:"esri-view-surface--touch-pan"};let vN=class nX{constructor(e,t){this._input=t,this._active={},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=e,e.getAttribute("tabindex")||e.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new $me(e,this._input),this._gamepadSource.onEvent=r=>this._callback("gamepad",r)}destroy(){this._callback=null,this.activeEvents=null,this._activePointerCaptures.forEach(e=>{this._releasePointerCaptureSafe(e)}),this._gamepadSource=Oe(this._gamepadSource),this._activePointerCaptures=null,this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault)}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(e){this._browserTouchPanningEnabled=e,this._updateTouchAction(),this._updateTouchEventHandling()}set onEventReceived(e){this._callback=e}set activeEvents(e){for(const t in this._active)if(!e||!e.has(t)){const r=this._active[t];this._element.removeEventListener(hO[t],r),delete this._active[t]}e&&e.forEach(t=>{if(!this._active[t]&&hO[t]){const r=(this._eventHandlers[t]||this._handleDefault).bind(this,t);this._element.addEventListener(hO[t],r),this._active[t]=r}}),this._gamepadSource.hasEventListeners=e&&e.has("gamepad")}setPointerCapture(e,t){t?(this._element.setPointerCapture(e.pointerId),this._activePointerCaptures.add(e.pointerId)):(this._releasePointerCaptureSafe(e.pointerId),this._activePointerCaptures.delete(e.pointerId))}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?R_.touchNone:R_.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?R_.touchPan:R_.touchNone)}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_removeTouchAction(){this._element.classList.remove(R_.touchNone),this._element.classList.remove(R_.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_releasePointerCaptureSafe(e){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(e))return;this._element.releasePointerCapture(e)}catch{}}_updateNormalizedPointerLikeEvent(e,t){const r=NW(this._element,e);return nX.test.disableSubpixelCoordinates&&(r.x=Math.round(r.x),r.y=Math.round(r.y)),t.x=r.x,t.y=r.y,t}_handleKey(e,t){const r=Bde(t);r&&e==="key-up"&&this._keyDownState.delete(r);const n={native:t,key:r,repeat:r&&this._keyDownState.has(r)};r&&e==="key-down"&&this._keyDownState.add(n.key),this._callback(e,n)}_handlePointer(e,t){const r=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,pointerType:t.pointerType,button:t.button,buttons:t.buttons,eventId:this._eventId++});this._callback(e,r)}_handlePointerPreventDefault(e,t){const r=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,pointerType:t.pointerType,button:t.button,buttons:t.buttons,eventId:this._eventId++});t.preventDefault(),this._callback(e,r)}_handleMouseWheel(e,t){let r=t.deltaY;switch(t.deltaMode){case 0:(DV||FV)&&(r=r/document.documentElement.clientHeight*600);break;case 1:r*=30;break;case 2:r*=900}DV||FV?r*=.7:Dme||Nme?r*=.6:Fme&&(r*=1.375);const n=100,s=Math.abs(r);s>n&&(r=r/s*200/(1+Math.exp(-.02*(s-n))));const a=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,deltaY:r});this._callback(e,a)}_handlePointerCaptureLost(e,t){this._activePointerCaptures.delete(t.pointerId),this._handleDefault(e,t)}_handleDefault(e,t){const r={native:t};t.preventDefault(),this._callback(e,r)}_preventAltKeyDefault(e){e.key==="Alt"&&e.preventDefault()}_preventMultiTouchPanning(e){e.touches.length>1&&e.preventDefault()}};vN.test={disableSubpixelCoordinates:!1};const hO={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};let sX=class extends Ri{constructor(){super(!0),this.registerIncoming("context-menu",e=>{e.data.native.preventDefault()})}};function bN(i,e){return Math.abs(e.x-i.x)+Math.abs(e.y-i.y)}function kme(i,e){const t=e.x-i.x,r=e.y-i.y;return Math.sqrt(t*t+r*r)}function Vme(i,e){if(e?(e.radius=0,e.center.x=0,e.center.y=0):e={radius:0,center:Rs()},i.length===0)return e;if(i.length===1)return e.center.x=i[0].x,e.center.y=i[0].y,e;if(i.length===2){const[x,T]=i,[R,E]=[T.x-x.x,T.y-x.y];return e.radius=Math.sqrt(R*R+E*E)/2,e.center.x=(x.x+T.x)/2,e.center.y=(x.y+T.y)/2,e}let t=0,r=0;for(let x=0;x<i.length;x++)t+=i[x].x,r+=i[x].y;t/=i.length,r/=i.length;const n=i.map(x=>x.x-t),s=i.map(x=>x.y-r);let a=0,o=0,l=0,c=0,u=0,d=0,m=0;for(let x=0;x<n.length;x++){const T=n[x],R=s[x],E=T*T,O=R*R;a+=E,o+=O,l+=T*R,c+=E*T,u+=O*R,d+=T*O,m+=R*E}const f=.5*(c+d),_=.5*(u+m),g=a*o-l*l,w=(f*o-_*l)/g,v=(a*_-l*f)/g,b=Rs(w+t,v+r);return{radius:Math.sqrt(w*w+v*v+(a+o)/i.length),center:b}}function vg(i){const{native:e}=i,{pointerId:t,button:r,pointerType:n}=e;return n==="mouse"?`${t}:${r}`:`${n}`}const Ul={maximumDoubleClickDelay:250,maximumDoubleClickDistance:10,maximumDoubleTouchDelay:350,maximumDoubleTouchDistance:35};let aX=class extends Ri{constructor(e=Ul.maximumDoubleClickDelay,t=Ul.maximumDoubleClickDistance,r=Ul.maximumDoubleTouchDelay,n=Ul.maximumDoubleTouchDistance,s=RR){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=t,this._maximumDoubleTouchDelay=r,this._maximumDoubleTouchDistance=n,this._clock=s,this._pointerState=new Map,this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",this._handleImmediateClick.bind(this)),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this))}onUninstall(){this._pointerState.forEach(e=>e.doubleClickTimer=Os(e.doubleClickTimer))}get hasPendingInputs(){return Er(this._pointerState,e=>e.doubleClickTimer!=null)}_clearDoubleClickTimer(e,t){const r=this._pointerState.get(e);r&&(r.doubleClickTimer=Os(r.doubleClickTimer),t&&this._click.emit(r.event.data,void 0,r.event.modifiers),this._pointerState.delete(e),this.refreshHasPendingInputs())}_doubleClickTimeoutExceeded(e){const t=this._pointerState.get(e);t.pointerDownCount===1&&this._click.emit(t.event.data,void 0,t.event.modifiers),t.doubleClickTimer=null,this._pointerState.delete(e),this.refreshHasPendingInputs()}_getPointerId(e){const{pointerId:t,pointerType:r,button:n}=e.native;return r==="mouse"?`${t}:${n}`:`${r}`}_handleImmediateClick(e){const t=e.data,{pointerType:r}=t.native,n=this._getPointerId(t);if(!this._pointerState.has(n))return void this._startClick(e);const s=this._pointerState.get(n),{data:a,modifiers:o}=s.event,l=r==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;bN(a,t)>l?(this._clearDoubleClickTimer(n,!0),this._startClick(e)):(this._clearDoubleClickTimer(n,!1),s.pointerDownCount===2&&this._doubleClick.emit(a,void 0,o))}_handlePointerDown(e){const t=vg(e.data),r=this._pointerState.get(t);r&&(r.pointerDownCount+=1)}_startClick(e){const{data:t}=e,{native:{pointerType:r}}=t,n=vg(t),s=r==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,a=this._clock.setTimeout(()=>this._doubleClickTimeoutExceeded(n),s),o=1;this._pointerState.set(n,{event:e,doubleClickTimer:a,pointerDownCount:o}),this.refreshHasPendingInputs()}},Ume=class extends Ri{constructor(e=Ul.maximumDoubleClickDelay,t=Ul.maximumDoubleClickDistance,r=Ul.maximumDoubleTouchDelay,n=Ul.maximumDoubleTouchDistance,s=RR){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=t,this._maximumDoubleTouchDelay=r,this._maximumDoubleTouchDistance=n,this._clock=s,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=Rs(0,0),this._pointerState=new Map,this._doubleTapDrag=this.registerOutgoing("double-tap-drag"),this._dragEventSeparator=new eT({start:(a,o)=>this._dragStart(a,o),update:(a,o)=>this._dragUpdate(o),end:(a,o)=>this._dragEnd(o)}),this.registerIncoming("drag",a=>this._dragEventSeparator.handle(a)),this.registerIncoming("pointer-down",a=>this._handlePointerDown(a)),this.registerIncoming("pointer-up",()=>this._handlePointerUp())}onUninstall(){this._pointerState.forEach(e=>{e.doubleTapTimeout=Os(e.doubleTapTimeout)})}get hasPendingInputs(){return Er(this._pointerState,e=>e.doubleTapTimeout!=null)}_clearPointerDown(e){const t=this._pointerState.get(e);t&&(t.doubleTapTimeout=Os(t.doubleTapTimeout),this._pointerState.delete(e),this.refreshHasPendingInputs())}_createDoubleTapDragData(e,t,r){const{button:n,buttons:s,pointer:a,pointers:o,pointerType:l,timestamp:c}=r;return{action:e,delta:t,button:n,buttons:s,pointer:a,pointers:o,pointerType:l,timestamp:c}}_dragStart(e,t){if(!this._doubleTapDragReady||e!==1)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;const{data:r,modifiers:n}=t,{center:s}=r;this._dragStartCenter=s;const a=this._createDoubleTapDragData("begin",Rs(0,0),r);this._doubleTapDrag.emit(a,void 0,n),t.stopPropagation()}_dragUpdate(e){if(!this._doubleTapDragActive)return;const{data:t,modifiers:r}=e,{center:n}=t,s=Rs(n.x-this._dragStartCenter.x,n.y-this._dragStartCenter.y),a=this._createDoubleTapDragData("update",s,t);this._doubleTapDrag.emit(a,void 0,r),e.stopPropagation()}_dragEnd(e){if(!this._doubleTapDragActive)return;const{data:t,modifiers:r}=e,{center:n}=t,s=Rs(n.x-this._dragStartCenter.x,n.y-this._dragStartCenter.y),a=this._createDoubleTapDragData("end",s,t);this._doubleTapDrag.emit(a,void 0,r),this._doubleTapDragActive=!1,e.stopPropagation()}_handlePointerDown(e){const{data:t}=e,r=vg(t),n=this._pointerState.get(r),{pointerType:s}=t.native;if(n){const a=s==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;this._clearPointerDown(r),bN(n.event.data,t)>a?this._storePointerDown(e):this._doubleTapDragReady=!0}else this._storePointerDown(e)}_handlePointerUp(){this._doubleTapDragReady=!1}_storePointerDown(e){const{data:t}=e,{pointerType:r}=t.native,n=vg(t),s=r==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,a=this._clock.setTimeout(()=>this._clearPointerDown(n),s);this._pointerState.set(n,{event:e,doubleTapTimeout:a}),this.refreshHasPendingInputs()}},oX=class extends Ri{constructor(e){super(!1),this._navigationTouch=e,this._startStateModifiers=new Set,this._activePointerMap=new Map,this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this._handlePointerUpAndPointerLost.bind(this))}_createPayload(e,t,r,n){return{action:e,pointerType:this._pointerType,button:this._mouseButton,buttons:t.buttons,timestamp:n,pointers:zme(this._activePointerMap),pointer:t,angle:r.angle,radius:r.radius,center:r.center}}_addPointer(e){const t=e.native.pointerId,r=VT(this._activePointerMap).angle,n={event:e,initialAngle:0,lastAngle:0};this._activePointerMap.set(t,n);const s=ZS(n,lX(this._activePointerMap));n.initialAngle=s,n.lastAngle=s,this._updatePointerAngles(r)}_updatePointer(e){if(e&&e.x==null&&e.y==null)return;const t=e.native.pointerId,r=this._activePointerMap.get(t);r?r.event=e:this._addPointer(e)}_removePointer(e){const t=VT(this._activePointerMap).angle;this._activePointerMap.delete(e),this._updatePointerAngles(t)}_updatePointerAngles(e){const t=VT(this._activePointerMap);this._activePointerMap.forEach(r=>{r.initialAngle=ZS(r,t)-e,r.lastAngle=ZS(r,t)-e})}_emitEvent(e,t,r){const n=VT(this._activePointerMap);this._drag.emit(this._createPayload(e,t,n,r),void 0,this._startStateModifiers)}_handlePointerUpAndPointerLost(e){const t=e.data.native.pointerId,r=It(e.timestamp);this._activePointerMap.get(t)&&(this._activePointerMap.size===1?(this._updatePointer(e.data),!this._isCurrentDragSuppressed&&this._emitEvent("end",e.data,r),this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._removePointer(t)):(this._removePointer(t),this._emitEvent("removed",e.data,It(e.timestamp))))}_handlePointerDrag(e){const t=e.data,r=t.currentEvent,n=It(e.timestamp);switch(t.action){case"start":case"update":this._isDragging?this._activePointerMap.has(r.native.pointerId)?(this._updatePointer(r),!this._isCurrentDragSuppressed&&this._emitEvent("update",r,n)):(this._addPointer(r),this._emitEvent("added",r,n),this._isCurrentDragSuppressed=this._isSuppressed):(this._updatePointer(r),this._pointerType=e.data.startEvent.pointerType,this._mouseButton=e.data.startEvent.button,this._startStateModifiers=e.modifiers,this._isDragging=!0,this._isCurrentDragSuppressed=this._isSuppressed,!this._isCurrentDragSuppressed&&this._emitEvent("start",r,n))}}get _isSuppressed(){return!!this._navigationTouch&&!this._navigationTouch.browserTouchPanEnabled&&this._pointerType==="touch"&&this._activePointerMap.size===1}};function lX(i){const e=[];return i.forEach(t=>{e.push(Rs(t.event.x,t.event.y))}),Vme(e)}function VT(i){const e=lX(i);let t=0;return i.forEach(r=>{let n=ZS(r,e),s=n-r.lastAngle;for(;s>Math.PI;)s-=2*Math.PI;for(;s<-Math.PI;)s+=2*Math.PI;n=r.lastAngle+s,r.lastAngle=n;const a=n-r.initialAngle;t+=a}),t/=i.size||1,{angle:t,radius:e.radius,center:e.center}}function zme(i){const e=new Map;return i.forEach((t,r)=>e.set(r,t.event)),e}function ZS(i,e){const t=i.event,r=t.x-e.center.x,n=t.y-e.center.y;return Math.atan2(n,r)}var NV;(function(i){i[i.Left=0]="Left",i[i.Middle=1]="Middle",i[i.Right=2]="Right",i[i.Back=3]="Back",i[i.Forward=4]="Forward",i[i.Undefined=-1]="Undefined"})(NV||(NV={}));let cX=class extends Ri{constructor(e=Ul.maximumDoubleClickDelay,t=Ul.maximumDoubleClickDistance,r=Ul.maximumDoubleTouchDelay,n=Ul.maximumDoubleTouchDistance,s=RR){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=t,this._maximumDoubleTouchDelay=r,this._maximumDoubleTouchDistance=n,this._clock=s,this._pointerState=new Map,this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUp.bind(this))}onUninstall(){this._pointerState.forEach(e=>{e.immediateDoubleClick&&e.immediateDoubleClick.timeoutHandle.remove()}),super.onUninstall()}_handlePointerDown(e){const t=e.data,r=vg(t);if(!this._pointerState.has(r)){const n={downButton:t.native.button,immediateDoubleClick:null};this._pointerState.set(r,n),this.startCapturingPointer(t.native)}}_handlePointerUp(e){const t=e.data,r=vg(t),n=this._pointerState.get(r);if(n&&n.downButton===t.native.button){const s=n.immediateDoubleClick;if(s){s.timeoutHandle.remove();const a=e.data.native.pointerType==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;bN(s,e.data)>a?this._startImmediateDoubleClick(e,n):(this._immediateDoubleClick.emit(e.data,void 0,s.modifiers),this._removeState(t))}else this._startImmediateDoubleClick(e,n)}}_startImmediateDoubleClick(e,t){const r=e.data.native.pointerType==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay;t.immediateDoubleClick={x:e.data.x,y:e.data.y,modifiers:e.modifiers,timeoutHandle:this._clock.setTimeout(()=>this._removeState(e.data),r)}}_removeState(e){const t=vg(e);this._pointerState.delete(t),this.stopCapturingPointer(e.native),this.refreshHasPendingInputs()}};const i1={maximumClickDelay:300,movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500};let hX=class extends Ri{constructor(e=i1.maximumClickDelay,t=i1.movementUntilMouseDrag,r=i1.movementUntilPenDrag,n=i1.movementUntilTouchDrag,s=i1.holdDelay,a=RR){super(!1),this._maximumClickDelay=e,this._movementUntilMouseDrag=t,this._movementUntilPenDrag=r,this._movementUntilTouchDrag=n,this._holdDelay=s,this._clock=a,this._pointerState=new Map,this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",o=>{this._handlePointerLoss(o,"pointer-up")}),this.registerIncoming("pointer-capture-lost",o=>{this._handlePointerLoss(o,"pointer-capture-lost")}),this.registerIncoming("pointer-cancel",o=>{this._handlePointerLoss(o,"pointer-cancel")}),this._moveHandle=this.registerIncoming("pointer-move",this._handlePointerMove.bind(this)),this._moveHandle.pause()}onUninstall(){this._pointerState.forEach(e=>{e.holdTimeout=Os(e.holdTimeout)}),super.onUninstall()}_handlePointerDown(e){const t=e.data,r=t.native.pointerId;let n=null;this._pointerState.size===0&&(n=this._clock.setTimeout(()=>{const a=this._pointerState.get(r);if(a){if(!a.isDragging){const o=a.previousEvent;this._pointerHold.emit(o,void 0,e.modifiers),a.holdEmitted=!0}a.holdTimeout=null}},this._holdDelay));const s={startEvent:t,previousEvent:t,startTimestamp:e.timestamp,isDragging:!1,downButton:t.native.button,holdTimeout:n,modifiers:new Set};this._pointerState.set(r,s),this.startCapturingPointer(t.native),this._moveHandle.resume(),this._pointerState.size>1&&this._startDragging(e)}_createPointerDragData(e,t,r){return{action:e,startEvent:t.startEvent,previousEvent:t.previousEvent,currentEvent:r}}_handlePointerMove(e){const t=e.data,r=t.native.pointerId,n=this._pointerState.get(r);n&&(n.isDragging?this._pointerDrag.emit(this._createPointerDragData("update",n,t),void 0,n.modifiers):kme(t,n.startEvent)>this._getDragThreshold(t.native.pointerType)&&this._startDragging(e),n.previousEvent=t)}_getDragThreshold(e){switch(e){case"touch":return this._movementUntilTouchDrag;case"pen":return this._movementUntilPenDrag;default:return this._movementUntilMouseDrag}}_startDragging(e){const t=e.data,r=t.native.pointerId;this._pointerState.forEach(n=>{n.holdTimeout!=null&&(n.holdTimeout.remove(),n.holdTimeout=null),n.isDragging||(n.modifiers=e.modifiers,n.isDragging=!0,r===n.startEvent.native.pointerId?this._pointerDrag.emit(this._createPointerDragData("start",n,t)):this._pointerDrag.emit(this._createPointerDragData("start",n,n.previousEvent),e.timestamp))})}_handlePointerLoss(e,t){const r=e.data,n=r.native.pointerId,s=this._pointerState.get(n);s&&(s.holdTimeout!=null&&(s.holdTimeout.remove(),s.holdTimeout=null),s.isDragging?this._pointerDrag.emit(this._createPointerDragData("end",s,t==="pointer-up"?r:s.previousEvent),void 0,s.modifiers):t==="pointer-up"&&s.downButton===r.native.button&&e.timestamp-s.startTimestamp<=this._maximumClickDelay&&!s.holdEmitted&&this._immediateClick.emit(r),this._pointerState.delete(n),this.stopCapturingPointer(r.native),this._pointerState.size===0&&this._moveHandle.pause())}};const UT={counter:"Ctrl",pan:{left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},zoom:{zoomIn:["=","+"],zoomOut:["-","_"]},rotate:{clockwiseOption1:"a",clockwiseOption2:"A",counterClockwiseOption1:"d",counterClockwiseOption2:"D",resetOption1:"n",resetOption2:"N"}};let Mf=class extends pe{constructor(){super(...arguments),this._handles=new Vt}initialize(){const e=()=>{var t;return(t=this.view)==null?void 0:t.ready};this._handles.add([cs(()=>!e(),()=>this._disconnect()),cs(e,()=>this._connect())])}destroy(){this._handles&&(this._handles.removeAll(),this._handles=null),this._disconnect()}get latestPointerType(){var e;return(e=this._inputManager)==null?void 0:e.latestPointerType}get latestPointerLocation(){var e;return(e=this._inputManager)==null?void 0:e.latestPointerLocation}get multiTouchActive(){var e;return((e=this._inputManager)==null?void 0:e.multiTouchActive)??!1}_disconnect(){this.view.viewEvents.disconnect(),this._inputManager=Oe(this._inputManager)}_connect(){const e=this.view.surface,t=new vN(e,this.view.input),r=[new cX,new hX,new aX,new oX(this.view.navigation),new Ume],n=new uc({eventSource:t,recognizers:r});n.installHandlers("prevent-context-menu",[new sX],Yh.INTERNAL),n.installHandlers("navigation",[new Ome(this.view),new wme(this.view),new Ame(this.view),new IV(this.view),new IV(this.view,[UT.counter]),new yme(this.view,"primary"),new Sme(this.view,UT.pan),new Rme(this.view,UT.zoom),new Eme(this.view,UT.rotate),new vme(this.view,"secondary"),new _me(this.view,"touch")],Yh.INTERNAL),this.view.viewEvents.connect(n),this._source=t,this._inputManager=n,B(()=>{var s,a;return(a=(s=this.view)==null?void 0:s.navigation)==null?void 0:a.browserTouchPanEnabled},s=>{this._source&&(this._source.browserTouchPanningEnabled=!s)},et)}get test(){return{inputManager:this._inputManager}}};h([p()],Mf.prototype,"view",void 0),h([p()],Mf.prototype,"latestPointerType",null),h([p()],Mf.prototype,"latestPointerLocation",null),h([p()],Mf.prototype,"multiTouchActive",null),Mf=h([F("esri.views.2d.input.MapViewInputManager")],Mf);const Bme=Mf;let Gme=0,Cp=class extends pe{constructor(){super(...arguments),this.color=new ti([0,255,255]),this.haloOpacity=1,this.fillOpacity=.25}get version(){return Gme++}};h([p({readOnly:!0})],Cp.prototype,"version",null),h([p({type:ti})],Cp.prototype,"color",void 0),h([p({type:ti})],Cp.prototype,"haloColor",void 0),h([p()],Cp.prototype,"haloOpacity",void 0),h([p()],Cp.prototype,"fillOpacity",void 0),Cp=h([F("esri.views.2d.support.HighlightOptions")],Cp);const uX=Cp,Hme=i=>i.includes("Brush");let dX=class{constructor(){this._names=new Map}begin(e){this._names.has(e)||(this._names.set(e,!1),Hme(e)&&this.record("Esri.FirstDraw"),performance.mark(`Esri.${e}.Start`))}end(e){this._names.has(e)&&!this._names.get(e)&&(this._names.set(e,!0),performance.mark(`Esri.${e}.End`))}record(e){this._names.has(e)||(this._names.set(e,!0),performance.mark(`Esri.${e}`))}};function jme(i,e,t,r,n,s,a,o){let l;i.ignorePadding&&(r={left:0,right:0,top:0,bottom:0}),i.width!=null&&i.height!=null?l=[i.width,i.height]:i.width==null&&i.height!=null?l=[i.height,i.height]:i.width!=null&&i.height==null?l=[i.width,i.width]:i.width==null&&i.height==null&&(l=null);const c=t[0]-(r.left+r.right),u=t[1]-(r.top+r.bottom);let d,m,f=i.area||{x:0,y:0,width:c,height:u};if(l){const _=c/u,g=l[0]/l[1];if(g>_){const w=f.width/g;f={x:f.x,y:Math.round(f.y+(f.height-w)/2),width:f.width,height:Math.round(w)}}else{const w=f.height*g;f={x:Math.round(f.x+(f.width-w)/2),y:f.y,width:Math.round(w),height:f.height}}}else l=[f.width,f.height];return l[0]>f.width?(d=Math.min(l[0]/f.width,e),m=l[0]/f.width/d):(d=1,m=l[0]/f.width),{resolutionScale:d,cropArea:{x:Math.round((f.x+r.left)*d),y:Math.round((f.y+r.top)*d),width:Math.round(f.width*d),height:Math.round(f.height*d)},outputScale:m,format:n,quality:s,children:a,rotation:o}}const kV=2048,qme=1.5,Wme=8;function Xme(i,e){const{format:t,quality:r,rotation:n,disableDecorations:s}=i||{},a=wN(i,e.padding),o=rfe(i,{width:e.width-a.left-a.right,height:e.height-a.top-a.bottom}),{width:l,height:c}=ife(i,o),u=gX(t),d=_X[u];return{format:u,quality:ue(r??d,0,100),area:o,width:l,height:c,rotation:n,disableDecorations:!!s,ignoreBackground:!(!i||!i.ignoreBackground),ignorePadding:!(!i||!i.ignorePadding)}}function Qme(i,e){const t=Xme(i,e),r=t.area,n=t.width/r.width,s=wN(t,e.padding),a=s.left+s.right,o=s.top+s.bottom,l=e.width-a,c=e.height-o,u=Math.floor(l*n+a),d=Math.floor(c*n+o),m=i&&i.layers?i.layers:[],f=t.ignoreBackground,_=t.ignorePadding;return{framebufferWidth:u,framebufferHeight:d,region:{x:Math.floor(r.x*n)+s.left,y:Math.floor(r.y*n)+s.top,width:t.width,height:t.height},format:t.format,quality:t.quality,rotation:t.rotation,pixelRatio:n,layers:m,disableDecorations:t.disableDecorations,ignoreBackground:f,ignorePadding:_,objectAndLayerIdColor:!1}}function YS(i,e,t){const{ctx:r,canvas:n}=mX(i,t),s=r.getImageData(0,0,i.width,i.height),a=Yme(n,e);return fX(n),{dataUrl:a,data:s}}function pX(i,e){const{ctx:t,canvas:r}=mX(i,e),n=t.getImageData(0,0,i.width,i.height);return fX(r),n}function mX(i,e){const t=Zme();e.premultipliedAlpha&&ofe(i),t.width=i.width,t.height=i.height;const r=t.getContext("2d");return r.putImageData(i,0,0),e.flipY&&afe(r),{ctx:r,canvas:t}}function fX(i){i.width=0,i.height=0}function Zme(){return C(uO)&&(uO=document.createElement("canvas")),uO}let uO=null;function Yme(i,e){const t=lfe[e.format],r=e.quality/100;return i.toDataURL(t,r)}function Kme(i,e){const t=gX(i),r=_X[t];return{format:t,quality:ue(e??r,0,100)}}function Jme(i,e){return e/Math.max(i[0],i[1])}function efe(i,e,t,r=0,n=0,s=i.width-r,a=i.height-n,o=!1){const{data:l}=i,{width:c,height:u,data:d}=e,m=s/c,f=a/u,_=Math.ceil(m/2),g=Math.ceil(f/2),w=i.width;for(let v=0;v<u;v++)for(let b=0;b<c;b++){const x=4*(b+(o?u-v-1:v)*c);let T=0,R=0,E=0,O=0,$=0,D=0;const I=(v+.5)*f;for(let G=Math.floor(v*f);G<(v+1)*f;G++){const W=Math.abs(I-(G+.5))/g,re=(b+.5)*m,te=W*W;for(let H=Math.floor(b*m);H<(b+1)*m;H++){const M=Math.abs(re-(H+.5))/_,U=Math.sqrt(te+M*M);if(U>=1)continue;let L=2*U*U*U-3*U*U+1;const z=4*(r+H+(n+G)*w);D+=L*l[z+3],R+=L,!t&&l[z+3]<255&&(L=L*l[z+3]/255),E+=L*l[z],O+=L*l[z+1],$+=L*l[z+2],T+=L}}d[x]=E/T,d[x+1]=O/T,d[x+2]=$/T,d[x+3]=D/R}return e}function tfe(i,e,t){if(!e)return i;const{framebufferWidth:r,framebufferHeight:n,pixelRatio:s,region:a}=i,o=wN(i,t),l=o.left+o.right,c=o.top+o.bottom,u=r-l,d=n-c,m=Math.min(Wme,Math.min((kV-l)/u,(kV-c)/d));return m<qme?i:{...i,framebufferWidth:Math.round(u*m)+l,framebufferHeight:Math.round(d*m)+c,pixelRatio:s*m,resample:{region:{x:Math.round((a.x-o.left)*m)+o.left,y:Math.round((a.y-o.top)*m)+o.top,width:Math.round(a.width*m),height:Math.round(a.height*m)},width:r,height:n}}}function ife(i,e){if(!i)return e;const t=i.width,r=i.height;if(t!=null&&r!=null)return{width:Math.floor(t),height:Math.floor(r)};if(t==null&&r==null)return e;const n=e.width/e.height;return r==null?{width:Math.floor(t),height:Math.floor(t/n)}:{width:Math.floor(r*n),height:Math.floor(r)}}function rfe(i,e){const t={x:0,y:0,width:e.width,height:e.height};if(i&&i.area){i.area.x!=null&&(t.x=Math.floor(i.area.x)),i.area.y!=null&&(t.y=Math.floor(i.area.y));const r=i.area.width!=null?Math.floor(i.area.width):null,n=i.area.height!=null?Math.floor(i.area.height):null;if(t.width=e.width-t.x,t.height=e.height-t.y,r!=null&&n!=null)t.width=Math.min(t.width,r),t.height=Math.min(t.height,n);else if(r==null&&n!=null){const s=Math.min(t.width,r);t.height=s/t.width*t.height,t.width=s}else if(r!=null&&n==null){const s=Math.min(t.height,n);t.width=s/t.height*t.width,t.height=s}}return nfe(sfe(t,i),e)}function nfe(i,e){const t=Math.floor(Math.max(i.x,0)),r=Math.floor(Math.max(i.y,0)),n={x:t,y:r,width:Math.floor(Math.min(i.width,e.width-t)),height:Math.floor(Math.min(i.height,e.height-r))},s=n.width/n.height,a=i.width/i.height;if(a===s)return n;if(a>s){const c=Math.floor(n.width/a),u=n.height-c;return{x:n.x,y:Math.floor(n.y+u/2),width:n.width,height:c}}const o=Math.floor(n.height*a),l=n.width-o;return{x:Math.floor(n.x+l/2),y:n.y,width:o,height:n.height}}function sfe(i,e){if(!e||e.width==null||e.height==null)return i;const t=e.width/e.height,r=i.width/i.height;if(r===t)return i;if(r<t){const s=Math.floor(i.height*t);return i.x-=(s-i.width)/2,i.width=s,i}const n=Math.floor(i.width/t);return i.y-=(n-i.height)/2,i.height=n,i}function wN(i,e){return!e||i&&i.ignorePadding?hfe:e}function gX(i){switch(i){case"png":case"jpg":case"jpeg":return i;default:return cfe}}function afe(i){i.save(),i.globalCompositeOperation="copy",i.scale(1,-1),i.translate(0,-i.canvas.height),i.drawImage(i.canvas,0,0),i.restore()}function ofe(i){const e=i.data,t=e.length;for(let r=0;r<t;r+=4){const n=e[r+3];if(n!==255&&n>0){const s=255/n;e[r+0]=e[r+0]*s,e[r+1]=e[r+1]*s,e[r+2]=e[r+2]*s}}}const lfe={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},VV=98,cfe="png",_X={png:100,jpg:VV,jpeg:VV},hfe={top:0,right:0,bottom:0,left:0};function yX(i){const e=Rre(i);if(!e.available)return new J("webgl:required","WebGL is required but not supported.");if(i==="3d"&&e.majorPerformanceCaveat)return new J("webgl:major-performance-caveat-detected","Your WebGL implementation doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist.");if(!e.supportsHighPrecisionFragment)return new J("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported.");if(!e.supportsVertexShaderSamplers)return new J("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported.");if(e.type===Nn.WEBGL1){if(!e.supportsElementIndexUint)return new J("webgl:element-index-uint-required","WebGL support for uint vertex indices is required but not supported.");if(!e.supportsStandardDerivatives)return new J("webgl:standard-derivatives-required","WebGL support for standard derivatives is required but not supported.");if(!e.supportsInstancedArrays)return new J("webgl:instanced-arrays-required","WebGL support for instanced rendering is required but not supported.")}return null}function ufe(i){return i&&"nodeType"in i}function dfe(i){return i&&typeof i.render=="function"}const UV={component:"esri-component"};let If=class extends pe{constructor(){super(...arguments),this.widget=null}destroy(){this.widget&&this.widget.destroy(),this.node=null}get id(){return this.get("widget.id")||this.get("node.id")}set node(e){const t=this._get("node");e!==t&&(e&&e.classList.add(UV.component),t&&t.classList.remove(UV.component),this._set("node",e))}castNode(e){return e?typeof e=="string"||ufe(e)?(this._set("widget",null),uD(e)):(dfe(e)&&!e.domNode&&(e.domNode=document.createElement("div")),this._set("widget",e),e.domNode):(this._set("widget",null),null)}};h([p({dependsOn:[]})],If.prototype,"id",null),h([p()],If.prototype,"node",null),h([qr("node")],If.prototype,"castNode",null),h([p({readOnly:!0})],If.prototype,"widget",void 0),If=h([F("esri.views.ui.Component")],If);const KS=If,pfe={left:0,top:0,bottom:0,right:0},vX={bottom:30,top:15,right:15,left:15},dO="manual",ea={ui:"esri-ui",corner:"esri-ui-corner",innerContainer:"esri-ui-inner-container",manualContainer:"esri-ui-manual-container",cornerContainer:"esri-ui-corner-container",topLeft:"esri-ui-top-left",topRight:"esri-ui-top-right",bottomLeft:"esri-ui-bottom-left",bottomRight:"esri-ui-bottom-right"};function mfe(i){return i&&!i._started&&typeof i.postMixInProperties=="function"&&typeof i.buildRendering=="function"&&typeof i.postCreate=="function"&&typeof i.startup=="function"}function pO(i){const e=i,t=typeof e=="object"&&e!==null&&Object.getPrototypeOf(e);return(t===null||t===Object.prototype)&&("component"in e||"index"in e||"position"in e)?i:null}function mO(i,{top:e,bottom:t,left:r,right:n}){i.style.top=e,i.style.bottom=t,i.style.left=r,i.style.right=n}let Du=class extends nn.EventedAccessor{constructor(e){super(e),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentToKey=new Map,this._handles=new Vt,this.view=null,this._applyViewPadding=()=>{const t=this.container;t&&mO(t,this._toPxPosition(this._getViewPadding()))},this._applyUIPadding=()=>{const t=this._innerContainer;t&&mO(t,this._toPxPosition(this.padding))},this._initContainers()}initialize(){this._handles.add([B(()=>{var e;return[(e=this.view)==null?void 0:e.padding,this.container]},this._applyViewPadding,et),B(()=>this.padding,this._applyUIPadding,et)])}destroy(){this.container=null;for(const e of this._components)e.destroy();this._components.length=0,this._handles.destroy(),this._componentToKey.clear()}set container(e){const t=this._get("container");e!==t&&(e&&(e.classList.add(ea.ui),Uue(e),this._attachContainers(e)),t&&(t.classList.remove(ea.ui),mO(t,{top:"",bottom:"",left:"",right:""}),J7(t)),this._set("container",e))}get height(){const e=this.get("view.height")||0;if(e===0)return e;const t=this._getViewPadding(),r=t.top+t.bottom;return Math.max(e-r,0)}get padding(){return this._get("padding")}set padding(e){this._overrideIfSome("padding",e)}castPadding(e){return typeof e=="number"?{bottom:e,top:e,right:e,left:e}:{...vX,...e}}get width(){const e=this.get("view.width")||0;if(e===0)return e;const t=this._getViewPadding(),r=t.left+t.right;return Math.max(e-r,0)}add(e,t){let r,n;if(Array.isArray(e))return void e.forEach(a=>this.add(a,t));const s=pO(e);s&&({index:r,position:t,component:e,key:n}=s),t&&typeof t=="object"&&({index:r,key:n,position:t}=t),!e||t&&!this._isValidPosition(t)||this._add(e,t,r,n)}remove(e,t){if(!e)return;if(Array.isArray(e))return e.map(n=>this.remove(n,t));const r=this._find(e);if(r){const n=this._componentToKey;if(n.has(e)&&n.get(e)!==t)return;const s=this._components.indexOf(r);return r.node.parentNode&&r.node.parentNode.removeChild(r.node),this._componentToKey.delete(e),this._components.splice(s,1)[0]}}empty(e){return Array.isArray(e)?e.map(t=>this.empty(t)).reduce((t,r)=>t.concat(r)):(e=e||dO)===dO?Array.prototype.slice.call(this._manualContainer.children).filter(t=>!t.classList.contains(ea.corner)).map(t=>this.remove(t)):this._isValidPosition(e)?Array.prototype.slice.call(this._cornerNameToContainerLookup[e].children).map(this.remove,this):null}move(e,t){if(Array.isArray(e)&&e.forEach(a=>this.move(a,t)),!e)return;let r;const n=pO(e)||pO(t);if(n&&(r=n.index,t=n.position,e=n.component||e),t&&!this._isValidPosition(t))return;const s=this.remove(e);s&&this.add(s,{position:t,index:r})}find(e){if(!e)return null;const t=this._findById(e);return t&&(t.widget||t.node)}getPosition(e){for(const t in this._positionNameToContainerLookup)if(this._positionNameToContainerLookup[t].contains(e))return t;return null}_add(e,t,r,n){e instanceof KS||(e=new KS({node:e})),this._place({component:e,position:t,index:r}),this._components.push(e),n&&this._componentToKey.set(e,n)}_find(e){return e?e instanceof KS?this._findByComponent(e):typeof e=="string"?this._findById(e):this._findByNode(e.domNode||e):null}_getViewPadding(){return this.get("view.padding")||pfe}_attachContainers(e){e.appendChild(this._innerContainer),e.appendChild(this._manualContainer)}_initContainers(){const e=document.createElement("div");e.classList.add(ea.innerContainer),e.classList.add(ea.cornerContainer);const t=document.createElement("div");t.classList.add(ea.innerContainer),t.classList.add(ea.manualContainer);const r=document.createElement("div");r.classList.add(ea.topLeft),r.classList.add(ea.corner),e.appendChild(r);const n=document.createElement("div");n.classList.add(ea.topRight),n.classList.add(ea.corner),e.appendChild(n);const s=document.createElement("div");s.classList.add(ea.bottomLeft),s.classList.add(ea.corner),e.appendChild(s);const a=document.createElement("div");a.classList.add(ea.bottomRight),a.classList.add(ea.corner),e.appendChild(a),this._innerContainer=e,this._manualContainer=t;const o=zh();this._cornerNameToContainerLookup={"top-left":r,"top-right":n,"bottom-left":s,"bottom-right":a,"top-leading":o?n:r,"top-trailing":o?r:n,"bottom-leading":o?a:s,"bottom-trailing":o?s:a},this._positionNameToContainerLookup={manual:t,...this._cornerNameToContainerLookup}}_isValidPosition(e){return!!this._positionNameToContainerLookup[e]}_place(e){const t=e.component,r=e.position||dO,n=e.index,s=this._positionNameToContainerLookup[r],a=n>-1;if(mfe(t.widget)&&t.widget.startup(),!a)return void s.appendChild(t.node);const o=Array.prototype.slice.call(s.children);if(n===0)return void(s.firstChild?R5(t.node,s.firstChild):s.appendChild(t.node));n>=o.length?s.appendChild(t.node):R5(t.node,o[n])}_toPxPosition(e){return{top:this._toPxUnit(e.top),left:this._toPxUnit(e.left),right:this._toPxUnit(e.right),bottom:this._toPxUnit(e.bottom)}}_toPxUnit(e){return e===0?"0":e+"px"}_findByComponent(e){let t,r=null;return this._components.some(n=>(t=n===e,t&&(r=n),t)),r}_findById(e){let t,r=null;return this._components.some(n=>(t=n.id===e,t&&(r=n),t)),r}_findByNode(e){let t,r=null;return this._components.some(n=>(t=n.node===e,t&&(r=n),t)),r}};h([p()],Du.prototype,"container",null),h([p()],Du.prototype,"height",null),h([p({value:vX})],Du.prototype,"padding",null),h([qr("padding")],Du.prototype,"castPadding",null),h([p()],Du.prototype,"view",void 0),h([p()],Du.prototype,"width",null),Du=h([F("esri.views.ui.UI")],Du);const ffe=Du;function zV(i,e){return i&&"copyright"in i&&(!e||typeof i.originOf=="function"&&i.originOf("copyright")==="user")}function gfe(i,e){return i.length!==e.length||i.some((t,r)=>t.text!==e[r].text)}function zT(i,e,t){!t||!e||i.find(r=>r.layerView===e&&r.text===t)||i.push({text:t,layerView:e})}function _fe(i){return i.type==="bing-maps"}const Qd=[];let _y=class extends dD{constructor(e){super(e),this._clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.handles.remove("suspension"),this.notifyChange("state")},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new wt,this.view=null,this._allLayerViewsChange=t=>{this.handles.remove("suspension");const r=this.get("view.allLayerViews");r&&this.handles.add(r.map(n=>B(()=>{var s;return[n.suspended,(s=n.layer)==null?void 0:s.attributionVisible]},()=>this._updateAttributionItems())),"suspension"),t&&t.removed&&t.removed.forEach(n=>{this._pendingAttributions.delete(n),this._fetchedAttributionData.delete(n)}),this._updateAttributionItems()},this.handles.add([wr(()=>{var t;return(t=this.view)==null?void 0:t.allLayerViews},"change",t=>this._allLayerViewsChange(t),{onListenerAdd:()=>this._allLayerViewsChange(),onListenerRemove:this._clear}),cs(()=>{var t;return((t=this.view)==null?void 0:t.stationary)===!0},()=>this._updateAttributionItems())])}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll()}get state(){return this.get("view.ready")?this._pendingAttributions.size>0?"loading":"ready":"disabled"}_updateAttributionItems(){const e=this.get("view.allLayerViews");Qd.length=0,e?(e.forEach(t=>{var s;if(t.suspended||!((s=t.layer)!=null&&s.attributionVisible))return;const r=t.layer;if(zV(r,"user"))return void zT(Qd,t,r.copyright);if(r.hasAttributionData){if(this._fetchedAttributionData.has(t)){const a=this._fetchedAttributionData.get(t);return void(a?zT(Qd,t,this._getDynamicAttribution(a,this.view,r)):zV(r)&&zT(Qd,t,r.copyright))}return void this._fetchAttributionData(t)}const n=r.get("portalItem.accessInformation");zT(Qd,t,n||r.copyright)}),gfe(this.items,Qd)&&(this.items.removeAll(),this.items.addMany(Qd)),Qd.length=0,this.notifyChange("state")):this._clear()}async _fetchAttributionData(e){if(this._pendingAttributions.has(e))return;this._pendingAttributions.add(e);const t=await bw(e.layer.fetchAttributionData());if(this._pendingAttributions.has(e)){const r=t.ok?this._createContributionIndex(t.value,_fe(e.layer)):null;this._pendingAttributions.delete(e),this._fetchedAttributionData.set(e,r)}this._updateAttributionItems()}_createContributionIndex(e,t){const r=e.contributors,n={};if(!r)return n;for(let s=0;s<r.length;s++){const a=r[s],o=a.coverageAreas;if(!o)return;for(const l of o){const c=l.bbox,u=l.zoomMin-(t&&l.zoomMin?1:0),d=l.zoomMax-(t&&l.zoomMax?1:0),m={xmin:c[1],ymin:c[0],xmax:c[3],ymax:c[2],spatialReference:Zt.WGS84},f={extent:ER(m),attribution:a.attribution||"",score:l.score!=null?l.score:100,id:s};for(let _=u;_<=d;_++)n[_]=n[_]||[],n[_].push(f)}}return n.maxKey=Math.max.apply(null,Object.keys(n)),n}_getDynamicAttribution(e,t,r){const{extent:n,scale:s}=t;let a=r.tileInfo.scaleToZoom(s);if(a=Math.min(e.maxKey,Math.round(a)),!n||a==null||a<=-1)return"";const o=e[a],l=hD(n.center.clone().normalize(),t.spatialReference),c={};return o?o.filter(u=>{const d=!c[u.id]&&l&&B7(u.extent,l);return d&&(c[u.id]=!0),d}).sort((u,d)=>d.score-u.score||u.objectId-d.objectId).map(u=>u.attribution).join(", "):""}};h([p({readOnly:!0,type:wt})],_y.prototype,"items",void 0),h([p({readOnly:!0})],_y.prototype,"state",null),h([p()],_y.prototype,"view",void 0),_y=h([F("esri.widgets.Attribution.AttributionViewModel")],_y);const bX=_y,Zd={base:"esri-attribution esri-widget",poweredBy:"esri-attribution__powered-by",sources:"esri-attribution__sources",open:"esri-attribution--open",sourcesOpen:"esri-attribution__sources--open",link:"esri-attribution__link",widgetIcon:"esri-icon-description",interactive:"esri-interactive"};let ha=class extends Hn{constructor(e,t){super(e,t),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this._resizeObserver=new ResizeObserver(r=>r.forEach(({target:n})=>this._checkSourceTextOverflow(n))),this.iconClass=Zd.widgetIcon,this.itemDelimiter=" | ",this.messages=null,this.viewModel=new bX}initialize(){this.addHandles(wr(()=>{var e;return(e=this.viewModel)==null?void 0:e.items},"change",()=>this.scheduleRender()))}destroy(){var e;(e=this._resizeObserver)==null||e.disconnect()}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}get attributionText(){return this.viewModel.items.reduce((e,t)=>(e.includes(t.text)||e.push(t.text),e),[]).join(this.itemDelimiter)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e={[Zd.open]:this._isOpen};return N("div",{bind:this,class:this.classes(Zd.base,e),dir:"ltr",onclick:this._toggleState,onkeydown:this._toggleState},this.renderSourcesNode(),this.renderPoweredBy())}renderPoweredBy(){return N("div",{class:Zd.poweredBy},"Powered by"," ",N("a",{class:Zd.link,href:"http://www.esri.com/",target:"_blank",rel:"noreferrer"},"Esri"))}renderSourcesNode(){const e=this._isOpen,t=this._isInteractive,r=t?"0":"",{attributionText:n}=this,s={[Zd.sourcesOpen]:e,[Zd.interactive]:t};return N("div",{afterCreate:this._afterSourcesNodeCreate,bind:this,class:this.classes(Zd.sources,s),innerHTML:n,tabindex:r})}_afterSourcesNodeCreate(e){this._prevSourceNodeHeight=e.clientWidth,this._resizeObserver.observe(e)}_checkSourceTextOverflow(e){let t=!1;const{clientHeight:r,clientWidth:n,scrollWidth:s}=e,a=s>n,o=this._attributionTextOverflowed!==a;if(this._attributionTextOverflowed=a,o&&(t=!0),this._isOpen){const l=r<this._prevSourceNodeHeight;this._prevSourceNodeHeight=r,l&&(this._isOpen=!1,t=!0)}t&&this.scheduleRender()}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen)}};h([p()],ha.prototype,"_isOpen",void 0),h([p()],ha.prototype,"_isInteractive",null),h([p()],ha.prototype,"_attributionTextOverflowed",void 0),h([p()],ha.prototype,"_prevSourceNodeHeight",void 0),h([p({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],ha.prototype,"attributionText",null),h([p()],ha.prototype,"iconClass",void 0),h([p()],ha.prototype,"itemDelimiter",void 0),h([p()],ha.prototype,"label",null),h([p(),_n("esri/widgets/Attribution/t9n/Attribution")],ha.prototype,"messages",void 0),h([p()],ha.prototype,"view",null),h([p({type:bX})],ha.prototype,"viewModel",void 0),h([Uo()],ha.prototype,"_toggleState",null),ha=h([F("esri.widgets.Attribution")],ha);const yfe=ha,vfe="esri.widgets.CompassViewModel";let Lf=class extends PW(pe){constructor(e){super(e),this._handles=new Vt,this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this)}initialize(){this._handles.add(B(()=>this.view,this._updateRotationWatcher,et))}destroy(){this._handles=Os(this._handles),this.view=null}get canShowNorth(){const e=this.get("view.spatialReference");return!(!e||!e.isWebMercator&&!e.isGeographic)}get state(){return this.get("view.ready")?this.canShowNorth?"compass":"rotation":"disabled"}reset(){if(!this.get("view.ready"))return;const e={};this.view.type==="2d"?e.rotation=0:e.heading=0,this.callGoTo({target:e})}_updateForRotation(e){e!=null&&(this.orientation={z:e})}_updateForCamera(e){if(!e)return;const t=-e.heading;this.orientation={x:0,y:0,z:t}}_updateRotationWatcher(e){this._handles.removeAll(),e&&this._handles.add(e.type==="2d"?B(()=>e==null?void 0:e.rotation,this._updateForRotation,et):B(()=>e==null?void 0:e.camera,this._updateForCamera,et))}};h([p({readOnly:!0})],Lf.prototype,"canShowNorth",null),h([p()],Lf.prototype,"orientation",void 0),h([p({readOnly:!0})],Lf.prototype,"state",null),h([p()],Lf.prototype,"view",void 0),Lf=h([F(vfe)],Lf);const wX=Lf,Yd={base:"esri-compass esri-widget--button esri-widget",text:"esri-icon-font-fallback-text",icon:"esri-compass__icon",rotationIcon:"esri-icon-dial",northIcon:"esri-icon-compass",widgetIcon:"esri-icon-locate-circled",interactive:"esri-interactive",disabled:"esri-disabled"};let _h=class extends Hn{constructor(e,t){super(e,t),this.iconClass=Yd.widgetIcon,this.messages=null,this.viewModel=new wX}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}reset(){return this.viewModel.reset()}render(){const{orientation:e,state:t}=this.viewModel,r=t==="disabled",n=(t==="rotation"?"rotation":"compass")=="compass",s=r?-1:0,a={[Yd.disabled]:r,[Yd.interactive]:!r},o={[Yd.northIcon]:n,[Yd.rotationIcon]:!n},{messages:l}=this;return N("div",{bind:this,class:this.classes(Yd.base,a),onclick:this._reset,onkeydown:this._reset,role:"button",tabIndex:s,"aria-label":l.reset,title:l.reset},N("span",{"aria-hidden":"true",class:this.classes(Yd.icon,o),styles:this._toRotationTransform(e)}),N("span",{class:Yd.text},l.reset))}_reset(){this.viewModel.reset()}_toRotationTransform(e){return{transform:`rotateZ(${e.z}deg)`}}};h([p()],_h.prototype,"goToOverride",null),h([p()],_h.prototype,"iconClass",void 0),h([p()],_h.prototype,"label",null),h([p(),_n("esri/widgets/Compass/t9n/Compass")],_h.prototype,"messages",void 0),h([p()],_h.prototype,"view",null),h([p({type:wX})],_h.prototype,"viewModel",void 0),h([Uo()],_h.prototype,"_reset",null),_h=h([F("esri.widgets.Compass")],_h);const bfe=_h;let yy=class extends pe{constructor(e){super(e),this.navigationMode="pan",this.view=null}initialize(){this.own(cs(()=>{var e;return(e=this.view)==null?void 0:e.inputManager},()=>this._setNavigationMode()))}destroy(){this.view=null}get state(){return this.get("view.ready")&&this.view.type==="3d"?"ready":"disabled"}toggle(){this.state!=="disabled"&&(this.navigationMode=this.navigationMode!=="pan"?"pan":"rotate",this._setNavigationMode())}_setNavigationMode(){this.get("view.inputManager").primaryDragAction=this.navigationMode==="pan"?"pan":"rotate"}};h([p({readOnly:!0})],yy.prototype,"state",null),h([p()],yy.prototype,"navigationMode",void 0),h([p()],yy.prototype,"view",void 0),yy=h([F("esri.widgets.NavigationToggleViewModel")],yy);const xX=yy,hl={base:"esri-navigation-toggle esri-widget",button:"esri-navigation-toggle__button esri-widget--button",activeButton:"esri-navigation-toggle__button--active",panButton:"esri-navigation-toggle__button--pan",rotateButton:"esri-navigation-toggle__button--rotate",isLayoutHorizontal:"esri-navigation-toggle--horizontal",rotationIcon:"esri-icon-rotate",panIcon:"esri-icon-pan",widgetIcon:"esri-icon-pan2",disabled:"esri-disabled"};let yh=class extends Hn{constructor(e,t){super(e,t),this.iconClass=hl.widgetIcon,this.messages=null,this.viewModel=new xX}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}toggle(){return this.viewModel.toggle()}render(){const e=this.get("viewModel.state")==="disabled",t=this.get("viewModel.navigationMode")==="pan",r={[hl.disabled]:e,[hl.isLayoutHorizontal]:this.layout==="horizontal"},n={[hl.activeButton]:t},s={[hl.activeButton]:!t},a=e?-1:0,o=this.messages.toggle;return N("div",{bind:this,class:this.classes(hl.base,r),onclick:this._toggle,onkeydown:this._toggle,tabIndex:a,"aria-label":o,title:o},N("div",{class:this.classes(hl.button,hl.panButton,n)},N("span",{class:hl.panIcon})),N("div",{class:this.classes(hl.button,hl.rotateButton,s)},N("span",{class:hl.rotationIcon})))}_toggle(){this.toggle()}};h([p()],yh.prototype,"iconClass",void 0),h([p()],yh.prototype,"label",null),h([p({value:"vertical"})],yh.prototype,"layout",null),h([p(),_n("esri/widgets/NavigationToggle/t9n/NavigationToggle")],yh.prototype,"messages",void 0),h([p()],yh.prototype,"view",null),h([p({type:xX})],yh.prototype,"viewModel",void 0),h([Uo()],yh.prototype,"_toggle",null),yh=h([F("esri.widgets.NavigationToggle")],yh);const wfe=yh,r1={button:"esri-widget--button esri-widget",disabled:"esri-disabled",interactive:"esri-interactive",iconText:"esri-icon-font-fallback-text",icon:"esri-icon"};let Sp=class extends Hn{constructor(){super(...arguments),this.enabled=!0,this.iconClass="",this.title=""}render(){const e=this.enabled?0:-1,t={[r1.disabled]:!this.enabled,[r1.interactive]:this.enabled},r={[this.iconClass]:!!this.iconClass};return N("div",{bind:this,class:this.classes(r1.button,t),onclick:this._triggerAction,onkeydown:this._triggerAction,role:"button",tabIndex:e,title:this.title},N("span",{"aria-hidden":"true",role:"presentation",class:this.classes(r1.icon,r)}),N("span",{class:r1.iconText},this.title))}_triggerAction(){this.action.call(this)}};h([p()],Sp.prototype,"action",void 0),h([p()],Sp.prototype,"enabled",void 0),h([p()],Sp.prototype,"iconClass",void 0),h([p()],Sp.prototype,"title",void 0),h([Uo()],Sp.prototype,"_triggerAction",null),Sp=h([F("esri.widgets.IconButton")],Sp);const BV=Sp;let vy=class extends pe{get canZoomIn(){if(!this.get("view.ready"))return!1;const e=this.get("view.animation.target.scale")||this.get("view.scale"),t=this.get("view.constraints.effectiveMaxScale");return t===0||e>t}get canZoomOut(){if(!this.get("view.ready"))return!1;const e=this.get("view.animation.target.scale")||this.get("view.scale"),t=this.get("view.constraints.effectiveMinScale");return t===0||e<t}};h([p({readOnly:!0})],vy.prototype,"canZoomIn",null),h([p({readOnly:!0})],vy.prototype,"canZoomOut",null),h([p()],vy.prototype,"view",void 0),vy=h([F("esri.widgets.Zoom.ZoomConditions2D")],vy);const xfe=vy;let by=class extends pe{get canZoomIn(){return!!this.view.ready}get canZoomOut(){return!!this.view.ready}};h([p({readOnly:!0})],by.prototype,"canZoomIn",null),h([p({readOnly:!0})],by.prototype,"canZoomOut",null),h([p()],by.prototype,"view",void 0),by=h([F("esri.widgets.Zoom.ZoomConditions3D")],by);const Tfe=by;let Ep=class extends pe{constructor(e){super(e)}destroy(){this.view=null}get canZoomIn(){return y(this._zoomConditions)&&this._zoomConditions.canZoomIn}get canZoomOut(){var e;return y(this._zoomConditions)&&((e=this._zoomConditions)==null?void 0:e.canZoomOut)}get state(){var e;return(e=this.view)!=null&&e.ready?"ready":"disabled"}set view(e){e?e.type==="2d"?this._zoomConditions=new xfe({view:e}):e.type==="3d"&&(this._zoomConditions=new Tfe({view:e})):this._zoomConditions=null,this._set("view",e)}zoomIn(){if(!this.canZoomIn)return;const e=this.view;e.type==="2d"?e.mapViewNavigation.zoomIn():Ib(e.goTo({zoomFactor:2}))}zoomOut(){if(!this.canZoomOut)return;const e=this.view;e.type==="2d"?e.mapViewNavigation.zoomOut():Ib(e.goTo({zoomFactor:.5}))}};h([p()],Ep.prototype,"_zoomConditions",void 0),h([p()],Ep.prototype,"canZoomIn",null),h([p()],Ep.prototype,"canZoomOut",null),h([p({readOnly:!0})],Ep.prototype,"state",null),h([p()],Ep.prototype,"view",null),Ep=h([F("esri.widgets.Zoom.ZoomViewModel")],Ep);const TX=Ep,n1={base:"esri-zoom esri-widget",horizontalLayout:"esri-zoom--horizontal",zoomInIcon:"esri-icon-plus",zoomOutIcon:"esri-icon-minus",widgetIcon:"esri-icon-zoom-in-magnifying-glass"};let Fu=class extends Hn{constructor(e,t){super(e,t),this.iconClass=n1.widgetIcon,this.messages=null,this.viewModel=new TX}initialize(){this._zoomInButton=new BV({action:this.zoomIn.bind(this),iconClass:n1.zoomInIcon}),this._zoomOutButton=new BV({action:this.zoomOut.bind(this),iconClass:n1.zoomOutIcon})}destroy(){this._zoomInButton=Oe(this._zoomInButton),this._zoomOutButton=Oe(this._zoomOutButton)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}set view(e){this.viewModel.view=e}get view(){return this.viewModel.view}render(){const e=this.viewModel,t={[n1.horizontalLayout]:this.layout==="horizontal"},{canZoomIn:r,canZoomOut:n}=e;this._zoomInButton.enabled=r,this._zoomOutButton.enabled=n;const{zoomIn:s,zoomOut:a}=this.messages;return this._zoomInButton.title=s,this._zoomOutButton.title=a,N("div",{class:this.classes(n1.base,t)},this._zoomInButton.render(),this._zoomOutButton.render())}zoomIn(){return this.viewModel.zoomIn()}zoomOut(){return this.viewModel.zoomOut()}};h([p()],Fu.prototype,"iconClass",void 0),h([p()],Fu.prototype,"label",null),h([p({value:"vertical"})],Fu.prototype,"layout",null),h([p(),_n("esri/widgets/Zoom/t9n/Zoom")],Fu.prototype,"messages",void 0),h([p()],Fu.prototype,"view",null),h([p({type:TX})],Fu.prototype,"viewModel",void 0),Fu=h([F("esri.widgets.Zoom")],Fu);const Cfe=Fu;function Sfe(i){return i&&i.view!==void 0}let JS=class extends ffe{constructor(e){super(e),this._defaultPositionLookup={attribution:"manual",compass:"top-left","navigation-toggle":"top-left",zoom:"top-left"},this.components=[]}initialize(){this._handles.add([B(()=>this.components,this._componentsWatcher.bind(this),et),B(()=>this.view,this._updateViewAwareWidgets.bind(this),et)])}_add(e,t,r,n){if(typeof e=="string"&&this._defaultPositionLookup[e]){if(this._find(e))return;e=this._createComponent(e)}super._add(e,t,r,n)}_removeComponents(e){e.forEach(t=>{const r=this._find(t);r&&(this.remove(r),r.destroy())})}_updateViewAwareWidgets(e){this.components.forEach(t=>{const r=this._find(t),n=r&&r.widget;Sfe(n)&&(n.view=e)})}_componentsWatcher(e,t){this._removeComponents(t),this._addComponents(e),this._adjustPadding(e)}_adjustPadding(e){if(!e.includes("attribution")&&!this._isOverridden("padding")){const{top:t}=this.padding;this.padding=t}}_addComponents(e){this.constructed&&e.forEach(t=>this.add(this._createComponent(t),this._defaultPositionLookup[t]))}_createComponent(e){const t=this._createWidget(e);if(t)return new KS({id:e,node:t})}_createWidget(e){return e==="attribution"?this._createAttribution():e==="compass"?this._createCompass():e==="navigation-toggle"?this._createNavigationToggle():e==="zoom"?this._createZoom():void 0}_createAttribution(){return new yfe({view:this.view})}_createCompass(){return new bfe({view:this.view})}_createNavigationToggle(){return new wfe({view:this.view})}_createZoom(){return new Cfe({view:this.view})}};h([p()],JS.prototype,"components",void 0),JS=h([F("esri.views.ui.DefaultUI")],JS);const CX=JS;let eE=class extends CX{constructor(e){super(e),this.components=["attribution","zoom"]}};h([p()],eE.prototype,"components",void 0),eE=h([F("esri.views.ui.2d.DefaultUI2D")],eE);const SX=eE;var d3;let tE=d3=class extends xt{constructor(i){super(i),this.color=new ti([0,0,0,1])}clone(){return new d3(Pr({color:this.color}))}};h([p({type:ti,json:{write:!0}})],tE.prototype,"color",void 0),tE=d3=h([F("esri.webmap.background.ColorBackground")],tE);const bP=tE;let EX,RX,PX,AX,OX,MX;async function Efe(){const[,{GraphicsView2D:i,GraphicContainer:e,LabelManager:t,MapViewNavigation:r,MagnifierView2D:n,Stage:s}]=await Promise.all([j(()=>import("./webglDeps-c0ee13fe.js"),["assets/webglDeps-c0ee13fe.js","assets/FramebufferObject-a3b9c52c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/typedArrayUtil-4d7bb04c.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/context-util-a4ce3a7b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/Evented-a45c8b0f.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/VertexElementDescriptor-2925c6af.js","assets/ShaderCompiler-77d0dcb6.js","assets/programUtils-f035fe8a.js","assets/ProgramTemplate-cc7f8b69.js","assets/preload-helper-3bce6601.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/vec2-528adfe4.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),j(()=>import("./mapViewDeps-f66618ba.js"),["assets/mapViewDeps-f66618ba.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/typedArrayUtil-4d7bb04c.js","assets/promiseUtils-1e54421e.js","assets/reactiveUtils-4dabbb80.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/mat3f32-d3d088e8.js","assets/Rasterizer-dce80cb8.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/_commonjsHelpers-a430e9ea.js","assets/imageutils-c0676a73.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/cimAnalyzer-38842966.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/arcadeOnDemand-281a01eb.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-193543b5.js","assets/jsonUtils-229211af.js","assets/enums-2658a65c.js","assets/alignmentUtils-ae955d28.js","assets/mat2d-2bbb5feb.js","assets/vec2-528adfe4.js","assets/vec2f32-461e65a9.js","assets/number-954e4ab6.js","assets/Rect-ea14f53a.js","assets/callExpressionWithFeature-55effb7b.js","assets/quantizationUtils-4dd81f85.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-9ad35d39.js","assets/rasterizingUtils-ec11e94c.js","assets/utils-317368cb.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/Evented-a45c8b0f.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/enums-4ca4641f.js","assets/MaterialKey-0093a242.js","assets/Utils-69cc114d.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/BufferPool-b74ae6cb.js","assets/WGLContainer-8a3733a0.js","assets/WGLBrushVTLSymbol-d778c554.js","assets/FramebufferObject-a3b9c52c.js","assets/StyleDefinition-ff072275.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/pixelUtils-d9cd2e49.js","assets/ShaderCompiler-77d0dcb6.js","assets/ProgramTemplate-cc7f8b69.js","assets/heatmapTextureUtils-2627384f.js","assets/earcut-58237617.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/VTLMaterialManager-2c63b5e3.js","assets/enums-0fc02184.js","assets/programUtils-f035fe8a.js","assets/MaterialPrograms-b885dd99.js","assets/pbf-0e99a620.js","assets/Matcher-f2620e9f.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/Queue-b7d3cd48.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/enumeration-3a03bd31.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Clonable-545593ce.js","assets/visualVariablesUtils-0d4b5279.js","assets/visualVariablesUtils-ecd70012.js","assets/tileUtils-55e656c2.js","assets/TileClipper-4637f47d.js","assets/assets-8d3e737a.js","assets/Geometry-daada628.js","assets/defaultsJSON-59981e75.js","assets/LRUCache-64ec42ee.js","assets/MemCache-18a255ed.js","assets/ExpandedCIM-b7ed8ce5.js","assets/devEnvironmentUtils-5002a058.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/locale-30120714.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/persistableUrlUtils-5f719c3b.js","assets/styleUtils-22b14a8b.js","assets/CircularArray-f4b6cd92.js","assets/MeshComponent-a43522cc.js","assets/deduplicate-03981d62.js","assets/HandleOwner-9b396af1.js","assets/FeatureSetReader-7e79a15e.js","assets/centroid-5c988df3.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/sizeVariableUtils-d4870b0d.js","assets/BaseGraphicContainer-76f5ab54.js","assets/projectionSupport-aa5eaa0d.js","assets/projection-290b739f.js","assets/SimpleObservable-23231131.js","assets/zscale-89472cba.js","assets/json-48e3ea08.js","assets/labelingInfo-607e66b8.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/fieldUtils-7f54c4b1.js","assets/Symbol-f93ed9fd.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/Collection-910b6f71.js","assets/collectionUtils-803d9ba8.js","assets/labelUtils-3108e8d7.js","assets/jsonUtils-0ff4ff96.js","assets/FeatureContainer-934cc4cc.js","assets/TileContainer-21007653.js","assets/capabilities-302cf20d.js","assets/schemaUtils-9c08f5e8.js","assets/LayerFloorInfo-54b916a2.js","assets/diffUtils-68b89c71.js","assets/createSymbolSchema-36503ad8.js","assets/rendererUtils-0bcb63a1.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/PopupTemplate-40f3c9aa.js","assets/number-27cf8195.js","assets/Identifiable-bfe1ff30.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/colorRamps-9dac42c1.js","assets/Graphic-f0e54e86.js","assets/compilerUtils-18d58939.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/deprecate-035b199e.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/util-4239daf3.js","assets/ComputedAttributeStorage-2b4316ba.js","assets/FieldsIndex-f104cc5f.js","assets/normalizeUtils-27e29a72.js","assets/GraphicsView-d3b9d029.js","assets/vec3f32-c9aa289f.js","assets/GraphicContainer-ce27fa6a.js","assets/asyncUtils-437defc4.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/RelationshipQuery-0dda77ad.js","assets/utils-6786b611.js","assets/ItemCache-fd3aceaf.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/dehydratedFeatures-0557137d.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/SnappingCandidate-970faec6.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])]);RX=i,PX=e,AX=t,OX=r,MX=n,EX=s}const GV=160;function Rfe(i){return i&&i.declaredClass==="esri.Viewpoint"}let lt=class extends sW(OW(MW(qW))){constructor(e){super(e),this._magnifierView=null,this._stage=null,this._resolveWhenReady=[],this.rootLayerViews=new yw({getCollections:()=>{var t,r;return[(t=this.basemapView)==null?void 0:t.baseLayerViews,this.layerViews,(r=this.basemapView)==null?void 0:r.referenceLayerViews]},getChildrenFunction:()=>null}),this.featuresTilingScheme=null,this.fullOpacity=1,this.graphicsView=null,this.labelManager=null,this.mapViewNavigation=null,this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.rendering=!1,this.supersampleScreenshotsEnabled=!1,this.supportsGround=!1,this._stationaryTimer=null,this.frameTask=new hme(this),this._pePromise=null,this.floors=new wt,this.highlightOptions=new uX,this.inputManager=new Bme({view:this}),this.map=null,this.resizeAlign="center",this.spatialReferenceLocked=!1,this.timeline=new dX,this.type="2d",this.ui=new SX,this._pixelFormat={flipY:!0,premultipliedAlpha:!0},this.constraints=new rX,this.padding={top:0,right:0,bottom:0,left:0},this.handles.add([B(()=>this.viewpoint,()=>{this._lastStationaryEventTimestamp=performance.now(),this._flipStationary(GV)},ni),this.on("resize",t=>this._resizeHandler(t)),B(()=>{var t;return(t=this.animationManager)==null?void 0:t.animation},t=>{this.animation=t})]),Q7()}destroy(){this._set("preconditionsReady",!1),this._gotoTask=this.frameTask=null,this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null)}get graphicsTileStore(){return new xre(this.featuresTilingScheme)}get initialExtentRequired(){var o;const{scale:e,constraints:t,center:r,viewpoint:n,extent:s}=this;let a=this.zoom;return!(this.map&&"initialViewProperties"in this.map&&((o=this.map.initialViewProperties)!=null&&o.viewpoint))&&!s&&(t!=null&&t.effectiveLODs||(a=-1),(!r||e===0&&a===-1)&&(!n||!y(n.targetGeometry)||n.targetGeometry.type!=="extent"&&!n.scale))}get resourceManager(){return this._stage.resourceManager}get textureManager(){return this._stage.painter.textureManager}get _defaultsFromMapSettings(){return{required:{tileInfo:!0,heightModelInfo:!1,extent:!1},requiresExtentInSpatialReference:this.spatialReferenceLocked}}get _projectionEngineLoaded(){return!!vw()||(this._pePromise||(this._pePromise=PR().finally(()=>{this._pePromise=null})),!1)}get typeSpecificPreconditionsReady(){const e=this._getDefaultViewpoint();if(!e)return!1;const t=this.spatialReference,r=ft(e.targetGeometry);return!!gv(r.spatialReference,t)||this._projectionEngineLoaded}set animation(e){const t=this._get("animation");if(e===t)return;if(t&&t.stop(),!e||e.isFulfilled())return void this._set("animation",null);this._set("animation",e),this.frameTask.animationInProgress=!0;const r=()=>{var n;e===this._get("animation")&&(this._set("animation",null),(n=this.frameTask)==null||n.requestFrame()),this.frameTask&&(this.frameTask.animationInProgress=!1)};e.when(r,r)}get background(){return Pfe(this.map)?this.map.initialViewProperties.background:null}set background(e){this._override("background",e)}get center(){if(!this.ready)return this._get("center");const{center:e,spatialReference:t}=this.state.paddedViewState;return new He({x:e[0],y:e[1],spatialReference:t})}set center(e){if(e==null)return;if(!this.ready)return this._set("center",e),void this.notifyChange("initialExtentRequired");let t;try{t=this._project(e,this.spatialReference)}catch(n){return void ee.getLogger(this.declaredClass).error(new J("mapview:invalid-center","could not project the value in the view's spatial reference",{input:e,error:n}))}const r=this.viewpoint;r3(r,r,t),this.viewpoint=r}set constraints(e){const t=this._get("constraints");t&&(this.handles.remove("map-view-constraints"),t.destroy()),this._set("constraints",e),e&&(e.view=this,this.ready&&(this.state.viewpoint=e.fit(this.state.paddedViewState.viewpoint)),this.handles.add(B(()=>e.version,()=>{this.ready&&this.state&&(this.state.viewpoint=e.fit(this.state.paddedViewState.viewpoint))},ni),"map-view-constraints"))}get extent(){return this.ready?this.state.paddedViewState.extent.clone():this._get("extent")}set extent(e){if(e==null)return;if(!e.width||!e.height)return void ee.getLogger(this.declaredClass).error(new J("mapview:invalid-extent","invalid extent size"));if(!this.ready)return this._set("extent",e),this._set("center",null),this._set("viewpoint",null),this._set("scale",0),this._set("zoom",-1),void this.notifyChange("initialExtentRequired");let t;try{t=this._project(e,this.spatialReference)}catch(n){return void ee.getLogger(this.declaredClass).error(new J("mapview:invalid-extent","could not project the value in the view's spatial reference",{error:n}))}const r=this.viewpoint;Xpe(r,r,t,this.size,{constraints:this.constraints}),this.viewpoint=r}get padding(){return this.ready?this.state.padding:this._get("padding")}set padding(e){this.ready?(this.state.padding=e,this._set("padding",this.state.padding)):this._set("padding",e)}get resolution(){return this.state?this.state.resolution:0}get rotation(){return this.ready?this.state.rotation:this._get("rotation")}set rotation(e){if(isNaN(e))return;if(!this.ready)return void this._set("rotation",e);const t=this.viewpoint;ame(t,t,e),this.viewpoint=t}get scale(){return this.ready?this.state.scale:this._get("scale")}set scale(e){if(!e||isNaN(e))return;if(!this.ready){this._set("scale",e),this._set("zoom",-1);const r=this._get("extent");return r&&(this._set("extent",null),this._set("center",r.center)),void this.notifyChange("initialExtentRequired")}const t=this.viewpoint;AV(t,t,e),this.viewpoint=t}get stationary(){return!(this.animation||this.navigating||this.resizing||this._stationaryTimer)}get updating(){var t,r,n;const e=!this.destroyed&&(!this.layerViewManager||!this.labelManager||!this.graphicsView||this.layerViewManager.updating===!0||this.labelManager.updating===!0||this.graphicsView.updating===!0||this.allLayerViews.some(s=>!s.destroyed&&!("layerViews"in s)&&s.updating===!0));if(Ot("esri-2d-log-updating")){const s=this.allLayerViews.reduce((a,o)=>({...a,[o.layer.id]:!o.destroyed&&!("layerViews"in o)&&o.updating}),{});console.log(`Updating MapView: ${e}
-> Null LayerViewManager: ${!this.layerViewManager}
-> Null LabelManager: ${!this.labelManager}
-> Null GraphicsView: ${!this.graphicsView}
-> layerViewManager.updating: ${(t=this.layerViewManager)==null?void 0:t.updating}
-> labelManager.updating: ${(r=this.labelManager)==null?void 0:r.updating}
-> graphicsView.updating: ${(n=this.graphicsView)==null?void 0:n.updating}
-> allLayerViews: ${JSON.stringify(s)}
`)}return e}get viewpoint(){if(!this.ready)return this._get("viewpoint");const e=this.state.paddedViewState;return e&&e.viewpoint.clone()}set viewpoint(e){if(e==null)return;if(!this.ready)return this._set("viewpoint",e),this._set("extent",null),this._set("center",null),this._set("zoom",-1),this._set("scale",0),void this.notifyChange("initialExtentRequired");let t,r;try{t=this._project(e,this.spatialReference),!e.scale||isNaN(e.scale)?r=new J("mapview:invalid-viewpoint",`invalid scale value of ${e.scale}`):C(e.targetGeometry)&&(r=new J("mapview:invalid-viewpoint","geometry not defined"))}catch(s){r=new J("mapview:invalid-viewpoint","could not project the value in the view's spatial reference",{error:s})}if(r)return void ee.getLogger(this.declaredClass).error(r);this._scaleBeforeChangingSpatialReference=null;const n=new rr({targetGeometry:new He,scale:0,rotation:0});Xc(n,t),this.constraints.constrain(n,this.state.paddedViewState.viewpoint),this.state.viewpoint=n,this.frameTask.requestFrame(),this._set("viewpoint",n)}get zoom(){return this.ready?this.constraints.scaleToZoom(this.scale):this._get("zoom")}set zoom(e){if(e==null)return;if(!this.ready){this._set("zoom",e),this._set("scale",0);const r=this._get("extent");return r&&(this._set("extent",null),this._set("center",r.center)),void this.notifyChange("initialExtentRequired")}if(!this.constraints.effectiveLODs)return void this._set("zoom",-1);const t=this.viewpoint;AV(t,t,this.constraints.zoomToScale(e)),this.viewpoint=t,this._set("zoom",this.constraints.scaleToZoom(this.scale))}get navigating(){return!(!this.mapViewNavigation||!this.mapViewNavigation.interacting)}goTo(e,t){if(e)return this.animation&&(this.animation=null),this._createAnimation(),Pm(()=>this.ready,t).then(()=>{const r={animate:!0,...t},n=jpe(e,this);return this.animation.update(n),this._gotoTask={},r.animate?this._gotoAnimated(n,r):this._gotoImmediate(n,r)});ee.getLogger(this.declaredClass).error("#goTo()","target cannot be null or undefined")}async hitTest(e,t){const r=L2(e)?I2(this,e):e;if(!this.ready||isNaN(r.x)||isNaN(r.y))return{screenPoint:r,results:[]};let n=new Set,s=!1,a=null,o=null;t!=null&&t.include?jV(t.include,HV(this,d=>n.add(d),d=>{a||(a=new Set),a.add(d)},d=>n.add(d),()=>s=!0)):(s=!0,n=new Set(this.allLayerViews)),t!=null&&t.exclude&&jV(t.exclude,HV(this,d=>n.delete(d),d=>{o||(o=new Set),o.add(d)}));const l=this.allLayerViews.filter(d=>!d.suspended&&n.has(d)).reverse(),c=this.toMap(r);let u=[...s?this.graphicsView.hitTest(c).map(d=>({type:"graphic",graphic:d,layer:null,mapPoint:c})):[],...await Promise.all(l.map(d=>d.hitTest(c,r)).toArray())].filter(y).flat().filter(y);return a&&(u=u.filter(d=>!("graphic"in d)||!d.graphic||a.has(p3(d.graphic)))),o&&(u=u.filter(d=>!("graphic"in d)||!d.graphic||o.has(p3(d.graphic)))),{screenPoint:r,results:u}}async takeScreenshot(e){const t=this._createScreenshotPlan(e),r=await this._stage.takeScreenshot(t);return YS(r,{format:t.format,quality:t.quality,rotation:0,disableDecorations:!1},this._pixelFormat)}async _takeScreenshot(e){const t=this._createScreenshotPlan(e),r=await this._stage.takeScreenshot(t);return pX(r,this._pixelFormat)}_createScreenshotPlan(e){e=e||{};const t=this.supersampleScreenshotsEnabled?Math.min(4,Jme(this.size,Math.min(4096,this._stage.context.parameters.maxTextureSize))):1;let r;e.layers?(r=[],e.layers.forEach(a=>{const o=this.allLayerViews.find(l=>l.layer.id===a.id);o&&"container"in o&&o.container&&r.push(o.container)})):r=this._stage.children;const{format:n,quality:s}=Kme(e.format,e.quality);return jme(e,t,this.size,this.padding,n,s,r,e.rotation)}get test(){return{takeScreenshot:e=>this._takeScreenshot(e)}}toMap(e){if(!this.ready)return null;const t=L2(e)?I2(this,e):e,r=[0,0],[n,s]=this.state.toMap(r,[t.x,t.y]),a=this.spatialReference;return new He({x:n,y:s,spatialReference:a})}toScreen(e){if(!this.ready)return null;const t=this._project(e,this.spatialReference),r=[t.x,t.y];return this.state.toScreen(r,r),Rs(r[0],r[1])}on(e,t,r,n){return this.inputManager&&this.viewEvents.on(e,t,r,n)||super.on(e,t)}hasEventListener(e){return super.hasEventListener(e)||this.viewEvents.hasHandler(e)}whenLayerView(e){return super.whenLayerView(e)}graphicChanged(e){this.graphicsView&&this.graphicsView.graphicUpdateHandler(e)}whenReady(){return new Promise(e=>{this.ready?e(this):this._resolveWhenReady.push(e)})}forceDOMReadyCycle(){this.forceReadyCycle()}getDefaultSpatialReference(){var e,t,r;return this.map&&"initialViewProperties"in this.map&&((t=(e=this.map)==null?void 0:e.initialViewProperties)==null?void 0:t.spatialReference)||((r=this.defaultsFromMap)==null?void 0:r.spatialReference)||null}hasLayerViewModule(e){return MV.hasLayerViewModule(e)}importLayerView(e){return MV.importLayerView(e)}pixelSizeAt(){return this.ready?this.state.resolution:(ee.getLogger(this.declaredClass).error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}popupHitTest(e){return this.hitTest(e).then(t=>({...t,mapPoint:this.toMap(e)}))}requestUpdate(){this.ready&&this.frameTask.requestUpdate()}validate(){let e=yX(this.type);return Ot("safari")&&Ot("safari")<9&&(e=new J("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:Ot("safari")})),y(e)?(ee.getLogger(this.declaredClass).warn("#validate()",e.message),Promise.reject(e)):Efe()}_createAnimation(){return this.animation&&!this.animation.done||(this.animation=new Md),this.animation}_cancellableGoTo(e,t,r){const n=()=>e===this._gotoTask,s=r.then(()=>{n()&&(this.animation=null)}).catch(o=>{throw n()&&(this.animation=null,t.done||(t.stop(),this.frameTask.animationInProgress=!1)),o}),a=new Promise(o=>o(s));return t.when().catch(()=>{n()&&a.cancel&&a.cancel()}),a}_gotoImmediate(e,t){const r=this._gotoTask,n=this.animation,s=e.then(a=>{if(Ti(t),r!==this._gotoTask)throw new J("view:goto-interrupted","Goto was interrupted");this.viewpoint=n.target=a,n.finish()});return this._cancellableGoTo(r,n,s)}_flipStationary(e){return this._stationaryTimer!==null||(this._stationaryTimer=setTimeout(()=>{this._stationaryTimer=null;const t=performance.now()-this._lastStationaryEventTimestamp;t<GV&&(this._stationaryTimer=this._flipStationary(t))},e)),this._stationaryTimer}_getDefaultViewpoint(){var v,b,x,T;const{constraints:e,initialExtent:t,map:r,padding:n,size:s}=this;if(!e)return null;const a=r&&"initialViewProperties"in r&&r.initialViewProperties,o={zoom:this._get("zoom"),scale:this._get("scale"),center:this._get("center"),extent:this._get("extent"),rotation:this._get("rotation"),viewpoint:this._get("viewpoint"),spatialReference:this._userSpatialReference};e.effectiveLODs?o.zoom!==-1&&(o.scale=e.zoomToScale(o.zoom)):o.zoom=-1;let l=null,c=null,u=0;const d=o.viewpoint&&o.viewpoint.rotation,m=o.viewpoint&&o.viewpoint.targetGeometry;y(m)&&(m.type==="extent"?l=m:m.type==="point"&&(c=m,u=o.viewpoint.scale));const f=o.extent||l||((b=ft((v=a==null?void 0:a.viewpoint)==null?void 0:v.targetGeometry))==null?void 0:b.extent)||t,_=o.center||c||(f==null?void 0:f.center),g=o.scale||u||((x=a==null?void 0:a.viewpoint)==null?void 0:x.scale)||f&&Qb(f,[s[0]-n.left-n.right,s[1]-n.top-n.bottom]),w=o.rotation||d||((T=a==null?void 0:a.viewpoint)==null?void 0:T.rotation)||0;return _&&g?new rr({targetGeometry:_,scale:g,rotation:w}):null}_gotoAnimated(e,t){const r=this._gotoTask,n=this.animation,s=e.then(a=>{if(Ti(t),r!==this._gotoTask)throw new J("view:goto-interrupted","Goto was interrupted");return n.update(a),this.animationManager.animate(n,this.viewpoint,t),n.when().then(()=>{},()=>{})});return this._cancellableGoTo(r,n,s)}_project(e,t){var s;const r=e&&e.targetGeometry||e;if(!t)return e;if(!r)return null;if(t.imageCoordinateSystem||(s=r.spatialReference)!=null&&s.imageCoordinateSystem||Gm(t,r.spatialReference))return e;const n=Dd(r,t);if(!n)throw new J("mapview:projection-not-possible","projecting input geometry to target spatial reference returned a null value",{geometry:r,spatialReference:t});return Rfe(e)?(e.targetGeometry=n,e):n}_resizeHandler(e){if(!this.ready)return;const t=this.state;let r=this.state.paddedViewState.viewpoint;const n=this.state.paddedViewState.size.concat();t.size=[e.width,e.height],sme(r,r,n,this.state.paddedViewState.size,this.resizeAlign),r=this.constraints.constrain(r,null),this.state.viewpoint=r}_startup(){var l,c;this.timeline.begin("MapView Startup");const e=this._getDefaultViewpoint(),t=e.targetGeometry;try{this._project(e,this.spatialReference)}catch(u){ee.getLogger(this.declaredClass).warn(new w5("mapview:startup-projection-error","projection of initial viewpoint to the view's spatial reference, defaulting to the initial viewpoint.",{center:t.toJSON(),spatialReference:this.spatialReference,error:u})),e.targetGeometry=((l=this.defaultsFromMap.extent)==null?void 0:l.center)||new He({x:0,y:0,spatialReference:this.spatialReference})}(c=this.constraints)==null||c.fit(e),this._set("state",new gme({padding:this._get("padding"),size:this.size,viewpoint:e})),this.graphics.owner=this;const r=new EX(this.surface,{canvas:this.renderCanvas,supersampleScreenshots:this.supersampleScreenshotsEnabled,contextOptions:{disabledExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions},renderingOptions:this.renderingOptions,timeline:this.timeline});this._stage=r,this._magnifierView=new MX,this._magnifierView.magnifier=this.magnifier;const n=new AX({view:this});this._set("labelManager",n);const s=new cme({view:this});this._set("animationManager",s);const a=new OX({view:this,animationManager:s});this._set("mapViewNavigation",a),this._setupSpatialReferenceDependentProperties(),this.handles.add([this.rootLayerViews.on("change",()=>this._updateStageChildren()),r.on("post-render",()=>this._set("rendering",r.renderRequested)),r.on("will-render",()=>this._set("rendering",r.renderRequested)),r.on("webgl-error",u=>this.fatalError=u.error),B(()=>this.stationary,u=>r.stationary=u,Mi),B(()=>this.background,u=>{r.background=u,this._magnifierView.background=u},Mi),B(()=>this.magnifier,u=>this._magnifierView.magnifier=u,Mi),B(()=>this.renderingOptions,u=>r.renderingOptions=u,Mi),B(()=>this.highlightOptions,u=>r.highlightOptions=u,Mi),B(()=>this.state.id,()=>r.state=this.state,Mi)],"map-view"),this._updateStageChildren();const o=this._resolveWhenReady;this._resolveWhenReady=[],o.forEach(u=>u(this)),this.timeline.end("MapView Startup"),this.frameTask&&this.frameTask.start(),this._set("ready",!0)}_teardown(){this._destroySpatialReferenceDependentProperties(),this.handles.remove("map-view"),this.mapViewNavigation.destroy(),this._set("mapViewNavigation",null),this.animationManager.destroy(),this._set("animationManager",null),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this._stage.destroy(),this._stage=null,this._set("graphicsView",null),this._magnifierView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,this.frameTask&&this.frameTask.stop(),this._stationaryTimer&&(clearTimeout(this._stationaryTimer),this._stationaryTimer=null),this._set("ready",!1);const{center:[e,t],spatialReference:r,rotation:n,scale:s}=this.state.paddedViewState,a=new He({x:e,y:t,spatialReference:r});this._set("viewpoint",null),this._set("extent",null),this._set("center",a),this._set("zoom",-1),this._set("rotation",n),this._set("scale",s),this._set("spatialReference",r),this._set("state",null),this.animation=null}_updateStageChildren(){this._stage.removeAllChildren(),this.rootLayerViews.forEach(t=>{this._stage.addChild(t.container)});const e=this.graphicsView;this._stage.addChild(e.container),this._stage.addChild(this._magnifierView)}_setupSpatialReferenceDependentProperties(){const e=new Tre(Lb.create({spatialReference:this.spatialReference,size:512,numLODs:36}));this._set("featuresTilingScheme",e);const t=new RX({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new PX(e)});this.frameTask.graphicsView=t,this._set("graphicsView",t)}_destroySpatialReferenceDependentProperties(){const e=this.graphicsView;this._set("graphicsView",null),this.frameTask.graphicsView=null,e.destroy(),this._set("featuresTilingScheme",null)}_spatialReferenceChanged(e){if(!this.ready)return;this.frameTask.stop();for(const l of this.allLayerViews)l.processDetach();this._destroySpatialReferenceDependentProperties();const t=this.state.paddedViewState.clone();if(C(this._scaleBeforeChangingSpatialReference))this._scaleBeforeChangingSpatialReference=t.scale;else{const l=t.viewpoint.clone();l.scale=this._scaleBeforeChangingSpatialReference,t.viewpoint=l}const r=t.clone(),[n,s]=t.center;let a=null;try{a=this._project(new He({x:n,y:s,spatialReference:t.spatialReference}),e)}catch(l){vw()||ee.getLogger(this.declaredClass).warn(new w5("mapview:spatial-reference-change","could not project the view's center to the new spatial reference",{center:a.toJSON(),spatialReference:e,error:l}))}a||(a=new He({x:0,y:0,spatialReference:e}));const o=r3(new rr({targetGeometry:new He,scale:0,rotation:0}),t.viewpoint,a);r.viewpoint=o;try{const c=[t.size[0]/2,t.size[1]/2],u=[c[0]+20,c[1]],d=t.toMap([0,0],u),{x:m,y:f}=this._project(new He({x:d[0],y:d[1],spatialReference:t.spatialReference}),e);d[0]=m,d[1]=f,r.toScreen(d,d);const _=rme(c,d,u),g=Math.hypot(d[0]-c[0],d[1]-c[1])/20;!Number.isFinite(g)||Math.abs(g)>4?(o.rotation=0,o.targetGeometry=new He({x:0,y:0,spatialReference:e})):(o.scale*=g,o.scale>Ot("mapview-srswitch-adjust-rotation-scale-threshold")?o.rotation=0:o.rotation+=Number.isFinite(_)?_:0)}catch{}this._get("constraints").constrain(o,null),this._get("state").viewpoint=o,this._stage.state=this.state,this._setupSpatialReferenceDependentProperties();for(const l of this.allLayerViews)l.processAttach();this.frameTask.requestFrame(),this.frameTask.start(),this._updateStageChildren()}};lt.type="2d",h([p({readOnly:!0})],lt.prototype,"animationManager",void 0),h([p({constructOnly:!0})],lt.prototype,"deactivatedWebGLExtensions",void 0),h([p({constructOnly:!0})],lt.prototype,"debugWebGLExtensions",void 0),h([p({readOnly:!0})],lt.prototype,"featuresTilingScheme",void 0),h([p({readOnly:!0})],lt.prototype,"fullOpacity",void 0),h([p({readOnly:!0})],lt.prototype,"graphicsTileStore",null),h([p()],lt.prototype,"graphicsView",void 0),h([p({readOnly:!0})],lt.prototype,"state",void 0),h([p()],lt.prototype,"initialExtentRequired",null),h([p()],lt.prototype,"labelManager",void 0),h([p({readOnly:!0})],lt.prototype,"resourceManager",null),h([p({readOnly:!0})],lt.prototype,"textureManager",null),h([p({readOnly:!0})],lt.prototype,"mapViewNavigation",void 0),h([p({constructOnly:!0})],lt.prototype,"renderCanvas",void 0),h([p()],lt.prototype,"renderingOptions",void 0),h([p({readOnly:!0})],lt.prototype,"rendering",void 0),h([p({constructOnly:!0})],lt.prototype,"supersampleScreenshotsEnabled",void 0),h([p({readOnly:!0})],lt.prototype,"supportsGround",void 0),h([p()],lt.prototype,"_stationaryTimer",void 0),h([p()],lt.prototype,"_defaultsFromMapSettings",null),h([p()],lt.prototype,"_pePromise",void 0),h([p({readOnly:!0})],lt.prototype,"typeSpecificPreconditionsReady",null),h([p()],lt.prototype,"animation",null),h([p({type:bP})],lt.prototype,"background",null),h([p({value:null,type:He,dependsOn:["state.id","ready"]})],lt.prototype,"center",null),h([p({type:rX})],lt.prototype,"constraints",null),h([p({value:null,type:pi,dependsOn:["state.id","ready"]})],lt.prototype,"extent",null),h([p()],lt.prototype,"floors",void 0),h([p({type:uX})],lt.prototype,"highlightOptions",void 0),h([p({readOnly:!0})],lt.prototype,"inputManager",void 0),h([p()],lt.prototype,"map",void 0),h([p({value:{top:0,right:0,bottom:0,left:0},cast:i=>({top:0,right:0,bottom:0,left:0,...i})})],lt.prototype,"padding",null),h([p()],lt.prototype,"resizeAlign",void 0),h([p({readOnly:!0,dependsOn:["state.id"]})],lt.prototype,"resolution",null),h([p({value:0,type:Number,dependsOn:["state.id","ready"]})],lt.prototype,"rotation",null),h([p({value:0,type:Number,dependsOn:["state.id","ready"]})],lt.prototype,"scale",null),h([p({constructOnly:!0})],lt.prototype,"spatialReferenceLocked",void 0),h([p()],lt.prototype,"stationary",null),h([p({type:dX,readOnly:!0})],lt.prototype,"timeline",void 0),h([p({readOnly:!0})],lt.prototype,"type",void 0),h([p({readOnly:!0})],lt.prototype,"updating",null),h([p({value:null,type:rr,dependsOn:["state.id","ready"]})],lt.prototype,"viewpoint",null),h([p({value:-1,dependsOn:["state.id","ready"]})],lt.prototype,"zoom",null),h([p({readOnly:!0})],lt.prototype,"navigating",null),h([p({type:SX})],lt.prototype,"ui",void 0),lt=h([F("esri.views.MapView")],lt);const IX=lt;function p3(i){var t,r;const e=i.getObjectId();return e?`${((t=i.layer)==null?void 0:t.uid)??((r=i.sourceLayer)==null?void 0:r.uid)??"MapView"}/${e}`:`"MapView/${i.uid}`}function HV(i,e,t,r,n){return s=>{if(s instanceof jc){if(s.layer===i)n==null||n();else{const a=i.allLayerViews.find(o=>o.layer===s.layer);a&&(r==null||r(a))}t(p3(s))}else{const a=i.allLayerViews.find(o=>o.layer===s);a&&e(a)}}}function jV(i,e){if(i)if(dI(i))for(const t of i)if(dI(t))for(const r of t)e(r);else e(t);else e(i)}function Pfe(i){return(i==null?void 0:i.declaredClass)==="esri.WebMap"}const ko=P(),wy=Or(),fO=Or(),qV=Or();function u0(i,e,t){return Y(ko,e[0],e[1],1),Nl(ko,ko,qc(wy,t)),ko[2]===0?rt(i,ko[0],ko[1]):rt(i,ko[0]/ko[2],ko[1]/ko[2])}function Afe(i,e,t){return WV(fO,e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]),WV(qV,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]),xD(i,vG(fO,fO),qV)}function WV(i,e,t,r,n,s,a,o,l){AI(i,e,r,s,t,n,a,1,1,1),Y(ko,o,l,1),vG(wy,i);const[c,u,d]=Nl(ko,ko,qc(wy,wy));return AI(wy,c,0,0,0,u,0,0,0,d),xD(i,wy,i)}let m3=class extends _te{};m3=h([F("esri.layers.support.GeoreferenceBase")],m3);const wP=m3,Ofe=Or(),Jc=Te();let Q1=class extends pe{constructor(){super(...arguments),this.sourcePoint=null,this.mapPoint=null}};h([p()],Q1.prototype,"sourcePoint",void 0),h([p({type:He})],Q1.prototype,"mapPoint",void 0),Q1=h([F("esri.layers.support.ControlPoint")],Q1);let Nu=class extends wP{constructor(e){super(e),this.controlPoints=null,this.height=0,this.type="control-points",this.width=0}get coords(){if(C(this.controlPoints))return null;const e=this._updateTransform(Ofe);if(C(e)||!vu(this.controlPoints[0]))return null;const t=this.controlPoints[0].mapPoint.spatialReference;return Ffe(e,this.width,this.height,t)}get inverseTransform(){return C(this.transform)?null:Kg(Or(),this.transform)}get transform(){return this._updateTransform()}toMap(e){if(C(e)||C(this.transform)||C(this.controlPoints)||!vu(this.controlPoints[0]))return null;rt(Jc,e.x,e.y);const t=this.controlPoints[0].mapPoint.spatialReference;return u0(Jc,Jc,this.transform),new He({x:Jc[0],y:Jc[1],spatialReference:t})}toSource(e){if(C(e)||C(this.inverseTransform)||C(this.controlPoints)||!vu(this.controlPoints[0]))return null;const t=this.controlPoints[0].mapPoint.spatialReference;return e=e.normalize(),e=kE(e,t).geometry,C(e)?null:(rt(Jc,e.x,e.y),u0(Jc,Jc,this.inverseTransform),Rs(Jc[0],Jc[1]))}_updateTransform(e){const{controlPoints:t,width:r,height:n}=this;if(C(t)||!(r>0)||!(n>0))return null;const[s,a,o,l]=t;if(!vu(s))return null;const c=s.mapPoint.spatialReference,u=this._projectControlPoint(a,c),d=this._projectControlPoint(o,c),m=this._projectControlPoint(l,c);if(!u.valid||!d.valid||!m.valid||!vu(u.controlPoint))return null;C(e)&&(e=Or());let f=null;return f=vu(d.controlPoint)&&vu(m.controlPoint)?Lfe(e,s,u.controlPoint,d.controlPoint,m.controlPoint):vu(d.controlPoint)?Ife(e,s,u.controlPoint,d.controlPoint):Mfe(e,s,u.controlPoint),f.every(_=>_===0)?null:f}_projectControlPoint(e,t){if(!vu(e))return{valid:!0,controlPoint:e};const{sourcePoint:r,mapPoint:n}=e,{geometry:s,pending:a}=kE(n,t);return a?{valid:!1,controlPoint:null}:a||s?{valid:!0,controlPoint:{sourcePoint:r,mapPoint:s}}:(ee.getLogger(this.declaredClass).warn("map point could not be projected to the spatial reference",{georeference:this,controlPoint:e,sourceSpatialReference:n.spatialReference,targetSpatialReference:t}),{valid:!1,controlPoint:null})}};function vu(i){return y(i)&&y(i.sourcePoint)&&y(i.mapPoint)}h([p({type:[Q1]})],Nu.prototype,"controlPoints",void 0),h([p({readOnly:!0})],Nu.prototype,"coords",null),h([p()],Nu.prototype,"height",void 0),h([p({readOnly:!0})],Nu.prototype,"inverseTransform",null),h([p({readOnly:!0})],Nu.prototype,"transform",null),h([p()],Nu.prototype,"width",void 0),Nu=h([F("esri.layers.support.ControlPointsGeoreference")],Nu);const cd=Te(),hd=Te(),bg=Te(),am=Te(),ud=Te(),dd=Te(),wg=Te(),om=Te(),BT=Math.PI/2;function pd(i,e,t){rt(i,t.sourcePoint.x,t.sourcePoint.y),rt(e,t.mapPoint.x,t.mapPoint.y)}function Mfe(i,e,t){return pd(cd,ud,e),pd(hd,dd,t),Xy(bg,hd,cd,BT),Xy(am,cd,hd,BT),Xy(wg,dd,ud,-BT),Xy(om,ud,dd,-BT),xN(i,cd,hd,bg,am,ud,dd,wg,om)}function Ife(i,e,t,r){return pd(cd,ud,e),pd(hd,dd,t),pd(bg,wg,r),Qf(am,cd,hd,.5),Xy(am,bg,am,Math.PI),Qf(om,ud,dd,.5),Xy(om,wg,om,Math.PI),xN(i,cd,hd,bg,am,ud,dd,wg,om)}function Lfe(i,e,t,r,n){return pd(cd,ud,e),pd(hd,dd,t),pd(bg,wg,r),pd(am,om,n),xN(i,cd,hd,bg,am,ud,dd,wg,om)}const $fe=new Array(8).fill(0),Dfe=new Array(8).fill(0);function XV(i,e,t,r,n){return i[0]=e[0],i[1]=e[1],i[2]=t[0],i[3]=t[1],i[4]=r[0],i[5]=r[1],i[6]=n[0],i[7]=n[1],i}function xN(i,e,t,r,n,s,a,o,l){return Afe(i,XV($fe,e,t,r,n),XV(Dfe,s,a,o,l))}function Ffe(i,e,t,r){const n=Qt(0,t),s=Qt(0,0),a=Qt(e,0),o=Qt(e,t);return u0(n,n,i),u0(s,s,i),u0(a,a,i),u0(o,o,i),new jm({rings:[[n,s,a,o,n]],spatialReference:r})}const LX=Nu;let Rp=class extends wP{constructor(e){super(e),this.bottomLeft=null,this.bottomRight=null,this.topLeft=null,this.topRight=null,this.type="corners"}get coords(){let{topLeft:e,topRight:t,bottomLeft:r,bottomRight:n}=this;if(C(e)||C(t)||C(r)||C(n))return null;const s=e.spatialReference;return t=this._projectCorner(t,s),r=this._projectCorner(r,s),n=this._projectCorner(n,s),C(t)||C(r)||C(n)?null:new jm({rings:[[[r.x,r.y],[e.x,e.y],[t.x,t.y],[n.x,n.y],[r.x,r.y]]],spatialReference:s})}_projectCorner(e,t){if(C(e))return e;const{geometry:r,pending:n}=kE(e,t);return n?null:n||r?r:(ee.getLogger(this.declaredClass).warn("map point could not be projected to the spatial reference",{georeference:this,point:e,sourceSpatialReference:e.spatialReference,targetSpatialReference:t}),null)}};h([p({readOnly:!0})],Rp.prototype,"coords",null),h([p({type:He})],Rp.prototype,"bottomLeft",void 0),h([p({type:He})],Rp.prototype,"bottomRight",void 0),h([p({type:He})],Rp.prototype,"topLeft",void 0),h([p({type:He})],Rp.prototype,"topRight",void 0),Rp=h([F("esri.layers.support.CornersGeoreference")],Rp);const $X=Rp;let xy=class extends wP{constructor(e){super(e),this.extent=null,this.rotation=0,this.type="extent-and-rotation"}get coords(){if(C(this.extent))return null;const{xmin:e,ymin:t,xmax:r,ymax:n,spatialReference:s}=this.extent;let a;if(this.rotation){const{x:o,y:l}=this.extent.center,c=Nfe(o,l,this.rotation);a=[c(e,t),c(e,n),c(r,n),c(r,t)],a.push(a[0])}else a=[[e,t],[e,n],[r,n],[r,t],[e,t]];return new jm({rings:[a],spatialReference:s})}};function Nfe(i,e,t){const r=$R(t),n=Math.cos(r),s=Math.sin(r);return(a,o)=>[n*(a-i)+s*(o-e)+i,n*(o-e)-s*(a-i)+e]}h([p({readOnly:!0})],xy.prototype,"coords",null),h([p({type:pi})],xy.prototype,"extent",void 0),h([p({type:Number})],xy.prototype,"rotation",void 0),xy=h([F("esri.layers.support.ExtentAndRotationGeoreference")],xy);const $2=xy,kfe={key:"type",base:wP,typeMap:{"control-points":LX,corners:$X,"extent-and-rotation":$2}};let Z1=class extends IR(Om){constructor(){super(...arguments),this.georeference=null,this.opacity=1}};h([p({types:kfe})],Z1.prototype,"georeference",void 0),h([p()],Z1.prototype,"opacity",void 0),Z1=h([F("esri.layers.support.MediaElementBase")],Z1);const TN=Z1;let Y1=class extends TN{constructor(e){super(e),this.content=null,this.type="image",this.image=null}load(){const e=this.image;if(typeof e=="string"){const t=Wh(e,{responseType:"image"}).then(({data:r})=>{this._set("content",r)});this.addResolvingPromise(t)}else if(e instanceof HTMLImageElement){const t=e.decode().then(()=>{this._set("content",e)});this.addResolvingPromise(t)}else e?this._set("content",e):this.addResolvingPromise(Promise.reject(new J("image-element:invalid-image-type","Invalid image type",{image:e})));return Promise.resolve(this)}set image(e){this.loadStatus==="not-loaded"?this._set("image",e):ee.getLogger(this.declaredClass).error("#image","image cannot be changed after the element is loaded.")}};h([p({readOnly:!0})],Y1.prototype,"content",void 0),h([p()],Y1.prototype,"image",null),Y1=h([F("esri.layers.support.ImageElement")],Y1);const K1=Y1;function Vfe(i){return DX(i,!0)}function PVe(i){return DX(i,!1)}function DX(i,e){if(C(i))return null;const t=i.spatialReference,r=z7(t),n="toJSON"in i?i.toJSON():i;if(!r)return n;const s=Mte(t)?102100:4326,a=A5[s].maxX,o=A5[s].minX;if(kte(n))return QV(n,a,o);if(Vte(n))return n.points=n.points.map(l=>QV(l,a,o)),n;if(Ute(n))return Ufe(n,r);if(zte(n)||j7(n)){const l=Gie(Bfe,n),c={xmin:l[0],ymin:l[1],xmax:l[2],ymax:l[3]},u=N1(c.xmin,o)*(2*a),d=u===0?n:Wie(n,u);return c.xmin+=u,c.xmax+=u,c.xmax>a?YV(d,a,e):c.xmin<o?YV(d,o,e):d}return n}function Ufe(i,e){if(!e)return i;const t=zfe(i,e).map(r=>r.extent);return t.length<2?t[0]||i:t.length>2?(i.xmin=e.valid[0],i.xmax=e.valid[1],i):{rings:t.map(r=>[[r.xmin,r.ymin],[r.xmin,r.ymax],[r.xmax,r.ymax],[r.xmax,r.ymin],[r.xmin,r.ymin]])}}function QV(i,e,t){if(Array.isArray(i)){const r=i[0];if(r>e){const n=N1(r,e);i[0]=r+n*(-2*e)}else if(r<t){const n=N1(r,t);i[0]=r+n*(-2*t)}}else{const r=i.x;if(r>e){const n=N1(r,e);i.x+=n*(-2*e)}else if(r<t){const n=N1(r,t);i.x+=n*(-2*t)}}return i}function zfe(i,e){const t=[],{ymin:r,ymax:n,xmin:s,xmax:a}=i,o=i.xmax-i.xmin,[l,c]=e.valid,{x:u,frameId:d}=ZV(i.xmin,e),{x:m,frameId:f}=ZV(i.xmax,e),_=u===m&&o>0;if(o>2*c){const g={xmin:s<a?u:m,ymin:r,xmax:c,ymax:n},w={xmin:l,ymin:r,xmax:s<a?m:u,ymax:n},v={xmin:0,ymin:r,xmax:c,ymax:n},b={xmin:l,ymin:r,xmax:0,ymax:n},x=[],T=[];GT(g,v)&&x.push(d),GT(g,b)&&T.push(d),GT(w,v)&&x.push(f),GT(w,b)&&T.push(f);for(let R=d+1;R<f;R++)x.push(R),T.push(R);t.push(new Jm(g,[d]),new Jm(w,[f]),new Jm(v,x),new Jm(b,T))}else u>m||_?t.push(new Jm({xmin:u,ymin:r,xmax:c,ymax:n},[d]),new Jm({xmin:l,ymin:r,xmax:m,ymax:n},[f])):t.push(new Jm({xmin:u,ymin:r,xmax:m,ymax:n},[d]));return t}function ZV(i,e){const[t,r]=e.valid,n=2*r;let s,a=0;return i>r?(s=Math.ceil(Math.abs(i-r)/n),i-=s*n,a=s):i<t&&(s=Math.ceil(Math.abs(i-t)/n),i+=s*n,a=-s),{x:i,frameId:a}}function GT(i,e){const{xmin:t,ymin:r,xmax:n,ymax:s}=e;return HT(i,t,r)&&HT(i,t,s)&&HT(i,n,s)&&HT(i,n,r)}function HT(i,e,t){return e>=i.xmin&&e<=i.xmax&&t>=i.ymin&&t<=i.ymax}function YV(i,e,t=!0){const r=!j7(i);if(r&&Hie(i),t)return new Gfe().cut(i,e);const n=r?i.rings:i.paths,s=r?4:2,a=n.length,o=-2*e;for(let l=0;l<a;l++){const c=n[l];if(c&&c.length>=s){const u=[];for(const d of c)u.push([d[0]+o,d[1]]);n.push(u)}}return r?i.rings=n:i.paths=n,i}let Jm=class{constructor(e,t){this.extent=e,this.frameIds=t}};const Bfe=Nt();let Gfe=class{constructor(){this._linesIn=[],this._linesOut=[]}cut(e,t){let r;if(this._xCut=t,e.rings)this._closed=!0,r=e.rings,this._minPts=4;else{if(!e.paths)return null;this._closed=!1,r=e.paths,this._minPts=2}for(const s of r){if(!s||s.length<this._minPts)continue;let a=!0;for(const o of s)a?(this.moveTo(o),a=!1):this.lineTo(o);this._closed&&this.close()}this._pushLineIn(),this._pushLineOut(),r=[];for(const s of this._linesIn)s&&s.length>=this._minPts&&r.push(s);const n=-2*this._xCut;for(const s of this._linesOut)if(s&&s.length>=this._minPts){for(const a of s)a[0]+=n;r.push(s)}return this._closed?e.rings=r:e.paths=r,e}moveTo(e){this._pushLineIn(),this._pushLineOut(),this._prevSide=this._side(e[0]),this._moveTo(e[0],e[1],this._prevSide),this._prevPt=e,this._firstPt=e}lineTo(e){const t=this._side(e[0]);if(t*this._prevSide==-1){const r=this._intersect(this._prevPt,e);this._lineTo(this._xCut,r,0),this._prevSide=0,this._lineTo(e[0],e[1],t)}else this._lineTo(e[0],e[1],t);this._prevSide=t,this._prevPt=e}close(){const e=this._firstPt,t=this._prevPt;e[0]===t[0]&&e[1]===t[1]||this.lineTo(e),this._checkClosingPt(this._lineIn),this._checkClosingPt(this._lineOut)}_moveTo(e,t,r){this._closed?(this._lineIn.push([r<=0?e:this._xCut,t]),this._lineOut.push([r>=0?e:this._xCut,t])):(r<=0&&this._lineIn.push([e,t]),r>=0&&this._lineOut.push([e,t]))}_lineTo(e,t,r){this._closed?(this._addPolyVertex(this._lineIn,r<=0?e:this._xCut,t),this._addPolyVertex(this._lineOut,r>=0?e:this._xCut,t)):r<0?(this._prevSide===0&&this._pushLineOut(),this._lineIn.push([e,t])):r>0?(this._prevSide===0&&this._pushLineIn(),this._lineOut.push([e,t])):this._prevSide<0?(this._lineIn.push([e,t]),this._lineOut.push([e,t])):this._prevSide>0&&(this._lineOut.push([e,t]),this._lineIn.push([e,t]))}_addPolyVertex(e,t,r){const n=e.length;n>1&&e[n-1][0]===t&&e[n-2][0]===t?e[n-1][1]=r:e.push([t,r])}_checkClosingPt(e){const t=e.length;t>3&&e[0][0]===this._xCut&&e[t-2][0]===this._xCut&&e[1][0]===this._xCut&&(e[0][1]=e[t-2][1],e.pop())}_side(e){return e<this._xCut?-1:e>this._xCut?1:0}_intersect(e,t){const r=(this._xCut-e[0])/(t[0]-e[0]);return e[1]+r*(t[1]-e[1])}_pushLineIn(){this._lineIn&&this._lineIn.length>=this._minPts&&this._linesIn.push(this._lineIn),this._lineIn=[]}_pushLineOut(){this._lineOut&&this._lineOut.length>=this._minPts&&this._linesOut.push(this._lineOut),this._lineOut=[]}},ku=class extends pe{constructor(e){super(e)}get bounds(){const e=this.coords;return C(e)||C(e.extent)?null:ww(e.extent)}get coords(){var t;const e=(t=ft(this.element.georeference))==null?void 0:t.coords;return kE(e,this.spatialReference).geometry}get normalizedCoords(){return jm.fromJSON(Vfe(this.coords))}get normalizedBounds(){const e=y(this.normalizedCoords)?this.normalizedCoords.extent:null;return y(e)?ww(e):null}};h([p()],ku.prototype,"spatialReference",void 0),h([p()],ku.prototype,"element",void 0),h([p()],ku.prototype,"bounds",null),h([p()],ku.prototype,"coords",null),h([p()],ku.prototype,"normalizedCoords",null),h([p()],ku.prototype,"normalizedBounds",null),ku=h([F("esri.layers.support.media.MediaElementView")],ku);let J1=class extends TN{constructor(e){super(e),this.content=null,this.type="video"}load(){const e=this.video;if(typeof e=="string"){const t=document.createElement("video");t.src=e,t.crossOrigin="anonymous",t.autoplay=!0,t.muted=!0,t.loop=!0,this.addResolvingPromise(this._loadVideo(t).then(()=>{this._set("content",t)}))}else e instanceof HTMLVideoElement?this.addResolvingPromise(this._loadVideo(e).then(()=>{this._set("content",e)})):this.addResolvingPromise(Promise.reject(new J("video-element:invalid-video-type","Invalid video type",{video:e})));return Promise.resolve(this)}set video(e){this.loadStatus==="not-loaded"?this._set("video",e):ee.getLogger(this.declaredClass).error("#video","video cannot be changed after the element is loaded.")}_loadVideo(e){return new Promise((t,r)=>{e.oncanplay=()=>{e.oncanplay=null,e.play().then(t,r)},e.crossOrigin!=="anonymous"&&(e.crossOrigin="anonymous",e.src=e.src)})}};h([p({readOnly:!0})],J1.prototype,"content",void 0),h([p()],J1.prototype,"video",null),J1=h([F("esri.layers.support.VideoElement")],J1);const FX=J1,Hfe={key:"type",defaultKeyValue:"image",base:TN,typeMap:{image:K1,video:FX}},KV=wt.ofType(Hfe);let Ty=class extends Om.LoadableMixin(bD(Ux(nn.EventedAccessor))){constructor(e){super(e),this._index=new Fre,this._elementViewsMap=new Map,this._elementsIndexes=new Map,this._elementsChangedHandler=t=>{for(const n of t.removed){const s=this._elementViewsMap.get(n);this._elementViewsMap.delete(n),this._index.delete(s),this.handles.remove(s),s.destroy(),this.notifyChange("fullExtent")}const{spatialReference:r}=this;for(const n of t.added){if(this._elementViewsMap.get(n))continue;const s=new ku({spatialReference:r,element:n});this._elementViewsMap.set(n,s);const a=B(()=>s.bounds,()=>this._updateIndexForElement(s,!1));this._updateIndexForElement(s,!0),this.handles.add(a,s)}this._elementsIndexes.clear(),this.elements.forEach((n,s)=>this._elementsIndexes.set(n,s)),this.emit("refresh")},this.elements=new KV}async load(e){if(Ti(e),!this.spatialReference){const t=this.elements.find(r=>y(r.georeference)&&y(r.georeference.coords));this._set("spatialReference",t?ft(ft(t.georeference).coords).spatialReference:Zt.WGS84)}return this._elementsChangedHandler({added:this.elements.items,removed:[]}),this.handles.add(this.elements.on("change",this._elementsChangedHandler)),this}destroy(){this._index.clear(),this._elementViewsMap.clear(),this._elementsIndexes.clear()}set elements(e){this._set("elements",dG(e,this._get("elements"),KV))}get fullExtent(){if(this.loadStatus==="not-loaded")return null;const e=this._index.fullBounds;return C(e)?null:new pi({xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:this.spatialReference})}set spatialReference(e){this.loadStatus==="not-loaded"?this._set("spatialReference",e):ee.getLogger(this.declaredClass).error("#spatialReference","spatialReference cannot be changed after the source is loaded.")}async queryElements(e,t){await this.load(),await Xte(e.spatialReference,this.spatialReference,null,t);const r=Gm(e.spatialReference,this.spatialReference)?e:Dd(e,this.spatialReference);if(!r)return[];const n=r.normalize(),s=[];for(const a of n)this._index.forEachInBounds(ww(a),({normalizedCoords:o,element:l})=>{y(o)&&Ite(a,o)&&s.push(l)});return s.sort((a,o)=>this._elementsIndexes.get(a)-this._elementsIndexes.get(o)),s}_updateIndexForElement(e,t){const r=e.normalizedBounds,n=this._index.has(e),s=y(r);this._index.delete(e),s&&this._index.set(e,r),this.notifyChange("fullExtent"),t||n===s||this.emit("refresh")}};h([p()],Ty.prototype,"elements",null),h([p({readOnly:!0})],Ty.prototype,"fullExtent",null),h([p()],Ty.prototype,"spatialReference",null),Ty=h([F("esri.layers.support.LocalMediaElementSource")],Ty);const JV=Ty;let vh=class extends Are(Ore(TI)){constructor(e){super(e),this.copyright=null,this.spatialReference=null,this.type="media",this.source=new JV}load(e){this.spatialReference&&(this.source.spatialReference=this.spatialReference);const t=this.source.load(e).then(()=>{this.spatialReference=this.source.spatialReference});return this.addResolvingPromise(t),Promise.resolve(this)}destroy(){var e;(e=ft(this.source))==null||e.destroy()}get fullExtent(){var e;return(e=this.source)==null?void 0:e.fullExtent}set source(e){this.loadStatus==="not-loaded"?this._set("source",e):ee.getLogger(this.declaredClass).error("#source","source cannot be changed after the layer is loaded.")}castSource(e){return e?Array.isArray(e)||e instanceof wt?new JV({elements:e}):e:null}};h([p({type:String})],vh.prototype,"copyright",void 0),h([p({readOnly:!0})],vh.prototype,"fullExtent",null),h([p({type:["show","hide"]})],vh.prototype,"listMode",void 0),h([p({nonNullable:!0})],vh.prototype,"source",null),h([qr("source")],vh.prototype,"castSource",null),h([p()],vh.prototype,"spatialReference",void 0),h([p({readOnly:!0})],vh.prototype,"type",void 0),vh=h([F("esri.layers.MediaLayer")],vh);const NX=vh;let Pp=class extends pe{constructor(e){super(e),this._viewpointHandle=null,this._handles=new Vt,this.group=null}initialize(){this._handles.add(wr(()=>{var e;return(e=this.view)==null?void 0:e.ui},"expand",e=>{const{target:t}=e;t&&t!==this&&t.expanded&&t.group&&t.group===this.group&&this._collapse()}))}destroy(){this._viewpointHandle=null,this.view=null,this._handles.destroy(),this._handles=null}set autoCollapse(e){this._set("autoCollapse",e),this._watchViewpoint()}set expanded(e){const t=!!e;this._set("expanded",t);const r=this.get("view.ui");r&&r.emit("expand",{target:this}),this._viewpointHandleChange(t)}get state(){return this.get("view.ready")?"ready":"disabled"}set view(e){this._get("view")!==e&&(this._set("view",e),e&&cs(()=>e.ready,()=>{this.view===e&&this._watchViewpoint()},{once:!0,initial:!0}))}_viewpointHandleChange(e){this._viewpointHandle&&(e?cs(()=>this.view.stationary,()=>this._viewpointHandle.resume(),{once:!0,initial:!0}):this._viewpointHandle.pause())}_watchViewpoint(){const e="viewpoint";this._handles.remove(e),this._viewpointHandle=null;const{autoCollapse:t,view:r}=this;if(r&&t){const n=Wte(()=>r.type==="3d"?r.camera:r.viewpoint,()=>this._collapse());this._handles.add(n,e),this._viewpointHandle=n}}_collapse(){this.expanded=!1}};h([p({value:!1})],Pp.prototype,"autoCollapse",null),h([p({value:!1})],Pp.prototype,"expanded",null),h([p()],Pp.prototype,"group",void 0),h([p({readOnly:!0})],Pp.prototype,"state",null),h([p({value:null})],Pp.prototype,"view",null),Pp=h([F("esri.widgets.Expand.ExpandViewModel")],Pp);const kX=Pp,ln={base:"esri-expand esri-widget",modeAuto:"esri-expand--auto",modeDrawer:"esri-expand--drawer",modeFloating:"esri-expand--floating",container:"esri-expand__container",containerExpanded:"esri-expand__container--expanded",panel:"esri-expand__panel",button:"esri-widget--button",text:"esri-icon-font-fallback-text",icon:"esri-collapse__icon",iconExpanded:"esri-expand__icon--expanded",iconNumber:"esri-expand__icon-number",iconNumberExpanded:"esri-expand__icon-number--expanded",expandIcon:"esri-icon-expand",collapseIcon:"esri-icon-collapse",content:"esri-expand__content",contentExpanded:"esri-expand__content--expanded",expandMask:"esri-expand__mask",expandMaskExpanded:"esri-expand__mask--expanded"};let Dr=class extends Hn{constructor(e,t){super(e,t),this.closeOnEsc=!0,this.collapseTooltip="",this.content="",this.expandTooltip="",this.iconNumber=0,this.messages=null,this.messagesCommon=null,this.mode="auto",this.viewModel=new kX,this._handleKeyDown=r=>{const{closeOnEsc:n,_toggleButtonEl:s,expanded:a}=this;!a||!n||r.target===s||r.key!=="Escape"||(typeof n=="function"?n(r):n)&&(this.expanded=!1,s==null||s.focus())}}get contentId(){return`${this.id}_controls_content`}get expandTitle(){const{expanded:e,messagesCommon:t,collapseTooltip:r,expandTooltip:n}=this;return e?r||t.collapse:n||t.expand}get autoCollapse(){return this.viewModel.autoCollapse}set autoCollapse(e){this.viewModel.autoCollapse=e}get collapseIconClass(){return ln.collapseIcon}set collapseIconClass(e){this._overrideIfSome("collapseIconClass",e)}get expanded(){return this.viewModel.expanded}set expanded(e){this.viewModel.expanded=e}get expandIconClass(){return UE(this.content)?this.content.iconClass:ln.expandIcon}set expandIconClass(e){this._overrideIfSome("expandIconClass",e)}get group(){return this.viewModel.group}set group(e){this.viewModel.group=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}expand(){this.viewModel.expanded=!0}collapse(){this.viewModel.expanded=!1}toggle(){this.viewModel.expanded=!this.viewModel.expanded}render(){const{mode:e}=this,t={[ln.modeAuto]:e==="auto",[ln.modeDrawer]:e==="drawer",[ln.modeFloating]:e==="floating"};return N("div",{class:this.classes(ln.base,t),onkeydown:this._handleKeyDown},this.renderMask(),this.renderContainer())}renderContainer(){const{expanded:e}=this,t={[ln.containerExpanded]:e};return N("div",{class:this.classes(ln.container,t)},this.renderPanel(),this.renderContent())}renderMask(){const{expanded:e}=this,t={[ln.expandMaskExpanded]:e};return N("div",{bind:this,onclick:this._toggle,class:this.classes(ln.expandMask,t)})}renderBadgeNumber(){const{expanded:e,iconNumber:t}=this;return t&&!e?N("span",{key:"expand__icon-number",class:ln.iconNumber},t):null}renderPanelNumber(){const{iconNumber:e,expanded:t}=this;return e&&t?N("span",{key:"expand__expand-icon-number",class:this.classes(ln.iconNumber,ln.iconNumberExpanded)},e):null}renderIcon(){const{collapseIconClass:e,expandIconClass:t,expanded:r}=this,n={[ln.iconExpanded]:r,[e]:r,[t]:!r};return e===t&&(n[e]=!0),N("span",{"aria-hidden":"true",class:this.classes(ln.icon,n)})}renderTitle(){return N("span",{class:ln.text},this.expandTitle)}renderExpandButton(){const{expanded:e,expandTitle:t,contentId:r}=this;return N("div",{afterCreate:this._storeToggleButtonEl,"aria-controls":r,"aria-expanded":e?"true":"false",bind:this,class:ln.button,onclick:this._toggle,onkeydown:this._toggle,role:"button",tabindex:"0",title:t},this.renderBadgeNumber(),this.renderIcon(),this.renderTitle())}renderPanel(){return N("div",{class:ln.panel},this.renderExpandButton(),this.renderPanelNumber())}renderContent(){const{expanded:e,contentId:t,content:r}=this,n={[ln.contentExpanded]:e},s={id:t,role:"region",class:this.classes(ln.content,n)};return typeof r=="string"?N("div",{key:"content__string",innerHTML:r,...s}):UE(r)?N("div",{key:"content__widget",...s},r.render()):r instanceof HTMLElement?N("div",{key:"content__html-element",bind:r,afterCreate:this._attachToNode,...s}):K7(r)?N("div",{key:"content__node",bind:r.domNode,afterCreate:this._attachToNode,...s}):null}_toggle(){this.toggle()}_attachToNode(e){const t=this;e.appendChild(t)}_storeToggleButtonEl(e){this._toggleButtonEl=e}};h([p({readOnly:!0})],Dr.prototype,"contentId",null),h([p({readOnly:!0})],Dr.prototype,"expandTitle",null),h([p()],Dr.prototype,"autoCollapse",null),h([p()],Dr.prototype,"closeOnEsc",void 0),h([p()],Dr.prototype,"collapseIconClass",null),h([p()],Dr.prototype,"collapseTooltip",void 0),h([p()],Dr.prototype,"content",void 0),h([p()],Dr.prototype,"expanded",null),h([p()],Dr.prototype,"expandIconClass",null),h([p()],Dr.prototype,"expandTooltip",void 0),h([p()],Dr.prototype,"group",null),h([p()],Dr.prototype,"iconNumber",void 0),h([p()],Dr.prototype,"label",null),h([p(),_n("esri/widgets/Expand/t9n/Expand")],Dr.prototype,"messages",void 0),h([p(),_n("esri/t9n/common")],Dr.prototype,"messagesCommon",void 0),h([p()],Dr.prototype,"mode",void 0),h([p()],Dr.prototype,"view",null),h([p({type:kX})],Dr.prototype,"viewModel",void 0),h([Uo()],Dr.prototype,"_toggle",null),Dr=h([F("esri.widgets.Expand")],Dr);const eb=Dr;let iE=class extends xt{get version(){return this.commitVersionProperties(),(this._get("version")||0)+1}};h([p({readOnly:!0})],iE.prototype,"version",null),iE=h([F("esri.views.layers.support.ClipArea")],iE);const jfe=iE;var f3;let $f=f3=class extends jfe{constructor(i){super(i),this.type="rect",this.left=null,this.right=null,this.top=null,this.bottom=null}clone(){return new f3({left:this.left,right:this.right,top:this.top,bottom:this.bottom})}commitVersionProperties(){this.commitProperty("left"),this.commitProperty("right"),this.commitProperty("top"),this.commitProperty("bottom")}};h([p({type:[Number,String],json:{write:!0}})],$f.prototype,"left",void 0),h([p({type:[Number,String],json:{write:!0}})],$f.prototype,"right",void 0),h([p({type:[Number,String],json:{write:!0}})],$f.prototype,"top",void 0),h([p({type:[Number,String],json:{write:!0}})],$f.prototype,"bottom",void 0),$f=f3=h([F("esri.views.layers.support.ClipRect")],$f);const jT=$f;function qfe(i,e){const t=10**e;return Math.round(i*t)/t}const qT={left:0,right:0,top:0,bottom:0};let Wa=class extends pe{constructor(e){super(e),this._handles=new Vt,this._leadingClips=new Map,this._trailingClips=new Map,this.direction="horizontal",this.leadingLayers=new wt,this.max=100,this.min=0,this.precision=4,this.step=.5,this.stepMultiplier=10,this.trailingLayers=new wt,this.view=null}initialize(){this._handles.add([B(()=>{var e;return[this.view,(e=this.view)==null?void 0:e.ready,this.position,this.direction]},()=>this._clipLayers(),et),wr(()=>this.leadingLayers,"change",()=>this._clipLeadingLayers()),wr(()=>this.trailingLayers,"change",()=>this._clipTrailingLayers())])}destroy(){this._removeExistingClips(),this._handles.destroy(),this._handles=null}get position(){return 25}set position(e){const{precision:t,min:r,max:n}=this;this._set("position",qfe(Math.max(Math.min(e,n),r),t))}get state(){const{view:e}=this;return e&&e.ready?"ready":"disabled"}_clipLayers(){this._clipLeadingLayers(),this._clipTrailingLayers()}_clipLeadingLayers(){this._removeClips("leading");const{leadingLayers:e}=this;e.forEach(t=>this._clipLayer({layer:t,type:"leading"}))}_clipTrailingLayers(){this._removeClips("trailing");const{trailingLayers:e}=this;e.forEach(t=>this._clipLayer({layer:t,type:"trailing"}))}async _getLayerView(e){const{view:t}=this;if(!e||!t)return null;const r=await t.whenLayerView(e);return"clips"in r?r:null}_getVerticalClipRect(e){const{position:t}=this;return e==="leading"?new jT({...qT,bottom:100-t+"%"}):e==="trailing"?new jT({...qT,top:`${t}%`}):null}_getHorizontalClipRect(e){const{position:t}=this;return e==="leading"?new jT({...qT,right:100-t+"%"}):e==="trailing"?new jT({...qT,left:`${t}%`}):null}_getClipRect(e){const{direction:t}=this;return t==="vertical"?this._getVerticalClipRect(e):t==="horizontal"?this._getHorizontalClipRect(e):null}async _clipLayer(e){const{_leadingClips:t,_trailingClips:r}=this,{layer:n,type:s}=e,a=s==="trailing"?r:s==="leading"?t:null,o=await this._getLayerView(n);if(!(o&&"clips"in o&&a&&o.hasOwnProperty("clips")))return;const l=a.get(o);l&&o.clips.remove(l);const c=this._getClipRect(s);c&&(a.set(o,c),o.clips.add(c))}_removeClips(e){const{_leadingClips:t,_trailingClips:r}=this,n=e==="trailing"?r:e==="leading"?t:null;n&&(n.forEach((s,a)=>{a&&a.hasOwnProperty("clips")&&a.clips.remove(s)}),n.clear())}_removeExistingClips(){this._removeClips("leading"),this._removeClips("trailing")}};h([p()],Wa.prototype,"direction",void 0),h([p({type:wt,nonNullable:!0})],Wa.prototype,"leadingLayers",void 0),h([p({readOnly:!0})],Wa.prototype,"max",void 0),h([p({readOnly:!0})],Wa.prototype,"min",void 0),h([p()],Wa.prototype,"position",null),h([p()],Wa.prototype,"precision",void 0),h([p({readOnly:!0})],Wa.prototype,"state",null),h([p()],Wa.prototype,"step",void 0),h([p()],Wa.prototype,"stepMultiplier",void 0),h([p({type:wt,nonNullable:!0})],Wa.prototype,"trailingLayers",void 0),h([p()],Wa.prototype,"view",void 0),Wa=h([F("esri.widgets.Swipe.SwipeViewModel")],Wa);const VX=Wa,ta={base:"esri-swipe",baseDisabled:"esri-swipe--disabled",vertical:"esri-swipe--vertical",horizontal:"esri-swipe--horizontal",container:"esri-swipe__container",divider:"esri-swipe__divider",handle:"esri-swipe__handle",handleHidden:"esri-swipe__handle--hidden",widgetIcon:"esri-icon-up-down-arrows",handleIcon:"esri-swipe__handle-icon",dragIconHorizontal:"esri-icon-drag-horizontal",dragIconVertical:"esri-icon-drag-vertical",widget:"esri-widget",disabled:"esri-disabled"},e6={handle:!0,divider:!0};let ua=class extends Hn{constructor(e,t){super(e,t),this.disabled=!1,this.iconClass=ta.widgetIcon,this.messages=null,this.viewModel=new VX,this._pointerOffset=null,this._container=null,this._onContainerPointerDown=this._onContainerPointerDown.bind(this),this._onContainerPointerMove=this._onContainerPointerMove.bind(this),this._onContainerPointerUp=this._onContainerPointerUp.bind(this)}get direction(){return this.viewModel.direction}set direction(e){this.viewModel.direction=e}get dragLabel(){var e;return this._get("dragLabel")??((e=this.messages)==null?void 0:e.dragLabel)??""}set dragLabel(e){this._set("dragLabel",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get leadingLayers(){return this.viewModel.leadingLayers}set leadingLayers(e){this.viewModel.leadingLayers=e}get position(){return this.viewModel.position}set position(e){this.viewModel.position=e}get trailingLayers(){return this.viewModel.trailingLayers}set trailingLayers(e){this.viewModel.trailingLayers=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}set visibleElements(e){this._set("visibleElements",{...e6,...e})}get visibleElements(){return this._get("visibleElements")||e6}render(){const{state:e,direction:t}=this.viewModel,r=e==="disabled"||this.disabled,n={[ta.disabled]:r,[ta.baseDisabled]:r,[ta.vertical]:t==="vertical",[ta.horizontal]:t==="horizontal"};return N("div",{class:this.classes(ta.base,ta.widget,n)},e==="disabled"?null:this.renderContainer())}renderHandle(){const{direction:e}=this.viewModel,{visibleElements:t}=this,r={[ta.dragIconHorizontal]:e==="vertical",[ta.dragIconVertical]:e==="horizontal"},n=this.classes(ta.handle,!t.handle&&ta.handleHidden);return N("div",{key:"handle",role:"presentation",class:n},N("span",{"aria-hidden":"true",class:this.classes(ta.handleIcon,r)}))}renderDivider(){const{visibleElements:e}=this;return e&&e.divider?N("div",{key:"divider",role:"presentation",class:ta.divider}):null}renderContent(){return[this.renderDivider(),this.renderHandle()]}renderContainer(){const{disabled:e,dragLabel:t,viewModel:r}=this,{max:n,min:s,direction:a,position:o}=r,l=`${o}%`,c={top:a==="vertical"?l:null,left:a==="vertical"?null:l},u=this.renderContent();return N("div",e?{key:"container",role:"presentation",styles:c,class:ta.container}:{tabIndex:0,key:"container",bind:this,afterCreate:this._afterContainerCreate,onkeydown:this._onContainerKeyDown,"touch-action":"none",role:"slider",title:t,"aria-label":t,"aria-orientation":a,"aria-valuemax":`${n}`,"aria-valuemin":`${s}`,"aria-valuenow":`${o}`,"aria-valuetext":l,styles:c,class:ta.container},u)}_afterContainerCreate(e){this._container=e,e.addEventListener("pointerdown",this._onContainerPointerDown)}_calculatePointerOffset(e){const{direction:t}=this,r=e.target,n=(t==="vertical"?r.clientHeight:r.clientWidth)/2,s=r.getBoundingClientRect(),a=e.clientX-s.left,o=e.clientY-s.top;this._pointerOffset=t==="vertical"?o-n:a-n}_onContainerPointerDown(e){e.preventDefault(),this._container&&document.activeElement!==this.container&&this._container.focus(),this._calculatePointerOffset(e),document.addEventListener("pointerup",this._onContainerPointerUp),document.addEventListener("pointermove",this._onContainerPointerMove)}_onContainerPointerUp(e){e.preventDefault(),document.removeEventListener("pointerup",this._onContainerPointerUp),document.removeEventListener("pointermove",this._onContainerPointerMove)}_onContainerPointerMove(e){e.preventDefault();const{_pointerOffset:t,container:r,direction:n}=this,{clientX:s,clientY:a}=e,{top:o,left:l,width:c,height:u}=r.getBoundingClientRect(),d=(n==="vertical"?a-o-t:s-l-t)/(n==="vertical"?u:c)*100;this.position=d}_getKeyPosition(e){const t=Ol(e),{position:r}=this,{max:n,min:s,step:a,stepMultiplier:o,direction:l}=this.viewModel,c=a*o;return["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Home","End","PageUp","PageDown"].includes(t)&&(e.preventDefault(),e.stopPropagation()),(l==="vertical"?t==="ArrowDown"||t==="ArrowRight":t==="ArrowUp"||t==="ArrowRight")?r+(e.shiftKey?c:a):(l==="vertical"?t==="ArrowUp"||t==="ArrowLeft":t==="ArrowDown"||t==="ArrowLeft")?r-(e.shiftKey?c:a):t==="Home"?s:t==="End"?n:(l==="vertical"?t==="PageDown":t==="PageUp")?r+c:(l==="vertical"?t==="PageUp":t==="PageDown")?r-c:null}_onContainerKeyDown(e){const t=this._getKeyPosition(e);typeof t=="number"&&(this.position=t)}};h([p()],ua.prototype,"direction",null),h([p()],ua.prototype,"disabled",void 0),h([p()],ua.prototype,"dragLabel",null),h([p()],ua.prototype,"iconClass",void 0),h([p()],ua.prototype,"label",null),h([p()],ua.prototype,"leadingLayers",null),h([p(),_n("esri/widgets/Swipe/t9n/Swipe")],ua.prototype,"messages",void 0),h([p()],ua.prototype,"position",null),h([p()],ua.prototype,"trailingLayers",null),h([p()],ua.prototype,"view",null),h([p({type:VX})],ua.prototype,"viewModel",void 0),h([p()],ua.prototype,"visibleElements",null),ua=h([F("esri.widgets.Swipe")],ua);const Wfe=ua,si={allRenderFn:!1,cmpDidLoad:!0,cmpDidUnload:!1,cmpDidUpdate:!0,cmpDidRender:!0,cmpWillLoad:!0,cmpWillUpdate:!0,cmpWillRender:!0,connectedCallback:!0,disconnectedCallback:!0,element:!0,event:!0,hasRenderFn:!0,lifecycle:!0,hostListener:!0,hostListenerTargetWindow:!0,hostListenerTargetDocument:!0,hostListenerTargetBody:!0,hostListenerTargetParent:!1,hostListenerTarget:!0,member:!0,method:!0,mode:!0,observeAttribute:!0,prop:!0,propMutable:!0,reflect:!0,scoped:!0,shadowDom:!0,slot:!0,cssAnnotations:!0,state:!0,style:!0,svg:!0,updatable:!0,vdomAttribute:!0,vdomXlink:!0,vdomClass:!0,vdomFunctional:!0,vdomKey:!0,vdomListener:!0,vdomRef:!0,vdomPropOrAttr:!0,vdomRender:!0,vdomStyle:!0,vdomText:!0,watchCallback:!0,taskQueue:!0,hotModuleReplacement:!1,isDebug:!1,isDev:!1,isTesting:!1,hydrateServerSide:!1,hydrateClientSide:!1,lifecycleDOMEvents:!1,lazyLoad:!1,profile:!1,slotRelocation:!0,appendChildSlotFix:!1,cloneNodeFix:!1,hydratedAttribute:!1,hydratedClass:!0,safari10:!1,scriptDataOpts:!1,scopedSlotTextContentFix:!1,shadowDomShim:!1,slotChildNodesFix:!1,invisiblePrehydration:!0,propBoolean:!0,propNumber:!0,propString:!0,cssVarShim:!1,constructableCSS:!0,cmpShouldUpdate:!0,devTools:!1,dynamicImportShim:!1,shadowDelegatesFocus:!0,initializeNextTick:!1,asyncLoading:!1,asyncQueue:!1,transformTagName:!1,attachStyles:!0};let Cy,UX,xP,zX=!1,D2=!1,CN=!1,zo=!1,t6=null,g3=!1;const SN={isDev:!!si.isDev,isBrowser:!0,isServer:!1,isTesting:!!si.isTesting},BX=i=>{const e=new URL(i,Js.$resourcesUrl$);return e.origin!==Ev.location.origin?e.href:e.pathname},Xfe=i=>Js.$resourcesUrl$=i,zg=(i,e="")=>()=>{},i6="http://www.w3.org/1999/xlink",r6={},Qfe="http://www.w3.org/2000/svg",Zfe="http://www.w3.org/1999/xhtml",Yfe=i=>i!=null,EN=i=>(i=typeof i,i==="object"||i==="function"),Cr=(i,e,...t)=>{let r=null,n=null,s=null,a=!1,o=!1;const l=[],c=d=>{for(let m=0;m<d.length;m++)r=d[m],Array.isArray(r)?c(r):r!=null&&typeof r!="boolean"&&((a=typeof i!="function"&&!EN(r))&&(r=String(r)),a&&o?l[l.length-1].$text$+=r:l.push(a?F2(null,r):r),o=a)};if(c(t),e&&(si.isDev&&i==="input"&&ege(e),si.vdomKey&&e.key&&(n=e.key),si.slotRelocation&&e.name&&(s=e.name),si.vdomClass)){const d=e.className||e.class;d&&(e.class=typeof d!="object"?d:Object.keys(d).filter(m=>d[m]).join(" "))}if(si.isDev&&l.some(GX)&&Ege(`The <Host> must be the single root component. Make sure:
- You are NOT using hostData() and <Host> in the same component.
- <Host> is used once, and it's the single root component of the render() function.`),si.vdomFunctional&&typeof i=="function")return i(e===null?{}:e,l,Kfe);const u=F2(i,null);return u.$attrs$=e,l.length>0&&(u.$children$=l),si.vdomKey&&(u.$key$=n),si.slotRelocation&&(u.$name$=s),u},F2=(i,e)=>{const t={$flags$:0,$tag$:i,$text$:e,$elm$:null,$children$:null};return si.vdomAttribute&&(t.$attrs$=null),si.vdomKey&&(t.$key$=null),si.slotRelocation&&(t.$name$=null),t},RN={},GX=i=>i&&i.$tag$===RN,Kfe={forEach:(i,e)=>i.map(n6).forEach(e),map:(i,e)=>i.map(n6).map(e).map(Jfe)},n6=i=>({vattrs:i.$attrs$,vchildren:i.$children$,vkey:i.$key$,vname:i.$name$,vtag:i.$tag$,vtext:i.$text$}),Jfe=i=>{if(typeof i.vtag=="function"){const t=Object.assign({},i.vattrs);return i.vkey&&(t.key=i.vkey),i.vname&&(t.name=i.vname),Cr(i.vtag,t,...i.vchildren||[])}const e=F2(i.vtag,i.vtext);return e.$attrs$=i.vattrs,e.$children$=i.vchildren,e.$key$=i.vkey,e.$name$=i.vname,e},ege=i=>{const e=Object.keys(i),t=e.indexOf("value");if(t===-1)return;const r=e.indexOf("type"),n=e.indexOf("min"),s=e.indexOf("max"),a=e.indexOf("step");(t<r||t<n||t<s||t<a)&&Rge('The "value" prop of <input> should be set after "min", "max", "type" and "step"')},tge=i=>Pge.map(e=>e(i)).find(e=>!!e),ige=(i,e)=>i!=null&&!EN(i)?e&4?i==="false"?!1:i===""||!!i:e&2?parseFloat(i):e&1?String(i):i:i,s6=new WeakMap,rge=(i,e,t)=>{let r=k2.get(i);Mge&&t?(r=r||new CSSStyleSheet,typeof r=="string"?r=e:r.replaceSync(e)):r=e,k2.set(i,r)},nge=(i,e,t,r)=>{let n=HX(e,t);const s=k2.get(n);if(i=i.nodeType===11?i:Vc,s)if(typeof s=="string"){i=i.head||i;let a=s6.get(i),o;a||s6.set(i,a=new Set),a.has(n)||(o=Vc.createElement("style"),o.innerHTML=s,i.insertBefore(o,i.querySelector("link")),a&&a.add(n))}else i.adoptedStyleSheets.includes(s)||(i.adoptedStyleSheets=[...i.adoptedStyleSheets,s]);return n},sge=i=>{const e=i.$cmpMeta$,t=i.$hostElement$,r=e.$flags$,n=zg("attachStyles",e.$tagName$),s=nge(V2&&t.shadowRoot?t.shadowRoot:t.getRootNode(),e,i.$modeName$);r&10&&(t["s-sc"]=s,t.classList.add(s+"-h"),r&2&&t.classList.add(s+"-s")),n()},HX=(i,e)=>"sc-"+(e&&i.$flags$&32?i.$tagName$+"-"+e:i.$tagName$),a6=(i,e,t,r,n,s)=>{if(t!==r){let a=h6(i,e),o=e.toLowerCase();if(e==="class"){const l=i.classList,c=o6(t),u=o6(r);l.remove(...c.filter(d=>d&&!u.includes(d))),l.add(...u.filter(d=>d&&!c.includes(d)))}else if(e==="style"){for(const l in t)(!r||r[l]==null)&&(l.includes("-")?i.style.removeProperty(l):i.style[l]="");for(const l in r)(!t||r[l]!==t[l])&&(l.includes("-")?i.style.setProperty(l,r[l]):i.style[l]=r[l])}else if(e!=="key")if(e==="ref")r&&r(i);else if(!i.__lookupSetter__(e)&&e[0]==="o"&&e[1]==="n")e[2]==="-"?e=e.slice(3):h6(Ev,o)?e=o.slice(2):e=o[2]+e.slice(3),t&&Js.rel(i,e,t,!1),r&&Js.ael(i,e,r,!1);else{const l=EN(r);if((a||l&&r!==null)&&!n)try{if(i.tagName.includes("-"))i[e]=r;else{const u=r??"";e==="list"?a=!1:(t==null||i[e]!=u)&&(i[e]=u)}}catch{}let c=!1;o!==(o=o.replace(/^xlink\:?/,""))&&(e=o,c=!0),r==null||r===!1?(r!==!1||i.getAttribute(e)==="")&&(c?i.removeAttributeNS(i6,e):i.removeAttribute(e)):(!a||s&4||n)&&!l&&(r=r===!0?"":r,c?i.setAttributeNS(i6,e,r):i.setAttribute(e,r))}}},age=/\s/,o6=i=>i?i.split(age):[],jX=(i,e,t,r)=>{const n=e.$elm$.nodeType===11&&e.$elm$.host?e.$elm$.host:e.$elm$,s=i&&i.$attrs$||r6,a=e.$attrs$||r6;for(r in s)r in a||a6(n,r,s[r],void 0,t,e.$flags$);for(r in a)a6(n,r,s[r],a[r],t,e.$flags$)},N2=(i,e,t,r)=>{const n=e.$children$[t];let s=0,a,o,l;if(zX||(CN=!0,n.$tag$==="slot"&&(Cy&&r.classList.add(Cy+"-s"),n.$flags$|=n.$children$?2:1)),n.$text$!==null)a=n.$elm$=Vc.createTextNode(n.$text$);else if(n.$flags$&1)a=n.$elm$=Vc.createTextNode("");else{if(zo||(zo=n.$tag$==="svg"),a=n.$elm$=Vc.createElementNS(zo?Qfe:Zfe,n.$flags$&2?"slot-fb":n.$tag$),zo&&n.$tag$==="foreignObject"&&(zo=!1),jX(null,n,zo),Yfe(Cy)&&a["s-si"]!==Cy&&a.classList.add(a["s-si"]=Cy),n.$children$)for(s=0;s<n.$children$.length;++s)o=N2(i,n,s,a),o&&a.appendChild(o);n.$tag$==="svg"?zo=!1:a.tagName==="foreignObject"&&(zo=!0)}return a["s-hn"]=xP,n.$flags$&3&&(a["s-sr"]=!0,a["s-cr"]=UX,a["s-sn"]=n.$name$||"",l=i&&i.$children$&&i.$children$[t],l&&l.$tag$===n.$tag$&&i.$elm$&&ix(i.$elm$,!1)),a},ix=(i,e)=>{Js.$flags$|=1;const t=i.childNodes;for(let r=t.length-1;r>=0;r--){const n=t[r];n["s-hn"]!==xP&&n["s-ol"]&&(XX(n).insertBefore(n,PN(n)),n["s-ol"].remove(),n["s-ol"]=void 0,CN=!0),e&&ix(n,e)}Js.$flags$&=-2},qX=(i,e,t,r,n,s)=>{let a=i["s-cr"]&&i["s-cr"].parentNode||i,o;for(a.shadowRoot&&a.tagName===xP&&(a=a.shadowRoot);n<=s;++n)r[n]&&(o=N2(null,t,n,i),o&&(r[n].$elm$=o,a.insertBefore(o,PN(e))))},WX=(i,e,t,r,n)=>{for(;e<=t;++e)(r=i[e])&&(n=r.$elm$,YX(r),D2=!0,n["s-ol"]?n["s-ol"].remove():ix(n,!0),n.remove())},oge=(i,e,t,r)=>{let n=0,s=0,a=0,o=0,l=e.length-1,c=e[0],u=e[l],d=r.length-1,m=r[0],f=r[d],_,g;for(;n<=l&&s<=d;)if(c==null)c=e[++n];else if(u==null)u=e[--l];else if(m==null)m=r[++s];else if(f==null)f=r[--d];else if(WT(c,m))Sy(c,m),c=e[++n],m=r[++s];else if(WT(u,f))Sy(u,f),u=e[--l],f=r[--d];else if(WT(c,f))(c.$tag$==="slot"||f.$tag$==="slot")&&ix(c.$elm$.parentNode,!1),Sy(c,f),i.insertBefore(c.$elm$,u.$elm$.nextSibling),c=e[++n],f=r[--d];else if(WT(u,m))(c.$tag$==="slot"||f.$tag$==="slot")&&ix(u.$elm$.parentNode,!1),Sy(u,m),i.insertBefore(u.$elm$,c.$elm$),u=e[--l],m=r[++s];else{for(a=-1,o=n;o<=l;++o)if(e[o]&&e[o].$key$!==null&&e[o].$key$===m.$key$){a=o;break}a>=0?(g=e[a],g.$tag$!==m.$tag$?_=N2(e&&e[s],t,a,i):(Sy(g,m),e[a]=void 0,_=g.$elm$),m=r[++s]):(_=N2(e&&e[s],t,s,i),m=r[++s]),_&&XX(c.$elm$).insertBefore(_,PN(c.$elm$))}n>l?qX(i,r[d+1]==null?null:r[d+1].$elm$,t,r,s,d):s>d&&WX(e,n,l)},WT=(i,e)=>i.$tag$===e.$tag$?i.$tag$==="slot"?i.$name$===e.$name$:i.$key$===e.$key$:!1,PN=i=>i&&i["s-ol"]||i,XX=i=>(i["s-ol"]?i["s-ol"]:i).parentNode,Sy=(i,e)=>{const t=e.$elm$=i.$elm$,r=i.$children$,n=e.$children$,s=e.$tag$,a=e.$text$;let o;a===null?(zo=s==="svg"?!0:s==="foreignObject"?!1:zo,s==="slot"||jX(i,e,zo),r!==null&&n!==null?oge(t,r,e,n):n!==null?(i.$text$!==null&&(t.textContent=""),qX(t,null,e,n,0,n.length-1)):r!==null&&WX(r,0,r.length-1),zo&&s==="svg"&&(zo=!1)):(o=t["s-cr"])?o.parentNode.textContent=a:i.$text$!==a&&(t.data=a)},QX=i=>{const e=i.childNodes;let t,r,n,s,a,o;for(r=0,n=e.length;r<n;r++)if(t=e[r],t.nodeType===1){if(t["s-sr"]){for(a=t["s-sn"],t.hidden=!1,s=0;s<n;s++)if(o=e[s].nodeType,e[s]["s-hn"]!==t["s-hn"]||a!==""){if(o===1&&a===e[s].getAttribute("slot")){t.hidden=!0;break}}else if(o===1||o===3&&e[s].textContent.trim()!==""){t.hidden=!0;break}}QX(t)}},xc=[],ZX=i=>{let e,t,r,n,s,a,o=0;const l=i.childNodes,c=l.length;for(;o<c;o++){if(e=l[o],e["s-sr"]&&(t=e["s-cr"])&&t.parentNode)for(r=t.parentNode.childNodes,n=e["s-sn"],a=r.length-1;a>=0;a--)t=r[a],!t["s-cn"]&&!t["s-nr"]&&t["s-hn"]!==e["s-hn"]&&(l6(t,n)?(s=xc.find(u=>u.$nodeToRelocate$===t),D2=!0,t["s-sn"]=t["s-sn"]||n,s?s.$slotRefNode$=e:xc.push({$slotRefNode$:e,$nodeToRelocate$:t}),t["s-sr"]&&xc.map(u=>{l6(u.$nodeToRelocate$,t["s-sn"])&&(s=xc.find(d=>d.$nodeToRelocate$===t),s&&!u.$slotRefNode$&&(u.$slotRefNode$=s.$slotRefNode$))})):xc.some(u=>u.$nodeToRelocate$===t)||xc.push({$nodeToRelocate$:t}));e.nodeType===1&&ZX(e)}},l6=(i,e)=>i.nodeType===1?i.getAttribute("slot")===null&&e===""||i.getAttribute("slot")===e:i["s-sn"]===e?!0:e==="",YX=i=>{i.$attrs$&&i.$attrs$.ref&&i.$attrs$.ref(null),i.$children$&&i.$children$.map(YX)},lge=(i,e)=>{const t=i.$hostElement$,r=i.$cmpMeta$,n=i.$vnode$||F2(null,null),s=GX(e)?e:Cr(null,null,e);xP=t.tagName,r.$attrsToReflect$&&(s.$attrs$=s.$attrs$||{},r.$attrsToReflect$.map(([a,o])=>s.$attrs$[o]=t[a])),s.$tag$=null,s.$flags$|=4,i.$vnode$=s,s.$elm$=n.$elm$=t.shadowRoot||t,Cy=t["s-sc"],UX=t["s-cr"],zX=V2&&(r.$flags$&1)!==0,D2=!1,Sy(n,s);{if(Js.$flags$|=1,CN){ZX(s.$elm$);let a,o,l,c,u,d,m=0;for(;m<xc.length;m++)a=xc[m],o=a.$nodeToRelocate$,o["s-ol"]||(l=Vc.createTextNode(""),l["s-nr"]=o,o.parentNode.insertBefore(o["s-ol"]=l,o));for(m=0;m<xc.length;m++)if(a=xc[m],o=a.$nodeToRelocate$,a.$slotRefNode$){for(c=a.$slotRefNode$.parentNode,u=a.$slotRefNode$.nextSibling,l=o["s-ol"];l=l.previousSibling;)if(d=l["s-nr"],d&&d["s-sn"]===o["s-sn"]&&c===d.parentNode&&(d=d.nextSibling,!d||!d["s-nr"])){u=d;break}(!u&&c!==o.parentNode||o.nextSibling!==u)&&o!==u&&(!o["s-hn"]&&o["s-ol"]&&(o["s-hn"]=o["s-ol"].parentNode.nodeName),c.insertBefore(o,u))}else o.nodeType===1&&(o.hidden=!0)}D2&&QX(s.$elm$),Js.$flags$&=-2,xc.length=0}},cge=(i,e)=>{},KX=(i,e)=>(i.$flags$|=16,cge(i,i.$ancestorComponent$),$ge(()=>hge(i,e))),hge=(i,e)=>{const t=i.$hostElement$,r=zg("scheduleUpdate",i.$cmpMeta$.$tagName$),n=t;let s;return e?s=D0(n,"componentWillLoad"):s=D0(n,"componentWillUpdate"),s=c6(s,()=>D0(n,"componentWillRender")),r(),c6(s,()=>uge(i,n,e))},uge=async(i,e,t)=>{const r=i.$hostElement$,n=zg("update",i.$cmpMeta$.$tagName$);r["s-rc"],t&&sge(i);const s=zg("render",i.$cmpMeta$.$tagName$);dge(i,e,r),s(),n(),pge(i)},dge=(i,e,t)=>{try{t6=e,e=e.render&&e.render(),i.$flags$&=-17,i.$flags$|=2,(si.hasRenderFn||si.reflect)&&(si.vdomRender||si.reflect)&&(si.hydrateServerSide||lge(i,e))}catch(o){tT(o,i.$hostElement$)}return t6=null,null},pge=i=>{const e=i.$cmpMeta$.$tagName$,t=i.$hostElement$,r=zg("postUpdate",e),n=t;i.$ancestorComponent$,D0(n,"componentDidRender"),i.$flags$&64?(D0(n,"componentDidUpdate"),r()):(i.$flags$|=64,D0(n,"componentDidLoad"),r())},D0=(i,e,t)=>{if(i&&i[e])try{return i[e](t)}catch(r){tT(r)}},c6=(i,e)=>i&&i.then?i.then(e):e(),mge=(i,e)=>TP(i).$instanceValues$.get(e),fge=(i,e,t,r)=>{const n=TP(i),s=i,a=n.$instanceValues$.get(e),o=n.$flags$,l=s;t=ige(t,r.$members$[e][0]);const c=Number.isNaN(a)&&Number.isNaN(t);if(t!==a&&!c){n.$instanceValues$.set(e,t);{if(r.$watchers$&&o&128){const d=r.$watchers$[e];d&&d.map(m=>{try{l[m](t,a,e)}catch(f){tT(f,s)}})}if((o&18)===2){if(l.componentShouldUpdate&&l.componentShouldUpdate(t,a,e)===!1)return;KX(n,!1)}}}},gge=(i,e,t)=>{if(e.$members$){i.watchers&&(e.$watchers$=i.watchers);const r=Object.entries(e.$members$),n=i.prototype;r.map(([s,[a]])=>{(a&31||a&32)&&Object.defineProperty(n,s,{get(){return mge(this,s)},set(o){fge(this,s,o,e)},configurable:!0,enumerable:!0})});{const s=new Map;n.attributeChangedCallback=function(a,o,l){Js.jmp(()=>{const c=s.get(a);if(this.hasOwnProperty(c))l=this[c],delete this[c];else if(n.hasOwnProperty(c)&&typeof this[c]=="number"&&this[c]==l)return;this[c]=l===null&&typeof this[c]=="boolean"?!1:l})},i.observedAttributes=r.filter(([a,o])=>o[0]&15).map(([a,o])=>{const l=o[1]||a;return s.set(l,a),o[0]&512&&e.$attrsToReflect$.push([a,l]),l})}}return i},_ge=async(i,e,t,r,n)=>{if(!(e.$flags$&32)&&(n=i.constructor,e.$flags$|=32,customElements.whenDefined(t.$tagName$).then(()=>e.$flags$|=128),n.style)){let a=n.style;typeof a!="string"&&(a=a[e.$modeName$=tge(i)]);const o=HX(t,e.$modeName$);if(!k2.has(o)){const l=zg("registerStyles",t.$tagName$);rge(o,a,!!(t.$flags$&1)),l()}}e.$ancestorComponent$,(()=>KX(e,!0))()},yge=i=>{},vge=i=>{if(!(Js.$flags$&1)){const e=TP(i),t=e.$cmpMeta$,r=zg("connectedCallback",t.$tagName$);e.$flags$&1?(JX(i,e,t.$listeners$),yge(e.$lazyInstance$)):(e.$flags$|=1,t.$flags$&12&&bge(i),t.$members$&&Object.entries(t.$members$).map(([n,[s]])=>{if(s&31&&i.hasOwnProperty(n)){const a=i[n];delete i[n],i[n]=a}}),_ge(i,e,t)),r()}},bge=i=>{const e=i["s-cr"]=Vc.createComment("");e["s-cn"]=!0,i.insertBefore(e,i.firstChild)},wge=i=>{if(!(Js.$flags$&1)){const e=TP(i);e.$rmListeners$&&(e.$rmListeners$.map(t=>t()),e.$rmListeners$=void 0)}},AN=(i,e)=>{const t={$flags$:e[0],$tagName$:e[1]};si.member&&(t.$members$=e[2]),si.hostListener&&(t.$listeners$=e[3]),si.watchCallback&&(t.$watchers$=i.$watchers$),si.reflect&&(t.$attrsToReflect$=[]),si.shadowDom&&!V2&&t.$flags$&1&&(t.$flags$|=8);const r=i.prototype.connectedCallback,n=i.prototype.disconnectedCallback;return Object.assign(i.prototype,{__registerHost(){Sge(this,t)},connectedCallback(){vge(this),si.connectedCallback&&r&&r.call(this)},disconnectedCallback(){wge(this),si.disconnectedCallback&&n&&n.call(this)},__attachShadow(){V2?si.shadowDelegatesFocus?this.attachShadow({mode:"open",delegatesFocus:!!(t.$flags$&16)}):this.attachShadow({mode:"open"}):this.shadowRoot=this}}),i.is=t.$tagName$,gge(i,t)},JX=(i,e,t,r)=>{t&&t.map(([n,s,a])=>{const o=Tge(i,n),l=xge(e,a),c=Cge(n);Js.ael(o,s,l,c),(e.$rmListeners$=e.$rmListeners$||[]).push(()=>Js.rel(o,s,l,c))})},xge=(i,e)=>t=>{try{si.lazyLoad||i.$hostElement$[e](t)}catch(r){tT(r)}},Tge=(i,e)=>e&4?Vc:e&8?Ev:e&16?Vc.body:i,Cge=i=>Age?{passive:(i&1)!==0,capture:(i&2)!==0}:(i&2)!==0,eQ=new WeakMap,TP=i=>eQ.get(i),Sge=(i,e)=>{const t={$flags$:0,$hostElement$:i,$cmpMeta$:e,$instanceValues$:new Map};return si.isDev&&(t.$renderCount$=0),si.method&&si.lazyLoad&&(t.$onInstancePromise$=new Promise(r=>t.$onInstanceResolve$=r)),si.asyncLoading&&(t.$onReadyPromise$=new Promise(r=>t.$onReadyResolve$=r),i["s-p"]=[],i["s-rc"]=[]),JX(i,t,e.$listeners$),eQ.set(i,t)},h6=(i,e)=>e in i,tT=(i,e)=>(0,console.error)(i,e),tQ=si.isTesting?["STENCIL:"]:["%cstencil","color: white;background:#4c47ff;font-weight: bold; font-size:10px; padding:2px 6px; border-radius: 5px"],Ege=(...i)=>console.error(...tQ,...i),Rge=(...i)=>console.warn(...tQ,...i),k2=new Map,Pge=[],Ev=typeof window<"u"?window:{};si.cssVarShim&&Ev.CSS;const Vc=Ev.document||{head:{}},ON=Ev.HTMLElement||class{},Js={$flags$:0,$resourcesUrl$:"",jmp:i=>i(),raf:i=>requestAnimationFrame(i),ael:(i,e,t,r)=>i.addEventListener(e,t,r),rel:(i,e,t,r)=>i.removeEventListener(e,t,r),ce:(i,e)=>new CustomEvent(i,e)},V2=si.shadowDomShim&&si.shadowDom?(()=>(Vc.head.attachShadow+"").indexOf("[native")>-1)():!0,Age=(()=>{let i=!1;try{Vc.addEventListener("e",null,Object.defineProperty({},"passive",{get(){i=!0}}))}catch{}return i})(),Oge=i=>Promise.resolve(i),Mge=si.constructableCSS?(()=>{try{return new CSSStyleSheet,typeof new CSSStyleSheet().replaceSync=="function"}catch{}return!1})():!1,u6=[],iQ=[],Ige=(i,e)=>t=>{i.push(t),g3||(g3=!0,e&&Js.$flags$&4?Lge(_3):Js.raf(_3))},d6=i=>{for(let e=0;e<i.length;e++)try{i[e](performance.now())}catch(t){tT(t)}i.length=0},_3=()=>{d6(u6),d6(iQ),(g3=u6.length>0)&&Js.raf(_3)},Lge=i=>Oge().then(i),$ge=Ige(iQ,!0);/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.7
 */function Dge(i){return i.map(e=>{let t="";for(let r=0;r<e;r++)t+=((1+Math.random())*65536|0).toString(16).substring(1);return t}).join("-")}const Fge=()=>Dge([2,1,1,1,3]);/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.7
 */const Nge="calcite-mode-auto",kge="calcite-mode-dark";function Vge(i){const e="dir",t=`[${e}]`,r=iT(i,t);return r?r.getAttribute(e):"ltr"}function rQ(i){return i.getRootNode()}function nQ(i){return i.host||null}function Uge(i,{selector:e,id:t}){function r(n){if(!n)return null;n.assignedSlot&&(n=n.assignedSlot);const s=rQ(n),a=t?"getElementById"in s?s.getElementById(t):null:e?s.querySelector(e):null,o=nQ(s);return a||(o?r(o):null)}return r(i)}function iT(i,e){function t(r){return r?r.closest(e)||t(nQ(rQ(r))):null}return t(i)}function zge(i,e){return sQ(i,e)}function sQ(i,e){if(!i)return;const t=e(i);if(t!==void 0)return t;const{parentNode:r}=i;return sQ(r instanceof ShadowRoot?r.host:r,e)}function Bge(i,e){return!!zge(e,t=>t===i?!0:void 0)}function Gge(i){return Boolean(i).toString()}/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.7
 */function Hge(i){const{formEl:e}=i;return e?("requestSubmit"in e?e.requestSubmit():e.submit(),!0):!1}function jge(i){var e;(e=i.formEl)==null||e.reset()}/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.7
 */function qge(){}function Wge(i,e=!1){if(i.disabled){i.el.setAttribute("tabindex","-1"),i.el.setAttribute("aria-disabled","true"),i.el.contains(document.activeElement)&&document.activeElement.blur(),i.el.click=qge;return}i.el.click=HTMLElement.prototype.click,typeof e=="function"?i.el.setAttribute("tabindex",e.call(i)?"0":"-1"):e===!0?i.el.setAttribute("tabindex","0"):e===!1&&i.el.removeAttribute("tabindex"),i.el.removeAttribute("aria-disabled")}/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.7
 */const aQ="calciteInternalLabelClick",MN="calciteInternalLabelConnected",y3="calciteInternaLabelDisconnected",p6="calcite-label",U2=new WeakMap,rx=new WeakMap,z2=new WeakMap,F0=new Set,Xge=i=>{const{id:e}=i,t=e&&Uge(i,{selector:`${p6}[for="${e}"]`});if(t)return t;const r=iT(i,p6);return!r||Qge(r,i)?null:r};function Qge(i,e){let t;const r="custom-element-ancestor-check",n=a=>{a.stopImmediatePropagation();const o=a.composedPath();t=o.slice(o.indexOf(e),o.indexOf(i))};return i.addEventListener(r,n,{once:!0}),e.dispatchEvent(new CustomEvent(r,{composed:!0,bubbles:!0})),i.removeEventListener(r,n),t.filter(a=>a!==e&&a!==i).filter(a=>{var o;return(o=a.tagName)==null?void 0:o.includes("-")}).length>0}function oQ(i){const e=Xge(i.el);if(U2.has(e)||!e&&F0.has(i))return;const t=e_e.bind(i);if(e){i.labelEl=e;const r=Kge.bind(i);U2.set(i.labelEl,r),i.labelEl.addEventListener(aQ,r),F0.delete(i),document.removeEventListener(MN,rx.get(i)),z2.set(i,t),document.addEventListener(y3,t)}else F0.has(i)||(t(),document.removeEventListener(y3,z2.get(i)))}function Zge(i){if(F0.delete(i),document.removeEventListener(MN,rx.get(i)),document.removeEventListener(y3,z2.get(i)),rx.delete(i),z2.delete(i),!i.labelEl)return;const e=U2.get(i.labelEl);i.labelEl.removeEventListener(aQ,e),U2.delete(i.labelEl)}function Yge(i){var e,t;return i.label||((t=(e=i.labelEl)==null?void 0:e.textContent)==null?void 0:t.trim())||""}function Kge(i){this.disabled||this.el.contains(i.detail.sourceEvent.target)||this.onLabelClick(i)}function Jge(){F0.has(this)&&oQ(this)}function e_e(){F0.add(this);const i=rx.get(this)||Jge.bind(this);rx.set(this,i),document.addEventListener(MN,i)}/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.7
 */const lQ=new WeakMap,cQ=new WeakMap;function t_e(i){cQ.set(i,new Promise(e=>lQ.set(i,e)))}function i_e(i){lQ.get(i)()}function r_e(i){return cQ.get(i)}/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.7
 */function IN(i,e,t){if(!SN.isBrowser)return;const r=n_e(i);return new r(e,t)}function n_e(i){class e extends window.MutationObserver{constructor(r){super(r),this.observedEntry=[],this.callback=r}observe(r,n){return this.observedEntry.push({target:r,options:n}),super.observe(r,n)}unobserve(r){const n=this.observedEntry.filter(s=>s.target!==r);this.observedEntry=[],this.callback(super.takeRecords(),this),this.disconnect(),n.forEach(s=>this.observe(s.target,s.options))}}return function(){return i==="intersection"?window.IntersectionObserver:i==="mutation"?e:window.ResizeObserver}()}/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.7
 */const s_e=new RegExp("-","g"),a_e=new RegExp("\\.?0+$");class Ni{constructor(e){if(this.add=n=>Ni.fromBigInt(this.value+new Ni(n).value),this.subtract=n=>Ni.fromBigInt(this.value-new Ni(n).value),this.multiply=n=>Ni._divRound(this.value*new Ni(n).value,Ni.SHIFT),this.divide=n=>Ni._divRound(this.value*Ni.SHIFT,new Ni(n).value),e instanceof Ni)return e;const[t,r]=String(e).split(".").concat("");this.value=BigInt(t+r.padEnd(Ni.DECIMALS,"0").slice(0,Ni.DECIMALS))+BigInt(Ni.ROUNDED&&r[Ni.DECIMALS]>="5"),this.isNegative=e.charAt(0)==="-"}getIntegersAndDecimals(){const e=this.value.toString().replace(s_e,"").padStart(Ni.DECIMALS+1,"0"),t=e.slice(0,-Ni.DECIMALS),r=e.slice(-Ni.DECIMALS).replace(a_e,"");return{integers:t,decimals:r}}toString(){const{integers:e,decimals:t}=this.getIntegersAndDecimals();return`${this.isNegative?"-":""}${e}${t.length?"."+t:""}`}formatToParts(e){const{integers:t,decimals:r}=this.getIntegersAndDecimals(),n=e.numberFormatter.formatToParts(BigInt(t));return this.isNegative&&n.unshift({type:"minusSign",value:e.minusSign}),r.length&&(n.push({type:"decimal",value:e.decimal}),r.split("").forEach(s=>n.push({type:"fraction",value:s}))),n}format(e){const{integers:t,decimals:r}=this.getIntegersAndDecimals(),n=`${this.isNegative?e.minusSign:""}${e.numberFormatter.format(BigInt(t))}`,s=r.length?`${e.decimal}${r.split("").map(a=>e.numberFormatter.format(Number(a))).join("")}`:"";return`${n}${s}`}}Ni.DECIMALS=100;Ni.ROUNDED=!0;Ni.SHIFT=BigInt("1"+"0".repeat(Ni.DECIMALS));Ni._divRound=(i,e)=>Ni.fromBigInt(i/e+(Ni.ROUNDED?i*BigInt(2)/e%BigInt(2):BigInt(0)));Ni.fromBigInt=i=>Object.assign(Object.create(Ni.prototype),{value:i});const Bg="en",o_e=["ar","bg","bs","ca","cs","da","de","el",Bg,"es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","no","nl","pl","pt-BR","pt-PT","ro","ru","sk","sl","sr","sv","th","tr","uk","vi","zh-CN","zh-HK","zh-TW"],l_e=["ar","bg","bs","ca","cs","da","de","de-CH","el",Bg,"en-AU","en-CA","en-GB","es","es-MX","et","fi","fr","fr-CH","he","hi","hr","hu","id","it","it-CH","ja","ko","lt","lv","mk","no","nl","pl","pt","pt-PT","ro","ru","sk","sl","sr","sv","th","tr","uk","vi","zh-CN","zh-HK","zh-TW"];new Intl.NumberFormat().resolvedOptions().numberingSystem;function c_e(i,e="cldr"){const t=e==="cldr"?l_e:o_e;return i?t.includes(i)?i:(i=i.toLowerCase(),i==="nb"?"no":e==="t9n"&&i==="pt"?"pt-BR":(i.includes("-")&&(i=i.replace(/(\w+)-(\w+)/,(r,n,s)=>`${n}-${s.toUpperCase()}`),t.includes(i)||(i=i.split("-")[0])),i==="zh"?"zh-CN":t.includes(i)?i:(console.warn(`Translations for the "${i}" locale are not available and will fall back to the default, English (en).`),Bg))):Bg}const nx=new Set;function h_e(i){u_e(i),nx.size===0&&(rE==null||rE.observe(document.documentElement,{attributes:!0,attributeFilter:["lang"],subtree:!0})),nx.add(i)}function u_e(i){i.effectiveLocale=p_e(i)}function d_e(i){nx.delete(i),nx.size===0&&rE.disconnect()}const rE=IN("mutation",i=>{i.forEach(e=>{const t=e.target;nx.forEach(r=>{if(!Bge(t,r.el))return;const s=iT(r.el,"[lang]");if(!s){r.effectiveLocale=Bg;return}const a=s.lang;r.effectiveLocale=s.hasAttribute("lang")&&a===""?Bg:a})})});function p_e(i){var e;return i.el.lang||((e=iT(i.el,"[lang]"))==null?void 0:e.lang)||document.documentElement.lang||Bg}/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.7
 */const XT={};async function m_e(i,e){const t=`${e}_${i}`;return XT[t]||(XT[t]=fetch(BX(`./assets/${e}/t9n/messages_${i}.json`)).then(r=>(r.ok||m6(),r.json())).catch(()=>m6())),XT[t]}function m6(){throw new Error("could not fetch component message bundle")}function LN(i){i.messages={...i.defaultMessages,...i.messageOverrides}}async function f_e(i){i.defaultMessages=await hQ(i,i.effectiveLocale),LN(i)}async function hQ(i,e){const{el:t}=i,n=t.tagName.toLowerCase().replace("calcite-","");return m_e(c_e(e,"t9n"),n)}async function g_e(i,e){i.defaultMessages=await hQ(i,e),LN(i)}function __e(i){i.onMessagesChange=v_e}function y_e(i){i.onMessagesChange=void 0}function v_e(){LN(this)}/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.7
 */const b_e={icon:"icon",flipRtl:"flip-rtl"},gO={},_O={},uQ={s:16,m:24,l:32};async function w_e({icon:i,scale:e}){const t=uQ[e],r=x_e(i),n=r.charAt(r.length-1)==="F",a=`${n?r.substring(0,r.length-1):r}${t}${n?"F":""}`;if(gO[a])return gO[a];_O[a]||(_O[a]=fetch(BX(`./assets/icon/${a}.json`)).then(l=>l.json()).catch(()=>(console.error(`"${a}" is not a valid calcite-ui-icon name`),"")));const o=await _O[a];return gO[a]=o,o}function x_e(i){const e=!isNaN(Number(i.charAt(0))),t=i.split("-");if(t.length>0){const n=/[a-z]/i;i=t.map((s,a)=>s.replace(n,function(l,c){return a===0&&c===0?l:l.toUpperCase()})).join("")}return e?`i${i}`:i}const T_e="@keyframes in{0%{opacity:0}100%{opacity:1}}@keyframes in-down{0%{opacity:0;transform:translate3D(0, -5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-up{0%{opacity:0;transform:translate3D(0, 5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-scale{0%{opacity:0;transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;transform:scale3D(1, 1, 1)}}:root{--calcite-animation-timing:calc(150ms * var(--calcite-internal-duration-factor));--calcite-internal-duration-factor:var(--calcite-duration-factor, 1);--calcite-internal-animation-timing-fast:calc(100ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-medium:calc(200ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-slow:calc(300ms * var(--calcite-internal-duration-factor))}.calcite-animate{opacity:0;animation-fill-mode:both;animation-duration:var(--calcite-animation-timing)}.calcite-animate__in{animation-name:in}.calcite-animate__in-down{animation-name:in-down}.calcite-animate__in-up{animation-name:in-up}.calcite-animate__in-scale{animation-name:in-scale}@media (prefers-reduced-motion: reduce){:root{--calcite-internal-duration-factor:0}}:root{--calcite-floating-ui-transition:var(--calcite-animation-timing);--calcite-floating-ui-z-index:600}:host([hidden]){display:none}:host{display:inline-flex;color:var(--calcite-ui-icon-color)}:host([scale=s]){block-size:1rem;inline-size:1rem;min-inline-size:1rem;min-block-size:1rem}:host([scale=m]){block-size:1.5rem;inline-size:1.5rem;min-inline-size:1.5rem;min-block-size:1.5rem}:host([scale=l]){block-size:2rem;inline-size:2rem;min-inline-size:2rem;min-block-size:2rem}.flip-rtl{transform:scaleX(-1)}.svg{display:block}",C_e=AN(class extends ON{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.icon=null,this.flipRtl=!1,this.scale="m",this.textLabel=void 0,this.pathData=void 0,this.visible=!1}connectedCallback(){this.waitUntilVisible(()=>{this.visible=!0,this.loadIconPathData()})}disconnectedCallback(){var i;(i=this.intersectionObserver)==null||i.disconnect(),this.intersectionObserver=null}async componentWillLoad(){this.loadIconPathData()}render(){const{el:i,flipRtl:e,pathData:t,scale:r,textLabel:n}=this,s=Vge(i),a=uQ[r],o=!!n,l=[].concat(t||"");return Cr(RN,{"aria-hidden":Gge(!o),"aria-label":o?n:null,role:o?"img":null},Cr("svg",{"aria-hidden":"true",class:{[b_e.flipRtl]:s==="rtl"&&e,svg:!0},fill:"currentColor",height:"100%",viewBox:`0 0 ${a} ${a}`,width:"100%",xmlns:"http://www.w3.org/2000/svg"},l.map(c=>typeof c=="string"?Cr("path",{d:c}):Cr("path",{d:c.d,opacity:"opacity"in c?c.opacity:1}))))}async loadIconPathData(){const{icon:i,scale:e,visible:t}=this;!SN.isBrowser||!i||!t||(this.pathData=await w_e({icon:i,scale:e}))}waitUntilVisible(i){if(this.intersectionObserver=IN("intersection",e=>{e.forEach(t=>{t.isIntersecting&&(this.intersectionObserver.disconnect(),this.intersectionObserver=null,i())})},{rootMargin:"50px"}),!this.intersectionObserver){i();return}this.intersectionObserver.observe(this.el)}static get assetsDirs(){return["assets"]}get el(){return this}static get watchers(){return{icon:["loadIconPathData"],scale:["loadIconPathData"]}}static get style(){return T_e}},[1,"calcite-icon",{icon:[513],flipRtl:[516,"flip-rtl"],scale:[513],textLabel:[1,"text-label"],pathData:[32],visible:[32]}]);function dQ(){if(typeof customElements>"u")return;["calcite-icon"].forEach(e=>{switch(e){case"calcite-icon":customElements.get(e)||customElements.define(e,C_e);break}})}dQ();/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.7
 */const S_e='@charset "UTF-8";@keyframes in{0%{opacity:0}100%{opacity:1}}@keyframes in-down{0%{opacity:0;transform:translate3D(0, -5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-up{0%{opacity:0;transform:translate3D(0, 5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-scale{0%{opacity:0;transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;transform:scale3D(1, 1, 1)}}:root{--calcite-animation-timing:calc(150ms * var(--calcite-internal-duration-factor));--calcite-internal-duration-factor:var(--calcite-duration-factor, 1);--calcite-internal-animation-timing-fast:calc(100ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-medium:calc(200ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-slow:calc(300ms * var(--calcite-internal-duration-factor))}.calcite-animate{opacity:0;animation-fill-mode:both;animation-duration:var(--calcite-animation-timing)}.calcite-animate__in{animation-name:in}.calcite-animate__in-down{animation-name:in-down}.calcite-animate__in-up{animation-name:in-up}.calcite-animate__in-scale{animation-name:in-scale}@media (prefers-reduced-motion: reduce){:root{--calcite-internal-duration-factor:0}}:root{--calcite-floating-ui-transition:var(--calcite-animation-timing);--calcite-floating-ui-z-index:600}:host([hidden]){display:none}:host{position:relative;margin-inline:auto;display:none;align-items:center;justify-content:center;opacity:1;min-block-size:var(--calcite-loader-size);font-size:var(--calcite-loader-font-size);stroke:var(--calcite-ui-brand);stroke-width:3;fill:none;transform:scale(1, 1);animation:loader-color-shift calc(var(--calcite-internal-animation-timing-slow) * 2) alternate-reverse infinite linear;padding-block:var(--calcite-loader-padding, 4rem)}:host([scale=s]){--calcite-loader-font-size:var(--calcite-font-size--2);--calcite-loader-size:2rem;--calcite-loader-size-inline:0.75rem}:host([scale=m]){--calcite-loader-font-size:var(--calcite-font-size-0);--calcite-loader-size:4rem;--calcite-loader-size-inline:1rem}:host([scale=l]){--calcite-loader-font-size:var(--calcite-font-size-2);--calcite-loader-size:6rem;--calcite-loader-size-inline:1.5rem}:host([no-padding]){padding-block:0px}:host{display:flex}.loader__text{display:block;text-align:center;font-size:var(--calcite-font-size--2);line-height:1rem;color:var(--calcite-ui-text-1);margin-block-start:calc(var(--calcite-loader-size) + 1.5rem)}.loader__percentage{position:absolute;display:block;text-align:center;color:var(--calcite-ui-text-1);font-size:var(--calcite-loader-font-size);inline-size:var(--calcite-loader-size);inset-inline-start:50%;margin-inline-start:calc(var(--calcite-loader-size) / 2 * -1);line-height:0.25;transform:scale(1, 1)}.loader__svgs{position:absolute;overflow:visible;opacity:1;inline-size:var(--calcite-loader-size);block-size:var(--calcite-loader-size);inset-inline-start:50%;margin-inline-start:calc(var(--calcite-loader-size) / 2 * -1);transform:scale(1, 1)}.loader__svg{position:absolute;inset-block-start:0px;transform-origin:center;overflow:visible;inset-inline-start:0;inline-size:var(--calcite-loader-size);block-size:var(--calcite-loader-size);animation-iteration-count:infinite;animation-timing-function:linear;animation-name:loader-clockwise}@supports (display: grid){.loader__svg--1{animation-name:loader-offset-1}.loader__svg--2{animation-name:loader-offset-2}.loader__svg--3{animation-name:loader-offset-3}}:host([type=determinate]){animation:none;stroke:var(--calcite-ui-border-3)}:host([type=determinate]) .loader__svg--3{animation:none;stroke:var(--calcite-ui-brand);stroke-dasharray:150.79632;transform:rotate(-90deg);transition:all var(--calcite-internal-animation-timing-fast) linear}:host([inline]){position:relative;margin:0px;animation:none;stroke:currentColor;stroke-width:2;padding-block:0px;block-size:var(--calcite-loader-size-inline);min-block-size:var(--calcite-loader-size-inline);inline-size:var(--calcite-loader-size-inline);margin-inline-end:calc(var(--calcite-loader-size-inline) * 0.5);vertical-align:calc(var(--calcite-loader-size-inline) * -1 * 0.2)}:host([inline]) .loader__svgs{inset-block-start:0px;margin:0px;inset-inline-start:0;inline-size:var(--calcite-loader-size-inline);block-size:var(--calcite-loader-size-inline)}:host([inline]) .loader__svg{inline-size:var(--calcite-loader-size-inline);block-size:var(--calcite-loader-size-inline)}:host([complete]){opacity:0;transform:scale(0.75, 0.75);transform-origin:center;transition:opacity var(--calcite-internal-animation-timing-medium) linear 1000ms, transform var(--calcite-internal-animation-timing-medium) linear 1000ms}:host([complete]) .loader__svgs{opacity:0;transform:scale(0.75, 0.75);transform-origin:center;transition:opacity calc(180ms * var(--calcite-internal-duration-factor)) linear 800ms, transform calc(180ms * var(--calcite-internal-duration-factor)) linear 800ms}:host([complete]) .loader__percentage{color:var(--calcite-ui-brand);transform:scale(1.05, 1.05);transform-origin:center;transition:color var(--calcite-internal-animation-timing-medium) linear, transform var(--calcite-internal-animation-timing-medium) linear}.loader__svg--1{stroke-dasharray:27.9252444444% 139.6262222222%;animation-duration:calc(var(--calcite-internal-animation-timing-slow) * 2.4)}@keyframes loader-offset-1{0%{stroke-dasharray:27.9252444444% 251.3272%;stroke-dashoffset:0}50%{stroke-dasharray:139.6262222222% 139.6262222222%;stroke-dashoffset:-83.7757333333%}100%{stroke-dasharray:27.9252444444% 251.3272%;stroke-dashoffset:-279.2524444444%}}.loader__svg--2{stroke-dasharray:55.8504888889% 139.6262222222%;animation-duration:calc(var(--calcite-internal-animation-timing-slow) * 3.2)}@keyframes loader-offset-2{0%{stroke-dasharray:55.8504888889% 223.4019555556%;stroke-dashoffset:0}50%{stroke-dasharray:139.6262222222% 139.6262222222%;stroke-dashoffset:-97.7383555556%}100%{stroke-dasharray:55.8504888889% 223.4019555556%;stroke-dashoffset:-279.2524444444%}}.loader__svg--3{stroke-dasharray:13.9626222222% 139.6262222222%;animation-duration:calc(var(--calcite-internal-animation-timing-slow) * 3.867)}@keyframes loader-offset-3{0%{stroke-dasharray:13.9626222222% 265.2898222222%;stroke-dashoffset:0}50%{stroke-dasharray:139.6262222222% 139.6262222222%;stroke-dashoffset:-76.7944222222%}100%{stroke-dasharray:13.9626222222% 265.2898222222%;stroke-dashoffset:-279.2524444444%}}@keyframes loader-color-shift{0%{stroke:var(--calcite-ui-brand)}33%{stroke:var(--calcite-ui-brand-press)}66%{stroke:var(--calcite-ui-brand-hover)}100%{stroke:var(--calcite-ui-brand)}}@keyframes loader-clockwise{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}',E_e=AN(class extends ON{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.inline=!1,this.label=void 0,this.scale="m",this.type=void 0,this.value=0,this.text=""}render(){const{el:i,inline:e,label:t,scale:r,text:n,type:s,value:a}=this,o=i.id||Fge(),l=.45,c=e?this.getInlineSize(r):this.getSize(r),u=c*l,d=`0 0 ${c} ${c}`,m=s==="determinate",f=2*u*Math.PI,_=a/100*f,g=f-_,w=Math.floor(a),v={"aria-valuenow":w,"aria-valuemin":0,"aria-valuemax":100,complete:w===100},b={r:u,cx:c/2,cy:c/2},x={"stroke-dasharray":`${_} ${g}`};return Cr(RN,{"aria-label":t,id:o,role:"progressbar",...m?v:{}},Cr("div",{class:"loader__svgs"},Cr("svg",{"aria-hidden":"true",class:"loader__svg loader__svg--1",viewBox:d},Cr("circle",{...b})),Cr("svg",{"aria-hidden":"true",class:"loader__svg loader__svg--2",viewBox:d},Cr("circle",{...b})),Cr("svg",{"aria-hidden":"true",class:"loader__svg loader__svg--3",viewBox:d,...m?{style:x}:{}},Cr("circle",{...b}))),n&&Cr("div",{class:"loader__text"},n),m&&Cr("div",{class:"loader__percentage"},a))}getSize(i){return{s:32,m:56,l:80}[i]}getInlineSize(i){return{s:12,m:16,l:20}[i]}get el(){return this}static get style(){return S_e}},[1,"calcite-loader",{inline:[516],label:[1],scale:[513],type:[513],value:[2],text:[1]}]);function pQ(){if(typeof customElements>"u")return;["calcite-loader"].forEach(e=>{switch(e){case"calcite-loader":customElements.get(e)||customElements.define(e,E_e);break}})}pQ();/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.7
 */(function(i){if(typeof i.requestSubmit=="function")return;i.requestSubmit=function(r){r?(e(r,this),r.click()):(r=document.createElement("input"),r.type="submit",r.hidden=!0,this.appendChild(r),r.click(),this.removeChild(r))};function e(r,n){r instanceof HTMLElement||t(TypeError,"parameter 1 is not of type 'HTMLElement'"),r.type=="submit"||t(TypeError,"The specified element is not a submit button"),r.form==n||t(DOMException,"The specified element is not owned by this form element","NotFoundError")}function t(r,n,s){throw new r("Failed to execute 'requestSubmit' on 'HTMLFormElement': "+n+".",s)}})(HTMLFormElement.prototype);const Co={buttonLoader:"calcite-button--loader",content:"content",contentSlotted:"content--slotted",icon:"icon",iconStart:"icon--start",iconEnd:"icon--end",loadingIn:"loading-in",loadingOut:"loading-out",iconStartEmpty:"icon-start-empty",iconEndEmpty:"icon-end-empty",buttonPadding:"button-padding",buttonPaddingShrunk:"button-padding--shrunk"},R_e="@keyframes in{0%{opacity:0}100%{opacity:1}}@keyframes in-down{0%{opacity:0;transform:translate3D(0, -5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-up{0%{opacity:0;transform:translate3D(0, 5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-scale{0%{opacity:0;transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;transform:scale3D(1, 1, 1)}}:root{--calcite-animation-timing:calc(150ms * var(--calcite-internal-duration-factor));--calcite-internal-duration-factor:var(--calcite-duration-factor, 1);--calcite-internal-animation-timing-fast:calc(100ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-medium:calc(200ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-slow:calc(300ms * var(--calcite-internal-duration-factor))}.calcite-animate{opacity:0;animation-fill-mode:both;animation-duration:var(--calcite-animation-timing)}.calcite-animate__in{animation-name:in}.calcite-animate__in-down{animation-name:in-down}.calcite-animate__in-up{animation-name:in-up}.calcite-animate__in-scale{animation-name:in-scale}@media (prefers-reduced-motion: reduce){:root{--calcite-internal-duration-factor:0}}:root{--calcite-floating-ui-transition:var(--calcite-animation-timing);--calcite-floating-ui-z-index:600}:host([hidden]){display:none}:host([disabled]){pointer-events:none;cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-ui-opacity-disabled)}:host{display:inline-block;inline-size:auto;vertical-align:middle}:host([round]){border-radius:50px}:host([round]) a,:host([round]) button{border-radius:50px}:host button,:host a{outline-color:transparent}:host button:focus,:host a:focus{outline:2px solid var(--calcite-ui-brand);outline-offset:2px}:host button,:host a{--calcite-button-content-margin-internal:0.5rem;--calcite-button-padding-x-internal:7px;--calcite-button-padding-y-internal:3px;padding-block:var(--calcite-button-padding-y-internal);padding-inline:var(--calcite-button-padding-x-internal);position:relative;box-sizing:border-box;display:flex;block-size:100%;inline-size:100%;cursor:pointer;-webkit-user-select:none;user-select:none;-webkit-appearance:none;appearance:none;align-items:center;justify-content:center;border-radius:0px;border-style:none;text-align:center;font-family:inherit;font-weight:var(--calcite-font-weight-normal);text-decoration-line:none;transition:color var(--calcite-animation-timing) ease-in-out, background-color var(--calcite-animation-timing) ease-in-out, box-shadow var(--calcite-animation-timing) ease-in-out, outline-color var(--calcite-internal-animation-timing-fast) ease-in-out}:host button:hover,:host a:hover{text-decoration-line:none}.content{display:flex;flex-basis:auto;margin-inline:var(--calcite-button-content-margin-internal)}.icon-start-empty .content{margin-inline-start:unset}.icon-end-empty .content{margin-inline-end:unset}:host([scale=m]) button,:host([scale=m]) a{--calcite-button-content-margin-internal:0.75rem}:host([scale=l]) button,:host([scale=l]) a{--calcite-button-content-margin-internal:1rem}:host([width=auto]){inline-size:auto}:host([width=half]){inline-size:50%}:host([width=full]){inline-size:100%}:host([alignment=center]:not([width=auto])) a,:host([alignment=center]:not([width=auto])) button{justify-content:center}:host([alignment=start]:not([width=auto])) a,:host([alignment=start]:not([width=auto])) button{justify-content:flex-start}:host([alignment=end]:not([width=auto])) a,:host([alignment=end]:not([width=auto])) button{justify-content:flex-end}:host([alignment*=space-between]:not([width=auto])) a,:host([alignment*=space-between]:not([width=auto])) button{justify-content:space-between}:host([alignment=icon-start-space-between]:not([width=auto])) .icon--start{margin-inline-end:auto}:host([alignment=icon-start-space-between]:not([width=auto])) a,:host([alignment=icon-start-space-between]:not([width=auto])) button{text-align:unset}:host([alignment=icon-end-space-between]:not([width=auto])) .icon--end{margin-inline-start:auto}:host([alignment=icon-end-space-between]:not([width=auto])) a,:host([alignment=icon-end-space-between]:not([width=auto])) button{text-align:unset}:host([alignment=center]) a:not(.content--slotted) .icon--start+.icon--end,:host([alignment=center]) button:not(.content--slotted) .icon--start+.icon--end{margin-inline-start:var(--calcite-button-content-margin-internal)}.icon{position:relative;margin:0px;display:inline-flex;font-weight:var(--calcite-font-weight-normal);line-height:inherit}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}:host([loading]){pointer-events:none}:host([loading]) button,:host([loading]) a{pointer-events:none;opacity:var(--calcite-ui-opacity-disabled)}@keyframes loader-in{0%{inline-size:0;opacity:0;transform:scale(0.5)}100%{inline-size:1em;opacity:1;transform:scale(1)}}@keyframes loader-out{0%{inline-size:1em;opacity:1;transform:scale(1)}100%{inline-size:0;opacity:0;transform:scale(0.5)}}.calcite-button--loader{display:flex}.calcite-button--loader calcite-loader{margin:0px;transition:inline-size var(--calcite-internal-animation-timing-slow) ease-in-out, opacity var(--calcite-internal-animation-timing-slow) ease-in-out, transform var(--calcite-internal-animation-timing-slow) ease-in-out}.calcite-button--loader calcite-loader.loading-in{animation-name:loader-in;animation-duration:var(--calcite-internal-animation-timing-slow)}.calcite-button--loader calcite-loader.loading-out{animation-name:loader-out;animation-duration:var(--calcite-internal-animation-timing-slow)}:host([loading]) button.content--slotted .calcite-button--loader calcite-loader,:host([loading]) a.content--slotted .calcite-button--loader calcite-loader{margin-inline-end:var(--calcite-button-content-margin-internal)}:host([loading]) button:not(.content--slotted) .icon--start,:host([loading]) button:not(.content--slotted) .icon--end,:host([loading]) a:not(.content--slotted) .icon--start,:host([loading]) a:not(.content--slotted) .icon--end{display:none}:host([appearance]) button,:host([appearance]) a{border-width:1px;border-style:solid;border-color:transparent}:host([kind=brand]) button,:host([kind=brand]) a{background-color:var(--calcite-ui-brand);color:var(--calcite-ui-text-inverse)}:host([kind=brand]) button:hover,:host([kind=brand]) button:focus,:host([kind=brand]) a:hover,:host([kind=brand]) a:focus{background-color:var(--calcite-ui-brand-hover)}:host([kind=brand]) button:active,:host([kind=brand]) a:active{background-color:var(--calcite-ui-brand-press)}:host([kind=brand]) button calcite-loader,:host([kind=brand]) a calcite-loader{color:var(--calcite-ui-text-inverse)}:host([kind=danger]) button,:host([kind=danger]) a{background-color:var(--calcite-ui-danger);color:var(--calcite-ui-text-inverse)}:host([kind=danger]) button:hover,:host([kind=danger]) button:focus,:host([kind=danger]) a:hover,:host([kind=danger]) a:focus{background-color:var(--calcite-ui-danger-hover)}:host([kind=danger]) button:active,:host([kind=danger]) a:active{background-color:var(--calcite-ui-danger-press)}:host([kind=danger]) button calcite-loader,:host([kind=danger]) a calcite-loader{color:var(--calcite-ui-text-inverse)}:host([kind=neutral]) button,:host([kind=neutral]) a{background-color:var(--calcite-ui-foreground-3);color:var(--calcite-ui-text-1)}:host([kind=neutral]) button:hover,:host([kind=neutral]) button:focus,:host([kind=neutral]) a:hover,:host([kind=neutral]) a:focus{background-color:var(--calcite-ui-foreground-2)}:host([kind=neutral]) button:active,:host([kind=neutral]) a:active{background-color:var(--calcite-ui-foreground-1)}:host([kind=neutral]) button calcite-loader,:host([kind=neutral]) a calcite-loader{color:var(--calcite-ui-text-1)}:host([kind=inverse]) button,:host([kind=inverse]) a{color:var(--calcite-ui-text-inverse);background-color:var(--calcite-ui-inverse)}:host([kind=inverse]) button:hover,:host([kind=inverse]) button:focus,:host([kind=inverse]) a:hover,:host([kind=inverse]) a:focus{background-color:var(--calcite-ui-inverse-hover)}:host([kind=inverse]) button:active,:host([kind=inverse]) a:active{background-color:var(--calcite-ui-inverse-press)}:host([kind=inverse]) button calcite-loader,:host([kind=inverse]) a calcite-loader{color:var(--calcite-ui-text-inverse)}:host([appearance=outline-fill]) button,:host([appearance=outline-fill]) a{border-width:1px;border-style:solid;background-color:var(--calcite-ui-foreground-1);box-shadow:inset 0 0 0 1px transparent}:host([appearance=outline-fill][kind=brand]) button,:host([appearance=outline-fill][kind=brand]) a{border-color:var(--calcite-ui-brand);background-color:var(--calcite-ui-foreground-1);color:var(--calcite-ui-brand)}:host([appearance=outline-fill][kind=brand]) button:hover,:host([appearance=outline-fill][kind=brand]) a:hover{border-color:var(--calcite-ui-brand-hover);color:var(--calcite-ui-brand-hover);box-shadow:inset 0 0 0 1px var(--calcite-ui-brand-hover)}:host([appearance=outline-fill][kind=brand]) button:focus,:host([appearance=outline-fill][kind=brand]) a:focus{border-color:var(--calcite-ui-brand);color:var(--calcite-ui-brand);box-shadow:inset 0 0 0 2px var(--calcite-ui-brand)}:host([appearance=outline-fill][kind=brand]) button:active,:host([appearance=outline-fill][kind=brand]) a:active{border-color:var(--calcite-ui-brand-press);color:var(--calcite-ui-brand-press);box-shadow:inset 0 0 0 2px var(--calcite-ui-brand-press)}:host([appearance=outline-fill][kind=brand]) button calcite-loader,:host([appearance=outline-fill][kind=brand]) a calcite-loader{color:var(--calcite-ui-brand)}:host([appearance=outline-fill][kind=danger]) button,:host([appearance=outline-fill][kind=danger]) a{border-color:var(--calcite-ui-danger);background-color:var(--calcite-ui-foreground-1);color:var(--calcite-ui-danger)}:host([appearance=outline-fill][kind=danger]) button:hover,:host([appearance=outline-fill][kind=danger]) a:hover{border-color:var(--calcite-ui-danger-hover);color:var(--calcite-ui-danger-hover);box-shadow:inset 0 0 0 1px var(--calcite-ui-danger-hover)}:host([appearance=outline-fill][kind=danger]) button:focus,:host([appearance=outline-fill][kind=danger]) a:focus{border-color:var(--calcite-ui-danger);color:var(--calcite-ui-danger);box-shadow:inset 0 0 0 2px var(--calcite-ui-danger)}:host([appearance=outline-fill][kind=danger]) button:active,:host([appearance=outline-fill][kind=danger]) a:active{border-color:var(--calcite-ui-danger-press);color:var(--calcite-ui-danger-press);box-shadow:inset 0 0 0 2px var(--calcite-ui-danger-press)}:host([appearance=outline-fill][kind=danger]) button calcite-loader,:host([appearance=outline-fill][kind=danger]) a calcite-loader{color:var(--calcite-ui-danger)}:host([appearance=outline-fill][kind=neutral]) button,:host([appearance=outline-fill][kind=neutral]) a{background-color:var(--calcite-ui-foreground-1);color:var(--calcite-ui-text-1);border-color:var(--calcite-ui-foreground-3)}:host([appearance=outline-fill][kind=neutral]) button:hover,:host([appearance=outline-fill][kind=neutral]) a:hover{box-shadow:inset 0 0 0 1px var(--calcite-ui-foreground-3)}:host([appearance=outline-fill][kind=neutral]) button:focus,:host([appearance=outline-fill][kind=neutral]) a:focus{box-shadow:inset 0 0 0 2px var(--calcite-ui-foreground-3)}:host([appearance=outline-fill][kind=neutral]) button:active,:host([appearance=outline-fill][kind=neutral]) a:active{box-shadow:inset 0 0 0 2px var(--calcite-ui-foreground-3)}:host([appearance=outline-fill][kind=neutral]) button calcite-loader,:host([appearance=outline-fill][kind=neutral]) a calcite-loader{color:var(--calcite-ui-text-1)}:host([appearance=outline-fill][kind=inverse]) button,:host([appearance=outline-fill][kind=inverse]) a{background-color:var(--calcite-ui-foreground-1);color:var(--calcite-ui-text-1);border-color:var(--calcite-ui-inverse)}:host([appearance=outline-fill][kind=inverse]) button:hover,:host([appearance=outline-fill][kind=inverse]) a:hover{border-color:var(--calcite-ui-inverse-hover);box-shadow:inset 0 0 0 1px var(--calcite-ui-inverse-hover)}:host([appearance=outline-fill][kind=inverse]) button:focus,:host([appearance=outline-fill][kind=inverse]) a:focus{border-color:var(--calcite-ui-inverse);box-shadow:inset 0 0 0 2px var(--calcite-ui-inverse)}:host([appearance=outline-fill][kind=inverse]) button:active,:host([appearance=outline-fill][kind=inverse]) a:active{border-color:var(--calcite-ui-inverse-press);box-shadow:inset 0 0 0 2px var(--calcite-ui-inverse-press)}:host([appearance=outline-fill][kind=inverse]) button calcite-loader,:host([appearance=outline-fill][kind=inverse]) a calcite-loader{color:var(--calcite-ui-text-1)}:host([appearance=outline]) button,:host([appearance=outline]) a{border-width:1px;border-style:solid;background-color:transparent;box-shadow:inset 0 0 0 1px transparent}:host([appearance=outline][kind=brand]) button,:host([appearance=outline][kind=brand]) a{border-color:var(--calcite-ui-brand);background-color:transparent;color:var(--calcite-ui-brand)}:host([appearance=outline][kind=brand]) button:hover,:host([appearance=outline][kind=brand]) a:hover{border-color:var(--calcite-ui-brand-hover);color:var(--calcite-ui-brand-hover);box-shadow:inset 0 0 0 1px var(--calcite-ui-brand-hover)}:host([appearance=outline][kind=brand]) button:focus,:host([appearance=outline][kind=brand]) a:focus{border-color:var(--calcite-ui-brand);color:var(--calcite-ui-brand);box-shadow:inset 0 0 0 2px var(--calcite-ui-brand)}:host([appearance=outline][kind=brand]) button:active,:host([appearance=outline][kind=brand]) a:active{border-color:var(--calcite-ui-brand-press);color:var(--calcite-ui-brand-press);box-shadow:inset 0 0 0 2px var(--calcite-ui-brand-press)}:host([appearance=outline][kind=brand]) button calcite-loader,:host([appearance=outline][kind=brand]) a calcite-loader{color:var(--calcite-ui-brand)}:host([appearance=outline][kind=danger]) button,:host([appearance=outline][kind=danger]) a{border-color:var(--calcite-ui-danger);background-color:transparent;color:var(--calcite-ui-danger)}:host([appearance=outline][kind=danger]) button:hover,:host([appearance=outline][kind=danger]) a:hover{border-color:var(--calcite-ui-danger-hover);color:var(--calcite-ui-danger-hover);box-shadow:inset 0 0 0 1px var(--calcite-ui-danger-hover)}:host([appearance=outline][kind=danger]) button:focus,:host([appearance=outline][kind=danger]) a:focus{border-color:var(--calcite-ui-danger);color:var(--calcite-ui-danger);box-shadow:inset 0 0 0 2px var(--calcite-ui-danger)}:host([appearance=outline][kind=danger]) button:active,:host([appearance=outline][kind=danger]) a:active{border-color:var(--calcite-ui-danger-press);color:var(--calcite-ui-danger-press);box-shadow:inset 0 0 0 2px var(--calcite-ui-danger-press)}:host([appearance=outline][kind=danger]) button calcite-loader,:host([appearance=outline][kind=danger]) a calcite-loader{color:var(--calcite-ui-danger)}:host([appearance=outline][kind=neutral]) button,:host([appearance=outline][kind=neutral]) a{background-color:transparent;color:var(--calcite-ui-text-1);border-color:var(--calcite-ui-border-1)}:host([appearance=outline][kind=neutral]) button:hover,:host([appearance=outline][kind=neutral]) a:hover{box-shadow:inset 0 0 0 1px var(--calcite-ui-foreground-3)}:host([appearance=outline][kind=neutral]) button:focus,:host([appearance=outline][kind=neutral]) a:focus{box-shadow:inset 0 0 0 2px var(--calcite-ui-foreground-3)}:host([appearance=outline][kind=neutral]) button:active,:host([appearance=outline][kind=neutral]) a:active{box-shadow:inset 0 0 0 2px var(--calcite-ui-foreground-3)}:host([appearance=outline][kind=neutral]) button calcite-loader,:host([appearance=outline][kind=neutral]) a calcite-loader{color:var(--calcite-ui-text-1)}:host([appearance=outline][kind=inverse]) button,:host([appearance=outline][kind=inverse]) a{background-color:transparent;color:var(--calcite-ui-text-1);border-color:var(--calcite-ui-inverse)}:host([appearance=outline][kind=inverse]) button:hover,:host([appearance=outline][kind=inverse]) a:hover{border-color:var(--calcite-ui-inverse-hover);box-shadow:inset 0 0 0 1px var(--calcite-ui-inverse-hover)}:host([appearance=outline][kind=inverse]) button:focus,:host([appearance=outline][kind=inverse]) a:focus{border-color:var(--calcite-ui-inverse);box-shadow:inset 0 0 0 2px var(--calcite-ui-inverse)}:host([appearance=outline][kind=inverse]) button:active,:host([appearance=outline][kind=inverse]) a:active{border-color:var(--calcite-ui-inverse-press);box-shadow:inset 0 0 0 2px var(--calcite-ui-inverse-press)}:host([appearance=outline][kind=inverse]) button calcite-loader,:host([appearance=outline][kind=inverse]) a calcite-loader{color:var(--calcite-ui-text-1)}:host([appearance=outline-fill][split-child=primary]) button,:host([appearance=outline][split-child=primary]) button{border-inline-end-width:0;border-inline-start-width:1px}:host([appearance=outline-fill][split-child=secondary]) button,:host([appearance=outline][split-child=secondary]) button{border-inline-start-width:0;border-inline-end-width:1px}:host([appearance=transparent]:not(.enable-editing-button)) button,:host([appearance=transparent]:not(.enable-editing-button)) a{background-color:transparent}:host([appearance=transparent]:not(.enable-editing-button)) button:hover,:host([appearance=transparent]:not(.enable-editing-button)) button:focus,:host([appearance=transparent]:not(.enable-editing-button)) a:hover,:host([appearance=transparent]:not(.enable-editing-button)) a:focus{background-color:var(--calcite-button-transparent-hover)}:host([appearance=transparent]:not(.enable-editing-button)) button:active,:host([appearance=transparent]:not(.enable-editing-button)) a:active{background-color:var(--calcite-button-transparent-press)}:host([appearance=transparent][kind=brand]) button,:host([appearance=transparent][kind=brand]) a{color:var(--calcite-ui-brand)}:host([appearance=transparent][kind=brand]) button:hover,:host([appearance=transparent][kind=brand]) a:hover{color:var(--calcite-ui-brand-hover)}:host([appearance=transparent][kind=brand]) button:focus,:host([appearance=transparent][kind=brand]) a:focus{color:var(--calcite-ui-brand)}:host([appearance=transparent][kind=brand]) button:active,:host([appearance=transparent][kind=brand]) a:active{color:var(--calcite-ui-brand-press)}:host([appearance=transparent][kind=brand]) button calcite-loader,:host([appearance=transparent][kind=brand]) a calcite-loader{color:var(--calcite-ui-brand)}:host([appearance=transparent][kind=danger]) button,:host([appearance=transparent][kind=danger]) a{color:var(--calcite-ui-danger)}:host([appearance=transparent][kind=danger]) button:hover,:host([appearance=transparent][kind=danger]) a:hover{color:var(--calcite-ui-danger-hover)}:host([appearance=transparent][kind=danger]) button:focus,:host([appearance=transparent][kind=danger]) a:focus{color:var(--calcite-ui-danger)}:host([appearance=transparent][kind=danger]) button:active,:host([appearance=transparent][kind=danger]) a:active{color:var(--calcite-ui-danger-press)}:host([appearance=transparent][kind=danger]) button calcite-loader,:host([appearance=transparent][kind=danger]) a calcite-loader{color:var(--calcite-ui-danger)}:host([appearance=transparent][kind=neutral]:not(.cancel-editing-button)) button,:host([appearance=transparent][kind=neutral]:not(.cancel-editing-button)) a,:host([appearance=transparent][kind=neutral]:not(.cancel-editing-button)) calcite-loader{color:var(--calcite-ui-text-1)}:host([appearance=transparent][kind=neutral].cancel-editing-button) button{border-block-start-width:1px;border-block-end-width:1px;color:var(--calcite-ui-text-3);border-block-start-color:var(--calcite-ui-border-input);border-block-end-color:var(--calcite-ui-border-input);border-block-style:solid}:host([appearance=transparent][kind=neutral].cancel-editing-button) button:not(.content--slotted){--calcite-button-padding-y-internal:0}:host([appearance=transparent][kind=neutral].cancel-editing-button) button:hover{color:var(--calcite-ui-text-1)}:host([appearance=transparent][kind=neutral].enable-editing-button) button{background-color:transparent}:host(.confirm-changes-button) button:focus,:host(.cancel-editing-button) button:focus,:host(.enable-editing-button) button:focus{outline-offset:-2px}:host([appearance=transparent][kind=inverse]) button,:host([appearance=transparent][kind=inverse]) a,:host([appearance=transparent][kind=inverse]) calcite-loader{color:var(--calcite-ui-text-inverse)}:host([scale=s]) button.content--slotted,:host([scale=s]) a.content--slotted{font-size:var(--calcite-font-size--2);line-height:1rem}:host([scale=s][appearance=transparent]) button.content--slotted,:host([scale=s][appearance=transparent]) a.content--slotted{--calcite-button-padding-x-internal:0.5rem}:host([scale=s]) button,:host([scale=s]) a{--calcite-button-padding-y-internal:3px}:host([scale=m]) button.content--slotted,:host([scale=m]) a.content--slotted{--calcite-button-padding-x-internal:11px;font-size:var(--calcite-font-size--1);line-height:1rem}:host([scale=m]) button,:host([scale=m]) a{--calcite-button-padding-y-internal:7px}:host([scale=m][appearance=transparent]) button.content--slotted,:host([scale=m][appearance=transparent]) a.content--slotted{--calcite-button-padding-x-internal:0.75rem}:host([scale=l]) button.content--slotted,:host([scale=l]) a.content--slotted{--calcite-button-padding-x-internal:15px;font-size:var(--calcite-font-size-0);line-height:1.25rem}:host([scale=l]) .button-padding{--calcite-button-padding-x-internal:1rem;--calcite-button-padding-y-internal:11px}:host([scale=l]) .button-padding--shrunk{--calcite-button-padding-y-internal:9px}:host([scale=s]) button:not(.content--slotted),:host([scale=s]) a:not(.content--slotted){--calcite-button-padding-x-internal:0.125rem;--calcite-button-padding-y-internal:3px;inline-size:1.5rem;font-size:var(--calcite-font-size-0);line-height:1.25rem;min-block-size:1.5rem}:host([scale=m]) button:not(.content--slotted),:host([scale=m]) a:not(.content--slotted){--calcite-button-padding-x-internal:0.125rem;--calcite-button-padding-y-internal:7px;inline-size:2rem;font-size:var(--calcite-font-size-0);line-height:1.25rem;min-block-size:2rem}:host([scale=l]) button:not(.content--slotted),:host([scale=l]) a:not(.content--slotted){--calcite-button-padding-x-internal:0.125rem;--calcite-button-padding-y-internal:9px;inline-size:2.75rem;font-size:var(--calcite-font-size-0);line-height:1.25rem;min-block-size:2.75rem}:host([scale=l][appearance=transparent]) button:not(.content--slotted),:host([scale=l][appearance=transparent]) a:not(.content--slotted){--calcite-button-padding-y-internal:0.625rem}:host([scale=s][icon-start][icon-end]) button:not(.content--slotted),:host([scale=s][icon-start][icon-end]) a:not(.content--slotted){--calcite-button-padding-x-internal:23px;block-size:1.5rem;font-size:var(--calcite-font-size-0);line-height:1.25rem}:host([scale=s][icon-start][icon-end][appearance=transparent]) button:not(.content--slotted),:host([scale=s][icon-start][icon-end][appearance=transparent]) a:not(.content--slotted){--calcite-button-padding-x-internal:1.5rem}:host([scale=m][icon-start][icon-end]) button:not(.content--slotted),:host([scale=m][icon-start][icon-end]) a:not(.content--slotted){--calcite-button-padding-x-internal:2rem;block-size:2rem;font-size:var(--calcite-font-size-0);line-height:1.25rem}:host([scale=m][icon-start][icon-end][appearance=transparent]) button:not(.content--slotted),:host([scale=m][icon-start][icon-end][appearance=transparent]) a:not(.content--slotted){--calcite-button-padding-x-internal:33px}:host([scale=l][icon-start][icon-end]) button:not(.content--slotted),:host([scale=l][icon-start][icon-end]) a:not(.content--slotted){--calcite-button-padding-x-internal:43px;block-size:2.75rem;font-size:var(--calcite-font-size-0);line-height:1.25rem}:host([scale=l][icon-start][icon-end]) button:not(.content--slotted) .icon--start+.icon--end,:host([scale=l][icon-start][icon-end]) a:not(.content--slotted) .icon--start+.icon--end{margin-inline-start:1rem}:host([scale=l][icon-start][icon-end][appearance=transparent]) button:not(.content--slotted),:host([scale=l][icon-start][icon-end][appearance=transparent]) a:not(.content--slotted){--calcite-button-padding-x-internal:2.75rem}",P_e=AN(class extends ON{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.mutationObserver=IN("mutation",()=>this.updateHasContent()),this.handleClick=()=>{const{type:i}=this;this.href||(i==="submit"?Hge(this):i==="reset"&&jge(this))},this.alignment="center",this.appearance="solid",this.label=void 0,this.kind="brand",this.disabled=!1,this.href=void 0,this.iconEnd=void 0,this.iconFlipRtl=void 0,this.iconStart=void 0,this.loading=!1,this.name=void 0,this.rel=void 0,this.round=!1,this.scale="m",this.splitChild=!1,this.target=void 0,this.type="button",this.width="auto",this.messages=void 0,this.messageOverrides=void 0,this.hasContent=!1,this.hasLoader=!1,this.effectiveLocale="",this.defaultMessages=void 0}loadingChanged(i,e){i&&!e&&(this.hasLoader=!0),!i&&e&&window.setTimeout(()=>{this.hasLoader=!1},300)}onMessagesChange(){}async connectedCallback(){h_e(this),__e(this),this.hasLoader=this.loading,this.setupTextContentObserver(),oQ(this),this.formEl=iT(this.el,"form")}disconnectedCallback(){var i;(i=this.mutationObserver)==null||i.disconnect(),Zge(this),d_e(this),y_e(this),this.formEl=null}async componentWillLoad(){t_e(this),SN.isBrowser&&(this.updateHasContent(),await f_e(this))}componentDidLoad(){i_e(this)}componentDidRender(){Wge(this)}render(){const i=this.href?"a":"button",e=i,t=this.hasLoader?Cr("div",{class:Co.buttonLoader},Cr("calcite-loader",{class:this.loading?Co.loadingIn:Co.loadingOut,inline:!0,label:this.messages.loading,scale:this.scale==="l"?"m":"s"})):null,r=!this.iconStart&&!this.iconEnd,n=Cr("calcite-icon",{class:{[Co.icon]:!0,[Co.iconStart]:!0},flipRtl:this.iconFlipRtl==="start"||this.iconFlipRtl==="both",icon:this.iconStart,scale:this.scale==="l"?"m":"s"}),s=Cr("calcite-icon",{class:{[Co.icon]:!0,[Co.iconEnd]:!0},flipRtl:this.iconFlipRtl==="end"||this.iconFlipRtl==="both",icon:this.iconEnd,scale:this.scale==="l"?"m":"s"}),a=Cr("span",{class:Co.content},Cr("slot",null));return Cr(e,{"aria-label":Yge(this),class:{[Co.buttonPadding]:r,[Co.buttonPaddingShrunk]:!r,[Co.contentSlotted]:this.hasContent,[Co.iconStartEmpty]:!this.iconStart,[Co.iconEndEmpty]:!this.iconEnd},disabled:this.disabled||this.loading,href:i==="a"&&this.href,name:i==="button"&&this.name,onClick:this.handleClick,ref:o=>this.childEl=o,rel:i==="a"&&this.rel,tabIndex:this.disabled||this.loading?-1:null,target:i==="a"&&this.target,type:i==="button"&&this.type},t,this.iconStart?n:null,this.hasContent?a:null,this.iconEnd?s:null)}async setFocus(){var i;await r_e(this),(i=this.childEl)==null||i.focus()}effectiveLocaleChange(){g_e(this,this.effectiveLocale)}updateHasContent(){var e,t;const i=this.el.textContent.trim().length>0||this.el.childNodes.length>0;this.hasContent=this.el.childNodes.length===1&&((e=this.el.childNodes[0])==null?void 0:e.nodeName)==="#text"?((t=this.el.textContent)==null?void 0:t.trim().length)>0:i}setupTextContentObserver(){var i;(i=this.mutationObserver)==null||i.observe(this.el,{childList:!0,subtree:!0})}onLabelClick(){this.handleClick(),this.setFocus()}static get assetsDirs(){return["assets"]}get el(){return this}static get watchers(){return{loading:["loadingChanged"],messageOverrides:["onMessagesChange"],effectiveLocale:["effectiveLocaleChange"]}}static get style(){return R_e}},[1,"calcite-button",{alignment:[513],appearance:[513],label:[1],kind:[513],disabled:[516],href:[513],iconEnd:[513,"icon-end"],iconFlipRtl:[513,"icon-flip-rtl"],iconStart:[513,"icon-start"],loading:[516],name:[513],rel:[513],round:[516],scale:[513],splitChild:[520,"split-child"],target:[513],type:[1537],width:[513],messages:[1040],messageOverrides:[1040],hasContent:[32],hasLoader:[32],effectiveLocale:[32],defaultMessages:[32],setFocus:[64]}]);function A_e(){if(typeof customElements>"u")return;["calcite-button","calcite-icon","calcite-loader"].forEach(e=>{switch(e){case"calcite-button":customElements.get(e)||customElements.define(e,P_e);break;case"calcite-icon":customElements.get(e)||dQ();break;case"calcite-loader":customElements.get(e)||pQ();break}})}A_e();const O_e=i=>i.toLowerCase().split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(""),mQ=i=>i.replace(/([A-Z])/g,e=>`-${e[0].toLowerCase()}`),M_e=(i,e,t={})=>{if(i instanceof Element){const r=I_e(i.classList,e,t);r!==""&&(i.className=r),Object.keys(e).forEach(n=>{if(!(n==="children"||n==="style"||n==="ref"||n==="class"||n==="className"||n==="forwardedRef"))if(n.indexOf("on")===0&&n[2]===n[2].toUpperCase()){const s=n.substring(2),a=s[0].toLowerCase()+s.substring(1);fQ(a)||L_e(i,a,e[n])}else i[n]=e[n],typeof e[n]==="string"&&i.setAttribute(mQ(n),e[n])})}},I_e=(i,e,t)=>{const r=e.className||e.class,n=t.className||t.class,s=yO(i),a=yO(r?r.split(" "):[]),o=yO(n?n.split(" "):[]),l=[];return s.forEach(c=>{a.has(c)?(l.push(c),a.delete(c)):o.has(c)||l.push(c)}),a.forEach(c=>l.push(c)),l.join(" ")};/**
 * Checks if an event is supported in the current execution environment.
 * @license Modernizr 3.0.0pre (Custom Build) | MIT
 */const fQ=i=>{if(typeof document>"u")return!0;{const e="on"+i;let t=e in document;if(!t){const r=document.createElement("div");r.setAttribute(e,"return;"),t=typeof r[e]=="function"}return t}},L_e=(i,e,t)=>{const r=i.__events||(i.__events={}),n=r[e];n&&i.removeEventListener(e,n),i.addEventListener(e,r[e]=function(a){t&&t.call(this,a)})},yO=i=>{const e=new Map;return i.forEach(t=>e.set(t,t)),e},$_e=(i,e)=>{typeof i=="function"?i(e):i!=null&&(i.current=e)},D_e=(...i)=>e=>{i.forEach(t=>{$_e(t,e)})},F_e=(i,e)=>{const t=(r,n)=>Dw.createElement(i,Object.assign({},r,{forwardedRef:n}));return t.displayName=e,Dw.forwardRef(t)};var N_e=globalThis&&globalThis.__rest||function(i,e){var t={};for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&e.indexOf(r)<0&&(t[r]=i[r]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(i);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(i,r[n])&&(t[r[n]]=i[r[n]]);return t};const k_e=(i,e,t,r)=>{r!==void 0&&r();const n=O_e(i),s=class extends Dw.Component{constructor(a){super(a),this.setComponentElRef=o=>{this.componentEl=o}}componentDidMount(){this.componentDidUpdate(this.props)}componentDidUpdate(a){M_e(this.componentEl,this.props,a)}render(){const a=this.props,{children:o,forwardedRef:l,style:c,className:u,ref:d}=a,m=N_e(a,["children","forwardedRef","style","className","ref"]);let f=Object.keys(m).reduce((g,w)=>{const v=m[w];if(w.indexOf("on")===0&&w[2]===w[2].toUpperCase()){const b=w.substring(2).toLowerCase();typeof document<"u"&&fQ(b)&&(g[w]=v)}else{const b=typeof v;(b==="string"||b==="boolean"||b==="number")&&(g[mQ(w)]=v)}return g},{});t&&(f=t(this.props,f));const _=Object.assign(Object.assign({},f),{ref:D_e(l,this.setComponentElRef),style:c});return $e.createElement(i,_,o)}static get displayName(){return n}};return e&&(s.contextType=e),F_e(s,n)},tb=k_e("calcite-button");var $N={exports:{}};function DN(i){return i instanceof Map?i.clear=i.delete=i.set=function(){throw new Error("map is read-only")}:i instanceof Set&&(i.add=i.clear=i.delete=function(){throw new Error("set is read-only")}),Object.freeze(i),Object.getOwnPropertyNames(i).forEach(function(e){var t=i[e];typeof t=="object"&&!Object.isFrozen(t)&&DN(t)}),i}$N.exports=DN;$N.exports.default=DN;let f6=class{constructor(e){e.data===void 0&&(e.data={}),this.data=e.data,this.isMatchIgnored=!1}ignoreMatch(){this.isMatchIgnored=!0}};function gQ(i){return i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")}function lm(i,...e){const t=Object.create(null);for(const r in i)t[r]=i[r];return e.forEach(function(r){for(const n in r)t[n]=r[n]}),t}const V_e="</span>",g6=i=>!!i.scope||i.sublanguage&&i.language,U_e=(i,{prefix:e})=>{if(i.includes(".")){const t=i.split(".");return[`${e}${t.shift()}`,...t.map((r,n)=>`${r}${"_".repeat(n+1)}`)].join(" ")}return`${e}${i}`};class z_e{constructor(e,t){this.buffer="",this.classPrefix=t.classPrefix,e.walk(this)}addText(e){this.buffer+=gQ(e)}openNode(e){if(!g6(e))return;let t="";e.sublanguage?t=`language-${e.language}`:t=U_e(e.scope,{prefix:this.classPrefix}),this.span(t)}closeNode(e){g6(e)&&(this.buffer+=V_e)}value(){return this.buffer}span(e){this.buffer+=`<span class="${e}">`}}const _6=(i={})=>{const e={children:[]};return Object.assign(e,i),e};class FN{constructor(){this.rootNode=_6(),this.stack=[this.rootNode]}get top(){return this.stack[this.stack.length-1]}get root(){return this.rootNode}add(e){this.top.children.push(e)}openNode(e){const t=_6({scope:e});this.add(t),this.stack.push(t)}closeNode(){if(this.stack.length>1)return this.stack.pop()}closeAllNodes(){for(;this.closeNode(););}toJSON(){return JSON.stringify(this.rootNode,null,4)}walk(e){return this.constructor._walk(e,this.rootNode)}static _walk(e,t){return typeof t=="string"?e.addText(t):t.children&&(e.openNode(t),t.children.forEach(r=>this._walk(e,r)),e.closeNode(t)),e}static _collapse(e){typeof e!="string"&&e.children&&(e.children.every(t=>typeof t=="string")?e.children=[e.children.join("")]:e.children.forEach(t=>{FN._collapse(t)}))}}class B_e extends FN{constructor(e){super(),this.options=e}addKeyword(e,t){e!==""&&(this.openNode(t),this.addText(e),this.closeNode())}addText(e){e!==""&&this.add(e)}addSublanguage(e,t){const r=e.root;r.sublanguage=!0,r.language=t,this.add(r)}toHTML(){return new z_e(this,this.options).value()}finalize(){return!0}}function sx(i){return i?typeof i=="string"?i:i.source:null}function _Q(i){return l_("(?=",i,")")}function G_e(i){return l_("(?:",i,")*")}function H_e(i){return l_("(?:",i,")?")}function l_(...i){return i.map(t=>sx(t)).join("")}function j_e(i){const e=i[i.length-1];return typeof e=="object"&&e.constructor===Object?(i.splice(i.length-1,1),e):{}}function NN(...i){return"("+(j_e(i).capture?"":"?:")+i.map(r=>sx(r)).join("|")+")"}function yQ(i){return new RegExp(i.toString()+"|").exec("").length-1}function q_e(i,e){const t=i&&i.exec(e);return t&&t.index===0}const W_e=/\[(?:[^\\\]]|\\.)*\]|\(\??|\\([1-9][0-9]*)|\\./;function kN(i,{joinWith:e}){let t=0;return i.map(r=>{t+=1;const n=t;let s=sx(r),a="";for(;s.length>0;){const o=W_e.exec(s);if(!o){a+=s;break}a+=s.substring(0,o.index),s=s.substring(o.index+o[0].length),o[0][0]==="\\"&&o[1]?a+="\\"+String(Number(o[1])+n):(a+=o[0],o[0]==="("&&t++)}return a}).map(r=>`(${r})`).join(e)}const X_e=/\b\B/,vQ="[a-zA-Z]\\w*",VN="[a-zA-Z_]\\w*",bQ="\\b\\d+(\\.\\d+)?",wQ="(-?)(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)",xQ="\\b(0b[01]+)",Q_e="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|-|-=|/=|/|:|;|<<|<<=|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~",Z_e=(i={})=>{const e=/^#![ ]*\//;return i.binary&&(i.begin=l_(e,/.*\b/,i.binary,/\b.*/)),lm({scope:"meta",begin:e,end:/$/,relevance:0,"on:begin":(t,r)=>{t.index!==0&&r.ignoreMatch()}},i)},ax={begin:"\\\\[\\s\\S]",relevance:0},Y_e={scope:"string",begin:"'",end:"'",illegal:"\\n",contains:[ax]},K_e={scope:"string",begin:'"',end:'"',illegal:"\\n",contains:[ax]},J_e={begin:/\b(a|an|the|are|I'm|isn't|don't|doesn't|won't|but|just|should|pretty|simply|enough|gonna|going|wtf|so|such|will|you|your|they|like|more)\b/},CP=function(i,e,t={}){const r=lm({scope:"comment",begin:i,end:e,contains:[]},t);r.contains.push({scope:"doctag",begin:"[ ]*(?=(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):)",end:/(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):/,excludeBegin:!0,relevance:0});const n=NN("I","a","is","so","us","to","at","if","in","it","on",/[A-Za-z]+['](d|ve|re|ll|t|s|n)/,/[A-Za-z]+[-][a-z]+/,/[A-Za-z][a-z]{2,}/);return r.contains.push({begin:l_(/[ ]+/,"(",n,/[.]?[:]?([.][ ]|[ ])/,"){3}")}),r},eye=CP("//","$"),tye=CP("/\\*","\\*/"),iye=CP("#","$"),rye={scope:"number",begin:bQ,relevance:0},nye={scope:"number",begin:wQ,relevance:0},sye={scope:"number",begin:xQ,relevance:0},aye={begin:/(?=\/[^/\n]*\/)/,contains:[{scope:"regexp",begin:/\//,end:/\/[gimuy]*/,illegal:/\n/,contains:[ax,{begin:/\[/,end:/\]/,relevance:0,contains:[ax]}]}]},oye={scope:"title",begin:vQ,relevance:0},lye={scope:"title",begin:VN,relevance:0},cye={begin:"\\.\\s*"+VN,relevance:0},hye=function(i){return Object.assign(i,{"on:begin":(e,t)=>{t.data._beginMatch=e[1]},"on:end":(e,t)=>{t.data._beginMatch!==e[1]&&t.ignoreMatch()}})};var QT=Object.freeze({__proto__:null,MATCH_NOTHING_RE:X_e,IDENT_RE:vQ,UNDERSCORE_IDENT_RE:VN,NUMBER_RE:bQ,C_NUMBER_RE:wQ,BINARY_NUMBER_RE:xQ,RE_STARTERS_RE:Q_e,SHEBANG:Z_e,BACKSLASH_ESCAPE:ax,APOS_STRING_MODE:Y_e,QUOTE_STRING_MODE:K_e,PHRASAL_WORDS_MODE:J_e,COMMENT:CP,C_LINE_COMMENT_MODE:eye,C_BLOCK_COMMENT_MODE:tye,HASH_COMMENT_MODE:iye,NUMBER_MODE:rye,C_NUMBER_MODE:nye,BINARY_NUMBER_MODE:sye,REGEXP_MODE:aye,TITLE_MODE:oye,UNDERSCORE_TITLE_MODE:lye,METHOD_GUARD:cye,END_SAME_AS_BEGIN:hye});function uye(i,e){i.input[i.index-1]==="."&&e.ignoreMatch()}function dye(i,e){i.className!==void 0&&(i.scope=i.className,delete i.className)}function pye(i,e){e&&i.beginKeywords&&(i.begin="\\b("+i.beginKeywords.split(" ").join("|")+")(?!\\.)(?=\\b|\\s)",i.__beforeBegin=uye,i.keywords=i.keywords||i.beginKeywords,delete i.beginKeywords,i.relevance===void 0&&(i.relevance=0))}function mye(i,e){Array.isArray(i.illegal)&&(i.illegal=NN(...i.illegal))}function fye(i,e){if(i.match){if(i.begin||i.end)throw new Error("begin & end are not supported with match");i.begin=i.match,delete i.match}}function gye(i,e){i.relevance===void 0&&(i.relevance=1)}const _ye=(i,e)=>{if(!i.beforeMatch)return;if(i.starts)throw new Error("beforeMatch cannot be used with starts");const t=Object.assign({},i);Object.keys(i).forEach(r=>{delete i[r]}),i.keywords=t.keywords,i.begin=l_(t.beforeMatch,_Q(t.begin)),i.starts={relevance:0,contains:[Object.assign(t,{endsParent:!0})]},i.relevance=0,delete t.beforeMatch},yye=["of","and","for","in","not","or","if","then","parent","list","value"],vye="keyword";function TQ(i,e,t=vye){const r=Object.create(null);return typeof i=="string"?n(t,i.split(" ")):Array.isArray(i)?n(t,i):Object.keys(i).forEach(function(s){Object.assign(r,TQ(i[s],e,s))}),r;function n(s,a){e&&(a=a.map(o=>o.toLowerCase())),a.forEach(function(o){const l=o.split("|");r[l[0]]=[s,bye(l[0],l[1])]})}}function bye(i,e){return e?Number(e):wye(i)?0:1}function wye(i){return yye.includes(i.toLowerCase())}const y6={},xg=i=>{console.error(i)},v6=(i,...e)=>{console.log(`WARN: ${i}`,...e)},P_=(i,e)=>{y6[`${i}/${e}`]||(console.log(`Deprecated as of ${i}. ${e}`),y6[`${i}/${e}`]=!0)},B2=new Error;function CQ(i,e,{key:t}){let r=0;const n=i[t],s={},a={};for(let o=1;o<=e.length;o++)a[o+r]=n[o],s[o+r]=!0,r+=yQ(e[o-1]);i[t]=a,i[t]._emit=s,i[t]._multi=!0}function xye(i){if(Array.isArray(i.begin)){if(i.skip||i.excludeBegin||i.returnBegin)throw xg("skip, excludeBegin, returnBegin not compatible with beginScope: {}"),B2;if(typeof i.beginScope!="object"||i.beginScope===null)throw xg("beginScope must be object"),B2;CQ(i,i.begin,{key:"beginScope"}),i.begin=kN(i.begin,{joinWith:""})}}function Tye(i){if(Array.isArray(i.end)){if(i.skip||i.excludeEnd||i.returnEnd)throw xg("skip, excludeEnd, returnEnd not compatible with endScope: {}"),B2;if(typeof i.endScope!="object"||i.endScope===null)throw xg("endScope must be object"),B2;CQ(i,i.end,{key:"endScope"}),i.end=kN(i.end,{joinWith:""})}}function Cye(i){i.scope&&typeof i.scope=="object"&&i.scope!==null&&(i.beginScope=i.scope,delete i.scope)}function Sye(i){Cye(i),typeof i.beginScope=="string"&&(i.beginScope={_wrap:i.beginScope}),typeof i.endScope=="string"&&(i.endScope={_wrap:i.endScope}),xye(i),Tye(i)}function Eye(i){function e(a,o){return new RegExp(sx(a),"m"+(i.case_insensitive?"i":"")+(i.unicodeRegex?"u":"")+(o?"g":""))}class t{constructor(){this.matchIndexes={},this.regexes=[],this.matchAt=1,this.position=0}addRule(o,l){l.position=this.position++,this.matchIndexes[this.matchAt]=l,this.regexes.push([l,o]),this.matchAt+=yQ(o)+1}compile(){this.regexes.length===0&&(this.exec=()=>null);const o=this.regexes.map(l=>l[1]);this.matcherRe=e(kN(o,{joinWith:"|"}),!0),this.lastIndex=0}exec(o){this.matcherRe.lastIndex=this.lastIndex;const l=this.matcherRe.exec(o);if(!l)return null;const c=l.findIndex((d,m)=>m>0&&d!==void 0),u=this.matchIndexes[c];return l.splice(0,c),Object.assign(l,u)}}class r{constructor(){this.rules=[],this.multiRegexes=[],this.count=0,this.lastIndex=0,this.regexIndex=0}getMatcher(o){if(this.multiRegexes[o])return this.multiRegexes[o];const l=new t;return this.rules.slice(o).forEach(([c,u])=>l.addRule(c,u)),l.compile(),this.multiRegexes[o]=l,l}resumingScanAtSamePosition(){return this.regexIndex!==0}considerAll(){this.regexIndex=0}addRule(o,l){this.rules.push([o,l]),l.type==="begin"&&this.count++}exec(o){const l=this.getMatcher(this.regexIndex);l.lastIndex=this.lastIndex;let c=l.exec(o);if(this.resumingScanAtSamePosition()&&!(c&&c.index===this.lastIndex)){const u=this.getMatcher(0);u.lastIndex=this.lastIndex+1,c=u.exec(o)}return c&&(this.regexIndex+=c.position+1,this.regexIndex===this.count&&this.considerAll()),c}}function n(a){const o=new r;return a.contains.forEach(l=>o.addRule(l.begin,{rule:l,type:"begin"})),a.terminatorEnd&&o.addRule(a.terminatorEnd,{type:"end"}),a.illegal&&o.addRule(a.illegal,{type:"illegal"}),o}function s(a,o){const l=a;if(a.isCompiled)return l;[dye,fye,Sye,_ye].forEach(u=>u(a,o)),i.compilerExtensions.forEach(u=>u(a,o)),a.__beforeBegin=null,[pye,mye,gye].forEach(u=>u(a,o)),a.isCompiled=!0;let c=null;return typeof a.keywords=="object"&&a.keywords.$pattern&&(a.keywords=Object.assign({},a.keywords),c=a.keywords.$pattern,delete a.keywords.$pattern),c=c||/\w+/,a.keywords&&(a.keywords=TQ(a.keywords,i.case_insensitive)),l.keywordPatternRe=e(c,!0),o&&(a.begin||(a.begin=/\B|\b/),l.beginRe=e(l.begin),!a.end&&!a.endsWithParent&&(a.end=/\B|\b/),a.end&&(l.endRe=e(l.end)),l.terminatorEnd=sx(l.end)||"",a.endsWithParent&&o.terminatorEnd&&(l.terminatorEnd+=(a.end?"|":"")+o.terminatorEnd)),a.illegal&&(l.illegalRe=e(a.illegal)),a.contains||(a.contains=[]),a.contains=[].concat(...a.contains.map(function(u){return Rye(u==="self"?a:u)})),a.contains.forEach(function(u){s(u,l)}),a.starts&&s(a.starts,o),l.matcher=n(l),l}if(i.compilerExtensions||(i.compilerExtensions=[]),i.contains&&i.contains.includes("self"))throw new Error("ERR: contains `self` is not supported at the top-level of a language.  See documentation.");return i.classNameAliases=lm(i.classNameAliases||{}),s(i)}function SQ(i){return i?i.endsWithParent||SQ(i.starts):!1}function Rye(i){return i.variants&&!i.cachedVariants&&(i.cachedVariants=i.variants.map(function(e){return lm(i,{variants:null},e)})),i.cachedVariants?i.cachedVariants:SQ(i)?lm(i,{starts:i.starts?lm(i.starts):null}):Object.isFrozen(i)?lm(i):i}var Pye="11.7.0";class Aye extends Error{constructor(e,t){super(e),this.name="HTMLInjectionError",this.html=t}}const vO=gQ,b6=lm,w6=Symbol("nomatch"),Oye=7,Mye=function(i){const e=Object.create(null),t=Object.create(null),r=[];let n=!0;const s="Could not find the language '{}', did you forget to load/include a language module?",a={disableAutodetect:!0,name:"Plain text",contains:[]};let o={ignoreUnescapedHTML:!1,throwUnescapedHTML:!1,noHighlightRe:/^(no-?highlight)$/i,languageDetectRe:/\blang(?:uage)?-([\w-]+)\b/i,classPrefix:"hljs-",cssSelector:"pre code",languages:null,__emitter:B_e};function l(M){return o.noHighlightRe.test(M)}function c(M){let U=M.className+" ";U+=M.parentNode?M.parentNode.className:"";const L=o.languageDetectRe.exec(U);if(L){const z=D(L[1]);return z||(v6(s.replace("{}",L[1])),v6("Falling back to no-highlight mode for this block.",M)),z?L[1]:"no-highlight"}return U.split(/\s+/).find(z=>l(z)||D(z))}function u(M,U,L){let z="",q="";typeof U=="object"?(z=M,L=U.ignoreIllegals,q=U.language):(P_("10.7.0","highlight(lang, code, ...args) has been deprecated."),P_("10.7.0",`Please use highlight(code, options) instead.
https://github.com/highlightjs/highlight.js/issues/2277`),q=M,z=U),L===void 0&&(L=!0);const K={code:z,language:q};te("before:highlight",K);const ie=K.result?K.result:d(K.language,K.code,L);return ie.code=K.code,te("after:highlight",ie),ie}function d(M,U,L,z){const q=Object.create(null);function K(oe,se){return oe.keywords[se]}function ie(){if(!be.keywords){Le.addText(Pe);return}let oe=0;be.keywordPatternRe.lastIndex=0;let se=be.keywordPatternRe.exec(Pe),ge="";for(;se;){ge+=Pe.substring(oe,se.index);const Re=st.case_insensitive?se[0].toLowerCase():se[0],We=K(be,Re);if(We){const[at,yt]=We;if(Le.addText(ge),ge="",q[Re]=(q[Re]||0)+1,q[Re]<=Oye&&(di+=yt),at.startsWith("_"))ge+=se[0];else{const Et=st.classNameAliases[at]||at;Le.addKeyword(se[0],Et)}}else ge+=se[0];oe=be.keywordPatternRe.lastIndex,se=be.keywordPatternRe.exec(Pe)}ge+=Pe.substring(oe),Le.addText(ge)}function Z(){if(Pe==="")return;let oe=null;if(typeof be.subLanguage=="string"){if(!e[be.subLanguage]){Le.addText(Pe);return}oe=d(be.subLanguage,Pe,!0,_t[be.subLanguage]),_t[be.subLanguage]=oe._top}else oe=f(Pe,be.subLanguage.length?be.subLanguage:null);be.relevance>0&&(di+=oe.relevance),Le.addSublanguage(oe._emitter,oe.language)}function ne(){be.subLanguage!=null?Z():ie(),Pe=""}function Ae(oe,se){let ge=1;const Re=se.length-1;for(;ge<=Re;){if(!oe._emit[ge]){ge++;continue}const We=st.classNameAliases[oe[ge]]||oe[ge],at=se[ge];We?Le.addKeyword(at,We):(Pe=at,ie(),Pe=""),ge++}}function Fe(oe,se){return oe.scope&&typeof oe.scope=="string"&&Le.openNode(st.classNameAliases[oe.scope]||oe.scope),oe.beginScope&&(oe.beginScope._wrap?(Le.addKeyword(Pe,st.classNameAliases[oe.beginScope._wrap]||oe.beginScope._wrap),Pe=""):oe.beginScope._multi&&(Ae(oe.beginScope,se),Pe="")),be=Object.create(oe,{parent:{value:be}}),be}function ze(oe,se,ge){let Re=q_e(oe.endRe,ge);if(Re){if(oe["on:end"]){const We=new f6(oe);oe["on:end"](se,We),We.isMatchIgnored&&(Re=!1)}if(Re){for(;oe.endsParent&&oe.parent;)oe=oe.parent;return oe}}if(oe.endsWithParent)return ze(oe.parent,se,ge)}function Ye(oe){return be.matcher.regexIndex===0?(Pe+=oe[0],1):(ot=!0,0)}function Ce(oe){const se=oe[0],ge=oe.rule,Re=new f6(ge),We=[ge.__beforeBegin,ge["on:begin"]];for(const at of We)if(at&&(at(oe,Re),Re.isMatchIgnored))return Ye(se);return ge.skip?Pe+=se:(ge.excludeBegin&&(Pe+=se),ne(),!ge.returnBegin&&!ge.excludeBegin&&(Pe=se)),Fe(ge,oe),ge.returnBegin?0:se.length}function Ee(oe){const se=oe[0],ge=U.substring(oe.index),Re=ze(be,oe,ge);if(!Re)return w6;const We=be;be.endScope&&be.endScope._wrap?(ne(),Le.addKeyword(se,be.endScope._wrap)):be.endScope&&be.endScope._multi?(ne(),Ae(be.endScope,oe)):We.skip?Pe+=se:(We.returnEnd||We.excludeEnd||(Pe+=se),ne(),We.excludeEnd&&(Pe=se));do be.scope&&Le.closeNode(),!be.skip&&!be.subLanguage&&(di+=be.relevance),be=be.parent;while(be!==Re.parent);return Re.starts&&Fe(Re.starts,oe),We.returnEnd?0:se.length}function je(){const oe=[];for(let se=be;se!==st;se=se.parent)se.scope&&oe.unshift(se.scope);oe.forEach(se=>Le.openNode(se))}let nt={};function Mt(oe,se){const ge=se&&se[0];if(Pe+=oe,ge==null)return ne(),0;if(nt.type==="begin"&&se.type==="end"&&nt.index===se.index&&ge===""){if(Pe+=U.slice(se.index,se.index+1),!n){const Re=new Error(`0 width match regex (${M})`);throw Re.languageName=M,Re.badRule=nt.rule,Re}return 1}if(nt=se,se.type==="begin")return Ce(se);if(se.type==="illegal"&&!L){const Re=new Error('Illegal lexeme "'+ge+'" for mode "'+(be.scope||"<unnamed>")+'"');throw Re.mode=be,Re}else if(se.type==="end"){const Re=Ee(se);if(Re!==w6)return Re}if(se.type==="illegal"&&ge==="")return 1;if(Lt>1e5&&Lt>se.index*3)throw new Error("potential infinite loop, way more iterations than matches");return Pe+=ge,ge.length}const st=D(M);if(!st)throw xg(s.replace("{}",M)),new Error('Unknown language: "'+M+'"');const Be=Eye(st);let Ve="",be=z||Be;const _t={},Le=new o.__emitter(o);je();let Pe="",di=0,zt=0,Lt=0,ot=!1;try{for(be.matcher.considerAll();;){Lt++,ot?ot=!1:be.matcher.considerAll(),be.matcher.lastIndex=zt;const oe=be.matcher.exec(U);if(!oe)break;const se=U.substring(zt,oe.index),ge=Mt(se,oe);zt=oe.index+ge}return Mt(U.substring(zt)),Le.closeAllNodes(),Le.finalize(),Ve=Le.toHTML(),{language:M,value:Ve,relevance:di,illegal:!1,_emitter:Le,_top:be}}catch(oe){if(oe.message&&oe.message.includes("Illegal"))return{language:M,value:vO(U),illegal:!0,relevance:0,_illegalBy:{message:oe.message,index:zt,context:U.slice(zt-100,zt+100),mode:oe.mode,resultSoFar:Ve},_emitter:Le};if(n)return{language:M,value:vO(U),illegal:!1,relevance:0,errorRaised:oe,_emitter:Le,_top:be};throw oe}}function m(M){const U={value:vO(M),illegal:!1,relevance:0,_top:a,_emitter:new o.__emitter(o)};return U._emitter.addText(M),U}function f(M,U){U=U||o.languages||Object.keys(e);const L=m(M),z=U.filter(D).filter(G).map(ne=>d(ne,M,!1));z.unshift(L);const q=z.sort((ne,Ae)=>{if(ne.relevance!==Ae.relevance)return Ae.relevance-ne.relevance;if(ne.language&&Ae.language){if(D(ne.language).supersetOf===Ae.language)return 1;if(D(Ae.language).supersetOf===ne.language)return-1}return 0}),[K,ie]=q,Z=K;return Z.secondBest=ie,Z}function _(M,U,L){const z=U&&t[U]||L;M.classList.add("hljs"),M.classList.add(`language-${z}`)}function g(M){let U=null;const L=c(M);if(l(L))return;if(te("before:highlightElement",{el:M,language:L}),M.children.length>0&&(o.ignoreUnescapedHTML||(console.warn("One of your code blocks includes unescaped HTML. This is a potentially serious security risk."),console.warn("https://github.com/highlightjs/highlight.js/wiki/security"),console.warn("The element with unescaped HTML:"),console.warn(M)),o.throwUnescapedHTML))throw new Aye("One of your code blocks includes unescaped HTML.",M.innerHTML);U=M;const z=U.textContent,q=L?u(z,{language:L,ignoreIllegals:!0}):f(z);M.innerHTML=q.value,_(M,L,q.language),M.result={language:q.language,re:q.relevance,relevance:q.relevance},q.secondBest&&(M.secondBest={language:q.secondBest.language,relevance:q.secondBest.relevance}),te("after:highlightElement",{el:M,result:q,text:z})}function w(M){o=b6(o,M)}const v=()=>{T(),P_("10.6.0","initHighlighting() deprecated.  Use highlightAll() now.")};function b(){T(),P_("10.6.0","initHighlightingOnLoad() deprecated.  Use highlightAll() now.")}let x=!1;function T(){if(document.readyState==="loading"){x=!0;return}document.querySelectorAll(o.cssSelector).forEach(g)}function R(){x&&T()}typeof window<"u"&&window.addEventListener&&window.addEventListener("DOMContentLoaded",R,!1);function E(M,U){let L=null;try{L=U(i)}catch(z){if(xg("Language definition for '{}' could not be registered.".replace("{}",M)),n)xg(z);else throw z;L=a}L.name||(L.name=M),e[M]=L,L.rawDefinition=U.bind(null,i),L.aliases&&I(L.aliases,{languageName:M})}function O(M){delete e[M];for(const U of Object.keys(t))t[U]===M&&delete t[U]}function $(){return Object.keys(e)}function D(M){return M=(M||"").toLowerCase(),e[M]||e[t[M]]}function I(M,{languageName:U}){typeof M=="string"&&(M=[M]),M.forEach(L=>{t[L.toLowerCase()]=U})}function G(M){const U=D(M);return U&&!U.disableAutodetect}function W(M){M["before:highlightBlock"]&&!M["before:highlightElement"]&&(M["before:highlightElement"]=U=>{M["before:highlightBlock"](Object.assign({block:U.el},U))}),M["after:highlightBlock"]&&!M["after:highlightElement"]&&(M["after:highlightElement"]=U=>{M["after:highlightBlock"](Object.assign({block:U.el},U))})}function re(M){W(M),r.push(M)}function te(M,U){const L=M;r.forEach(function(z){z[L]&&z[L](U)})}function H(M){return P_("10.7.0","highlightBlock will be removed entirely in v12.0"),P_("10.7.0","Please use highlightElement now."),g(M)}Object.assign(i,{highlight:u,highlightAuto:f,highlightAll:T,highlightElement:g,highlightBlock:H,configure:w,initHighlighting:v,initHighlightingOnLoad:b,registerLanguage:E,unregisterLanguage:O,listLanguages:$,getLanguage:D,registerAliases:I,autoDetection:G,inherit:b6,addPlugin:re}),i.debugMode=function(){n=!1},i.safeMode=function(){n=!0},i.versionString=Pye,i.regex={concat:l_,lookahead:_Q,either:NN,optional:H_e,anyNumberOfTimes:G_e};for(const M in QT)typeof QT[M]=="object"&&$N.exports(QT[M]);return Object.assign(i,QT),i};var ox=Mye({}),Iye=ox;ox.HighlightJS=ox;ox.default=ox;const SP=Iye,x6="[A-Za-z$_][0-9A-Za-z$_]*",Lye=["as","in","of","if","for","while","finally","var","new","function","do","return","void","else","break","catch","instanceof","with","throw","case","default","try","switch","continue","typeof","delete","let","yield","const","class","debugger","async","await","static","import","from","export","extends"],$ye=["true","false","null","undefined","NaN","Infinity"],EQ=["Object","Function","Boolean","Symbol","Math","Date","Number","BigInt","String","RegExp","Array","Float32Array","Float64Array","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Int32Array","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array","Set","Map","WeakSet","WeakMap","ArrayBuffer","SharedArrayBuffer","Atomics","DataView","JSON","Promise","Generator","GeneratorFunction","AsyncFunction","Reflect","Proxy","Intl","WebAssembly"],RQ=["Error","EvalError","InternalError","RangeError","ReferenceError","SyntaxError","TypeError","URIError"],PQ=["setInterval","setTimeout","clearInterval","clearTimeout","require","exports","eval","isFinite","isNaN","parseFloat","parseInt","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","unescape"],Dye=["arguments","this","super","console","window","document","localStorage","module","global"],Fye=[].concat(PQ,EQ,RQ);function AQ(i){const e=i.regex,t=(U,{after:L})=>{const z="</"+U[0].slice(1);return U.input.indexOf(z,L)!==-1},r=x6,n={begin:"<>",end:"</>"},s=/<[A-Za-z0-9\\._:-]+\s*\/>/,a={begin:/<[A-Za-z0-9\\._:-]+/,end:/\/[A-Za-z0-9\\._:-]+>|\/>/,isTrulyOpeningTag:(U,L)=>{const z=U[0].length+U.index,q=U.input[z];if(q==="<"||q===","){L.ignoreMatch();return}q===">"&&(t(U,{after:z})||L.ignoreMatch());let K;const ie=U.input.substring(z);if(K=ie.match(/^\s*=/)){L.ignoreMatch();return}if((K=ie.match(/^\s+extends\s+/))&&K.index===0){L.ignoreMatch();return}}},o={$pattern:x6,keyword:Lye,literal:$ye,built_in:Fye,"variable.language":Dye},l="[0-9](_?[0-9])*",c=`\\.(${l})`,u="0|[1-9](_?[0-9])*|0[0-7]*[89][0-9]*",d={className:"number",variants:[{begin:`(\\b(${u})((${c})|\\.)?|(${c}))[eE][+-]?(${l})\\b`},{begin:`\\b(${u})\\b((${c})\\b|\\.)?|(${c})\\b`},{begin:"\\b(0|[1-9](_?[0-9])*)n\\b"},{begin:"\\b0[xX][0-9a-fA-F](_?[0-9a-fA-F])*n?\\b"},{begin:"\\b0[bB][0-1](_?[0-1])*n?\\b"},{begin:"\\b0[oO][0-7](_?[0-7])*n?\\b"},{begin:"\\b0[0-7]+n?\\b"}],relevance:0},m={className:"subst",begin:"\\$\\{",end:"\\}",keywords:o,contains:[]},f={begin:"html`",end:"",starts:{end:"`",returnEnd:!1,contains:[i.BACKSLASH_ESCAPE,m],subLanguage:"xml"}},_={begin:"css`",end:"",starts:{end:"`",returnEnd:!1,contains:[i.BACKSLASH_ESCAPE,m],subLanguage:"css"}},g={className:"string",begin:"`",end:"`",contains:[i.BACKSLASH_ESCAPE,m]},v={className:"comment",variants:[i.COMMENT(/\/\*\*(?!\/)/,"\\*/",{relevance:0,contains:[{begin:"(?=@[A-Za-z]+)",relevance:0,contains:[{className:"doctag",begin:"@[A-Za-z]+"},{className:"type",begin:"\\{",end:"\\}",excludeEnd:!0,excludeBegin:!0,relevance:0},{className:"variable",begin:r+"(?=\\s*(-)|$)",endsParent:!0,relevance:0},{begin:/(?=[^\n])\s/,relevance:0}]}]}),i.C_BLOCK_COMMENT_MODE,i.C_LINE_COMMENT_MODE]},b=[i.APOS_STRING_MODE,i.QUOTE_STRING_MODE,f,_,g,{match:/\$\d+/},d];m.contains=b.concat({begin:/\{/,end:/\}/,keywords:o,contains:["self"].concat(b)});const x=[].concat(v,m.contains),T=x.concat([{begin:/\(/,end:/\)/,keywords:o,contains:["self"].concat(x)}]),R={className:"params",begin:/\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:o,contains:T},E={variants:[{match:[/class/,/\s+/,r,/\s+/,/extends/,/\s+/,e.concat(r,"(",e.concat(/\./,r),")*")],scope:{1:"keyword",3:"title.class",5:"keyword",7:"title.class.inherited"}},{match:[/class/,/\s+/,r],scope:{1:"keyword",3:"title.class"}}]},O={relevance:0,match:e.either(/\bJSON/,/\b[A-Z][a-z]+([A-Z][a-z]*|\d)*/,/\b[A-Z]{2,}([A-Z][a-z]+|\d)+([A-Z][a-z]*)*/,/\b[A-Z]{2,}[a-z]+([A-Z][a-z]+|\d)*([A-Z][a-z]*)*/),className:"title.class",keywords:{_:[...EQ,...RQ]}},$={label:"use_strict",className:"meta",relevance:10,begin:/^\s*['"]use (strict|asm)['"]/},D={variants:[{match:[/function/,/\s+/,r,/(?=\s*\()/]},{match:[/function/,/\s*(?=\()/]}],className:{1:"keyword",3:"title.function"},label:"func.def",contains:[R],illegal:/%/},I={relevance:0,match:/\b[A-Z][A-Z_0-9]+\b/,className:"variable.constant"};function G(U){return e.concat("(?!",U.join("|"),")")}const W={match:e.concat(/\b/,G([...PQ,"super","import"]),r,e.lookahead(/\(/)),className:"title.function",relevance:0},re={begin:e.concat(/\./,e.lookahead(e.concat(r,/(?![0-9A-Za-z$_(])/))),end:r,excludeBegin:!0,keywords:"prototype",className:"property",relevance:0},te={match:[/get|set/,/\s+/,r,/(?=\()/],className:{1:"keyword",3:"title.function"},contains:[{begin:/\(\)/},R]},H="(\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)|"+i.UNDERSCORE_IDENT_RE+")\\s*=>",M={match:[/const|var|let/,/\s+/,r,/\s*/,/=\s*/,/(async\s*)?/,e.lookahead(H)],keywords:"async",className:{1:"keyword",3:"title.function"},contains:[R]};return{name:"Javascript",aliases:["js","jsx","mjs","cjs"],keywords:o,exports:{PARAMS_CONTAINS:T,CLASS_REFERENCE:O},illegal:/#(?![$_A-z])/,contains:[i.SHEBANG({label:"shebang",binary:"node",relevance:5}),$,i.APOS_STRING_MODE,i.QUOTE_STRING_MODE,f,_,g,v,{match:/\$\d+/},d,O,{className:"attr",begin:r+e.lookahead(":"),relevance:0},M,{begin:"("+i.RE_STARTERS_RE+"|\\b(case|return|throw)\\b)\\s*",keywords:"return throw case",relevance:0,contains:[v,i.REGEXP_MODE,{className:"function",begin:H,returnBegin:!0,end:"\\s*=>",contains:[{className:"params",variants:[{begin:i.UNDERSCORE_IDENT_RE,relevance:0},{className:null,begin:/\(\s*\)/,skip:!0},{begin:/\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:o,contains:T}]}]},{begin:/,/,relevance:0},{match:/\s+/,relevance:0},{variants:[{begin:n.begin,end:n.end},{match:s},{begin:a.begin,"on:begin":a.isTrulyOpeningTag,end:a.end}],subLanguage:"xml",contains:[{begin:a.begin,end:a.end,skip:!0,contains:["self"]}]}]},D,{beginKeywords:"while if switch catch for"},{begin:"\\b(?!function)"+i.UNDERSCORE_IDENT_RE+"\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)\\s*\\{",returnBegin:!0,label:"func.def",contains:[R,i.inherit(i.TITLE_MODE,{begin:r,className:"title.function"})]},{match:/\.\.\./,relevance:0},re,{match:"\\$"+r,relevance:0},{match:[/\bconstructor(?=\s*\()/],className:{1:"title.function"},contains:[R]},W,I,E,te,{match:/\$[(.]/}]}}SP.registerLanguage("javascript",AQ);function Nye(){const i=$e.useRef(null),e=$e.useRef(null),t=$e.useRef(null),r=$e.useRef(null),n=$e.useRef(null),[s,a]=$e.useState(null),[o,l]=$e.useState(null);$e.useEffect(()=>{c()},[]);async function c(){if(SP.highlightAll(),!(i!=null&&i.current))return;Rg.portalUrl="http://arcgis.com/";const b=new _P({basemap:{portalItem:{id:"3582b744bba84668b52a16b0b6942544"}}}),x=new IX({container:i==null?void 0:i.current,map:b,zoom:10,center:[-89.93307,29.973197296501905],constraints:{snapToZoom:!1,minScale:1155582}});x.ui.add([new eb({view:x,content:e==null?void 0:e.current,expanded:!0,group:"group1",expandTooltip:"MediaLayer"}),new eb({view:x,content:t==null?void 0:t.current,group:"group1",expandTooltip:"ExtentAndRotationGeoreference"}),new eb({view:x,content:r==null?void 0:r.current,group:"group1",expandTooltip:"CornersGeoreference"}),new eb({view:x,content:n==null?void 0:n.current,group:"group1",expandTooltip:"ControlPointsGeoreference"})],"top-left"),a(x)}async function u(){const b=new K1({image:"https://arcgis.github.io/arcgis-samples-javascript/sample-data/media-layer/new-orleans/chef-menteur1892.png",georeference:new $2({extent:new pi({spatialReference:{wkid:102100},xmax:-100032576023701e-7,xmin:-10043731008847024e-9,ymax:3513936582106864e-9,ymin:3.4867731082574953e6})})}),x=new NX({source:[b]});s.map.layers.add(x),await s.when(),await x.when(),l(x);const T=new Wfe({leadingLayers:[x],position:80,view:s});s.ui.add(T),s==null||s.goTo(new pi({spatialReference:{wkid:102100},xmax:-100032576023701e-7,xmin:-10043731008847024e-9,ymax:3513936582106864e-9,ymin:3.4867731082574953e6}).expand(1.5))}function d(){const b=new K1({image:"https://arcgis.github.io/arcgis-samples-javascript/sample-data/media-layer/new-orleans/neworleans1891.png",georeference:new $2({extent:new pi({spatialReference:{wkid:102100},xmin:-1004745627662979e-8,ymin:3.4867222723874687e6,xmax:-10006982870152846e-9,ymax:351446891365495e-8})})});o.source.elements.add(b),s==null||s.goTo(new pi({spatialReference:{wkid:102100},xmin:-1004745627662979e-8,ymin:3.4867222723874687e6,xmax:-10006982870152846e-9,ymax:351446891365495e-8}).expand(1.5))}function m(){const b=new K1({image:"https://arcgis.github.io/arcgis-samples-javascript/sample-data/media-layer/new-orleans/spanish-fort1891.png",georeference:new $X({bottomRight:new He({x:-10008215143195309e-9,y:3.4867942321162825e6,spatialReference:{wkid:102100}}),bottomLeft:new He({x:-1006146693004702e-8,y:3.4867942321162825e6,spatialReference:{wkid:102100}}),topRight:new He({x:-10008215143195309e-9,y:3.5144184006159767e6,spatialReference:{wkid:102100}}),topLeft:new He({x:-1006146693004702e-8,y:3.5144184006159767e6,spatialReference:{wkid:102100}})})});o.source.elements.add(b),s==null||s.goTo(new pi({spatialReference:{wkid:102100},xmax:-10008215143195309e-9,xmin:-1006146693004702e-8,ymax:3.5144184006159767e6,ymin:3.4867942321162825e6}).expand(1.5))}function f(){const b=new K1({image:"https://arcgis.github.io/arcgis-samples-javascript/sample-data/media-layer/new-orleans/st-bernard1892.png",georeference:new LX({width:1246,height:669,controlPoints:[{sourcePoint:{x:0,y:669},mapPoint:new He({x:-10046739695935503e-9,y:3486942691935667e-9,spatialReference:{wkid:102100}})},{sourcePoint:{x:0,y:0},mapPoint:new He({x:-10046739695935503e-9,y:3514979040597104e-9,spatialReference:{wkid:102100}})},{sourcePoint:{x:1246,y:0},mapPoint:new He({x:-10001415789436923e-9,y:3514979040597104e-9,spatialReference:{wkid:102100}})},{sourcePoint:{x:1246,y:669},mapPoint:new He({x:-10001415789436923e-9,y:3486942691935667e-9,spatialReference:{wkid:102100}})}]})});o.source.elements.add(b),s==null||s.goTo(new pi({spatialReference:{wkid:102100},xmax:-10001415789436923e-9,xmin:-10046739695935503e-9,ymax:3514979040597104e-9,ymin:3486942691935667e-9}).expand(1.5))}return nd("div",{className:"App",children:[Ft("div",{id:"view",ref:i}),nd("div",{ref:e,className:"card",children:[Ft("p",{children:"MediaLayer"}),Ft("pre",{children:Ft("code",{className:"javascript",children:`
  new MediaLayer({ 
    source: [
      new ImageElement({
        image: "image url or image data",
        georeference: {...}
      })
    ] 
  });
  `})}),Ft(tb,{className:"btn","icon-start":"play",onClick:u})]}),nd("div",{ref:t,className:"card",children:[Ft("p",{children:"ExtentAndRotationGeoreference"}),Ft("pre",{children:Ft("code",{className:"javascript",children:`
  new ExtentAndRotationGeoreference({
    extent: new Extent({
      spatialReference: { wkid: 102100 },
      xmin: -10047456.27662979,
      ymin: 3486722.2723874687,
      xmax: -10006982.870152846,
      ymax: 3514468.91365495,
    }),
  })
  `})}),Ft(tb,{className:"btn","icon-start":"play",onClick:d})]}),nd("div",{ref:r,className:"card",children:[Ft("p",{children:"CornersGeoreference"}),Ft("pre",{children:Ft("code",{className:"javascript",children:`
  new CornersGeoreference({
    bottomRight: new Point({
      x: -10008215.143195309,
      y: 3486794.2321162825,
      spatialReference: { wkid: 102100 },
    }),
    bottomLeft: new Point({
      x: -10061466.93004702,
      y: 3486794.2321162825,
      spatialReference: { wkid: 102100 },
    }),
    topRight: new Point({
      x: -10008215.143195309,
      y: 3514418.4006159767,
      spatialReference: { wkid: 102100 },
    }),
    topLeft: new Point({
      x: -10061466.93004702,
      y: 3514418.4006159767,
      spatialReference: { wkid: 102100 },
    }),
  })
  `})}),Ft(tb,{className:"btn","icon-start":"play",onClick:m})]}),nd("div",{ref:n,className:"card",children:[Ft("p",{children:"ControlPointsGeoreference"}),Ft("pre",{children:Ft("code",{className:"javascript",children:`
  new ControlPointsGeoreference({
    width: 1246,
    height: 669,
    controlPoints: [
      {
        sourcePoint: { x: 0, y: 669 },
        mapPoint: new Point({ 
          x: -10046739.695935503, 
          y: 3486942.691935667, 
          spatialReference: { wkid: 102100 } 
        }),
      },
      {
        sourcePoint: { x: 0, y: 0 },
        mapPoint: new Point({
          x: -10046739.695935503,
          y: 3514979.040597104,
          spatialReference: { wkid: 102100 },
        }),
      },
      {
        sourcePoint: { x: 1246, y: 0 },
        mapPoint: new Point({
          x: -10001415.789436923,
          y: 3514979.040597104,
          spatialReference: { wkid: 102100 },
        }),
      },
      {
        sourcePoint: { x: 1246, y: 669 },
        mapPoint: new Point({
          x: -10001415.789436923,
          y: 3486942.691935667,
          spatialReference: { wkid: 102100 },
        }),
      },
    ],
  })
  `})}),Ft(tb,{className:"btn","icon-start":"play",onClick:f})]})]})}function Gg(i){const e=i[0]*i[0]+i[4]*i[4]+i[8]*i[8],t=i[1]*i[1]+i[5]*i[5]+i[9]*i[9],r=i[2]*i[2]+i[6]*i[6]+i[10]*i[10];return Math.sqrt(Math.max(e,t,r))}function kye(i,e){const t=Math.sqrt(e[0]*e[0]+e[4]*e[4]+e[8]*e[8]),r=Math.sqrt(e[1]*e[1]+e[5]*e[5]+e[9]*e[9]),n=Math.sqrt(e[2]*e[2]+e[6]*e[6]+e[10]*e[10]);return Y(i,t,r,n),i}function zVe(i,e,t){t=t||i;const r=_e(i,e);Y(t,i[0]-r*e[0],i[1]-r*e[1],i[2]-r*e[2]),de(t,t)}function BVe(i,e,t){Math.abs(i[0])>Math.abs(i[1])?Y(e,0,1,0):Y(e,1,0,0),ut(t,i,e),de(e,e),ut(e,t,i),de(t,t)}function ZT(i,e,t,r,n,s){const a=i+(e-i)*n;return a+(t+(r-t)*n-a)*s}function Vye(i,e,t,r=P()){const n=we(i),s=we(e),a=_e(i,e)/(n*s);if(a<.9999999999999999){const o=Math.acos(a),l=((1-t)*n+t*s)/Math.sin(o),c=l/n*Math.sin((1-t)*o),u=l/s*Math.sin(t*o);return Q(cg,i,c),Q(hg,e,u),ce(r,cg,hg)}return Bn(r,i,e,t)}function GVe(i,e,t,r=P(),n=P()){const s=we(i),a=we(e),o=_e(i,e)/(s*a);if(o<.9999999999999999){const l=Math.acos(o),c=Math.sin(l),u=Math.sin(t*l),d=Math.sin((1-t)*l),m=(1-t)*s+t*a;{const f=m/c,_=f/a*u;Q(cg,i,f/s*d),Q(hg,e,_),ce(r,cg,hg)}{const f=1/s*(-Math.cos((1-t)*l)*l*m+d*(-s+a));Q(cg,i,f);const _=1/a*(Math.cos(t*l)*l*m+u*(-s+a));Q(hg,e,_),ce(n,cg,hg),Q(n,n,1/c)}return n}return Bn(r,i,e,t),ae(n,e,i),de(n,n),n}function nE(i,e,t){i=de(cg,i),e=de(hg,e);const r=ls(_e(i,e));if(t){const n=ut(Uye,i,e);if(_e(n,t)<0)return-r}return r}function sE(i){const e=i.length;return t=>{if(t<=i[0][0])return i[0][1];if(t>=i[e-1][0])return i[e-1][1];let r=1;for(;t>i[r][0];)r++;const n=i[r-1][0],s=i[r][0],a=(s-t)/(s-n);return a*i[r-1][1]+(1-a)*i[r][1]}}function HVe(i,e,t,r){ae(T6,e,i),ae(C6,t,i),ut(r,T6,C6),de(r,r),r[3]=-_e(i,r)}const T6=P(),C6=P(),Uye=P(),cg=P(),hg=P(),bO=ee.getLogger("esri.views.3d.support.geometryUtils.boundedPlane");let OQ=class{constructor(){this.plane=fr(),this.origin=P(),this.basis1=P(),this.basis2=P()}};function zd(i=zQ){return{plane:fr(i.plane),origin:as(i.origin),basis1:as(i.basis1),basis2:as(i.basis2)}}function zye(i,e,t){const r=Jye.get();return r.origin=i,r.basis1=e,r.basis2=t,r.plane=tne(0,0,0,0),EP(r),r}function c_(i,e=zd()){return UN(i.origin,i.basis1,i.basis2,e)}function Bye(i,e){X(e.origin,i.origin),X(e.basis1,i.basis1),X(e.basis2,i.basis2),FG(e.plane,i.plane)}function UN(i,e,t,r=zd()){return X(r.origin,i),X(r.basis1,e),X(r.basis2,t),EP(r),Yye(r,"fromValues()"),r}function EP(i){Sw(i.basis2,i.basis1,i.origin,i.plane)}function MQ(i,e,t){i!==t&&c_(i,t);const r=Q(Xe.get(),Id(i),e);return ce(t.origin,t.origin,r),t.plane[3]-=e,t}function Gye(i,e,t){return IQ(e,t),MQ(t,HN(i,i.origin),t),t}function IQ(i,e=zd()){const t=(i[2]-i[0])/2,r=(i[3]-i[1])/2;return Y(e.origin,i[0]+t,i[1]+r,0),Y(e.basis1,t,0,0),Y(e.basis2,0,r,0),ine(0,0,1,0,e.plane),e}function zN(i,e,t){return!!e_(i.plane,e,t)&&VQ(i,t)}function Hye(i,e,t){if(zN(i,e,t))return t;const r=LQ(i,e,Xe.get());return ce(t,e.origin,Q(Xe.get(),e.direction,Li(e.origin,r)/we(e.direction))),t}function LQ(i,e,t){const r=G2.get();UQ(i,e,r,G2.get());let n=Number.POSITIVE_INFINITY;for(const s of qN){const a=jN(i,s,RP.get()),o=Xe.get();if(rne(r,a,o)){const l=Jg(Xe.get(),e.origin,o),c=Math.abs(ls(_e(e.direction,l)));c<n&&(n=c,X(t,o))}}return n===Number.POSITIVE_INFINITY?$Q(i,e,t):t}function $Q(i,e,t){if(zN(i,e,t))return t;const r=G2.get(),n=G2.get();UQ(i,e,r,n);let s=Number.POSITIVE_INFINITY;for(const a of qN){const o=jN(i,a,RP.get()),l=Xe.get();if(nne(r,o,l)){const c=Vre(e,l);if(!NG(n,l))continue;c<s&&(s=c,X(t,l))}}return BN(i,e.origin)<s&&DQ(i,e.origin,t),t}function DQ(i,e,t){const r=sne(i.plane,e,Xe.get()),n=U5(S6(i,i.basis1),r,-1,1,Xe.get()),s=U5(S6(i,i.basis2),r,-1,1,Xe.get());return ae(t,ce(Xe.get(),n,s),i.origin),t}function FQ(i,e,t){const{origin:r,basis1:n,basis2:s}=i,a=ae(Xe.get(),e,r),o=Db(n,a),l=Db(s,a),c=Db(Id(i),a);return Y(t,o,l,c)}function BN(i,e){const t=FQ(i,e,Xe.get()),{basis1:r,basis2:n}=i,s=we(r),a=we(n),o=Math.max(Math.abs(t[0])-s,0),l=Math.max(Math.abs(t[1])-a,0),c=t[2];return o*o+l*l+c*c}function jye(i,e){return Math.sqrt(BN(i,e))}function qye(i,e){let t=Number.NEGATIVE_INFINITY;for(const r of qN){const n=jN(i,r,RP.get()),s=ID(n,e);s>t&&(t=s)}return Math.sqrt(t)}function GN(i,e){return NG(i.plane,e)&&VQ(i,e)}function Wye(i,e,t,r){return Zye(i,t,r)}function HN(i,e){const t=-i.plane[3];return Db(Id(i),e)-t}function Xye(i,e,t,r){const n=HN(i,e),s=Q(Kye,Id(i),t-n);return ce(r,e,s),r}function NQ(i,e){return Oc(i.basis1,e.basis1)&&Oc(i.basis2,e.basis2)&&Oc(i.origin,e.origin)}function kQ(i,e,t){return i!==t&&c_(i,t),kn(A_,e),AD(A_,A_),Me(t.basis1,i.basis1,A_),Me(t.basis2,i.basis2,A_),Me(Ia(t.plane),Ia(i.plane),A_),Me(t.origin,i.origin,e),$I(t.plane,t.plane,t.origin),t}function Qye(i,e,t,r){return i!==r&&c_(i,r),Bc(wO,e,t),Me(r.basis1,i.basis1,wO),Me(r.basis2,i.basis2,wO),EP(r),r}function Id(i){return Ia(i.plane)}function Zye(i,e,t){switch(e){case tm.X:X(t,i.basis1),de(t,t);break;case tm.Y:X(t,i.basis2),de(t,t);break;case tm.Z:X(t,Id(i))}return t}function VQ(i,e){const t=ae(Xe.get(),e,i.origin),r=Ml(i.basis1),n=Ml(i.basis2),s=_e(i.basis1,t),a=_e(i.basis2,t);return-s-r<0&&s-r<0&&-a-n<0&&a-n<0}function S6(i,e){const t=RP.get();return X(t.origin,i.origin),X(t.vector,e),t}function jN(i,e,t){const{basis1:r,basis2:n,origin:s}=i,a=Q(Xe.get(),r,e.origin[0]),o=Q(Xe.get(),n,e.origin[1]);ce(t.origin,a,o),ce(t.origin,t.origin,s);const l=Q(Xe.get(),r,e.direction[0]),c=Q(Xe.get(),n,e.direction[1]);return Q(t.vector,ce(l,l,c),2),t}function Yye(i,e){Math.abs(_e(i.basis1,i.basis2)/(we(i.basis1)*we(i.basis2)))>1e-6&&bO.warn(e,"Provided basis vectors are not perpendicular"),Math.abs(_e(i.basis1,Id(i)))>1e-6&&bO.warn(e,"Basis vectors and plane normal are not perpendicular"),Math.abs(-_e(Id(i),i.origin)-i.plane[3])>1e-6&&bO.warn(e,"Plane offset is not consistent with plane origin")}function UQ(i,e,t,r){const n=Id(i);Sw(n,e.direction,e.origin,t),Sw(Ia(t),n,e.origin,r)}const zQ={plane:fr(),origin:Ze(0,0,0),basis1:Ze(1,0,0),basis2:Ze(0,1,0)},G2=new SD(fr),RP=new SD(yv),Kye=P(),Jye=new SD(()=>zd()),qN=[{origin:[-1,-1],direction:[1,0]},{origin:[1,-1],direction:[0,1]},{origin:[1,1],direction:[-1,0]},{origin:[-1,1],direction:[0,-1]}],A_=xe(),wO=xe(),e0e=Object.freeze(Object.defineProperty({__proto__:null,BoundedPlaneClass:OQ,create:zd,wrap:zye,copy:c_,copyWithoutVerify:Bye,fromValues:UN,updateUnboundedPlane:EP,elevate:MQ,setExtent:Gye,fromAABoundingRect:IQ,intersectRay:zN,intersectRayClosestSilhouette:Hye,closestPointOnSilhouette:LQ,closestPoint:$Q,projectPoint:DQ,projectPointLocal:FQ,distance2:BN,distance:jye,distanceToSilhouette:qye,extrusionContainsPoint:GN,axisAt:Wye,altitudeAt:HN,setAltitudeAt:Xye,equals:NQ,transform:kQ,rotate:Qye,normal:Id,UP:zQ},Symbol.toStringTag,{value:"Module"}));function t0e(i){const{value:e,operations:t}=i;return{operations:t,value:t.create(e)}}function i0e(i,e,t){return i.operations.setExtent(i.value,e,t.value),t}function r0e(i){return{operations:i,value:i.create()}}function BQ(i,e,t=r0e(i)){return t.operations=i,i.copy(e,t.value),t}function n0e(i){return BQ(zre,Ure(0,0,0,Kt(i).radius))}const E6=2**50;function s0e(){return BQ(e0e,UN([0,0,0],[E6,0,0],[0,E6,0]))}function a0e(i,e,t){return i.operations.axisAt(i.value,e,tm.Z,t)}function o0e(i,e,t,r){return i.operations.axisAt(i.value,e,t,r)}function l0e(i,e,t){return i.operations.intersectRay(i.value,e,t)}function c0e(i,e,t){return i.operations.intersectRayClosestSilhouette(i.value,e,t)}function h0e(i,e){return i.operations.altitudeAt(i.value,e)}function GQ(i,e,t,r){return i.operations.setAltitudeAt(i.value,e,t,r)}function u0e(i,e,t,r){return e!==r&&pn(r,e),Y(O_,r[12],r[13],r[14]),GQ(i,O_,t,O_),r[12]=O_[0],r[13]=O_[1],r[14]=O_[2],r}function xO(i,e,t){return i.operations.elevate(i.value,e,t.value)}const O_=P();function R6(i,e,t,r,n){return n[0]=_e(i,e),n[1]=_e(i,t),n[2]=_e(i,r),n}function v3(i,e,t,r,n){X(t,i),X(YT,e),de(YT,YT),ut(r,YT,t),ut(n,r,t)}function HQ(i,e){return i?lie(e):e.isGeographic?Zt.PlateCarree:e}const YT=P(),d0e=12;let so=class da{constructor(e){const t=da.checkUnsupported(e);if(y(t))throw t;const r=ft(e);this.spatialReference=r.spatialReference,this._isWebMercator=this.spatialReference.isWebMercator,this._isGCS=Pg(this.spatialReference)||Dx(this.spatialReference)||Fx(this.spatialReference),this.origin=[r.origin.x,r.origin.y],this.pixelSize=r.size[0],this.dpi=r.dpi;const n=r.lods.reduce((c,u,d)=>(u.level<c.min&&(c.min=u.level,c.minIndex=d),c.max=Math.max(c.max,u.level),c),{min:1/0,minIndex:0,max:-1/0}),s=r.lods[n.minIndex],a=2**s.level;let o=s.resolution*a,l=s.scale*a;this.levels=new Array(n.max+1);for(let c=0;c<this.levels.length;c++)this.levels[c]={resolution:o,scale:l,tileSize:[o*r.size[0],o*r.size[1]]},o/=2,l/=2}clone(){return new da(this.toTileInfo())}toTileInfo(){return new Lb({dpi:this.dpi,origin:{x:this.origin[0],y:this.origin[1],spatialReference:this.spatialReference},size:[this.pixelSize,this.pixelSize],spatialReference:this.spatialReference,lods:this.levels.map((e,t)=>({level:t,scale:e.scale,resolution:e.resolution}))})}getExtent(e,t,r,n){const s=this.levels[e],a=s.tileSize[0],o=s.tileSize[1];n[0]=this.origin[0]+r*a,n[2]=this.origin[0]+(r+1)*a,n[3]=this.origin[1]-t*o,n[1]=this.origin[1]-(t+1)*o}convertExtentToRadians(e,t){this._isWebMercator?(t[0]=T5(e[0]),t[1]=fI(e[1]),t[2]=T5(e[2]),t[3]=fI(e[3])):this._isGCS&&(t[0]=At(e[0]),t[1]=At(e[1]),t[2]=At(e[2]),t[3]=At(e[3]))}getExtentGeometry(e,t,r,n=new pi){return this.getExtent(e,t,r,eh),n.spatialReference=this.spatialReference,n.xmin=eh[0],n.ymin=eh[1],n.xmax=eh[2],n.ymax=eh[3],n.zmin=void 0,n.zmax=void 0,n}ensureMaxLod(e){if(e==null)return!1;let t=!1;for(;this.levels.length<=e;){const r=this.levels[this.levels.length-1],n=r.resolution/2;this.levels.push({resolution:n,scale:r.scale/2,tileSize:[n*this.pixelSize,n*this.pixelSize]}),t=!0}return t}capMaxLod(e){this.levels.length>e+1&&(this.levels.length=e+1)}getMaxLod(){return this.levels.length-1}scaleAtLevel(e){return this.levels[0].scale/2**e}levelAtScale(e){const t=this.levels[0].scale;return e>=t?0:Math.log(t/e)*Math.LOG2E}resolutionAtLevel(e){return this.levels[0].resolution/2**e}compatibleWith(e){if(!(e instanceof da)){if(da.checkUnsupported(e))return!1;e=new da(e)}if(!e.spatialReference.equals(this.spatialReference)||e.pixelSize!==this.pixelSize)return!1;const t=Math.min(this.levels.length,e.levels.length)-1,r=this.levels[t].resolution;let n=.5*r;return!lA(e.origin[0],this.origin[0],n)||!lA(e.origin[1],this.origin[1],n)?!1:(n=.5*r/2**t/this.pixelSize*d0e,lA(r,e.levels[t].resolution,n))}rootTilesInExtent(e,t=null,r=1/0){const n=new Array,s=this.levels[0].tileSize;if(C(e)||s[0]===0||s[1]===0)return n;da.computeRowColExtent(e,s,this.origin,eh);let a=eh[1],o=eh[3],l=eh[0],c=eh[2];const u=c-l,d=o-a;if(u*d>r){const m=Math.floor(Math.sqrt(r));d>m&&(a=a+Math.floor(.5*d)-Math.floor(.5*m),o=a+m),u>m&&(l=l+Math.floor(.5*u)-Math.floor(.5*m),c=l+m)}for(let m=a;m<o;m++)for(let f=l;f<c;f++)n.push([0,m,f]);return y(t)&&(t[0]=this.origin[0]+l*s[0],t[1]=this.origin[1]-o*s[1],t[2]=this.origin[0]+c*s[0],t[3]=this.origin[1]-a*s[1]),n}static computeRowColExtent(e,t,r,n){const s=.001*(e[2]-e[0]+(e[3]-e[1]));n[0]=Math.max(0,Math.floor((e[0]+s-r[0])/t[0])),n[2]=Math.max(0,Math.ceil((e[2]-s-r[0])/t[0])),n[1]=Math.max(0,Math.floor((r[1]-e[3]+s)/t[1])),n[3]=Math.max(0,Math.ceil((r[1]-e[1]-s)/t[1]))}static isPowerOfTwo(e){const t=e.lods,r=t[0].resolution*2**t[0].level;return!t.some(n=>!vte(n.resolution,r/2**n.level))}static hasGapInLevels(e){const t=e.lods.map(r=>r.level);t.sort((r,n)=>r-n);for(let r=1;r<t.length;r++)if(t[r]!==t[0]+r)return!0;return!1}static tileSizeSupported(e){const t=e.size[1];return t===e.size[0]&&(t&t-1)==0&&t>=128&&t<=512}static hasOriginPerLODs(e){const t=e.origin;return e.lods.some(r=>r.origin!=null&&(r.origin[0]!==t.x||r.origin[1]!==t.y))}static getMissingTileInfoError(){return new J("tilingscheme:tile-info-missing","Tiling scheme must have tiling information")}static checkUnsupported(e){return C(e)?WN():e.lods.length<1?new J("tilingscheme:generic","Tiling scheme must have at least one level"):da.isPowerOfTwo(e)?da.hasGapInLevels(e)?new J("tilingscheme:gaps","Tiling scheme levels must not have gaps between min and max level"):da.tileSizeSupported(e)?da.hasOriginPerLODs(e)?new J("tilingscheme:multiple-origin","Tiling scheme levels must not have their own origin"):null:new J("tilingscheme:tile-size","Tiles must be square and size must be one of [128, 256, 512]"):new J("tilingscheme:power-of-two","Tiling scheme must be power of two")}static fromExtent(e,t){const r=e[2]-e[0],n=e[3]-e[1],s=Hm(t),a=1.2*Math.max(r,n),o=256,l=96,c=.0254,u=new da(new Lb({size:[o,o],origin:{x:e[0]-.5*(a-r),y:e[3]+.5*(a-n)},lods:[{level:0,resolution:a/o,scale:1/(o/l*c/(a*s))}],spatialReference:t}));return u.ensureMaxLod(20),u}static makeWebMercatorAuxiliarySphere(e){const t=new da(da.WebMercatorAuxiliarySphereTileInfo);return t.ensureMaxLod(e),t}static makeGCSWithTileSize(e,t=256,r=16){const n=256/t,s=new da(new Lb({size:[t,t],origin:{x:-180,y:90,spatialReference:e},spatialReference:e,lods:[{level:0,resolution:.703125*n,scale:295497598570834e-6*n}]}));return s.ensureMaxLod(r),s}get test(){return{isWebMercator:this._isWebMercator,isGCS:this._isGCS}}};function WN(){return new J("tilingscheme:tile-info-missing","Tiling scheme must have tiling information")}so.WebMercatorAuxiliarySphereTileInfo=new Lb({size:[256,256],origin:{x:-20037508342787e-6,y:20037508342787e-6,spatialReference:Zt.WebMercator},spatialReference:Zt.WebMercator,lods:[{level:0,resolution:156543.03392800014,scale:591657527591555e-6}]}),so.WebMercatorAuxiliarySphere=so.makeWebMercatorAuxiliarySphere(19);const eh=Nt(),d0=64,ib=512,p0e=2.5,lx=bte(wte/10),jQ=4,qQ=Nt();so.WebMercatorAuxiliarySphere.getExtent(0,0,0,qQ);const m0e=Nt([-180,-90,180,90]),f0e="Cannot extend surface to encompass all layers because it would result in too many root tiles.",g0e="Surface extent is too large for tile resolution at level 0.";let _0e=4;const aE=i=>i<4?3:_0e;let Ap=class extends nn.EventedAccessor{constructor(e){super(e),this.demResolution={min:-1,max:-1},this.noDataValue=lx}initialize(){this.view.basemapTerrain.on("elevation-change",()=>this.emit("changed",{}))}get extent(){const e=this.view.basemapTerrain;if(C(e.extent)||C(e.spatialReference))return null;const t=TG(e.extent,e.spatialReference);return t.zmin=e.visibleElevationBounds.min,t.zmax=e.visibleElevationBounds.max,t}get spatialReference(){return Ke(this.view.basemapTerrain.spatialReference,Zt.WGS84)}elevationAt(e,t){if(C(this.extent)||!Lte(this.extent,e,t)){const r=y(this.extent)?`${this.extent.xmin}, ${this.extent.ymin}, ${this.extent.xmax}, ${this.extent.ymax}`:null;return ee.getLogger(this.declaredClass).warn("#elevationAt()",`Point used to sample elevation (${e}, ${t}) is outside of the sampler extent (${r})`),this.noDataValue}return Ke(this.view.elevationProvider.getElevation(e,t,0,this.spatialReference,"ground"),this.noDataValue)}queryElevation(e){return une(e.clone(),this)}};h([p({readOnly:!0})],Ap.prototype,"demResolution",void 0),h([p({readOnly:!0})],Ap.prototype,"extent",null),h([p({readOnly:!0})],Ap.prototype,"noDataValue",void 0),h([p()],Ap.prototype,"spatialReference",null),h([p({constructOnly:!0})],Ap.prototype,"view",void 0),Ap=h([F("esri.views.support.GroundViewElevationSampler")],Ap);const y0e=Ap;let Op=class extends pe{constructor(e){super(e),this._handles=new Vt,this.view=null,this.layerViews=new wt}initialize(){this._handles.add(cs(()=>{var e,t;return(t=(e=this.view)==null?void 0:e.map)==null?void 0:t.ground},e=>e.load())),this._handles.add(this.layerViews.on("after-changes",()=>this._layerViewsAfterChangesHandler()))}destroy(){this._set("view",null),this._handles&&(this._handles.destroy(),this._handles=null)}get elevationSampler(){return this.view?this.view.type==="2d"?null:this.view.ready&&this.view.basemapTerrain&&this.view.basemapTerrain.ready?new y0e({view:this.view}):null:null}get updating(){return!this.suspended&&this.layerViews.some(e=>e.updating)}get suspended(){return!this.view||this.view.suspended}_layerViewsAfterChangesHandler(){this._handles.remove("updating"),this._handles.add(this.layerViews.map(e=>B(()=>e.updating,()=>this._updateUpdating(),ni)).toArray(),"updating"),this._updateUpdating()}_updateUpdating(){this.notifyChange("updating")}};h([p({readOnly:!0})],Op.prototype,"elevationSampler",null),h([p({type:Boolean,readOnly:!0})],Op.prototype,"updating",null),h([p({constructOnly:!0})],Op.prototype,"view",void 0),h([p({type:wt,readOnly:!0})],Op.prototype,"layerViews",void 0),h([p({readOnly:!0})],Op.prototype,"suspended",null),Op=h([F("esri.views.GroundView")],Op);const v0e=Op,s1=()=>j(()=>import("./TileLayerView3D-2c850d76.js"),["assets/TileLayerView3D-2c850d76.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/projection-290b739f.js","assets/preload-helper-3bce6601.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/unitUtils-45d1147c.js","assets/jsonMap-7b8332c9.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/SimpleObservable-23231131.js","assets/mat4-44a0988f.js","assets/Polyline-ff2d7c6b.js","assets/assets-8d3e737a.js","assets/request-6fc81c4c.js","assets/aaBoundingRect-193543b5.js","assets/zscale-89472cba.js","assets/LayerView3D-4202d4f4.js","assets/reactiveUtils-4dabbb80.js","assets/TiledLayerView3D-fcefa94b.js","assets/LayerView-bd9a2316.js","assets/Evented-a45c8b0f.js","assets/HandleOwner-9b396af1.js","assets/Identifiable-bfe1ff30.js","assets/Promise-376ab9f6.js","assets/RefreshableLayerView-7c1c2c75.js","assets/TileLayerView-80cc70bb.js","assets/clickToleranceUtils-a273d161.js","assets/drapedUtils-f6534f49.js","assets/geometry-b7901087.js","assets/typeUtils-35750739.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),P6=()=>j(()=>import("./ElevationLayerView3D-f950e800.js"),["assets/ElevationLayerView3D-f950e800.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/LayerView3D-4202d4f4.js","assets/reactiveUtils-4dabbb80.js","assets/TiledLayerView3D-fcefa94b.js","assets/LayerView-bd9a2316.js","assets/Evented-a45c8b0f.js","assets/HandleOwner-9b396af1.js","assets/Identifiable-bfe1ff30.js","assets/Promise-376ab9f6.js","assets/preload-helper-3bce6601.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),A6={"base-dynamic":()=>j(()=>import("./BaseDynamicLayerView3D-c48c8fe4.js"),["assets/BaseDynamicLayerView3D-c48c8fe4.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/DynamicLayerView3D-09cf86aa.js","assets/asyncUtils-437defc4.js","assets/reactiveUtils-4dabbb80.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/aaBoundingRect-193543b5.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/LayerView3D-4202d4f4.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/mat3-3fc68e72.js","assets/mat3f64-c6305894.js","assets/mat4-44a0988f.js","assets/mat4f64-1e28eae0.js","assets/aaBoundingBox-657a9b82.js","assets/BufferView-903d1848.js","assets/vec2-528adfe4.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/enums-64ab819c.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/quatf64-7fd38d64.js","assets/compilerUtils-18d58939.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/byteSizeEstimations-f0cab514.js","assets/VisualVariablePassParameters-d460182b.js","assets/VertexAttribute-9c5c630d.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/ShaderBuilder-a7d0da4e.js","assets/basicInterfaces-19ed850e.js","assets/ViewingMode-5d7d590b.js","assets/Util-a48361c6.js","assets/vec2f64-30dc1443.js","assets/vec4f64-e407da96.js","assets/sphere-2af0d852.js","assets/lineSegment-10422ca0.js","assets/Texture-46c8c2cb.js","assets/Evented-a45c8b0f.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/ScreenSpacePass-d5e48a9b.js","assets/Float4PassUniform-d7bdbc81.js","assets/Texture2DPassUniform-753de459.js","assets/assets-8d3e737a.js","assets/InterleavedLayout-984d67b2.js","assets/Matrix3PassUniform-ad9f953b.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/vec3f32-c9aa289f.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/symbolColorUtils-b2b55883.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/FloatPassUniform-68d54f51.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/projectExtentUtils-79348579.js","assets/ImageMaterial-85877c86.js","assets/ImageMaterial.glsl-befce2a1.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/Identifiable-bfe1ff30.js","assets/Promise-376ab9f6.js","assets/RefreshableLayerView-7c1c2c75.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/NormalUtils.glsl-c12729bf.js","assets/HUD.glsl-d3a072ad.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),"base-elevation":P6,"base-tile":s1,"bing-maps":s1,"building-scene":()=>j(()=>import("./BuildingSceneLayerView3D-a8353ba9.js"),["assets/BuildingSceneLayerView3D-a8353ba9.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/reactiveUtils-4dabbb80.js","assets/BuildingGroupSublayer-cc8c0afd.js","assets/loadAll-b5bfa7ab.js","assets/asyncUtils-437defc4.js","assets/BuildingComponentSublayer-cd73d2b0.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/MemCache-18a255ed.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/TimeExtent-23e282b9.js","assets/ElevationInfo-215614d8.js","assets/RelationshipQuery-0dda77ad.js","assets/Query-b96bcde0.js","assets/Layer-5ffe0eda.js","assets/HandleOwner-9b396af1.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/editsZScale-6a661299.js","assets/queryZScale-1481fa99.js","assets/zscale-89472cba.js","assets/FeatureSet-d32b0eb8.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/TopFeaturesQuery-cad97c37.js","assets/popupUtils-86dc6b94.js","assets/capabilities-a18453f6.js","assets/I3SIndexInfo-7af1a739.js","assets/I3SLayerDefinitions-ec48d9ab.js","assets/I3SUtil-f31a4571.js","assets/mat3-3fc68e72.js","assets/mat3f64-c6305894.js","assets/mat4f64-1e28eae0.js","assets/quat-3d5eec2d.js","assets/quatf64-7fd38d64.js","assets/I3SBinaryReader-f4829435.js","assets/VertexAttribute-9c5c630d.js","assets/projection-290b739f.js","assets/ViewingMode-5d7d590b.js","assets/symbolColorUtils-b2b55883.js","assets/vec3f32-c9aa289f.js","assets/plane-b575face.js","assets/sphere-2af0d852.js","assets/byteSizeEstimations-f0cab514.js","assets/vec2f64-30dc1443.js","assets/popupUtils-af06d391.js","assets/WhereClause-d4b8b019.js","assets/I3SMeshView3D-59ddde13.js","assets/mat3f32-d3d088e8.js","assets/I3SOverrides-35972e34.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/Scheduler-540208b6.js","assets/I3SNode-941d6d9e.js","assets/RenderTexture-a15e38d0.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec2-528adfe4.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/AlphaCutoff-96178e0d.js","assets/Texture-46c8c2cb.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/Util-a48361c6.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/ScreenSpacePass-d5e48a9b.js","assets/Octree-0a267ea2.js","assets/FeatureLayerView3D-3975b454.js","assets/FeatureLayerViewBase3D-fb4beaaf.js","assets/FeatureLikeLayerView3D-fcaec06e.js","assets/dehydratedFeatureComparison-59868945.js","assets/utils-6786b611.js","assets/ItemCache-fd3aceaf.js","assets/queryForSymbologySnapping-45d6d1c3.js","assets/elevationInfoUtils-36e5dd0f.js","assets/hash-0ddfbf4b.js","assets/Graphics3DObjectStates-56cfe062.js","assets/OptimizedFeature-4ab8d380.js","assets/optimizedFeatureQueryEngineAdapter-d72f082e.js","assets/centroid-5c988df3.js","assets/PooledRBush-3e149119.js","assets/quickselect-322ec8e1.js","assets/floorFilterUtils-080a7cd2.js","assets/QueryEngine-cdb0ba2c.js","assets/normalizeUtils-27e29a72.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/QueryEngineResult-8f90b8dc.js","assets/utils-b34fcd9d.js","assets/generateRendererUtils-7252b5e6.js","assets/projectionSupport-aa5eaa0d.js","assets/json-48e3ea08.js","assets/SnappingCandidate-970faec6.js","assets/utils-511aa5f5.js","assets/QueryEngineCapabilities-42e44ded.js","assets/timeSupport-3de56d7f.js","assets/scaleUtils-93ad8d0c.js","assets/FeatureStore-3cfbdfa3.js","assets/BoundsStore-b9fa27cc.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/vec2f32-461e65a9.js","assets/lineSegment-10422ca0.js","assets/InterleavedLayout-984d67b2.js","assets/Matrix3PassUniform-ad9f953b.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/Heatmap.glsl-388d8513.js","assets/HeatmapDensity.glsl-92a06674.js","assets/heatmapTextureUtils-2627384f.js","assets/projectExtentUtils-79348579.js","assets/LayerView3D-4202d4f4.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/LercDecoder-4c9b29b3.js","assets/EventedSet-be3adf97.js","assets/FeatureLayerView-e9178bab.js","assets/LayerView-bd9a2316.js","assets/RefreshableLayerView-7c1c2c75.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/executeQueryJSON-2fe748db.js","assets/mat2d-2bbb5feb.js","assets/Basemap-af7f62f8.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/capabilities-302cf20d.js","assets/ElevationSamplerData-b87e0e50.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/NormalUtils.glsl-c12729bf.js","assets/HUD.glsl-d3a072ad.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/labelFormatUtils-d25d1d9e.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js","assets/SceneModification-3462a3f4.js","assets/persistable-ad5d84e1.js","assets/SceneLayerWorker-02654016.js","assets/I3SQueryFeatureStore-788a3a0d.js","assets/DefinitionExpressionSceneLayerView-9802dbb8.js"]),csv:()=>j(()=>import("./CSVLayerView3D-2f8bea5d.js"),["assets/CSVLayerView3D-2f8bea5d.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/FeatureLayerViewBase3D-fb4beaaf.js","assets/reactiveUtils-4dabbb80.js","assets/FeatureLikeLayerView3D-fcaec06e.js","assets/asyncUtils-437defc4.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/Promise-376ab9f6.js","assets/HandleOwner-9b396af1.js","assets/arcgisLayerUrl-c09f09b4.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/persistableUrlUtils-5f719c3b.js","assets/Query-b96bcde0.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/TimeExtent-23e282b9.js","assets/enumeration-3a03bd31.js","assets/jsonUtils-229211af.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Clonable-545593ce.js","assets/aaBoundingRect-193543b5.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/dehydratedFeatures-0557137d.js","assets/byteSizeEstimations-f0cab514.js","assets/aaBoundingBox-657a9b82.js","assets/quantizationUtils-4dd81f85.js","assets/ViewingMode-5d7d590b.js","assets/dehydratedFeatureComparison-59868945.js","assets/Scheduler-540208b6.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/assets-8d3e737a.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/queryForSymbologySnapping-45d6d1c3.js","assets/elevationInfoUtils-36e5dd0f.js","assets/ElevationInfo-215614d8.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/hash-0ddfbf4b.js","assets/compilerUtils-18d58939.js","assets/diffUtils-68b89c71.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/Graphics3DObjectStates-56cfe062.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/projection-290b739f.js","assets/zscale-89472cba.js","assets/Layer-5ffe0eda.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OptimizedFeature-4ab8d380.js","assets/optimizedFeatureQueryEngineAdapter-d72f082e.js","assets/centroid-5c988df3.js","assets/PooledRBush-3e149119.js","assets/quickselect-322ec8e1.js","assets/basicInterfaces-19ed850e.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/OperationalLayer-97084f13.js","assets/floorFilterUtils-080a7cd2.js","assets/QueryEngine-cdb0ba2c.js","assets/normalizeUtils-27e29a72.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/QueryEngineResult-8f90b8dc.js","assets/WhereClause-d4b8b019.js","assets/utils-b34fcd9d.js","assets/generateRendererUtils-7252b5e6.js","assets/projectionSupport-aa5eaa0d.js","assets/json-48e3ea08.js","assets/SnappingCandidate-970faec6.js","assets/utils-511aa5f5.js","assets/QueryEngineCapabilities-42e44ded.js","assets/timeSupport-3de56d7f.js","assets/FieldsIndex-f104cc5f.js","assets/FeatureSet-d32b0eb8.js","assets/scaleUtils-93ad8d0c.js","assets/FeatureStore-3cfbdfa3.js","assets/BoundsStore-b9fa27cc.js","assets/VisualVariablePassParameters-d460182b.js","assets/VertexAttribute-9c5c630d.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/ShaderBuilder-a7d0da4e.js","assets/mat3f64-c6305894.js","assets/Util-a48361c6.js","assets/vec2f64-30dc1443.js","assets/mat4f64-1e28eae0.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec2-528adfe4.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/mat3-3fc68e72.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/quatf64-7fd38d64.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/sphere-2af0d852.js","assets/lineSegment-10422ca0.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/Matrix3PassUniform-ad9f953b.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/symbolColorUtils-b2b55883.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/Heatmap.glsl-388d8513.js","assets/HeatmapDensity.glsl-92a06674.js","assets/heatmapTextureUtils-2627384f.js","assets/projectExtentUtils-79348579.js","assets/LayerView3D-4202d4f4.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/LercDecoder-4c9b29b3.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/EventedSet-be3adf97.js","assets/FeatureLayerView-e9178bab.js","assets/popupUtils-af06d391.js","assets/LayerView-bd9a2316.js","assets/RefreshableLayerView-7c1c2c75.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/executeQueryJSON-2fe748db.js","assets/RelationshipQuery-0dda77ad.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/capabilities-302cf20d.js","assets/plane-b575face.js","assets/ElevationSamplerData-b87e0e50.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/NormalUtils.glsl-c12729bf.js","assets/HUD.glsl-d3a072ad.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),dimension:()=>j(()=>import("./DimensionLayerView3D-86b61a5e.js"),["assets/DimensionLayerView3D-86b61a5e.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/asyncUtils-437defc4.js","assets/reactiveUtils-4dabbb80.js","assets/LayerView3D-4202d4f4.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/Identifiable-bfe1ff30.js","assets/Promise-376ab9f6.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),elevation:P6,feature:()=>j(()=>import("./FeatureLayerView3D-3975b454.js"),["assets/FeatureLayerView3D-3975b454.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/projection-290b739f.js","assets/preload-helper-3bce6601.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/unitUtils-45d1147c.js","assets/jsonMap-7b8332c9.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/SimpleObservable-23231131.js","assets/mat4-44a0988f.js","assets/Polyline-ff2d7c6b.js","assets/assets-8d3e737a.js","assets/request-6fc81c4c.js","assets/aaBoundingRect-193543b5.js","assets/zscale-89472cba.js","assets/styleUtils-22b14a8b.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/locale-30120714.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/FeatureLayerViewBase3D-fb4beaaf.js","assets/reactiveUtils-4dabbb80.js","assets/FeatureLikeLayerView3D-fcaec06e.js","assets/asyncUtils-437defc4.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/HandleOwner-9b396af1.js","assets/arcgisLayerUrl-c09f09b4.js","assets/persistableUrlUtils-5f719c3b.js","assets/Query-b96bcde0.js","assets/geometry-b7901087.js","assets/typeUtils-35750739.js","assets/TimeExtent-23e282b9.js","assets/enumeration-3a03bd31.js","assets/jsonUtils-229211af.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Clonable-545593ce.js","assets/dehydratedFeatures-0557137d.js","assets/byteSizeEstimations-f0cab514.js","assets/aaBoundingBox-657a9b82.js","assets/quantizationUtils-4dd81f85.js","assets/ViewingMode-5d7d590b.js","assets/dehydratedFeatureComparison-59868945.js","assets/Scheduler-540208b6.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/number-27cf8195.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/queryForSymbologySnapping-45d6d1c3.js","assets/elevationInfoUtils-36e5dd0f.js","assets/ElevationInfo-215614d8.js","assets/lengthUtils-fa751420.js","assets/hash-0ddfbf4b.js","assets/compilerUtils-18d58939.js","assets/diffUtils-68b89c71.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/jsonUtils-0ff4ff96.js","assets/Graphics3DObjectStates-56cfe062.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/Layer-5ffe0eda.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OptimizedFeature-4ab8d380.js","assets/optimizedFeatureQueryEngineAdapter-d72f082e.js","assets/centroid-5c988df3.js","assets/PooledRBush-3e149119.js","assets/quickselect-322ec8e1.js","assets/basicInterfaces-19ed850e.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/OperationalLayer-97084f13.js","assets/floorFilterUtils-080a7cd2.js","assets/QueryEngine-cdb0ba2c.js","assets/normalizeUtils-27e29a72.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/QueryEngineResult-8f90b8dc.js","assets/WhereClause-d4b8b019.js","assets/utils-b34fcd9d.js","assets/generateRendererUtils-7252b5e6.js","assets/projectionSupport-aa5eaa0d.js","assets/json-48e3ea08.js","assets/SnappingCandidate-970faec6.js","assets/utils-511aa5f5.js","assets/QueryEngineCapabilities-42e44ded.js","assets/timeSupport-3de56d7f.js","assets/FieldsIndex-f104cc5f.js","assets/FeatureSet-d32b0eb8.js","assets/scaleUtils-93ad8d0c.js","assets/FeatureStore-3cfbdfa3.js","assets/BoundsStore-b9fa27cc.js","assets/VisualVariablePassParameters-d460182b.js","assets/VertexAttribute-9c5c630d.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/ShaderBuilder-a7d0da4e.js","assets/mat3f64-c6305894.js","assets/Util-a48361c6.js","assets/vec2f64-30dc1443.js","assets/mat4f64-1e28eae0.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec2-528adfe4.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/mat3-3fc68e72.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/quatf64-7fd38d64.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/sphere-2af0d852.js","assets/lineSegment-10422ca0.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/Matrix3PassUniform-ad9f953b.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/symbolColorUtils-b2b55883.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/Heatmap.glsl-388d8513.js","assets/HeatmapDensity.glsl-92a06674.js","assets/heatmapTextureUtils-2627384f.js","assets/projectExtentUtils-79348579.js","assets/LayerView3D-4202d4f4.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/LercDecoder-4c9b29b3.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/EventedSet-be3adf97.js","assets/FeatureLayerView-e9178bab.js","assets/popupUtils-af06d391.js","assets/LayerView-bd9a2316.js","assets/RefreshableLayerView-7c1c2c75.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/executeQueryJSON-2fe748db.js","assets/RelationshipQuery-0dda77ad.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/capabilities-302cf20d.js","assets/plane-b575face.js","assets/ElevationSamplerData-b87e0e50.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/NormalUtils.glsl-c12729bf.js","assets/HUD.glsl-d3a072ad.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),geojson:()=>j(()=>import("./GeoJSONLayerView3D-c49af2b6.js"),["assets/GeoJSONLayerView3D-c49af2b6.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/FeatureLayerViewBase3D-fb4beaaf.js","assets/reactiveUtils-4dabbb80.js","assets/FeatureLikeLayerView3D-fcaec06e.js","assets/asyncUtils-437defc4.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/Promise-376ab9f6.js","assets/HandleOwner-9b396af1.js","assets/arcgisLayerUrl-c09f09b4.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/persistableUrlUtils-5f719c3b.js","assets/Query-b96bcde0.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/TimeExtent-23e282b9.js","assets/enumeration-3a03bd31.js","assets/jsonUtils-229211af.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Clonable-545593ce.js","assets/aaBoundingRect-193543b5.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/dehydratedFeatures-0557137d.js","assets/byteSizeEstimations-f0cab514.js","assets/aaBoundingBox-657a9b82.js","assets/quantizationUtils-4dd81f85.js","assets/ViewingMode-5d7d590b.js","assets/dehydratedFeatureComparison-59868945.js","assets/Scheduler-540208b6.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/assets-8d3e737a.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/queryForSymbologySnapping-45d6d1c3.js","assets/elevationInfoUtils-36e5dd0f.js","assets/ElevationInfo-215614d8.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/hash-0ddfbf4b.js","assets/compilerUtils-18d58939.js","assets/diffUtils-68b89c71.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/Graphics3DObjectStates-56cfe062.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/projection-290b739f.js","assets/zscale-89472cba.js","assets/Layer-5ffe0eda.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OptimizedFeature-4ab8d380.js","assets/optimizedFeatureQueryEngineAdapter-d72f082e.js","assets/centroid-5c988df3.js","assets/PooledRBush-3e149119.js","assets/quickselect-322ec8e1.js","assets/basicInterfaces-19ed850e.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/OperationalLayer-97084f13.js","assets/floorFilterUtils-080a7cd2.js","assets/QueryEngine-cdb0ba2c.js","assets/normalizeUtils-27e29a72.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/QueryEngineResult-8f90b8dc.js","assets/WhereClause-d4b8b019.js","assets/utils-b34fcd9d.js","assets/generateRendererUtils-7252b5e6.js","assets/projectionSupport-aa5eaa0d.js","assets/json-48e3ea08.js","assets/SnappingCandidate-970faec6.js","assets/utils-511aa5f5.js","assets/QueryEngineCapabilities-42e44ded.js","assets/timeSupport-3de56d7f.js","assets/FieldsIndex-f104cc5f.js","assets/FeatureSet-d32b0eb8.js","assets/scaleUtils-93ad8d0c.js","assets/FeatureStore-3cfbdfa3.js","assets/BoundsStore-b9fa27cc.js","assets/VisualVariablePassParameters-d460182b.js","assets/VertexAttribute-9c5c630d.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/ShaderBuilder-a7d0da4e.js","assets/mat3f64-c6305894.js","assets/Util-a48361c6.js","assets/vec2f64-30dc1443.js","assets/mat4f64-1e28eae0.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec2-528adfe4.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/mat3-3fc68e72.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/quatf64-7fd38d64.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/sphere-2af0d852.js","assets/lineSegment-10422ca0.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/Matrix3PassUniform-ad9f953b.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/symbolColorUtils-b2b55883.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/Heatmap.glsl-388d8513.js","assets/HeatmapDensity.glsl-92a06674.js","assets/heatmapTextureUtils-2627384f.js","assets/projectExtentUtils-79348579.js","assets/LayerView3D-4202d4f4.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/LercDecoder-4c9b29b3.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/EventedSet-be3adf97.js","assets/FeatureLayerView-e9178bab.js","assets/popupUtils-af06d391.js","assets/LayerView-bd9a2316.js","assets/RefreshableLayerView-7c1c2c75.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/executeQueryJSON-2fe748db.js","assets/RelationshipQuery-0dda77ad.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/capabilities-302cf20d.js","assets/plane-b575face.js","assets/ElevationSamplerData-b87e0e50.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/NormalUtils.glsl-c12729bf.js","assets/HUD.glsl-d3a072ad.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),graphics:()=>j(()=>import("./GraphicsLayerView3D-38edcfe0.js"),["assets/GraphicsLayerView3D-38edcfe0.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/reactiveUtils-4dabbb80.js","assets/LayerView3D-4202d4f4.js","assets/queryForSymbologySnapping-45d6d1c3.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/dehydratedFeatures-0557137d.js","assets/byteSizeEstimations-f0cab514.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/quantizationUtils-4dd81f85.js","assets/jsonUtils-229211af.js","assets/Field-61ec9870.js","assets/enumeration-3a03bd31.js","assets/fieldType-f31285f7.js","assets/elevationInfoUtils-36e5dd0f.js","assets/ElevationInfo-215614d8.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/GraphicsProcessor-220bbf91.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/HandleOwner-9b396af1.js","assets/diffUtils-68b89c71.js","assets/Layer-5ffe0eda.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/Graphics3DObjectStates-56cfe062.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/MemCache-18a255ed.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/projection-290b739f.js","assets/mat4-44a0988f.js","assets/assets-8d3e737a.js","assets/zscale-89472cba.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OptimizedFeature-4ab8d380.js","assets/optimizedFeatureQueryEngineAdapter-d72f082e.js","assets/centroid-5c988df3.js","assets/asyncUtils-437defc4.js","assets/PooledRBush-3e149119.js","assets/quickselect-322ec8e1.js","assets/basicInterfaces-19ed850e.js","assets/Scheduler-540208b6.js","assets/projectExtentUtils-79348579.js","assets/LayerView-bd9a2316.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/RelationshipQuery-0dda77ad.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),group:()=>j(()=>import("./GroupLayerView-6f5d18e8.js"),["assets/GroupLayerView-6f5d18e8.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/collectionUtils-803d9ba8.js","assets/reactiveUtils-4dabbb80.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/Identifiable-bfe1ff30.js","assets/Promise-376ab9f6.js"]),imagery:()=>j(()=>import("./ImageryLayerView3D-eb4235d5.js"),["assets/ImageryLayerView3D-eb4235d5.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/reactiveUtils-4dabbb80.js","assets/DynamicLayerView3D-09cf86aa.js","assets/asyncUtils-437defc4.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/aaBoundingRect-193543b5.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/LayerView3D-4202d4f4.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/mat3-3fc68e72.js","assets/mat3f64-c6305894.js","assets/mat4-44a0988f.js","assets/mat4f64-1e28eae0.js","assets/aaBoundingBox-657a9b82.js","assets/BufferView-903d1848.js","assets/vec2-528adfe4.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/enums-64ab819c.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/quatf64-7fd38d64.js","assets/compilerUtils-18d58939.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/byteSizeEstimations-f0cab514.js","assets/VisualVariablePassParameters-d460182b.js","assets/VertexAttribute-9c5c630d.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/ShaderBuilder-a7d0da4e.js","assets/basicInterfaces-19ed850e.js","assets/ViewingMode-5d7d590b.js","assets/Util-a48361c6.js","assets/vec2f64-30dc1443.js","assets/vec4f64-e407da96.js","assets/sphere-2af0d852.js","assets/lineSegment-10422ca0.js","assets/Texture-46c8c2cb.js","assets/Evented-a45c8b0f.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/ScreenSpacePass-d5e48a9b.js","assets/Float4PassUniform-d7bdbc81.js","assets/Texture2DPassUniform-753de459.js","assets/assets-8d3e737a.js","assets/InterleavedLayout-984d67b2.js","assets/Matrix3PassUniform-ad9f953b.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/vec3f32-c9aa289f.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/symbolColorUtils-b2b55883.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/FloatPassUniform-68d54f51.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/projectExtentUtils-79348579.js","assets/ImageMaterial-85877c86.js","assets/ImageMaterial.glsl-befce2a1.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/Identifiable-bfe1ff30.js","assets/Promise-376ab9f6.js","assets/RefreshableLayerView-7c1c2c75.js","assets/ImageryLayerView-31e9d56f.js","assets/OperationalLayer-97084f13.js","assets/TimeExtent-23e282b9.js","assets/persistableUrlUtils-5f719c3b.js","assets/ElevationInfo-215614d8.js","assets/jsonMap-7b8332c9.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/geometry-b7901087.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/opacityUtils-1f7f5126.js","assets/Query-b96bcde0.js","assets/enumeration-3a03bd31.js","assets/jsonUtils-229211af.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Clonable-545593ce.js","assets/popupUtils-af06d391.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/Collection-910b6f71.js","assets/SimpleObservable-23231131.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/symbolLayerUtils3D-76acc268.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/NormalUtils.glsl-c12729bf.js","assets/HUD.glsl-d3a072ad.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),"integrated-mesh":()=>j(()=>import("./IntegratedMeshLayerView3D-a9d21bf5.js"),["assets/IntegratedMeshLayerView3D-a9d21bf5.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/reactiveUtils-4dabbb80.js","assets/I3SMeshView3D-59ddde13.js","assets/byteSizeEstimations-f0cab514.js","assets/unitUtils-45d1147c.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/mat4-44a0988f.js","assets/mat4f64-1e28eae0.js","assets/vec4f64-e407da96.js","assets/projection-290b739f.js","assets/assets-8d3e737a.js","assets/zscale-89472cba.js","assets/I3SOverrides-35972e34.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Scheduler-540208b6.js","assets/ViewingMode-5d7d590b.js","assets/I3SNode-941d6d9e.js","assets/sphere-2af0d852.js","assets/mat3f64-c6305894.js","assets/quatf64-7fd38d64.js","assets/vec2f64-30dc1443.js","assets/I3SUtil-f31a4571.js","assets/quat-3d5eec2d.js","assets/I3SBinaryReader-f4829435.js","assets/VertexAttribute-9c5c630d.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/symbolColorUtils-b2b55883.js","assets/vec3f32-c9aa289f.js","assets/plane-b575face.js","assets/asyncUtils-437defc4.js","assets/RenderTexture-a15e38d0.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec2-528adfe4.js","assets/compilerUtils-18d58939.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/AlphaCutoff-96178e0d.js","assets/Texture-46c8c2cb.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/Util-a48361c6.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/ScreenSpacePass-d5e48a9b.js","assets/Octree-0a267ea2.js","assets/styleUtils-22b14a8b.js","assets/FeatureLayerView3D-3975b454.js","assets/FeatureLayerViewBase3D-fb4beaaf.js","assets/FeatureLikeLayerView3D-fcaec06e.js","assets/HandleOwner-9b396af1.js","assets/arcgisLayerUrl-c09f09b4.js","assets/dehydratedFeatureComparison-59868945.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/queryForSymbologySnapping-45d6d1c3.js","assets/elevationInfoUtils-36e5dd0f.js","assets/ElevationInfo-215614d8.js","assets/lengthUtils-fa751420.js","assets/hash-0ddfbf4b.js","assets/diffUtils-68b89c71.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/jsonUtils-0ff4ff96.js","assets/Graphics3DObjectStates-56cfe062.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/Layer-5ffe0eda.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OptimizedFeature-4ab8d380.js","assets/optimizedFeatureQueryEngineAdapter-d72f082e.js","assets/centroid-5c988df3.js","assets/PooledRBush-3e149119.js","assets/quickselect-322ec8e1.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/OperationalLayer-97084f13.js","assets/floorFilterUtils-080a7cd2.js","assets/QueryEngine-cdb0ba2c.js","assets/normalizeUtils-27e29a72.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/QueryEngineResult-8f90b8dc.js","assets/WhereClause-d4b8b019.js","assets/utils-b34fcd9d.js","assets/generateRendererUtils-7252b5e6.js","assets/projectionSupport-aa5eaa0d.js","assets/json-48e3ea08.js","assets/SnappingCandidate-970faec6.js","assets/utils-511aa5f5.js","assets/QueryEngineCapabilities-42e44ded.js","assets/timeSupport-3de56d7f.js","assets/FieldsIndex-f104cc5f.js","assets/FeatureSet-d32b0eb8.js","assets/scaleUtils-93ad8d0c.js","assets/FeatureStore-3cfbdfa3.js","assets/BoundsStore-b9fa27cc.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/vec2f32-461e65a9.js","assets/lineSegment-10422ca0.js","assets/InterleavedLayout-984d67b2.js","assets/Matrix3PassUniform-ad9f953b.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/Heatmap.glsl-388d8513.js","assets/HeatmapDensity.glsl-92a06674.js","assets/heatmapTextureUtils-2627384f.js","assets/projectExtentUtils-79348579.js","assets/LayerView3D-4202d4f4.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/LercDecoder-4c9b29b3.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/EventedSet-be3adf97.js","assets/FeatureLayerView-e9178bab.js","assets/popupUtils-af06d391.js","assets/LayerView-bd9a2316.js","assets/RefreshableLayerView-7c1c2c75.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/executeQueryJSON-2fe748db.js","assets/RelationshipQuery-0dda77ad.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/capabilities-302cf20d.js","assets/ElevationSamplerData-b87e0e50.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/NormalUtils.glsl-c12729bf.js","assets/HUD.glsl-d3a072ad.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/labelFormatUtils-d25d1d9e.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js","assets/SceneModification-3462a3f4.js","assets/persistable-ad5d84e1.js","assets/SceneLayerWorker-02654016.js"]),"line-of-sight":()=>j(()=>import("./LineOfSightLayerView3D-16b56893.js"),["assets/LineOfSightLayerView3D-16b56893.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/asyncUtils-437defc4.js","assets/reactiveUtils-4dabbb80.js","assets/LayerView3D-4202d4f4.js","assets/LayerView-bd9a2316.js","assets/Evented-a45c8b0f.js","assets/HandleOwner-9b396af1.js","assets/Identifiable-bfe1ff30.js","assets/Promise-376ab9f6.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),"map-image":()=>j(()=>import("./MapImageLayerView3D-2334bdfb.js"),["assets/MapImageLayerView3D-2334bdfb.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/DynamicLayerView3D-09cf86aa.js","assets/asyncUtils-437defc4.js","assets/reactiveUtils-4dabbb80.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/aaBoundingRect-193543b5.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/LayerView3D-4202d4f4.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/mat3-3fc68e72.js","assets/mat3f64-c6305894.js","assets/mat4-44a0988f.js","assets/mat4f64-1e28eae0.js","assets/aaBoundingBox-657a9b82.js","assets/BufferView-903d1848.js","assets/vec2-528adfe4.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/enums-64ab819c.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/quatf64-7fd38d64.js","assets/compilerUtils-18d58939.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/byteSizeEstimations-f0cab514.js","assets/VisualVariablePassParameters-d460182b.js","assets/VertexAttribute-9c5c630d.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/ShaderBuilder-a7d0da4e.js","assets/basicInterfaces-19ed850e.js","assets/ViewingMode-5d7d590b.js","assets/Util-a48361c6.js","assets/vec2f64-30dc1443.js","assets/vec4f64-e407da96.js","assets/sphere-2af0d852.js","assets/lineSegment-10422ca0.js","assets/Texture-46c8c2cb.js","assets/Evented-a45c8b0f.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/ScreenSpacePass-d5e48a9b.js","assets/Float4PassUniform-d7bdbc81.js","assets/Texture2DPassUniform-753de459.js","assets/assets-8d3e737a.js","assets/InterleavedLayout-984d67b2.js","assets/Matrix3PassUniform-ad9f953b.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/vec3f32-c9aa289f.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/symbolColorUtils-b2b55883.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/FloatPassUniform-68d54f51.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/projectExtentUtils-79348579.js","assets/ImageMaterial-85877c86.js","assets/ImageMaterial.glsl-befce2a1.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/Identifiable-bfe1ff30.js","assets/Promise-376ab9f6.js","assets/RefreshableLayerView-7c1c2c75.js","assets/MapImageLayerView-7b24456f.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/enumeration-3a03bd31.js","assets/jsonMap-7b8332c9.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/geometry-b7901087.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/Collection-910b6f71.js","assets/SimpleObservable-23231131.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/locale-30120714.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/Clonable-545593ce.js","assets/unitUtils-45d1147c.js","assets/scaleUtils-93ad8d0c.js","assets/OperationalLayer-97084f13.js","assets/TimeExtent-23e282b9.js","assets/ElevationInfo-215614d8.js","assets/lengthUtils-fa751420.js","assets/ExportImageParameters-4b588db2.js","assets/LayerFloorInfo-54b916a2.js","assets/floorFilterUtils-080a7cd2.js","assets/sublayerUtils-96c8a85b.js","assets/clickToleranceUtils-a273d161.js","assets/normalizeUtils-27e29a72.js","assets/jsonUtils-229211af.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/number-27cf8195.js","assets/GraphicsCollection-c37a9ffd.js","assets/popupUtils-af06d391.js","assets/drapedUtils-f6534f49.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/executeQueryJSON-2fe748db.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/plane-b575face.js","assets/ElevationSamplerData-b87e0e50.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/NormalUtils.glsl-c12729bf.js","assets/HUD.glsl-d3a072ad.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),media:()=>j(()=>import("./MediaLayerView3D-2cf8253b.js"),["assets/MediaLayerView3D-2cf8253b.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/reactiveUtils-4dabbb80.js","assets/aaBoundingRect-193543b5.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/LayerView3D-4202d4f4.js","assets/basicInterfaces-19ed850e.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/mat3-3fc68e72.js","assets/mat3f64-c6305894.js","assets/mat4-44a0988f.js","assets/mat4f64-1e28eae0.js","assets/aaBoundingBox-657a9b82.js","assets/BufferView-903d1848.js","assets/vec2-528adfe4.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/asyncUtils-437defc4.js","assets/enums-64ab819c.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/quatf64-7fd38d64.js","assets/compilerUtils-18d58939.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/byteSizeEstimations-f0cab514.js","assets/VisualVariablePassParameters-d460182b.js","assets/VertexAttribute-9c5c630d.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/ShaderBuilder-a7d0da4e.js","assets/ViewingMode-5d7d590b.js","assets/Util-a48361c6.js","assets/vec2f64-30dc1443.js","assets/vec4f64-e407da96.js","assets/sphere-2af0d852.js","assets/lineSegment-10422ca0.js","assets/Texture-46c8c2cb.js","assets/Evented-a45c8b0f.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/ScreenSpacePass-d5e48a9b.js","assets/Float4PassUniform-d7bdbc81.js","assets/Texture2DPassUniform-753de459.js","assets/assets-8d3e737a.js","assets/InterleavedLayout-984d67b2.js","assets/Matrix3PassUniform-ad9f953b.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/vec3f32-c9aa289f.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/symbolColorUtils-b2b55883.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/FloatPassUniform-68d54f51.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/ImageMaterial-85877c86.js","assets/ImageMaterial.glsl-befce2a1.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/Identifiable-bfe1ff30.js","assets/Promise-376ab9f6.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/NormalUtils.glsl-c12729bf.js","assets/HUD.glsl-d3a072ad.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),"ogc-feature":()=>j(()=>import("./OGCFeatureLayerView3D-f1b1a570.js"),["assets/OGCFeatureLayerView3D-f1b1a570.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/FeatureLayerViewBase3D-fb4beaaf.js","assets/reactiveUtils-4dabbb80.js","assets/FeatureLikeLayerView3D-fcaec06e.js","assets/asyncUtils-437defc4.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/Promise-376ab9f6.js","assets/HandleOwner-9b396af1.js","assets/arcgisLayerUrl-c09f09b4.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/persistableUrlUtils-5f719c3b.js","assets/Query-b96bcde0.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/TimeExtent-23e282b9.js","assets/enumeration-3a03bd31.js","assets/jsonUtils-229211af.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Clonable-545593ce.js","assets/aaBoundingRect-193543b5.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/dehydratedFeatures-0557137d.js","assets/byteSizeEstimations-f0cab514.js","assets/aaBoundingBox-657a9b82.js","assets/quantizationUtils-4dd81f85.js","assets/ViewingMode-5d7d590b.js","assets/dehydratedFeatureComparison-59868945.js","assets/Scheduler-540208b6.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/assets-8d3e737a.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/queryForSymbologySnapping-45d6d1c3.js","assets/elevationInfoUtils-36e5dd0f.js","assets/ElevationInfo-215614d8.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/hash-0ddfbf4b.js","assets/compilerUtils-18d58939.js","assets/diffUtils-68b89c71.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/Graphics3DObjectStates-56cfe062.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/projection-290b739f.js","assets/zscale-89472cba.js","assets/Layer-5ffe0eda.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OptimizedFeature-4ab8d380.js","assets/optimizedFeatureQueryEngineAdapter-d72f082e.js","assets/centroid-5c988df3.js","assets/PooledRBush-3e149119.js","assets/quickselect-322ec8e1.js","assets/basicInterfaces-19ed850e.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/OperationalLayer-97084f13.js","assets/floorFilterUtils-080a7cd2.js","assets/QueryEngine-cdb0ba2c.js","assets/normalizeUtils-27e29a72.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/QueryEngineResult-8f90b8dc.js","assets/WhereClause-d4b8b019.js","assets/utils-b34fcd9d.js","assets/generateRendererUtils-7252b5e6.js","assets/projectionSupport-aa5eaa0d.js","assets/json-48e3ea08.js","assets/SnappingCandidate-970faec6.js","assets/utils-511aa5f5.js","assets/QueryEngineCapabilities-42e44ded.js","assets/timeSupport-3de56d7f.js","assets/FieldsIndex-f104cc5f.js","assets/FeatureSet-d32b0eb8.js","assets/scaleUtils-93ad8d0c.js","assets/FeatureStore-3cfbdfa3.js","assets/BoundsStore-b9fa27cc.js","assets/VisualVariablePassParameters-d460182b.js","assets/VertexAttribute-9c5c630d.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/ShaderBuilder-a7d0da4e.js","assets/mat3f64-c6305894.js","assets/Util-a48361c6.js","assets/vec2f64-30dc1443.js","assets/mat4f64-1e28eae0.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec2-528adfe4.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/mat3-3fc68e72.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/quatf64-7fd38d64.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/sphere-2af0d852.js","assets/lineSegment-10422ca0.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/Matrix3PassUniform-ad9f953b.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/symbolColorUtils-b2b55883.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/Heatmap.glsl-388d8513.js","assets/HeatmapDensity.glsl-92a06674.js","assets/heatmapTextureUtils-2627384f.js","assets/projectExtentUtils-79348579.js","assets/LayerView3D-4202d4f4.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/LercDecoder-4c9b29b3.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/EventedSet-be3adf97.js","assets/FeatureLayerView-e9178bab.js","assets/popupUtils-af06d391.js","assets/LayerView-bd9a2316.js","assets/RefreshableLayerView-7c1c2c75.js","assets/OGCFeatureLayerView-409b7077.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/executeQueryJSON-2fe748db.js","assets/RelationshipQuery-0dda77ad.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/capabilities-302cf20d.js","assets/plane-b575face.js","assets/ElevationSamplerData-b87e0e50.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/NormalUtils.glsl-c12729bf.js","assets/HUD.glsl-d3a072ad.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),"open-street-map":s1,"oriented-imagery":()=>j(()=>import("./FeatureLayerView3D-3975b454.js"),["assets/FeatureLayerView3D-3975b454.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/projection-290b739f.js","assets/preload-helper-3bce6601.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/unitUtils-45d1147c.js","assets/jsonMap-7b8332c9.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/SimpleObservable-23231131.js","assets/mat4-44a0988f.js","assets/Polyline-ff2d7c6b.js","assets/assets-8d3e737a.js","assets/request-6fc81c4c.js","assets/aaBoundingRect-193543b5.js","assets/zscale-89472cba.js","assets/styleUtils-22b14a8b.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/locale-30120714.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/FeatureLayerViewBase3D-fb4beaaf.js","assets/reactiveUtils-4dabbb80.js","assets/FeatureLikeLayerView3D-fcaec06e.js","assets/asyncUtils-437defc4.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/HandleOwner-9b396af1.js","assets/arcgisLayerUrl-c09f09b4.js","assets/persistableUrlUtils-5f719c3b.js","assets/Query-b96bcde0.js","assets/geometry-b7901087.js","assets/typeUtils-35750739.js","assets/TimeExtent-23e282b9.js","assets/enumeration-3a03bd31.js","assets/jsonUtils-229211af.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Clonable-545593ce.js","assets/dehydratedFeatures-0557137d.js","assets/byteSizeEstimations-f0cab514.js","assets/aaBoundingBox-657a9b82.js","assets/quantizationUtils-4dd81f85.js","assets/ViewingMode-5d7d590b.js","assets/dehydratedFeatureComparison-59868945.js","assets/Scheduler-540208b6.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/number-27cf8195.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/queryForSymbologySnapping-45d6d1c3.js","assets/elevationInfoUtils-36e5dd0f.js","assets/ElevationInfo-215614d8.js","assets/lengthUtils-fa751420.js","assets/hash-0ddfbf4b.js","assets/compilerUtils-18d58939.js","assets/diffUtils-68b89c71.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/jsonUtils-0ff4ff96.js","assets/Graphics3DObjectStates-56cfe062.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/Layer-5ffe0eda.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OptimizedFeature-4ab8d380.js","assets/optimizedFeatureQueryEngineAdapter-d72f082e.js","assets/centroid-5c988df3.js","assets/PooledRBush-3e149119.js","assets/quickselect-322ec8e1.js","assets/basicInterfaces-19ed850e.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/OperationalLayer-97084f13.js","assets/floorFilterUtils-080a7cd2.js","assets/QueryEngine-cdb0ba2c.js","assets/normalizeUtils-27e29a72.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/QueryEngineResult-8f90b8dc.js","assets/WhereClause-d4b8b019.js","assets/utils-b34fcd9d.js","assets/generateRendererUtils-7252b5e6.js","assets/projectionSupport-aa5eaa0d.js","assets/json-48e3ea08.js","assets/SnappingCandidate-970faec6.js","assets/utils-511aa5f5.js","assets/QueryEngineCapabilities-42e44ded.js","assets/timeSupport-3de56d7f.js","assets/FieldsIndex-f104cc5f.js","assets/FeatureSet-d32b0eb8.js","assets/scaleUtils-93ad8d0c.js","assets/FeatureStore-3cfbdfa3.js","assets/BoundsStore-b9fa27cc.js","assets/VisualVariablePassParameters-d460182b.js","assets/VertexAttribute-9c5c630d.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/ShaderBuilder-a7d0da4e.js","assets/mat3f64-c6305894.js","assets/Util-a48361c6.js","assets/vec2f64-30dc1443.js","assets/mat4f64-1e28eae0.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec2-528adfe4.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/mat3-3fc68e72.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/quatf64-7fd38d64.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/sphere-2af0d852.js","assets/lineSegment-10422ca0.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/Matrix3PassUniform-ad9f953b.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/symbolColorUtils-b2b55883.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/Heatmap.glsl-388d8513.js","assets/HeatmapDensity.glsl-92a06674.js","assets/heatmapTextureUtils-2627384f.js","assets/projectExtentUtils-79348579.js","assets/LayerView3D-4202d4f4.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/LercDecoder-4c9b29b3.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/EventedSet-be3adf97.js","assets/FeatureLayerView-e9178bab.js","assets/popupUtils-af06d391.js","assets/LayerView-bd9a2316.js","assets/RefreshableLayerView-7c1c2c75.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/executeQueryJSON-2fe748db.js","assets/RelationshipQuery-0dda77ad.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/capabilities-302cf20d.js","assets/plane-b575face.js","assets/ElevationSamplerData-b87e0e50.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/NormalUtils.glsl-c12729bf.js","assets/HUD.glsl-d3a072ad.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),"point-cloud":()=>j(()=>import("./PointCloudLayerView3D-3060b61e.js").then(i=>i.P),["assets/PointCloudLayerView3D-3060b61e.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/asyncUtils-437defc4.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/reactiveUtils-4dabbb80.js","assets/screenUtils-410d12c0.js","assets/unitUtils-45d1147c.js","assets/jsonMap-7b8332c9.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec3f32-c9aa289f.js","assets/projection-290b739f.js","assets/preload-helper-3bce6601.js","assets/mathUtils-b4bb77e2.js","assets/vec4-790471c0.js","assets/mat4-44a0988f.js","assets/Polyline-ff2d7c6b.js","assets/assets-8d3e737a.js","assets/request-6fc81c4c.js","assets/aaBoundingRect-193543b5.js","assets/zscale-89472cba.js","assets/aaBoundingBox-657a9b82.js","assets/plane-b575face.js","assets/sphere-2af0d852.js","assets/vec4f64-e407da96.js","assets/byteSizeEstimations-f0cab514.js","assets/mat3f64-c6305894.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/vec2f64-30dc1443.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/jsonUtils-229211af.js","assets/typeUtils-35750739.js","assets/Field-61ec9870.js","assets/enumeration-3a03bd31.js","assets/fieldType-f31285f7.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/geometry-b7901087.js","assets/Scheduler-540208b6.js","assets/ElevationInfo-215614d8.js","assets/lengthUtils-fa751420.js","assets/LayerView3D-4202d4f4.js","assets/LercDecoder-4c9b29b3.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/messages-2289086c.js","assets/I3SUtil-f31a4571.js","assets/mat3-3fc68e72.js","assets/quat-3d5eec2d.js","assets/I3SBinaryReader-f4829435.js","assets/VertexAttribute-9c5c630d.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/Clonable-545593ce.js","assets/ViewingMode-5d7d590b.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/symbolColorUtils-b2b55883.js","assets/PointCloudWorkerUtil-831c5cd2.js","assets/PointCloudUniqueValueRenderer-b0367a06.js","assets/LegendOptions-010d0873.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/basicInterfaces-19ed850e.js","assets/Matrix3PassUniform-ad9f953b.js","assets/ShaderBuilder-a7d0da4e.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/Util-a48361c6.js","assets/vec2-528adfe4.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/Texture2DPassUniform-753de459.js","assets/Slice.glsl-3b39b1f7.js","assets/OutputHighlight.glsl-fbac199a.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DDrawUniform-053796dc.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/compilerUtils-18d58939.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/PiUtils.glsl-db6418ee.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/lineSegment-10422ca0.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/PopupSceneLayerView-56a29af9.js","assets/popupUtils-af06d391.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js"]),voxel:()=>j(()=>import("./VoxelLayerView3D-94b648b3.js"),["assets/VoxelLayerView3D-94b648b3.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/reactiveUtils-4dabbb80.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/LayerView3D-4202d4f4.js","assets/LayerView-bd9a2316.js","assets/Evented-a45c8b0f.js","assets/HandleOwner-9b396af1.js","assets/Identifiable-bfe1ff30.js","assets/Promise-376ab9f6.js","assets/context-util-a4ce3a7b.js","assets/preload-helper-3bce6601.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),route:()=>j(()=>import("./RouteLayerView3D-2752cbf2.js"),["assets/RouteLayerView3D-2752cbf2.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/Stop-8921a099.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/LayerView3D-4202d4f4.js","assets/GraphicsProcessor-220bbf91.js","assets/HandleOwner-9b396af1.js","assets/diffUtils-68b89c71.js","assets/Layer-5ffe0eda.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Graphics3DObjectStates-56cfe062.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/MemCache-18a255ed.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/projection-290b739f.js","assets/mat4-44a0988f.js","assets/assets-8d3e737a.js","assets/zscale-89472cba.js","assets/dehydratedFeatures-0557137d.js","assets/byteSizeEstimations-f0cab514.js","assets/quantizationUtils-4dd81f85.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OptimizedFeature-4ab8d380.js","assets/optimizedFeatureQueryEngineAdapter-d72f082e.js","assets/centroid-5c988df3.js","assets/asyncUtils-437defc4.js","assets/PooledRBush-3e149119.js","assets/quickselect-322ec8e1.js","assets/ElevationInfo-215614d8.js","assets/basicInterfaces-19ed850e.js","assets/Scheduler-540208b6.js","assets/projectExtentUtils-79348579.js","assets/EventedSet-be3adf97.js","assets/LayerView-bd9a2316.js","assets/Cyclical-151bcc41.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/RelationshipQuery-0dda77ad.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),scene:i=>i.profile==null||i.profile==="mesh-pyramids"?j(()=>import("./SceneLayerView3D-c302791e.js"),["assets/SceneLayerView3D-c302791e.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/reactiveUtils-4dabbb80.js","assets/WhereClause-d4b8b019.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/TimeExtent-23e282b9.js","assets/Query-b96bcde0.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/MemCache-18a255ed.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/floorFilterUtils-080a7cd2.js","assets/I3SMeshView3D-59ddde13.js","assets/byteSizeEstimations-f0cab514.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/mat4f64-1e28eae0.js","assets/projection-290b739f.js","assets/assets-8d3e737a.js","assets/zscale-89472cba.js","assets/I3SOverrides-35972e34.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/Scheduler-540208b6.js","assets/ViewingMode-5d7d590b.js","assets/I3SNode-941d6d9e.js","assets/sphere-2af0d852.js","assets/mat3f64-c6305894.js","assets/quatf64-7fd38d64.js","assets/vec2f64-30dc1443.js","assets/I3SUtil-f31a4571.js","assets/quat-3d5eec2d.js","assets/I3SBinaryReader-f4829435.js","assets/VertexAttribute-9c5c630d.js","assets/symbolColorUtils-b2b55883.js","assets/vec3f32-c9aa289f.js","assets/plane-b575face.js","assets/asyncUtils-437defc4.js","assets/RenderTexture-a15e38d0.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec2-528adfe4.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/AlphaCutoff-96178e0d.js","assets/Texture-46c8c2cb.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/Util-a48361c6.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/ScreenSpacePass-d5e48a9b.js","assets/Octree-0a267ea2.js","assets/FeatureLayerView3D-3975b454.js","assets/FeatureLayerViewBase3D-fb4beaaf.js","assets/FeatureLikeLayerView3D-fcaec06e.js","assets/HandleOwner-9b396af1.js","assets/arcgisLayerUrl-c09f09b4.js","assets/dehydratedFeatureComparison-59868945.js","assets/utils-6786b611.js","assets/ItemCache-fd3aceaf.js","assets/queryForSymbologySnapping-45d6d1c3.js","assets/elevationInfoUtils-36e5dd0f.js","assets/hash-0ddfbf4b.js","assets/Graphics3DObjectStates-56cfe062.js","assets/Layer-5ffe0eda.js","assets/OptimizedFeature-4ab8d380.js","assets/optimizedFeatureQueryEngineAdapter-d72f082e.js","assets/centroid-5c988df3.js","assets/PooledRBush-3e149119.js","assets/quickselect-322ec8e1.js","assets/QueryEngine-cdb0ba2c.js","assets/normalizeUtils-27e29a72.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/QueryEngineResult-8f90b8dc.js","assets/utils-b34fcd9d.js","assets/generateRendererUtils-7252b5e6.js","assets/projectionSupport-aa5eaa0d.js","assets/json-48e3ea08.js","assets/SnappingCandidate-970faec6.js","assets/utils-511aa5f5.js","assets/QueryEngineCapabilities-42e44ded.js","assets/timeSupport-3de56d7f.js","assets/FieldsIndex-f104cc5f.js","assets/FeatureSet-d32b0eb8.js","assets/scaleUtils-93ad8d0c.js","assets/FeatureStore-3cfbdfa3.js","assets/BoundsStore-b9fa27cc.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/vec2f32-461e65a9.js","assets/lineSegment-10422ca0.js","assets/InterleavedLayout-984d67b2.js","assets/Matrix3PassUniform-ad9f953b.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/Heatmap.glsl-388d8513.js","assets/HeatmapDensity.glsl-92a06674.js","assets/heatmapTextureUtils-2627384f.js","assets/projectExtentUtils-79348579.js","assets/LayerView3D-4202d4f4.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/LercDecoder-4c9b29b3.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/EventedSet-be3adf97.js","assets/FeatureLayerView-e9178bab.js","assets/popupUtils-af06d391.js","assets/LayerView-bd9a2316.js","assets/RefreshableLayerView-7c1c2c75.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/executeQueryJSON-2fe748db.js","assets/RelationshipQuery-0dda77ad.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/capabilities-302cf20d.js","assets/ElevationSamplerData-b87e0e50.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/NormalUtils.glsl-c12729bf.js","assets/HUD.glsl-d3a072ad.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/labelFormatUtils-d25d1d9e.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js","assets/SceneModification-3462a3f4.js","assets/persistable-ad5d84e1.js","assets/SceneLayerWorker-02654016.js","assets/SceneLayerView-e17bd758.js","assets/DefinitionExpressionSceneLayerView-9802dbb8.js","assets/I3SQueryFeatureStore-788a3a0d.js","assets/PopupSceneLayerView-56a29af9.js"]):j(()=>import("./SceneLayerGraphicsView3D-bdee1643.js"),["assets/SceneLayerGraphicsView3D-bdee1643.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/reactiveUtils-4dabbb80.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/assets-8d3e737a.js","assets/zscale-89472cba.js","assets/dehydratedFeatures-0557137d.js","assets/byteSizeEstimations-f0cab514.js","assets/quantizationUtils-4dd81f85.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/I3SOverrides-35972e34.js","assets/Scheduler-540208b6.js","assets/ViewingMode-5d7d590b.js","assets/vec4f64-e407da96.js","assets/I3SNode-941d6d9e.js","assets/sphere-2af0d852.js","assets/mat3f64-c6305894.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/vec2f64-30dc1443.js","assets/I3SUtil-f31a4571.js","assets/mat3-3fc68e72.js","assets/quat-3d5eec2d.js","assets/I3SBinaryReader-f4829435.js","assets/VertexAttribute-9c5c630d.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/symbolColorUtils-b2b55883.js","assets/vec3f32-c9aa289f.js","assets/plane-b575face.js","assets/asyncUtils-437defc4.js","assets/RenderTexture-a15e38d0.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec2-528adfe4.js","assets/compilerUtils-18d58939.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/AlphaCutoff-96178e0d.js","assets/Texture-46c8c2cb.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/Util-a48361c6.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/ScreenSpacePass-d5e48a9b.js","assets/Octree-0a267ea2.js","assets/styleUtils-22b14a8b.js","assets/FeatureLayerView3D-3975b454.js","assets/FeatureLayerViewBase3D-fb4beaaf.js","assets/FeatureLikeLayerView3D-fcaec06e.js","assets/HandleOwner-9b396af1.js","assets/arcgisLayerUrl-c09f09b4.js","assets/dehydratedFeatureComparison-59868945.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/queryForSymbologySnapping-45d6d1c3.js","assets/elevationInfoUtils-36e5dd0f.js","assets/ElevationInfo-215614d8.js","assets/lengthUtils-fa751420.js","assets/hash-0ddfbf4b.js","assets/diffUtils-68b89c71.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/jsonUtils-0ff4ff96.js","assets/Graphics3DObjectStates-56cfe062.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/Layer-5ffe0eda.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OptimizedFeature-4ab8d380.js","assets/optimizedFeatureQueryEngineAdapter-d72f082e.js","assets/centroid-5c988df3.js","assets/PooledRBush-3e149119.js","assets/quickselect-322ec8e1.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/OperationalLayer-97084f13.js","assets/floorFilterUtils-080a7cd2.js","assets/QueryEngine-cdb0ba2c.js","assets/normalizeUtils-27e29a72.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/QueryEngineResult-8f90b8dc.js","assets/WhereClause-d4b8b019.js","assets/utils-b34fcd9d.js","assets/generateRendererUtils-7252b5e6.js","assets/projectionSupport-aa5eaa0d.js","assets/json-48e3ea08.js","assets/SnappingCandidate-970faec6.js","assets/utils-511aa5f5.js","assets/QueryEngineCapabilities-42e44ded.js","assets/timeSupport-3de56d7f.js","assets/FieldsIndex-f104cc5f.js","assets/FeatureSet-d32b0eb8.js","assets/scaleUtils-93ad8d0c.js","assets/FeatureStore-3cfbdfa3.js","assets/BoundsStore-b9fa27cc.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/lineSegment-10422ca0.js","assets/InterleavedLayout-984d67b2.js","assets/Matrix3PassUniform-ad9f953b.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/Heatmap.glsl-388d8513.js","assets/HeatmapDensity.glsl-92a06674.js","assets/heatmapTextureUtils-2627384f.js","assets/projectExtentUtils-79348579.js","assets/LayerView3D-4202d4f4.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/LercDecoder-4c9b29b3.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/EventedSet-be3adf97.js","assets/FeatureLayerView-e9178bab.js","assets/popupUtils-af06d391.js","assets/LayerView-bd9a2316.js","assets/RefreshableLayerView-7c1c2c75.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/executeQueryJSON-2fe748db.js","assets/RelationshipQuery-0dda77ad.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/capabilities-302cf20d.js","assets/ElevationSamplerData-b87e0e50.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/NormalUtils.glsl-c12729bf.js","assets/HUD.glsl-d3a072ad.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/labelFormatUtils-d25d1d9e.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js","assets/SceneLayerView-e17bd758.js","assets/DefinitionExpressionSceneLayerView-9802dbb8.js","assets/PopupSceneLayerView-56a29af9.js"]),stream:()=>j(()=>import("./StreamLayerView3D-db0ce9f7.js"),["assets/StreamLayerView3D-db0ce9f7.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/reactiveUtils-4dabbb80.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/HandleOwner-9b396af1.js","assets/StreamFeatureManager-adf26b1c.js","assets/CircularArray-f4b6cd92.js","assets/createConnection-37f8beca.js","assets/zscale-89472cba.js","assets/unitUtils-45d1147c.js","assets/query-694f7287.js","assets/normalizeUtils-27e29a72.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/EventedSet-be3adf97.js","assets/FeatureLikeLayerView3D-fcaec06e.js","assets/asyncUtils-437defc4.js","assets/arcgisLayerUrl-c09f09b4.js","assets/dehydratedFeatures-0557137d.js","assets/byteSizeEstimations-f0cab514.js","assets/quantizationUtils-4dd81f85.js","assets/ViewingMode-5d7d590b.js","assets/dehydratedFeatureComparison-59868945.js","assets/Scheduler-540208b6.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/assets-8d3e737a.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/queryForSymbologySnapping-45d6d1c3.js","assets/elevationInfoUtils-36e5dd0f.js","assets/ElevationInfo-215614d8.js","assets/lengthUtils-fa751420.js","assets/hash-0ddfbf4b.js","assets/compilerUtils-18d58939.js","assets/diffUtils-68b89c71.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/Graphics3DObjectStates-56cfe062.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/projection-290b739f.js","assets/Layer-5ffe0eda.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/optimizedFeatureQueryEngineAdapter-d72f082e.js","assets/centroid-5c988df3.js","assets/PooledRBush-3e149119.js","assets/quickselect-322ec8e1.js","assets/basicInterfaces-19ed850e.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/OperationalLayer-97084f13.js","assets/floorFilterUtils-080a7cd2.js","assets/QueryEngine-cdb0ba2c.js","assets/featureConversionUtils-03a03f40.js","assets/QueryEngineResult-8f90b8dc.js","assets/WhereClause-d4b8b019.js","assets/utils-b34fcd9d.js","assets/generateRendererUtils-7252b5e6.js","assets/projectionSupport-aa5eaa0d.js","assets/json-48e3ea08.js","assets/SnappingCandidate-970faec6.js","assets/utils-511aa5f5.js","assets/QueryEngineCapabilities-42e44ded.js","assets/timeSupport-3de56d7f.js","assets/FieldsIndex-f104cc5f.js","assets/FeatureSet-d32b0eb8.js","assets/scaleUtils-93ad8d0c.js","assets/FeatureStore-3cfbdfa3.js","assets/BoundsStore-b9fa27cc.js","assets/VisualVariablePassParameters-d460182b.js","assets/VertexAttribute-9c5c630d.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/ShaderBuilder-a7d0da4e.js","assets/mat3f64-c6305894.js","assets/Util-a48361c6.js","assets/vec2f64-30dc1443.js","assets/mat4f64-1e28eae0.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec2-528adfe4.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/mat3-3fc68e72.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/quatf64-7fd38d64.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/sphere-2af0d852.js","assets/lineSegment-10422ca0.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/Matrix3PassUniform-ad9f953b.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/symbolColorUtils-b2b55883.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/Heatmap.glsl-388d8513.js","assets/HeatmapDensity.glsl-92a06674.js","assets/heatmapTextureUtils-2627384f.js","assets/projectExtentUtils-79348579.js","assets/LayerView3D-4202d4f4.js","assets/LayerView-bd9a2316.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/executeQueryJSON-2fe748db.js","assets/RelationshipQuery-0dda77ad.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/capabilities-302cf20d.js","assets/plane-b575face.js","assets/ElevationSamplerData-b87e0e50.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/NormalUtils.glsl-c12729bf.js","assets/HUD.glsl-d3a072ad.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),tile:s1,"imagery-tile":()=>j(()=>import("./ImageryTileLayerView3D-b9d685b8.js"),["assets/ImageryTileLayerView3D-b9d685b8.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/reactiveUtils-4dabbb80.js","assets/LayerView3D-4202d4f4.js","assets/TiledLayerView3D-fcefa94b.js","assets/ImageryTileLayerView-f97d6c38.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/OperationalLayer-97084f13.js","assets/TimeExtent-23e282b9.js","assets/ElevationInfo-215614d8.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/rasterProjectionHelper-a7452876.js","assets/projection-290b739f.js","assets/mat4-44a0988f.js","assets/assets-8d3e737a.js","assets/zscale-89472cba.js","assets/popupUtils-af06d391.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/RefreshableLayerView-7c1c2c75.js","assets/drapedUtils-f6534f49.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),"vector-tile":()=>j(()=>import("./VectorTileLayerView3D-ad804504.js"),["assets/VectorTileLayerView3D-ad804504.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/reactiveUtils-4dabbb80.js","assets/MemCache-18a255ed.js","assets/mat3f32-d3d088e8.js","assets/aaBoundingRect-193543b5.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/TileInfoViewPOT-07a81608.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/number-27cf8195.js","assets/jsonMap-7b8332c9.js","assets/locale-30120714.js","assets/messages-2289086c.js","assets/Rect-ea14f53a.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/pbf-0e99a620.js","assets/rasterizingUtils-ec11e94c.js","assets/floatRGBA-9ad35d39.js","assets/TileKey-5aef17b6.js","assets/config-1337d16e.js","assets/StyleDefinition-ff072275.js","assets/enums-2658a65c.js","assets/TileInfo-b0eb8c90.js","assets/unitUtils-45d1147c.js","assets/TileStore-00ac650f.js","assets/Evented-a45c8b0f.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-b96bcde0.js","assets/geometry-b7901087.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/TimeExtent-23e282b9.js","assets/enumeration-3a03bd31.js","assets/jsonUtils-229211af.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Clonable-545593ce.js","assets/WGLBrushVTLSymbol-d778c554.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/vec2f64-30dc1443.js","assets/VertexElementDescriptor-2925c6af.js","assets/enums-4ca4641f.js","assets/number-954e4ab6.js","assets/FramebufferObject-a3b9c52c.js","assets/vec2f32-461e65a9.js","assets/GeometryUtils-c093d234.js","assets/VTLMaterialManager-2c63b5e3.js","assets/enums-0fc02184.js","assets/ShaderCompiler-77d0dcb6.js","assets/programUtils-f035fe8a.js","assets/StyleRepository-0c36ed5d.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/colorUtils-0c057879.js","assets/GeometryUtils-eebff0a0.js","assets/Geometry-daada628.js","assets/LayerView3D-4202d4f4.js","assets/TiledLayerView3D-fcefa94b.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/Identifiable-bfe1ff30.js","assets/Promise-376ab9f6.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/Collection-910b6f71.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/projection-290b739f.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/vec2-528adfe4.js","assets/TileStrategy-a90cd1af.js","assets/capabilities-302cf20d.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),wcs:()=>j(()=>import("./ImageryTileLayerView3D-b9d685b8.js"),["assets/ImageryTileLayerView3D-b9d685b8.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/reactiveUtils-4dabbb80.js","assets/LayerView3D-4202d4f4.js","assets/TiledLayerView3D-fcefa94b.js","assets/ImageryTileLayerView-f97d6c38.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/OperationalLayer-97084f13.js","assets/TimeExtent-23e282b9.js","assets/ElevationInfo-215614d8.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/rasterProjectionHelper-a7452876.js","assets/projection-290b739f.js","assets/mat4-44a0988f.js","assets/assets-8d3e737a.js","assets/zscale-89472cba.js","assets/popupUtils-af06d391.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/RefreshableLayerView-7c1c2c75.js","assets/drapedUtils-f6534f49.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),"web-tile":s1,wfs:()=>j(()=>import("./WFSLayerView3D-1e9633c6.js"),["assets/WFSLayerView3D-1e9633c6.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/FeatureLayerViewBase3D-fb4beaaf.js","assets/reactiveUtils-4dabbb80.js","assets/FeatureLikeLayerView3D-fcaec06e.js","assets/asyncUtils-437defc4.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/Promise-376ab9f6.js","assets/HandleOwner-9b396af1.js","assets/arcgisLayerUrl-c09f09b4.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/persistableUrlUtils-5f719c3b.js","assets/Query-b96bcde0.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/TimeExtent-23e282b9.js","assets/enumeration-3a03bd31.js","assets/jsonUtils-229211af.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Clonable-545593ce.js","assets/aaBoundingRect-193543b5.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/dehydratedFeatures-0557137d.js","assets/byteSizeEstimations-f0cab514.js","assets/aaBoundingBox-657a9b82.js","assets/quantizationUtils-4dd81f85.js","assets/ViewingMode-5d7d590b.js","assets/dehydratedFeatureComparison-59868945.js","assets/Scheduler-540208b6.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/mat4-44a0988f.js","assets/assets-8d3e737a.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/queryForSymbologySnapping-45d6d1c3.js","assets/elevationInfoUtils-36e5dd0f.js","assets/ElevationInfo-215614d8.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/hash-0ddfbf4b.js","assets/compilerUtils-18d58939.js","assets/diffUtils-68b89c71.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/Graphics3DObjectStates-56cfe062.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/projection-290b739f.js","assets/zscale-89472cba.js","assets/Layer-5ffe0eda.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OptimizedFeature-4ab8d380.js","assets/optimizedFeatureQueryEngineAdapter-d72f082e.js","assets/centroid-5c988df3.js","assets/PooledRBush-3e149119.js","assets/quickselect-322ec8e1.js","assets/basicInterfaces-19ed850e.js","assets/FeatureReductionLayer-d69dae71.js","assets/BlendLayer-20d0571b.js","assets/OperationalLayer-97084f13.js","assets/floorFilterUtils-080a7cd2.js","assets/QueryEngine-cdb0ba2c.js","assets/normalizeUtils-27e29a72.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/QueryEngineResult-8f90b8dc.js","assets/WhereClause-d4b8b019.js","assets/utils-b34fcd9d.js","assets/generateRendererUtils-7252b5e6.js","assets/projectionSupport-aa5eaa0d.js","assets/json-48e3ea08.js","assets/SnappingCandidate-970faec6.js","assets/utils-511aa5f5.js","assets/QueryEngineCapabilities-42e44ded.js","assets/timeSupport-3de56d7f.js","assets/FieldsIndex-f104cc5f.js","assets/FeatureSet-d32b0eb8.js","assets/scaleUtils-93ad8d0c.js","assets/FeatureStore-3cfbdfa3.js","assets/BoundsStore-b9fa27cc.js","assets/VisualVariablePassParameters-d460182b.js","assets/VertexAttribute-9c5c630d.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/ShaderBuilder-a7d0da4e.js","assets/mat3f64-c6305894.js","assets/Util-a48361c6.js","assets/vec2f64-30dc1443.js","assets/mat4f64-1e28eae0.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec2-528adfe4.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/mat3-3fc68e72.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/quatf64-7fd38d64.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/sphere-2af0d852.js","assets/lineSegment-10422ca0.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/Matrix3PassUniform-ad9f953b.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/symbolColorUtils-b2b55883.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/Heatmap.glsl-388d8513.js","assets/HeatmapDensity.glsl-92a06674.js","assets/heatmapTextureUtils-2627384f.js","assets/projectExtentUtils-79348579.js","assets/LayerView3D-4202d4f4.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/queryZScale-1481fa99.js","assets/LercDecoder-4c9b29b3.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/EventedSet-be3adf97.js","assets/FeatureLayerView-e9178bab.js","assets/popupUtils-af06d391.js","assets/LayerView-bd9a2316.js","assets/RefreshableLayerView-7c1c2c75.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/executeQueryJSON-2fe748db.js","assets/RelationshipQuery-0dda77ad.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/capabilities-302cf20d.js","assets/plane-b575face.js","assets/ElevationSamplerData-b87e0e50.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/NormalUtils.glsl-c12729bf.js","assets/HUD.glsl-d3a072ad.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),wms:()=>j(()=>import("./WMSLayerView3D-5d847f08.js"),["assets/WMSLayerView3D-5d847f08.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/DynamicLayerView3D-09cf86aa.js","assets/asyncUtils-437defc4.js","assets/reactiveUtils-4dabbb80.js","assets/aaBoundingRect-193543b5.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/LayerView3D-4202d4f4.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/mat3-3fc68e72.js","assets/mat3f64-c6305894.js","assets/mat4-44a0988f.js","assets/mat4f64-1e28eae0.js","assets/aaBoundingBox-657a9b82.js","assets/BufferView-903d1848.js","assets/vec2-528adfe4.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/enums-64ab819c.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/quatf64-7fd38d64.js","assets/compilerUtils-18d58939.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/byteSizeEstimations-f0cab514.js","assets/VisualVariablePassParameters-d460182b.js","assets/VertexAttribute-9c5c630d.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/ShaderBuilder-a7d0da4e.js","assets/basicInterfaces-19ed850e.js","assets/ViewingMode-5d7d590b.js","assets/Util-a48361c6.js","assets/vec2f64-30dc1443.js","assets/vec4f64-e407da96.js","assets/sphere-2af0d852.js","assets/lineSegment-10422ca0.js","assets/Texture-46c8c2cb.js","assets/Evented-a45c8b0f.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/ScreenSpacePass-d5e48a9b.js","assets/Float4PassUniform-d7bdbc81.js","assets/Texture2DPassUniform-753de459.js","assets/assets-8d3e737a.js","assets/InterleavedLayout-984d67b2.js","assets/Matrix3PassUniform-ad9f953b.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/vec3f32-c9aa289f.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/symbolColorUtils-b2b55883.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/FloatPassUniform-68d54f51.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/projectExtentUtils-79348579.js","assets/ImageMaterial-85877c86.js","assets/ImageMaterial.glsl-befce2a1.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/Identifiable-bfe1ff30.js","assets/Promise-376ab9f6.js","assets/RefreshableLayerView-7c1c2c75.js","assets/WMSLayerView-ccaae110.js","assets/OperationalLayer-97084f13.js","assets/TimeExtent-23e282b9.js","assets/persistableUrlUtils-5f719c3b.js","assets/ElevationInfo-215614d8.js","assets/jsonMap-7b8332c9.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/geometry-b7901087.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/opacityUtils-1f7f5126.js","assets/ExportWMSImageParameters-e7eb0d55.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/SimpleObservable-23231131.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/symbolLayerUtils3D-76acc268.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/NormalUtils.glsl-c12729bf.js","assets/HUD.glsl-d3a072ad.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),wmts:()=>j(()=>import("./WMTSLayerView3D-faf69967.js"),["assets/WMTSLayerView3D-faf69967.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/reactiveUtils-4dabbb80.js","assets/layerUtils-f4d08f94.js","assets/LayerView3D-4202d4f4.js","assets/TiledLayerView3D-fcefa94b.js","assets/LayerView-bd9a2316.js","assets/HandleOwner-9b396af1.js","assets/Identifiable-bfe1ff30.js","assets/Promise-376ab9f6.js","assets/RefreshableLayerView-7c1c2c75.js","assets/preload-helper-3bce6601.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),"geo-rss":null,kml:null,"map-notes":null,"subtype-group":null,unknown:null,unsupported:null};function b0e(i){const e=i.declaredClass?i.declaredClass.slice(i.declaredClass.lastIndexOf(".")+1):"Unknown",t=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new J(`${t}:view-not-supported`,`${e} is not supported in 3D`)}const O6={hasLayerViewModule:i=>y(A6[i.type]),importLayerView:i=>{const e=A6[i.type];if(C(e))throw b0e(i);return e(i)}},M6="analyses-owner-handles";var p0,Kf;(function(i){i[i.PENDING=0]="PENDING",i[i.CREATED=1]="CREATED"})(p0||(p0={})),function(i){i[i.ADDED=0]="ADDED",i[i.REMOVED=1]="REMOVED"}(Kf||(Kf={}));let Df=class extends dD{constructor(e){super(e),this._allAnalysisViews=new wt,this._creatingViewCount=0,this._items=new Map,this._scheduledUpdateHandle=null,this._attachedToViewResolver=I6(),this._analysisModules={"area-measurement":{module:null},dimension:{module:null},"direct-line-measurement":{module:null},"line-of-sight":{module:null},slice:{module:null}}}destroy(){this._disconnectOwners(),this._attachedToViewResolver.reject(ts("AnalysisViewManager was destroyed"))}attach(){this._connectOwners(),this._attachedToViewResolver.resolve()}detach(){this._disconnectOwners(),this._attachedToViewResolver.reject(ts()),this._attachedToViewResolver=I6()}get updating(){return!this.view.ready||this._creatingViewCount!==0||this._allAnalysisViews.some(e=>e.updating)}get testInfo(){return{allAnalysisViews:this._allAnalysisViews}}async whenAnalysisView(e){await this._attachedToViewResolver.promise;const t=this._items.get(e);if(C(t)||t.state.list===Kf.REMOVED)throw new J("AnalysisViewManager:no-analysisview-for-analysis","The analysis has not been added to view.analyses",{analysis:e});return t.createAnalysisViewTask.promise}_connectOwners(){this.handles.add(this._connectAnalysesCollection(this.view.analyses),M6)}_disconnectOwners(){this.handles.remove(M6),this._update(),this._creatingViewCount=0}_connectAnalysesCollection(e){for(const n of e)this._addAnalysis(n);const t=e.on("after-add",n=>this._addAnalysis(n.item)),r=e.on("after-remove",n=>this._removeAnalysis(n.item));return{remove:()=>{t.remove(),r.remove();for(const n of e)this._removeAnalysis(n)}}}_addAnalysis(e){const t=this._items.get(e);if(t==null){const r={state:{view:p0.PENDING,list:Kf.ADDED},analysis:e,view:null,createAnalysisViewTask:null};this._items.set(e,r),r.createAnalysisViewTask=Bx(n=>this._createAnalysisViewPromise(r,n))}else t.state.list=Kf.ADDED}_removeAnalysis(e){const t=this._items.get(e);t!=null?(t.state.list=Kf.REMOVED,this._scheduleUpdate()):ee.getLogger(this.declaredClass).error("Trying to remove analysis which was not added")}_scheduleUpdate(){y(this._scheduledUpdateHandle)||(this._scheduledUpdateHandle=L7(()=>this._update()))}_update(){this._scheduledUpdateHandle=Os(this._scheduledUpdateHandle),this._items.forEach(e=>{if(e.state.list===Kf.REMOVED)switch(this._items.delete(e.analysis),e.state.view){case p0.PENDING:e.createAnalysisViewTask=iu(e.createAnalysisViewTask);break;case p0.CREATED:y(e.view)&&(this._allAnalysisViews.remove(e.view),e.view=Oe(e.view),e.createAnalysisViewTask=null)}})}async _createAnalysisViewPromise(e,t){const r=e.analysis,n=r.type,s=this._analysisModules[n];if(this._creatingViewCount+=1,C(s.module))try{s.module=await this._loadAnalysisModule(n)}catch(o){throw this._creatingViewCount-=1,o}if(Ec(t))throw this._creatingViewCount-=1,ts("AnalysisView creation aborted");const a=new s.module.default({analysis:r,view:this.view});try{await a.when()}catch(o){throw this._creatingViewCount-=1,o}if(Ec(t))throw this._creatingViewCount-=1,a.destroy(),ts("AnalysisView creation aborted");return e.view=a,e.state.view=p0.CREATED,this._allAnalysisViews.add(a),this._creatingViewCount-=1,a}_loadAnalysisModule(e){switch(e){case"area-measurement":return j(()=>import("./AreaMeasurementAnalysisView3D-b1c1bf25.js").then(t=>t.A),["assets/AreaMeasurementAnalysisView3D-b1c1bf25.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/analysisThemeUtils-efa1a8b1.js","assets/unitUtils-45d1147c.js","assets/jsonMap-7b8332c9.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/geometry-b7901087.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/projection-290b739f.js","assets/preload-helper-3bce6601.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/SimpleObservable-23231131.js","assets/mat4-44a0988f.js","assets/assets-8d3e737a.js","assets/request-6fc81c4c.js","assets/aaBoundingRect-193543b5.js","assets/zscale-89472cba.js","assets/screenUtils-410d12c0.js","assets/vec2-528adfe4.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/LineVisualElement-bccf172d.js","assets/Promise-376ab9f6.js","assets/mat4f64-1e28eae0.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/Evented-a45c8b0f.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/reactiveUtils-4dabbb80.js","assets/basicInterfaces-19ed850e.js","assets/VisualVariablePassParameters-d460182b.js","assets/VertexAttribute-9c5c630d.js","assets/FramebufferObject-a3b9c52c.js","assets/ShaderBuilder-a7d0da4e.js","assets/mat3f64-c6305894.js","assets/aaBoundingBox-657a9b82.js","assets/ViewingMode-5d7d590b.js","assets/Util-a48361c6.js","assets/vec4f64-e407da96.js","assets/Segment-2acc0e69.js","assets/elevationInfoUtils-36e5dd0f.js","assets/ElevationInfo-215614d8.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/lengthUtils-fa751420.js","assets/widget-fb292a2f.js","assets/intl-65a3e389.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/messages-2289086c.js","assets/uuid-73213768.js","assets/sphere-2af0d852.js","assets/byteSizeEstimations-f0cab514.js","assets/quatf64-7fd38d64.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/asyncUtils-437defc4.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/compilerUtils-18d58939.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/lineSegment-10422ca0.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/ScreenSpacePass-d5e48a9b.js","assets/Float4PassUniform-d7bdbc81.js","assets/Texture2DPassUniform-753de459.js","assets/InterleavedLayout-984d67b2.js","assets/Matrix3PassUniform-ad9f953b.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/vec3f32-c9aa289f.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/symbolColorUtils-b2b55883.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/FloatPassUniform-68d54f51.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/geometryEngine-d1bfed92.js","assets/geometryEngineBase-3dd302e0.js","assets/hydrated-c3c67fc1.js","assets/earcut-58237617.js","assets/plane-b575face.js","assets/EditGeometryOperations-464d8964.js"]);case"dimension":return j(()=>import("./DimensionAnalysisView3D-252f755c.js").then(t=>t.D),["assets/DimensionAnalysisView3D-252f755c.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/reactiveUtils-4dabbb80.js","assets/LineVisualElement-bccf172d.js","assets/Promise-376ab9f6.js","assets/projection-290b739f.js","assets/preload-helper-3bce6601.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/unitUtils-45d1147c.js","assets/jsonMap-7b8332c9.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/mat4-44a0988f.js","assets/Polyline-ff2d7c6b.js","assets/assets-8d3e737a.js","assets/request-6fc81c4c.js","assets/aaBoundingRect-193543b5.js","assets/zscale-89472cba.js","assets/mat4f64-1e28eae0.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/basicInterfaces-19ed850e.js","assets/VisualVariablePassParameters-d460182b.js","assets/VertexAttribute-9c5c630d.js","assets/FramebufferObject-a3b9c52c.js","assets/ShaderBuilder-a7d0da4e.js","assets/mat3f64-c6305894.js","assets/aaBoundingBox-657a9b82.js","assets/ViewingMode-5d7d590b.js","assets/Util-a48361c6.js","assets/vec4f64-e407da96.js","assets/LengthDimension-6eb29622.js","assets/geometry-b7901087.js","assets/typeUtils-35750739.js","assets/Clonable-545593ce.js","assets/Cyclical-151bcc41.js","assets/Segment-2acc0e69.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/vec2-528adfe4.js","assets/elevationInfoUtils-36e5dd0f.js","assets/ElevationInfo-215614d8.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/lengthUtils-fa751420.js","assets/widget-fb292a2f.js","assets/intl-65a3e389.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/messages-2289086c.js","assets/uuid-73213768.js","assets/sphere-2af0d852.js","assets/byteSizeEstimations-f0cab514.js","assets/quatf64-7fd38d64.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/jsonUtils-229211af.js","assets/Field-61ec9870.js","assets/enumeration-3a03bd31.js","assets/fieldType-f31285f7.js","assets/plane-b575face.js","assets/analysisViewUtils-ae3c8eee.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/compilerUtils-18d58939.js","assets/lineSegment-10422ca0.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/asyncUtils-437defc4.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/ScreenSpacePass-d5e48a9b.js","assets/Float4PassUniform-d7bdbc81.js","assets/Texture2DPassUniform-753de459.js","assets/InterleavedLayout-984d67b2.js","assets/Matrix3PassUniform-ad9f953b.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/vec3f32-c9aa289f.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/symbolColorUtils-b2b55883.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/FloatPassUniform-68d54f51.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/ImageMaterial-85877c86.js","assets/ImageMaterial.glsl-befce2a1.js","assets/Factory-265a09f6.js","assets/MarkerSizing.glsl-566261cc.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/HandleOwner-9b396af1.js","assets/Octree-0a267ea2.js","assets/PointVisualElement-b23705fb.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/RightAngleQuadVisualElement-77ea66a2.js","assets/colorUtils-0c057879.js","assets/EditGeometryOperations-464d8964.js","assets/QueryEngineResult-8f90b8dc.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/WhereClause-d4b8b019.js","assets/utils-b34fcd9d.js","assets/generateRendererUtils-7252b5e6.js","assets/colorRamps-9dac42c1.js","assets/projectionSupport-aa5eaa0d.js","assets/json-48e3ea08.js","assets/SnappingCandidate-970faec6.js","assets/utils-511aa5f5.js","assets/normalizeUtils-27e29a72.js","assets/featureConversionUtils-03a03f40.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/dehydratedFeatureComparison-59868945.js","assets/Scheduler-540208b6.js","assets/RenderTexture-a15e38d0.js"]);case"direct-line-measurement":return j(()=>import("./DirectLineMeasurementAnalysisView3D-38228716.js").then(t=>t.D),["assets/DirectLineMeasurementAnalysisView3D-38228716.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/analysisThemeUtils-efa1a8b1.js","assets/unitUtils-45d1147c.js","assets/jsonMap-7b8332c9.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/geometry-b7901087.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/projection-290b739f.js","assets/preload-helper-3bce6601.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/SimpleObservable-23231131.js","assets/mat4-44a0988f.js","assets/assets-8d3e737a.js","assets/request-6fc81c4c.js","assets/aaBoundingRect-193543b5.js","assets/zscale-89472cba.js","assets/screenUtils-410d12c0.js","assets/vec2-528adfe4.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/LineVisualElement-bccf172d.js","assets/Promise-376ab9f6.js","assets/mat4f64-1e28eae0.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/Evented-a45c8b0f.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/reactiveUtils-4dabbb80.js","assets/basicInterfaces-19ed850e.js","assets/VisualVariablePassParameters-d460182b.js","assets/VertexAttribute-9c5c630d.js","assets/FramebufferObject-a3b9c52c.js","assets/ShaderBuilder-a7d0da4e.js","assets/mat3f64-c6305894.js","assets/aaBoundingBox-657a9b82.js","assets/ViewingMode-5d7d590b.js","assets/Util-a48361c6.js","assets/vec4f64-e407da96.js","assets/Segment-2acc0e69.js","assets/elevationInfoUtils-36e5dd0f.js","assets/ElevationInfo-215614d8.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/lengthUtils-fa751420.js","assets/widget-fb292a2f.js","assets/intl-65a3e389.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/messages-2289086c.js","assets/uuid-73213768.js","assets/sphere-2af0d852.js","assets/byteSizeEstimations-f0cab514.js","assets/quatf64-7fd38d64.js","assets/geometryEngine-d1bfed92.js","assets/geometryEngineBase-3dd302e0.js","assets/hydrated-c3c67fc1.js","assets/InterleavedLayout-984d67b2.js","assets/BufferView-903d1848.js","assets/types-e1c0a5bf.js","assets/Matrix3PassUniform-ad9f953b.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/asyncUtils-437defc4.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/compilerUtils-18d58939.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/lineSegment-10422ca0.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/ScreenSpacePass-d5e48a9b.js","assets/Float4PassUniform-d7bdbc81.js","assets/Texture2DPassUniform-753de459.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/vec3f32-c9aa289f.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/symbolColorUtils-b2b55883.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/FloatPassUniform-68d54f51.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/RightAngleQuadVisualElement-77ea66a2.js"]);case"line-of-sight":return j(()=>import("./LineOfSightAnalysisView3D-9227c144.js"),["assets/LineOfSightAnalysisView3D-9227c144.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/vec3f64-2f9cef06.js","assets/LineVisualElement-bccf172d.js","assets/Promise-376ab9f6.js","assets/projection-290b739f.js","assets/preload-helper-3bce6601.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/unitUtils-45d1147c.js","assets/jsonMap-7b8332c9.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/mat4-44a0988f.js","assets/Polyline-ff2d7c6b.js","assets/assets-8d3e737a.js","assets/request-6fc81c4c.js","assets/aaBoundingRect-193543b5.js","assets/zscale-89472cba.js","assets/mat4f64-1e28eae0.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/reactiveUtils-4dabbb80.js","assets/basicInterfaces-19ed850e.js","assets/VisualVariablePassParameters-d460182b.js","assets/VertexAttribute-9c5c630d.js","assets/FramebufferObject-a3b9c52c.js","assets/ShaderBuilder-a7d0da4e.js","assets/mat3f64-c6305894.js","assets/aaBoundingBox-657a9b82.js","assets/ViewingMode-5d7d590b.js","assets/Util-a48361c6.js","assets/vec4f64-e407da96.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/geometry-b7901087.js","assets/typeUtils-35750739.js","assets/LineOfSightAnalysisTarget-d9c2124d.js","assets/Clonable-545593ce.js","assets/persistable-ad5d84e1.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/uuid-73213768.js","assets/persistableUrlUtils-5f719c3b.js","assets/ElevationInfo-215614d8.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/lengthUtils-fa751420.js","assets/asyncUtils-437defc4.js","assets/HandleOwner-9b396af1.js","assets/sphere-2af0d852.js","assets/byteSizeEstimations-f0cab514.js","assets/quatf64-7fd38d64.js","assets/elevationInfoUtils-36e5dd0f.js","assets/screenUtils-410d12c0.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/jsonUtils-229211af.js","assets/Field-61ec9870.js","assets/enumeration-3a03bd31.js","assets/fieldType-f31285f7.js","assets/Scheduler-540208b6.js","assets/lineSegment-10422ca0.js","assets/analysisViewUtils-ae3c8eee.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/compilerUtils-18d58939.js","assets/vec2-528adfe4.js","assets/plane-b575face.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/ScreenSpacePass-d5e48a9b.js","assets/Float4PassUniform-d7bdbc81.js","assets/Texture2DPassUniform-753de459.js","assets/InterleavedLayout-984d67b2.js","assets/Matrix3PassUniform-ad9f953b.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/vec3f32-c9aa289f.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/symbolColorUtils-b2b55883.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/FloatPassUniform-68d54f51.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/ImageMaterial-85877c86.js","assets/ImageMaterial.glsl-befce2a1.js","assets/PointVisualElement-b23705fb.js","assets/Octree-0a267ea2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/NormalUtils.glsl-c12729bf.js","assets/HUD.glsl-d3a072ad.js","assets/projection-a69d43d0.js","assets/HUDMaterial.glsl-32cf019c.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/portalItemUtils-2ccd793f.js"]);case"slice":return j(()=>import("./SliceAnalysisView3D-6a439170.js").then(t=>t.S),["assets/SliceAnalysisView3D-6a439170.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/LineVisualElement-bccf172d.js","assets/Promise-376ab9f6.js","assets/projection-290b739f.js","assets/preload-helper-3bce6601.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/unitUtils-45d1147c.js","assets/jsonMap-7b8332c9.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/SimpleObservable-23231131.js","assets/mat4-44a0988f.js","assets/Polyline-ff2d7c6b.js","assets/assets-8d3e737a.js","assets/request-6fc81c4c.js","assets/aaBoundingRect-193543b5.js","assets/zscale-89472cba.js","assets/mat4f64-1e28eae0.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/mat3-3fc68e72.js","assets/Evented-a45c8b0f.js","assets/TileKey-5aef17b6.js","assets/vec2f64-30dc1443.js","assets/context-util-a4ce3a7b.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/VertexElementDescriptor-2925c6af.js","assets/reactiveUtils-4dabbb80.js","assets/basicInterfaces-19ed850e.js","assets/VisualVariablePassParameters-d460182b.js","assets/VertexAttribute-9c5c630d.js","assets/FramebufferObject-a3b9c52c.js","assets/ShaderBuilder-a7d0da4e.js","assets/mat3f64-c6305894.js","assets/aaBoundingBox-657a9b82.js","assets/ViewingMode-5d7d590b.js","assets/Util-a48361c6.js","assets/vec4f64-e407da96.js","assets/geometry-b7901087.js","assets/typeUtils-35750739.js","assets/Clonable-545593ce.js","assets/Cyclical-151bcc41.js","assets/persistable-ad5d84e1.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/uuid-73213768.js","assets/persistableUrlUtils-5f719c3b.js","assets/Layer-5ffe0eda.js","assets/Identifiable-bfe1ff30.js","assets/Loadable-268c900a.js","assets/BuildingComponentSublayer-cd73d2b0.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/Collection-910b6f71.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/MemCache-18a255ed.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/TimeExtent-23e282b9.js","assets/ElevationInfo-215614d8.js","assets/RelationshipQuery-0dda77ad.js","assets/Query-b96bcde0.js","assets/HandleOwner-9b396af1.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/editsZScale-6a661299.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/asyncUtils-437defc4.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/TopFeaturesQuery-cad97c37.js","assets/popupUtils-86dc6b94.js","assets/capabilities-a18453f6.js","assets/I3SIndexInfo-7af1a739.js","assets/I3SLayerDefinitions-ec48d9ab.js","assets/I3SUtil-f31a4571.js","assets/quat-3d5eec2d.js","assets/quatf64-7fd38d64.js","assets/I3SBinaryReader-f4829435.js","assets/symbolColorUtils-b2b55883.js","assets/vec3f32-c9aa289f.js","assets/plane-b575face.js","assets/sphere-2af0d852.js","assets/byteSizeEstimations-f0cab514.js","assets/popupUtils-af06d391.js","assets/analysisViewUtils-ae3c8eee.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/vec2-528adfe4.js","assets/lineSegment-10422ca0.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/ScreenSpacePass-d5e48a9b.js","assets/Float4PassUniform-d7bdbc81.js","assets/Texture2DPassUniform-753de459.js","assets/InterleavedLayout-984d67b2.js","assets/Matrix3PassUniform-ad9f953b.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/View.glsl-3ce196d4.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/FloatPassUniform-68d54f51.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/ImageMaterial-85877c86.js","assets/ImageMaterial.glsl-befce2a1.js","assets/Factory-265a09f6.js"])}}};function I6(){const i=Vx();return i.promise.catch(()=>{}),i}h([p()],Df.prototype,"updating",null),h([p({constructOnly:!0})],Df.prototype,"view",void 0),h([p()],Df.prototype,"_allAnalysisViews",void 0),h([p()],Df.prototype,"_creatingViewCount",void 0),Df=h([F("esri.views.3d.analysis.AnalysisViewManager3D")],Df);const w0e=Df;let Vu=class extends pe{constructor(e){super(e),this.collision=new rb,this.distance=1/0,this.minimumPoiDistance=4,this.tilt=null}get altitude(){return this.mode===Ie.Local?null:this._get("altitude")||null}set altitude(e){this.mode!==Ie.Local?this._set("altitude",e):ee.getLogger(this.declaredClass).warn("Altitude constraint is ignored in local scenes")}clampAltitude(e){return this.altitude?ue(e,this.altitude.min,this.altitude.max):e}clampTilt(e,t){if(!this.tilt)return t;const r=this.tilt(e);return ue(t,r.min,r.max)}clampDistance(e){return Math.min(e,this.distance)}createDefaultTilt(){return this.mode===Ie.Local?this._createDefaultTiltLocal():this._createDefaultTiltGlobal()}createConstantMaxTilt(e){return(t,r=TO)=>(r.min=Jn.min,r.max=e,r)}_createDefaultTiltLocal(){const e=this.collision.enabled?sE([[4e3,Jn.max],[1e4,At(88)],[6e6,At(88)]]):()=>Jn.max;return(t,r=TO)=>(r.min=Jn.min,r.max=e(t),r)}_createDefaultTiltGlobal(){const e=this.collision.enabled?sE([[4e3,Jn.max],[5e4,At(88)],[6e6,At(88)],[2e7,Jn.min]]):sE([[3e5,Jn.max],[3e6,At(88)],[6e6,At(88)],[2e7,Jn.min]]);return(t,r=TO)=>(r.min=Jn.min,r.max=e(t),r)}};function x0e(i){return{min:-2e5,max:4*i.radius}}h([p()],Vu.prototype,"altitude",null),h([p({readOnly:!0})],Vu.prototype,"collision",void 0),h([p()],Vu.prototype,"distance",void 0),h([p({readOnly:!0})],Vu.prototype,"minimumPoiDistance",void 0),h([p()],Vu.prototype,"tilt",void 0),h([p({constructOnly:!0})],Vu.prototype,"mode",void 0),Vu=h([F("esri.views.3d.state.Constraints")],Vu);const L6=x0e(lo),Jn={min:At(.5),max:At(179.5)},TO={min:0,max:0};let rb=class extends pe{constructor(){super(...arguments),this.enabled=!0,this.elevationMargin=5}};h([p({type:Boolean})],rb.prototype,"enabled",void 0),h([p({type:Number})],rb.prototype,"elevationMargin",void 0),rb=h([F("esri.views.3d.state.Constraints.CollisionConstraint")],rb);let m0=class extends pe{constructor(){super(...arguments),this.min=L6.min,this.max=L6.max}};h([p({type:Number})],m0.prototype,"min",void 0),h([p({type:Number})],m0.prototype,"max",void 0),m0=h([F("esri.views.3d.constraints.AltitudeConstraint")],m0);let Xu=class extends pe{constructor(){super(...arguments),this.mode="auto"}get near(){return this._get("near")}set near(e){this._set("near",e),e>=this._get("far")&&(this.far=e+1e-9),this.mode="manual"}castNear(e){return Math.max(1e-8,e)}get far(){return this._get("far")}set far(e){this._set("far",e),e<=this._get("near")&&(this.near=e-1e-9),this.mode="manual"}castFar(e){return Math.max(1e-8,e)}autoUpdate(e,t){this.mode==="auto"&&(this._get("near")!==e&&this._set("near",e),this._get("far")!==t&&this._set("far",t))}};h([p({type:Number,value:1e-8})],Xu.prototype,"near",null),h([qr("near")],Xu.prototype,"castNear",null),h([p({type:Number,value:1e-8})],Xu.prototype,"far",null),h([qr("far")],Xu.prototype,"castFar",null),h([p({type:["auto","manual"]})],Xu.prototype,"mode",void 0),Xu=h([F("esri.views.3d.constraints.ClipDistanceConstraint")],Xu);const b3={min:_o(Jn.min),max:_o(Jn.max)};let Jf=class extends pe{constructor(){super(...arguments),this.mode="auto"}get max(){return this._get("max")}set max(e){this._set("max",e),this.mode="manual"}castMax(e){return ue(e,b3.min,b3.max)}autoUpdate(e){this.mode==="auto"&&this._get("max")!==e&&this._set("max",e)}};h([p({type:["auto","manual"]})],Jf.prototype,"mode",void 0),h([p({type:Number,value:b3.max})],Jf.prototype,"max",null),h([qr("max")],Jf.prototype,"castMax",null),Jf=h([F("esri.views.3d.constraints.TiltConstraint")],Jf);let eg=class extends pe{constructor(){super(...arguments),this.tilt=new Jf,this.altitude=new m0,this.clipDistance=new Xu}};h([p({type:Jf})],eg.prototype,"tilt",void 0),h([p({type:m0})],eg.prototype,"altitude",void 0),h([p({type:Xu})],eg.prototype,"clipDistance",void 0),eg=h([F("esri.views.3d.constraints.Constraints")],eg);var w3;let fl=w3=class extends xt{constructor(i){super(i),this.type="sun",this.date=null,this.directShadowsEnabled=!1,this.displayUTCOffset=null}readDate(i,e){return e.datetime!=null&&new Date(e.datetime)||null}writeDate(i,e,t){e[t]=i.getTime()}readDirectShadowsEnabled(i,e){return!!e.directShadows}writedirectShadowsEnabled(i,e,t){i&&(e[t]=i)}writeDisplayUTCOffset(i,e){i!=null&&(e.displayUTCOffset=i)}clone(){return new w3(this.cloneConstructProperties())}cloneConstructProperties(){const i={directShadowsEnabled:this.directShadowsEnabled,displayUTCOffset:this.displayUTCOffset!=null?this.displayUTCOffset:null};return this.date!=null&&(i.date=new Date(this.date.getTime())),i}};h([p({readOnly:!0,type:["sun"],json:{write:!0}})],fl.prototype,"type",void 0),h([p({type:Date,json:{type:Number,write:{target:"datetime"}}})],fl.prototype,"date",void 0),h([Dl("date",["datetime"])],fl.prototype,"readDate",null),h([Cs("date")],fl.prototype,"writeDate",null),h([p({type:Boolean,json:{default:!1,write:{target:"directShadows"}}})],fl.prototype,"directShadowsEnabled",void 0),h([Dl("directShadowsEnabled",["directShadows"])],fl.prototype,"readDirectShadowsEnabled",null),h([Cs("directShadowsEnabled")],fl.prototype,"writedirectShadowsEnabled",null),h([p({type:Number,json:{write:!0}})],fl.prototype,"displayUTCOffset",void 0),h([Cs("displayUTCOffset")],fl.prototype,"writeDisplayUTCOffset",null),fl=w3=h([F("esri.webscene.SunLighting")],fl);const cx=fl;var Ey;let bh=Ey=class extends nn.EventedMixin(cx){constructor(i){super(i),this.cameraTrackingEnabled=!0,this.ambientOcclusionEnabled=!1,this.waterReflectionEnabled=!1,this.positionTimezoneInfo={hours:0,minutes:0,seconds:0,autoUpdated:!0};const e=new Date().getFullYear(),t=new Date("March 15, "+e+" 12:00:00 UTC");this._set("defaultDate",t),this._set("date",t)}get defaultDate(){return new Date(this._get("defaultDate").getTime())}static fromWebsceneLighting(i){return new Ey(i.cloneConstructProperties())}set defaultDate(i){const e=this._get("date")===this._get("defaultDate");i=new Date(i.getTime()),this._set("defaultDate",i),e&&this._set("date",i)}set date(i){i!=null&&(this.positionTimezoneInfo.autoUpdated=!1,this._set("date",new Date(i.getTime())))}autoUpdate(i,e){const t=Ey.calculateTimezoneOffset(this.positionTimezoneInfo);this.positionTimezoneInfo.hours=e.hours,this.positionTimezoneInfo.minutes=e.minutes,this.positionTimezoneInfo.seconds=e.seconds;let r=null;y(i)&&(this.positionTimezoneInfo.autoUpdated=!0,isNaN(i.getTime())?(r=this.defaultDate.getTime(),this._set("date",this.defaultDate)):(r=this.date&&this.date.getTime(),this._set("date",new Date(i.getTime()))));const n=Ey.calculateTimezoneOffset(this.positionTimezoneInfo);if(t!==n&&(CO.target=this,CO.timezoneOffset=n,this.emit("timezone-will-change",CO)),y(i))return!!isNaN(i.getTime())||r!==i.getTime()}clone(){const i=this._get("date")===this._get("defaultDate"),e=new Ey({...this.cloneConstructProperties(),defaultDate:this.defaultDate,cameraTrackingEnabled:this.cameraTrackingEnabled,ambientOcclusionEnabled:this.ambientOcclusionEnabled,waterReflectionEnabled:this.waterReflectionEnabled});return i&&e._set("date",e._get("defaultDate")),e.positionTimezoneInfo.autoUpdated=this.positionTimezoneInfo.autoUpdated,e.positionTimezoneInfo.hours=this.positionTimezoneInfo.hours,e.positionTimezoneInfo.minutes=this.positionTimezoneInfo.minutes,e.positionTimezoneInfo.seconds=this.positionTimezoneInfo.seconds,e}cloneWithWebsceneLighting(i){const e=this.clone();return i.date!=null&&(e.date=i.date),e.directShadowsEnabled=i.directShadowsEnabled,e.displayUTCOffset=i.displayUTCOffset,e}cloneNonPersistentConstructProperties(){return{ambientOcclusionEnabled:this.ambientOcclusionEnabled,waterReflectionEnabled:this.waterReflectionEnabled,cameraTrackingEnabled:this.cameraTrackingEnabled}}};h([p({type:Boolean})],bh.prototype,"cameraTrackingEnabled",void 0),h([p({type:Boolean})],bh.prototype,"ambientOcclusionEnabled",void 0),h([p({type:Boolean})],bh.prototype,"waterReflectionEnabled",void 0),h([p({type:Date})],bh.prototype,"defaultDate",null),h([p({type:Date})],bh.prototype,"date",null),bh=Ey=h([F("esri.views.3d.environment.SunLighting")],bh),function(i){function e({hours:t,minutes:r,seconds:n}){return Math.round(t+r/60+n/3600)}i.calculateTimezoneOffset=e}(bh||(bh={}));const CO={target:null,timezoneOffset:0},Mp=bh;var x3;let nb=x3=class extends xt{constructor(i){super(i),this.type="virtual",this.directShadowsEnabled=!1}clone(){return new x3(this.cloneConstructProperties())}cloneConstructProperties(){return{directShadowsEnabled:this.directShadowsEnabled}}};h([p({readOnly:!0,type:["virtual"],json:{write:!0}})],nb.prototype,"type",void 0),h([p({type:Boolean,json:{default:!1,name:"directShadows",write:!0}})],nb.prototype,"directShadowsEnabled",void 0),nb=x3=h([F("esri.webscene.VirtualLighting")],nb);const PP=nb;var oE;let Ry=oE=class extends nn.EventedMixin(PP){constructor(i){super(i),this.ambientOcclusionEnabled=!1,this.waterReflectionEnabled=!1,this.cameraTrackingEnabled=!0}clone(){return new oE({...this.cloneConstructProperties(),ambientOcclusionEnabled:this.ambientOcclusionEnabled,waterReflectionEnabled:this.waterReflectionEnabled,cameraTrackingEnabled:this.cameraTrackingEnabled})}static fromWebsceneLighting(i){return new oE(i.cloneConstructProperties())}cloneWithWebsceneLighting(i){const e=this.clone();return e.directShadowsEnabled=i.directShadowsEnabled,e}cloneNonPersistentConstructProperties(){return{ambientOcclusionEnabled:this.ambientOcclusionEnabled,waterReflectionEnabled:this.waterReflectionEnabled,cameraTrackingEnabled:this.cameraTrackingEnabled}}};h([p({type:Boolean})],Ry.prototype,"ambientOcclusionEnabled",void 0),h([p({type:Boolean})],Ry.prototype,"waterReflectionEnabled",void 0),h([p({type:Boolean})],Ry.prototype,"cameraTrackingEnabled",void 0),Ry=oE=h([F("esri.views.3d.environment.VirtualLighting")],Ry);const sb=Ry,T0e={key:"type",defaultKeyValue:"sun",base:null,typeMap:{sun:Mp,virtual:sb}};var T3;let Zb=T3=class extends pe{set quality(i){["low","high"].includes(i)&&this._set("quality",i)}clone(){return new T3({quality:this.quality})}};h([p({type:["low","high"],value:"low"})],Zb.prototype,"quality",null),Zb=T3=h([F("esri.views.3d.environment.SceneViewAtmosphere")],Zb);var C3;let ab=C3=class extends xt{constructor(i){super(i),this.type="sunny",this.cloudCover=.5}clone(){return new C3({cloudCover:this.cloudCover})}};h([Pa({sunny:"sunny"})],ab.prototype,"type",void 0),h([p({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],ab.prototype,"cloudCover",void 0),ab=C3=h([F("esri.views.3d.environment.SunnyWeather")],ab);const S3=ab;var E3;let ob=E3=class extends xt{constructor(i){super(i),this.type="cloudy",this.cloudCover=.5}clone(){return new E3({cloudCover:this.cloudCover})}};h([Pa({cloudy:"cloudy"})],ob.prototype,"type",void 0),h([p({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],ob.prototype,"cloudCover",void 0),ob=E3=h([F("esri.views.3d.environment.CloudyWeather")],ob);const C0e=ob;var R3;let lb=R3=class extends xt{constructor(i){super(i),this.type="foggy",this.fogStrength=.5}clone(){return new R3({fogStrength:this.fogStrength})}};h([Pa({foggy:"foggy"})],lb.prototype,"type",void 0),h([p({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],lb.prototype,"fogStrength",void 0),lb=R3=h([F("esri.views.3d.environment.FoggyWeather")],lb);const S0e=lb;var P3;let Py=P3=class extends xt{constructor(i){super(i),this.type="rainy",this.cloudCover=.5,this.precipitation=.5}clone(){return new P3({cloudCover:this.cloudCover,precipitation:this.precipitation})}};h([Pa({rainy:"rainy"})],Py.prototype,"type",void 0),h([p({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],Py.prototype,"cloudCover",void 0),h([p({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],Py.prototype,"precipitation",void 0),Py=P3=h([F("esri.views.3d.environment.RainyWeather")],Py);const E0e=Py;var A3;let Ff=A3=class extends xt{constructor(i){super(i),this.type="snowy",this.cloudCover=.5,this.precipitation=.5,this.snowCover="disabled"}clone(){return new A3({cloudCover:this.cloudCover,precipitation:this.precipitation,snowCover:this.snowCover})}};h([Pa({snowy:"snowy"})],Ff.prototype,"type",void 0),h([p({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],Ff.prototype,"cloudCover",void 0),h([p({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],Ff.prototype,"precipitation",void 0),h([p({type:["enabled","disabled"],nonNullable:!0,json:{write:!0}})],Ff.prototype,"snowCover",void 0),Ff=A3=h([F("esri.views.3d.environment.SnowyWeather")],Ff);const R0e=Ff,WQ={key:"type",base:S3,typeMap:{sunny:S3,cloudy:C0e,rainy:E0e,snowy:R0e,foggy:S0e}},P0e=Object.keys(WQ.typeMap);function A0e(i,e){return!!P0e.includes(i)||(e.error(`"${i}" is not a valid weather type`),!1)}const Cl=1e4,O0e={key:"type",defaultKeyValue:"sun",base:null,typeMap:{sun:cx,virtual:PP}};let lE=class extends xt{constructor(e){super(e)}clone(){}};h([p({readOnly:!0,json:{read:!1}})],lE.prototype,"type",void 0),lE=h([F("esri.webscene.background.Background")],lE);const XQ=lE;var O3;const M0e={...Aie,nonNullable:!0};let cb=O3=class extends XQ{constructor(i){super(i),this.type="color",this.color=new ti([0,0,0,1])}clone(){return new O3(this.cloneProperties())}cloneProperties(){return{color:this.color.clone()}}};h([Pa({color:"color"},{readOnly:!0})],cb.prototype,"type",void 0),h([p(M0e)],cb.prototype,"color",void 0),cb=O3=h([F("esri.webscene.background.ColorBackground")],cb);const QQ=cb,$6={base:XQ,key:"type",typeMap:{color:QQ}};function I0e(i){return(e,t,r)=>{if(!e)return e;for(const n in i.typeMap)if(e.type===n){const s=new i.typeMap[n];return s.read(e,r),s}}}const L0e={types:$6,json:{read:I0e($6),write:{overridePolicy:(i,e,t)=>({enabled:!t||!t.isPresentation})}}};var M3;const ZQ="esri.webscene.Environment",$0e=ee.getLogger(ZQ),D6=(i,e,t)=>({enabled:!t||!t.isPresentation});let Ip=M3=class extends xt{constructor(i){super(i),this.lighting=new cx,this.background=null,this.atmosphereEnabled=!0,this.starsEnabled=!0}set weather(i){A0e(i==null?void 0:i.type,$0e)&&this._set("weather",i)}clone(){return new M3(this.cloneConstructProperties())}cloneConstructProperties(){return{lighting:this.lighting&&this.lighting.type==="virtual"?PP.prototype.clone.call(this.lighting):cx.prototype.clone.call(this.lighting),background:Pr(this.background),atmosphereEnabled:this.atmosphereEnabled,starsEnabled:this.starsEnabled,weather:this.weather.clone()}}};h([p({types:O0e,nonNullable:!0,json:{write:!0}})],Ip.prototype,"lighting",void 0),h([p(L0e)],Ip.prototype,"background",void 0),h([p({type:Boolean,nonNullable:!0,json:{write:{overridePolicy:D6}}})],Ip.prototype,"atmosphereEnabled",void 0),h([p({type:Boolean,nonNullable:!0,json:{write:{overridePolicy:D6}}})],Ip.prototype,"starsEnabled",void 0),h([p({types:WQ,nonNullable:!0,json:{write:!0},value:new S3})],Ip.prototype,"weather",null),Ip=M3=h([F(ZQ)],Ip);const YQ=Ip;var hb;let Ay=hb=class extends YQ{constructor(i){super(i),this.atmosphere=new Zb,this.lighting=new Mp,this.cachedCameraTrackingEnabled=null}static fromWebsceneEnvironment(i){const e=i.cloneConstructProperties();return new hb({...e,lighting:e.lighting.type==="virtual"?sb.fromWebsceneLighting(e.lighting):Mp.fromWebsceneLighting(e.lighting)})}castLighting(i){return this._convertLighting(i)}applyLighting(i){this.lighting=this._convertLighting(i)}_convertLighting(i){var e,t;return i?i instanceof Mp||i instanceof sb?i:i instanceof cx?this.lighting&&this.lighting.type!=="virtual"?this.lighting.cloneWithWebsceneLighting(i):new Mp({...i.cloneConstructProperties(),...(e=this.lighting)==null?void 0:e.cloneNonPersistentConstructProperties()}):i instanceof PP?this.lighting&&this.lighting.type==="virtual"?this.lighting.cloneWithWebsceneLighting(i):new sb({...i.cloneConstructProperties(),...(t=this.lighting)==null?void 0:t.cloneNonPersistentConstructProperties()}):Nte(T0e,i):new Mp}clone(){return new hb({lighting:this.lighting.clone(),atmosphere:this.atmosphere.clone(),weather:this.weather.clone(),atmosphereEnabled:this.atmosphereEnabled,starsEnabled:this.starsEnabled,background:Pr(this.background)})}cloneWithWebsceneEnvironment(i){return new hb({atmosphere:this.atmosphere.clone(),weather:this.weather.clone(),atmosphereEnabled:this.atmosphereEnabled,starsEnabled:this.starsEnabled,background:Pr(this.background),...i.cloneConstructProperties(),lighting:this._getLighting(i)})}_getLighting(i){switch(i.lighting.type){case"sun":return this.lighting&&this.lighting.type==="sun"?this.lighting.cloneWithWebsceneLighting(i.lighting):Mp.fromWebsceneLighting(i.lighting);case"virtual":return this.lighting&&this.lighting.type==="virtual"?this.lighting.cloneWithWebsceneLighting(i.lighting):sb.fromWebsceneLighting(i.lighting);default:return Ra(i.lighting),Mp.fromWebsceneLighting(i.lighting)}}};h([p({type:Zb,json:{read:!1},nonNullable:!0})],Ay.prototype,"atmosphere",void 0),h([p({nonNullable:!0})],Ay.prototype,"lighting",void 0),h([qr("lighting")],Ay.prototype,"castLighting",null),Ay=hb=h([F("esri.views.3d.environment.SceneViewEnvironment")],Ay);const Oy=Ay;var In;(function(i){i[i.Simple=0]="Simple",i[i.Realistic=1]="Realistic",i[i.Panoramic=2]="Panoramic",i[i.None=3]="None"})(In||(In={}));function KQ(i){return Math.min(1,Math.max(0,(i-1e5)/(1e6-1e5)))}const I3=1e4,D0e=.085,hx=1e5,Yb=Ze(parseFloat(Number(5802e-9).toFixed(6)),parseFloat(Number(13558e-9).toFixed(6)),parseFloat(Number(331e-7).toFixed(6))),SO=3,EO=Ze(SO*parseFloat(Number(65e-8).toFixed(6)),SO*parseFloat(Number(1881e-9).toFixed(6)),SO*parseFloat(Number(85e-9).toFixed(6))),F0e=3996e-9,N0e=Ze(parseFloat(Number(Yb[0]+EO[0]).toFixed(6)),parseFloat(Number(Yb[1]+EO[1]).toFixed(6)),parseFloat(Number(Yb[2]+EO[2]).toFixed(6)));function k0e(i){const e=new Yi;e.attributes.add(S.POSITION,"vec2"),e.include(kR,{textureCoordinateType:Im.Default}),e.varyings.add("worldRay","vec3"),e.varyings.add("eyeDir","vec3");const{vertex:t,fragment:r}=e;return t.uniforms.add([new Ys("inverseProjectionMatrix",(n,s)=>s.camera.inverseProjectionMatrix),new Ys("inverseViewMatrix",(n,s)=>kn(V0e,s.camera.viewMatrix))]),t.code.add(A`void main(void) {
vec3 posViewNear = (inverseProjectionMatrix * vec4(position, -1, 1)).xyz;
eyeDir = posViewNear;
worldRay = (inverseViewMatrix * vec4(posViewNear, 0)).xyz;
forwardTextureCoordinates();
gl_Position = vec4(position, 1, 1);
}`),r.uniforms.add([new Zs("radii",n=>n.radii),new Ps("cameraPosition",(n,s)=>s.camera.eye),new Xh("heightParameters",n=>n.heightParameters),new Pt("innerFadeDistance",n=>n.innerFadeDistance),new Pt("altitudeFade",n=>n.altitudeFade),new Ht("depthTex",n=>n.depthTex),new Pt("hazeStrength",n=>n.hazeStrength)]),r.constants.add("betaRayleigh","vec3",Yb),r.constants.add("betaCombined","vec3",N0e),r.constants.add("betaMie","float",F0e),r.constants.add("scaleHeight","float",D0e*hx),VR(r),e.include(ND),i.haze&&(r.include(Ig),r.uniforms.add(new Zs("nearFar",(n,s)=>s.camera.nearFar))),r.code.add(A`vec2 sphereIntersect(vec3 start, vec3 dir, float radius, bool planet) {
float a = dot(dir, dir);
float b = 2.0 * dot(dir, start);
float c = planet ? heightParameters[1] - radius * radius : heightParameters[2];
float d = (b * b) - 4.0 * a * c;
if (d < 0.0) {
return vec2(1e5, -1e5);
}
return vec2((-b - sqrt(d)) / (2.0 * a), (-b + sqrt(d)) / (2.0 * a));
}`),r.code.add(A`float chapmanApproximation(float X, float h, float cosZenith) {
float c = sqrt(X + h);
float cExpH = c * exp(-h);
if (cosZenith >= 0.0) {
return cExpH / (c * cosZenith + 1.0);
} else {
float x0 = sqrt(1.0 - cosZenith * cosZenith) * (X + h);
float c0 = sqrt(x0);
return 2.0 * c0 * exp(X - x0) - cExpH / (1.0 - c * cosZenith);
}
}`),r.code.add(A`float getOpticalDepth(vec3 position, vec3 dir, float h) {
return scaleHeight * chapmanApproximation(radii[0] / scaleHeight, h, dot(normalize(position), dir));
}`),r.code.add(A`
    const int STEPS = 6;

    float getGlow(float dist, float radius, float intensity) {
      return pow(radius / max(dist, 1e-6), intensity);
    }

    vec3 getAtmosphereColour(vec3 cameraPos, vec3 rayDir, vec3 lightDir, float terrainDepth) {
      float reducedPlanetRadius = radii[0] - 20000.0;
      vec2 rayPlanetIntersect = sphereIntersect(cameraPos, rayDir, reducedPlanetRadius, true);
      vec2 rayAtmosphereIntersect = sphereIntersect(cameraPos, rayDir, radii[1], false);
      bool hitsAtmosphere = (rayAtmosphereIntersect.x <= rayAtmosphereIntersect.y) && rayAtmosphereIntersect.x > 0.0;
      bool insideAtmosphere = heightParameters[0] < radii[1];

      if (!(hitsAtmosphere || insideAtmosphere)) {
        return vec3(0);
      }

      bool hitsPlanet = (rayPlanetIntersect.x <= rayPlanetIntersect.y) && rayPlanetIntersect.x > 0.0;

      float start = insideAtmosphere ? 0.0 : rayAtmosphereIntersect.x;

      if (heightParameters[0] < reducedPlanetRadius) {
        // Long light rays from the night side of the planet lead to numerical instability
        // Do not render the atmosphere in such cases
        if (dot(rayDir, normalize(cameraPos)) < -0.025) {
          return vec3(0);
        }
        start = rayPlanetIntersect.y;
      }

      float end = hitsPlanet ? rayPlanetIntersect.x : rayAtmosphereIntersect.y;
      float maxEnd = end;

      ${i.haze?A`if (terrainDepth != -1.0) { end = terrainDepth; }`:""}

      vec3 samplePoint = cameraPos + rayDir * end;
      float multiplier = hitsPlanet ? -1.0 : 1.0;

      vec3 scattering = vec3(0);
      float scaleFract = (length(samplePoint) - radii[0]) / scaleHeight;
      float lastOpticalDepth = getOpticalDepth(samplePoint, rayDir, scaleFract);
      float stepSize = (end - start) / float(STEPS);
      for (int i = 0; i < STEPS; i++) {
        samplePoint -= stepSize * rayDir;
        scaleFract = (length(samplePoint) - radii[0]) / scaleHeight;
        float opticalDepth = multiplier * getOpticalDepth(samplePoint, rayDir * multiplier, scaleFract);

        if (i > 0) {
          scattering *= ${i.haze?A``:" mix(2.5, 1.0, clamp((length(cameraPos) - radii[0]) / 50e3, 0.0, 1.0)) * "} exp(-(mix(betaCombined, betaRayleigh, 0.5) + betaMie) * max(0.0, (opticalDepth - lastOpticalDepth)));
        }

        if (dot(normalize(samplePoint), lightDir) > -0.3) {

          float scale = exp(-scaleFract);
          float lightDepth = getOpticalDepth(samplePoint, lightDir, scaleFract);

          scattering += scale * exp(-(betaCombined + betaMie) * lightDepth);
          ${i.haze?"":A`scattering += scale * exp(-(0.25 * betaCombined ) * lightDepth);`}
        }

        lastOpticalDepth = opticalDepth;

      }

      float mu = dot(rayDir, lightDir);
      float mumu = 1.0 + mu * mu;

      float phaseRayleigh = 0.0596831 * mumu;

      ${i.haze?A`return 3.0 * scattering * stepSize * phaseRayleigh * betaRayleigh;`:A`
            const float g = 0.8;
            const float gg = g * g;
            float phaseMie = end == maxEnd ? 0.1193662 * ((1.0 - gg) * mumu) / (pow(1.0 + gg - 2.0 * mu * g, 1.5) * (2.0 + gg)) : 0.0;
            phaseMie += getGlow(1.0 - mu, 5e-5, 3.0) * smoothstep(0.01, 0.1, length(scattering));
            phaseMie = clamp(phaseMie, 0.0, 128.0);
            return 3.0 * scattering * stepSize * (phaseRayleigh * betaRayleigh + 0.025 * phaseMie * betaMie);`}
    }

    vec3 tonemapACES(vec3 x) {
      return clamp((x * (2.51 * x + 0.03)) / (x * (2.43 * x + 0.59) + 0.14), 0.0, 1.0);
    }

    vec4 applyUndergroundAtmosphere(vec3 rayDir, vec3 lightDirection, vec4 fragColor) {
      vec2 rayPlanetIntersect = sphereIntersect(cameraPosition, rayDir, radii[0], true);
      if (!((rayPlanetIntersect.x <= rayPlanetIntersect.y) && rayPlanetIntersect.y > 0.0)) {
        return fragColor;
      }

      float lightAngle = dot(lightDirection, normalize(cameraPosition + rayDir * max(0.0, rayPlanetIntersect.x)));
      vec4 surfaceColor = vec4(vec3(max(0.0, (smoothstep(-1.0, 0.8, 2.0 * lightAngle)))), 1.0 - altitudeFade);
      float relDist = (rayPlanetIntersect.y - max(0.0, rayPlanetIntersect.x)) / innerFadeDistance;
      if (relDist > 1.0) {
        return surfaceColor;
      }

      return mix(gl_FragColor, surfaceColor, smoothstep(0.0, 1.0, relDist * relDist));
    }

    void main() {
      vec3 rayDir = normalize(worldRay);
      float terrainDepth = -1.0;
      ${i.haze?A`
          vec4 depthSample = texture2D(depthTex, vuv0).rgba;
          if (depthSample != vec4(0)) {
            vec3 cameraSpaceRay = normalize(eyeDir);
            cameraSpaceRay /= cameraSpaceRay.z;
            cameraSpaceRay *= -linearDepthFromTexture(depthTex, vuv0, nearFar);
            terrainDepth = max(0.0, length(cameraSpaceRay));
          }`:A`
          float depthSample = texture2D(depthTex, vuv0).r;
          if (depthSample != 1.0) {
            gl_FragColor = vec4(0);
            return;
          }`}

      ${i.haze?A`
            vec3 col = vec3(0);
            float fadeOut = smoothstep(-10000.0, -15000.0, heightParameters[0] - radii[0]);
            if(depthSample != vec4(0)){
              col = (1.0 - fadeOut) * hazeStrength * getAtmosphereColour(cameraPosition, rayDir, mainLightDirection, terrainDepth);
            }
            float alpha = 1.0 - fadeOut;`:A`
            vec3 col = getAtmosphereColour(cameraPosition, rayDir, mainLightDirection, terrainDepth);;
            float alpha = smoothstep(0.0, mix(0.15, 0.01, heightParameters[3]), length(col));`}
      col = tonemapACES(col);
      gl_FragColor = delinearizeGamma(vec4(col, alpha));
      ${i.haze?"":A`
          if (depthSample == 1.0) {
            gl_FragColor = applyUndergroundAtmosphere(rayDir, mainLightDirection, gl_FragColor);
          }`}
    }
  `),e}const V0e=xe(),U0e=Object.freeze(Object.defineProperty({__proto__:null,betaRayleigh:Yb,build:k0e},Symbol.toStringTag,{value:"Module"}));let z0e=class extends Ir{constructor(){super(...arguments),this.heightParameters=yi(),this.radii=Te(),this.innerFadeDistance=0,this.altitudeFade=0,this.hazeStrength=1}},L3=class JQ extends ii{initializeProgram(e){return new ei(e.rctx,JQ.shader.get().build(this.configuration),oi)}initializePipeline(){return this.configuration.haze?it({blending:Gn(me.ONE,me.ZERO,me.ONE_MINUS_SRC_COLOR,me.ONE),colorWrite:gt}):it({blending:Gn(me.SRC_ALPHA,me.ONE,me.ONE_MINUS_SRC_ALPHA,me.ONE_MINUS_SRC_ALPHA),depthTest:{func:hs.LEQUAL},colorWrite:gt})}};L3.shader=new ri(U0e,()=>j(()=>import("./ChapmanAtmosphere.glsl-d406961e.js"),["assets/ChapmanAtmosphere.glsl-d406961e.js","assets/mat4-44a0988f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/mat4f64-1e28eae0.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/vec3-e93e648f.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/FloatPassUniform-68d54f51.js","assets/vec4-790471c0.js","assets/vec4f64-e407da96.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/vec3f32-c9aa289f.js","assets/compilerUtils-18d58939.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));let eZ=class extends $a{constructor(){super(...arguments),this.haze=!1}};h([k()],eZ.prototype,"haze",void 0);let F6=class{constructor(e){this._view=e,this.type=In.Realistic,this._passParameters=new z0e,this._rootTileElevationMin=NaN,this._lowerBoundEarthRadius=lo.radius,this._fadeHaze=0,this._updateRadius(lo.radius)}destroy(){this._atmosphereTechnique=Qi(this._atmosphereTechnique),this._atmosphereHazeTechnique=Qi(this._atmosphereHazeTechnique),this._vao=ke(this._vao),this._handles=Oe(this._handles)}initializeRenderContext(e){const t=e.renderContext.rctx,r=this._handles=new Vt;this._updateRootTileElevationBounds(),r.add(B(()=>this._view.basemapTerrain.rootTileElevationBounds,()=>this._updateRootTileElevationBounds())),r.add(B(()=>this._view.basemapTerrain.visibleElevationBounds,()=>this._updateVisibleElevationBounds()));const n=new eZ;n.haze=!1,this._atmosphereTechnique=e.shaderTechniqueRepository.acquire(L3,n),n.haze=!0,this._atmosphereHazeTechnique=e.shaderTechniqueRepository.acquire(L3,n),this._vao=La(t,jx)}render(e){this._render(e,this._atmosphereTechnique,e.offscreenRenderingHelper.depthTexture)}renderHaze(e,t){this._fadeHaze=t,this._render(e,this._atmosphereHazeTechnique,e.offscreenRenderingHelper.linearDepthTexture)}_render(e,t,r){if(C(r))return;this._update(e.bindParameters.camera),this._passParameters.depthTex=r;const n=e.rctx.bindTechnique(t,this._passParameters,e.bindParameters);e.offscreenRenderingHelper.renderDepthDetached(()=>{this._renderCommon(n,e)})}_renderCommon(e,t){C(this._vao)||(t.rctx.bindVAO(this._vao),e.assertCompatibleVertexAttributeLocations(this._vao),t.rctx.drawArrays(kt.TRIANGLE_STRIP,0,4))}_adjustRadiusForTesselation(e){return e*Math.cos(Math.PI/16/16)}_updateRootTileElevationBounds(){const e=this._view.basemapTerrain.rootTileElevationBounds.min;e!==this._rootTileElevationMin&&(this._rootTileElevationMin=e,this._lowerBoundEarthRadius=lo.radius,this._updateVisibleElevationBounds())}_updateVisibleElevationBounds(){const e=this._adjustRadiusForTesselation(lo.radius+this._view.basemapTerrain.visibleElevationBounds.min);e<this._lowerBoundEarthRadius&&this._updateRadius(e)}_updateRadius(e){this._lowerBoundEarthRadius=e,rt(this._passParameters.radii,e,e+hx),this._passParameters.innerFadeDistance=2*Math.sqrt((2*e-I3)*I3)}_update(e){if(C(e))return;const t=we(e.eye),r=t*t,n=r-this._passParameters.radii[1]*this._passParameters.radii[1],s=Math.min(1,Math.max(0,(t-this._passParameters.radii[0])/hx));Qs(this._passParameters.heightParameters,t,r,n,s),this._passParameters.altitudeFade=KQ(t-this._lowerBoundEarthRadius),this._passParameters.hazeStrength=bt(bt(.6,1,G0(9500,10500,t-lo.radius)),1,this._fadeHaze)}static isSupported(e){return e.renderContext.rctx.capabilities.depthTexture}};function B0e(){const i=new Yi;i.attributes.add(S.POSITION,"vec2"),i.varyings.add("worldRay","vec3");const{vertex:e,fragment:t}=i;return e.uniforms.add([new Ys("inverseProjectionMatrix",(r,n)=>n.camera.inverseProjectionMatrix),new Ys("inverseViewMatrix",(r,n)=>kn(G0e,n.camera.viewMatrix))]),e.code.add(A`void main(void) {
vec3 posViewNear = (inverseProjectionMatrix * vec4(position, -1.0, 1.0)).xyz;
worldRay = (inverseViewMatrix * vec4(posViewNear, 0.0)).xyz;
gl_Position = vec4(position, 1.0, 1.0);
}`),t.include(nH),t.include(i_),i.include(yne,{pbrMode:zr.Disabled,lightingSphericalHarmonicsOrder:2}),i.include(Jne),i.include(ND),i.include(vne,{useLegacyTerrainShading:!1}),i.include(Tne,{instancedDoublePrecision:!1,useLegacyTerrainShading:!1}),t.uniforms.add([new Ps("cameraPosition",(r,n)=>n.camera.eye)]),t.code.add(A`void main() {
vec4 cloudsColor = renderClouds(normalize(worldRay), cameraPosition);
gl_FragColor = vec4((1.0 - totalFadeInOut) * cloudsColor.rgb, cloudsColor.a);
}`),i}const G0e=xe(),H0e=Object.freeze(Object.defineProperty({__proto__:null,build:B0e},Symbol.toStringTag,{value:"Module"}));let tZ=class iZ extends ii{constructor(e){super(e,new $a,()=>this.destroy())}initializeProgram(e){return new ei(e.rctx,iZ.shader.get().build(),oi)}initializePipeline(){return it({blending:lu(me.ONE,me.SRC_ALPHA),depthTest:{func:hs.LEQUAL},colorWrite:gt})}};tZ.shader=new ri(H0e,()=>j(()=>import("./CloudsComposition.glsl-cd857f63.js"),["assets/CloudsComposition.glsl-cd857f63.js","assets/mat4-44a0988f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/mat4f64-1e28eae0.js","assets/vec3-e93e648f.js","assets/vec4-790471c0.js","assets/vec4f64-e407da96.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/vec3f32-c9aa289f.js","assets/compilerUtils-18d58939.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/mathUtils-b4bb77e2.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/mat3f64-c6305894.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/NormalUtils.glsl-c12729bf.js","assets/Ellipsoid-89682c5e.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/sphere-2af0d852.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));let Nf=class extends pe{constructor(e){super(e),this._technique=new tZ(e),this._vao=La(e.rctx)}destroy(){this._technique=Qi(this._technique),this._vao=ke(this._vao)}render(e){const t=e.bindParameters.cloudsFade;if(C(this._vao)||C(t.data))return;if(!this._technique.compiled)return void this.requestRender();const r=e.rctx.bindTechnique(this._technique,j0e,e.bindParameters);e.rctx.bindVAO(this._vao),r.assertCompatibleVertexAttributeLocations(this._vao),e.rctx.drawArrays(kt.TRIANGLE_STRIP,0,4)}};h([p({constructOnly:!0})],Nf.prototype,"rctx",void 0),h([p({constructOnly:!0})],Nf.prototype,"viewingMode",void 0),h([p({constructOnly:!0})],Nf.prototype,"planetRadius",void 0),h([p({constructOnly:!0})],Nf.prototype,"requestRender",void 0),Nf=h([F("esri.views.3d.environment.CloudsComposition")],Nf);const j0e=new Ir;var Ea;(function(i){i[i.SIXTEEN=0]="SIXTEEN",i[i.HUNDRED=1]="HUNDRED",i[i.TWOHUNDRED=2]="TWOHUNDRED",i[i.COUNT=3]="COUNT"})(Ea||(Ea={}));let cE=class extends $a{constructor(){super(...arguments),this.steps=Ea.SIXTEEN,this.writeTextureChannels=kD.RG}};h([k({count:Ea.COUNT})],cE.prototype,"steps",void 0),h([k({constValue:Ot("esri-mobile")?1024:2048})],cE.prototype,"cubeMapSize",void 0),h([k()],cE.prototype,"writeTextureChannels",void 0);let ub=class{constructor(e,t,r,n,s,a,o,l,c=.5){this.coverage=e,this.density=t,this.absorption=r,this.cloudSize=n,this.detailSize=s,this.smoothness=a,this.cloudHeight=o,this.raymarchingSteps=l,this.median=c}};const N6=new ub([0,.6],[.03,.03],[0,0],[.9,.9],[.8,.8],[.7,.7],[.05,.05],Ea.SIXTEEN),ys={sunny:N6,cloudy:new ub([.3,.65],[.2,.4],[0,0],[.85,.85],[.75,.75],[.3,.4],[1,1],Ea.TWOHUNDRED,.6),rainy:new ub([.6,.8],[.5,.8],[.1,.5],[.9,.9],[.75,.75],[.5,.5],[1,1],Ea.TWOHUNDRED,.4),snowy:new ub([.25,.75],[.3,.3],[0,0],[.95,.95],[.7,.7],[.69,.75],[.3,1],Ea.HUNDRED,.65),foggy:new ub([.8,.8],[.5,.5],[0,0],[.95,.95],[.9,.9],[.55,.55],[.3,.3],Ea.SIXTEEN),default:N6},Sl=Ot("esri-mobile")?64:128,q0e=Sl/128,dc=Math.ceil(Math.sqrt(Sl)),Tc=(Sl+2)*dc,W0e=1e5,RO=128,X0e=Tc/1560;let rZ=class extends Ir{constructor(){super(...arguments),this.cloudRadius=0,this.cloudSize=0,this.detailSize=0,this.absorption=0,this.density=0,this.smoothness=0,this.cloudHeight=0,this.coverage=0,this.raymarchingSteps=ys.default.raymarchingSteps,this.weatherTile=Te()}},nZ=class extends Ir{constructor(){super(...arguments),this.viewMatrix=Or()}};function Q0e(i){const e=new Yi;e.include(Nd,!1);const t=e.fragment;return t.uniforms.add([new Pt("cloudRadius",r=>r.cloudRadius),new Pt("power",r=>bt(35,120,r.absorption)),new Pt("sigmaE",r=>1+r.absorption),new Pt("density",r=>bt(0,.3,r.density)),new Pt("cloudSize",r=>bt(0,.02,Math.max(.01,1-r.cloudSize))),new Pt("detailSize",r=>bt(0,.2,Math.max(.01,1-r.detailSize))),new Pt("smoothness",r=>bt(0,.5,1-r.smoothness)),new Pt("cloudHeight",r=>bt(0,1500,r.cloudHeight)),new Pt("coverage",r=>r.coverage),new UI("view",r=>r.viewMatrix),new Ht("cloudShapeTexture",r=>y(r.noiseTexture)?r.noiseTexture.textureAtlas:null),new Zs("cloudVariables",r=>rt(Z0e,r.coverage,r.absorption))]),t.constants.add("halfCubeMapSize","float",.5*i.cubeMapSize),t.code.add(A`
    const int STEPS = ${i.steps===Ea.SIXTEEN?A`16`:i.steps===Ea.HUNDRED?A`100`:A`200`};
    const int STEPS_LIGHT = 6;
    const float stepL = 300.0 / float(STEPS_LIGHT);
    const float cloudStart = 1500.0;

    vec3 rayDirection(vec2 fragCoord) {
      vec2 xy = fragCoord - halfCubeMapSize;
      return normalize(vec3(-xy, -halfCubeMapSize));
    }

    float remap(float x, float low1, float high1, float low2, float high2) {
      return low2 + (x - low1) * (high2 - low2) / (high1 - low1);
    }

    float saturate(float x) {
      return clamp(x, 0.0, 1.0);
    }`),t.code.add(A`
    float getCloudShape(vec3 pos, float pOffset) {
      const float textureWidth = ${A.float(Tc)};
      const float dataWidth = ${A.float(Tc)};
      const float tileRows = ${A.float(dc)};
      const vec3 atlasDimensions = vec3(${A.float(Sl)}, ${A.float(Sl)}, tileRows * tileRows);

      //Change from Y being height to Z being height
      vec3 p = float(${A.float(q0e)}) * pos.xzy;

      //Pixel coordinates of point in the 3D data
      vec3 coord = vec3(mod(p - pOffset * atlasDimensions, atlasDimensions));
      float f = fract(coord.z);
      float level = floor(coord.z);
      float tileY = floor(level / tileRows);
      float tileX = level - tileY * tileRows;

      //The data coordinates are offset by the x and y tile, the two boundary cells between each tile pair and the initial boundary cell on the first row/column
      vec2 offset = atlasDimensions.x * vec2(tileX, tileY) + 2.0 * vec2(tileX, tileY) + 1.0;
      vec2 pixel = coord.xy + offset;
      vec2 data = texture2D(cloudShapeTexture, mod(pixel, dataWidth) / textureWidth).xy;

      return 1.0 - mix(data.x, data.y, f);
    }

    float getCloudMap(vec2 p){
      // Non-power-of-two textures can't be tiled using WebGL1
      // Get fractional part of uv to tile
      // Shift the texture center to origin to avoid seam artifacts
      vec2 uv = fract((${A.float(X0e)} * p) / ${A.float(Tc)} + 0.5);

      return texture2D(cloudShapeTexture, uv).a;
    }
    `),t.code.add(A`float clouds(vec3 p) {
float cloud = saturate(0.5 * mix(0.0, 1.0, min(2.0 * coverage, 1.0)));
if (cloud <= 0.0) {
return 0.0;
}
float cloudMap = getCloudMap(cloudSize * p.xy);
cloud = mix(cloud, min(2.0 * (coverage), 1.0) * cloudMap, min(2.0 * (1.0 - coverage), 1.0));
if (cloud <= 0.0) {
return 0.0;
}
float shape = getCloudShape(8.0 * cloudSize * p, 0.0);
cloud = saturate(remap(cloud, smoothness * shape, 1.0, 0.0, 1.0));
if (cloud <= 0.0) {
return 0.0;
}
float heightFraction = saturate((length(p) - cloudRadius - cloudStart) / cloudHeight);
cloud *= saturate(remap(heightFraction, 0.0, 0.25, 0.0, 1.0)) * smoothstep(1.0, 0.25, heightFraction);
if (cloud <= 0.0) {
return 0.0;
}
return density * saturate(remap(cloud, 0.35 * smoothness * getCloudShape(detailSize * p, 0.0), 1.0, 0.0, 1.0));
}`),t.code.add(A`vec2 sphereIntersections(vec3 start, vec3 dir, float radius) {
float a = dot(dir, dir);
float b = 2.0 * dot(dir, start);
float c = dot(start, start) - (radius * radius);
float d = (b * b) - 4.0 * a * c;
if (d < 0.0) {
return vec2(1e5, -1e5);
}
return vec2((-b - sqrt(d)) / (2.0 * a), (-b + sqrt(d)) / (2.0 * a));
}
float HenyeyGreenstein(float g, float costh) {
return (1.0 / (4.0 * 3.1415))  * ((1.0 - g * g) / pow(1.0 + g * g - 2.0 * g * costh, 1.5));
}`),t.code.add(`
    float multipleOctaves(float extinction, float mu, float stepL) {
      float attenuation = 1.0;
      float contribution = 1.0;
      float phaseAttenuation = 1.0;
      float luminance = 0.0;

      for (int i = 0; i < 4; i++) {
        float phase = mix(HenyeyGreenstein(0.0, mu), HenyeyGreenstein(0.3 * phaseAttenuation, mu), 0.7);
        luminance += contribution * phase * exp(-stepL * extinction * sigmaE * attenuation);
        attenuation *= 0.2;
        contribution *= 0.6;
        phaseAttenuation *= 0.5;
      }

      return luminance;
    }`),t.code.add(A`float lightRay(vec3 org, vec3 p, float phaseFunction, float mu, vec3 sunDirection) {
float lightRayDensity = clouds(p);
lightRayDensity += clouds(p + sunDirection * 1.0 * stepL);
lightRayDensity += clouds(p + sunDirection * 2.0 * stepL);
lightRayDensity += clouds(p + sunDirection * 3.0 * stepL);
lightRayDensity += clouds(p + sunDirection * 4.0 * stepL);
lightRayDensity += clouds(p + sunDirection * 5.0 * stepL);
float beersLaw = multipleOctaves(lightRayDensity, mu, stepL);
return mix(beersLaw * 2.0 * (1.0 - (exp(-stepL * lightRayDensity * 2.0 * sigmaE ))), beersLaw, 0.5 + 0.5 * mu);
}`),t.code.add(A`float mainRay(vec3 org, vec3 dir, vec3 sunDirection, float distToStart, float totalDistance, out float totalTransmittance) {
if (dir.z < 0.0) {
return 0.0;
}
totalTransmittance = 1.0;
float stepS = totalDistance / float(STEPS);
float cameraHeight = length(org);
float mu = 0.5 + 0.5 * dot(sunDirection, dir);
float phaseFunction = mix(HenyeyGreenstein(-0.3, mu), HenyeyGreenstein(0.3, mu), 0.7);
vec3 p = org + distToStart  * dir;
float dist = distToStart;
float shading = 0.0;
for (int i = 0; i < STEPS; i++) {
float sampleDensity = clouds(p);
float sampleSigmaE = sampleDensity * sigmaE;
if (sampleDensity > 0.0 ) {
float ambient = mix((1.2), (1.6), saturate((length(p) - cloudRadius - cloudStart) / cloudHeight));
float luminance = sampleDensity * (ambient + power * phaseFunction * lightRay(org, p, phaseFunction, mu, sunDirection));
float transmittance = exp(-sampleSigmaE * stepS);
shading += totalTransmittance * (luminance - luminance * transmittance) / sampleSigmaE;
totalTransmittance *= transmittance;
if (totalTransmittance <= 0.001) {
totalTransmittance = 0.0;
break;
}
}
dist += stepS;
p = org + dir * dist;
}
return shading;
}`),t.code.add(A`void main() {
if (coverage ==  0.0) {
gl_FragColor = vec4(0.0, 1.0, 0.0, 1.0);
return;
}
vec3 rayDir = rayDirection(gl_FragCoord.xy);
rayDir = normalize(view * rayDir);
vec3 viewPos = vec3(0, 0, cloudRadius + 1.0);
bool hitsPlanet = rayDir.z < 0.0;
float hazeFactor = smoothstep(-0.01, mix(0.0, 0.075, cloudVariables.x), abs(dot(rayDir, vec3(0, 0, 1))));
float totalTransmittance = 1.0;
float shading = 0.0;
if (hitsPlanet) {
shading = clamp(1.0 - cloudVariables.y, 0.6, 1.0) * (1.0 - hazeFactor);
totalTransmittance = hazeFactor;
gl_FragColor = vec4(shading, totalTransmittance, shading, totalTransmittance);
return;
}
vec2 rayStartIntersect = sphereIntersections(viewPos, rayDir, cloudRadius + cloudStart);
vec2 rayEndIntersect = sphereIntersections(viewPos, rayDir, cloudRadius + cloudStart + cloudHeight);
float distToStart = rayStartIntersect.y;
float totalDistance = rayEndIntersect.y - distToStart;
vec3 sunDirection = normalize(vec3(0, 0, 1));
shading = 0.5 * mainRay(viewPos, rayDir, sunDirection, distToStart, totalDistance, totalTransmittance);
shading = mix(clamp(1.0 - cloudVariables.y, 0.6, 1.0), shading, hazeFactor);
totalTransmittance = mix(0.0, totalTransmittance, hazeFactor);
gl_FragColor = vec4(shading, totalTransmittance, shading, totalTransmittance);
}`),e}const Z0e=Te(),Y0e=Object.freeze(Object.defineProperty({__proto__:null,CloudsPassParameters:rZ,CloudsDrawParameters:nZ,build:Q0e},Symbol.toStringTag,{value:"Module"}));let sZ=class aZ extends ii{constructor(e,t){super(e,t,()=>this.destroy())}initializeProgram(e){return new ei(e.rctx,aZ.shader.get().build(this.configuration),oi)}initializePipeline(){return it({blending:lu(me.CONSTANT_COLOR,me.ONE_MINUS_CONSTANT_COLOR,Pw.ADD,this.configuration.writeTextureChannels===kD.RG?[1,1,0,0]:[0,0,1,1]),depthTest:{func:hs.LEQUAL},colorWrite:gt})}};sZ.shader=new ri(Y0e,()=>j(()=>import("./Clouds.glsl-2f558b9b.js"),["assets/Clouds.glsl-2f558b9b.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/mat3f64-c6305894.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DPassUniform-753de459.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));var Xo;(function(i){i[i.Full=0]="Full",i[i.WeatherMap=1]="WeatherMap",i[i.COUNT=2]="COUNT"})(Xo||(Xo={}));let $3=class extends $a{constructor(){super(...arguments),this.mode=Xo.Full}};h([k({count:Xo.COUNT})],$3.prototype,"mode",void 0);let oZ=class extends Ir{constructor(){super(...arguments),this.weatherTile=Qt(0,0)}};function K0e(i){const e=new Yi;return e.include(Nd,!1),e.fragment.code.add(A`float remap(float x, float low1, float high1, float low2, float high2) {
return low2 + (x - low1) * (high2 - low2) / (high1 - low1);
}`),i.mode===Xo.Full&&e.fragment.code.add(A`
    float saturate(float x) {
      return clamp(x, 0.0, 1.0);
    }

    // Safer modulo for positive and negative values
    vec3 modulo(vec3 m, float n){
      return mod(mod(m, n) + n, n);
    }

    vec3 hash(vec3 p3, float frequency){
      p3 = modulo(p3, frequency);
      p3 = fract(p3 * vec3(0.1031, 0.1030, 0.0973));
      p3 += dot(p3, p3.yxz + 33.33);
      return -1.0 + 2.0 * fract((p3.xxy + p3.yxx) * p3.zyx);
    }

    // 5th order polynomial interpolation
    vec3 fade(vec3 t){
      return (t * t * t) * (t * (t * 6.0 - 15.0) + 10.0);
    }

    float gradientNoise(vec3 p, float frequency){
      // Cell point is in
      vec3 i = floor(p);

      // Position in the cell in [0, 1]
      vec3 f = fract(p);

      // Interpolation value for gradient mixing
      vec3 u = fade(f);

      // Trilinear interpolation of gradients at cube vertices around point
      return mix( mix( mix( dot( hash( i + vec3(0.0,0.0,0.0), frequency), f - vec3(0.0,0.0,0.0) ),
                            dot( hash( i + vec3(1.0,0.0,0.0), frequency), f - vec3(1.0,0.0,0.0) ), u.x),
                       mix( dot( hash( i + vec3(0.0,1.0,0.0), frequency), f - vec3(0.0,1.0,0.0) ),
                            dot( hash( i + vec3(1.0,1.0,0.0), frequency), f - vec3(1.0,1.0,0.0) ), u.x), u.y),
                  mix( mix( dot( hash( i + vec3(0.0,0.0,1.0), frequency), f - vec3(0.0,0.0,1.0) ),
                            dot( hash( i + vec3(1.0,0.0,1.0), frequency), f - vec3(1.0,0.0,1.0) ), u.x),
                       mix( dot( hash( i + vec3(0.0,1.0,1.0), frequency), f - vec3(0.0,1.0,1.0) ),
                            dot( hash( i + vec3(1.0,1.0,1.0), frequency), f - vec3(1.0,1.0,1.0) ), u.x), u.y), u.z );
    }

    float getPerlinNoise(vec3 pos, float frequency) {
      float octaveFrequencyFactor = 2.0;
      float sum = 0.0;
      float weightSum = 0.0;
      float weight = 1.0;

      for (int oct = 0; oct < 3; oct++) {
        vec3 p = pos * frequency;
        float val = 0.5 + 0.5 * gradientNoise(p, frequency);
        sum += val * weight;
        weightSum += weight;
        weight *= 0.5;
        frequency *= octaveFrequencyFactor;
      }

      float noise = (sum / weightSum);
      noise = saturate(noise);
      return noise;
    }

    float worley(vec3 pos, float numCells) {
      vec3 p = pos * numCells;
      float d = 1.0e10;

      for (int x = -1; x <= 1; x++) {
        for (int y = -1; y <= 1; y++) {
          for (int z = -1; z <= 1; z++) {
            vec3 tp = floor(p) + vec3(x, y, z);
            tp = p - tp - (hash(tp, numCells) * 0.5 + 0.5);
            d = min(d, dot(tp, tp));
          }
        }
      }

      return 1.0 - clamp(d, 0.0, 1.0);
    }

    vec3 get3Dfrom2D(vec2 uv) {
      vec2 tile = floor(uv);
      float z = floor(${A.float(dc)} * tile.y + tile.x);
      return vec3(fract(uv), z);
    }

    float getTextureForPointPerlinWorley(vec3 p) {
      float perlinNoise = getPerlinNoise(p, ${A.float(8)});

      float worley0 = worley(p, ${A.float(2)} * 2.0);
      float worley1 = worley(p, ${A.float(2)} * 8.0);
      float worley2 = worley(p, ${A.float(2)} * 14.0);

      float worleyFBM = worley0 * 0.625 + worley1 * 0.25 + worley2 * 0.125;
      return remap(perlinNoise, 0.0, 1.0, worleyFBM, 1.0);
    }

    float getTextureForPointWorley(vec3 p) {
      float worley0 = worley(p, ${A.float(2)});
      float worley1 = worley(p, ${A.float(2)} * 2.0);
      float worley2 = worley(p, ${A.float(2)} * 4.0);
      float worley3 = worley(p, ${A.float(2)} * 8.0);

      float FBM0 = worley0 * 0.625 + worley1 * 0.25 + worley2 * 0.125;
      float FBM1 = worley1 * 0.625 + worley2 * 0.25 + worley3 * 0.125;
      float FBM2 = worley2 * 0.75 + worley3 * 0.25;

      return FBM0 * 0.625 + FBM1 * 0.25 + FBM2 * 0.125;
    }
  `),e.fragment.uniforms.add(new Zs("weatherTile",t=>t.weatherTile)),e.fragment.code.add(A`
    vec2 modulo(vec2 m, float n){
      return mod(mod(m, n) + n, n);
    }

    vec2 hash(vec2 p){
      // Get position of p in weather tile
      p = modulo(p, ${A.float(RO)});

      // Get global coordinates of p
      p += weatherTile * ${A.float(RO)};

      // Limit position to avoid numerical instability
      p = modulo(p, ${A.float(W0e)});

      vec3 p3 = fract(vec3(p.xyx) * vec3(0.1031, 0.1030, 0.0973));
      p3 += dot(p3, p3.yzx + 33.33);
      return 2.0 * fract((p3.xx + p3.yz) * p3.zy) - 1.0;
    }

    vec2 fade(vec2 t){
      return (t * t * t) * (t * (t * 6.0 - 15.0) + 10.0);
    }

    float gradientNoise(vec2 p){
      vec2 i = floor( p );
      vec2 f = fract( p );

      vec2 u = fade(f);

      // Bilinear interpolation of gradients at cell vertices around point
      return  mix(
                mix(dot( hash( i + vec2(0.0,0.0) ), f - vec2(0.0,0.0) ),
                    dot( hash( i + vec2(1.0,0.0) ), f - vec2(1.0,0.0) ), u.x),
                mix(dot( hash( i + vec2(0.0,1.0) ), f - vec2(0.0,1.0) ),
                    dot( hash( i + vec2(1.0,1.0) ), f - vec2(1.0,1.0) ), u.x),
                u.y);
    }

    float worley(vec2 p){
      float d = 1.0e10;
      for (int x = -1; x <= 1; x++){
        for (int y = -1; y <= 1; y++){
                vec2 tp = floor(p) + vec2(x, y);
                tp = p - tp - (0.5 + 0.5 * hash(tp));
                d = min(d, dot(tp, tp));
            }
        }
      return 1.0 - clamp(d, 0.0, 1.0);
    }
  `),e.fragment.code.add(A`void main() {`),i.mode===Xo.Full&&e.fragment.code.add(A`
        float padWidth = 1.0;
        float paddedSize = ${A.float(Sl)} + 2.0 * padWidth;
        float tileCount = ${A.float(dc)} * ${A.float(dc)};
        vec2 tile = floor((gl_FragCoord.xy - 0.5) / paddedSize);

        bool padCell = false;
        if (mod(gl_FragCoord.x, paddedSize) == 0.5 || mod(gl_FragCoord.x, paddedSize) == paddedSize - 0.5) {
          padCell = true;
        }

        if (mod(gl_FragCoord.y, paddedSize) == 0.5 || mod(gl_FragCoord.y, paddedSize) == paddedSize - 0.5) {
          padCell = true;
        }

        bool startPadX = false;
        bool startPadY = false;
        bool endPadX = false;
        bool endPadY = false;

        if (gl_FragCoord.x == tile.x * paddedSize + 0.5) {
          startPadX = true;
        }

        if (gl_FragCoord.y == tile.y * paddedSize + 0.5) {
          startPadY = true;
        }

        if (gl_FragCoord.x == (tile.x + 1.0) * paddedSize - 0.5) {
          endPadX = true;
        }

        if (gl_FragCoord.y == (tile.y + 1.0) * paddedSize - 0.5) {
          endPadY = true;
        }

        vec2 padding = vec2(2.0 * padWidth) * tile;
        vec2 uv;

        if (padCell) {
          vec2 pixel = gl_FragCoord.xy - padWidth - padding;

          if (startPadX) {
            pixel.x += ${A.float(Sl)};
          }

          if (startPadY) {
            pixel.y += ${A.float(Sl)};
          }

          if (endPadX) {
            pixel.x -= ${A.float(Sl)};
          }

          if (endPadY) {
            pixel.y -= ${A.float(Sl)};
          }

          uv = vec2(pixel.xy / ${A.float(Sl)});
        } else {
          vec2 pixel = gl_FragCoord.xy - padWidth - padding;
          uv = vec2(pixel.xy / ${A.float(Sl)});
        }

        vec3 p_ = get3Dfrom2D(uv);
        vec3 p = p_;
        p.z /= (${A.float(dc)} * ${A.float(dc)});

        float worleyPerlinNoise = getTextureForPointPerlinWorley(p);
        float worleyNoise = getTextureForPointWorley(p);

        gl_FragColor.r = saturate(remap(worleyPerlinNoise, worleyNoise, 1.0, 0.0, 1.0));

        p_ = mod(p_ + 1.0, ${A.float(dc)} * ${A.float(dc)});
        p = p_;
        p.z /= (${A.float(dc)} * ${A.float(dc)});

        worleyPerlinNoise = getTextureForPointPerlinWorley(p);
        worleyNoise = getTextureForPointWorley(p);

        gl_FragColor.g = saturate(remap(worleyPerlinNoise, worleyNoise, 1.0, 0.0, 1.0));
      `),e.fragment.code.add(A`
      vec2 mapUV = ${A.float(RO)} * (gl_FragCoord.xy / ${A.float(Tc)});
      float map = abs(gradientNoise(mapUV));
      map = remap(map, 0.25 * (1.0 - worley(8.0 * mapUV)), 1.0, 0.0, 1.0);

      ${i.mode===Xo.Full?A`gl_FragColor.ba = vec2(0.0, map);`:A`gl_FragColor = vec4(map);`};
    }
  `),e}const J0e=Object.freeze(Object.defineProperty({__proto__:null,NoiseTextureAtlasPassParameters:oZ,build:K0e},Symbol.toStringTag,{value:"Module"}));let D3=class lZ extends ii{initializeProgram(e){return new ei(e.rctx,lZ.shader.get().build(this.configuration),oi)}initializePipeline(){return it({blending:this.configuration.mode===Xo.Full?lu(me.ONE,me.ZERO):Gn(me.ZERO,me.ONE,me.ONE,me.ZERO),depthTest:{func:hs.ALWAYS},colorWrite:gt})}};D3.shader=new ri(J0e,()=>j(()=>import("./NoiseTextureAtlas.glsl-832d6ac3.js"),["assets/NoiseTextureAtlas.glsl-832d6ac3.js","assets/vec2f64-30dc1443.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/VertexAttribute-9c5c630d.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/vec2-528adfe4.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));let db=class extends pe{constructor(e){super(e),this._needsRender=!0,this._passParameters=new oZ,this._frameBuffer=new yn(e.context.renderContext.rctx,{colorTarget:Vn.TEXTURE,width:Tc,height:Tc},{target:bi.TEXTURE_2D,pixelFormat:St.RGBA,dataType:Xt.UNSIGNED_BYTE,wrapMode:ai.CLAMP_TO_EDGE,samplingMode:Jt.LINEAR,hasMipmap:!1,width:Tc,height:Tc}),this._vao=La(e.context.renderContext.rctx)}get _techniqueRepository(){return this.context.shaderTechniqueRepository}get textureAtlas(){return y(this._texture)?y(this._weatherMapTechnique)&&this._weatherMapTechnique.compiled&&this._needsRender&&(this._texture=this._render(Xo.WeatherMap)):y(this._fullTechnique)&&this._fullTechnique.compiled&&(this._texture=this._render(Xo.Full)),this._texture}_setDirty(){this._needsRender=!0}updateWeatherMap(e){this._passParameters.weatherTile[0]===e[0]&&this._passParameters.weatherTile[1]===e[1]||(wn(this._passParameters.weatherTile,e),this._setDirty())}destroy(){this._fullTechniqueCached=Qi(this._fullTechniqueCached),this._weatherMapTechniqueCached=Qi(this._weatherMapTechniqueCached),this._frameBuffer=ke(this._frameBuffer),this._vao=ke(this._vao)}get _fullTechnique(){if(C(this._fullTechniqueCached)){const e=new $3;e.mode=Xo.Full,this._fullTechniqueCached=this._techniqueRepository.acquire(D3,e)}return this._fullTechniqueCached}get _weatherMapTechnique(){if(C(this._weatherMapTechniqueCached)){const e=new $3;e.mode=Xo.WeatherMap,this._weatherMapTechniqueCached=this._techniqueRepository.acquire(D3,e)}return this._weatherMapTechniqueCached}_render(e){if(C(this._vao)||C(this._frameBuffer))return null;const t=e===Xo.Full?this._fullTechnique:this._weatherMapTechnique,r=this.context.renderContext.rctx,n=r.getViewport();r.setViewport(0,0,Tc,Tc),r.bindFramebuffer(this._frameBuffer);const s=r.bindTechnique(t,this._passParameters,null);return r.bindVAO(this._vao),s.assertCompatibleVertexAttributeLocations(this._vao),r.gl.drawArrays(r.gl.TRIANGLE_STRIP,0,4),r.setViewport(n.x,n.y,n.width,n.height),this._needsRender=!1,this._frameBuffer.colorTexture}};h([p({constructOnly:!0})],db.prototype,"context",void 0),h([p({readOnly:!0})],db.prototype,"_techniqueRepository",null),db=h([F("esri.views.3d.environment.NoiseTextureAtlas")],db);let AP=class{constructor(e,t,r){this.shadowMap=e,this.ssaoHelper=t,this.slicePlane=r,this.slot=le.OPAQUE_MATERIAL,this.hasOccludees=!1,this.enableFillLights=!0,this._inverseViewport=Te(),this.oldLighting=new pA,this.newLighting=new pA,this._fadedLighting=new pA,this._lighting=this.newLighting,this.ssr=new Cne,this.multipassTerrain=new ose,this.multipassGeometry=new sse,this.overlays=[],this.cloudsFade=new Sne}get camera(){return this._camera}set camera(e){this._camera=this.ssr.camera=e,this._inverseViewport[0]=1/e.fullViewport[2],this._inverseViewport[1]=1/e.fullViewport[3]}get inverseViewport(){return this._inverseViewport}get lighting(){return this._lighting}get weatherFading(){return this._lighting===this._fadedLighting}fadeLighting(e){const{oldLighting:t,newLighting:r}=this;e>=1?this._lighting=r:(this._fadedLighting.lerpLighting(t,r,e),this._lighting=this._fadedLighting)}},pa=class extends pe{constructor(e){super(e),this.runOncePerFrame=!0,this._handles=new Vt,this._techniques=new Array,this._techniqueConfiguration=new cE,this._bindParameters=new AP(null,null,null),this._passParameters=new rZ,this._drawParameters=new nZ,this._weatherTile=Te(),this._weatherTileCount=128,this._faceIndex=0,this._tileIndex=0,this.coverage=bt(ys.default.coverage[0],ys.default.coverage[1],.5),this.density=bt(ys.default.density[0],ys.default.density[1],.5),this.absorption=bt(ys.default.absorption[0],ys.default.absorption[1],.5),this.cloudSize=bt(ys.default.cloudSize[0],ys.default.cloudSize[1],.5),this.detailSize=bt(ys.default.detailSize[0],ys.default.detailSize[1],.5),this.smoothness=bt(ys.default.smoothness[0],ys.default.smoothness[1],.5),this.cloudHeight=bt(ys.default.cloudHeight[0],ys.default.cloudHeight[1],.5),this.raymarchingSteps=ys.default.raymarchingSteps,this._viewMatrix=xe(),this._dirty=!1,this.running=!1}_getTechnique(e){const t=1-this.context.renderContext.bindParameters.cloudsFade.readChannels,r=t===kD.RG?2*e:2*e+1;return this._techniques[r]||(this._techniqueConfiguration.writeTextureChannels=t,this._techniqueConfiguration.steps=e,this._techniques[r]=new sZ({rctx:this.context.renderContext.rctx,viewingMode:this.view.state.viewingMode},this._techniqueConfiguration),this._techniques[r])}updateWeatherTile(){const e=this.view.camera.position.latitude,t=this.view.camera.position.longitude;rt(this._weatherTile,(e+90)/180,(t+180)/360);const r=Math.floor(this._weatherTileCount*Math.abs(2*this._weatherTile[0]-1));this._weatherTile[0]=Math.floor(2*this._weatherTileCount*this._weatherTile[0]),this._weatherTile[1]=Math.floor(4*(this._weatherTileCount-r)*this._weatherTile[1]);let n=0,s=0;if(y(this.view.environment)&&this.view.environment.lighting.type!=="virtual"&&y(this.view.environment.lighting.date)){const a=new Date(this.view.environment.lighting.date);a.setUTCHours(this.view.environment.lighting.date.getUTCHours()+this.view.environment.lighting.displayUTCOffset),n=31*a.getUTCMonth()+a.getUTCDate(),s=a.getUTCFullYear()}this._weatherTile[0]=(this._weatherTile[0]+n)%(2*this._weatherTileCount),this._weatherTile[1]=(this._weatherTile[1]+s%100)%(4*this._weatherTileCount),mre(this._passParameters.weatherTile,this._weatherTile)||this.setDirty()}initialize(){this._vao=La(this.context.renderContext.rctx);const e=Kt(this.view.spatialReference);this._passParameters.cloudRadius=.5*e.radius,this.setDirty(),this.updateWeatherTile(),this._handles.add([this.view.resourceController.scheduler.registerTask(dr.CLOUDS_GENERATOR,this),B(()=>[this.coverage,this.density,this.absorption,this.cloudSize,this.detailSize,this.smoothness,this.cloudHeight,this.raymarchingSteps],()=>this.setDirty(),et)])}destroy(){this._handles.destroy(),this._techniques.forEach(e=>Qi(e)),this._frameBufferCube=ke(this._frameBufferCube),this._techniques.length=0,this._vao=ke(this._vao),this._passParameters.noiseTexture=Oe(this._passParameters.noiseTexture)}get _tilesPerFace(){switch(this._techniqueConfiguration.steps){case Ea.SIXTEEN:return 1;case Ea.HUNDRED:return 4;case Ea.COUNT:case Ea.TWOHUNDRED:return 8}}_ensureNoiseTexture(){if(y(this._passParameters.noiseTexture))this._passParameters.noiseTexture.updateWeatherMap(this._passParameters.weatherTile);else{const e=this.context;this._passParameters.noiseTexture=new db({context:e}),this._passParameters.noiseTexture.updateWeatherMap(this._passParameters.weatherTile)}return y(this._passParameters.noiseTexture.textureAtlas)}_ensureFrameBufferCube(e){if(C(this._frameBufferCube)){const t={target:bi.TEXTURE_CUBE_MAP,pixelFormat:St.RGBA,dataType:Xt.UNSIGNED_BYTE,wrapMode:ai.CLAMP_TO_EDGE,samplingMode:Jt.LINEAR,hasMipmap:!1,width:e,height:e};this._frameBufferCube=new yn(this.context.renderContext.rctx,{colorTarget:Vn.CUBEMAP,width:e,height:e},t)}return this._frameBufferCube}get cubeMap(){return this._frameBufferCube}destroyFrameBufferCube(){this._frameBufferCube=ke(this._frameBufferCube)}applyPreset(e,t){const r=e.median,n=s=>{const a=bt(s[0],s[1],r);return t<.5?bt(s[0],a,2*t):bt(a,s[1],2*(t-.5))};this.coverage=n(e.coverage),this.density=n(e.density),this.absorption=n(e.absorption),this.cloudSize=n(e.cloudSize),this.detailSize=n(e.detailSize),this.smoothness=n(e.smoothness),this.cloudHeight=n(e.cloudHeight),this.raymarchingSteps=e.raymarchingSteps}setDirty(){this._dirty=this.running=!0}runTask(e){if(C(this._vao))return this._dirty=this.running=!1,void(this.context.renderContext.bindParameters.cloudsFade.renderingStage=Kr.FINISHED_RENDERING);this._faceIndex===0&&this._tileIndex===0&&(this._passParameters.raymarchingSteps=this.raymarchingSteps,this.updateWeatherTile(),wn(this._passParameters.weatherTile,this._weatherTile));const t=this._getTechnique(this._passParameters.raymarchingSteps);if(!t.compiled||!this.context.renderContext.bindParameters.cloudsFade.isCameraPositionFinal||this.context.renderContext.bindParameters.cloudsFade.isFading||!this._ensureNoiseTexture())return;this._faceIndex===0&&this._tileIndex===0&&(this.context.renderContext.bindParameters.cloudsFade.renderingStage=Kr.RENDERING,this._passParameters.absorption=this.absorption,this._passParameters.density=this.density,this._passParameters.cloudSize=this.cloudSize,this._passParameters.detailSize=this.detailSize,this._passParameters.smoothness=this.smoothness,this._passParameters.cloudHeight=this.cloudHeight,this._passParameters.coverage=this.coverage,this._dirty=!1);const r=this.context.renderContext.rctx,n=r.bindTechnique(t,this._passParameters,this._bindParameters);r.bindVAO(this._vao),n.assertCompatibleVertexAttributeLocations(this._vao);const s=r.getViewport(),a=t.configuration.cubeMapSize,o=a/this._tilesPerFace,l=this._tileIndex*o;r.setViewport(0,l,a,o);const c=this._ensureFrameBufferCube(a);r.bindFramebuffer(c);const u=eve[this._faceIndex],d=tve[this._faceIndex];Qre(this._viewMatrix,ive,u,d),Td(this._drawParameters.viewMatrix,this._viewMatrix);const m=bi.TEXTURE_CUBE_MAP_POSITIVE_X+this._faceIndex;c.setColorTextureTarget(m),n.bindDraw(this._drawParameters,this._bindParameters,this._passParameters),r.gl.drawArrays(r.gl.TRIANGLE_STRIP,0,4),r.gl.flush(),r.setViewport(s.x,s.y,s.width,s.height),this.requestRender(),e.madeProgress(),++this._tileIndex,this._faceIndex===4&&this._tileIndex===this._tilesPerFace?(this.running=this._dirty,this._faceIndex=0,this._tileIndex=0,this.context.renderContext.bindParameters.cloudsFade.renderingStage=Kr.FINISHED_RENDERING):this._tileIndex===this._tilesPerFace&&(++this._faceIndex,this._tileIndex=0)}};h([p({constructOnly:!0})],pa.prototype,"context",void 0),h([p({constructOnly:!0})],pa.prototype,"view",void 0),h([p({constructOnly:!0})],pa.prototype,"requestRender",void 0),h([p()],pa.prototype,"coverage",void 0),h([p()],pa.prototype,"density",void 0),h([p()],pa.prototype,"absorption",void 0),h([p()],pa.prototype,"cloudSize",void 0),h([p()],pa.prototype,"detailSize",void 0),h([p()],pa.prototype,"smoothness",void 0),h([p()],pa.prototype,"cloudHeight",void 0),h([p()],pa.prototype,"raymarchingSteps",void 0),h([p()],pa.prototype,"running",void 0),pa=h([F("esri.views.3d.environment.CloudsGenerator")],pa);const eve=[_i(1,0,0),_i(-1,0,0),_i(0,1,0),_i(0,-1,0),_i(0,0,1)],tve=[_i(0,1,0),_i(0,1,0),_i(0,0,-1),_i(0,0,1),_i(0,1,0)],ive=ese();let XN=class extends Ir{constructor(){super(...arguments),this.fogColor=P(),this.hazeColor=P(),this.fogStrength=4e-6,this.hazeStrength=4e-6,this.atmosphereC=1}};function rve(i){const e=new Yi;e.attributes.add(S.POSITION,"vec2"),e.include(kR,{textureCoordinateType:Im.Default}),e.varyings.add("worldRay","vec3"),e.varyings.add("eyeDir","vec3");const{vertex:t,fragment:r}=e;return t.uniforms.add([new Ys("inverseProjectionMatrix",(n,s)=>s.camera.inverseProjectionMatrix),new Ys("inverseViewMatrix",(n,s)=>kn(nve,s.camera.viewMatrix))]),t.code.add(A`void main(void) {
vec3 posViewNear = (inverseProjectionMatrix * vec4(position, -1, 1)).xyz;
eyeDir = posViewNear;
worldRay = (inverseViewMatrix * vec4(posViewNear, 0)).xyz;
forwardTextureCoordinates();
gl_Position = vec4(position, 1, 1);
}`),r.uniforms.add(new Pt("atmosphereC",n=>n.atmosphereC)),r.uniforms.add(new Ps("cameraPosition",(n,s)=>s.camera.eye)),r.uniforms.add(new Zs("nearFar",(n,s)=>s.camera.nearFar)),r.uniforms.add(new Ht("depthTex",n=>n.depthTexture)),r.uniforms.add(new Pt("fogStrength",n=>i.haze?n.hazeStrength:n.fogStrength)),r.uniforms.add(new Pt("fogAmount",n=>i.haze?n.hazeAmount:n.fogAmount)),r.uniforms.add(new Ps("fogColor",n=>i.haze?n.hazeColor:n.fogColor)),e.include(ND),r.include(Ig),r.code.add(A`vec2 sphereIntersect(vec3 start, vec3 dir) {
float a = dot(dir, dir);
float b = 2.0 * dot(dir, start);
float d = (b * b) - 4.0 * a * atmosphereC;
if (d < 0.0) {
return vec2(1e5, -1e5);
}
return vec2((-b - sqrt(d)) / (2.0 * a), (-b + sqrt(d)) / (2.0 * a));
}`),r.code.add(A`vec4 applyFog(float dist, vec3 rayDir){
if(dist == -1.0){
vec2 rayAtmosphereIntersect = sphereIntersect(cameraPosition, rayDir);
dist = 0.055 * rayAtmosphereIntersect.y;
}
float fogAmount = fogAmount * (1.0 - exp(-dist * fogStrength));
return vec4(fogAmount * fogColor, fogAmount);
}`),r.code.add(A`
    vec3 tonemapACES(vec3 x) {
      return clamp((x * (2.51 * x + 0.03)) / (x * (2.43 * x + 0.59) + 0.14), 0.0, 1.0);
    }

    void main() {
      vec3 rayDir = normalize(worldRay);
      float terrainDepth = -1.0;

      float depthSample = texture2D(depthTex, vuv0).r;
      float zNorm = 2.0 * depthSample - 1.0;
      float linDepth = 2.0 * nearFar[0] * nearFar[1] / (nearFar[1] + nearFar[0] - zNorm * (nearFar[1] - nearFar[0]));
      if(depthSample < 1.0 && depthSample > 0.0){
        vec3 cameraSpaceRay = normalize(eyeDir);
        cameraSpaceRay /= cameraSpaceRay.z;
        cameraSpaceRay *= linDepth;
        terrainDepth = max(0.0, length(cameraSpaceRay));
      }

      ${i.haze?A`
          if(terrainDepth == -1.0){
            gl_FragColor = vec4(0);
            return;
          }`:""}

      vec4 fog = applyFog(terrainDepth, rayDir);

      gl_FragColor = delinearizeGamma(vec4(tonemapACES(fog.rgb), fog.a));
    }
  `),e}const nve=xe(),cZ=Object.freeze(Object.defineProperty({__proto__:null,FogHazePassParameters:XN,build:rve},Symbol.toStringTag,{value:"Module"}));let hZ=class uZ extends ii{initializeProgram(e){return new ei(e.rctx,uZ.shader.get().build(this.configuration),oi)}initializePipeline(){return this.configuration.haze?it({blending:Gn(me.ONE,me.ZERO,me.ONE_MINUS_SRC_COLOR,me.ONE),colorWrite:gt}):it({blending:Gn(me.SRC_ALPHA,me.ZERO,me.ONE_MINUS_SRC_ALPHA,me.ONE),colorWrite:gt})}};hZ.shader=new ri(cZ,()=>j(()=>import("./FogHaze.glsl-88c5583f.js"),["assets/FogHaze.glsl-88c5583f.js","assets/mat4-44a0988f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/mat4f64-1e28eae0.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/vec3-e93e648f.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/FloatPassUniform-68d54f51.js","assets/vec4-790471c0.js","assets/vec4f64-e407da96.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/vec3f32-c9aa289f.js","assets/compilerUtils-18d58939.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));let QN=class extends $a{constructor(){super(...arguments),this.haze=!1}};h([k()],QN.prototype,"haze",void 0);const sve=.95,ave=1;let pb=class extends pe{constructor(e){super(e),this._passParameters=new XN;const t=e.context.renderContext.rctx;this._vao=La(t,jx);const r=Kt(e.view.spatialReference);this._planetRadius=r.radius,this._atmosphereRadius=r.radius+hx}destroy(){this._thickFogTechniqueCached=Qi(this._thickFogTechniqueCached),this._vao=ke(this._vao)}get _shaderTechniqueRepository(){return this.context.shaderTechniqueRepository}set strength(e){this._passParameters.fogStrength=e}get strength(){return this._passParameters.fogStrength}get _thickFogTechnique(){if(C(this._thickFogTechniqueCached)){const e=new QN;e.haze=!1,this._thickFogTechniqueCached=this._shaderTechniqueRepository.acquire(hZ,e)}return this._thickFogTechniqueCached}render(e,t){if(this._update(e,t),this._passParameters.fogAmount<=0)return;const r=this._thickFogTechnique;if(!r.compiled)return void this.context.requestRender();const n=e.offscreenRenderingHelper;n.renderDepthDetached(()=>{this._passParameters.depthTexture=n.depthTexture;const s=e.rctx.bindTechnique(r,this._passParameters,e.bindParameters);this._renderFog(s,e)})}_renderFog(e,t){if(C(this._vao))return;const r=t.rctx;r.bindVAO(this._vao),e.assertCompatibleVertexAttributeLocations(this._vao),r.drawArrays(kt.TRIANGLE_STRIP,0,4)}_update(e,t){const r=e.bindParameters.camera;de(k6,r.eye);const n=Math.max(0,_e(k6,e.bindParameters.lighting.mainLight.direction)),s=t.color;Q(V6,s,.1),Bn(this._passParameters.fogColor,V6,s,n);const a=we(r.eye),o=a*a;this._passParameters.atmosphereC=o-this._atmosphereRadius*this._atmosphereRadius,this._passParameters.fogAmount=(1-G0(sve*Cl,ave*Cl,Math.abs(a-this._planetRadius)))*t.amount,this._passParameters.fogStrength=t.strength}static isSupported(e){return e.capabilities.depthTexture}};h([p({constructOnly:!0})],pb.prototype,"context",void 0),h([p({constructOnly:!0})],pb.prototype,"view",void 0),pb=h([F("esri.views.3d.environment.Fog")],pb);let ove=class{constructor(){this.color=P(),this.strength=0,this.amount=0}};const k6=P(),V6=P();var su;(function(i){i[i.Cone=0]="Cone",i[i.Cylinder=1]="Cylinder",i[i.Underground=2]="Underground",i[i.COUNT=3]="COUNT"})(su||(su={}));let H2=class extends cu{constructor(){super(...arguments),this.geometry=su.Cone}};h([k({count:su.COUNT})],H2.prototype,"geometry",void 0);let ZN=class extends Ir{constructor(){super(...arguments),this.texV=Te(),this.altitudeFade=0,this.innerScale=0,this.undergroundFadeAlpha=0,this.silhouette=new dZ}},dZ=class{constructor(){this.center=P(),this.v1=P(),this.v2=P()}};function lve(i){const e=new Yi,{vertex:t,fragment:r}=e;if(VR(t),i.geometry===su.Underground)e.attributes.add(S.POSITION,"vec2"),e.varyings.add("color","vec4"),t.uniforms.add([new Ps("cameraPosition",(n,s)=>s.camera.eye),new Pt("undergroundFadeAlpha",n=>n.undergroundFadeAlpha)]),t.code.add(A`void main(void) {
float ndotl = dot(normalize(cameraPosition), mainLightDirection);
float lighting = max(0.0, smoothstep(-1.0, 0.8, 2.0 * ndotl));
color = vec4(vec3(lighting), undergroundFadeAlpha);
gl_Position = vec4(position.xy, 1.0, 1.0);
}`),r.code.add(A`void main() {
gl_FragColor = color;
}`);else{e.include(mH,i),e.attributes.add(S.POSITION,"vec3"),e.varyings.add("vtc","vec2"),e.varyings.add("falloff","float");const n=i.geometry===su.Cylinder;t.uniforms.add([new Ys("proj",(o,l)=>l.camera.projectionMatrix),new Ys("view",(o,l)=>l.camera.viewMatrix)]),n||(e.varyings.add("innerFactor","float"),t.uniforms.add(new Ps("silCircleCenter",o=>o.silhouette.center)),t.uniforms.add(new Ps("silCircleV1",o=>o.silhouette.v1)),t.uniforms.add(new Ps("silCircleV2",o=>o.silhouette.v2)),t.uniforms.add(new Zs("texV",o=>o.texV)),t.uniforms.add(new Pt("innerScale",o=>o.innerScale)));const s=6.2831853,a=1/128;t.code.add(A`
		void main(void) {
      ${n?A`
      vec3 pos = position;
      float ndotl = mainLightDirection.z;
      vtc = vec2(0.0, position.z + 0.05);`:A`
      innerFactor = clamp(-position.z, 0.0, 1.0);
      float scale = position.y * (1.0 + innerFactor * innerScale);
      float phi = position.x * ${A.float(s*a)} + 1.0;
      vec3 pos =  (silCircleCenter + sin(phi) * silCircleV1 + cos(phi) * silCircleV2) * scale;
      float ndotl = dot(normalize(position.y > 0.0 ? pos: silCircleCenter), mainLightDirection);
      vtc.x = position.x  * ${A.float(a)};
      vtc.y = texV.x * (1.0 - position.z) + texV.y * position.z;
      `}
      falloff = max(0.0, smoothstep(-1.0, 0.8, 2.0 * ndotl));

		  gl_Position = transformPosition(proj, view, pos);
		  gl_Position.z = gl_Position.w; // project atmosphere onto the far plane
    }
	  `),r.uniforms.add(new Ht("tex",o=>o.texture)),n||r.uniforms.add(new Pt("altitudeFade",o=>o.altitudeFade)),r.code.add(A`
		void main() {
			vec4 atmosphereColor = texture2D(tex, vtc) * falloff;
      ${n?A`gl_FragColor = atmosphereColor;`:A`
			vec4 innerColor = vec4(atmosphereColor.rgb, 1.0 - altitudeFade);
			gl_FragColor = mix(atmosphereColor, innerColor, smoothstep(0.0, 1.0, innerFactor));
      `}
    }`)}return e}const cve=Object.freeze(Object.defineProperty({__proto__:null,SimpleAtmospherePassParameters:ZN,SilhouetteCircle:dZ,build:lve},Symbol.toStringTag,{value:"Module"}));let j2=class pZ extends ii{initializeProgram(e){return new ei(e.rctx,pZ.shader.get().build(this.configuration),oi)}initializePipeline(){return this.configuration.geometry===su.Cylinder?it({blending:Gn(me.SRC_ALPHA,me.ONE,me.ONE_MINUS_SRC_ALPHA,me.ONE_MINUS_SRC_ALPHA),culling:jG,depthTest:{func:hs.LEQUAL},colorWrite:gt}):it({blending:Gn(me.SRC_ALPHA,me.ONE,me.ONE_MINUS_SRC_ALPHA,me.ONE_MINUS_SRC_ALPHA),depthTest:{func:hs.LEQUAL},colorWrite:gt})}};j2.shader=new ri(cve,()=>j(()=>import("./SimpleAtmosphere.glsl-4294eec5.js"),["assets/SimpleAtmosphere.glsl-4294eec5.js","assets/vec2f64-30dc1443.js","assets/vec3f64-2f9cef06.js","assets/Matrix3PassUniform-ad9f953b.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/mat3f64-c6305894.js","assets/mat4f64-1e28eae0.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/vec2-528adfe4.js","assets/common-c186b691.js","assets/Texture2DPassUniform-753de459.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/sphere-2af0d852.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));const mZ=new Uint8ClampedArray([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,2,0,0,0,2,0,0,0,2,0,0,0,2,0,0,0,2,0,0,0,2,0,0,0,3,0,0,0,3,0,0,0,3,0,0,0,3,0,0,0,3,0,0,0,4,0,0,0,4,0,0,0,4,0,0,0,4,0,0,0,4,0,0,0,4,0,0,0,5,0,0,0,5,0,0,0,5,0,0,0,5,0,0,0,5,0,0,0,6,0,0,0,6,0,0,0,6,0,0,0,6,0,0,0,6,0,0,0,7,0,0,0,7,0,0,0,7,0,0,0,7,0,0,0,7,0,0,0,8,0,0,0,8,0,0,0,8,0,0,0,8,0,0,0,8,0,0,0,9,0,0,0,9,0,0,0,9,0,0,0,9,0,0,0,9,0,0,0,10,0,0,0,10,0,0,0,10,0,0,0,10,0,0,0,11,0,0,0,11,0,0,0,11,0,0,0,11,0,0,0,11,0,0,0,12,0,0,0,12,0,0,0,12,0,0,0,12,0,0,0,13,0,0,0,13,0,0,0,13,0,0,0,13,0,0,0,14,0,0,0,14,0,0,0,14,0,0,0,14,0,0,0,15,0,0,0,15,0,0,0,15,0,0,0,15,0,0,0,15,16,0,0,16,16,0,0,16,16,0,0,16,16,0,0,16,15,0,0,17,15,0,0,17,15,0,0,17,15,0,0,17,14,0,0,18,14,0,0,18,14,0,0,18,13,0,0,19,13,0,0,19,13,0,0,19,13,0,0,19,13,0,0,20,13,0,0,20,13,0,0,20,13,0,0,20,12,0,0,21,12,0,0,21,12,0,0,21,12,0,0,21,12,0,0,22,12,0,0,22,12,0,0,22,12,0,0,22,11,0,0,23,11,0,0,23,11,0,0,23,11,0,0,24,11,0,0,24,11,0,0,24,11,0,0,24,10,0,0,25,10,0,0,25,10,0,0,25,10,0,0,26,10,0,0,26,10,0,0,26,10,0,0,26,9,0,0,27,9,0,0,27,9,0,0,27,18,0,0,28,18,0,0,28,18,0,0,28,18,0,0,28,18,0,0,29,18,0,0,29,18,0,0,29,17,0,0,30,17,0,0,30,17,0,0,30,17,0,0,30,16,0,0,31,16,0,0,31,16,0,0,31,16,0,0,32,16,0,0,32,16,0,0,32,15,0,0,33,15,0,0,33,15,0,0,33,15,0,0,34,15,8,0,34,15,8,0,34,15,8,0,34,15,7,0,35,15,7,0,35,15,7,0,35,21,7,0,36,21,7,0,36,21,7,0,36,21,7,0,37,21,7,0,37,21,7,0,37,20,7,0,38,20,7,0,38,20,7,0,38,20,7,0,39,20,7,0,39,20,7,0,39,20,7,0,39,19,6,0,40,19,6,0,40,19,6,0,40,19,6,0,41,19,6,0,41,19,6,0,41,18,6,0,42,18,6,0,42,18,6,0,42,24,6,0,43,24,6,0,43,24,6,0,43,23,6,0,44,23,6,0,44,23,6,0,44,23,6,0,45,23,6,0,45,23,6,0,45,22,6,0,46,22,6,0,46,22,6,0,46,22,5,0,47,22,5,0,47,22,5,0,47,21,5,0,48,21,5,0,48,21,5,0,48,21,5,0,49,21,5,0,49,26,5,0,49,25,5,0,50,25,5,0,50,25,5,0,50,25,5,0,51,25,5,0,51,25,5,0,51,25,5,0,52,25,5,0,52,25,5,0,52,24,5,0,53,24,5,0,53,24,5,0,53,24,9,0,54,28,9,0,54,28,9,0,54,28,9,0,55,28,9,0,55,27,9,0,56,27,9,0,56,27,9,0,56,27,9,4,57,27,9,4,57,27,9,4,57,26,9,4,58,26,9,4,58,26,9,4,58,26,9,4,59,26,9,4,59,26,9,4,59,26,8,4,60,30,8,4,60,30,8,4,60,29,8,4,61,29,8,4,61,29,8,4,62,29,8,4,62,29,8,4,62,28,8,4,63,28,8,4,63,28,8,4,63,28,12,4,64,28,12,4,64,28,12,4,64,27,12,4,65,27,12,8,65,27,12,8,65,31,12,8,66,31,12,8,66,30,11,8,67,30,11,8,67,30,11,8,67,30,11,8,68,30,11,8,68,30,11,8,68,30,15,7,69,30,15,7,69,30,15,7,69,33,15,11,70,33,15,11,70,32,14,11,71,32,14,11,71,32,14,11,71,32,18,14,72,32,18,14,72,32,18,14,72,31,17,14,73,35,17,14,73,34,17,17,74,34,21,17,74,34,21,17,74,34,20,17,75,34,20,20,75,34,20,20,75,34,23,20,76,34,23,20,76,36,23,23,77,36,23,23,77,36,23,23,77,36,23,23,78,36,26,26,78,36,26,26,78,36,26,26,79,36,26,29,79,38,26,29,80,38,29,29,80,38,29,29,80,38,28,31,81,38,28,31,81,38,31,31,81,37,31,34,82,37,31,34,82,37,31,37,83,40,34,37,83,40,34,37,83,39,33,39,84,39,33,39,84,39,36,42,84,39,36,42,85,39,36,42,85,39,36,42,85,39,39,44,86,39,39,44,86,41,38,47,87,41,41,47,87,41,41,50,87,41,41,49,88,41,41,52,88,40,43,52,89,43,43,52,89,43,43,54,89,42,45,54,90,42,45,57,90,42,45,57,90,42,45,59,91,42,48,59,91,44,47,61,92,44,47,61,92,44,50,61,92,44,49,63,93,44,49,63,93,44,52,66,93,43,52,65,94,46,54,68,94,46,54,70,95,46,54,70,95,46,54,70,95,45,56,72,96,45,56,72,96,45,58,74,97,47,58,76,97,47,58,76,97,47,60,78,98,47,60,78,98,47,60,81,98,49,62,80,99,49,62,82,99,48,61,84,100,48,64,84,100,48,64,84,100,50,63,86,101,50,66,86,101,50,66,88,101,50,65,90,102,52,67,89,103,51,69,91,104,51,68,92,105,52,69,93,107,52,71,94,108,54,70,96,109,53,71,96,111,52,73,98,112,54,72,98,114,53,73,100,115,54,72,100,117,54,73,102,118,55,74,104,120,55,76,105,121,56,77,106,123,56,76,107,124,57,79,107,126,58,78,110,128,57,79,111,129,56,80,113,131,58,79,112,132,57,82,114,134,58,81,116,136,60,82,117,137,59,83,117,139,60,83,119,141,59,84,120,142,60,85,122,144,59,86,122,146,60,86,126,148,62,87,127,149,61,88,127,151,62,88,128,153,63,89,130,155,62,90,131,156,63,90,132,158,64,91,134,160,65,91,135,162,64,92,136,163,63,93,138,165,66,95,139,167,65,95,140,169,66,95,142,171,67,96,142,172,66,97,144,174,67,99,145,176,67,97,148,178,67,99,147,180,68,100,149,181,68,100,150,183,69,101,152,185,70,102,153,187,71,103,155,188,70,103,156,190,70,104,157,192,71,105,158,194,71,106,160,195,72,106,161,197,72,108,161,199,73,108,163,200,73,109,164,202,74,109,165,204,74,110,167,206,75,111,168,207,74,112,170,209,75,112,170,210,76,113,171,212,76,114,173,214,77,115,174,215,78,115,175,217,78,116,175,218,78,117,177,220,78,118,178,221,79,118,180,223,80,120,180,224,81,120,181,226,81,120,182,227,82,121,184,229,82,122,185,230,84,123,186,232,83,123,187,233,84,124,189,234,84,125,188,235,85,126,189,237,86,126,190,238,86,127,191,239,87,127,192,240,87,129,193,242,88,129,194,243,89,130,195,244,90,131,196,245,90,132,197,246,91,132,197,247,92,133,198,248,92,134,199,249,93,135,200,250,94,136,201,251,95,137,202,252,96,138,203,253,97,140,204,254,98,141,205,254,99,142,206,255,101,143,207,255,102,144,208,255,103,146,209,255,104,147,209,255,106,148,210,255,107,149,211,255,108,151,212,255,110,152,213,255,111,153,213,255,112,154,214,255,114,156,215,255,115,157,215,255,117,158,216,255,118,160,217,255,120,161,217,255,121,162,218,255,123,164,218,255,124,165,219,255,125,166,219,255,127,167,220,255,129,169,220,255,130,170,221,255,132,171,221,255,133,173,222,255,134,174,222,255,136,175,223,255,139,178,224,255,142,180,224,255,144,182,225,255,147,185,226,255,150,187,226,255,153,189,227,255,155,191,228,255,158,194,228,255,160,196,229,255,163,198,229,255,165,200,230,255,168,202,231,255,170,203,231,255,172,205,232,255,174,207,232,255,176,209,233,255,178,210,234,255,180,212,234,255,182,214,235,255,184,215,236,255,186,217,237,255,188,219,238,255,190,220,238,255,192,221,239,255,193,222,240,255,194,224,240,255,196,225,241,255,197,226,241,255,198,226,242,255,199,227,242,255,200,228,242,255,201,228,243,255,202,229,243,255,203,230,243,255,204,230,244,255,205,231,244,255,207,232,244,255,208,233,245,255,209,233,245,255,211,234,246,255,213,235,246,255,217,238,247,255,222,240,248,255,226,242,249,255,231,245,250,255,236,247,251,255,241,249,252,255,245,251,253,255,249,252,254,255,255,255,255,255]);var F3;(function(i){function e(a,o){const l=a[o],c=a[o+1],u=a[o+2];return Math.sqrt(l*l+c*c+u*u)}function t(a,o){const l=a[o],c=a[o+1],u=a[o+2],d=1/Math.sqrt(l*l+c*c+u*u);a[o]*=d,a[o+1]*=d,a[o+2]*=d}function r(a,o,l){a[o]*=l,a[o+1]*=l,a[o+2]*=l}function n(a,o,l,c,u,d=o){(u=u||a)[d]=a[o]+l[c],u[d+1]=a[o+1]+l[c+1],u[d+2]=a[o+2]+l[c+2]}function s(a,o,l,c,u,d=o){(u=u||a)[d]=a[o]-l[c],u[d+1]=a[o+1]-l[c+1],u[d+2]=a[o+2]-l[c+2]}i.length=e,i.normalize=t,i.scale=r,i.add=n,i.subtract=s})(F3||(F3={}));const M_=F3;var N3,k3,V3;(function(i){const t=[[-.5,-.5,.5],[.5,-.5,.5],[.5,.5,.5],[-.5,.5,.5],[-.5,-.5,-.5],[.5,-.5,-.5],[.5,.5,-.5],[-.5,.5,-.5]],r=[0,0,1,-1,0,0,1,0,0,0,-1,0,0,1,0,0,0,-1],n=[0,0,1,0,1,1,0,1],s=[0,1,2,2,3,0,4,0,3,3,7,4,1,5,6,6,2,1,1,0,4,4,5,1,3,2,6,6,7,3,5,4,7,7,6,5],a=new Array(36);for(let c=0;c<6;c++)for(let u=0;u<6;u++)a[6*c+u]=c;const o=new Array(36);for(let c=0;c<6;c++)o[6*c+0]=0,o[6*c+1]=1,o[6*c+2]=2,o[6*c+3]=2,o[6*c+4]=3,o[6*c+5]=0;function l(c){Array.isArray(c)||(c=[c,c,c]);const u=new Array(24);for(let d=0;d<8;d++)u[3*d]=t[d][0]*c[0],u[3*d+1]=t[d][1]*c[1],u[3*d+2]=t[d][2]*c[2];return new jr([[S.POSITION,{size:3,data:u,exclusive:!0}],[S.NORMAL,{size:3,data:r}],[S.UV0,{size:2,data:n}]],[[S.POSITION,s],[S.NORMAL,a],[S.UV0,o]])}i.createGeometry=l})(N3||(N3={})),function(i){const t=[[-.5,0,-.5],[.5,0,-.5],[.5,0,.5],[-.5,0,.5],[0,-.5,0],[0,.5,0]],r=[0,1,-1,1,1,0,0,1,1,-1,1,0,0,-1,-1,1,-1,0,0,-1,1,-1,-1,0],n=[5,1,0,5,2,1,5,3,2,5,0,3,4,0,1,4,1,2,4,2,3,4,3,0],s=[0,0,0,1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6,7,7,7];function a(o){Array.isArray(o)||(o=[o,o,o]);const l=new Array(18);for(let c=0;c<6;c++)l[3*c]=t[c][0]*o[0],l[3*c+1]=t[c][1]*o[1],l[3*c+2]=t[c][2]*o[2];return new jr([[S.POSITION,{size:3,data:l,exclusive:!0}],[S.NORMAL,{size:3,data:r}]],[[S.POSITION,n],[S.NORMAL,s]])}i.createGeometry=a}(k3||(k3={})),function(i){const r=_i(-.5,0,-.5),n=_i(.5,0,-.5),s=_i(0,0,.5),a=_i(0,0+.5,0),o=Xi(),l=Xi(),c=Xi(),u=Xi(),d=Xi();ae(o,r,a),ae(l,r,n),ut(c,o,l),de(c,c),ae(o,n,a),ae(l,n,s),ut(u,o,l),de(u,u),ae(o,s,a),ae(l,s,r),ut(d,o,l),de(d,d);const m=[r,n,s,a],f=[0,-1,0,c[0],c[1],c[2],u[0],u[1],u[2],d[0],d[1],d[2]],_=[0,1,2,3,1,0,3,2,1,3,0,2],g=[0,0,0,1,1,1,2,2,2,3,3,3];function w(v){Array.isArray(v)||(v=[v,v,v]);const b=new Array(12);for(let x=0;x<4;x++)b[3*x]=m[x][0]*v[0],b[3*x+1]=m[x][1]*v[1],b[3*x+2]=m[x][2]*v[2];return new jr([[S.POSITION,{size:3,data:b,exclusive:!0}],[S.NORMAL,{size:3,data:f}]],[[S.POSITION,_],[S.NORMAL,g]])}i.createGeometry=w}(V3||(V3={}));const hve=N3.createGeometry,uve=k3.createGeometry,dve=V3.createGeometry;function x6e(i,e,t,r={uv:!0}){const n=-Math.PI,s=2*Math.PI,a=-Math.PI/2,o=Math.PI,l=Math.max(3,Math.floor(e)),c=Math.max(2,Math.floor(t)),u=(l+1)*(c+1),d=new Float32Array(3*u),m=new Float32Array(3*u),f=new Float32Array(2*u),_=[];let g=0;for(let x=0;x<=c;x++){const T=[],R=x/c,E=a+R*o,O=Math.cos(E);for(let $=0;$<=l;$++){const D=$/l,I=n+D*s,G=Math.cos(I)*O,W=Math.sin(E),re=-Math.sin(I)*O;d[3*g]=G*i,d[3*g+1]=W*i,d[3*g+2]=re*i,m[3*g]=G,m[3*g+1]=W,m[3*g+2]=re,f[2*g]=D,f[2*g+1]=R,T.push(g),++g}_.push(T)}const w=new Array;for(let x=0;x<c;x++)for(let T=0;T<l;T++){const R=_[x][T],E=_[x][T+1],O=_[x+1][T+1],$=_[x+1][T];x===0?(w.push(R),w.push(O),w.push($)):x===c-1?(w.push(R),w.push(E),w.push(O)):(w.push(R),w.push(E),w.push(O),w.push(O),w.push($),w.push(R))}const v=[[S.POSITION,w],[S.NORMAL,w]],b=[[S.POSITION,{size:3,data:d,exclusive:!0}],[S.NORMAL,{size:3,data:m,exclusive:!0}]];return r.uv&&(b.push([S.UV0,{size:2,data:f,exclusive:!0}]),v.push([S.UV0,w])),r.offset&&(v[0][0]=S.OFFSET,b[0][0]=S.OFFSET,v.push([S.POSITION,new Array(w.length).fill(0)]),b.push([S.POSITION,{size:3,data:Float64Array.from(r.offset),exclusive:!0}])),new jr(b,v)}function fZ(i,e,t){const r=i;let n,s;if(t)n=[0,-1,0,1,0,0,0,0,1,-1,0,0,0,0,-1,0,1,0],s=[0,1,2,0,2,3,0,3,4,0,4,1,1,5,2,2,5,3,3,5,4,4,5,1];else{const d=r*(1+Math.sqrt(5))/2;n=[-r,d,0,r,d,0,-r,-d,0,r,-d,0,0,-r,d,0,r,d,0,-r,-d,0,r,-d,d,0,-r,d,0,r,-d,0,-r,-d,0,r],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1]}for(let d=0;d<n.length;d+=3)M_.scale(n,d,i/M_.length(n,d));let a={};function o(d,m){d>m&&([d,m]=[m,d]);const f=d.toString()+"."+m.toString();if(a[f])return a[f];let _=n.length;return n.length+=3,M_.add(n,3*d,n,3*m,n,_),M_.scale(n,_,i/M_.length(n,_)),_/=3,a[f]=_,_}for(let d=0;d<e;d++){const m=s.length,f=new Array(4*m);for(let _=0;_<m;_+=3){const g=s[_],w=s[_+1],v=s[_+2],b=o(g,w),x=o(w,v),T=o(v,g),R=4*_;f[R]=g,f[R+1]=b,f[R+2]=T,f[R+3]=w,f[R+4]=x,f[R+5]=b,f[R+6]=v,f[R+7]=T,f[R+8]=x,f[R+9]=b,f[R+10]=x,f[R+11]=T}s=f,a={}}const l=new Float32Array(n);for(let d=0;d<l.length;d+=3)M_.normalize(l,d);const c=[[S.POSITION,s],[S.NORMAL,s]],u=[[S.POSITION,{size:3,data:new Float32Array(n),exclusive:!0}],[S.NORMAL,{size:3,data:l,exclusive:!0}]];return new jr(u,c)}function U3(i,e,t,r,n,s,a,o){const l=e?[e[0],e[1],e[2]]:[0,0,0],c=i?[i[0],i[1],i[2]]:[0,0,1];s=s||[0,0];const u=t?[255*t[0],255*t[1],255*t[2],t.length>3?255*t[3]:255]:[255,255,255,255],d=r!=null&&r.length===2?r:[1,1],m=[[S.POSITION,{size:3,data:l,exclusive:!0}],[S.NORMAL,{size:3,data:c,exclusive:!0}],[S.UV0,{size:s.length,data:s}],[S.COLOR,{size:4,data:u,exclusive:!0}],[S.SIZE,{size:2,data:d}]];if(n!=null){const f=new Float32Array([n[0],n[1],n[2],n[3]]);m.push([S.AUXPOS1,{size:4,data:f}])}if(a!=null){const f=new Float32Array([a[0],a[1],a[2],a[3]]);m.push([S.AUXPOS2,{size:4,data:f}])}return new jr(m,null,Fc.Point,o)}const pve=[[-1,-1,0],[1,-1,0],[1,1,0],[-1,1,0]];function T6e(i=pve){const e=new Array(12);for(let c=0;c<4;c++)for(let u=0;u<3;u++)e[3*c+u]=i[c][u];const t=[0,1,2,2,3,0],r=[0,0,1],n=[0,0,0,0,0,0],s=[0,0,1,0,1,1,0,1],a=[255,255,255,255],o=[[S.POSITION,t],[S.NORMAL,n],[S.UV0,t],[S.COLOR,n]],l=[[S.POSITION,{size:3,data:e,exclusive:!0}],[S.NORMAL,{size:3,data:r,exclusive:!0}],[S.UV0,{size:2,data:s,exclusive:!0}],[S.COLOR,{size:4,data:a,exclusive:!0}]];return new jr(l,o)}function U6(i,e,t,r,n=!0,s=!0){let a=0;const o=e,l=i;let c=_i(0,a,0),u=_i(0,a+l,0),d=_i(0,-1,0),m=_i(0,1,0);r&&(a=l,u=_i(0,0,0),c=_i(0,a,0),d=_i(0,1,0),m=_i(0,-1,0));const f=[u,c],_=[d,m],g=t+2,w=Math.sqrt(l*l+o*o);if(r)for(let O=t-1;O>=0;O--){const $=O*(2*Math.PI/t),D=_i(Math.cos($)*o,a,Math.sin($)*o);f.push(D);const I=_i(l*Math.cos($)/w,-o/w,l*Math.sin($)/w);_.push(I)}else for(let O=0;O<t;O++){const $=O*(2*Math.PI/t),D=_i(Math.cos($)*o,a,Math.sin($)*o);f.push(D);const I=_i(l*Math.cos($)/w,o/w,l*Math.sin($)/w);_.push(I)}const v=new Array,b=new Array;if(n){for(let O=3;O<f.length;O++)v.push(1),v.push(O-1),v.push(O),b.push(0),b.push(0),b.push(0);v.push(f.length-1),v.push(2),v.push(1),b.push(0),b.push(0),b.push(0)}if(s){for(let O=3;O<f.length;O++)v.push(O),v.push(O-1),v.push(0),b.push(O),b.push(O-1),b.push(1);v.push(0),v.push(2),v.push(f.length-1),b.push(1),b.push(2),b.push(_.length-1)}const x=new Float32Array(3*g);for(let O=0;O<g;O++)x[3*O]=f[O][0],x[3*O+1]=f[O][1],x[3*O+2]=f[O][2];const T=new Float32Array(3*g);for(let O=0;O<g;O++)T[3*O]=_[O][0],T[3*O+1]=_[O][1],T[3*O+2]=_[O][2];const R=[[S.POSITION,v],[S.NORMAL,b]],E=[[S.POSITION,{size:3,data:x,exclusive:!0}],[S.NORMAL,{size:3,data:T,exclusive:!0}]];return new jr(E,R)}function mve(i,e,t,r,n,s){const a=r?Y5(r):_i(1,0,0),o=n?Y5(n):_i(0,0,0);s=s??!0;const l=Xi();de(l,a);const c=Xi();Q(c,l,Math.abs(i));const u=Xi();Q(u,c,-.5),ce(u,u,o);const d=_i(0,1,0);Math.abs(1-_e(l,d))<.2&&Y(d,0,0,1);const m=Xi();ut(m,l,d),de(m,m),ut(d,m,l);const f=2*t+(s?2:0),_=t+(s?2:0),g=new Float32Array(3*f),w=new Float32Array(3*_),v=new Float32Array(2*f),b=new Array(3*t*(s?4:2)),x=new Array(3*t*(s?4:2));s&&(g[3*(f-2)+0]=u[0],g[3*(f-2)+1]=u[1],g[3*(f-2)+2]=u[2],v[2*(f-2)]=0,v[2*(f-2)+1]=0,g[3*(f-1)+0]=g[3*(f-2)+0]+c[0],g[3*(f-1)+1]=g[3*(f-2)+1]+c[1],g[3*(f-1)+2]=g[3*(f-2)+2]+c[2],v[2*(f-1)]=1,v[2*(f-1)+1]=1,w[3*(_-2)+0]=-l[0],w[3*(_-2)+1]=-l[1],w[3*(_-2)+2]=-l[2],w[3*(_-1)+0]=l[0],w[3*(_-1)+1]=l[1],w[3*(_-1)+2]=l[2]);const T=(I,G,W)=>{b[I]=G,x[I]=W};let R=0;const E=Xi(),O=Xi();for(let I=0;I<t;I++){const G=I*(2*Math.PI/t);Q(E,d,Math.sin(G)),Q(O,m,Math.cos(G)),ce(E,E,O),w[3*I+0]=E[0],w[3*I+1]=E[1],w[3*I+2]=E[2],Q(E,E,e),ce(E,E,u),g[3*I+0]=E[0],g[3*I+1]=E[1],g[3*I+2]=E[2],v[2*I+0]=I/t,v[2*I+1]=0,g[3*(I+t)+0]=g[3*I+0]+c[0],g[3*(I+t)+1]=g[3*I+1]+c[1],g[3*(I+t)+2]=g[3*I+2]+c[2],v[2*(I+t)+0]=I/t,v[2*I+1]=1;const W=(I+1)%t;T(R++,I,I),T(R++,I+t,I),T(R++,W,W),T(R++,W,W),T(R++,I+t,I),T(R++,W+t,W)}if(s){for(let I=0;I<t;I++){const G=(I+1)%t;T(R++,f-2,_-2),T(R++,I,_-2),T(R++,G,_-2)}for(let I=0;I<t;I++){const G=(I+1)%t;T(R++,I+t,_-1),T(R++,f-1,_-1),T(R++,G+t,_-1)}}const $=[[S.POSITION,b],[S.NORMAL,x],[S.UV0,b]],D=[[S.POSITION,{size:3,data:g,exclusive:!0}],[S.NORMAL,{size:3,data:w,exclusive:!0}],[S.UV0,{size:2,data:v,exclusive:!0}]];return new jr(D,$)}function C6e(i,e,t,r,n,s=_i(0,0,0)){const a=i.length,o=new Float32Array(e.length*a*3+(6*t.length||0)),l=new Float32Array(e.length*a*3+(t?6:0)),c=new Array,u=new Array;let d=0,m=0;const f=Xi(),_=Xi(),g=Xi(),w=Xi(),v=Xi(),b=Xi(),x=Xi(),T=P(),R=Xi(),E=Xi(),O=Xi(),$=Xi(),D=Xi(),I=fr();Y(R,0,1,0),ae(_,e[1],e[0]),de(_,_),n?(ce(T,e[0],s),de(g,T)):Y(g,0,0,1),q2(_,g,R,R,v,g,z6),X(w,g),X($,v);for(let L=0;L<t.length;L++)Q(b,v,t[L][0]),Q(T,g,t[L][2]),ce(b,b,T),ce(b,b,e[0]),o[d++]=b[0],o[d++]=b[1],o[d++]=b[2];l[m++]=-_[0],l[m++]=-_[1],l[m++]=-_[2];for(let L=0;L<r.length;L++)c.push(r[L][0]>0?r[L][0]:-r[L][0]-1+t.length),c.push(r[L][1]>0?r[L][1]:-r[L][1]-1+t.length),c.push(r[L][2]>0?r[L][2]:-r[L][2]-1+t.length),u.push(0),u.push(0),u.push(0);let G=t.length;const W=t.length-1;for(let L=0;L<e.length;L++){let z=!1;L>0&&(X(f,_),L<e.length-1?(ae(_,e[L+1],e[L]),de(_,_)):z=!0,ce(E,f,_),de(E,E),ce(O,e[L-1],w),Ew(e[L],E,I),e_(I,zc(O,f),T)?(ae(T,T,e[L]),de(g,T),ut(v,E,g),de(v,v)):q2(E,w,$,R,v,g,z6),X(w,g),X($,v)),n&&(ce(T,e[L],s),de(D,T));for(let q=0;q<a;q++)if(Q(b,v,i[q][0]),Q(T,g,i[q][1]),ce(b,b,T),de(x,b),l[m++]=x[0],l[m++]=x[1],l[m++]=x[2],ce(b,b,e[L]),o[d++]=b[0],o[d++]=b[1],o[d++]=b[2],!z){const K=(q+1)%a;c.push(G+q),c.push(G+a+q),c.push(G+K),c.push(G+K),c.push(G+a+q),c.push(G+a+K);for(let ie=0;ie<6;ie++){const Z=c.length-6;u.push(c[Z+ie]-W)}}G+=a}const re=e[e.length-1];for(let L=0;L<t.length;L++)Q(b,v,t[L][0]),Q(T,g,t[L][1]),ce(b,b,T),ce(b,b,re),o[d++]=b[0],o[d++]=b[1],o[d++]=b[2];const te=m/3;l[m++]=_[0],l[m++]=_[1],l[m++]=_[2];const H=G-a;for(let L=0;L<r.length;L++)c.push(r[L][0]>=0?G+r[L][0]:-r[L][0]-1+H),c.push(r[L][2]>=0?G+r[L][2]:-r[L][2]-1+H),c.push(r[L][1]>=0?G+r[L][1]:-r[L][1]-1+H),u.push(te),u.push(te),u.push(te);const M=[[S.POSITION,c],[S.NORMAL,u]],U=[[S.POSITION,{size:3,data:o,exclusive:!0}],[S.NORMAL,{size:3,data:l,exclusive:!0}]];return new jr(U,M)}function S6e(i,e,t){ct(i.length>1,"createPolylineGeometry(): polyline needs at least 2 points"),ct(i[0].length===3,"createPolylineGeometry(): malformed vertex"),ct(e==null||e.length===i.length,"createPolylineGeometry: need same number of points and normals"),ct(e==null||e[0].length===3,"createPolylineGeometry(): malformed normal");const r=new Float64Array(3*i.length),n=new Array(2*(i.length-1));let s=0,a=0;for(let c=0;c<i.length;c++){for(let u=0;u<3;u++)r[s++]=i[c][u];c>0&&(n[a++]=c-1,n[a++]=c)}const o=[],l=[];if(o.push([S.POSITION,n]),l.push([S.POSITION,{size:3,data:r,exclusive:!0}]),e){const c=new Float32Array(3*e.length);let u=0;for(let d=0;d<i.length;d++)for(let m=0;m<3;m++)c[u++]=e[d][m];o.push([S.NORMAL,n]),l.push([S.NORMAL,{size:3,data:c,exclusive:!0}])}return t&&(l.push([S.COLOR,{size:4,data:t}]),o.push([S.COLOR,KD(t.length/4)])),new jr(l,o,Fc.Line)}function E6e(i,e,t,r,n=0){const s=new Array(18),a=[[-e,n,r/2],[t,n,r/2],[0,i+n,r/2],[-e,n,-r/2],[t,n,-r/2],[0,i+n,-r/2]],o=[0,1,2,3,0,2,2,5,3,1,4,5,5,2,1,1,0,3,3,4,1,4,3,5];for(let l=0;l<6;l++)s[3*l]=a[l][0],s[3*l+1]=a[l][1],s[3*l+2]=a[l][2];return new jr([[S.POSITION,{size:3,data:s,exclusive:!0}]],[[S.POSITION,o]])}function fve(i,e=i){const t=i.vertexAttributes,r=t.get(S.POSITION).data,n=t.get(S.NORMAL).data;if(n){const s=e.getMutableAttribute(S.NORMAL).data;for(let a=0;a<n.length;a+=3){const o=n[a+1];s[a+1]=-n[a+2],s[a+2]=o}}if(r){const s=e.getMutableAttribute(S.POSITION).data;for(let a=0;a<r.length;a+=3){const o=r[a+1];s[a+1]=-r[a+2],s[a+2]=o}}return e}function PO(i,e,t,r,n){return!(Math.abs(_e(e,i))>n)&&(ut(t,i,e),de(t,t),ut(r,t,i),de(r,r),!0)}function q2(i,e,t,r,n,s,a){return PO(i,e,n,s,a)||PO(i,t,n,s,a)||PO(i,r,n,s,a)}const z6=.99619469809;let gve=class{constructor(){this.type=In.Panoramic,this._configuration=new H2,this._passParameters=new ZN}destroy(){this._passParameters.texture=ke(this._passParameters.texture),this._vao=ke(this._vao)}initializeRenderContext(e){this._configuration.geometry=su.Cylinder,this._technique=e.shaderTechniqueRepository.acquire(j2,this._configuration);const t=e.renderContext.rctx;this._vao=this._createVertexArrayObject(t),this._vaoCount=Ws(this._vao,"geometry"),this._passParameters.texture=new Gi(t,{pixelFormat:St.RGBA,dataType:Xt.UNSIGNED_BYTE,wrapMode:ai.CLAMP_TO_EDGE,samplingMode:Jt.LINEAR,flipped:!0,width:1,height:512},mZ),e.requestRender()}render(e){if(C(this._vao)||C(this._passParameters.texture))return;const t=e.rctx,r=t.bindTechnique(this._technique,this._passParameters,e.bindParameters);_ve(B6,e.bindParameters.camera.viewMatrix),r.setUniformMatrix4fv("view",B6),t.bindVAO(this._vao),r.assertCompatibleVertexAttributeLocations(this._vao),t.drawArrays(kt.TRIANGLES,0,this._vaoCount)}renderHaze(){return!1}_createVertexArrayObject(e){const t=fZ(1,2,!1),r=t.indices.get(S.POSITION);for(let o=0;o<r.length;o+=3){const l=r[o];r[o]=r[o+2],r[o+2]=l}const n=t.vertexAttributes.get(S.POSITION).data,s=G6.createBuffer(r.length),a=s.position;for(let o=0;o<r.length;++o){const l=3*r[o];a.set(o,0,n[l]),a.set(o,1,n[l+1]),a.set(o,2,n[l+2])}return new nu(e,oi,{geometry:Wc(G6)},{geometry:ui.createVertex(e,mi.STATIC_DRAW,s.buffer)})}};function _ve(i,e){pn(i,e),i[12]=0,i[13]=0,i[14]=0,i[15]=1}const B6=xe(),G6=sn().vec3f(S.POSITION);var Ld;(function(i){i[i.Rain=0]="Rain",i[i.Snow=1]="Snow",i[i.COUNT=2]="COUNT"})(Ld||(Ld={}));let z3=class extends $a{constructor(){super(...arguments),this.type=Ld.Rain}};h([k({count:Ld.COUNT})],z3.prototype,"type",void 0);function yve(i){const e=new Yi;return e.attributes.add(S.POSITION,"vec3"),e.attributes.add(S.INSTANCEFEATUREATTRIBUTE,"float"),e.vertex.uniforms.add(new Ps("cameraPosition",(t,r)=>r.camera.eye)),e.vertex.uniforms.add(new Ps("offset",(t,r)=>vve(t,r))),e.vertex.uniforms.add(new Pt("width",t=>t.width)),e.vertex.uniforms.add(new Ys("proj",(t,r)=>r.camera.projectionMatrix)),e.vertex.uniforms.add(new Ys("view",(t,r)=>r.camera.viewMatrix)),e.vertex.uniforms.add(new Pt("time",t=>t.time)),e.varyings.add("vUv","vec2"),e.vertex.code.add(A`
    vec3 hash31(float p){
      vec3 p3 = fract(vec3(p) * vec3(0.1031, 0.1030, 0.0973));
      p3 += dot(p3, p3.yzx + 33.33);
      return fract((p3.xxy + p3.yzz) * p3.zyx);
    }

    float hash11(float p){
      p = fract(p * 0.1031);
      p *= p + 33.33;
      p *= p + p;
      return fract(p);
    }

    //https://www.geeks3d.com/20141201/how-to-rotate-a-vertex-by-a-quaternion-in-glsl/
    vec3 rotateVectorByQuaternion(vec3 v, vec4 q){
      return 2.0 * cross(q.xyz, v * q.w + cross(q.xyz, v)) + v;
    }

    void main(void) {

      vUv = position.xz;

      vec3 rand = hash31(instanceFeatureAttribute);

      // Set random position for all particles
      // The hash function space is not high resolution so offset particles by an additional random value
      // This creates grids of 1000 particles which are shifted by random hundreths of the tile width
      // overlaying multiple identical but offset grids
      vec3 randomPosition = 2.0 * (rand + (0.01 + 0.01 * rand) * floor(0.001 * instanceFeatureAttribute)) - 1.0;

      // Random orientation of rain drops
      float angle = 3.1415 * hash11(instanceFeatureAttribute);

      vec3 up = vec3(0, 0, 1);

      // Gravity and wind direction
      vec3 direction = normalize(cameraPosition);

      vec3 tangent = normalize(cross(direction, up));

      // Gravity
      vec3 animatedPos = randomPosition + direction * -time;

      // Rain particles fall straight down and are randomly oriented
      // Snow particles have random sinusoid trajectories and are rotated to face the camera
      ${i.type===Ld.Rain?A`
            // Random rotation for particle
            vec3 rotationAxis = up;
            vec4 quat = vec4(rotationAxis * sin(angle), cos(angle));
            vec3 transformedPos = rotateVectorByQuaternion(vec3(0.2, 0.2, 4.0) * (position - vec3(0.5, 0.0, 0.5)), quat);

            // Rotate particle to planetary position
            rotationAxis = tangent;
            angle = 0.5 * -acos(dot(direction, up));
            quat = vec4(rotationAxis * sin(angle), cos(angle));
            transformedPos = rotateVectorByQuaternion(transformedPos, quat);

            vec4 pos = mat4(mat3(view)) * vec4(transformedPos + (mod(width * animatedPos - offset, width) - 0.5 * width), 1.0);
            gl_Position = proj * pos;
      `:A`
            vec3 rotationAxis = direction;
            vec4 quat = vec4(rotationAxis * sin(angle), cos(angle));

            tangent = rotateVectorByQuaternion(tangent, quat);
            // Random sinusoid from friction
            animatedPos += tangent * 0.25 * sin(dot(animatedPos, direction));
            vec4 pos = mat4(mat3(view)) * vec4((mod(width * animatedPos - offset, width) - 0.5 * width), 1.0);
            gl_Position = proj * (0.5 * vec4(position.xzy, 0.0) + pos);
      `}
    }
  `),e.fragment.uniforms.add([new Pt("opacity",t=>t.opacity),new Ps("particleColor",(t,r)=>bve(r,i))]),e.fragment.code.add(A`
    void main() {

      // Cut off corners of the triangle
      if(vUv.x < 0.0 || vUv.y < 0.0){
        discard;
      }

      float d = length(vUv - vec2(0.5));

      ${i.type===Ld.Rain?A`d = 0.35 * smoothstep(0.5, 0.0, d);`:A`d = smoothstep(0.5, 0.1, d);`}
      gl_FragColor = opacity * vec4(particleColor * d, d);
    }
  `),e}function vve(i,e){const t=e.camera.eye,r=.5*i.width,n=1/i.width,s=Cre(B3,Y(B3,(t[0]+r)*n,(t[1]+r)*n,(t[2]+r)*n));return tl(s,t,Q(s,s,i.width))}function bve(i,e){const t=e.type===Ld.Rain?xve:wve,r=Q(B3,t,Tve),n=i.camera.eye;de(H6,n);const s=Math.max(0,_e(H6,i.lighting.mainLight.direction));return Bn(r,r,t,s)}const B3=P(),H6=P(),wve=Ze(1,1,1),xve=Ze(.85,.85,.85),Tve=.7,Cve=Object.freeze(Object.defineProperty({__proto__:null,build:yve},Symbol.toStringTag,{value:"Module"}));let Sve=class extends Ir{constructor(){super(...arguments),this.time=0,this.radius=1,this.width=500,this.opacity=1}},G3=class gZ extends ii{initializeProgram(e){return new ei(e.rctx,gZ.shader.get().build(this.configuration),hE)}initializePipeline(){return it({blending:Gn(me.ONE,me.ONE,me.ONE_MINUS_SRC_ALPHA,me.ONE_MINUS_SRC_ALPHA),depthTest:{func:hs.LEQUAL},colorWrite:gt})}};G3.shader=new ri(Cve,()=>j(()=>import("./Precipitation.glsl-f1ef5e7a.js"),["assets/Precipitation.glsl-f1ef5e7a.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/VertexAttribute-9c5c630d.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));const hE=new Map([[S.POSITION,0],[S.INSTANCEFEATUREATTRIBUTE,1]]);let _Z=class{constructor(){this.enabled=!0,this._time=It(0)}get time(){return this._time}advance(e){return this._time!==e.time&&(this._time=e.time,!0)}},kf=class extends pe{constructor(e){super(e),this._numParticles=25e4,this._rainSpeed=.1,this._snowSpeed=.01,this._passParameters=new Sve,this._animation=new _Z,this._updatingTracking=new _v,this._passParameters.time=0,this._passParameters.radius=Kt(e.view.spatialReference).radius,this._shaderTechniqueRepository=e.context.shaderTechniqueRepository}destroy(){this._updatingTracking.destroy(),this._numParticles=0,this._snowTechniqueCached=Qi(this._snowTechniqueCached),this._rainTechniqueCached=Qi(this._rainTechniqueCached),this._vao=ke(this._vao),this._instanceIdBuffer=ke(this._instanceIdBuffer)}get updating(){return this._updatingTracking.updating}get _rainTechnique(){if(C(this._rainTechniqueCached)){const e=new z3;e.type=Ld.Rain,this._rainTechniqueCached=this._shaderTechniqueRepository.acquire(G3,e)}return this._rainTechniqueCached}get _snowTechnique(){if(C(this._snowTechniqueCached)){const e=new z3;e.type=Ld.Snow,this._snowTechniqueCached=this._shaderTechniqueRepository.acquire(G3,e)}return this._snowTechniqueCached}update(e){return this._animation.advance(e)}render(e,t,r){const n=r==="rainy"?this._rainTechnique:this._snowTechnique;if(!n.compiled)return void this.context.requestRender();const s=e.rctx;if(this._ensureResources(s),C(n)||C(this._vao)||C(this._instanceIdBuffer)||(y(e.bindParameters.cloudsFade.data)&&(this._passParameters.opacity=1-e.bindParameters.cloudsFade.fadeInOutHeight.factor),this._passParameters.opacity<=0))return;const a=.35;t=t<.5?bt(0,a,2*t):bt(a,1,2*(t-.5)),this._passParameters.time=(r==="rainy"?this._rainSpeed:this._snowSpeed)*aD(this._animation.time)%1e5;const o=s.bindTechnique(n,this._passParameters,e.bindParameters);s.bindVAO(this._vao),o.assertCompatibleVertexAttributeLocations(this._vao),aH(s,hE,this._instanceIdBuffer,j6,0),s.capabilities.instancing.drawArraysInstanced(kt.TRIANGLES,0,3,this._numParticles*t),oH(s,hE,this._instanceIdBuffer,j6)}_ensureResources(e){C(this._vao)&&(this._vao=this._createVertexArrayObject(e)),C(this._instanceIdBuffer)&&(this._instanceIdBuffer=this._createInstanceIndices(e))}_createInstanceIndices(e){const t=[];for(let r=0;r<this._numParticles;r++)t.push(r);return ui.createVertex(e,mi.STATIC_DRAW,new Float32Array(t))}_createVertexArrayObject(e){const t=new Float32Array([-1,0,1,1,0,-1,1,0,1]);return new nu(e,hE,{geometry:Wc(Eve)},{geometry:ui.createVertex(e,mi.STATIC_DRAW,t)})}};h([p({constructOnly:!0})],kf.prototype,"context",void 0),h([p({constructOnly:!0})],kf.prototype,"view",void 0),h([p({readOnly:!0})],kf.prototype,"updating",null),h([p()],kf.prototype,"_updatingTracking",void 0),kf=h([F("esri.views.3d.environment.Precipitation")],kf);const Eve=sn().vec3f(S.POSITION),j6=Wc(sn().f32(S.INSTANCEFEATUREATTRIBUTE),1),Rve=new Uint8ClampedArray([0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,2,0,0,0,2,0,0,0,2,0,0,0,2,0,0,0,3,0,0,0,3,0,0,0,3,0,0,0,4,0,0,0,4,0,0,0,4,0,0,0,5,0,0,0,5,0,0,0,5,0,0,0,5,0,0,0,5,0,0,0,5,0,0,0,5,0,0,0,6,0,0,0,6,0,0,0,7,0,0,0,7,0,0,0,7,0,0,0,8,0,0,0,8,0,0,0,8,0,0,0,9,0,0,0,9,0,0,0,9,0,0,0,10,0,0,0,10,0,0,0,11,0,0,0,11,0,0,0,11,0,0,0,12,0,0,0,12,0,0,0,12,0,0,0,13,0,0,0,13,0,0,0,14,0,0,0,14,0,0,0,14,0,0,0,14,0,0,0,14,0,0,0,15,0,0,0,15,0,0,0,16,0,0,0,16,0,0,0,16,0,0,0,17,0,0,0,17,0,0,0,18,0,0,0,18,0,0,0,19,0,0,0,19,0,0,0,19,0,0,0,20,0,0,0,20,0,0,0,21,0,0,0,21,0,0,0,22,0,0,0,22,11,0,0,23,11,0,0,23,11,0,0,23,11,0,0,23,11,0,0,24,11,0,0,24,11,0,0,24,10,0,0,25,10,0,0,25,10,0,0,26,10,0,0,26,9,0,0,27,9,0,0,27,9,0,0,28,9,0,0,28,9,0,0,29,9,0,0,29,8,0,0,30,8,0,0,30,8,0,0,31,8,0,0,31,8,0,0,32,8,0,0,32,8,0,0,32,8,0,0,32,8,0,0,33,8,0,0,33,8,0,0,34,7,0,0,35,7,0,0,35,7,0,0,36,7,0,0,36,7,7,0,37,7,7,0,37,7,7,0,38,7,7,0,38,13,7,0,39,13,7,0,39,13,6,0,40,13,6,0,40,12,6,0,41,12,6,0,41,12,6,0,41,12,6,0,42,12,6,0,42,12,6,0,43,12,6,0,43,12,6,0,44,12,6,0,44,11,6,0,45,11,6,6,45,11,6,6,46,11,5,5,47,11,5,5,47,11,5,5,48,11,5,5,48,10,5,5,49,10,5,5,49,10,5,5,50,15,5,5,51,15,5,5,51,15,5,5,51,15,5,5,51,15,5,5,52,15,5,5,52,14,5,5,53,14,5,5,54,14,5,5,54,14,5,5,55,14,5,5,55,14,5,5,56,13,4,4,57,13,4,4,57,13,4,4,58,13,4,4,58,13,4,4,59,13,4,4,59,17,4,4,60,17,4,4,60,17,4,4,60,17,4,4,61,17,4,4,61,16,4,4,62,16,4,4,63,16,4,4,63,16,8,4,64,16,8,4,64,16,8,4,65,15,8,4,66,15,8,4,66,15,8,4,67,19,8,4,68,19,8,4,68,18,7,4,69,18,7,4,69,18,7,4,69,18,7,4,70,18,7,4,70,18,7,4,71,18,7,4,71,18,7,4,72,17,7,3,73,17,7,3,73,21,7,3,74,21,7,3,74,20,7,3,75,20,7,3,76,20,7,3,76,20,7,3,77,20,7,3,77,20,7,3,78,20,7,3,78,20,7,7,78,19,6,6,79,19,10,6,80,19,10,6,80,22,9,6,81,22,9,6,81,22,9,6,82,22,9,6,83,22,9,6,83,21,9,6,84,21,9,6,84,21,9,6,85,21,9,6,86,21,9,6,86,23,9,6,87,23,9,6,87,23,9,6,87,23,9,6,88,23,9,6,88,23,9,6,89,23,8,6,90,23,8,6,90,22,8,6,91,22,8,6,91,25,8,6,92,25,8,5,93,25,8,5,93,24,8,5,94,24,8,5,94,24,11,5,95,24,11,5,96,24,11,5,96,26,11,5,97,26,11,5,97,26,11,5,97,26,10,5,98,26,10,5,98,26,10,5,99,25,10,5,100,25,10,5,100,25,10,5,101,25,10,5,101,25,10,5,102,27,10,5,103,27,10,5,103,27,10,5,104,27,10,5,104,27,12,5,105,26,12,5,106,26,12,5,106,29,12,5,106,29,12,5,106,29,12,7,107,28,12,7,108,28,12,7,108,28,12,7,109,28,12,7,109,30,12,7,110,30,11,7,111,30,11,7,111,30,11,7,112,30,11,7,112,29,11,7,113,29,11,7,114,29,11,7,114,31,11,7,115,31,11,7,115,31,11,7,115,31,11,7,116,31,11,7,116,33,13,7,117,33,13,9,117,32,13,9,118,32,13,9,118,32,13,9,119,34,15,8,120,34,15,8,120,34,15,8,121,36,15,8,121,36,15,8,122,36,15,8,122,35,15,8,123,37,14,8,124,37,14,8,124,37,14,8,124,37,14,8,124,39,14,8,125,39,16,8,125,38,16,8,126,38,16,8,127,38,16,8,127,40,16,10,128,40,16,10,128,40,16,10,129,42,18,10,129,41,18,10,130,41,18,10,130,43,18,10,131,43,18,10,131,42,17,10,132,42,17,12,132,42,17,12,133,44,17,12,133,44,17,12,133,46,17,11,134,46,17,11,134,45,19,11,135,45,19,11,135,47,19,11,136,47,19,11,136,47,19,11,137,47,19,11,137,48,20,11,138,48,20,11,138,50,20,13,139,50,20,13,139,49,20,13,140,49,22,13,140,51,22,13,141,51,22,13,141,50,22,13,142,52,22,13,142,52,21,12,143,53,21,12,143,53,21,12,143,53,21,12,143,53,21,14,144,53,23,14,144,55,23,14,145,55,23,14,145,56,23,14,146,56,23,14,146,57,24,14,147,57,24,14,147,59,24,16,148,59,24,16,148,58,24,15,149,58,26,15,149,58,26,15,149,60,26,15,150,60,26,15,150,61,25,15,151,61,25,15,151,62,25,17,152,62,25,17,152,64,25,17,152,64,27,17,152,63,27,17,153,63,27,17,153,65,27,17,153,66,28,17,154,66,28,17,154,67,28,16,155,67,28,16,155,67,30,16,155,69,29,18,156,69,29,18,156,68,29,18,157,70,29,18,157,70,29,18,157,71,31,18,158,71,31,18,158,72,30,19,159,72,30,19,159,74,30,19,159,73,30,19,160,73,32,19,160,74,32,19,161,74,32,21,161,76,32,21,161,78,33,21,161,78,33,21,161,79,35,20,162,78,34,20,163,79,34,22,164,81,36,22,164,82,36,22,165,81,35,22,166,82,37,21,167,84,37,21,167,85,36,21,168,86,38,23,169,88,38,23,169,88,38,23,170,88,39,23,170,89,39,24,171,91,40,24,171,92,40,24,172,93,40,24,173,94,41,25,173,95,41,25,174,96,42,25,175,98,42,25,175,99,43,26,176,99,43,26,177,101,45,26,177,102,44,26,178,103,46,27,179,104,46,27,179,105,46,27,179,106,45,28,180,108,47,28,180,108,46,28,181,109,48,28,182,111,48,29,182,111,49,29,183,114,49,29,184,114,50,30,184,114,50,30,185,116,51,30,185,117,51,30,186,119,52,31,187,119,53,31,187,121,53,31,188,122,54,33,188,123,54,32,189,124,55,32,189,125,55,32,189,126,56,34,190,128,56,34,190,128,57,33,191,130,57,33,191,131,58,35,192,131,58,35,192,133,59,34,193,134,60,35,194,135,60,35,194,136,61,37,195,139,61,37,195,139,62,36,196,141,62,36,196,141,63,38,197,142,63,38,197,143,64,39,198,144,64,39,198,146,66,39,198,146,67,39,198,147,67,38,199,147,68,40,199,149,68,40,200,150,69,40,200,152,70,41,201,154,71,41,201,154,71,42,202,155,72,42,202,156,73,41,203,157,73,43,203,158,74,42,204,160,75,44,204,161,76,44,204,162,77,44,205,164,77,45,205,165,78,45,206,166,79,45,206,168,80,46,207,169,81,46,207,170,83,47,207,171,83,47,207,172,83,47,207,174,85,48,208,175,85,48,208,177,85,48,209,178,87,49,209,180,87,49,210,181,87,49,210,182,89,50,210,182,89,50,211,185,91,50,211,186,91,51,212,186,93,51,212,189,94,52,212,190,95,51,213,192,96,51,213,193,96,53,213,194,97,52,214,195,98,54,214,197,98,55,215,198,100,55,215,199,101,55,215,200,102,55,216,202,103,55,216,203,104,55,216,204,105,57,216,205,106,57,216,207,107,58,216,208,108,58,217,209,109,59,217,210,110,60,217,211,111,60,218,212,112,61,218,213,113,61,218,214,114,62,219,217,115,63,219,217,116,64,219,218,118,64,220,219,119,65,220,220,121,66,220,222,121,67,221,222,122,67,221,222,123,68,221,223,124,69,222,224,125,70,222,225,127,71,222,226,128,72,223,228,129,73,223,228,130,74,223,229,132,75,223,230,135,79,224,231,138,81,224,233,141,84,224,233,144,87,225,235,147,91,225,236,150,94,225,237,154,97,225,238,158,102,225,239,161,107,225,239,165,110,225,240,168,114,226,241,172,118,226,241,176,122,226,241,181,126,226,242,183,130,227,243,186,135,227,243,190,139,227,244,194,143,227,244,197,147,228,244,200,150,228,245,204,154,228,245,207,157,228,245,210,161,229,246,212,164,229,246,215,167,229,246,217,169,229,246,220,172,230,247,221,174,230]),KT=128,q6=-I3,W6=0,AO=50,Pve=()=>1-511/512,Ave=sE([[50,.1015625],[500,.21875],[5e3,1-250/512],[5e4,.4140625]]);let Ove=class{constructor(e){this.view=e,this.type=In.Simple,this._passParameters=new ZN,this._fadeVaoCount=0,this._texV1=1,this._isOnMars=Dx(e.spatialReference);const t=Kt(e.spatialReference);this._planetRadius=t.radius,this._outerRimWidth=t.outerAtmosphereRimWidth,this._innerRimFactor=(this._planetRadius+q6)/this._planetRadius,this._middleRimFactor=(this._planetRadius+W6)/this._planetRadius,this._outerRimFactor=(this._planetRadius+this._outerRimWidth)/this._planetRadius,this._texV0=W6/this._outerRimWidth,this._texVScale=this._texV1-this._texV0}destroy(){this._cameraChangeHandle=Os(this._cameraChangeHandle),this._passParameters.texture=ke(this._passParameters.texture),this._fadeVao=ke(this._fadeVao),this._vao=ke(this._vao)}async initializeRenderContext(e){this._shaderTechniqueRepository=e.shaderTechniqueRepository;const t=e.renderContext.rctx;this._cameraChangeHandle=B(()=>{var n;return(n=this.view.state)==null?void 0:n.camera},()=>e.requestRender(),Mi),this._vao=this._createRibbon(t),this._vaoCount=Ws(this._vao,"geometry"),this._fadeVao=La(t),this._fadeVaoCount=Ws(this._fadeVao,"geometry");const r=this._isOnMars?Rve:mZ;this._passParameters.texture=new Gi(t,{pixelFormat:St.RGBA,dataType:Xt.UNSIGNED_BYTE,wrapMode:ai.CLAMP_TO_EDGE,samplingMode:Jt.LINEAR,flipped:!0,width:1,height:512},r),e.requestRender()}get _coneTechnique(){if(C(this._coneTechniqueCached)){const e=new H2;e.geometry=su.Cone,this._coneTechniqueCached=this._shaderTechniqueRepository.acquire(j2,e)}return this._coneTechniqueCached}get _undergroundTechnique(){if(C(this._undergroundTechniqueCached)){const e=new H2;e.geometry=su.Underground,this._undergroundTechniqueCached=this._shaderTechniqueRepository.acquire(j2,e)}return this._undergroundTechniqueCached}render(e){if(C(this._vao)||C(this._passParameters.texture))return;const t=e.bindParameters.camera;this._update(t);const r=e.rctx;this._passParameters.undergroundFadeAlpha<1&&(r.bindTechnique(this._coneTechnique,this._passParameters,e.bindParameters),r.bindVAO(this._vao),r.drawArrays(kt.TRIANGLES,0,this._vaoCount)),this._passParameters.undergroundFadeAlpha>0&&(r.bindTechnique(this._undergroundTechnique,this._passParameters,e.bindParameters),r.bindVAO(this._fadeVao),r.drawArrays(kt.TRIANGLE_STRIP,0,this._fadeVaoCount))}renderHaze(){}_update(e){const t=P(),r=this._planetRadius,n=we(e.eye),s=n-r;if(s<0){const f=Math.min(-s/5e3,1);this._passParameters.undergroundFadeAlpha=f}else this._passParameters.undergroundFadeAlpha=0;const a=Math.max(AO,s),o=r+q6;this._passParameters.innerScale=Mve(r+a,r,o)-1,this._passParameters.altitudeFade=KQ(s),Q(t,e.eye,(r+AO)/n),X6(t,e.center,e.up,r,this._passParameters.silhouette);const l=this._computeScreenRimWidth(e,t,e.up,this._passParameters.silhouette),c=Pve(),u=Ave(s);let d=this._texV0+c*this._texVScale,m=this._texV0+l*u*this._texVScale;if(s>AO){X6(e.eye,e.center,e.up,r,this._passParameters.silhouette);const f=this._computeScreenRimWidth(e,e.eye,e.up,this._passParameters.silhouette),_=ue((f-1.5)/(l-1.5),0,1);d=this._texV0+_*c*this._texVScale,m=this._texV0+bt(this._texV1,l*u,_)*this._texVScale}rt(this._passParameters.texV,d,m)}_createRibbon(e){const t=new Float32Array(3+3*KT*3),r=new Uint32Array(3*KT*5);t[0]=0,t[1]=0,t[2]=-1;for(let a=0;a<KT;a++){const o=9*a+3;t[o+0]=a,t[o+1]=this._innerRimFactor,t[o+2]=-1,t[o+3]=a,t[o+4]=this._middleRimFactor,t[o+5]=0,t[o+6]=a,t[o+7]=this._outerRimFactor,t[o+8]=1;const l=3*a+1,c=a===KT-1?1:l+3,u=15*a;r[u+0]=l,r[u+1]=l+1,r[u+2]=c+1,r[u+3]=c+1,r[u+4]=c,r[u+5]=l,r[u+6]=l+1,r[u+7]=l+2,r[u+8]=c+2,r[u+9]=c+2,r[u+10]=c+1,r[u+11]=l+1,r[u+12]=l,r[u+13]=c,r[u+14]=0}const n=Q6.createBuffer(r.length),s=n.position;for(let a=0;a<r.length;++a){const o=3*r[a];s.set(a,0,t[o]),s.set(a,1,t[o+1]),s.set(a,2,t[o+2])}return new nu(e,oi,{geometry:Wc(Q6)},{geometry:ui.createVertex(e,mi.STATIC_DRAW,n.buffer)})}_computeScreenRimWidth(e,t,r,n){return ce(a1,n.center,n.v2),Q(MO,a1,this._outerRimFactor),OD(OO,t,a1,r),ak(a1,OO,e.projectionMatrix,e.viewport),ak(MO,OO,e.projectionMatrix,e.viewport),Li(a1,MO)/e.height}};function X6(i,e,t,r,n){const s=we(i),a=r*Math.sqrt(s*s-r*r)/s,o=Math.sqrt(r*r-a*a),l=n.v1,c=n.v2;return Q(n.center,i,o/s),ut(l,i,e),Ml(l)<1&&ut(l,i,t),Q(l,l,a/we(l)),ut(c,l,i),Q(c,c,a/we(c)),a}const OO=xe(),a1=P(),MO=P();function Mve(i,e,t){return i*i/(Math.sqrt(i*i-e*e)*Math.sqrt(i*i-t*t)+e*t)}const Q6=sn().vec3f(S.POSITION);let yZ=class vZ extends ii{initializeProgram(e){return new ei(e.rctx,vZ.shader.get().build(this.configuration),oi)}initializePipeline(){return it({blending:Gn(me.ONE,me.ZERO,me.ONE_MINUS_SRC_COLOR,me.ONE),colorWrite:gt})}};yZ.shader=new ri(cZ,()=>j(()=>import("./FogHaze.glsl-88c5583f.js"),["assets/FogHaze.glsl-88c5583f.js","assets/mat4-44a0988f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/mat4f64-1e28eae0.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/vec3-e93e648f.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/FloatPassUniform-68d54f51.js","assets/vec4-790471c0.js","assets/vec4f64-e407da96.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/vec3f32-c9aa289f.js","assets/compilerUtils-18d58939.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));const Ive=.7,Lve=1;let mb=class extends pe{constructor(e){super(e),this._passParameters=new XN;const t=e.context.renderContext.rctx;this._vao=La(t,jx);const r=Kt(e.view.spatialReference);this._planetRadius=r.radius,this._atmosphereRadius=r.radius+hx}destroy(){this._hazeTechniqueCached=Qi(this._hazeTechniqueCached),this._vao=ke(this._vao)}get _shaderTechniqueRepository(){return this.context.shaderTechniqueRepository}set strength(e){this._passParameters.hazeStrength=e}get strength(){return this._passParameters.hazeStrength}get _hazeTechnique(){if(C(this._hazeTechniqueCached)){const e=new QN;e.haze=!0,this._hazeTechniqueCached=this._shaderTechniqueRepository.acquire(yZ,e)}return this._hazeTechniqueCached}render(e,t){if(this.view.basemapTerrain.baseOpacity===0||(this._update(e,t),this._passParameters.hazeAmount<=0))return;const r=this._hazeTechnique;if(!r.compiled)return void this.context.requestRender();const n=e.offscreenRenderingHelper;n.renderDepthDetached(()=>{this._passParameters.depthTexture=n.depthTexture;const s=e.rctx.bindTechnique(r,this._passParameters,e.bindParameters);this._renderSimpleHaze(s,e)})}_renderSimpleHaze(e,t){if(C(this._vao))return;const r=t.rctx;r.bindVAO(this._vao),e.assertCompatibleVertexAttributeLocations(this._vao),r.drawArrays(kt.TRIANGLE_STRIP,0,4)}_update(e,t){const r=e.bindParameters.camera;de(Z6,r.eye);const n=Math.max(0,_e(Z6,e.bindParameters.lighting.mainLight.direction)),s=Dve;Q(Y6,s,0),Bn(this._passParameters.hazeColor,Y6,s,n);const a=we(r.eye),o=a*a;this._passParameters.atmosphereC=o-this._atmosphereRadius*this._atmosphereRadius,this._passParameters.hazeAmount=(1-G0(Ive*Cl,Lve*Cl,Math.abs(a-this._planetRadius)))*t.amount,this._passParameters.fogStrength=t.strength}static isSupported(e){return e.capabilities.depthTexture}};h([p({constructOnly:!0})],mb.prototype,"context",void 0),h([p({constructOnly:!0})],mb.prototype,"view",void 0),mb=h([F("esri.views.3d.environment.SimpleHaze")],mb);let $ve=class{constructor(){this.strength=0,this.amount=0}};const Dve=Ze(.24,.44,.8),Z6=P(),Y6=P();function Fve(){const i=new Yi;return i.attributes.add(S.POSITION,"vec3"),i.attributes.add(S.COLOR,"vec4"),i.attributes.add(S.SIZE,"float"),i.varyings.add("vcolor","vec4"),i.varyings.add("vsize","float"),i.vertex.uniforms.add([new Ys("transform",(e,t)=>Nve(e,t)),new Xh("viewport",(e,t)=>t.camera.fullViewport),new Pt("pixelRatio",(e,t)=>t.camera.pixelRatio)]),i.include(ase),i.vertex.code.add(A`void main(void) {
vec4 posProj = transform * vec4(position, 0);
gl_Position = alignToPixelCenter(posProj, viewport.zw);
vcolor = color / 1.2;
vsize = size * 5.0 * pixelRatio;
gl_PointSize = vsize;
}`),i.fragment.code.add(A`void main() {
float cap = 0.7;
float scale = 1.0 / cap;
float helper = clamp(length(abs(gl_PointCoord - vec2(0.5))), 0.0, cap);
float alpha = clamp((cap - helper) * scale, 0.0, 1.0);
float intensity = alpha * alpha * alpha;
if (vsize < 3.0) {
intensity *= 0.5;
}
gl_FragColor = vec4(vcolor.xyz, intensity);
}`),i}function Nve(i,e){return pn(Kd,e.camera.projectionMatrix),Kd[10]=24e-8-1,Kd[11]=-1,Kd[14]=(24e-8-2)*e.camera.near,Hr(Kd,Kd,e.camera.viewMatrix),Hr(Kd,Kd,i.modelMatrix)}const Kd=xe(),kve=Object.freeze(Object.defineProperty({__proto__:null,build:Fve},Symbol.toStringTag,{value:"Module"}));let Vve=class extends Ir{constructor(){super(...arguments),this.modelMatrix=xe()}},bZ=class wZ extends ii{constructor(e){super(e,new $a,()=>this.destroy())}initializeProgram(e){return new ei(e.rctx,wZ.shader.get().build(),oi)}initializePipeline(){return it({blending:Gn(me.SRC_ALPHA,me.ONE,me.ONE_MINUS_SRC_ALPHA,me.ONE_MINUS_SRC_ALPHA),depthTest:{func:hs.LEQUAL},colorWrite:gt})}};bZ.shader=new ri(kve,()=>j(()=>import("./Stars.glsl-1f73175a.js"),["assets/Stars.glsl-1f73175a.js","assets/mat4-44a0988f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/mat4f64-1e28eae0.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/VertexAttribute-9c5c630d.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));let Lp=class extends pe{constructor(e){super(e),this._loadDataTask=null,this._numPoints=0,this._renderParameter=new Vve,this._updatingTracking=new _v}get updating(){return this._updatingTracking.updating||this.loading}get loading(){return y(this._loadDataTask)&&!this._loadDataTask.finished}initialize(){this._loadDataTask=this._createLoadDataTask()}destroy(){this._loadDataTask=iu(this._loadDataTask),this._updatingTracking.destroy(),this._numPoints=0,this._technique=Qi(this._technique),this._vao=ke(this._vao)}render(e){const{rctx:t}=e;if(this._ensureResources(t),C(this._technique)||C(this._vao))return;if(!this._technique.compiled)return void this.requestRender();const r=t.bindTechnique(this._technique,this._renderParameter,e.bindParameters);t.bindVAO(this._vao),r.assertCompatibleVertexAttributeLocations(this._vao),t.drawArrays(kt.POINTS,0,this._numPoints)}_ensureResources(e){if(y(this._technique)||C(I_))return;this._technique=new bZ({rctx:e,viewingMode:this.view.state.viewingMode}),this._numPoints=I_.byteLength/K6;const t=new Float32Array(I_,0,2*this._numPoints),r=new Uint8Array(I_,2*this._numPoints*4,this._numPoints);this._vao=this._createVertexArrayObject(e,t,r,this._numPoints),this._updatingTracking.add(()=>this.view.environment.lighting.type!=="virtual"?this.view.environment.lighting.date:null,n=>this._update(n),et)}_computeDayDuration(e){const t=e,r=new Date(e.getFullYear(),0,1,11,58,56);return(+t-+r)/(+new Date(e.getFullYear()+1,0,1,11,58,55)-+r)}_update(e){if(!e)return;const t=(e.getHours()/12+e.getMinutes()/60*(2/24)+e.getSeconds()/60*(2/1440)-.9972222)%2,r=2*this._computeDayDuration(e),n=pn(this._renderParameter.modelMatrix,Bve);Tw(n,n,-r*Math.PI),Hr(n,zve,n),Tw(n,n,-t*Math.PI),this.requestRender()}_hexToRGB(e){return[parseInt(e.substring(0,2),16),parseInt(e.substring(2,4),16),parseInt(e.substring(4,6),16)]}_unpackUint8Attributes(e){return e>=192?[2.9,e-192]:e>=160?[2.5,e-160]:e>=128?[2,e-128]:e>=96?[1.5,e-96]:e>=64?[1,e-64]:e>=32?[.7,e-32]:[.4,e]}_createVertexArrayObject(e,t,r,n){const s=J6.createBuffer(n),a=s.position,o=s.color,l=s.size;for(let c=0;c<n;c++){const u=t[2*c+0],d=t[2*c+1];a.set(c,0,-Math.cos(u)*Math.sin(d)),a.set(c,1,-Math.sin(u)*Math.sin(d)),a.set(c,2,-Math.cos(d));const m=this._unpackUint8Attributes(r[c]),f=this._hexToRGB(Uve[m[1]]);o.set(c,0,255*f[0]),o.set(c,1,255*f[1]),o.set(c,2,255*f[2]),o.set(c,3,255),l.set(c,m[0])}return new nu(e,oi,{geometry:Wc(J6)},{geometry:ui.createVertex(e,mi.STATIC_DRAW,s.buffer)})}_createLoadDataTask(){if(y(I_))return null;const e=Bx(async t=>{const{data:r}=await Cie("esri/views/3d/environment/resources/stars.wsv",{responseType:"array-buffer",signal:t});this._verifyStarData(r),I_=r});return e.promise.catch(t=>{yo(t)||ee.getLogger(this.declaredClass).error(t)}).then(()=>{this.destroyed||(this.requestRender(),this.notifyChange("updating"))}),e}_verifyStarData(e){if(!e)throw new J("stars:no-data-received","Failed to create stars because star catalogue is missing");const t=e.byteLength/K6;if(t%1!=0||t>5e4||t<5e3)throw new J("stars:invalid-data","Failed to create stars because star catalogue data is invalid")}};h([p({constructOnly:!0})],Lp.prototype,"view",void 0),h([p({constructOnly:!0})],Lp.prototype,"requestRender",void 0),h([p({readOnly:!0})],Lp.prototype,"updating",null),h([p()],Lp.prototype,"_loadDataTask",void 0),h([p()],Lp.prototype,"_updatingTracking",void 0),Lp=h([F("esri.views.3d.environment.Stars")],Lp);const Uve=["9bb2ff","9eb5ff","aabfff","bbccff","ccd8ff ","dae2ff","e4e9ff","eeefff","f8f6ff","fff9fb","fff5ef","fff1e5","ffeddb","ffe9d2","ffe6ca","ffe3c3","ffe0bb","ffddb4","ffdaad","ffd6a5","ffd29c","ffcc8f","ffc178","ffa94b","ff7b00"],zve=$G(1,0,0,0,0,.9174771405229186,.39778850739794974,0,0,-.39778850739794974,.9174771405229186,0,0,0,0,1),Bve=$G(1,0,0,0,0,.9174771405229186,-.39778850739794974,0,0,.39778850739794974,.9174771405229186,0,0,0,0,1),K6=9,J6=sn().vec3f(S.POSITION).vec4u8(S.COLOR).f32(S.SIZE);let I_=null;function Gve(i,e,t){const r=i.parallax.anchorPointClouds;i.fadeIn.stage===Ih.FINISHED&&(i.fadeIn.factor=0,X(r,Vh),i.fadeIn.stage=Ih.CHANGE_ANCHOR,i.crossFade.enabled=!1,i.fadeInOut.stage=ba.FINISHED),i.fadeIn.stage===Ih.CHANGE_ANCHOR&&i.isCameraPositionFinal&&(VD(i.data)&&i.renderingStage!==Kr.RENDERING||i.renderingStage===Kr.FADING_TEXTURE_CHANNELS)&&(X(r,Vh),i.fadeIn.stage=Ih.FADE_IN,i.startTime=e,i.renderingStage===Kr.FADING_TEXTURE_CHANNELS&&(i.renderingStage=Kr.SWITCH_CHANNELS)),i.fadeIn.factor<1&&i.fadeIn.stage===Ih.FADE_IN?i.fadeIn.factor=t?ue((e-i.startTime)/(xZ*t),0,1):1:i.fadeIn.factor>=1&&i.fadeIn.stage===Ih.FADE_IN&&(i.fadeIn.stage=Ih.FINISHED,i.fadeIn.factor=1)}function Hve(i,e,t){const{fadeInOut:r,crossFade:n}=i;r.stage===ba.FINISHED&&(i.startTime=e,r.factor=1,r.stage=ba.FADE_OUT),r.factor>0&&r.stage===ba.FADE_OUT?r.factor=t?1-ue((e-i.startTime)/(Qve*t),0,1):0:(r.factor<=0&&r.stage===ba.FADE_OUT&&(r.factor=0,X(i.parallax.anchorPointClouds,Vh)),r.factor<=0&&r.stage===ba.FADE_OUT&&i.isCameraPositionFinal&&(r.factor=0,r.stage=ba.SWITCH,i.crossFade.enabled=!1,n.factor=1),r.stage===ba.SWITCH&&(VD(i.data)&&i.renderingStage!==Kr.RENDERING||i.renderingStage===Kr.FADING_TEXTURE_CHANNELS)&&(i.startTime=e,r.factor=0,r.stage=ba.FADE_IN,X(i.parallax.anchorPointClouds,Vh),i.crossFade.enabled=!1,n.factor=1,i.renderingStage===Kr.FADING_TEXTURE_CHANNELS&&(i.renderingStage=Kr.SWITCH_CHANNELS)),r.factor<1&&r.stage===ba.FADE_IN?r.factor=t?ue((e-i.startTime)/(xZ*t),0,1):1:r.factor>=1&&r.stage===ba.FADE_IN&&(r.stage=ba.FINISHED,r.factor=1))}function jve(i,e,t,r){const{crossFade:n}=i,s=i.parallax.anchorPointClouds;i.crossFade.enabled&&!r||(X(i.parallaxNew.anchorPointClouds,Vh),i.startTime=e,n.factor=0,i.crossFade.enabled=!0),n.factor<1&&i.crossFade.enabled?n.factor=t?ue((e-i.startTime)/(Zve*t),0,1):1:n.factor>=1&&i.crossFade.enabled&&(i.crossFade.enabled=!1,n.factor=1,X(s,i.parallaxNew.anchorPointClouds),i.renderingStage===Kr.FADING_TEXTURE_CHANNELS&&(i.renderingStage=Kr.SWITCH_CHANNELS))}function eU(i,e,t,r){const n=i.fadeInOutHeight,s=n.stage===HE.FINISHED?t:i.startTimeHeightFade;if(r!==0){const a=(t-s)/(Yve*r);n.factor+=e?-a:a}else n.factor=e?0:1;i.startTimeHeightFade=t,n.factor=ue(n.factor,0,1),n.stage=HE.HEIGHT_FADE}function qve(i,e,t,r,n){i.renderingStage===Kr.FINISHED_RENDERING&&(i.renderingStage=Kr.FADING_TEXTURE_CHANNELS);const s=we(e.eye);i.fadeInOutHeight.factor<0&&(i.fadeInOutHeight.factor=s-lo.radius>Cl?1:0),i.isCameraPositionFinal=Og(i.cameraPositionLastFrame,e.eye),de(Vh,e.eye),Q(Vh,Vh,lo.radius);const a=i.parallax;a.anchorPointClouds[0]===0&&a.anchorPointClouds[1]===0&&a.anchorPointClouds[2]===0&&X(a.anchorPointClouds,Vh);const o=we(ae(Xve,a.anchorPointClouds,Vh));let l=!0;o>i.fadeIn.distanceThresholdFactor*a.cloudsHeight||i.fadeIn.stage!==Ih.FINISHED?Gve(i,r,n):o>i.fadeInOut.distanceThresholdFactor*a.cloudsHeight||i.fadeInOut.stage!==ba.FINISHED?Hve(i,r,n):o>i.crossFade.distanceThresholdFactor*a.cloudsHeight||i.crossFade.enabled||i.renderingStage===Kr.FADING_TEXTURE_CHANNELS?jve(i,r,n,(t!==Fh.IDLE||!VD(i.data))&&i.renderingStage!==Kr.FADING_TEXTURE_CHANNELS):l=!1;const c=s-lo.radius;if((c>1.7*Cl||c<-Cl)&&i.fadeInOutHeight.factor<1?i.fadeInOutHeight.factor=1:(c>Cl||c<-.35*Cl)&&i.fadeInOutHeight.factor<1?eU(i,!1,r,n):c<Cl&&c>-.35*Cl&&i.fadeInOutHeight.factor>0?eU(i,!0,r,n):i.fadeInOutHeight.stage=HE.FINISHED,i.renderingStage===Kr.SWITCH_CHANNELS&&(i.readChannels=1-i.readChannels,i.renderingStage=Kr.FINISHED),a.radiusCurvatureCorrectionFactor=.84*Math.sqrt(Math.max(s*s-lo.radius*lo.radius,0))/s,ok(tU,a.anchorPointClouds,L_),kl(a.transform,rn,L_[3],lk(L_)),l){const{parallaxNew:u}=i;ok(tU,u.anchorPointClouds,L_),kl(u.transform,rn,L_[3],lk(L_))}X(i.cameraPositionLastFrame,e.eye)}function Wve(i){return i.crossFade.enabled||i.fadeInOut.stage!==ba.FINISHED||i.fadeIn.stage!==Ih.FINISHED||i.fadeInOutHeight.stage!==HE.FINISHED||i.renderingStage!==Kr.FINISHED}const tU=Ze(0,0,1),L_=Fse(),Vh=P(),Xve=P(),xZ=1,Qve=.5,Zve=1.3,Yve=1;var N0;(function(i){i[i.Immediate=0]="Immediate",i[i.Faded=1]="Faded"})(N0||(N0={}));var My;const Kve=[le.POSTPROCESSING_ENVIRONMENT_OPAQUE,le.POSTPROCESSING_ENVIRONMENT_TRANSPARENT];let gs=My=class extends pe{constructor(i){super(i),this._handles=new Vt,this._context=null,this._atmosphere=null,this._oldWeatherParameters=new IO,this._newWeatherParameters=new IO,this._fadedWeatherParameters=new IO,this._weatherParameters=this._newWeatherParameters}initialize(){this.view._stage.addRenderPlugin(Kve,this)}destroy(){var i;((i=this.view)==null?void 0:i._stage)!=null&&this.view._stage.removeRenderPlugin(this),this._handles=Oe(this._handles),this._set("view",null)}get atmosphereType(){return y(this._atmosphere)?this._atmosphere.type:In.None}get canRender(){var i;return!!((i=this.view.basemapTerrain)!=null&&i.renderer.canRender)||this.view.viewingMode!=="global"}get needsLinearDepth(){return y(this._atmosphere)&&this._atmosphere.type===In.Realistic}updateAnimation(i){return!!y(this._precipitation)&&this._precipitation.update(i)}get updating(){return y(this._stars)&&this._stars.updating||y(this._clouds)&&this._clouds.running}get weatherVisible(){return we(this.view.state.camera.eye)-Kt(this.view.spatialReference).radius<=Cl}get _stars(){var r;const i=this.view,e=((r=i.environment)==null?void 0:r.starsEnabled)??!1,t=this._get("_stars");return!e||C(this._context)?(Oe(t),null):y(t)?t:new Lp({view:i,requestRender:()=>this._setNeedsRender()})}get _precipitation(){const i=this._get("_precipitation");if(!this._precipitationEnabled||C(this._context))return Oe(i),null;const e=this.view,t=this._context;return y(i)&&i.context===t?i:(Oe(i),new kf({context:t,view:e}))}get _clouds(){const i=this._get("_clouds");if(!this.weatherEnabled||C(this._context))return Oe(i),null;if(y(i))return i;const e=this.view,t=this._context;return Oe(i),new pa({context:t,view:e,requestRender:()=>this._setNeedsRender()})}get _cloudsComposition(){const i=this._get("_cloudsComposition");if(!this.weatherEnabled||C(this._context))return Oe(i),null;const e=this.view.state.viewingMode,t=this._context.renderContext.rctx,r=Kt(this.view.spatialReference).radius;return y(i)&&i.viewingMode===e&&i.planetRadius===r?i:(Oe(i),new Nf({rctx:t,viewingMode:e,planetRadius:r,requestRender:()=>this._setNeedsRender()}))}get _fog(){const i=this._get("_fog");if(!this.weatherEnabled||C(this._context))return Oe(i),null;if(y(i))return i;const e=this.view,t=this._context;return new pb({context:t,view:e})}get _simpleHaze(){const i=this._get("_simpleHaze");if(!this.weatherEnabled||C(this._context))return Oe(i),null;if(y(i))return i;const e=this.view,t=this._context;return new mb({context:t,view:e})}get weatherEnabled(){var i,e;return!!((e=(i=this.view)==null?void 0:i.environmentManager)!=null&&e.weatherEnabled)}get _precipitationEnabled(){return this.weatherEnabled&&(this.view.environment.weather.type==="rainy"||this.view.environment.weather.type==="snowy")}initializeRenderContext(i=null){this._context=i;const e=()=>this._setNeedsRender();this._handles.add([cs(()=>{var t;return(t=this.view)==null?void 0:t.basemapTerrain},()=>this._updateBasemapTerrain(),Mi),B(()=>({viewingMode:this.view.viewingMode,atmosphereEnabled:this.view.environment.atmosphereEnabled,atmosphereQuality:this.view.environment.atmosphere.quality}),()=>this._updateAtmosphere(),Mi),B(()=>this._stars,e),B(()=>this._precipitation,e),B(()=>this._clouds,()=>this._updateWeather(),et),B(()=>this._fog,()=>this._updateFogHaze(),et),B(()=>this._simpleHaze,()=>this._updateFogHaze(),et),B(()=>this._weatherUpdateParameters,()=>{this._updateWeather(),this._updateFogHaze()},Mi)])}uninitializeRenderContext(){this._context=null,this._atmosphere=Oe(this._atmosphere),this._set("_stars",Oe(this._stars)),this._set("_precipitation",Oe(this._precipitation)),this._set("_clouds",Oe(this._clouds)),this._set("_cloudsComposition",Oe(this._cloudsComposition)),this._set("_fog",Oe(this._fog)),this._set("_simpleHaze",Oe(this._simpleHaze))}prepareRender(i){i.bindParameters.cloudsFade.data=Ene(this._clouds)?this._clouds:null,this.view.viewingMode!=="local"&&(qve(i.bindParameters.cloudsFade,i.bindParameters.camera,this.view.state.mode,My.test.time||i.time,this.view.qualitySettings.weatherFadeDuration),this._updateWeatherFading(i.bindParameters),i.bindParameters.cloudsFade.renderingStage===Kr.FINISHED&&y(this._clouds)&&this._clouds.coverage===0&&this._clouds.running===!1&&this._clouds.destroyFrameBufferCube())}render(i){if(i.output===V.Color)switch(i.bindParameters.slot){case le.POSTPROCESSING_ENVIRONMENT_OPAQUE:y(this._stars)&&this._stars.render(i),y(this._atmosphere)&&(this._atmosphere.render(i),y(this._cloudsComposition)&&y(i.bindParameters.cloudsFade.data)&&(this.weatherVisible&&y(this._clouds)&&this._clouds.updateWeatherTile(),this._cloudsComposition.render(i)),Wve(i.bindParameters.cloudsFade)&&y(this._context)&&this._context.requestRender());break;case le.POSTPROCESSING_ENVIRONMENT_TRANSPARENT:if(y(this._atmosphere)&&(this._atmosphere.renderHaze(i,this._weatherParameters.haze.amount),this._weatherParameters.haze.amount>0&&this._selectAtmosphereType()!==In.Realistic&&y(this._simpleHaze)&&this._simpleHaze.render(i,this._weatherParameters.haze),this._weatherParameters.fog.amount>0&&y(this._fog)&&this._fog.render(i,this._weatherParameters.fog),y(this._precipitation))){const e=this.view.environment.weather;e.type!=="rainy"&&e.type!=="snowy"||this._precipitation.render(i,e.precipitation,e.type)}}}updateLightSources(i,e,t,r){if(y(this._context)){const n=this._context.renderContext;n.bindParameters.oldLighting.copyFrom(n.bindParameters.lighting),n.bindParameters.newLighting.noonFactor=e,n.bindParameters.newLighting.globalFactor=t,n.bindParameters.newLighting.set(i),r===N0.Faded||n.bindParameters.weatherFading?n.bindParameters.fadeLighting(0):n.bindParameters.fadeLighting(1),this._context.requestRender()}}get _weatherUpdateParameters(){const i=this.weatherEnabled?this.view.environment.weather:null;return C(i)?null:i.type==="rainy"||i.type==="snowy"?{type:i.type,weatherAdjustment:i.cloudCover,effect:i.precipitation}:{type:i.type,weatherAdjustment:i.type==="foggy"?i.fogStrength:i.cloudCover}}_updateWeatherFading(i){if(!i.weatherFading)return;const e=i.cloudsFade;return e.fadeIn.stage===Ih.FADE_IN?(i.fadeLighting(e.fadeIn.factor),void this._fadeWeather(e.fadeIn.factor)):e.fadeInOut.stage===ba.FADE_IN?(i.fadeLighting(e.fadeInOut.factor),void this._fadeWeather(e.fadeInOut.factor)):e.crossFade.enabled?(i.fadeLighting(e.crossFade.factor),void this._fadeWeather(e.crossFade.factor)):(i.fadeLighting(0),void this._fadeWeather(0))}_fadeWeather(i){const{_newWeatherParameters:e,_oldWeatherParameters:t}=this;i>=1?this._weatherParameters=e:(this._fadedWeatherParameters.lerp(t,e,i),this._weatherParameters=this._fadedWeatherParameters)}_updateWeather(){const i=this._weatherUpdateParameters;C(i)||C(this._clouds)||(this._clouds.applyPreset(ys[i.type],i.weatherAdjustment),this._setNeedsRender())}_setNeedsRender(){y(this._context)&&this._context.requestRender()}_updateFogHaze(){const i=this._weatherUpdateParameters;if(C(this._fog)||C(this._simpleHaze)||C(i)||C(this._context))return;const e=this._context.renderContext.bindParameters;switch(this._oldWeatherParameters.copyFrom(this._weatherParameters),i.type){case"foggy":this._newWeatherParameters.fog.strength=bt(3e-5,.005,i.weatherAdjustment**3),X(this._newWeatherParameters.fog.color,iU),this._newWeatherParameters.fog.amount=1,this._newWeatherParameters.haze.strength=0,this._newWeatherParameters.haze.amount=this._selectAtmosphereType()===In.Realistic?1:0,this._setNeedsRender();break;case"rainy":this._newWeatherParameters.fog.strength=bt(4e-6,2e-4,i.effect**3),X(this._newWeatherParameters.fog.color,Jve),this._newWeatherParameters.fog.amount=1,this._newWeatherParameters.haze.strength=0,this._newWeatherParameters.haze.amount=0,this._setNeedsRender();break;case"snowy":this._newWeatherParameters.fog.strength=bt(4e-6,2e-4,i.effect**3),X(this._newWeatherParameters.fog.color,iU),this._newWeatherParameters.fog.amount=1,this._newWeatherParameters.haze.strength=0,this._newWeatherParameters.haze.amount=this._selectAtmosphereType()===In.Realistic?1:0,this._setNeedsRender();break;default:this._newWeatherParameters.fog.strength=0,this._newWeatherParameters.fog.amount=0,this._newWeatherParameters.haze.strength=4e-6,this._newWeatherParameters.haze.amount=1,this._setNeedsRender()}e.weatherFading?this._fadeWeather(0):this._fadeWeather(1)}_updateAtmosphere(){const i=this._selectAtmosphereType();if(this.atmosphereType===i)return;const e=this._getAtmosphereClass();if(!e)return y(this._atmosphere)&&(this._atmosphere.destroy(),this._atmosphere=null,this._setNeedsRender()),void this._updateBasemapTerrain();y(this._context)&&(Oe(this._atmosphere),this._atmosphere=new e(this.view),this._atmosphere.initializeRenderContext(this._context),this._setNeedsRender(),this._updateBasemapTerrain())}_getAtmosphereClass(){switch(this._selectAtmosphereType()){case In.None:return null;case In.Realistic:return F6;case In.Panoramic:return gve;case In.Simple:return Ove;default:return}}_selectAtmosphereType(){const i=this.view.get("environment.atmosphereEnabled"),e=this.view.get("environment.atmosphere.quality"),t=this.view.viewingMode;return!i||e==null||Fx(this.view.spatialReference)?In.None:t==="local"?In.Panoramic:e==="high"&&y(this._context)&&F6.isSupported(this._context)&&DE(this.view.spatialReference)?In.Realistic:In.Simple}_updateBasemapTerrain(){this.view.basemapTerrain&&(this.view.basemapTerrain.velvetOverground=y(this._atmosphere)&&this.atmosphereType===In.Simple)}get test(){return{atmosphere:this._atmosphere,clouds:this._clouds,selectAtmosphereType:()=>this._selectAtmosphereType(),stubGetAtmosphereClass:i=>{rU=My.prototype._getAtmosphereClass,My.prototype._getAtmosphereClass=i},restoreGetAtmosphereClass:()=>{My.prototype._getAtmosphereClass=rU}}}};gs.test={time:It(0)},h([p({constructOnly:!0})],gs.prototype,"view",void 0),h([p({type:Boolean,readOnly:!0})],gs.prototype,"updating",null),h([p({readOnly:!0})],gs.prototype,"weatherVisible",null),h([p()],gs.prototype,"_context",void 0),h([p({readOnly:!0})],gs.prototype,"_stars",null),h([p({readOnly:!0})],gs.prototype,"_precipitation",null),h([p({readOnly:!0})],gs.prototype,"_clouds",null),h([p({readOnly:!0})],gs.prototype,"_cloudsComposition",null),h([p({readOnly:!0})],gs.prototype,"_fog",null),h([p({readOnly:!0})],gs.prototype,"_simpleHaze",null),h([p({readOnly:!0})],gs.prototype,"weatherEnabled",null),h([p({readOnly:!0})],gs.prototype,"_precipitationEnabled",null),h([p({readOnly:!0})],gs.prototype,"_weatherUpdateParameters",null),gs=My=h([F("esri.views.3d.environment.EnvironmentRenderer")],gs);let IO=class{constructor(){this.fog=new ove,this.haze=new $ve}copyFrom(e){this.fog.amount=e.fog.amount,this.haze.amount=e.haze.amount,this.fog.strength=e.fog.strength,this.haze.strength=e.haze.strength,X(this.fog.color,e.fog.color)}lerp(e,t,r){this.fog.amount=bt(e.fog.amount,t.fog.amount,r),this.haze.amount=bt(e.haze.amount,t.haze.amount,r),this.fog.strength=bt(e.fog.strength,t.fog.strength,r),this.haze.strength=bt(e.haze.strength,t.haze.strength,r),Bn(this.fog.color,e.fog.color,t.fog.color,r)}};const Jve=Ze(.5,.5,.5),iU=Ze(1.5,1.5,1.5);let rU;function nU(i,e,t){if(C(e.longitude)||C(e.latitude)||C(t.longitude)||C(t.latitude))throw new Error("Invalid points: no lon/lat");return e1e(i,e.longitude,e.latitude,t.longitude,t.latitude)}function e1e(i,e,t,r,n){const s=At(t),a=At(n),o=s-a,l=At(e)-At(r),c=Math.sin(o/2),u=Math.sin(l/2),d=2*tu(Math.sqrt(c*c+Math.cos(s)*Math.cos(a)*u*u))*i;return Math.round(1e4*d)/1e4}function t1e(i,e,t){const r=e.spatialReference,n=Kt(r),s=new He(e.x,i.y,r),a=new He(t.x,i.y,r),o=new He(i.x,e.y,r),l=new He(i.x,t.y,r);return{lon:nU(n.radius,s,a),lat:nU(n.radius,o,l)}}function i1e(i,e,t){const r=e/t,n=At(i),s=Math.sin(r/2),a=Math.cos(n),o=2*tu(Math.sqrt(s*s/(a*a)));return _o(o)}function r1e(i,e){let t=i/15;return e||(t=Math.round(t)),t}function sU(i,e){e||(e={hours:0,minutes:0,seconds:0}),e.hours=r1e(i[0],!0);const t=e.hours%1;e.hours-=t,e.minutes=60*t;const r=e.minutes%1;return e.minutes-=r,e.seconds=Math.round(60*r),e}var aU,oU,lU,TZ={exports:{}};aU=TZ,oU=function(){var i=Math.PI,e=Math.sin,t=Math.cos,r=Math.tan,n=Math.asin,s=Math.atan2,a=Math.acos,o=i/180,l=864e5,c=2440588,u=2451545,d={dec:0,ra:0};function m(U){return U.valueOf()/l-.5+c}function f(U){return new Date((U+.5-c)*l)}function _(U){return m(U)-u}var g=23.4397*o;function w(U,L){return s(e(U)*t(g)-r(L)*e(g),t(U))}function v(U,L){return n(e(L)*t(g)+t(L)*e(g)*e(U))}function b(U,L,z){return s(e(U),t(U)*e(L)-r(z)*t(L))}function x(U,L,z){return n(e(L)*e(z)+t(L)*t(z)*t(U))}function T(U,L){return o*(280.16+360.9856235*U)-L}function R(U){return o*(357.5291+.98560028*U)}function E(U){return o*(1.9148*e(U)+.02*e(2*U)+3e-4*e(3*U))}function O(U,L){return U+L+102.9372*o+i}function $(U,L){var z=R(U),q=O(z,E(z));return L||(L={dec:0,ra:0}),L.dec=v(q,0),L.ra=w(q,0),L}var D={PolarException:{NORMAL:0,MIDNIGHT_SUN:1,POLAR_NIGHT:2},getPosition:function(U,L,z,q){var K=o*-z,ie=o*L,Z=_(U),ne=$(Z,d),Ae=T(Z,K)-ne.ra;return q||(q={azimuth:0,altitude:0}),q.azimuth=b(Ae,ie,ne.dec),q.altitude=x(Ae,ie,ne.dec),q}},I=[[-.83,"sunrise","sunset"]];D.addTime=function(U,L,z){I.push([U,L,z])};var G=9e-4;function W(U,L){return Math.round(U-G-L/(2*i))}function re(U,L,z){return G+(U+L)/(2*i)+z}function te(U,L,z){return u+U+.0053*e(L)-.0069*e(2*z)}function H(U,L,z){return a((e(U)-e(L)*e(z))/(t(L)*t(z)))}function M(U){var L=o*(134.963+13.064993*U),z=o*(93.272+13.22935*U),q=o*(218.316+13.176396*U)+6.289*o*e(L),K=5.128*o*e(z),ie=385001-20905*t(L);return{ra:w(q,K),dec:v(q,K),dist:ie}}return D.getTimes=function(U,L,z){var q=o*-z,K=o*L,ie=W(_(U),q),Z=re(0,q,ie),ne=R(Z),Ae=E(ne),Fe=O(ne,Ae),ze=v(Fe,0),Ye=te(Z,ne,Fe);function Ce(be){return te(re(H(be,K,ze),q,ie),ne,Fe)}function Ee(be){var _t=(e(be)-e(K)*e(ze))/(t(K)*t(ze));return _t<-1?D.PolarException.MIDNIGHT_SUN:_t>1?D.PolarException.POLAR_NIGHT:D.PolarException.NORMAL}var je,nt,Mt,st,Be,Ve={solarNoon:f(Ye),nadir:f(Ye-.5),polarException:D.PolarException.NORMAL};for(je=0,nt=I.length;je<nt;je+=1)Be=Ye-((st=Ce((Mt=I[je])[0]*o))-Ye),Ve[Mt[1]]=f(Be),Ve[Mt[2]]=f(st);return Ve.polarException=Ee(I[0][0]*o),Ve},D.getMoonPosition=function(U,L,z){var q=o*-z,K=o*L,ie=_(U),Z=M(ie),ne=T(ie,q)-Z.ra,Ae=x(ne,K,Z.dec);return Ae+=.017*o/r(Ae+10.26*o/(Ae+5.1*o)),{azimuth:b(ne,K,Z.dec),altitude:Ae,distance:Z.dist}},D.getMoonFraction=function(U){var L=_(U),z=$(L),q=M(L),K=149598e3,ie=a(e(z.dec)*e(q.dec)+t(z.dec)*t(q.dec)*t(z.ra-q.ra)),Z=s(K*e(ie),q.dist-K*t(ie));return(1+t(Z))/2},D},(lU=oU())!==void 0&&(aU.exports=lU);const Hg=TZ.exports,Lh={local:{altitude:1500,ambientAtNight:.1,ambientAtNoon:.45,ambientAtTwilight:.2,directAtNoon:.65,directAtTwilight:.7},global:{altitude:8e5,ambient:.015,direct:.75},planarDirection:{localAltitude:1e4,globalAltitude:1e6,globalAngles:{azimuth:1.3*Math.PI,altitude:.6*Math.PI}}};function n1e(i,e,t,r,n,s){Y(s.ambient.color,1,1,1),s.ambient.intensity=Lh.global.ambient,Y(s.direct.color,1,1,1),s.direct.intensity=Lh.global.direct;const a=e[2],o=ue((Math.abs(a)-Lh.local.altitude)/(Lh.global.altitude-Lh.local.altitude),0,1);let l;if(s.globalFactor=o,y(i)&&(l=Hg.getTimes(i,e[1],e[0])),o<1){let c;if(y(i))c=u1e(i,l,r);else{const u=EZ(r);c={direct:{intensity:Lh.local.directAtNoon*u.direct,color:Ze(1,1,1)},ambient:{intensity:Lh.local.ambientAtNoon*u.ambient,color:Ze(1,1,1)},timeOfDay:"early afternoon"}}Bn(s.ambient.color,c.ambient.color,s.ambient.color,o),s.ambient.intensity=bt(c.ambient.intensity,s.ambient.intensity,o),Bn(s.direct.color,c.direct.color,s.direct.color,o),s.direct.intensity=bt(c.direct.intensity,s.direct.intensity,o),s.specularStrength=r==="rainy"||r==="snowy"||r==="foggy"?0:1,s.environmentStrength=r==="rainy"?.7:r==="snowy"||r==="foggy"?.75:1}s.noonFactor=y(i)?h1e(i,l):1,y(i)?s1e(i,e,t,s.direct.directionToLightSource):CZ(n,t,s.direct.directionToLightSource)}function CZ(i,e,t){e===Ie.Global?de(LO,i.eye):Y(LO,0,0,1),Q($O,i.viewForward,-1);const r=nE($O,LO),n=Math.max(r-2*DO,0),s=.85*n/(n+1),a=Math.max(DO,r-DO-s);Bc(hU,-a,i.viewRight),Me(t,$O,hU),ce(t,t,Q(d1e,i.viewRight,p1e)),de(t,t)}function s1e(i,e,t,r){const n=c1e,s=Mg(l1e);if(t===Ie.Global)Hg.getPosition(i,0,0,n),Y(r,0,0,-1),Cw(s,s,-n.azimuth),MD(s,s,-n.altitude),Me(r,r,s);else{const a=Lh.planarDirection,o=a.globalAngles,l=e[2];let c=(Math.abs(l)-a.localAltitude)/(a.globalAltitude-a.localAltitude);c=ue(c,0,1),c<1?(Hg.getPosition(i,e[1],e[0],n),n.azimuth=(1-c)*n.azimuth+c*o.azimuth,n.altitude=(1-c)*n.altitude+c*o.altitude):(n.azimuth=o.azimuth,n.altitude=o.altitude),Y(r,0,-1,0),Tw(s,s,-n.azimuth),Cw(s,s,-n.altitude),Me(r,r,s)}}function a1e(i,e){if(e===Ie.Global)return!0;const t=Lh.planarDirection;return Math.abs(i)<t.localAltitude}const o1e=Ze(.5773502691896258,-.5773502691896258,.5773502691896258);let SZ=class{constructor(){this.ambient={color:Ze(1,1,1),intensity:.55},this.direct={color:Ze(1,1,1),intensity:.55,directionToLightSource:as(o1e)},this.noonFactor=.5,this.globalFactor=0,this.specularStrength=1,this.environmentStrength=1}};const l1e=xe(),c1e={azimuth:0,altitude:0};function h1e(i,e){const t=i.valueOf();let r,n;e.polarException===Hg.PolarException.MIDNIGHT_SUN?(r=t-60*(i.getHours()+48)*60*1e3-60*i.getMinutes()*1e3,n=r+432e6):e.polarException===Hg.PolarException.POLAR_NIGHT?(r=t-2,n=t-1):(r=e.sunrise.valueOf(),n=e.sunset.valueOf());const s=r+(n-r)/2;return 1-ue(Math.abs(t-s)/432e5,0,1)}function EZ(i){switch(i){case"disabled":case"sunny":case"cloudy":return{direct:1,ambient:1};case"rainy":return{direct:.4,ambient:1.2};case"snowy":return{direct:.5,ambient:1.3};case"foggy":return{direct:.2,ambient:1.6}}}function cU(i,e){const t=(i[0]+i[1]+i[2])/3;for(let r=0;r<3;r++)i[r]=i[r]+(t-i[r])*e;return i}function u1e(i,e,t){const r=i.valueOf();let n,s;e.polarException===Hg.PolarException.MIDNIGHT_SUN?(n=r-60*(i.getHours()+48)*60*1e3-60*i.getMinutes()*1e3,s=n+432e6):e.polarException===Hg.PolarException.POLAR_NIGHT?(n=r-2,s=r-1):(n=e.sunrise.valueOf(),s=e.sunset.valueOf());const a=s-n,o=n+a/2,l=a/4,c=o-l,u=o+l,d=.06*a,m=n-d/2,f=n+d/2,_=s-d/2,g=s+d/2,w=Lh.local,v=[.01,w.ambientAtNight],b=[.8,.8,1],x=[.01,.01,.01],T=[w.directAtTwilight,w.ambientAtTwilight],R=[1,.6,.5],E=[.8,.8,1],O=[.9*w.directAtNoon,w.ambientAtNoon],$=[1,.98,.98],D=[.98,.98,1],I=[w.directAtNoon,w.ambientAtNoon],G=[1,1,1],W=[1,1,1],re=O,te=$,H=D,M=T,U=R,L=E;let z,q,K=[0,0],ie=[0,0,0],Z=[0,0,0];r<m||r>g?(K=v,ie=x,Z=b,q="night"):r<f?(z=f-m,K=Wn(r-m,z,v,T),ie=Wn(r-m,z,x,R),Z=Wn(r-m,z,b,E),q="sun rising"):r<c?(z=c-f,K=Wn(r-f,z,T,O),ie=Wn(r-f,z,R,$),Z=Wn(r-f,z,E,D),q="early morning"):r<o?(z=o-c,K=Wn(r-c,z,O,I),ie=Wn(r-c,z,$,G),Z=Wn(r-c,z,D,W),q="late morning"):r<u?(z=u-o,K=Wn(r-o,z,I,re),ie=Wn(r-o,z,G,te),Z=Wn(r-o,z,W,H),q="early afternoon"):r<_?(z=_-u,K=Wn(r-u,z,re,M),ie=Wn(r-u,z,te,U),Z=Wn(r-u,z,H,L),q="late afternoon"):r<g&&(z=g-_,K=Wn(r-_,z,M,v),ie=Wn(r-_,z,U,x),Z=Wn(r-_,z,L,b),q="sun setting");let ne=0;switch(t){case"rainy":case"foggy":ne=.9;case"snowy":ne=.5}ne>0&&(ie=cU(ie,ne),Z=cU(Z,ne));const Ae=Ze(ie[0],ie[1],ie[2]),Fe=Ze(Z[0],Z[1],Z[2]),ze=EZ(t);return{direct:{intensity:K[0]*ze.direct,color:Ae},ambient:{intensity:K[1]*ze.ambient,color:Fe},timeOfDay:q}}function Wn(i,e,t,r){const n=[];for(let s=0;s<t.length;s++)n[s]=(r[s]-t[s])*i/e+t[s];return n}const hU=xe(),LO=P(),$O=P(),d1e=P(),DO=.25,p1e=.2;let sc=class extends nn.EventedAccessor{constructor(){super(),this._referencePointUpdateDelay=200,this._referencePointUpdateInterval=3e3,this._referencePointUpdateDistThreshold=1e6,this._referencePosUpdateQuery=null,this._referencePosMapCoordsRequested=null,this._viewHandles=new Vt,this._preserveAbsoluteDateTime=!1,this._trackingEnabled=!1,this._referencePosResetPreserveAbsoluteTime=!1,this._referencePosUpdateTimer=null,this._referencePosMapCoords=null,this._mainLight=new Ine,this._ambientLight=new qG,this._moonLight=new Lne,this.disableQueries=!1,this._disableWeather=!1,this._renderer=null,this._referencePosWGS84Comparable=null,this._resetReferencePosition()}destroy(){this.disconnectView(),this._viewHandles.destroy()}get _view(){var e;return(e=this._renderer)==null?void 0:e.view}get updating(){var e;return!((this.disableQueries||!this._referencePosUpdateQuery&&!this._referencePosMapCoordsRequested)&&!((e=this._renderer)!=null&&e.updating))}get weatherEnabled(){var e,t,r;return((e=this._view)==null?void 0:e.environment.atmosphereEnabled)&&!this._disableWeather&&((r=(t=this._view)==null?void 0:t.state)==null?void 0:r.viewingMode)===Ie.Global&&DE(this._view.spatialReference)}get weatherVisible(){var e;return this.weatherEnabled&&((e=this._renderer)==null?void 0:e.weatherVisible)}get referencePositionWGS84Comparable(){return this._referencePosWGS84Comparable}connectView(e){if(this._renderer)return;this._renderer=new gs({view:e});const t=()=>this._updateRenderParameters(),r=()=>this._cameraHandler();this._viewHandles.add([B(()=>e.environment.lighting,n=>this._updateLightingHandler(n),ni),B(()=>e.environment.lighting.type!=="virtual"?e.environment.lighting.date:null,n=>this._lightingDateHandler(n),ni),B(()=>e.stationary,()=>this._interactingStationaryHandler()),B(()=>e.environment.lighting.directShadowsEnabled,t,ni),B(()=>e.environment.lighting.ambientOcclusionEnabled,t,ni),B(()=>e.environment.lighting.waterReflectionEnabled,t,ni),B(()=>{var n;return(n=e.environment.background)==null?void 0:n.color},t,ni),B(()=>e.spatialReference,()=>this._resetReferencePosition(!0),ni),B(()=>e.environment.weather.type,()=>this._updateLighting(null,N0.Faded),ni),B(()=>this.weatherEnabled,()=>this._updateLighting(null,N0.Faded),ni),B(()=>e.viewingMode,()=>this._resetReferencePosition(!0),Mi),B(()=>e.environment.lighting.type!=="virtual"&&e.environment.lighting.cameraTrackingEnabled,n=>this._updateCameraTracking(n),Mi),B(()=>e.state.camera,r,Mi),B(()=>this.disableQueries,r)]),this._updateRenderParameters(),this._updateLighting(),this._cameraHandler(),this.notifyChange("updating")}disconnectView(){this._viewHandles.removeAll(),this._resetReferencePosition(),this._renderer=Oe(this._renderer)}_updateLightingHandler(e){this._updateCameraTracking(e.type!=="virtual"&&e.cameraTrackingEnabled),this._lightingDateHandler(e.type!=="virtual"?e.date:null),this._updateRenderParameters()}_updateCameraTracking(e){if(this._trackingEnabled=e,e)this._cameraHandler();else{const t=this._view.environment.lighting;(t==null?void 0:t.type)!=="virtual"&&(t.positionTimezoneInfo.autoUpdated=!1)}}_lightingDateHandler(e){const t=this._view.environment.lighting;if((t==null?void 0:t.type)!=="virtual"){if(e){if(!t.positionTimezoneInfo.autoUpdated){this._preserveAbsoluteDateTime=!0;const r=this._view.spatialReference;if(!Pg(r)){const n=this._view.camera.position;if(!this._referencePosMapCoords||!this._referencePosMapCoords.equals(n))return void this._requestReferencePositionUpdate(n)}if(this._preupdateTracking(e),y(this._referencePosWGS84Comparable)){const n=sU(this._referencePosWGS84Comparable,uU);y(n)&&(t.autoUpdate(null,n),this._trackingEnabled&&(t.positionTimezoneInfo.autoUpdated=!0))}}this._updateLighting(e)}}else this._updateLighting()}_preupdateTracking(e){!this._trackingEnabled&&this._view.environment.lighting.type!=="virtual"&&this._view.environment.lighting.cameraTrackingEnabled&&this._cameraHandler(e)}_cameraHandler(e=null){const t=this._view;if(!t.ready)return;const r=t.stateManager.camera;r&&(this._cameraHandlerClientSide(r,e)||this._cameraHandlerServerSide(r))}_cameraHandlerClientSide(e,t){const r=DE(this._view.spatialReference);if(r&&!Pg(this._view.spatialReference))return this._view.environment.lighting.type==="virtual"&&this._updateLighting(),!1;const n=e.position;return C(this._referencePosWGS84Comparable)&&(this._referencePosWGS84Comparable=P()),r?Qte(n,this._referencePosWGS84Comparable):Y(this._referencePosWGS84Comparable,n.longitude,n.latitude,n.z),this.notifyChange("referencePositionWGS84Comparable"),this._autoUpdateTimezone(this._referencePosWGS84Comparable,t)||this._updateLighting(t),!0}_cameraHandlerServerSide(e){const t=e.position;(!this._referencePosMapCoords||this._referencePosMapCoordsRequested||this._exceedsReferencePosDistThreshold(t))&&this._requestReferencePositionUpdate(t,!0),this._view.mapCoordsHelper&&this._referencePosWGS84Comparable&&(this._referencePosWGS84Comparable[2]=t.z*this._view.mapCoordsHelper.unitInMeters,this._referencePosChanged())}_interactingStationaryHandler(){this._view.stationary&&this._executePendingReferencePositionUpdate()}_updateLighting(e,t=N0.Immediate){const r=this._view;e=e||(r.environment.lighting.type==="virtual"?null:r.environment.lighting.date);const n=this._referencePosWGS84Comparable,s=y(n)?m1e:f1e,a=this.weatherVisible?r.environment.weather.type:"disabled";y(n)?n1e(e,n,r.state.viewingMode,a,r.state.camera,s):r.environment.lighting.type==="virtual"&&CZ(r.state.camera,r.state.viewingMode,s.direct.directionToLightSource);const o=this._mainLight,l=s.direct;Q(o.intensity,l.color,l.intensity*Math.PI),X(o.direction,l.directionToLightSource),o.specularStrength=s.specularStrength,o.environmentStrength=s.environmentStrength;const c=this._ambientLight;Q(c.intensity,s.ambient.color,s.ambient.intensity);const u=this._moonLight;Bn(u.intensity,_1e,y1e,s.globalFactor);const d=(1-.5*s.globalFactor)*(1-.4*s.noonFactor*(1-s.globalFactor));Q(u.intensity,u.intensity,d),X(u.direction,l.directionToLightSource),this._renderer.updateLightSources([o,c,u],s.noonFactor,s.globalFactor,t),this._updateRenderParameters()}_autoUpdateTimezone(e,t=null){if(this._view.environment.lighting.type==="virtual"||!this._view.environment.lighting.cameraTrackingEnabled||C(e))return!1;const r=g1e;r.setTime((t||this._view.environment.lighting.date).getTime());const n=sU(e,uU);if(C(n))return!1;let s=this._view.environment.lighting.positionTimezoneInfo;if(s.autoUpdated){if(s.hours===n.hours&&s.minutes===n.minutes&&s.seconds===n.seconds)return!1}else s=n;const a=r.getUTCHours()-(n.hours-s.hours),o=r.getUTCMinutes()-(n.minutes-s.minutes),l=r.getUTCSeconds()-(n.seconds-s.seconds);return r.setUTCHours(a),r.setUTCMinutes(o),r.setUTCSeconds(l),!t&&this._view.environment.lighting.autoUpdate(r,n)}_updateRenderParameters(){const e=this._view._stage;if(!e)return;const t=Np(this._referencePosWGS84Comparable,!0,s=>a1e(s[2],this._view.state.viewingMode)),r=this._view.environment.background,n=r instanceof QQ?{type:"color",color:fne(ti.toUnitRGBA(r.color))}:{type:"color",color:Bi(0,0,0,1)};e.renderView.setRenderParameters({shadowMap:this._view.environment.lighting.directShadowsEnabled&&t,background:n,environment:this._view.environment,weatherVisible:this._view.environmentManager.weatherVisible})}_resetReferencePosition(e=!1){this._cancelReferencePosUpdates(),this._referencePosMapCoords=null,this._referencePosMapCoordsRequested=null,this._referencePosResetPreserveAbsoluteTime=null,this._referencePosWGS84Comparable=null,this.notifyChange("updating"),e&&this._cameraHandler()}_requestReferencePositionUpdate(e,t=!1){if(!this.disableQueries&&(this._referencePosMapCoordsRequested?this._referencePosMapCoordsRequested.copy(e):this._referencePosMapCoordsRequested=e.clone(),this._referencePosResetPreserveAbsoluteTime=!!t,!this._referencePosUpdateQuery&&!this._referencePosUpdateTimer&&this._view.stationary)){const r=this._referencePosUpdateQuery=j0(this._referencePointUpdateDelay).then(()=>{if(this._referencePosUpdateQuery===r){const s=()=>this._referencePosUpdateQuery!==r;return this._doReferencePositionUpdateQuery(s)}}).catch(s=>{s.name==="mapcoordshelper:missing-geometry-service"&&(this.disableQueries=!0)}).then(()=>{this._referencePosUpdateQuery===r&&(this._referencePosUpdateQuery=null,this._referencePosUpdateTimer||this._executePendingReferencePositionUpdate(),this.notifyChange("updating"))}),n=this._referencePosUpdateTimer=j0(this._referencePointUpdateInterval).then(()=>{this._referencePosUpdateTimer===n&&(this._referencePosUpdateTimer=null,this._referencePosUpdateQuery||this._executePendingReferencePositionUpdate())});this.notifyChange("updating")}}async _doReferencePositionUpdateQuery(e){this._referencePosResetPreserveAbsoluteTime&&(this._preserveAbsoluteDateTime=!1),this._referencePosMapCoords?this._referencePosMapCoords.copy(this._referencePosMapCoordsRequested):this._referencePosMapCoords=this._referencePosMapCoordsRequested.clone(),this._referencePosResetPreserveAbsoluteTime=null,this._referencePosMapCoordsRequested=null;const t=await this._view.mapCoordsHelper.toGeographic(this._referencePosMapCoords);if(!e()&&!isNaN(t[0])&&!isNaN(t[1])){const r=this._referencePosMapCoords.z*this._view.mapCoordsHelper.unitInMeters;this._referencePosWGS84Comparable?(this._referencePosWGS84Comparable[0]=t[0],this._referencePosWGS84Comparable[1]=t[1],this._referencePosWGS84Comparable[2]=r):this._referencePosWGS84Comparable=[t[0],t[1],r],this._referencePosChanged()}}_executePendingReferencePositionUpdate(){const e=this._referencePosMapCoordsRequested;e&&this._requestReferencePositionUpdate(e,this._referencePosResetPreserveAbsoluteTime)}_referencePosChanged(){this._preserveAbsoluteDateTime?this._updateLighting():this._autoUpdateTimezone(this._referencePosWGS84Comparable)||this._updateLighting(),this.notifyChange("referencePositionWGS84Comparable")}_exceedsReferencePosDistThreshold(e){if(this._referencePosMapCoords){let t=this._referencePosMapCoords.distance(e);return this._view.mapCoordsHelper&&(t*=this._view.mapCoordsHelper.unitInMeters),t>this._referencePointUpdateDistThreshold}return!0}_cancelReferencePosUpdates(){const e=!!this._referencePosUpdateQuery;return this._referencePosUpdateQuery=null,this._referencePosUpdateTimer=null,e}get test(){const e=this;return{get renderer(){return e._renderer},set referencePointUpdateInterval(t){e._referencePointUpdateInterval=t},set referencePointUpdateDistThreshold(t){e._referencePointUpdateDistThreshold=t},set referencePosUpdateTimer(t){e._referencePosUpdateTimer=t},set referencePointUpdateDelay(t){e._referencePointUpdateDelay=t},set disableWeather(t){e._disableWeather=t}}}};h([p({type:Boolean,readOnly:!0})],sc.prototype,"updating",null),h([p()],sc.prototype,"disableQueries",void 0),h([p()],sc.prototype,"_disableWeather",void 0),h([p()],sc.prototype,"weatherEnabled",null),h([p()],sc.prototype,"weatherVisible",null),h([p()],sc.prototype,"referencePositionWGS84Comparable",null),h([p()],sc.prototype,"_renderer",void 0),h([p()],sc.prototype,"_referencePosWGS84Comparable",void 0),sc=h([F("esri.views.3d.environment.SceneViewEnvironmentManager")],sc);const m1e=new SZ,f1e=new SZ,g1e=new Date,uU={hours:0,minutes:0,seconds:0},_1e=Ze(.22,.22,.33),y1e=Ze(.22,.22,.22);var xi;(function(i){i[i.NONE=0]="NONE",i[i.TILT=1]="TILT",i[i.ALTITUDE=2]="ALTITUDE",i[i.DISTANCE=4]="DISTANCE",i[i.COLLISION=8]="COLLISION",i[i.ALL=15]="ALL",i[i.ALL_EXCEPT_COLLISION=7]="ALL_EXCEPT_COLLISION"})(xi||(xi={}));var ht;(function(i){i[i.NONE=0]="NONE",i[i.ZOOM=1]="ZOOM",i[i.TUMBLE=2]="TUMBLE",i[i.LOOK_AROUND=3]="LOOK_AROUND",i[i.PAN=4]="PAN",i[i.ASCEND=5]="ASCEND"})(ht||(ht={}));var vn;(function(i){i[i.TUMBLE=0]="TUMBLE",i[i.LOOK_AROUND=1]="LOOK_AROUND"})(vn||(vn={}));function ux(i,e){return(i&e)!=0}function W2(i,e,t,r,n,s){i!==0&&(t?(s.min=Math.min(s.min,e),s.max=Math.max(s.max,e)):r!=null?(s.min-=Math.max(0,(e-s.min)*(1-r)),s.max+=Math.max(0,(e-s.max)*(1-r))):n&&(s.min-=Math.max(0,e-s.min-n),s.max+=Math.max(0,e-s.max-n)))}const Vm={selection:xi.NONE,interactionType:ht.NONE,interactionFactor:0,interactionStartCamera:null,interactionDirection:null,tiltMode:vn.TUMBLE};function RZ(i,e,t,r){return e=e||i.viewForward,X(r,e),Q(r,r,Math.sign(_e(e,t))),r}function v1e(i,e,t,r){return C1e(i,e,t,x1e(r,e,t,!0))}function b1e(i,e,t,r){const n=_e(t,ae(i,r,e));return ce(i,e,Q(i,t,n))}const w1e={dir:P(),len:0,clip:Te()};function x1e(i,e,t,r){const n=w1e;return i?(t&&r&&(n.len=Li(e,t)),X(n.dir,i)):r?(n.len=Li(e,t),ae(n.dir,t,e),Q(n.dir,n.dir,1/n.len)):(ae(n.dir,t,e),de(n.dir,n.dir)),n}function T1e(i,e,t){const r=_e(Ia(i),t.dir),n=-tr(i,e);if(n<0&&r>=0)return!1;if(r>-1e-6&&r<1e-6)return n>0;if((n<0||r<0)&&!(n<0&&r<0))return!0;const s=n/r;return r>0?s<t.clip[1]&&(t.clip[1]=s):s>t.clip[0]&&(t.clip[0]=s),t.clip[0]<=t.clip[1]}function C1e(i,e,t,r){r.clip[0]=0,r.clip[1]=t?r.len:Number.MAX_VALUE;for(let n=0;n<i.length;n++)if(!T1e(i[n],e,r))return!1;return!0}function S1e(i,e,t=Vm){const r=YN(i,e,t);if(r===0)return!1;const n=i.renderCoordsHelper,s=n.getAltitude(e.eye)+r,a=RZ(e,t.interactionDirection,P1e(i,e,Math.sign(r),I1e),M1e),o=X(L1e,e.viewForward),l=n.intersectInfiniteManifold(zc(e.eye,a),s,FO);return e.eye=y(l)?l:n.setAltitude(FO,s,e.eye),e.center=b1e(FO,e.eye,o,e.center),!0}function YN(i,e,t=Vm){if(!E1e(i,t))return 0;const r=A1e(i.state.constraints.altitude,O1e);R1e(i,t,r);const n=i.renderCoordsHelper.getAltitude(e.eye),s=ue(n,r.min,r.max)-n;return Math.abs(s)<=1e-6?0:s}function E1e(i,e){const t=i.state.constraints.altitude;return!(!i.state.isGlobal||!t)&&(e.interactionType!==ht.TUMBLE||!ux(e.selection,xi.TILT))}function R1e(i,e,t){const r=e.interactionType;if(r===ht.NONE)return;const{min:n,max:s}=t,{interactionStartCamera:a,interactionFactor:o}=e,l=r===ht.TUMBLE||r===ht.ZOOM,c=YN(i,a),u=c===0?0:i.renderCoordsHelper.getAltitude(a.eye);t.min=n,t.max=s,W2(c,u,l,o,.05*u,t)}function P1e(i,e,t,r){return i.renderCoordsHelper.worldUpAtPosition(e.eye,r),Q(r,r,t),r}function A1e(i,e){return e.min=i.min,e.max=i.max,e}const O1e={min:0,max:0},M1e=P(),I1e=P(),L1e=P(),FO=P();function KN(i,e,t=Vm){if(!i.state.isLocal)return 0;const r=i.state.constraints.distance;if(!i.pointsOfInterest.surfaceOrigin.renderLocation||r===1/0)return 0;JT.min=0,JT.max=r,D1e(i,t,JT);const n=JN(i,e),s=JT.max-n;return s>=-1e-6?0:s}function $1e(i,e,t=Vm){const r=KN(i,e,t);if(r===0)return!1;const n=i.pointsOfInterest.surfaceOrigin,s=JN(i,e)+r,a=X(N1e,e.eye),o=RZ(e,t.interactionDirection,F1e(i,e,U1e),V1e);if(!FR(Bre(n.renderLocation,s),zc(e.eye,o),eC))return!1;e.eye=eC;const l=ae(k1e,e.eye,a);e.center=ce(eC,e.center,l);const c=i.renderCoordsHelper.getAltitude(e.center),u=i.renderCoordsHelper.intersectInfiniteManifold(e.ray,c,eC);return y(u)&&(e.center=u),!0}function D1e(i,e,t){const r=e.interactionType;if(r===ht.NONE)return;const{min:n,max:s}=t,{interactionStartCamera:a,interactionFactor:o}=e,l=r===ht.ZOOM||r===ht.PAN,c=KN(i,a),u=c===0?0:JN(i,a);t.min=n,t.max=s,W2(c,u,l,o,.05*u,t)}function JN(i,e){const t=i.pointsOfInterest.surfaceOrigin;return Li(e.eye,t.renderLocation)}function F1e(i,e,t){const r=i.pointsOfInterest.surfaceOrigin;return Jg(t,e.eye,r.renderLocation)}const JT={min:0,max:0},N1e=P(),k1e=P(),V1e=P(),U1e=P(),eC=P();var Ui,zn;(function(i){i[i.OBJECT=0]="OBJECT",i[i.HUD=1]="HUD",i[i.TERRAIN=2]="TERRAIN",i[i.OVERLAY=3]="OVERLAY",i[i.I3S=4]="I3S",i[i.PCL=5]="PCL",i[i.LOD=6]="LOD",i[i.VOXEL=7]="VOXEL"})(Ui||(Ui={}));let z1e=class{constructor(){this.verticalOffset=0,this.selectionMode=!1,this.hud=!0,this.selectOpaqueTerrainOnly=!0,this.invisibleTerrain=!1,this.backfacesTerrain=!0,this.isFiltered=!1,this.store=zn.ALL}};(function(i){i[i.MIN=0]="MIN",i[i.MINMAX=1]="MINMAX",i[i.ALL=2]="ALL"})(zn||(zn={}));function hu(i){return y(i)&&y(i.dist)}function dU(i){return(e,t,r)=>(Bn(pU,e,t,r),!GN(i,pU))}function OP(i){return hu(i)&&i.intersector===Ui.OBJECT&&!!i.target}function MP(i){return hu(i)&&i.intersector===Ui.HUD&&!!i.target&&y(i.target.center)}const pU=P(),lv=1e-5;let B1e=class{constructor(e){this.options=new z1e,this._results=new G1e,this.transform=new lse,this.tolerance=lv,this.verticalOffset=null,this._ray=oo(),this._rayEnd=P(),this._rayBeginTransformed=P(),this._rayEndTransformed=P(),this.viewingMode=e??Ie.Global}get results(){return this._results}get ray(){return this._ray}get rayBegin(){return this._ray.origin}get rayEnd(){return this._rayEnd}reset(e,t,r){this.resetWithRay(Gre(e,t,this._ray),r)}resetWithRay(e,t){this.camera=t,e!==this._ray&&LI(e,this._ray),this.options.verticalOffset!==0?this.viewingMode===Ie.Local?this._ray.origin[2]-=this.options.verticalOffset:this.verticalOffset=this.options.verticalOffset:this.verticalOffset=null,ce(this._rayEnd,this._ray.origin,this._ray.direction),this._results.init(this._ray)}intersect(e=null,t,r,n,s){this.point=t,this.filterPredicate=n,this.tolerance=r??lv;const a=ik(this.verticalOffset);if(y(e)&&e.length>0){const o=s?l=>{s(l)&&this.intersectObject(l)}:l=>{this.intersectObject(l)};for(const l of e){const c=l.getSpatialQueryAccelerator&&l.getSpatialQueryAccelerator();y(c)?(y(a)?c.forEachAlongRayWithVerticalOffset(this._ray.origin,this._ray.direction,o,a):c.forEachAlongRay(this._ray.origin,this._ray.direction,o),this.options.selectionMode&&this.options.hud&&c.forEachDegenerateObject(o)):l.objects.forAll(u=>o(u))}}this.sortResults()}intersectObject(e){const t=e.geometryRecords;if(!t)return;const r=e.transformation,n=ik(this.verticalOffset);for(const s of t){const{geometry:a,material:o,instanceParameters:l}=s;if(UR(l))continue;const c=a.id;this.transform.setAndInvalidateLazyTransforms(r,s.getShaderTransformation()),Me(this._rayBeginTransformed,this.rayBegin,this.transform.inverse),Me(this._rayEndTransformed,this.rayEnd,this.transform.inverse);const u=this.transform.transform;y(n)&&(n.objectTransform=this.transform),o.intersect(a,l,this.transform.transform,this,this._rayBeginTransformed,this._rayEndTransformed,(d,m,f,_,g,w)=>{if(d>=0){if(y(this.filterPredicate)&&!this.filterPredicate(this._ray.origin,this._rayEnd,d))return;const v=_?this._results.hud:this._results,b=_?x=>{const T={object:e,geometryId:c,triangleNr:f,center:y(w)?[w[0],w[1],w[2]]:null};x.set(Ui.HUD,T,d,m,rn,g)}:x=>x.set(Ui.OBJECT,{object:e,geometryId:c,triangleNr:f},d,m,u,g);if((v.min.drapedLayerOrder==null||g>=v.min.drapedLayerOrder)&&(v.min.dist==null||d<v.min.dist)&&b(v.min),this.options.store!==zn.MIN&&(v.max.drapedLayerOrder==null||g<v.max.drapedLayerOrder)&&(v.max.dist==null||d>v.max.dist)&&b(v.max),this.options.store===zn.ALL)if(_){const x=new H3(this._ray);b(x),this._results.hud.all.push(x)}else{const x=new k0(this._ray);b(x),this._results.all.push(x)}}},s.shaderTransformation)}}sortResults(e=this._results.all){e.sort((t,r)=>t.dist!==r.dist?Ke(t.dist,0)-Ke(r.dist,0):t.drapedLayerOrder!==r.drapedLayerOrder?Ke(t.drapedLayerOrder,Number.MAX_VALUE)-Ke(r.drapedLayerOrder,Number.MAX_VALUE):Ke(r.drapedLayerGraphicOrder,Number.MIN_VALUE)-Ke(t.drapedLayerGraphicOrder,Number.MIN_VALUE))}};function Xl(i){return new B1e(i)}let G1e=class{constructor(){this.min=new k0(oo()),this.max=new k0(oo()),this.hud={min:new H3(oo()),max:new H3(oo()),all:new Array},this.ground=new k0(oo()),this.all=[]}init(e){this.min.init(e),this.max.init(e),this.ground.init(e),this.all.length=0,this.hud.min.init(e),this.hud.max.init(e),this.hud.all.length=0}},k0=class{constructor(e){this.intersector=Ui.OBJECT,this.normal=P(),this.transformation=xe(),this._ray=oo(),this.init(e)}get ray(){return this._ray}get distanceInRenderSpace(){return y(this.dist)?(Q(tC,this.ray.direction,this.dist),we(tC)):null}getIntersectionPoint(e){return!!hu(this)&&(Q(tC,this.ray.direction,this.dist),ce(e,this.ray.origin,tC),!0)}getTransformedNormal(e){return X(o1,this.normal),o1[3]=0,sd(o1,o1,this.transformation),X(e,o1),de(e,e)}init(e){this.dist=null,this.target=null,this.drapedLayerOrder=null,this.drapedLayerGraphicOrder=null,this.intersector=Ui.OBJECT,LI(e,this._ray)}set(e,t,r,n,s,a,o){this.intersector=e,this.dist=r,X(this.normal,Ke(n,Nre)),pn(this.transformation,Ke(s,rn)),this.target=t,this.drapedLayerOrder=a,this.drapedLayerGraphicOrder=o}copy(e){LI(e.ray,this._ray),this.intersector=e.intersector,this.dist=e.dist,this.target=e.target,this.drapedLayerOrder=e.drapedLayerOrder,this.drapedLayerGraphicOrder=e.drapedLayerGraphicOrder,X(this.normal,e.normal),pn(this.transformation,e.transformation)}},H3=class extends k0{constructor(){super(...arguments),this.intersector=Ui.HUD}};function e4(i){return new k0(i)}const tC=P(),o1=yi();function PZ(i,e,t,r){return y(i.renderCoordsHelper.fromRenderCoords(e.eye,X2,r))&&CG(t,X2)}function IP(i,e){return i.elevationProvider?Ke(i.elevationProvider.getElevation(e[0],e[1],e[2],i.renderCoordsHelper.spatialReference,"ground"),0):0}function h_(i,e,t,r){const n=i.state.camera.clone();e&&(n.eye=e,n.center=t,n.up=r),H1e(i,n.ray,Jd)||X(Jd,n.center);const s=i.state.constraints,a=s.minimumPoiDistance;if(Bl(n.eye,Jd)<a){const o=s.collision.enabled;X(ef,n.viewForward),Q(ef,ef,a),o?n.eye=ae(X2,Jd,ef):ce(Jd,n.eye,ef);const l=i.renderCoordsHelper,c=l.getAltitude(n.eye),u=s.collision.elevationMargin;o&&c<u&&(ae(ef,Jd,n.eye),n.eye=l.setAltitude(X2,u,n.eye),ce(Jd,n.eye,ef))}return n.center=Jd,n}function mU(i,e,t){if(!i.state.isGlobal)return!1;const r=IP(i,e),n=i.stateManager.constraintsManager.nearFarHeuristic,{far:s}=n.compute(e,t,i.renderDataExtent,r,q1e),a=s*s;return Bl(e,t)>a}function H1e(i,e,t){let r=fU[i.viewingMode];r||(r=Xl(i.state.viewingMode),r.options.backfacesTerrain=!i.state.isGlobal,r.options.invisibleTerrain=!0,fU[i.viewingMode]=r);const{isGlobal:n}=i.state;return!(!i.sceneIntersectionHelper.intersectRay(e,r,t)||mU(i,e.origin,t))||!(!i.renderCoordsHelper.intersectManifold(e,0,t)||mU(i,e.origin,t))||!!n&&j1e(e,t,Kt(i.spatialReference).radius)}function j1e(i,e,t){const r=_e(i.origin,i.origin)-t*t,n=r>0?Math.sqrt(r)/3:1;return Q(e,i.direction,n/we(i.direction)),ce(e,e,i.origin),!0}const fU={},X2=P(),Jd=P(),ef=P(),q1e={near:0,far:0};function Rv(i,e,t=zl.EYE){const r=i.state.constraints;if(!r.collision.enabled)return!1;const n=IP(i,e.eye),s=i.renderCoordsHelper.getAltitude(e.eye),a=n+r.collision.elevationMargin;if(s>=a)return!1;const o=we(e.eye);if(ae(iC,e.center,e.eye),e.eye=i.renderCoordsHelper.setAltitude(W1e,a,e.eye),t===zl.EYE_AND_CENTER)e.center=ce(iC,e.eye,iC);else if(t===zl.EYE_AND_CENTER_SCALE){const l=(o-s+a)/o;e.center=Q(iC,e.center,l)}return!0}var zl;(function(i){i[i.EYE=0]="EYE",i[i.EYE_AND_CENTER=1]="EYE_AND_CENTER",i[i.EYE_AND_CENTER_SCALE=2]="EYE_AND_CENTER_SCALE"})(zl||(zl={}));const iC=P(),W1e=P();function Um(i,e,t){i.worldUpAtPosition(e,gU),ae(NO,t,e);const r=we(NO);return r===0?0:ls(_e(NO,gU)/r)}const gU=P(),NO=P();function AZ(i,e,t=Vm,r=!0){l1.eyeCenterDistance=0,l1.requiresTwoSteps=!1;const n=t4(i,e,t,void 0,l1);if(n===0)return!1;switch(Bc(rC,-n,e.viewRight),t.tiltMode){case vn.LOOK_AROUND:Me(ep,e.viewForward,rC),Q(ep,ep,l1.eyeCenterDistance),e.center=ce(Zp,e.eye,ep);break;case vn.TUMBLE:ae(ep,e.center,e.eye),Me(ep,ep,rC),e.eye=ae(Zp,e.center,ep);break;default:Ra(t.tiltMode)}return e.up=Me(Zp,e.up,rC),!l1.requiresTwoSteps||!r||AZ(i,e,t,!1)}function t4(i,e,t=Vm,r=Vm,n){if(!i.state.constraints.tilt)return 0;const s=e.distance,a=i.state.constraints.tilt(s,rbe);return ibe(i,t,a),r.interactionType===ht.TUMBLE&&ux(r.selection,xi.ALTITUDE)&&OZ(i,r.interactionStartCamera,a),t.tiltMode===vn.LOOK_AROUND||r.tiltMode===vn.LOOK_AROUND?Q1e(i,e,a,n):X1e(i,e,a)}function X1e(i,e,t){const r=Um(i.renderCoordsHelper,e.center,e.eye),n=r-ue(r,t.min,t.max);return dx(n)?n:0}function Q1e(i,e,t,r){switch(r&&(r.requiresTwoSteps=!1),i.viewingMode){case"global":return Y1e(i,e,t,r);case"local":return Z1e(i,e,t,r);default:return void Ra(i.viewingMode)}}function Z1e(i,e,t,r){const n=Um(i.renderCoordsHelper,e.center,e.eye),s=ue(n,t.min,t.max),a=n-s;if(!dx(a))return 0;if(r){const o=i.pointsOfInterest.centerOnSurfaceFrequent.estimatedSurfaceAltitude,l=i.renderCoordsHelper.getAltitude(e.eye)-o,c=Math.cos(s);Math.abs(c)>1e-4?r.eyeCenterDistance=l/c:r.eyeCenterDistance=e.distance}return a}function Y1e(i,e,t,r){const n=K1e(i,e,nbe),s=ue(n.tiltAtCenter,t.min,t.max);if(!dx(n.tiltAtCenter-s))return 0;let a,o;return n.centerIsOnSurface?(a=J1e(n),o=ebe(n,a)):(a=n.constraints.clampTilt(n.eyeCenterDistance,n.tiltAtCenter),r&&a<Math.PI/2&&(r.requiresTwoSteps=!0,a=Math.PI/2-1e-5),o=tbe(n,a)),r&&(r.eyeCenterDistance=j3(n,a)),o}function K1e(i,e,t){const r=i.pointsOfInterest.centerOnSurfaceFrequent.estimatedSurfaceAltitude,n=r+Kt(i.spatialReference).radius,s=i.renderCoordsHelper.intersectManifold(e.ray,r,Zp);return t.eyeCenterDistance=e.distance,t.centerIsOnSurface=!1,y(s)?(t.eyeCenterDistance=Li(e.eye,s),t.tiltAtCenter=Um(i.renderCoordsHelper,s,e.eye),t.centerIsOnSurface=!0):i.state.isLocal?t.tiltAtCenter=Um(i.renderCoordsHelper,e.center,e.eye):(NR(ED(RD,n),e.ray,Zp),t.eyeCenterDistance=Li(e.eye,Zp),t.tiltAtCenter=ls(-_e(e.viewForward,de(Zp,Zp)))),t.radius=n,t.eyeRadius=we(e.eye),t.constraints=i.state.constraints,t}function dx(i){return Math.abs(i)>1e-9}function J1e(i){const{constraints:e,eyeCenterDistance:t,tiltAtCenter:r}=i;let n=r,s=e.clampTilt(t,r);const a=j3(i,s);if(e.clampTilt(a,r)===s)return s;let o=0;for(;o<10&&dx(s-n);){const l=(n+s)/2,c=j3(i,l);dx(e.clampTilt(c,l)-l)?n=l:s=l,o++}return s}function j3(i,e){if(!i.centerIsOnSurface)return i.eyeCenterDistance;const t=Math.PI-ue(e,0,Math.PI),r=tu(i.radius/i.eyeRadius*Math.sin(t)),n=Math.PI-t-r,s=Math.sin(n)/Math.sin(t);if(i.eyeRadius<i.radius&&s>1){const a=Math.PI-r,o=Math.PI-t-a;return Math.sin(o)/Math.sin(t)*i.eyeRadius}return s*i.eyeRadius}function ebe(i,e){const t=tu(i.radius/i.eyeRadius*Math.sin(i.tiltAtCenter)),r=tu(i.radius/i.eyeRadius*Math.sin(e));return i.eyeRadius>i.radius?t-r:r-t}function tbe(i,e){return i.tiltAtCenter-Math.PI/2-(e-Math.PI/2)}function ibe(i,e,t){if(e.interactionType===ht.NONE)return;const{interactionStartCamera:r,interactionFactor:n}=e,{min:s,max:a}=t,o=t4(i,r,Vm,e),l=o===0?0:Um(i.renderCoordsHelper,r.center,r.eye);t.min=s,t.max=a,e.interactionType===ht.TUMBLE?(ux(e.selection,xi.ALTITUDE)&&OZ(i,r,t),W2(o,l,!0,n,_U,t)):W2(o,l,!1,n,_U,t)}function OZ(i,e,t){if(i.state.isLocal)return;const r=i.state.constraints;if(!r.altitude)return;const n=Ml(e.center),s=Math.sqrt(n),a=e.distance,o=Kt(i.spatialReference).radius,l=r.altitude.min+o,c=r.altitude.max+o,u=(l*l-a*a-n)/(-2*s*a),d=(c*c-a*a-n)/(-2*s*a);t.min=Math.max(t.min,Math.min(Math.PI-ls(d),t.max)),t.max=Math.min(t.max,Math.PI-ls(u))}const ep=P(),rC=xe(),Zp=P(),_U=At(5),rbe={min:0,max:0},nbe={constraints:null,radius:0,eyeRadius:0,centerIsOnSurface:!0,eyeCenterDistance:0,tiltAtCenter:0},l1={eyeCenterDistance:0,requiresTwoSteps:!1};function sbe(i){return i}const LP=i=>i*i,i4=i=>1-LP(1-i),abe=i=>i<.5?LP(2*i)/2:(i4(2*(i-.5))+1)/2,r4=i=>i*i*i,MZ=i=>1-r4(1-i),IZ=i=>i<.5?r4(2*i)/2:(MZ(2*(i-.5))+1)/2,n4=i=>i*i*i*i,LZ=i=>1-n4(1-i),obe=i=>i<.5?n4(2*i)/2:(LZ(2*(i-.5))+1)/2,s4=i=>i*i*i*i*i,$Z=i=>1-s4(1-i),lbe=i=>i<.5?s4(2*i)/2:($Z(2*(i-.5))+1)/2,a4=i=>1-Math.cos(i*Math.PI/2),DZ=i=>1-a4(1-i),cbe=i=>i<.5?a4(2*i)/2:(DZ(2*(i-.5))+1)/2,o4=i=>2**(10*(i-1)),rT=i=>1-o4(1-i),hbe=i=>i<.5?o4(2*i)/2:(rT(2*(i-.5))+1)/2,l4=i=>-(Math.sqrt(1-i*i)-1),FZ=i=>1-l4(1-i),ube=i=>i<.5?l4(2*i)/2:(FZ(2*(i-.5))+1)/2;function Zl(i){const e=2*(i-Math.sqrt((i-1)*i)),t=e/2/i;return r=>r<t?i*r*r:e*r-e+1}function Yl(i,e){return(t,r)=>t<e?e*i(t/e,r):1-i((1-t)/(1-e),r)*(1-e)}const dbe=Yl(Zl(1),1),pbe=Yl(Zl(1),0),NZ=Yl(Zl(1),.5),mbe=Yl(Zl(2),1),fbe=Yl(Zl(2),0),gbe=Yl(Zl(2),.5),_be=Yl(Zl(3),1),ybe=Yl(Zl(3),0),vbe=Yl(Zl(3),.5),bbe=Yl(Zl(4),1),wbe=Yl(Zl(4),0),xbe=Yl(Zl(4),.5),Tbe={linear:sbe,"in-quad":LP,"out-quad":i4,"in-out-quad":abe,"in-coast-quad":dbe,"out-coast-quad":pbe,"in-out-coast-quad":NZ,"in-cubic":r4,"out-cubic":MZ,"in-out-cubic":IZ,"in-coast-cubic":mbe,"out-coast-cubic":fbe,"in-out-coast-cubic":gbe,"in-quart":n4,"out-quart":LZ,"in-out-quart":obe,"in-coast-quart":_be,"out-coast-quart":ybe,"in-out-coast-quart":vbe,"in-quint":s4,"out-quint":$Z,"in-out-quint":lbe,"in-coast-quint":bbe,"out-coast-quint":wbe,"in-out-coast-quint":xbe,"in-sine":a4,"out-sine":DZ,"in-out-sine":cbe,"in-expo":o4,"out-expo":rT,"in-out-expo":hbe,"in-circ":l4,"out-circ":FZ,"in-out-circ":ube};function pr(i,e,t=Rbe,r=e){r!==e&&r.copyFrom(e),r.computeUp(i.state.viewingMode);let n=!1;for(let o=0;o<Pbe;o++){let l=0;for(const c of Ebe)if(ux(t.selection,c.type)){const u=Math.abs(c.error(i,r,t));c.apply(i,r,t)&&(n=!0,l+=u)}if(l===0)break}const s=ux(t.selection,xi.COLLISION),a=Cbe(t.interactionType,i);return s&&Rv(i,r,a)&&(n=!0),n&&r.computeUp(i.state.viewingMode),n}function Cbe(i,e){switch(i){case ht.PAN:return zl.EYE_AND_CENTER;case ht.ASCEND:return e.state.isGlobal?zl.EYE_AND_CENTER_SCALE:zl.EYE_AND_CENTER;default:return zl.EYE}}function Cc(i){const e=Math.min(1,i/150);return IZ(e)}function Sbe(i,e,t){return t4(i,e,t)*e.distance}const Ebe=[{type:xi.TILT,error:Sbe,apply:AZ},{type:xi.ALTITUDE,error:YN,apply:S1e},{type:xi.DISTANCE,error:KN,apply:$1e}],Rbe={selection:xi.ALL,interactionType:ht.NONE,interactionFactor:0,interactionStartCamera:null,interactionDirection:null,tiltMode:vn.TUMBLE},Pbe=5,So=P(),Na=P(),tp=P(),ds=P(),tf=P(),Abe=P(),Eo={upward:Ze(0,0,1),forward:Ze(0,1,0),sideway:Ze(1,0,0)},yU=Or();let vU=class{constructor(e=Ie.Global){this.viewingMode=e,this.center=P(),this.pitch=0,this.yaw=0,this.distance=0,this.lookAtDirection=as(Eo.forward)}pixelsPerPanAtZoom(e){return this.size/2/(this._zoomToPanScale*e)}zoomAtPixelsPerPan(e){return this.size/2/(this._zoomToPanScale*e)}pixelsPerRotateAtZoom(){const e=Math.max(Math.cos(Math.abs(this.pitch)),.5);return this.size/2/e}compareTo(e,t){if(t||(t={pan:0,rotate:0,sourceZoom:0,targetZoom:0}),this.viewingMode===Ie.Global){const s=(we(this.center)+we(e.center))/2;t.pan=nE(this.center,e.center)*s}else t.pan=Li(this.center,e.center);let r=Math.abs(e.yaw-this.yaw);r>=Math.PI&&(r=2*Math.PI-r);const n=Math.abs(e.pitch-this.pitch);return t.rotate=Math.max(r,n),t.sourceZoom=this.distance,t.targetZoom=e.distance,t}interpolate(e,t,r){this.viewingMode===Ie.Global?Vye(e.center,t.center,r.pan,this.center):Bn(this.center,e.center,t.center,r.pan),this.distance=isFinite(t.distance)?bt(e.distance,t.distance,r.zoom):e.distance,this.pitch=bt(e.pitch,t.pitch,r.rotate);let n=e.yaw;const s=t.yaw;Math.abs(s-n)>=Math.PI&&(n+=2*(n<s?1:-1)*Math.PI),this.yaw=bt(n,s,r.rotate)}copyFrom(e){X(this.center,e.center),this.pitch=e.pitch,this.yaw=e.yaw,this.distance=e.distance,X(this.lookAtDirection,e.lookAtDirection),this.size=e.size,this.copyFromCommon(e),this.viewingMode=e.viewingMode}copyFromRenderCamera(e){const t=this._lookAtOrientation(e.center,yU);X(this.center,e.center),ae(ds,e.center,e.eye),Nl(ds,ds,t),Nl(tf,e.up,t),this.distance=we(ds),this.distance!==0&&(ds[0]/=this.distance,ds[1]/=this.distance,ds[2]/=this.distance),this.pitch=this._eyeUpToPitch(ds),this.yaw=this._eyeUpToYaw(ds,tf),this.size=Math.sqrt(e.width*e.width+e.height*e.height),this.copyFromCommon(e)}copyFromCommon(e){this.fov=e.fov,this._zoomToPanScale=Math.atan(.5*this.fov)}copyToRenderCamera(e){const t=this._lookAtOrientation(this.center,yU);qc(t,t),this._axisAngleVec3(Eo.sideway,this.pitch-Math.PI/2,Eo.forward,ds),this._axisAngleVec3(Eo.upward,this.yaw,ds),this._axisAngleVec3(Eo.sideway,this.pitch-Math.PI/2,Eo.upward,tf),this._axisAngleVec3(Eo.upward,this.yaw,tf),Q(ds,ds,this.distance),Nl(ds,ds,t),Nl(tf,tf,t),e.center=this.center,e.eye=ae(ds,this.center,ds),e.up=tf}_axisAngleVec3(e,t,r,n=r){const s=Math.cos(t),a=Math.sin(t);return Q(So,r,s),ut(Na,e,r),Q(Na,Na,a),Q(tp,e,(1-s)*_e(e,r)),ce(n,ce(n,So,Na),tp)}_lookAtOrientation(e,t=Or()){return this._upAtLookAt(e,tp),ut(So,this.lookAtDirection,tp),de(So,So),So[0]===0&&So[1]===0&&So[2]===0&&X(So,Eo.sideway),ut(Na,tp,So),de(Na,Na),t[0]=So[0],t[1]=Na[0],t[2]=tp[0],t[3]=So[1],t[4]=Na[1],t[5]=tp[1],t[6]=So[2],t[7]=Na[2],t[8]=tp[2],t}_upAtLookAt(e,t){return this.viewingMode===Ie.Local?X(t,Eo.upward):de(t,e)}_eyeUpToPitch(e){return Math.PI-nE(Eo.upward,e)}_eyeUpToYaw(e,t){const r=Abe;return Math.abs(t[2])<.5?(X(r,t),e[2]>0&&Q(r,r,-1)):X(r,e),ut(Na,r,Eo.upward),de(Na,Na),nE(Eo.sideway,Na,Eo.upward)}},vi=class kZ{constructor(e=null,t=null,r=null){this._viewUp=P(),this._viewForward=P(),this._viewRight=P(),this._ray=oo(),this._viewport=Bi(0,0,1,1),this._padding=Bi(0,0,0,0),this._fov=55/180*Math.PI,this._nearFar=Qt(1,1e3),this._viewDirty=!0,this._viewMatrix=xe(),this._projectionDirty=!0,this._projectionMatrix=xe(),this._viewProjectionDirty=!0,this._viewProjectionMatrix=xe(),this._viewInverseTransposeMatrixDirty=!0,this._viewInverseTransposeMatrix=xe(),this._inverseProjectionDirty=!0,this._inverseProjectionMatrix=null,this._frustumDirty=!0,this._frustum=Iw(),this._fullViewport=yi(),this._pixelRatio=1,this.relativeElevation=0,y(e)&&X(this._ray.origin,e),this._center=y(t)?as(t):P(),this._up=y(r)?as(r):Ze(0,0,1)}get pixelRatio(){return this._pixelRatio}set pixelRatio(e){this._pixelRatio=e>0?e:1}get eye(){return this._ray.origin}set eye(e){this._compareAndSetView(e,this._ray.origin)}get center(){return this._center}set center(e){this._compareAndSetView(e,this._center)}get ray(){return ae(this._ray.direction,this.center,this.eye),this._ray}get up(){return this._up}set up(e){this._compareAndSetView(e,this._up)}get viewMatrix(){return this._ensureViewClean(),this._viewMatrix}set viewMatrix(e){pn(this._viewMatrix,e),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}get viewForward(){return this._ensureViewClean(),this._viewForward}get viewUp(){return this._ensureViewClean(),this._viewUp}get viewRight(){return this._ensureViewClean(),this._viewRight}get nearFar(){return this._nearFar}get near(){return this._nearFar[0]}set near(e){this._nearFar[0]!==e&&(this._nearFar[0]=e,this._projectionDirty=!0,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get far(){return this._nearFar[1]}set far(e){this._nearFar[1]!==e&&(this._nearFar[1]=e,this._projectionDirty=!0,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get viewport(){return this._viewport}set viewport(e){this.x=e[0],this.y=e[1],this.width=e[2],this.height=e[3]}get x(){return this._viewport[0]}set x(e){e+=this._padding[Je.LEFT],this._viewport[0]!==e&&(this._viewport[0]=e,this._projectionDirty=!0,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get y(){return this._viewport[1]}set y(e){e+=this._padding[Je.BOTTOM],this._viewport[1]!==e&&(this._viewport[1]=e,this._projectionDirty=!0,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get width(){return this._viewport[2]}set width(e){this._viewport[2]!==e&&(this._viewport[2]=e,this._projectionDirty=!0,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get height(){return this._viewport[3]}set height(e){this._viewport[3]!==e&&(this._viewport[3]=e,this._projectionDirty=!0,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get fullWidth(){return this._viewport[2]+this._padding[Je.RIGHT]+this._padding[Je.LEFT]}set fullWidth(e){this.width=e-(this._padding[Je.RIGHT]+this._padding[Je.LEFT])}get fullHeight(){return this._viewport[3]+this._padding[Je.TOP]+this._padding[Je.BOTTOM]}set fullHeight(e){this.height=e-(this._padding[Je.TOP]+this._padding[Je.BOTTOM])}get fullViewport(){return this._fullViewport[0]=this._viewport[0]-this._padding[Je.LEFT],this._fullViewport[1]=this._viewport[1]-this._padding[Je.BOTTOM],this._fullViewport[2]=this.fullWidth,this._fullViewport[3]=this.fullHeight,this._fullViewport}get aspect(){return this.width/this.height}get padding(){return this._padding}set padding(e){this._padding[Je.TOP]===e[Je.TOP]&&this._padding[Je.RIGHT]===e[Je.RIGHT]&&this._padding[Je.BOTTOM]===e[Je.BOTTOM]&&this._padding[Je.LEFT]===e[Je.LEFT]||(this._viewport[0]+=e[Je.LEFT]-this._padding[Je.LEFT],this._viewport[1]+=e[Je.BOTTOM]-this._padding[Je.BOTTOM],this._viewport[2]-=e[Je.RIGHT]+e[Je.LEFT]-(this._padding[Je.RIGHT]+this._padding[Je.LEFT]),this._viewport[3]-=e[Je.TOP]+e[Je.BOTTOM]-(this._padding[Je.TOP]+this._padding[Je.BOTTOM]),im(this._padding,e),this._projectionDirty=!0,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get viewProjectionMatrix(){return this._viewProjectionDirty&&(Hr(this._viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),this._viewProjectionDirty=!1),this._viewProjectionMatrix}get projectionMatrix(){if(this._projectionDirty){const e=this.width,t=this.height,r=this.near*Math.tan(this.fovY/2),n=r*this.aspect;Zre(this._projectionMatrix,-n*(1+2*this._padding[Je.LEFT]/e),n*(1+2*this._padding[Je.RIGHT]/e),-r*(1+2*this._padding[Je.BOTTOM]/t),r*(1+2*this._padding[Je.TOP]/t),this.near,this.far),this._projectionDirty=!1}return this._projectionMatrix}get inverseProjectionMatrix(){return C(this._inverseProjectionMatrix)&&(this._inverseProjectionMatrix=xe()),this._inverseProjectionDirty&&kn(this._inverseProjectionMatrix,this.projectionMatrix),this._inverseProjectionMatrix}set projectionMatrix(e){pn(this._projectionMatrix,e),this._projectionDirty=!1,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}get fov(){return this._fov}set fov(e){this._fov=e,this._projectionDirty=!0,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}get fovX(){return Ose(this._fov,this.width,this.height)}set fovX(e){this._fov=Mse(e,this.width,this.height),this._projectionDirty=!0,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}get fovY(){return Ise(this._fov,this.width,this.height)}set fovY(e){this._fov=Lse(e,this.width,this.height),this._projectionDirty=!0,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}get distance(){return Li(this._center,this.eye)}get frustum(){return this._recomputeFrustum(),this._frustum}get viewInverseTransposeMatrix(){return(this._viewInverseTransposeMatrixDirty||this._viewDirty)&&(kn(this._viewInverseTransposeMatrix,this.viewMatrix),AD(this._viewInverseTransposeMatrix,this._viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1),this._viewInverseTransposeMatrix}depthNDCToWorld(e){const t=2*e-1;return 2*this.near*this.far/(this.far+this.near-t*(this.far-this.near))}get perRenderPixelRatio(){return Math.tan(this.fovX/2)/(this.width/2)}get perScreenPixelRatio(){return this.perRenderPixelRatio*this._pixelRatio}get aboveGround(){return this.relativeElevation!=null&&this.relativeElevation>=0}copyFrom(e){X(this._ray.origin,e.eye),X(this._center,e.center),X(this._up,e.up),im(this._viewport,e.viewport),im(this._padding,e.padding),wn(this._nearFar,e.nearFar),this._fov=e.fov,this.relativeElevation=e.relativeElevation;const t=e;return this._viewDirty=t._viewDirty,this._viewDirty||(pn(this._viewMatrix,e.viewMatrix),X(this._viewRight,e.viewRight),X(this._viewUp,e.viewUp),X(this._viewForward,e.viewForward)),t._projectionDirty?this._projectionDirty=!0:(pn(this._projectionMatrix,e.projectionMatrix),this._projectionDirty=!1),this._viewProjectionDirty=!0,this._inverseProjectionDirty=!0,this._frustumDirty=t._frustumDirty,this._frustumDirty||(ZE(this._frustum,e.frustum),this._frustumDirty=!1),t._viewInverseTransposeMatrixDirty?this._viewInverseTransposeMatrixDirty=!0:(pn(this._viewInverseTransposeMatrix,e.viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1),im(this._fullViewport,e.fullViewport),this._pixelRatio=e.pixelRatio,this}copyViewFrom(e){this.eye=e.eye,this.center=e.center,this.up=e.up}clone(){return new kZ().copyFrom(this)}equals(e){return Oc(this.eye,e.eye)&&Oc(this._center,e.center)&&Oc(this._up,e.up)&&NI(this._viewport,e.viewport)&&NI(this._padding,e.padding)&&fre(this._nearFar,e.nearFar)&&this._fov===e.fov&&this._pixelRatio===e.pixelRatio&&this.relativeElevation===e.relativeElevation}almostEquals(e){if(this._pixelRatio!==e.pixelRatio||Math.abs(e.fov-this._fov)>=.001)return!1;const t=5e-4,r=1-1e-10;tl(ps,e.eye,e.center),tl(kO,this.eye,this._center);const n=_e(ps,kO),s=D5(ps),a=D5(kO);return n*n>=r*s*a&&wG(e.eye,this.eye)<Math.max(s,a)*t*t&&j5(e.padding,this._padding)<.5&&j5(e.viewport,this._viewport)<.5}computeRenderPixelSizeAt(e){return this.computeRenderPixelSizeAtDist(this._viewDirectionDistance(e))}computeRenderPixelSizeAtDist(e){return e*this.perRenderPixelRatio}computeScreenPixelSizeAt(e){return this.computeScreenPixelSizeAtDist(this._viewDirectionDistance(e))}_viewDirectionDistance(e){return Math.abs(Db(this.viewForward,ae(ps,e,this.eye)))}computeScreenPixelSizeAtDist(e){return e*this.perScreenPixelRatio}computeDistanceFromRadius(e,t){return e/Math.tan(Math.min(this.fovX,this.fovY)/(2*(t||1)))}getScreenCenter(e=zi()){return e[0]=(this.padding[Je.LEFT]+this.width/2)/this._pixelRatio,e[1]=(this.padding[Je.TOP]+this.height/2)/this._pixelRatio,e}getRenderCenter(e,t=.5,r=.5){return e[0]=this.padding[Je.LEFT]+this.width*t,e[1]=this.padding[Je.BOTTOM]+this.height*r,e[2]=.5,e}setGLViewport(e){const t=this.viewport,r=this.padding;e.setViewport(t[0]-r[3],t[1]-r[2],t[2]+r[1]+r[3],t[3]+r[0]+r[2])}applyProjection(e,t){e!==pt&&X(pt,e),pt[3]=1,sd(pt,pt,this.projectionMatrix);const r=Math.abs(pt[3]);Q(pt,pt,1/r);const n=this.fullViewport;t[0]=bt(0,n[0]+n[2],.5+.5*pt[0]),t[1]=bt(0,n[1]+n[3],.5+.5*pt[1]),t[2]=.5*(pt[2]+1),t[3]=r}unapplyProjection(e,t){const r=this.fullViewport;pt[0]=(e[0]/(r[0]+r[2])*2-1)*e[3],pt[1]=(e[1]/(r[1]+r[3])*2-1)*e[3],pt[2]=(2*e[2]-1)*e[3],pt[3]=e[3],sd(pt,pt,this.inverseProjectionMatrix),t[0]=pt[0],t[1]=pt[1],t[2]=pt[2]}projectToScreen(e,t){return this.projectToRenderScreen(e,VO),this.renderToScreen(VO,t),t}projectToRenderScreen(e,t){if(pt[0]=e[0],pt[1]=e[1],pt[2]=e[2],pt[3]=1,sd(pt,pt,this.viewProjectionMatrix),pt[3]===0)return null;Q(pt,pt,1/Math.abs(pt[3]));const r=this.fullViewport;return"x"in t?(t.x=bt(0,r[0]+r[2],.5+.5*pt[0]),t.y=bt(0,r[1]+r[3],.5+.5*pt[1])):(t[0]=bt(0,r[0]+r[2],.5+.5*pt[0]),t[1]=bt(0,r[1]+r[3],.5+.5*pt[1]),t.length>2&&(t[2]=.5*(pt[2]+1))),t}unprojectFromScreen(e,t){return this.unprojectFromRenderScreen(this.screenToRender(e,VO),t)}unprojectFromRenderScreen(e,t){if(Hr(nC,this.projectionMatrix,this.viewMatrix),!kn(nC,nC))return null;const r=this.fullViewport;return pt[0]=2*(e[0]-r[0])/r[2]-1,pt[1]=2*(e[1]-r[1])/r[3]-1,pt[2]=2*e[2]-1,pt[3]=1,sd(pt,pt,nC),pt[3]===0?null:(t[0]=pt[0]/pt[3],t[1]=pt[1]/pt[3],t[2]=pt[2]/pt[3],t)}constrainWindowSize(e,t,r,n=r){const s=e*this._pixelRatio,a=t*this._pixelRatio,o=Math.max(s-r/2,0),l=Math.max(this.fullHeight-a-n/2,0),c=-Math.min(s-r/2,0),u=-Math.min(this.fullHeight-a-n/2,0);return[o,l,r-c- -Math.min(this.fullWidth-s-r/2,0),n-u- -Math.min(a-n/2,0)]}computeUp(e){e===Ie.Global?this._computeUpGlobal():this._computeUpLocal()}screenToRender(e,t){const r=e[0]*this._pixelRatio,n=this.fullHeight-e[1]*this._pixelRatio;return t[0]=r,t[1]=n,t}renderToScreen(e,t){const r=e[0]/this._pixelRatio,n=(this.fullHeight-e[1])/this._pixelRatio;t[0]=r,t[1]=n}_computeUpGlobal(){ae(ps,this.center,this.eye);const e=we(this.center);e<1?(Y(this._up,0,0,1),this._markViewDirty()):Math.abs(_e(ps,this.center))>.9999*we(ps)*e||(ut(this._up,ps,this.center),ut(this._up,this._up,ps),de(this._up,this._up),this._markViewDirty())}_computeUpLocal(){Jg(ps,this.eye,this.center),Math.abs(ps[2])<=.9999&&(Q(ps,ps,ps[2]),Y(this._up,-ps[0],-ps[1],1-ps[2]),de(this._up,this._up),this._markViewDirty())}_compareAndSetView(e,t){typeof e[0]=="number"&&isFinite(e[0])&&typeof e[1]=="number"&&isFinite(e[1])&&typeof e[2]=="number"&&isFinite(e[2])?Oc(e,t)||(X(t,e),this._markViewDirty()):ee.getLogger("esri.views.3d.webgl-engine.lib.Camera").warn("Camera vector contains invalid number, ignoring value")}_markViewDirty(){this._viewDirty=!0,this._frustumDirty=!0,this._viewProjectionDirty=!0}_recomputeFrustum(){this._frustumDirty&&(_H(this.viewMatrix,this.projectionMatrix,this._frustum),this._frustumDirty=!1)}_ensureViewClean(){this._viewDirty&&(OD(this._viewMatrix,this.eye,this._center,this._up),Y(this._viewForward,-this._viewMatrix[2],-this._viewMatrix[6],-this._viewMatrix[10]),Y(this._viewUp,this._viewMatrix[1],this._viewMatrix[5],this._viewMatrix[9]),Y(this._viewRight,this._viewMatrix[0],this._viewMatrix[4],this._viewMatrix[8]),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0)}};const pt=yi(),nC=xe(),ps=P(),kO=P(),VO=is();var Je;(function(i){i[i.TOP=0]="TOP",i[i.RIGHT=1]="RIGHT",i[i.BOTTOM=2]="BOTTOM",i[i.LEFT=3]="LEFT"})(Je||(Je={}));const Q2={desiredScreenFlow:2,minDuration:It(500),maxDuration:It(8e3)};let Obe=class VZ{constructor(e){this._createCamera=e,this.compared={sourceZoom:0,targetZoom:0,pan:0,rotate:0},this.settings={desiredScreenFlow:Q2.desiredScreenFlow},this.source=e(),this.target=e()}clone(){const e=new VZ(this._createCamera);return e.copyFrom(this),e}copyFrom(e){this.update(e.source,e.target,e.settings)}update(e,t,r){this.source!==e&&this.source.copyFrom(e),this.target!==t&&this.target.copyFrom(t),this.compared=this.source.compareTo(this.target,this.compared),this.settings.desiredScreenFlow=r.desiredScreenFlow!=null?r.desiredScreenFlow:Q2.desiredScreenFlow,this.desiredPixelFlow=this.settings.desiredScreenFlow*this.target.size,this.halfWindowSize=this.target.size/2}halfWindowPanAtZoom(e){const t=this.target.pixelsPerPanAtZoom(e);return this.halfWindowSize/t}get hasZoom(){return Math.abs(this.compared.sourceZoom-this.compared.targetZoom)>1e-5}get hasPan(){return this.compared.pan>1e-9}get hasRotate(){return this.compared.rotate>1e-9}},Mbe=class{constructor(){this.segments=[]}get time(){return this.segments.reduce((e,t)=>fc(e+t.time),fc(0))}interpolateComponentsAt(e,t){e=Math.min(Math.max(e,0),1),e*=this.time;let r=0,n=0;const s=this.definition;for(let a=0;a<this.segments.length;a++){const o=this.segments[a],l=o.definition;if(e<=o.time||a===this.segments.length-1){if(t=this.segmentInterpolateComponentsAt(o,o.time===0?0:e/o.time,t),s.hasPan&&!isNaN(t.pan)&&isFinite(s.compared.pan)?t.pan=(r+l.compared.pan*t.pan)/s.compared.pan:t.pan=1,s.hasRotate&&!isNaN(t.rotate)&&isFinite(s.compared.rotate)?t.rotate=(n+l.compared.rotate*t.rotate)/s.compared.rotate:t.rotate=1,s.hasZoom&&!isNaN(t.zoom)&&isFinite(l.compared.targetZoom)){const c=t.zoom*(l.compared.targetZoom-l.compared.sourceZoom)+l.compared.sourceZoom,u=this.segments[0].definition.compared.sourceZoom,d=this.segments[this.segments.length-1].definition.compared.targetZoom;t.zoom=(c-u)/(d-u)}else t.zoom=1;return t}e-=o.time,r+=l.compared.pan,n+=l.compared.rotate}}segmentInterpolateComponentsAt(e,t,r){return e.interpolateComponentsAt(t,r)}},UO=class{constructor(e){e&&this.update(e)}get time(){return this._time}update(e){e&&(this.definition?this.definition.copyFrom(e):this.definition=e.clone()),this._updatePrecomputedVariables(),this._updatePixelFlow()}_updatePrecomputedVariables(){const e=this.definition,t=e.compared,r=t.sourceZoom,n=t.targetZoom;this._zoomSign=r>n?1:-1,this._panPixelsAtSource=t.pan*e.source.pixelsPerPanAtZoom(r);const s=(e.source.pixelsPerRotateAtZoom(r)+e.target.pixelsPerRotateAtZoom(n))/2;this._rotatePixels=t.rotate*s}_updatePixelFlow(){const e=this.definition.compared.sourceZoom,t=this.definition.compared.targetZoom,{hasZoom:r,hasPan:n,hasRotate:s}=this.definition;let a=0,o=0;r&&(n&&(a=(t/e-1)/(-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2*this._panPixelsAtSource)),s&&(o=this._zoomSign*(Math.log(e/t)/Math.LN2)*this.definition.halfWindowSize/this._rotatePixels)),this._zoomPixelFlow=0,this._panPixelFlow=0,this._rotatePixelFlow=0;const l=this.definition.desiredPixelFlow;if(r&&n&&s){const c=a+o+a*o;this._zoomPixelFlow=a*o/c*l,this._panPixelFlow=o/c*l,this._rotatePixelFlow=a/c*l}else if(r&&n){const c=1+a;this._zoomPixelFlow=a/c*l,this._panPixelFlow=1/c*l}else if(r&&s){const c=1+o;this._zoomPixelFlow=o/c*l,this._rotatePixelFlow=1/c*l}else if(n&&s){const c=this._panPixelsAtSource/this._rotatePixels,u=1+c;this._panPixelFlow=c/u*l,this._rotatePixelFlow=1/u*l}else n?this._panPixelFlow=l:r?this._zoomPixelFlow=l:s&&(this._rotatePixelFlow=l);this._time=s?this.rotateTime:r?this.zoomTime:n?this.panTime:fc(0)}get rotateTime(){return this.definition.hasRotate?fc(this._rotatePixels/this._rotatePixelFlow):fc(0)}get zoomTime(){return this.definition.hasZoom?fc(this._zoomSign*(Math.log(this.definition.compared.sourceZoom/this.definition.compared.targetZoom)/Math.LN2)*this.definition.halfWindowSize/this._zoomPixelFlow):fc(0)}get panTime(){if(this.definition.hasPan){if(this.definition.hasZoom){const e=-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2,t=e*this._panPixelsAtSource;return fc(Math.log(t*(this._zoomPixelFlow/this._panPixelFlow)+1)/(e*this._zoomPixelFlow))}return fc(this._panPixelsAtSource/this._panPixelFlow)}return fc(0)}_interpolateComponentsZoom(e){if(e===0||e===1)return e;if(this.definition.hasZoom){const t=this.definition.compared.sourceZoom,r=this.definition.compared.targetZoom;return(t*(t/r)**-e-t)/(r-t)}return e}_interpolateComponentsPan(e){if(e===0||e===1)return e;if(this.definition.hasPan&&this.definition.hasZoom){const t=-1/(this._zoomSign*this.definition.halfWindowSize)*this._zoomPixelFlow;return 1/this._panPixelsAtSource*(this._panPixelFlow*(2**(t*e*this._time)-1))/(t*Math.LN2)}return e}_interpolateComponentsRotate(e){return e}interpolateComponentsAt(e,t){e=Math.min(Math.max(e,0),1);const r=this._interpolateComponentsZoom(e),n=this._interpolateComponentsPan(e),s=this._interpolateComponentsRotate(e);return t?(t.zoom=r,t.pan=n,t.rotate=s):t={zoom:r,pan:n,rotate:s},t}};function Ibe(i,e,t){const r=e-i.compared.sourceZoom,n=i.halfWindowPanAtZoom(r);return-i.halfWindowSize*(t.ascensionFactor*Math.LN2*i.compared.pan+n)*Math.log(i.compared.sourceZoom/e)/(i.desiredPixelFlow*Math.LN2*n)}function Lbe(i,e,t){const r=1/e,n=Math.log(i.compared.sourceZoom*r),s=1/i.desiredPixelFlow,a=1/Math.LN2,o=e-i.compared.sourceZoom,l=1/o,c=(t.ascensionFactor*Math.LN2*i.compared.pan+i.halfWindowPanAtZoom(o))/i.halfWindowPanAtZoom(1);return i.halfWindowSize*r*s*a*l*c-i.halfWindowSize*n*s*a*l+i.halfWindowSize*n*s*a*c/(o*o)}function $be(i,e,t){const r=e-i.compared.sourceZoom,n=1/r,s=1/e,a=Math.log(i.compared.sourceZoom*s),o=(t.ascensionFactor*Math.LN2*i.compared.pan+i.halfWindowPanAtZoom(r))/i.halfWindowPanAtZoom(1);return i.halfWindowSize*n*(-2*n*s*o+2*n*a+2*s-2*a*o/(r*r)-o/(e*e))/(i.desiredPixelFlow*Math.LN2)}function Dbe(i,e){return-i.halfWindowSize*Math.log(i.compared.sourceZoom/e)/(i.desiredPixelFlow*Math.LN2)}function Fbe(i,e){return i.halfWindowSize/(e*i.desiredPixelFlow*Math.LN2)}function Nbe(i,e){return-i.halfWindowSize/(e*e*i.desiredPixelFlow*Math.LN2)}function kbe(i,e,t){return-i.compared.pan*i.halfWindowSize*(t.ascensionFactor+t.descensionFactor-1)/(i.desiredPixelFlow*i.halfWindowPanAtZoom(e))}function Vbe(i,e,t){return i.compared.pan*i.halfWindowSize*(t.ascensionFactor+t.descensionFactor-1)/(i.desiredPixelFlow*i.halfWindowPanAtZoom(e*e))}function Ube(i,e,t){return-2*i.compared.pan*i.halfWindowSize*(t.ascensionFactor+t.descensionFactor-1)/(i.desiredPixelFlow*i.halfWindowPanAtZoom(e*e*e))}function zbe(i,e,t){return i.halfWindowSize*(-i.halfWindowPanAtZoom(e)-t.descensionFactor*Math.LN2*i.compared.pan+i.halfWindowPanAtZoom(i.compared.targetZoom))*Math.log(e/i.compared.targetZoom)/(i.desiredPixelFlow*Math.LN2*i.halfWindowPanAtZoom(-e+i.compared.targetZoom))}function Bbe(i,e,t){const r=Math.log(e/i.compared.targetZoom),n=1/i.desiredPixelFlow,s=1/Math.LN2,a=-e+i.compared.targetZoom,o=1/a,l=(-i.halfWindowPanAtZoom(e)-t.descensionFactor*Math.LN2*i.compared.pan+i.halfWindowPanAtZoom(i.compared.targetZoom))/i.halfWindowPanAtZoom(1);return-i.halfWindowSize*r*n*s*o+i.halfWindowSize*r*n*s*l/(a*a)+i.halfWindowSize*n*s*o*l/e}function Gbe(i,e,t){const r=e-i.compared.targetZoom,n=1/r,s=1/e,a=Math.log(e/i.compared.targetZoom),o=(i.halfWindowPanAtZoom(e)+t.descensionFactor*Math.LN2*i.compared.pan-i.halfWindowPanAtZoom(i.compared.targetZoom))/i.halfWindowPanAtZoom(1);return i.halfWindowSize*n*(-2*n*s*o-2*n*a+2*s+2*a*o/(r*r)-o/(e*e))/(i.desiredPixelFlow*Math.LN2)}function Hbe(i,e){return i.halfWindowSize*Math.log(e/i.compared.targetZoom)/(i.desiredPixelFlow*Math.LN2)}function jbe(i,e){return i.halfWindowSize/(e*i.desiredPixelFlow*Math.LN2)}function qbe(i,e){return-i.halfWindowSize/(e*e*i.desiredPixelFlow*Math.LN2)}function Wbe(i){const e=Math.LN2*i.compared.pan,t=i.compared.sourceZoom-i.compared.targetZoom,r=i.halfWindowPanAtZoom(t),n=i.halfWindowSize*Math.log(i.compared.sourceZoom/i.compared.targetZoom)/(i.desiredPixelFlow*Math.LN2*r);return i.compared.sourceZoom<=i.compared.targetZoom?n*(e-r):n*(e+r)}function Xbe(i,e){let t=Qbe(i,e);const r={ascensionFactor:e.ascensionFactor!=null?e.ascensionFactor:.5,descensionFactor:e.descensionFactor!=null?e.descensionFactor:.5},n=r.ascensionFactor===0,s=r.descensionFactor===0,a=n?Dbe:Ibe,o=n?Fbe:Lbe,l=n?Nbe:$be,c=s?Hbe:zbe,u=s?jbe:Bbe,d=s?qbe:Gbe,m=T=>a(i,T,r)+kbe(i,T,r)+c(i,T,r),f=T=>o(i,T,r)+Vbe(i,T,r)+u(i,T,r),_=T=>l(i,T,r)+Ube(i,T,r)+d(i,T,r);let g=m(t);const w=Wbe(i);let v;const b=e.maximumIterations||20,x=e.maximumDistance!=null?e.maximumDistance:1/0;for(v=0;v<b;v++){const R=(f(t)+1e-6)/_(t);if(isNaN(R)||t>=x&&R<0){if(!isFinite(x))return null;t=x,g=m(t);break}if(t-=R,t<i.compared.sourceZoom||t<i.compared.targetZoom)return null;const E=m(t);if(Math.abs(E-g)/g<=.005)break;g=E}return g>w*(1-.3)||t<i.compared.sourceZoom||t<i.compared.targetZoom?null:t}function Qbe(i,e){const t=Math.max(i.compared.sourceZoom,i.compared.targetZoom),r=i.source.zoomAtPixelsPerPan(i.desiredPixelFlow/i.compared.pan)/2;return r<t?e.maximumDistance!=null?t+(e.maximumDistance-t)/2:1.5*t:e.maximumDistance?Math.min(e.maximumDistance,r):r}let Zbe=class extends Mbe{constructor(e,t){super(),this._preallocSegments=[new UO,new UO,new UO],this.update(e,t)}update(e,t){if(!e)return;this.definition?this.definition.copyFrom(e):this.definition=e.clone();let r=null;t&&t.apex&&(r=Xbe(e,t.apex)),this.segments.length=0,this._ascensionSegment=null,this._descensionSegment=null,r==null?this._updateWithoutApex():this._updateWithApex(r,t.apex)}segmentInterpolateComponentsAt(e,t,r){return r=e.interpolateComponentsAt(t,r),e===this._ascensionSegment?r.zoom=i4(r.zoom):e===this._descensionSegment&&(r.zoom=LP(r.zoom)),r}_updateWithApex(e,t){const[r,n,s]=this._preallocSegments,a=t.ascensionFactor!=null?t.ascensionFactor:.5,o=Math.min(1-a,t.ascensionFactor!=null?t.descensionFactor:.5),l=1-a-o;r.definition?r.definition.copyFrom(this.definition):r.definition=this.definition.clone(),r.definition.compared.targetZoom=e,r.definition.compared.pan=this.definition.compared.pan*a,r.definition.compared.rotate=this.definition.compared.rotate*a,r.update(),this._ascensionSegment=r,this.segments.push(r),l>0&&(n.definition?n.definition.copyFrom(this.definition):n.definition=this.definition.clone(),n.definition.copyFrom(this.definition),n.definition.compared.sourceZoom=e,n.definition.compared.targetZoom=e,n.definition.compared.pan=this.definition.compared.pan*l,n.definition.compared.rotate=this.definition.compared.rotate*l,n.update(),this.segments.push(n)),s.definition?s.definition.copyFrom(this.definition):s.definition=this.definition.clone(),s.definition.compared.sourceZoom=e,s.definition.compared.pan=this.definition.compared.pan*o,s.definition.compared.rotate=this.definition.compared.rotate*o,s.update(),this._descensionSegment=s,this.segments.push(s)}_updateWithoutApex(){const[e]=this._preallocSegments;e.update(this.definition),this.segments.push(e)}};const Ybe={zoom:0,pan:0,rotate:0};let Kbe=class{constructor(e){this._createCamera=e,this._time=It(0),this.definition=new Obe(e),this.path=new Zbe}get time(){return this._time}update(e,t,r){this.definition.update(e,t,r),this.path.update(this.definition,r),this._time=this._applyTimeSettings($7(isFinite(this.path.time)?this.path.time:fc(0)),r),this._easing=r.easing?r.easing:this._time>=1e3?NZ:rT}cameraAt(e,t){t=t||this._createCamera(),e=Math.min(Math.max(0,e),1),e=this._normalizedEasing(e);const r=this.path.interpolateComponentsAt(e,Ybe);return t.interpolate(this.definition.source,this.definition.target,r),t}_normalizedEasing(e){const t=this._easing(0,this._time),r=this._easing(1,this._time);return(this._easing(e,this._time)-t)/(r-t)}_applyTimeSettings(e,t){const r=t.speedFactor!=null?t.speedFactor:1;t.duration!=null?e=t.duration:t.speedFactor!=null&&(e=It(e/r));const n=t.minDuration!=null?t.minDuration:Q2.minDuration/r,s=t.maxDuration!=null?t.maxDuration:Q2.maxDuration/r;return It(Math.min(Math.max(n,e),s))}};const Jbe=P();let ewe=class{constructor(e){this.currentTime=It(0),this._animation=new Kbe(()=>new vU(e)),this._current=new vU(e)}get finished(){return this.currentTime>=this._animation.time}get time(){return this._animation.time}update(e,t,r){const n=this._animation.definition.source,s=this._animation.definition.target,a=ae(Jbe,t.center,e.center),o=we(a);o>=1e-5?(a[0]/=o,a[1]/=o,a[2]/=o):(a[0]=0,a[1]=1,a[0]=0),X(n.lookAtDirection,a),X(s.lookAtDirection,a),n.copyFromRenderCamera(e),s.copyFromRenderCamera(t),this._current.copyFrom(n),this._animation.update(n,s,r),this.currentTime=It(0),e.almostEquals(t)&&(this.currentTime=this._animation.time)}cameraAt(e,t){return this._animation.cameraAt(e,this._current),t=t||new vi,this._current.copyToRenderCamera(t),t}step(e,t){return this.finished||(this.currentTime=It(this.currentTime+$7(e)),this.currentTime>=this.time&&(this.currentTime=this.time)),this.cameraAt(this.currentTime/this.time,t)}};var Vi;(function(i){i.Ready="ready",i.Rejected="rejected",i.Running="running",i.Stopped="stopped",i.Finished="finished"})(Vi||(Vi={}));let ed=class extends pe{constructor(e){super(e),this.state=Vi.Ready}get active(){return this.state===Vi.Running}get isInteractive(){return!1}get canStop(){return!1}stopController(){return!!this.canStop&&(this.state=Vi.Stopped,!0)}finishController(){this.state=Vi.Finished}get steppingFinished(){return!1}};h([p({constructOnly:!0})],ed.prototype,"view",void 0),h([p({readOnly:!0})],ed.prototype,"active",null),h([p()],ed.prototype,"state",void 0),h([p({readOnly:!0})],ed.prototype,"isInteractive",null),ed=h([F("esri.views.3d.state.controllers.CameraController")],ed);let px=class extends ed{constructor(){super(...arguments),this._asyncResult=null}get canStop(){return!0}set asyncResult(e){this._asyncResult&&(this._asyncResult.reject(ts()),this._asyncResult=null),this.state===Vi.Finished||this.state===Vi.Stopped?(Tte(e),this.state===Vi.Finished?e.resolve():e.reject(ts())):this._asyncResult=e}get asyncResult(){return this._asyncResult}onControllerStart(){this.state=Vi.Running,y(this.viewAnimation)&&this.viewAnimation.when(()=>this.updateStateFromViewAnimation(),()=>this.updateStateFromViewAnimation())}updateStateFromViewAnimation(){!y(this.viewAnimation)||this.state!==Vi.Ready&&this.state!==Vi.Running||(this.viewAnimation.state===Md.State.FINISHED?this.finish():this.viewAnimation.state===Md.State.STOPPED&&(this.state=Vi.Stopped))}onControllerEnd(){y(this.viewAnimation)&&!this.viewAnimation.done&&(this.state===Vi.Finished?this.viewAnimation.finish():this.state===Vi.Stopped&&this.viewAnimation.stop()),this._asyncResult&&(this.state===Vi.Finished?this._asyncResult.resolve():this._asyncResult.reject(ts()))}finish(){this.finishController()}};px=h([F("esri.views.3d.state.controllers.AnimationController")],px);let md=class extends px{constructor(e){super(e),this.mode="interaction",this._hasTarget=!1}get intersectionHelper(){return this.view.sceneIntersectionHelper}initialize(){this.animation=new ewe(this.view.state.viewingMode),this.viewAnimation=this.mode==="interaction"?null:new Md}get isInteractive(){return this.mode==="interaction"}begin(e,t){this._hasTarget=!0;const r=this.animationSettings(t);sC.copyFrom(this.view.state.camera);const n=Xl(this.view.state.viewingMode);this.intersectionHelper.intersectRay(sC.ray,n,bU)&&(sC.center=bU),this.animation.update(sC,e,r),this.animation.finished&&this.finish()}finish(){this.animation.currentTime=this.animation.time,super.finish()}get steppingFinished(){return this._hasTarget&&this.animation.finished}stepController(e,t){this._hasTarget&&this.animation.step(e,t)}onControllerEnd(e){this._hasTarget&&(this.animation.cameraAt(this.animation.currentTime/this.animation.time,e),this.animation.currentTime=this.animation.time),super.onControllerEnd(e)}animationSettings(e={}){return{apex:{maximumDistance:this.view.state.constraints.clampAltitude(1/0)/6,ascensionFactor:void 0,descensionFactor:void 0},...e,easing:typeof e.easing=="string"?Tbe[e.easing]:e.easing}}};h([p({constructOnly:!0})],md.prototype,"mode",void 0),h([p({readOnly:!0})],md.prototype,"isInteractive",null),md=h([F("esri.views.3d.state.controllers.PointToPointAnimationController")],md);const sC=new vi,bU=P();function $P(i=iwe){return[i[0],i[1],i[2],i[3]]}function mx(i,e){return twe(i[0],i[1],i[2],e,Hre.get())}function twe(i,e,t,r,n=$P()){return n[0]=i,n[1]=e,n[2]=t,n[3]=r,n}function c4(i,e,t){return ut(t,i,e),de(t,t),t[3]=RG(i,e),t}const iwe=[0,0,1,0];function UZ(i,e,t){return rwe(i,i.screenToRender(e,q0(Xe.get())),t)}function rwe(i,e,t){const r=q0(wn(Xe.get(),e));if(r[2]=0,!i.unprojectFromRenderScreen(r,t.origin))return null;const n=q0(wn(Xe.get(),e));n[2]=1;const s=i.unprojectFromRenderScreen(n,Xe.get());return C(s)?null:(ae(t.direction,s,t.origin),t)}function Pv(i,e,t){return h4(i,i.screenToRender(e,q0(Xe.get())),t)}function h4(i,e,t){X(t.origin,i.eye);const r=Y(Xe.get(),e[0],e[1],1),n=i.unprojectFromRenderScreen(r,Xe.get());return C(n)?null:(ae(t.direction,n,t.origin),t)}function u4(i,e,t,r){const n=Pv(e,t,nwe);return FR(i,n,r)}const nwe=oo();var cv;(function(i){i[i.Ellipsoid=0]="Ellipsoid",i[i.Silhouette=1]="Silhouette"})(cv||(cv={}));const zZ=30,Z2=[1,3e8],BZ=70;function Tg(i,e,t){return t[0]=e[0]/(i.fullWidth/i.pixelRatio),t[1]=e[1]/(i.fullHeight/i.pixelRatio),t}function q3(i){for(;i>Math.PI;)i-=2*Math.PI;for(;i<-Math.PI;)i+=2*Math.PI;return i}function zm(i,e,t){const r=Bc(jre.get(),t[3],t);C(r)||Yre(r,rn)||(ae(hi,i.eye,e),Me(hi,hi,r),i.eye=ce(hi,hi,e),ae(hi,i.center,e),Me(hi,hi,r),i.center=ce(hi,hi,e),i.up=Me(hi,i.up,r))}function swe(i,e,t,r){return e_(i,UZ(e,t,m4),r)}function W3(i,e,t,r){return e_(i,Pv(e,t,m4),r)}function d4(i,e,t,r){const n=Xe.get();let s=1-t;ae(n,e,i.eye);const a=we(n);let o=a*(1-s);s>=0&&o<r&&(o=r,s=-(o-a)/a),Math.abs(a-o)<1e-6||(Q(n,n,s),i.eye=ce(hi,i.eye,n),i.center=Bn(hi,i.center,e,s))}function GZ(i,e,t){e.getScreenCenter(wU),u4(i,e,wU,hi)&&(e.center=hi);const r=e.distance,n=r*t;if(Math.abs(r-n)<1e-6)return;const s=Q(Xe.get(),e.viewForward,n);e.eye=ae(hi,e.center,s)}const wU=zi();function zO(i,e){Y(e,0,0,0);for(const t of i)ce(e,e,t);Q(e,e,1/i.length)}function uE(i,e,t,r){return Math.sin(i/we(e))*(t+r.radius)}function xU(i,e,t,r){return uE(Math.PI/2,e,t,r)+(i-Math.PI/2)}var Dn;(function(i){i[i.Vertical=0]="Vertical",i[i.Horizontal=1]="Horizontal"})(Dn||(Dn={}));const TU={Elevation:3e4,Angle:At(6)},aC={Pole:.95,Angle:At(18),Tilt:45},HZ=At(80);function jZ(i,e,t,r,n,s){const a=P(),o=ou();let l=!0,c=!0;return i.intersectScreen(t,a,s)?o[3]=we(a):(c=!1,e.aboveGround&&n!==cv.Ellipsoid?o[3]=Math.max(we(e.center),.9*r.radius):o[3]=we(e.eye)-e.relativeElevation,n===cv.Silhouette?fx(o,e,t,a):l=u4(o,e,t,a)),{sphere:o,scenePickPoint:l?a:null,hasGeometryIntersection:c}}function DP(i,e,t,r){return we(i.eye)-r.radius>TU.Elevation?Dn.Horizontal:t?(Pv(i,e,MU),-Math.sign(i.relativeElevation)*(.5*Math.PI+RG(i.eye,MU.direction))<TU.Angle?Dn.Vertical:Dn.Horizontal):Dn.Vertical}function qZ(i,e,t){ae(BO,t,e),i.eye=ae(hi,i.eye,BO),i.center=ae(hi,i.center,BO)}const BO=P();function fx(i,e,t,r){const n=Pv(e,t,m4);return!C(n)&&(NR(i,n,oC),FR(i,n,r)?!(Bl(oC,n.origin)<Bl(r,n.origin))||(X(r,oC),!1):(ae($_,e.eye,e.center),de($_,$_),kG($_,-_e(de($_,$_),oC),CU),e_(CU,n,r),!1))}const oC=P(),$_=P(),CU=fr();function WZ(i,e,t,r,n,s){let a=0;if(ut(J2,i,e),ae(uC,i,e),we(i)<=n||!r.aboveGround){ut(t,uC,r.eye);const o=_e(i,e)/(we(i)*we(e));if(o<.9999)a=ls(o);else{const c=we(ut(P(),i,e))/(we(i)*we(e));a=tu(c)}const l=Math.cos(ue(Em.normalize(At(s)),0,HZ));a=-a-Math.max(0,we(e)-n)/(l*n)}else ae(SU,r.eye,r.center),ut(t,uC,SU),a=-we(uC)/n;return de(t,t),Q(t,t,we(J2)),a}const SU=P();function EU(i,e,t,r){let n,s;const a=Math.cos(ue(Em.normalize(At(r)),0,HZ));return n=e>t?-(e-t)/(a*t):e<-t?Math.PI-(e+t)/(a*t):ls(e/t),s=i>t?-(i-t)/(a*t):i<-t?Math.PI-(i+t)/(a*t):ls(i/t),(s-n)*t}function awe(i,e,t,r,n,s,a,o,l,c){const u=EU(i[2],e[2],s[3],o),d=l?EU(i[0],e[0],s[3],180):e[0]-i[0],m=Math.sin(a)*d-Math.cos(a)*u,f=Math.cos(a)*d+Math.sin(a)*u;de(hi,n);const _=l?m/Math.sqrt(Math.abs(s[3]**2-_e(t,hi)**2)):m/s[3],g=f/Math.sqrt(Math.abs(s[3]**2-_e(t,r)**2));rt(c,_,g)}function XZ(i,e,t,r,n,s,a,o,l,c){ut(J2,i,e),v3(s.up,s.eye,lC,cC,hC),v3([0,0,1],s.eye,gd,Tm,KZ),X(t,Tm),X(r,gd),de(t,t),Q(t,t,we(J2)),R6(i,de(cC,cC),de(hC,hC),de(lC,lC),RU),R6(e,cC,hC,lC,PU),awe(RU,PU,i,gd,Tm,a,o,l,c,n)}function owe(i,e,t,r,n,s,a){Bc(Y2,n,r),Bc(K2,a,s),Hr(f0,Y2,K2),ae(e,i,t),Me(e,e,f0),ce(e,e,t)}function QZ(i,e,t,r,n,s){Bc(Y2,r,t),Bc(K2,s,n),Hr(f0,Y2,K2),ae(hi,i.eye,e),Me(hi,hi,f0),i.eye=ce(hi,hi,e),ae(hi,i.center,e),Me(hi,hi,f0),i.center=ce(hi,hi,e),ae(hi,i.up,e),Me(hi,hi,f0),i.up=ce(hi,hi,e)}function p4(i,e,t,r,n,s){return(Math.abs(r)>Math.PI-aC.Angle||Math.abs(r)<aC.Angle)&&(Math.abs(i[2])<t*aC.Pole||Math.abs(e)>t)&&s.aboveGround&&n<aC.Tilt}function ZZ(i,e,t,r,n,s){if(s)c4(t,r,AU),zm(e,i,AU);else{const a=WZ(t,r,OU,e,i[3],n);zm(e,i,mx(OU,a))}}function YZ(i,e,t,r,n,s,a){const o=a?20:1,l=1e-12;let c,u;X(rf,r),dC.copyFrom(e);for(let d=0;d<o&&Bl(t,rf)>l&&(c=Bl(t,rf),XZ(t,rf,Tm,gd,c1,dC,i,n,s,a),QZ(dC,i,gd,c1[1],Tm,c1[0]),owe(rf,rf,i,gd,c1[1],Tm,c1[0]),u=Bl(t,rf),u<c||d===0);d++)e.copyFrom(dC)}function lwe(i,e,t,r,n,s,a){p4(t,_e(e.up,t),i[3],-Em.normalize(At(n)),s,e)?YZ(i,e,t,r,-Em.normalize(At(n)),s,a):ZZ(i,e,t,r,s,a)}function cwe(i,e,t,r,n,s){const{eye:a}=i;v3([0,0,1],a,gd,Tm,KZ);const o=e.translation[0]*t.pan,l=n.mode==="zoom"?0:e.translation[1]*t.pan,c=Math.max(Math.sqrt(Math.abs(1-_e(i.center,gd)**2/we(i.center)**2)),.5),u=(Math.sin(s)*l+Math.cos(s)*o)/c,d=-Math.cos(s)*l+Math.sin(s)*o;switch(kl(r.pan.matrix,r.pan.matrix,u,gd),r.pan.enabled=!0,n.mode){case"pan":kl(r.pan.matrix,r.pan.matrix,d,Tm),r.pan.enabled=!0;break;case"zoom":r.zoom=-e.translation[1]*t.zoom}}function hwe(i,e,t,r,n){const{eye:s,viewRight:a}=i,o=ut(Xe.get(),a,s),l=e.translation[0]*t.pan;switch(l!==0&&(kl(r.pan.matrix,r.pan.matrix,-l,o),r.pan.enabled=!0),n.mode){case"pan":{const c=e.translation[1]*t.pan;c!==0&&(kl(r.pan.matrix,r.pan.matrix,c,a),r.pan.enabled=!0);break}case"zoom":r.zoom=-e.translation[1]*t.zoom}}function uwe(i,e,t,r,n,s,a,o,l){p4(i.center,_e(i.up,i.center),we(i.center),-Em.normalize(At(s)),a,e)?cwe(e,t,r,o,l,-Em.normalize(At(n))):hwe(e,t,r,o,l)}const gd=P(),Tm=P(),KZ=P(),lC=P(),cC=P(),hC=P(),RU=P(),PU=P(),c1=Te(),AU=$P(),Y2=xe(),K2=xe(),f0=xe(),rf=P(),hi=P(),uC=P(),dC=new vi,J2=P(),OU=P(),m4={origin:P(),direction:P()},MU={origin:P(),direction:P()},IU=.6,GO=4,dwe=12,pwe=60,mwe=200;let eR=class extends md{constructor(){super(...arguments),this._zoomLocation=P(),this._tmpCamera=new vi,this._tmpViewDir=P(),this._tmpRayDir={origin:P(),direction:P()},this._targetOnSphere=P(),this._tmpCenter=P(),this._constraintOptions={selection:xi.ALL_EXCEPT_COLLISION,interactionType:ht.ZOOM,interactionFactor:null,interactionStartCamera:new vi,interactionDirection:null,tiltMode:vn.TUMBLE},this._sphere=ou()}initialize(){this._intersector=Xl(this.view.state.viewingMode)}zoomStep(e,t){if(!this.active)return;const r=this.view.state,{interactionStartCamera:n}=this._constraintOptions;this.animation.finished?n.copyFrom(r.camera):this.animation.cameraAt(1,n);let s=!1,a=!1;this.intersectionHelper.intersectScreen(t,this._zoomLocation,this.view.map.ground.opacity===0?fwe:{})&&(s=e>0,a=!0),this._tmpCamera.copyFrom(r.camera),s?this.intersectionHelper.intersectRay(this._tmpCamera.ray,this._intersector,this._tmpCenter)&&(this._tmpCamera.center=this._tmpCenter):this.intersectionHelper.intersectRay(this._tmpCamera.ray,this._intersector,this._zoomLocation)?this._tmpCamera.center=this._zoomLocation:X(this._zoomLocation,this._tmpCamera.center),this._updateCamera(this._tmpCamera,e,this._zoomLocation,t,a),this.begin(this._tmpCamera)}animationSettings(){return{apex:null,duration:It(600),easing:rT}}_updateCamera(e,t,r,n,s){const a=Kt(this.view.spatialReference),o=DP(e,n,s,a);let l;this.view.camera.position.hasZ&&(l=Math.abs(this.view.camera.position.z)),de(mC,e.eye),Q(mC,mC,-1),Pv(e,n,this._tmpRayDir),de(this._tmpRayDir.direction,this._tmpRayDir.direction);const c=Math.max(Math.min(dwe,1/Math.abs(_e(mC,this._tmpRayDir.direction)))*l,mwe);if(o===Dn.Horizontal){let u=IU**t;this._sphere[3]=we(r),ae(this._tmpViewDir,e.center,e.eye);const d=Math.min(we(this._tmpViewDir),c);let m=d*u;if(u<=1&&m<GO&&(m=GO,u=m/d),Math.abs(d-m)<1e-6)return;const f=we(e.center);if(this._sphere[3]!==f){const _=this._sphere[3]+u*(f-this._sphere[3]);e.center=Q(pC,e.center,_/f)}Q(this._tmpViewDir,this._tmpViewDir,-u),e.eye=ce(pC,e.center,this._tmpViewDir),pr(this.view,e,this._constraintOptions),Bl(r,e.center)>1e-12&&u4(this._sphere,e,n,this._targetOnSphere)&&lwe(this._sphere,e,r,this._targetOnSphere,this.view.camera.heading,this.view.camera.tilt,!0)}else{let u=IU**Math.abs(t);const d=t>0?1:-1;ae(this._tmpViewDir,r,e.eye);const m=we(this._tmpViewDir),f=this.view._stage.renderView.getMinimalDepthForArea(null,n[0],n[1],this.view.state.camera,pwe);let _=y(f)?Math.min(c,f):c;_=s?Math.min(_,m):_,Q(this._tmpRayDir.direction,this._tmpRayDir.direction,_),ce(r,this._tmpRayDir.origin,this._tmpRayDir.direction);let g=_*u;const w=Math.max(GO,1.01*e.nearFar[0]);if(t>0&&g<w&&(g=w,u=g/_),Math.abs(_-g)<1e-6)return;Q(this._tmpRayDir.direction,this._tmpRayDir.direction,d*(1-u)),e.eye=ce(pC,e.eye,this._tmpRayDir.direction),e.center=ce(pC,e.center,this._tmpRayDir.direction)}Rv(this.view,e)}};eR=h([F("esri.views.3d.state.controllers.global.ZoomStepController")],eR);const pC=P(),mC=P(),fwe={exclude:new Set([Ac])},gwe=.6,_we=4,ywe=60,vwe=14,bwe=200;let tR=class extends md{constructor(){super(...arguments),this._zoomLocation=P(),this._tmpCamera=new vi,this._tmpRayDir=P(),this._tmpCenter=P(),this._constraintOptions={selection:xi.ALL,interactionType:ht.ZOOM,interactionFactor:null,interactionStartCamera:new vi,interactionDirection:null,tiltMode:vn.TUMBLE}}zoomStep(e,t){if(!this.active)return;const r=this.view.state,{interactionStartCamera:n}=this._constraintOptions;this.animation.finished?n.copyFrom(r.camera):this.animation.cameraAt(1,n),this._tmpCamera.copyFrom(r.camera);const s=Xl(this.view.state.viewingMode);e>0?(this.view.map.ground.opacity===0?this.intersectionHelper.intersectScreenFreePointFallback(t,this._zoomLocation,xwe):this.intersectionHelper.intersectScreenFreePointFallback(t,this._zoomLocation),this.intersectionHelper.intersectRay(this._tmpCamera.ray,s,this._tmpCenter)&&(this._tmpCamera.center=this._tmpCenter)):this.intersectionHelper.intersectRay(this._tmpCamera.ray,s,this._zoomLocation)?this._tmpCamera.center=this._zoomLocation:X(this._zoomLocation,this._tmpCamera.center);const a=gwe**e;let o=this.view._stage.renderView.getMinimalDepthForArea(this.view.voxelWasm,t[0],t[1],this.view.state.camera,ywe);ae(fC,this._tmpCamera.eye,this._zoomLocation),de(fC,fC);const l=Math.max(Math.min(vwe,1/Math.abs(_e(wwe,fC)))*Math.abs(this.view.camera.position.z),bwe);if(o=y(o)?Math.min(o,l):l,o){const c=P();ae(c,this._zoomLocation,this._tmpCamera.eye),o<we(c)&&(de(c,c),ce(this._zoomLocation,this._tmpCamera.eye,Q(c,c,o)))}this._updateCamera(this._tmpCamera,a,this._zoomLocation),this.begin(this._tmpCamera)}animationSettings(){return{apex:null,duration:It(600),easing:rT}}_updateCamera(e,t,r){ae(this._tmpRayDir,r,e.eye);const n=we(this._tmpRayDir);let s=n*t;const a=t<=1,o=Math.max(_we,1.01*e.nearFar[0]);s!==0&&(a&&s<o&&(s=o,t=s/n),Math.abs(n-s)<1e-6||(Q(this._tmpRayDir,this._tmpRayDir,t),e.eye=ae(LU,r,this._tmpRayDir),e.center=Bn(LU,e.center,r,1-t),pr(this.view,e,this._constraintOptions)))}};tR=h([F("esri.views.3d.state.controllers.local.ZoomStepController")],tR);const LU=P(),wwe=Ze(0,0,1),fC=P(),xwe={exclude:new Set([Ac])};let Twe=class extends Ri{constructor(e,t){super(!0),this._view=e,this.registerIncoming("double-click",t,r=>this._handleDoubleClick(r))}_handleDoubleClick(e){const t=e.data;if(vP(t,"primary")){const r=this._view.state.isGlobal?new eR({view:this._view,mode:"animation"}):new tR({view:this._view,mode:"animation"});this._view.state.switchCameraController(r),r.zoomStep(Math.log(.5)/Math.log(.6),zi(t.x,t.y)),e.stopPropagation()}}};function Cwe(i,e,t){return i===Ie.Global?new Ewe(t):new Swe(e,t)}let Swe=class{constructor(e,t){this._elevationProvider=e,this._referenceEllipsoid=Kt(t),this._unitInMeters=Hm(t,this._referenceEllipsoid.metersPerDegree)}compute(e,t,r,n,s){var x;s||(s={near:0,far:0});let a=e[2]*this._unitInMeters;const o=a,l=a-n,c=(x=this._elevationProvider)==null?void 0:x.visibleElevationBounds;c&&(a=l>=0?o-this._unitInMeters*c.min:this._unitInMeters*c.max-o);const u={x:(r=y(r)?r:new pi({xmin:0,ymin:0,zmin:0,xmax:0,ymax:0,zmax:0})).xmax-r.xmin,y:r.ymax-r.ymin,z:4*Math.max(r.xmax-r.xmin,r.ymax-r.ymin)},d=Math.max(u.x,u.y,u.z);ae(nf,t,e),D_[0]=nf[0]>0?r.xmax:r.xmin,D_[1]=nf[1]>0?r.ymax:r.ymin,D_[2]=nf[2]>0?d/2:-d/2,ae(D_,D_,e),de(nf,nf);const m=1.1*_e(D_,nf)*this._unitInMeters,f=Math.sqrt(a*(a+2*this._referenceEllipsoid.radius)),_=Math.max(r.xmax-r.xmin,r.ymax-r.ymin),g=_*Awe*this._unitInMeters,w=_*Owe*this._unitInMeters;let v=ue((a-w)/(g-w),0,1);v*=v*v;let b=Math.min(bt(f,m,v),f);return b*=Math.max(Math.log(Math.abs(l)),1),b=Math.min(b,Math.max(34064e4,d)),b/=this._unitInMeters,JZ(b,Rwe,this._unitInMeters,s)}},Ewe=class{constructor(e){this._referenceEllipsoid=Kt(e)}compute(e,t,r,n,s){s||(s={near:0,far:0});const a=we(e)-this._referenceEllipsoid.radius,o=this._referenceEllipsoid.radius+Math.min(0,n),l=Math.abs(a-n),c=Math.max(l,Math.abs(a));return JZ(1.2*Math.sqrt(c*(c+2*o)),ue(2e4-(Math.log(c)-7.983)/9.011*19e3,1e3,2e4),1,s)}};function JZ(i,e,t,r){const n=Pwe/t;return i/e>n?(r.far=i,r.near=r.far/e):(r.near=n,r.far=r.near*e),r}const Rwe=2e4,Pwe=2,Awe=.001,Owe=1e-4,D_=P(),nf=P();let dE=class extends pe{constructor(e){super(e),this._handles=new Vt}initialize(){this._handles.add(this.view.basemapTerrain.on("elevation-change",e=>this._handleElevationChangeEvent(e)))}destroy(){this._handles&&(this._handles.destroy(),this._handles=null)}_handleElevationChangeEvent(e){if(this.view.state.cameraController)return;const t=this.view.state.camera;y(e.spatialReference)&&PZ(this.view,t,e.extent,e.spatialReference)&&this._applyToCurrentCamera()}_applyToCurrentCamera(){this.view.state.updateCamera(e=>Rv(this.view,e,zl.EYE_AND_CENTER))}};h([p({constructOnly:!0})],dE.prototype,"view",void 0),dE=h([F("esri.views.3d.state.ElevationCollisionConstraint")],dE);let fb=class extends pe{constructor(e){super(e),this._handles=new Vt,this.nearFarHeuristic=Cwe(e.view.state.viewingMode,e.view.basemapTerrain,e.view.renderCoordsHelper.spatialReference)}initialize(){this._handles.add([B(()=>{var e,t,r,n;return[(t=(e=this.view.constraints)==null?void 0:e.clipDistance)==null?void 0:t.near,(n=(r=this.view.constraints)==null?void 0:r.clipDistance)==null?void 0:n.far]},()=>this._clipDistanceNearFarChanged()),B(()=>{var e,t;return(t=(e=this.view.constraints)==null?void 0:e.clipDistance)==null?void 0:t.mode},()=>this._updateNearFar()),this.view.state.events.on("before-camera-change",e=>this._updateCameraNearFar(e.camera)),B(()=>this.view.renderDataExtent,()=>this._updateNearFar(),ni),B(()=>{var e,t,r,n;return[(t=(e=this.view.constraints)==null?void 0:e.altitude)==null?void 0:t.min,(n=(r=this.view.constraints)==null?void 0:r.altitude)==null?void 0:n.max]},()=>this._updateAltitude(),ni),B(()=>{var e,t;return(t=(e=this.view.constraints)==null?void 0:e.tilt)==null?void 0:t.max},()=>this._updateTiltMax(),ni),B(()=>{var e,t;return(t=(e=this.view.constraints)==null?void 0:e.tilt)==null?void 0:t.mode},()=>this._updateTilt(),ni),B(()=>{var e;return(e=this.view.state)==null?void 0:e.camera},()=>this._updateTiltAutoMax(),ni),B(()=>{var e,t,r,n,s,a;return[(r=(t=(e=this.view.map)==null?void 0:e.ground)==null?void 0:t.navigationConstraint)==null?void 0:r.type,(a=(s=(n=this.view.state)==null?void 0:n.constraints)==null?void 0:s.collision)==null?void 0:a.enabled]},()=>this._updateCollision(),ni)]),this.view.state.isLocal&&this._handles.add(B(()=>this.view.renderDataExtent,e=>this._updateLocalSurfaceDistance(e),et)),this._updateNearFar(),this.view.state.viewingMode!==Ie.Local&&this._updateAltitude(),this._updateTilt(),this._updateCollision(),this._set("surfaceCollisionConstraint",new dE({view:this.view}))}destroy(){this._handles=Oe(this._handles),this.surfaceCollisionConstraint&&(this.surfaceCollisionConstraint.destroy(),this._set("surfaceCollisionConstraint",null))}_clipDistanceNearFarChanged(){var t;const e=(t=this.view.constraints)==null?void 0:t.clipDistance;e&&e.mode!=="auto"&&this.view.state.updateCamera(r=>this._updateCameraNearFarManual(r,e))}_updateNearFar(){this.view.state.updateCamera(e=>this._updateCameraNearFar(e))}_updateCameraNearFar(e){const t=this.view.constraints&&this.view.constraints.clipDistance;(t?t.mode:"auto")==="manual"?this._updateCameraNearFarManual(e,t):this._updateCameraNearFarAuto(e,t)}_updateCameraNearFarAuto(e,t){this.nearFarHeuristic.compute(e.eye,e.center,this.view.renderDataExtent,IP(this.view,e.eye),e),t&&t.autoUpdate(e.near,e.far)}_updateCameraNearFarManual(e,t){t&&(e.near=t.near,e.far=t.far)}_updateCollision(){var n,s,a;const e=(a=(s=(n=this.view.map)==null?void 0:n.ground)==null?void 0:s.navigationConstraint)==null?void 0:a.type,t=!e||e==="stay-above",r=this.view.state.constraints.collision;if(t!==r.enabled){r.enabled=t,t&&this._reapplyConstraints(xi.COLLISION);const o=this.view.constraints&&this.view.constraints.tilt;o&&o.mode!=="auto"||this._updateTiltAuto()}}_updateAltitude(){const e=this.view.constraints&&this.view.constraints.altitude;e&&this.view.state.viewingMode!==Ie.Local?this.view.state.constraints.altitude={min:e.min,max:e.max}:this.view.state.constraints.altitude=null,this._reapplyConstraints()}_updateTiltMax(){const e=this.view.constraints&&this.view.constraints.tilt;e&&e.mode!=="auto"&&(this._updateTiltManual(e),this._reapplyConstraints())}_updateTilt(){const e=this.view.constraints&&this.view.constraints.tilt;(e?e.mode:"auto")==="manual"?this._updateTiltManual(e):this._updateTiltAuto(),this._reapplyConstraints()}_updateTiltManual(e){const t=this.view.state.constraints;t.tilt=t.createConstantMaxTilt(At(e.max))}_updateTiltAuto(){const e=this.view.state.constraints;e.tilt=e.createDefaultTilt(),this._updateTiltAutoMax()}_updateTiltAutoMax(){const e=this.view.constraints&&this.view.constraints.tilt;if(!e||e.mode!=="auto")return;const t=this.view.state.constraints;if(t.tilt){const r=t.tilt(this.view.state.camera.distance).max;e.autoUpdate(_o(r))}}_updateLocalSurfaceDistance(e){if(C(e))return;let t=Math.max(e.width,e.height);if(t<=0)return;e.hasZ&&(t=Math.max(t,e.zmax-e.zmin));const r=this.view.state,n=3*t/Math.atan(r.camera.fov/2);n!==r.constraints.distance&&(r.constraints.distance=n)}_reapplyConstraints(e=xi.ALL){this.view.state.updateCamera(t=>pr(this.view,t,{selection:e,interactionType:ht.NONE,interactionFactor:null,interactionStartCamera:null,interactionDirection:null,tiltMode:vn.TUMBLE}))}};h([p({constructOnly:!0})],fb.prototype,"view",void 0),h([p({readOnly:!0})],fb.prototype,"surfaceCollisionConstraint",void 0),fb=h([F("esri.views.3d.state.ConstraintsManager")],fb);let Yp=class{constructor(e){this.renderCoordsHelper=e,this.frustum=Iw(),this._points=Bse(),this.lines=new Array(12),this._origin=P(),this._direction=P(),this._altitude=null;for(let t=0;t<12;t++)this.lines[t]={origin:null,direction:P(),endpoint:null}}get planes(){return this.frustum}get points(){return this._points}get mutablePoints(){return this._points}get direction(){return this._direction}update(e){_H(e.viewMatrix,e.projectionMatrix,this.frustum,this._points),X(this._origin,e.eye),X(this._direction,e.viewForward),this._altitude=this.renderCoordsHelper.getAltitude(this._origin),this._updateLines()}updatePoints(e){for(let t=0;t<this._points.length;t++)X(this._points[t],e[t]);Gse(this.frustum,this._points),this._updateLines()}get altitude(){return this._altitude}intersectsSphere(e){return GR(this.frustum,e)}intersectsRay(e){return Hse(this.frustum,e)}intersectsLineSegment(e,t){return jse(this.frustum,e,t)}intersectsPoint(e){return yH(this.frustum,e)}_updateLines(){const e=this._points;for(let t=0;t<4;t++){const r=t+4;HO(this.lines[t],e[t],e[r]),HO(this.lines[t+4],e[t],t===3?e[0]:e[t+1]),HO(this.lines[t+8],e[r],t===3?e[4]:e[r+1])}}};function HO(i,e,t){i.origin=e,i.endpoint=t,Jg(i.direction,e,t)}Yp.planePointIndices=qse,Yp.nearFarLineIndices=[[Ci.NEAR_BOTTOM_LEFT,Ci.FAR_BOTTOM_LEFT],[Ci.NEAR_BOTTOM_RIGHT,Ci.FAR_BOTTOM_RIGHT],[Ci.NEAR_TOP_RIGHT,Ci.FAR_TOP_RIGHT],[Ci.NEAR_TOP_LEFT,Ci.FAR_TOP_LEFT]];let Kb=class extends ed{constructor(e){super(e),this._handles=new Vt}set desiredCamera(e){this._set("desiredCamera",e.clone())}get canStop(){return!0}get constraintEnabled(){return this.view.state.constraints.collision.enabled}onControllerStart(){this.state=Vi.Running,this._handles.add(this.view.basemapTerrain.on("elevation-change",e=>this._handleElevationChangeEvent(e))),this._applyCorrection()}onControllerEnd(){this._handles.removeAll()}stepController(){}_handleElevationChangeEvent(e){y(e.spatialReference)&&!PZ(this.view,this.desiredCamera,e.extent,e.spatialReference)||this._applyCorrection()}_applyCorrection(){this.view.state.updateCamera(e=>{e.copyViewFrom(this.desiredCamera),Rv(this.view,e,zl.EYE_AND_CENTER)||this.constraintEnabled||(this.state=Vi.Stopped)})}};h([p({constructOnly:!0})],Kb.prototype,"desiredCamera",null),Kb=h([F("esri.views.3d.state.controllers.SurfaceCollisionCorrectionController")],Kb);const Mwe=P(),gC=P();function f4(){return{direction:P(),up:P()}}function eY(i,e,t,r,n){let s=de(Mwe,i),a=_e(s,r);const o=a>0;a=Math.abs(a),a>.99&&(a=Math.abs(_e(e,r)),a<.99?(X(s,e),o&&Q(s,s,-1)):s=null);let l=0;if(s){Q(gC,r,_e(r,s)),ae(s,s,gC);const u=_e(s,n)/(we(s)*we(n));ut(gC,s,n),l=(_e(gC,r)>0?1:-1)*_o(ls(u))}const c=_o(ls(-_e(r,i)/we(i)));return t?(t.heading=l,t.tilt=c,t):{heading:l,tilt:c}}const tY=Ze(0,1,0),iY=Ze(0,0,1),h1=xe(),bu=P(),wu=P();function rY(i,e,t,r=f4()){const{direction:n,up:s}=r;return Kre(h1,-At(e)),Cw(h1,h1,At(t)),Me(n,iY,h1),Q(n,n,-1),Me(s,tY,h1),r}function Iwe(i,e,t,r){return eY(e,t,r,iY,tY)}function Lwe(i,e,t,r){const n=rY(i,t,r),s=P();return Q(s,n.direction,-e),ce(s,s,i),{up:n.up,eye:s,heading:t,tilt:r}}function $we(i){return _o(i)}function Dwe(i){return At(i)}function nY(i,e,t,r,n){const s=i.renderSpatialReference,a=i.map&&i.spatialReference||e.spatialReference;return bn(e,bu,s),bn(e,wu,s),bu[0]-=t/2,wu[0]+=t/2,bu[1]-=r/2,wu[1]+=r/2,ss(bu,s,bu,a),ss(wu,s,wu,a),n?(n.xmin=bu[0],n.ymin=bu[1],n.xmax=wu[0],n.ymax=wu[1],n.spatialReference=a):n=new pi(bu[0],bu[1],wu[0],wu[1],a),n}const Fwe=Object.freeze(Object.defineProperty({__proto__:null,headingTiltToDirectionUp:rY,directionToHeadingTilt:Iwe,eyeForCenterWithHeadingTilt:Lwe,lookAtTiltToEyeTilt:$we,eyeTiltToLookAtTilt:Dwe,toExtent:nY},Symbol.toStringTag,{value:"Module"})),sY=Ze(0,0,1),aY=de(P(),Ze(1,1,1)),Nwe=new gw(-180,180),u1=xe(),Hp=P(),F_=P();function oY(i,e,t,r=f4()){ut(Hp,i,sY),_e(Hp,Hp)===0&&ut(Hp,i,aY),Bc(u1,-At(e),i),kl(u1,u1,-At(t),Hp);const{up:n,direction:s}=r;return ut(n,Hp,i),de(n,n),Me(n,n,u1),de(s,i),Aa(s,s),Me(s,s,u1),r}function kwe(i,e,t,r){const n=Hp,s=F_;return de(n,i),ut(F_,n,sY),_e(F_,F_)===0&&ut(F_,n,aY),ut(s,F_,n),eY(e,t,r,n,s)}function Vwe(i,e,t,r){const n={eye:P(),up:null,tilt:r,heading:t},s=Hp;s[0]=i[0],s[1]=i[2],s[2]=-i[1];const a=e,o=At(t),l=At(r),c=Math.sin(o),u=Math.cos(o),d=Math.sin(l),m=Math.cos(l),f=we(s);let _;if(Math.abs(l)<1e-8)_=a+f;else{const M=f/d,U=tu(a/M),L=Math.PI-l-U;_=M*Math.sin(L)}const g=m*a,w=a*a*(d*d),v=u*u*w,b=_-g,x=b*b,T=v*(v+x-s[1]*s[1]);if(T<0)return Q(n.eye,s,_/f),n.tilt=0,n;const R=Math.sqrt(T),E=s[1]*b,O=v+x;let $;if($=u>0?-R+E:R+E,Math.abs(O)<1e-8)return f<1e-8?(n.eye[0]=0,n.eye[1]=0,n.eye[2]=a):Q(n.eye,s,_/f),n.tilt=0,jO(n.eye),qO(n,i);n.eye[1]=$/O;const D=c*c*w,I=d*a,G=u*I*n.eye[1],W=n.eye[1]*n.eye[1],re=1-W,te=Math.sqrt(re),H=v*W+D-2*G*te*b+re*x;return Math.abs(H)<1e-8?(Q(n.eye,s,_/f),n.tilt=0,jO(n.eye),qO(n,i)):(n.eye[0]=(re*(_*s[0]-g*s[0])-I*te*(s[0]*n.eye[1]*u+s[2]*c))/H,n.eye[2]=(re*(_*s[2]-g*s[2])-I*te*(s[2]*n.eye[1]*u-s[0]*c))/H,Q(n.eye,n.eye,_),jO(n.eye),qO(n,i))}function jO(i){const e=i[1];i[1]=-i[2],i[2]=e}function qO(i,e){const t=oY(e,i.heading,i.tilt);return i.up=t.up,i}function Uwe(i,e,t){const r=we(e),n=Math.sqrt(t*t+r*r-2*t*r*Math.cos(Math.PI-i)),s=tu(t/(n/Math.sin(i)));return _o(i-s)}function zwe(i,e,t){const r=At(i),n=we(e);return tu(t/(n/Math.sin(r)))+r}function lY(i,e,t,r,n){let s,a,o,l;const c=e.latitude,u=Kt(i.spatialReference).radius,d=e.longitude,m=i1e(c,t,u)/2;s=d-m,a=d+m;const f=At(c),_=(1+Math.sin(f))/(1-Math.sin(f)),g=(_+1)*Math.tan(r/u/2),w=g*g;function v(x){const T=Math.PI/2;return(x=yte.normalize(x,-T))>T&&(x=Math.PI-x),x}if(o=1.5*Math.PI-2*Math.atan(.5*(g+Math.sqrt(4*_+w))),l=o+r/u,o=v(o),l=v(l),l<o){const x=l;l=o,o=x}if(o=Math.max(_o(o),-90),l=Math.min(_o(l),90),a=Nwe.monotonic(s,a),a-s>180){const x=(a-s-180)/2;s+=x,a-=x}const b=i.spatialReference&&i.spatialReference.isGeographic?i.spatialReference:Zt.WGS84;return n?(n.xmin=s,n.ymin=o,n.xmax=a,n.ymax=l,n.spatialReference=b):n=new pi(s,o,a,l,b),i.spatialReference&&i.spatialReference.isWebMercator&&ER(n,!1,n),n}const Bwe=Object.freeze(Object.defineProperty({__proto__:null,headingTiltToDirectionUp:oY,directionToHeadingTilt:kwe,eyeForCenterWithHeadingTilt:Vwe,lookAtTiltToEyeTilt:Uwe,eyeTiltToLookAtTilt:zwe,toExtent:lY},Symbol.toStringTag,{value:"Module"}));function iR(i){return i.type==="point"}let cY=class{constructor(e,t=null,r=0){this.array=e,this.spatialReference=t,this.offset=r}};function hY(i){return"array"in i}function Gh(i,e,t="ground"){if(iR(e))return i.getElevation(e.x,e.y,e.z||0,e.spatialReference,t);if(hY(e)){let r=e.offset;return i.getElevation(e.array[r++],e.array[r++],e.array[r]||0,Ke(e.spatialReference,i.spatialReference),t)}return i.getElevation(e[0],e[1],e[2]||0,i.spatialReference,t)}function rR(i,e){return i!=null&&(e==null||(e===Ie.Local?!i.isGeographic||i.isWGS84||i.wkid===kv.CGCS2000:i.isWebMercator||i.isWGS84||i.wkid===kv.CGCS2000||i.wkid===kv.GCSMARS2000||i.wkid===kv.GCSMARS2000_SPHERE||i.wkid===kv.GCSMOON2000))}const uY=ee.getLogger("esri.views.3d.support.cameraUtils"),dY=39.37,pY=96,X3=1,Gwe=8,Hwe=5,mY=1,$U=P(),_C=P(),jwe={heading:0,tilt:0},td=new He,qwe=new gw(-20037508342788905e-9,20037508342788905e-9),Wwe=new gw(-180,180);var ns;function nT(i){return i.spatialReference||Zt.WGS84}function Av(i){return i.viewingMode==="global"?Bwe:Fwe}function Xwe(i,e,t,r,n){return Av(i).headingTiltToDirectionUp(e,t,r,n)}function Qu(i,e){if(C(e))return null;const t=i.renderSpatialReference,r=Av(i).headingTiltToDirectionUp,n=P();if(!bn(e.position,n,t))return null;const s=r(n,e.heading,e.tilt);Q(s.direction,s.direction,i.state.camera.distance),ce(s.direction,s.direction,n);const a=h_(i,n,s.direction,s.up);return a.fov=At(e.fov),a}(function(i){i[i.LOCKED=0]="LOCKED",i[i.ADJUST=1]="ADJUST"})(ns||(ns={}));const N_=P();function hv(i,e,t){const r=i.renderSpatialReference,n=FP(i,e.eye,e.viewForward,e.up,jwe);let s=nT(i);return ss(e.eye,r,N_,s)||(s=Zt.WGS84,ss(e.eye,r,N_,s)),C(t)?new al(new He(N_,s),n.heading,n.tilt,_o(e.fov)):(t.position.x=N_[0],t.position.y=N_[1],t.position.z=N_[2],t.position.spatialReference=s,t.heading=n.heading,t.tilt=n.tilt,t.fov=_o(e.fov),t)}function g4(i,e,t){const r=i.state.camera,n=r.width/2/r.pixelRatio;return i.renderCoordsHelper.viewingMode===Ie.Global&&t!=null&&(e*=Math.cos(At(t))),e/=i.renderCoordsHelper.unitInMeters,n/(pY*dY/e)/Math.tan(r.fovX/2)}function jg(i,e,t){const r=i.state.camera,n=e*Math.tan(r.fovX/2),s=r.width/2/r.pixelRatio;let a=pY*dY/(s/n);return i.renderCoordsHelper.viewingMode===Ie.Global&&(a/=Math.cos(At(t))),a*=i.renderCoordsHelper.unitInMeters,a}function fY(i,e,t,r,n,s){return gY(i,e,g4(i,t,e.latitude),r,n,s)}function gY(i,e,t,r,n,s){if(Cg(s)){const o=new Ov(s.signal);return gx(i,r.heading,r.tilt,e,t,n,o),void o.resolver.promise.then(l=>{const c=sR(i,l,r.fov);if(!C(c))return s.resolver.resolve(c);s.resolver.reject()},l=>s.resolver.reject(l))}const a=gx(i,r.heading,r.tilt,e,t,n);return sR(i,a,r.fov,s)}function FP(i,e,t,r,n){return Av(i).directionToHeadingTilt(e,t,r,n)}function Qwe(i,e){return!!(i.basemapTerrain&&i.renderCoordsHelper.fromRenderCoords(e,td,i.spatialReference)&&Ke(Gh(i.elevationProvider,td),0)>td.z-mY)}async function Zwe(i,e,t){if(!i.renderCoordsHelper.fromRenderCoords(e,td,i.spatialReference))return!1;const r=await i.elevationProvider.queryElevation(td.x,td.y,td.z,td.spatialReference,"ground",t);return Ke(r,0)>td.z-mY}async function Ywe(i,e,t){const r=P();if(e)if(e instanceof He){if(bn(e,r,i.renderSpatialReference),e.z==null&&i.basemapTerrain!=null){const n=await i.elevationProvider.queryElevation(e.x,e.y,e.z,e.spatialReference,"ground",t);return y(n)&&i.renderCoordsHelper.setAltitude(r,n),r}}else X(r,e);else X(r,i.state.camera.center);return r}function Kwe(i,e){const t=P();if(e&&e instanceof He){if(bn(e,t,i.renderSpatialReference),e.z==null&&i.basemapTerrain!=null){const r=Gh(i.elevationProvider,e);y(r)&&i.renderCoordsHelper.setAltitude(t,r)}}else X(t,e||i.state.camera.center);return t}function gx(i,e,t,r,n,s,a){const o=r&&r instanceof He?r:null;if(Cg(a))return Ywe(i,r,a.signal).then(c=>{Q3(i,e,t,o,c,n,s,a)},c=>a.resolver.reject(c)),null;const l=Kwe(i,r);return Q3(i,e,t,o,l,n,s,a)}function Q3(i,e,t,r,n,s,a,o){if(C(r)){const d=i.renderSpatialReference;if(r=Am(n,d,nT(i)),C(r))return null}s=Math.max(s,i.state.constraints.minimumPoiDistance);const l=txe(i,e,t,n,s,a),c=(0,Av(i).eyeForCenterWithHeadingTilt)(n,s,l.heading,l.tilt);if(a===ns.ADJUST&&i.viewingMode==="global"&&t>0){const d=()=>{const f=_Y(i,n,s,rxe(i,s,t,n));return a=t-f<1?ns.LOCKED:ns.ADJUST,Q3(i,e,f,r,n,s,a,o)},m=i.map.ground.navigationConstraint;if(!m||m.type==="stay-above"){if(Qwe(i,c.eye))return d();if(Cg(o))return Zwe(i,c.eye,o.signal).then(f=>f?d():(o.resolver.resolve({eye:c.eye,up:c.up,center:as(n),heading:c.heading,tilt:c.tilt}),null)),null}}const u=!o||Cg(o)?{center:P(),eye:P(),up:P(),tilt:0,heading:0}:o;return u.eye=c.eye,u.up=c.up,u.center=as(n),u.heading=c.heading,u.tilt=c.tilt,Cg(o)&&o.resolver.resolve(u),u}function Jb(i,e,t,r,n,s=null){const a=e.zmax!=null&&e.zmin!=null;let o,l,c;if(i.state.isGlobal){if(!rR(e.spatialReference,Ie.Global))return Cg(s)&&s.resolver.reject(),null;const v=new He(e.xmin,e.ymin,e.spatialReference),b=new He(e.xmax,e.ymax,e.spatialReference),x=e.spatialReference.isGeographic?Wwe:qwe;o=new He({x:x.center(v.x,b.x),y:(b.y+v.y)/2,z:a?(e.zmax+e.zmin)/2:null,spatialReference:e.spatialReference});const T=Kt(e.spatialReference),R=t1e(o,v,b);l=R.lon,c=R.lat,x.diff(v.x,b.x)>x.range/2&&(l+=T.halfCircumference),l=Math.min(l,T.halfCircumference),c=Math.min(c,T.halfCircumference)}else{const v=Ke(i.renderSpatialReference,e.spatialReference);v.equals(e.spatialReference)||(e=Dd(e,v)),l=e.xmax-e.xmin,c=e.ymax-e.ymin;const b=a?(e.zmax+e.zmin)/2:null;o=new He({x:e.xmin+.5*l,y:e.ymin+.5*c,z:b,spatialReference:v})}const u=a?e.zmax-e.zmin:0,d=i.state.camera,m=1/Math.tan(d.fovX/2),f=1/Math.tan(d.fovY/2),_=1/Math.tan(d.fov/2),g=Math.max(.5*l*m,.5*c*f,.5*u*_)/X3;if(Cg(s)){const v=new Ov(s.signal);return gx(i,t,r,o,g,n,v),void v.resolver.promise.then(b=>{const x=sR(i,b,i.camera.fov);if(!C(x))return s.resolver.resolve(x);s.resolver.reject()},b=>s.resolver.reject(b))}const w=gx(i,t,r,o,g,n);return sR(i,w,i.camera.fov,s)}function Jwe(i,e,t){const r=i.renderSpatialReference,n=Am(t,r,nT(i));if(C(n))return null;const s=Math.tan(e.fovX/2),a=Math.tan(e.fovY/2),o=xG(e.eye,t),l=2*o*s*X3,c=2*o*a*X3;return i.viewingMode==="global"?lY(i,n,l,c):nY(i,n,l,c)}function exe(i,e,t){const r=i.pointsOfInterest.centerOnSurfaceFrequent.distance;if(Math.log(t/r)/Math.LN2>Gwe)return!0;const n=i.renderSpatialReference,s=nT(i),a=Am(e,n,s),o=Am(i.pointsOfInterest.centerOnSurfaceFrequent.renderLocation,n,s);if(C(a)||C(o))return!1;const l=Math.tan(.5*i.state.camera.fov)*r;return o.distance(a)/l>Hwe}function txe(i,e,t,r,n,s){let a=0;return s===ns.ADJUST&&exe(i,r,n)?(e=0,a=ixe(i,n,t,r)):a=_4(i,r,n,t),a=i.state.constraints.clampTilt(n,a),{heading:e,tilt:t=_Y(i,r,n,a)}}const nR=.7;function ixe(i,e,t,r){const n=i.state.constraints.tilt(e);n.max=Math.min(n.max,.5*Math.PI);const s=n.min*(1-nR)+n.max*nR,a=_4(i,r,e,t);return Math.min(a,s)}function rxe(i,e,t,r){const n=i.state.constraints.tilt(e);let s=_4(i,r,e,t);return s=Math.min(s,.5*Math.PI),n.min*(1-nR)+s*nR}function _Y(i,e,t,r){return Av(i).lookAtTiltToEyeTilt(r,e,t)}function _4(i,e,t,r){return Av(i).eyeTiltToLookAtTilt(r,e,t)}function sR(i,e,t,r){if(C(e))return null;const n=i.renderSpatialReference,s=Am(e.eye,n,nT(i));return C(s)?null:y(r)?(r.position=s,r.heading=e.heading,r.tilt=e.tilt,r.fov=t,r):new al(s,e.heading,e.tilt,t)}function nxe(i,e){var r;const t=(r=i.basemapTerrain)==null?void 0:r.tilingScheme;if(t)return t.levelAtScale(e);uY.error("#scaleToZoom()","Cannot compute zoom from scale without a tiling scheme")}function yY(i,e){var r;const t=(r=i.basemapTerrain)==null?void 0:r.tilingScheme;if(t)return t.scaleAtLevel(e);uY.error("#zoomToScale()","Cannot compute scale from zoom without a tiling scheme")}function vY(i,e,t){const r=i.renderSpatialReference;let n,s;e||(e=i.state.camera);const a=Zt.WGS84;return e instanceof al?(n=e.position.latitude,bn(e.position,$U,r),bn(t,_C,r),s=Li($U,_C)):(ss(e.center,r,_C,a),n=_C[1],s=e.distance),jg(i,s,n)}let Ov=class{constructor(e){this.signal=e,this.resolver=Vx()}};function Cg(i){return i&&"resolver"in i}const sxe=.66;function bY(i){return 360-oD.normalize(i)}function NP(i){return oD.normalize(360-i)}function yC(i){return y(i)&&i.resolver&&i.resolver.reject(),null}function axe(i,e){return y(i)&&i.resolver&&i.resolver.resolve(e),e}function wY(i,e,t,r=null){if(!e)return yC(r);const n=i.spatialReference||Zt.WGS84;if(y(e.camera)){const c=hD(e.camera.position,n);if(C(c))return yC(r);const u=e.camera.clone();return u.position=c,axe(r,u)}if(C(e.targetGeometry))return yC(r);const s=e.get("targetGeometry.spatialReference");if(s&&!FE(s,n))return yC(r);const a=hv(i,i.state.camera);let o=ns.ADJUST;if(e.rotation!=null&&(a.heading=bY(e.rotation),o=ns.LOCKED),t!=null&&(a.tilt=t),e.targetGeometry.type==="point"){const c=e.targetGeometry;let u;const d=e.targetGeometry.clone();return u=e.scale!=null?g4(i,e.scale,c.latitude):i.state.camera.distance,gY(i,d,u,a,o,r)}const l=e.targetGeometry.extent;return Jb(i,l,a.heading,a.tilt,o,r)}function oxe(i,e,t=null){return C(t)&&(t=new rr),b4(i,null,e.clone(),t)}async function lxe(i,e,t){const r=yxe(i,e);if(!r)throw new J("viewpointutils-create:no-target","Missing target for creating viewpoint");const n=new al({fov:i.camera.fov}),s=new rr({camera:n});if(r.target instanceof rr)return sf(await uxe(i,r.target,r,t,s));if(r.target instanceof al)return sf(TY(i,r.target,s));const a=r.scale!=null||r.zoom!=null;if(r.target instanceof pi){const c=r.target.xmin===r.target.xmax||r.target.ymin===r.target.ymax;return sf(a||c?await Z3(i,r,r.target.center,n,t,s):await fxe(i,r,r.target,n,t,s))}const o={boundingBox:Ii(),hasZ:!1,screenSpaceObjects:[]},l=a?cxe(i,r):void 0;if(await xY(i,r.target,l,o),isFinite(o.boundingBox[0])){let c;if(Ic(o.boundingBox,ur),Bo.x=ur[0],Bo.y=ur[1],Bo.z=ur[2],Bo.spatialReference=i.spatialReference,isFinite(Bo.z)&&o.hasZ?c=JD(o.boundingBox):(Bo.z=void 0,c=Mre(eF(o.boundingBox,bxe))),a||c)return sf(await Z3(i,r,Bo,n,t,s));const u=vxe(i,o.screenSpaceObjects);return sf(await _xe(i,r,Bo,o.boundingBox,u,n,t,s))}return r.position?sf(pxe(i,r,n,s)):sf(await mxe(i,r,n,t,s))}function y4(i,e){return e.scale==null&&e.zoom!=null?yY(i,e.zoom):e.scale}function cxe(i,e){return one(y4(i,e))}function v4(i,e){let t=!1;return e.heading!=null?(i.heading=e.heading,t=!0):e.rotation!=null&&(i.heading=bY(e.rotation),t=!0),e.tilt!=null&&(i.tilt=e.tilt,t=!0),e.fov!=null&&(i.fov=e.fov),t}function b4(i,e,t,r){const n=i.spatialReference||Zt.WGS84;return e=y(e)?e:Qu(i,t),C(e)||(r.targetGeometry=Am(e.center,i.renderSpatialReference,n),r.scale=vY(i,e),r.rotation=NP(t.heading),r.camera=t),r}function aR(i,e,t){var o;const r=()=>new J("viewpointutils:invalid-geometry","The target is missing a valid geometry");if(!e)throw r();if(!FE(e.spatialReference,i.spatialReference))throw new J("viewpointutils:incompatible-spatialreference",`Spatial reference (${e.spatialReference?e.spatialReference.wkid:"unknown"}) is incompatible with the view (${i.spatialReference.wkid})`,{geometry:e});const n=[];if(!e.hasZ&&i.basemapTerrain){let l;switch(e.type){case"point":l=e;break;case"multipoint":case"polyline":l=(o=e.extent)==null?void 0:o.center;break;case"mesh":l=e.origin;break;case"extent":l=e.center;break;case"polygon":l=e.centroid}l&&y(i.basemapTerrain.spatialReference)&&FE(l,i.basemapTerrain.spatialReference)?ur[2]=Ke(Gh(i.elevationProvider,l),0):ur[2]=0}(0,wxe[e.type])(e,l=>{n.push(l[0],l[1],l[2])},ur);const s=n.length/3;if(s===0)throw r();const a=new Array(n.length);if(Ma(n,e.spatialReference,0,a,i.spatialReference,0,s)){e.hasZ&&(t.hasZ=!0);for(let l=0;l<a.length;l+=3)e.hasZ?(ur[0]=a[l+0],ur[1]=a[l+1],ur[2]=a[l+2]):(ur[0]=a[l+0],ur[1]=a[l+1]),Z0(t.boundingBox,ur)}}async function hxe(i,e,t,r){const n=await bw(i.whenViewForGraphic(e));if(n.ok===!1||C(n.value)||!("whenGraphicBounds"in n.value))return void aR(i,e.geometry,r);const s=n.value,a=await bw(s.whenGraphicBounds(e,{minDemResolution:t}));if(a.ok===!1)return void aR(i,e.geometry,r);const{screenSpaceObjects:o,boundingBox:l}=a.value;Y0(r.boundingBox,l),o&&o.forEach(c=>{r.screenSpaceObjects.push(c)}),isFinite(l[2])&&(r.hasZ=!0)}async function xY(i,e,t,r){if(Array.isArray(e)&&e.length===2){const n=e[0],s=e[1];if(typeof n=="number"&&typeof s=="number")return Bo.x=n,Bo.y=s,Bo.z=void 0,Bo.spatialReference=i.spatialReference.isGeographic?i.spatialReference:Zt.WGS84,void aR(i,Bo,r)}e&&typeof e.map=="function"?await Yo(e.map(n=>xY(i,n,t,r))):e instanceof U7?aR(i,e,r):e instanceof jc&&await hxe(i,e,t,r)}async function uxe(i,e,t,r,n){if(y(e.camera))return TY(i,e.camera,n);n.scale=e.scale,n.rotation=e.rotation,n.targetGeometry=y(e.targetGeometry)?e.targetGeometry.clone():null,n.camera=null,t.heading!=null?n.rotation=NP(t.heading):t.rotation!=null&&(n.rotation=t.rotation);const s=y4(i,t);s!=null&&(n.scale=s);const a=new Ov(r);return wY(i,n,t.tilt,a),n.camera=await a.resolver.promise,n}function TY(i,e,t){const r=i.spatialReference,n=hD(e.position,r);return C(n)?null:((e=e.clone()).fov=i.camera.fov,e.position=n,b4(i,null,e,t))}function dxe(i,e,t,r,n,s){const a=i.renderSpatialReference;return bn(t.position,bC,a),bn(e,WO,a),s.targetGeometry=new He(e),n.position=new He(t.position),ae(oR,WO,bC),FP(i,bC,oR,r.up,n),s.scale=jg(i,Li(bC,WO),s.targetGeometry.latitude),s.rotation=NP(n.heading),s.camera=n,s}async function Z3(i,e,t,r,n,s){if(C(t))throw new J("createfromcenter","invalid point");s.targetGeometry=t.clone();const a=h_(i);if(e.position)return dxe(i,s.targetGeometry,e,a,r,s);if(e.zoomFactor){const l=a.distance/e.zoomFactor,c=Q(ur,a.viewForward,-l);a.eye=ce(ur,a.center,c),s.scale=jg(i,l,t.latitude)}hv(i,a,r);const o=v4(r,e)?ns.LOCKED:ns.ADJUST;if(!e.zoomFactor){s.scale=y4(i,e),s.scale==null&&(bn(t,ur,i.renderSpatialReference),yH(a.frustum,ur)?s.scale=jg(i,Li(a.eye,ur),t.latitude):s.scale=vY(i,a));const l=new Ov(n);fY(i,s.targetGeometry,s.scale,r,o,l),s.camera=await l.resolver.promise}return s}function pxe(i,e,t,r){const n=h_(i);return X(oR,n.viewForward),FP(i,n.eye,oR,n.up,XO),t.position=new He(e.position),t.heading=e.heading!=null?e.heading:XO.heading,t.tilt=e.tilt!=null?e.tilt:XO.tilt,b4(i,null,t,r)}async function mxe(i,e,t,r,n){const s=h_(i);return Z3(i,e,Am(s.center,i.renderSpatialReference,i.spatialReference),t,r,n)}async function fxe(i,e,t,r,n,s){s.targetGeometry=t.clone();const a=h_(i);hv(i,a,r);const o=v4(r,e)?ns.LOCKED:ns.ADJUST,l=new Ov(n);return Jb(i,t,r.heading,r.tilt,o,l),s.camera=await l.resolver.promise,s}function gxe(i,e,t,r,n){let s=0;t.hasZ?s=t.z:i.basemapTerrain&&(s=ft(Gh(i.elevationProvider,t))),Y(ur,t.x,t.y,s),xd(i.spatialReference,ur,DU,i.renderSpatialReference),Td(vC,DU),qc(vC,vC),Ii(d1);const a=[[0,1,2],[3,1,2],[0,4,2],[3,4,2],[0,1,5],[3,1,5],[0,4,5],[3,4,5]];for(let _=0;_<a.length;_++){const g=a[_];let w=r[g[2]];isFinite(w)||(w=s),Y(ur,r[g[0]],r[g[1]],w),ss(ur,i.spatialReference,ur,i.renderSpatialReference),Z0(d1,Nl(ur,ur,vC))}const o=vH(d1),l=tF(d1),c=bH(d1),u=1/Math.tan(e.fovX/2),d=1/Math.tan(e.fovY/2),m=.5*Math.sqrt(o*o+c*c)*Math.max(d,u)+.5*l,f=.5*l*d+.5*Math.max(o,c);return Math.max(m,f)/n}async function _xe(i,e,t,r,n,s,a,o){o.targetGeometry=t.clone();const l=h_(i),c=gxe(i,l,t,r,n);hv(i,l,s);const u=v4(s,e)?ns.LOCKED:ns.ADJUST;o.scale=jg(i,c,o.targetGeometry.latitude);const d=new Ov(a);return fY(i,o.targetGeometry,o.scale,s,u,d),o.camera=await d.resolver.promise,o}function yxe(i,e){if(!e||!i.spatialReference)return null;const t={target:null};if("declaredClass"in e||Array.isArray(e))t.target=e;else{for(const r in e)t[r]=e[r];e.center&&!t.target&&(t.target=e.center)}return t}function sf(i){return i&&y(i.camera)&&(i.rotation=NP(i.camera.heading)),i}function vxe(i,e){const t=sxe;if(!e.length)return t;let r=Number.NEGATIVE_INFINITY;for(let n=0;n<e.length;n++){const s=e[n].screenSpaceBoundingRect;r=Math.max(r,Math.abs(s[0]),Math.abs(s[1]),Math.abs(s[2]),Math.abs(s[3]))}return t-r/Math.min(i.width,i.height)*2}const ur=P(),DU=xe(),vC=Or(),d1=Ms(),bxe=Nt(),oR=P(),bC=P(),WO=P(),XO={heading:0,tilt:0},Bo=new He,wxe={point(i,e,t){t[0]=i.x,t[1]=i.y,i.hasZ&&(t[2]=i.z),e(t)},polygon(i,e,t){const r=i.hasZ;for(let n=0;n<i.rings.length;n++){const s=i.rings[n];for(let a=0;a<s.length;a++)t[0]=s[a][0],t[1]=s[a][1],r&&(t[2]=s[a][2]),e(t)}},polyline(i,e,t){const r=i.hasZ;for(let n=0;n<i.paths.length;n++){const s=i.paths[n];for(let a=0;a<s.length;a++)t[0]=s[a][0],t[1]=s[a][1],r&&(t[2]=s[a][2]),e(t)}},multipoint(i,e,t){const r=i.points,n=i.hasZ;for(let s=0;s<r.length;s++)t[0]=r[s][0],t[1]=r[s][1],n&&(t[2]=r[s][2]),e(t)},extent(i,e,t){i.hasZ?(e(Y(t,i.xmin,i.ymin,i.zmin)),e(Y(t,i.xmax,i.ymin,i.zmin)),e(Y(t,i.xmin,i.ymax,i.zmin)),e(Y(t,i.xmax,i.ymax,i.zmin)),e(Y(t,i.xmin,i.ymin,i.zmax)),e(Y(t,i.xmax,i.ymin,i.zmax)),e(Y(t,i.xmin,i.ymax,i.zmax)),e(Y(t,i.xmax,i.ymax,i.zmax))):(e(Y(t,i.xmin,i.ymin,t[2])),e(Y(t,i.xmax,i.ymin,t[2])),e(Y(t,i.xmin,i.ymax,t[2])),e(Y(t,i.xmax,i.ymax,t[2])))},mesh(i,e,t){const r=i.vertexAttributes&&i.vertexAttributes.position;if(r)for(let n=0;n<r.length;n+=3)e(Y(t,r[n+0],r[n+1],r[n+2]))}};let xxe=class{constructor(e,t,r){this.target=e,this.options=t,this.view=r,this.state="pending",this._abortController=null,this._animationController=null,this._promise=new Promise((n,s)=>{this._resolveCallback=n,this._rejectCallback=s;const a=new AbortController;y(this.options.signal)&&Rm(this.options.signal,()=>{this.abort()}),this._abortController=a,this.waitForReady()})}then(e,t){return this._promise.then(e,t)}catch(e){return this._promise.catch(e)}resolve(e){return this.state="finished",this._resolveCallback(e)}reject(e){return this.state="finished",this._rejectCallback(e)}abort(e=!1){switch(this.state){case"pending":case"wait-for-ready":case"wait-for-viewpoint":this.reject(ts());break;case"wait-for-animation-finish":!e&&y(this._animationController)&&this.view.state.cameraController===this._animationController&&this._animationController.active&&this._animationController.stopController(),this.reject(ts())}}async waitForReady(){if(this.state="wait-for-ready",!this.view.ready)try{await Pm(()=>this.view.ready,this._abortController.signal)}catch(e){return this.reject(e)}this.createViewPoint()}createViewPoint(){this.state!=="finished"&&(this.state="wait-for-viewpoint",this._animationController=this.options.animate?this._getAnimationController():null,lxe(this.view,this.target,this._abortController.signal).then(e=>{if(this.state==="finished")return;const t=this._getCameraFromViewpoint(e);if(!C(t))if(this.options.animate){if(C(this._animationController))return;this.startAnimation(t,this._animationController)}else this.view.stateManager.setStateCamera(t.camera,{applyConstraints:!t.isFullySpecified,positionAndOrientationOnly:!0,doNotCancelGoToOperation:!0}),this.resolve()},e=>{this.reject(e)}))}_getCameraFromViewpoint(e){const t=!!(this.target instanceof rr&&this.target.camera||this.target instanceof al),r=e.camera;if(C(r))return null;if(!this.view.stateManager.isCompatible(r)){const s=r.position,a=s&&s.spatialReference,o=a?a.wkid:"none",l=this.view.spatialReference.wkid;return this.reject(new J("GotoAnimation:incompatible-spatialreference",`Resulting camera has an incompatible spatial reference (camera: ${o}, view: ${l})`,{camera:r})),null}const n=Qu(this.view,r);return C(n)?(this.reject(new J("GotoAnimation:invalid-camera","Resulting camera is invalid")),null):{viewpoint:e,camera:n,isFullySpecified:t}}startAnimation(e,t){this.state="wait-for-animation-finish";const r=t.viewAnimation;if(C(r))return void this.reject(new J("GotoAnimation:missing-animation","Unreachable code in view.stateManager"));if(r.update(e.viewpoint,"running"),!t.active||C(t.viewAnimation)||t.viewAnimation.target!==e.viewpoint||this.view.state.cameraController!==t)return this.abort();let n;e.isFullySpecified?(n=new Kb({view:this.view,desiredCamera:e.camera}),Rv(this.view,e.camera,zl.EYE_AND_CENTER)):pr(this.view,e.camera),t.begin(e.camera,this.options);const s=()=>{const o=this.view.state.cameraController;n&&(o&&o.active?o instanceof md&&y(o.viewAnimation)&&o.viewAnimation.target===e.viewpoint&&(this.view.state.cameraController=n):y(t.viewAnimation)&&t.viewAnimation.target===e.viewpoint&&t.state==="finished"&&(this.view.state.cameraController=n))},a=o=>{if(!C(this.view.state))switch(t.state){case Vi.Finished:switch(this.state){case"pending":case"wait-for-ready":case"wait-for-viewpoint":case"wait-for-animation-finish":this.resolve()}break;case Vi.Ready:case Vi.Rejected:case Vi.Running:case Vi.Stopped:switch(this.state){case"pending":case"wait-for-ready":case"wait-for-viewpoint":case"wait-for-animation-finish":this.reject(o)}}};r.when(s,o=>a(o)),t.asyncResult={resolve:()=>a(),reject:o=>a(o)}}_getAnimationController(){let e,t=null;const r=this.view.state.cameraController;return r instanceof md&&(r.updateStateFromViewAnimation(),r.active&&(e=r,t=e.viewAnimation)),e!=null||(e=new md({view:this.view,mode:"animation"}),t=e.viewAnimation,this.view.state.switchCameraController(e))?e:(y(t)&&t.stop(),this.reject(new J("GotoAnimation:goto-cannot-interrupt","Cannot start an animation while interacting")),null)}},Xr=class extends pe{constructor(e){super(e),this._propertiesPool=new Od({frustum:Yp},this),this._handles=new Vt,this._cameraSetByUser=!1,this._gotoOperation=null,this.ready=!1,this._windowDevicePixelRatio=1,this._devicePixelRatioOverride=null,this._maximumPixelRatioOverride=null,this._cameraChangeTime=0,this.test={contentCameraResetState:new Map,setDevicePixelRatio:t=>this._devicePixelRatioOverride=t,setMaximumPixelRatio:t=>this._maximumPixelRatioOverride=t,renderState:null}}get camera(){const e=this._get("camera");if(!this.ready)return e;const t=hv(this.view,this.view.state.camera,QO);return t&&e&&t.equals(e)?e:t.clone()}set camera(e){this._updatePropertyBeforeReady("camera",e)||(this.view.elevationProvider.enableElevationCache(!0),this.setStateCamera(Qu(this.view,e),{applyConstraints:!1})||ee.getLogger(this.declaredClass).error("#camera=","Invalid camera",e),this.view.elevationProvider.enableElevationCache(!1))}get contentCamera(){const e=this._get("contentCamera");if(!this.ready)return e;const t=hv(this.view,this.view.state.contentCamera,QO);return t&&e&&t.equals(e)?e:t.clone()}set contentCamera(e){if(this._updatePropertyBeforeReady("contentCamera",e))return;const t=Qu(this.view,e);C(t)?this.view.state.contentCamera=null:(this._updateElevation(t),this.view.state.contentCamera=t)}installContentCameraReset(e){if(this._handles.remove("contentCameraReset"),this.test.contentCameraResetState.clear(),!this.view.state.fixedContentCamera)return!1;const t=this.zoom,r=this.view.state.camera.distance**2,n=Tl(this.view.state.camera.center),s=e.sticky?this.contentCamera.clone():null;return this._handles.add([B(()=>this.contentCamera,()=>{e.sticky||(this._handles.remove("contentCameraReset"),this.test.contentCameraResetState.clear())}),B(()=>this.zoom,a=>{this.test.contentCameraResetState.set("view.zoom",Math.abs(a-t)/2),Math.abs(a-t)>2?this.contentCamera=null:this.view.state.fixedContentCamera||(this.contentCamera=s)}),B(()=>this.view.state.camera,a=>{const o=Bl(n,a.center);this.test.contentCameraResetState.set("camera.center",o/r),o>r?this.contentCamera=null:this.view.state.fixedContentCamera||(this.contentCamera=s)})],"contentCameraReset"),!0}get center(){return this.ready?this.view.pointsOfInterest.centerOnContent.location:this._get("center")}set center(e){this._updatePropertyBeforeReady("center",e)||(e?this.isCompatible(e)?this.setStateCamera(this._centerToCamera(e),{applyConstraints:!0})?this.view.pointsOfInterest.centerOnContent.runTask():ee.getLogger(this.declaredClass).error("#center=","Invalid center",e):ee.getLogger(this.declaredClass).error("#center=","Center has an incompatible spatial reference (center: "+(e.spatialReference?e.spatialReference.wkid:"none")+", view: "+this.view.spatialReference.wkid+")",e):ee.getLogger(this.declaredClass).error("#center=","Center may not be null or undefined"))}get extent(){if(!this.ready)return this._get("extent");const e=this.view,t=Jwe(e,e.state.camera,e.pointsOfInterest.centerOnContent.renderLocation);return y(t)?t:this._get("extent")}set extent(e){this._updatePropertyBeforeReady("extent",e)||(e?this.isCompatible(e)?this.setStateCamera(this._extentToCamera(e),{applyConstraints:!0})||ee.getLogger(this.declaredClass).error("#extent=","Invalid extent",e):ee.getLogger(this.declaredClass).error("#extent=","Extent has an incompatible spatial reference (extent: "+(e.spatialReference?e.spatialReference.wkid:"none")+", view: "+this.view.spatialReference.wkid+")",e):ee.getLogger(this.declaredClass).error("#extent=","Extent may not be null or undefined"))}get frustum(){const e=this._propertiesPool.get("frustum");return e.renderCoordsHelper=this.view.renderCoordsHelper,e.update(this.view.state.camera),e}get hasInitialView(){return!!this.view.get("map.initialViewProperties.viewpoint")}get scale(){if(this.ready){const e=this.view.pointsOfInterest.centerOnContent;return jg(this.view,e.distance,e.location.latitude)}return this._get("scale")}set scale(e){this._updatePropertyBeforeReady("scale",e)||this.setStateCamera(this._scaleToCamera(e),{applyConstraints:!0})||ee.getLogger(this.declaredClass).error("#scale=","Invalid scale",e)}get padding(){if(!this.ready)return this._get("padding");const e=this.view.state.camera,t=e.padding,r=e.pixelRatio,n=this._get("padding"),s=Math.round(t[Je.TOP]/r),a=Math.round(t[Je.RIGHT]/r),o=Math.round(t[Je.BOTTOM]/r),l=Math.round(t[Je.LEFT]/r);return n!=null&&n.top===s&&n.right===a&&n.bottom===o&&n.left===l?n:{top:s,right:a,bottom:o,left:l}}set padding(e){this._updatePropertyBeforeReady("padding",e)||(this._paddingToArray(e,this.view.state.camera.pixelRatio,wC),this.view.state.updateCamera(t=>t.padding=wC))}_paddingToArray(e,t,r){e?Qs(r,e.top||0,e.right||0,e.bottom||0,e.left||0):Qs(r,0,0,0,0);for(let n=0;n<4;n++)r[n]=Math.round(r[n]*t)}get screenCenter(){const e=this.padding;return Rs((this.view.width-(e.left+e.right))/2+e.left,(this.view.height-(e.top+e.bottom))/2+e.top)}get viewpoint(){return this.ready?oxe(this.view,this.camera):this._get("viewpoint")}set viewpoint(e){if(!this._updatePropertyBeforeReady("viewpoint",e))if(e)if(this.isCompatible(e))this.setStateCamera(this._viewpointToCamera(e),{applyConstraints:!e.camera})||ee.getLogger(this.declaredClass).error("#viewpoint=","Invalid viewpoint",e);else{const t=y(e.camera)?e.camera.position:e.targetGeometry,r=y(t)&&t.spatialReference;ee.getLogger(this.declaredClass).error("#viewpoint=","Viewpoint has an incompatible spatial reference (viewpoint: "+(r?r.wkid:"none")+", view: "+this.view.spatialReference.wkid+")",e)}else ee.getLogger(this.declaredClass).error("#viewpoint=","Viewpoint may not be null or undefined")}get zoom(){return this.ready?nxe(this.view,this.scale):this._get("zoom")}set zoom(e){this._updatePropertyBeforeReady("zoom",e)||this.setStateCamera(this._zoomToCamera(e),{applyConstraints:!0})||ee.getLogger(this.declaredClass).error("#zoom=","Invalid zoom",e)}get maximumPixelRatio(){if(y(this._maximumPixelRatioOverride))return this._maximumPixelRatioOverride;let e=1/0;const{maximumPixelRatio:t,maximumRenderResolution:r}=this.view.qualitySettings;if(t!=null&&(e=Math.min(e,t)),r!=null){const n=r/Math.max(this.view.width,this.view.height);e=Math.min(e,n)}return e}get _devicePixelRatio(){return C(this._devicePixelRatioOverride)?Math.min(this._windowDevicePixelRatio,this.maximumPixelRatio):this._devicePixelRatioOverride}initialize(){this._cameraChangeTime=performance.now(),this._handles.add([wr(()=>this.view.state.events,"before-camera-change",e=>this._updateElevation(e.camera)),B(()=>{var e;return(e=this.view.state)==null?void 0:e.camera},(e,t)=>this._cameraChangedHandler(e,t),ni)]),cs(()=>{var e;return(e=this.view.state)==null?void 0:e.camera},e=>this._updateElevation(e),{once:!0,sync:!0}),this._handles.add([wd({prepare:()=>this._prepareFrame()}),B(()=>this.view.state.cameraController,()=>{this._cameraSetByUser=!0,this._handles.remove(xC)}),wr(()=>this.view.state.events,"camera-projection-changed",()=>this.notifyChange("scale"))])}destroy(){this.exit(),this._handles&&(this._handles.destroy(),this._handles=null),this._propertiesPool&&(this._propertiesPool.destroy(),this._propertiesPool=null)}init(){this.constraintsManager=new fb({view:this.view}),this._prepareFrame();const e=this._getInitialProperties();this._cameraSetByUser=!1,this._set("ready",!0);for(const t of e)this.set(t.name,t.value);if(!this._cameraSetByUser){const t=this.view.get("map.initialViewProperties.viewpoint")||this.view.initialExtent;t&&this.isCompatible(t)?this._setInitialView(t):this.view.state.viewingMode===Ie.Local&&this._handles.add(cs(()=>this.view.basemapTerrain.ready,()=>{this._handles.remove(xC),this._setInitialView(this.view.dataExtent)},{once:!0,initial:!0}),xC)}}exit(){this._cancelGoToOperation(),this.ready&&(this._override("padding",this.padding),this._set("ready",!1),this._clearOverride("hasInitialView"),this._cameraSetByUser=!1,this._handles.remove(xC),this.constraintsManager&&(this.constraintsManager.destroy(),this.constraintsManager=null))}async goTo(e,t){const r={animate:!0,...t};return y(this._gotoOperation)&&this._gotoOperation.abort(r.animate),this._gotoOperation=new xxe(e,r,this.view),this.view.resourceController.scheduler.stopFrame(),this._gotoOperation}debugSetCameraOnContent(){this.setStateCamera(h_(this.view),{applyConstraints:!1})}step(e){const t=this.view.state,r=t==null?void 0:t.cameraController;r&&(t.updateCamera(n=>r.stepController(e,n)),r.steppingFinished&&r.finishController())}_cancelGoToOperation(){y(this._gotoOperation)&&(this._gotoOperation.abort(),this._gotoOperation=null)}_getInitialProperties(){const e=new Set,t=[];for(const{propertyName:r,overrides:n}of Cxe){const s=e.has(r),a=this._isOverridden(r);!s&&a&&t.push({name:r,value:this._get(r)}),this._clearOverride(r),(s||a)&&n.forEach(o=>e.add(o))}return t}_setInitialView(e){if(C(e)||this._cameraSetByUser)return;if(e instanceof al)return void this.setStateCamera(Qu(this.view,e),{applyConstraints:!1});if(e instanceof rr){if(e.targetGeometry instanceof pi){const s=Jb(this.view,e.targetGeometry,0,.5,ns.LOCKED);return void(y(s)&&this.setStateCamera(Qu(this.view,s),{applyConstraints:!0}))}const r={applyConstraints:!e.camera},n=this._viewpointToCamera(e);return void this.setStateCamera(n,r)}const t=Jb(this.view,e,0,.5,ns.LOCKED);y(t)&&this.setStateCamera(Qu(this.view,t),{applyConstraints:!0})}_updatePropertyBeforeReady(e,t){return!this.ready&&(this._override(e,t),t&&Txe.includes(e)&&this._override("hasInitialView",!0),!0)}isCompatible(e){return!C(e)&&(e instanceof rr?e.camera?this.isCompatible(e.camera):this.isCompatible(e.targetGeometry):e instanceof al?this.isCompatible(e.position):e.spatialReference&&FE(e.spatialReference,this.view.spatialReference))}_getPreservingHeadingTilt(e=Sxe){return this._cameraSetByUser?(e.heading=this.camera.heading,e.tilt=this.camera.tilt):(e.heading=0,e.tilt=.5),e}_centerPointAtDistanceToCamera(e,t,r=ip){const{heading:n,tilt:s}=this._getPreservingHeadingTilt(),a=gx(this.view,n,s,e,t,ns.ADJUST);return C(a)?null:(r.copyFrom(this.view.state.camera),r.eye=a.eye,r.center=a.center,r.up=a.up,r)}_centerToCamera(e){const t=this.view.pointsOfInterest.centerOnContent;t.runTask();const r=t.distance;return this._centerPointAtDistanceToCamera(e,r)}_extentToCamera(e){const{heading:t,tilt:r}=this._getPreservingHeadingTilt(),n=Jb(this.view,e,t,r,ns.ADJUST,QO);return y(n)?Qu(this.view,n):null}_scaleToCamera(e){if(e==null)return null;const t=this.view.pointsOfInterest.centerOnContent;t.runTask();const r=t.renderLocation,n=t.location.latitude,s=g4(this.view,e,n);return this._centerPointAtDistanceToCamera(r,s)}_zoomToCamera(e){return this._scaleToCamera(yY(this.view,e))}_viewpointToCamera(e){return Qu(this.view,wY(this.view,e))}setStateCamera(e,t){return!(C(e)||!this.view.state.stopActiveCameraController())&&(this._cameraSetByUser=!0,t.doNotCancelGoToOperation||this._cancelGoToOperation(),this.view.state.updateCamera(r=>{t.positionAndOrientationOnly?(r.eye=e.eye,r.center=e.center,r.up=e.up):r.copyFrom(e),t.applyConstraints&&pr(this.view,r)}),t.applyConstraints||(this.view.state.cameraController=new Kb({view:this.view,desiredCamera:e})),!0)}_prepareFrame(){const{surface:e,canvas:t}=this.view;if(!e||!t)return;this._windowDevicePixelRatio=window.devicePixelRatio;const r=this._devicePixelRatio,n=Math.round(e.clientWidth*r),s=Math.round(e.clientHeight*r);if(n!==0&&s!==0&&(t.width===n&&t.height===s||(t.width=n,t.height=s),this.view.state)){const a=this.view.state.camera;a.fullWidth===n&&a.fullHeight===s&&a.pixelRatio===r||(ip.copyFrom(a),ip.pixelRatio!==r&&(this._paddingToArray(this.padding,r,wC),ip.padding=wC),ip.fullWidth=n,ip.fullHeight=s,ip.pixelRatio=r,this.view.state.camera=ip),this._updateRenderState()}}_updateElevation(e){var s;const t=this.view.basemapTerrain&&this.view.basemapTerrain.spatialReference,r=((s=this.view.renderCoordsHelper)==null?void 0:s.getAltitude(e.eye))??0,n=t?IP(this.view,e.eye):0;e.relativeElevation=r-n}_updateRenderState(){y(this.test.renderState)?this.view.state.mode=this.test.renderState:this.view.animation?this.view.state.mode=Fh.ANIMATING:this.view.interacting?this.view.state.mode=Fh.INTERACTING:(this.view.state.mode===Fh.ANIMATING&&(this._cameraChangeTime=0),performance.now()-this._cameraChangeTime<=Exe?this.view.state.mode=Fh.INTERACTING:this.view.state.mode=Fh.IDLE)}_cameraChangedHandler(e,t){e&&t&&e.almostEquals(t)||(this._cameraChangeTime=performance.now(),this._updateRenderState())}};h([p({type:al,dependsOn:["view.state.camera","ready"]})],Xr.prototype,"camera",null),h([p({type:al,dependsOn:["view.state.contentCamera","ready"]})],Xr.prototype,"contentCamera",null),h([p({type:He})],Xr.prototype,"center",null),h([p({type:pi})],Xr.prototype,"extent",null),h([p({readOnly:!0})],Xr.prototype,"frustum",null),h([p({readOnly:!0})],Xr.prototype,"hasInitialView",null),h([p({readOnly:!0,type:Boolean})],Xr.prototype,"ready",void 0),h([p({type:Number})],Xr.prototype,"scale",null),h([p()],Xr.prototype,"padding",null),h([p({readOnly:!0})],Xr.prototype,"screenCenter",null),h([p({constructOnly:!0})],Xr.prototype,"view",void 0),h([p({type:rr})],Xr.prototype,"viewpoint",null),h([p({type:Number})],Xr.prototype,"zoom",null),h([p()],Xr.prototype,"maximumPixelRatio",null),h([p()],Xr.prototype,"_devicePixelRatio",null),h([p()],Xr.prototype,"_windowDevicePixelRatio",void 0),h([p()],Xr.prototype,"_devicePixelRatioOverride",void 0),h([p()],Xr.prototype,"_maximumPixelRatioOverride",void 0),Xr=h([F("esri.views.3d.state.ViewStateManager")],Xr);const Txe=["camera","viewpoint","extent","scale","center","zoom"],Cxe=[{propertyName:"camera",overrides:["viewpoint"]},{propertyName:"viewpoint",overrides:["extent"]},{propertyName:"extent",overrides:["center","scale"]},{propertyName:"center",overrides:[]},{propertyName:"scale",overrides:["zoom"]},{propertyName:"zoom",overrides:[]},{propertyName:"padding",overrides:[]}],Sxe={heading:0,tilt:0},QO=new al,ip=new vi,wC=yi(),xC="pending-initial-view",Exe=300,FU=100;let Hh=class extends ed{constructor(){super(...arguments),this.startCamera=new vi,this.currentCamera=new vi,this._lastInteraction=0}get isInteractive(){return performance.now()-this._lastInteraction<FU}stepController(e,t){t.copyViewFrom(this.currentCamera),this.currentCamera.copyFrom(t)}onControllerStart(e){this.state=Vi.Running,this.startCamera.copyFrom(e),this.currentCamera.copyFrom(e)}onControllerEnd(e){e.copyViewFrom(this.currentCamera)}commitCamera(){this._lastInteraction=performance.now(),setTimeout(()=>this.notifyChange("isInteractive"),FU),this.view.state.updateCamera(e=>this.stepController(0,e)),this.steppingFinished&&this.finishController()}};h([p({readOnly:!0})],Hh.prototype,"isInteractive",null),h([p()],Hh.prototype,"_lastInteraction",void 0),Hh=h([F("esri.views.3d.state.controllers.InteractiveController")],Hh);var ro;(function(i){i[i.CENTER=0]="CENTER",i[i.EYE=1]="EYE"})(ro||(ro={}));const Rxe=7,ZO=90;let ew=class extends Hh{constructor(e){super(e),this.pivot=ro.CENTER,this._lastPoint=Te(),this._tmpWorldUp=P(),this._tmpViewDir=P(),this._tmpRotCurPoint=Te(),this._tmpTransf=xe(),this._tmpAxis=P(),this._tmpPivotPoint=P(),this._pivotPos=P(),this._constraintOptions={selection:xi.ALL,interactionType:ht.TUMBLE,interactionFactor:0,interactionStartCamera:null,interactionDirection:null,tiltMode:vn.TUMBLE}}get _intersectionHelper(){return this.view.sceneIntersectionHelper}initialize(){this._rotScale=this.pivot===ro.CENTER?3:1.5}begin(e){if(this.active){switch(this.pivot){case ro.EYE:X(this._pivotPos,this.startCamera.eye),this._constraintOptions.interactionType=ht.LOOK_AROUND,this._constraintOptions.tiltMode=vn.LOOK_AROUND,this._constraintOptions.selection=xi.NONE;break;case ro.CENTER:{const t=this._intersectionHelper.intersectRayFreePointFallback(this.startCamera.ray,this._pivotPos);t||X(this._pivotPos,this.startCamera.center),this._constrainPivotPoint(e,t),this.startCamera.center=this._pivotPos,this._constraintOptions.interactionType=ht.TUMBLE,this._constraintOptions.tiltMode=vn.TUMBLE,this._constraintOptions.selection=xi.ALL&~xi.DISTANCE;break}}this._constraintOptions.interactionStartCamera=this.startCamera,Tg(this.startCamera,e,this._lastPoint)}}_constrainPivotPoint(e,t){const r=this.startCamera,n=P();ae(n,this._pivotPos,r.eye);const s=we(n);let a=Math.min(s,Rxe*Math.abs(this.view.camera.position.z));const o=Kt(this.view.spatialReference),l=zi(r.width/r.pixelRatio*.5,r.height/r.pixelRatio*.5),c=DP(this.startCamera,l,!0,o);let u=this.view._stage.renderView.getMinimalDepthForArea(this.view.voxelWasm,r.fullWidth/r.pixelRatio*.5,r.fullHeight/r.pixelRatio*.5,r,2.5*ZO,ZO),d=this.view._stage.renderView.getMinimalDepthForArea(this.view.voxelWasm,e[0],e[1],r,ZO);(y(u)||y(d))&&(u=Ke(u,d),d=C(d)||c===Dn.Horizontal?u:d,a=u>d?d:u,a=t?Math.min(a,s):a),de(n,n),X(this._pivotPos,ce(this._tmpPivotPoint,r.eye,Q(this._tmpPivotPoint,n,a)))}update(e){if(this.active){switch(this.pivot){case ro.EYE:this.currentCamera.center=this._applyRotation(this.currentCamera,e,this.currentCamera.center,this._pivotPos);break;case ro.CENTER:this.currentCamera.center=this._pivotPos,this.currentCamera.eye=this._applyRotation(this.currentCamera,e,this.currentCamera.eye,this._pivotPos)}pr(this.view,this.currentCamera,this._constraintOptions),this.commitCamera()}}end(){this.active&&this.finishController()}_applyRotation(e,t,r,n){this.view.renderCoordsHelper.worldUpAtPosition(n,this._tmpWorldUp),Tg(e,t,this._tmpRotCurPoint);let s=(this._lastPoint[1]-this._tmpRotCurPoint[1])*this._rotScale,a=(this._tmpRotCurPoint[0]-this._lastPoint[0])*this._rotScale;ae(this._tmpViewDir,r,n);const o=we(this._tmpViewDir),l=ls(_e(this._tmpViewDir,this._tmpWorldUp)/o);if(this.pivot===ro.EYE){s*=-.5;const c=.5*Math.PI-l,u=.5*Math.PI*.99;s=c-Math.max(-u,Math.min(u,c+s))}return s=ue(s+l,Jn.min,Jn.max)-l,ut(this._tmpAxis,e.up,this._tmpViewDir),this.pivot===ro.CENTER&&(a=-a),Bc(this._tmpTransf,a,this._tmpWorldUp),kl(this._tmpTransf,this._tmpTransf,s,this._tmpAxis),Me(this._tmpViewDir,this._tmpViewDir,this._tmpTransf),e.up=Me(YO,e.up,this._tmpTransf),ce(YO,n,this._tmpViewDir),wn(this._lastPoint,this._tmpRotCurPoint),YO}};h([p()],ew.prototype,"pivot",void 0),ew=h([F("esri.views.3d.state.controllers.RotateController")],ew);const YO=P();let KO=class extends Ri{constructor(e,t,r,n){super(!0),this._view=e,this.pointerAction=t,this._pivot=r,this.registerIncoming("drag",n,s=>this._handleDrag(s))}_handleDrag(e){const t=e.data;if(t.pointers.size>1||!yN(e.data,this.pointerAction))return;const r=zi(t.center.x,t.center.y);switch(t.action){case"start":this._cameraController&&(this._cameraController.end(),this._cameraController=null),this._cameraController=new ew({view:this._view,pivot:this._pivot}),this._view.state.switchCameraController(this._cameraController),this._cameraController.begin(r);break;case"update":this._cameraController&&this._cameraController.update(r);break;case"end":this._cameraController&&(this._cameraController.end(),this._cameraController=null)}e.stopPropagation()}},Y3=class extends Hh{constructor(){super(...arguments),this._pickPoint=P(),this._tmpP0=Te(),this._panAxisAngle=$P(),this._tmpRayDir=P(),this._tmpRayDirPick=P(),this._targetOnSphere=P(),this._tmpRay={origin:P(),direction:P()},this.dragBeginPoint=zi(),this._normalizedAnchorPoint=Te(),this._constraintOptions={selection:xi.ALL_EXCEPT_COLLISION,interactionType:ht.ZOOM,interactionFactor:0,interactionStartCamera:null,interactionDirection:null,tiltMode:vn.TUMBLE},this._sphere=ou(),this._hasPickPoint=!1}get _intersectionHelper(){return this.view.sceneIntersectionHelper}begin(e){if(!this.active)return;wn(this.dragBeginPoint,e),Tg(this.startCamera,e,this._normalizedAnchorPoint);const t=Kt(this.view.spatialReference),r=jZ(this._intersectionHelper,this.startCamera,e,t,cv.Ellipsoid,this.view.map.ground.opacity===0?Pxe:{});if(this._navMode=DP(this.startCamera,e,r.hasGeometryIntersection,t),this._navMode===Dn.Horizontal)this._hasPickPoint=!!r.scenePickPoint,this._pickPoint=Ke(r.scenePickPoint,this._pickPoint),this._sphere=r.sphere;else{let n,s;Pv(this.startCamera,e,this._tmpRay),de(this._tmpRay.direction,this._tmpRay.direction),y(r.scenePickPoint)&&(ae(this._tmpRayDirPick,this.startCamera.eye,r.scenePickPoint),s=we(this._tmpRayDirPick)),this.view.camera.position.hasZ&&(n=Math.abs(this.view.camera.position.z));let a=ue(zZ*n,Z2[0],Z2[1]);const o=this.view._stage.renderView.getMinimalDepthForArea(null,e[0],e[1],this.view.state.camera,BZ);a=y(o)?Math.min(a,o):a,a=r.scenePickPoint?Math.min(a,s):a,this._hasPickPoint=!0,Q(this._tmpRay.direction,this._tmpRay.direction,a),ce(this._pickPoint,this._tmpRay.origin,this._tmpRay.direction)}this._constraintOptions.interactionStartCamera=this.startCamera}update(e){if(this.active){if(this.currentCamera.eye=this.startCamera.eye,this.currentCamera.center=this.startCamera.center,this.currentCamera.up=this.startCamera.up,this._navMode===Dn.Horizontal){ae(this._tmpRayDir,this.currentCamera.center,this.currentCamera.eye);const t=we(this._tmpRayDir);Tg(this.currentCamera,e,this._tmpP0);const r=12*(this._normalizedAnchorPoint[1]-this._tmpP0[1]);let n=t*2**r;const s=this.view.state.constraints.minimumPoiDistance;if(r<0&&n<s&&(n=s),Math.abs(t-n)<1e-6)return;if(this._hasPickPoint&&n<t){const a=1-(1-n/t)*(1-this._sphere[3]/we(this.currentCamera.center));this.currentCamera.center=Q(TC,this.currentCamera.center,a)}Q(this._tmpRayDir,this._tmpRayDir,-n/t),this.currentCamera.eye=ce(TC,this.currentCamera.center,this._tmpRayDir),this._constraintOptions.interactionFactor=Cc(Q0(this.dragBeginPoint,e)),pr(this.view,this.currentCamera,this._constraintOptions),this._hasPickPoint&&(fx(this._sphere,this.currentCamera,this.dragBeginPoint,this._targetOnSphere),c4(this._pickPoint,this._targetOnSphere,this._panAxisAngle),zm(this.currentCamera,this._sphere,this._panAxisAngle))}else{const t=we(this._tmpRay.direction);Tg(this.currentCamera,e,this._tmpP0);const r=12*(this._normalizedAnchorPoint[1]-this._tmpP0[1]);let n=t*2**r;const s=this.view.state.constraints.minimumPoiDistance;if(r<0&&n<s&&(n=s),Math.abs(t-n)<1e-6)return;Q(this._tmpRayDir,this._tmpRay.direction,1-n/t),this.currentCamera.eye=ce(TC,this.currentCamera.eye,this._tmpRayDir),this.currentCamera.center=ce(TC,this.currentCamera.center,this._tmpRayDir)}Rv(this.view,this.currentCamera),this.commitCamera()}}end(){this.active&&this.finishController()}};Y3=h([F("esri.views.3d.state.controllers.global.ZoomController")],Y3);const TC=P(),Pxe={exclude:new Set([Ac])};let K3=class extends Hh{constructor(){super(...arguments),this._tmpP=P(),this._tmpDir=P(),this._tmpN=P(),this._tmpP0=Te(),this._tmpPoi=P(),this._tmpRayDir=P(),this.dragBeginPoint=zi(),this._normalizedAnchorPoint=Te(),this._constraintOptions={selection:xi.ALL,interactionType:ht.ZOOM,interactionFactor:0,interactionStartCamera:null,interactionDirection:P(),tiltMode:vn.TUMBLE},this._plane=fr()}get _intersectionHelper(){return this.view.sceneIntersectionHelper}begin(e){if(!this.active)return;wn(this.dragBeginPoint,e),Tg(this.startCamera,e,this._normalizedAnchorPoint);const t=this._intersectionHelper.intersectScreenFreePointFallback(e,this._tmpP,this.view.map.ground.opacity===0?Axe:{});ae(this._tmpDir,this._tmpP,this.startCamera.eye);const r=we(this._tmpDir);let n;de(this._tmpDir,this._tmpDir),this.view.camera.position.hasZ&&(n=Math.abs(this.view.camera.position.z));let s=ue(zZ*n,Z2[0],Z2[1]);const a=this.view._stage.renderView.getMinimalDepthForArea(this.view.voxelWasm,e[0],e[1],this.view.state.camera,BZ);s=y(a)?Math.min(s,a):s,s=t?Math.min(s,r):s,Q(this._tmpDir,this._tmpDir,s),ce(this._tmpP,this.startCamera.eye,this._tmpDir),ae(this._tmpN,this.startCamera.eye,this.startCamera.center),de(this._tmpN,this._tmpN),this._tmpN[1]<0&&Aa(this._tmpN,this._tmpN),Ew(this._tmpP,this._tmpN,this._plane),this._constraintOptions.interactionStartCamera=this.startCamera}update(e){if(!this.active)return;swe(this._plane,this.currentCamera,this.dragBeginPoint,this._tmpPoi)||X(this._tmpPoi,this.currentCamera.center),Tg(this.currentCamera,e,this._tmpP0);let t=4*(this._tmpP0[1]-this._normalizedAnchorPoint[1]);wn(this._normalizedAnchorPoint,this._tmpP0),ae(this._tmpRayDir,this._tmpPoi,this.currentCamera.eye);const r=we(this._tmpRayDir);let n=r*(1-t);X(this._constraintOptions.interactionDirection,this._tmpRayDir),Q(this._constraintOptions.interactionDirection,this._constraintOptions.interactionDirection,Math.sign(t)/r);const s=this.view.state.constraints.minimumPoiDistance;t>=0&&n<s&&(n=s,t=-(n-r)/r),Math.abs(r-n)<1e-6||(Q(this._tmpRayDir,this._tmpRayDir,t),this.currentCamera.eye=ce(af,this.currentCamera.eye,this._tmpRayDir),Bn(af,this.currentCamera.center,this._tmpPoi,t),this._tmpPoi[2]>this.startCamera.center[2]?af[2]=Math.max(this.startCamera.center[2],af[2]):af[2]=Math.min(this.startCamera.center[2],af[2]),this.currentCamera.center=af,this._constraintOptions.interactionFactor=Cc(Q0(this.dragBeginPoint,e)),pr(this.view,this.currentCamera,this._constraintOptions),this.commitCamera())}end(){this.active&&this.finishController()}};K3=h([F("esri.views.3d.state.controllers.local.ZoomController")],K3);const af=P(),Axe={exclude:new Set([Ac])};let Oxe=class extends Ri{constructor(e,t,r){super(!0),this._view=e,this.pointerAction=t,this.registerIncoming("drag",r,n=>this._handleDrag(n))}_handleDrag(e){const t=e.data;if(t.pointers.size>1||!yN(e.data,this.pointerAction))return;const r=zi(t.center.x,t.center.y);switch(t.action){case"start":this._cameraController&&(this._cameraController.end(),this._cameraController=null),this._view.state.isGlobal?this._cameraController=new Y3({view:this._view}):this._cameraController=new K3({view:this._view}),this._view.state.switchCameraController(this._cameraController),this._cameraController.begin(r);break;case"update":this._cameraController&&this._cameraController.update(r);break;case"end":this._cameraController&&(this._cameraController.end(),this._cameraController=null)}e.stopPropagation()}},ug=class extends Hh{constructor(e){super(e),this._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this._keysButtonState=[0,0,0,0,0,0,0,0,0,0,0,0],this._tmpCamera=new vi,this._constraintOptions={selection:xi.ALL,interactionType:ht.NONE,interactionStartCamera:new vi,interactionFactor:0,interactionDirection:null,tiltMode:vn.LOOK_AROUND}}handleEventGamepad(e){const t=u3(e,this.view.navigation.gamepad,this._transformation);(e.action==="end"||QS(t))&&this.finishController()}activateDirection(e){this._keysButtonState[e]=1,LV(this._keysButtonState,this._transformation)}deactivateDirection(e){this._keysButtonState[e]=0;const t=LV(this._keysButtonState,this._transformation);QS(t)&&this.finishController()}onControllerStart(e){this._filteredSurfaceElevation=this.view.pointsOfInterest.cameraOnSurface.location.z,this._headingStart=this.view.camera.heading,super.onControllerStart(e)}_updateFilteredSurfaceElevation(e){const t=this.view.pointsOfInterest.cameraOnSurface.location.z,r=1;this._filteredSurfaceElevation+=r*(t-this._filteredSurfaceElevation)*e}stepController(e,t){this._updateStartHeading(),this._updateFilteredSurfaceElevation(e),this.currentCamera.copyViewFrom(t),this._updateCameraCenter(),this._constraintOptions.interactionStartCamera.copyFrom(this.currentCamera),this._calculateControlTransformation(e,this.currentCamera,of),this._applyDisabledMovementTypes(of),this._applyPan(of.pan),this._applyRotate(of.rotate),this._applyZoom(of.zoom),this._applyAscend(of.ascend),this._constraintOptions.interactionType=ht.NONE,this._constraintOptions.selection=xi.COLLISION,pr(this.view,this.currentCamera,this._constraintOptions),super.stepController(e,t)}_updateStartHeading(){this._transformation.heading!==0&&(this._headingStart=this.view.camera.heading)}_applyRotate(e){if(!e.enabled)return;const t=this.currentCamera;ae(ia,t.center,t.eye),Me(ia,ia,e.matrix),t.center=ce(ia,ia,t.eye),t.up=Me(ia,t.up,e.matrix),this._constraintOptions.interactionType=ht.LOOK_AROUND,this._constraintOptions.selection=xi.ALL_EXCEPT_COLLISION,pr(this.view,t,this._constraintOptions)}_applyPan(e,t=this.currentCamera){e.enabled&&(t.eye=Me(ia,t.eye,e.matrix),t.center=Me(ia,t.center,e.matrix),this.view.state.isGlobal&&(t.up=Me(ia,t.up,e.matrix)),this._constraintOptions.interactionType=ht.PAN,this._constraintOptions.selection=xi.ALL,pr(this.view,t,this._constraintOptions))}_applyZoom(e){if(!e)return;const t=this.currentCamera.viewForward;this.currentCamera.eye=ce(ia,this.currentCamera.eye,Q(Xe.get(),t,e)),X(p1,t),Aa(p1,p1),this._constraintOptions.interactionDirection=p1,this._constraintOptions.interactionType=ht.ZOOM,this._constraintOptions.selection=xi.ALL_EXCEPT_COLLISION,pr(this.view,this.currentCamera,this._constraintOptions),this._constraintOptions.interactionDirection=null}_applyAscend(e){if(!e)return;const t=this.view.renderCoordsHelper.worldUpAtPosition(this.currentCamera.eye,Xe.get());if(this._constraintOptions.interactionDirection=X(p1,t),this.view.state.isGlobal){const r=we(this.currentCamera.eye),n=(r+e)/r;this.currentCamera.eye=Q(ia,this.currentCamera.eye,n),this.currentCamera.center=Q(ia,this.currentCamera.center,n)}else{const r=Q(Xe.get(),t,e);this.currentCamera.eye=ce(ia,this.currentCamera.eye,r),this.currentCamera.center=ce(ia,this.currentCamera.center,r)}this._updateCameraCenter(),this._constraintOptions.interactionType=ht.ASCEND,this._constraintOptions.selection=xi.COLLISION,pr(this.view,this.currentCamera,this._constraintOptions)&&this._updateCameraCenter(),this._constraintOptions.selection=xi.ALL_EXCEPT_COLLISION,pr(this.view,this.currentCamera,this._constraintOptions),this._constraintOptions.interactionDirection=null}_calculateControlTransformation(e,t,r){Nxe(r);const n=this._computeVelocities(e);this.view.state.isLocal?this._calculateControlTransformationLocal(n,t,r):this._calculateControlTransformationGlobal(n,t,r)}_updateCameraCenter(){const e=this.view.pointsOfInterest.centerOnSurfaceFrequent.estimatedSurfaceAltitude,t=this.view.renderCoordsHelper,r=this.currentCamera.ray;this.currentCamera.center=t.intersectManifoldClosestSilhouette(r,e,ia)}_calculateControlTransformationLocal(e,t,r){const{viewRight:n,viewForward:s}=t,a=this._transformation,o=this.view.navigation.gamepad,l=Y(Xe.get(),s[0],s[1],0);de(l,l);const c=a.translation[0]*e.pan;if(c!==0){const g=Q(Xe.get(),n,c);ru(r.pan.matrix,r.pan.matrix,g),r.pan.enabled=!0}switch(o.mode){case"pan":{const g=-a.translation[1]*e.pan;if(g!==0){const w=Q(Xe.get(),l,g);ru(r.pan.matrix,r.pan.matrix,w),r.pan.enabled=!0}r.zoom=a.zoom*e.zoom;break}case"zoom":r.zoom=(-a.translation[1]+a.zoom)*e.zoom;break;default:Ra(o.mode)}const u=a.translation[2]*e.ascend;r.ascend=u;const d=-a.heading*e.rotate;d!==0&&(kl(r.rotate.matrix,r.rotate.matrix,d,this.view.renderCoordsHelper.worldUpAtPosition(t.eye,Xe.get())),r.rotate.enabled=!0);const m=a.tilt*e.rotate,f=Um(this.view.renderCoordsHelper,t.center,t.eye),_=ue(f+m,Jn.min,Jn.max)-f;_&&(kl(r.rotate.matrix,r.rotate.matrix,_,n),r.rotate.enabled=!0)}_calculateControlTransformationGlobal(e,t,r){const{eye:n,viewRight:s}=t,a=this._transformation,o=this.view.navigation.gamepad,l=ut(Xe.get(),s,n);de(l,l),Aa(l,l),uwe(this.startCamera,t,a,e,this.view.camera.heading,this._headingStart,this.view.camera.tilt,r,o),this._tmpCamera.copyFrom(this.currentCamera),this._applyPan(of.pan,this._tmpCamera);const c=this.view.pointsOfInterest.centerOnSurfaceFrequent.estimatedSurfaceAltitude,u=a.translation[2]*e.ascend;r.ascend=u;const d=-a.heading*e.rotate;d!==0&&(kl(r.rotate.matrix,r.rotate.matrix,d,this._tmpCamera.eye),r.rotate.enabled=!0);const m=a.tilt*e.rotate,f=this._clampTiltDeltaGlobalToValidRange(m,t.ray,c);f!==0&&(kl(r.rotate.matrix,r.rotate.matrix,f,this._tmpCamera.viewRight),r.rotate.enabled=!0),r.zoom+=a.zoom*e.zoom}_clampTiltDeltaGlobalToValidRange(e,t,r){const n=Kt(this.view.spatialReference),s=uE(Jn.min,t.origin,r,n);let a=0,o=0;const l=Xe.get();if(this.view.renderCoordsHelper.intersectManifold(t,r,l)){const c=Um(this.view.renderCoordsHelper,l,t.origin);a=uE(c,t.origin,r,n),o=uE(Jn.max,t.origin,r,n)}else{NR(ED(RD,r+n.radius),t,l);const c=ls(-_e(t.direction,de(l,l)));a=xU(c,t.origin,r,n),o=xU(Jn.max,t.origin,r,n)}return ue(a+e,s,o)-a}_getPointAbsoluteSurfaceElevation(e,t,r){const{renderCoordsHelper:n}=this.view,s=n.getAltitude(e),a=t+Math.abs(s-t);return n.setAltitude(r,a,e),a}_clampedDistanceToSurface(e,t){const{renderCoordsHelper:r}=this.view,{camera:n}=this.view.state,{direction:s}=Xwe(this.view,t,0,CY,Fxe),a=r.intersectManifoldClosestSilhouette(zc(t,s),e,Xe.get()),o=Li(t,a),l=r.intersectManifoldClosestSilhouette(zc(t,Jg(Xe.get(),t,n.center)),e,Xe.get()),c=Li(t,l);return Math.min(o,c)}_computeHeadingRotateRadius(e){const{renderCoordsHelper:t,state:r}=this.view,{camera:n,isGlobal:s}=r,a=t.intersectManifoldClosestSilhouette(n.ray,this._filteredSurfaceElevation,Xe.get());if(s){const o=ae(Xe.get(),e,a),l=we(o);Q(o,o,1/l);const c=de(Xe.get(),e),u=ls(_e(c,o));return l*Math.sin(Math.min(Ixe,u))}{const o=X(Xe.get(),e);return t.setAltitude(o,this._filteredSurfaceElevation),Li(a,o)}}_minimumAscendVelocity(){return this.view.state.constraints.collision.enabled?0:Lxe}_computeVelocities(e){const t=this._filteredSurfaceElevation,r=t+Kt(this.view.spatialReference).radius,{camera:n,isGlobal:s}=this.view.state,a=Xe.get(),o=this._getPointAbsoluteSurfaceElevation(n.eye,t,a),l=this._clampedDistanceToSurface(t,a),c=n.width/2,u=NU*n.width,d=NU*n.width,m=l*Math.tan(.5*n.fovX)/c,f=m/r,_=m/this._computeHeadingRotateRadius(a),g=o-t;return{pan:(s?f:m)*u*e,ascend:Math.max(this._minimumAscendVelocity()*e,2**(u*e/c)*g-g),zoom:2**(u*e/c)*l-l,rotate:ue(_*d,$xe,Dxe)*e}}_applyDisabledMovementTypes(e){!y(this.disableMovements)||this.disableMovements.mode!==void 0&&this.view.state.viewingMode!==this.disableMovements.mode||(e.zoom=this.disableMovements.zoom?0:e.zoom,e.ascend=this.disableMovements.ascend?0:e.ascend,e.pan.enabled=!this.disableMovements.pan,this.disableMovements.pan&&Mg(e.pan.matrix),e.rotate.enabled=!this.disableMovements.rotate,this.disableMovements.rotate&&Mg(e.rotate.matrix))}static activatesFor(e,t){const r=u3(t,e.navigation.gamepad,Mxe);return!(t.action==="end"||QS(r))}};h([p({constructOnly:!0})],ug.prototype,"gamepadDevice",void 0),h([p({constructOnly:!0})],ug.prototype,"disableMovements",void 0),ug=h([F("esri.views.3d.state.controllers.GamepadKeyboardController")],ug);const Mxe={translation:[0,0,0],heading:0,tilt:0,zoom:0},CY=80,Ixe=At(CY),NU=.75,Lxe=5,$xe=At(30),Dxe=At(80),of={zoom:0,ascend:0,pan:{enabled:!1,matrix:xe()},rotate:{enabled:!1,matrix:xe()}},ia=P(),p1=P(),Fxe=f4();function Nxe(i){i.zoom=0,i.ascend=0,i.pan.enabled=!1,Mg(i.pan.matrix),i.rotate.enabled=!1,Mg(i.rotate.matrix)}let kxe=class extends Ri{constructor(e){super(!0),this._view=e,this._watchHandles=new Vt,this._handle=this.registerIncoming("gamepad",t=>this._handleEventGamepad(t)),this._handle.pause()}onInstall(e){super.onInstall(e),this._watchHandles.add([B(()=>this._view.navigation.gamepad.enabled,t=>{t?this._handle.resume():(this._handle.pause(),this._cameraControllerGamepad&&(this._cameraControllerGamepad.finishController(),this._cameraControllerGamepad=null))},et),B(()=>this._view.navigation.gamepad.device,t=>{this._cameraControllerGamepad&&t&&this._cameraControllerGamepad.gamepadDevice!==t&&(this._cameraControllerGamepad.finishController(),this._cameraControllerGamepad=null)})])}onUninstall(){this._watchHandles.removeAll(),super.onUninstall()}_handleEventGamepad(e){const t=this._view.navigation.gamepad.device;if(t&&e.data.device!==t)return;const r=this._cameraControllerGamepad&&this._cameraControllerGamepad.active;if(r||ug.activatesFor(this._view,e.data)){if(!r){const n=new ug({view:this._view,gamepadDevice:e.data.device});this._view.state.switchCameraController(n)&&(this._cameraControllerGamepad=n)}this._cameraControllerGamepad&&this._cameraControllerGamepad.active&&this._cameraControllerGamepad.gamepadDevice===e.data.device&&this._cameraControllerGamepad.handleEventGamepad(e.data)}}};var Ka;(function(i){i[i.LEFT=0]="LEFT",i[i.RIGHT=1]="RIGHT",i[i.FORWARD=2]="FORWARD",i[i.BACKWARD=3]="BACKWARD",i[i.UP=4]="UP",i[i.DOWN=5]="DOWN",i[i.HEADINGLEFT=6]="HEADINGLEFT",i[i.HEADINGRIGHT=7]="HEADINGRIGHT",i[i.TILTUP=8]="TILTUP",i[i.TILTDOWN=9]="TILTDOWN",i[i.ZOOMIN=10]="ZOOMIN",i[i.ZOOMOUT=11]="ZOOMOUT"})(Ka||(Ka={}));let Vxe=class extends Ri{constructor(e,t){super(!0),this._view=e,this._disableMovements={pan:!0,zoom:!1,ascend:!0,rotate:!1,mode:Ie.Local},this._keyToNumber={[t.left]:Ka.LEFT,[t.right]:Ka.RIGHT,[t.forward]:Ka.FORWARD,[t.backward]:Ka.BACKWARD,[t.up]:Ka.UP,[t.down]:Ka.DOWN,[t.headingLeft]:Ka.HEADINGLEFT,[t.headingRight]:Ka.HEADINGRIGHT,[t.tiltUp]:Ka.TILTUP,[t.tiltDown]:Ka.TILTDOWN,[t.zoomIn]:Ka.ZOOMIN,[t.zoomOut]:Ka.ZOOMOUT},this.registerIncoming("key-down",null,r=>this._handleKeyDown(r)),this.registerIncoming("key-up",null,r=>this._handleKeyUp(r)),this.registerIncoming("blur",null,()=>this._handleBlur())}_handleKeyDown(e){if(e.data.native.ctrlKey||e.data.native.metaKey)return;const t=this._keyToNumber[e.data.key];t!=null&&(this._cameraControllerKeyboard&&this._cameraControllerKeyboard.active||(this._cameraControllerKeyboard=new ug({view:this._view,disableMovements:this._disableMovements}),this._view.state.switchCameraController(this._cameraControllerKeyboard)),this._cameraControllerKeyboard.active&&(this._cameraControllerKeyboard.activateDirection(t),e.stopPropagation()))}_handleBlur(){this._cameraControllerKeyboard&&this._cameraControllerKeyboard.active&&(this._cameraControllerKeyboard.finishController(),this._cameraControllerKeyboard=null)}_handleKeyUp(e){if(e.data.native.ctrlKey||e.data.native.metaKey)return;const t=this._keyToNumber[e.data.key];t!=null&&this._cameraControllerKeyboard&&this._cameraControllerKeyboard.active&&(this._cameraControllerKeyboard.deactivateDirection(t),e.stopPropagation())}},Uxe=class extends Ri{constructor(e,t){super(!0),this._view=e,this.registerIncoming("mouse-wheel",t,r=>this._handleMouseWheel(r))}_handleMouseWheel(e){if(!this._view.navigation.mouseWheelZoomEnabled)return;const t=e.data;this._cameraController&&this._cameraController.active||(this._cameraController=this._view.state.isGlobal?new eR({view:this._view,mode:"interaction"}):new tR({view:this._view,mode:"interaction"}),this._view.state.switchCameraController(this._cameraController)),this._cameraController.zoomStep(-1/60*t.deltaY,zi(t.x,t.y)),e.preventDefault(),e.stopPropagation()}},lR=class{constructor(e){this._gain=e}reset(e){this._value=e}set gain(e){this._gain=e}get value(){return this._value===void 0?0:this._value}update(e){this._value===void 0?this._value=e:this._value=this._gain*e+(1-this._gain)*this._value}},qg=class extends px{constructor(){super(...arguments),this._beginCamera=new vi,this._elapsedTimeSec=0,this.constraintOptions={selection:xi.ALL,interactionType:ht.PAN,interactionFactor:0,interactionStartCamera:new vi,interactionDirection:null,tiltMode:vn.TUMBLE}}initialize(){this.constraintOptions.interactionType=this.interactionType,this.viewAnimation=new Md}get steppingFinished(){return this.momentum.isFinished(this._elapsedTimeSec)}onControllerStart(e){this._beginCamera.copyFrom(e),this.constraintOptions.interactionStartCamera=this._beginCamera,super.onControllerStart(e)}stepController(e,t){t.copyViewFrom(this._beginCamera),this._elapsedTimeSec+=e,this.momentumStep(this._elapsedTimeSec,t),pr(this.view,t,this.constraintOptions)}};qg=h([F("esri.views.3d.state.controllers.momentum.MomentumController")],qg);let tw=class extends qg{constructor(e){super(e),this.interactionType=ht.PAN,this._tmpPan=P()}momentumStep(e,t){const r=this.momentum.value(e);Q(this._tmpPan,this.momentum.direction,r),t.eye=ae(kU,t.eye,this._tmpPan),t.center=ae(kU,t.center,this._tmpPan),this.constraintOptions.interactionDirection=this._tmpPan}};h([p({constructOnly:!0})],tw.prototype,"momentum",void 0),tw=h([F("esri.views.3d.state.controllers.momentum.PanPlanarMomentumController")],tw);const kU=P(),zxe=P(),CC=P();let pE=class extends qg{constructor(e){super(e),this.interactionType=ht.PAN}momentumStep(e,t){const r=this.momentum.value1(e),n=this.momentum.value2(e);X(CC,t.eye),de(CC,CC),ut(this.momentum.axis2,CC,this.momentum.axis1),QZ(t,zxe,this.momentum.axis1,r,this.momentum.axis2,n)}};h([p({constructOnly:!0})],pE.prototype,"momentum",void 0),pE=h([F("esri.views.3d.state.controllers.momentum.PanSphericalMomentumController")],pE);let tg=class extends qg{constructor(e){super(e),this.interactionType=ht.TUMBLE}set center(e){this._set("center",as(e))}set axis(e){this._set("axis",as(e))}momentumStep(e,t){const r=this.momentum.value(e);zm(t,this.center,mx(this.axis,r))}};h([p({constructOnly:!0})],tg.prototype,"momentum",void 0),h([p({constructOnly:!0})],tg.prototype,"center",null),h([p({constructOnly:!0})],tg.prototype,"axis",null),tg=h([F("esri.views.3d.state.controllers.momentum.MomentumController")],tg);let g0=class extends qg{constructor(e){super(e),this.interactionType=ht.ZOOM,this.constraintOptions.interactionDirection=P()}set zoomCenter(e){this._set("zoomCenter",as(e))}momentumStep(e,t){X(this.constraintOptions.interactionDirection,t.eye);const r=this.momentum.valueDelta(0,e);d4(t,this.zoomCenter,r,this.view.state.constraints.minimumPoiDistance),this.constraintOptions.interactionDirection=Jg(this.constraintOptions.interactionDirection,t.eye,this.constraintOptions.interactionDirection)}};h([p({constructOnly:!0})],g0.prototype,"momentum",void 0),h([p({constructOnly:!0})],g0.prototype,"zoomCenter",null),g0=h([F("esri.views.3d.state.controllers.momentum.ZoomPlanarMomentumController")],g0);let Vf=class extends qg{constructor(e){super(e),this.interactionType=ht.ZOOM,this.radius=0,this._tmpSceneCenter=P(),this._tmpZoomAxisAngle=$P(),this._sphere=ou()}set screenCenter(e){this._set("screenCenter",zi(e[0],e[1]))}set sceneCenter(e){this._set("sceneCenter",as(e))}initialize(){this._sphere[3]=this.radius}momentumStep(e,t){const r=this.momentum.valueDelta(0,e);GZ(this._sphere,t,r),this.constraintOptions.interactionType=ht.ZOOM,pr(this.view,t,this.constraintOptions),fx(this._sphere,t,this.screenCenter,this._tmpSceneCenter),c4(this.sceneCenter,this._tmpSceneCenter,this._tmpZoomAxisAngle),zm(t,this._sphere,this._tmpZoomAxisAngle),this.constraintOptions.interactionType=ht.PAN}};h([p({constructOnly:!0})],Vf.prototype,"momentum",void 0),h([p({constructOnly:!0})],Vf.prototype,"screenCenter",null),h([p({constructOnly:!0})],Vf.prototype,"sceneCenter",null),h([p({constructOnly:!0})],Vf.prototype,"radius",void 0),Vf=h([F("esri.views.3d.state.controllers.momentum.ZoomSphericalMomentumController")],Vf);let Sc=class{constructor(e){this._gain=e,this.lastValue=void 0,this.filteredDelta=void 0}update(e){if(this.hasLastValue()){const t=this.computeDelta(e);this._updateDelta(t)}this.lastValue=e}reset(){this.lastValue=void 0,this.filteredDelta=void 0}hasLastValue(){return this.lastValue!==void 0}hasFilteredDelta(){return this.filteredDelta!==void 0}computeDelta(e){return this.lastValue===void 0?NaN:e-this.lastValue}_updateDelta(e){this.filteredDelta!==void 0?this.filteredDelta=(1-this._gain)*this.filteredDelta+this._gain*e:this.filteredDelta=e}},kP=class{constructor(e,t,r){this._initialVelocity=e,this._stopVelocity=t,this._friction=r,this._duration=Math.abs(Math.log(Math.abs(this._initialVelocity)/this._stopVelocity)/Math.log(1-this._friction))}get duration(){return this._duration}isFinished(e){return e>this.duration}get friction(){return this._friction}value(e){return this.valueFromInitialVelocity(this._initialVelocity,e)}valueDelta(e,t){const r=this.value(e);return this.value(e+t)-r}valueFromInitialVelocity(e,t){t=Math.min(t,this.duration);const r=1-this.friction;return e*(r**t-1)/Math.log(r)}},Bxe=class extends kP{constructor(e,t,r,n,s){super(e,t,r),this._sceneVelocity=n,this.direction=s}value(e){return super.valueFromInitialVelocity(this._sceneVelocity,e)}},SY=class{constructor(e=300,t=12,r=.84){this._minimumInitialVelocity=e,this._stopVelocity=t,this._friction=r,this.enabled=!0,this._time=new Sc(.6),this._screen=[new Sc(.4),new Sc(.4)],this._scene=[new Sc(.6),new Sc(.6),new Sc(.6)],this._tmpDirection=P()}add(e,t,r){if(this.enabled){if(this._time.hasLastValue()&&this._time.computeDelta(r)<.015)return;this._screen[0].update(e[0]),this._screen[1].update(e[1]),this._scene[0].update(t[0]),this._scene[1].update(t[1]),this._scene[2].update(t[2]),this._time.update(r)}}reset(){this._screen[0].reset(),this._screen[1].reset(),this._scene[0].reset(),this._scene[1].reset(),this._scene[2].reset(),this._time.reset()}evaluateMomentum(){if(!this.enabled||!this._screen[0].hasFilteredDelta()||!this._time.hasFilteredDelta())return null;const e=this._screen[0].filteredDelta,t=this._screen[1].filteredDelta,r=e==null||t==null?0:Math.sqrt(e*e+t*t),n=this._time.filteredDelta,s=n==null||r==null?0:r/n;return Math.abs(s)<this._minimumInitialVelocity?null:this.createMomentum(s,this._stopVelocity,this._friction)}createMomentum(e,t,r){Y(this._tmpDirection,this._scene[0].filteredDelta??0,this._scene[1].filteredDelta??0,this._scene[2].filteredDelta??0);const n=we(this._tmpDirection);n>0&&Q(this._tmpDirection,this._tmpDirection,1/n);const s=this._time.filteredDelta;return new Bxe(e,t,r,s==null?0:n/s,this._tmpDirection)}},VU=class{constructor(e){this._gain=e}update(e){this.filteredValue!==void 0?this.filteredValue=(1-this._gain)*this.filteredValue+this._gain*e:this.filteredValue=e}reset(){this.filteredValue=void 0}get hasFilteredValue(){return this.filteredValue!==void 0}};const UU=1e-5;let Gxe=class extends kP{constructor(e,t,r,n,s,a=0,o){super(e,t,r),this._angularVelocity1=n,this.axis1=s,this.angularVelocity2=a,this.axis2=o}value1(e){return super.valueFromInitialVelocity(this._angularVelocity1,e)}value2(e){return super.valueFromInitialVelocity(this.angularVelocity2,e)}},Hxe=class{constructor(e=300,t=12,r=.84){this._minimumInitialVelocity=e,this._stopVelocity=t,this._friction=r,this.enabled=!0,this._tmpAxis1=P(),this._tmpAxis2=P(),this._tmpAngles=Te(),this._time=new Sc(.3),this._screen=[new Sc(.4),new Sc(.4)],this._angle1=new VU(.6),this._angle2=new VU(.6),this._axis1=P(),this._axis2=P(),this._lastScene=P()}addMomentumDirectRotation(e,t,r,n,s,a){if(this.enabled){if(this._time.hasLastValue()){if(this._time.computeDelta(r)<.01)return;let o=WZ(this._lastScene,t,this._tmpAxis2,n,s,a);this._angle2.update(0),Ml(this._tmpAxis2)<UU?o=0:de(this._axis1,this._tmpAxis2),this._angle1.update(o),X(this._lastScene,t)}this._screen[0].update(e[0]),this._screen[1].update(e[1]),this._time.update(r)}}addMomentumPreserveHeading(e,t,r,n,s,a,o){if(this.enabled){if(this._time.hasLastValue()){if(this._time.computeDelta(r)<.01)return;XZ(this._lastScene,t,this._tmpAxis2,this._tmpAxis1,this._tmpAngles,n,s,a,o,!1),Ml(this._tmpAxis2)<UU?(this._angle1.update(0),this._angle2.update(0)):(this._angle1.update(this._tmpAngles[1]),this._angle2.update(this._tmpAngles[0]),de(this._axis1,this._tmpAxis1),de(this._axis2,this._tmpAxis2)),X(this._lastScene,t)}this._screen[0].update(e[0]),this._screen[1].update(e[1]),this._time.update(r)}}reset(){this._screen[0].reset(),this._screen[1].reset(),this._angle1.reset(),this._angle2.reset(),this._time.reset()}evaluateMomentum(){if(!this.enabled||!this._screen[0].hasFilteredDelta())return null;const e=this._screen[0].filteredDelta,t=this._screen[1].filteredDelta,r=e==null||t==null?null:Math.sqrt(e*e+t*t),n=this._time.filteredDelta,s=r==null||n==null?0:r/n;return Math.abs(s)<this._minimumInitialVelocity?null:this.createMomentum(s,this._stopVelocity,this._friction)}createMomentum(e,t,r){const n=this._time.filteredDelta,s=this._angle1.filteredValue,a=this._angle2.filteredValue,o=n==null||a==null?0:a/n;return new Gxe(e,t,r,n==null||s==null?0:s/n,this._axis1,o,this._axis2)}},EY=class{constructor(e=2.5,t=.01,r=.95,n=12){this._minimumInitialVelocity=e,this._stopVelocity=t,this._friction=r,this._maxVelocity=n,this.enabled=!0,this.value=new Sc(.8),this.time=new Sc(.3)}add(e,t){if(this.enabled&&t!=null){if(this.time.hasLastValue()){if(this.time.computeDelta(t)<.01)return;if(this.value.hasFilteredDelta()){const r=this.value.computeDelta(e);this.value.filteredDelta*r<0&&this.value.reset()}}this.time.update(t),this.value.update(e)}}reset(){this.value.reset(),this.time.reset()}evaluateMomentum(){if(!this.enabled||!this.value.hasFilteredDelta()||!this.time.hasFilteredDelta())return null;let e=this.value.filteredDelta/this.time.filteredDelta;return e=ue(e,-this._maxVelocity,this._maxVelocity),Math.abs(e)<this._minimumInitialVelocity?null:this.createMomentum(e,this._stopVelocity,this._friction)}createMomentum(e,t,r){return new kP(e,t,r)}},RY=class extends EY{constructor(e=3,t=.01,r=.95,n=12){super(e,t,r,n)}add(e,t){const r=this.value.lastValue;if(r!=null){let n=e-r;for(;n>Math.PI;)n-=2*Math.PI;for(;n<-Math.PI;)n+=2*Math.PI;e=r+n}super.add(e,t)}},jxe=class extends kP{constructor(e,t,r){super(e,t,r)}value(e){const t=super.value(e);return Math.exp(t)}valueDelta(e,t){const r=super.value(e),n=super.value(e+t)-r;return Math.exp(n)}},PY=class extends EY{constructor(e=2.5,t=.01,r=.95,n=12){super(e,t,r,n)}add(e,t){super.add(Math.log(e),t)}createMomentum(e,t,r){return new jxe(e,t,r)}},J3=class extends Hh{constructor(){super(...arguments),this._smoothRotation=new lR(.05),this._rotationAxis=P(),this._panningPlane=fr(),this._smoothScaling=new lR(.05),this._zoomCenterScreen=zi(),this._zoomMomentumEstimator=new PY,this._rotationMomentumEstimator=new RY,this._panSphericalMomentumEstimator=new Hxe,this._panPlanarMomentumEstimator=new SY,this._adjustedSphere=ou(),this._tmp3d=P(),this._tmpScreenPointArray=zi(),this._beginScreenPoint=zi(),this._beginScenePoint=P(),this._screenPickPoint=zi(),this._mode=Dn.Horizontal,this._tmpInteractionDirection=P(),this._constraintOptions={selection:xi.ALL,interactionType:ht.NONE,interactionFactor:0,interactionStartCamera:new vi,interactionDirection:null,tiltMode:vn.TUMBLE}}get _intersectionHelper(){return this.view.sceneIntersectionHelper}begin(e){if(!this.active)return;const t=this.view.navigation.momentumEnabled;this._zoomMomentumEstimator.enabled=t,this._rotationMomentumEstimator.enabled=t,this._panPlanarMomentumEstimator.enabled=t,this._panSphericalMomentumEstimator.enabled=t,this._beginHeading=-Em.normalize(At(this.view.camera.heading)),this._beginRadius=e.radius,this._pointerCount=e.pointers.size,this._beginAngle=e.angle,this._smoothRotation.reset(),Dh(e.center,this._screenPickPoint),wn(this._beginScreenPoint,this._screenPickPoint);const r=Kt(this.view.spatialReference),n=jZ(this._intersectionHelper,this.startCamera,this._screenPickPoint,r,cv.Silhouette);C(n.scenePickPoint)||(this._scenePickPoint=n.scenePickPoint,this._sphere=n.sphere,X(this._beginScenePoint,this._scenePickPoint),this._mode=DP(this.startCamera,this._screenPickPoint,n.hasGeometryIntersection,r),this._mode===Dn.Vertical&&this._preparePlanarPanMode(e),this._constraintOptions.interactionStartCamera.copyFrom(this.startCamera))}update(e){if(!this.active)return;this.currentCamera.copyFrom(this.startCamera);const t=e.pointers.size>1;this._mode===Dn.Horizontal?(t&&this._zoomSpherical(e),this._panningSpherical(e),t&&this._rotateSpherical(e)):(t&&this._zoomPlanar(e),this._panningPlanar(e),t&&this._rotatePlanar(e)),this.commitCamera()}end(e){e.pointers.size===this._pointerCount&&this.update(e),this.finishController();const t=this._zoomMomentumEstimator.evaluateMomentum();if(t)return this._mode===Dn.Horizontal?new Vf({view:this.view,momentum:t,screenCenter:this._zoomCenterScreen,sceneCenter:this._beginScenePoint,radius:this._sphere[3]}):new g0({view:this.view,momentum:t,zoomCenter:this._beginScenePoint});const r=this._rotationMomentumEstimator.evaluateMomentum();if(r)return new tg({view:this.view,momentum:r,center:this._sphere,axis:this._rotationAxis});if(this._mode===Dn.Horizontal){const n=this._panSphericalMomentumEstimator.evaluateMomentum();if(n)return new pE({view:this.view,momentum:n})}else{const n=this._panPlanarMomentumEstimator.evaluateMomentum();if(n)return new tw({view:this.view,momentum:n})}return null}_preparePlanarPanMode(e){const t=Aa(this._tmp3d,this.startCamera.viewForward);Ew(this._scenePickPoint,t,this._panningPlane);const r=zi(this._screenPickPoint[0],0),n=P(),s=we(this.startCamera.eye);this._adjustedSphere[3]=s<this._sphere[3]?s-100:this._sphere[3],fx(this._adjustedSphere,this.startCamera,r,n);const a=is();this.startCamera.projectToRenderScreen(n,a);const o=.9*a[1];this._screenPickPoint[1]=Math.min(this._screenPickPoint[1],o);const l=this._intersectionHelper.intersectScreen(this._screenPickPoint,this._scenePickPoint);l&&Ew(this._scenePickPoint,Ia(this._panningPlane),this._panningPlane);const c=P(),u=P(),d=P(),m=80,f=5,_=50;ae(c,this._scenePickPoint,this.currentCamera.eye);const g=we(c);de(c,c);const w=f*Math.max(Math.abs(this.view.camera.position.z),_),v=this.view._stage.renderView.getMinimalDepthForArea(null,this._screenPickPoint[0],this._screenPickPoint[1],this.view.state.camera,m);let b=y(v)?Math.min(v,w):w;b=l?Math.min(b,g):b,X(d,ce(u,this.currentCamera.eye,Q(u,c,b))),this._panningPlane[3]=-_e(this._panningPlane,d),this.startCamera.center=ce(u,this.startCamera.eye,Q(u,this.startCamera.viewForward,b));const x=Dh(e.center,this._tmpScreenPointArray);W3(this._panningPlane,this.startCamera,x,this._beginScenePoint)}_zoomSpherical(e){const t=this._beginRadius/e.radius,r=.001875*Math.min(Math.max(e.radius,40),120);this._smoothScaling.gain=r,this._smoothScaling.update(t),GZ(this._sphere,this.currentCamera,this._smoothScaling.value),Dh(e.center,this._zoomCenterScreen),this._zoomMomentumEstimator.add(this._smoothScaling.value,.001*e.timestamp),this._constraintOptions.interactionType=ht.ZOOM,this._constraintOptions.interactionFactor=Cc(e.radius-this._beginRadius),pr(this.view,this.currentCamera,this._constraintOptions)}_panningSpherical(e){const t=Dh(e.center,this._tmpScreenPointArray);fx(this._sphere,this.currentCamera,t,this._tmp3d),p4(this._beginScenePoint,_e(this.currentCamera.up,this._beginScenePoint),this._sphere[3],this._beginHeading,this.view.camera.tilt,this.startCamera)?(YZ(this._sphere,this.currentCamera,this._beginScenePoint,this._tmp3d,this._beginHeading,this.view.camera.tilt,!1),this._panSphericalMomentumEstimator.addMomentumPreserveHeading(t,this._tmp3d,.001*e.timestamp,this.startCamera,this._sphere,this._beginHeading,this.view.camera.tilt)):(ZZ(this._sphere,this.currentCamera,this._beginScenePoint,this._tmp3d,this.view.camera.tilt,!1),this._panSphericalMomentumEstimator.addMomentumDirectRotation(t,this._tmp3d,.001*e.timestamp,this.startCamera,this._sphere[3],this.view.camera.tilt)),this._constraintOptions.interactionType=ht.PAN,this._constraintOptions.interactionFactor=Cc(Q0(this._screenPickPoint,t)),pr(this.view,this.currentCamera,this._constraintOptions)}_rotateSpherical(e){de(this._rotationAxis,this._scenePickPoint),this.currentCamera.aboveGround||Aa(this._rotationAxis,this._rotationAxis);const t=this._smoothRotation.value,r=t+q3(e.angle-t),n=.00125*Math.min(Math.max(e.radius,40),120);this._smoothRotation.gain=n,this._smoothRotation.update(r);const s=this._smoothRotation.value-this._beginAngle;this._rotationMomentumEstimator.add(s,.001*e.timestamp),zm(this.currentCamera,this._sphere,mx(this._rotationAxis,s)),this._constraintOptions.interactionType=ht.TUMBLE,this._constraintOptions.interactionFactor=Cc(e.radius*r),pr(this.view,this.currentCamera,this._constraintOptions)}_panningPlanar(e){const t=Dh(e.center,this._tmpScreenPointArray);W3(this._panningPlane,this.currentCamera,t,this._tmp3d)&&(qZ(this.currentCamera,this._beginScenePoint,this._tmp3d),this._panPlanarMomentumEstimator.add(t,this._tmp3d,.001*e.timestamp),this._constraintOptions.interactionType=ht.PAN,this._constraintOptions.interactionFactor=Cc(Q0(this._beginScreenPoint,t)),this._constraintOptions.interactionDirection=this.view.renderCoordsHelper.worldUpAtPosition(this.currentCamera.eye,this._tmpInteractionDirection),pr(this.view,this.currentCamera,this._constraintOptions),this._constraintOptions.interactionDirection=null)}_zoomPlanar(e){const t=this._beginRadius/e.radius,r=.001875*Math.min(Math.max(e.radius,40),120);this._smoothScaling.gain=r,this._smoothScaling.update(t),this._zoomMomentumEstimator.add(this._smoothScaling.value,.001*e.timestamp),d4(this.currentCamera,this._beginScenePoint,this._smoothScaling.value,this.view.state.constraints.minimumPoiDistance),this._constraintOptions.interactionType=ht.ZOOM,this._constraintOptions.interactionFactor=Cc(e.radius-this._beginRadius),pr(this.view,this.currentCamera,this._constraintOptions)}_rotatePlanar(e){X(this._rotationAxis,this._beginScenePoint),this.currentCamera.aboveGround||Aa(this._rotationAxis,this._rotationAxis);const t=this._smoothRotation.value;let r=e.angle-t;r=q3(r);const n=t+r,s=.00125*Math.min(Math.max(e.radius,40),120);this._smoothRotation.gain=s,this._smoothRotation.update(n);const a=this._smoothRotation.value-this._beginAngle;this._rotationMomentumEstimator.add(a,.001*e.timestamp),zm(this.currentCamera,this._sphere,mx(this._rotationAxis,a)),this._constraintOptions.interactionType=ht.TUMBLE,this._constraintOptions.interactionFactor=Cc(e.radius*a),pr(this.view,this.currentCamera,this._constraintOptions)}};J3=h([F("esri.views.3d.state.controllers.global.PinchAndPanController")],J3);const zU=Ze(0,0,1),qxe={ELEVATION_THRESHOLD:3e4,ANGLE_THRESHOLD:16/180*Math.PI},Wxe=80;let e$=class extends Hh{constructor(){super(...arguments),this._rotationValueSmooth=new lR(.05),this._scalingValueSmooth=new lR(.05),this._planeHorizontal=fr(),this._planeVertical=fr(),this._rotationMomentumEstimator=new RY,this._panMomentumEstimator=new SY(300,12,.9),this._zoomMomentumEstimator=new PY,this._beginCenter=P(),this._tmpPoints=[],this._beginCenterScreen=zi(),this._tmpCentroid3d=P(),this._tmpCentroid2d=zi(),this._tmp2d=zi(),this._constraintOptions={selection:xi.ALL,interactionType:ht.NONE,interactionFactor:0,interactionStartCamera:new vi,interactionDirection:null,tiltMode:vn.TUMBLE}}begin(e){if(!this.active)return;const t=this.view.navigation.momentumEnabled;this._zoomMomentumEstimator.enabled=t,this._rotationMomentumEstimator.enabled=t,this._panMomentumEstimator.enabled=t,this._beginRadius=e.radius,this._pointerCount=e.pointers.size,this._beginAngle=e.angle,this._rotationValueSmooth.reset(),this._scalingValueSmooth.reset(),Dh(e.center,this._beginCenterScreen),kG(zU,0,this._planeHorizontal);const r=P(),n=this._intersectionHelper.intersectScreenFreePointFallback(this._beginCenterScreen,r),s=P();Aa(s,this.startCamera.viewForward);const a=P();X(a,zU);const o=_e(s,a),l=tu(o<0?-o:o);if(this._panMode=l>=qxe.ANGLE_THRESHOLD?Dn.Horizontal:Dn.Vertical,$I(this._planeHorizontal,this._planeHorizontal,r),this.startCamera.aboveGround||DI(this._planeHorizontal,this._planeHorizontal),this._panMode===Dn.Vertical){Q(a,a,o),ae(this._planeVertical,s,a),de(this._planeVertical,this._planeVertical),$I(this._planeVertical,this._planeVertical,r);const c=P(),u=P(),d=P();ae(c,r,this.currentCamera.eye);const m=we(c);de(c,c);const f=5*Math.max(Math.abs(this.view.camera.position.z),50),_=this.view._stage.renderView.getMinimalDepthForArea(this.view.voxelWasm,this._beginCenterScreen[0],this._beginCenterScreen[1],this.view.state.camera,Wxe);let g=y(_)?Math.min(_,f):f;g=n?Math.min(g,m):g,X(d,ce(u,this.currentCamera.eye,Q(u,c,g))),this._planeVertical[3]=-_e(this._planeVertical,d),this._computePlanePoints(e.pointers,this._planeVertical,this.startCamera,this._tmpPoints),zO(this._tmpPoints,this._beginCenter)}else this._computePlanePoints(e.pointers,this._planeHorizontal,this.startCamera,this._tmpPoints),zO(this._tmpPoints,this._beginCenter);this._constraintOptions.interactionStartCamera.copyFrom(this.startCamera)}update(e){if(!this.active)return;this.currentCamera.copyFrom(this.startCamera);const t=e.pointers.size>1,r=this._panMode===Dn.Horizontal?this._planeHorizontal:this._planeVertical,n=this._beginCenter;if(t){const s=this._beginRadius/e.radius,a=.001875*Math.min(Math.max(e.radius,40),120);this._scalingValueSmooth.gain=a,this._scalingValueSmooth.update(s),d4(this.currentCamera,n,this._scalingValueSmooth.value,this.view.state.constraints.minimumPoiDistance),this._zoomMomentumEstimator.add(this._scalingValueSmooth.value,.001*e.timestamp),this._constraintOptions.interactionType=ht.ZOOM,this._constraintOptions.interactionFactor=Cc(Math.abs(e.radius-this._beginRadius)),pr(this.view,this.currentCamera,this._constraintOptions)}if(this._computePlanePoints(e.pointers,r,this.currentCamera,this._tmpPoints),zO(this._tmpPoints,this._tmpCentroid3d),Dh(e.center,this._tmpCentroid2d),qZ(this.currentCamera,n,this._tmpCentroid3d),this._panMomentumEstimator.add(this._tmpCentroid2d,this._tmpCentroid3d,.001*e.timestamp),this._constraintOptions.interactionType=ht.PAN,this._constraintOptions.interactionFactor=Cc(Q0(this._beginCenterScreen,this._tmpCentroid2d)),pr(this.view,this.currentCamera,this._constraintOptions),t){const s=this._planeHorizontal,a=n,o=this._rotationValueSmooth.value,l=o+q3(e.angle-o),c=.00125*Math.min(Math.max(e.radius,40),120);this._rotationValueSmooth.gain=c,this._rotationValueSmooth.update(l);const u=this._rotationValueSmooth.value-this._beginAngle;this._rotationMomentumEstimator.add(u,.001*e.timestamp),zm(this.currentCamera,a,mx(s,u)),this._constraintOptions.interactionType=ht.TUMBLE,this._constraintOptions.interactionFactor=Cc(Math.abs(e.radius*u)),pr(this.view,this.currentCamera,this._constraintOptions)}this.commitCamera()}end(e){e.pointers.size===this._pointerCount&&this.update(e),this.finishController();const t=this._zoomMomentumEstimator.evaluateMomentum();if(t)return new g0({view:this.view,momentum:t,zoomCenter:this._beginCenter});const r=this._rotationMomentumEstimator.evaluateMomentum();if(r)return new tg({view:this.view,momentum:r,center:this._beginCenter,axis:Ia(this._planeHorizontal)});const n=this._panMomentumEstimator.evaluateMomentum();return n?new tw({view:this.view,momentum:n}):null}_computePlanePoints(e,t,r,n){n.length=e.size;const s=this._tmp2d;let a=0;return e.forEach(o=>{s[0]=o.x,s[1]=o.y,n[a]===void 0&&(n[a]=P()),W3(t,r,s,n[a]),a+=1}),n}get _intersectionHelper(){return this.view.sceneIntersectionHelper}};e$=h([F("esri.views.3d.state.controllers.local.PinchAndPanController")],e$);let BU=class extends Ri{constructor(e,t,r){super(!0),this._view=e,this.pointerAction=t,this._lastEndTimestamp=0,this._lastTimestamp=0,this.registerIncoming("drag",r,n=>this._handleDrag(n))}_handleDrag(e){if(e.data.pointerType==="mouse"&&!yN(e.data,this.pointerAction))return;const t=e.timestamp-this._lastEndTimestamp,r=40,n=this._momentum&&this._momentum.active&&t<r;switch(e.data.action){case"start":case"update":if(n)break;this._controller&&this._controller.active?e.data.timestamp-this._lastTimestamp>2&&(this._controller.update(e.data),this._lastTimestamp=e.timestamp):this._startController(e);break;case"end":case"removed":this._endController(e,!0);break;case"added":this._endController(e,!1),this._startController(e)}e.stopPropagation()}_endController(e,t){if(this._controller&&this._controller.active){this._lastEndTimestamp=e.timestamp;const r=this._controller.end(e.data);t&&r&&(this._momentum=r,this._view.state.switchCameraController(this._momentum))}this._controller=null}_startController(e){this._controller=this._createController(),this._view.state.switchCameraController(this._controller),this._controller.begin(e.data),this._lastTimestamp=e.timestamp}_createController(){return this._view.state.isGlobal?new J3({view:this._view}):new e$({view:this._view})}},Xxe=class extends Ri{constructor(e,t){super(!0),this.view=e,this.registerIncoming("pointer-down",t,()=>this.view.state.stopActiveCameraController())}},AY=class extends Ri{constructor(e,t){super(!0),this.key=e,this.registerIncoming("key-down",t,r=>this._handleKeyDown(r))}_handleKeyDown(e){e.data.key===this.key&&(this.activate(),e.stopPropagation())}},Qxe=class extends AY{constructor(e,t,r){super(t,r),this.view=e}activate(){this.view.goTo({heading:0}).catch(()=>{})}},Zxe=class extends AY{constructor(e,t,r){super(t,r),this.view=e}activate(){this.view.goTo({tilt:0}).catch(()=>{})}},Yxe=class extends Ri{constructor(e,t=!1){super(!0),this._view=e,this._invert=t,this.registerIncoming("vertical-two-finger-drag",r=>this._handleTwoFinger(r))}_handleTwoFinger(e){var n,s,a;const t=this._invert?-1:1,r=zi(0,e.data.delta*t);switch(e.data.action){case"begin":(n=this._cameraController)==null||n.end(),this._cameraController=new ew({view:this._view,pivot:ro.CENTER}),this._view.state.switchCameraController(this._cameraController),this._cameraController.begin(r);break;case"update":(s=this._cameraController)==null||s.update(r);break;case"end":(a=this._cameraController)==null||a.end(),this._cameraController=null}}},Kxe=class extends Ri{constructor(e=20,t=40){super(!1),this._threshold=e,this._maxDelta=t,this._state="ready",this._emittedArtificalEnd2=!1,this._vertical=this.registerOutgoing("vertical-two-finger-drag"),this._artificalDrag=this.registerOutgoing("drag"),this._dragEventSeparator=new eT({start:(r,n)=>this._observeStart(r,n),update:(r,n,s)=>this._observeUpdate(r,n,s),end:(r,n)=>this._observeEnd(n)}),this.registerIncoming("drag",r=>this._dragEventSeparator.handle(r))}get failed(){return this._state==="failed"}_observeStart(e,t){e===1&&this._emittedArtificalEnd2&&(this._emittedArtificalEnd2=!1,this._artificalDrag.emit({action:"start",button:t.data.button,buttons:t.data.buttons,pointerType:t.data.pointerType,timestamp:t.data.timestamp,pointers:t.data.pointers,pointer:t.data.pointer,angle:t.data.angle,radius:t.data.radius,center:t.data.center}),t.stopPropagation()),this._state=e===2?"ready":"failed"}_observeUpdate(e,t,r){if(this._state!=="failed"&&e===2)return this._state==="active"?(this._vertical.emit({delta:t.data.center.y-this._thresholdReachedCenter.y,action:"update"}),void t.stopPropagation()):void(this._checkMovementWithinLimits(t.data,r.data)?this._checkVerticalThresholdReached(t.data,r.data)&&(this._state="active",this._emittedArtificalEnd2=!0,this._thresholdReachedCenter=t.data.center,this._artificalDrag.emit({action:"end",button:t.data.button,buttons:t.data.buttons,pointerType:t.data.pointerType,timestamp:t.data.timestamp,pointers:t.data.pointers,pointer:t.data.pointer,angle:t.data.angle,radius:t.data.radius,center:t.data.center}),this._vertical.emit({delta:t.data.center.y-this._thresholdReachedCenter.y,action:"begin"}),t.stopPropagation()):this._state="failed")}_observeEnd(e){this._state==="active"&&(this._vertical.emit({delta:e.data.center.y-this._thresholdReachedCenter.y,action:"end"}),this._state="ready",e.stopPropagation())}_checkMovementWithinLimits(e,t){let r=-1/0,n=1/0,s=-1/0,a=1/0;for(const{x:g,y:w}of t.pointers.values())r=Math.max(r,g),n=Math.min(n,g),s=Math.max(s,w),a=Math.min(a,w);let o=-1/0,l=1/0,c=-1/0,u=1/0;for(const{x:g,y:w}of e.pointers.values())o=Math.max(o,g),l=Math.min(l,g),c=Math.max(c,w),u=Math.min(u,w);const d=r-n,m=s-a,f=o-l,_=c-u;return Math.abs(e.center.x-t.center.x)<this._threshold&&Math.abs(f-d)<=this._maxDelta&&Math.abs(_-m)<=this._maxDelta}_checkVerticalThresholdReached(e,t){let r=Math.abs(e.center.y-t.center.y);return e.pointers.forEach((n,s)=>{const a=t.pointers.get(s);r=Math.min(r,Math.abs(n.y-a.y))}),r>=this._threshold}},ac=class extends pe{constructor(){super(...arguments),this._handles=new Vt}destroy(){this._handles&&(this._handles.removeAll(),this._handles=null),this.disconnect()}get primaryDragAction(){return this._get("primaryDragAction")}set primaryDragAction(e){e!=="pan"&&e!=="rotate"||e===this._get("primaryDragAction")||(this._set("primaryDragAction",e),this._updateMode())}get mode(){return this._get("mode")}set mode(e){e!=="default"&&e!=="pro"||e===this._get("mode")||(this._set("mode",e),this._updateMode())}get hasPendingInputs(){var e;return(e=this._inputManager)==null?void 0:e.hasPendingInputs}get latestPointerType(){var e;return(e=this._inputManager)==null?void 0:e.latestPointerType}get latestPointerLocation(){var e;return(e=this._inputManager)==null?void 0:e.latestPointerLocation}get multiTouchActive(){var e;return((e=this._inputManager)==null?void 0:e.multiTouchActive)??!1}disconnect(){this.view.viewEvents.disconnect(),this._inputManager=Oe(this._inputManager)}connect(){const e=this.view;this._source=new vN(this.view.surface,e.input);const t=[new cX,new hX,new aX,new oX(this.view.navigation),new Kxe],r=new uc({eventSource:this._source,recognizers:t});this._inputManager=r,r.installHandlers("prevent-context-menu",[new sX],Yh.INTERNAL),this._modeDragPan=new BU(e,"primary"),this._modeDragRotate=new KO(e,"secondary",ro.CENTER),this._modeDragZoom=new Oxe(e,"tertiary");const n={lookAround:"b",pan:{left:"ArrowLeft",right:"ArrowRight",forward:"ArrowUp",backward:"ArrowDown",up:"u",down:"j",headingLeft:"a",headingRight:"d",tiltUp:"w",tiltDown:"s",zoomIn:"+",zoomOut:"-"},resetHeading:"n",resetTilt:"p"};r.installHandlers("navigation",[new Xxe(e),new Twe(e),new kxe(e),new Vxe(e,n.pan),new Uxe(e),new Zxe(e,n.resetTilt),new Qxe(e,n.resetHeading),new KO(e,"primary",ro.EYE,[n.lookAround]),new KO(e,"secondary",ro.CENTER,[n.lookAround]),new BU(e,"tertiary",[n.lookAround]),this._modeDragRotate,this._modeDragZoom,this._modeDragPan,new Yxe(e)],Yh.INTERNAL),this.view.viewEvents.connect(r),this._updateMode(),this._handles.add(B(()=>{var s;return(s=this.view.navigation)==null?void 0:s.browserTouchPanEnabled},s=>{this._source.browserTouchPanningEnabled=!s},et))}_updateMode(){const e=this.mode,t=this.primaryDragAction,r=t$.get(e).get(t);this._modeDragPan&&(this._modeDragPan.pointerAction=r.pan),this._modeDragRotate&&(this._modeDragRotate.pointerAction=r.rotate),this._modeDragZoom&&(this._modeDragZoom.pointerAction=r.zoom)}get test(){return{inputManager:this._inputManager,modeDragPan:this._modeDragPan,modeDragRotate:this._modeDragRotate,modeDragZoom:this._modeDragZoom}}};h([p()],ac.prototype,"view",void 0),h([p({value:"pan"})],ac.prototype,"primaryDragAction",null),h([p({value:"default"})],ac.prototype,"mode",null),h([p({readOnly:!0})],ac.prototype,"hasPendingInputs",null),h([p()],ac.prototype,"latestPointerType",null),h([p()],ac.prototype,"latestPointerLocation",null),h([p()],ac.prototype,"multiTouchActive",null),h([p()],ac.prototype,"_inputManager",void 0),ac=h([F("esri.views.3d.input.SceneInputManager")],ac);const t$=new Map,JO=new Map,eM=new Map;JO.set("pan",{pan:"primary",rotate:"secondary",zoom:"tertiary"}),JO.set("rotate",{pan:"secondary",rotate:"primary",zoom:"tertiary"}),eM.set("pan",{pan:"primary",rotate:"tertiary",zoom:"secondary"}),eM.set("rotate",{pan:"tertiary",rotate:"primary",zoom:"secondary"}),t$.set("default",JO),t$.set("pro",eM);const Jxe=ac;let Go,V0,i$=!1,r$=!1,n$=!1,s$=!1,iw=null;function eTe(i,e){if(!r$||!V0)return;OY();const t=V0;let r=0;for(let n=0;n<i.accBinsNumX;n++)for(let s=0;s<i.accBinsNumY;s++){const a=i.accBins[n][i.accBinsNumY-1-s];r+=a.length;const o=n*i.accBinsSizeX,l=(n+1)*i.accBinsSizeX,c=s*i.accBinsSizeY,u=(s+1)*i.accBinsSizeY;t.fillText(a.length.toFixed(),o+5,c+15),MY(o,l,c,u,"blue")}t.fillText("total totalShownLabels: "+r,70,40),t.fillText("total visible labels: "+e.size,70,50),t.fillText("total numTests: "+i.accNumTests,70,30)}function tTe(i){n$=Wt.DECONFLICTOR_SHOW_VISIBLE,s$=Wt.DECONFLICTOR_SHOW_INVISIBLE,i$=n$||s$,r$=Wt.DECONFLICTOR_SHOW_GRID,iw=null,i$||r$?iw=()=>iTe(i):Go&&(Go.parentElement.removeChild(Go),Go=null)}function OY(){iw&&(iw(),iw=null)}function iTe(i){Go==null&&(Go=document.createElement("canvas"),Go.setAttribute("id","canvas2d"),i.surface.parentElement.style.position="relative",i.surface.parentElement.appendChild(Go));const{state:e}=i,{camera:t,pixelRatio:r}=e,{width:n,height:s}=t,a=n*r,o=s*r;Go.setAttribute("width",`${a}px`),Go.setAttribute("height",`${o}px`),Go.setAttribute("style",`position:absolute;left:0px;top:0px;display:block;pointer-events:none;width:${n}px;height:${s}px`),V0=Go.getContext("2d"),V0.clearRect(0,0,n,s),V0.font="12px Arial"}function MY(i,e,t,r,n){OY();const s=Go.height,a=V0;a.beginPath(),a.lineWidth=1,a.strokeStyle=n,a.moveTo(i,s-t),a.lineTo(e,s-t),a.stroke(),a.lineTo(e,s-r),a.stroke(),a.lineTo(e,s-t),a.stroke(),a.lineTo(i,s-t),a.stroke(),a.lineTo(i,s-t),a.stroke(),a.closePath()}function rTe(i,e){i$&&(e&&n$||!e&&s$)&&MY(i.aabr[0],i.aabr[2],i.aabr[1],i.aabr[3],e?"green":"red")}var $n,Qo;(function(i){i[i.GRAPHIC=0]="GRAPHIC",i[i.LABEL=1]="LABEL",i[i._COUNT=2]="_COUNT"})($n||($n={})),function(i){i[i.USER_SETTING=0]="USER_SETTING",i[i.SCALE_RANGE=1]="SCALE_RANGE",i[i.FILTER=2]="FILTER",i[i.DECONFLICTION=3]="DECONFLICTION",i[i._COUNT=4]="_COUNT"}(Qo||(Qo={}));function nTe(i){return i instanceof Float32Array&&i.length>=16}function sTe(i){return Array.isArray(i)&&i.length>=16}function aTe(i){return nTe(i)||sTe(i)}let IY=class LY extends ii{initializeConfiguration(e,t){t.hasWebGL2Context=e.rctx.type===Nn.WEBGL2,t.spherical=e.viewingMode===Ie.Global}initializeProgram(e){return new ei(e.rctx,LY.shader.get().build(this.configuration),oi)}_setPipelineState(e){const t=this.configuration,r=e===qt.NONE,n=e===qt.FrontFace,s=this.configuration.hasPolygonOffset&&oTe,a=(r||n)&&t.output!==V.Highlight?(t.depthEnabled||t.occlusionPass)&&nl:null;return it({blending:t.output===V.Color||t.output===V.Alpha||t.output===V.Highlight?r?lTe:qm(e):null,depthTest:{func:hs.LEQUAL},depthWrite:a,colorWrite:gt,polygonOffset:s})}initializePipeline(){return this._setPipelineState(this.configuration.transparencyPassType)}get primitiveType(){return this.configuration.occlusionPass?kt.POINTS:kt.TRIANGLES}};IY.shader=new ri(rae,()=>j(()=>import("./HUDMaterial.glsl-ea4d9626.js"),["assets/HUDMaterial.glsl-ea4d9626.js","assets/vec2-528adfe4.js","assets/common-c186b691.js","assets/vec2f64-30dc1443.js","assets/vec4f64-e407da96.js","assets/string-a318751c.js","assets/typedArrayUtil-4d7bb04c.js","assets/floatRGBA-9ad35d39.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/vec4-790471c0.js","assets/Texture-46c8c2cb.js","assets/compilerUtils-18d58939.js","assets/Error-ec6249b9.js","assets/Evented-a45c8b0f.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/VisualVariablePassParameters-d460182b.js","assets/VertexAttribute-9c5c630d.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/ShaderBuilder-a7d0da4e.js","assets/mat3f64-c6305894.js","assets/aaBoundingBox-657a9b82.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/aaBoundingRect-193543b5.js","assets/basicInterfaces-19ed850e.js","assets/ViewingMode-5d7d590b.js","assets/Util-a48361c6.js","assets/mat4-44a0988f.js","assets/mat4f64-1e28eae0.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/ScreenSpacePass-d5e48a9b.js","assets/Float4PassUniform-d7bdbc81.js","assets/Texture2DPassUniform-753de459.js","assets/assets-8d3e737a.js","assets/Matrix3PassUniform-ad9f953b.js","assets/HUD.glsl-d3a072ad.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/FloatPassUniform-68d54f51.js","assets/TransparencyPassType-a11868d2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/Slice.glsl-3b39b1f7.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/AlphaCutoff-96178e0d.js"]));const oTe={factor:0,units:-4},lTe=lu(me.ONE,me.ONE_MINUS_SRC_ALPHA);let lr=class extends cu{constructor(){super(...arguments),this.output=V.Color,this.screenCenterOffsetUnitsEnabled=Lm.World,this.transparencyPassType=qt.NONE,this.spherical=!1,this.occlusionTestEnabled=!0,this.signedDistanceFieldEnabled=!1,this.vvSize=!1,this.vvColor=!1,this.hasVerticalOffset=!1,this.hasScreenSizePerspective=!1,this.debugDrawLabelBorder=!1,this.binaryHighlightOcclusionEnabled=!0,this.hasSlicePlane=!1,this.hasPolygonOffset=!1,this.depthEnabled=!0,this.pixelSnappingEnabled=!0,this.isDraped=!1,this.hasMultipassGeometry=!1,this.hasMultipassTerrain=!1,this.cullAboveGround=!1,this.occlusionPass=!1,this.objectAndLayerIdColorInstanced=!1}};h([k({count:V.COUNT})],lr.prototype,"output",void 0),h([k({count:Lm.COUNT})],lr.prototype,"screenCenterOffsetUnitsEnabled",void 0),h([k({count:qt.COUNT})],lr.prototype,"transparencyPassType",void 0),h([k()],lr.prototype,"spherical",void 0),h([k()],lr.prototype,"occlusionTestEnabled",void 0),h([k()],lr.prototype,"signedDistanceFieldEnabled",void 0),h([k()],lr.prototype,"vvSize",void 0),h([k()],lr.prototype,"vvColor",void 0),h([k()],lr.prototype,"hasVerticalOffset",void 0),h([k()],lr.prototype,"hasScreenSizePerspective",void 0),h([k()],lr.prototype,"debugDrawLabelBorder",void 0),h([k()],lr.prototype,"binaryHighlightOcclusionEnabled",void 0),h([k()],lr.prototype,"hasSlicePlane",void 0),h([k()],lr.prototype,"hasPolygonOffset",void 0),h([k()],lr.prototype,"depthEnabled",void 0),h([k()],lr.prototype,"pixelSnappingEnabled",void 0),h([k()],lr.prototype,"isDraped",void 0),h([k()],lr.prototype,"hasMultipassGeometry",void 0),h([k()],lr.prototype,"hasMultipassTerrain",void 0),h([k()],lr.prototype,"cullAboveGround",void 0),h([k()],lr.prototype,"occlusionPass",void 0),h([k()],lr.prototype,"objectAndLayerIdColorInstanced",void 0),h([k({constValue:!0})],lr.prototype,"hasSliceInVertexProgram",void 0),h([k({constValue:!1})],lr.prototype,"hasVvInstancing",void 0);let uv=class extends Fd{constructor(e){super(e,new yTe),this._configuration=new lr}getConfiguration(e,t){return this._configuration.output=e,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.hasVerticalOffset=!!this.parameters.verticalOffset,this._configuration.hasScreenSizePerspective=!!this.parameters.screenSizePerspective,this._configuration.screenCenterOffsetUnitsEnabled=this.parameters.centerOffsetUnits==="screen"?Lm.Screen:Lm.World,this._configuration.hasPolygonOffset=this.parameters.polygonOffset,this._configuration.isDraped=this.parameters.isDraped,this._configuration.occlusionTestEnabled=this.parameters.occlusionTest,this._configuration.pixelSnappingEnabled=this.parameters.pixelSnappingEnabled,this._configuration.signedDistanceFieldEnabled=this.parameters.textureIsSignedDistanceField,this._configuration.vvSize=!!this.parameters.vvSizeEnabled,this._configuration.vvColor=!!this.parameters.vvColorEnabled,this._configuration.occlusionPass=t.slot===le.OCCLUSION_PIXELS&&this.parameters.occlusionTest&&(e===V.Color||e===V.Alpha),e===V.Color&&(this._configuration.debugDrawLabelBorder=!!this.parameters.debugDrawLabelBorder),e===V.Highlight&&(this._configuration.binaryHighlightOcclusionEnabled=this.parameters.binaryHighlightOcclusion),this._configuration.depthEnabled=this.parameters.depthEnabled,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration.hasMultipassGeometry=t.multipassGeometry.enabled,this._configuration.hasMultipassTerrain=t.multipassTerrain.enabled,this._configuration.cullAboveGround=t.multipassTerrain.cullAboveGround,this._configuration}intersect(e,t,r,n,s,a,o,l,c){y(c)?this._intersectDrapedHudGeometry(e,a,o,l,c):this._intersectHudGeometry(e,t,r,n,o,l)}_intersectDrapedHudGeometry(e,t,r,n,s){const a=e.vertexAttributes.get(S.POSITION),o=e.vertexAttributes.get(S.SIZE),l=this.parameters,c=uk(l);let u=1,d=1;if(y(n)){const f=n(jU);u=f[0],d=f[5]}u*=e.screenToWorldRatio,d*=e.screenToWorldRatio;const m=gTe*e.screenToWorldRatio;for(let f=0;f<a.data.length/a.size;f++){const _=f*a.size,g=a.data[_],w=a.data[_+1],v=f*o.size;let b;rp[0]=o.data[v]*u,rp[1]=o.data[v+1]*d,l.textureIsSignedDistanceField&&(b=l.outlineSize*e.screenToWorldRatio/2),GU(t,g,w,rp,m,b,l,c)&&r(s.dist,s.normal,-1,!1)}}_intersectHudGeometry(e,t,r,n,s,a){if(!n.options.selectionMode||!n.options.hud||UR(t))return;const o=this.parameters;let l=1,c=1;if(Td(iM,r),y(a)){const b=a(jU);l=b[0],c=b[5],uTe(iM)}const u=e.vertexAttributes.get(S.POSITION),d=e.vertexAttributes.get(S.SIZE),m=e.vertexAttributes.get(S.NORMAL),f=e.vertexAttributes.get(S.AUXPOS1);ct(u.size>=3);const _=n.point,g=n.camera,w=uk(o);l*=g.pixelRatio,c*=g.pixelRatio;const v=this.parameters.centerOffsetUnits==="screen";for(let b=0;b<u.data.length/u.size;b++){const x=b*u.size;Y(ms,u.data[x],u.data[x+1],u.data[x+2]),Me(ms,ms,r);const T=b*d.size;rp[0]=d.data[T]*l,rp[1]=d.data[T+1]*c,Me(ms,ms,g.viewMatrix);const R=b*f.size;if(Y(Ro,f.data[R+0],f.data[R+1],f.data[R+2]),!v&&(ms[0]+=Ro[0],ms[1]+=Ro[1],Ro[2]!==0)){const O=Ro[2];de(Ro,ms),ae(ms,ms,Q(Ro,Ro,O))}const E=b*m.size;if(Y(m1,m.data[E],m.data[E+1],m.data[E+2]),this._normalAndViewAngle(m1,iM,g,rM),this._applyVerticalOffsetTransformationView(ms,rM,g,tM),g.applyProjection(ms,Fs),Fs[0]>-1){Fs[0]=Math.floor(Fs[0]),Fs[1]=Math.floor(Fs[1]),v&&(Ro[0]||Ro[1])&&(Fs[0]+=Ro[0],Ro[1]!==0&&(Fs[1]+=kne(Ro[1],tM.factorAlignment)),g.unapplyProjection(Fs,ms)),Fs[0]+=this.parameters.screenOffset[0],Fs[1]+=this.parameters.screenOffset[1],QG(rp,tM.factor,rp);const O=fTe*g.pixelRatio;let $;if(o.textureIsSignedDistanceField&&($=o.outlineSize*g.pixelRatio/2),GU(_,Fs[0],Fs[1],rp,O,$,o,w)){const D=n.ray;if(Me(HU,ms,kn(mTe,g.viewMatrix)),Fs[0]=_[0],Fs[1]=_[1],g.unprojectFromRenderScreen(Fs,ms)){const I=P();X(I,D.direction);const G=1/we(I);Q(I,I,G),s(Li(D.origin,ms)*G,I,-1,!0,1,HU)}}}}}computeAttachmentOrigin(e,t){const r=e.vertexAttributes;if(!r)return!1;const n=r.get(S.POSITION),s=e.indices.get(S.POSITION);return cse(n,s,t)}createBufferWriter(){return new bTe(this)}_normalAndViewAngle(e,t,r,n){return aTe(t)&&(t=Td(pTe,t)),Nl(n.normal,e,t),Me(n.normal,n.normal,r.viewInverseTransposeMatrix),n.cosAngle=_e($Y,_Te),n}_updateScaleInfo(e,t,r){const n=this.parameters;y(n.screenSizePerspective)?X5(r,t,n.screenSizePerspective,e.factor):(e.factor.scale=1,e.factor.factor=0,e.factor.minPixelSize=0,e.factor.paddingPixels=0),y(n.screenSizePerspectiveAlignment)?X5(r,t,n.screenSizePerspectiveAlignment,e.factorAlignment):(e.factorAlignment.factor=e.factor.factor,e.factorAlignment.scale=e.factor.scale,e.factorAlignment.minPixelSize=e.factor.minPixelSize,e.factorAlignment.paddingPixels=e.factor.paddingPixels)}applyShaderOffsetsView(e,t,r,n,s,a,o){const l=this._normalAndViewAngle(t,r,s,rM);return this._applyVerticalGroundOffsetView(e,l,s,o),this._applyVerticalOffsetTransformationView(o,l,s,a),this._applyPolygonOffsetView(o,l,n[3],s,o),this._applyCenterOffsetView(o,n,o),o}applyShaderOffsetsNDC(e,t,r,n,s){return this._applyCenterOffsetNDC(e,t,r,n),y(s)&&X(s,n),this._applyPolygonOffsetNDC(n,t,r,n),n}_applyPolygonOffsetView(e,t,r,n,s){const a=n.aboveGround?1:-1;let o=Math.sign(r);o===0&&(o=a);const l=a*o;if(this.parameters.shaderPolygonOffset<=0)return X(s,e);const c=ue(Math.abs(t.cosAngle),.01,1),u=1-Math.sqrt(1-c*c)/c/n.viewport[2];return Q(s,e,l>0?u:1/u),s}_applyVerticalGroundOffsetView(e,t,r,n){const s=we(e),a=r.aboveGround?1:-1,o=.5*r.computeRenderPixelSizeAtDist(s),l=Q(ms,t.normal,a*o);return ce(n,e,l),n}_applyVerticalOffsetTransformationView(e,t,r,n){const s=this.parameters;if(!s.verticalOffset||!s.verticalOffset.screenLength){if(s.screenSizePerspective||s.screenSizePerspectiveAlignment){const c=we(e);this._updateScaleInfo(n,c,t.cosAngle)}else n.factor.scale=1,n.factorAlignment.scale=1;return e}const a=we(e),o=Ke(s.screenSizePerspectiveAlignment,s.screenSizePerspective),l=Vne(r,a,s.verticalOffset,t.cosAngle,o);return this._updateScaleInfo(n,a,t.cosAngle),Q(t.normal,t.normal,l),ce(e,e,t.normal)}_applyCenterOffsetView(e,t,r){const n=this.parameters.centerOffsetUnits!=="screen";return r!==e&&X(r,e),n&&(r[0]+=t[0],r[1]+=t[1],t[2]&&(de(m1,r),ce(r,r,Q(m1,m1,t[2])))),r}_applyCenterOffsetNDC(e,t,r,n){const s=this.parameters.centerOffsetUnits!=="screen";return n!==e&&X(n,e),s||(n[0]+=t[0]/r.fullWidth*2,n[1]+=t[1]/r.fullHeight*2),n}_applyPolygonOffsetNDC(e,t,r,n){const s=this.parameters.shaderPolygonOffset;if(e!==n&&X(n,e),s){const a=r.aboveGround?1:-1,o=a*Math.sign(t[3]);n[2]-=(o||a)*s}return n}requiresSlot(e,t){if(t===V.Color||t===V.Alpha||t===V.Highlight||t===V.ObjectAndLayerIdColor){if(e===le.DRAPED_MATERIAL)return!0;const{drawInSecondSlot:r,occlusionTest:n}=this.parameters;return e===(r?le.LABEL_MATERIAL:le.HUD_MATERIAL)||n&&e===le.OCCLUSION_PIXELS}return!1}createGLMaterial(e){return new cTe(e)}calculateRelativeScreenBounds(e,t,r=Nt()){return hTe(this.parameters,e,t,r),r[2]=r[0]+e[0],r[3]=r[1]+e[1],r}},cTe=class extends lH{constructor(e){super({...e,...e.material.parameters})}selectProgram(e){return this.ensureTechnique(IY,e)}beginSlot(e){return this.updateTexture(this._material.parameters.textureId),this._material.setParameters(this.textureBindParameters),this.selectProgram(e)}};function hTe(i,e,t,r=dTe){return wn(r,i.anchorPosition),r[0]*=-e[0],r[1]*=-e[1],r[0]+=i.screenOffset[0]*t,r[1]+=i.screenOffset[1]*t,r}function uTe(i){const e=i[0],t=i[1],r=i[2],n=i[3],s=i[4],a=i[5],o=i[6],l=i[7],c=i[8],u=1/Math.sqrt(e*e+t*t+r*r),d=1/Math.sqrt(n*n+s*s+a*a),m=1/Math.sqrt(o*o+l*l+c*c);return i[0]=e*u,i[1]=t*u,i[2]=r*u,i[3]=n*d,i[4]=s*d,i[5]=a*d,i[6]=o*m,i[7]=l*m,i[8]=c*m,i}function GU(i,e,t,r,n,s,a,o){let l=e-n-(o[0]>0?r[0]*o[0]:0),c=l+r[0]+2*n,u=t-n-(o[1]>0?r[1]*o[1]:0),d=u+r[1]+2*n;const m=a.distanceFieldBoundingBox;return a.textureIsSignedDistanceField&&y(m)&&(l+=r[0]*m[0],u+=r[1]*m[1],c-=r[0]*(1-m[2]),d-=r[1]*(1-m[3]),l-=s,c+=s,u-=s,d+=s),i[0]>l&&i[0]<c&&i[1]>u&&i[1]<d}const tM={factor:{scale:0,factor:0,minPixelSize:0,paddingPixels:0},factorAlignment:{scale:0,factor:0,minPixelSize:0,paddingPixels:0}},dTe=Te(),ms=P(),m1=P(),Fs=yi(),$Y=P(),HU=P(),iM=Or(),pTe=Or(),mTe=xe(),Ro=P(),rM={normal:$Y,cosAngle:0},jU=xe(),fTe=1,gTe=2,rp=[0,0],_Te=Ze(0,0,1);let yTe=class extends hse{constructor(){super(...arguments),this.renderOccluded=cr.Occlude,this.color=Bi(1,1,1,1),this.texCoordScale=[1,1],this.polygonOffset=!1,this.anchorPosition=Qt(.5,.5),this.screenOffset=[0,0],this.shaderPolygonOffset=1e-5,this.textureIsSignedDistanceField=!1,this.outlineColor=Bi(1,1,1,1),this.outlineSize=0,this.vvSizeEnabled=!1,this.vvSizeMinSize=[1,1,1],this.vvSizeMaxSize=[100,100,100],this.vvSizeOffset=[0,0,0],this.vvSizeFactor=[1,1,1],this.vvColorEnabled=!1,this.vvColorValues=[0,0,0,0,0,0,0,0],this.vvColorColors=[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],this.hasSlicePlane=!1,this.pixelSnappingEnabled=!0,this.occlusionTest=!0,this.binaryHighlightOcclusion=!0,this.debugDrawLabelBorder=!1,this.centerOffsetUnits="world",this.drawInSecondSlot=!1,this.depthEnabled=!0,this.isDraped=!1}};const DY=sn().vec3f(S.POSITION).vec3f(S.NORMAL).vec2f(S.UV0).vec4u8(S.COLOR).vec2f(S.SIZE).vec4f(S.AUXPOS1).vec4f(S.AUXPOS2),vTe=DY.clone().vec4u8(S.OBJECTANDLAYERIDCOLOR);let bTe=class{constructor(e){this._material=e,this.vertexBufferLayout=Ot("enable-feature:objectAndLayerId-rendering")?vTe:DY}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){return 6*e.indices.get(S.POSITION).length}write(e,t,r,n,s){HD(r.indices.get(S.POSITION),r.vertexAttributes.get(S.POSITION).data,e,n.position,s,6),cH(r.indices.get(S.NORMAL),r.vertexAttributes.get(S.NORMAL).data,t,n.normal,s,6);{const a=r.vertexAttributes.get(S.UV0).data;let o,l,c,u;if(a==null||a.length<4){const _=this._material.parameters;o=0,l=0,c=_.texCoordScale[0],u=_.texCoordScale[1]}else o=a[0],l=a[1],c=a[2],u=a[3];c=Math.min(1.99999,c+1),u=Math.min(1.99999,u+1);const d=r.indices.get(S.POSITION).length,m=n.uv0;let f=s;for(let _=0;_<d;++_)m.set(f,0,o),m.set(f,1,l),f+=1,m.set(f,0,c),m.set(f,1,l),f+=1,m.set(f,0,c),m.set(f,1,u),f+=1,m.set(f,0,c),m.set(f,1,u),f+=1,m.set(f,0,o),m.set(f,1,u),f+=1,m.set(f,0,o),m.set(f,1,l),f+=1}hH(r.indices.get(S.COLOR),r.vertexAttributes.get(S.COLOR).data,4,n.color,s,6);{const a=r.indices.get(S.SIZE),o=r.vertexAttributes.get(S.SIZE).data,l=a.length,c=n.size;let u=s;for(let d=0;d<l;++d){const m=o[2*a[d]],f=o[2*a[d]+1];for(let _=0;_<6;++_)c.set(u,0,m),c.set(u,1,f),u+=1}}if(r.indices.get(S.AUXPOS1)&&r.vertexAttributes.get(S.AUXPOS1)&&Aw(r.indices.get(S.AUXPOS1),r.vertexAttributes.get(S.AUXPOS1).data,n.auxpos1,s,6),r.indices.get(S.AUXPOS2)&&r.vertexAttributes.get(S.AUXPOS2)&&Aw(r.indices.get(S.AUXPOS2),r.vertexAttributes.get(S.AUXPOS2).data,n.auxpos2,s,6),y(r.objectAndLayerIdColor)&&r.objectAndLayerIdColor.length===4&&r.indices.get(S.POSITION)){const a=r.indices.get(S.POSITION).length,o=n.getField(S.OBJECTANDLAYERIDCOLOR,$m);use(r.objectAndLayerIdColor,o,a,s,6)}}};const th=P(),k_=yi(),f1=yi(),nM=P(),wTe=xe(),xTe=ou(),sM=oo(),TTe=P(),CTe=Nt();class STe{constructor(){this.aabr=Nt(),this.distance=0,this.culled=!1,this.visible=!1}}class ETe{constructor(e,t,r={}){this.graphics3DGraphic=e,this.slicePlaneEnabled=t,this.info=r}}class RTe{constructor(){this.active=new Map,this.visible=new Map}clear(){this.active.clear(),this.visible.clear()}}class PTe{}class ATe{constructor(){this.sortArray=new Yt({allocator:e=>e||new PTe})}}var eo;(function(i){i[i.Idle=0]="Idle",i[i.Process=1]="Process",i[i.Sort=2]="Sort",i[i.Deconflict=3]="Deconflict",i[i.NumStates=4]="NumStates"})(eo||(eo={}));class FY{constructor(){this.camera=new vi,this.slicePlane=zd(),this.slicePlaneEnabled=!1}copyFrom(e){this.camera.copyFrom(e.camera),c_(e.slicePlane,this.slicePlane),this.slicePlaneEnabled=e.slicePlaneEnabled}}let _0=class extends pe{constructor(i){super(i),this._dirty=!1,this._runningViewState=new FY,this._state=eo.Idle,this._graphics=new RTe,this._iterators=new ATe,this._accBinsNumX=15,this._accBinsNumY=20,this._accBinsSizeX=0,this._accBinsSizeY=0,this._accBins=null,this.accNumTests=0}get dirty(){return this._dirty}get state(){return this._state}destroy(){this._graphics.clear(),this._iterators=null}setDirty(){!this._dirty&&this._graphics.active.size>0&&(this._dirty=!0,this.notifyChange("updating"))}get updating(){return this._state!==eo.Idle||this._dirty}get updatingProgress(){if(!this.updating)return 1;const i=this._state/eo.NumStates;return this._dirty?.5*i:i}get running(){return this.view.ready&&this.view.state!=null&&this.updating}runTask(i){switch(this._state){case eo.Idle:this._startUpdate(),i.madeProgress();case eo.Process:if(this._state=eo.Process,!this._processActiveGraphics(i))return;case eo.Sort:if(this._state=eo.Sort,!this._sortVisibleGraphics(i))return;case eo.Deconflict:if(this._state=eo.Deconflict,!this._deconflictVisibleGraphics(i))return;default:eTe(this,this._graphics.visible),this._state=eo.Idle,this.notifyChange("updating")}}modifyGraphics(i,e){e?i.forEach(t=>this.addToActiveGraphics(t)):i.forEach(t=>this.removeFromActiveGraphics(t)),this.setDirty()}layerSupportsDeconfliction(i){if(C(i)||i.type!=="object3d")return!1;const e=i.stageObject;return(e?e.geometryRecords.length:0)!==1?!1:e.geometryRecords[0].material instanceof uv}_startUpdate(){tTe(this.view),this._dirty=!1,this._runningViewState.copyFrom(this.viewState);const{fullWidth:i,fullHeight:e}=this._runningViewState.camera;this._initBins(i,e),this._resetIterators()}addToActiveGraphics(i){i.info[this.visibilityGroup]=new STe,this._graphics.active.set(i.graphics3DGraphic.graphic.uid,i),this.setDirty()}removeFromActiveGraphics(i){this._removeFromVisibleGraphics(i),OTe(i,this.visibilityGroup),delete i.info[this.visibilityGroup],this._graphics.active.delete(i.graphics3DGraphic.graphic.uid),this.setDirty()}_addToVisibleGraphics(i){this._graphics.visible.set(i.graphics3DGraphic.graphic.uid,i)}_removeFromVisibleGraphics(i){this._graphics.visible.delete(i.graphics3DGraphic.graphic.uid)}_processActiveGraphics(i){const e=this._ensureActiveGraphicsIterator(),t=kn(wTe,this._runningViewState.camera.projectionMatrix),r=this.view.viewingMode==="global"&&this.view.map.ground.opacity===1&&this._runningViewState.camera.relativeElevation>0?xTe:null;let n=0;for(y(r)&&(Me(r,Gl,this._runningViewState.camera.viewMatrix),r[3]=Kt(this.view.spatialReference).radius,n=qre(r,Gl));!i.done;){i.madeProgress();const s=e.next();if(s.done===!0)return this._resetActiveGraphicsIterator(),!0;const a=s.value,o=a&&a.info[this.visibilityGroup];o&&(this._collectGraphics3DGraphics(a,t,r,n),o.culled?this._removeFromVisibleGraphics(a):this._addToVisibleGraphics(a))}return!1}_sortVisibleGraphics(i){const e=this._ensureSortGraphicsIterator();for(;!i.done;){const t=e.next();if(i.madeProgress(),t.done===!0)return this._resetSortGraphicsIterator(),!0}return!1}_deconflictVisibleGraphics(i){const e=this._ensureVisibleGraphicsIterator(),t=this.visibilityGroup===$n.LABEL;for(;!i.done;){i.madeProgress();const r=e.next();if(r.done===!0)return this._resetVisibleGraphicsIterator(),!0;const n=r.value,s=n.info[this.visibilityGroup];if(!s||s.culled)continue;const a=n.graphics3DGraphic,o=(!t||a.isVisible())&&!this._isConflicted(n);o&&this._addToBins(n),s.visible=o,this._setGraphicVisibility(n,o),rTe(s,o)}return!1}_resetIterators(){this._iterators.active=null,this._iterators.visible=null,this._iterators.sort=null}_ensureActiveGraphicsIterator(){return this._iterators.active||(this._iterators.active=qU(this._graphics.active)),this._iterators.active}_resetActiveGraphicsIterator(){this._iterators.active=null}_ensureVisibleGraphicsIterator(){return this._iterators.visible||(this._iterators.visible=qU(this._graphics.visible)),this._iterators.visible}_resetVisibleGraphicsIterator(){this._iterators.visible=null}_ensureSortGraphicsIterator(){return this._iterators.sort||(this._iterators.sort=MTe(this._graphics.visible,this._iterators.sortArray,this.visibilityGroup)),this._iterators.sort}_resetSortGraphicsIterator(){this._iterators.sort=null}_collectGraphics3DGraphics(i,e,t,r){const n=i.graphics3DGraphic;if(n.destroyed)return;const s=i.info[this.visibilityGroup];if(!n.isVisible($n.GRAPHIC,Qo.DECONFLICTION))return void(s.culled=!0);const a=this.getGraphicsLayers(n);Uc(s.aabr);let o=null;for(const l of a){if(!this.layerSupportsDeconfliction(l))continue;const c=l.stageObject.geometryRecords[0].material;if(C(o)){if(o=this._getProjectionInfo(l,e,$Te),o.isOutsideScreen||this._isCulledBySlice(i,th)||y(t)&&this._isCulledByHorizon(o,t,r))return void(s.culled=!0);!Wt.TESTS_DISABLE_OPTIMIZATIONS&&s.visible&&(o.distance*=.7)}this._expandBoundingRect(s,l,c,o)}C(o)?s.culled=!0:(s.distance=o.distance,s.culled=!1)}_getProjectionInfo(i,e,t){const r=this._runningViewState.camera,n=i.stageObject,s=n.geometryRecords[0],a=s.material,o=PD(n.boundingVolumeWorldSpace.bounds);Me(th,o,r.viewMatrix);const l=s.geometry.vertexAttributes,c=l.get(S.NORMAL).data,u=l.get(S.AUXPOS1).data;return a.applyShaderOffsetsView(th,c,n.transformation,u,r,t.scaleInfo,th),Qs(k_,th[0],th[1],th[2],1),sd(f1,k_,r.projectionMatrix),Q(t.positionNDC,f1,1/f1[3]),a.applyShaderOffsetsNDC(t.positionNDC,u,r,t.positionNDC,nM),t.distanceWithoutPolygonOffset=r.depthNDCToWorld(nM[2]),t.distance=nM[2]===t.positionNDC[2]?t.distanceWithoutPolygonOffset:r.depthNDCToWorld(t.positionNDC[2]),Qs(f1,t.positionNDC[0],t.positionNDC[1],t.positionNDC[2],1),sd(k_,f1,e),$D(k_,k_,1/k_[3]),Y(t.positionView,th[0],th[1],th[2]),t}_isCulledByHorizon(i,e,t){return X(sM.direction,i.positionView),Y(sM.origin,0,0,0),!!FR(e,sM,TTe)&&i.distanceWithoutPolygonOffset>t}_isCulledBySlice(i,e){return i.slicePlaneEnabled&&this._runningViewState.slicePlaneEnabled&&GN(this._runningViewState.slicePlane,e)}_expandBoundingRect(i,e,t,{positionNDC:r,scaleInfo:n}){const s=this._runningViewState.camera,a=e.getScreenSize(ITe);QG(a,n.factor,a),a[0]*=s.pixelRatio,a[1]*=s.pixelRatio;const o=GE(t.calculateRelativeScreenBounds(a,n.factorAlignment.scale,CTe),bt(0,s.fullWidth,.5+.5*r[0]),bt(0,s.fullHeight,.5+.5*r[1])),l=this.iconMarginFactor;if(l!==0){const c=l*Math.min(Nh(o),Mm(o));o[0]-=c,o[1]-=c,o[2]+=c,o[3]+=c}um(i.aabr,o,i.aabr)}_isConflicted(i){const e=i.graphics3DGraphic.graphic.uid,t=i.info[this.visibilityGroup];for(let r=Math.floor(t.aabr[0]/this._accBinsSizeX);r<=Math.floor(t.aabr[2]/this._accBinsSizeX);r++)if(!(r<0||r>=this._accBinsNumX))for(let n=Math.floor(t.aabr[1]/this._accBinsSizeY);n<=Math.floor(t.aabr[3]/this._accBinsSizeY);n++){if(n<0||n>=this._accBinsNumY)continue;const s=this._accBins[r][n];for(let a=0;a<s.length;a++){const o=s.data[a],l=o.info[this.visibilityGroup];if(l&&l.visible&&o.graphics3DGraphic.graphic.uid!==e&&(this.accNumTests++,DR(l.aabr,t.aabr)))return!0}}return!1}_initBins(i,e){if(this._accBins==null){this._accBins=[];for(let t=0;t<this._accBinsNumX;t++){this._accBins.push([]);const r=this._accBins[this._accBins.length-1];for(let n=0;n<this._accBinsNumY;n++)r.push(new Yt)}}else for(let t=0;t<this._accBinsNumX;t++)for(let r=0;r<this._accBinsNumY;r++)this._accBins[t][r].clear();this._accBinsSizeX=i/this._accBinsNumX,this._accBinsSizeY=e/this._accBinsNumY,this.accNumTests=0}_addToBins(i){const e=i.info[this.visibilityGroup],t=Math.floor(e.aabr[0]/this._accBinsSizeX),r=Math.floor(e.aabr[2]/this._accBinsSizeX),n=Math.floor(e.aabr[1]/this._accBinsSizeY),s=Math.floor(e.aabr[3]/this._accBinsSizeY);for(let a=t;a<=r;a++)if(!(a<0||a>=this._accBinsNumX))for(let o=n;o<=s;o++)o<0||o>=this._accBinsNumY||this._accBins[a][o].push(i)}_setGraphicVisibility(i,e){const t=i.graphics3DGraphic;t.destroyed||(t.setVisibilityFlag(Qo.DECONFLICTION,e,this.visibilityGroup),this.visibilityGroup===$n.LABEL&&this.view.labeler.setLabelGraphicVisibility(t,e))}};function OTe(i,e){const t=i.graphics3DGraphic;t.destroyed||t.clearVisibilityFlag(Qo.DECONFLICTION,e)}function*qU(i){if(Map.prototype.entries){const e=i.entries();for(let t=e.next();!t.done;t=e.next())yield t.value[1]}else yield*i.values()}function*MTe(i,e,t){e.clear(),i.forEach((n,s)=>{const a=e.pushNew();a.id=s,a.prio=n.info?-n.info[t].distance:Number.MAX_VALUE}),yield;const r=e.iterableSort((n,s)=>s.prio-n.prio);for(let n=r.next();!n.done;n=r.next())yield;e.forAll(n=>{const s=i.get(n.id);s&&(i.delete(n.id),i.set(n.id,s))}),e.clear()}h([p({constructOnly:!0})],_0.prototype,"view",void 0),h([p({type:Boolean,readOnly:!0})],_0.prototype,"updating",null),_0=h([F("esri.views.3d.layers.graphics.Deconflictor")],_0);const ITe=Te();class LTe{constructor(){this.positionView=P(),this.positionNDC=P(),this.distance=0,this.distanceWithoutPolygonOffset=0,this.scaleInfo={factor:{scale:0,factor:0,minPixelSize:0,paddingPixels:0},factorAlignment:{scale:0,factor:0,minPixelSize:0,paddingPixels:0}}}get isOutsideScreen(){const e=this.positionNDC;return e[0]<-1||e[1]<-1||e[2]<-1||e[0]>=1||e[1]>=1}}const $Te=new LTe,DTe=2e3;let mE=class extends _0{constructor(e){super(e),this.visibilityGroup=$n.LABEL,this.iconMarginFactor=0,this._lastDeconfliction=0}get viewState(){return this.parent.viewState}runTask(e){if(this.parent.running)return;const t=performance.now();(e.state===Fh.IDLE||t-this._lastDeconfliction>DTe)&&(super.runTask(e),this.state===eo.Idle&&(this._lastDeconfliction=t))}enabledChanged(e,t){this.modifyGraphics(t,e.labelsEnabled)}getGraphicsLayers(e){return e.labelGraphics}};h([p({constructOnly:!0})],mE.prototype,"parent",void 0),mE=h([F("esri.views.3d.layers.graphics.LabelDeconflictor")],mE);let a$=class extends _0{constructor(){super(...arguments),this._handles=new Vt,this._contexts=new Map,this._viewState=new FY,this.visibilityGroup=$n.GRAPHIC,this._iconMarginFactor=-.1}get labels(){return this._labels}get viewState(){return this._viewState}initialize(){this._handles.add([B(()=>{var e,t;return(t=(e=this.view)==null?void 0:e.state)==null?void 0:t.camera},()=>{this._updateViewState(),this.setDirty()}),B(()=>{var e,t,r;return(r=(t=(e=this.view)==null?void 0:e.map)==null?void 0:t.ground)==null?void 0:r.opacity},(e,t)=>{e!==1&&t!==1||this.setDirty()}),B(()=>{var e;return(e=this.view)==null?void 0:e.slicePlane},()=>{this._updateSlicePlane(),this._slicePlaneChanged()},et)]),this._frameTask=this.view.resourceController.scheduler.registerTask(dr.GRAPHICS_DECONFLICTOR,this),this._labels=new mE({view:this.view,parent:this})}destroy(){this._labels.destroy(),this._labels=null,this._handles.destroy(),this._handles=null,this._frameTask&&(this._frameTask.remove(),this._frameTask=null)}get iconMarginFactor(){return this._iconMarginFactor}set iconMarginFactor(e){this._iconMarginFactor=e,this.setDirty()}setDirty(){this._contexts.size>0&&(super.setDirty(),this._labels.setDirty())}runTask(e){super.runTask(e),this.running||this._labels.setDirty()}setInitialIconVisibilityFlag(e,t){const r=!(this._graphicSupportsDeconfliction(t)&&aM(e));t.setVisibilityFlag(Qo.DECONFLICTION,r,$n.GRAPHIC)}_updateViewState(){this.view&&this.view.state&&(this._viewState.camera.copyFrom(this.view.state.camera),this._updateSlicePlane())}_updateSlicePlane(){const e=this.view?this.view.slicePlane:null;y(e)&&kQ(e,this._viewState.camera.viewMatrix,this._viewState.slicePlane),this._viewState.slicePlaneEnabled=y(e)}_slicePlaneChanged(){Er(this._contexts,(e,t)=>t.symbolCreationContext.slicePlaneEnabled)&&this.setDirty()}addGraphicsOwner(e){let t=this._contexts.get(e);return t==null&&(t=new Map,this._contexts.set(e,t),this.setDirty()),{addGraphic:r=>this._addGraphic(e,t,r),removeGraphic:r=>this._removeGraphic(t,r),labelingInfoChange:()=>this._labels.enabledChanged(e,t),featureReductionChange:()=>this.enabledChanged(e,t),slicePlaneEnabledChange:()=>this._slicePlaneEnabledChanged(e,t),clear:()=>t.forEach(r=>this._removeGraphic(t,r.graphics3DGraphic))}}removeGraphicsOwner(e){const t=this._contexts.get(e);t&&(t.forEach(r=>this._removeGraphic(t,r.graphics3DGraphic)),this._contexts.delete(e),this.setDirty())}_addGraphic(e,t,r){const n=r.graphic.uid,s=new ETe(r,e.symbolCreationContext.slicePlaneEnabled);t.set(n,s),aM(e)&&this.addToActiveGraphics(s),e.labelsEnabled&&this._labels.addToActiveGraphics(s)}_removeGraphic(e,t){const r=t.graphic.uid,n=e.get(r);n&&(this.removeFromActiveGraphics(n),this._labels.removeFromActiveGraphics(n),e.delete(r),this.setDirty())}enabledChanged(e,t){const r=aM(e);r||FTe(e),this.modifyGraphics(t,r)}_slicePlaneEnabledChanged(e,t){const r=e.symbolCreationContext.slicePlaneEnabled;t.forEach(n=>n.slicePlaneEnabled=r),this.setDirty()}getGraphicsLayers(e){return e.graphics}_graphicSupportsDeconfliction(e){if(e.isDraped)return!1;const t=e.graphics;if(!t||!t.length)return!1;for(const r of t)if(this.layerSupportsDeconfliction(r))return!0;return!1}};function aM(i){const e=i.layer;return!(!e||!e.featureReduction||e.featureReduction.type!=="selection")}function FTe(i){const e=i.graphics3DGraphics;e&&e.forEach(t=>t.clearVisibilityFlag(Qo.DECONFLICTION))}a$=h([F("esri.views.3d.layers.graphics.GraphicsDeconflictor")],a$);function NY(i){return"declaredClass"in i}function WU(i){return"declaredClass"in i}function NTe(i){return"declaredClass"in i}function kTe(i,e){if(!i)return null;if(NTe(i))return i;const t=new jc({layer:e,sourceLayer:e});return t.visible=i.visible,t.symbol=Pr(i.symbol),t.attributes=Pr(i.attributes),t.geometry=kY(i.geometry),t}function kY(i){return C(i)?null:NY(i)?i:NE(VTe(i))}function VTe(i){const{wkid:e,wkt:t,latestWkid:r}=i.spatialReference,n={wkid:e,wkt:t,latestWkid:r};switch(i.type){case"point":{const{x:s,y:a,z:o,m:l}=i;return{x:s,y:a,z:o,m:l,spatialReference:n}}case"polygon":{const{rings:s,hasZ:a,hasM:o}=i;return{rings:XU(s),hasZ:a,hasM:o,spatialReference:n}}case"polyline":{const{paths:s,hasZ:a,hasM:o}=i;return{paths:XU(s),hasZ:a,hasM:o,spatialReference:n}}case"extent":{const{xmin:s,xmax:a,ymin:o,ymax:l,zmin:c,zmax:u,mmin:d,mmax:m,hasZ:f,hasM:_}=i;return{xmin:s,xmax:a,ymin:o,ymax:l,zmin:c,zmax:u,mmin:d,mmax:m,hasZ:f,hasM:_,spatialReference:n}}case"multipoint":{const{points:s,hasZ:a,hasM:o}=i;return{points:UY(s)?VY(s):s,hasZ:a,hasM:o,spatialReference:n}}default:return}}function XU(i){return UTe(i)?i.map(e=>VY(e)):i}function VY(i){return i.map(e=>Cte(e))}function UTe(i){for(const e of i)if(e.length!==0)return UY(e);return!1}function UY(i){return i.length&&(D7(i[0])||F7(i[0]))}function zTe(i,e){if(!i)return null;let t;if(WU(i)){if(e==null)return i.clone();if(WU(e))return e.copy(i)}return e!=null?(t=e,t.x=i.x,t.y=i.y,t.spatialReference=i.spatialReference,i.hasZ?(t.z=i.z,t.hasZ=i.hasZ):(t.z=null,t.hasZ=!1),i.hasM?(t.m=i.m,t.hasM=!0):(t.m=null,t.hasM=!1)):(t=kd(i.x,i.y,i.z,i.spatialReference),i.hasM&&(t.m=i.m,t.hasM=!0)),t}function n8e(i){const{wkid:e,wkt:t,latestWkid:r}=i,n={wkid:e,wkt:t,latestWkid:r};return Zt.fromJSON(n)}function w4(i,e){if(i.type==="point")return np(i,e,!1);if(NY(i))switch(i.type){case"extent":return np(i.center,e,!1);case"polygon":return np(i.centroid,e,!1);case"polyline":return np(QU(i),e,!0);case"mesh":return np(i.origin,e,!1)}else switch(i.type){case"extent":return np(BTe(i),e,!0);case"polygon":return np(GTe(i),e,!0);case"polyline":return np(QU(i),e,!0)}}function QU(i){const e=i.paths[0];if(!e||e.length===0)return null;const t=aG(e,oG(e)/2);return kd(t[0],t[1],t[2],i.spatialReference)}function BTe(i){const e=isFinite(i.zmin);return kd(.5*(i.xmax+i.xmin),.5*(i.ymax+i.ymin),e?.5*(i.zmax+i.zmin):void 0,i.spatialReference)}function GTe(i){const e=i.rings[0];if(!e||e.length===0)return null;const t=jie(i.rings,i.hasZ);return kd(t[0],t[1],t[2],i.spatialReference)}function np(i,e,t){const r=t?i:zTe(i);return e&&i?Zte(i,r,e)?r:null:r}function s8e(i,e,t,r=0){if(i){e||(e=Nt());const n=i;let s=.5*n.width*(t-1),a=.5*n.height*(t-1);return n.width<1e-7*n.height?s+=a/20:n.height<1e-7*n.width&&(a+=s/20),Qs(e,n.xmin-s-r,n.ymin-a-r,n.xmax+s+r,n.ymax+a+r),e}return null}function zY(i,e){for(let t=0;t<i.geometries.length;++t){const r=i.geometries[t].getMutableAttribute(S.AUXPOS1);r&&r.data[3]!==e&&(r.data[3]=e,i.geometryVertexAttrsUpdated(i.geometryRecords[t]))}}function rw(i,e){const t=LD(Pc);return y(i)&&(t[0]=i[0],t[1]=i[1],t[2]=i[2]),y(e)?t[3]=e:y(i)&&i.length>3&&(t[3]=i[3]),t}function a8e(i,e,t,r,n,s=[0,0,0,0]){for(let a=0;a<3;++a)y(i)&&i[a]!=null?s[a]=i[a]:y(t)&&t[a]!=null?s[a]=t[a]:s[a]=n[a];return y(e)?s[3]=e:y(r)?s[3]=r:s[3]=n[3],s}function ZU(i=em,e,t,r=1){const n=new Array(3);if(C(e)||C(t))n[0]=1,n[1]=1,n[2]=1;else{let s,a=0;for(let o=2;o>=0;o--){const l=i[o];let c;const u=l!=null,d=o===0&&!s&&!u,m=t[o];l==="symbol-value"||d?c=m!==0?e[o]/m:1:u&&l!=="proportional"&&isFinite(l)&&(c=m!==0?l/m:1),c!=null&&(n[o]=c,s=c,a=Math.max(a,Math.abs(c)))}for(let o=2;o>=0;o--)n[o]==null?n[o]=s:n[o]===0&&(n[o]=.001*a)}for(let s=2;s>=0;s--)n[s]/=r;return Tl(n)}function HTe(i){return i.isPrimitive!=null}function VP(i){return HTe(i)&&(i=[i.width,i.depth,i.height]),cR(i)?null:"Symbol sizes may not be negative values"}function cR(i){if(Array.isArray(i)){for(const e of i)if(!cR(e))return!1;return!0}return i==null||i>=0}function jTe(i,e,t,r=xe()){const n=i||0,s=e||0,a=t||0;return n!==0&&Tw(r,r,-n/180*Math.PI),s!==0&&Cw(r,r,s/180*Math.PI),a!==0&&MD(r,r,a/180*Math.PI),r}function x4(i,e,t){if(t.minDemResolution!=null)return t.minDemResolution;const r=Hm(e),n=vH(i)*r,s=bH(i)*r,a=tF(i)*(e.isGeographic?1:r);return n===0&&s===0&&a===0?t.minDemResolutionForPoints:.01*Math.max(n,s,a)}function BY(i,e,t,r,n,s,a,o,l,c,u){const d=JTe[u.mode];let m,f,_=0;if(Ma(i,e,t,r,l.spatialReference,n,o))return d.requiresAlignment(u)?(_=d.applyElevationAlignmentBuffer(r,n,s,a,o,l,c,u),m=s,f=a):(m=r,f=n),Ma(m,l.spatialReference,f,s,c.spatialReference,a,o)?_:void 0}function $d(i,e,t,r,n){const s=(iR(i)?i.z:hY(i)?i.array[i.offset+2]:i[2])||0;switch(t.mode){case"on-the-ground":{const a=Ke(Gh(e,i,"ground"),0);return n.verticalDistanceToGround=0,n.sampledElevation=a,void(n.z=a)}case"relative-to-ground":{const a=Ke(Gh(e,i,"ground"),0),o=t.geometryZWithOffset(s,r);return n.verticalDistanceToGround=o,n.sampledElevation=a,void(n.z=o+a)}case"relative-to-scene":{const a=Ke(Gh(e,i,"scene"),0),o=t.geometryZWithOffset(s,r);return n.verticalDistanceToGround=o,n.sampledElevation=a,void(n.z=o+a)}case"absolute-height":{const a=t.geometryZWithOffset(s,r),o=Ke(Gh(e,i,"ground"),0);return n.verticalDistanceToGround=a-o,n.sampledElevation=o,void(n.z=a)}default:return Ra(t.mode),void(n.z=0)}}function qTe(i,e,t,r){return $d(i,e,t,r,y0),y0.z}function sT(i,e,t){return e==null||t==null?i.definedChanged:e==="on-the-ground"&&t==="on-the-ground"?i.staysOnTheGround:e===t||e!=="on-the-ground"&&t!=="on-the-ground"?Zi.UPDATE:i.onTheGroundChanged}function Ql(i){return i==="relative-to-ground"||i==="relative-to-scene"}function Bm(i){return i!=="absolute-height"}function WTe(i,e,t,r,n){$d(e,t,n,r,y0),zY(i,y0.verticalDistanceToGround);const s=y0.sampledElevation,a=pn(eCe,i.transformation);return SC[0]=e.x,SC[1]=e.y,SC[2]=y0.z,xd(e.spatialReference,SC,a,r.spatialReference)?i.transformation=a:console.warn("Could not locate symbol object properly, it might be misplaced"),s}function XTe(i,e,t,r,n,s){let a=0;const o=s.spatialReference;e*=3,r*=3;for(let l=0;l<n;++l){const c=i[e+0],u=i[e+1],d=i[e+2],m=Ke(s.getElevation(c,u,d,o,"ground"),0);a+=m,t[r+0]=c,t[r+1]=u,t[r+2]=m,e+=3,r+=3}return a/n}function QTe(i,e,t,r,n,s,a,o){let l=0;const c=o.calculateOffsetRenderUnits(a),u=o.featureExpressionInfoContext,d=s.spatialReference;e*=3,r*=3;for(let m=0;m<n;++m){const f=i[e+0],_=i[e+1],g=i[e+2],w=Ke(s.getElevation(f,_,g,d,"ground"),0);l+=w,t[r+0]=f,t[r+1]=_,t[r+2]=u==null?g+w+c:w+c,e+=3,r+=3}return l/n}function ZTe(i,e,t,r,n,s,a,o){let l=0;const c=o.calculateOffsetRenderUnits(a),u=o.featureExpressionInfoContext,d=s.spatialReference;e*=3,r*=3;for(let m=0;m<n;++m){const f=i[e+0],_=i[e+1],g=i[e+2],w=Ke(s.getElevation(f,_,g,d,"scene"),0);l+=w,t[r+0]=f,t[r+1]=_,t[r+2]=u==null?g+w+c:w+c,e+=3,r+=3}return l/n}function YTe(i){const e=i.meterUnitOffset,t=i.featureExpressionInfoContext;return e!==0||t!=null}function KTe(i,e,t,r,n,s,a,o){const l=o.calculateOffsetRenderUnits(a),c=o.featureExpressionInfoContext;e*=3,r*=3;for(let u=0;u<n;++u){const d=i[e+0],m=i[e+1],f=i[e+2];t[r+0]=d,t[r+1]=m,t[r+2]=c==null?f+l:l,e+=3,r+=3}return 0}let aT=class{constructor(){this.verticalDistanceToGround=0,this.sampledElevation=0,this.z=0}};var Zi;(function(i){i[i.NONE=0]="NONE",i[i.UPDATE=1]="UPDATE",i[i.RECREATE=2]="RECREATE"})(Zi||(Zi={}));const JTe={"absolute-height":{applyElevationAlignmentBuffer:KTe,requiresAlignment:YTe},"on-the-ground":{applyElevationAlignmentBuffer:XTe,requiresAlignment:()=>!0},"relative-to-ground":{applyElevationAlignmentBuffer:QTe,requiresAlignment:()=>!0},"relative-to-scene":{applyElevationAlignmentBuffer:ZTe,requiresAlignment:()=>!0}},eCe=xe(),y0=new aT,SC=P();function GY(i,e,t,r){const n=i.stageObject,s=n.geometryRecords;let a=0;for(const o of s){const{update:l,averageGeometrySampledElevation:c}=jY(o,e,t,r);a+=c,l&&n.geometryVertexAttrsUpdated(o)}return a/s.length}function _x(i,e,t,r){const n=i.stageObject,s=e.centerPointInElevationSR;let a=0;n.metadata.usesVerticalDistanceToGround?($d(s,t,e,r,Ta),zY(n,Ta.verticalDistanceToGround),a=Ta.sampledElevation):($d(s,t,e,r,Ta),e.mode!=="absolute-height"&&(a=Ta.sampledElevation));const o=pn(tCe,n.transformation),l=Y(HY,o[12],o[13],o[14]);Wt.TESTS_DISABLE_OPTIMIZATIONS?(xa[0]=s.x,xa[1]=s.y,xa[2]=Ta.z,xd(s.spatialReference,xa,o,r.spatialReference)&&(n.transformation=o)):r.setAltitudeOfTransformation(Ta.z,o);const c=T4/r.unitInMeters;return(Math.abs(o[12]-l[0])>=c||Math.abs(o[13]-l[1])>=c||Math.abs(o[14]-l[2])>=c)&&(n.transformation=o),a}const tCe=xe();function iCe(i,e,t,r){const n=i.graphics3DSymbolLayer.lodRenderer;if(C(n))return 0;const s=e.centerPointInElevationSR;$d(s,t,e,r,Ta);const a=e.mode!=="absolute-height"?Ta.sampledElevation:0,o=n.instanceData,l=i.instanceIndex,c=nCe;o.getGlobalTransform(l,c);const u=Y(HY,c[12],c[13],c[14]);Wt.TESTS_DISABLE_OPTIMIZATIONS?(xa[0]=s.x,xa[1]=s.y,xa[2]=Ta.z,xd(s.spatialReference,xa,c,r.spatialReference)&&o.setGlobalTransform(l,c)):r.setAltitudeOfTransformation(Ta.z,c);const d=T4/r.unitInMeters;return(Wt.TESTS_DISABLE_OPTIMIZATIONS||Math.abs(c[12]-u[0])>=d||Math.abs(c[13]-u[1])>=d||Math.abs(c[14]-u[2])>=d)&&o.setGlobalTransform(l,c),a}function rCe(i,e,t,r){const n=i.stageObject,s=n.geometryRecords;if(s.length===0)return 0;let a=0,o=null,l=0,c=!1;for(const u of s){const d=u.geometry.vertexAttributes.get(S.POSITION);if(d!==o){const{update:m,averageGeometrySampledElevation:f}=jY(u,e,t,r);l=f,o=d,c=m}c&&n.geometryVertexAttrsUpdated(u),a+=l}return a/s.length}const T4=.01,xa=P(),ul=P(),V_=P(),nCe=xe(),HY=P(),Ta=new aT;function jY(i,e,t,r){let n=!1;const s=t.spatialReference,a=i.geometry,o=i.getShaderTransformation(),l=e.requiresSampledElevationInfo;ul[0]=o[12],ul[1]=o[13],ul[2]=o[14],a.invalidateBoundingInfo();const c=a.getMutableAttribute(S.POSITION),u=c.data,d=a.vertexAttributes.get(S.MAPPOS).data,m=c.size,f=u.length/m,_=new cY(d,s);let g=0,w=0;for(let v=0;v<f;v++){if(V_[0]=u[g],V_[1]=u[g+1],V_[2]=u[g+2],$d(_,t,e,r,Ta),l&&(w+=Ta.sampledElevation),Wt.TESTS_DISABLE_OPTIMIZATIONS)u[g]=_.array[_.offset],u[g+1]=_.array[_.offset+1],u[g+2]=Ta.z,Ma(u,s,g,u,r.spatialReference,g,1),u[g]-=ul[0],u[g+1]-=ul[1],u[g+2]-=ul[2],n=!0;else{xa[0]=u[g]+ul[0],xa[1]=u[g+1]+ul[1],xa[2]=u[g+2]+ul[2],r.setAltitude(xa,Ta.z),u[g]=xa[0]-ul[0],u[g+1]=xa[1]-ul[1],u[g+2]=xa[2]-ul[2];const b=T4/r.unitInMeters;(Math.abs(V_[0]-u[g])>=b||Math.abs(V_[1]-u[g+1])>=b||Math.abs(V_[2]-u[g+2])>=b)&&(n=!0)}g+=m,_.offset+=3}return w/=f,{update:n,averageGeometrySampledElevation:w}}const sCe=ee.getLogger("esri.views.3d.layers.graphics.featureExpressionInfoUtils");function aCe(i){return{cachedResult:i.cachedResult,arcade:i.arcade?{func:i.arcade.func,context:i.arcade.modules.arcadeUtils.createExecContext(null,{sr:i.arcade.context.spatialReference}),modules:i.arcade.modules}:null}}function l8e(i){const e=i&&i.expression;if(typeof e=="string"){const t=XY(e);if(t!=null)return{cachedResult:t}}return null}async function c8e(i,e,t,r){const n=i&&i.expression;if(typeof n!="string")return null;const s=XY(n);if(s!=null)return{cachedResult:s};const a=await pD();Ti(t);const o=a.arcadeUtils,l=o.createSyntaxTree(n);return o.dependsOnView(l)?(r!=null&&r.error("Expressions containing '$view' are not supported on ElevationInfo"),{cachedResult:0}):{arcade:{func:o.createFunction(l),context:o.createExecContext(null,{sr:e}),modules:a}}}function qY(i,e,t){return i.arcadeUtils.createFeature(e.attributes,e.geometry,t)}function C4(i,e){if(i!=null&&!WY(i)){if(!e||!i.arcade)return void sCe.errorOncePerTick("Arcade support required but not provided");const t=e;t._geometry&&(t._geometry=kY(t._geometry)),i.arcade.modules.arcadeUtils.updateExecContext(i.arcade.context,e)}}function oCe(i){if(i!=null){if(WY(i))return i.cachedResult;const e=i.arcade;let t=i.arcade.modules.arcadeUtils.executeFunction(e.func,e.context);return typeof t!="number"&&(i.cachedResult=0,t=0),t}return 0}function h8e(i,e=!1){let t=i&&i.featureExpressionInfo;const r=t&&t.expression;return e||r==="0"||(t=null),t}const lCe={cachedResult:0};function WY(i){return i.cachedResult!=null}function XY(i){return i==="0"?0:null}let Qc=class QY{constructor(){this._meterUnitOffset=0,this._renderUnitOffset=0,this._unit="meters",this._metersPerElevationInfoUnit=1,this._featureExpressionInfoContext=null,this.centerPointInElevationSR=null,this.mode=null}get featureExpressionInfoContext(){return this._featureExpressionInfoContext}get meterUnitOffset(){return this._meterUnitOffset}get unit(){return this._unit}set unit(e){this._unit=e,this._metersPerElevationInfoUnit=oae(e)}get requiresSampledElevationInfo(){return this.mode!=="absolute-height"}reset(){this.mode=null,this._meterUnitOffset=0,this._renderUnitOffset=0,this._featureExpressionInfoContext=null,this.unit="meters"}set offsetMeters(e){this._meterUnitOffset=e,this._renderUnitOffset=0}set offsetElevationInfoUnits(e){this._meterUnitOffset=e*this._metersPerElevationInfoUnit,this._renderUnitOffset=0}addOffsetRenderUnits(e){this._renderUnitOffset+=e}geometryZWithOffset(e,t){const r=this.calculateOffsetRenderUnits(t);return this.featureExpressionInfoContext!=null?r:e+r}calculateOffsetRenderUnits(e){let t=this._meterUnitOffset;const r=this.featureExpressionInfoContext;return r!=null&&(t+=oCe(r)*this._metersPerElevationInfoUnit),t/e.unitInMeters+this._renderUnitOffset}setFromElevationInfo(e){this.mode=e.mode,this.unit=lae(e.unit)?e.unit:"meters",this.offsetElevationInfoUnits=Ke(e.offset,0)}updateFeatureExpressionInfoContext(e,t,r){if(C(e))return void(this._featureExpressionInfoContext=null);const n=e&&e.arcade;n&&y(t)&&y(r)?(this._featureExpressionInfoContext=aCe(e),C4(this._featureExpressionInfoContext,qY(n.modules,t,r))):this._featureExpressionInfoContext=e}static fromElevationInfo(e){const t=new QY;return y(e)&&t.setFromElevationInfo(e),t}},uu=class{constructor(e,t,r,n,s,a,o,l=null){this.graphics3DSymbolLayer=e,this.stageObject=t,this._uniqueGeometries=r,this._uniqueMaterials=n,this._sharedResource=s,this.elevationAligner=a,this.elevationContext=o,this._edgeState=l,this.type="object3d",this._stageLayer=null,this._stage=null,this._visible=!1,this._addedToStage=!1,this.alignedSampledElevation=0,this.needsElevationUpdates=!1,this.useObjectOriginAsAttachmentOrigin=!1,this.graphics3DSymbolLayer=e,this.stageObject=t}get isElevationSource(){return!(!this.stageObject.metadata||!this.stageObject.metadata.isElevationSource)}initialize(e,t){this._stageLayer=t,this._stage=e,e.addMany(this._uniqueMaterials),e.addMany(this._uniqueGeometries),e.add(this.stageObject)}destroy(){const e=this._stage;this._stageLayer&&(e.removeMany(this._uniqueMaterials),e.removeMany(this._uniqueGeometries)),e.remove(this.stageObject),this._addedToStage&&(this._stageLayer.remove(this.stageObject),this._addedToStage=!1);const t=this._stage.renderView.ensureEdgeView();t.hasObject(this.stageObject)&&t.removeObject(this.stageObject),this.stageObject.dispose(),y(this._sharedResource)&&this._sharedResource.release(),this._visible=!1,this._stageLayer=null,this._stage=null}layerOpacityChanged(e,t){if(C(this._edgeState))return;const r=YU(this._edgeState.baseMaterial);let n=!1;for(const s of this._edgeState.edgeMaterials)s.objectTransparency!==r&&(s.objectTransparency=r,n=!0);n&&this._resetEdgeObject(t),this._stage.renderView.ensureEdgeView().updateAllComponentOpacities(this.stageObject,[e])}slicePlaneEnabledChanged(e,t){C(this._edgeState)||(this._stage.renderView.ensureEdgeView().updateAllComponentMaterials(this.stageObject,this._edgeState.edgeMaterials,{hasSlicePlane:e},!t),this._edgeState.properties.hasSlicePlane=e)}setVisibility(e){if(this._stage!=null&&this._visible!==e&&(this._visible=e,this._visible?this._addedToStage?this.stageObject.setVisible(!0):(this._stageLayer.add(this.stageObject),this._addedToStage=!0):this.stageObject.setVisible(!1),y(this._edgeState))){const t=this._stage.renderView.ensureEdgeView();t.hasObject(this.stageObject)?t.updateObjectVisibility(this.stageObject,e):e&&this._addOrUpdateEdgeObject(t,!1)}}get visible(){return this._visible}alignWithElevation(e,t,r,n){this.elevationAligner!=null&&(y(r)&&C4(this.elevationContext.featureExpressionInfoContext,r),this.alignedSampledElevation=this.elevationAligner(this,this.elevationContext,e,t),this._resetEdgeObject(n))}getCenterObjectSpace(e=P()){return X(e,PD(this.stageObject.boundingVolumeObjectSpace.bounds))}getBoundingBoxObjectSpace(e=Ms()){const t=this.stageObject.boundingVolumeObjectSpace;return Zse(e,t.min),Yse(e,t.max),e}computeAttachmentOrigin(e){if(this.useObjectOriginAsAttachmentOrigin){const t=this.stageObject.transformation;e.render.origin[0]+=t[12],e.render.origin[1]+=t[13],e.render.origin[2]+=t[14],e.render.num++}else for(const t of this.stageObject.geometryRecords)t.computeAttachmentOrigin(xu)&&(Me(xu,xu,this.stageObject.transformation),ce(e.render.origin,e.render.origin,xu),e.render.num++)}async getProjectedBoundingBox(e,t,r,n,s){const a=this.getBoundingBoxObjectSpace(s),o=cCe,l=JD(a)?1:o.length;for(let u=0;u<l;u++){const d=o[u];sp[0]=a[d[0]],sp[1]=a[d[1]],sp[2]=a[d[2]],Me(sp,sp,this.stageObject.transformation),lf[3*u+0]=sp[0],lf[3*u+1]=sp[1],lf[3*u+2]=sp[2]}if(!e(lf,0,l))return null;Ii(a);let c=null;this.calculateRelativeScreenBounds&&(c=this.calculateRelativeScreenBounds());for(let u=0;u<3*l;u+=3){for(let d=0;d<3;d++)a[d]=Math.min(a[d],lf[u+d]),a[d+3]=Math.max(a[d+3],lf[u+d]);c&&r.push({location:lf.slice(u,u+3),screenSpaceBoundingRect:c})}if(t&&t.service&&this.elevationContext.mode!=="absolute-height"){Ic(a,xu);const u=this.elevationContext.mode==="relative-to-scene"?"scene":"ground";let d=0;if(t.useViewElevation)d=Ke(t.service.getElevation(xu[0],xu[1],u),0);else try{const m=x4(a,t.service.spatialReference,t);d=Ke(await t.service.queryElevation(xu[0],xu[1],n,m,u),0)}catch{}wH(a,0,0,-this.alignedSampledElevation+d)}return a}addObjectState(e,t){e===Dg.Highlight&&t.addObject(this.stageObject,this.stageObject.highlight()),e===Dg.MaskOccludee&&t.addObject(this.stageObject,this.stageObject.maskOccludee())}removeObjectState(e){e.removeObject(this.stageObject)}_resetEdgeObject(e){if(C(this._edgeState))return;const t=this._stage.renderView.ensureEdgeView();this._visible?this._addOrUpdateEdgeObject(t,e):t.removeObject(this.stageObject)}_addOrUpdateEdgeObject(e,t){const r=this._edgeState;if(C(r))return;const n=YU(r.baseMaterial);for(const s of r.edgeMaterials)s.objectTransparency=n;e.addOrUpdateObject3D(this.stageObject,r.edgeMaterials,r.properties,!t).then(()=>{var s;return(s=this._stageLayer)==null?void 0:s.sync()})}};function YU(i){return i.isVisible?i.parameters.transparent?Ct.TRANSPARENT:Ct.OPAQUE:Ct.INVISIBLE}const lf=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],sp=P(),xu=P(),cCe=[[0,1,2],[3,1,2],[0,4,2],[3,4,2],[0,1,5],[3,1,5],[0,4,5],[3,4,5]];var Gr;(function(i){i[i.Recreate_Symbol=0]="Recreate_Symbol",i[i.Recreate_Graphics=1]="Recreate_Graphics",i[i.Fast_Update=2]="Fast_Update"})(Gr||(Gr={}));let S4=class{constructor(e){this.schedule=e,this._abortController=null,this._loadStatus=jo.LOADING,this._loadError=null,this._loader=null,this.logger=null}destroy(){this.abortLoad()}get loadStatus(){return this._loadStatus}load(e,t){return this._loadStatus===jo.LOADED?(e&&e(),Ke(this._loader,Promise.resolve())):this._loadStatus===jo.FAILED?(t&&t(this._loadError),Ke(this._loader,Promise.resolve())):(C(this._loader)&&(this._abortController=new AbortController,this._loader=this.doLoad(this._abortController.signal).then(()=>{this._abortController=null,this._loadStatus=jo.LOADED},r=>{throw this._loadError=r,this._abortController=null,this._loadStatus=jo.FAILED,!yo(r)&&this.logger&&r.message&&this.logger.warn(r.message),r})),this._loader.then(e,t).catch(()=>{}),this._loader)}abortLoad(){y(this._abortController)?this._abortController=iu(this._abortController):this._loadStatus===jo.LOADING&&(this._loadStatus=jo.FAILED),this._loader=null}};var jo;(function(i){i[i.LOADING=0]="LOADING",i[i.LOADED=1]="LOADED",i[i.FAILED=2]="FAILED"})(jo||(jo={}));function hCe(i){switch(i){case"sphere":case"cube":case"diamond":case"cylinder":case"cone":case"inverted-cone":case"tetrahedron":return!0}return!1}function ZY(i,e){const t=(r,n,s=!1)=>({levels:r.map(a=>{const o=n(a.tesselation);return s&&fve(o),{components:[{geometry:o,material:e}],faceCount:o.indexCount/3,minScreenSpaceRadius:a.minScreenSpaceRadius}})});switch(i){case"sphere":return t([{tesselation:0,minScreenSpaceRadius:0},{tesselation:1,minScreenSpaceRadius:8},{tesselation:2,minScreenSpaceRadius:16},{tesselation:3,minScreenSpaceRadius:50},{tesselation:4,minScreenSpaceRadius:250}],r=>fZ(.5,r,!0));case"cube":return t([{tesselation:0,minScreenSpaceRadius:0}],()=>hve(1));case"cone":return t(oM,r=>U6(1,.5,r,!1),!0);case"inverted-cone":return t(oM,r=>U6(1,.5,r,!0),!0);case"cylinder":return t(oM,r=>mve(1,.5,r,[0,0,1],[0,0,.5]));case"tetrahedron":return t([{tesselation:0,minScreenSpaceRadius:0}],()=>dve(1),!0);case"diamond":return t([{tesselation:0,minScreenSpaceRadius:0}],()=>uve(1),!0);default:return}}const oM=[{tesselation:6,minScreenSpaceRadius:0},{tesselation:18,minScreenSpaceRadius:7},{tesselation:64,minScreenSpaceRadius:65}];function EC(i){const e=[];return i.levels.forEach(t=>{t.components.forEach(r=>{e.push(r.material)})}),$x(e)}function KU(i){const e=new Array;return i.levels.forEach(t=>{t.components.forEach(r=>{r.textures&&e.push(...r.textures)})}),$x(e)}function E4(i){const e=[];return i.components.forEach(t=>{e.push(t.geometry)}),$x(e)}function JU(i){const e=[];return i.levels.forEach(t=>{t.components.forEach(r=>{e.push(r.geometry)})}),$x(e)}function uCe(i){return E4(i).reduce((e,t)=>e+t.indexCount/3,0)}const R4={primitivesPerFeature:0,primitivesPerCoordinate:0,drawCallsPerFeature:0,estimated:!0,memory:{bytesPerFeature:0,bytesPerCoordinate:0,bytesPerFeatureLabel:0,resourceBytes:0,draped:{bytesPerFeature:0,bytesPerFeatureLabel:0,bytesPerCoordinate:0}}};function p8e(i){return i.type==="web-style"?R4:P4(i.symbolLayers.toArray().map(e=>YY(i,e)))}function P4(i){let e=0,t=0,r=0,n=!1,s=0;const a={bytesPerFeature:0,bytesPerFeatureLabel:0,bytesPerCoordinate:0,resourceBytes:0,draped:{bytesPerFeature:0,bytesPerFeatureLabel:0,bytesPerCoordinate:0}};for(const o of i)C(o)||(e+=o.primitivesPerFeature,t+=o.primitivesPerCoordinate,r+=o.drawCallsPerFeature,a.bytesPerFeature+=o.memory.bytesPerFeature,a.bytesPerFeatureLabel+=o.memory.bytesPerFeatureLabel,a.bytesPerCoordinate+=o.memory.bytesPerCoordinate,a.resourceBytes+=o.memory.resourceBytes,a.draped.bytesPerFeature+=o.memory.bytesPerFeature,a.draped.bytesPerFeatureLabel+=o.memory.bytesPerFeatureLabel,a.draped.bytesPerCoordinate+=o.memory.bytesPerCoordinate,n=n||o.estimated,++s);return{primitivesPerFeature:e,primitivesPerCoordinate:t,drawCallsPerFeature:r,estimated:n,memory:a,numComplexities:s}}function m8e(i){const e=P4(i);return e.numComplexities>0&&(e.primitivesPerFeature/=e.numComplexities,e.primitivesPerCoordinate/=e.numComplexities,e.drawCallsPerFeature/=e.numComplexities,e.memory.bytesPerFeature/=e.numComplexities,e.memory.bytesPerFeatureLabel/=e.numComplexities,e.memory.bytesPerCoordinate/=e.numComplexities,e.memory.resourceBytes/=e.numComplexities,e.memory.draped.bytesPerFeature/=e.numComplexities,e.memory.draped.bytesPerFeatureLabel/=e.numComplexities,e.memory.draped.bytesPerCoordinate/=e.numComplexities),e}const e8={};function YY(i,e){const t=KY(i,e),r=cae(e)?2:0;switch(e.type){case"extrude":return{primitivesPerFeature:-4,primitivesPerCoordinate:4,drawCallsPerFeature:r,estimated:!1,memory:t};case"fill":return i.type==="mesh-3d"?{primitivesPerFeature:0,primitivesPerCoordinate:0,drawCallsPerFeature:r,estimated:!1,memory:t}:y(e.outline)&&e.outline.size>0?{primitivesPerFeature:-4,primitivesPerCoordinate:3,drawCallsPerFeature:0,estimated:!1,memory:t}:{primitivesPerFeature:-2,primitivesPerCoordinate:1,drawCallsPerFeature:0,estimated:!1,memory:t};case"water":return{primitivesPerFeature:-2,primitivesPerCoordinate:1,drawCallsPerFeature:0,estimated:!1,memory:t};case"line":return{primitivesPerFeature:-2,primitivesPerCoordinate:2,drawCallsPerFeature:0,estimated:!1,memory:t};case"object":return e.resource&&e.resource.href?{primitivesPerFeature:16,primitivesPerCoordinate:0,drawCallsPerFeature:0,estimated:!0,memory:t}:{...dCe(e.resource&&e.resource.primitive||rG),memory:t};case"path":{let o=0,l=0;switch(e.profile){case"circle":o=10;break;case"quad":o=4;break;default:return void Ra(e.profile)}switch(e.join){case"round":l=3;break;case"miter":case"bevel":l=1;break;default:return void Ra(e.join)}const c=2*o,u=o*l*2;let d=-2*u-c;switch(e.cap){case"none":break;case"butt":case"square":d+=2*(o-1);break;case"round":d+=2*(o*(3-1)*2+o);break;default:return}return{primitivesPerFeature:d,primitivesPerCoordinate:u+c,drawCallsPerFeature:0,estimated:!1,memory:t}}case"text":case"icon":return{primitivesPerFeature:2,primitivesPerCoordinate:0,drawCallsPerFeature:0,estimated:!1,memory:t};default:return}}function KY(i,e){const t=i.type==="point-3d";switch(e.type){case"extrude":return e.edges&&e.edges.size>0?ra.EXTRUDE_EDGES:ra.EXTRUDE;case"fill":return y(e.outline)&&e.outline.size>0?ra.FILL_OUTLINE:ra.FILL;case"water":return ra.FILL;case"line":return e.join==="round"?ra.LINE_ROUND:ra.LINE_MITER;case"path":switch(e.join){case"round":switch(e.profile){case"circle":return ra.PATH_ROUND_CIRCLE;case"quad":return ra.PATH_ROUND_QUAD;default:return void Ra(e.profile)}case"miter":case"bevel":switch(e.profile){case"circle":return ra.PATH_MITER_CIRCLE;case"quad":return ra.PATH_MITER_QUAD;default:return void Ra(e.profile)}default:return void Ra(e.join)}case"object":return t?ra.OBJECT_POINT:ra.OBJECT_POLYGON;case"icon":case"text":return t?ra.ICON_POINT:ra.ICON_POLYGON;default:return}}function dCe(i){let e=e8[i];if(e)return e;const t=ZY(i,null);return e={primitivesPerFeature:E4(t.levels[0]).reduce((r,n)=>r+n.indices.get(S.POSITION).length/3,0),primitivesPerCoordinate:0,drawCallsPerFeature:0,estimated:!1},e8[i]=e,e}const ra={ICON_POINT:{bytesPerFeature:7127.413186968842,bytesPerFeatureLabel:4826.302896296296,bytesPerCoordinate:0,resourceBytes:0,draped:{bytesPerFeature:3929.4396628895197,bytesPerFeatureLabel:3550.1332222222227,bytesPerCoordinate:0}},ICON_POLYGON:{bytesPerFeature:9329.452613976147,bytesPerFeatureLabel:3675.3372604938268,bytesPerCoordinate:60.177252982212096,resourceBytes:0,draped:{bytesPerFeature:6190.247450139383,bytesPerFeatureLabel:3744.074358024691,bytesPerCoordinate:59.488211068026104}},OBJECT_POINT:{bytesPerFeature:2350.5884192634558,bytesPerFeatureLabel:4446.651003703703,bytesPerCoordinate:0,resourceBytes:0,draped:{bytesPerFeature:2350.5884192634558,bytesPerFeatureLabel:4446.651003703703,bytesPerCoordinate:0}},OBJECT_POLYGON:{bytesPerFeature:4583.807620302299,bytesPerFeatureLabel:3665.342685185186,bytesPerCoordinate:60.11621818101506,resourceBytes:0,draped:{bytesPerFeature:4583.807620302299,bytesPerFeatureLabel:3665.342685185186,bytesPerCoordinate:60.11621818101506}},LINE_MITER:{bytesPerFeature:7321.028181375921,bytesPerFeatureLabel:4048.0226716049388,bytesPerCoordinate:186.55621386363578,resourceBytes:0,draped:{bytesPerFeature:4246.856619435009,bytesPerFeatureLabel:3852.3737679012347,bytesPerCoordinate:163.47884002621583}},LINE_ROUND:{bytesPerFeature:7482.205842738954,bytesPerFeatureLabel:4045.886987654321,bytesPerCoordinate:191.5452524171851,resourceBytes:0,draped:{bytesPerFeature:4473.481387957992,bytesPerFeatureLabel:3842.1112395061728,bytesPerCoordinate:167.27703460226945}},PATH_MITER_CIRCLE:{bytesPerFeature:9010.489006415351,bytesPerFeatureLabel:4230.9109,bytesPerCoordinate:4618.2594178027275,resourceBytes:0,draped:{bytesPerFeature:9010.489006415351,bytesPerFeatureLabel:4230.9109,bytesPerCoordinate:4618.2594178027275}},PATH_ROUND_CIRCLE:{bytesPerFeature:4104.727250200398,bytesPerFeatureLabel:4251.8525,bytesPerCoordinate:8019.043777064957,resourceBytes:0,draped:{bytesPerFeature:4104.727250200398,bytesPerFeatureLabel:4251.8525,bytesPerCoordinate:8019.043777064957}},PATH_MITER_QUAD:{bytesPerFeature:9416.372942261387,bytesPerFeatureLabel:4241.2757,bytesPerCoordinate:3176.7222742582203,resourceBytes:0,draped:{bytesPerFeature:9416.372942261387,bytesPerFeatureLabel:4241.2757,bytesPerCoordinate:3176.7222742582203}},PATH_ROUND_QUAD:{bytesPerFeature:6614.431545308682,bytesPerFeatureLabel:4206.7461,bytesPerCoordinate:5141.817789093826,resourceBytes:0,draped:{bytesPerFeature:6614.431545308682,bytesPerFeatureLabel:4206.7461,bytesPerCoordinate:5141.817789093826}},FILL:{bytesPerFeature:9478.244183633637,bytesPerFeatureLabel:3713.816824691358,bytesPerCoordinate:95.9343604185578,resourceBytes:0,draped:{bytesPerFeature:6287.911108168086,bytesPerFeatureLabel:3790.785032098766,bytesPerCoordinate:83.08783220478168}},FILL_OUTLINE:{bytesPerFeature:13085.871870349445,bytesPerFeatureLabel:3392.613241975309,bytesPerCoordinate:118.63968023169875,resourceBytes:0,draped:{bytesPerFeature:8437.199992480122,bytesPerFeatureLabel:3973.5431172839503,bytesPerCoordinate:106.33556817014312}},EXTRUDE:{bytesPerFeature:19459.53727140414,bytesPerFeatureLabel:3743.7045209876546,bytesPerCoordinate:372.6819978900477,resourceBytes:0,draped:{bytesPerFeature:19459.53727140414,bytesPerFeatureLabel:3743.7045209876546,bytesPerCoordinate:372.6819978900477}},EXTRUDE_EDGES:{bytesPerFeature:22266.888534913724,bytesPerFeatureLabel:3064.3193358024696,bytesPerCoordinate:374.3725221561312,resourceBytes:0,draped:{bytesPerFeature:22266.888534913724,bytesPerFeatureLabel:3064.3193358024696,bytesPerCoordinate:374.3725221561312}}},U_=ee.getLogger("esri.views.3d.layers.graphics.Graphics3DSymbolLayer");let du=class extends S4{constructor(e,t,r,n){super(r.schedule),this._context=r,this._elevationInfoOverride=null,this._ignoreDrivers=!1,this._drivenProperties={color:!1,opacity:!1,opacityAlwaysOpaque:!0,size:!1},this.complexity=null,this.logger=U_,this._elevationOptions={supportsOffsetAdjustment:!1,supportsOnTheGround:!0},this.symbol=e,this.symbolLayer=t,this._renderPriority=n.renderPriority,this._renderPriorityStep=n.renderPriorityStep,this._elevationContext=new Qc,this.complexity=this.computeComplexity(),this._ignoreDrivers=n.ignoreDrivers,this._ignoreDrivers||(this._drivenProperties=t8(this._context.renderer)),this._updateElevationContext()}getCachedSize(){return null}get extentPadding(){return 0}_drivenPropertiesChanged(e){if(this._ignoreDrivers)return!1;const t=this._drivenProperties,r=t8(e);return r.color!==t.color||r.opacity!==t.opacity||r.opacityAlwaysOpaque!==t.opacityAlwaysOpaque||r.size!==t.size}get needsDrivenTransparentPass(){return this._drivenProperties.opacity&&!this._drivenProperties.opacityAlwaysOpaque}_logGeometryCreationWarnings(e,t,r,n){const s=e.projectionSuccess,a="polygons"in e?e.polygons:null,o=`${n} geometry failed to be created`;let l=null;s?!this._logGeometryValidationWarnings(t,r,n)&&a&&a.length===0&&r==="rings"&&t.length>0&&t[0].length>2&&(l=`${o} (filled rings should use clockwise winding - try reversing the order of vertices)`):l=`${o} (failed to project geometry to view spatial reference)`,l&&U_.warnOncePerTick(l)}_logGeometryValidationWarnings(e,t,r){const n=`${r} geometry failed to be created`;return!e.length||e.length===1&&!e[0].length?(U_.warnOncePerTick(`${n} (no ${t} were defined)`),!0):(!Array.isArray(e)||!Array.isArray(e[0]))&&(U_.warnOncePerTick(`${n} (${t} should be defined as a 2D array)`),!0)}_validateGeometry(e,t=null,r=null){if(y(t)&&!t.includes(e.type))return this.logger.warn("unsupported geometry type for "+r+` symbol: ${e.type}`),!1;if(e.type==="point"){const n=e;if(!isFinite(n.x)||!isFinite(n.y))return U_.warn("point coordinate is not a valid number, graphic skipped"),!1}return!0}_defaultElevationInfoNoZ(){return pCe}_defaultElevationInfoZ(){return mCe}_updateElevationContext(){y(this._elevationInfoOverride)?(this._elevationContext.setFromElevationInfo(this._elevationInfoOverride),this._elevationContext.updateFeatureExpressionInfoContext(null)):this._context.layer.elevationInfo?(this._elevationContext.setFromElevationInfo(this._context.layer.elevationInfo),this._elevationContext.updateFeatureExpressionInfoContext(this._context.featureExpressionInfoContext)):this._elevationContext.reset()}getDefaultElevationInfo(e){return e.hasZ?this._defaultElevationInfoZ():this._defaultElevationInfoNoZ()}getGeometryElevationMode(e,t=this.getDefaultElevationInfo(e)){return this._elevationContext.mode||t.mode}setElevationInfoOverride(e){this._elevationInfoOverride=e,this._updateElevationContext()}setGraphicElevationContext(e,t){const r=ft(e.geometry),n=this.getDefaultElevationInfo(r);t.unit=this._elevationContext.unit!=null?this._elevationContext.unit:n.unit,t.mode=this.getGeometryElevationMode(r,n),t.offsetMeters=Ke(this._elevationContext.meterUnitOffset,Ke(n.offset,0));const s=!this._elevationOptions.supportsOnTheGround&&t.mode==="on-the-ground";s&&(t.mode="relative-to-ground",t.offsetMeters=0);const a=s?lCe:this._elevationContext.featureExpressionInfoContext;return t.updateFeatureExpressionInfoContext(a,e,this._context.layer),t}prepareSymbolLayerPatch(e){}updateGeometry(e,t){return!1}onRemoveGraphic(e){}_getLayerOpacity(){return this._context.graphicsCoreOwner&&"fullOpacity"in this._context.graphicsCoreOwner?this._context.graphicsCoreOwner.fullOpacity:this._context.layer.opacity??1}_getCombinedOpacity(e,t=i8){let r=1;return this.draped||(r*=this._getLayerOpacity()),this._drivenProperties.opacity||(y(e)?r*=e.a:t.hasIntrinsicColor||(r=0)),r}_getCombinedOpacityAndColor(e,t=i8){const r=this._getCombinedOpacity(e,t);if(this._drivenProperties.color)return rw(null,r);const n=y(e)?ti.toUnitRGB(e):em;return rw(n,r)}_getVertexOpacityAndColor(e,t=null){const r=this._drivenProperties.color?e.color:null,n=this._drivenProperties.opacity?e.opacity:null,s=rw(r,n);return y(t)&&(s[0]*=t,s[1]*=t,s[2]*=t,s[3]*=t),s}isFastUpdatesEnabled(){return this._fastUpdates&&this._fastUpdates.enabled}computeComplexity(){return YY(this.symbol,this.symbolLayer)}globalPropertyChanged(e,t,r){switch(e){case"opacity":return this.layerOpacityChanged(t,r),!0;case"elevationInfo":{const n=this._elevationContext.mode;return this._updateElevationContext(),this.layerElevationInfoChanged(t,r,n)!==Zi.RECREATE}case"slicePlaneEnabled":return this.slicePlaneEnabledChanged(t,r);case"physicalBasedRenderingEnabled":return this.physicalBasedRenderingChanged();case"pixelRatio":return this.pixelRatioChanged();default:return!1}}updateGraphics3DGraphicElevationInfo(e,t,r){let n=Zi.UPDATE;return e.forEach(s=>{const a=t(s);if(y(a)){const o=s.graphic;this.setGraphicElevationContext(o,a.elevationContext),a.needsElevationUpdates=r(a.elevationContext.mode)}else n=Zi.RECREATE}),n}applyRendererDiff(e,t){return Gr.Recreate_Symbol}getFastUpdateAttrValues(e){if(!this._fastUpdates.enabled)return null;const t=this._fastUpdates.visualVariables,r=t.size?_d(t.size.field,e):0,n=t.color?_d(t.color.field,e):0,s=t.opacity?_d(t.opacity.field,e):0;return Bi(r,n,s,0)}get draped(){return this._draped}ensureDrapedStatus(e){return this._draped==null?(this._draped=e,!0):(e!==this.draped&&U_.warnOnce("A symbol can only produce either draped or non-draped visualizations. Use two separate symbol instances for draped and non-draped graphics if necessary."),!1)}test(){const e=()=>{var t,r,n,s,a,o,l,c,u,d,m,f;return{size:((n=(r=(t=this._fastUpdates)==null?void 0:t.visualVariables)==null?void 0:r.size)==null?void 0:n.field)??null,color:((o=(a=(s=this._fastUpdates)==null?void 0:s.visualVariables)==null?void 0:a.color)==null?void 0:o.field)??null,opacity:((u=(c=(l=this._fastUpdates)==null?void 0:l.visualVariables)==null?void 0:c.opacity)==null?void 0:u.field)??null,rotation:((f=(m=(d=this._fastUpdates)==null?void 0:d.visualVariables)==null?void 0:m.rotation)==null?void 0:f.field)??null}};return{drivenProperties:this._drivenProperties,getVisVarFields:e}}};function _d(i,e){const t=i!=null?e.attributes[i]:0;return t!=null&&isFinite(t)?t:0}function t8(i){const e={color:!1,opacity:!1,opacityAlwaysOpaque:!0,size:!1};return i&&"visualVariables"in i&&i.visualVariables&&i.visualVariables.forEach(t=>{switch(t.type){case"color":if(e.color=!0,t.stops)for(let r=0;r<t.stops.length;r++){const n=t.stops[r].color;n&&(e.opacity=!0,n.a<1&&(e.opacityAlwaysOpaque=!1))}break;case"opacity":e.opacity=!0,e.opacityAlwaysOpaque=!1;break;case"size":e.size=!0}}),e}const pCe={mode:"on-the-ground",offset:0,unit:"meters"},mCe={mode:"absolute-height",offset:0,unit:"meters"},i8={hasIntrinsicColor:!1};let Wg=class{constructor(){this._disposed=!1}get disposed(){return this._disposed}get shaderTransformation(){return this._shaderTransformation}acquire(e,t,r,n,s,a){this.id=Sm(),this.geometry=e,this.material=t,this.transformation=r,this.instanceParameters=n,this.origin=s,this._shaderTransformation=a,this._disposed=!1}release(){this._disposed=!1}dispose(){this._disposed=!0}getStaticTransformation(){return this.transformation}getShaderTransformation(){return y(this._shaderTransformation)?this._shaderTransformation(this.transformation):this.transformation}computeAttachmentOrigin(e){return!!(this.material.computeAttachmentOrigin?this.material.computeAttachmentOrigin(this.geometry,e):this.geometry.computeAttachmentOrigin(e))&&(Me(e,e,this.getStaticTransformation()),!0)}};Wg.pool=new Fl(Wg);let hR=class{constructor(e){this.channel=e,this.id=Sm()}},Bd=class extends ZG{constructor(e={}){super(),this.type=vv.Object,this._geometryRecords=new Array,this._geometries=new Array,this._objectTransformation=xe(),this._bvObjectSpace=new r8,this._bvWorldSpace=new r8,this._bvDirty=!0,this._hasVolatileTransformation=!1,this._visible=!0,this.castShadow=e.castShadow==null||e.castShadow,this.metadata=e.metadata,this.metadata&&this.metadata.isElevationSource&&(this.metadata.lastValidElevationBB=new JY);const{geometries:t,materials:r,transformations:n,origins:s}=e;if(Array.isArray(t)){ct(r.length===t.length,"Object3D: materials don't match geometries"),ct(n.length===t.length,"Object3D: transformations don't match geometries"),this._geometryRecords.length=t.length,this._geometries.length=t.length;for(let a=0;a<t.length;a++)this._geometries[a]=t[a],this._geometryRecords[a]=Wg.pool.acquire(t[a],r[a],SS(n[a]),{highlights:null,occludees:null,visible:this._visible},s&&s[a])}}get geometryRecords(){return this._geometryRecords}get geometries(){return this._geometries}get transformation(){return this._objectTransformation}set transformation(e){pn(this._objectTransformation,e),this._invalidateBoundingVolume(),this._emit("objectTransformation",this)}dispose(){this._geometryRecords.length=0,this._geometries.length=0}get parentLayer(){return this._parentLayer}set parentLayer(e){ct(this._parentLayer==null||e==null,"Object3D can only be added to a single Layer"),this._parentLayer=e}addGeometry(e,t,r,n,s){r=r||rn,this._geometries.push(e);const a=Wg.pool.acquire(e,t,r,{highlights:null,occludees:null,visible:this._visible},n,s);return this._geometryRecords.push(a),this._hasVolatileTransformation=this._hasVolatileTransformation||y(a.shaderTransformation),this._emit("objectGeometryAdded",{object:this,record:a}),this._invalidateBoundingVolume(),a}removeGeometry(e){const t=this._geometryRecords.splice(e,1)[0];return this._hasVolatileTransformation=y(t.shaderTransformation)?this._geometryRecords.some(r=>y(r.shaderTransformation)):this._hasVolatileTransformation,t.dispose(),this._geometries.splice(e,1),this._emit("objectGeometryRemoved",{object:this,record:t}),this._invalidateBoundingVolume(),t}removeAllGeometries(){for(;this.geometryRecords.length>0;)this.removeGeometry(0)}geometryVertexAttrsUpdated(e){this._emit("vertexAttrsUpdated",{object:this,record:e}),this._invalidateBoundingVolume()}get isVisible(){return this._visible}setVisible(e){if(this._visible!==e){this._visible=e;for(const t of this._geometryRecords)t.instanceParameters.visible=this._visible;this._emit("visibilityChanged",this)}}maskOccludee(){const e=new hR(Dg.MaskOccludee);for(const t of this._geometryRecords)t.instanceParameters.occludees=kI(t.instanceParameters.occludees,e);return this._emit("occlusionChanged",this),e}removeOcclude(e){for(const t of this._geometryRecords)t.instanceParameters.occludees=VI(t.instanceParameters.occludees,e);this._emit("occlusionChanged",this)}highlight(){const e=new hR(Dg.Highlight);for(const t of this._geometryRecords)t.instanceParameters.highlights=kI(t.instanceParameters.highlights,e);return this._emit("highlightChanged",this),e}removeHighlight(e){for(const t of this._geometryRecords)t.instanceParameters.highlights=VI(t.instanceParameters.highlights,e);this._emit("highlightChanged",this)}getCombinedStaticTransformation(e,t){return Hr(t,this.transformation,e.getStaticTransformation())}_getCombinedShaderTransformation(e){return Hr(xe(),this.transformation,e.getShaderTransformation())}hasVolativeTransformation(){return this._hasVolatileTransformation}get boundingVolumeWorldSpace(){return this._validateBoundingVolume(),this._bvWorldSpace}get boundingVolumeObjectSpace(){return this._validateBoundingVolume(),this._bvObjectSpace}_validateBoundingVolume(){if(!this._bvDirty&&!this._hasVolatileTransformation)return;this._bvObjectSpace.init(),this._bvWorldSpace.init();for(let n=0;n<this._geometryRecords.length;++n){const s=this._geometries[n],a=this._geometryRecords[n],o=s.boundingInfo;y(o)&&(this._calculateTransformedBoundingVolume(o,this._bvObjectSpace,a.getShaderTransformation()),this._calculateTransformedBoundingVolume(o,this._bvWorldSpace,this._getCombinedShaderTransformation(a)))}Bn(this._bvObjectSpace.bounds,this._bvObjectSpace.min,this._bvObjectSpace.max,.5),Bn(this._bvWorldSpace.bounds,this._bvWorldSpace.min,this._bvWorldSpace.max,.5);const e=P(),t=P(),r=Gg(this.transformation);for(let n=0;n<this._geometryRecords.length;++n){const s=this._geometries[n].boundingInfo;if(C(s))continue;const a=this._geometryRecords[n].getShaderTransformation(),o=Gg(a);Me(e,s.getCenter(),a);const l=Li(e,this._bvObjectSpace.bounds),c=s.getBSRadius()*o;this._bvObjectSpace.bounds[3]=Math.max(this._bvObjectSpace.bounds[3],l+c),Me(t,e,this.transformation);const u=Li(t,this._bvWorldSpace.bounds),d=c*r;this._bvWorldSpace.bounds[3]=Math.max(this._bvWorldSpace.bounds[3],u+d)}this._bvDirty=!1}_calculateTransformedBoundingVolume(e,t,r){const n=e.getBBMin(),s=e.getBBMax(),a=as(n),o=as(s);Me(a,a,r),Me(o,o,r);for(let l=0;l<3;++l)t.min[l]=Math.min(t.min[l],a[l],o[l]),t.max[l]=Math.max(t.max[l],a[l],o[l]);for(let l=0;l<3;++l){X(a,n),X(o,s),a[l]=s[l],o[l]=n[l],Me(a,a,r),Me(o,o,r);for(let c=0;c<3;++c)t.min[c]=Math.min(t.min[c],a[c],o[c]),t.max[c]=Math.max(t.max[c],a[c],o[c])}}_invalidateBoundingVolume(){this._bvDirty=!0,y(this._parentLayer)&&this._parentLayer.notifyObjectBBChanged(this,this._bvWorldSpace.bounds)}_emit(e,t){y(this._parentLayer)&&this._parentLayer.events.emit(e,t)}get test(){const e=this;return{hasGeometry:t=>e._geometries.includes(t),getGeometryIndex:t=>e._geometries.indexOf(t)}}},JY=class{constructor(){this.min=Ze(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this.max=Ze(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE)}isEmpty(){return this.max[0]<this.min[0]&&this.max[1]<this.min[1]&&this.max[2]<this.min[2]}},r8=class extends JY{constructor(){super(...arguments),this.bounds=ou()}init(){Y(this.min,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),Y(this.max,-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),Wre(this.bounds)}};const cm=P();function A4(i,e,t,r,n,s,a,o){const l=t?t.length:0,c=i.clippingExtent;if(bn(e,cm,i.elevationProvider.spatialReference),y(c)&&!iF(c,cm))return null;bn(e,cm,i.renderCoordsHelper.spatialReference);const u=i.localOriginFactory.getOrigin(cm),d=new Bd({castShadow:!1,metadata:{layerUid:s,graphicUid:a,usesVerticalDistanceToGround:!0}});for(let m=0;m<l;m++){const f=rn;d.addGeometry(t[m],r[m],f,u,o)}return{object:d,sampledElevation:WTe(d,e,i.elevationProvider,i.renderCoordsHelper,n)}}function yx(i,e,t){const r=i.elevationContext,n=t.spatialReference;bn(e,cm,n),r.centerPointInElevationSR=kd(cm[0],cm[1],e.hasZ?cm[2]:0,y(n)?n:null)}function vx(i){switch(i.type){case"point":return i;case"polygon":case"extent":return w4(i);case"polyline":{const e=i.paths[0];if(!e||e.length===0)return null;const t=aG(e,oG(e)/2);return kd(t[0],t[1],t[2],i.spatialReference)}case"mesh":return i.origin}return null}let eK=class tK extends ii{initializeConfiguration(e,t){t.spherical=e.viewingMode===Ie.Global}initializeProgram(e){return new ei(e.rctx,tK.shader.get().build(this.configuration),oi)}setPipelineState(e){const t=e?hs.ALWAYS:hs.LESS;return this.configuration.depthHudEnabled?it({depthTest:{func:t},depthWrite:nl}):it({blending:Gn(me.ONE,me.SRC_ALPHA,me.ONE_MINUS_SRC_ALPHA,me.ONE_MINUS_SRC_ALPHA),depthTest:{func:t},colorWrite:gt})}initializePipeline(){return this.setPipelineState(this.configuration.hasMultipassGeometry)}};eK.shader=new ri(mae,()=>j(()=>import("./LineCallout.glsl-00f1e0f3.js"),["assets/LineCallout.glsl-00f1e0f3.js","assets/vec2-528adfe4.js","assets/common-c186b691.js","assets/vec2f64-30dc1443.js","assets/vec4f64-e407da96.js","assets/mat4-44a0988f.js","assets/vec3f64-2f9cef06.js","assets/mat4f64-1e28eae0.js","assets/vec3-e93e648f.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/HUD.glsl-d3a072ad.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/vec4-790471c0.js","assets/Float4PassUniform-d7bdbc81.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/FloatPassUniform-68d54f51.js","assets/VertexAttribute-9c5c630d.js","assets/LineCallout.glsl-358ef89b.js","assets/Slice.glsl-3b39b1f7.js"]));let gl=class extends cu{constructor(){super(...arguments),this.screenCenterOffsetUnitsEnabled=Lm.World,this.spherical=!1,this.occlusionTestEnabled=!0,this.hasVerticalOffset=!1,this.hasScreenSizePerspective=!1,this.depthHudEnabled=!1,this.depthHudAlignStartEnabled=!1,this.hasSlicePlane=!1,this.hasMultipassGeometry=!1}};h([k({count:Lm.COUNT})],gl.prototype,"screenCenterOffsetUnitsEnabled",void 0),h([k()],gl.prototype,"spherical",void 0),h([k()],gl.prototype,"occlusionTestEnabled",void 0),h([k()],gl.prototype,"hasVerticalOffset",void 0),h([k()],gl.prototype,"hasScreenSizePerspective",void 0),h([k()],gl.prototype,"depthHudEnabled",void 0),h([k()],gl.prototype,"depthHudAlignStartEnabled",void 0),h([k()],gl.prototype,"hasSlicePlane",void 0),h([k()],gl.prototype,"hasMultipassGeometry",void 0),h([k({constValue:!0})],gl.prototype,"hasSliceInVertexProgram",void 0),h([k({constValue:!1})],gl.prototype,"isDraped",void 0);let RC=class o$ extends Fd{constructor(e){super(e,new gCe),this._configuration=new gl,this._uniqueMaterialIdentifier=o$.uniqueMaterialIdentifier(this.parameters)}get uniqueMaterialIdentifier(){return this._uniqueMaterialIdentifier}getPassParameters(){return this.parameters}getConfiguration(e,t){const r=(t==null?void 0:t.slot)!==le.LINE_CALLOUTS;return this._configuration.occlusionTestEnabled=this.parameters.occlusionTest,this._configuration.hasVerticalOffset=y(this.parameters.verticalOffset),this._configuration.hasScreenSizePerspective=y(this.parameters.screenSizePerspective),this._configuration.depthHudEnabled=r,this._configuration.depthHudAlignStartEnabled=!!this.parameters.depthHUDAlignStart,this._configuration.screenCenterOffsetUnitsEnabled=this.parameters.centerOffsetUnits==="screen"?Lm.Screen:Lm.World,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.hasMultipassGeometry=t.multipassGeometry.enabled,this._configuration}intersect(){}requiresSlot(e,t){if(t===V.Color)switch(e){case le.LINE_CALLOUTS:case le.LINE_CALLOUTS_HUD_DEPTH:return!0}return!1}createGLMaterial(e){return new fCe(e)}createBufferWriter(){return new yCe}validateParameters(e){const t=o$.uniqueMaterialIdentifier(e);t!==this._uniqueMaterialIdentifier&&(this._uniqueMaterialIdentifier=t)}static uniqueMaterialIdentifier(e){return JSON.stringify({screenOffset:e.screenOffset||[0,0],centerOffsetUnits:e.centerOffsetUnits||"world"})}},fCe=class extends r_{beginSlot(e){return this.ensureTechnique(eK,e)}},gCe=class extends qx{constructor(){super(...arguments),this.screenOffset=Ag,this.color=[0,0,0,1],this.size=1,this.occlusionTest=!1,this.shaderPolygonOffset=1e-5,this.depthHUDAlignStart=!1,this.centerOffsetUnits="world",this.hasSlicePlane=!1}};const _Ce=sn().vec3f(S.POSITION).vec3f(S.NORMAL).vec2f(S.UV0).vec4f(S.AUXPOS1),n8=[Vp(0,0),Vp(1,0),Vp(0,1),Vp(1,0),Vp(1,1),Vp(0,1)];let yCe=class{constructor(){this.vertexBufferLayout=_Ce}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){return 6*e.indices.get(S.POSITION).length}write(e,t,r,n,s){HD(r.indices.get(S.POSITION),r.vertexAttributes.get(S.POSITION).data,e,n.position,s,6),cH(r.indices.get(S.NORMAL),r.vertexAttributes.get(S.NORMAL).data,t,n.normal,s,6),Aw(r.indices.get(S.AUXPOS1),r.vertexAttributes.get(S.AUXPOS1).data,n.auxpos1,s,6);for(let a=0;a<n8.length;++a)n.uv0.setVec(s+a,n8[a])}},iK=class rK extends du{constructor(e,t){super(e,null,t,wCe),this._elevationOptions={supportsOffsetAdjustment:!0,supportsOnTheGround:!1},this.ensureDrapedStatus(!1)}async doLoad(){this._material=new RC(this._materialParameters),this._context.stage.add(this._material)}destroy(){super.destroy(),this._context.stage.remove(this._material),this._material=null}_perInstanceMaterialParameters(e){const t=this._materialParameters;return t.screenOffset=e.screenOffset||Ag,t.centerOffsetUnits=e.centerOffsetUnits||"world",t}get _materialParameters(){const e=this.symbol,t=e.callout,r=y(t.color)?ti.toUnitRGBA(t.color):[0,0,0,0];r[3]*=this._getLayerOpacity();const n=Sa(t.size||0);let s=null;if(e.verticalOffset){const{screenLength:d,minWorldLength:m,maxWorldLength:f}=e.verticalOffset;s={screenLength:Sa(d),minWorldLength:m||0,maxWorldLength:y(f)?f:1/0}}const a=y(t.border)&&y(t.border.color)?ti.toUnitRGBA(t.border.color):null,o=e.symbolLayers.getItemAt(0).type==="object",l=!o,c=o?0:void 0,u=e.type==="label-3d";return{color:r,size:n,verticalOffset:s,screenSizePerspective:this._context.screenSizePerspectiveEnabled?this._context.sharedResources.screenSizePerspectiveSettings:null,screenOffset:[0,0],centerOffsetUnits:"world",borderColor:a,occlusionTest:l,shaderPolygonOffset:c,depthHUDAlignStart:u,hasSlicePlane:this._context.slicePlaneEnabled,renderOccluded:cr.Occlude,__tagStrict:"NoParameters"}}_defaultElevationInfoNoZ(){return bCe}createGraphics3DGraphic(e){const t=e.renderingInfo,r=e.graphic,n=this.setGraphicElevationContext(r,new Qc,t.elevationOffset||0),s=t.symbol,a=this._elevationContext.mode==="on-the-ground"&&(s.type==="cim"||!s.symbolLayers.some(l=>l.type==="object"||l.type==="text"));if(s.type!=="label-3d"&&a||s.type==="point-3d"&&s.symbolLayers.every(l=>l.type==="text"&&!nG(l)))return null;const o=w4(r.geometry);return C(o)?null:this._createAs3DShape(o,n,t,r.uid)}layerOpacityChanged(){y(this._material)&&this._material.setParameters(this._materialParameters)}layerElevationInfoChanged(e,t,r){const n=this._elevationContext.mode,s=sT(rK.elevationModeChangeTypes,r,n);return s!==Zi.UPDATE||e.forEach(a=>{const o=t(a);y(o)&&this.updateGraphicElevationContext(a.graphic,o)}),s}slicePlaneEnabledChanged(){return C(this._material)||this._material.setParameters({hasSlicePlane:this._context.slicePlaneEnabled}),!0}physicalBasedRenderingChanged(){return!0}pixelRatioChanged(){return!0}setGraphicElevationContext(e,t,r=0){const n=super.setGraphicElevationContext(e,t);return n.addOffsetRenderUnits(r),n}updateGraphicElevationContext(e,t){this.setGraphicElevationContext(e,t.elevationContext,t.metadata.elevationOffset),t.needsElevationUpdates=Ql(t.elevationContext.mode)}computeComplexity(){return{primitivesPerFeature:2,primitivesPerCoordinate:0,drawCallsPerFeature:0,estimated:!1,memory:R4.memory}}_createVertexData(e){const{translation:t,centerOffset:r}=e,n=t?{size:3,data:[t[0],t[1],t[2]],exclusive:!0}:{size:3,data:[0,0,0],exclusive:!0},s=r?{size:4,data:[r[0],r[1],r[2],r[3]],exclusive:!0}:{size:4,data:[0,0,0,1],exclusive:!0};return[[S.POSITION,n],[S.NORMAL,{size:3,data:[0,0,1],exclusive:!0}],[S.AUXPOS1,s]]}_getOrCreateMaterial(e){const t=this._perInstanceMaterialParameters(e),r=RC.uniqueMaterialIdentifier(t);if(y(this._material)&&r===this._material.uniqueMaterialIdentifier)return{material:this._material,isUnique:!1};if(e.materialCollection){let n=e.materialCollection.get(r);return C(n)&&(n=new RC(t),e.materialCollection.add(r,n)),{material:n,isUnique:!1}}return{material:new RC(t),isUnique:!0}}_createAs3DShape(e,t,r,n){const s=this._context.stage.renderView._getObjectAndLayerIdColor({graphicUid:n,layerUid:this._context.layer.uid}),a=[new jr(this._createVertexData(r),vCe,Fc.Point,s)],o=this._getOrCreateMaterial(r),l=A4(this._context,e,a,[o.material],t,this._context.layer.uid,n);if(l===null)return null;const c=new uu(this,l.object,a,o.isUnique?[o.material]:null,null,_x,t);return c.metadata={elevationOffset:r.elevationOffset||0},c.alignedSampledElevation=l.sampledElevation,c.needsElevationUpdates=Ql(t.mode),yx(c,e,this._context.elevationProvider),c}};iK.elevationModeChangeTypes={definedChanged:Zi.UPDATE,staysOnTheGround:Zi.UPDATE,onTheGroundChanged:Zi.RECREATE};const lM=[0],vCe=[[S.POSITION,lM],[S.NORMAL,lM],[S.AUXPOS1,lM]],bCe={mode:"relative-to-ground",offset:0},wCe={ignoreDrivers:!0,renderPriority:0,renderPriorityStep:1},s8=ee.getLogger("esri.views.3d.layers.graphics.Graphics3DCalloutSymbolLayerFactory");function xCe(i,e){if(!mD(i))return s8.error("Graphics3DCalloutSymbolLayerFactory#make",`symbol of type '${i.type}' does not support callouts`),null;if(!i.callout)return null;const t=TCe[i.callout.type];return t?new t(i,e):(s8.error("Graphics3DCalloutSymbolLayerFactory#make",`unknown or unsupported callout type ${i.callout.type}`),null)}const TCe={line:iK};let CCe=class{constructor(e,t,r){this.graphic=e,this.renderingInfo=t,this.layer=r}};const a8=new Fl(Array,i=>rF(i,Kse),null,10,5),SCe=Nt();let ECe=class{constructor(e,t,r,n,s){this.graphic=e,this.graphics3DSymbol=t,this.graphics=r,this._labelGraphics=new Array,this._auxiliaryGraphics=new Array,this._visibilityFlags=RCe($n._COUNT,Qo._COUNT),this._featureExpressionFeature=null,this._optimizedGeometry={geometry:null,hasZ:!1,hasM:!1},this._extent=null,this.isElevationSource=!1,++t.referenced,this._featureExpressionFeature=s?qY(s,e,n):null;for(const a of r)y(a)&&(this.isElevationSource=this.isElevationSource||a.isElevationSource)}get labelGraphics(){return this._labelGraphics}get extent(){return this._extent}initialize(e,t){this._layer=t,this._stage=e,this._forEachSymbolLayerGraphic(r=>{r.initialize(e,t),r.setVisibility(this.isVisible())})}destroy(){this._forEachSymbolLayerGraphic(e=>e.destroy()),this.graphics=null,this._auxiliaryGraphics=null,--this.graphics3DSymbol.referenced,this.graphics3DSymbol=null}get destroyed(){return this.graphics==null}clearLabelGraphics(){this._forEachLabelGraphic(e=>e.destroy()),this._labelGraphics.length=0}addLabelGraphic(e,t,r){this._labelGraphics.push(e),e.initialize(t,r),e.setVisibility(this.isVisible($n.LABEL))}addAuxiliaryGraphic(e){this._auxiliaryGraphics.push(e),this._layer&&(e.initialize(this._stage,this._layer),e.setVisibility(this.isVisible()))}get isDraped(){let e=!1;return this._forEachSymbolLayerGraphic(t=>{t.type==="draped"&&(e=!0)}),e}isVisible(e=$n.GRAPHIC,t){for(let r=0;r<=e;r++){const n=this._visibilityFlags[r];for(let s=0;s<n.length;++s)if(n[s]===!1&&s!==t)return!1}return!0}hasVisibilityFlag(e,t){return this._visibilityFlags[t][e]!=null}setVisibilityFlag(e,t,r){const n=this.isVisible(r);this._visibilityFlags[r][e]=t;const s=this.isVisible(r);if(n===s)return!1;if(r===$n.LABEL)this._forEachLabelGraphic(a=>a.setVisibility(s));else{this._forEachSymbolLayerGraphic(o=>o.setVisibility(s));const a=this.isVisible($n.LABEL);this._forEachLabelGraphic(o=>o.setVisibility(a))}return!0}clearVisibilityFlag(e,t=$n.GRAPHIC){return this.setVisibilityFlag(e,void 0,t)}computeExtent(e){if(!this._extent){const t=this.graphic.geometry;if(C(t))return!1;this._extent=Nt(),nae(t,this._extent);const r=t.spatialReference;if(!Gm(r,e)&&!AR(this._extent,r,this._extent,e))return this._extent=null,!1}return!0}getAsOptimizedGeometry(e,t){return y(this._optimizedGeometry.geometry)&&this._optimizedGeometry.hasZ===e&&this._optimizedGeometry.hasM===t||(this._optimizedGeometry.geometry=this._convertGraphicToOptimizedGeometry(this.graphic,e,t),this._optimizedGeometry.hasZ=e,this._optimizedGeometry.hasM=t),this._optimizedGeometry.geometry}_convertGraphicToOptimizedGeometry(e,t,r){let n=e.geometry;return n.type!=="mesh"&&n.type!=="extent"||(n=jm.fromExtent(n.type==="mesh"?n.extent:n)),zie(n,t,r)}get usedMemory(){let e=rie(this.graphic.attributes);return this._forEachSymbolLayerGraphic(t=>{const r=t.graphics3DSymbolLayer.complexity;if(C(r))return;const n=t.type==="draped"?r.memory.draped:r.memory;e+=n.bytesPerFeature,n.bytesPerCoordinate&&(e+=sae(this.graphic.geometry)*n.bytesPerCoordinate)}),e}computeAttachmentOrigin(){const e={render:{origin:P(),num:0},draped:{origin:Te(),num:0}};for(const t of this.graphics)C(t)||t.computeAttachmentOrigin(e);return e.render.num&&Q(e.render.origin,e.render.origin,1/e.render.num),e.draped.num&&qs(e.draped.origin,e.draped.origin,1/e.draped.num),e}async getProjectedBoundingBox(e,t,r,n,s){return s||(s={boundingBox:null,requiresDrapedElevation:!1,screenSpaceObjects:[]}),s.boundingBox?Ii(s.boundingBox):s.boundingBox=Ii(),s.requiresDrapedElevation=!1,await vD(this.graphics,async a=>{if(C(a))return;const o=a.type==="draped"?t:e,l=a8.acquire(),c=await a.getProjectedBoundingBox(o,r,s.screenSpaceObjects,n,l);isFinite(c[2])&&isFinite(c[5])||(s.requiresDrapedElevation=!0),c&&Y0(s.boundingBox,l),a8.release(l)}),Jse(s.boundingBox)||MI(eF(s.boundingBox,SCe))?s:null}needsElevationUpdates(){for(const e of this.graphics)if(y(e)&&(e.type==="object3d"||e.type==="lod-instance")&&e.needsElevationUpdates)return!0;for(const e of this._labelGraphics)if(e&&e.needsElevationUpdates)return!0;return!1}alignWithElevation(e,t,r){this._forEachRenderedGraphic(n=>{n.type!=="object3d"&&n.type!=="lod-instance"||n.alignWithElevation(e,t,this._featureExpressionFeature,r)})}addObjectStateSet(e,t){this._forEachSymbolLayerGraphic(r=>r.addObjectState(e,t))}removeObjectState(e){this._forEachSymbolLayerGraphic(t=>t.removeObjectState(e))}_forEachGraphicList(e,t){e.forEach(r=>r&&t(r))}_forEachSymbolLayerGraphic(e){this._forEachGraphicList(this.graphics,e),this._forEachGraphicList(this._auxiliaryGraphics,e)}_forEachLabelGraphic(e){this._forEachGraphicList(this._labelGraphics,e)}_forEachRenderedGraphic(e){this._forEachSymbolLayerGraphic(e),this._forEachLabelGraphic(e)}};function RCe(i,e){const t=new Array(i);for(let r=0;r<t.length;r++)t[r]=new Array(e);return t}function UP(i,e){if(!i||i.symbol)return null;const t=e&&e.renderer;return i&&y(t)&&t.getObservationRenderer?t.getObservationRenderer(i):t}function PCe(i,e){if(y(i.symbol))return i.symbol;const t=UP(i,e);return y(t)&&t.type!=="dot-density"?t.getSymbol(i,e):null}function R8e(i,e){const t=UP(i,e),r=PCe(i,e);if(C(r))return null;const n={renderer:t,symbol:r};if(C(t)||!("visualVariables"in t)||!t.visualVariables)return n;const s=PH(t,i,e)??[],a=["proportional","proportional","proportional"];for(const{variable:o,value:l}of s)switch(o.type){case"color":n.color=l.toRgba();break;case"size":if(o.target==="outline")n.outlineSize=l;else{const c=o.axis,u=o.useSymbolValue?"symbol-value":l;switch(c){case"width":a[0]=u;break;case"depth":a[1]=u;break;case"height":a[2]=u;break;case"width-and-depth":a[0]=a[1]=u;break;default:a[0]=a[1]=a[2]=u}}break;case"opacity":n.opacity=l;break;case"rotation":switch(o.axis){case"tilt":n.tilt=l;break;case"roll":n.roll=l;break;default:n.heading=l}}return a[0]==="proportional"&&a[1]==="proportional"&&a[2]==="proportional"||(n.size=a),n}async function ACe(i,e){if(y(i.symbol))return i.symbol;const t=UP(i,e);return y(t)?t.getSymbolAsync(i,e):null}async function P8e(i,e){const t=UP(i,e),r=await ACe(i,e);if(!r)return null;const n={renderer:t,symbol:r};if(!t||!("visualVariables"in t)||!t.visualVariables)return n;const s=PH(t,i,e)??[],a=["proportional","proportional","proportional"];for(const{variable:o,value:l}of s)if(o.type==="color")n.color=ti.toUnitRGBA(l);else if(o.type==="size")if(o.target==="outline")n.outlineSize=l;else{const c=o.axis,u=o.useSymbolValue?"symbol-value":l;c==="width"?a[0]=u:c==="depth"?a[1]=u:c==="height"?a[2]=u:a[0]=a[1]=c==="width-and-depth"?u:a[2]=u}else o.type==="opacity"?n.opacity=l:o.type==="rotation"&&o.axis==="tilt"?n.tilt=l:o.type==="rotation"&&o.axis==="roll"?n.roll=l:o.type==="rotation"&&(n.heading=l);return(isFinite(a[0])||isFinite(a[1])||isFinite(a[2]))&&(n.size=a),n}function OCe(i,e=0){const t=i[e];return typeof t=="number"&&isFinite(t)?t:null}function MCe(i){for(let e=0;e<3;e++){const t=i[e];if(typeof t=="number")return isFinite(t)?t:0}return 0}function o8(i){const e=[[S.POSITION,i.indices]],t=[[S.POSITION,{size:3,data:i.attributeData.position,exclusive:!0}]];return y(i.attributeData.color)&&(t.push([S.COLOR,{size:4,data:i.attributeData.color,exclusive:!0}]),e.push([S.COLOR,new Array(i.indices.length).fill(0)])),y(i.attributeData.uvMapSpace)&&(t.push([S.UVMAPSPACE,{size:4,data:i.attributeData.uvMapSpace,exclusive:!0}]),e.push([S.UVMAPSPACE,i.indices])),y(i.attributeData.boundingRect)&&(t.push([S.BOUNDINGRECT,{size:9,data:i.attributeData.boundingRect,exclusive:!0}]),e.push([S.BOUNDINGRECT,i.indices])),y(i.attributeData.mapPosition)&&(t.push([S.MAPPOS,{size:3,data:i.attributeData.mapPosition,exclusive:!0}]),e.push([S.MAPPOS,i.indices])),new jr(t,e,Fc.Triangle,i.attributeData.objectAndLayerIdColor)}function l8(i){const e=[[S.POSITION,i.indices],[S.UV0,i.indices]],t=[[S.POSITION,{size:3,data:i.attributeData.position,exclusive:!0}],[S.UV0,{size:2,data:i.attributeData.uv0,exclusive:!0}]];return y(i.attributeData.mapPosition)&&(t.push([S.MAPPOS,{size:3,data:i.attributeData.mapPosition,exclusive:!0}]),e.push([S.MAPPOS,i.indices])),new jr(t,e)}function bx(i){switch(i.type){case"extent":if(i instanceof pi)return jm.fromExtent(i);break;case"polygon":return i}return null}let zP=class{constructor(e,t,r){this.renderData=e,this.layerUid=t,this.graphicsUid=r,this.outGeometries=new Array,this.outMaterials=new Array,this.outTransforms=new Array}};var nw,l$;(function(i){i[i.RasterImage=0]="RasterImage",i[i.Features=1]="Features"})(nw||(nw={})),function(i){i[i.WithRasterImage=0]="WithRasterImage",i[i.WithoutRasterImage=1]="WithoutRasterImage"}(l$||(l$={}));var ki,Pl,qe,sw,er,fn,xs;(function(i){i[i.INNER=0]="INNER",i[i.OUTER=1]="OUTER"})(ki||(ki={})),function(i){i[i.REGULAR=0]="REGULAR",i[i.HAS_NORTH_POLE=1]="HAS_NORTH_POLE",i[i.HAS_SOUTH_POLE=2]="HAS_SOUTH_POLE",i[i.HAS_BOTH_POLES=3]="HAS_BOTH_POLES"}(Pl||(Pl={})),function(i){i[i.NORTH=0]="NORTH",i[i.NORTH_EAST=1]="NORTH_EAST",i[i.EAST=2]="EAST",i[i.SOUTH_EAST=3]="SOUTH_EAST",i[i.SOUTH=4]="SOUTH",i[i.SOUTH_WEST=5]="SOUTH_WEST",i[i.WEST=6]="WEST",i[i.NORTH_WEST=7]="NORTH_WEST"}(qe||(qe={})),function(i){i[i.OFF=0]="OFF",i[i.ON=1]="ON"}(sw||(sw={})),function(i){i[i.Color=0]="Color",i[i.ColorNoRasterImage=1]="ColorNoRasterImage",i[i.Highlight=2]="Highlight",i[i.Water=3]="Water",i[i.Occluded=4]="Occluded",i[i.ObjectAndLayerIdColor=5]="ObjectAndLayerIdColor"}(er||(er={})),function(i){i[i.FADING=0]="FADING",i[i.IMMEDIATE=1]="IMMEDIATE",i[i.UNFADED=2]="UNFADED"}(fn||(fn={})),function(i){i[i.INSIDE=0]="INSIDE",i[i.INTERSECTS=1]="INTERSECTS",i[i.OUTSIDE=2]="OUTSIDE"}(xs||(xs={}));let ICe=class{constructor(e,t){this.vec3=e,this.id=t}};function aw(i,e,t,r){return new ICe(Ze(i,e,t),r)}var Zn;(function(i){i[i.None=0]="None",i[i.ColorAndWater=1]="ColorAndWater",i[i.Highlight=2]="Highlight",i[i.Occluded=3]="Occluded",i[i.ObjectAndLayerIdColor=4]="ObjectAndLayerIdColor"})(Zn||(Zn={}));let c8=class{constructor(e,t){this.index=e,this.renderTargets=t,this._extent=Nt(),this.resolution=0,this.renderLocalOrigin=aw(0,0,0,"O"),this.pixelRatio=1,this.mapUnitsPerPixel=1,this.canvasGeometries=new $Ce,this.validTargets=null,this.hasDrapedFeatureSource=!1,this.hasDrapedRasterSource=!1,this.hasTargetWithoutRasterImage=!1,this.index=e,this.validTargets=new Array(t.renderTargets.length).fill(!1)}get extent(){return this._extent}getValidTexture(e){return this.validTargets[e]?this.renderTargets.getTarget(e).getTexture():null}get _needsColorWithoutRasterImage(){return this.hasDrapedRasterSource&&this.hasDrapedFeatureSource&&this.hasTargetWithoutRasterImage}getColorTexture(e){const t=e===Zn.ColorAndWater?this.renderTargets.getTarget(er.Color):e===Zn.Highlight?this.renderTargets.getTarget(er.Highlight):e===Zn.ObjectAndLayerIdColor?this.renderTargets.getTarget(er.ObjectAndLayerIdColor):this.renderTargets.getTarget(er.Occluded);return t?t.getTexture():null}getColorTextureNoRasterImage(){return this._needsColorWithoutRasterImage?this.getValidTexture(er.ColorNoRasterImage):this.hasDrapedFeatureSource?this.getValidTexture(er.Color):null}getNormalTexture(e){const t=e===Zn.ColorAndWater?this.renderTargets.getTarget(er.Water):null;return t?t.getTexture():null}draw(e,t){const r=this.computeRenderTargetValidityBitfield();for(const n of this.renderTargets.renderTargets)n.type!==er.ColorNoRasterImage||this._needsColorWithoutRasterImage?this.validTargets[n.type]=e.drawTarget(this,n,t):this.validTargets[n.type]=!1;return r^this.computeRenderTargetValidityBitfield()?XE.CHANGED:XE.UNCHANGED}computeRenderTargetValidityBitfield(){const e=this.validTargets;return+e[er.Color]|+e[er.ColorNoRasterImage]<<1|+e[er.Highlight]<<2|+e[er.Water]<<3|+e[er.Occluded]<<4}setupGeometryViewsCyclical(e){this.setupGeometryViewsDirect();const t=.001*e.range;if(this._extent[0]-t<=e.min){const r=this.canvasGeometries.extents[this.canvasGeometries.numViews++];GE(this._extent,e.range,0,r)}if(this._extent[2]+t>=e.max){const r=this.canvasGeometries.extents[this.canvasGeometries.numViews++];GE(this._extent,-e.range,0,r)}}setupGeometryViewsDirect(){this.canvasGeometries.numViews=1,xw(this.canvasGeometries.extents[0],this._extent)}hasSomeSizedView(){for(let e=0;e<this.canvasGeometries.numViews;e++){const t=this.canvasGeometries.extents[e];if(t[0]!==t[2]&&t[1]!==t[3])return!0}return!1}applyViewport(e){e.setViewport(this.index===ki.INNER?0:this.resolution,0,this.resolution,this.resolution)}};function LCe(i,e,t){return Math.min(lD(Math.max(i,e)+256),t)}let $Ce=class{constructor(){this.extents=[Nt(),Nt(),Nt()],this.numViews=0}},nK=class{constructor(e,t){this._size=wre(),this._fbo=null,this._fbo=new yn(e,{colorTarget:Vn.TEXTURE,depthStencilTarget:rs.NONE},{target:bi.TEXTURE_2D,pixelFormat:St.RGBA,dataType:Xt.UNSIGNED_BYTE,wrapMode:ai.CLAMP_TO_EDGE,samplingMode:Jt.LINEAR_MIPMAP_LINEAR,hasMipmap:t,maxAnisotropy:8,width:0,height:0})}dispose(){this._fbo=ke(this._fbo)}getTexture(){return this._fbo?this._fbo.colorTexture:null}isValid(){return this._fbo!==null}resize(e,t){this._size[0]=e,this._size[1]=t,this._fbo.resize(this._size[0],this._size[1])}bind(e){e.bindFramebuffer(this._fbo)}generateMipMap(){const e=this._fbo.colorTexture;e.descriptor.hasMipmap&&e.generateMipmap()}disposeRenderTargetMemory(){var e;(e=this._fbo)==null||e.resize(0,0)}get gpuMemoryUsage(){var e;return((e=this._fbo)==null?void 0:e.gpuMemoryUsage)??0}},z_=class{constructor(e,t,r,n=!0){this.output=t,this.type=r,this.valid=!1,this.lastUsed=1/0,this.fbo=new nK(e,n)}},DCe=class{constructor(e){this.renderTargets=[new z_(e,V.Color,er.Color),new z_(e,V.Color,er.ColorNoRasterImage),new z_(e,V.Highlight,er.Highlight,!1),new z_(e,V.Normal,er.Water),new z_(e,V.Color,er.Occluded)],Ot("enable-feature:objectAndLayerId-rendering")&&this.renderTargets.push(new z_(e,V.ObjectAndLayerIdColor,er.ObjectAndLayerIdColor))}getTarget(e){return this.renderTargets[e].fbo}dispose(){for(const e of this.renderTargets)e.fbo.dispose()}disposeRenderTargetMemory(){for(const e of this.renderTargets)e.fbo.disposeRenderTargetMemory()}validateUsageForTarget(e,t,r){if(e)t.lastUsed=r;else if(r-t.lastUsed>FCe)t.fbo.disposeRenderTargetMemory(),t.lastUsed=1/0;else if(t.lastUsed<1/0)return!0;return!1}get gpuMemoryUsage(){return this.renderTargets.reduce((e,t)=>e+t.fbo.gpuMemoryUsage,0)}};const FCe=1e3;let O4=class{constructor(){this._outer=new Map}clear(){this._outer.clear()}get empty(){return this._outer.size===0}get(e,t){var r;return(r=this._outer.get(e))==null?void 0:r.get(t)}set(e,t,r){const n=this._outer.get(e);n?n.set(t,r):this._outer.set(e,new Map([[t,r]]))}delete(e,t){const r=this._outer.get(e);r&&(r.delete(t),r.size===0&&this._outer.delete(e))}forEach(e){this._outer.forEach((t,r)=>e(t,r))}},sK=class{constructor(e){this._context=e,this._perConstructorInstances=new O4,this._frameCounter=0,this._keepAliveFrameCount=h8}get viewingMode(){return this._context.viewingMode}get constructionContext(){return this._context}dispose(){this._perConstructorInstances.forEach(e=>e.forEach(t=>t.technique.destroy())),this._perConstructorInstances.clear()}acquire(e,t=kCe){const r=t.key;let n=this._perConstructorInstances.get(e,r);if(C(n)){const s=new e(this._context,t,()=>this.release(s));n=new NCe(s),this._perConstructorInstances.set(e,r,n)}return++n.refCount,n.technique}releaseAndAcquire(e,t,r){if(y(r)){if(t.key===r.key)return r;this.release(r)}return this.acquire(e,t)}release(e){if(C(e)||this._perConstructorInstances.empty)return;const t=this._perConstructorInstances.get(e.constructor,e.key);C(t)||(--t.refCount,t.refCount===0&&(t.refZeroFrame=this._frameCounter))}frameUpdate(){this._frameCounter++,this._keepAliveFrameCount!==h8&&this._perConstructorInstances.forEach((e,t)=>{e.forEach((r,n)=>{r.refCount===0&&r.refZeroFrame+this._keepAliveFrameCount<this._frameCounter&&(r.technique.destroy(),this._perConstructorInstances.delete(t,n))})})}async reloadAll(){const e=new Array;this._perConstructorInstances.forEach((t,r)=>{const n=async(s,a)=>{const o=a.shader;o&&(await o.reload(),s.forEach(l=>l.technique.reload(this._context)))};e.push(n(t,r))}),await Promise.all(e)}},NCe=class{constructor(e){this.technique=e,this.refCount=0,this.refZeroFrame=0}};const h8=-1,kCe=new $a,BP=i=>{class e extends i{constructor(){super(...arguments),this._isDisposed=!1}dispose(){for(const r of this._managedDisposables??[]){const n=this[r];this[r]=null,n&&typeof n.dispose=="function"&&n.dispose()}this._isDisposed=!0}get isDisposed(){return this._isDisposed}}return e};let GP=class extends BP(class{}){};function Yn(){return(i,e)=>{var t,r;i.hasOwnProperty("_managedDisposables")||(i._managedDisposables=((t=i._managedDisposables)==null?void 0:t.slice())??[]),(r=i._managedDisposables)==null||r.unshift(e)}}let aK=class{constructor(e,t,r,n){this._textureRepository=e,this._techniqueRepository=t,this.materialChanged=r,this.requestRender=n,this._id2glMaterialRef=new O4}dispose(){this._textureRepository.dispose()}acquire(e,t,r){if(this._ownMaterial(e),!e.requiresSlot(t,r))return null;let n=this._id2glMaterialRef.get(r,e.id);if(C(n)){const s=e.createGLMaterial({material:e,techniqueRep:this._techniqueRepository,textureRep:this._textureRepository,output:r});n=new VCe(s),this._id2glMaterialRef.set(r,e.id,n)}return n.ref(),n.glMaterial}release(e,t){const r=this._id2glMaterialRef.get(t,e.id);y(r)&&(r.unref(),r.referenced||(ke(r.glMaterial),this._id2glMaterialRef.delete(t,e.id)))}_ownMaterial(e){y(e.repository)&&e.repository!==this&&ee.getLogger("esri.views.3d.webgl-engine.lib.GLMaterialRepository").error("Material is already owned by a different material repository"),e.repository=this}},VCe=class{constructor(e){this.glMaterial=e,this._refCnt=0}ref(){++this._refCnt}unref(){--this._refCnt,ct(this._refCnt>=0)}get referenced(){return this._refCnt>0}};const UCe={orderedRepackingEnabled:!1},zCe={rootOrigin:null},BCe=["layerObjectAdded","layerObjectRemoved","layerObjectsAdded","layerObjectsRemoved","shaderTransformationChanged","objectTransformation","visibilityChanged","occlusionChanged","highlightChanged","objectGeometryAdded","objectGeometryRemoved","vertexAttrsUpdated"];let oK=class extends ZG{constructor(e,t=""){super(),this.apiLayerUid=t,this.type=vv.Layer,this.events=new nn,this.isSliceable=!1,this._objects=new Yt,this._stageHandles=new Vt,this.apiLayerUid=t,this.isVisible=(e==null?void 0:e.isVisible)??!0,this.isPickable=(e==null?void 0:e.isPickable)??!0,this.updatePolicy=(e==null?void 0:e.updatePolicy)??QE.ASYNC}get objects(){return this._objects}destroy(){this.detachStage(),this._stage=null}attachStage(e){this.detachStage(),this._stage=e;for(const t of BCe)this._stageHandles.add(this.events.on(t,r=>e.handleEvent(t,r)))}detachStage(){this._stageHandles.removeAll(),this.invalidateSpatialQueryAccelerator()}add(e){this._objects.push(e),e.parentLayer=this,this.events.emit("layerObjectAdded",{layer:this,object:e}),y(this._octree)&&this._octree.add([e])}remove(e){this._objects.removeUnordered(e)&&(e.parentLayer=null,this.events.emit("layerObjectRemoved",{layer:this,object:e}),y(this._octree)&&this._octree.remove([e]))}addMany(e){this._objects.pushArray(e);for(const t of e)t.parentLayer=this;this.events.emit("layerObjectsAdded",{layer:this,objects:e}),y(this._octree)&&this._octree.add(e)}removeMany(e){const t=new Array;if(this._objects.removeUnorderedMany(e,e.length,t),t.length!==0){for(const r of t)r.parentLayer=null;this.events.emit("layerObjectsRemoved",{layer:this,objects:t}),y(this._octree)&&this._octree.remove(t)}}sync(){y(this._stage)&&this.updatePolicy!==QE.SYNC&&this._stage.syncLayer(this.id)}notifyObjectBBChanged(e,t){y(this._octree)&&this._octree.update(e,t)}getSpatialQueryAccelerator(){return C(this._octree)&&this._objects.length>50&&this._createOctree(),this._octree}shaderTransformationChanged(){this.invalidateSpatialQueryAccelerator(),this.events.emit("shaderTransformationChanged",this)}invalidateSpatialQueryAccelerator(){this._octree=Oe(this._octree)}_createOctree(){this._octree=new Mc(e=>e.boundingVolumeWorldSpace.bounds),this._octree.add(this._objects.data,this._objects.length)}};function uR(i){return y(i)&&i.type===vv.Layer}const lK=new Map([[S.POSITION,0],[S.SUBDIVISIONFACTOR,1],[S.UV0,2],[S.AUXPOS1,3],[S.AUXPOS2,4],[S.COLOR,5],[S.COLORFEATUREATTRIBUTE,5],[S.SIZE,6],[S.SIZEFEATUREATTRIBUTE,6],[S.OPACITYFEATUREATTRIBUTE,7],[S.OBJECTANDLAYERIDCOLOR,8]]);let cK=class hK extends ii{initializeProgram(e){return new ei(e.rctx,hK.shader.get().build(this.configuration),lK)}_makePipelineState(e,t){const r=this.configuration,n=e===qt.NONE,s=e===qt.FrontFace;return it({blending:r.output===V.Color||r.output===V.Alpha?n?Hl:qm(e):null,depthTest:{func:n_(e)},depthWrite:n?r.writeDepth&&nl:BR(e),colorWrite:gt,stencilWrite:r.hasOccludees?Cd:null,stencilTest:r.hasOccludees?t?$g:s_:null,polygonOffset:n||s?r.hasPolygonOffset&&u8:jD})}initializePipeline(){const e=this.configuration;if(e.occluder){const t=e.hasPolygonOffset&&u8;this._occluderPipelineTransparent=it({blending:Hl,polygonOffset:t,depthTest:WE,depthWrite:null,colorWrite:gt,stencilWrite:null,stencilTest:uH}),this._occluderPipelineOpaque=it({blending:Hl,polygonOffset:t,depthTest:WE,depthWrite:null,colorWrite:gt,stencilWrite:dH,stencilTest:pH}),this._occluderPipelineMaskWrite=it({blending:null,polygonOffset:t,depthTest:qD,depthWrite:null,colorWrite:null,stencilWrite:Cd,stencilTest:$g})}return this._occludeePipelineState=this._makePipelineState(this.configuration.transparencyPassType,!0),this._makePipelineState(this.configuration.transparencyPassType,!1)}get primitiveType(){return this.configuration.wireframe?kt.LINES:kt.TRIANGLE_STRIP}getPipelineState(e,t){return t?this._occludeePipelineState:this.configuration.occluder?e===le.TRANSPARENT_OCCLUDER_MATERIAL?this._occluderPipelineTransparent:e===le.OCCLUDER_MATERIAL?this._occluderPipelineOpaque:this._occluderPipelineMaskWrite:super.getPipelineState(e,t)}};cK.shader=new ri(xae,()=>j(()=>import("./RibbonLine.glsl-7b33496e.js"),["assets/RibbonLine.glsl-7b33496e.js","assets/Matrix3PassUniform-ad9f953b.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/mat3f64-c6305894.js","assets/mat4f64-1e28eae0.js","assets/vec3f32-c9aa289f.js","assets/vec3f64-2f9cef06.js","assets/VertexAttribute-9c5c630d.js","assets/mat4-44a0988f.js","assets/common-c186b691.js","assets/vec3-e93e648f.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/mathUtils-b4bb77e2.js","assets/vec4-790471c0.js","assets/context-util-a4ce3a7b.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/promiseUtils-1e54421e.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/aaBoundingBox-657a9b82.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/aaBoundingRect-193543b5.js","assets/basicInterfaces-19ed850e.js","assets/ViewingMode-5d7d590b.js","assets/Util-a48361c6.js","assets/vec2f64-30dc1443.js","assets/vec4f64-e407da96.js","assets/LineStipple.glsl-ed22a88b.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/Texture2DPassUniform-753de459.js","assets/vec2-528adfe4.js","assets/Float4PassUniform-d7bdbc81.js","assets/FloatPassUniform-68d54f51.js","assets/floatRGBA-9ad35d39.js","assets/Texture-46c8c2cb.js","assets/compilerUtils-18d58939.js","assets/Evented-a45c8b0f.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/ScreenSpacePass-d5e48a9b.js","assets/assets-8d3e737a.js","assets/MarkerSizing.glsl-566261cc.js","assets/sdfPrimitives-9858c36d.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/TransparencyPassType-a11868d2.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Slice.glsl-3b39b1f7.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/PiUtils.glsl-db6418ee.js","assets/AlphaCutoff-96178e0d.js"]));const u8={factor:0,units:-4};var Ja;(function(i){i[i.LEFT_JOIN_START=-2]="LEFT_JOIN_START",i[i.LEFT_JOIN_END=-1]="LEFT_JOIN_END",i[i.LEFT_CAP_START=-4]="LEFT_CAP_START",i[i.LEFT_CAP_END=-5]="LEFT_CAP_END",i[i.RIGHT_JOIN_START=2]="RIGHT_JOIN_START",i[i.RIGHT_JOIN_END=1]="RIGHT_JOIN_END",i[i.RIGHT_CAP_START=4]="RIGHT_CAP_START",i[i.RIGHT_CAP_END=5]="RIGHT_CAP_END"})(Ja||(Ja={}));let v0=class extends Fd{constructor(e){super(e,new HCe),this._configuration=new Tae,this._vertexAttributeLocations=lK,this._layout=this.createLayout()}isClosed(e,t){return uK(this.parameters,e,t)}getConfiguration(e,t){this._configuration.output=e,this._configuration.draped=t.slot===le.DRAPED_MATERIAL;const r=y(this.parameters.stipplePattern)&&e!==V.Highlight;return this._configuration.stippleEnabled=r,this._configuration.stippleOffColorEnabled=r&&y(this.parameters.stippleOffColor),this._configuration.stippleScaleWithLineWidth=r&&this.parameters.stippleScaleWithLineWidth,this._configuration.stipplePreferContinuous=r&&this.parameters.stipplePreferContinuous,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.hasOccludees=this.parameters.hasOccludees,this._configuration.roundJoins=this.parameters.join==="round",this._configuration.capType=this.parameters.cap,this._configuration.applyMarkerOffset=!!y(this.parameters.markerParameters)&&qCe(this.parameters.markerParameters),this._configuration.hasPolygonOffset=this.parameters.hasPolygonOffset,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.vvColor=this.parameters.vvColorEnabled,this._configuration.vvOpacity=this.parameters.vvOpacityEnabled,this._configuration.vvSize=this.parameters.vvSizeEnabled,this._configuration.innerColorEnabled=this.parameters.innerWidth>0&&y(this.parameters.innerColor),this._configuration.falloffEnabled=this.parameters.falloff>0,this._configuration.occluder=this.parameters.renderOccluded===cr.OccludeAndTransparentStencil,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration.hasMultipassTerrain=t.multipassTerrain.enabled,this._configuration.cullAboveGround=t.multipassTerrain.cullAboveGround,this._configuration.wireframe=this.parameters.wireframe,this._configuration}intersect(e,t,r,n,s,a,o,l,c){y(c)?this._intersectDrapedLineGeometry(e,n,c,a,o):this._intersectLineGeometry(e,t,r,n,o)}_intersectDrapedLineGeometry(e,t,r,n,s){if(!t.options.selectionMode)return;const a=e.vertexAttributes.get(S.POSITION).data,o=e.vertexAttributes.get(S.SIZE);let l=this.parameters.width;if(this.parameters.vvSizeEnabled){const _=e.vertexAttributes.get(S.SIZEFEATUREATTRIBUTE).data[0];l*=ue(this.parameters.vvSizeOffset[0]+_*this.parameters.vvSizeFactor[0],this.parameters.vvSizeMinSize[0],this.parameters.vvSizeMaxSize[0])}else o&&(l*=o.data[0]);const c=n[0],u=n[1],d=(l/2+4)*e.screenToWorldRatio;let m=Number.MAX_VALUE,f=0;for(let _=0;_<a.length-5;_+=3){const g=a[_],w=a[_+1],v=c-g,b=u-w,x=a[_+3]-g,T=a[_+4]-w,R=ue((x*v+T*b)/(x*x+T*T),0,1),E=x*R-v,O=T*R-b,$=E*E+O*O;$<m&&(m=$,f=_/3)}m<d*d&&s(r.dist,r.normal,f,!1)}_intersectLineGeometry(e,t,r,n,s){if(!n.options.selectionMode||UR(t))return;if(!fH(r))return void ee.getLogger("esri.views.3d.webgl-engine.materials.RibbonLineMaterial").error("intersection assumes a translation-only matrix");const a=e.vertexAttributes,o=a.get(S.POSITION).data;let l=this.parameters.width;if(this.parameters.vvSizeEnabled){const v=a.get(S.SIZEFEATUREATTRIBUTE).data[0];l*=ue(this.parameters.vvSizeOffset[0]+v*this.parameters.vvSizeFactor[0],this.parameters.vvSizeMinSize[0],this.parameters.vvSizeMaxSize[0])}else a.has(S.SIZE)&&(l*=a.get(S.SIZE).data[0]);const c=n.camera,u=WCe;wn(u,n.point);const d=l*c.pixelRatio/2+4*c.pixelRatio;Y(g1[0],u[0]-d,u[1]+d,0),Y(g1[1],u[0]+d,u[1]+d,0),Y(g1[2],u[0]+d,u[1]-d,0),Y(g1[3],u[0]-d,u[1]-d,0);for(let v=0;v<4;v++)if(!c.unprojectFromRenderScreen(g1[v],Tu[v]))return;Bh(c.eye,Tu[0],Tu[1],hM),Bh(c.eye,Tu[1],Tu[2],uM),Bh(c.eye,Tu[2],Tu[3],dM),Bh(c.eye,Tu[3],Tu[0],pM);let m=Number.MAX_VALUE,f=0;const _=c$(this.parameters,a,e.indices)?o.length-2:o.length-5;for(let v=0;v<_;v+=3){na[0]=o[v]+r[12],na[1]=o[v+1]+r[13],na[2]=o[v+2]+r[14];const b=(v+3)%o.length;if(sa[0]=o[b]+r[12],sa[1]=o[b+1]+r[13],sa[2]=o[b+2]+r[14],tr(hM,na)<0&&tr(hM,sa)<0||tr(uM,na)<0&&tr(uM,sa)<0||tr(dM,na)<0&&tr(dM,sa)<0||tr(pM,na)<0&&tr(pM,sa)<0)continue;if(c.projectToRenderScreen(na,hf),c.projectToRenderScreen(sa,uf),hf[2]<0&&uf[2]>0){ae(ih,na,sa);const T=c.frustum,R=-tr(T[hr.NEAR],na)/_e(ih,Ia(T[hr.NEAR]));Q(ih,ih,R),ce(na,na,ih),c.projectToRenderScreen(na,hf)}else if(hf[2]>0&&uf[2]<0){ae(ih,sa,na);const T=c.frustum,R=-tr(T[hr.NEAR],sa)/_e(ih,Ia(T[hr.NEAR]));Q(ih,ih,R),ce(sa,sa,ih),c.projectToRenderScreen(sa,uf)}else if(hf[2]<0&&uf[2]<0)continue;hf[2]=0,uf[2]=0;const x=ID(gg(hf,uf,m8),u);x<m&&(m=x,X(d8,na),X(p8,sa),f=v/3)}const g=n.rayBegin,w=n.rayEnd;if(m<d*d){let v=Number.MAX_VALUE;if(DG(gg(d8,p8,m8),gg(g,w,XCe),cf)){ae(cf,cf,g);const b=we(cf);Q(cf,cf,1/b),v=b/Li(g,w)}s(v,cf,f,!1)}}computeAttachmentOrigin(e,t){const r=e.vertexAttributes;if(!r)return!1;const n=e.indices,s=r.get(S.POSITION);return WD(s,n?n.get(S.POSITION):null,n&&c$(this.parameters,r,n),t)}createLayout(){const e=sn().vec3f(S.POSITION).f32(S.SUBDIVISIONFACTOR).vec2f(S.UV0).vec3f(S.AUXPOS1).vec3f(S.AUXPOS2);return this.parameters.vvSizeEnabled?e.f32(S.SIZEFEATUREATTRIBUTE):e.f32(S.SIZE),this.parameters.vvColorEnabled?e.f32(S.COLORFEATUREATTRIBUTE):e.vec4f(S.COLOR),this.parameters.vvOpacityEnabled&&e.f32(S.OPACITYFEATUREATTRIBUTE),Ot("enable-feature:objectAndLayerId-rendering")&&e.vec4u8(S.OBJECTANDLAYERIDCOLOR),e}createBufferWriter(){return new jCe(this._layout,this.parameters)}requiresSlot(e,t){return t===V.Color||t===V.Alpha||t===V.Highlight||t===V.Depth||t===V.ObjectAndLayerIdColor?e===le.DRAPED_MATERIAL?!0:this.parameters.renderOccluded===cr.OccludeAndTransparentStencil?e===le.OPAQUE_MATERIAL||e===le.OCCLUDER_MATERIAL||e===le.TRANSPARENT_OCCLUDER_MATERIAL:t===V.Color||t===V.Alpha?e===(this.parameters.writeDepth?le.TRANSPARENT_MATERIAL:le.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL):e===le.OPAQUE_MATERIAL:!1}createGLMaterial(e){return new GCe(e)}validateParameters(e){e.join!=="miter"&&(e.miterLimit=0),y(e.markerParameters)&&(e.markerScale=e.markerParameters.width/e.width)}},GCe=class extends r_{constructor(){super(...arguments),this._stipplePattern=null}dispose(){super.dispose(),this._stippleTextureRepository.release(this._stipplePattern),this._stipplePattern=null}_updateOccludeeState(e){e.hasOccludees!==this._material.parameters.hasOccludees&&this._material.setParameters({hasOccludees:e.hasOccludees})}beginSlot(e){this._output!==V.Color&&this._output!==V.Alpha||this._updateOccludeeState(e);const t=this._material.parameters.stipplePattern;return this._stipplePattern!==t&&(this._material.setParameters(this._stippleTextureRepository.swap(this._stipplePattern,t)),this._stipplePattern=t),this.ensureTechnique(cK,e)}},HCe=class extends YG{constructor(){super(...arguments),this.width=0,this.color=Pc,this.join="miter",this.cap=E0.BUTT,this.miterLimit=5,this.writeDepth=!0,this.hasPolygonOffset=!1,this.stippleTexture=null,this.stippleScaleWithLineWidth=!1,this.stipplePreferContinuous=!0,this.markerParameters=null,this.markerScale=1,this.hasSlicePlane=!1,this.vvFastUpdate=!1,this.isClosed=!1,this.falloff=0,this.innerWidth=0,this.hasOccludees=!1,this.wireframe=!1}},jCe=class{constructor(e,t){this._parameters=t,this.numJoinSubdivisions=0,this.vertexBufferLayout=e;const r=t.stipplePattern?1:0;switch(this._parameters.join){case"miter":case"bevel":this.numJoinSubdivisions=r;break;case"round":this.numJoinSubdivisions=Cae+r}}_isClosed(e){return c$(this._parameters,e.vertexAttributes,e.indices)}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){const r=e.indices.get(S.POSITION).length/2+1,n=this._isClosed(e);let s=n?2:2*2;return s+=((n?r:r-1)-(n?0:1))*(2*this.numJoinSubdivisions+4),s+=2,this._parameters.wireframe&&(s=2+4*(s-2)),s}write(e,t,r,n,s){var te;const a=QCe,o=ZCe,l=YCe,c=r.vertexAttributes.get(S.POSITION).data,u=r.indices&&r.indices.get(S.POSITION),d=(te=r.vertexAttributes.get(S.DISTANCETOSTART))==null?void 0:te.data;u&&u.length!==2*(c.length/3-1)&&console.warn("RibbonLineMaterial does not support indices");let m=1,f=0;this._parameters.vvSizeEnabled?f=r.vertexAttributes.get(S.SIZEFEATUREATTRIBUTE).data[0]:r.vertexAttributes.has(S.SIZE)&&(m=r.vertexAttributes.get(S.SIZE).data[0]);let _=[1,1,1,1],g=0;this._parameters.vvColorEnabled?g=r.vertexAttributes.get(S.COLORFEATUREATTRIBUTE).data[0]:r.vertexAttributes.has(S.COLOR)&&(_=r.vertexAttributes.get(S.COLOR).data);let w=null;Ot("enable-feature:objectAndLayerId-rendering")&&(w=r.objectAndLayerIdColor);let v=0;this._parameters.vvOpacityEnabled&&(v=r.vertexAttributes.get(S.OPACITYFEATUREATTRIBUTE).data[0]);const b=c.length/3,x=new Float32Array(n.buffer),T=Ot("enable-feature:objectAndLayerId-rendering")?new Uint8Array(n.buffer):null,R=this.vertexBufferLayout.stride/4;let E=s*R;const O=E;let $=0;const D=d?(H,M,U)=>$=d[U]:(H,M,U)=>$+=Li(H,M),I=(H,M,U,L,z,q,K)=>{if(x[E++]=M[0],x[E++]=M[1],x[E++]=M[2],x[E++]=L,x[E++]=K,x[E++]=z,x[E++]=H[0],x[E++]=H[1],x[E++]=H[2],x[E++]=U[0],x[E++]=U[1],x[E++]=U[2],this._parameters.vvSizeEnabled?x[E++]=f:x[E++]=m,this._parameters.vvColorEnabled)x[E++]=g;else{const ie=Math.min(4*q,_.length-4);x[E++]=_[ie+0],x[E++]=_[ie+1],x[E++]=_[ie+2],x[E++]=_[ie+3]}this._parameters.vvOpacityEnabled&&(x[E++]=v),Ot("enable-feature:objectAndLayerId-rendering")&&(y(w)&&(T[4*E+0]=w[0],T[4*E+1]=w[1],T[4*E+2]=w[2],T[4*E+3]=w[3]),E++)};E+=R,Y(o,c[0],c[1],c[2]),e&&Me(o,o,e);const G=this._isClosed(r);if(G){const H=c.length-3;Y(a,c[H],c[H+1],c[H+2]),e&&Me(a,a,e)}else Y(l,c[3],c[4],c[5]),e&&Me(l,l,e),I(o,o,l,1,Ja.LEFT_CAP_START,0,0),I(o,o,l,1,Ja.RIGHT_CAP_START,0,0),X(a,o),X(o,l);const W=G?0:1,re=G?b:b-1;for(let H=W;H<re;H++){const M=(H+1)%b*3;Y(l,c[M+0],c[M+1],c[M+2]),e&&Me(l,l,e),D(a,o,H),I(a,o,l,0,Ja.LEFT_JOIN_END,H,$),I(a,o,l,0,Ja.RIGHT_JOIN_END,H,$);const U=this.numJoinSubdivisions;for(let L=0;L<U;++L){const z=(L+1)/(U+1);I(a,o,l,z,Ja.LEFT_JOIN_END,H,$),I(a,o,l,z,Ja.RIGHT_JOIN_END,H,$)}I(a,o,l,1,Ja.LEFT_JOIN_START,H,$),I(a,o,l,1,Ja.RIGHT_JOIN_START,H,$),X(a,o),X(o,l)}G?(Y(l,c[3],c[4],c[5]),e&&Me(l,l,e),$=D(a,o,re),I(a,o,l,0,Ja.LEFT_JOIN_END,W,$),I(a,o,l,0,Ja.RIGHT_JOIN_END,W,$)):($=D(a,o,re),I(a,o,o,0,Ja.LEFT_CAP_END,re,$),I(a,o,o,0,Ja.RIGHT_CAP_END,re,$)),cM(x,O+R,x,O,R),E=cM(x,E-R,x,E,R),this._parameters.wireframe&&this._addWireframeVertices(n,O,E,R)}_addWireframeVertices(e,t,r,n){const s=new Float32Array(e.buffer,r*Float32Array.BYTES_PER_ELEMENT),a=new Float32Array(e.buffer,t*Float32Array.BYTES_PER_ELEMENT,r-t);let o=0;const l=c=>o=cM(a,c,s,o,n);for(let c=0;c<a.length-1;c+=2*n)l(c),l(c+2*n),l(c+1*n),l(c+2*n),l(c+1*n),l(c+3*n)}};function cM(i,e,t,r,n){for(let s=0;s<n;s++)t[r++]=i[e++];return r}function c$(i,e,t){return uK(i,e.get(S.POSITION).data,t?t.get(S.POSITION):null)}function uK(i,e,t){return!!i.isClosed&&(t?t.length>2:e.length>6)}function qCe(i){return i.anchor===AH.Tip&&i.hideOnShortSegments&&i.placement==="begin-end"&&i.worldSpace}const na=P(),sa=P(),ih=P(),cf=P(),WCe=P(),hf=is(),uf=is(),d8=P(),p8=P(),m8=yv(),XCe=yv(),QCe=P(),ZCe=P(),YCe=P(),g1=[is(),is(),is(),is()],Tu=[P(),P(),P(),P()],hM=fr(),uM=fr(),dM=fr(),pM=fr();let M4=class{constructor(e){this._originSR=e,this._origins=new Map,this._objects=new Map,this._gridSize=5e5,this._rootOriginId="root/"+Sm()}getOrigin(e){const t=this._origins.get(this._rootOriginId);if(t==null){const u=zCe.rootOrigin;if(y(u))return this._origins.set(this._rootOriginId,aw(u[0],u[1],u[2],this._rootOriginId)),this.getOrigin(e);const d=aw(e[0]+Math.random()-.5,e[1]+Math.random()-.5,e[2]+Math.random()-.5,this._rootOriginId);return this._origins.set(this._rootOriginId,d),d}const r=this._gridSize,n=Math.round(e[0]/r),s=Math.round(e[1]/r),a=Math.round(e[2]/r),o=`${n}/${s}/${a}`;let l=this._origins.get(o);const c=.5*r;if(ae(Cn,e,t.vec3),Cn[0]=Math.abs(Cn[0]),Cn[1]=Math.abs(Cn[1]),Cn[2]=Math.abs(Cn[2]),Cn[0]<c&&Cn[1]<c&&Cn[2]<c){if(l){const u=Math.max(...Cn);if(ae(Cn,e,l.vec3),Cn[0]=Math.abs(Cn[0]),Cn[1]=Math.abs(Cn[1]),Cn[2]=Math.abs(Cn[2]),Math.max(...Cn)<u)return l}return t}return l||(l=aw(n*r,s*r,a*r,o),this._origins.set(o,l)),l}_drawOriginBox(e,t=Bi(1,1,0,1)){const r=window.view,n=r._stage,s=t.toString();if(!this._objects.has(s)){this._material=new v0({width:2,color:t}),n.add(this._material);const f=new oK({isPickable:!1}),_=new Bd({castShadow:!1});n.add(_),f.add(_),n.add(f),this._objects.set(s,_)}const a=this._objects.get(s),o=[0,1,5,4,0,2,1,7,6,2,0,1,3,7,5,4,6,2,0],l=o.length,c=new Array(3*l),u=new Array,d=.5*this._gridSize;for(let f=0;f<l;f++)c[3*f+0]=e[0]+(1&o[f]?d:-d),c[3*f+1]=e[1]+(2&o[f]?d:-d),c[3*f+2]=e[2]+(4&o[f]?d:-d),f>0&&u.push(f-1,f);Ma(c,this._originSR,0,c,r.renderSpatialReference,0,l);const m=new jr([[S.POSITION,{size:3,data:c,exclusive:!0}]],[[S.POSITION,u]],Fc.Line);n.add(m),a.addGeometry(m,this._material,rn)}get test(){const e=this;return{set gridSize(t){e._gridSize=t}}}};const Cn=P();let dK=class{constructor(e,t,r,n=null){this.rctx=e,this.sliceHelper=n,this.lastFrameCamera=new vi,this.output=V.Color,this.renderOccludedMask=f8,this.bindParameters=new AP(t,r,y(n)?n.plane:null)}resetRenderOccludedMask(){this.renderOccludedMask=f8}},KCe=class extends dK{constructor(e,t,r,n,s){super(e,r,n,s),this.offscreenRenderingHelper=t,this.sliceHelper=s}};const f8=cr.Occlude|cr.OccludeAndTransparent|cr.OccludeAndTransparentStencil;var dv;(function(i){i[i.Highlight=0]="Highlight",i[i.Default=1]="Default"})(dv||(dv={}));let PC=class{constructor(){this.camera=new vi,this.lightMat=xe()}},I4=class{constructor(e,t){this._rctx=e,this._viewingMode=t,this._enabled=!1,this._snapshots=new Array,this._textureSize=0,this._numCascades=1,this._maxNumCascades=4,this._splitSchemeLambda=0,this._warp=!0,this._cascadeDistances=[0,0,0,0,0],this._usedCascadeDistances=yi(),this._cascades=[new PC,new PC,new PC,new PC],this._maxTextureSize=Math.min(Ot("esri-mobile")?2048:8192,this._rctx.parameters.maxTextureSize)}get depthTexture(){return this._depthTexture}get textureSize(){return this._textureSize}get numCascades(){return this._numCascades}get cascadeDistances(){return Qs(this._usedCascadeDistances,this._cascadeDistances[0],this._numCascades>1?this._cascadeDistances[1]:1/0,this._numCascades>2?this._cascadeDistances[2]:1/0,this._numCascades>3?this._cascadeDistances[3]:1/0)}dispose(){this._discardDepthTexture(),this._discardAllSnapshots()}set maxCascades(e){this._maxNumCascades=ue(Math.floor(e),1,4)}get maxCascades(){return this._maxNumCascades}set enabled(e){this._enabled=e,e||(this._discardDepthTexture(),this._discardAllSnapshots())}get enabled(){return this._enabled}get ready(){return this._enabled&&y(this._depthTexture)}getSnapshot(e){return this.enabled?this._snapshots[e]:null}getCascades(){for(let e=0;e<this._numCascades;++e)fM[e]=this._cascades[e];return fM.length=this._numCascades,fM}start(e,t,r){ct(this.enabled),this._textureSize=this._computeTextureSize(e.fullWidth,e.fullHeight),this._ensureDepthTexture();const{near:n,far:s}=this._clampNearFar(r);this._computeCascadeDistances(s,n),this._setupMatrices(e,t);const a=e.viewMatrix,o=e.projectionMatrix;for(let l=0;l<this._numCascades;++l)this._constructCascade(l,o,a,t);this._lastOrigin=null,this.clear()}finish(e){ct(this.enabled),this._rctx.bindFramebuffer(e)}getShadowMapMatrices(e){if(!this._lastOrigin||!Oc(e,this._lastOrigin)){this._lastOrigin=this._lastOrigin||P(),X(this._lastOrigin,e);for(let t=0;t<this._numCascades;++t){ru(S8,this._cascades[t].lightMat,e);for(let r=0;r<16;++r)E8[16*t+r]=S8[r]}}return E8}takeCascadeSnapshotTo(e,t){ct(this.enabled);const r=this._ensureSnapshot(t);this._bindFbo();const n=this._rctx,s=n.bindTexture(r,Gi.TEXTURE_UNIT_FOR_UPDATES);n.gl.copyTexSubImage2D(bi.TEXTURE_2D,0,e.camera.viewport[0],e.camera.viewport[1],e.camera.viewport[0],e.camera.viewport[1],e.camera.viewport[2],e.camera.viewport[3]),n.bindTexture(s,Gi.TEXTURE_UNIT_FOR_UPDATES)}clear(){const e=this._rctx;this._bindFbo(),e.setClearColor(1,1,1,1),e.clearSafe(Oi.COLOR_BUFFER_BIT|Oi.DEPTH_BUFFER_BIT)}_computeTextureSize(e,t){const r=.5*Math.log(e*e+t*t)*Math.LOG2E,n=.35,s=2**Math.round(r+n);return Math.min(this._maxTextureSize,2*s)}_ensureDepthTexture(){if(y(this._depthTexture)&&this._depthTexture.descriptor.width===this._textureSize)return;this._discardDepthTexture();const e={target:bi.TEXTURE_2D,pixelFormat:St.RGBA,dataType:Xt.UNSIGNED_BYTE,wrapMode:ai.CLAMP_TO_EDGE,samplingMode:Jt.NEAREST,flipped:!0,width:this._textureSize,height:this._textureSize};this._depthTexture=new Gi(this._rctx,e),this._fbo=new yn(this._rctx,{colorTarget:Vn.TEXTURE,depthStencilTarget:rs.DEPTH_RENDER_BUFFER,width:this._textureSize,height:this._textureSize},this._depthTexture)}_ensureSnapshot(e){let t=this._snapshots[e];if(y(t)&&t.descriptor.width===this._textureSize)return t;this._discardSnapshot(e);const r={target:bi.TEXTURE_2D,pixelFormat:St.RGBA,dataType:Xt.UNSIGNED_BYTE,wrapMode:ai.CLAMP_TO_EDGE,samplingMode:Jt.NEAREST,flipped:!0,width:this._textureSize,height:this._textureSize};return t=new Gi(this._rctx,r),this._snapshots[e]=t,t}_discardDepthTexture(){this._fbo=ke(this._fbo),this._depthTexture=ke(this._depthTexture)}_discardSnapshot(e){this._snapshots[e]=ke(this._snapshots[e])}_discardAllSnapshots(){for(let e=0;e<this._snapshots.length;++e)this._discardSnapshot(e);this._snapshots.length=0}_bindFbo(){const e=this._rctx;e.unbindTexture(this._depthTexture),e.bindFramebuffer(this._fbo)}_constructCascade(e,t,r,n){const s=this._cascades[e],a=-this._cascadeDistances[e],o=-this._cascadeDistances[e+1],l=(t[10]*a+t[14])/Math.abs(t[11]*a+t[15]),c=(t[10]*o+t[14])/Math.abs(t[11]*o+t[15]);ct(l<c);for(let d=0;d<8;++d){Qs(v8,d%4==0||d%4==3?-1:1,d%4==0||d%4==1?-1:1,d<4?l:c,1),sd(Xa[d],v8,y8);for(let m=0;m<3;++m)Xa[d][m]/=Xa[d][3]}Aa(mM,Xa[0]),ru(g8,C8,mM),s.camera.viewMatrix=g8;for(let d=0;d<8;++d)Me(Xa[d],Xa[d],s.camera.viewMatrix);X(rh,Xa[0]),X(nh,Xa[0]);for(let d=1;d<8;++d)for(let m=0;m<3;++m)rh[m]=Math.min(rh[m],Xa[d][m]),nh[m]=Math.max(nh[m],Xa[d][m]);rh[2]-=200,nh[2]+=200,s.camera.near=-nh[2],s.camera.far=-rh[2],this._warp?this._constructTrapezoidalProjection(r,n,s):this._constructOrthogonalProjection(s),Hr(s.lightMat,s.camera.projectionMatrix,s.camera.viewMatrix);const u=this._textureSize/2;s.camera.viewport[0]=e%2==0?0:u,s.camera.viewport[1]=Math.floor(e/2)===0?0:u,s.camera.viewport[2]=u,s.camera.viewport[3]=u}_constructOrthogonalProjection(e){OG(e.camera.projectionMatrix,rh[0],nh[0],rh[1],nh[1],e.camera.near,e.camera.far)}_constructTrapezoidalProjection(e,t,r){const n=1/Xa[0][3],s=1/Xa[4][3];ct(n<s);let a=n+Math.sqrt(n*s);const o=Math.sin(ls(e[2]*t[0]+e[6]*t[1]+e[10]*t[2]));a/=o,eSe(Xa,a,o,b8,w8,JCe,x8,T8),tSe(b8,w8,x8,T8,r.camera.projectionMatrix),r.camera.projectionMatrix[10]=2/(rh[2]-nh[2]),r.camera.projectionMatrix[14]=-(rh[2]+nh[2])/(rh[2]-nh[2])}_setupMatrices(e,t){Hr(_8,e.projectionMatrix,e.viewMatrix),kn(y8,_8);const r=this._viewingMode===Ie.Global?e.eye:Y(mM,0,0,1);OD(C8,[0,0,0],[-t[0],-t[1],-t[2]],r)}_clampNearFar(e){let{near:t,far:r}=e;return t<2&&(t=2),r<2&&(r=2),t>=r&&(t=2,r=4),{near:t,far:r}}_computeCascadeDistances(e,t){this._numCascades=Math.min(1+Math.floor($se(e/t,4)),this._maxNumCascades);const r=(e-t)/this._numCascades,n=(e/t)**(1/this._numCascades);let s=t,a=t;for(let o=0;o<this._numCascades+1;++o)this._cascadeDistances[o]=bt(s,a,this._splitSchemeLambda),s*=n,a+=r}get gpuMemoryUsage(){var e;return this._snapshots.reduce((t,r)=>t+qE(r),((e=this._fbo)==null?void 0:e.gpuMemoryUsage)??0)}get test(){const e=this;return{maxNumCascades:this._maxNumCascades,cascades:this._cascades,textureSize:this._textureSize,set splitSchemeLambda(t){e._splitSchemeLambda=t},get splitSchemeLambda(){return e._splitSchemeLambda},set warp(t){e._warp=t},get warp(){return e._warp}}}};const g8=xe(),_8=xe(),y8=xe(),v8=yi(),Xa=[];for(let i=0;i<8;++i)Xa.push(yi());const rh=P(),nh=P(),b8=Te(),w8=Te(),JCe=Te(),x8=Te(),T8=Te(),C8=xe(),mM=P(),fM=[],S8=xe(),E8=new Float32Array(64),Po=Te(),B_=Te(),df=[Te(),Te(),Te(),Te()],Wr=Te(),gM=Te(),ap=Te(),_1=Te(),G_=Te(),H_=Te(),AC=Te();function eSe(i,e,t,r,n,s,a,o){rt(Po,0,0);for(let R=0;R<4;++R)yc(Po,Po,i[R]);qs(Po,Po,.25),rt(B_,0,0);for(let R=4;R<8;++R)yc(B_,B_,i[R]);qs(B_,B_,.25),Qf(df[0],i[4],i[5],.5),Qf(df[1],i[5],i[6],.5),Qf(df[2],i[6],i[7],.5),Qf(df[3],i[7],i[4],.5);let l=0,c=L5(df[0],Po);for(let R=1;R<4;++R){const E=L5(df[R],Po);E<c&&(c=E,l=R)}Rc(Wr,df[l],i[l+4]);const u=Wr[0];let d,m;Wr[0]=-Wr[1],Wr[1]=u,Rc(gM,B_,Po),Fr(gM,Wr)<0&&gG(Wr,Wr),Qf(Wr,Wr,gM,t),X0(Wr,Wr),d=m=Fr(Rc(ap,i[0],Po),Wr);for(let R=1;R<8;++R){const E=Fr(Rc(ap,i[R],Po),Wr);E<d?d=E:E>m&&(m=E)}wn(r,Po),qs(ap,Wr,d-e),yc(r,r,ap);let f=-1,_=1,g=0,w=0;for(let R=0;R<8;++R){Rc(_1,i[R],r),X0(_1,_1);const E=Wr[0]*_1[1]-Wr[1]*_1[0];E>0?E>f&&(f=E,g=R):E<_&&(_=E,w=R)}T_(f>0,"leftArea"),T_(_<0,"rightArea"),qs(G_,Wr,d),yc(G_,G_,Po),qs(H_,Wr,m),yc(H_,H_,Po),AC[0]=-Wr[1],AC[1]=Wr[0];const v=gT(r,i[w],H_,yc(ap,H_,AC),1,n),b=gT(r,i[g],H_,ap,1,s),x=gT(r,i[g],G_,yc(ap,G_,AC),1,a),T=gT(r,i[w],G_,ap,1,o);T_(v,"rayRay"),T_(b,"rayRay"),T_(x,"rayRay"),T_(T,"rayRay")}function Dt(i,e){return 3*e+i}const R8=Te();function ka(i,e){return rt(R8,i[e],i[e+3]),R8}const aa=Te(),De=Or();function tSe(i,e,t,r,n){Rc(aa,t,r),qs(aa,aa,.5),De[0]=aa[0],De[1]=aa[1],De[2]=0,De[3]=aa[1],De[4]=-aa[0],De[5]=0,De[6]=aa[0]*aa[0]+aa[1]*aa[1],De[7]=aa[0]*aa[1]-aa[1]*aa[0],De[8]=1,De[Dt(0,2)]=-Fr(ka(De,0),i),De[Dt(1,2)]=-Fr(ka(De,1),i);let s=Fr(ka(De,0),t)+De[Dt(0,2)],a=Fr(ka(De,1),t)+De[Dt(1,2)],o=Fr(ka(De,0),r)+De[Dt(0,2)],l=Fr(ka(De,1),r)+De[Dt(1,2)];s=-(s+o)/(a+l),De[Dt(0,0)]+=De[Dt(1,0)]*s,De[Dt(0,1)]+=De[Dt(1,1)]*s,De[Dt(0,2)]+=De[Dt(1,2)]*s,s=1/(Fr(ka(De,0),t)+De[Dt(0,2)]),a=1/(Fr(ka(De,1),t)+De[Dt(1,2)]),De[Dt(0,0)]*=s,De[Dt(0,1)]*=s,De[Dt(0,2)]*=s,De[Dt(1,0)]*=a,De[Dt(1,1)]*=a,De[Dt(1,2)]*=a,De[Dt(2,0)]=De[Dt(1,0)],De[Dt(2,1)]=De[Dt(1,1)],De[Dt(2,2)]=De[Dt(1,2)],De[Dt(1,2)]+=1,s=Fr(ka(De,1),e)+De[Dt(1,2)],a=Fr(ka(De,2),e)+De[Dt(2,2)],o=Fr(ka(De,1),t)+De[Dt(1,2)],l=Fr(ka(De,2),t)+De[Dt(2,2)],s=-.5*(s/a+o/l),De[Dt(1,0)]+=De[Dt(2,0)]*s,De[Dt(1,1)]+=De[Dt(2,1)]*s,De[Dt(1,2)]+=De[Dt(2,2)]*s,s=Fr(ka(De,1),e)+De[Dt(1,2)],a=Fr(ka(De,2),e)+De[Dt(2,2)],o=-a/s,De[Dt(1,0)]*=o,De[Dt(1,1)]*=o,De[Dt(1,2)]*=o,n[0]=De[0],n[1]=De[1],n[2]=0,n[3]=De[2],n[4]=De[3],n[5]=De[4],n[6]=0,n[7]=De[5],n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=De[6],n[13]=De[7],n[14]=0,n[15]=De[8]}let pK=class{constructor(){this.adds=new Yt,this.removes=new Yt,this.updates=new Yt({allocator:e=>e||new iSe,deallocator:e=>(e.renderGeometry=null,e)})}clear(){this.adds.clear(),this.removes.clear(),this.updates.clear()}prune(){this.adds.prune(),this.removes.prune(),this.updates.prune()}},iSe=class{},rSe=class{constructor(){this.adds=new Array,this.removes=new Array,this.updates=new Array}};var Fi,Ur;(function(i){i[i.ADD=0]="ADD",i[i.UPDATE=1]="UPDATE",i[i.REMOVE=2]="REMOVE"})(Fi||(Fi={})),function(i){i[i.NONE=0]="NONE",i[i.VISIBILITIES=1]="VISIBILITIES",i[i.VERTEXATTRS=2]="VERTEXATTRS",i[i.TRANSFORMATION=4]="TRANSFORMATION",i[i.HIGHLIGHTS=8]="HIGHLIGHTS",i[i.OCCLUDEES=16]="OCCLUDEES"}(Ur||(Ur={}));function mK(i){const e=new Map,t=r=>{let n=e.get(r);return n||(n=new rSe,e.set(r,n)),n};return i.removes.forAll(r=>{_M(r)&&t(r.material).removes.push(r)}),i.adds.forAll(r=>{_M(r)&&t(r.material).adds.push(r)}),i.updates.forAll(r=>{_M(r.renderGeometry)&&t(r.renderGeometry.material).updates.push(r)}),e}function _M(i){return i.data.indexCount>=1}let fK=class{constructor(e,t){this._material=e,this._repository=t,this._map=new Map}destroy(){this._map.forEach((e,t)=>{y(e)&&this._repository.release(this._material,t)})}load(e,t,r){if(!this._material.requiresSlot(t,r))return null;this._map.has(r)||this._map.set(r,this._repository.acquire(this._material,t,r));const n=this._map.get(r);if(y(n)){if(n.ensureResources(e)===PS.LOADED)return n;this._repository.requestRender()}return null}},h$=class extends Sae{constructor(e=P()){super(),this.origin=e,this.slicePlaneLocalOrigin=this.origin}},gK=class _K extends ii{initializeConfiguration(e,t){t.hasWebGL2Context=e.rctx.type===Nn.WEBGL2,t.spherical=e.viewingMode===Ie.Global,t.doublePrecisionRequiresObfuscation=zR(e.rctx)}initializeProgram(e){return new ei(e.rctx,_K.shader.get().build(this.configuration),oi)}_setPipelineState(e){const t=this.configuration,r=e===qt.NONE,n=e===qt.FrontFace;return it({blending:t.output!==V.Normal&&t.output!==V.Highlight&&t.transparent?r?Hl:qm(e):null,depthTest:{func:n_(e)},depthWrite:r?t.writeDepth&&nl:BR(e),colorWrite:gt,polygonOffset:r||n?null:XD(t.enableOffset)})}initializePipeline(){return this._setPipelineState(this.configuration.transparencyPassType)}};gK.shader=new ri(Rne,()=>j(()=>import("./WaterSurface.glsl-3260bb79.js"),["assets/WaterSurface.glsl-3260bb79.js","assets/Matrix3PassUniform-ad9f953b.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/mat3f64-c6305894.js","assets/mat4f64-1e28eae0.js","assets/vec3f32-c9aa289f.js","assets/vec3f64-2f9cef06.js","assets/VertexAttribute-9c5c630d.js","assets/mat4-44a0988f.js","assets/common-c186b691.js","assets/vec3-e93e648f.js","assets/vec4f64-e407da96.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/Texture2DPassUniform-753de459.js","assets/vec4-790471c0.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/compilerUtils-18d58939.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/mathUtils-b4bb77e2.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/NormalUtils.glsl-c12729bf.js","assets/Ellipsoid-89682c5e.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js"]));let Rn=class extends cu{constructor(){super(...arguments),this.output=V.Color,this.transparencyPassType=qt.NONE,this.spherical=!1,this.receiveShadows=!1,this.hasSlicePlane=!1,this.transparent=!1,this.enableOffset=!0,this.writeDepth=!1,this.hasScreenSpaceReflections=!1,this.doublePrecisionRequiresObfuscation=!1,this.hasCloudsReflections=!1,this.isDraped=!1,this.hasMultipassTerrain=!1,this.cullAboveGround=!1}};h([k({count:V.COUNT})],Rn.prototype,"output",void 0),h([k({count:qt.COUNT})],Rn.prototype,"transparencyPassType",void 0),h([k()],Rn.prototype,"spherical",void 0),h([k()],Rn.prototype,"receiveShadows",void 0),h([k()],Rn.prototype,"hasSlicePlane",void 0),h([k()],Rn.prototype,"transparent",void 0),h([k()],Rn.prototype,"enableOffset",void 0),h([k()],Rn.prototype,"writeDepth",void 0),h([k()],Rn.prototype,"hasScreenSpaceReflections",void 0),h([k()],Rn.prototype,"doublePrecisionRequiresObfuscation",void 0),h([k()],Rn.prototype,"hasCloudsReflections",void 0),h([k()],Rn.prototype,"isDraped",void 0),h([k()],Rn.prototype,"hasMultipassTerrain",void 0),h([k()],Rn.prototype,"cullAboveGround",void 0),h([k({constValue:zr.Water})],Rn.prototype,"pbrMode",void 0),h([k({constValue:!0})],Rn.prototype,"useCustomDTRExponentForWater",void 0),h([k({constValue:!0})],Rn.prototype,"highStepCount",void 0),h([k({constValue:!1})],Rn.prototype,"useFillLights",void 0);let nSe=class extends r_{_updateShadowState(e){e.shadowMap.enabled!==this._material.parameters.receiveShadows&&this._material.setParameters({receiveShadows:e.shadowMap.enabled})}_updateSSRState(e){e.ssr.enabled!==this._material.parameters.hasScreenSpaceReflections&&this._material.setParameters({hasScreenSpaceReflections:e.ssr.enabled})}_updateCloudsReflectionState(e){const t=y(e.cloudsFade.data);t!==this._material.parameters.hasCloudsReflections&&this._material.setParameters({hasCloudsReflections:t})}ensureResources(e){return this._techniqueRepository.constructionContext.waterTextureRepository.ensureResources(e)}beginSlot(e){return this._output===V.Color&&(this._updateShadowState(e),this._updateSSRState(e),this._updateCloudsReflectionState(e)),this._material.setParameters(this._techniqueRepository.constructionContext.waterTextureRepository.passParameters),this.ensureTechnique(gK,e)}};const sSe=sn().vec3f(S.POSITION),aSe=sn().vec3f(S.POSITION).vec2f(S.UV0),yK=sn().vec3f(S.POSITION).vec4u8(S.COLOR);sn().vec3f(S.POSITION).vec4u8(S.OBJECTANDLAYERIDCOLOR);sn().vec3f(S.POSITION).vec2f(S.UV0).vec4u8(S.OBJECTANDLAYERIDCOLOR);const oSe=sn().vec3f(S.POSITION).vec4u8(S.COLOR).vec4u8(S.OBJECTANDLAYERIDCOLOR);let HP=class{constructor(e){this.vertexBufferLayout=e}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){return e.indices.get(S.POSITION).length}write(e,t,r,n,s){QD(r,this.vertexBufferLayout,e,t,n,s)}},vK=class extends Fd{constructor(e){super(e,new bK),this._configuration=new Rn,this.animation=new _Z}getConfiguration(e,t){return this._configuration.output=e,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.receiveShadows=this.parameters.receiveShadows,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this.parameters.transparent,this._configuration.hasScreenSpaceReflections=this.parameters.hasScreenSpaceReflections,this._configuration.hasCloudsReflections=this.parameters.hasCloudsReflections,this._configuration.isDraped=this.parameters.isDraped,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration.enableOffset=t.camera.relativeElevation<ZD,this._configuration.hasMultipassTerrain=t.multipassTerrain.enabled,this._configuration.cullAboveGround=t.multipassTerrain.cullAboveGround,this._configuration}update(e){const t=Math.min(e.camera.relativeElevation,e.camera.distance);this.animation.enabled=Math.sqrt(this.parameters.waveTextureRepeat/this.parameters.waveStrength)*t<lSe;const r=this.animation.advance(e);return this.setParameters({timeElapsed:aD(this.animation.time)*this.parameters.animationSpeed},!1),this.animation.enabled&&r}intersect(e,t,r,n,s,a,o){BD(e,t,n,s,a,void 0,o)}requiresSlot(e,t){switch(t){case V.Normal:return e===le.DRAPED_WATER;case V.Color:if(this.parameters.isDraped)return e===le.DRAPED_MATERIAL;break;case V.Alpha:break;case V.Highlight:return e===le.OPAQUE_MATERIAL||e===le.DRAPED_MATERIAL;default:return!1}let r=le.OPAQUE_MATERIAL;return this.parameters.transparent&&(r=this.parameters.writeDepth?le.TRANSPARENT_MATERIAL:le.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL),e===r}createGLMaterial(e){return new nSe(e)}createBufferWriter(){return new HP(aSe)}},bK=class extends qx{constructor(){super(...arguments),this.waveStrength=.06,this.waveTextureRepeat=32,this.waveDirection=Qt(1,0),this.waveVelocity=.05,this.flowStrength=.015,this.flowOffset=-.5,this.animationSpeed=.35,this.timeElapsed=0,this.color=Bi(0,0,0,0),this.transparent=!0,this.writeDepth=!0,this.hasSlicePlane=!1,this.isDraped=!1,this.receiveShadows=!0,this.hasScreenSpaceReflections=!1,this.hasCloudsReflections=!1}};const lSe=35e3;let OC=class{constructor(){this.first=0,this.count=0}},Iy=class{constructor(e=0,t=0){this.from=e,this.to=t}},cSe=class extends Iy{constructor(e,t,r,n,s,a){super(t,r),this.id=e,this.isVisible=n,this.hasHighlights=s,this.hasOccludees=a}};function P8(i){return Array.from(i.values()).sort(hSe)}function hSe(i,e){return i.from===e.from?i.to-e.to:i.from-e.from}function MC(i,e){const t=i.back();if(t==null){const r=i.pushNew();return r.first=e.from,void(r.count=e.to-e.from)}if(uSe(t,e)){const r=e.from-t.first+e.to-e.from;t.count=r}else{const r=i.pushNew();r.first=e.from,r.count=e.to-e.from}}function uSe(i,e){return i.first+i.count>=e.from}let dSe=class{constructor(e,t){this._pool=e,this._size=0,this._buffer=e.newBuffer(d$(t))}dispose(){this._buffer=this._pool.deleteBuffer(this._buffer),this._size=0}release(){this.erase(0,this._size),this.dispose()}get buffer(){return this._buffer}get size(){return this._size}grow(e){this._resize(this._size+e,!0).dispose()}allocate(e){return this._resize(e,!1)}_resize(e,t){let r;const n=pSe(this._buffer.length,this._size,e);if(this._buffer.length!==n){const a=this._pool.newBuffer(n);t&&(a.array.set(this._buffer.array.subarray(0,Math.min(this._size,n))),a.vao.vertexBuffers.geometry.setSubData(a.array,0,0,a.array.length)),r=this._buffer,this._buffer=a}const s=this._size;return this._size=e,r?{dispose:()=>{r.array.fill(0,0,s),this._pool.deleteBuffer(r)},copy:(a,o,l)=>this._buffer.array.set(r.array.subarray(o,l),a),hasNewBuffer:!0}:{dispose:()=>{},copy:(a,o,l)=>{a!==o&&this._buffer.array.copyWithin(a,o,l)},hasNewBuffer:!1}}erase(e,t){this._buffer.array.fill(0,e,t)}};const u$=65536;function d$(i){return Math.ceil(i/u$)*u$}function pSe(i,e,t){return e<=t?i>=t?i:d$(Math.max(2*i,t)):i<=2*t?i:d$(t)}let mSe=class{constructor(e,t,r,n){this.vao=new nu(e,t,{geometry:r},{geometry:ui.createVertex(e,mi.STATIC_DRAW)}),this.array=new Float32Array(n),this.vao.vertexBuffers.geometry.setSize(this.array.byteLength)}dispose(){this.vao.dispose(!0)}get length(){return this.array.length}};const fSe=Iae+1;let gSe=class{constructor(e,t,r){this._rctx=e,this._locations=t,this._layout=r,this._cache=e.newCache(`MergedRenderer pool ${Sm()}`,_Se)}dispose(){this._cache.destroy()}newBuffer(e){const t=e.toString(),r=this._cache.pop(t);if(y(r)){const n=r.pop();return r.length>0&&this._cache.put(t,r,n.array.byteLength*r.length,fSe),n}return new mSe(this._rctx,this._locations,this._layout,e)}deleteBuffer(e){const t=e.array.byteLength,r=e.array.length.toString(),n=this._cache.pop(r);return y(n)?(n.push(e),this._cache.put(r,n,t*n.length,-1)):this._cache.put(r,[e],t,-1),null}};function _Se(i,e){if(e===Mae.ALL)return void i.forEach(n=>n.dispose());const t=i.pop(),r=i.length*t.array.byteLength;return t.dispose(),r}let wK=class{constructor(e,t,r){this._rctx=e,this._materialRepository=t,this._material=r,this.type="MergedRenderer",this._dataByOrigin=new Map,this._renderCommandData=new Yt,this._hasHighlights=!1,this._hasOccludees=!1,this._glMaterials=new fK(this._material,this._materialRepository),this._bufferWriter=r.createBufferWriter(),this._bufferPool=new gSe(e,r.vertexAttributeLocations,Wc(this._bufferWriter.vertexBufferLayout))}dispose(){this._glMaterials.destroy(),this._dataByOrigin.forEach(e=>e.geometry.dispose()),this._dataByOrigin.clear(),this._bufferPool.dispose()}get isEmpty(){return this._dataByOrigin.size===0}get hasHighlights(){return this._hasHighlights}get hasOccludees(){return this._hasOccludees}get hasWater(){return!this.isEmpty&&this._material instanceof vK}get rendersOccluded(){return!this.isEmpty&&this._material.renderOccluded!==cr.Occlude}modify(e){this._updateGeometries(e.updates),this._addAndRemoveGeometries(e.adds,e.removes),this._updateDrawCommands()}_addAndRemoveGeometries(e,t){const r=this._bufferWriter,n=r.vertexBufferLayout.stride/4,s=this._dataByOrigin,a=vSe(e,t);a.forEach((o,l)=>{a.delete(l);const c=o.add.reduce((v,b)=>v+r.elementCount(b.data),0);let u=s.get(l);if(u==null)ct(o.remove.length===0),u=new wSe(o.origin,new dSe(this._bufferPool,c*n)),s.set(l,u);else if(o.add.length===0&&u.instances.size===o.remove.length)return u.geometry.dispose(),void s.delete(l);let d=0;u.instances.forEach(v=>d+=v.to-v.from);const m=o.remove.reduce((v,b)=>v+r.elementCount(b.data),0),f=u.geometry.size,_=(d+c-m)*n,g=TSe;if(_>u$&&(_<f/2||f-_>1048576)?this._removeAndRebuild(u,o.remove,n,_,g):o.remove.length>0&&this._remove(u,o.remove,n,g),o.add.length>0){const v=CSe;Dse(v,-o.origin[0],-o.origin[1],-o.origin[2]),this._add(u,o.add,n,v,g)}const w=u.geometry.buffer.vao.vertexBuffers.geometry;M8(g),g.forAll(({from:v,to:b})=>{if(v<b){const x=u.geometry.buffer.array;w.setSubData(x,v,v,b)}}),g.clear(),u.drawCommandsDirty=!0})}_updateGeometries(e){const t=this._bufferWriter,r=t.vertexBufferLayout.stride/4;for(const n of e){const s=n.renderGeometry,a=this._dataByOrigin.get(s.origin.id),o=a&&a.instances.get(s.id);if(!o)return;const l=n.updateType;if(l&Ur.VISIBILITIES&&(o.isVisible=s.instanceParameters.visible),l&(Ur.HIGHLIGHTS|Ur.VISIBILITIES)){const c=s.instanceParameters.visible;o.hasHighlights=!!s.instanceParameters.highlights&&c}if(l&Ur.OCCLUDEES&&(o.hasOccludees=!!s.instanceParameters.occludees),l&(Ur.VERTEXATTRS|Ur.TRANSFORMATION)){const{array:c,vao:u}=a.geometry.buffer;Une(s,yM,y1),t.write(yM,y1,s.data,t.vertexBufferLayout.createView(c.buffer),o.from),ct(o.from+t.elementCount(s.data)===o.to,"material VBO layout has changed"),u.vertexBuffers.geometry.setSubData(c,o.from*r,o.from*r,o.to*r)}a.drawCommandsDirty=!0}}_updateDrawCommands(){this._hasHighlights=!1,this._hasOccludees=!1,this._dataByOrigin.forEach(t=>{t.hasHiddenInstances=!1,t.hasHighlights=!1,t.hasOccludees=!1,Er(t.instances,r=>(r.isVisible?(r.hasHighlights&&(this._hasHighlights=!0,t.hasHighlights=!0),r.hasOccludees&&(this._hasOccludees=!0,t.hasOccludees=!0)):t.hasHiddenInstances=!0,t.hasHiddenInstances&&t.hasHighlights&&t.hasOccludees))});const e=t=>{if(t.drawCommandsDefault.clear(),t.drawCommandsHighlight.clear(),t.drawCommandsOccludees.clear(),t.drawCommandsShadowHighlightRest.clear(),t.instances.size===0)return;if(!O8(t)){const n=t.drawCommandsDefault.pushNew();return n.first=1/0,n.count=0,t.instances.forEach(s=>{n.first=Math.min(n.first,s.from),n.count=Math.max(n.count,s.to)}),void(n.count-=n.first)}const r=P8(t.instances);for(const n of r)n.isVisible&&(n.hasOccludees?MC(t.drawCommandsOccludees,n):MC(t.drawCommandsDefault,n),n.hasHighlights?MC(t.drawCommandsHighlight,n):MC(t.drawCommandsShadowHighlightRest,n))};this._dataByOrigin.forEach(t=>{t.drawCommandsDirty&&(e(t),t.drawCommandsDirty=!1)})}updateAnimation(e){return this._material.update(e)}requiresSlot(e,t){return this._material.requiresSlot(e,t)}render(e,t){if(!this.requiresSlot(t.slot,e))return!1;const r=e===V.Highlight||e===V.ShadowHighlight;if(r&&!this._hasHighlights)return!1;const n=e===V.ShadowExludeHighlight,s=!(r||n);if(this._dataByOrigin.forEach(u=>{if(r&&!u.hasHighlights)return;const d=(r?u.drawCommandsHighlight:n&&O8(u)?u.drawCommandsShadowHighlightRest:u.drawCommandsDefault)||null,m=s&&u.drawCommandsOccludees||null;(d!=null&&d.length||m!=null&&m.length)&&this._renderCommandData.push(new xSe(u.origin,u.geometry,d,m))}),this._renderCommandData.length===0)return!1;const a=this._rctx,o=this._glMaterials.load(a,t.slot,e);if(C(o))return this._renderCommandData.clear(),!1;const l=o.beginSlot(t),c=a.bindTechnique(l,this._material.parameters,t);return this._renderCommandData.forAll(u=>{c.bindDraw(u,t,this._material.parameters);const{geometry:d,renderCommands:m,occludeeCommands:f}=u;l.ensureAttributeLocations(d.buffer.vao),a.bindVAO(d.buffer.vao);const _=l.primitiveType;y(m)&&m.length>0&&(l.bindPipelineState(a,t.slot,!1),m.forAll(g=>a.drawArrays(_,g.first,g.count))),y(f)&&f.length>0&&(l.bindPipelineState(a,t.slot,!0),f.forAll(g=>a.drawArrays(_,g.first,g.count)))}),this._renderCommandData.clear(),!0}_removeAndRebuild(e,t,r,n,s){for(const u of t)e.instances.delete(u.id);const a=P8(e.instances);e.instances.clear();const o=e.geometry.size,l=e.geometry.allocate(n);let c=0;for(const u of a){const d=u.from*r,m=u.to*r;l.copy(c,d,m),u.from=c/r,c+=m-d,u.to=c/r,e.instances.set(u.id,u)}s.push(new Iy(0,l.hasNewBuffer?e.geometry.buffer.array.length:o)),l.dispose(),e.geometry.erase(c,s.back().to),e.holes.clear()}_remove(e,t,r,n){for(const s of t){const a=s.id,o=e.instances.get(a),l=o.from*r,c=o.to*r;e.geometry.erase(l,c),e.holes.push(new Iy(o.from,o.to)),e.instances.delete(a),n.push(new Iy(l,c))}M8(e.holes)}_add(e,t,r,n,s){if(t.length===0)return;const a=this._bufferWriter;let o=a.vertexBufferLayout.createView(e.geometry.buffer.array.buffer);const l=e.holes.length>0;let c=Number.MAX_SAFE_INTEGER,u=Number.MIN_SAFE_INTEGER;for(const d of t){const m=y(d.transformation)?Hr(yM,n,d.transformation):n;kn(y1,m);const f=AD(y1,y1),_=a.elementCount(d.data),g=_*r;let w=bSe(e.holes,_);C(w)&&(w=e.geometry.size/r,e.geometry.grow(g),o=a.vertexBufferLayout.createView(e.geometry.buffer.array.buffer)),a.write(m,f,d.data,o,w);const v=d.instanceParameters.visible,b=!!d.instanceParameters.highlights&&v,x=!!d.instanceParameters.occludees,T=new cSe(d.id,w,w+_,v,b,x);ct(e.instances.get(d.id)==null),e.instances.set(d.id,T),l?s.push(new Iy(T.from*r,T.to*r)):(c=Math.min(T.from,c),u=Math.max(T.to,u))}l||s.push(new Iy(c*r,u*r))}get test(){return{material:this._material,glMaterials:this._glMaterials,dataByOrigin:this._dataByOrigin}}},ySe=class{constructor(e){this.origin=e,this.add=new Array,this.remove=new Array}};function vSe(i,e){const t=new Map;for(const r of i)A8(t,r,!0);for(const r of e)A8(t,r,!1);return t}function A8(i,e,t){const r=e.origin;if(C(r))return;let n=i.get(r.id);n==null&&(n=new ySe(r.vec3),i.set(r.id,n)),t?n.add.push(e):n.remove.push(e)}function O8(i){return i.hasOccludees||i.hasHighlights||i.hasHiddenInstances}function bSe(i,e){let t;if(!i.some(n=>!(n.to-n.from<e)&&(t=n,!0)))return null;const r=t.from;return t.from+=e,t.from>=t.to&&i.removeUnordered(t),r}function M8(i){const e=new Map;i.forAll(r=>e.set(r.from,r));let t=!0;for(;t;)t=!1,i.forEach(r=>{const n=e.get(r.to);n&&(r.to=n.to,e.delete(n.from),i.removeUnordered(n),t=!0)})}let wSe=class{constructor(e,t){this.origin=e,this.geometry=t,this.instances=new Map,this.holes=new Yt({deallocator:null}),this.hasHiddenInstances=!1,this.hasHighlights=!1,this.hasOccludees=!1,this.drawCommandsDirty=!1,this.drawCommandsDefault=new Yt({allocator:r=>r||new OC,deallocator:r=>r}),this.drawCommandsHighlight=new Yt({allocator:r=>r||new OC,deallocator:r=>r}),this.drawCommandsOccludees=new Yt({allocator:r=>r||new OC,deallocator:r=>r}),this.drawCommandsShadowHighlightRest=new Yt({allocator:r=>r||new OC,deallocator:r=>r})}},xSe=class extends h${constructor(e,t,r,n){super(e),this.geometry=t,this.renderCommands=r,this.occludeeCommands=n}};const TSe=new Yt({deallocator:null}),CSe=xe(),yM=xe(),y1=xe();let Oh=class extends pe{constructor(e){super(e),this._pending=new SSe,this._changes=new pK,this._materialRenderers=new Map,this._sortedMaterialRenderers=new Yt,this._geometries=new Map,this._hasHighlights=!1,this._hasWater=!1}destroy(){this._changes.prune(),this._materialRenderers.forEach(e=>e.dispose()),this._materialRenderers.clear(),this._sortedMaterialRenderers.clear(),this._geometries.clear()}get updating(){return!this._pending.empty||this._changes.updates.length>0}get rctx(){return this.rendererContext.rctx}get _materialRepository(){return this.rendererContext.materialRepository}get _localOriginFactory(){return this.rendererContext.localOriginFactory}get hasHighlights(){return this._hasHighlights}get hasWater(){return this._hasWater}get rendersOccluded(){return Er(this._materialRenderers,e=>e.rendersOccluded)}get isEmpty(){return!this.updating&&this._materialRenderers.size===0&&this._geometries.size===0}commitChanges(){if(!this.updating)return!1;this._processAddsRemoves();const e=mK(this._changes);let t=!1,r=!1,n=!1;return e.forEach((s,a)=>{let o=this._materialRenderers.get(a);if(!o&&s.adds.length>0&&(o=new wK(this.rctx,this._materialRepository,a),this._materialRenderers.set(a,o),t=!0,r=!0,n=!0),!o)return;const l=r||o.hasHighlights,c=n||o.hasWater;o.modify(s),r=r||l!==o.hasHighlights,n=n||c!==o.hasWater,o.isEmpty&&(this._materialRenderers.delete(a),o.dispose(),t=!0)}),this._changes.clear(),t&&this._updateSortedMaterialRenderers(),r&&(this._hasHighlights=Er(this._materialRenderers,s=>s.hasHighlights)),n&&(this._hasWater=Er(this._materialRenderers,s=>s.hasWater)),this.notifyChange("updating"),!0}addGeometries(e,t){if(e.length===0)return;const r=this._validateRenderGeometries(e);for(const s of r)this._geometries.set(s.id,s);const n=this._pending.empty;for(const s of r)this._pending.adds.add(s);n&&this.notifyChange("updating"),t===Fi.UPDATE&&this._notifyGraphicGeometryChanged(e)}removeGeometries(e,t){const r=this._pending.empty,n=this._pending.adds;for(const s of e)n.has(s)?(this._pending.removed.add(s),n.delete(s)):this._pending.removed.has(s)||this._pending.removes.add(s),this._geometries.delete(ft(s.id));r&&!this._pending.empty&&this.notifyChange("updating"),t===Fi.UPDATE&&this._notifyGraphicGeometryChanged(e)}modifyGeometries(e,t){const r=this._changes.updates.length===0;for(const n of e){const s=this._changes.updates.pushNew();s.renderGeometry=this._validateRenderGeometry(n),s.updateType=t}switch(r&&this._changes.updates.length>0&&this.notifyChange("updating"),t){case Ur.TRANSFORMATION:case Ur.VERTEXATTRS:return this._notifyGraphicGeometryChanged(e);case Ur.VISIBILITIES:return this._notifyGraphicVisibilityChanged(e)}}updateAnimation(e){let t=!1;return this._sortedMaterialRenderers.forAll(({materialRenderer:r})=>t=r.updateAnimation(e)||t),t}render(e,t){for(let r=0;r<this._sortedMaterialRenderers.length;r++){const n=this._sortedMaterialRenderers.data[r];n.material.shouldRender(e)&&n.materialRenderer.render(e.output,t)}}intersect(e,t,r,n,s){return this._geometries.forEach(a=>{if(n&&!n(a))return;this._intersectRenderGeometry(a,r,t,0,e,s);const o=this.rendererContext.longitudeCyclical;o&&(a.boundingSphere[0]-a.boundingSphere[3]<o.min&&this._intersectRenderGeometry(a,r,t,o.range,e,s),a.boundingSphere[0]+a.boundingSphere[3]>o.max&&this._intersectRenderGeometry(a,r,t,-o.range,e,s)),s++}),s}_updateSortedMaterialRenderers(){this._sortedMaterialRenderers.clear();let e=0;this._materialRenderers.forEach((t,r)=>{r.insertOrder=e++,this._sortedMaterialRenderers.push({material:r,materialRenderer:t})}),this._sortedMaterialRenderers.sort((t,r)=>{const n=r.material.renderPriority-t.material.renderPriority;return n!==0?n:t.material.insertOrder-r.material.insertOrder})}_processAddsRemoves(){this._changes.adds.clear(),this._changes.removes.clear(),this._changes.adds.pushArray(Array.from(this._pending.adds)),this._changes.removes.pushArray(Array.from(this._pending.removes));for(let e=0;e<this._changes.updates.length;){const t=this._changes.updates.data[e];this._pending.has(t.renderGeometry)?this._changes.updates.removeUnorderedIndex(e):e++}this._pending.clear()}_intersectRenderGeometry(e,t,r,n,s,a){if(!e.instanceParameters.visible)return;let o=0;y(e.transformation)&&(n+=e.transformation[12],o=e.transformation[13]),IC[0]=r[0]-n,IC[1]=r[1]-o,IC[2]=1,LC[0]=r[0]-n,LC[1]=r[1]-o,LC[2]=0,e.screenToWorldRatio=this.rendererContext.screenToWorldRatio,e.material.intersect(e,null,e.getShaderTransformation(),s,IC,LC,(l,c,u)=>{ESe(t,u,e.material.renderPriority,a,s,e.layerUid,e.graphicUid)},e.calculateShaderTransformation,t)}_notifyGraphicGeometryChanged(e){if(C(this.drapeSource.notifyGraphicGeometryChanged))return;let t;for(const r of e){const n=r.graphicUid;y(n)&&n!==t&&(this.drapeSource.notifyGraphicGeometryChanged(n),t=n)}}_notifyGraphicVisibilityChanged(e){if(C(this.drapeSource.notifyGraphicVisibilityChanged))return;let t;for(const r of e){const n=r.graphicUid;y(n)&&n!==t&&(this.drapeSource.notifyGraphicVisibilityChanged(n),t=n)}}_validateRenderGeometries(e){for(const t of e)this._validateRenderGeometry(t);return e}_validateRenderGeometry(e){return C(e.origin)&&(e.origin=this._localOriginFactory.getOrigin(e.boundingSphere)),e}get test(){return{sortedMaterialRenderers:this._sortedMaterialRenderers}}};h([p()],Oh.prototype,"drapeSource",void 0),h([p()],Oh.prototype,"updating",null),h([p()],Oh.prototype,"rctx",null),h([p()],Oh.prototype,"rendererContext",void 0),h([p()],Oh.prototype,"_materialRepository",null),h([p()],Oh.prototype,"_localOriginFactory",null),Oh=h([F("esri.views.3d.webgl-engine.lib.SortedRenderGeometryRenderer")],Oh);let SSe=class{constructor(){this.adds=new Set,this.removes=new Set,this.removed=new Set}get empty(){return this.adds.size===0&&this.removes.size===0&&this.removed.size===0}has(e){return this.adds.has(e)||this.removes.has(e)||this.removed.has(e)}clear(){this.adds.clear(),this.removes.clear(),this.removed.clear()}};function ESe(i,e,t,r,n,s,a){const o={layerUid:s,graphicUid:a,triangleNr:e},l=c=>{c.set(Ui.OVERLAY,o,i.dist,i.normal,i.transformation,t,r)};if((n.results.min.drapedLayerOrder==null||t>=n.results.min.drapedLayerOrder)&&(n.results.min.dist==null||n.results.ground.dist<=n.results.min.dist)&&l(n.results.min),n.options.store!==zn.MIN&&(n.results.max.drapedLayerOrder==null||t<n.results.max.drapedLayerOrder)&&(n.results.max.dist==null||n.results.ground.dist>n.results.max.dist)&&l(n.results.max),n.options.store===zn.ALL){const c=e4(n.ray);l(c),n.results.all.push(c)}}const IC=P(),LC=P();let L4=class xK extends ii{initializeProgram(e){return new ei(e.rctx,xK.shader.get().build(),oi)}initializePipeline(){return this.configuration.hasAlpha?it({blending:Gn(me.SRC_ALPHA,me.ONE,me.ONE_MINUS_SRC_ALPHA,me.ONE_MINUS_SRC_ALPHA),colorWrite:gt}):it({colorWrite:gt})}};L4.shader=new ri(yae,()=>j(()=>import("./TextureOnly.glsl-18ace1e6.js"),["assets/TextureOnly.glsl-18ace1e6.js","assets/vec4f64-e407da96.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/VertexAttribute-9c5c630d.js","assets/vec2-528adfe4.js","assets/common-c186b691.js","assets/vec2f64-30dc1443.js","assets/Texture2DPassUniform-753de459.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/ScreenSpacePass-d5e48a9b.js","assets/Float4PassUniform-d7bdbc81.js"]));let $4=class extends $a{constructor(){super(...arguments),this.hasAlpha=!1}};h([k()],$4.prototype,"hasAlpha",void 0);let wh=class extends BP(pe){constructor(e){super(e),this._overlays=null,this._overlayRenderTarget=null,this._hasHighlights=!1,this._rendersOccluded=!1,this._hasWater=!1,this._handles=new Vt,this._renderers=new Map,this._sortedDrapeSourceRenderersDirty=!1,this._sortedRenderers=new Yt,this._passParameters=new vae,this._rctx=null,this._materialRepository=null,this._screenToWorldRatio=1,this._localOriginFactory=null,this.worldToPCSRatio=1,this.events=new nn,this.longitudeCyclical=null}get _bindParameters(){return this._renderContext.bindParameters}get rctx(){return this._rctx}get materialRepository(){return this._materialRepository}get screenToWorldRatio(){return this._screenToWorldRatio}get localOriginFactory(){return this._localOriginFactory}initialize(){const e=this.view._stage.renderView;this._rctx=e.renderingContext;const t=e.waterTextureRepository;this._stippleTextureRepository=new MH(e.renderingContext),this._shaderTechniqueRepository=new sK({rctx:this._rctx,viewingMode:Ie.Local,stippleTextureRepository:this._stippleTextureRepository,waterTextureRepository:t}),this._renderContext=new dK(this._rctx,new I4(this._rctx,this.view.state.viewingMode),new WG(this._shaderTechniqueRepository,this._rctx,()=>{})),this._handles.add([B(()=>t.updating,()=>this.events.emit("content-changed"),Mi),B(()=>this.spatialReference,r=>this._localOriginFactory=new M4(r),Mi),wr(()=>this.view.allLayerViews,"after-changes",()=>this._sortedDrapeSourceRenderersDirty=!0)]),this._materialRepository=new aK(e.textureRepository,this._shaderTechniqueRepository,r=>{(r.renderOccluded&dR)>0!==this._rendersOccluded&&this._updateRendersOccluded(),this.events.emit("content-changed"),this.notifyChange("updating")},()=>this.events.emit("content-changed")),this._bindParameters.slot=le.DRAPED_MATERIAL,this._bindParameters.highlightDepthTexture=KG(this._rctx),this._bindParameters.camera=dg,this._bindParameters.transparencyPassType=qt.NONE,this._bindParameters.newLighting.noonFactor=0,this._bindParameters.newLighting.globalFactor=0,this._bindParameters.newLighting.set([new qG(Ze(1,1,1))]),this._handles.add(this.view.resourceController.scheduler.registerTask(dr.STAGE,this))}dispose(){this._handles.destroy(),this._renderers.forEach(e=>e.destroy()),this._renderers.clear(),this._debugTextureTechnique=Qi(this._debugTextureTechnique),this._passParameters.texture=ke(this._passParameters.texture),this._bindParameters.highlightDepthTexture=ke(this._bindParameters.highlightDepthTexture),this._shaderTechniqueRepository=ke(this._shaderTechniqueRepository),this._temporaryFBO=ke(this._temporaryFBO),this._quadVAO=ke(this._quadVAO),this.disposeOverlays()}get updating(){return this._sortedDrapeSourceRenderersDirty||Er(this._renderers,e=>e.updating)}get hasOverlays(){return y(this._overlays)&&y(this._overlayRenderTarget)}get gpuMemoryUsage(){return y(this._overlayRenderTarget)?this._overlayRenderTarget.gpuMemoryUsage:0}createGeometryDrapeSourceRenderer(e){return this.createDrapeSourceRenderer(e,Oh)}createDrapeSourceRenderer(e,t,r){const n=this._renderers.get(e);y(n)&&n.destroy();const s=new t({...r,rendererContext:this,drapeSource:e});return this._renderers.set(e,s),this._sortedDrapeSourceRenderersDirty=!0,"fullOpacity"in e&&this._handles.add(B(()=>e.fullOpacity,()=>this.events.emit("content-changed")),e),s}removeDrapeSourceRenderer(e){if(C(e))return;const t=this._renderers.get(e);C(t)||(this._sortedDrapeSourceRenderersDirty=!0,this._renderers.delete(e),this._handles.remove(e),t.destroy())}collectUnusedRenderTargetMemory(e){let t=!1;if(y(this._overlayRenderTarget))for(const r of this._overlayRenderTarget.renderTargets){const n=this.overlays[0].validTargets[r.type]||!this.overlays[1].validTargets[r.type];t=this._overlayRenderTarget.validateUsageForTarget(n,r,e)||t}return t}get overlays(){return Ke(this._overlays,[])}ensureDrapeTargets(e){y(this._overlays)&&this._overlays.forEach(t=>t.hasTargetWithoutRasterImage=oA(e,r=>r.drapeTargetType===l$.WithoutRasterImage))}ensureDrapeSources(e){y(this._overlays)&&this._overlays.forEach(t=>{t.hasDrapedFeatureSource=oA(e,r=>r.drapeSourceType===nw.Features),t.hasDrapedRasterSource=oA(e,r=>r.drapeSourceType===nw.RasterImage)})}ensureOverlays(e,t){C(this._overlays)&&(this._overlayRenderTarget=new DCe(this._rctx),this._overlays=[new c8(ki.INNER,this._overlayRenderTarget),new c8(ki.OUTER,this._overlayRenderTarget)]),this.ensureDrapeTargets(e),this.ensureDrapeSources(t)}disposeOverlays(){this._overlays=null,this._overlayRenderTarget=ke(this._overlayRenderTarget),this.events.emit("textures-disposed")}get running(){return this.updating}runTask(e){this._processDrapeSources(e,()=>!0)}_processDrapeSources(e,t){let r=!1;for(const[n,s]of this._renderers){if(e.done)break;(n.destroyed||t(n))&&s.commitChanges()&&(r=!0,e.madeProgress())}this._sortedDrapeSourceRenderersDirty&&(this._sortedDrapeSourceRenderersDirty=!1,r=!0,this._updateSortedDrapeSourceRenderers()),r&&(y(this._overlays)&&this._renderers.size===0&&this.disposeOverlays(),this.notifyChange("updating"),this.events.emit("content-changed"),this._updateHasHighlights(),this._updateRendersOccluded(),this._updateHasWater())}processSyncDrapeSources(){this._processDrapeSources(LR,e=>e.updatePolicy===QE.SYNC)}isEmpty(){if(Wt.OVERLAY_DRAW_DEBUG_TEXTURE)return!1;for(const e of this._renderers.values())if(!e.isEmpty)return!1;return!0}get hasHighlights(){return this._hasHighlights}get hasWater(){return this._hasWater}get rendersOccluded(){return this._rendersOccluded}updateAnimation(e){let t=!1;return this._renderers.forEach(r=>t=r.updateAnimation(e)||t),t}updateDrapeSourceOrder(){this._sortedDrapeSourceRenderersDirty=!0}drawTarget(e,t,r){const n=e.canvasGeometries;if(n.numViews===0)return!1;this._screenToWorldRatio=r*e.mapUnitsPerPixel;const s=t.output;if(this.isEmpty()||s===V.Highlight&&!this.hasHighlights||s===V.Normal&&!this.hasWater||!e.hasSomeSizedView())return!1;const a=t.fbo;if(!a.isValid())return!1;const o=2*e.resolution,l=e.resolution;a.resize(o,l);const c=this._rctx;dg.pixelRatio=e.pixelRatio*r,this._renderContext.output=s,this._bindParameters.screenToWorldRatio=this._screenToWorldRatio,this._bindParameters.screenToPCSRatio=this._screenToWorldRatio*this.worldToPCSRatio,this._bindParameters.slot=s===V.Normal?le.DRAPED_WATER:le.DRAPED_MATERIAL,e.applyViewport(this._rctx),a.bind(c),e.index===ki.INNER&&(c.setClearColor(0,0,0,0),c.clearSafe(Oi.COLOR_BUFFER_BIT));const u=t.type===er.ColorNoRasterImage?jp.ExcludeRasterImage:t.type===er.Occluded?jp.OccludedOnly:jp.Normal;if(u===jp.OccludedOnly&&(this._renderContext.renderOccludedMask=dR),Wt.OVERLAY_DRAW_DEBUG_TEXTURE&&u!==jp.OccludedOnly)for(let d=0;d<n.numViews;d++)this._setViewParameters(n.extents[d],e,dg),this._drawDebugTexture(e.resolution,PSe[e.index]);return this._renderers.size>0&&this._sortedRenderers.forAll(({drapeSource:d,renderer:m})=>{if(u===jp.ExcludeRasterImage&&d.drapeSourceType===nw.RasterImage)return;const{fullOpacity:f}=d,_=y(f)&&f<1&&s===V.Color;_&&(this.bindTemporaryFramebuffer(this._rctx,o,l),c.clearSafe(Oi.COLOR_BUFFER_BIT));for(let g=0;g<n.numViews;g++)this._setViewParameters(n.extents[g],e,dg),m.render(this._renderContext,this._bindParameters);_&&y(this._temporaryFBO)&&(a.bind(c),this.view._stage.renderView.compositingHelper.compositeOverlay(this._renderContext.bindParameters,this._temporaryFBO.getTexture(),f,e.index))}),c.bindFramebuffer(null),a.generateMipMap(),this._renderContext.resetRenderOccludedMask(),!0}bindTemporaryFramebuffer(e,t,r){C(this._temporaryFBO)&&(this._temporaryFBO=new nK(e,!1)),this._temporaryFBO.resize(t,r),this._temporaryFBO.bind(e)}async reloadShaders(){await this._shaderTechniqueRepository.reloadAll()}notifyContentChanged(){this.events.emit("content-changed")}intersect(e,t,r,n){var a;let s=0;for(const o of this._renderers.values())s=((a=o.intersect)==null?void 0:a.call(o,e,t,r,n,s))??s}_updateSortedDrapeSourceRenderers(){if(this._sortedRenderers.clear(),this._renderers.size===0)return;const e=this.view.map.allLayers;this._renderers.forEach((t,r)=>{const n=e.indexOf(r.layer);this._sortedRenderers.push(new RSe(r,t,n<0?1/0:n))}),this._sortedRenderers.sort((t,r)=>t.index-r.index)}_setViewParameters(e,t,r){r.viewport[0]=r.viewport[1]=0,r.viewport[2]=r.viewport[3]=t.resolution,OG(r.projectionMatrix,0,e[2]-e[0],0,e[3]-e[1],r.near,r.far),MG(r.viewMatrix,[-e[0],-e[1],0]),this._bindParameters.camera=r}_updateHasWater(){const e=Er(this._renderers,t=>t.hasWater);e!==this._hasWater&&(this._hasWater=e,this.events.emit("has-water",e))}_updateHasHighlights(){const e=Er(this._renderers,t=>t.hasHighlights);e!==this._hasHighlights&&(this._hasHighlights=e,this.events.emit("has-highlights",e))}_updateRendersOccluded(){const e=Er(this._renderers,t=>t.rendersOccluded);e!==this._rendersOccluded&&(this._rendersOccluded=e,this.events.emit("renders-occluded",e))}_drawDebugTexture(e,t){this._ensureDebugPatternResources(e,e,t);const r=this._rctx;r.bindTechnique(this._debugTextureTechnique,this._passParameters,null),r.bindVAO(this._quadVAO),r.drawArrays(kt.TRIANGLE_STRIP,0,Ws(this._quadVAO,"geometry"))}_ensureDebugPatternResources(e,t,r){if(Y(this._passParameters.color,r[0],r[1],r[2]),this._passParameters.texture)return;const n=new Uint8Array(e*t*4);let s=0;for(let o=0;o<t;o++)for(let l=0;l<e;l++){const c=Math.floor(l/10),u=Math.floor(o/10);c<2||u<2||10*c>e-20||10*u>t-20?(n[s++]=255,n[s++]=255,n[s++]=255,n[s++]=255):(n[s++]=255,n[s++]=255,n[s++]=255,n[s++]=1&c&&1&u?1&l^1&o?0:255:1&c^1&u?0:128)}this._passParameters.texture=new Gi(this._rctx,{target:bi.TEXTURE_2D,pixelFormat:St.RGBA,dataType:Xt.UNSIGNED_BYTE,samplingMode:Jt.NEAREST,width:e,height:t},n);const a=new $4;a.hasAlpha=!0,this._debugTextureTechnique=this._shaderTechniqueRepository.acquire(L4,a),this._quadVAO=La(this._rctx)}get test(){return{drapeSourceRenderers:this._renderers,getDrapeSourceRenderer:e=>this._renderers.get(e)}}};var jp;h([p()],wh.prototype,"_sortedDrapeSourceRenderersDirty",void 0),h([Yn()],wh.prototype,"_shaderTechniqueRepository",void 0),h([Yn()],wh.prototype,"_stippleTextureRepository",void 0),h([p({constructOnly:!0})],wh.prototype,"view",void 0),h([p()],wh.prototype,"worldToPCSRatio",void 0),h([p()],wh.prototype,"spatialReference",void 0),h([p({type:Boolean,readOnly:!0})],wh.prototype,"updating",null),wh=h([F("esri.views.3d.terrain.OverlayRenderer")],wh),function(i){i[i.Normal=0]="Normal",i[i.OccludedOnly=1]="OccludedOnly",i[i.ExcludeRasterImage=2]="ExcludeRasterImage"}(jp||(jp={}));let RSe=class{constructor(e,t,r){this.drapeSource=e,this.renderer=t,this.index=r}};const PSe=[[1,.5,.5],[.5,.5,1]],dg=new vi;dg.near=1,dg.far=1e4,dg.relativeElevation=null;const D4=-2,dR=cr.OccludeAndTransparent;function F4(i,e,t,r){const n=HR(i.rings,i.hasZ,K0.CCW_IS_HOLE),s=new Float64Array(n.position.length),a=BY(n.position,i.spatialReference,0,s,0,n.position,0,n.position.length/3,e,t,r),o=a!=null;return new OSe(n.position,s,SK(n.polygons,n.position,s),CK(n.outlines,n.position,s),o,a)}function TK(i,e){const t=HR(i.rings,!1,K0.CCW_IS_HOLE),r=Ma(t.position,i.spatialReference,0,t.position,e,0,t.position.length/3);for(let n=2;n<t.position.length;n+=3)t.position[n]=D4;return{position:t.position,polygons:SK(t.polygons,t.position),outlines:CK(t.outlines,t.position),projectionSuccess:r}}function CK(i,e,t){return i.filter(({count:r})=>r>1).map(({index:r,count:n})=>{const s=3*r,a=s+3*n;return t?new ASe(r,n,e.subarray(s,a),t.subarray(s,a)):new EK(r,n,e.subarray(s,a))})}function SK(i,e,t){const r=new Array;for(const{index:n,count:s,holeIndices:a,pathLengths:o}of i){if(s<=1)continue;const l=3*n,c=l+3*s,u=a.map(d=>d-n);r.push({index:n,count:s,holeIndices:u,pathLengths:o,position:e.subarray(l,c),mapPosition:t?t.subarray(l,c):void 0})}return r}let EK=class{constructor(e,t,r){this.index=e,this.count=t,this.position=r}},ASe=class extends EK{constructor(e,t,r,n){super(e,t,r),this.mapPosition=n}},OSe=class{constructor(e,t,r,n,s,a){this.position=e,this.mapPosition=t,this.polygons=r,this.outlines=n,this.projectionSuccess=s,this.sampledElevation=a}};const MSe=["polygon","extent"];let ISe=class extends du{constructor(e,t,r,n){super(e,t,r,n),this.ensureDrapedStatus(!1)}async doLoad(){if(!this._drivenProperties.size){const o=VP(this._getSymbolSize());if(o)throw new J("graphics3dextrudesymbollayer:invalid-size",o)}const e=en(this.symbolLayer,"material","color"),t=this._getCombinedOpacityAndColor(e),r=Tl(t),n=t[3],s=n<1||this.needsDrivenTransparentPass,a={usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0,diffuse:r,ambient:r,opacity:n,transparent:s,cullFace:s?tn.None:tn.Back,hasVertexColors:!0,hasSlicePlane:this._context.slicePlaneEnabled,castShadows:this.symbolLayer.castShadows,offsetTransparentBackfaces:!0};this._material=new Ow(a),this._bottomMaterial=new Ow({...a,cullFace:tn.Back}),this._context.stage.add(this._material),this._context.stage.add(this._bottomMaterial)}destroy(){super.destroy(),this._material&&(this._context.stage.remove(this._material),this._context.stage.remove(this._bottomMaterial))}createGraphics3DGraphic(e){const t=e.graphic;if(!this._validateGeometry(t.geometry,MSe,this.symbolLayer.type))return null;const r=this._getVertexOpacityAndColor(e.renderingInfo,255),n=this.setGraphicElevationContext(t,new Qc);return this._createAs3DShape(t,e.renderingInfo,r,n,t.uid)}layerOpacityChanged(e,t){const r=en(this.symbolLayer,"material","color"),n=this._getCombinedOpacity(r),s=n<1||this.needsDrivenTransparentPass;this._material.setParameters({opacity:n,transparent:s}),this._bottomMaterial.setParameters({opacity:n,transparent:s});const a=this._getLayerOpacity();e.forEach(o=>{const l=t(o);y(l)&&l.layerOpacityChanged(a,this._context.isAsync)})}layerElevationInfoChanged(e,t){return this.updateGraphics3DGraphicElevationInfo(e,t,Bm)}slicePlaneEnabledChanged(e,t){return this._material.setParameters({hasSlicePlane:this._context.slicePlaneEnabled}),this._bottomMaterial.setParameters({hasSlicePlane:this._context.slicePlaneEnabled}),e.forEach(r=>{const n=t(r);y(n)&&n.slicePlaneEnabledChanged(this._context.slicePlaneEnabled,this._context.isAsync)}),!0}physicalBasedRenderingChanged(){return this._material.setParameters({usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0}),this._bottomMaterial.setParameters({usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0}),!0}pixelRatioChanged(){return!0}_getExtrusionSize(e){let t;return t=e.size&&this._drivenProperties.size?OCe(e.size,2)??0:this._getSymbolSize(),t/=this._context.renderCoordsHelper.unitInMeters,t}applyRendererDiff(e,t){return this._drivenPropertiesChanged(t)?Gr.Recreate_Symbol:Gr.Recreate_Graphics}async queryForSnapping(e,t,r,n){const s=this._getExtrusionSize(r)*this._context.renderCoordsHelper.unitInMeters/cie(t),{objectId:a,target:o}=e,l=Pr(o);switch(l.z=(l.z??0)+s,e.type){case"edge":{const{start:c,end:u}=e,d=Pr(c),m=Pr(u);return d.z=(d.z??0)+s,m.z=(m.z??0)+s,[pk(a,l,1/0,d,m)]}case"vertex":return[fae(a,l,1/0),pk(a,o,1/0,o,l)];default:return[]}}_getSymbolSize(){return this.symbolLayer.size??1}_createAs3DShape(e,t,r,n,s){const a=bx(e.geometry);if(C(a))return null;if(a.rings.length===0||!a.rings.some(H=>H.length>0))return this._logGeometryValidationWarnings(a.rings,"rings","ExtrudeSymbol3DLayer"),null;const o=F4(a,this._context.elevationProvider,this._context.renderCoordsHelper,n);this._logGeometryCreationWarnings(o,a.rings,"rings","ExtrudeSymbol3DLayer");const l=w4(a);if(C(l))return null;const c=new Array,u=new Array,d=new Array,m=Ms(),f=xe(),_=P(),g=this._context.renderCoordsHelper.viewingMode===Ie.Global;g||this._context.renderCoordsHelper.worldUpAtPosition(null,_),xd(a.spatialReference,[l.x,l.y,0],f,this._context.renderCoordsHelper.spatialReference);const w=xe();kn(w,f);const v=Or();yre(v,w);const{polygons:b,mapPosition:x,position:T}=o,R=T.length/3,E=new Float64Array(3*R*6),O=new Float64Array(3*R*6),$=new Float64Array(3*R*6),D=new Float64Array(1*R*6);let I=0;for(let H=0;H<b.length;++H){const M=b[H],U=M.count;if(this._context.clippingExtent&&(Ii(m),Jo(m,M.mapPosition),!Lc(m,this._context.clippingExtent)))continue;const L=$w(M.mapPosition,M.holeIndices,3);if(L.length===0)continue;const z=3*U*2+L.length,q=new Array(z),K=new Array(L.length),ie=6*U,Z=3*E.BYTES_PER_ELEMENT,ne=new Dm(E.buffer,I*Z,Z,(I+ie)*Z),Ae=3*O.BYTES_PER_ELEMENT,Fe=new Dm(O.buffer,I*Ae,Ae,(I+ie)*Ae),ze=new Float64Array($.buffer,3*I*$.BYTES_PER_ELEMENT,3*ie),Ye=new Float64Array(D.buffer,1*I*D.BYTES_PER_ELEMENT,1*ie),Ce=this._getExtrusionSize(t);LSe(T,x,L,M,ne.typedBuffer,ze,Fe.typedBuffer,Ye,q,K,Ce,_,g),EH(ne,ne,w),YE(Fe,Fe,v),I+=6*U;const Ee=this._context.stage.renderView._getObjectAndLayerIdColor({graphicUid:s,layerUid:this._context.layer.uid}),je=I8(q,q.length-K.length,{positions:ne.typedBuffer,elevation:ze,normals:Fe.typedBuffer,heights:Ye},r,Ee);c.push(je),u.push(this._material),d.push(rn);const nt=I8(K,0,{positions:ne.typedBuffer,elevation:ze,normals:Fe.typedBuffer,heights:Ye},r,Ee);c.push(nt),u.push(this._bottomMaterial),d.push(rn)}if(c.length===0)return null;const G=new Bd({geometries:c,materials:u,transformations:d,metadata:{layerUid:this._context.layer.uid,graphicUid:s,isElevationSource:!0}});G.transformation=f;const W=SH(this.symbolLayer,{opacity:this._getLayerOpacity()}),re=y(W)?{baseMaterial:this._material,edgeMaterials:[W],properties:{mergeGeometries:!0,hasSlicePlane:this._context.slicePlaneEnabled}}:null,te=new uu(this,G,c,null,null,FSe,n,re);return te.alignedSampledElevation=o.sampledElevation,te.needsElevationUpdates=Bm(n.mode),te}};function I8(i,e,t,r,n){const s=new Array(i.length).fill(0),a=[[S.POSITION,{size:3,data:t.positions,exclusive:!0}],[S.NORMAL,{size:3,data:t.normals,exclusive:!0}],[S.COLOR,{size:4,data:r,exclusive:!0}],[S.SIZE,{size:1,data:t.heights,exclusive:!0}]],o=[[S.POSITION,i],[S.NORMAL,i],[S.COLOR,s]];return t.elevation&&(a.push([S.MAPPOS,{size:3,data:t.elevation}]),o.push([S.MAPPOS,i])),new jr(a,o,Fc.Triangle,n,e)}function LSe(i,e,t,r,n,s,a,o,l,c,u,d,m){const f=t.length/3;let _=0,g=2*r.count;$Se(i,e,r.index,r.count,t,0,f,n,s,a,o,l,c,g,u,d,m);let w=2*r.count;g=0,L8(n,s,o,a,_,r.pathLengths[0],r.count,w,l,g,u),w+=4*r.pathLengths[0],g+=2*r.pathLengths[0],_+=r.pathLengths[0];for(let v=1;v<r.pathLengths.length;++v)L8(n,s,o,a,_,r.pathLengths[v],r.count,w,l,g,u),w+=4*r.pathLengths[v],g+=2*r.pathLengths[v],_+=r.pathLengths[v]}function $Se(i,e,t,r,n,s,a,o,l,c,u,d,m,f,_,g,w){X(oa,g);const v=_>0?1:-1;let b=3*t,x=0,T=3*x,R=r,E=3*R;for(let D=0;D<r;++D)w&&(oa[0]=i[b+0],oa[1]=i[b+1],oa[2]=i[b+2],de(oa,oa)),o[T+0]=i[b+0],o[T+1]=i[b+1],o[T+2]=i[b+2],l[T+0]=e[b+0],l[T+1]=e[b+1],l[T+2]=e[b+2],c[T+0]=-v*oa[0],c[T+1]=-v*oa[1],c[T+2]=-v*oa[2],u[x]=0,o[E+0]=i[b+0]+_*oa[0],o[E+1]=i[b+1]+_*oa[1],o[E+2]=i[b+2]+_*oa[2],l[E+0]=e[b+0],l[E+1]=e[b+1],l[E+2]=e[b+2],c[E+0]=v*oa[0],c[E+1]=v*oa[1],c[E+2]=v*oa[2],u[R]=_,T+=3,E+=3,b+=3,x+=1,R+=1;b=3*s,T=0,E=3*f;const O=_<0?V8:k8,$=_<0?k8:V8;for(let D=0;D<a;++D)m[T+0]=n[b+O[0]],m[T+1]=n[b+O[1]],m[T+2]=n[b+O[2]],d[E+0]=n[b+$[0]]+r,d[E+1]=n[b+$[1]]+r,d[E+2]=n[b+$[2]]+r,T+=3,E+=3,b+=3}function $C(i,e,t,r,n,s,a){r[s]=r[a],a*=3,i[(s*=3)+0]=i[a+0],i[s+1]=i[a+1],i[s+2]=i[a+2],e[s+0]=e[a+0],e[s+1]=e[a+1],e[s+2]=e[a+2],t[s+0]=n[0],t[s+1]=n[1],t[s+2]=n[2]}const v1=P();function L8(i,e,t,r,n,s,a,o,l,c,u){let d=n,m=n+1,f=n+a,_=n+a+1,g=o,w=o+1,v=o+2*s,b=o+2*s+1;u<0&&(d=n+a+1,_=n),c*=3;for(let x=0;x<s;++x)x===s-1&&(u>0?(m=n,_=n+a):(m=n,d=n+a)),DSe(i,d,m,f,v1),$C(i,e,r,t,v1,g,d),$C(i,e,r,t,v1,w,m),$C(i,e,r,t,v1,v,f),$C(i,e,r,t,v1,b,_),l[c++]=g,l[c++]=v,l[c++]=b,l[c++]=g,l[c++]=b,l[c++]=w,d++,m++,f++,_++,g+=2,w+=2,v+=2,b+=2}const vM=P(),$8=P(),D8=P(),F8=P(),N8=P();function DSe(i,e,t,r,n){e*=3,t*=3,r*=3,Y(vM,i[e++],i[e++],i[e++]),Y($8,i[t++],i[t++],i[t++]),Y(D8,i[r++],i[r++],i[r++]),ae(F8,$8,vM),ae(N8,D8,vM),ut(n,N8,F8),de(n,n)}const j_=P();function FSe(i,e,t,r){const n=i.stageObject,s=n.geometryRecords,a=s.length,o=e.mode!=="absolute-height";let l=0;const c=n.transformation,u=kn(xe(),c);for(let d=0;d<a;d+=2){const m=s[d].geometry,f=m.getMutableAttribute(S.POSITION).data,_=m.vertexAttributes.get(S.SIZE).data,g=m.vertexAttributes.get(S.MAPPOS).data,w=new cY(g),v=f.length/3;let b=0,x=!1,T=0;const R=t.spatialReference;for(let E=0;E<v;E++){j_[0]=f[b],j_[1]=f[b+1],j_[2]=f[b+2],$d(w,t,e,r,DC),o&&(T+=DC.sampledElevation),Wt.TESTS_DISABLE_OPTIMIZATIONS?(Y(Va,w.array[w.offset+0],w.array[w.offset+1],DC.z+_[b/3]),y(R)&&r.toRenderCoords(Va,R,Va),Me(Va,Va,u)):(Y(Va,f[b+0],f[b+1],f[b+2]),Me(Va,Va,c),r.setAltitude(Va,DC.z+_[b/3]),Me(Va,Va,u)),f[b]=Va[0],f[b+1]=Va[1],f[b+2]=Va[2];const O=NSe/r.unitInMeters;(Math.abs(j_[0]-f[b])>=O||Math.abs(j_[1]-f[b+1])>=O||Math.abs(j_[2]-f[b+2])>=O)&&(x=!0),w.offset+=3,b+=3}x&&(m.invalidateBoundingInfo(),n.geometryVertexAttrsUpdated(s[d]),s[d+1].geometry.invalidateBoundingInfo(),n.geometryVertexAttrsUpdated(s[d+1])),l+=T/v}return l/a}const Va=P(),oa=P(),DC=new aT,k8=[0,2,1],V8=[0,1,2],NSe=.01,Rze=1.2,kSe=C0;let jP=class{constructor(e,t,r,n){this.graphics3DSymbolLayer=e,this.renderGeometries=t,this.boundingBox=r,this._drapeSourceRenderer=n,this.type="draped",this.stage=null,this._visible=!1,this._addedToStage=!1,this.isElevationSource=!1}initialize(e){this.stage=e}setVisibility(e){if(this.stage!=null&&this._visible!==e){if(this._visible=e,e&&!this._addedToStage)return this._addedToStage=!0,void this._drapeSourceRenderer.addGeometries(this.renderGeometries,Fi.ADD);if(e||this._addedToStage){for(const t of this.renderGeometries)t.instanceParameters.visible=this._visible;this._drapeSourceRenderer.modifyGeometries(this.renderGeometries,Ur.VISIBILITIES)}}}destroy(){this.stage&&this._addedToStage&&this._drapeSourceRenderer.removeGeometries(this.renderGeometries,Fi.REMOVE),this._addedToStage=!1,this._visible=!1,this.stage=null}getCenterObjectSpace(e=P()){return Y(e,0,0,0)}getBoundingBoxObjectSpace(e=Ms()){return Ii(e)}addObjectState(e,t){e===Dg.Highlight&&(this.renderGeometries.forEach(r=>{const n=r.addHighlight();t.addRenderGeometry(r,n,this)}),this._addedToStage&&this._drapeSourceRenderer.modifyGeometries(this.renderGeometries,Ur.HIGHLIGHTS))}removeObjectState(e){this.renderGeometries.forEach(t=>{e.removeRenderGeometry(t)})}removeRenderGeometryObjectState(e,t){e.removeHighlight(t),this._addedToStage&&this._drapeSourceRenderer.modifyGeometries(this.renderGeometries,Ur.HIGHLIGHTS)}computeAttachmentOrigin(e){for(const t of this.renderGeometries)t.computeAttachmentOrigin(q_)&&(e.draped.origin[0]+=q_[0],e.draped.origin[1]+=q_[1],e.draped.num++)}async getProjectedBoundingBox(e,t,r,n,s){Ii(s);for(let a=0;a<this.renderGeometries.length;a++){const o=this.renderGeometries[a];this._getRenderGeometryProjectedBoundingRect(o,e,U8,r),eae(s,U8)}if(t){let a;Ic(s,q_);const o=x4(s,t.service.spatialReference,t);try{a=await t.service.queryElevation(q_[0],q_[1],n,o,"ground")}catch{}y(a)&&(s[2]=Math.min(s[2],a),s[5]=Math.max(s[5],a))}return s}_getRenderGeometryProjectedBoundingRect(e,t,r,n){if(this.boundingBox)rF(sh,this.boundingBox);else{const s=e.boundingSphere,a=s[3];sh[0]=s[0]-a,sh[1]=s[1]-a,sh[2]=s[2]-a,sh[3]=s[0]+a,sh[4]=s[1]+a,sh[5]=s[2]+a}return t(sh,0,2),this.calculateRelativeScreenBounds&&n.push({location:Ic(sh),screenSpaceBoundingRect:this.calculateRelativeScreenBounds()}),eF(sh,r)}};const U8=Nt(),sh=Ms(),q_=P();let RK=class{constructor(e,t,r,n=2048){this.text=e,this._alignment=t,this._parameters=r,this._maxSize=n,this._textWidths=[],this._lineWidths=[],this._renderPixelRatio=null,this._displayWidth=null,this._heightMetricsCached=null,this.key=`TextRenderer-${this._parameters.key}-${this._alignment}--${e}`,this._lines=e.split(/\r?\n/)}get displayWidth(){return Math.ceil(this._ensureTextWidth()+2*this._backgroundHorizontalPadding)}get displayHeight(){const e=this._lineSpacing*(this._lines.length-1),t=this._lineHeight;return Math.ceil(e+t+2*this._haloSize+this._backgroundTopPadding+this._backgroundBottomPadding)}get renderedWidth(){return Math.ceil(this._toRenderUnit(this.displayWidth))}get renderedHeight(){return Math.ceil(this._toRenderUnit(this.displayHeight))}get firstRenderedBaselinePosition(){return this._toRenderUnit(this._firstLineYOffset+this._baselinePosition)}get _firstLineYOffset(){return this._backgroundTopPadding+this._haloSize}get _heightMetrics(){return this._ensureHeightMetrics()}get _lineSpacing(){return(this._lineHeight+this._linePadding)*this._parameters.definition.lineSpacingFactor}get _lineHeight(){return this._heightMetrics.lineHeight}get _linePadding(){return this._lineHeight*VSe}get _baselinePosition(){return this._heightMetrics.baselinePosition}get _renderedFontSize(){return this._toRenderUnit(this._fontSize)}get _fontSize(){return this._parameters.definition.size}get _renderedHaloSize(){return this._toRenderUnit(this._haloSize)}get _haloSize(){return this._parameters.haloSize}get _backgroundHorizontalPadding(){return this._hasBackground?this._parameters.definition.background.padding[0]:0}get _backgroundVerticalPadding(){return this._hasBackground?this._parameters.definition.background.padding[1]:0}get _backgroundTopPadding(){return Math.max(0,this._backgroundVerticalPadding-this._heightMetrics.paddingTop)}get _backgroundBottomPadding(){return Math.max(0,this._backgroundVerticalPadding-this._heightMetrics.paddingBottom)}get _hasBackground(){return!!this._parameters.backgroundStyle}get renderPixelRatio(){if(C(this._renderPixelRatio)){const e=this._parameters.definition.pixelRatio;this._maxSize>0?this._renderPixelRatio=Math.min(e,Math.min(this._maxSize/this.displayWidth,this._maxSize/this.displayHeight)):this._renderPixelRatio=e}return this._renderPixelRatio}_getLineXOffset(e){switch(this._alignment){case Cm.Left:return this._backgroundHorizontalPadding;case Cm.Center:return(this.displayWidth-this._lineWidths[e])/2;case Cm.Right:return this.displayWidth-this._backgroundHorizontalPadding-this._lineWidths[e]}}render(e,t=0,r=0){e.save();const n=t/=this.renderPixelRatio,s=r/=this.renderPixelRatio,a=this._haloSize,o=this._firstLineYOffset;t+=a,r+=o+this._baselinePosition;const l=this._haloSize>0;l&&this._renderHalo(e,n,s,a,o),this._setFontProperties(e,this._renderedFontSize);for(let c=0;c<this._lines.length;++c){const u=this._lines[c],d=this._getLineXOffset(c);l&&(e.globalCompositeOperation="destination-out",e.fillStyle="rgb(0, 0, 0)",this._fillText(e,u,t+d,r),this._renderLineDecoration(e,t+d,r,this._textWidths[c])),e.globalCompositeOperation="source-over",e.fillStyle=this._parameters.textStyle,this._fillText(e,u,t+this._getLineXOffset(c),r),this._renderLineDecoration(e,t+d,r,this._textWidths[c]),r+=this._lineSpacing}if(Wt.TEXT_SHOW_BASELINE){e.strokeStyle=z8,e.setLineDash([2,2]),e.lineWidth=1;let c=s+o;for(let u=0;u<this._lines.length;++u){const d=c+this._baselinePosition;this._drawLine(e,[n,d],[n+this.displayWidth,d]),c+=this._lineSpacing}}if(Wt.TEXT_SHOW_BORDER&&(e.strokeStyle=z8,e.setLineDash([]),e.lineWidth=1,this._drawBox(e,[n,s],[this.displayWidth,this.displayHeight])),this._hasBackground){const c=this._parameters.definition.background.borderRadius*this.renderPixelRatio;this._roundedRect(e,n,s,c),e.globalCompositeOperation="destination-over",e.fillStyle=this._parameters.backgroundStyle,e.fill()}e.restore()}_renderLineDecoration(e,t,r,n,s=!1){if(this._parameters.definition.font.decoration==="none"||n===0)return;const a=1,o=Math.max(this._parameters.definition.size/16,a);switch(this._parameters.definition.font.decoration){case"underline":r+=2*o;break;case"line-through":r-=.33*this._baselinePosition}const l=s?this._haloSize:0;e.strokeStyle=s?this._parameters.haloStyle:this._parameters.textStyle,e.lineWidth=this._toRenderUnit(o+2*l),e.beginPath(),e.moveTo(this._toRenderUnit(t-l),this._toRenderUnit(r)),e.lineTo(this._toRenderUnit(t+n+l),this._toRenderUnit(r)),e.stroke()}_roundedRect(e,t,r,n){t=this._toRenderUnit(t),r=this._toRenderUnit(r);const s=this.renderedWidth,a=this.renderedHeight;n!==0?(n=ue(n,0,Math.floor(a/2)),e.beginPath(),e.moveTo(t,r+n),e.arcTo(t,r,t+n,r,n),e.lineTo(t+s-n,r),e.arcTo(t+s,r,t+s,r+n,n),e.lineTo(t+s,r+a-n),e.arcTo(t+s,r+a,t+s-n,r+a,n),e.lineTo(t+n,r+a),e.arcTo(t,r+a,t,r+a-n,n),e.closePath()):e.rect(t,r,s,a)}_renderHalo(e,t,r,n,s){const a=this.renderedWidth,o=this.renderedHeight,l=fE(bM,Math.max(a,W_),Math.max(o,W_)),c=l.getContext("2d");c.clearRect(0,0,a,o),this._setFontProperties(c,this._renderedFontSize),c.fillStyle=this._parameters.haloStyle,c.strokeStyle=this._parameters.haloStyle;const u=this._renderedHaloSize<3;c.lineJoin=u?"miter":"round",u?this._renderHaloEmulated(c,n,s):this._renderHaloNative(c,n,s);let d=s+this._baselinePosition;for(let m=0;m<this._lines.length;++m){const f=this._getLineXOffset(m);this._renderLineDecoration(c,n+f,d,this._textWidths[m],!0),d+=this._lineSpacing}e.globalAlpha=this._parameters.definition.halo.color[3],e.drawImage(l,0,0,a,o,this._toRenderUnit(t),this._toRenderUnit(r),a,o),e.globalAlpha=1}_renderHaloEmulated(e,t,r){r+=this._baselinePosition;for(let n=0;n<this._lines.length;++n){const s=this._lines[n],a=this._getLineXOffset(n);for(const[o,l]of PK)this._fillText(e,s,t+a+this._haloSize*o,r+this._haloSize*l);r+=this._lineSpacing}}_renderHaloNative(e,t,r){const n=2*this._haloSize;r+=this._baselinePosition;for(let s=0;s<this._lines.length;++s){const a=this._lines[s],o=this._getLineXOffset(s),l=5,c=.1;for(let u=0;u<l;u++){const d=1-(l-1)*c+u*c;e.lineWidth=this._toRenderUnit(d*n),this._strokeText(e,a,t+o,r)}r+=this._lineSpacing}}_setFontProperties(e,t){e.font=this._parameters.fontString(t),e.textAlign="left",e.textBaseline="alphabetic"}_ensureTextWidth(){if(y(this._displayWidth))return this._displayWidth;const e=fE(bM,W_,W_).getContext("2d");this._setFontProperties(e,this._fontSize);let t=2*this._haloSize;const r=this._parameters.definition.font;r.style!=="italic"&&r.style!=="oblique"&&r.weight!=="bold"&&r.weight!=="bolder"||(t+=.3*e.measureText("A").width),this._textWidths.length=0,this._lineWidths.length=0;let n=0;for(const s of this._lines){const a=e.measureText(s).width,o=a+t;this._textWidths.push(a),this._lineWidths.push(o),n=Math.max(n,o)}return this._displayWidth=n,this._displayWidth}_ensureHeightMetrics(){if(C(this._heightMetricsCached)){const e=fE(bM,W_,W_).getContext("2d");this._setFontProperties(e,this._fontSize);const t=e.measureText(this.text+USe),r=this._hasBackground?e.measureText(this._lines[0]):t,n=this._lines.length===1?r:this._hasBackground?e.measureText(this._lines[this._lines.length-1]):t,s=t.actualBoundingBoxAscent+t.actualBoundingBoxDescent;this._heightMetricsCached={paddingTop:t.actualBoundingBoxAscent-r.actualBoundingBoxAscent,paddingBottom:t.actualBoundingBoxDescent-n.actualBoundingBoxDescent,lineHeight:s,baselinePosition:t.actualBoundingBoxAscent}}return this._heightMetricsCached}_toRenderUnit(e){return e*this.renderPixelRatio}_toRoundedRenderUnit(e){return Math.round(e*this.renderPixelRatio)}_fillText(e,t,r,n){e.fillText(t,this._toRenderUnit(r),this._toRenderUnit(n))}_strokeText(e,t,r,n){e.strokeText(t,this._toRenderUnit(r),this._toRenderUnit(n))}_drawLine(e,t,r){e.beginPath(),e.moveTo(this._toRoundedRenderUnit(t[0])+.5,this._toRoundedRenderUnit(t[1])+.5),e.lineTo(this._toRoundedRenderUnit(r[0])+.5,this._toRoundedRenderUnit(r[1])+.5),e.stroke()}_drawBox(e,t,r){const n=this._toRenderUnit(t[0]),s=this._toRenderUnit(t[1]),a=this._toRenderUnit(r[0]),o=this._toRenderUnit(r[1]),l=Math.floor(n)+.5,c=Math.ceil(n+a)-.5,u=Math.floor(s)+.5,d=Math.ceil(s+o)-.5;e.beginPath(),e.moveTo(l,u),e.lineTo(c,u),e.lineTo(c,d),e.lineTo(l,d),e.lineTo(l,u),e.stroke()}};const PK=[];for(let e=0;e<360;e+=360/16)PK.push([Math.cos(Math.PI*e/180),Math.sin(Math.PI*e/180)]);var Cm;function fE(i,e,t){return i.canvas||(i.canvas=document.createElement("canvas")),i.canvas.width=e,i.canvas.height=t,i.canvas}(function(i){i[i.Left=0]="Left",i[i.Center=1]="Center",i[i.Right=2]="Right"})(Cm||(Cm={}));const bM={canvas:null},VSe=.2,W_=512,z8="rgb(255, 0, 255, 0.5)",USe=(()=>{let i="";for(let e=32;e<127;e++)i+=String.fromCharCode(e);return i})(),zSe=Object.freeze({left:0,center:.5,right:1}),gE=Object.freeze({"bottom-left":Qt(0,0),bottom:Qt(.5,0),"bottom-right":Qt(1,0),left:Qt(0,.5),center:Qt(.5,.5),right:Qt(1,.5),"top-left":Qt(0,1),top:Qt(.5,1),"top-right":Qt(1,1)});function AK(i){switch(i){case"left":return Cm.Left;case"right":return Cm.Right;default:return Cm.Center}}function B8(i){switch(i){case"bottom-left":case"left":case"top-left":return"left";case"bottom":case"center":case"top":return"center";case"bottom-right":case"right":case"top-right":return"right"}}function BSe(i){switch(i){case"bottom-left":case"bottom":case"bottom-right":return"bottom";case"left":case"center":case"right":return"center";case"top-left":case"top":case"top-right":return"top"}}function GSe(i,e){switch(e){case"bottom":return i==="left"?"bottom-left":i==="right"?"bottom-right":"bottom";case"center":return i;case"top":return i==="left"?"top-left":i==="right"?"top-right":"top"}}function HSe(i){return i==="middle"?"center":i}var Ss,G8,pR;function b1(i){return i!=null}function X_(i){return typeof i=="number"}function qP(i){return typeof i=="string"}function jSe(i){return i==null||qP(i)}function Br(i,e){i&&i.push(e)}function qSe(i,e,t,r=xe()){const n=i||0,s=e||0,a=t||0;return n!==0&&Tw(r,r,-n/180*Math.PI),s!==0&&Cw(r,r,s/180*Math.PI),a!==0&&MD(r,r,a/180*Math.PI),r}function op(i,e,t,r,n){const s=i.minSize,a=i.maxSize;if(i.expression)return Br(n,"Could not convert size info: expression not supported"),!1;if(i.useSymbolValue){const o=r.symbolSize[t];return e.minSize[t]=o,e.maxSize[t]=o,e.offset[t]=e.minSize[t],e.factor[t]=0,e.type[t]=Ss.DefinedSize,!0}if(b1(i.field))return b1(i.stops)?i.stops.length===2&&X_(i.stops[0].size)&&X_(i.stops[1].size)?(H8(i.stops[0].size,i.stops[1].size,i.stops[0].value,i.stops[1].value,e,t),e.type[t]=Ss.DefinedSize,!0):(Br(n,"Could not convert size info: stops only supported with 2 elements"),!1):X_(s)&&X_(a)&&b1(i.minDataValue)&&b1(i.maxDataValue)?(H8(s,a,i.minDataValue,i.maxDataValue,e,t),e.type[t]=Ss.DefinedSize,!0):mk[i.valueUnit]!=null?(e.minSize[t]=-1/0,e.maxSize[t]=1/0,e.offset[t]=0,e.factor[t]=1/mk[i.valueUnit],e.type[t]=Ss.DefinedSize,!0):i.valueUnit==="unknown"?(Br(n,"Could not convert size info: proportional size not supported"),!1):(Br(n,"Could not convert size info: scale-dependent size not supported"),!1);if(!b1(i.field)){if(i.stops&&i.stops[0]&&X_(i.stops[0].size))return e.minSize[t]=i.stops[0].size,e.maxSize[t]=i.stops[0].size,e.offset[t]=e.minSize[t],e.factor[t]=0,e.type[t]=Ss.DefinedSize,!0;if(X_(s))return e.minSize[t]=s,e.maxSize[t]=s,e.offset[t]=s,e.factor[t]=0,e.type[t]=Ss.DefinedSize,!0}return Br(n,"Could not convert size info: unsupported variant of sizeInfo"),!1}function H8(i,e,t,r,n,s){const a=Math.abs(r-t)>0?(e-i)/(r-t):0;n.minSize[s]=a>0?i:e,n.maxSize[s]=a>0?e:i,n.offset[s]=i-t*a,n.factor[s]=a}function WSe(i,e,t,r){if(i.normalizationField||i.valueRepresentation)return Br(r,"Could not convert size info: unsupported property"),null;if(!jSe(i.field))return Br(r,"Could not convert size info: field is not a string"),null;if(e.size){if(i.field)if(e.size.field){if(i.field!==e.size.field)return Br(r,"Could not convert size info: multiple fields in use"),null}else e.size.field=i.field}else e.size={field:i.field,minSize:[0,0,0],maxSize:[0,0,0],offset:[0,0,0],factor:[0,0,0],type:[Ss.Undefined,Ss.Undefined,Ss.Undefined]};let n;switch(i.axis){case"width":return n=op(i,e.size,0,t,r),n?e:null;case"height":return n=op(i,e.size,2,t,r),n?e:null;case"depth":return n=op(i,e.size,1,t,r),n?e:null;case"width-and-depth":return n=op(i,e.size,0,t,r),n&&op(i,e.size,1,t,r),n?e:null;case null:case void 0:case"all":return n=op(i,e.size,0,t,r),n=n&&op(i,e.size,1,t,r),n=n&&op(i,e.size,2,t,r),n?e:null;default:return Br(r,`Could not convert size info: unknown axis "${i.axis}""`),null}}function XSe(i,e,t){for(let n=0;n<3;++n){let s=e.unitInMeters;i.type[n]===Ss.DefinedSize&&(s*=e.modelSize[n],i.type[n]=Ss.DefinedScale),i.minSize[n]=i.minSize[n]/s,i.maxSize[n]=i.maxSize[n]/s,i.offset[n]=i.offset[n]/s,i.factor[n]=i.factor[n]/s}let r;if(i.type[0]!==Ss.Undefined)r=0;else if(i.type[1]!==Ss.Undefined)r=1;else{if(i.type[2]===Ss.Undefined)return Br(t,"No size axis contains a valid size or scale"),!1;r=2}for(let n=0;n<3;++n)i.type[n]===Ss.Undefined&&(i.minSize[n]=i.minSize[r],i.maxSize[n]=i.maxSize[r],i.offset[n]=i.offset[r],i.factor[n]=i.factor[r],i.type[n]=i.type[r]);return!0}function j8(i,e,t){i[4*e+0]=t.r/255,i[4*e+1]=t.g/255,i[4*e+2]=t.b/255,i[4*e+3]=t.a}function QSe(i,e,t){if(i.normalizationField)return Br(t,"Could not convert color info: unsupported property"),null;if(qP(i.field)){if(!i.stops)return Br(t,"Could not convert color info: missing stops or colors"),null;{if(i.stops.length>8)return Br(t,"Could not convert color info: too many color stops"),null;e.color={field:i.field,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};const r=i.stops;for(let n=0;n<8;++n){const s=r[Math.min(n,r.length-1)];e.color.values[n]=s.value,j8(e.color.colors,n,s.color)}}}else{if(!(i.stops&&i.stops.length>=0))return Br(t,"Could not convert color info: no field and no colors/stops"),null;{const r=i.stops&&i.stops.length>=0&&i.stops[0].color;e.color={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};for(let n=0;n<8;n++)e.color.values[n]=1/0,j8(e.color.colors,n,r)}}return e}function ZSe(i,e,t){if(i.normalizationField)return Br(t,"Could not convert opacity info: unsupported property"),null;if(qP(i.field)){if(!i.stops)return Br(t,"Could not convert opacity info: missing stops or opacities"),null;{if(i.stops.length>8)return Br(t,"Could not convert opacity info: too many opacity stops"),null;e.opacity={field:i.field,values:[0,0,0,0,0,0,0,0],opacityValues:[0,0,0,0,0,0,0,0]};const r=i.stops;for(let n=0;n<8;++n){const s=r[Math.min(n,r.length-1)];e.opacity.values[n]=s.value,e.opacity.opacityValues[n]=s.opacity}}}else{if(!(i.stops&&i.stops.length>=0))return Br(t,"Could not convert opacity info: no field and no opacities/stops"),null;{const r=i.stops&&i.stops.length>=0&&i.stops[0].opacity;e.opacity={field:null,values:[0,0,0,0,0,0,0,0],opacityValues:[0,0,0,0,0,0,0,0]};for(let n=0;n<8;n++)e.opacity.values[n]=1/0,e.opacity.opacityValues[n]=r}}return e}function wM(i,e,t){const r=t===2&&i.rotationType==="arithmetic";e.offset[t]=r?90:0,e.factor[t]=r?-1:1,e.type[t]=1}function YSe(i,e,t){if(!qP(i.field))return Br(t,"Could not convert rotation info: field is not a string"),null;if(e.rotation){if(i.field)if(e.rotation.field){if(i.field!==e.rotation.field)return Br(t,"Could not convert rotation info: multiple fields in use"),null}else e.rotation.field=i.field}else e.rotation={field:i.field,offset:[0,0,0],factor:[1,1,1],type:[0,0,0]};switch(i.axis){case"tilt":return wM(i,e.rotation,0),e;case"roll":return wM(i,e.rotation,1),e;case null:case void 0:case"heading":return wM(i,e.rotation,2),e;default:return Br(t,`Could not convert rotation info: unknown axis "${i.axis}""`),null}}function OK(i,e,t){if(!i)return null;const r=!e.supportedTypes||!!e.supportedTypes.size,n=!e.supportedTypes||!!e.supportedTypes.color,s=!e.supportedTypes||!!e.supportedTypes.rotation,a=!!e.supportedTypes&&!!e.supportedTypes.opacity,o=i.reduce((l,c)=>{if(!l)return l;if(c.valueExpression)return Br(t,"Could not convert visual variables: arcade expressions not supported"),null;switch(c.type){case"size":return r?WSe(c,l,e,t):l;case"color":return n?QSe(c,l,t):l;case"opacity":return a?ZSe(c,l,t):null;case"rotation":return s?YSe(c,l,t):l;default:return null}},{size:null,color:null,opacity:null,rotation:null});return!(i.length>0&&o)||o.size||o.color||o.opacity||o.rotation?o&&o.size&&!XSe(o.size,e,t)?null:o:null}function N4(i){return i&&i.size!=null}function wx(i,e){if(!i)return{enabled:!1};if(Wt.TESTS_DISABLE_FAST_UPDATES)return{enabled:!1};const t=OK(i.visualVariables,e);return t?{enabled:!0,visualVariables:t,materialParameters:MK(t,e),requiresShaderTransformation:N4(t)}:{enabled:!1}}function xx(i,e,t){if(!e||!i.enabled)return!1;const r=i.visualVariables,n=OK(e.visualVariables,t);return!!n&&!!(FC(r.size,n.size,"size")&&FC(r.color,n.color,"color")&&FC(r.rotation,n.rotation,"rotation")&&FC(r.opacity,n.opacity,"opacity"))&&(i.visualVariables=n,i.materialParameters=MK(n,t),i.requiresShaderTransformation=N4(n),!0)}function FC(i,e,t){if(!!i!=!!e||i&&i.field!==e.field)return!1;if(i&&t==="rotation"){const r=i,n=e;for(let s=0;s<3;s++)if(r.type[s]!==n.type[s]||r.offset[s]!==n.offset[s]||r.factor[s]!==n.factor[s])return!1}return!0}function MK(i,e){const t={vvSizeEnabled:!1,vvSizeMinSize:null,vvSizeMaxSize:null,vvSizeOffset:null,vvSizeFactor:null,vvSizeValue:null,vvColorEnabled:!1,vvColorValues:null,vvColorColors:null,vvOpacityEnabled:!1,vvOpacityValues:null,vvOpacityOpacities:null,vvSymbolAnchor:null,vvSymbolRotationMatrix:null},r=N4(i);return i&&i.size?(t.vvSizeEnabled=!0,t.vvSizeMinSize=i.size.minSize,t.vvSizeMaxSize=i.size.maxSize,t.vvSizeOffset=i.size.offset,t.vvSizeFactor=i.size.factor):i&&r&&(t.vvSizeValue=e.transformation.scale),i&&r&&(t.vvSymbolAnchor=e.transformation.anchor,t.vvSymbolRotationMatrix=Or(),Mg(ow),qSe(e.transformation.rotation[2],e.transformation.rotation[0],e.transformation.rotation[1],ow),Td(t.vvSymbolRotationMatrix,ow)),i&&i.color&&(t.vvColorEnabled=!0,t.vvColorValues=i.color.values,t.vvColorColors=i.color.colors),i&&i.opacity&&(t.vvOpacityEnabled=!0,t.vvOpacityValues=i.opacity.values,t.vvOpacityOpacities=i.opacity.opacityValues),t}(function(i){i[i.Undefined=0]="Undefined",i[i.DefinedSize=1]="DefinedSize",i[i.DefinedScale=2]="DefinedScale"})(Ss||(Ss={})),function(i){i[i.Undefined=0]="Undefined",i[i.DefinedAngle=1]="DefinedAngle"}(G8||(G8={})),function(i){const e=xe(),t=P();function r(s,a,o){if(!s.vvSizeEnabled)return o;pn(e,o);const l=s.vvSymbolRotationMatrix;IG(ow,l[0],l[1],l[2],0,l[3],l[4],l[5],0,l[6],l[7],l[8],0,0,0,0,1),Hr(e,e,ow);for(let c=0;c<3;++c){const u=s.vvSizeOffset[c]+a[0]*s.vvSizeFactor[c];t[c]=ue(u,s.vvSizeMinSize[c],s.vvSizeMaxSize[c])}return LG(e,e,t),ru(e,e,s.vvSymbolAnchor),e}function n(s,a,o){if(!a.vvSizeEnabled)return Y(s,1,1,1);for(let l=0;l<3;++l){const c=a.vvSizeOffset[l]+o[0]*a.vvSizeFactor[l];s[l]=ue(c,a.vvSizeMinSize[l],a.vvSizeMaxSize[l])}return s}i.evaluateModelTransform=r,i.evaluateModelTransformScale=n}(pR||(pR={}));const ow=xe(),p$=pR.evaluateModelTransform,KSe=pR.evaluateModelTransformScale;let JSe=class{constructor(){this.visible=!0}},pv=class{constructor(e,t,r={}){this.data=e,this.material=t,this.boundingSphere=yi(),this.instanceParameters=new JSe,this._transformation=xe(),this._shaderTransformationDirty=!0,this.layerUid=Ke(r.layerUid,null),this.graphicUid=Ke(r.graphicUid,null),this.id=r.id?r.id:Sm(),this.boundingInfo=Ke(r.boundingInfo,null),this.calculateShaderTransformation=Ke(r.calculateShaderTransformation,null),this.castShadow=!!r.castShadow&&r.castShadow}get transformation(){return this._transformation}updateTransformation(e){e(this._transformation),this._shaderTransformationDirty=!0,this.computeBoundingSphere(this._transformation,this.boundingSphere)}shaderTransformationChanged(){this._shaderTransformationDirty=!0}computeBoundingSphere(e,t,r=Gg(e)){C(this.boundingInfo)||(Me(t,this.boundingInfo.getCenter(),e),t[3]=this.boundingInfo.getBSRadius()*r)}get hasShaderTransformation(){return y(this.calculateShaderTransformation)}get primitiveType(){return this.data.primitiveType}getShaderTransformation(){return C(this.calculateShaderTransformation)?Ke(this.transformation,rn):(this._shaderTransformationDirty&&(this._shaderTransformation||(this._shaderTransformation=xe()),pn(this._shaderTransformation,this.calculateShaderTransformation(Ke(this.transformation,rn))),this._shaderTransformationDirty=!1),this._shaderTransformation)}computeAttachmentOrigin(e){if(this.material.computeAttachmentOrigin)return!!this.material.computeAttachmentOrigin(this,e)&&(y(this._transformation)&&Me(e,e,this._transformation),!0);const t=this.indices.get(S.POSITION),r=this.vertexAttributes.get(S.POSITION);return!!dse(r,t,e)&&(y(this._transformation)&&Me(e,e,this._transformation),!0)}get indices(){return this.data.indices}get vertexAttributes(){return this.data.vertexAttributes}addHighlight(){const e=new hR(Dg.Highlight),t=this.instanceParameters;return t.highlights=kI(t.highlights,e),e}removeHighlight(e){const t=this.instanceParameters;t.highlights=VI(t.highlights,e)}};const eEe=xe(),q8=Ze(0,0,1),tEe=16,iEe=1.5,pg=Nae,rEe=[pg/2,pg/2,1-pg/2,1-pg/2],nEe=[fk*pg,fk*pg];let m$=class IK extends du{constructor(e,t,r,n){super(e,t,r,n),this._cimLayers=null,this._cimSymbolMaterials=new Map,this._cimSymbolTextures=new Map,this._cimMaterialParametersInfo=null,this._cimRequiredFields=null,this._cimScaleFactorOrFunction=null,this._size=null,this._symbolTextureRatio=1,this._outlineSize=0,this._elevationOptions={supportsOffsetAdjustment:!0,supportsOnTheGround:!0}}getCachedSize(){return{size:this._getIconSize()}}async doLoad(e){this._validateOrThrow();const t=this._prepareMaterialParameters(),r=this._getPrimitive();if(y(r))this._prepareResourcesPrimitive(t,r);else{const n=Rie(this.symbol,this.symbolLayer),s=sG(n);s&&s.mediaType==="application/json"?await this._prepareResourcesCIM(t,JSON.parse(s.data),e):await this._prepareResourcesHref(t,n,e)}}_validateOrThrow(){if(this._drivenProperties.size)return;const e=VP(this._getIconSize());if(e)throw new J("graphics3diconsymbollayer:invalid-size",e)}_getIconSize(){const e=this.symbolLayer,t=Math.round(e.size!=null?Sa(e.size):tEe);return this._drivenProperties.size?Math.max(t,64):t}_generateTextureCIM(e){const t=this._getGraphicHash(e);let r=t===""?null:this._cimSymbolTextures.get(t);if(!r){const n={scaleFactor:this._cimScaleFactorOrFunction},s=this._context.sharedResources.cimSymbolRasterizer.rasterizeCIMSymbol3D(this._cimLayers,e,"esriGeometryPoint",n,null,null);this._cimMaterialParametersInfo.anchorPosition=this._getAnchorPos("relative",s.anchorPosition);const a={width:s.imageData.width,height:s.imageData.height,powerOfTwoResizeMode:YD.PAD};r=new jR(s.imageData,a),this._cimSymbolTextures.set(t,r),this._context.stage.add(r)}return r}_computeSize(e,t){const r=e.width/e.height;return r>1?[t,Math.round(t/r)]:[Math.round(t*r),t]}_prepareMaterialParameters(){const e={anchorPosition:this._getAnchorPos(this.symbolLayer.anchor,this.symbolLayer.anchorPosition)},t=this.symbol;if(sEe(t)){const{screenLength:r,minWorldLength:n,maxWorldLength:s}=t.verticalOffset;e.verticalOffset={screenLength:Sa(r),minWorldLength:n||0,maxWorldLength:y(s)?s:1/0}}return this._context.screenSizePerspectiveEnabled&&(e.screenSizePerspective=this._context.sharedResources.screenSizePerspectiveSettings),e.occlusionTest=!0,e.hasSlicePlane=this._context.slicePlaneEnabled,e}_prepareResourcesPrimitive(e,t){const r=this._getOutlineSize();if(xM(t)&&r===0)throw new Error("Nothing to render");if(this._outlineSize=r,e.color=this._getFillColor(),e.outlineColor=this._getOutlineColor(),e.outlineSize=this._outlineSize,y(this._context.sharedResources.textures)){const s=this._context.sharedResources.textures.fromData(`${t}-icon`,()=>Fae(t));this._texture=s.texture,this._releaseTexture=s,e.textureId=this._texture.id}e.textureIsSignedDistanceField=!0,e.distanceFieldBoundingBox=rEe;const n=this._getIconSize();this._size=[n,n],this._symbolTextureRatio=1/pg,this._createMaterialAndAddToStage(e,this._context.stage)}async _prepareResourcesHref(e,t,r){if(!Ot("esri-canvas-svg-support")&&fD(t))throw new J("graphics3diconsymbollayer:unsupported-image-format","IconSymbol3DLayer failed to load (SVG symbols are not supported in IE11)");this._outlineSize=this._getOutlineSize(),e.color=this._getFillColor(),e.outlineColor=this._getOutlineColor(),e.outlineSize=this._outlineSize,e.textureIsSignedDistanceField=!1;const n=this._getIconSize(),s=n*this._context.graphicsCoreOwner.view.state.pixelRatio;if(y(this._context.sharedResources.textures)){const a=await bw(this._context.sharedResources.textures.fromUrl(t,s,{signal:r}));if(a.ok===!1)throw Hte(a.error),new J("graphics3diconsymbollayer:request-failed",`Failed to load (Request for icon resource failed: ${t})`);this._releaseTexture=a.value;const o=a.value.texture,l=o.params;this._size=this._computeSize(l,n),e.textureId=o.id}this._createMaterialAndAddToStage(e,this._context.stage)}async _prepareResourcesCIM(e,t,r){const n=new kae({data:t});if(!this._context.sharedResources.cimSymbolRasterizer){const u=(await j(()=>import("./CIMSymbolRasterizer-0964644a.js"),["assets/CIMSymbolRasterizer-0964644a.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/typedArrayUtil-4d7bb04c.js","assets/ArrayPool-a8ee9378.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/promiseUtils-1e54421e.js","assets/screenUtils-410d12c0.js","assets/cimAnalyzer-38842966.js","assets/arcadeOnDemand-281a01eb.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/cast-fcb46737.js","assets/nextTick-3ee5a785.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-193543b5.js","assets/jsonUtils-229211af.js","assets/enums-2658a65c.js","assets/alignmentUtils-ae955d28.js","assets/mat2d-2bbb5feb.js","assets/vec2-528adfe4.js","assets/vec2f32-461e65a9.js","assets/number-954e4ab6.js","assets/Rect-ea14f53a.js","assets/callExpressionWithFeature-55effb7b.js","assets/quantizationUtils-4dd81f85.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-9ad35d39.js","assets/Rasterizer-dce80cb8.js","assets/_commonjsHelpers-a430e9ea.js","assets/imageutils-c0676a73.js","assets/rasterizingUtils-ec11e94c.js","assets/Symbol3DAnchorPosition2D-5726d999.js"])).CIMSymbolRasterizer;Ti(r),this._context.sharedResources.cimSymbolRasterizer||(this._context.sharedResources.cimSymbolRasterizer=new u(this._context.renderCoordsHelper.spatialReference,!0))}const s=this._context.layer.fields?this._context.layer.fields.map(u=>u.toJSON()):null;let a,o;if(this._cimLayers=await this._context.sharedResources.cimSymbolRasterizer.analyzeCIMSymbol(n,s,this._context.renderer&&this._context.renderer.type==="dictionary"?this._context.renderer.fieldMap:null,"esriGeometryPoint",{signal:r}),this._context.renderer&&this._context.renderer.type==="dictionary"&&this._context.renderer.scaleExpression){const u=this._context.renderer;if(isNaN(u.scaleExpression)){const d=u.scaleExpression,m=await Tie(d,this._context.layer.spatialReference,s);o=(f,_,g)=>{const w=Dae(m,f,{$view:g},"esriGeometryPoint",_);return w!==null?w:1}}else a=Number(u.scaleExpression)}this._cimScaleFactorOrFunction=a||o||1;const l=this._context.renderer?await this._context.renderer.getRequiredFields(this._context.layer.fieldsIndex):[];Ti(r);const c=this._context.layer.fieldsIndex;this._cimRequiredFields=l.map(u=>c.get(u).name),this._cimMaterialParametersInfo=e,this._cimMaterialParametersInfo.color=this._getFillColor(),this._cimMaterialParametersInfo.outlineColor=[0,0,0,0],this._cimMaterialParametersInfo.outlineSize=0,this._cimMaterialParametersInfo.textureIsSignedDistanceField=!1}_getPrimitive(){return this.symbolLayer.resource&&this.symbolLayer.resource.href?null:this.symbolLayer.resource&&this.symbolLayer.resource.primitive||Oie}_getOutlineSize(){let e=0;const t=this.symbolLayer;return y(t.outline)&&t.outline.size!=null?Math.max(Sa(t.outline.size),0):(e=xM(this._getPrimitive())?iEe:0,Math.max(e,0))}_getOutlineColor(){const e=this._getLayerOpacity(),t=this.symbolLayer,r=en(t,"outline","color");if(y(r)){const n=ti.toUnitRGB(r),s=r.a*e;return[n[0],n[1],n[2],s]}return[0,0,0,0]}_getFillColor(){if(xM(this._getPrimitive()))return kSe;const e=C(this._getPrimitive()),t=en(this.symbolLayer,"material","color");return this._getCombinedOpacityAndColor(t,{hasIntrinsicColor:e})}_getAnchorPos(e,t){return e==="relative"?Qt((t.x||0)+.5,.5-(t.y||0)):e in gE?gE[e]:gE.center}_createMaterialAndAddToStage(e,t){if(this._cimLayers?this._fastUpdates={enabled:!1}:this._fastUpdates=wx(this._context.renderer,this._fastVisualVariableConvertOptions()),this._fastUpdates.enabled&&Object.assign(e,this._fastUpdates.materialParameters),this._cimLayers){let r=y(e.textureId)?this._cimSymbolMaterials.get(e.textureId):null;return r||(r=new uv(e),this._cimSymbolMaterials.set(Ke(e.textureId,0),r),t.add(r)),r}return this._material=new uv(e),t.add(this._material),this._material}_setDrapingDependentMaterialParameters(){this.draped&&(this._forEachMaterial(e=>{e.setParameters({verticalOffset:null,screenSizePerspective:null,occlusionTest:!1,hasSlicePlane:!1,shaderPolygonOffset:0,isDraped:this.draped})}),this.layerOpacityChanged())}destroy(){super.destroy(),this._forEachMaterial(e=>this._context.stage.remove(e)),this._material=null,this._cimSymbolMaterials.clear(),this._cimSymbolTextures.forEach(e=>this._context.stage.remove(e)),this._cimSymbolTextures.clear(),this._releaseTexture=Qi(this._releaseTexture)}_getScaleFactor(e,t){if(this._drivenProperties.size&&e.size){for(let r=0;r<3;r++){const n=e.size[r];n&&n!=="symbol-value"&&n!=="proportional"&&(e.size[r]=Sa(n))}if(e.size[0]==="symbol-value")return 1;if(isFinite(+e.size[0]))return+e.size[0]/t;if(isFinite(+e.size[2]))return+e.size[2]/t}return 1}createGraphics3DGraphic(e){const t=e.graphic;if(!this._validateGeometry(t.geometry))return null;let r,n;if(this._cimLayers){if(!this._cimLayers.length)return null;const d=this._generateTextureCIM(t),m={textureId:d.id,...this._cimMaterialParametersInfo};n=this._createMaterialAndAddToStage(m,this._context.stage),r=[d.params.width,d.params.height]}else r=this._size,n=ft(this._material);const s=vx(t.geometry);if(C(s))return this.logger.warn(`unsupported geometry type for icon symbol: ${t.geometry.type}`),null;const a=e.renderingInfo,o=this._getVertexOpacityAndColor(a);let l=1;if(!this._fastUpdates.enabled||!this._fastUpdates.visualVariables.size){const d=r[0]>r[1]?r[0]:r[1];l=this._getScaleFactor(a,d)}l*=this._symbolTextureRatio;const c=[r[0]*l,r[1]*l],u=this.setGraphicElevationContext(t,new Qc);return this.ensureDrapedStatus(u.mode==="on-the-ground")&&this._setDrapingDependentMaterialParameters(),this.draped?this._createAsOverlay(t,s,n,o,c,e.layer.uid):this._createAs3DShape(t,s,n,o,c,u,t.uid)}layerOpacityChanged(){const e=this._getFillColor(),t=this._getOutlineColor();this._forEachMaterial(r=>{r.setParameters({color:e}),r.setParameters({outlineColor:t})})}layerElevationInfoChanged(e,t,r){const n=this._elevationContext.mode,s=sT(IK.elevationModeChangeTypes,r,n);if(s!==Zi.UPDATE)return s;const a=Ql(n)||n==="absolute-height";return this.updateGraphics3DGraphicElevationInfo(e,t,()=>a)}slicePlaneEnabledChanged(){return this.draped||this._forEachMaterial(e=>{e.setParameters({hasSlicePlane:this._context.slicePlaneEnabled})}),!0}physicalBasedRenderingChanged(){return!0}pixelRatioChanged(){return!!this._getPrimitive()}applyRendererDiff(e,t){for(const r in e.diff){if(r!=="visualVariables"||!xx(this._fastUpdates,t,this._fastVisualVariableConvertOptions()))return Gr.Recreate_Symbol;y(this._material)&&this._material.setParameters(this._fastUpdates.materialParameters)}return Gr.Fast_Update}_defaultElevationInfoNoZ(){return aEe}_createAs3DShape(e,t,r,n,s,a,o){const l=this.getFastUpdateAttrValues(e),c=l?_=>p$(this._fastUpdates.materialParameters,l,_):null,u=this._context.stage.renderView._getObjectAndLayerIdColor({graphicUid:o,layerUid:this._context.layer.uid}),d=[U3(q8,null,n,s,oEe,null,l,u)],m=A4(this._context,t,d,[r],a,this._context.layer.uid,o,c);if(m===null)return null;const f=new uu(this,m.object,d,null,null,_x,a);return f.alignedSampledElevation=m.sampledElevation,f.needsElevationUpdates=Ql(a.mode)||a.mode==="absolute-height",f.getScreenSize=this._createScreenSizeGetter(s,c),f.calculateRelativeScreenBounds=_=>r.calculateRelativeScreenBounds(f.getScreenSize(),1,_),yx(f,t,this._context.elevationProvider),f}_createAsOverlay(e,t,r,n,s,a){r.renderPriority=this._renderPriority;const o=yi();bn(t,o,this._context.overlaySR),o[2]=D4;const l=this._context.clippingExtent;if(y(l)&&!iF(l,o))return null;const c=this.getFastUpdateAttrValues(e),u=c?g=>p$(this._fastUpdates.materialParameters,c,g):null,d=this._context.stage.renderView._getObjectAndLayerIdColor({graphicUid:e.uid,layerUid:this._context.layer.uid}),m=U3(q8,o,n,s,null,null,c,d),f=new pv(m,r,{layerUid:a,graphicUid:e.uid,calculateShaderTransformation:u});o[3]=0,im(f.boundingSphere,o);const _=new jP(this,[f],null,this._context.drapeSourceRenderer);return _.getScreenSize=this._createScreenSizeGetter(s,u),_.calculateRelativeScreenBounds=g=>r.calculateRelativeScreenBounds(_.getScreenSize(),1,g),_}_createScreenSizeGetter(e,t){const r=this._outlineSize+2;if(this._fastUpdates.enabled){const n=e[0]/this._symbolTextureRatio,s=e[1]/this._symbolTextureRatio;return(a=Te())=>{const o=t(eEe);return a[0]=o[0]*n+r,a[1]=o[5]*s+r,a}}{const n=e[0]/this._symbolTextureRatio+r,s=e[1]/this._symbolTextureRatio+r;return(a=Te())=>(a[0]=n,a[1]=s,a)}}_fastVisualVariableConvertOptions(){const e=this._size[0]>this._size[1]?this._size[0]:this._size[1],t=Ze(e,e,e),r=_I(1),n=e*r;return{modelSize:t,symbolSize:Ze(n,n,n),unitInMeters:r,transformation:{anchor:Gl,scale:em,rotation:Gl}}}_getGraphicHash(e){let t="";for(const r of this._cimRequiredFields)t+=r+e.attributes[r];return t}_forEachMaterial(e){y(this._material)&&e(this._material),this._cimSymbolMaterials.forEach(e)}test(){return{...super.test(),material:this._material}}};function sEe(i){return i&&i.type==="point-3d"&&i.hasVisibleVerticalOffset()}function xM(i){return!C(i)&&(i==="cross"||i==="x")}m$.PRIMITIVE_SIZE=nEe,m$.elevationModeChangeTypes={definedChanged:Zi.UPDATE,staysOnTheGround:Zi.NONE,onTheGroundChanged:Zi.RECREATE};const aEe={mode:"relative-to-ground",offset:0},oEe=Bi(0,0,0,1);function f$(i){switch(i){case"butt":return E0.BUTT;case"square":return E0.SQUARE;case"round":return E0.ROUND;default:return null}}function lEe(i){return i==="diamond"?"kite":i}function g$(i,e=null){const t=[],r=[];cEe(i,r,t);const n=r[0][1].data,s=t[0][1].length,a=new Array(s).fill(0);return hEe(i,r,t),uEe(i,r,t,a),mEe(i,r,t,a),dEe(i,r,t,a),pEe(i,r,t,a),fEe(i,r,t,a),gEe(i,r,t,a),_Ee(i,r,t,n),new jr(r,t,Fc.Line,e)}function cEe(i,e,t){const{attributeData:{position:r},removeDuplicateStartEnd:n}=i,s=yEe(r)&&n,a=r.length/3-(s?1:0),o=new Array(2*(a-1)),l=s?N7(r,0,r.length-3):r;let c=0;for(let u=0;u<a-1;u++)o[c++]=u,o[c++]=u+1;e.push([S.POSITION,{size:3,data:l,exclusive:s}]),t.push([S.POSITION,o])}function hEe(i,e,t){const r=i.attributeData.mapPosition;C(r)||(t.push([S.MAPPOS,t[0][1]]),e.push([S.MAPPOS,{size:3,data:r}]))}function uEe(i,e,t,r){if(y(i.attributeData.colorFeature))return;const n=i.attributeData.color;e.push([S.COLOR,{size:4,data:Ke(n,Pc)}]),t.push([S.COLOR,r])}function dEe(i,e,t,r){if(!y(i.attributeData.normal))return;const n=i.attributeData.normal;e.push([S.NORMAL,{size:3,data:n}]),t.push([S.NORMAL,r])}function pEe(i,e,t,r){const n=i.attributeData.colorFeature;C(n)||(e.push([S.COLORFEATUREATTRIBUTE,{size:1,data:new Float32Array([n])}]),t.push([S.COLOR,r]))}function mEe(i,e,t,r){if(y(i.attributeData.sizeFeature))return;const n=i.attributeData.size;e.push([S.SIZE,{size:1,data:[Ke(n,1)]}]),t.push([S.SIZE,r])}function fEe(i,e,t,r){const n=i.attributeData.sizeFeature;C(n)||(e.push([S.SIZEFEATUREATTRIBUTE,{size:1,data:new Float32Array([n])}]),t.push([S.SIZEFEATUREATTRIBUTE,r]))}function gEe(i,e,t,r){const n=i.attributeData.opacityFeature;C(n)||(e.push([S.OPACITYFEATUREATTRIBUTE,{size:1,data:new Float32Array([n])}]),t.push([S.OPACITYFEATUREATTRIBUTE,r]))}function _Ee(i,e,t,r){if(C(i.overlayInfo)||i.overlayInfo.renderCoordsHelper.viewingMode!==Ie.Global||!i.overlayInfo.spatialReference.isGeographic)return;const n=new Float64Array(r.length),s=Kt(i.overlayInfo.spatialReference);for(let m=0;m<n.length;m+=3)Z7(r,m,n,m,s);const a=r.length/3,o=new Float32Array(a+1);let l=vEe,c=bEe,u=0,d=0;Y(l,n[d++],n[d++],n[d++]),o[0]=0;for(let m=1;m<a+1;++m)m===a&&(d=0),Y(c,n[d++],n[d++],n[d++]),u+=gre(l,c),o[m]=u,[l,c]=[c,l];e.push([S.DISTANCETOSTART,{size:1,data:o}]),t.push([S.DISTANCETOSTART,t[0][1]])}function yEe(i){const e=i.length;return i[0]===i[e-3]&&i[1]===i[e-2]&&i[2]===i[e-1]}var W8;(function(i){i[i.KEEP=0]="KEEP",i[i.REMOVE=1]="REMOVE"})(W8||(W8={}));const vEe=P(),bEe=P();function Ize(i,e){if(C(i)||i.length===0)return[];const t=[];return i.forEach(r=>{const n=r.length,s=new Float64Array(3*n);r.forEach((o,l)=>{s[3*l+0]=o[0],s[3*l+1]=o[1],s[3*l+2]=o[2]});const a={attributeData:{position:s,normal:e},removeDuplicateStartEnd:!1};t.push(a)}),t}function wEe(i,e,t,r){const n=i.type==="polygon"?K0.CCW_IS_HOLE:K0.NONE,s=i.type==="polygon"?i.rings:i.paths,{position:a,outlines:o}=HR(s,i.hasZ,n),l=new Float64Array(a.length),c=BY(a,i.spatialReference,0,l,0,a,0,a.length/3,e,t,r),u=c!=null;return{lines:u?LK(o,a,l):[],projectionSuccess:u,sampledElevation:c}}function xEe(i,e){const t=i.type==="polygon"?K0.CCW_IS_HOLE:K0.NONE,r=i.type==="polygon"?i.rings:i.paths,{position:n,outlines:s}=HR(r,!1,t),a=Ma(n,i.spatialReference,0,n,e,0,n.length/3);for(let o=2;o<n.length;o+=3)n[o]=D4;return{lines:a?LK(s,n):[],projectionSuccess:a}}function LK(i,e,t){const r=new Array;for(const{index:n,count:s}of i){if(s<=1)continue;const a=3*n,o=a+3*s;r.push({position:e.subarray(a,o),mapPosition:t?t.subarray(a,o):void 0})}return r}const $K=new Map([[S.POSITION,0],[S.UV0,2],[S.AUXPOS1,3],[S.NORMAL,4],[S.COLOR,5],[S.COLORFEATUREATTRIBUTE,5],[S.SIZE,6],[S.SIZEFEATUREATTRIBUTE,6],[S.OPACITYFEATUREATTRIBUTE,7]]);let DK=class FK extends ii{initializeProgram(e){return new ei(e.rctx,FK.shader.get().build(this.configuration),$K)}_makePipelineState(e,t){const r=this.configuration,n=e===qt.NONE;return it({blending:r.output===V.Color||r.output===V.Alpha?n?Hl:qm(e):null,depthTest:{func:n_(e)},depthWrite:n?r.writeDepth&&nl:BR(e),colorWrite:gt,stencilWrite:r.hasOccludees?Cd:null,stencilTest:r.hasOccludees?t?$g:s_:null,polygonOffset:{factor:0,units:-10}})}initializePipeline(){return this.configuration.occluder&&(this._occluderPipelineTransparent=it({blending:Hl,depthTest:WE,depthWrite:null,colorWrite:gt,stencilWrite:null,stencilTest:uH}),this._occluderPipelineOpaque=it({blending:Hl,depthTest:WE,depthWrite:null,colorWrite:gt,stencilWrite:dH,stencilTest:pH}),this._occluderPipelineMaskWrite=it({blending:null,depthTest:qD,depthWrite:null,colorWrite:null,stencilWrite:Cd,stencilTest:$g})),this._occludeePipelineState=this._makePipelineState(this.configuration.transparencyPassType,!0),this._makePipelineState(this.configuration.transparencyPassType,!1)}getPipelineState(e,t){return t?this._occludeePipelineState:this.configuration.occluder?e===le.TRANSPARENT_OCCLUDER_MATERIAL?this._occluderPipelineTransparent:e===le.OCCLUDER_MATERIAL?this._occluderPipelineOpaque:this._occluderPipelineMaskWrite:super.getPipelineState(e,t)}};DK.shader=new ri(Vae,()=>j(()=>import("./LineMarker.glsl-81f5bcae.js"),["assets/LineMarker.glsl-81f5bcae.js","assets/string-a318751c.js","assets/typedArrayUtil-4d7bb04c.js","assets/floatRGBA-9ad35d39.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/Texture-46c8c2cb.js","assets/compilerUtils-18d58939.js","assets/Error-ec6249b9.js","assets/Evented-a45c8b0f.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/VisualVariablePassParameters-d460182b.js","assets/VertexAttribute-9c5c630d.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/ShaderBuilder-a7d0da4e.js","assets/mat3f64-c6305894.js","assets/aaBoundingBox-657a9b82.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/aaBoundingRect-193543b5.js","assets/basicInterfaces-19ed850e.js","assets/ViewingMode-5d7d590b.js","assets/Util-a48361c6.js","assets/vec2f64-30dc1443.js","assets/vec4f64-e407da96.js","assets/mat4-44a0988f.js","assets/mat4f64-1e28eae0.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/ScreenSpacePass-d5e48a9b.js","assets/Float4PassUniform-d7bdbc81.js","assets/Texture2DPassUniform-753de459.js","assets/vec2-528adfe4.js","assets/assets-8d3e737a.js","assets/Matrix3PassUniform-ad9f953b.js","assets/vec3f32-c9aa289f.js","assets/MarkerSizing.glsl-566261cc.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/FloatPassUniform-68d54f51.js","assets/sdfPrimitives-9858c36d.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/TransparencyPassType-a11868d2.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/LineMarker.glsl-8166d610.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Slice.glsl-3b39b1f7.js","assets/OutputDepth.glsl-470c8e2a.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/AlphaCutoff-96178e0d.js"]));let TEe=class extends Fd{constructor(e){super(e,new SEe),this._vertexAttributeLocations=$K,this._configuration=new bae,this._layout=this.createLayout()}dispose(){}getConfiguration(e,t){return this._configuration.output=e,this._configuration.space=t.slot===le.DRAPED_MATERIAL?gA.Draped:this.parameters.worldSpace?gA.World:gA.Screen,this._configuration.hideOnShortSegments=this.parameters.hideOnShortSegments,this._configuration.hasCap=this.parameters.cap!==E0.BUTT,this._configuration.anchor=this.parameters.anchor,this._configuration.hasTip=this.parameters.hasTip,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.hasOccludees=this.parameters.hasOccludees,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.vvColor=this.parameters.vvColorEnabled,this._configuration.vvOpacity=this.parameters.vvOpacityEnabled,this._configuration.vvSize=this.parameters.vvSizeEnabled,this._configuration.occluder=this.parameters.renderOccluded===cr.OccludeAndTransparentStencil,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration.hasMultipassTerrain=t.multipassTerrain.enabled,this._configuration.cullAboveGround=t.multipassTerrain.cullAboveGround,this._configuration}intersect(){}createLayout(){const e=sn().vec3f(S.POSITION).vec2f(S.UV0).vec3f(S.AUXPOS1);return this.parameters.worldSpace&&e.vec3f(S.NORMAL),this.parameters.vvSizeEnabled?e.f32(S.SIZEFEATUREATTRIBUTE):e.f32(S.SIZE),this.parameters.vvColorEnabled?e.f32(S.COLORFEATUREATTRIBUTE):e.vec4f(S.COLOR),this.parameters.vvOpacityEnabled&&e.f32(S.OPACITYFEATUREATTRIBUTE),e}createBufferWriter(){return new EEe(this._layout,this.parameters)}requiresSlot(e,t){return t===V.Color||t===V.Alpha||t===V.Highlight||t===V.Depth?e===le.DRAPED_MATERIAL?!0:this.parameters.renderOccluded===cr.OccludeAndTransparentStencil?e===le.OPAQUE_MATERIAL||e===le.OCCLUDER_MATERIAL||e===le.TRANSPARENT_OCCLUDER_MATERIAL:t===V.Color||t===V.Alpha?e===(this.parameters.writeDepth?le.TRANSPARENT_MATERIAL:le.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL):e===le.OPAQUE_MATERIAL:!1}createGLMaterial(e){return new CEe(e)}},CEe=class extends lH{_updateParameters(e){return this.updateTexture(this._material.parameters.textureId),this._material.setParameters(this.textureBindParameters),this.ensureTechnique(DK,e)}_updateOccludeeState(e){e.hasOccludees!==this._material.parameters.hasOccludees&&this._material.setParameters({hasOccludees:e.hasOccludees})}beginSlot(e){return this._output!==V.Color&&this._output!==V.Alpha||this._updateOccludeeState(e),this._updateParameters(e)}},SEe=class extends YG{constructor(){super(...arguments),this.width=0,this.color=[1,1,1,1],this.placement="end",this.cap=E0.BUTT,this.anchor=AH.Center,this.hasTip=!1,this.worldSpace=!1,this.hideOnShortSegments=!1,this.writeDepth=!0,this.hasSlicePlane=!1,this.vvFastUpdate=!1,this.hasOccludees=!1}},EEe=class{constructor(e,t){this.vertexBufferLayout=e,this._parameters=t}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(){return this._parameters.placement==="begin-end"?12:6}write(e,t,r,n,s){const a=r.vertexAttributes.get(S.POSITION).data,o=a.length/3;let l=[1,0,0];const c=r.vertexAttributes.get(S.NORMAL);this._parameters.worldSpace&&y(c)&&(l=c.data);let u=1,d=0;this._parameters.vvSizeEnabled?d=r.vertexAttributes.get(S.SIZEFEATUREATTRIBUTE).data[0]:r.vertexAttributes.has(S.SIZE)&&(u=r.vertexAttributes.get(S.SIZE).data[0]);let m=[1,1,1,1],f=0;this._parameters.vvColorEnabled?f=r.vertexAttributes.get(S.COLORFEATUREATTRIBUTE).data[0]:r.vertexAttributes.has(S.COLOR)&&(m=r.vertexAttributes.get(S.COLOR).data);let _=0;this._parameters.vvOpacityEnabled&&(_=r.vertexAttributes.get(S.OPACITYFEATUREATTRIBUTE).data[0]);const g=new Float32Array(n.buffer);let w=s*(this.vertexBufferLayout.stride/4);const v=(R,E,O,$)=>{if(g[w++]=R[0],g[w++]=R[1],g[w++]=R[2],g[w++]=O[0],g[w++]=O[1],g[w++]=E[0],g[w++]=E[1],g[w++]=E[2],this._parameters.worldSpace&&(g[w++]=l[0],g[w++]=l[1],g[w++]=l[2]),this._parameters.vvSizeEnabled?g[w++]=d:g[w++]=u,this._parameters.vvColorEnabled)g[w++]=f;else{const D=Math.min(4*$,m.length-4);g[w++]=m[D+0],g[w++]=m[D+1],g[w++]=m[D+2],g[w++]=m[D+3]}this._parameters.vvOpacityEnabled&&(g[w++]=_)};let b;(function(R){R[R.ASCENDING=1]="ASCENDING",R[R.DESCENDING=-1]="DESCENDING"})(b||(b={}));const x=(R,E)=>{const O=Y(REe,a[3*R],a[3*R+1],a[3*R+2]),$=PEe;let D=R+E;do Y($,a[3*D],a[3*D+1],a[3*D+2]),D+=E;while(Og(O,$)&&D>=0&&D<o);e&&(Me(O,O,e),Me($,$,e)),v(O,$,[-1,-1],R),v(O,$,[1,-1],R),v(O,$,[1,1],R),v(O,$,[-1,-1],R),v(O,$,[1,1],R),v(O,$,[-1,1],R)},T=this._parameters.placement;T!=="begin"&&T!=="begin-end"||x(0,b.ASCENDING),T!=="end"&&T!=="begin-end"||x(o-1,b.DESCENDING)}};const REe=P(),PEe=P(),fs={dash:[4,3],dot:[1,3],"long-dash":[8,3],"short-dash":[4,1],"short-dot":[1,1]},AEe={dash:fs.dash,"dash-dot":[...fs.dash,...fs.dot],dot:fs.dot,"long-dash":fs["long-dash"],"long-dash-dot":[...fs["long-dash"],...fs.dot],"long-dash-dot-dot":[...fs["long-dash"],...fs.dot,...fs.dot],none:null,"short-dash":fs["short-dash"],"short-dash-dot":[...fs["short-dash"],...fs["short-dot"]],"short-dash-dot-dot":[...fs["short-dash"],...fs["short-dot"],...fs["short-dot"]],"short-dot":fs["short-dot"],solid:null},OEe=8;function MEe(i,e=2){return C(i)?i:{pattern:i.slice(),pixelRatio:e}}function Nze(i,e=2){return{pattern:[i,i],pixelRatio:e}}function NK(i){return y(i)&&i.type==="style"?IEe(i.style):null}function IEe(i){return y(i)?MEe(AEe[i],OEe):null}const LEe=["polyline","polygon","extent"];let kK=class VK extends du{constructor(e,t,r,n){super(e,t,r,n)}async doLoad(){if(this._vvConvertOptions={modelSize:[1,1,1],symbolSize:[1,1,1],unitInMeters:1,transformation:{anchor:[0,0,0],scale:[1,1,1],rotation:[0,0,0]},supportedTypes:{size:!0,color:!0,opacity:!0,rotation:!1}},this._context.renderer&&this._context.renderer.visualVariables&&this._context.renderer.visualVariables.length>0?this._fastUpdates=wx(this._context.renderer,this._vvConvertOptions):this._fastUpdates={enabled:!1},!this._drivenProperties.size&&(this.symbolLayer.size!=null?this.symbolLayer.size:_I(1))<0)throw new J("graphics3dlinesymbollayer:invalid-size","Symbol sizes may not be negative values");this._markerTexture=y(this.symbolLayer.marker)&&y(this._context.sharedResources.textures)?wae(this._context.sharedResources.textures,lEe(this.symbolLayer.marker.style)):null}_getMaterialParameters(e,t=!1){var s;const r=this._getCombinedOpacityAndColor(t&&this._markerColor||this._materialColor);this._patternHidesLine&&!t&&(r[3]=0);const n={width:this._computeMaterialWidth((s=this.symbolLayer)==null?void 0:s.size),color:r,hasPolygonOffset:!0,join:this.symbolLayer.join||"miter",cap:f$(this.symbolLayer.cap||"butt"),hasSlicePlane:this._context.slicePlaneEnabled,isClosed:e,stipplePattern:NK(this.symbolLayer.pattern),stippleScaleWithLineWidth:!0};return this._fastUpdates&&this._fastUpdates.visualVariables?{...n,...this._fastUpdates.materialParameters}:n}get _materialColor(){return co(this.symbolLayer.material,e=>e.color)}get _markerColor(){return co(this.symbolLayer.marker,e=>e.color)}get _lineMaterial(){return C(this._lineMaterialCached)&&(this._lineMaterialCached=new v0(this._getMaterialParameters(!1)),this._context.stage.add(this._lineMaterialCached)),this._lineMaterialCached}get _ringMaterial(){return C(this._ringMaterialCached)&&(this._ringMaterialCached=new v0(this._getMaterialParameters(!0)),this._context.stage.add(this._ringMaterialCached)),this._ringMaterialCached}get _wireframeLineMaterial(){return C(this._wireframeLineMaterialCached)&&(this._wireframeLineMaterialCached=new v0({...this._getMaterialParameters(!1),wireframe:!0}),this._context.stage.add(this._wireframeLineMaterialCached)),this._wireframeLineMaterialCached}get _wireframeRingMaterial(){return C(this._wireframeRingMaterialCached)&&(this._wireframeRingMaterialCached=new v0({...this._getMaterialParameters(!0),wireframe:!0}),this._context.stage.add(this._wireframeRingMaterialCached)),this._wireframeRingMaterialCached}get _markerMaterial(){return C(this._markerMaterialCached)&&y(this.symbolLayer.marker)&&y(this._markerTexture)&&(this._markerMaterialCached=new TEe({...this._getMaterialParameters(!1,!0),placement:this.symbolLayer.marker.placement,textureId:this._markerTexture.texture.id}),this._context.stage.add(this._markerMaterialCached)),this._markerMaterialCached}destroy(){super.destroy(),this._forEachMaterial(e=>this._context.stage.remove(e)),this._lineMaterialCached=null,this._ringMaterialCached=null,this._wireframeLineMaterialCached=null,this._wireframeRingMaterialCached=null,this._markerMaterialCached=null,this._markerTexture=Qi(this._markerTexture)}_getDrivenSize(e){return this._drivenProperties.size&&e.size?Sa(MCe(e.size)):1}_getSizeFeatureAttributeData(e){return this._fastUpdates.enabled&&this._fastUpdates.visualVariables.size?_d(this._fastUpdates.visualVariables.size.field,e):null}_getDrivenColor(e){const t=Bi(1,1,1,1);return this._drivenProperties.color&&e.color&&(t[0]=e.color[0],t[1]=e.color[1],t[2]=e.color[2],e.color.length>0&&(t[3]=e.color[3])),this._drivenProperties.opacity&&e.opacity&&(t[3]=e.opacity),t}_getColorFeatureAttributeData(e){return this._fastUpdates.enabled&&this._fastUpdates.visualVariables.color?_d(this._fastUpdates.visualVariables.color.field,e):null}_getOpacityFeatureAttributeData(e){return this._fastUpdates.enabled&&this._fastUpdates.visualVariables.opacity?_d(this._fastUpdates.visualVariables.opacity.field,e):null}createGraphics3DGraphic(e){const t=e.graphic;if(!this._validateGeometry(t.geometry,LEe,this.symbolLayer.type))return null;const r=this.setGraphicElevationContext(t,new Qc);return this.ensureDrapedStatus(r.mode==="on-the-ground"),this.draped?this._createAsOverlay(e,this._context.layer.uid):this._createAs3DShape(e,r,t.uid)}applyRendererDiff(e,t){for(const r in e.diff){if(r!=="visualVariables"||!xx(this._fastUpdates,t,this._vvConvertOptions))return Gr.Recreate_Symbol;this._forEachMaterial(n=>n.setParameters(this._fastUpdates.materialParameters))}return Gr.Fast_Update}prepareSymbolLayerPatch(e){var s,a;if(e.diff.type!=="partial")return;const t=e.diff.diff,r={};((s=t.size)==null?void 0:s.type)==="complete"&&(r.width=this._computeMaterialWidth(t.size.newValue),delete t.size),((a=t.cap)==null?void 0:a.type)==="complete"&&(r.cap=f$(Ke(t.cap.newValue,"butt")),delete t.cap);const n=this._prepareMarkerPatch(e,t);this._prepareMaterialPatch(e,t,n),e.symbolLayerStatePatches.push(()=>this._forEachMaterial(o=>o.setParameters(r)))}layerOpacityChanged(){this._forEachMaterial((e,t)=>this._updateMaterialLayerOpacity(e,t))}_forEachMaterial(e){y(this._lineMaterialCached)&&e(this._lineMaterialCached),y(this._ringMaterialCached)&&e(this._ringMaterialCached),y(this._wireframeLineMaterialCached)&&e(this._wireframeLineMaterialCached),y(this._wireframeRingMaterialCached)&&e(this._wireframeRingMaterialCached),y(this._markerMaterialCached)&&e(this._markerMaterialCached,!0)}_updateMaterialLayerOpacity(e,t=!1){const r=e.parameters.color,n=en(this.symbolLayer,"material","color"),s=this._patternHidesLine&&!t?0:this._getCombinedOpacity(n),a=Bi(r[0],r[1],r[2],s);e.setParameters({color:a})}layerElevationInfoChanged(e,t,r){const n=this._elevationContext.mode,s=sT(VK.elevationModeChangeTypes,r,n);if(s!==Zi.UPDATE)return s;const a=Ql(n);return this.updateGraphics3DGraphicElevationInfo(e,t,()=>a)}slicePlaneEnabledChanged(){const e={hasSlicePlane:this._context.slicePlaneEnabled};return this._forEachMaterial(t=>t.setParameters(e)),!0}physicalBasedRenderingChanged(){return!0}pixelRatioChanged(){return!0}_getGeometryAsPolygonOrPolyline(e){switch(e.type){case"extent":if(e instanceof pi)return jm.fromExtent(e);break;case"polygon":case"polyline":return e}return null}_createAs3DShape(e,t,r){const n=e.graphic,s=this._getGeometryAsPolygonOrPolyline(n.geometry),a=s.type==="polygon"?s.rings:s.paths,o=new Array,l=new Array,c=new Array,u=Ms(),d=wEe(s,this._context.elevationProvider,this._context.renderCoordsHelper,t),m=s.type==="polygon"?"rings":"paths";this._logGeometryCreationWarnings(d,a,m,"LineSymbol3DLayer");for(let g=0;g<d.lines.length;g++){const{position:w,mapPosition:v}=d.lines[g];if(y(this._context.clippingExtent)&&(Ii(u),Jo(u,v),!Lc(u,this._context.clippingExtent)))continue;const b=this._createGeometry(e,w,v,s.type,lw.ELEVATED,r);o.push(b),l.push(s.type==="polygon"?this._ringMaterial:this._lineMaterial),c.push(rn),Wt.LINE_WIREFRAMES&&(o.push(b.cloneShallow()),l.push(s.type==="polygon"?this._wireframeRingMaterial:this._wireframeLineMaterial),c.push(rn));const x=this._markerMaterial;y(x)&&(o.push(b.cloneShallow()),l.push(x),c.push(rn))}if(o.length===0)return null;const f=new Bd({geometries:o,materials:l,transformations:c,castShadow:!1,metadata:{layerUid:this._context.layer.uid,graphicUid:r}}),_=new uu(this,f,o,null,null,rCe,t);return _.alignedSampledElevation=d.sampledElevation,_.needsElevationUpdates=Ql(t.mode),_}_createGeometry(e,t,r,n,s,a){const o=n==="polygon",l=this._fastUpdates.enabled&&this._fastUpdates.visualVariables.color,c=this._fastUpdates.enabled&&this._fastUpdates.visualVariables.size,u=this._context.stage.renderView._getObjectAndLayerIdColor({graphicUid:a,layerUid:this._context.layer.uid});return g$({overlayInfo:s===lw.DRAPED?{spatialReference:this._context.overlaySR,renderCoordsHelper:this._context.renderCoordsHelper}:null,removeDuplicateStartEnd:o,attributeData:{position:t,mapPosition:r,size:c?null:this._getDrivenSize(e.renderingInfo),color:l?null:this._getDrivenColor(e.renderingInfo),sizeFeature:this._getSizeFeatureAttributeData(e.graphic),colorFeature:this._getColorFeatureAttributeData(e.graphic),opacityFeature:this._getOpacityFeatureAttributeData(e.graphic)}},u)}_createAsOverlay(e,t){const r=e.graphic,n=this._getGeometryAsPolygonOrPolyline(r.geometry),s=n.type==="polygon"?n.rings:n.paths,a=n.type==="polygon"?this._ringMaterial:this._lineMaterial;a.renderPriority=this._renderPriority;const o=Wt.LINE_WIREFRAMES?n.type==="polygon"?this._wireframeRingMaterial:this._wireframeLineMaterial:null,l=this._markerMaterial;y(o)&&(o.renderPriority=this._renderPriority-.001),y(l)&&(l.renderPriority=this._renderPriority-.002);const c=new Array,u=Ms(),d=Ii(),m=xEe(n,this._context.overlaySR),f=n.type==="polygon"?"rings":"paths";this._logGeometryCreationWarnings(m,s,f,"LineSymbol3DLayer");for(const _ of m.lines){if(Ii(u),Jo(u,_.position),!Lc(u,this._context.clippingExtent))continue;Y0(d,u);const g=this._createGeometry(e,_.position,null,n.type,lw.DRAPED,r.uid),w=b=>{const x=new pv(g,b,{layerUid:t,graphicUid:r.uid});return c.push(x),x};if(y(l)){const b=w(l),x=ft(this.symbolLayer.marker).placement;x!=="begin"&&x!=="begin-end"||Jo(u,_.position,0,1),x!=="end"&&x!=="begin-end"||Jo(u,_.position,_.position.length-3,1),this._updateBoundingSphere(b,u)}const v=w(a);if(this._updateBoundingSphere(v,u),Wt.LINE_WIREFRAMES){const b=w(o);this._updateBoundingSphere(b,u)}}return new jP(this,c,d,this._context.drapeSourceRenderer)}_updateBoundingSphere(e,t){Qs(e.boundingSphere,.5*(t[0]+t[3]),.5*(t[1]+t[4]),0,.5*Math.sqrt((t[3]-t[0])*(t[3]-t[0])+(t[4]-t[1])*(t[4]-t[1])))}get _patternHidesLine(){const e=this.symbolLayer.pattern;return y(e)&&e.type==="style"&&e.style==="none"}_computeMaterialWidth(e){return e=Ke(e,_I(1)),this._drivenProperties.size?this._fastUpdates.enabled&&this._fastUpdates.visualVariables.size?Sa(1):1:Sa(e)}_prepareMaterialPatch(e,t,r){const n=t.material;if(C(n))return void(r.changed&&r.useMaterialColor&&this._patchMaterialColor(this._getCombinedOpacityAndColor(this._materialColor),this._markerMaterialCached,e));if(n.type==="collection")return;const s=n.type==="complete"?co(n.newValue,o=>o.color):n.diff.color.type==="complete"?n.diff.color.newValue:null,a=this._getCombinedOpacityAndColor(s);r.useMaterialColor&&this._patchMaterialColor(LD(a),this._markerMaterialCached,e),this._patternHidesLine&&(a[3]=0),this._patchMaterialColor(a,this._lineMaterialCached,e),delete t.material}_prepareMarkerPatch(e,t){const r=t.marker;if(C(r)||r.type!=="partial"||y(r.diff.style)||y(r.diff.placement)||y(r.diff.color)&&r.diff.color.type!=="complete")return{changed:!1,useMaterialColor:C(this._markerColor)};const n=r.diff.color;if(C(n))return delete t.marker,{changed:!1,useMaterialColor:C(this._markerColor)};const s=ft(n.newValue);return C(s)?(delete t.marker,{changed:!0,useMaterialColor:!0}):(this._patchMaterialColor(this._getCombinedOpacityAndColor(s),this._markerMaterialCached,e),delete t.marker,{changed:!0,useMaterialColor:!1})}_patchMaterialColor(e,t,r){C(t)||r.symbolLayerStatePatches.push(()=>t.setParameters({color:e}))}};var lw;kK.elevationModeChangeTypes={definedChanged:Zi.RECREATE,staysOnTheGround:Zi.NONE,onTheGroundChanged:Zi.RECREATE},function(i){i[i.DRAPED=0]="DRAPED",i[i.ELEVATED=1]="ELEVATED"}(lw||(lw={}));let UK=class zK extends ii{get _stippleEnabled(){return this.configuration.stippleEnabled&&this.configuration.output!==V.Highlight}initializeConfiguration(e,t){t.hasWebGL2Context=e.rctx.type===Nn.WEBGL2}initializeProgram(e){return new ei(e.rctx,zK.shader.get().build(this.configuration),oi)}initializePipeline(){const e=this.configuration,t=Gn(me.SRC_ALPHA,me.ONE,me.ONE_MINUS_SRC_ALPHA,me.ONE_MINUS_SRC_ALPHA),r=(n,s=null,a=null)=>it({blending:s,depthTest:qD,depthWrite:a,colorWrite:gt,stencilWrite:e.hasOccludees?Cd:null,stencilTest:e.hasOccludees?n?$g:s_:null});return e.output===V.Color?(this._occludeePipelineState=r(!0,e.transparent||this._stippleEnabled?t:null,nl),r(!1,e.transparent||this._stippleEnabled?t:null,nl)):r(!1)}get primitiveType(){return kt.LINES}getPipelineState(e,t){return t?this._occludeePipelineState:super.getPipelineState(e,t)}};UK.shader=new ri(zae,()=>j(()=>import("./NativeLine.glsl-c0fa9712.js"),["assets/NativeLine.glsl-c0fa9712.js","assets/Matrix3PassUniform-ad9f953b.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/mat4-44a0988f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/mat4f64-1e28eae0.js","assets/vec3-e93e648f.js","assets/mat3f64-c6305894.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/vec4f64-e407da96.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/Texture2DPassUniform-753de459.js","assets/LineStipple.glsl-ed22a88b.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/Float4PassUniform-d7bdbc81.js","assets/FloatPassUniform-68d54f51.js","assets/floatRGBA-9ad35d39.js","assets/mathUtils-b4bb77e2.js","assets/vec4-790471c0.js","assets/enums-64ab819c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/NativeLine.glsl-742e9e29.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/VertexColor.glsl-8c022fa8.js","assets/OutputHighlight.glsl-fbac199a.js","assets/AlphaCutoff-96178e0d.js"]));let Lo=class extends cu{constructor(){super(...arguments),this.output=V.Color,this.hasSlicePlane=!1,this.hasVertexColors=!1,this.transparent=!1,this.draped=!1,this.stippleEnabled=!1,this.stippleOffColorEnabled=!1,this.stipplePreferContinuous=!0,this.hasOccludees=!1}};h([k({count:V.COUNT})],Lo.prototype,"output",void 0),h([k()],Lo.prototype,"hasSlicePlane",void 0),h([k()],Lo.prototype,"hasVertexColors",void 0),h([k()],Lo.prototype,"transparent",void 0),h([k()],Lo.prototype,"draped",void 0),h([k()],Lo.prototype,"stippleEnabled",void 0),h([k()],Lo.prototype,"stippleOffColorEnabled",void 0),h([k()],Lo.prototype,"stipplePreferContinuous",void 0),h([k()],Lo.prototype,"hasOccludees",void 0),h([k({constValue:!1})],Lo.prototype,"stippleRequiresClamp",void 0),h([k({constValue:!1})],Lo.prototype,"stippleScaleWithLineWidth",void 0),h([k({constValue:!1})],Lo.prototype,"stippleRequiresStretchMeasure",void 0);var mR;(function(i){i[i.START=0]="START",i[i.END=1]="END"})(mR||(mR={}));let X8=class extends Fd{constructor(e){super(e,new FEe),this._configuration=new Lo}getConfiguration(e,t){this._configuration.output=e,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.hasVertexColors=this.parameters.hasVertexColors,this._configuration.transparent=this.parameters.color[3]<1||this.parameters.width<1,this._configuration.draped=t.slot===le.DRAPED_MATERIAL;const r=y(this.parameters.stipplePattern);return this._configuration.stippleEnabled=r,this._configuration.stippleOffColorEnabled=r&&y(this.parameters.stippleOffColor),this._configuration.hasOccludees=this.parameters.hasOccludees,this._configuration.stipplePreferContinuous=this.parameters.stipplePreferContinuous,this._configuration}intersect(e,t,r,n,s,a,o,l,c){y(c)?zne(e,n,c,a,1,o):this._intersectLineGeometry(e,t,r,n,o)}_intersectLineGeometry(e,t,r,n,s){if(!n.options.selectionMode||UR(t))return;if(!fH(r))return void ee.getLogger("esri.views.3d.webgl-engine.materials.NativeLineMaterial").error("intersection assumes a translation-only matrix");const a=e.vertexAttributes.get(S.POSITION).data,o=n.camera,l=kEe;wn(l,n.point);const c=2;Y(w1[0],l[0]-c,l[1]+c,0),Y(w1[1],l[0]+c,l[1]+c,0),Y(w1[2],l[0]+c,l[1]-c,0),Y(w1[3],l[0]-c,l[1]-c,0);for(let _=0;_<4;_++)if(!o.unprojectFromRenderScreen(w1[_],Cu[_]))return;Bh(o.eye,Cu[0],Cu[1],TM),Bh(o.eye,Cu[1],Cu[2],CM),Bh(o.eye,Cu[2],Cu[3],SM),Bh(o.eye,Cu[3],Cu[0],EM);let u=Number.MAX_VALUE,d=0;for(let _=0;_<a.length-5;_+=3){if(Vs[0]=a[_]+r[12],Vs[1]=a[_+1]+r[13],Vs[2]=a[_+2]+r[14],Us[0]=a[_+3]+r[12],Us[1]=a[_+4]+r[13],Us[2]=a[_+5]+r[14],tr(TM,Vs)<0&&tr(TM,Us)<0||tr(CM,Vs)<0&&tr(CM,Us)<0||tr(SM,Vs)<0&&tr(SM,Us)<0||tr(EM,Vs)<0&&tr(EM,Us)<0)continue;if(o.projectToRenderScreen(Vs,mf),o.projectToRenderScreen(Us,ff),mf[2]<0&&ff[2]>0){ae(ah,Vs,Us);const w=o.frustum,v=-tr(w[hr.NEAR],Vs)/_e(ah,Ia(w[hr.NEAR]));Q(ah,ah,v),ce(Vs,Vs,ah),o.projectToRenderScreen(Vs,mf)}else if(mf[2]>0&&ff[2]<0){ae(ah,Us,Vs);const w=o.frustum,v=-tr(w[hr.NEAR],Us)/_e(ah,Ia(w[hr.NEAR]));Q(ah,ah,v),ce(Us,Us,ah),o.projectToRenderScreen(Us,ff)}else if(mf[2]<0&&ff[2]<0)continue;mf[2]=0,ff[2]=0;const g=ID(gg(mf,ff,Y8),l);g<u&&(u=g,X(Q8,Vs),X(Z8,Us),d=_/3)}const m=n.rayBegin,f=n.rayEnd;if(u<c*c){let _=Number.MAX_VALUE;if(DG(gg(Q8,Z8,Y8),gg(m,f,NEe),pf)){ae(pf,pf,m);const g=we(pf);Q(pf,pf,1/g),_=g/Li(m,f)}s(_,pf,d,!1)}}computeAttachmentOrigin(e,t){const r=e.vertexAttributes;if(!r)return!1;const n=r.get(S.POSITION);return WD(n,null,!1,t)}requiresSlot(e,t){return!(t!==V.Color&&t!==V.Highlight&&t!==V.ObjectAndLayerIdColor||e!==le.OPAQUE_MATERIAL&&e!==le.DRAPED_MATERIAL)}createGLMaterial(e){return new $Ee(e)}createBufferWriter(){const e=this.parameters.hasVertexColors?yK:sSe;return C(this.parameters.stipplePattern)?new HP(e):new DEe(e.clone().vec3f(S.AUXPOS1).vec2f(S.UV0))}},$Ee=class extends r_{constructor(){super(...arguments),this._stipplePattern=null}dispose(){super.dispose(),this._stippleTextureRepository.release(this._stipplePattern),this._stipplePattern=null}_updateOccludeeState(e){e.hasOccludees!==this._material.parameters.hasOccludees&&this._material.setParameters({hasOccludees:e.hasOccludees})}beginSlot(e){this._output===V.Color&&this._updateOccludeeState(e);const t=this._material.parameters.stipplePattern;return this._stipplePattern!==t&&(this._material.setParameters(this._stippleTextureRepository.swap(this._stipplePattern,t)),this._stipplePattern=t),this.ensureTechnique(UK,e)}},DEe=class{constructor(e){this.vertexBufferLayout=e}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){return e.indices.get(S.POSITION).length}write(e,t,r,n,s){QD(r,this.vertexBufferLayout,e,t,n,s),this._writeAuxpos1(e,r,n,s),this._writeUV0(e,r,n,s)}_writeAuxpos1(e,t,r,n){const s=r.getField(S.AUXPOS1,Fm),a=t.indices.get(S.POSITION),o=t.vertexAttributes.get(S.POSITION).data,l=e,c=s.typedBufferStride,u=s.typedBuffer;n*=c;for(let d=0;d<a.length-1;d+=2)for(const m of[1,0]){const f=3*a[d+m],_=o[f],g=o[f+1],w=o[f+2],v=l[0]*_+l[4]*g+l[8]*w+l[12],b=l[1]*_+l[5]*g+l[9]*w+l[13],x=l[2]*_+l[6]*g+l[10]*w+l[14];u[n]=v,u[n+1]=b,u[n+2]=x,n+=c}}_writeUV0(e,t,r,n){var x;const s=r.getField(S.UV0,TH),a=t.indices.get(S.POSITION),o=t.vertexAttributes.get(S.POSITION).data,l=(x=t.vertexAttributes.get(S.DISTANCETOSTART))==null?void 0:x.data,c=s.typedBufferStride,u=s.typedBuffer;let d=0;u[n*=c]=mR.START,u[n+1]=d,n+=c;const m=3*a[0],f=Y(Vs,o[m],o[m+1],o[m+2]);e&&Me(f,f,e);const _=Us,g=a.length-1;let w=1;const v=l?(T,R,E)=>d=l[E]:(T,R,E)=>d+=Li(T,R);for(let T=1;T<g;T+=2){const R=3*a[T];Y(_,o[R],o[R+1],o[R+2]),e&&Me(_,_,e),v(f,_,w++);for(let E=0;E<2;++E)u[n]=1-E,u[n+1]=d,n+=c;X(f,_)}const b=3*a[g];Y(_,o[b],o[b+1],o[b+2]),e&&Me(_,_,e),v(f,_,w),u[n]=mR.END,u[n+1]=d}},FEe=class extends qx{constructor(){super(...arguments),this.color=Pc,this.hasVertexColors=!1,this.hasSlicePlane=!1,this.width=1,this.stipplePreferContinuous=!0,this.hasOccludees=!1,this.stippleTexture=null}};const Vs=P(),Us=P(),ah=P(),pf=P(),mf=is(),ff=is(),Q8=P(),Z8=P(),Y8=yv(),NEe=yv(),kEe=P(),w1=[is(),is(),is(),is()],Cu=[P(),P(),P(),P()],TM=fr(),CM=fr(),SM=fr(),EM=fr(),VEe=["mesh"];let UEe=class extends du{constructor(e,t,r,n){super(e,t,r,n),this._materials=new Map,this._textures=new Map,this.ensureDrapedStatus(!1)}async doLoad(){Wt.DRAW_MESH_GEOMETRY_NORMALS&&(this._debugVertexNormalMaterial=new X8({color:[1,0,1,1]}),this._debugFaceNormalMaterial=new X8({color:[0,1,1,1]}))}destroy(){super.destroy(),this._context.stage.removeMany(Array.from(this._materials.values(),e=>e.material)),this._context.stage.removeMany(Array.from(this._textures.values())),this._materials.clear(),this._textures.clear()}createGraphics3DGraphic(e){const t=e.graphic;if(!this._validateGeometry(t.geometry,VEe,"fill on mesh-3d"))return null;const r=this.setGraphicElevationContext(t,new Qc),n=e.renderingInfo;return this._createAs3DShape(t,n,r,t.uid)}layerOpacityChanged(e,t){const r=this._getLayerOpacity();this._materials.forEach(n=>{n.material.setParameters({layerOpacity:r});const s=n.material.parameters;this._setMaterialTransparentParameter(s,n),n.material.setParameters({transparent:s.transparent})}),e.forEach(n=>{const s=t(n);y(s)&&s.layerOpacityChanged(r,this._context.isAsync)})}layerElevationInfoChanged(e,t){return this.updateGraphics3DGraphicElevationInfo(e,t,Bm)}slicePlaneEnabledChanged(e,t){return this._materials.forEach(r=>{r.material.setParameters({hasSlicePlane:this._context.slicePlaneEnabled})}),e.forEach(r=>{const n=t(r);y(n)&&n.slicePlaneEnabledChanged(this._context.slicePlaneEnabled,this._context.isAsync)}),!0}physicalBasedRenderingChanged(){const e=this._usePBR();return this._materials.forEach(t=>t.material.setParameters({usePBR:e})),!0}pixelRatioChanged(){return!0}_requiresSymbolVertexColors(){return this._drivenProperties.color||this._drivenProperties.opacity}_colorOrTextureUid(e){return C(e)?"-":e instanceof ti?e.toHex():e.contentHash}_materialPropertiesDefault(e,t){const r=this._requiresSymbolVertexColors(),n=!!e.vertexAttributes.color,s=!!e.vertexAttributes.tangent;return{hasSymbolVertexColors:r,hasVertexColors:n,hasVertexTangents:s,uid:`vc:${n},vt:${s},vct${t},svc:${r}`}}_materialProperties(e,t,r){const n=this._materialPropertiesDefault(e,r);if(!t.material)return n;const{color:s,colorTexture:a,normalTexture:o,doubleSided:l,alphaCutoff:c,alphaMode:u}=t.material,d=this._colorOrTextureUid(s),m=this._colorOrTextureUid(a),f=this._colorOrTextureUid(o);if(n.color=s,n.colorTexture=a,n.normalTexture=o,n.uid=`${n.uid},cmuid:${d},ctmuid:${m},ntmuid:${f},ds:${l},ac:${c},am:${u}`,t.material instanceof _ae){const{metallic:_,roughness:g,metallicRoughnessTexture:w,emissiveColor:v,emissiveTexture:b,occlusionTexture:x}=t.material,T=this._colorOrTextureUid(w),R=this._colorOrTextureUid(v),E=this._colorOrTextureUid(b),O=this._colorOrTextureUid(x);n.metallic=_,n.roughness=g,n.metallicRoughnessTexture=w,n.emissiveColor=v,n.emissiveTexture=b,n.occlusionTexture=x,n.colorTextureTransform=t.material.colorTextureTransform,n.normalTextureTransform=t.material.normalTextureTransform,n.emissiveTextureTransform=t.material.emissiveTextureTransform,n.occlusionTextureTransform=t.material.occlusionTextureTransform,n.metallicRoughnessTextureTransform=t.material.metallicRoughnessTextureTransform,n.uid=`${n.uid},mrm:${_},mrr:${g},mrt:${T},emuid:${R},etmuid:${E},otmuid:${O}`}return n}_setInternalColorValueParameters(e,t){t.diffuse=ti.toUnitRGB(e),t.opacity=e.a}_getLoadableTextureResource(e){return e.data?e.data:e.url}_getInternalTextureId(e){const t=this._getInternalTexture(e,Ho.Opaque);return y(t)?t.id:null}_getInternalTexture(e,t){const r=this._getLoadableTextureResource(e);if(!r)return null;const n=`${e.contentHash}/${t}`;let s=this._textures.get(n);return s||(s=new jR(r,{mipmap:!0,wrap:this._castTextureWrap(e.wrap),noUnpackFlip:!0,preMultiplyAlpha:t!==Ho.Opaque}),this._textures.set(n,s),this._context.stage.add(s),this._context.stage.loadImmediate(s)),s}_castTextureWrap(e="repeat"){if(typeof e=="string"){const t=this._castTextureWrapIndividual(e);return{s:t,t}}return{s:this._castTextureWrapIndividual(e.horizontal),t:this._castTextureWrapIndividual(e.vertical)}}_castTextureWrapIndividual(e){switch(e){case"clamp":return ai.CLAMP_TO_EDGE;case"mirror":return ai.MIRRORED_REPEAT;default:return ai.REPEAT}}_setInternalMaterialParameters(e,t){if(y(e.color)&&this._setInternalColorValueParameters(e.color,t),y(e.colorTexture)){const r=this._getInternalTexture(e.colorTexture,t.textureAlphaMode);y(r)?(t.textureId=r.id,t.textureAlphaPremultiplied=!!r.params.preMultiplyAlpha):t.textureId=void 0}y(e.normalTexture)&&(t.normalTextureId=this._getInternalTextureId(e.normalTexture)),y(e.emissiveColor)&&(t.emissiveFactor=ti.toUnitRGB(e.emissiveColor)),y(e.emissiveTexture)&&(t.emissiveTextureId=this._getInternalTextureId(e.emissiveTexture)),y(e.occlusionTexture)&&(t.occlusionTextureId=this._getInternalTextureId(e.occlusionTexture)),y(e.metallicRoughnessTexture)&&(t.metallicRoughnessTextureId=this._getInternalTextureId(e.metallicRoughnessTexture)),t.colorTextureTransformMatrix=Uv(e.colorTextureTransform),t.normalTextureTransformMatrix=Uv(e.normalTextureTransform),t.occlusionTextureTransformMatrix=Uv(e.occlusionTextureTransform),t.emissiveTextureTransformMatrix=Uv(e.emissiveTextureTransform),t.metallicRoughnessTextureTransformMatrix=Uv(e.metallicRoughnessTextureTransform)}_setExternalMaterialParameters(e){const t=this._drivenProperties.color;let r=y(this.symbolLayer.material)?this.symbolLayer.material.colorMixMode:null;if(t)e.externalColor=Pc;else{const n=y(this.symbolLayer.material)?this.symbolLayer.material.color:null;y(n)?e.externalColor=ti.toUnitRGBA(n):(r=null,e.externalColor=Pc)}r&&(e.colorMixMode=r),e.castShadows=!!this.symbolLayer.castShadows}_hasTransparentVertexColors(e){const t=e.vertexAttributes.color;if(C(t))return!1;for(let r=3;r<t.length;r+=4)if(t[r]!==255)return!0;return!1}_getOrCreateMaterial(e,t){var _,g,w;const r=(_=t.material)==null?void 0:_.color,n=(g=t.material)==null?void 0:g.colorTexture,s=(w=t.material)==null?void 0:w.alphaMode,a=s==="blend",o=s!=="opaque"&&(this._hasTransparentVertexColors(e)||y(r)&&r.a<1||y(n)&&n.transparent||a),l=this._materialProperties(e,t,o),c=this._materials.get(l.uid);if(c)return c.material;const u={material:null,isComponentTransparent:o,alphaMode:t.material?t.material.alphaMode:"opaque"},d=l.metallicRoughnessTexture==null&&l.metallic==null&&l.roughness==null,m={usePBR:this._usePBR(),isSchematic:d,hasVertexColors:l.hasVertexColors,hasSymbolColors:l.hasSymbolVertexColors,hasVertexTangents:l.hasVertexTangents,ambient:Gl,diffuse:em,opacity:1,doubleSided:!0,doubleSidedType:"winding-order",cullFace:tn.None,layerOpacity:this._getLayerOpacity(),hasSlicePlane:this._context.slicePlaneEnabled,initTextureTransparent:!0};d||(m.mrrFactors=[l.metallic!=null?l.metallic:1,l.roughness!=null?l.roughness:1,.5]),t.material&&(m.doubleSided=t.material.doubleSided,m.cullFace=t.material.doubleSided?tn.None:tn.Back,m.textureAlphaCutoff=t.material.alphaCutoff),this._setExternalMaterialParameters(m),this._setMaterialTransparentParameter(m,u),this._setInternalMaterialParameters(l,m);const f=new Ow(m);return u.material=f,this._materials.set(l.uid,u),this._context.stage.add(f),f}_usePBR(){return this._context.physicalBasedRenderingEnabled}_setMaterialTransparentParameter(e,t){e.transparent=this.needsDrivenTransparentPass||t.isComponentTransparent||e.layerOpacity<1||e.opacity<1||e.externalColor&&e.externalColor[3]<1,t.alphaMode==="auto"?e.textureAlphaMode=e.transparent?Ho.MaskBlend:Ho.Opaque:e.textureAlphaMode=t.alphaMode==="opaque"?Ho.Opaque:t.alphaMode==="mask"?Ho.Mask:Ho.Blend}_addDebugNormals(e,t,r,n){const s=t.length,a=e.spatialReference.isGeographic?20015077/180:1,o=.1*Math.max(e.extent.width*a,e.extent.height*a,e.extent.zmax-e.extent.zmin),l=[],c=[],u=[],d=[];for(let _=0;_<s;_++){const g=t[_],w=g.vertexAttributes.get(S.POSITION),v=g.vertexAttributes.get(S.NORMAL),b=g.indices.get(S.POSITION),x=g.indices.get(S.NORMAL),T=w.data,R=v.data;for(let E=0;E<b.length;E++){const O=3*b[E],$=3*x[E];for(let D=0;D<3;D++)l.push(T[O+D]);for(let D=0;D<3;D++)l.push(T[O+D]+R[$+D]*o);if(c.push(c.length),c.push(c.length),E%3==0){this._calculateFaceNormal(T,b,E,Y_),this._getFaceVertices(T,b,E,Xn,Q_,Z_),ce(Xn,Xn,Q_),ce(Xn,Xn,Z_),Q(Xn,Xn,1/3);for(let D=0;D<3;D++)u.push(Xn[D]);for(let D=0;D<3;D++)u.push(Xn[D]+Y_[D]*o);d.push(d.length),d.push(d.length)}}}const m=new jr([[S.POSITION,{data:l,size:3,exclusive:!0}]],[[S.POSITION,c]],Fc.Line);t.push(m),r.push(this._debugVertexNormalMaterial),n.push(SS(n[0]));const f=new jr([[S.POSITION,{data:u,size:3,exclusive:!0}]],[[S.POSITION,d]],Fc.Line);t.push(f),r.push(this._debugFaceNormalMaterial),n.push(SS(n[0]))}_createAs3DShape(e,t,r,n){const s=e.geometry;if(s.type!=="mesh")return null;const a=this._createGeometryInfo(s,t,n);if(!a)return null;const{geometries:o,materials:l,transformations:c,objectTransformation:u}=a;Wt.DRAW_MESH_GEOMETRY_NORMALS&&this._addDebugNormals(s,o,l,c);const d=new Bd({geometries:o,materials:l,transformations:c,metadata:{layerUid:this._context.layer.uid,graphicUid:n}});d.transformation=u;const m=this._createEdgeMaterial(),f=y(m)?{baseMaterial:l[0],edgeMaterials:[m],properties:{mergeGeometries:!0,hasSlicePlane:this._context.slicePlaneEnabled}}:null,_=new uu(this,d,o,null,null,_x,r,f);return _.needsElevationUpdates=Bm(r.mode),_.useObjectOriginAsAttachmentOrigin=!0,_.elevationContext.centerPointInElevationSR=this._getCenterPointInElevationSR(d),_.alignedSampledElevation=_x(_,_.elevationContext,this._context.elevationProvider,this._context.renderCoordsHelper),_}_getCenterPointInElevationSR(e){const t=kd(0,0,0,y(this._context.elevationProvider.spatialReference)?this._context.elevationProvider.spatialReference:null);return Y7([e.transformation[12],e.transformation[13],e.transformation[14]],this._context.renderCoordsHelper.spatialReference,t),t}_createComponentNormals(e,t,r,n){switch(r.shading||"flat"){case"source":return this._createComponentNormalsSource(e,t,r,n);case"flat":return this._createComponentNormalsFlat(e,n);case"smooth":return this._createComponentNormalsSmooth(e,n);default:return}}_createComponentNormalsSource(e,t,r,n){if(C(t))return this._createComponentNormalsFlat(e,n);let s=!1;if(!r.trustSourceNormals)for(let a=0;a<n.length;a+=3){this._calculateFaceNormal(e,n,a,Y_);for(let o=0;o<3;o++){const l=3*n[a+o];Xn[0]=t[l+0],Xn[1]=t[l+1],Xn[2]=t[l+2],_e(Y_,Xn)<0&&(t[l+0]=-t[l+0],t[l+1]=-t[l+1],t[l+2]=-t[l+2],s=!0)}}return{normals:t,indices:n,didFlipNormals:s}}_createComponentNormalsFlat(e,t){const r=new Float32Array(t.length),n=new Array(3*t.length);for(let s=0;s<t.length;s+=3){const a=this._calculateFaceNormal(e,t,s,Y_);for(let o=0;o<3;o++)r[s+o]=a[o],n[s+o]=s/3}return{normals:r,indices:n,didFlipNormals:!1}}_createComponentNormalsSmooth(e,t){const r={};for(let a=0;a<t.length;a+=3){const o=this._calculateFaceNormal(e,t,a,Y_);for(let l=0;l<3;l++){const c=t[a+l];let u=r[c];u||(u={normal:P(),count:0},r[c]=u),ce(u.normal,u.normal,o),u.count++}}const n=new Float32Array(3*t.length),s=new Array(3*t.length);for(let a=0;a<t.length;a++){const o=r[t[a]];o.count!==1&&(de(o.normal,o.normal),o.count=1);for(let l=0;l<3;l++)n[3*a+l]=o.normal[l];s[a]=a}return{normals:n,indices:s,didFlipNormals:!1}}_getFaceVertices(e,t,r,n,s,a){const o=3*t[r+0],l=3*t[r+1],c=3*t[r+2];n[0]=e[o+0],n[1]=e[o+1],n[2]=e[o+2],s[0]=e[l+0],s[1]=e[l+1],s[2]=e[l+2],a[0]=e[c+0],a[1]=e[c+1],a[2]=e[c+2]}_calculateFaceNormal(e,t,r,n){return this._getFaceVertices(e,t,r,Xn,Q_,Z_),ae(Q_,Q_,Xn),ae(Z_,Z_,Xn),ut(Xn,Q_,Z_),de(n,Xn),n}_getOrCreateComponents(e){return Ke(e.components,zEe)}_createPositionBuffer(e,t){let r=e.vertexAttributes.position;const n=t.reprojection===Fo.ECEF?t.transformBeforeProject:null;if(y(n)&&(r=Nse(r,new Float64Array(r.length),n)),t.reprojection===Fo.NONE)return t.needsBufferCopy?new Float64Array(r):r;const s=y(n)?r:new Float64Array(r.length);return Ma(r,e.spatialReference,0,s,this._context.renderCoordsHelper.spatialReference,0,r.length/3),s}_createNormalBuffer(e,t,r){let n=e.vertexAttributes.normal;if(C(n))return null;const s=r.reprojection===Fo.ECEF?r.transformBeforeProject:null;if(y(s)&&(n=kse(n,new Float32Array(n.length),s)),this._context.graphicsCoreOwner.view.viewingMode==="local"||r.reprojection===Fo.NONE)return r.needsBufferCopy&&e.vertexAttributes.normal===n?new Float32Array(n):n;const a=e.vertexAttributes.position,o=y(s)?n:new Float32Array(n.length);return Vse(n,a,t,e.spatialReference,o)}_createTangentBuffer(e,t,r){let n=e.vertexAttributes.tangent;if(C(n))return null;const s=r.reprojection===Fo.ECEF?r.transformBeforeProject:null;if(y(s)&&(n=Use(n,new Float32Array(n.length),s)),this._context.graphicsCoreOwner.view.viewingMode==="local"||r.reprojection===Fo.NONE)return r.needsBufferCopy&&e.vertexAttributes.normal===n?new Float32Array(n):n;const a=e.vertexAttributes.position,o=y(s)?n:new Float32Array(n.length);return zse(n,a,t,e.spatialReference,o)}_createColorBuffer(e){return e.vertexAttributes.color}_createSymbolColorBuffer(e){if(this._requiresSymbolVertexColors()){const t=this._getVertexOpacityAndColor(e),r=Uae(en(this.symbolLayer,"material","colorMixMode")),n=new Uint8Array(4);return IH(t,r,n),n}return null}_createBuffers(e,t){const r=e.vertexAttributes&&e.vertexAttributes.position;if(!r)return this.logger.warn("Mesh geometry must contain position vertex attributes"),null;const n=e.vertexAttributes.normal,s=e.vertexAttributes.uv,a=e.vertexAttributes.tangent;if(y(n)&&n.length!==r.length)return this.logger.warn("Mesh normal vertex buffer must contain the same number of elements as the position buffer"),null;if(y(a)&&a.length/4!=r.length/3)return this.logger.warn("Mesh tangent vertex buffer must contain the same number of elements as the position buffer"),null;if(y(s)&&s.length/2!=r.length/3)return this.logger.warn("Mesh uv vertex buffer must contain the same number of elements as the position buffer"),null;const o=this._computeReprojectionInfo(e),l=this._createPositionBuffer(e,o),c=this._createColorBuffer(e),u=this._createSymbolColorBuffer(t),d=this._createNormalBuffer(e,l,o),m=this._createTangentBuffer(e,l,o);return{positionBuffer:l,normalBuffer:d,tangentBuffer:m,uvBuffer:s,colorBuffer:c,symbolColorBuffer:u,objectTransformation:o.reprojection===Fo.NONE&&y(o.objectTransformation)?o.objectTransformation:this._transformOriginLocal(e,l,d,m),geometryTransformation:o.reprojection===Fo.NONE&&y(o.geometryTransformation)?o.geometryTransformation:xe()}}_computeReprojectionInfo(e){const t=y(e.transform),r=t&&e.transform.geographic||this._context.renderCoordsHelper.viewingMode===Ie.Local?Fo.NONE:Fo.ECEF;if(t){if(r===Fo.NONE){const s=xe();return xd(e.spatialReference,e.transform.origin,s,this._context.renderCoordsHelper.spatialReference),{reprojection:r,objectTransformation:s,geometryTransformation:SS(e.transform.localMatrix),needsBufferCopy:!1}}const n=MG(xe(),e.transform.origin);return Hr(n,n,e.transform.localMatrix),{reprojection:r,transformBeforeProject:n,needsBufferCopy:!0}}return{reprojection:r,needsBufferCopy:!0}}_transformOriginLocal(e,t,r,n){const s=this._context.renderCoordsHelper.spatialReference,a=e.anchor;NC[0]=a.x,NC[1]=a.y,NC[2]=a.z;const o=xe();xd(e.spatialReference,NC,o,s);const l=Dm.fromTypedArray(t);if(kn(K8,o),EH(l,l,K8),y(r)||y(n)){if(Td(x1,o),qc(x1,x1),y(r)){const c=Fm.fromTypedArray(r);YE(c,c,x1)}if(y(n)){const c=Fm.fromTypedArray(n,4*n.BYTES_PER_ELEMENT);YE(c,c,x1)}}return o}_validateFaces(e,t){const r=e.vertexAttributes.position.length/3,n=t.faces;if(n){let s=-1;for(let a=0;a<n.length;a++){const o=n[a];o>s&&(s=o)}if(r<=s)return this.logger.warn(`Vertex index ${s} is out of bounds of the mesh position buffer`),!1}else if(r%3!=0)return this.logger.warn("Mesh position buffer length must be a multiple of 9 if no component faces are defined (3 values per vertex * 3 vertices per triangle)"),!1;return!0}_getOrCreateFaces(e,t){return t.faces?t.faces:KD(e.vertexAttributes.position.length/3)}_isOutsideClippingArea(e){if(!this._context.clippingExtent)return!1;const t=e.vertexAttributes&&e.vertexAttributes.position;if(!t)return!1;const r=this._context.elevationProvider.spatialReference;let n;const s=t.length/3;return y(r)&&!e.spatialReference.equals(r)?(n=new Float64Array(t.length),Ma(e.vertexAttributes.position,e.spatialReference,0,n,r,0,s)):n=t,Ii(RM),Jo(RM,n,0,s),!Lc(RM,this._context.clippingExtent)}_createGeometryInfo(e,t,r){if(!gv(e.spatialReference,this._context.graphicsCoreOwner.view.spatialReference))return this.logger.warn("Geometry spatial reference is not compatible with the view"),null;if(this._isOutsideClippingArea(e))return null;const n=this._createBuffers(e,t);if(C(n))return null;const{positionBuffer:s,uvBuffer:a,colorBuffer:o,symbolColorBuffer:l,normalBuffer:c,tangentBuffer:u,objectTransformation:d,geometryTransformation:m}=n,f=this._getOrCreateComponents(e),_=[],g=[],w=[];let v=!1;for(const b of f){if(!this._validateFaces(e,b))return null;const x=this._getOrCreateFaces(e,b);if(x.length===0)continue;const T=this._createComponentNormals(s,c,b,x);T.didFlipNormals&&(v=!0);const R=[[S.POSITION,{size:3,data:s,exclusive:!0}],[S.NORMAL,{size:3,data:T.normals,exclusive:!0}]],E=[[S.POSITION,x],[S.NORMAL,T.indices]];y(o)&&(R.push([S.COLOR,{size:4,data:o,exclusive:!0}]),E.push([S.COLOR,x])),y(l)&&(R.push([S.SYMBOLCOLOR,{size:4,data:l,exclusive:!0}]),E.push([S.SYMBOLCOLOR,new Array(x.length).fill(0)])),y(a)&&(R.push([S.UV0,{size:2,data:a,exclusive:!0}]),E.push([S.UV0,x])),y(u)&&(R.push([S.TANGENT,{size:4,data:u,exclusive:!0}]),E.push([S.TANGENT,x]));const O=this._context.stage.renderView._getObjectAndLayerIdColor({graphicUid:r,layerUid:this._context.layer.uid}),$=new jr(R,E,Fc.Triangle,O);_.push($),g.push(m),w.push(this._getOrCreateMaterial(e,b))}return v&&this.logger.warn("Normals have been automatically flipped to be consistent with the counter clock wise face winding order. It is better to generate mesh geometries that have consistent normals."),{geometries:_,transformations:g,materials:w,objectTransformation:d}}_createEdgeMaterial(){const e={opacity:this._getLayerOpacity()};return SH(this.symbolLayer,e)}};const NC=P(),Xn=P(),Q_=P(),Z_=P(),Y_=P(),K8=xe(),x1=Or(),RM=Ms(),zEe=[new gae];var Fo;(function(i){i[i.NONE=0]="NONE",i[i.ECEF=1]="ECEF"})(Fo||(Fo={}));let BEe=class{constructor(e,t,r,n){this.graphics3DSymbolLayer=e,this.instanceIndex=t,this.elevationAligner=r,this.elevationContext=n,this.type="lod-instance",this._highlights=new Set,this.alignedSampledElevation=0,this.isElevationSource=!1,this.needsElevationUpdates=!1}initialize(){}setVisibility(e){const t=this._lodRenderer.instanceData;e!==t.getVisible(this.instanceIndex)&&t.setVisible(this.instanceIndex,e)}destroy(){this.instanceIndex!=null&&(this._lodRenderer.instanceData.removeInstance(this.instanceIndex),this.graphics3DSymbolLayer.notifyDestroyGraphicLayer(this))}alignWithElevation(e,t,r){if(this.elevationAligner){C4(this.elevationContext.featureExpressionInfoContext,r);const n=this.elevationAligner(this,this.elevationContext,e,t);y(n)&&(this.alignedSampledElevation=n)}}getCenterObjectSpace(e=P()){return this._lodRenderer.instanceData.getCombinedLocalTransform(this.instanceIndex,oh),Me(e,this._lodRenderer.baseBoundingSphere.center,oh)}getBoundingBoxObjectSpace(e=Ms()){this._lodRenderer.instanceData.getCombinedLocalTransform(this.instanceIndex,oh);const t=this._lodRenderer.baseBoundingBox;Ii(e);for(let r=0;r<8;++r)Y(dl,1&r?t[3]:t[0],2&r?t[4]:t[1],4&r?t[5]:t[2]),Me(dl,dl,oh),Z0(e,dl);return e}computeAttachmentOrigin(e){this._lodRenderer.instanceData.getGlobalTransform(this.instanceIndex,oh),e.render.origin[0]+=oh[12],e.render.origin[1]+=oh[13],e.render.origin[2]+=oh[14],e.render.num++}async getProjectedBoundingBox(e,t,r,n,s){const a=this.getBoundingBoxObjectSpace(s),o=GEe,l=JD(a)?1:o.length;this._lodRenderer.instanceData.getGlobalTransform(this.instanceIndex,oh);for(let u=0;u<l;u++){const d=o[u];dl[0]=a[d[0]],dl[1]=a[d[1]],dl[2]=a[d[2]],Me(dl,dl,oh),gf[3*u+0]=dl[0],gf[3*u+1]=dl[1],gf[3*u+2]=dl[2]}if(!e(gf,0,l))return null;Ii(a);let c=null;this.calculateRelativeScreenBounds&&(c=this.calculateRelativeScreenBounds());for(let u=0;u<3*l;u+=3){for(let d=0;d<3;d++)a[d]=Math.min(a[d],gf[u+d]),a[d+3]=Math.max(a[d+3],gf[u+d]);c&&r.push({location:gf.slice(u,u+3),screenSpaceBoundingRect:c})}if(t&&(Ic(a,PM),this.elevationContext.mode!=="absolute-height")){let u;const d=x4(a,t.service.spatialReference,t);try{u=await t.service.queryElevation(PM[0],PM[1],n,d,"ground")}catch{}y(u)&&wH(a,0,0,-this.alignedSampledElevation+u)}return a}addObjectState(e,t){if(e===Dg.Highlight){const r=new hR(e);this._addHighlightId(r),t.addExternal(n=>{this._removeHighlightId(n)},r)}}removeObjectState(e){this._highlights.forEach(t=>e.remove(t))}_addHighlightId(e){this._highlights.add(e),this._lodRenderer.instanceData.setHighlight(this.instanceIndex,!0)}_removeHighlightId(e){this._highlights.delete(e),this._lodRenderer.instanceData.setHighlight(this.instanceIndex,this._highlights.size>0)}get _lodRenderer(){return this.graphics3DSymbolLayer.lodRenderer}};const gf=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],dl=P(),PM=P(),GEe=[[0,1,2],[3,1,2],[0,4,2],[3,4,2],[0,1,5],[3,1,5],[0,4,5],[3,4,5]],oh=xe();function HEe(i){const e=[];return i.stageResources.geometries.forEach((t,r)=>{const n=i.stageResources.materials[r],s=i.stageResources.textures;e.push({material:n,geometry:t,textures:s})}),{components:e,minScreenSpaceRadius:y(i.lodThreshold)?i.lodThreshold:0,pivotOffset:i.pivotOffset}}function jEe(i){return{levels:i.map(e=>HEe(e))}}function qEe(i,e=XEe){const t=uCe(i);return Math.sqrt(t/(e*Math.PI))}function WEe(i){i.levels.forEach(e=>{e.minScreenSpaceRadius||(e.minScreenSpaceRadius=qEe(e))})}const XEe=.05;var Si;function QEe(i){let e=sn().mat4f64(S.LOCALTRANSFORM).mat4f64(S.GLOBALTRANSFORM).vec4f64(S.BOUNDINGSPHERE).vec3f64(S.MODELORIGIN).mat3f(S.MODEL).mat3f(S.MODELNORMAL).vec2f(S.MODELSCALEFACTORS);return i.includes("color")&&(e=e.vec4f(S.COLOR)),i.includes("featureAttribute")&&(e=e.vec4f(S.FEATUREATTRIBUTE)),e=e.u8(S.STATE).u8(S.LODLEVEL),i.includes(S.OBJECTANDLAYERIDCOLOR)&&(e=e.vec4u8(S.OBJECTANDLAYERIDCOLOR)),e.alignTo(8),e}(function(i){i[i.ALLOCATED=1]="ALLOCATED",i[i.DEFAULT_ACTIVE=2]="DEFAULT_ACTIVE",i[i.VISIBLE=4]="VISIBLE",i[i.HIGHLIGHT=8]="HIGHLIGHT",i[i.HIGHLIGHT_ACTIVE=16]="HIGHLIGHT_ACTIVE",i[i.REMOVE=32]="REMOVE",i[i.TRANSFORM_CHANGED=64]="TRANSFORM_CHANGED",i[i.ACTIVE=18]="ACTIVE"})(Si||(Si={}));let ZEe=class{constructor(e){this.localTransform=e.getField(S.LOCALTRANSFORM,ck),this.globalTransform=e.getField(S.GLOBALTRANSFORM,ck),this.modelOrigin=e.getField(S.MODELORIGIN,Dm),this.model=e.getField(S.MODEL,Lw),this.modelNormal=e.getField(S.MODELNORMAL,Lw),this.modelScaleFactors=e.getField(S.MODELSCALEFACTORS,TH),this.boundingSphere=e.getField(S.BOUNDINGSPHERE,iae),this.color=e.getField(S.COLOR,Sd),this.featureAttribute=e.getField(S.FEATUREATTRIBUTE,Sd),this.state=e.getField(S.STATE,hk),this.lodLevel=e.getField(S.LODLEVEL,hk),this.objectAndLayerIdColor=e.getField(S.OBJECTANDLAYERIDCOLOR,$m)}},YEe=class extends nn{constructor(e,t){super(),this._capacity=0,this._size=0,this._next=0,this._buffer=null,this._view=null,this._layout=QEe(e),this._shaderTransformation=t}get capacity(){return this._capacity}get size(){return this._size}get buffer(){return this._buffer.buffer}get view(){return this._view}addInstance(){this._size+1>this._capacity&&this._grow();const e=this._findSlot();return this._view.state.set(e,Si.ALLOCATED),this._size++,this.emit("instance-added",{index:e}),e}removeInstance(e){const t=this._view.state;ct(e>=0&&e<this._capacity&&t.get(e)&Si.ALLOCATED,"invalid instance handle"),this._getStateFlag(e,Si.ACTIVE)?this._setStateFlags(e,Si.REMOVE):this.freeInstance(e),this.emit("instance-removed",{index:e})}freeInstance(e){const t=this._view.state;ct(e>=0&&e<this._capacity&&t.get(e)&Si.ALLOCATED,"invalid instance handle"),t.set(e,0),this._size--}setLocalTransform(e,t,r=!0){this._view.localTransform.setMat(e,t),r&&this.updateModelTransform(e)}getLocalTransform(e,t){this._view.localTransform.getMat(e,t)}setGlobalTransform(e,t,r=!0){this._view.globalTransform.setMat(e,t),r&&this.updateModelTransform(e)}getGlobalTransform(e,t){this._view.globalTransform.getMat(e,t)}updateModelTransform(e){const t=this._view,r=lp,n=tc;t.localTransform.getMat(e,J8),t.globalTransform.getMat(e,AM);const s=Hr(AM,AM,J8);Y(r,s[12],s[13],s[14]),t.modelOrigin.setVec(e,r),Td(n,s),t.model.setMat(e,n);const a=kye(lp,s);a.sort(),t.modelScaleFactors.set(e,0,a[1]),t.modelScaleFactors.set(e,1,a[2]),Kg(n,n),qc(n,n),t.modelNormal.setMat(e,n),this._setStateFlags(e,Si.TRANSFORM_CHANGED),this.emit("instance-transform-changed",{index:e})}getModelTransform(e,t){const r=this._view;r.model.getMat(e,tc),r.modelOrigin.getVec(e,lp),t[0]=tc[0],t[1]=tc[1],t[2]=tc[2],t[3]=0,t[4]=tc[3],t[5]=tc[4],t[6]=tc[5],t[7]=0,t[8]=tc[6],t[9]=tc[7],t[10]=tc[8],t[11]=0,t[12]=lp[0],t[13]=lp[1],t[14]=lp[2],t[15]=1}applyShaderTransformation(e,t){this._shaderTransformation&&this._shaderTransformation.applyTransform(this,e,t)}getCombinedModelTransform(e,t){return this.getModelTransform(e,t),this._shaderTransformation&&this._shaderTransformation.applyTransform(this,e,t),t}getCombinedLocalTransform(e,t){return this._view.localTransform.getMat(e,t),this._shaderTransformation&&this._shaderTransformation.applyTransform(this,e,t),t}getCombinedMaxScaleFactor(e){let t=this._view.modelScaleFactors.get(e,1);if(this._shaderTransformation){const r=this._shaderTransformation.scaleFactor(lp,this,e);t*=Math.max(r[0],r[1],r[2])}return t}getCombinedMedianScaleFactor(e){let t=this._view.modelScaleFactors.get(e,0);if(this._shaderTransformation){const r=this._shaderTransformation.scaleFactor(lp,this,e);t*=KEe(r[0],r[1],r[2])}return t}getModel(e,t){this._view.model.getMat(e,t)}setFeatureAttribute(e,t){this._view.featureAttribute.setVec(e,t)}getFeatureAttribute(e,t){this._view.featureAttribute.getVec(e,t)}setColor(e,t){this._view.color.setVec(e,t)}setObjectAndLayerIdColor(e,t){this._view.objectAndLayerIdColor.setVec(e,t)}getColor(e,t){this._view.color.getVec(e,t)}setVisible(e,t){t!==this.getVisible(e)&&(this._setStateFlag(e,Si.VISIBLE,t),this.emit("instance-visibility-changed",{index:e}))}getVisible(e){return this._getStateFlag(e,Si.VISIBLE)}setHighlight(e,t){t!==this.getHighlight(e)&&(this._setStateFlag(e,Si.HIGHLIGHT,t),this.emit("instance-highlight-changed",{index:e}))}getHighlight(e){return this._getStateFlag(e,Si.HIGHLIGHT)}getState(e){return this._view.state.get(e)}getLodLevel(e){return this._view.lodLevel.get(e)}countFlags(e){let t=0;for(let r=0;r<this._capacity;++r)this.getState(r)&e&&++t;return t}_setStateFlags(e,t){const r=this._view.state;t=r.get(e)|t,r.set(e,t)}_clearStateFlags(e,t){const r=this._view.state;t=r.get(e)&~t,r.set(e,t)}_setStateFlag(e,t,r){r?this._setStateFlags(e,t):this._clearStateFlags(e,t)}_getStateFlag(e,t){return!!(this._view.state.get(e)&t)}_grow(){const e=Math.max(JEe,Math.floor(this._capacity*e2e)),t=this._layout.createBuffer(e);if(this._buffer){const r=new Uint8Array(this._buffer.buffer);new Uint8Array(t.buffer).set(r)}this._capacity=e,this._buffer=t,this._view=new ZEe(this._buffer)}_findSlot(){const e=this._view.state;let t=this._next;for(;e.get(t)&Si.ALLOCATED;)t=t+1===this._capacity?0:t+1;return this._next=t+1===this._capacity?0:t+1,t}};function KEe(i,e,t){return Math.max(Math.min(i,e),Math.min(Math.max(i,e),t))}const JEe=1024,e2e=2,lp=P(),tc=Or(),J8=xe(),AM=xe();let t2e=class extends Mc{constructor(e,t){super(r=>Xre(this._instanceData.view.boundingSphere.getVec(r,this._tmpSphere)),{maximumDepth:25}),this._tmpSphere=ou(),this._tmpMat4=xe(),this._instanceData=e,this._boundingSphere=t}addInstance(e){const t=this._instanceData.view.boundingSphere,r=this._instanceData.getCombinedModelTransform(e,this._tmpMat4);Me(this._tmpSphere,this._boundingSphere.center,r),this._tmpSphere[3]=this._boundingSphere.radius*Gg(r),t.setVec(e,this._tmpSphere),this.add([e])}removeInstance(e){this.remove([e])}},i2e=class{constructor(e,t){this.thresholdScale=1,this._camera=new vi,this._worldSpaceRadius=e,this._thresholds=t.map(r=>r)}updateCamera(e){this._camera.copyFrom(e)}selectLevel(e,t){const r=this._camera.computeScreenPixelSizeAt(e),n=this._worldSpaceRadius*t/r,s=this._thresholds;let a=-1;for(let o=0;o<s.length;++o)n>=s[o]*this.thresholdScale&&(a=o);return a}},r2e=class{constructor(e,t){const r=e.renderContext.rctx,{geometry:n,material:s}=t;this._materialRepository=e.materialRep,s.setParameters({instancedDoublePrecision:!0});const a=s.createBufferWriter(),o=a.vertexBufferLayout,l=a.elementCount(n),c=a.allocate(l);a.write(null,null,n,c,0),this.geometry=n,this.material=s,this.glMaterials=new fK(s,this._materialRepository),this.vertexBufferLayout=o,this.vbo=ui.createVertex(r,mi.STATIC_DRAW,c.buffer),this.vao=new nu(r,oi,{geometry:Wc(o)},{geometry:this.vbo}),this.vertexCount=l}destroy(){this.glMaterials.destroy(),this.vbo.dispose(),this.vao.dispose()}get boundingInfo(){return this.geometry.boundingInfo}get triangleCount(){return this.vertexCount/3}intersect(e,t,r,n,s,a,o,l){const c=this.geometry.id;this.material.intersect(this.geometry,null,e.transform.transform,e,r,n,(u,d,m,f,_)=>{if(u>=0){if(t!=null&&!t(e.rayBegin,e.rayEnd,u))return;const g={layerUid:a.layerUid,graphicUid:a.graphicUid(s),geometryId:c,triangleNr:m,baseBoundingSphere:o,numLodLevels:l};if((e.results.min.drapedLayerOrder==null||_>=e.results.min.drapedLayerOrder)&&(e.results.min.dist==null||u<e.results.min.dist)&&e.results.min.set(Ui.LOD,g,u,d,e.transform.transform,_),e.options.store!==zn.MIN&&(e.results.max.drapedLayerOrder==null||_>=e.results.max.drapedLayerOrder)&&(e.results.max.dist==null||u>e.results.max.dist)&&e.results.max.set(Ui.LOD,g,u,d,e.transform.transform,_),e.options.store===zn.ALL){const w=e4(e.results.min.ray);w.set(Ui.LOD,g,u,d,e.transform.transform,_),e.results.all.push(w)}}})}},n2e=class BK{constructor(e,t){this.minScreenSpaceRadius=e,this.components=t}static async create(e,t,r){const n=await Promise.allSettled(t.components.map(a=>e.schedule(()=>new r2e(e,a),r))),s=n.map(a=>a.status==="fulfilled"?a.value:null).filter(a=>a);if(Ec(r)||s.length!==n.length){s.forEach(a=>a.destroy()),Ti(r);for(const a of n)if(a.status==="rejected")throw a.reason}return new BK(t.minScreenSpaceRadius,s)}destroy(){this.components.forEach(e=>e.destroy())}intersect(e,t,r,n,s,a,o){this.components.forEach(l=>l.intersect(e,t,r,n,s,a,this.boundingSphere,o))}get boundingBox(){if(C(this._boundingBox)){const e=Ii();this.components.forEach(t=>{y(t.boundingInfo)&&(Z0(e,t.boundingInfo.bbMin),Z0(e,t.boundingInfo.bbMax))}),this._boundingBox=e}return this._boundingBox}get boundingSphere(){if(C(this._boundingSphere)){const e=this.boundingBox,t=P();Ic(e,t),this._boundingSphere={center:t,radius:.5*xH(e)}}return this._boundingSphere}get triangleCount(){return this.components.reduce((e,t)=>e+t.triangleCount,0)}},s2e=class{constructor(e,t,r){this._elementSize=t,this._buffer=ui.createVertex(e,mi.STATIC_DRAW),this.resize(r)}destroy(){this._buffer.dispose()}get elementSize(){return this._elementSize}get capacity(){return this._capacity}get array(){return this._array}get buffer(){return this._buffer}get memoryUsage(){return{cpu:this._capacity*this._elementSize,gpu:this._capacity*this._elementSize}}copyRange(e,t,r,n=0){const s=new Uint8Array(this.array,e*this.elementSize,(t-e)*this.elementSize);new Uint8Array(r.array,n*this.elementSize).set(s)}transferAll(){this._buffer.setData(this._array)}transferRange(e,t){const r=e*this._elementSize,n=t*this._elementSize;this._buffer.setSubData(new Uint8Array(this._array),r,r,n)}resize(e){const t=e*this._elementSize,r=new ArrayBuffer(t);this._array&&(e>=this._capacity?new Uint8Array(r).set(new Uint8Array(this._array)):new Uint8Array(r).set(new Uint8Array(this._array).subarray(0,e*this._elementSize))),this._array=r,this._buffer.setSize(t),this._capacity=e}},a2e=class{constructor(e){this.modelOriginHi=e.getField(S.MODELORIGINHI,Fm),this.modelOriginLo=e.getField(S.MODELORIGINLO,Fm),this.model=e.getField(S.MODEL,Lw),this.modelNormal=e.getField(S.MODELNORMAL,Lw),this.color=e.getField(S.INSTANCECOLOR,Sd),this.featureAttribute=e.getField(S.INSTANCEFEATUREATTRIBUTE,Sd),this.objectAndLayerIdColor=e.getField(S.OBJECTANDLAYERIDCOLOR_INSTANCED,$m)}},ez=class{constructor(e,t){this._headIndex=0,this._tailIndex=0,this._firstIndex=null,this._captureFirstIndex=!0,this._updating=!1,this._prevHeadIndex=0,this._resized=!1,this._rctx=e,this._instanceBufferLayout=t,this._elementSize=t.stride,this._capacity=1}destroy(){this._buffer&&this._buffer.destroy()}get buffer(){return this._buffer.buffer}get view(){return this._view}get capacity(){return this._capacity}get size(){const e=this._headIndex,t=this._tailIndex;return e>=t?e-t:e+this._capacity-t}get isEmpty(){return this._headIndex===this._tailIndex}get isFull(){return this._tailIndex===(this._headIndex+1)%this._capacity}get headIndex(){return this._headIndex}get tailIndex(){return this._tailIndex}get firstIndex(){return this._firstIndex}get memoryUsage(){return this._buffer?this._buffer.memoryUsage:{cpu:0,gpu:0}}reset(){this._headIndex=0,this._tailIndex=0,this._firstIndex=null}startUpdateCylce(){this._captureFirstIndex=!0}beginUpdate(){ct(!this._updating,"already updating"),this._updating=!0,this._prevHeadIndex=this._headIndex}endUpdate(){ct(this._updating,"not updating"),this.size<l2e*this.capacity&&this._shrink(),this._resized?(this._buffer.transferAll(),this._resized=!1):this._transferRange(this._prevHeadIndex,this._headIndex),this._updating=!1}allocateHead(){ct(this._updating,"not updating"),this.isFull&&this._grow();const e=this.headIndex;return this._captureFirstIndex&&(this._firstIndex=e,this._captureFirstIndex=!1),this._incrementHead(),ct(this._headIndex!==this._tailIndex,"invalid pointers"),e}freeTail(){ct(this._updating,"not updating"),ct(this.size>0,"invalid size");const e=this._tailIndex===this._firstIndex;this._incrementTail(),e&&(this._firstIndex=this._tailIndex)}_grow(){const e=Math.max(tz,Math.floor(this._capacity*o2e));this._resize(e)}_shrink(){const e=Math.max(tz,Math.floor(this._capacity*c2e));this._resize(e)}_resize(e){if(ct(this._updating,"not updating"),e===this._capacity)return;const t=new s2e(this._rctx,this._elementSize,e);if(this._buffer){this._firstIndex&&(this._firstIndex=(this._firstIndex+this._capacity-this._tailIndex)%this._capacity);const r=this.size,n=this._compactInstances(t);ct(n===r,"invalid compaction"),this._buffer.destroy(),this._tailIndex=0,this._headIndex=n,this._prevHeadIndex=0}this._resized=!0,this._capacity=e,this._buffer=t,this._view=new a2e(this._instanceBufferLayout.createView(this._buffer.array))}_compactInstances(e){const t=this._headIndex,r=this._tailIndex;return r<t?(this._buffer.copyRange(r,t,e),t-r):r>t?(this._buffer.copyRange(r,this._capacity,e),t>0&&this._buffer.copyRange(0,t,e,this._capacity-r),t+(this._capacity-r)):0}_incrementHead(e=1){this._headIndex=(this._headIndex+e)%this._capacity}_incrementTail(e=1){this._tailIndex=(this._tailIndex+e)%this._capacity}_transferRange(e,t){e<t?this._buffer.transferRange(e,t):e>t&&(t>0&&this._buffer.transferRange(0,t),this._buffer.transferRange(e,this._capacity))}};const tz=1024,o2e=2,l2e=.3,c2e=.5,h2e=i=>{const e=i.baseBoundingSphere.radius,t=i.levels.map(r=>r.minScreenSpaceRadius);return new i2e(e,t)};let u2e=class{constructor(e,t,r,n){this.type=Ui.LOD,this.isGround=!1,this._levels=[],this._defaultRenderInstanceData=[],this._highlightRenderInstanceData=[],this._instanceIndex=0,this._slicePlane=!1,this._lastCamera=new vi,this._updateCyclesWithStaticCamera=-1,this._needFullCycle=!1,this.slots=[le.OPAQUE_MATERIAL,le.TRANSPARENT_MATERIAL],this.canRender=!0,this._symbol=e,this._optionalFields=t,this._metadata=r,this._instanceBufferLayout=mse({instancedDoublePrecision:!0,instanced:t}),this._glInstanceBufferLayout=Wc(this._instanceBufferLayout,1),this._instanceData=new YEe(this._optionalFields,n),this._instanceData.on("instance-added",()=>this._requestUpdateCycle()),this._instanceData.on("instance-removed",()=>this._requestUpdateCycle()),this._instanceData.on("instance-transform-changed",s=>{this._requestUpdateCycle(),this._metadata.notifyGraphicGeometryChanged(s.index)}),this._instanceData.on("instance-visibility-changed",s=>{this._requestUpdateCycle(!0),this._metadata.notifyGraphicVisibilityChanged(s.index)}),this._instanceData.on("instance-highlight-changed",()=>this._requestUpdateCycle(!0)),this._enableLevelSelection=this._symbol.levels.length>1}get levels(){return this._levels}get baseBoundingBox(){return this._levels[this._levels.length-1].boundingBox}get baseBoundingSphere(){return this._levels[this._levels.length-1].boundingSphere}get baseMaterial(){return this._levels[this._levels.length-1].components[0].material}get slicePlaneEnabled(){return this._slicePlane}set slicePlaneEnabled(e){this._slicePlane=e}get layerUid(){return this._metadata.layerUid}get instanceData(){return this._instanceData}get memoryUsage(){const e={cpu:0,gpu:0};return this._defaultRenderInstanceData.forEach(t=>{const r=t.memoryUsage;e.cpu+=r.cpu,e.gpu+=r.gpu}),this._highlightRenderInstanceData.forEach(t=>{const r=t.memoryUsage;e.cpu+=r.cpu,e.gpu+=r.gpu}),e}get renderStats(){const e=this._instanceData.size,t=[];return this._levels.forEach((r,n)=>{const s=this._defaultRenderInstanceData[n],a=this._highlightRenderInstanceData[n],o=s.size+a.size,l=r.triangleCount;t.push({renderedInstances:o,renderedTriangles:o*l,trianglesPerInstance:l})}),{totalInstances:e,renderedInstances:t.reduce((r,n)=>r+n.renderedInstances,0),renderedTriangles:t.reduce((r,n)=>r+n.renderedTriangles,0),levels:t}}async initializeRenderContext(e,t){this._context=e;const r=e.renderContext.rctx,n=await Promise.allSettled(this._symbol.levels.map(a=>(this._defaultRenderInstanceData.push(new ez(r,this._instanceBufferLayout)),this._highlightRenderInstanceData.push(new ez(r,this._instanceBufferLayout)),n2e.create(e,a,t)))),s=n.map(a=>a.status==="fulfilled"?a.value:null).filter(a=>a);if(Ec(t)||s.length!==n.length){s.forEach(a=>a.destroy()),Ti(t);for(const a of n)if(a.status==="rejected")throw a.reason}this._levels=s,this._levelSelector=h2e(this)}uninitializeRenderContext(){this._invalidateOctree(),this._levels.forEach(e=>e.destroy()),this._defaultRenderInstanceData.forEach(e=>e.destroy()),this._highlightRenderInstanceData.forEach(e=>e.destroy())}get needsTransparentPass(){return this._levels.some(e=>e.components.some(t=>t.material.requiresSlot(le.TRANSPARENT_MATERIAL,V.Color)))}get needsHighlight(){return this._highlightRenderInstanceData.some(e=>e.size>0)}prepareRender(e){if(Wt.LOD_INSTANCE_RENDERER_DISABLE_UPDATES)return;if(this._enableLevelSelection){const r=e.bindParameters.contentCamera.equals(this._lastCamera);this._lastCamera.copyFrom(e.bindParameters.contentCamera),r||this._requestUpdateCycle()}const t=this._needFullCycle?this._instanceData.size:2e3;this._needFullCycle=!1,this._updateInstances(e.bindParameters.contentCamera,t),this._needsUpdates&&this._context.requestRender()}render(e){!this.baseMaterial.isVisible()||!this.baseMaterial.isVisibleForOutput(e.output)||(e.rctx.bindVAO(),e.output!==V.Highlight&&e.output!==V.ShadowHighlight&&this._renderComponents(e,this._defaultRenderInstanceData),e.output!==V.ShadowExludeHighlight&&this._renderComponents(e,this._highlightRenderInstanceData))}intersect(e,t,r,n){if(!this.baseMaterial.isVisible())return;const s=P();ae(s,n,r);const a=o=>{this._instanceData.getCombinedModelTransform(o,nz),e.transform.set(nz),Me(sz,r,e.transform.inverse),Me(az,n,e.transform.inverse);const l=this._instanceData.getState(o),c=this._instanceData.getLodLevel(o),u=this._levels.length;ct(l&Si.ACTIVE,"invalid instance state"),ct(c>=0&&c<u,"invaid lod level"),this._levels[c].intersect(e,t,sz,az,o,this._metadata,u)};this.baseMaterial.parameters.verticalOffset?this._octree.forEach(a):this._octree.forEachAlongRay(r,s,a)}queryDepthRange(e){return this._queryDepthRangeOctree(e)}notifyShaderTransformationChanged(){this._invalidateOctree()}_requestUpdateCycle(e=!1){this._updateCyclesWithStaticCamera=-1,e&&(this._needFullCycle=!0),this._needsUpdates&&this._context.requestRender()}get _needsUpdates(){return this._instanceData.size>0&&this._updateCyclesWithStaticCamera<1}get _octree(){return C(this._octreeCached)&&(this._octreeCached=this._buildOctree()),this._octreeCached}_invalidateOctree(){this._octreeCached=Oe(this._octreeCached)}_buildOctree(){const e=new t2e(this._instanceData,this.baseBoundingSphere),t=this._instanceData,r=t.view?t.view.state:null;for(let n=0;n<this._instanceData.capacity;++n)r.get(n)&Si.ACTIVE&&e.addInstance(n);return e}_queryDepthRangeOctree(e){const t=e.eye,r=e.viewForward,n=this._octree.findClosest(r,Mc.DepthOrder.FRONT_TO_BACK,e.frustum),s=this._octree.findClosest(r,Mc.DepthOrder.BACK_TO_FRONT,e.frustum);if(n!=null&&s!=null){this._instanceData.view.boundingSphere.getVec(n,lh),ae(lh,lh,t);const a=_e(lh,r)-lh[3];this._instanceData.view.boundingSphere.getVec(s,lh),ae(lh,lh,t);const o=_e(lh,r)+lh[3];return{near:Math.max(e.near,a),far:Math.min(e.far,o)}}return{near:1/0,far:-1/0}}_startUpdateCycle(){this._updateCyclesWithStaticCamera++,this._defaultRenderInstanceData.forEach(e=>{e.startUpdateCylce()}),this._highlightRenderInstanceData.forEach(e=>{e.startUpdateCylce()}),this._needsUpdates&&this._context.requestRender()}_updateInstances(e,t){const r=this._enableLevelSelection,n=this._levelSelector;n.updateCamera(e),this._defaultRenderInstanceData.forEach(u=>u.beginUpdate()),this._highlightRenderInstanceData.forEach(u=>u.beginUpdate());const s=this._instanceData,a=this._instanceData.view,o=s.size,l=s.capacity;let c=this._instanceIndex;t=Math.min(o,t);for(let u=0;u<t;++u){c===0&&this._startUpdateCycle();const d=a.state.get(c);let m=0;if(!(d&Si.ALLOCATED)){c=c+1===l?0:c+1,t++;continue}const f=a.lodLevel.get(c);if(d&Si.DEFAULT_ACTIVE&&this._defaultRenderInstanceData[f].freeTail(),d&Si.HIGHLIGHT_ACTIVE&&this._highlightRenderInstanceData[f].freeTail(),d&Si.REMOVE)s.freeInstance(c);else if(d&Si.VISIBLE){let _=0;r&&(a.modelOrigin.getVec(c,rz),_=n.selectLevel(rz,s.getCombinedMedianScaleFactor(c))),m=d&~(Si.ACTIVE|Si.TRANSFORM_CHANGED),_>=0&&(d&Si.HIGHLIGHT?(iz(this._highlightRenderInstanceData[_],a,c),m|=Si.HIGHLIGHT_ACTIVE):(iz(this._defaultRenderInstanceData[_],a,c),m|=Si.DEFAULT_ACTIVE)),a.state.set(c,m),a.lodLevel.set(c,_)}else m=d&~(Si.ACTIVE|Si.TRANSFORM_CHANGED),a.state.set(c,m);if(y(this._octreeCached)){const _=!!(d&Si.ACTIVE),g=!!(m&Si.ACTIVE);!_&&g?this._octreeCached.addInstance(c):_&&!g?this._octreeCached.removeInstance(c):_&&g&&d&Si.TRANSFORM_CHANGED&&(this._octreeCached.removeInstance(c),this._octreeCached.addInstance(c))}c=c+1===l?0:c+1}this._instanceIndex=c,this._defaultRenderInstanceData.forEach(u=>u.endUpdate()),this._highlightRenderInstanceData.forEach(u=>u.endUpdate())}_renderComponents(e,t){this.levels.forEach((r,n)=>{r.components.forEach(s=>{this._renderComponent(e,t[n],s,n)})})}_renderComponent(e,t,r,n){const{bindParameters:s,rctx:a,output:o}=e;if(t.size===0||!r.material.requiresSlot(s.slot,e.output))return;const l=r.glMaterials.load(a,s.slot,o);if(C(l))return;const c=l.beginSlot(s),u=a.bindTechnique(c,r.material.parameters,s);a.bindVAO(r.vao),c.ensureAttributeLocations(r.vao),u.bindDraw(p2e,s,r.material.parameters),Wt.LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL&&e.output===V.Color&&(u.setUniform4fv("externalColor",oz[Math.min(n,oz.length-1)]),u.setUniform1i("colorMixMode",Bne.replace));const d=a.capabilities.instancing,m=t.capacity,f=t.headIndex,_=t.tailIndex,g=t.firstIndex,w=this._glInstanceBufferLayout,v=(b,x)=>{aH(a,oi,t.buffer,w,b),d.drawArraysInstanced(c.primitiveType,0,r.vertexCount,x-b),oH(a,oi,t.buffer,w)};r.material.parameters.transparent&&g!=null?f>_?(ct(g>=_&&g<=f,"invalid firstIndex"),v(g,f),v(_,g)):f<_&&(g<=f?(ct(g>=0&&g<=f,"invalid firstIndex"),v(g,f),v(_,m),v(0,g)):(ct(g>=_&&g<=m,"invalid firstIndex"),v(g,m),v(0,f),v(_,g))):f>_?v(_,f):f<_&&(v(0,f),v(_,m)),a.bindVAO(null)}};function iz(i,e,t){const r=i.allocateHead();d2e(e,t,i.view,r)}function d2e(i,e,t,r){Gne(i.modelOrigin,e,t.modelOriginHi,t.modelOriginLo,r),t.model.copyFrom(r,i.model,e),t.modelNormal.copyFrom(r,i.modelNormal,e),i.color&&t.color&&t.color.copyFrom(r,i.color,e),i.objectAndLayerIdColor&&t.objectAndLayerIdColor&&t.objectAndLayerIdColor.copyFrom(r,i.objectAndLayerIdColor,e),i.featureAttribute&&t.featureAttribute&&t.featureAttribute.copyFrom(r,i.featureAttribute,e)}const rz=P(),lh=yi(),nz=xe(),sz=P(),az=P(),oz=[Bi(1,0,1,1),Bi(0,0,1,1),Bi(0,1,0,1),Bi(1,1,0,1),Bi(1,0,0,1)],p2e=new pse;let m2e=class extends du{constructor(e,t,r,n){super(e,t,r,n),this._resources=null,this._optionalFields=new Array,this._instanceIndexToGraphicUid=new Map,this._hasLoadedPBRTextures=!1,this._disposeResourceHandles=new Array,this.ensureDrapedStatus(!1),this._hasLoadedPBRTextures=r.physicalBasedRenderingEnabled}getCachedSize(){const[e,t,r]=y(this._resources)?this._resources.symbolSize:[1,1,1];return{width:e,depth:t,height:r}}async doLoad(e){if(!this._drivenProperties.size&&VP(this.symbolLayer))throw new Error;const t=this.symbolLayer;if(this._isPrimitive){const r=t.resource?t.resource.primitive:rG;this._resources=await this._createResourcesForPrimitive(r,e)}else this._resources=await this._createResourcesForUrl(t.resource.href,e);this.layerOpacityChanged(),this.slicePlaneEnabledChanged(),this.physicalBasedRenderingChanged(),this.complexity=this.computeComplexity()}get extentPadding(){return y(this._resources)?this._resources.extentPadding:0}get _isPrimitive(){return!(this.symbolLayer.resource&&this.symbolLayer.resource.href)}get lodRenderer(){return en(this._resources,"lodRenderer")}_setMaterialTransparencyParams(e,t=en(this.symbolLayer,"material","color")){const r=this._getCombinedOpacity(t),n=r<1||this.needsDrivenTransparentPass;return e.transparent=n,e.opacity=r,e.cullFace=n?tn.None:tn.Back,e}async _createResourcesForPrimitive(e,t){if(!hCe(e))throw new Error(`Unknown object symbol primitive: ${e}`);const r=this.symbolLayer,n=Ms(Bae(e)),s=Tl(_T(n)),a=Tl(_A(s,r)),o=we(a),l=!1,c=!1,u={usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0,ambient:em,diffuse:em,hasSlicePlane:this._context.slicePlaneEnabled,hasSliceHighlight:!1,castShadows:this.symbolLayer.castShadows,offsetTransparentBackfaces:!this.symbolLayer.isPrimitive},d=u.usePBR;this._setMaterialTransparencyParams(u);const m=this.symbol;if(m.type==="point-3d"&&m.verticalOffset){const{screenLength:v,minWorldLength:b,maxWorldLength:x}=m.verticalOffset;u.verticalOffset={screenLength:Sa(v),minWorldLength:b||0,maxWorldLength:y(x)?x:1/0},u.castShadows=!1}if(this._context.screenSizePerspectiveEnabled&&(u.screenSizePerspective=this._context.sharedResources.screenSizePerspectiveSettings),this._drivenProperties.color)u.externalColor=Pc;else{const v=y(r.material)&&r.material.color,b=y(v)?ti.toUnitRGBA(v):Pc;u.externalColor=b}this._fastUpdates=wx(this._context.renderer,this._fastVisualVariableConvertOptions(n,a,s,w_)),u.instanced=["transformation"],this._fastUpdates.enabled?(Object.assign(u,this._fastUpdates.materialParameters),u.instanced.push("featureAttribute"),this._optionalFields.push("featureAttribute")):this._hasPerInstanceColor()&&(u.instanced.push("color"),this._optionalFields.push("color")),Ot("enable-feature:objectAndLayerId-rendering")&&(u.instanced.push("objectAndLayerIdColor"),this._optionalFields.push("objectAndLayerIdColor"));const f=new Ow(u),_=ZY(e,f);if(!_)throw new Error(`Unknown object symbol primitive: ${e}`);const g=EC(_).map(v=>({opacity:1,transparent:v.parameters.transparent})),w=await this._createStageResources(_,d);return{lodResources:_,lodRenderer:await this._createLodRenderer(_,t),stageResources:w,symbolSize:a,extentPadding:o,isEsriSymbolResource:l,isWosr:c,originalMaterialParameters:g,physicalBasedRenderingEnabled:d,resourceBoundingBox:n,resourceSize:s,pivotOffset:w_}}async _createResourcesForUrl(e,t){const r=["transformation"],n={materialParamsMixin:{instanced:r,hasSlicePlane:this._context.slicePlaneEnabled,castShadows:this.symbolLayer.castShadows},streamDataRequester:this._context.streamDataRequester,cache:this._context.sharedResources.objectResourceCache};this._fastUpdates=wx(this._context.renderer,this._fastVisualVariableConvertOptions(w_,w_,w_,w_)),this._fastUpdates.enabled?(Object.assign(n.materialParamsMixin,this._fastUpdates.materialParameters),r.push("featureAttribute"),this._optionalFields.push("featureAttribute")):this._hasPerInstanceColor()&&(r.push("color"),this._optionalFields.push("color")),Ot("enable-feature:objectAndLayerId-rendering")&&(r.push("objectAndLayerIdColor"),this._optionalFields.push("objectAndLayerIdColor"));const s=this.symbol;if(s.type==="point-3d"&&s.verticalOffset){const{screenLength:D,minWorldLength:I,maxWorldLength:G}=s.verticalOffset;n.materialParamsMixin.verticalOffset={screenLength:Sa(D),minWorldLength:I||0,maxWorldLength:y(G)?G:1/0},n.materialParamsMixin.castShadows=!1}n.signal=t,n.usePBR=this._context.physicalBasedRenderingEnabled,n.skipHighLods=this._context.skipHighSymbolLods;const a=n.usePBR,o=await fse(e,n),l=o.isEsriSymbolResource,c=o.isWosr,u=jEe(o.lods);WEe(u),u.levels.sort((D,I)=>D.minScreenSpaceRadius-I.minScreenSpaceRadius),u.levels[0].minScreenSpaceRadius=Math.min(2,u.levels[0].minScreenSpaceRadius);const d=this._context,m=this.symbolLayer.material,f=this._getExternalColorParameters(m),_=en(this.symbolLayer,"material","color"),g=this._getCombinedOpacity(_,{hasIntrinsicColor:!0}),w=this.needsDrivenTransparentPass,v=EC(u),b=EC(u).map(D=>({opacity:D.parameters.opacity||1,transparent:D.parameters.transparent}));v.forEach(D=>{const I=D.parameters;D.setParameters(f);const G=I.opacity*g,W=G<1||w||I.transparent;D.setParameters({opacity:G,transparent:W}),d.screenSizePerspectiveEnabled&&D.setParameters({screenSizePerspective:d.sharedResources.screenSizePerspectiveSettings})});const x=o.referenceBoundingBox,T=Tl(_T(x)),R=Tl(u.levels[0].pivotOffset),E=Tl(_A(T,this.symbolLayer)),O=we(E);xx(this._fastUpdates,this._context.renderer,this._fastVisualVariableConvertOptions(x,E,T,R))&&v.forEach(D=>D.setParameters(this._fastUpdates.materialParameters));const $=await this._createStageResources(u,a);return{lodResources:u,lodRenderer:await this._createLodRenderer(u,t),stageResources:$,symbolSize:E,extentPadding:O,isEsriSymbolResource:l,isWosr:c,originalMaterialParameters:b,physicalBasedRenderingEnabled:a,resourceBoundingBox:x,resourceSize:T,pivotOffset:R}}_addDisposeResource(e){this._disposeResourceHandles.push(e)}async _createStageResources(e,t){const r=this._context.stage,n=EC(e);t!==this._context.physicalBasedRenderingEnabled&&this.physicalBasedRenderingChanged(),r.addMany(n),this._addDisposeResource(()=>r.removeMany(n));const s=KU(e);r.addMany(s),this._addDisposeResource(()=>r.removeMany(s)),await r.load(s);const a=JU(e);return r.addMany(a),this._addDisposeResource(()=>r.removeMany(a)),{materials:n,textures:s,geometries:a}}async _createLodRenderer(e,t){const r=this._context.stage,n={layerUid:this._context.layer.uid,graphicUid:o=>this._instanceIndexToGraphicUid.get(o),notifyGraphicGeometryChanged:o=>this._context.notifyGraphicGeometryChanged(this._instanceIndexToGraphicUid.get(o)),notifyGraphicVisibilityChanged:o=>this._context.notifyGraphicVisibilityChanged(this._instanceIndexToGraphicUid.get(o))},s=this._fastUpdates.enabled?{applyTransform:(o,l,c)=>{o.getFeatureAttribute(l,kC),pn(c,p$(this._fastUpdates.materialParameters,kC,c))},scaleFactor:(o,l,c)=>(l.getFeatureAttribute(c,kC),KSe(o,this._fastUpdates.materialParameters,kC))}:null,a=new u2e(e,this._optionalFields,n,s);return a.slicePlaneEnabled=this._context.slicePlaneEnabled,this._addDisposeResource(()=>{r.removeRenderPlugin(a)}),await r.addRenderPlugin(a.slots,a,t),a}_getExternalColorParameters(e){const t={};return this._drivenProperties.color?t.externalColor=Pc:y(e)&&y(e.color)?t.externalColor=ti.toUnitRGBA(e.color):(t.externalColor=Pc,t.colorMixMode="ignore"),t}destroy(){super.destroy(),this._cleanupResources()}_cleanupResources(){this._disposeResourceHandles.forEach(e=>e()),this._disposeResourceHandles.length=0,this._resources=null}createGraphics3DGraphic(e){const t=e.graphic;if(!this._validateGeometry(t.geometry))return null;const r=vx(t.geometry);if(C(r))return this.logger.warn(`unsupported geometry type for icon symbol: ${t.geometry.type}`),null;const n=this.setGraphicElevationContext(t,new Qc),s=e.renderingInfo;return this._createAs3DShape(t,r,s,n,t.uid,e.layer.uid)}notifyDestroyGraphicLayer(e){this._instanceIndexToGraphicUid.delete(e.instanceIndex)}graphicLayerToGraphicId(){return 0}layerOpacityChanged(){if(C(this._resources))return;const e=this._drivenProperties.opacity,t=!this._isPrimitive,r=this._resources.stageResources.materials,n=this._resources.originalMaterialParameters;for(let s=0;s<r.length;s++){const a=r[s],o=en(this.symbolLayer,"material","color"),l=n[s],c=this._getCombinedOpacity(o,{hasIntrinsicColor:t})*l.opacity,u=c<1||e||l.transparent;a.setParameters({opacity:c,transparent:u}),this._isPrimitive&&a.setParameters({cullFace:u?tn.None:tn.Back})}}layerElevationInfoChanged(e,t){return this.updateGraphics3DGraphicElevationInfo(e,t,Bm)}slicePlaneEnabledChanged(){if(C(this._resources))return!0;this._resources.lodRenderer.slicePlaneEnabled=this._context.slicePlaneEnabled;for(const e of this._resources.stageResources.materials)e.setParameters({hasSlicePlane:this._context.slicePlaneEnabled});return!0}physicalBasedRenderingChanged(){if(C(this._resources))return!0;const{stageResources:e,isWosr:t}=this._resources;for(const r of e.materials)this._isPrimitive?r.setParameters({usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0}):t||r.setParameters({usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!1});return this._hasLoadedPBRTextures!==!1||this._context.physicalBasedRenderingEnabled!==!0||(this._hasLoadedPBRTextures=!0,!1)}pixelRatioChanged(){return!0}applyRendererDiff(e,t){if(C(this._resources))return Gr.Recreate_Symbol;const{stageResources:{materials:r},lodRenderer:n,resourceBoundingBox:s,symbolSize:a,resourceSize:o,pivotOffset:l}=this._resources;for(const c in e.diff){if(c!=="visualVariables"||!xx(this._fastUpdates,t,this._fastVisualVariableConvertOptions(s,a,o,l)))return Gr.Recreate_Symbol;for(const u of r)u.setParameters(this._fastUpdates.materialParameters);n.notifyShaderTransformationChanged()}return Gr.Fast_Update}computeComplexity(){if(C(this._resources))return super.computeComplexity();const e=this._resources.lodResources,t=E4(e.levels[0]).reduce((s,a)=>s+a.indices.get(S.POSITION).length,0)/3,r=s=>Array.from(s.vertexAttributes.values()).reduce((a,o)=>{var l;return a+(((l=o.data.buffer)==null?void 0:l.byteLength)??0)},0)+Array.from(s.indices.values()).reduce((a,o)=>a+(Array.isArray(o)?12*o.length:o.buffer.byteLength),0),n=KU(e).reduce((s,a)=>s+a.estimatedTexMemRequired,0)/4+JU(e).reduce((s,a)=>s+r(a),0);return{primitivesPerFeature:t,primitivesPerCoordinate:0,drawCallsPerFeature:0,estimated:!1,memory:{...KY(this.symbol,this.symbolLayer),resourceBytes:n}}}_hasLodRenderer(){return y(this._resources)}_createAs3DShape(e,t,r,n,s,a){if(!this._hasLodRenderer()||C(this._resources))return null;const o=this.getFastUpdateAttrValues(e),l=!this._fastUpdates.enabled&&this._hasPerInstanceColor()?rw(r.color,r.opacity):null,c=this._context.clippingExtent;if(bn(t,K_,this._context.elevationProvider.spatialReference),y(c)&&!iF(c,K_))return null;const u=this._requiresTerrainElevation(n),d=this._computeGlobalTransform(t,n,OM,VC),m=this._computeLocalTransform(this._resources,this.symbolLayer,r,lz),f=this._resources.lodRenderer.instanceData,_=f.addInstance();this._instanceIndexToGraphicUid.set(_,s),f.setLocalTransform(_,m,!1),f.setGlobalTransform(_,d),o&&f.setFeatureAttribute(_,o),l&&f.setColor(_,l),Ot("enable-feature:objectAndLayerId-rendering")&&f.setObjectAndLayerIdColor(_,this._context.stage.renderView._objectAndLayerIdRenderHelper.getObjectAndLayerIdColor({graphicUid:s,layerUid:a}));const g=new BEe(this,_,iCe,n);return u&&(g.alignedSampledElevation=VC.sampledElevation),g.needsElevationUpdates=Bm(n.mode),yx(g,t,this._context.elevationProvider),g}_computeGlobalTransform(e,t,r,n){return $d(e,this._context.elevationProvider,t,this._context.renderCoordsHelper,n),K_[0]=e.x,K_[1]=e.y,K_[2]=n.z,xd(e.spatialReference,K_,r,this._context.renderCoordsHelper.spatialReference),r}_computeLocalTransform(e,t,r,n){return Mg(n),this._applyObjectRotation(r,!1,n),this._applyObjectRotation(t,!0,n),this._applyObjectScale(e,r,n),this._applyAnchor(e,t,n),n}_applyObjectScale(e,t,r){if(this._fastUpdates.enabled&&this._fastUpdates.requiresShaderTransformation)return;const n=this._drivenProperties.size&&t.size?t.size:e.symbolSize,s=ZU(n,e.symbolSize,e.resourceSize,this._context.renderCoordsHelper.unitInMeters);s[0]===1&&s[1]===1&&s[2]===1||LG(r,r,s)}prepareSymbolLayerPatch(e){if(e.diff.type!=="partial")return;const t=e.diff.diff;this._preparePatchTransform(e,t),this._preparePatchColor(e,t)}updateGeometry(e,t){if(C(this._resources))return!0;const r=t&&vx(t);if(C(r))return!1;const n=this.getGeometryElevationMode(t);return e.elevationContext.mode===n&&(this._computeGlobalTransform(r,e.elevationContext,OM,VC),this._requiresTerrainElevation(e.elevationContext)&&(e.alignedSampledElevation=VC.sampledElevation),this._resources.lodRenderer.instanceData.setGlobalTransform(e.instanceIndex,OM,!0),yx(e,r,this._context.elevationProvider),!0)}_preparePatchTransform(e,t){if(!(t.heading||t.tilt||t.roll||t.width||t.height||t.depth||t.anchor||t.anchorPosition)||C(this._resources))return;const r=(_,g,w)=>Ke(_!=null&&_.type==="complete"?_.newValue:g,w),n=r(t.heading,this.symbolLayer.heading,0),s=r(t.tilt,this.symbolLayer.tilt,0),a=r(t.roll,this.symbolLayer.roll,0),o=r(t.width,this.symbolLayer.width,void 0),l=r(t.height,this.symbolLayer.height,void 0),c=r(t.depth,this.symbolLayer.depth,void 0),u=r(t.anchor,this.symbolLayer.anchor,void 0),d=r(t.anchorPosition,this.symbolLayer.anchorPosition,void 0);delete t.heading,delete t.tilt,delete t.roll,delete t.width,delete t.height,delete t.depth,delete t.anchor,delete t.anchorPosition;const m={heading:n,tilt:s,roll:a,anchor:u,anchorPosition:d},f=this._resources;this.loadStatus===jo.LOADED&&e.symbolLayerStatePatches.push(()=>{f.symbolSize=Tl(_A(f.resourceSize,{width:o,height:l,depth:c,isPrimitive:this.symbolLayer.isPrimitive}))}),e.graphics3DGraphicPatches.push((_,g)=>{const w=this._computeLocalTransform(f,m,g,lz),v=_.instanceIndex;f.lodRenderer.instanceData.setLocalTransform(v,w,!0)})}_preparePatchColor(e,t){if(!t.material||t.material.type!=="partial")return;const r=t.material.diff;if(!r.color||r.color.type!=="complete"||r.color.newValue==null||r.color.oldValue==null)return;const n=r.color.newValue,s=y(n)?ti.toUnitRGBA(n):Pc;delete r.color;const a=this._resources;C(a)||e.graphics3DGraphicPatches.push(o=>{let l;this._hasPerInstanceColor()?(a.lodRenderer.instanceData.setColor(o.instanceIndex,s),l=this._setMaterialTransparencyParams({},n)):l=this._setMaterialTransparencyParams({externalColor:s},n);for(const c of a.stageResources.materials)c.setParameters(l)})}_requiresTerrainElevation(e){return e.mode!=="absolute-height"}_applyObjectRotation(e,t,r){if(!(this._fastUpdates.enabled&&this._fastUpdates.requiresShaderTransformation&&t))return jTe(e.heading,e.tilt,e.roll,r)}_computeAnchor(e,t,r){const n=P();switch(r.anchor){case"center":X(n,Ic(e)),Aa(n,n);break;case"top":{const s=Ic(e);Y(n,-s[0],-s[1],-e[5]);break}case"bottom":{const s=Ic(e);Y(n,-s[0],-s[1],-e[2]);break}case"relative":{const s=Ic(e),a=_T(e),o=r.anchorPosition,l=o?Ze(o.x,o.y,o.z):Gl;Sre(n,a,l),ce(n,n,s),Aa(n,n);break}default:y(t)?Aa(n,t):X(n,Gl)}return n}_applyAnchor(e,t,r){if(this._fastUpdates.enabled&&this._fastUpdates.requiresShaderTransformation)return;const n=this._computeAnchor(e.resourceBoundingBox,e.pivotOffset,t);n&&ru(r,r,n)}_hasPerInstanceColor(){return this._drivenProperties.color||this._drivenProperties.opacity}_fastVisualVariableConvertOptions(e,t,r,n){const s=y(e)?Tl(_T(e)):em,a=y(e)?this._computeAnchor(e,n,this.symbolLayer):Gl,o=this._context.renderCoordsHelper.unitInMeters,l=ZU(y(t)?t:void 0,t,r,o),c=Ze(this.symbolLayer.tilt||0,this.symbolLayer.roll||0,this.symbolLayer.heading||0);return{modelSize:s,symbolSize:y(t)?t:em,unitInMeters:o,transformation:{anchor:a,scale:l,rotation:c}}}};const K_=P(),lz=xe(),OM=xe(),kC=yi(),VC=new aT;function f2e(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i}function g2e(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=1,i}function k4(i,e,t,r,n){return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i}function _2e(i,e){if(i===e){const t=e[1];i[1]=e[2],i[2]=t}else i[0]=e[0],i[1]=e[2],i[2]=e[1],i[3]=e[3];return i}function y2e(i,e){const t=e[0],r=e[1],n=e[2],s=e[3];let a=t*s-n*r;return a?(a=1/a,i[0]=s*a,i[1]=-r*a,i[2]=-n*a,i[3]=t*a,i):null}function v2e(i,e){const t=e[0];return i[0]=e[3],i[1]=-e[1],i[2]=-e[2],i[3]=t,i}function b2e(i){return i[0]*i[3]-i[2]*i[1]}function GK(i,e,t){const r=e[0],n=e[1],s=e[2],a=e[3],o=t[0],l=t[1],c=t[2],u=t[3];return i[0]=r*o+s*l,i[1]=n*o+a*l,i[2]=r*c+s*u,i[3]=n*c+a*u,i}function w2e(i,e,t){const r=e[0],n=e[1],s=e[2],a=e[3],o=Math.sin(t),l=Math.cos(t);return i[0]=r*l+s*o,i[1]=n*l+a*o,i[2]=r*-o+s*l,i[3]=n*-o+a*l,i}function x2e(i,e,t){const r=e[0],n=e[1],s=e[2],a=e[3],o=t[0],l=t[1];return i[0]=r*o,i[1]=n*o,i[2]=s*l,i[3]=a*l,i}function T2e(i,e){const t=Math.sin(e),r=Math.cos(e);return i[0]=r,i[1]=t,i[2]=-t,i[3]=r,i}function C2e(i,e){return i[0]=e[0],i[1]=0,i[2]=0,i[3]=e[1],i}function S2e(i){return"mat2("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+")"}function E2e(i){return Math.sqrt(i[0]**2+i[1]**2+i[2]**2+i[3]**2)}function R2e(i,e,t,r){return i[2]=r[2]/r[0],t[0]=r[0],t[1]=r[1],t[3]=r[3]-i[2]*t[1],[i,e,t]}function P2e(i,e,t){return i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2],i[3]=e[3]+t[3],i}function HK(i,e,t){return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],i[3]=e[3]-t[3],i}function A2e(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]&&i[3]===e[3]}function O2e(i,e){const t=i[0],r=i[1],n=i[2],s=i[3],a=e[0],o=e[1],l=e[2],c=e[3],u=wD();return Math.abs(t-a)<=u*Math.max(1,Math.abs(t),Math.abs(a))&&Math.abs(r-o)<=u*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-l)<=u*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(s-c)<=u*Math.max(1,Math.abs(s),Math.abs(c))}function M2e(i,e,t){return i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i[3]=e[3]*t,i}function I2e(i,e,t,r){return i[0]=e[0]+t[0]*r,i[1]=e[1]+t[1]*r,i[2]=e[2]+t[2]*r,i[3]=e[3]+t[3]*r,i}const L2e=GK,$2e=HK;Object.freeze(Object.defineProperty({__proto__:null,copy:f2e,identity:g2e,set:k4,transpose:_2e,invert:y2e,adjoint:v2e,determinant:b2e,multiply:GK,rotate:w2e,scale:x2e,fromRotation:T2e,fromScaling:C2e,str:S2e,frob:E2e,LDU:R2e,add:P2e,subtract:HK,exactEquals:A2e,equals:O2e,multiplyScalar:M2e,multiplyScalarAndAdd:I2e,mul:L2e,sub:$2e},Symbol.toStringTag,{value:"Module"}));let D2e=class extends jr{constructor(e,t,r,n,s,a,o){super(e,t,Fc.Triangle,o),this.path=r,this.geometrySR=n,this.upVectorAlignment=s,this.stencilWidth=a}};function jK(i){return"upVectorAlignment"in i}function qK(){return[1,0,0,1]}function F2e(i){return[i[0],i[1],i[2],i[3]]}function N2e(i,e,t,r){return[i,e,t,r]}function k2e(i,e){return new Float64Array(i,e,4)}Object.freeze(Object.defineProperty({__proto__:null,create:qK,clone:F2e,fromValues:N2e,createView:k2e},Symbol.toStringTag,{value:"Module"}));function _$(){return{up:P(),right:P()}}function V2e(i,e,t){Me(i.up,e.up,t),Me(i.right,e.right,t)}function U2e(i,e,t){rt(i,_e(t,e.right),_e(t,e.up))}let z2e=class{constructor(){this.pos=P(),this.posES=P(),this.posGS=P(),this.vRight=P(),this.vLeft=P(),this.frame=_$(),this.rotationFrame=_$(),this.rotationRight=Te(),this.rotationAngle=0,this.miterStretch=qK()}setFrameFromUpVector(e){X(this.frame.up,e),ce(_l,this.vLeft,this.vRight),de(_l,_l),Q(oc,this.frame.up,_e(_l,this.frame.up)),ae(zC,_l,oc),de(zC,zC),ut(this.frame.right,zC,this.frame.up)}computeRotationAxisAndAngleFromUpVector(){X(this.rotationFrame.up,this.frame.up),X(this.rotationFrame.right,this.frame.right),rt(this.rotationRight,1,0),Q(oc,this.frame.up,_e(this.frame.up,this.vLeft)),ae(oc,this.vLeft,oc),Aa(oc,oc),de(oc,oc),Q(_l,this.frame.up,_e(this.frame.up,this.vRight)),ae(_l,this.vRight,_l),de(_l,_l),ut(v$,this.rotationFrame.up,this.vLeft);const e=Math.sign(_e(v$,this.vRight));if(this.rotationAngle=e*(Math.PI-ls(_e(oc,_l))),Math.abs(this.rotationAngle)>0){const r=pI(Math.cos(.5*this.rotationAngle));k4(this.miterStretch,r-1+1,0,0,1)}const t=Math.PI-this.rotationAngle;this.maxStretchDistance=Math.abs(Math.min(this.vLeftLength,this.vRightLength)/Math.cos(.5*t))}},cz=class y${constructor(){this.vertices=[],this.vertexIndices=[],this.vertexNormals=[],this.poles=[],this.poleIndices=[],this.uvs=null,this.uvIndices=null}addVertex(e,t){return this.vertices.push(fT(e)),this.vertexNormals.push(fT(t)),this.vertices.length-1}addUV(e){return this.uvs||(this.uvs=[],this.uvIndices=[]),this.uvs.push(e),this.uvs.length-1}addPole(e,t=null){return this.poles.push({position:fT(e),normal:t?fT(t):null}),this.poles.length-1}addSegment(e,t=null,r=null){this.vertexIndices.push(e.v0),this.vertexIndices.push(e.v1),t&&(this.uvIndices.push(t.v0),this.uvIndices.push(t.v1)),r&&(this.poleIndices.push(r.v0),this.poleIndices.push(r.v1))}get numSegments(){return this.vertexIndices.length/2}hasUV(){return this.uvs!=null}translate(e,t){for(const r of this.vertices)r[0]+=e,r[1]+=t;for(const r of this.poles)r.position[0]+=e,r.position[1]+=t}static circle(e=20){const r=new y$,n={v0:0,v1:0};r.addPole(Qt(0,0));for(let o=0;o<e;++o){const l=2*o*Math.PI/e,c=Math.cos(l),u=Math.sin(l),d=Qt(c*.5,u*.5),m=Qt(c,u);r.addVertex(d,m),r.addUV(o/e)}r.addUV(1);for(let o=0;o<e-1;++o){const l={v0:o,v1:o+1},c=l;r.addSegment(l,c,n)}const s={v0:e-1,v1:0},a={v0:e-1,v1:e};return r.addSegment(s,a,n),r}static rect(){const r=new y$,n=Qt(.5*-1,.5*-1),s=Qt(.5*1,.5*-1),a=Qt(.5*1,.5*1),o=Qt(.5*-1,.5*1),l=Qt(0,-1),c=Qt(1,0),u=Qt(0,1),d=Qt(-1,0);r.addUV(0),r.addUV(1),r.addPole(Qt(0,.5*1),u),r.addPole(Qt(0,.5*1)),r.addPole(Qt(0,.5*-1)),r.addPole(Qt(0,.5*-1),l);const m={v0:0,v1:1};return r.addVertex(n,l),r.addVertex(s,l),r.addSegment({v0:0,v1:1},m,{v0:3,v1:3}),r.addVertex(s,c),r.addVertex(a,c),r.addSegment({v0:2,v1:3},m,{v0:2,v1:1}),r.addVertex(a,u),r.addVertex(o,u),r.addSegment({v0:4,v1:5},m,{v0:0,v1:0}),r.addVertex(o,d),r.addVertex(n,d),r.addSegment({v0:6,v1:7},m,{v0:1,v1:2}),r}},B2e=class{constructor(e){this.vertices=[],this.offset=P(),this.xform=xe(),this.vertices=e;const t=Math.floor((e.length-1)/2);X(this.offset,this.vertices[t].pos);for(const r of this.vertices)ae(r.pos,r.pos,this.offset);ru(this.xform,this.xform,this.offset),this.updatePathVertexInformation()}updatePathVertexInformation(){const e=this.vertices.length;let t=this.vertices[0];t.index=0,Y(t.vLeft,0,0,0),t.vLeftLength=0,ae(t.vRight,this.vertices[1].pos,t.pos),t.vRightLength=we(t.vRight),de(t.vRight,t.vRight);let r=t;for(let n=1;n<e;++n)t=this.vertices[n],t.index=n,X(t.vLeft,r.vRight),t.vLeftLength=r.vRightLength,n<e-1?(ae(t.vRight,this.vertices[n+1].pos,t.pos),t.vRightLength=we(t.vRight),de(t.vRight,t.vRight)):(X(t.vRight,t.vLeft),t.vRightLength=t.vLeftLength),r=t}};function G2e(i,e){let t=null;const r=i.vertices.length,n=.99619469809,s=P(),a=P(),o=P(),l=P(),c=P(),u=P(),d=fr();let m=i.vertices[0];X(a,e),Y(s,0,1,0),q2(m.vRight,a,s,s,o,a,n),X(m.frame.up,a),X(m.frame.right,o),t=m;for(let f=1;f<r;++f){m=i.vertices[f],ce(c,m.vLeft,m.vRight);let _=we(c);_>0?(_=1/Math.sqrt(_),c[0]=c[0]*_,c[1]=c[1]*_,c[2]=c[2]*_):(c[0]=m.vRight[0],c[1]=m.vRight[1],c[2]=m.vRight[2]),ce(u,t.pos,t.frame.up),Ew(m.pos,c,d),e_(d,zc(u,m.vLeft),l)?(ae(l,l,m.pos),de(a,l),ut(o,c,a),de(o,o)):q2(c,t.frame.up,t.frame.right,s,o,a,n),X(m.frame.up,a),X(m.frame.right,o),t=m}}let H2e=class{numProfilesPerJoin(){return 1}extrude(e,t,r){for(let n=0;n<t.vertices.length;++n)r(e.index,e.frame,t.vertices[n],t.vertexNormals[n],!1)}},MM=class{constructor(e=.8*Math.PI,t=1){this.cutoffAngle=e,this.numBendSubdivisions=t}numProfilesPerJoin(){return this.numBendSubdivisions+1}extrude(e,t,r){const n=Y2e;if(Math.abs(e.rotationAngle)>=this.cutoffAngle)for(let s=0;s<this.numBendSubdivisions+1;++s){Bc(dz,.5*-e.rotationAngle+s*e.rotationAngle/this.numBendSubdivisions,e.rotationFrame.up),V2e(n,e.frame,dz);for(let a=0;a<t.vertices.length;++a)Fr(t.vertices[a],e.rotationRight)*e.rotationAngle>=0?r(e.index,n,t.vertices[a],t.vertexNormals[a],!1):($5(mg,t.vertices[a],e.miterStretch),r(e.index,e.frame,mg,t.vertexNormals[a],!0))}else for(let s=0;s<this.numBendSubdivisions+1;++s)for(let a=0;a<t.vertices.length;++a){const o=Fr(t.vertices[a],e.rotationRight)*e.rotationAngle>=0;$5(mg,t.vertices[a],e.miterStretch),r(e.index,e.frame,mg,t.vertexNormals[a],!o)}}};const j2e={generateUV:!1};let V4=class{rebuildConnectingProfileGeometry(e,t,r){for(let n=0;n<t.vertices.length;++n)r(e.index,e.frame,t.vertices[n],t.vertexNormals[n],0,0)}},hz=class extends V4{constructor(){super()}getNumVertices(){return 0}getNumIndices(){return 0}rebuildCapGeometry(){}buildTopology(){}},UC=class extends V4{constructor(e,t=0,r=!1){super(),this.profile=e,this.profilePlaneOffset=t,this.flip=r}getNumVertices(){return this.profile.vertices.length}getNumIndices(){return 3*this.profile.numSegments}rebuildConnectingProfileGeometry(e,t,r){for(let n=0;n<t.vertices.length;++n)r(e.index,e.frame,t.vertices[n],t.vertexNormals[n],this.profilePlaneOffset,0)}rebuildCapGeometry(e,t){const r=U4;rt(r,0,0);const n=this.flip?1:-1;for(let s=0;s<this.profile.vertices.length;++s)t(e.index,e.frame,this.profile.vertices[s],r,this.profilePlaneOffset,n)}buildTopology(e,t){const r=this.vertexBufferStart+this.profile.vertexIndices[0];for(let n=1;n<this.profile.numSegments;++n){const s=this.profile.vertexIndices[2*n+0],a=this.profile.vertexIndices[2*n+1],o=this.vertexBufferStart+s,l=this.vertexBufferStart+a;this.flip?t(l,o,r):t(r,o,l)}}},uz=class extends V4{constructor(e){super(),this.flip=!1,this.sign=0,this.breakNormals=!1,this.numSegments=3,this.profile=e.profile,this.flip=e.flip,this.sign=this.flip?1:-1,this.breakNormals=e.breakNormals,this.numSegments=e.subdivisions}getNumVertices(){let e=0;return e=this.profile.vertices.length*(this.numSegments-1),this.breakNormals&&(e+=this.profile.vertices.length),e+=this.profile.poles.length,e}getNumIndices(){let e=0;e+=2*this.profile.numSegments*(this.numSegments-1);for(let t=0;t<this.profile.numSegments;++t){const r=this.profile.vertexIndices[2*t+0],n=this.profile.vertexIndices[2*t+1];this.profile.poleIndices[r]===this.profile.poleIndices[n]?e+=1:e+=2}return 3*e}rebuildCapGeometry(e,t){const r=e.frame,n=.5*this.sign,s=mg,a=U4;rt(a,0,0);for(let o=0;o<this.profile.poles.length;++o){const l=this.profile.poles[o];l.normal?t(e.index,r,l.position,l.normal,n,0):t(e.index,r,l.position,a,n,this.sign)}if(this.breakNormals)for(let o=0;o<this.profile.vertices.length;++o)t(e.index,r,this.profile.vertices[o],this.profile.vertexNormals[o],0,0);for(let o=0;o<this.numSegments-1;++o){const l=(1-(o+1)/this.numSegments)*Math.PI*.5,c=Math.sin(l),u=Math.cos(l);for(let d=0;d<this.profile.vertices.length;++d){const m=this.profile.poles[this.profile.poleIndices[d]];Rc(s,this.profile.vertices[d],m.position),qs(s,s,c),m.normal?(yc(s,s,m.position),t(e.index,r,s,m.normal,n*u,0)):(X0(a,s),qs(a,a,c),yc(s,s,m.position),t(e.index,r,s,a,n*u,this.sign*u))}}}buildTopology(e,t){const r=this.breakNormals?this.vertexBufferStart+this.profile.poles.length:this.firstProfileVertexIndex,n=this.breakNormals?this.vertexBufferStart+this.profile.poles.length+this.profile.vertices.length:this.vertexBufferStart+this.profile.poles.length;for(let s=0;s<this.profile.numSegments;++s){const a=this.profile.vertexIndices[2*s+0],o=this.profile.vertexIndices[2*s+1],l=this.vertexBufferStart+this.profile.poleIndices[a],c=this.vertexBufferStart+this.profile.poleIndices[o];let u=r+a,d=r+o;for(let m=0;m<this.numSegments-1;++m){const f=n+m*this.profile.vertices.length+a,_=n+m*this.profile.vertices.length+o;this.flip?(t(f,d,u),t(d,f,_)):(t(u,d,f),t(_,f,d)),u=f,d=_}this.flip?(t(l,d,u),l!==c&&t(l,c,d)):(t(u,d,l),l!==c&&t(d,c,l))}}},q2e=class{constructor(e,t,r,n,s,a=j2e){this.options=a,this._extrusionVertexCount=0,this.numExtrusionProfiles=0,this.numVerticesTotal=0,this.numNormalsTotal=0,this.numUVTotal=0,this.profile=t,this.path=e,this.extruder=r,this.startCap=n,this.endCap=s;const o=this.path.vertices.length-2;this.numExtrusionProfiles=r.numProfilesPerJoin()*o+2,this.numVerticesTotal=t.vertices.length*this.numExtrusionProfiles,this.numNormalsTotal=this.numVerticesTotal,this.startCap.vertexBufferStart=this.numVerticesTotal;const l=this.startCap.getNumVertices();this.numVerticesTotal+=l,this.numNormalsTotal+=l,this.endCap.vertexBufferStart=this.numVerticesTotal;const c=this.endCap.getNumVertices();this.numVerticesTotal+=c,this.numNormalsTotal+=c,this.pathVertexData=new Float32Array(1*this.numVerticesTotal),this.profileRightAxisData=new Float32Array(4*this.numVerticesTotal),this.profileUpAxisData=new Float32Array(4*this.numVerticesTotal),this.profileVertexAndNormalData=new Float32Array(4*this.numVerticesTotal),this.profile.hasUV()&&this.options.generateUV&&(this.numUVTotal=this.profile.uvs.length,this.uvData=new Float32Array(2*this.numUVTotal)),this.originData=new Float32Array(3*this.path.vertices.length),this._rebuildGeometry(),this.buildTopology()}emitVertex(e,t,r,n,s){if(this.profileRightAxisData[4*this._extrusionVertexCount+0]=t.right[0],this.profileRightAxisData[4*this._extrusionVertexCount+1]=t.right[1],this.profileRightAxisData[4*this._extrusionVertexCount+2]=t.right[2],this.profileUpAxisData[4*this._extrusionVertexCount+0]=t.up[0],this.profileUpAxisData[4*this._extrusionVertexCount+1]=t.up[1],this.profileUpAxisData[4*this._extrusionVertexCount+2]=t.up[2],this.profileVertexAndNormalData[4*this._extrusionVertexCount+0]=r[0],this.profileVertexAndNormalData[4*this._extrusionVertexCount+1]=r[1],this.profileVertexAndNormalData[4*this._extrusionVertexCount+2]=n[0],this.profileVertexAndNormalData[4*this._extrusionVertexCount+3]=n[1],this.pathVertexData[this._extrusionVertexCount]=e,s){const a=this.path.vertices[e];this.profileRightAxisData[4*this._extrusionVertexCount+3]=a.rotationRight[0]*a.maxStretchDistance,this.profileUpAxisData[4*this._extrusionVertexCount+3]=a.rotationRight[1]*a.maxStretchDistance}else this.profileRightAxisData[4*this._extrusionVertexCount+3]=0,this.profileUpAxisData[4*this._extrusionVertexCount+3]=0;++this._extrusionVertexCount}emitCapVertex(e,t,r,n,s,a){this.profileRightAxisData[4*this._extrusionVertexCount+0]=t.right[0],this.profileRightAxisData[4*this._extrusionVertexCount+1]=t.right[1],this.profileRightAxisData[4*this._extrusionVertexCount+2]=t.right[2],this.profileUpAxisData[4*this._extrusionVertexCount+0]=t.up[0],this.profileUpAxisData[4*this._extrusionVertexCount+1]=t.up[1],this.profileUpAxisData[4*this._extrusionVertexCount+2]=t.up[2],this.profileVertexAndNormalData[4*this._extrusionVertexCount+0]=r[0],this.profileVertexAndNormalData[4*this._extrusionVertexCount+1]=r[1],this.profileVertexAndNormalData[4*this._extrusionVertexCount+2]=n[0],this.profileVertexAndNormalData[4*this._extrusionVertexCount+3]=n[1],this.pathVertexData[this._extrusionVertexCount]=e,this.profileRightAxisData[4*this._extrusionVertexCount+3]=s,this.profileUpAxisData[4*this._extrusionVertexCount+3]=a,++this._extrusionVertexCount}emitTriangle(e,t,r){this.vertexIndices.push(e),this.vertexIndices.push(t),this.vertexIndices.push(r),this.pathVertexIndices.push(this.pathVertexData[e]),this.pathVertexIndices.push(this.pathVertexData[t]),this.pathVertexIndices.push(this.pathVertexData[r]),this.normalIndices.push(e),this.normalIndices.push(t),this.normalIndices.push(r)}_rebuildGeometry(){const e=(r,n,s,a,o)=>this.emitVertex(r,n,s,a,o),t=(r,n,s,a,o,l)=>this.emitCapVertex(r,n,s,a,o,l);this._extrusionVertexCount=0;for(const r of this.path.vertices)this.originData[3*r.index+0]=r.pos[0],this.originData[3*r.index+1]=r.pos[1],this.originData[3*r.index+2]=r.pos[2];this.startCap.rebuildConnectingProfileGeometry(this.path.vertices[0],this.profile,t);for(let r=1;r<this.path.vertices.length-1;++r)this.extruder.extrude(this.path.vertices[r],this.profile,e);if(this.endCap.rebuildConnectingProfileGeometry(this.path.vertices[this.path.vertices.length-1],this.profile,t),this.startCap.rebuildCapGeometry(this.path.vertices[0],t),this.endCap.rebuildCapGeometry(this.path.vertices[this.path.vertices.length-1],t),this.profile.hasUV()&&this.options.generateUV)for(let r=0;r<this.profile.uvs.length;++r)this.uvData[2*r+0]=this.profile.uvs[r],this.uvData[2*r+1]=0}buildTopology(){const e=this.profile.vertices.length,t=this.profile.numSegments,r=this.numExtrusionProfiles-1;let n=3*(2*(t*r));this.startCap.indexBufferStart=n,this.startCap.firstProfileVertexIndex=0,n+=this.startCap.getNumIndices(),this.endCap.indexBufferStart=n,this.endCap.firstProfileVertexIndex=e*(this.numExtrusionProfiles-1),this.vertexIndices=new Array,this.normalIndices=new Array,this.pathVertexIndices=new Array,this.profile.hasUV()&&this.options.generateUV&&(this.uvIndices=new Array);for(let a=0;a<t;++a){const o=this.profile.vertexIndices[2*a],l=this.profile.vertexIndices[2*a+1];for(let c=0;c<r;++c){const u=c*e+o,d=(c+1)*e+o,m=(c+1)*e+l,f=c*e+l;this.emitTriangle(u,d,m),this.emitTriangle(u,m,f)}}const s=(a,o,l)=>this.emitTriangle(a,o,l);this.startCap.buildTopology(this.path.vertices[0],s),this.endCap.buildTopology(this.path.vertices[this.path.vertices.length-1],s)}onPathChanged(){this._rebuildGeometry()}},WK=class{constructor(e){this.builder=e}get xform(){return this.builder.path.xform}onPathChanged(){this.builder.onPathChanged()}},XK=class extends WK{constructor(e){super(e),this.vertexAttributePosition=null,this.vertexAttributeNormal=null,this.vertexAttributeColor=null,this.vertexAttributePosition=new Float32Array(3*this.builder.numVerticesTotal),this.vertexAttributeNormal=new Float32Array(3*this.builder.numNormalsTotal),this.vertexAttributeColor=new Uint8Array(4),this.vertexAttributeColor[0]=255,this.vertexAttributeColor[1]=255,this.vertexAttributeColor[2]=255,this.vertexAttributeColor[3]=255}bakeVertexColors(e){this.vertexAttributeColor[0]=255*e[0],this.vertexAttributeColor[1]=255*e[1],this.vertexAttributeColor[2]=255*e[2],this.vertexAttributeColor[3]=255*(e.length>3?e[3]:1)}bake(e){this.size=e;for(let t=0;t<this.builder.numVerticesTotal;++t){let r=this.builder.pathVertexData[t];const n=r===0||r===this.builder.path.vertices.length-1;r*=3;const s=X2e;Y(s,this.builder.originData[r++],this.builder.originData[r++],this.builder.originData[r]);const a=4*t,o=oc,l=mg,c=_l,u=v$,d=Z2e;let m=0,f=0;if(Y(u,this.builder.profileRightAxisData[a],this.builder.profileRightAxisData[a+1],this.builder.profileRightAxisData[a+2]),Y(d,this.builder.profileUpAxisData[a],this.builder.profileUpAxisData[a+1],this.builder.profileUpAxisData[a+2]),rt(l,this.builder.profileVertexAndNormalData[a]*e[0],this.builder.profileVertexAndNormalData[a+1]*e[1]),n)ut(c,d,u),m=this.builder.profileRightAxisData[a+3]*e[0],f=this.builder.profileUpAxisData[a+3];else{const g=U4,w=Q2e;rt(g,this.builder.profileRightAxisData[a+3],this.builder.profileUpAxisData[a+3]);const v=PI(g);X0(g,g);const b=Fr(l,g);if(Math.abs(b)>v){rt(w,-g[1],g[0]);const x=Fr(l,w);qs(g,g,v*Math.sign(b)),qs(w,w,x),yc(l,g,w)}Y(c,0,0,0)}Y(o,u[0]*l[0]+d[0]*l[1],u[1]*l[0]+d[1]*l[1],u[2]*l[0]+d[2]*l[1]),this.vertexAttributePosition[3*t+0]=s[0]+o[0]+c[0]*m,this.vertexAttributePosition[3*t+1]=s[1]+o[1]+c[1]*m,this.vertexAttributePosition[3*t+2]=s[2]+o[2]+c[2]*m;const _=mg;rt(_,this.builder.profileVertexAndNormalData[a+2],this.builder.profileVertexAndNormalData[a+3]),this.vertexAttributeNormal[3*t+0]=u[0]*_[0]+d[0]*_[1]+c[0]*f,this.vertexAttributeNormal[3*t+1]=u[1]*_[0]+d[1]*_[1]+c[1]*f,this.vertexAttributeNormal[3*t+2]=u[2]*_[0]+d[2]*_[1]+c[2]*f}}createGeometryData(){const e=[[S.POSITION,this.builder.vertexIndices],[S.NORMAL,this.builder.normalIndices]],t=[[S.POSITION,{size:3,data:this.vertexAttributePosition,exclusive:!0}],[S.NORMAL,{size:3,data:this.vertexAttributeNormal,exclusive:!0}]];if(this.vertexAttributeColor){const r=this.builder.vertexIndices.length;e.push([S.COLOR,new Array(r).fill(0)]),t.push([S.COLOR,{size:4,data:this.vertexAttributeColor}])}return{vertexAttributes:t,indices:e}}onPathChanged(){super.onPathChanged(),this.bake(this.size)}intersect(e,t,r){const n=this.builder.vertexIndices,s={size:3,data:this.vertexAttributePosition},a=n.length/3;GD(e,t,0,a,n,s,void 0,void 0,r)}},W2e=class extends WK{constructor(e,t,r,n){super(e),this.sizeAttributeValue=t,this.colorAttributeValue=r,this.opacityAttributeValue=n,this.vvData=null,this.baked=new XK(e),this.vvData=new Float32Array(4*this.builder.path.vertices.length);for(let s=0;s<this.builder.path.vertices.length;++s){this.vvData[4*s+0]=t,this.vvData[4*s+1]=r,this.vvData[4*s+2]=n;const a=s===0||s===this.builder.path.vertices.length-1;this.vvData[4*s+3]=a?1:0}}createGeometryData(){return{vertexAttributes:[[S.POSITION,{size:3,data:this.builder.originData,exclusive:!0}],[S.PROFILERIGHT,{size:4,data:this.builder.profileRightAxisData,exclusive:!0}],[S.PROFILEUP,{size:4,data:this.builder.profileUpAxisData,exclusive:!0}],[S.PROFILEVERTEXANDNORMAL,{size:4,data:this.builder.profileVertexAndNormalData,exclusive:!0}],[S.FEATUREVALUE,{size:4,data:this.vvData,exclusive:!0}]],indices:[[S.POSITION,this.builder.pathVertexIndices],[S.PROFILERIGHT,this.builder.vertexIndices],[S.PROFILEUP,this.builder.vertexIndices],[S.PROFILEVERTEXANDNORMAL,this.builder.vertexIndices],[S.FEATUREVALUE,this.builder.pathVertexIndices]]}}};const X2e=P(),mg=Te(),U4=Te(),Q2e=Te(),oc=P(),_l=P(),v$=P(),Z2e=P(),zC=P(),Y2e=_$(),dz=xe(),QK=new Map([[S.POSITION,0],[S.PROFILERIGHT,1],[S.PROFILEUP,2],[S.PROFILEVERTEXANDNORMAL,3],[S.FEATUREVALUE,4]]);let K2e=class extends Hae{constructor(){super(...arguments),this.ambient=Ze(.2,.2,.2),this.diffuse=Ze(.8,.8,.8),this.specular=Ze(0,0,0),this.opacity=1}},ZK=class YK extends ii{initializeConfiguration(e,t){t.hasWebGL2Context=e.rctx.type===Nn.WEBGL2,t.spherical=e.viewingMode===Ie.Global,t.doublePrecisionRequiresObfuscation=zR(e.rctx)}initializeProgram(e){return new ei(e.rctx,YK.shader.get().build(this.configuration),QK)}initializePipeline(){const e=this.configuration.transparencyPassType,t=this.configuration,r=e===qt.NONE,n=e===qt.FrontFace;return it({blending:t.output!==V.Color&&t.output!==V.Alpha||!t.transparent?null:r?Hl:qm(e),culling:t.hasSlicePlane&&!t.transparent&&t.doubleSidedMode!==ho.None&&$ne,depthTest:{func:n_(e)},depthWrite:r||n?nl:null,colorWrite:gt,stencilWrite:t.hasOccludees?Cd:null,stencilTest:t.hasOccludees?s_:null,polygonOffset:r||n?null:jD})}};ZK.shader=new ri(Gae,()=>j(()=>import("./Path.glsl-a65bb2f6.js"),["assets/Path.glsl-a65bb2f6.js","assets/Matrix3PassUniform-ad9f953b.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/mat3f64-c6305894.js","assets/mat4f64-1e28eae0.js","assets/vec3f32-c9aa289f.js","assets/vec3f64-2f9cef06.js","assets/VertexAttribute-9c5c630d.js","assets/mat4-44a0988f.js","assets/common-c186b691.js","assets/vec3-e93e648f.js","assets/vec2f64-30dc1443.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/mathUtils-b4bb77e2.js","assets/vec4-790471c0.js","assets/context-util-a4ce3a7b.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/promiseUtils-1e54421e.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/aaBoundingBox-657a9b82.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/aaBoundingRect-193543b5.js","assets/basicInterfaces-19ed850e.js","assets/ViewingMode-5d7d590b.js","assets/Util-a48361c6.js","assets/vec4f64-e407da96.js","assets/vec2-528adfe4.js","assets/Texture2DPassUniform-753de459.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/compilerUtils-18d58939.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/Normals.glsl-76f97814.js","assets/TransparencyPassType-a11868d2.js","assets/Path.glsl-9f6bab44.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js"]));let cn=class extends cu{constructor(){super(...arguments),this.output=V.Color,this.doubleSidedMode=ho.None,this.transparencyPassType=qt.NONE,this.spherical=!1,this.receiveShadows=!1,this.receiveAmbientOcclusion=!1,this.vvSize=!1,this.vvColor=!1,this.vvOpacity=!1,this.hasSlicePlane=!1,this.transparent=!1,this.hasOccludees=!1,this.hasMultipassTerrain=!1,this.cullAboveGround=!1,this.doublePrecisionRequiresObfuscation=!1}};h([k({count:V.COUNT})],cn.prototype,"output",void 0),h([k({count:ho.COUNT})],cn.prototype,"doubleSidedMode",void 0),h([k({count:qt.COUNT})],cn.prototype,"transparencyPassType",void 0),h([k()],cn.prototype,"spherical",void 0),h([k()],cn.prototype,"receiveShadows",void 0),h([k()],cn.prototype,"receiveAmbientOcclusion",void 0),h([k()],cn.prototype,"vvSize",void 0),h([k()],cn.prototype,"vvColor",void 0),h([k()],cn.prototype,"vvOpacity",void 0),h([k()],cn.prototype,"hasSlicePlane",void 0),h([k()],cn.prototype,"transparent",void 0),h([k()],cn.prototype,"hasOccludees",void 0),h([k()],cn.prototype,"hasMultipassTerrain",void 0),h([k()],cn.prototype,"cullAboveGround",void 0),h([k()],cn.prototype,"doublePrecisionRequiresObfuscation",void 0),h([k({constValue:zr.Disabled})],cn.prototype,"pbrMode",void 0),h([k({constValue:!0})],cn.prototype,"hasVvInstancing",void 0),h([k({constValue:!1})],cn.prototype,"useCustomDTRExponentForWater",void 0),h([k({constValue:!1})],cn.prototype,"useFillLights",void 0);let J2e=class KK extends Fd{constructor(e){super(e,new tRe),this.supportsEdges=!0,this._vertexAttributeLocations=QK,this._configuration=new cn,this._vertexBufferLayout=KK.getVertexBufferLayout(this.parameters)}getConfiguration(e,t){return this._configuration.output=e,this._configuration.vvSize=this.parameters.vvSizeEnabled,this._configuration.vvColor=this.parameters.vvColorEnabled,this._configuration.vvOpacity=this.parameters.vvOpacityEnabled,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this.parameters.transparent,this._configuration.hasOccludees=this.parameters.hasOccludees,e!==V.Color&&e!==V.Alpha||(this._configuration.doubleSidedMode=this.parameters.doubleSided&&this.parameters.doubleSidedType==="normal"?ho.View:this.parameters.doubleSided&&this.parameters.doubleSidedType==="winding-order"?ho.WindingOrder:ho.None,this._configuration.receiveShadows=this.parameters.receiveShadows,this._configuration.receiveAmbientOcclusion=!!t.ssaoHelper.ready&&this.parameters.receiveSSAO),this._configuration.transparencyPassType=t.transparencyPassType,this._configuration.hasMultipassTerrain=t.multipassTerrain.enabled,this._configuration.cullAboveGround=t.multipassTerrain.cullAboveGround,this._configuration}isVisibleForOutput(e){return e!==V.Shadow&&e!==V.ShadowExludeHighlight&&e!==V.ShadowHighlight||this.parameters.castShadows}isVisible(){return super.isVisible()&&this.parameters.opacity>0}intersect(e,t,r,n,s,a,o){const l=e;if(!jK(l))return;const c=l.path,u=[this.parameters.size[0],this.parameters.size[1]];if(this.parameters.vvSizeEnabled){const v=this.parameters.vvSizeOffset,b=this.parameters.vvSizeFactor,x=this.parameters.vvSizeMinSize,T=this.parameters.vvSizeMaxSize,R=c.sizeAttributeValue;u[0]*=ue(v[0]+R*b[0],x[0],T[0]),u[1]*=ue(v[2]+R*b[2],x[2],T[2])}const d=Math.max(u[0],u[1]),m=e.boundingInfo;if(C(m))return void this._intersectTriangles(c,u,s,a,o);const f=HI(m.bbMin[0]-d,m.bbMin[1]-d,m.bbMin[2]-d,m.bbMax[0]+d,m.bbMax[1]+d,m.bbMax[2]+d),_=[a[0]-s[0],a[1]-s[1],a[2]-s[2]],g=Math.sqrt(_[0]*_[0]+_[1]*_[1]+_[2]*_[2]),w=[g/_[0],g/_[1],g/_[2]];JG(f,s,w,n.tolerance)&&this._intersectTriangles(c,u,s,a,o)}_intersectTriangles(e,t,r,n,s){e.baked.size&&e.baked.size[0]===t[0]&&e.baked.size[1]===t[1]||e.baked.bake(t),e.baked.intersect(r,n,s)}computeAttachmentOrigin(e,t){const r=e.vertexAttributes;if(!r)return null;const n=r.get(S.POSITION);return WD(n,null,!1,t)}createBufferWriter(){return new iRe(this._vertexBufferLayout)}requiresSlot(e,t){switch(t){case V.Shadow:case V.ShadowHighlight:case V.ShadowExludeHighlight:if(!this.parameters.castShadows)return!1;case V.Color:case V.Alpha:case V.Depth:case V.Normal:case V.Highlight:case V.ObjectAndLayerIdColor:return e===(this.parameters.transparent?le.TRANSPARENT_MATERIAL:le.OPAQUE_MATERIAL)||e===le.DRAPED_MATERIAL;default:return!1}}createGLMaterial(e){return new eRe(e)}static getVertexBufferLayout(e){const t=sn().vec3f(S.POSITION).vec4f(S.PROFILERIGHT).vec4f(S.PROFILEUP).vec4f(S.PROFILEVERTEXANDNORMAL);return(e.vvColorEnabled||e.vvSizeEnabled||e.vvOpacityEnabled)&&t.vec4f(S.FEATUREVALUE),t}},eRe=class extends r_{_updateOccludeeState(e){e.hasOccludees!==this._material.parameters.hasOccludees&&this._material.setParameters({hasOccludees:e.hasOccludees})}_updateShadowState(e){(C(this.technique)||e.shadowMap.enabled!==this.technique.configuration.receiveShadows)&&this._material.setParameters({receiveShadows:e.shadowMap.enabled})}beginSlot(e){return this._output!==V.Color&&this._output!==V.Alpha||(this._updateShadowState(e),this._updateOccludeeState(e)),this.ensureTechnique(ZK,e)}},tRe=class extends K2e{constructor(){super(...arguments),this.doubleSided=!1,this.doubleSidedType="normal",this.receiveSSAO=!0,this.receiveShadows=!1,this.castShadows=!0,this.hasSlicePlane=!1,this.transparent=!1,this.hasOccludees=!1}},iRe=class{constructor(e){this.vertexBufferLayout=e}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){return e.indices.get(S.POSITION).length}write(e,t,r,n,s){BC(S.PROFILERIGHT,r,n,s),BC(S.PROFILEUP,r,n,s),BC(S.PROFILEVERTEXANDNORMAL,r,n,s),this.vertexBufferLayout.hasField(S.FEATUREVALUE)&&BC(S.FEATUREVALUE,r,n,s),QD(r,this.vertexBufferLayout,e,t,n,s)}};function BC(i,e,t,r){if(e.vertexAttributes.has(i)){const n=e.vertexAttributes.get(i),s=e.indices.get(i);ct(n.size===4);const a=t.getField(i,Sd);if(!a)throw new Error("unable to acquire view for "+i);Aw(s,n.data,a,r)}}const rRe=["polyline"];let nRe=class extends du{constructor(e,t,r,n){super(e,t,r,n),this._intrinsicSize=Qt(1,1),this._upVectorAlignment="path",this._stencilWidth=.1,this.ensureDrapedStatus(!1)}async doLoad(){const e=y(this.symbolLayer.width)?this.symbolLayer.width:this.symbolLayer.height,t=y(this.symbolLayer.height)?this.symbolLayer.height:e;this._vvConvertOptions={modelSize:[1,1,1],symbolSize:[e,1,t],unitInMeters:this._context.renderCoordsHelper.unitInMeters,transformation:{anchor:[0,0,0],scale:[1,1,1],rotation:[0,0,0]},supportedTypes:{size:!0,color:!0,opacity:!0,rotation:!1}},this._context.renderer&&this._context.renderer.visualVariables&&this._context.renderer.visualVariables.length>0?this._fastUpdates=wx(this._context.renderer,this._vvConvertOptions):this._fastUpdates={enabled:!1};const r=this.symbolLayer.anchor||"center";this._upVectorAlignment="path",this.symbolLayer.profileRotation==="heading"&&(this._upVectorAlignment="world");const n=this.symbolLayer.profile||"circle";switch(n){case"circle":default:this._profile=cz.circle(cRe);break;case"quad":this._profile=cz.rect()}let s=[0,0];switch(r!=="center"&&(s={left:[.5,0],right:[-.5,0],top:[0,-.5],bottom:[0,.5]}[r],this._profile.translate(s[0],s[1])),this.symbolLayer.join||"simple"){case"round":this._extruder=new MM(0,lRe);break;case"bevel":this._extruder=new MM(0,1);break;case"miter":this._extruder=new MM(.8*Math.PI,1);break;default:this._extruder=new H2e}const a=this.symbolLayer.cap||"butt";switch(a){case"none":this._startCap=new hz,this._endCap=new hz;break;case"butt":default:this._startCap=new UC(this._profile,0),this._endCap=new UC(this._profile,0,!0);break;case"square":this._startCap=new UC(this._profile,-.5),this._endCap=new UC(this._profile,.5,!0);break;case"round":{const f=n==="quad";this._startCap=new uz({profile:this._profile,flip:!1,breakNormals:f,subdivisions:fz}),this._endCap=new uz({profile:this._profile,flip:!0,breakNormals:f,subdivisions:fz});break}}const o=en(this.symbolLayer,"material","color"),l=this._getCombinedOpacityAndColor(o),c=Tl(l),u=l[3],d=u<1||this.needsDrivenTransparentPass,m={diffuse:c,ambient:c,opacity:u,transparent:d,hasVertexColors:!1,hasSlicePlane:this._context.slicePlaneEnabled,castShadows:this.symbolLayer.castShadows,cullFace:d||a==="none"?tn.None:tn.Back,offsetTransparentBackfaces:!0};if(!this._drivenProperties.size&&(rt(this._intrinsicSize,e,t),!cR(this._intrinsicSize[0])||!cR(this._intrinsicSize[1])))throw new J("graphics3dpathsymbollayer:invalid-size","Symbol sizes may not be negative values");if(this._fastUpdates.enabled&&this._fastUpdates.visualVariables.size||qs(this._intrinsicSize,this._intrinsicSize,1/this._context.renderCoordsHelper.unitInMeters),this._fastUpdates.enabled){const f={...m,...this._fastUpdates.materialParameters,size:_re(this._intrinsicSize)};this._material=new J2e(f)}else m.hasVertexColors=this._drivenProperties.color||this._drivenProperties.opacity,this._material=new Ow(m);this._material.setParameters({usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0}),this._context.stage.add(this._material)}destroy(){super.destroy(),this._context.stage.remove(this._material),this._material=null}createGraphics3DGraphic(e){const t=e.graphic;if(!this._validateGeometry(t.geometry,rRe,this.symbolLayer.type))return null;const r=this.setGraphicElevationContext(t,new Qc),n=e.renderingInfo;return this._createAs3DShape(t,n,r,t.uid)}layerOpacityChanged(){const e=en(this.symbolLayer,"material","color"),t=this._getCombinedOpacity(e),r=t<1||this.needsDrivenTransparentPass;this._material.setParameters({opacity:t,transparent:r})}layerElevationInfoChanged(e,t){return this.updateGraphics3DGraphicElevationInfo(e,t,Bm)}slicePlaneEnabledChanged(){return this._material.setParameters({hasSlicePlane:this._context.slicePlaneEnabled}),!0}physicalBasedRenderingChanged(){return this._material.setParameters({usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0}),!0}pixelRatioChanged(){return!0}applyRendererDiff(e,t){for(const r in e.diff){if(r!=="visualVariables"||!xx(this._fastUpdates,t,this._vvConvertOptions))return Gr.Recreate_Symbol;this._material.setParameters(this._fastUpdates.materialParameters)}return Gr.Fast_Update}getVertexData(e){let t=0;const r=e.paths,n=[],s=e.spatialReference,a=this._context.elevationProvider.spatialReference,o=this._context.renderCoordsHelper.spatialReference;for(const f of r)t+=f.length;const l=new Float64Array(3*t),c=new Float64Array(3*t),u=new Float64Array(3*t);let d=0;for(const f of r){n.push({index:d,numVertices:f.length});for(const _ of f)l[d++]=_[0],l[d++]=_[1],l[d++]=e.hasZ?_[2]:0}let m=!0;return y(a)&&!s.equals(a)?m=Ma(l,s,0,c,a,0,t):this._copyVertices(l,0,c,0,t),y(a)&&!a.equals(o)?Ma(c,a,0,u,o,0,t):this._copyVertices(c,0,u,0,t),{pathVertexDataInfos:n,vertexDataGS:l,vertexDataES:c,vertexDataRS:u,projectionSuccess:m,terrainElevation:0}}_copyVertices(e,t,r,n,s){t*=3,n*=3;for(let a=0;a<s;++a)r[n++]=e[t++],r[n++]=e[t++],r[n++]=e[t++]}_createAs3DShape(e,t,r,n){const s=e.geometry,a=new Array,o=new Array,l=new Array,c=s.spatialReference,u=Ms(),d=this._context.renderCoordsHelper;eJ.spatialReference=c;const m=this.getVertexData(s);if(!m.projectionSuccess)return this.logger.warn("PathSymbol3DLayer geometry failed to be created (failed to project geometry to view spatial reference)"),null;if(m.pathVertexDataInfos.length>0){for(let f=0;f<m.pathVertexDataInfos.length;++f){const _=m.pathVertexDataInfos[f],g=_.index,w=_.numVertices;if(w<2||y(this._context.clippingExtent)&&(Ii(u),Jo(u,m.vertexDataES,3*g,w),!Lc(u,this._context.clippingExtent)))continue;const v=[];for(let D=g;D<g+3*w;){const I=D++,G=D++,W=D++,re=new z2e;Y(re.posGS,m.vertexDataGS[I],m.vertexDataGS[G],m.vertexDataGS[W]),Y(re.posES,m.vertexDataES[I],m.vertexDataES[G],m.vertexDataES[W]);const te=qTe(re.posES,this._context.elevationProvider,r,d);Y(Ll,m.vertexDataRS[I],m.vertexDataRS[G],m.vertexDataRS[W]),d.setAltitude(Ll,te),Y(re.pos,Ll[0],Ll[1],Ll[2]),v.push(re)}const b=new B2e(v);JK(b,this._upVectorAlignment,this._context.renderCoordsHelper);const x=new q2e(b,this._profile,this._extruder,this._startCap,this._endCap);let T=null;if(this._fastUpdates.enabled){const D=this._fastUpdates.visualVariables,I=D.size?_d(D.size.field,e):0,G=D.color?_d(D.color.field,e):0,W=D.opacity?_d(D.opacity.field,e):0;T=new W2e(x,I,G,W)}else{const D=[this._intrinsicSize[0],this._intrinsicSize[1]];this._drivenProperties.size&&(D[0]*=pz(t.size[0],t.size[2]==="symbol-value"?this.symbolLayer.height||0:t.size[2],this.symbolLayer.width||0),D[1]*=pz(t.size[2],t.size[0]==="symbol-value"?this.symbolLayer.width||0:t.size[0],this.symbolLayer.height||0));let I=null;this._drivenProperties.color&&(I=t.color),this._drivenProperties.opacity&&t.opacity!=null&&(I=I?[I[0],I[1],I[2],t.opacity]:[1,1,1,t.opacity]);const G=new XK(x);G.bake(D),I&&G.bakeVertexColors(I),T=G}const{vertexAttributes:R,indices:E}=T.createGeometryData(),O=this._context.stage.renderView._getObjectAndLayerIdColor({graphicUid:n,layerUid:this._context.layer.uid}),$=new D2e(R,E,T,c,this._upVectorAlignment,this._stencilWidth,O);a.push($),o.push(this._material),l.push(T.xform)}if(a.length>0){const f={layerUid:this._context.layer.uid,graphicUid:n},_=new Bd({geometries:a,materials:o,transformations:l,metadata:f}),g=new uu(this,_,a,null,null,aRe,r);return g.alignedSampledElevation=m.terrainElevation,g.needsElevationUpdates=Bm(r.mode),g}}else s.paths.length!==0&&s.paths.some(f=>f.length>0)||this.logger.warn("PathSymbol3DLayer geometry failed to be created (no paths were defined)");return null}};function JK(i,e,t){switch(e){case"world":for(const r of i.vertices)ce(ch,r.pos,i.offset),t.worldUpAtPosition(ch,Ll),r.setFrameFromUpVector(Ll),r.computeRotationAxisAndAngleFromUpVector();break;case"path":ce(ch,i.vertices[0].pos,i.offset),t.worldUpAtPosition(ch,Ll),G2e(i,Ll);for(const r of i.vertices){const n=Math.sign(_e(r.frame.right,r.vRight));ut(r.rotationFrame.up,r.vRight,r.vLeft),Q(r.rotationFrame.up,r.rotationFrame.up,n),de(r.rotationFrame.up,r.rotationFrame.up);const s=_e(r.rotationFrame.up,r.frame.up),a=_e(r.rotationFrame.up,r.frame.right);if(Q(ch,r.frame.up,-a),Q(mz,r.frame.right,s),ce(ch,ch,mz),de(r.rotationFrame.right,ch),U2e(r.rotationRight,r.frame,r.rotationFrame.right),Aa(ch,r.vLeft),r.rotationAngle=-n*(Math.PI-ls(_e(ch,r.vRight))),Math.abs(r.rotationAngle)>0){const l=pI(Math.cos(.5*r.rotationAngle));k4(r.miterStretch,1+(l-1)*r.rotationRight[0]*r.rotationRight[0],(l-1)*r.rotationRight[0]*r.rotationRight[1],(l-1)*r.rotationRight[0]*r.rotationRight[1],1+(l-1)*r.rotationRight[1]*r.rotationRight[1])}const o=Math.PI-r.rotationAngle;r.maxStretchDistance=Math.abs(Math.min(r.vLeftLength,r.vRightLength)*pI(Math.cos(.5*o)))}}}function pz(i,e,t){switch(i){case"symbol-value":return t;case"proportional":return e;default:return i}}function sRe(i,e,t,r){let n=0;for(const s of i.vertices)$d(s.posES,t,e,r,IM),n+=IM.sampledElevation,ce(Ll,s.pos,i.offset),r.setAltitude(Ll,IM.z),ae(s.pos,Ll,i.offset);return i.updatePathVertexInformation(),n/i.vertices.length}function aRe(i,e,t,r){const n=i.stageObject,s=n.geometryRecords;let a=0;oRe.spatialReference=r.spatialReference;for(const o of s){const l=o.geometry;if(!jK(l))continue;const c=l.path,u=c.builder.path,d=l.geometrySR;eJ.spatialReference=d,a+=sRe(u,e,t,r),l.upVectorAlignment!=="world"&&JK(u,l.upVectorAlignment,r),c.onPathChanged(),l.invalidateBoundingInfo(),n.geometryVertexAttrsUpdated(o)}return a/s.length}const oRe=kd(0,0,0,null),eJ=kd(0,0,0,null),Ll=P(),ch=Xi(),mz=Xi(),IM=new aT,lRe=3,fz=3,cRe=10;function hRe(i,e,t,r,n=1){if(t.isGeographic&&r===Ie.Global){const o=new Float64Array(e.typedBuffer.length),l=3*e.count,c=Kt(t);for(let u=0;u<l;u+=3)Z7(e.typedBuffer,u,o,u,c);e=Dm.fromTypedArray(o)}rt(kr,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY);for(let o=0;o<e.count;o++)e.getVec(o,ao),kr[0]=Math.min(kr[0],ao[0]),kr[1]=Math.min(kr[1],ao[1]);const s=kr[0]%n,a=kr[1]%n;Al[0]=kr[0]-s,Al[1]=kr[1]-a;for(let o=0;o<e.count;o++)e.getVec(o,ao),i.setValues(o,(ao[0]-Al[0])/n,(ao[1]-Al[1])/n,Al[0]/n,Al[1]/n)}function tJ(i,e,t,r,n=1){Y(_f,1,0,0),Y(yf,0,1,0),Y(J_,0,0,1),pRe(LM,e),uRe(e,gz)&&dRe(gz,_f,yf,J_,t,LM),rt(kr,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),rt(vf,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(let l=0;l<e.count;l++){e.getVec(l,ao);const c=_e(_f,ao),u=_e(yf,ao);kr[0]=Math.min(kr[0],c),kr[1]=Math.min(kr[1],u),vf[0]=Math.max(vf[0],c),vf[1]=Math.max(vf[1],u)}const s=_e(J_,LM);DM(cp,kr[0],kr[1],s,_f,yf,J_),DM(bf,vf[0],kr[1],s,_f,yf,J_),DM(wf,kr[0],vf[1],s,_f,yf,J_),ae(bf,bf,cp),Q(bf,bf,.5),ae(wf,wf,cp),Q(wf,wf,.5),ce(cp,cp,bf),ce(cp,cp,wf);const a=kr[0]%n,o=kr[1]%n;Al[0]=kr[0]-a,Al[1]=kr[1]-o;for(let l=0;l<e.count;l++){e.getVec(l,ao),i.setValues(l,(_e(_f,ao)-Al[0])/n,(_e(yf,ao)-Al[1])/n,Al[0]/n,Al[1]/n);for(let c=0;c<3;c++)r.set(l,c,cp[c]),r.set(l,c+3,bf[c]),r.set(l,c+6,wf[c])}}const LM=P(),ao=P(),gz=fr(),_f=P(),yf=P(),J_=P(),kr=Te(),vf=Te(),Al=Te(),cp=P(),bf=P(),wf=P();function uRe(i,e){const t=i.count-1;return ane(i,e,0,Math.floor(t/3),Math.floor(t*(2/3)))}function dRe(i,e,t,r,n,s){y(n)?(n.basisMatrixAtPosition(s,hh),Y(GC,hh[0],hh[1],hh[2]),Y(HC,hh[4],hh[5],hh[6]),Y($M,hh[8],hh[9],hh[10])):(Y(GC,1,0,0),Y(HC,0,1,0),Y($M,0,0,1));const a=Ia(i);_e(a,$M)<0&&Q(a,a,-1),X(r,a);const o=_e(a,HC),l=_e(a,GC);Math.abs(o)<Math.abs(l)?(F5(e,GC,a,-l),de(e,e),ut(t,e,a),de(t,t),Q(t,t,-1)):(F5(t,HC,a,-o),de(t,t),ut(e,t,a),de(e,e))}const hh=xe(),GC=P(),HC=P(),$M=P();function pRe(i,e){Y(jC,0,0,0);for(let t=0;t<e.count-1;t++)e.getVec(t,ao),ce(jC,jC,ao);Q(i,jC,1/(e.count-1))}const jC=P();function DM(i,e,t,r,n,s,a){Y(i,e*n[0]+t*s[0]+r*a[0],e*n[1]+t*s[1]+r*a[1],e*n[2]+t*s[2]+r*a[2])}let iJ=class rJ extends ii{initializeConfiguration(e,t){t.hasWebGL2Context=e.rctx.type===Nn.WEBGL2}initializeProgram(e){return new ei(e.rctx,rJ.shader.get().build(this.configuration),oi)}_createPipeline(e,t){const r=this.configuration,n=e===qt.NONE,s=e===qt.FrontFace;return it({blending:r.output!==V.Color&&r.output!==V.Alpha||!r.transparent?null:n?Hl:qm(e),culling:zD(r.cullFace),depthTest:{func:n_(e)},depthWrite:n||s?r.writeDepth&&nl:null,colorWrite:gt,stencilWrite:r.hasOccludees?Cd:null,stencilTest:r.hasOccludees?t?$g:s_:null,polygonOffset:n||s?r.polygonOffset&&mRe:XD(r.enableOffset)})}initializePipeline(){return this._occludeePipelineState=this._createPipeline(this.configuration.transparencyPassType,!0),this._createPipeline(this.configuration.transparencyPassType,!1)}getPipelineState(e,t){return t?this._occludeePipelineState:super.getPipelineState(e,t)}};iJ.shader=new ri(jae,()=>j(()=>import("./ColorMaterial.glsl-b3baa2ff.js"),["assets/ColorMaterial.glsl-b3baa2ff.js","assets/Matrix3PassUniform-ad9f953b.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/mat3f64-c6305894.js","assets/mat4f64-1e28eae0.js","assets/vec3f32-c9aa289f.js","assets/vec3f64-2f9cef06.js","assets/VertexAttribute-9c5c630d.js","assets/mat4-44a0988f.js","assets/common-c186b691.js","assets/vec3-e93e648f.js","assets/vec4f64-e407da96.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/Texture2DPassUniform-753de459.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/TransparencyPassType-a11868d2.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/VertexColor.glsl-8c022fa8.js","assets/OutputDepth.glsl-470c8e2a.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/AlphaCutoff-96178e0d.js","assets/Float4PassUniform-d7bdbc81.js"]));const mRe={factor:1,units:1};let Qa=class extends cu{constructor(){super(...arguments),this.output=V.Color,this.cullFace=tn.None,this.hasSlicePlane=!1,this.hasVertexColors=!1,this.transparent=!1,this.polygonOffset=!1,this.enableOffset=!0,this.writeDepth=!0,this.hasOccludees=!1,this.transparencyPassType=qt.NONE,this.hasMultipassTerrain=!1,this.cullAboveGround=!1,this.objectAndLayerIdColorInstanced=!1}};h([k({count:V.COUNT})],Qa.prototype,"output",void 0),h([k({count:tn.COUNT})],Qa.prototype,"cullFace",void 0),h([k()],Qa.prototype,"hasSlicePlane",void 0),h([k()],Qa.prototype,"hasVertexColors",void 0),h([k()],Qa.prototype,"transparent",void 0),h([k()],Qa.prototype,"polygonOffset",void 0),h([k()],Qa.prototype,"enableOffset",void 0),h([k()],Qa.prototype,"writeDepth",void 0),h([k()],Qa.prototype,"hasOccludees",void 0),h([k({count:qt.COUNT})],Qa.prototype,"transparencyPassType",void 0),h([k()],Qa.prototype,"hasMultipassTerrain",void 0),h([k()],Qa.prototype,"cullAboveGround",void 0),h([k()],Qa.prototype,"objectAndLayerIdColorInstanced",void 0);let _z=class extends Fd{constructor(e){super(e,new gRe),this.supportsEdges=!0,this._configuration=new Qa}getConfiguration(e,t){return this._configuration.output=e,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasVertexColors=this.parameters.hasVertexColors,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this.parameters.transparent,this._configuration.polygonOffset=this.parameters.polygonOffset,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.hasOccludees=this.parameters.hasOccludees,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration.enableOffset=t.camera.relativeElevation<ZD,this._configuration.hasMultipassTerrain=t.multipassTerrain.enabled,this._configuration.cullAboveGround=t.multipassTerrain.cullAboveGround,this._configuration}intersect(e,t,r,n,s,a,o){BD(e,t,n,s,a,void 0,o)}requiresSlot(e,t){return t===V.Color||t===V.Alpha||t===V.Highlight||t===V.Depth&&this.parameters.writeLinearDepth||t===V.ObjectAndLayerIdColor?e===le.DRAPED_MATERIAL?!0:t===V.Highlight?e===le.OPAQUE_MATERIAL:e===(this.parameters.transparent?this.parameters.writeDepth?le.TRANSPARENT_MATERIAL:le.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL:le.OPAQUE_MATERIAL):!1}createGLMaterial(e){return new fRe(e)}createBufferWriter(){return new HP(Ot("enable-feature:objectAndLayerId-rendering")?oSe:yK)}},fRe=class extends r_{_updateOccludeeState(e){e.hasOccludees!==this._material.parameters.hasOccludees&&this._material.setParameters({hasOccludees:e.hasOccludees})}beginSlot(e){return this._output!==V.Color&&this._output!==V.Alpha||this._updateOccludeeState(e),this.ensureTechnique(iJ,e)}},gRe=class extends qx{constructor(){super(...arguments),this.color=C0,this.transparent=!1,this.writeDepth=!0,this.writeLinearDepth=!1,this.hasVertexColors=!1,this.polygonOffset=!1,this.hasSlicePlane=!1,this.cullFace=tn.None,this.hasOccludees=!1}},nJ=class sJ extends ii{initializeConfiguration(e,t){t.hasWebGL2Context=e.rctx.type===Nn.WEBGL2}initializeProgram(e){return new ei(e.rctx,sJ.shader.get().build(this.configuration),aJ)}_setPipelineState(e,t){const r=this.configuration,n=e===qt.NONE,s=e===qt.FrontFace;return it({blending:r.output===V.Color||r.output===V.Alpha?n?Hl:qm(e):null,culling:zD(r.cullFace),depthTest:{func:n_(e)},depthWrite:n?r.writeDepth&&nl:BR(e),colorWrite:gt,stencilWrite:r.hasOccludees?Cd:null,stencilTest:r.hasOccludees?t?$g:s_:null,polygonOffset:n||s?r.polygonOffset&&_Re:XD(r.enableOffset)})}initializePipeline(){return this._occludeePipelineState=this._setPipelineState(this.configuration.transparencyPassType,!0),this._setPipelineState(this.configuration.transparencyPassType,!1)}getPipelineState(e,t){return t?this._occludeePipelineState:super.getPipelineState(e,t)}};nJ.shader=new ri(qae,()=>j(()=>import("./Pattern.glsl-6461350d.js"),["assets/Pattern.glsl-6461350d.js","assets/Matrix3PassUniform-ad9f953b.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/mat3f64-c6305894.js","assets/mat4f64-1e28eae0.js","assets/vec3f32-c9aa289f.js","assets/vec3f64-2f9cef06.js","assets/VertexAttribute-9c5c630d.js","assets/mat4-44a0988f.js","assets/common-c186b691.js","assets/vec3-e93e648f.js","assets/vec4f64-e407da96.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/Texture2DPassUniform-753de459.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/TransparencyPassType-a11868d2.js","assets/Pattern.glsl-67f4595b.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/VertexColor.glsl-8c022fa8.js","assets/OutputDepth.glsl-470c8e2a.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/AlphaCutoff-96178e0d.js","assets/Float4PassUniform-d7bdbc81.js","assets/FloatPassUniform-68d54f51.js"]));const _Re={factor:1,units:1};let zs=class extends cu{constructor(){super(...arguments),this.output=V.Color,this.cullFace=tn.None,this.transparencyPassType=qt.NONE,this.hasSlicePlane=!1,this.hasVertexColors=!1,this.polygonOffset=!1,this.writeDepth=!0,this.hasOccludees=!1,this.enableOffset=!0,this.hasMultipassTerrain=!1,this.cullAboveGround=!1}};h([k({count:V.COUNT})],zs.prototype,"output",void 0),h([k({count:tn.COUNT})],zs.prototype,"cullFace",void 0),h([k({count:Up.COUNT})],zs.prototype,"style",void 0),h([k({count:qt.COUNT})],zs.prototype,"transparencyPassType",void 0),h([k()],zs.prototype,"hasSlicePlane",void 0),h([k()],zs.prototype,"hasVertexColors",void 0),h([k()],zs.prototype,"polygonOffset",void 0),h([k()],zs.prototype,"writeDepth",void 0),h([k()],zs.prototype,"hasOccludees",void 0),h([k()],zs.prototype,"patternSpacing",void 0),h([k()],zs.prototype,"lineWidth",void 0),h([k()],zs.prototype,"enableOffset",void 0),h([k()],zs.prototype,"draped",void 0),h([k()],zs.prototype,"hasMultipassTerrain",void 0),h([k()],zs.prototype,"cullAboveGround",void 0);const aJ=new Map([[S.POSITION,0],[S.COLOR,3],[S.UVMAPSPACE,4],[S.BOUNDINGRECT,5]]);let z4=class extends Fd{constructor(e){super(e,new bRe),this.supportsEdges=!0,this._vertexAttributeLocations=aJ,this._configuration=new zs}getConfiguration(e,t){return this._configuration.output=e,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasVertexColors=this.parameters.hasVertexColors,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.polygonOffset=this.parameters.polygonOffset,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.style=this.parameters.style,this._configuration.patternSpacing=this.parameters.patternSpacing,this._configuration.lineWidth=this.parameters.lineWidth,this._configuration.draped=this.parameters.draped,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration.enableOffset=t.camera.relativeElevation<ZD,this._configuration.hasMultipassTerrain=t.multipassTerrain.enabled,this._configuration.cullAboveGround=t.multipassTerrain.cullAboveGround,this._configuration}intersect(e,t,r,n,s,a,o){BD(e,t,n,s,a,void 0,o)}requiresSlot(e,t){return t===V.Color||t===V.Alpha||t===V.Highlight||t===V.Depth&&this.parameters.writeLinearDepth?e===le.DRAPED_MATERIAL?!0:t===V.Highlight?e===le.OPAQUE_MATERIAL:e===(this.parameters.writeDepth?le.TRANSPARENT_MATERIAL:le.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL):!1}createGLMaterial(e){return new yRe(e)}createBufferWriter(){const e=sn().vec3f(S.POSITION).vec4u8(S.COLOR).vec4f(S.UVMAPSPACE);return this.parameters.draped||e.mat3f(S.BOUNDINGRECT),new vRe(e)}},yRe=class extends r_{_updateParameters(e){return this.ensureTechnique(nJ,e)}_updateOccludeeState(e){e.hasOccludees!==this._material.parameters.hasOccludees&&this._material.setParameters({hasOccludees:e.hasOccludees})}beginSlot(e){return this._output!==V.Color&&this._output!==V.Alpha||this._updateOccludeeState(e),this._updateParameters(e)}},vRe=class extends HP{write(e,t,r,n,s){for(const a of this.vertexBufferLayout.fieldNames){const o=r.vertexAttributes.get(a),l=r.indices.get(a);if(o&&l)switch(a){case S.POSITION:{ct(o.size===3);const c=n.getField(a,Fm);c&&HD(l,o.data,e,c,s);break}case S.COLOR:{ct(o.size===3||o.size===4);const c=n.getField(a,$m);c&&hH(l,o.data,o.size,c,s);break}case S.UVMAPSPACE:{ct(o.size===4);const c=n.getField(a,Sd);c&&Aw(l,o.data,c,s);break}case S.BOUNDINGRECT:{ct(o.size===9);const c=n.getField(a,Lw);c&&this.writeBoundingRect(l,o.data,e,c,s);break}}}}writeBoundingRect(e,t,r,n,s){const a=r,o=n.typedBuffer,l=n.typedBufferStride,c=e.length;s*=l;for(let u=0;u<c;++u){const d=9*e[u],m=t[d],f=t[d+1],_=t[d+2];o[s]=a[0]*m+a[4]*f+a[8]*_+a[12],o[s+1]=a[1]*m+a[5]*f+a[9]*_+a[13],o[s+2]=a[2]*m+a[6]*f+a[10]*_+a[14];for(let g=3;g<9;++g)o[s+g]=t[d+g];s+=l}}},bRe=class extends qx{constructor(){super(...arguments),this.color=Bi(1,1,1,1),this.writeDepth=!0,this.writeLinearDepth=!1,this.hasVertexColors=!1,this.polygonOffset=!1,this.hasSlicePlane=!1,this.cullFace=tn.None,this.hasOccludees=!1,this.style=Up.Cross,this.patternSpacing=10,this.lineWidth=1,this.draped=!0}};function wRe(i,e,t){return TRe(xRe(i),e,t)}function xRe(i){return i&&i.pattern||null}function TRe(i,e,t){return y(i)?i.style==="none"||i.style==="solid"?(i.style==="none"&&(e.color=Bi(0,0,0,0),e.transparent=!0),new _z(e)):(e.style=CRe(i.style),e.draped=t.isDraped,new z4(e)):new _z(e)}function CRe(i){switch(i){case"horizontal":return Up.Horizontal;case"vertical":return Up.Vertical;case"cross":return Up.Cross;case"forward-diagonal":return Up.ForwardDiagonal;case"backward-diagonal":return Up.BackwardDiagonal;case"diagonal-cross":return Up.DiagonalCross;default:return}}function SRe(i){return i.material instanceof z4&&!i.material.parameters.draped}function ERe(i,e){if(SRe(i)){const t=i.geometry.vertexAttributes,r=t.get(S.POSITION).data,n=t.get(S.UVMAPSPACE).data,s=t.get(S.BOUNDINGRECT).data;tJ(Sd.fromTypedArray(n),Dm.fromTypedArray(r),e,CH.fromTypedArray(s))}}function RRe(i,e,t,r){const n=GY(i,e,t,r),s=i.stageObject.geometryRecords;for(let a=0;a<s.length;a++)ERe(s[a],r);return n}const PRe=["polyline","polygon","extent"];let oJ=class lJ extends du{constructor(e,t,r,n){super(e,t,r,n),this._needsUV=!1,this._hasOutline=!1}async doLoad(){}_ensureMaterials(){this._ensureFillMaterial(),this._ensureOutlineMaterial()}_ensureFillMaterial(){if(y(this._material))return;const e=en(this.symbolLayer,"material","color"),t=this._getCombinedOpacityAndColor(e);this._material=wRe(this.symbolLayer,{color:t,transparent:t[3]<1||this.needsDrivenTransparentPass,polygonOffset:!1,hasVertexColors:!0,writeLinearDepth:!0,hasSlicePlane:this._context.slicePlaneEnabled},{isDraped:this.draped}),this._needsUV=this._material instanceof z4,this._context.stage.add(this._material)}_ensureOutlineMaterial(){const e=this.symbolLayer.outline;if(y(this._outlineMaterial)||!this._isValidOutline(e))return;this._hasOutline=!0;const t=r=>{const n=NK(e.pattern);return new v0({width:r,color:this._getOutlineColor(),hasPolygonOffset:!0,hasSlicePlane:this._context.slicePlaneEnabled,isClosed:!0,stipplePattern:n,stippleScaleWithLineWidth:!0,cap:f$(e.patternCap||"butt")})};this._outlineMaterial=t(Sa(e.size)),this._context.stage.add(this._outlineMaterial)}_isValidOutline(e){return y(e)&&e.size&&e.size>0&&y(e.color)&&(C(e.pattern)||e.pattern.type!=="style"||e.pattern.style!=="none")}destroy(){super.destroy(),this._context.stage.remove(this._material),this._material=null,this._context.stage.remove(this._outlineMaterial),this._outlineMaterial=null}createGraphics3DGraphic(e){const t=e.graphic;if(!this._validateGeometry(t.geometry,PRe,this.symbolLayer.type))return null;const r=this._getVertexOpacityAndColor(e.renderingInfo,255),n=this.setGraphicElevationContext(t,new Qc);return this.ensureDrapedStatus(n.mode==="on-the-ground"),this._ensureMaterials(),this.draped?this._createAsOverlay(t,r):this._createAs3DShape(t,r,n)}layerOpacityChanged(){if(y(this._material)){const e=this._material.parameters.color,t=en(this.symbolLayer,"material","color"),r=this._getCombinedOpacity(t);this._material.setParameters({color:[e[0],e[1],e[2],r],transparent:r<1||this.needsDrivenTransparentPass})}if(y(this._outlineMaterial)){const e=this._outlineMaterial.parameters.color;this._outlineMaterial.setParameters({color:[e[0],e[1],e[2],this._getOutlineOpacity()]})}}layerElevationInfoChanged(e,t,r){const n=this._elevationContext.mode,s=sT(lJ.elevationModeChangeTypes,r,n);if(s!==Zi.UPDATE)return s;const a=Ql(n);return this.updateGraphics3DGraphicElevationInfo(e,t,()=>a)}slicePlaneEnabledChanged(){if(y(this._material)&&this._material.setParameters({hasSlicePlane:this._context.slicePlaneEnabled}),y(this._outlineMaterial)){const e={hasSlicePlane:this._context.slicePlaneEnabled};this._outlineMaterial.setParameters(e)}return!0}physicalBasedRenderingChanged(){return!0}pixelRatioChanged(){return!0}_createAs3DShape(e,t,r){var u;const n=bx(e.geometry);if(C(n))return null;const s=F4(n,this._context.elevationProvider,this._context.renderCoordsHelper,r),a=new ARe(s,t,this._context.layer.uid,e.uid),o=a.renderData.position.length/3;if(this._needsUV&&(a.uvMapSpace=new Float32Array(4*o),a.boundingRect=new Float64Array(9*o)),a.objectAndLayerIdColor=(u=this._context.stage.renderView)==null?void 0:u._getObjectAndLayerIdColor({graphicUid:a.graphicsUid,layerUid:a.layerUid}),this._createAs3DShapeFill(a),this._hasOutline&&this._createAs3DShapeOutline(a),this._logGeometryCreationWarnings(a.renderData,n.rings,"rings","FillSymbol3DLayer"),a.outGeometries.length===0)return null;this._needsUV&&tJ(Sd.fromTypedArray(a.uvMapSpace),Dm.fromTypedArray(a.renderData.position),this._context.renderCoordsHelper,CH.fromTypedArray(a.boundingRect));const l=new Bd({geometries:a.outGeometries,materials:a.outMaterials,transformations:a.outTransforms,castShadow:!1,metadata:{layerUid:this._context.layer.uid,graphicUid:e.uid}}),c=new uu(this,l,a.outGeometries,null,null,RRe,r);return c.alignedSampledElevation=a.renderData.sampledElevation,c.needsElevationUpdates=Ql(r.mode),c}_createAs3DShapeFill(e){const t=e.renderData.polygons;for(const{position:r,mapPosition:n,holeIndices:s,index:a,count:o}of t){if(y(this._context.clippingExtent)&&(Ii(Ns),Jo(Ns,n),!Lc(Ns,this._context.clippingExtent)))continue;const l=$w(n,s,3);if(l.length===0)continue;const c=o8({indices:l,attributeData:{position:r,color:e.color,mapPosition:n,uvMapSpace:this._needsUV?new Float32Array(e.uvMapSpace.buffer,4*a*e.uvMapSpace.BYTES_PER_ELEMENT,4*o):null,boundingRect:this._needsUV?new Float64Array(e.boundingRect.buffer,9*a*e.boundingRect.BYTES_PER_ELEMENT,9*o):null,objectAndLayerIdColor:e.objectAndLayerIdColor}});e.outGeometries.push(c),e.outMaterials.push(ft(this._material)),e.outTransforms.push(rn)}}_createAs3DShapeOutline(e){if(!this._hasOutline)return;const t=e.renderData.outlines;for(let r=0;r<t.length;++r){const{mapPosition:n,position:s}=t[r];if(y(this._context.clippingExtent)&&(Ii(Ns),Jo(Ns,n),!Lc(Ns,this._context.clippingExtent)))continue;const a=g$({overlayInfo:null,removeDuplicateStartEnd:!0,attributeData:{position:s,mapPosition:n}},e.objectAndLayerIdColor),o=a.vertexAttributes.get(S.POSITION);o.data===s&&(o.data=new Float64Array(s)),e.outGeometries.push(a),e.outMaterials.push(ft(this._outlineMaterial)),e.outTransforms.push(rn)}}_createAsOverlay(e,t){var o;const r=bx(e.geometry);if(C(r))return null;ft(this._material).renderPriority=this._renderPriority+this._renderPriorityStep/2,y(this._outlineMaterial)&&(this._outlineMaterial.renderPriority=this._renderPriority);const n=TK(r,this._context.overlaySR),s=new ORe(n,t,this._context.layer.uid,e.uid),a=s.renderData.position.length/3;return this._needsUV&&(s.uvMapSpace=new Float32Array(4*a)),s.outBoundingBox=Ii(),s.objectAndLayerIdColor=(o=this._context.stage.renderView)==null?void 0:o._getObjectAndLayerIdColor({graphicUid:s.graphicsUid,layerUid:s.layerUid}),this._createAsOverlayFill(s),this._hasOutline&&this._createAsOverlayOutline(s),this._logGeometryCreationWarnings(s.renderData,r.rings,"rings","FillSymbol3DLayer"),s.outGeometries.length===0?null:(this._needsUV&&hRe(Sd.fromTypedArray(s.uvMapSpace),Dm.fromTypedArray(s.renderData.position),this._context.overlaySR,this._context.graphicsCoreOwner.view.state.viewingMode),new jP(this,s.outGeometries,s.outBoundingBox,this._context.drapeSourceRenderer))}_createAsOverlayFill(e){const t=e.renderData.polygons;for(const{position:r,holeIndices:n,index:s,count:a}of t){if(Ii(Ns),Jo(Ns,r),!Lc(Ns,this._context.clippingExtent))continue;const o=$w(r,n,3);if(o.length===0)continue;Y0(e.outBoundingBox,Ns);const l=o8({indices:o,attributeData:{position:r,color:e.color,uvMapSpace:this._needsUV?new Float32Array(e.uvMapSpace.buffer,4*s*e.uvMapSpace.BYTES_PER_ELEMENT,4*a):null,objectAndLayerIdColor:e.objectAndLayerIdColor}}),c=new pv(l,ft(this._material),{layerUid:e.layerUid,graphicUid:e.graphicsUid}),u=Ns;Qs(c.boundingSphere,.5*(u[0]+u[3]),.5*(u[1]+u[4]),0,.5*Math.sqrt((u[3]-u[0])*(u[3]-u[0])+(u[4]-u[1])*(u[4]-u[1]))),e.outGeometries.push(c)}}_createAsOverlayOutline(e){if(!this._hasOutline)return;const t=e.renderData.outlines;for(let r=0;r<t.length;++r){const{position:n}=t[r];if(Ii(Ns),Jo(Ns,n),!Lc(Ns,this._context.clippingExtent))continue;Y0(e.outBoundingBox,Ns);const s=g$({overlayInfo:{spatialReference:this._context.overlaySR,renderCoordsHelper:this._context.renderCoordsHelper},removeDuplicateStartEnd:!0,attributeData:{position:n}},e.objectAndLayerIdColor),a=new pv(s,ft(this._outlineMaterial),{layerUid:e.layerUid,graphicUid:e.graphicsUid}),o=Ns;Qs(a.boundingSphere,.5*(o[0]+o[3]),.5*(o[1]+o[4]),0,.5*Math.sqrt((o[3]-o[0])*(o[3]-o[0])+(o[4]-o[1])*(o[4]-o[1]))),e.outGeometries.push(a)}}_getOutlineOpacity(){const e=en(this.symbolLayer,"outline","color");return(this.draped?1:this._getLayerOpacity())*(y(e)?e.a:0)}_getOutlineColor(){const e=en(this.symbolLayer,"outline","color"),t=this._getOutlineOpacity();return rw(y(e)?ti.toUnitRGB(e):null,t)}test(){return{...super.test(),createAsOverlay:(e,t)=>this._createAsOverlay(e,t),createAs3DShape:(e,t,r)=>this._createAs3DShape(e,t,r)}}};oJ.elevationModeChangeTypes={definedChanged:Zi.RECREATE,staysOnTheGround:Zi.NONE,onTheGroundChanged:Zi.RECREATE};const Ns=Ms();let ARe=class extends zP{constructor(e,t,r,n){super(e,r,n),this.color=t}},ORe=class extends zP{constructor(e,t,r,n){super(e,r,n),this.color=t}},cJ=class hJ{constructor(e){this.definition=e,this.key=JSON.stringify(e),this.haloSize=Math.round(e.halo.size),this.textStyle=this._colorToRGBA(e.color),this.haloStyle=this._colorToRGB(e.halo.color),this.backgroundStyle=e.background.color[3]!==0?this._colorToRGBA(e.background.color):null}fontString(e){const t=this.definition.font;return`${t.style} ${t.weight} ${e}px ${t.family}, sans-serif`}_colorToRGB(e){return`rgb(${e.slice(0,3).map(t=>Math.floor(255*t)).toString()})`}_colorToRGBA(e){return`rgba(${e.slice(0,3).map(t=>Math.floor(255*t)).toString()},${e[3]})`}static async fromSymbol(e,t=1){const r=en(e,"material","color"),n=Np(r,C0,ti.toUnitRGBA),s=Np(e.size,12,Sa),a=e.lineHeight,o=y(e.background)?ti.toUnitRGBA(e.background.color):C0,l={family:Np(e.font,"sans-serif",f=>f.family),decoration:Np(e.font,"none",f=>f.decoration),weight:Np(e.font,"normal",f=>f.weight),style:Np(e.font,"normal",f=>f.style)},c=e.halo,u=y(c)&&y(c.color)&&c.size>0?{size:Sa(c.size),color:ti.toUnitRGBA(c.color)}:{size:0,color:C0},d=new hJ({color:n,size:s,background:{color:o,padding:y(e.background)?[.65*s,.5*s]:[0,0],borderRadius:y(e.background)?s*(6/16):0},lineSpacingFactor:a,font:l,halo:u,pixelRatio:t}),m=d.fontString(s);try{await document.fonts.load(m)}catch{ee.getLogger("esri.views.3d.webgl-engine.lib.TextRenderParameters").warnOnce(`Failed to preload font '${m}'. Some text symbology may be rendered using the default browser font.`)}return d}},MRe=class{constructor(e,t,r){this._renderer=new RK(e,t,r)}get key(){return this._renderer.key}get baselineAnchorY(){return 1-this._renderer.firstRenderedBaselinePosition/this._renderer.renderedHeight}get displayWidth(){return this._renderer.displayWidth}get displayHeight(){return this._renderer.displayHeight}create(){const e=fE(IRe,this._renderer.renderedWidth,this._renderer.renderedHeight),t=e.getContext("2d");return t.save(),this._renderer.render(t,0,0),t.restore(),new jR(e,{wrap:{s:ai.CLAMP_TO_EDGE,t:ai.CLAMP_TO_EDGE},noUnpackFlip:!1,mipmap:!0,preMultiplyAlpha:!0,powerOfTwoResizeMode:YD.PAD})}};const IRe={canvas:null},LRe=[0,0,1];let $Re=class extends du{constructor(e,t,r,n){super(e,t,r,n),this._elevationOptions={supportsOffsetAdjustment:!0,supportsOnTheGround:!1},this.ensureDrapedStatus(!1)}async doLoad(){if(!this._drivenProperties.size){const e=VP(this.symbolLayer.size);if(e)throw new J("graphics3dtextsymbollayer:invalid-size",e)}await this._createTextRenderParameters()}async _createTextRenderParameters(){const e=this._context.graphicsCoreOwner.view.state.pixelRatio;this._textRenderParameters=await cJ.fromSymbol(this.symbolLayer,e)}destroy(){super.destroy()}createGraphics3DGraphic(e){const t=e.graphic,r=vx(t.geometry);if(C(r))return this.logger.warn(`unsupported geometry type for text symbol: ${t.geometry.type}`),null;const n=this.symbolLayer.text;if(C(n)||n==="")return null;const s=mD(this.symbol)&&this.symbol.hasVisibleVerticalOffset()?this.symbol.verticalOffset:null;if(y(s)&&!nG(this.symbolLayer))return this.logger.errorOncePerTick(`Callouts and vertical offset on text symbols are currently only supported with 'center' horizontal alignment (not with '${this.symbolLayer.horizontalAlignment}' alignment)`),null;const a={...NRe,verticalOffset:s,horizontalPlacement:this.symbolLayer.horizontalAlignment,verticalPlacement:HSe(this.symbolLayer.verticalAlignment)};return this._createAs3DShape(t,r,n,a)}createLabel(e,t,r,n){const s=e.graphic,a=vx(s.geometry);if(C(a))return this.logger.warn(`unsupported geometry type for label: ${s.geometry.type}`),null;const o=t.text;return!o||/^\s+$/.test(o)?null:this._createAs3DShape(s,a,o,t,r,n)}setGraphicElevationContext(e,t,r=0){const n=super.setGraphicElevationContext(e,t);return n.addOffsetRenderUnits(r),n}layerOpacityChanged(){return this.logger.warn("layer opacity change not yet implemented in Graphics3DTextSymbolLayer"),!1}layerElevationInfoChanged(e,t){return yz(e,t,(r,n)=>{this.updateGraphicElevationContext(n,r)}),Zi.UPDATE}slicePlaneEnabledChanged(e,t){return yz(e,t,r=>{for(const n of r.stageObject.geometryRecords)n.material.setParameters({hasSlicePlane:this._context.slicePlaneEnabled})}),!0}physicalBasedRenderingChanged(){return!0}pixelRatioChanged(){return!1}updateGraphicElevationContext(e,t){this.setGraphicElevationContext(e,t.elevationContext,t.metadata.elevationOffset),t.needsElevationUpdates=Ql(t.elevationContext.mode)||t.elevationContext.mode==="absolute-height"}_defaultElevationInfoNoZ(){return FRe}_createAs3DShape(e,t,r,n,s,a){const o=this.setGraphicElevationContext(e,new Qc,n.elevationOffset),l=en(e.geometry,"type")==="polyline",c=e.uid;let u=null,d=null;if(C(a)){const I=AK(n.horizontalPlacement);u=new MRe(r,I,this._textRenderParameters);let G=null;if(y(this._context.sharedResources.textures)){d=this._context.sharedResources.textures.fromData(u.key,()=>ft(u).create(),()=>{y(G)&&G.release()});const W=this._context.stage.renderView.textureRepository.acquire(d.texture.id);if(C(W)||kx(W))return d.release(),null;G=W}}const m=DRe(u,n),f={occlusionTest:!0,screenOffset:n.screenOffset,anchorPosition:m,polygonOffset:!0,color:[1,1,1,1],centerOffsetUnits:n.centerOffsetUnits,debugDrawLabelBorder:n.debugDrawLabelBorder,drawInSecondSlot:!0};if(y(d)&&(f.textureId=d.texture.id),y(a)&&(f.textureId=a.id),y(n.verticalOffset)){const{screenLength:I,minWorldLength:G,maxWorldLength:W}=n.verticalOffset;f.verticalOffset={screenLength:Sa(I),minWorldLength:G||0,maxWorldLength:y(W)?W:1/0}}if(this._context.screenSizePerspectiveEnabled){const{screenSizePerspectiveSettings:I,screenSizePerspectiveSettingsLabels:G}=this._context.sharedResources;f.screenSizePerspective=G.overridePadding(this._textRenderParameters.haloSize+this._textRenderParameters.definition.background.padding[0]),f.screenSizePerspectiveAlignment=I}let _;if(l&&(f.shaderPolygonOffset=1e-4),f.hasSlicePlane=this._context.slicePlaneEnabled,y(s)){const I=JSON.stringify(f);_=s.get(I),C(_)&&(_=new uv(f),s.add(I,_))}else _=new uv(f);const g=[_],w=n.translation,v=y(u)?[u.displayWidth,u.displayHeight]:[0,0],b=n.centerOffset,x=[U3(LRe,w,null,v,b,[0,0],null)],T=this._context.layer.uid,R=A4(this._context,t,x,g,o,T,c);if(R===null)return null;const E=new uu(this,R.object,x,C(s)?g:null,d,_x,o);E.alignedSampledElevation=R.sampledElevation,E.needsElevationUpdates=Ql(o.mode)||o.mode==="absolute-height";const{displayWidth:O,displayHeight:$}=y(u)?u:n;E.getScreenSize=(I=Te())=>(I[0]=O,I[1]=$,I);const D={labelText:r,elevationOffset:n.elevationOffset};return E.metadata=D,yx(E,t,this._context.elevationProvider),E}};function yz(i,e,t){i&&i.forEach(r=>{const n=e(r);y(n)&&t(n,r.graphic)})}function DRe(i,e){if(e.verticalPlacement==="baseline"){const r=zSe[e.horizontalPlacement],n=y(i)?i.baselineAnchorY:0;return Qt(r,n)}const t=GSe(e.horizontalPlacement,e.verticalPlacement);return gE[t]}const FRe={mode:"relative-to-ground",offset:0},NRe={text:null,translation:[0,0,0],elevationOffset:0,centerOffset:[0,0,0,1],screenOffset:[0,0],horizontalPlacement:"center",verticalPlacement:"center",verticalOffset:null,centerOffsetUnits:null,debugDrawLabelBorder:!1,displayWidth:0,displayHeight:0},kRe={"calm-small":{waveStrength:.005,perturbationStrength:.02,textureRepeat:12,waveVelocity:.01},"rippled-small":{waveStrength:.02,perturbationStrength:.09,textureRepeat:32,waveVelocity:.07},"slight-small":{waveStrength:.05,perturbationStrength:.07,textureRepeat:28,waveVelocity:.1},"moderate-small":{waveStrength:.075,perturbationStrength:.07,textureRepeat:24,waveVelocity:.1},"calm-medium":{waveStrength:.003125,perturbationStrength:.01,textureRepeat:8,waveVelocity:.02},"rippled-medium":{waveStrength:.035,perturbationStrength:.015,textureRepeat:12,waveVelocity:.07},"slight-medium":{waveStrength:.06,perturbationStrength:.015,textureRepeat:8,waveVelocity:.12},"moderate-medium":{waveStrength:.09,perturbationStrength:.03,textureRepeat:4,waveVelocity:.12},"calm-large":{waveStrength:.01,perturbationStrength:0,textureRepeat:4,waveVelocity:.05},"rippled-large":{waveStrength:.025,perturbationStrength:.01,textureRepeat:8,waveVelocity:.11},"slight-large":{waveStrength:.06,perturbationStrength:.02,textureRepeat:3,waveVelocity:.13},"moderate-large":{waveStrength:.14,perturbationStrength:.03,textureRepeat:2,waveVelocity:.15}},VRe=["polyline","polygon","extent"];let b$=class Uf extends du{constructor(e,t,r,n){super(e,t,r,n)}async doLoad(){}destroy(){super.destroy(),this._context.stage.remove(this._material),this._material=null}createGraphics3DGraphic(e){const t=e.graphic;if(!this._validateGeometry(t.geometry,VRe,this.symbolLayer.type))return null;const r=this.setGraphicElevationContext(t,new Qc);return this.ensureDrapedStatus(r.mode==="on-the-ground"),this.ensureMaterial(),this.draped?this._createAsOverlay(t):this._createAs3DShape(t,r,t.uid)}ensureMaterial(){if(y(this._material))return;const e=new bK,t=this.symbolLayer.color;y(t)&&(e.color=ti.toUnitRGBA(t));const r=this._getCombinedOpacity(t,{hasIntrinsicColor:!0});e.color=[e.color[0],e.color[1],e.color[2],r],e.transparent=r<1||this.needsDrivenTransparentPass,e.waveDirection=y(this.symbolLayer.waveDirection)?Uf.headingVectorFromAngle(this.symbolLayer.waveDirection):Qt(0,0);const n=this.symbolLayer.waveStrength+"-"+this.symbolLayer.waterbodySize,s=kRe[n];e.waveStrength=s.waveStrength,e.waveTextureRepeat=s.textureRepeat,e.waveVelocity=s.waveVelocity,e.flowStrength=s.perturbationStrength,e.hasSlicePlane=this._context.slicePlaneEnabled,e.isDraped=this.draped,this._material=new vK(e),this._context.stage.add(this._material)}layerOpacityChanged(){if(C(this._material))return;const e=this._material.parameters.color,t=this._getCombinedOpacity(this.symbolLayer.color,{hasIntrinsicColor:!0}),r=t<1||this.needsDrivenTransparentPass;this._material.setParameters({color:[e[0],e[1],e[2],t],transparent:r})}layerElevationInfoChanged(e,t,r){const n=this._elevationContext.mode,s=sT(Uf.elevationModeChangeTypes,r,n);if(s!==Zi.UPDATE)return s;const a=Ql(n);return this.updateGraphics3DGraphicElevationInfo(e,t,()=>a)}slicePlaneEnabledChanged(){return y(this._material)&&this._material.setParameters({hasSlicePlane:this._context.slicePlaneEnabled}),!0}physicalBasedRenderingChanged(){return!0}pixelRatioChanged(){return!0}_createAs3DShape(e,t,r){const n=bx(e.geometry);if(C(n))return null;const s=F4(n,this._context.elevationProvider,this._context.renderCoordsHelper,t),a=s.position.length/3,o=new Float64Array(2*a),l=new URe(s,o);if(this._create3DShapeGeometries(l),this._logGeometryCreationWarnings(l.renderData,n.rings,"rings","WaterSymbol3DLayer"),l.outGeometries.length===0)return null;this._createUVCoordsFromVertices(l.uvCoords,l.renderData.mapPosition,a,this._context.elevationProvider.spatialReference);const c=new Bd({geometries:l.outGeometries,materials:l.outMaterials,transformations:l.outTransforms,castShadow:!1,metadata:{layerUid:this._context.layer.uid,graphicUid:r}}),u=new uu(this,c,l.outGeometries,null,null,GY,t);return u.alignedSampledElevation=l.renderData.sampledElevation,u.needsElevationUpdates=Ql(t.mode),u}_createUVCoordsFromVertices(e,t,r,n){const s=Hm(n);Uc(hp);for(let l=0;l<r;l++)rt(vz,t[3*l+0],t[3*l+1]),TD(hp,vz);$D(hp,hp,s);const a=hp[0]%Uf.unitSizeOfTexture,o=hp[1]%Uf.unitSizeOfTexture;qC[0]=hp[0]-a,qC[1]=hp[1]-o;for(let l=0;l<r;l++)e[2*l+0]=(t[3*l+0]*s-qC[0])/Uf.unitSizeOfTexture,e[2*l+1]=(t[3*l+1]*s-qC[1])/Uf.unitSizeOfTexture}_create3DShapeGeometries(e){const t=e.renderData.polygons,r=e.uvCoords;for(const{count:n,index:s,position:a,mapPosition:o,holeIndices:l}of t){if(y(this._context.clippingExtent)&&(Ii(up),Jo(up,o),!Lc(up,this._context.clippingExtent)))continue;const c=$w(o,l,3);if(c.length===0)continue;const u=new Float64Array(r.buffer,2*s*r.BYTES_PER_ELEMENT,2*n),d=l8({indices:c,attributeData:{position:a,uv0:u,mapPosition:o}});e.outGeometries.push(d),e.outMaterials.push(ft(this._material)),e.outTransforms.push(rn)}}_createAsOverlay(e){const t=bx(e.geometry);if(C(t))return null;ft(this._material).renderPriority=this._renderPriority;const r=TK(t,this._context.overlaySR),n=r.position.length/3,s=new Float64Array(2*n),a=new zRe(r,s,this._context.layer.uid,e.uid);return a.outBoundingBox=Ii(),this._createAsOverlayWater(a),this._logGeometryCreationWarnings(a.renderData,t.rings,"rings","WaterSymbol3DLayer"),a.outGeometries.length===0?null:(this._createUVCoordsFromVertices(a.uvCoords,a.renderData.position,n,this._context.overlaySR),new jP(this,a.outGeometries,a.outBoundingBox,this._context.drapeSourceRenderer))}_createAsOverlayWater(e){const t=e.uvCoords,r=e.renderData.polygons;for(const{position:n,holeIndices:s,index:a,count:o}of r){if(Ii(up),Jo(up,n),!Lc(up,this._context.clippingExtent))continue;Y0(e.outBoundingBox,up);const l=$w(n,s,3);if(l.length===0)continue;const c=new Float64Array(t.buffer,2*a*t.BYTES_PER_ELEMENT,2*o),u=l8({indices:l,attributeData:{position:n,uv0:c}}),d=new pv(u,ft(this._material),{layerUid:e.layerUid,graphicUid:e.graphicsUid}),m=up;Qs(d.boundingSphere,.5*(m[0]+m[3]),.5*(m[1]+m[4]),0,.5*Math.sqrt((m[3]-m[0])*(m[3]-m[0])+(m[4]-m[1])*(m[4]-m[1]))),e.outGeometries.push(d)}}static headingVectorFromAngle(e){const t=Te(),r=$R(e);return t[0]=Math.sin(r),t[1]=Math.cos(r),t}test(){return{...super.test(),create3DShape:e=>this._createAs3DShape(e.graphic,e.elevationContext,e.graphicUid),ensureMaterial:()=>this.ensureMaterial()}}};b$.unitSizeOfTexture=100,b$.elevationModeChangeTypes={definedChanged:Zi.RECREATE,staysOnTheGround:Zi.NONE,onTheGroundChanged:Zi.RECREATE};const qC=Te(),hp=Nt(),vz=Te(),up=Ms();let URe=class extends zP{constructor(e,t){super(e,null,null),this.uvCoords=t}},zRe=class extends zP{constructor(e,t,r,n){super(e,r,n),this.uvCoords=t}};function BRe(i,e,t,r){const n=bz[i.type]&&bz[i.type][e.type]||GRe[e.type];return n?new n(i,e,t,r):(ee.getLogger("esri.views.3d.layers.graphics.Graphics3DSymbolLayerFactory").error("GraphicsLayerFactory#make",`unknown symbol type ${e.type}`),null)}const GRe={icon:m$,object:m2e,line:kK,path:nRe,fill:oJ,extrude:ISe,text:$Re,water:b$},bz={"mesh-3d":{fill:UEe}};let HRe=class extends S4{constructor(e,t,r){super(t.schedule),this._symbol=e,this._context=t,this._backgroundLayers=r,this._destroyed=!1,this.symbolLayers=new Array,this.referenced=0,this._extentPadding=0}set symbol(e){this._symbol=e;for(let t=0;t<e.symbolLayers.length;t++){const r=this.symbolLayers[t];C(r)||(r.symbol=e,r.symbolLayer=e.symbolLayers.items[t])}}get symbol(){return this._symbol}async doLoad(e){let t=this._symbol.symbolLayers;this._extentPadding=0,this._backgroundLayers&&(t=this._backgroundLayers.concat(t));const r=t.length;for(;this.symbolLayers.length<t.length;)this.symbolLayers.push(null);this.symbolLayers.length=t.length;const n=[];for(let s=0;s<r;s++){const a=t.getItemAt(s);if(a.enabled===!1)continue;WC.renderPriority=1-(1+s)/r,WC.renderPriorityStep=1/r,WC.ignoreDrivers=a._ignoreDrivers;const o=BRe(this.symbol,a,this._context,WC);n.push(jte(e,()=>{this.symbolLayers[s]=null,o.destroy()})),this.symbolLayers[s]=o}await vD(this.symbolLayers,async(s,a)=>{if(y(s))try{await s.load(),this._extentPadding+=Math.max(this._extentPadding,s.extentPadding)}catch{this.symbolLayers[a]=null}});for(const s of n)s==null||s.remove();if(n.length=0,Ti(e),this.symbolLayers.length&&!this.symbolLayers.some(s=>!!s))throw new Error}getSymbolLayerSize(e){const t=this.symbolLayers[e];return y(t)?t.getCachedSize():null}get extentPadding(){return this._extentPadding}get symbologySnappingSupported(){return this.symbolLayers.some(e=>y(e)&&e.queryForSnapping)}createGraphics3DGraphic(e,t){const r=e.graphic,n=new Array(this.symbolLayers.length);for(let a=0;a<this.symbolLayers.length;a++){const o=this.symbolLayers[a];n[a]=y(o)?o.createGraphics3DGraphic(e):null}const s=this._context.arcade||this._context.featureExpressionInfoContext&&this._context.featureExpressionInfoContext.arcade&&this._context.featureExpressionInfoContext.arcade.modules||null;return new ECe(r,t||this,n,e.layer,s)}get complexity(){return P4(this.symbolLayers.map(e=>en(e,"complexity")))}globalPropertyChanged(e,t){const r=this.symbolLayers.length;for(let n=0;n<r;n++){const s=this.symbolLayers[n],a=o=>{const l=o.graphics[n];return l instanceof uu?l:null};if(y(s)&&!s.globalPropertyChanged(e,t,a))return!1}return!0}applyRendererDiff(e,t){return this.loadStatus!==jo.LOADED?Gr.Recreate_Symbol:this.symbolLayers.reduce((r,n)=>r!==Gr.Recreate_Symbol&&y(n)?Math.min(r,n.applyRendererDiff(e,t)):r,Gr.Fast_Update)}prepareSymbolPatch(e){if(this.loadStatus===jo.FAILED||e.diff.type!=="partial")return;const t=e.diff.diff;if(!t.symbolLayers||t.symbolLayers.type!=="partial")return;const r=t.symbolLayers.diff;this.symbolLayers.forEach((n,s)=>{if(C(n))return;const a=r[s];if(a){const o={diff:a,graphics3DGraphicPatches:[],symbolLayerStatePatches:[]};n.prepareSymbolLayerPatch(o),e.symbolStatePatches.push(...o.symbolLayerStatePatches),o.graphics3DGraphicPatches.length&&e.graphics3DGraphicPatches.push((l,c)=>{const u=l.graphics[s];y(u)&&o.graphics3DGraphicPatches.forEach(d=>d(u,c))})}})}updateGeometry(e,t){for(let r=0;r<this.symbolLayers.length;r++){const n=this.symbolLayers[r];if(C(n))continue;const s=e.graphics[r];if(C(s)||!n.updateGeometry(s,t))return!1}return!0}onRemoveGraphic(e){for(let t=0;t<this.symbolLayers.length;t++){const r=this.symbolLayers[t];if(C(r))continue;const n=e.graphics[t];y(n)&&r.onRemoveGraphic(n)}}getFastUpdateStatus(){let e=0,t=0,r=0;return this.symbolLayers.forEach(n=>{C(n)||(n.loadStatus===jo.LOADING?e++:n.isFastUpdatesEnabled()?r++:t++)}),{loading:e,slow:t,fast:r}}async queryForSnapping(e,t,r,n){const s=this.symbolLayers.filter(y).filter(o=>y(o.queryForSnapping)).map(o=>o.queryForSnapping(e,t,r,n)),a=await Promise.all(s);return Ti(n),a.flat()}destroy(){if(this.destroyed)console.error("Graphics3DSymbol.destroy called when already destroyed!");else{super.destroy();for(const e of this.symbolLayers)y(e)&&e.destroy();this.symbolLayers.length=0,this._destroyed=!0}}get destroyed(){return this._destroyed}};const WC={renderPriority:0,renderPriorityStep:1,ignoreDrivers:!1};let jRe=class extends S4{constructor(e,t,r){super(t),this.symbol=e,this._convert=r,this.symbologySnappingSupported=!1,this.graphics3DSymbol=null,this.referenced=0}getSymbolLayerSize(e){return y(this.graphics3DSymbol)?this.graphics3DSymbol.getSymbolLayerSize(e):null}get symbolLayers(){return y(this.graphics3DSymbol)?this.graphics3DSymbol.symbolLayers:[]}get extentPadding(){return y(this.graphics3DSymbol)?this.graphics3DSymbol.extentPadding:0}async doLoad(e){const t=await this.symbol.fetchSymbol({signal:e});t.id=this.symbol.id,this.graphics3DSymbol=this._convert(t),y(this.graphics3DSymbol)&&await this.graphics3DSymbol.load()}createGraphics3DGraphic(e){return y(this.graphics3DSymbol)?this.graphics3DSymbol.createGraphics3DGraphic(e,this):null}get complexity(){return y(this.graphics3DSymbol)?this.graphics3DSymbol.complexity:R4}globalPropertyChanged(e,t){return!!y(this.graphics3DSymbol)&&this.graphics3DSymbol.globalPropertyChanged(e,t)}applyRendererDiff(e,t){return y(this.graphics3DSymbol)?this.graphics3DSymbol.applyRendererDiff(e,t):Gr.Recreate_Symbol}prepareSymbolPatch(e){y(this.graphics3DSymbol)&&this.graphics3DSymbol.prepareSymbolPatch(e)}updateGeometry(e,t){return!!y(this.graphics3DSymbol)&&this.graphics3DSymbol.updateGeometry(e,t)}onRemoveGraphic(){}getFastUpdateStatus(){return y(this.graphics3DSymbol)?this.graphics3DSymbol.getFastUpdateStatus():{loading:1,fast:0,slow:0}}destroy(){y(this.graphics3DSymbol)&&this.graphics3DSymbol.destroy(),this.graphics3DSymbol=void 0,super.destroy()}get destroyed(){return this.graphics3DSymbol===void 0}};function B4(i){return i instanceof jRe?i.graphics3DSymbol:i instanceof HRe?i:null}const Tx=ee.getLogger("esri.views.3d.layers.graphics.labelPlacement");function qRe(i){const e=tPe(i);if(C(e))return null;const t=WRe(i,e);if(C(t))return null;const r=t.anchor,n=!!e.hasLabelVerticalOffset;return QRe({anchor:r,verticalOffset:e.verticalOffset,screenOffset:Te(),centerOffset:Bi(0,0,0,-1),centerOffsetUnits:"world",translation:P(),elevationOffset:0,hasLabelVerticalOffset:n},t,i)}function WRe(i,e){if(e.anchor)return e;const t=i.labelClass.labelPlacement,r=$c[t],n=r||fR(i);return t&&!r&&Tx.warnOncePerTick(`the requested label placement '${t}' is currently unsupported in SceneView.`),XRe(n,i)}function G4(i){const e=i.graphics3DGraphic.graphics3DSymbol,t=B4(e);return y(t)?t.symbol.symbolLayers.getItemAt(0):null}function XRe(i,e){const t=e.graphics3DGraphic.graphic.geometry;if(C(t))return null;if(y(e.disablePlacement))return e.labelClass.labelPlacement?(Tx.warnOncePerTick(wz(i.placement,e.disablePlacement.logEntityDescription)),fR(e)):i;const r=t.type;switch(r){case"polyline":case"polygon":case"extent":case"multipoint":if(e.labelClass.labelPlacement)return Tx.warnOncePerTick(wz(i.placement,`'${r}' geometries`)),fR(e);break;case"point":case"mesh":return i}return i}function wz(i,e){return`the requested label placement '${i}' is currently unsupported for ${e} in SceneView.`}function fR(i){const e=i.graphics3DGraphic.graphic.geometry;if(C(e))return null;switch(e.type){case"polyline":case"extent":case"multipoint":return{placement:"center-center",normalizedOffset:null,anchor:"center"};case"polygon":{const t=G4(i);return y(t)&&t.type==="extrude"?$c["above-center"]:{placement:"center-center",normalizedOffset:null,anchor:"center"}}case"point":case"mesh":return $c["above-center"];default:return}}function QRe(i,e,t){const r=t.graphics3DGraphic.graphic.geometry;if(C(r))return null;switch(r.type){case"point":YRe(i,e,t);break;case"polygon":ZRe(i,e,t);break;case"mesh":H4(i,e,t.graphics3DGraphic.graphics[0])}return i}function ZRe(i,e,t){const r=G4(t);if(!C(r))switch(r.type){case"extrude":{const n=t.graphics3DGraphic.graphics[0];y(n)?(n.getBoundingBoxObjectSpace(cw),Ic(cw,i.translation),i.translation[2]=tF(cw)/2):Y(i.translation,0,0,0),H4(i,e,n);break}}}function YRe(i,e,t){const r=G4(t);if(C(r))return;const n=t.graphics3DGraphic.graphics[0];switch(y(n)?n.getCenterObjectSpace(i.translation):Y(i.translation,0,0,0),r.type){case"icon":case"text":KRe(i,e,t,n);break;case"object":H4(i,e,n)}}function KRe(i,e,t,r){const{graphics3DGraphic:n}=t,s=y(r)?r.getScreenSize():null;if(!n.isDraped&&y(s)){const a=JRe(t);T1[0]=s[0]/2*(e.normalizedOffset[0]-a[0]),T1[1]=s[1]/2*(e.normalizedOffset[1]-a[1]),i.screenOffset[0]=T1[0],i.hasLabelVerticalOffset?(i.centerOffset[1]=T1[1],i.centerOffsetUnits="screen"):i.screenOffset[1]=T1[1]}else i.hasLabelVerticalOffset||i.anchor==="center"||($c[t.labelClass.labelPlacement]&&Tx.warnOncePerTick(`the requested placement '${e.placement}' is currently unsupported for draped graphics`),i.anchor="center")}function JRe(i,e=iPe){const{graphics3DGraphic:t}=i,r=t.graphics[0],n=y(r)?r.stageObject.geometryRecords[0].material:null;if(n&&n instanceof uv){const s=n.parameters.anchorPosition;e[0]=2*(s[0]-.5),e[1]=2*(s[1]-.5)}else e[0]=0,e[1]=0;return e}function H4(i,e,t){const r=y(t)?t.getBoundingBoxObjectSpace(cw):cw,n=Ze(r[3]-r[0],r[4]-r[1],r[5]-r[2]),s=Math.sqrt(n[0]*n[0]+n[1]*n[1]);i.centerOffset[0]=s/2*e.normalizedOffset[0];const a=i.translation[2],o=n[2]/2*e.normalizedOffset[1];i.translation[2]=0,i.elevationOffset=a+o;const l=we(n);i.centerOffset[2]=l/2*e.normalizedOffset[2]}function ePe(i){return i==="above-center"}function tPe(i){const e=i.labelClass.labelPlacement,{labelSymbol:t,graphics3DGraphic:r}=i,n=B4(r.graphics3DSymbol),s=co(n,o=>o.symbol.type==="point-3d"?o.symbol:null),a=$c[e]||fR(i);return y(s)&&s.supportsCallout()&&s.hasVisibleVerticalOffset()&&!r.isDraped?{placement:null,hasLabelVerticalOffset:!1,verticalOffset:xz(s.verticalOffset),anchor:null,normalizedOffset:null}:t&&t.hasVisibleVerticalOffset()&&(C(s)||!s.supportsCallout()||!s.verticalOffset||r.isDraped)?ePe(a.placement)?{placement:"above-center",verticalOffset:xz(t.verticalOffset),anchor:"bottom",normalizedOffset:[0,a.normalizedOffset[1],0],hasLabelVerticalOffset:!0}:(Tx.errorOncePerTick("Callouts and vertical offset on labels are currently only supported with 'above-center' label placement (not with "+e+" placement)"),null):{placement:null,verticalOffset:null,anchor:null,normalizedOffset:null,hasLabelVerticalOffset:!1}}function xz(i){const{screenLength:e,minWorldLength:t,maxWorldLength:r}=i;return{screenLength:e,minWorldLength:t,maxWorldLength:r}}const $c={"above-center":{placement:"above-center",normalizedOffset:[0,1,0],anchor:"bottom"},"above-left":{placement:"above-left",normalizedOffset:[-1,1,0],anchor:"bottom-right"},"above-right":{placement:"above-right",normalizedOffset:[1,1,0],anchor:"bottom-left"},"below-center":{placement:"below-center",normalizedOffset:[0,-1,2],anchor:"top"},"below-left":{placement:"below-left",normalizedOffset:[-1,-1,0],anchor:"top-right"},"below-right":{placement:"below-right",normalizedOffset:[1,-1,0],anchor:"top-left"},"center-center":{placement:"center-center",normalizedOffset:[0,0,1],anchor:"center"},"center-left":{placement:"center-left",normalizedOffset:[-1,0,0],anchor:"right"},"center-right":{placement:"center-right",normalizedOffset:[1,0,0],anchor:"left"}},Tz={"above-center":["default","esriServerPointLabelPlacementAboveCenter"],"above-left":["esriServerPointLabelPlacementAboveLeft"],"above-right":["esriServerPointLabelPlacementAboveRight"],"below-center":["esriServerPointLabelPlacementBelowCenter"],"below-left":["esriServerPointLabelPlacementBelowLeft"],"below-right":["esriServerPointLabelPlacementBelowRight"],"center-center":["esriServerPointLabelPlacementCenterCenter"],"center-left":["esriServerPointLabelPlacementCenterLeft"],"center-right":["esriServerPointLabelPlacementCenterRight"]};for(const i in Tz){const e=Tz[i],t=$c[i];e.forEach(r=>{$c[r]=t})}Object.freeze&&(Object.freeze($c),Object.keys($c).forEach(i=>{Object.freeze($c[i]),Object.freeze($c[i].normalizedOffset)}));const T1=[0,0],iPe=[0,0],cw=Ms();let Cz=class{constructor(e){this._stage=e,this._materials=new Map}get(e){return this._materials.get(e)}add(e,t){this._materials.set(e,t),this._stage.add(t)}dispose(){this._stage.removeMany(Array.from(this._materials.values())),this._materials.clear()}};const FM=512,NM=4096,rPe=.85,nPe=.95;let gb=class extends pe{constructor(e){super(e),this.type=vv.Texture,this.id=Sm(),this.events=new nn,this._glTexture=null,this._needsClear=!1,this._elementsToAddOrUpdate=new Map,this._elementsToRemove=new Map,this._elementsToRender=new Map,this._elements=new Map,this._stageObjects=new Map,this.updating=!1}initialize(){this._stage=this.view._stage,this._canvas=this._create2DCanvas(),this._ctx=this._canvas.getContext("2d"),this._stage.add(this);const e=this._computeAtlasResolution(this.view.width,this.view.height);this._createAtlasRegion(e),this._update2DCanvasSize(),this._resetAtlasCursor()}unload(){this._glTexture=ke(this._glTexture),this.updating=!1,this.events.emit("unloaded")}get width(){return this._atlas.size.width}get height(){return this._atlas.size.height}get requiresFrameUpdates(){return!1}_createDescriptor(e){return{target:bi.TEXTURE_2D,pixelFormat:St.RGBA,dataType:Xt.UNSIGNED_BYTE,wrapMode:ai.CLAMP_TO_EDGE,flipped:!0,samplingMode:Jt.LINEAR_MIPMAP_LINEAR,hasMipmap:!0,preMultiplyAlpha:!0,maxAnisotropy:e.parameters.maxMaxAnisotropy}}get glTexture(){return this._glTexture}load(e){return y(this._glTexture)||(this._glTexture=new Gi(e,this._createDescriptor(e),this._canvas),this._frameWorker=this.view.resourceController.scheduler.registerTask(dr.TEXT_TEXTURE_ATLAS,this),this.setDirty()),this._glTexture}dispose(){this._elements=null,this._elementsToAddOrUpdate=null,this._elementsToRemove=null,this._elementsToRender=null,this._frameWorker=Os(this._frameWorker),this._glTexture&&(this._stage.remove(this),this._glTexture=ke(this._glTexture)),this._canvas.width=0,this._canvas.height=0,this._canvas=null,this._ctx=null}_create2DCanvas(){const e=document.createElement("canvas");return e.setAttribute("id","canvas2d"),e.setAttribute("style","display:none"),e.setAttribute("width",FM.toString()),e.setAttribute("height",FM.toString()),e}_update2DCanvasSize(){this._canvas.setAttribute("width",this._atlas.size.width.toString()),this._canvas.setAttribute("height",this._atlas.size.height.toString())}_createAtlasRegion(e=FM){this._atlas={size:{width:e,height:e},cursor:{x:0,y:0},lineHeight:0}}_computeAtlasResolution(e,t){let r=Math.max(e,t);return r+=256,r=lD(r),r=Math.min(r,NM),r}_resizeAtlas(e,t){t=t||e;const r=this._atlas;r.size.width=e,r.size.height=t,y(this._glTexture)&&this._glTexture.resize(e,t),this._update2DCanvasSize()}_resetAtlasCursor(){const e=this._atlas;e.cursor.x=C1,e.cursor.y=C1+Sz,e.lineHeight=0,this._needsClear=!0}_getAtlasUsage(){const e=this._atlas;return(e.cursor.x+e.cursor.y*e.size.width)/(e.size.width*e.size.height)}_getExpectedAtlasUsage(){const e=this._elementsToRemove.size,t=this._elementsToAddOrUpdate.size,r=this._elements.size;return this._getAtlasUsage()/r*(r+t-e)}_addAtlasElement(e,t,r,n){const s=this._atlas,{renderedWidth:a,renderedHeight:o,displayWidth:l,displayHeight:c}=e.textRenderer;e.placement.offset.x=s.cursor.x,e.placement.offset.y=s.cursor.y,e.placement.size.width=a,e.placement.size.height=o,e.placement.size.displayWidth=l,e.placement.size.displayHeight=c,e.placement.uvMinMax=[e.placement.offset.x/s.size.width,1-(e.placement.offset.y+o)/s.size.height,(e.placement.offset.x+a)/s.size.width,1-e.placement.offset.y/s.size.height],s.cursor.x+=r,s.lineHeight=Math.max(s.lineHeight,n),this._elements.set(t,e)}_removeAtlasElement(e){if(e&&this._elements.has(e.textId)){const t=e.placement.offset,r=e.placement.size;this._ctx.clearRect(t.x,t.y,r.width,r.height),this._elements.delete(e.textId)}}_ensureStageObjects(e){const t=this._stageObjects.get(e);if(t)return t;const r=new Set;return this._stageObjects.set(e,r),r}_addStageObject(e,t){this._ensureStageObjects(e).add(t)}_removeStageObject(e,t){const r=this._stageObjects.get(e);r&&r.delete(t)&&(t.geometries[0].vertexAttributes.get(S.SIZE).data=[0,0],t.geometryVertexAttrsUpdated(t.geometryRecords[0]))}_processAddition(e,t){const r=this._atlas,n=e.textId,s=e.textRenderer.renderedWidth,a=e.textRenderer.renderedHeight,o=s+C1,l=a+C1+Sz;if(r.cursor.x+o<r.size.width&&r.cursor.y+l<r.size.height)this._addAtlasElement(e,n,o,l),this._elementsToRender.set(n,e),this._elementsToAddOrUpdate.delete(n);else{if(!(r.cursor.y+l+r.lineHeight<r.size.height)){const c=this._getExpectedAtlasUsage(),u=c>rPe&&r.size.width<NM;return u&&this._resizeAtlas(2*r.size.width,2*r.size.height),!t||!u&&c>nPe&&r.size.width===NM?(this._processRemovals(),b0.OK):(this._repack(),b0.REPACK)}r.cursor.x=C1,r.cursor.y+=r.lineHeight,r.lineHeight=0,this._addAtlasElement(e,n,o,l),this._elementsToRender.set(n,e),this._elementsToAddOrUpdate.delete(n)}return b0.OK}_processRemovals(){this._elementsToRemove.forEach((e,t)=>{const r=this._stageObjects.get(t);r&&r.size!==0||this._removeAtlasElement(e),r&&r.size===0&&this._stageObjects.delete(t)}),this._elementsToRemove.clear()}_repack(){this._processRemovals(),this._elements.forEach((e,t)=>{e.rendered=!1,this._elementsToAddOrUpdate.set(t,e)}),this._elements.clear(),this._resetAtlasCursor(),this._elementsToRender.clear()}_processRenderingRequest(e){this._ctx.clearRect(e.placement.offset.x,e.placement.offset.y,e.placement.size.width,e.placement.size.height),e.textRenderer.render(this._ctx,e.placement.offset.x,e.placement.offset.y);const t=this._stageObjects.get(e.textId);t&&t.forEach(r=>{r.geometries[0].vertexAttributes.get(S.UV0).data=new Float32Array(e.placement.uvMinMax),r.geometries[0].vertexAttributes.get(S.SIZE).data=[e.placement.size.displayWidth,e.placement.size.displayHeight],r.geometryVertexAttrsUpdated(r.geometryRecords[0])}),e.rendered=!0}get running(){return this.updating}runTask(e,t=!0){if(!this._glTexture)return;let r=!1;if(Er(this._elementsToAddOrUpdate,(s,a)=>{const o=this._elements.get(a);if(o&&o.rendered){const l=this._stageObjects.get(a);return l&&l.forEach(c=>{const u=c.geometries[0].vertexAttributes,d=this._elements.get(a);u.get(S.UV0).data=new Float32Array(d.placement.uvMinMax),u.get(S.SIZE).data=new Float32Array([d.placement.size.displayWidth,d.placement.size.displayHeight]),c.geometryVertexAttrsUpdated(c.geometryRecords[0])}),this._elementsToAddOrUpdate.delete(a),!1}return this._processAddition(this._elementsToAddOrUpdate.get(a),t)===b0.REPACK&&(r=!0,!0)}),r)return void this.runTask(LR,!1);let n=!1;this._elementsToRender.size>0&&this._needsClear&&(this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._needsClear=!1),Er(this._elementsToRender,(s,a)=>(this._processRenderingRequest(s),this._elementsToRender.delete(a),n=!0,e.madeProgress(),e.done)),n&&y(this._glTexture)&&this._glTexture.setData(this._canvas),this.updating=this._elementsToRender.size>0,!this.updating&&UCe.orderedRepackingEnabled&&this.repackOrdered()}addTextTexture(e,t){const r=e.key;this._elementsToAddOrUpdate.has(r)||this._elementsToAddOrUpdate.set(r,{textId:r,placement:{offset:{x:0,y:0},size:{width:0,height:0,displayWidth:0,displayHeight:0},uvMinMax:[]},textRenderer:e,rendered:!1}),this._addStageObject(r,t),this._elementsToRemove.delete(r),this.setDirty()}removeTextTexture(e,t){const r=e.key;this._elementsToRemove.set(r,this._elements.get(r)),this._removeStageObject(r,t)}setDirty(){this._glTexture&&(this.updating=!0)}repackOrdered(){if(this._elements.size===0)return;const e=[];this._elements.forEach((r,n)=>e.push({element:r,key:n}));let t=!0;for(let r=0;r<e.length-1;r++)if(e[r].key.localeCompare(e[r+1].key)>0){t=!1;break}if(!t||this._elementsToRemove.size){e.sort((r,n)=>r.key.localeCompare(n.key)),this._elements.clear();for(const{element:r,key:n}of e)this._elements.set(n,r);this._repack(),this.setDirty()}}get test(){const{_elements:e,_stageObjects:t,_elementsToRemove:r,_atlas:n}=this,s=this;return{elements:e,stageObjects:t,elementsToRemove:r,atlas:n,_resizeAtlas:(a,o)=>s._resizeAtlas(a,o),run:(a,o)=>s.runTask(a,o)}}};h([p({constructOnly:!0})],gb.prototype,"view",void 0),h([p({type:Boolean})],gb.prototype,"updating",void 0),gb=h([F("esri.views.3d.webgl-engine.lib.TextTextureAtlas")],gb);const C1=2,Sz=2;var b0;(function(i){i[i.OK=0]="OK",i[i.REPACK=1]="REPACK"})(b0||(b0={}));let zf=class extends pe{constructor(e){super(e),this._dirty=!1,this._labels=new Map,this._labelsToAdd=new Map,this._labelsToRemove=new Map,this._labelingContexts=new Array}setup(){this.dispose(),this._handles=new Vt,this._handles.add([B(()=>{var e;return(e=this.view.state)==null?void 0:e.camera},()=>this.setDirty()),B(()=>{var e;return(e=this.view.state)==null?void 0:e.pixelRatio},()=>this._resetAllLabels()),this.view.resourceController.scheduler.registerTask(dr.LABELER,this)]),this._textTextureAtlas=new gb({view:this.view}),this._hudMaterialCollection=new Cz(this.view._stage),this._calloutMaterialCollection=new Cz(this.view._stage)}dispose(){this._handles=Oe(this._handles),this._textTextureAtlas=ke(this._textTextureAtlas),this._hudMaterialCollection=ke(this._hudMaterialCollection),this._calloutMaterialCollection=ke(this._calloutMaterialCollection),this._labelingContexts.length=0,this._labels.clear(),this._labelsToAdd.clear(),this._labelsToRemove.clear()}_activateLabelingContext(e){e.labels.forEach((t,r)=>{this._labels.set(r,t),t.graphics3DGraphic.setVisibilityFlag(Qo.USER_SETTING,!0,$n.LABEL)}),e.active=!0}_deactivateLabelingContext(e){e.labels.forEach((t,r)=>{t.graphics3DGraphic.setVisibilityFlag(Qo.USER_SETTING,!1,$n.LABEL),this.setLabelGraphicVisibility(t.graphics3DGraphic,!1),this._labels.delete(r)}),e.active=!1}_addLabelTextureToAtlas(e){for(const t of e.graphics3DGraphic.labelGraphics){if(!t._labelClass)continue;const r=e.textTextureResources.textRenderers[t._labelIndex];y(r)&&this._textTextureAtlas.addTextTexture(r,t.stageObject)}e.rendered=!0}_removeLabelTextureFromAtlas(e){for(const t of e.graphics3DGraphic.labelGraphics){if(!t._labelClass)continue;const r=e.textTextureResources.textRenderers[t._labelIndex];y(r)&&this._textTextureAtlas.removeTextTexture(r,t.stageObject)}e.rendered=!1}get running(){var e;return this.view.ready&&(this._dirty||((e=this._textTextureAtlas)==null?void 0:e.updating)||this.deconflictor.running)}runTask(e){this._updateLabels(e),!this._dirty&&this.deconflictor.running&&this.deconflictor.runTask(e)}_updateLabels(e){if(this._dirty){this._dirty=!1;for(const t of this._labelingContexts)if(sPe(t)){if(!Ez(t)){if(aPe(t)){this._deactivateLabelingContext(t);continue}if(this._createLabelClassContext(t),kM(t)){this._dirty=!0;continue}if(!Ez(t))continue}Er(t.labelsToInitialize,(r,n)=>(this._ensureGraphics3DResources(r)&&(this._labels.set(n,r),this.deconflictor.setDirty(),e.madeProgress()),(r.visible&&r.textTextureResources.initialized||!r.visible&&r.hasGraphics3DResources)&&(t.labelsToInitialize.delete(n),e.madeProgress()),e.done))&&(this._dirty=!0)}this._labelsToRemove.forEach(t=>this._removeLabelTextureFromAtlas(t)),this._labelsToAdd.forEach(t=>this._addLabelTextureToAtlas(t)),this._labelsToRemove.clear(),this._labelsToAdd.clear(),this._dirty||this.notifyChange("updating")}}async _createLabelClassContextAsync(e){const t=e.labelClassAbortController.signal;await e.layer.when(),Ti(t),e.scaleVisibility&&e.scaleVisibility.updateScaleRangeActive();const r=e.graphics3DCore,n=r.layer,s=n.labelingInfo&&n.labelingInfo.filter(l=>!!l.symbol);if(!s||s.length===0)return;const a=new Array(s.length);let o=!1;await vD(s,async(l,c)=>{const u=l.symbol,d=B4(r.getOrCreateGraphics3DSymbol(u));if(C(d))return void ee.getLogger(this.declaredClass).error("Failed to create Graphics3DSymbol for label");await d.load(),Ti(t);let m=null;mD(u)&&u.hasVisibleCallout()&&(m=xCe(u,r.symbolCreationContext),await m.load(),Ti(t));const f=await bw(aae(l,e.layer.fieldsIndex,this.view.spatialReference));if(Ti(t),f.ok===!0){const _=await this._createTextRenderParameters(d.symbol);Ti(t),a[c]={labelClass:l,labelFunction:f.value,graphics3DSymbol:d,graphics3DCalloutSymbolLayer:m,calloutSymbolLayerIndex:0,textRenderParameters:_}}else ee.getLogger(this.declaredClass).error(`Label expression failed to evaluate: ${f.error}`),o=!0}),Ti(t),o||(e.labelClassContexts=a)}async _createLabelClassContext(e){return e.labelClassPromise||(e.labelClassPromise=this._createLabelClassContextAsync(e).catch(t=>{if(yo(t))throw t;e.labelClassContexts=null}).then(()=>{e.labelClassAbortController=null,this.notifyChange("updating")}).catch(()=>{}),this.notifyChange("updating")),e.labelClassPromise}async _createTextRenderParameters(e){const t=e.symbolLayers.getItemAt(0);return t&&t.type==="text"?cJ.fromSymbol(t,this.view.state.pixelRatio):null}_destroyLabelClassContext(e){for(const r of e.labelClassContexts)--r.graphics3DSymbol.referenced,r.graphics3DSymbol=null;const t=e.labelClassAbortController;e.labelClassAbortController=new AbortController,t&&t.abort(),e.labelClassContexts=[],e.labelClassPromise=null,this.notifyChange("updating")}_createTextSymbolGraphic(e,t,r,n,s){const a={text:e.text,centerOffset:r.centerOffset,translation:r.translation,elevationOffset:r.elevationOffset,screenOffset:r.screenOffset,centerOffsetUnits:r.centerOffsetUnits,horizontalPlacement:B8(r.anchor),verticalPlacement:BSe(r.anchor),verticalOffset:r.verticalOffset,debugDrawLabelBorder:Wt.LABELS_SHOW_BORDER,displayWidth:e.displayWidth,displayHeight:e.displayHeight};return dp.graphic=t,dp.renderingInfo=null,dp.layer=n,s.createLabel(dp,a,this._hudMaterialCollection,this._textTextureAtlas)}_createLineCalloutGraphic(e,t,r,n,s){const a={symbol:t,translation:n.translation,elevationOffset:n.elevationOffset,screenOffset:n.screenOffset,centerOffset:n.centerOffset,centerOffsetUnits:n.centerOffsetUnits,materialCollection:this._calloutMaterialCollection};return dp.graphic=e,dp.renderingInfo=a,dp.layer=s,r.createGraphics3DGraphic(dp)}_ensureGraphics3DResources(e){if(e.hasGraphics3DResources)return!1;const t=e.graphics3DGraphic;if(t.destroyed)return!1;this._ensureTextTextureResources(e);const{textTextureResources:r}=e,n=e.labelingContext,s=n.labelClassContexts;if(!s||s.length===0||!n.emptySymbolLabelSupported&&t.graphics.length===0)return!1;let a=!1;const o=t.graphic,l=n.layer,c=FI(n.layer),u=this.view._stage;for(let d=0;d<s.length;d++){const m=r.textRenderers[d],f=r.labelPlacements[d];if(C(m)||C(f))continue;const _=s[d],g=_.graphics3DSymbol,w=g.symbol&&g.symbol.type==="label-3d"?g.symbol:null,v=g.symbolLayers[0];if(!v)continue;v.setElevationInfoOverride(n.elevationInfoOverride);const b=this._createTextSymbolGraphic(m,o,f,l,v);if(!b)return!1;b._labelClass=_.labelClass,b._labelIndex=d,t.addLabelGraphic(b,u,n.stageLayer),t.setVisibilityFlag(Qo.USER_SETTING,c,$n.LABEL),t.clearVisibilityFlag(Qo.SCALE_RANGE,$n.LABEL),t.setVisibilityFlag(Qo.DECONFLICTION,!1,$n.LABEL),a=!0;const x=_.graphics3DCalloutSymbolLayer;if(x&&f.hasLabelVerticalOffset){x.setElevationInfoOverride(n.elevationInfoOverride);const T=this._createLineCalloutGraphic(o,w,x,f,l);y(T)&&(_.calloutSymbolLayerIndex=t.labelGraphics.length,t.addLabelGraphic(T,u,n.stageLayer))}break}return n.scaleVisibility&&a&&n.scaleVisibility.updateGraphicLabelScaleVisibility(t),e.hasGraphics3DResources=!0,!0}_destroyGraphics3DResources(e){const t=e.labelingContext.labelClassContexts;for(const r of e.graphics3DGraphic.labelGraphics){if(r._labelClass==null)continue;const n=t[r._labelIndex].graphics3DSymbol.symbolLayers[0];n!=null&&n.onRemoveGraphic(r)}e.graphics3DGraphic.clearLabelGraphics(),e.hasGraphics3DResources=!1}_ensureTextTextureResources(e){const{textTextureResources:t}=e;if(t.initialized)return;const r=e.labelingContext,n=r.labelClassContexts;if(!n||n.length===0)return;const s=e.graphics3DGraphic.graphic;for(let a=0;a<n.length;a++){const o=n[a];if(t.textRenderers[a]=null,t.labelPlacements[a]=null,!o.textRenderParameters)continue;const l=o.labelFunction;let c;if(l.type==="arcade")try{const b=l.needsHydrationToEvaluate()?kTe(s,r.layer):s;c=l.evaluate(b)}catch{c=null}else c=l.evaluate(s);if(C(c)||c===""||/^\s+$/.test(c))continue;const u=o.graphics3DSymbol,d=u.symbol&&u.symbol.type==="label-3d"?u.symbol:null;if(!u.symbolLayers[0])continue;const m=e.graphics3DGraphic,f=o.labelClass,_=r.disablePlacement,g=qRe({graphics3DGraphic:m,labelSymbol:d,labelClass:f,disablePlacement:_});if(C(g))continue;const w=B8(g.anchor),v=AK(w);t.textRenderers[a]=new RK(c,v,o.textRenderParameters),t.labelPlacements[a]=g}t.initialized=!0}_destroyTextTextureResources(e){const{textTextureResources:t}=e;t.initialized=!1,t.textRenderers=[],t.labelPlacements=[]}_addGraphic(e,t){const r={hasGraphics3DResources:!1,visible:!1,rendered:!1,labelingContext:e,graphics3DGraphic:t,textTextureResources:{initialized:!1,textRenderers:[],labelPlacements:[]}},n=t.graphic.uid;e.labels.set(n,r),e.labelsToInitialize.set(n,r),this.setDirty(),this.deconflictor.setDirty()}_removeGraphic(e,t){const r=t.graphic.uid,n=e.labels.get(r);n&&(this._destroyGraphic(n,r),e.labels.delete(r),e.labelsToInitialize.delete(r),this.setDirty(),this.deconflictor.setDirty())}_destroyGraphic(e,t){this._labels.has(t)&&(this._labels.delete(t),this._labelsToAdd.delete(t),this._labelsToRemove.delete(t)),e.textTextureResources.initialized&&(this._removeLabelTextureFromAtlas(e),this._destroyTextTextureResources(e)),e.hasGraphics3DResources&&this._destroyGraphics3DResources(e)}async _labelingInfoChange(e,t){if(!t)return this._visibilityInfoChange(e),this._resetLabels(e),this._createLabelClassContext(e);for(const r of t){const n=e.labels.get(r);n&&(this._removeGraphic(e,n.graphics3DGraphic),this._addGraphic(e,n.graphics3DGraphic))}}_globalPropertyChanged(e,t){for(const r of t.labelClassContexts){const n=new Map;t.labels.forEach(a=>{const o=a.graphics3DGraphic;n.set(o.graphic.uid,o)});const s=a=>a.labelGraphics[0];if(ft(r.graphics3DSymbol.symbolLayers[0]).globalPropertyChanged(e,n,s),r.graphics3DCalloutSymbolLayer){const a=o=>o.labelGraphics[r.calloutSymbolLayerIndex];r.graphics3DCalloutSymbolLayer.globalPropertyChanged(e,n,a)}}}_visibilityInfoChange(e){const t=e.layer.labelsVisible;t&&!e.active&&this._activateLabelingContext(e),!t&&e.active&&this._deactivateLabelingContext(e),this.setDirty()}_resetAllLabels(){for(const e of this._labelingContexts)this._resetLabels(e)}_resetLabels(e){e.labels.forEach((t,r)=>{this._destroyGraphic(t,r),t.visible=!1,t.rendered=!1,e.labelsToInitialize.set(r,t)}),this._destroyLabelClassContext(e),this.setDirty(),this.deconflictor.setDirty()}_findLabelingContext(e){for(const t of this._labelingContexts)if(t.graphics3DCore===e)return t;return null}addGraphicsOwner(e,t,r){const n=r&&r.emptySymbolLabelSupported||!1,s=r&&r.elevationInfoOverride||null,a=r&&r.disablePlacement||null;if(this._findLabelingContext(e))return;const o=e.layer,l={graphics3DCore:e,layer:o,scaleVisibility:t,emptySymbolLabelSupported:n,elevationInfoOverride:s,disablePlacement:a,active:o.labelsVisible,labelClassPromise:null,labelClassAbortController:new AbortController,labelClassContexts:[],labels:new Map,labelsToInitialize:new Map,stageLayer:new oK({isPickable:!0},o.uid)};return this.view._stage.add(l.stageLayer),this._labelingContexts.push(l),this.setDirty(),{addGraphic:c=>this._addGraphic(l,c),removeGraphic:c=>this._removeGraphic(l,c),featureReductionChange:()=>{},layerLabelsEnabled:()=>FI(l.layer),labelingInfoChange:c=>this._labelingInfoChange(l,c),elevationInfoChange:()=>this._globalPropertyChanged("elevationInfo",l),slicePlaneEnabledChange:()=>this._globalPropertyChanged("slicePlaneEnabled",l),visibilityInfoChange:()=>this._visibilityInfoChange(l),reset:()=>this._resetLabels(l),clear:()=>{}}}removeGraphicsOwner(e){const t=this._findLabelingContext(e);if(!t)return;const r=this._labelingContexts.indexOf(t);this._labelingContexts.splice(r,1),t.labels.forEach(n=>this._removeGraphic(t,n.graphics3DGraphic)),this.view._stage.remove(t.stageLayer),t.stageLayer=null,this.setDirty()}setLabelGraphicVisibility(e,t){const r=e.graphic.uid,n=this._labels.get(r);n&&n.visible!==t&&(t&&!n.rendered?(this._labelsToAdd.set(r,n),this._labelsToRemove.delete(r),n.textTextureResources.initialized||n.labelingContext.labelsToInitialize.set(r,n)):!t&&n.rendered&&(this._labelsToRemove.set(r,n),this._labelsToAdd.delete(r)),n.visible=t,this.setDirty())}setDirty(){!this._dirty&&this._labelingContexts.length>0&&(this._dirty=!0,this.notifyChange("updating"))}get updating(){var e;return this._dirty||((e=this._textTextureAtlas)==null?void 0:e.updating)||this.deconflictor.updating||this._labelingContexts.some(t=>kM(t))}get updatingProgress(){if(!this.updating||!this._textTextureAtlas)return 1;const e=this._labelingContexts.length>0?this._labelingContexts.reduce((t,r)=>t+(kM(r)?0:1),0)/this._labelingContexts.length:1;return(this._dirty?0:.3)+(this._textTextureAtlas.updating?0:.1)+.1*e+.5*this.deconflictor.updatingProgress}get test(){return{textTextureAtlas:this._textTextureAtlas,resetAllLabels:()=>this._resetAllLabels()}}};function sPe(i){return i.active&&FI(i.layer)}function kM(i){return i.labelClassPromise&&!!i.labelClassAbortController}function Ez(i){return i.labelClassContexts&&i.labelClassContexts.length}function aPe(i){return i.labelClassContexts===null}h([p({constructOnly:!0})],zf.prototype,"view",void 0),h([p({constructOnly:!0})],zf.prototype,"deconflictor",void 0),h([p()],zf.prototype,"_textTextureAtlas",void 0),h([p({type:Boolean,readOnly:!0})],zf.prototype,"updating",null),zf=h([F("esri.views.3d.layers.graphics.Labeler")],zf);const dp=new CCe(null,null,null);let _b=class Ly{constructor(e,t,r,n=null){this.lij=[0,0,0],this.extent=Nt(),this.resolution=0,this.loadPriority=0,this.measures={visibility:ws.VISIBLE_ON_SURFACE,screenRect:Nt(),distance:0,shouldSplit:!1},this.used=!1,n&&this.acquire(e,t,r,n)}acquire(e,t,r,n){this.tilingScheme=n,this.id=Ly.id(e,t,r),this.lij[0]=e,this.lij[1]=t,this.lij[2]=r,n.getExtent(e,t,r,this.extent),this.resolution=n.resolutionAtLevel(e)}release(){this.tilingScheme=null}getChildren(e){const t=this.lij[0]+1,r=2*this.lij[1],n=2*this.lij[2];return e?(e[0].acquire(t,r,n,this.tilingScheme),e[1].acquire(t,r+1,n,this.tilingScheme),e[2].acquire(t,r,n+1,this.tilingScheme),e[3].acquire(t,r+1,n+1,this.tilingScheme),e):[new Ly(t,r,n,this.tilingScheme),new Ly(t,r+1,n,this.tilingScheme),new Ly(t,r,n+1,this.tilingScheme),new Ly(t,r+1,n+1,this.tilingScheme)]}copyMeasurementsFrom(e){this.measures.visibility=e.measures.visibility,this.measures.shouldSplit=e.measures.shouldSplit,this.measures.distance=e.measures.distance,xw(e.measures.screenRect,this.measures.screenRect)}static id(e,t,r){return`${e}/${t}/${r}`}};var ws;(function(i){i[i.INVISIBLE=0]="INVISIBLE",i[i.VISIBLE_WHEN_EXTENDED=1]="VISIBLE_WHEN_EXTENDED",i[i.VISIBLE_ON_SURFACE=2]="VISIBLE_ON_SURFACE"})(ws||(ws={}));const uJ=.5*Math.PI,oPe=uJ/Math.PI*180;let lPe=class{constructor(e){this._renderCoordsHelper=e.renderCoordsHelper,this._extent=new Array(4),this._planes=new Array(6),this._maxSpan=0,this._center={origin:P(),direction:P()};for(let t=0;t<4;t++)this._extent[t]={origin:P(),direction:P(),cap:{next:null,direction:P()}},this._planes[t]=fr();this._planes[hr.NEAR]=fr(),this._planes[hr.FAR]=fr(),this._planesWithoutFar=this._planes.slice(0,5)}update(e,t,r,n=!0){const s=this._extent;this._toRenderBoundingExtent(e,t,r),ce(this._center.origin,s[0].origin,s[2].origin),Q(this._center.origin,this._center.origin,.5),this._renderCoordsHelper.worldUpAtPosition(this._center.origin,this._center.direction),n||Q(this._center.direction,this._center.direction,-1);for(let a=0;a<4;a++){const o=s[a];this._renderCoordsHelper.worldUpAtPosition(o.origin,o.direction);const l=s[a===3?0:a+1];o.cap.next=l.origin,Jg(o.cap.direction,o.origin,l.origin),Sw(o.direction,o.cap.direction,o.origin,this._planes[a]),n||Q(o.direction,o.direction,-1)}Sw(s[0].cap.direction,s[1].cap.direction,s[0].origin,this._planes[hr.NEAR]),n?DI(this._planes[hr.NEAR],this._planes[hr.FAR]):(FG(this._planes[hr.FAR],this._planes[hr.NEAR]),DI(this._planes[hr.NEAR],this._planes[hr.NEAR])),this._maxSpan=Math.max(Math.abs(e[0]-e[2]),Math.abs(e[1]-e[3])),this._maxSpanSpatialReference=t,this._minGlobalAltitude=.9*Kt(this._maxSpanSpatialReference).radius}isVisibleInFrustum(e,t,r=!1){if(e==null)return!1;if(this._renderCoordsHelper.viewingMode===Ie.Global){const s=this._maxSpanSpatialReference.isGeographic?oPe:uJ*t;if(this._maxSpan>s)return!0;if(e.altitude!=null&&e.altitude>=this._minGlobalAltitude)return this._isVisibleInFrustumGlobal(e)}if(this._maxSpan===0){const s=this._extent[0];return!(r||!e.intersectsRay(zc(s.origin,s.direction)))}for(let s=0;s<this._extent.length;s++){const a=this._extent[s];if(!r&&e.intersectsRay(zc(a.origin,a.direction))||e.intersectsLineSegment(gg(a.origin,a.cap.next,hPe),a.cap.direction))return!0}const n=r?this._planes:this._planesWithoutFar;for(let s=0;s<e.lines.length;s++){const a=e.lines[s];if(v1e(n,a.origin,a.endpoint,a.direction))return!0}return!1}_toRenderBoundingExtentGlobal(e,t,r){CD(e,ic),ic[2]=r,xd(t,ic,VM,this._renderCoordsHelper.spatialReference),kn(Rz,VM),Ii(Ua);for(const{x0:s,x1:a,y0:o,y1:l}of cPe)for(let c=0;c<5;c++){const u=c/4;ic[0]=bt(e[s],e[a],u),ic[1]=bt(e[o],e[l],u),ic[2]=r,ss(ic,t,ic,this._renderCoordsHelper.spatialReference),Me(ic,ic,Rz),Z0(Ua,ic)}Y(this._extent[0].origin,Ua[0],Ua[1],Ua[2]),Y(this._extent[1].origin,Ua[3],Ua[1],Ua[2]),Y(this._extent[2].origin,Ua[3],Ua[4],Ua[2]),Y(this._extent[3].origin,Ua[0],Ua[4],Ua[2]);for(let s=0;s<4;++s)Me(this._extent[s].origin,this._extent[s].origin,VM)}_toRenderBoundingExtentLocal(e,t,r){AR(e,t,Su,this._renderCoordsHelper.spatialReference),Y(this._extent[0].origin,Su[0],Su[1],r),Y(this._extent[1].origin,Su[2],Su[1],r),Y(this._extent[2].origin,Su[2],Su[3],r),Y(this._extent[3].origin,Su[0],Su[3],r)}_toRenderBoundingExtent(e,t,r){switch(this._renderCoordsHelper.viewingMode){case Ie.Global:this._toRenderBoundingExtentGlobal(e,t,r);break;case Ie.Local:this._toRenderBoundingExtentLocal(e,t,r);break;default:Ra(this._renderCoordsHelper.viewingMode)}}_isVisibleInFrustumGlobal(e){if(tr(e.planes[hr.NEAR],this._center.origin)<0&&_e(this._center.direction,e.direction)<0)return!0;for(let t=0;t<4;t++){const r=this._extent[t];if(tr(e.planes[hr.NEAR],r.origin)<0&&_e(r.direction,e.direction)<0)return!0}return!1}};const cPe=[{x0:0,y0:1,x1:2,y1:1},{x0:0,y0:3,x1:2,y1:3},{x0:0,y0:1,x1:0,y1:3},{x0:2,y0:1,x1:2,y1:3}],ic=P(),VM=xe(),Rz=xe(),Ua=Ms(),Su=Nt(),hPe=yv();let uPe=class{constructor(e){this._renderCoordsHelper=e,this._surfaceElevation=0,this._cache=new Map,this._frustum=new Yp(e),this._extendedFrustum=new Yp(e),this._intersector=new lPe({renderCoordsHelper:e}),this._renderCoordsHelper=e}begin(e,t){this._surfaceElevation=t,this._aboveGround=this._renderCoordsHelper.getAltitude(e.eye)>t,this._frustum.update(e),this._shortenFrustumFarPlane(this._frustum),this._updateExtendedFrustum(e)}end(){this._cache.clear()}calculate(e){if(this._allTilesInvisible)return ws.INVISIBLE;const t=this._renderCoordsHelper.viewingMode===Ie.Global&&e.lij[0]>=dPe&&e.lij[0]<pPe,r=this._getOrCalculateSingleTileVisibility(e,!t);return r!==ws.INVISIBLE&&t?this._calculateAggregatedChildrenVisibility(e):r}_shortenFrustumFarPlane(e){const t=Yp.nearFarLineIndices,r=e.mutablePoints;for(const n of t){const[s,a]=n,o=r[s],l=r[a];ae(Ao,l,o),Q(Ao,Ao,fPe),ce(r[a],o,Ao)}e.updatePoints(r)}_calculateAggregatedChildrenVisibility(e){let t=ws.INVISIBLE;const r=this._cache.get(e.id);if(r!=null)return r;const n=Mz.acquire();e.getChildren(n);for(const s of n){const a=this.calculate(s);if(a!==ws.INVISIBLE&&(t=a,a===ws.VISIBLE_ON_SURFACE))break}return Mz.release(n),this._cache.set(e.id,t),t}_getOrCalculateSingleTileVisibility(e,t){const r=this._cache.get(e.id);if(r!=null)return r;const n=this._calculateSingleTileVisibility(e);return t&&this._cache.set(e.id,n),n}_calculateSingleTileVisibility(e){return!this._aboveGround&&this._renderCoordsHelper.viewingMode===Ie.Global&&e.lij[0]<mPe?this._calculateSingleTileVisibilitySided(e,!1)===ws.INVISIBLE?this._calculateSingleTileVisibilitySided(e,!0):void 0:this._calculateSingleTileVisibilitySided(e,this._aboveGround)}_calculateSingleTileVisibilitySided(e,t){this._intersector.update(e.extent,e.tilingScheme.spatialReference,this._surfaceElevation,t);const r=Kt(e.tilingScheme.spatialReference).radius;return this._intersector.isVisibleInFrustum(this._extendedFrustum,r)?this._intersector.isVisibleInFrustum(this._frustum,r,!0)?ws.VISIBLE_ON_SURFACE:ws.VISIBLE_WHEN_EXTENDED:ws.INVISIBLE}_updateExtendedFrustum(e){this._extendedFrustum.update(e),this._shortenFrustumFarPlane(this._extendedFrustum);const t=this._renderCoordsHelper.worldUpAtPosition(e.eye,Ao);this._aboveGround||Aa(t,t);const r=ls(-_e(t,e.viewForward));if(this._allTilesInvisible=r>(Math.PI+e.fovY)/2,this._allTilesInvisible||(this._hasExtendedFrustum=r>e.fovY/2,!this._hasExtendedFrustum))return;const n=this._extendedFrustumParameters(),s=this._extendedFrustum.mutablePoints;for(let a=0;a<4;a++){const o=n.pointIndices[a],l=s[o],c=this._renderCoordsHelper.getAltitude(l);if(n.needsAltitudeAdjustment(c)){switch(this._renderCoordsHelper.worldUpAtPosition(l,Ao),o){case Ci.FAR_BOTTOM_LEFT:case Ci.FAR_TOP_LEFT:case Ci.NEAR_BOTTOM_LEFT:case Ci.NEAR_TOP_LEFT:z5(this._extendedFrustum.planes[hr.LEFT],Ao,Ao);break;case Ci.FAR_BOTTOM_RIGHT:case Ci.FAR_TOP_RIGHT:case Ci.NEAR_BOTTOM_RIGHT:case Ci.NEAR_TOP_RIGHT:z5(this._extendedFrustum.planes[hr.RIGHT],Ao,Ao)}Q(Ao,Ao,n.direction),this._renderCoordsHelper.intersectInfiniteManifold(zc(l,Ao),n.zWithMargin,l)}}if(this._extendedFrustum.updatePoints(s),Bh(s[Ci.NEAR_BOTTOM_LEFT],s[Ci.NEAR_BOTTOM_RIGHT],s[Ci.NEAR_TOP_RIGHT],Az),Bh(s[Ci.NEAR_BOTTOM_RIGHT],s[Ci.NEAR_TOP_RIGHT],s[Ci.NEAR_TOP_LEFT],Oz),_e(Ia(Az),Ia(Oz))<0){const a=this._extendedFrustum.mutablePoints;this._aboveGround?[a[Ci.NEAR_BOTTOM_LEFT],a[Ci.NEAR_BOTTOM_RIGHT]]=[a[Ci.NEAR_BOTTOM_RIGHT],a[Ci.NEAR_BOTTOM_LEFT]]:[a[Ci.NEAR_TOP_LEFT],a[Ci.NEAR_TOP_RIGHT]]=[a[Ci.NEAR_TOP_RIGHT],a[Ci.NEAR_TOP_LEFT]],this._extendedFrustum.updatePoints(a)}}_extendedFrustumParameters(){return this._aboveGround?this._extendedFrustumParametersAboveSurface():this._extendedFrustumParametersBelowSurface()}_extendedFrustumParametersAboveSurface(){const e=this._surfaceElevation-Pz;return{zWithMargin:e,pointIndices:Yp.planePointIndices.bottom,direction:-1,needsAltitudeAdjustment:t=>t>e}}_extendedFrustumParametersBelowSurface(){const e=this._surfaceElevation+Pz;return{zWithMargin:e,pointIndices:Yp.planePointIndices.top,direction:1,needsAltitudeAdjustment:t=>t<e}}};const dPe=2,pPe=6,mPe=12,fPe=.95,Pz=1,Ao=P(),Az=fr(),Oz=fr(),Mz=new Fl(Array,i=>{i.length!==4&&(i[0]=new _b,i[1]=new _b,i[2]=new _b,i[3]=new _b)},i=>{i[0].release(),i[1].release(),i[2].release(),i[3].release()});let gPe=class{constructor(e){this._camera=new vi,this._focusOnMap=[0,0],this._screenRect=Nt(),this._tileSize=e.tileSize,this._renderCoordsHelper=e.renderCoordsHelper,this._tilingScheme=e.tilingScheme,this._visibility=new uPe(e.renderCoordsHelper)}begin(e,t,r){this._camera.copyFrom(e),this._surfaceElevation=r,this._focusOnMap[0]=t.x,this._focusOnMap[1]=t.y,SG(0,0,e.fullWidth,e.fullHeight,this._screenRect),this._visibility.begin(this._camera,r)}end(){this._visibility.end()}updateTile(e){e.measures.visibility=this._visibility.calculate(e),e.measures.distance=Ire(e.extent,this._focusOnMap),e.measures.visibility!==ws.INVISIBLE&&this._updateScreenMeasure(e)}_updateScreenMeasure(e){const t=_Pe,r=1<<t,n=e.measures.screenRect;Uc(n);let s=0;const a=e.lij[0]+t,o=e.lij[1]<<t,l=e.lij[2]<<t,c=this._tileSizeWithBias(e),u=c*c;for(let d=0;d<r;d++)for(let m=0;m<r;m++)if(s+=this._computeScreenArea(e,a,o+d,l+m,n),s>u)return void(e.measures.shouldSplit=!0);e.measures.shouldSplit=!1}_tileSizeWithBias(e){return e.measures.visibility===ws.VISIBLE_WHEN_EXTENDED?this._tileSize*yPe:this._tileSize}_computeScreenArea(e,t,r,n,s){const a=e.measures.visibility===ws.VISIBLE_WHEN_EXTENDED;this._projectToScreen(t,r,n,a,pp),Uc(UM);for(let o=0;o<4;o++)TD(UM,pp[o]);return um(s,UM,s),rk(pp[0],pp[1],pp[2])+rk(pp[0],pp[2],pp[3])}_projectToScreen(e,t,r,n,s){this._tilingScheme.ensureMaxLod(e),this._tilingScheme.getExtent(e,t,r,S1),this._toRenderCoords(S1,0,3,mp[0]),this._toRenderCoords(S1,2,3,mp[1]),this._toRenderCoords(S1,2,1,mp[2]),this._toRenderCoords(S1,0,1,mp[3]),n&&(this._projectToPlane(mp,this._camera.frustum[hr.NEAR]),this._projectToPlane(mp,this._camera.frustum[hr.TOP]),this._projectToPlane(mp,this._camera.frustum[hr.BOTTOM]));for(let a=0;a<4;a++)this._camera.projectToRenderScreen(mp[a],Iz),this._camera.renderToScreen(Iz,s[a])}_projectToPlane(e,t){for(let n=0;n<4;n++)R1[n]=tr(t,e[n]);const r=Math.max(R1[0],R1[1],R1[2],R1[3]);if(r>0){const n=Q(E1,Ia(t),-r);for(let s=0;s<4;s++)ce(e[s],e[s],n)}}_toRenderCoords(e,t,r,n){return E1[0]=e[t],E1[1]=e[r],E1[2]=this._surfaceElevation,this._renderCoordsHelper.toRenderCoords(E1,this._tilingScheme.spatialReference,n),n}};const UM=Nt(),_Pe=2,yPe=5,pp=[zi(),zi(),zi(),zi()],S1=Nt(),E1=P(),mp=[P(),P(),P(),P()],R1=[0,0,0,0],Iz=is();function GBe(i,e,t){if(C(i)||C(t))return!1;let r=!0;return Nr[0]=i.xmin!=null?i.xmin:0,Nr[1]=i.ymin!=null?i.ymin:0,Nr[2]=i.zmin!=null?i.zmin:0,r=r&&Ma(Nr,i.spatialReference,0,e,t,0,1),Nr[0]=i.xmax!=null?i.xmax:0,Nr[1]=i.ymax!=null?i.ymax:0,Nr[2]=i.zmax!=null?i.zmax:0,r=r&&Ma(Nr,i.spatialReference,0,e,t,3,1),i.xmin==null&&(e[0]=-1/0),i.ymin==null&&(e[1]=-1/0),i.zmin==null&&(e[2]=-1/0),i.xmax==null&&(e[3]=1/0),i.ymax==null&&(e[4]=1/0),i.zmax==null&&(e[5]=1/0),r}function dJ(i,e,t){if(C(i)||C(t))return!1;let r=!0;return Nr[0]=i.xmin!=null?i.xmin:0,Nr[1]=i.ymin!=null?i.ymin:0,Nr[2]=i.zmin!=null?i.zmin:0,r=r&&Ma(Nr,i.spatialReference,0,Nr,t,0,1),e[0]=Nr[0],e[1]=Nr[1],Nr[0]=i.xmax!=null?i.xmax:0,Nr[1]=i.ymax!=null?i.ymax:0,Nr[2]=i.zmax!=null?i.zmax:0,r=r&&Ma(Nr,i.spatialReference,0,Nr,t,0,1),e[2]=Nr[0],e[3]=Nr[1],i.xmin==null&&(e[0]=-1/0),i.ymin==null&&(e[1]=-1/0),i.xmax==null&&(e[2]=1/0),i.ymax==null&&(e[3]=1/0),r}const Nr=P();let Mn=class extends pe{constructor(e){super(e),this.tiles=new wt,this.tileSize=512,this._idToTile=new Map,this._handles=new Vt,this._clients=new Set,this._dirty=!1,this._newTiles=new Yt}get tilingScheme(){const e=this.tilingSchemeOwner.tilingScheme;return e?e.clone():null}set filterExtent(e){if(y(e)&&!e.spatialReference.equals(this.viewState.spatialReference))return void ee.getLogger(this.declaredClass).error("#extent","extent spatial reference needs to be in the same spatial reference as the view");const t=this._get("filterExtent");if(t===e||y(t)&&e&&t.equals(e))return;const r=y(e)?e.clone():null;this._set("filterExtent",r),this._setDirty()}get _filterExtentRect(){if(C(this.filterExtent)||!this.tilingScheme)return null;const e=Nt();return dJ(this.filterExtent,e,this.tilingScheme.spatialReference),e}get _rootTileIds(){return this._filterExtentRect?this.tilingScheme.rootTilesInExtent(this._filterExtentRect):[[0,0,0]]}set suspended(e){e!==this._get("suspended")&&(this._set("suspended",e),this._setDirty())}get updating(){return this._dirty||!!this._pendingTiles}initialize(){this._handles.add([B(()=>[this.tilingScheme,this.tileSize],()=>this._reset(),ni),B(()=>{var e,t,r;return[this.tileSize,(e=this.cameraOnSurface)==null?void 0:e.location,this.tilingScheme,(t=this.viewState)==null?void 0:t.contentCamera,(r=this.focus)==null?void 0:r.location]},()=>this._setDirty(),Mi)]),this.scheduler&&(this._frameWorker=this.scheduler.registerTask(dr.FEATURE_TILE_TREE,this))}destroy(){this._frameWorker=Os(this._frameWorker),this._handles=Oe(this._handles)}addClient(){const e=bPe();return this._clients.add(e),this._clients.size===1&&this._setDirty(),{remove:()=>this._removeClient(e)}}_removeClient(e){this._clients.delete(e),this._hasClients||this._clear()}get _hasClients(){return this._clients.size>0}_setDirty(){!this._hasClients||this.suspended||this._dirty||(this._frameWorker?(this._dirty=!0,this.notifyChange("updating")):this.runTask(LR))}_clear(){this.tiles.removeAll(),this._idToTile.clear(),this._reset(),this._dirty=!1,this.notifyChange("updating")}get running(){return this.updating}runTask(e){this._dirty=!1,this._pendingTiles||(this._startUpdate(),y(this._frameWorker)&&(this._frameWorker.priority=dr.FEATURE_TILE_TREE_ACTIVE)),this._subdivideTilesForView(e),!this._pendingTiles&&y(this._frameWorker)&&(this._frameWorker.priority=dr.FEATURE_TILE_TREE),this.notifyChange("updating")}_startUpdate(){if(this.suspended)return;if(!this.tilingScheme)return void this._clear();this._tileMeasurements||(this._tileMeasurements=new gPe({renderCoordsHelper:this.renderCoordsHelper,tilingScheme:this.tilingScheme,tileSize:this.tileSize}));const e=this.viewState.contentCamera;this._tileMeasurements.begin(e,this.focus.location,this.cameraOnSurface.location.z),this._pendingTiles=this._getRootTiles()}_reset(){this._newTiles.clear(),this._tileMeasurements=null,this._pendingTiles=null,this._setDirty()}_getRootTiles(){return this._rootTileIds.map(e=>new _b(e[0],e[1],e[2],this.tilingScheme))}_purgeHorizonTiles(e){e.sort((t,r)=>{const n=t.measures.screenRect,s=r.measures.screenRect;return n[1]+n[3]-(s[1]+s[3])}),Uc(XC);for(let t=0;t<e.length;t++)if(um(XC,e.data[t].measures.screenRect,XC),Mm(XC)>wPe)return e.data.slice(t,e.length);return[]}_subdivideTilesForView(e){if(this._pendingTiles){for(;this._pendingTiles.length>0&&!e.done;){const t=this._pendingTiles.pop();e.madeProgress(),this._filterExtentRect&&!DR(this._filterExtentRect,t.extent)||(this._tileMeasurements.updateTile(t),t.measures.visibility!==ws.INVISIBLE&&(t.measures.shouldSplit?(this.tilingScheme.ensureMaxLod(t.lij[0]+1),this._pendingTiles.push(...t.getChildren())):this._newTiles.push(t)))}this._pendingTiles.length===0&&(this._updateTiles(this._purgeHorizonTiles(this._newTiles)),this._newTiles.clear(),this._tileMeasurements.end(),this._pendingTiles=null)}}_updateTiles(e){for(const n of this.tiles.items)n.used=!1;const t=e.filter(n=>{const s=this._idToTile.get(n.id);return s?(s.copyMeasurementsFrom(n),s.used=!0):this._idToTile.set(n.id,n),!s}),r=this.tiles.items.filter(n=>!n.used&&(this._idToTile.delete(n.id),!0));this.tiles.removeMany(r),this.tiles.addMany(t),this._sortTiles()}_sortTiles(){this.viewState.fixedContentCamera||this.tiles.sort((e,t)=>e.measures.visibility!==t.measures.visibility?e.measures.visibility===ws.VISIBLE_ON_SURFACE?-1:1:e.measures.distance-t.measures.distance),this.tiles.forEach((e,t)=>e.loadPriority=t)}};h([p({constructOnly:!0})],Mn.prototype,"scheduler",void 0),h([p({constructOnly:!0})],Mn.prototype,"renderCoordsHelper",void 0),h([p({constructOnly:!0})],Mn.prototype,"tilingSchemeOwner",void 0),h([p({constructOnly:!0})],Mn.prototype,"cameraOnSurface",void 0),h([p({constructOnly:!0})],Mn.prototype,"focus",void 0),h([p({constructOnly:!0})],Mn.prototype,"viewState",void 0),h([p({constructOnly:!0})],Mn.prototype,"terrain",void 0),h([p()],Mn.prototype,"tiles",void 0),h([p()],Mn.prototype,"tileSize",void 0),h([p({readOnly:!0})],Mn.prototype,"tilingScheme",null),h([p()],Mn.prototype,"filterExtent",null),h([p({readOnly:!0})],Mn.prototype,"_filterExtentRect",null),h([p({readOnly:!0})],Mn.prototype,"_rootTileIds",null),h([p({value:!1})],Mn.prototype,"suspended",null),h([p({readOnly:!0})],Mn.prototype,"updating",null),Mn=h([F("esri.views.3d.layers.support.FeatureTileTree3D")],Mn);let vPe=0;function bPe(){return vPe++}const XC=Nt(),wPe=10;let hn=class extends pe{constructor(){super(...arguments),this._propertiesPool=new Od({camera:vi},this),this._lastSeenCameraProjectionValues=new vi,this.events=new nn,this.viewingMode=Ie.Global,this._cameraChanged=!1,this._updateQueue=new Array,this._processingUpdates=!1}init(e,t){this._set("viewingMode",e),this._set("spatialReference",t),this._set("constraints",new Vu({mode:this.viewingMode}))}exit(){this.cameraController=null,this._propertiesPool.destroy(),this._propertiesPool=new Od({camera:vi},this)}createInitialCamera(){if(this.viewingMode===Ie.Global){const e=Kt(this.spatialReference).radius;this.camera=new vi(Ze(4*e,0,0),Ze(e,0,0),Ze(0,0,1))}else this.camera=new vi(Ze(0,0,100),Ze(0,0,0),Ze(0,1,0))}get animation(){return this.cameraController instanceof px&&y(this.cameraController.viewAnimation)?this.cameraController.viewAnimation:null}get camera(){return this._get("camera")}set camera(e){e!==pl&&pl.copyFrom(e),pl.computeUp(this.viewingMode),Lz.camera=pl,this.events.emit("before-camera-change",Lz);const t=this._get("camera");if(this._cameraProjectionChanged(this._lastSeenCameraProjectionValues,pl)&&(this._lastSeenCameraProjectionValues.copyFrom(pl),$z.camera=this._lastSeenCameraProjectionValues,this.events.emit("camera-projection-changed",$z)),(!t||!t.equals(pl))&&(this._set("camera",this._propertiesPool.get("camera").copyFrom(pl)),this._cameraChanged=!t||!t.almostEquals(pl),this._cameraChanged)){const r=M7(()=>{this._cameraChanged=!1,r.remove()})}}get pixelRatio(){return this.camera.pixelRatio}get contentCamera(){return y(this._contentCamera)?this._contentCamera:this.camera}set contentCamera(e){this._contentCamera=y(e)?e.clone():null}get fixedContentCamera(){return y(this._contentCamera)}get isGlobal(){return this.viewingMode===Ie.Global}get isLocal(){return this.viewingMode===Ie.Local}get navigating(){return!(!this.cameraController||!this.cameraController.isInteractive)}get stationary(){return!this._cameraChanged&&!this.navigating}get cameraController(){return this._get("cameraController")}set cameraController(e){this.stopActiveCameraController()?(e&&(this.addHandles(cs(()=>e.state===Vi.Finished||e.state===Vi.Stopped,()=>{this._set("cameraController",null),this.updateCamera(t=>e.onControllerEnd(t))},{sync:!0,once:!0})),e.onControllerStart(this.camera)),this._set("cameraController",e)):e&&(e.state=Vi.Rejected)}switchCameraController(e){return this.cameraController=e,e.state!==Vi.Rejected}stopActiveCameraController(){return!(this.cameraController&&!this.cameraController.stopController())}updateCamera(e){this._updateQueue.push(e),this._processUpdateQueue()}_processUpdateQueue(){if(this._updateQueue.length===0||this._processingUpdates)return;this._processingUpdates=!0;const e=this._updateQueue.shift();pl.copyFrom(this._get("camera")),e(pl),this.camera=pl,this._processingUpdates=!1,this._processUpdateQueue()}_cameraProjectionChanged(e,t){return e.fov!==t.fov||e.fullViewport[0]!==t.fullViewport[0]||e.fullViewport[1]!==t.fullViewport[1]||e.fullViewport[2]!==t.fullViewport[2]||e.fullViewport[3]!==t.fullViewport[3]||e.padding[Je.TOP]!==t.padding[Je.TOP]||e.padding[Je.RIGHT]!==t.padding[Je.RIGHT]||e.padding[Je.BOTTOM]!==t.padding[Je.BOTTOM]||e.padding[Je.LEFT]!==t.padding[Je.LEFT]}};h([p()],hn.prototype,"mode",void 0),h([p({readOnly:!0,type:Md})],hn.prototype,"animation",null),h([p({type:vi})],hn.prototype,"camera",null),h([p()],hn.prototype,"pixelRatio",null),h([p({})],hn.prototype,"_contentCamera",void 0),h([p({type:vi})],hn.prototype,"contentCamera",null),h([p({readOnly:!0})],hn.prototype,"fixedContentCamera",null),h([p({readOnly:!0})],hn.prototype,"constraints",void 0),h([p({readOnly:!0})],hn.prototype,"events",void 0),h([p({readOnly:!0})],hn.prototype,"isGlobal",null),h([p({readOnly:!0})],hn.prototype,"isLocal",null),h([p({readOnly:!0})],hn.prototype,"viewingMode",void 0),h([p({readOnly:!0})],hn.prototype,"spatialReference",void 0),h([p()],hn.prototype,"navigating",null),h([p()],hn.prototype,"stationary",null),h([p()],hn.prototype,"_cameraChanged",void 0),h([p()],hn.prototype,"cameraController",null),hn=h([F("esri.views.3d.state.ViewState")],hn);const xPe=hn,pl=new vi,Lz={camera:null},$z={camera:null};let TPe=class{constructor(e,t,r){this.viewingMode=e,this._forEachLayer=t,this._view=r,this._externalIntersectionHandlers=new Yt,this._tolerance=lv,this._tmpRay=oo(),this._tmpRegion=Nt(),this._validateHUDIntersector=Xl(this.viewingMode),this._validateHUDIntersector.options.hud=!1}intersectScreen(e,t,r){return this.intersectRay(this._getPickRay(e,this._tmpRay),Dz(this.viewingMode),t,r)}intersectScreenFreePointFallback(e,t,r){return this.intersectRayFreePointFallback(this._getPickRay(e,this._tmpRay),t,r)}intersectRayFreePointFallback(e,t,r){return this.intersectRay(e,Dz(this.viewingMode),t,r)||this._intersectRayFreePointLocal(e,t)}intersectRay(e,t,r,n){return t.options.selectionMode=!1,t.options.store=zn.MIN,this.computeIntersection(e,t,n),!!t.results.min&&t.results.min.getIntersectionPoint(r)}getCenterRayWithSubpixelOffset(e,t,r=.5,n=.5){return e.getRenderCenter(YC,r,n),YC[0]+=.0466,YC[1]-=.0123,h4(e,YC,t)}intersectIntersectorScreen(e,t,r){this.computeIntersection(this._getPickRay(e,this._tmpRay),t,r)}intersectToolIntersectorScreen(e,t,r){const n=this._getPickRay(e,this._tmpRay);this.intersectToolIntersectorRay(n,t,r)}intersectToolIntersectorRay(e,t,r){t.options.selectionMode=!0,this.computeIntersection(e,t,r);const n=t.results.min;this._view.basemapTerrain&&this._view.basemapTerrain.opaque||hu(n)&&n.intersector!==Ui.TERRAIN||(t.options.selectionMode=!1,this.computeIntersection(e,t,r))}setTolerance(e=lv){this._tolerance=e}addIntersectionHandler(e){this._externalIntersectionHandlers.push(e),this._externalIntersectionHandlers.sort((t,r)=>t.type===Ui.TERRAIN?1:r.type===Ui.TERRAIN?-1:0)}removeIntersectionHandler(e){this._externalIntersectionHandlers.removeUnordered(e)!=null&&this._externalIntersectionHandlers.sort((t,r)=>t.type===Ui.TERRAIN?1:r.type===Ui.TERRAIN?-1:0)}_getPickRay(e,t){const r=this._view.state.camera;return UZ(r,e,t)}_intersectRayFreePointLocal(e,t){if(this.viewingMode!==Ie.Local||C(e))return!1;const r=this._view.renderDataExtent;if(C(r))return ce(t,e.origin,de(Xe.get(),e.direction)),!0;const n={x:r.xmax-r.xmin,y:r.ymax-r.ymin,z:8*Math.max(r.xmax-r.xmin,r.ymax-r.ymin)},s=Math.max(n.x,n.y,n.z);if(s===0)return ce(t,e.origin,de(Xe.get(),e.direction)),!0;const a=this._view.state.camera,o=Math.max(0,r.xmin-a.eye[0],a.eye[0]-r.xmax),l=Math.max(0,r.ymin-a.eye[1],a.eye[1]-r.ymax),c=Math.sqrt(o*o+l*l),u=Math.abs(a.relativeElevation)+Number.MIN_VALUE,d=Math.max(0,Math.log(s/u))**2;let m=s/Math.max(1,d);m=Math.max(m,Math.min(c,s));const f=we(e.direction),_=Q(Xe.get(),e.direction,f===0?m:m/f);return ce(t,e.origin,_),!0}intersectElevationFromScreen(e,t,r=0,n=null){return this._intersectElevation(this._getPickRay(e,this._tmpRay),t,r,n)}_intersectElevation(e,t,r=0,n=null){if(C(e))return null;const s=y(t)?t.mode:"absolute-height",a=y(t)?Ke(t.offset,0):0,o=s!=="on-the-ground"?a+r:0,l=o/this._view.renderCoordsHelper.unitInMeters;if(s==="absolute-height"){if(this._view.renderCoordsHelper.intersectInfiniteManifold(e,o,ZC)){const b=this._view.computeMapPointFromVec3d(ZC);return b.z-=a,b}return null}const c=this._view.state.camera,u=q0(Xe.get());c.projectToRenderScreen(e.origin,u);const d=new Fz(null,this._forEachLayer),m=this._view.slicePlane,f=y(m)?dU(m):null,_=Xl(this.viewingMode);_.options.store=zn.MIN,_.options.verticalOffset=l;const g=e.origin,w=ce(Xe.get(),g,e.direction);_.reset(g,w,c),_.point=u;const v=y(n)?"type"in n&&n.type==="graphics"?b=>b.metadata.layerUid!==n.uid:b=>b.metadata.graphicUid!==n.uid:null;switch(s){case"relative-to-scene":{const b=x=>(C(v)||v(x))&&x.metadata&&x.metadata.isElevationSource;_.intersect(d.layers,u,this._tolerance,null,b),this._externalIntersectionHandlers.forAll(x=>{if(x.type===Ui.I3S||x.type===Ui.TERRAIN){const T=x.slicePlaneEnabled?f:null;x.intersect(_,T,_.rayBegin,_.rayEnd,u)}})}break;case"on-the-ground":case"relative-to-ground":this._externalIntersectionHandlers.forAll(b=>{if(b.isGround){const x=b.slicePlaneEnabled?f:null;b.intersect(_,x,_.rayBegin,_.rayEnd,u)}})}if(_.results.min.getIntersectionPoint(ZC)){const b=this._view.computeMapPointFromVec3d(ZC);return b.z=r,b}return null}computeIntersection(e,t,r){if(C(e))return;const n=this._view.state.camera,s=q0(Xe.get());n.projectToRenderScreen(e.origin,s);const a=new Fz(r,this._forEachLayer);t.options.selectOpaqueTerrainOnly=!r||!("include"in r||"exclude"in r);const o=e.origin,l=ce(Xe.get(),e.origin,e.direction);t.reset(o,l,n),t.intersect(a.layers,s,this._tolerance);const c=this._view.slicePlane,u=y(c)?dU(c):null;t.intersect(a.sliceableLayers,s,this._tolerance,u);const d=r&&(r.requiresGroundFeedback||r.enableDraped);this._externalIntersectionHandlers.forAll(_=>{if(t.options.isFiltered=!a.filterLayerUid(_.layerUid),_.isGround&&d||!t.options.isFiltered){const g=_.slicePlaneEnabled?u:null;_.intersect(t,g,o,l,s)}});const m=Xe.get(),f=this._view.basemapTerrain;if(r&&r.enableDraped&&y(f.spatialReference)&&t.results.ground.getIntersectionPoint(m)){const _=f.overlayManager.renderer,g=this._view.renderCoordsHelper.spatialReference,w=Xe.get();this._view.renderCoordsHelper.fromRenderCoords(m,w,f.spatialReference),w[2]=Ke(this._view.elevationProvider.getElevation(m[0],m[1],m[2],g,"ground"),0),_.intersect(t,w,t.results.ground,v=>a.filterRenderGeometry(v))}t.sortResults(),this._processHUDResults(t)}_processHUDResults(e){const t=e.results.hud;xw(this._tmpRegion,Lre);const r=this._view.state.camera,n=[],s=this._tmpRegion,a=v=>{const b=new SPe(v);r.projectToRenderScreen(v.target.center,b.screenPoint),b.screenPoint[0]=Math.floor(b.screenPoint[0]),b.screenPoint[1]=Math.floor(b.screenPoint[1]),n.push(b),TD(s,b.screenPoint)};e.sortResults(t.all),y(t.min.dist)&&a(t.min);for(const v of t.all)t.min.target.object!==v.target.object&&t.max.target.object!==v.target.object&&a(v);if(y(t.max.dist)&&t.max.target.object!==t.min.target.object&&a(t.max),!n.length)return;s[0]===s[2]&&(s[2]+=1),s[1]===s[3]&&(s[3]+=1);const o=r.fullWidth,l=r.fullHeight,c=Math.max(0,s[0]-yb),u=Math.max(0,s[1]-yb),d=Math.min(Nh(s)+2*yb,o-c),m=Math.min(Mm(s)+2*yb,l-u),f=new Uint8Array(d*m*4);this._view._stage.renderView.readHUDVisibility(c,u,d,m,f);let _=!0;const g=C(e.results.max.dist);let w=0;for(const v of n)for(const b of CPe)if(f[4*(Math.min(v.screenPoint[0]+b[0],o)-s[0]+(Math.min(v.screenPoint[1]+b[1],l)-s[1])*d)]){_&&(e.results.min.copy(v.result),_=!1),g&&e.results.max.copy(v.result),e.options.store===zn.ALL&&e.results.all.splice(w++,0,v.result);break}}};const yb=1,CPe=(()=>{const i=[],e=yb;for(let t=-e;t<=e;t++)for(let r=-e;r<=e;r++)i.push([r+e,t+e]);return i})();let SPe=class{constructor(e){this.result=e,this.screenPoint=is()}},QC;function Dz(i){return QC&&QC.viewingMode===i||(QC=Xl(i)),QC}let Fz=class{constructor(e,t){this.layers=new Array,this.sliceableLayers=new Array,this.include=e==null?void 0:e.include,this.exclude=e==null?void 0:e.exclude,t(r=>{r.isPickable&&this.filterLayerUid(r.apiLayerUid)&&(r.isSliceable?this.sliceableLayers:this.layers).push(r)})}filterLayerUid(e){const{include:t,exclude:r}=this;return C(e)?t==null&&r==null:(t==null||t.has(e))&&(r==null||!r.has(e))}filterRenderGeometry(e){return this.filterLayerUid(e.layerUid)}};function Nz(i){return typeof i=="object"&&"intersect"in i}const ZC=P(),YC=is();let QBe=class{constructor(e,t){this.spatialReference=e,this._view=t}getElevation(e,t,r){return this._view.elevationProvider.getElevation(e,t,0,this.spatialReference,r)}async queryElevation(e,t,r,n,s){return this._view.elevationProvider.queryElevation(e,t,0,this.spatialReference,s,r,n)}},EPe=class{constructor(e,t,r,n){this.spatialReference=t,this._getElevationQueryProvider=r,this._queries=new Array,this._queryOptions={...n,ignoreInvisibleLayers:!0},this._frameTask=e.registerTask(dr.ELEVATION_QUERY,this)}destroy(){this._frameTask.remove()}queryElevation(e,t,r,n=0){return new Promise((s,a)=>{const o={x:e,y:t,minDemResolution:n,result:{resolve:s,reject:a},signal:r};this._queries.push(o),Rm(r,()=>{Ste(this._queries,o),a(ts())})})}get running(){return this._queries.length>0}runTask(){const e=this._queries;this._queries=[];const t=this._getElevationQueryProvider();if(!t)return void e.forEach(c=>c.result.reject());const r=e.map(c=>[c.x,c.y]),n=e.reduce((c,u)=>Math.min(c,u.minDemResolution),1/0),s=new qie({points:r,spatialReference:this.spatialReference}),a=e.length>1&&e.some(c=>!!c.signal)?new AbortController:null,o=y(a)?a.signal:e[0].signal;if(y(a)){let c=0;e.forEach(u=>Rm(u.signal,()=>{c++,u.result.reject(ts()),c===e.length&&a.abort()}))}const l={...this._queryOptions,minDemResolution:n,signal:o};t.queryElevation(s,l).then(c=>{e.forEach((u,d)=>{y(u.signal)&&u.signal.aborted?u.result.reject(ts()):u.result.resolve(c.geometry.points[d][2])})}).catch(c=>{e.forEach(u=>u.result.reject(c))})}get test(){const e=this;return{update:()=>e._queries.length>0&&e.runTask()}}},vb=class extends nn.EventedMixin(pe){constructor(e){super(e),this._im=new Array,this._ground=new Array,this._scene=new Array,this._handles=new Map,this.lastElevationQuery=null,this.elevationCacheEnabled=!1}get spatialReference(){var e,t;return(t=(e=this.view)==null?void 0:e.basemapTerrain)==null?void 0:t.spatialReference}destroy(){this._elevationQueryCached=Oe(this._elevationQueryCached)}get _elevationQuery(){return C(this._elevationQueryCached)&&(this._elevationQueryCached=new EPe(this.view.resourceController.scheduler,this.view.spatialReference,()=>this.view.map&&this.view.map.ground,{maximumAutoTileRequests:4})),this._elevationQueryCached}enableElevationCache(e){e||(this.lastElevationQuery=null),this.elevationCacheEnabled=e}getElevation(e,t,r,n,s){if(this.elevationCacheEnabled&&this.lastElevationQuery!=null){const o=this.lastElevationQuery;if(e===o.x&&t===o.y&&r===o.z&&Gm(n,o.spatialReference)&&s===o.queryContext)return o.result}let a=null;return a=KC(a,this._im,e,t,r,n,s),C(a)&&(a=KC(a,this._ground,e,t,r,n,s)),s==="scene"&&(a=KC(a,this._scene,e,t,r,n,s)),this.elevationCacheEnabled&&(this.lastElevationQuery={x:e,y:t,z:r,spatialReference:n,queryContext:s,result:a}),a}queryElevation(e,t,r,n,s,a=null,o=0){const l=Vx();return this._elevationQuery.queryElevation(e,t,a,o).then(c=>{s==="scene"&&(c=KC(c,this._scene,e,t,r,n,s)),l.resolve(c)}).catch(c=>{yo(c)?l.reject(c):l.resolve(this.getElevation(e,t,r,n,s))}),l.promise}register(e,t){this._handles.set(t,t.on("elevation-change",r=>this.emit("elevation-change",r))),this._providersFromContext(e).push(t)}unregister(e){this._handles.has(e)&&(this._handles.get(e).remove(),this._handles.delete(e));for(const t of[this._im,this._ground,this._scene]){const r=t.indexOf(e);r>-1&&t.splice(r,1)}}_providersFromContext(e){switch(e){case"ground":return this._ground;case"im":return this._im;case"scene":return this._scene}}};function KC(i,e,t,r,n,s,a){for(const o of e){const l=o.getElevation(t,r,n,s,a);y(l)&&(i=y(i)?Math.max(l,i):l)}return i}h([p({constructOnly:!0})],vb.prototype,"view",void 0),h([p()],vb.prototype,"spatialReference",null),vb=h([F("esri.views.3d.support.CombinedElevationProvider")],vb);let bb=class w${static isValidProfile(e){return e in w$.profiles}static getDefaultProfile(){return Ot("trident")||Ot("esri-iPhone")?"low":"medium"}static apply(e,t){const r=w$.profiles[e];t.graphics3D.maxTotalNumberOfFeatures=r.graphics3D.maxTotalNumberOfFeatures,t.graphics3D.maxTotalNumberOfPrimitives=r.graphics3D.maxTotalNumberOfPrimitives,t.graphics3D.polygonLodFactor=r.graphics3D.polygonLodFactor,t.graphics3D.polylineLodFactor=r.graphics3D.polylineLodFactor,t.graphics3D.snapshotAvailable=r.graphics3D.snapshotAvailable,t.graphics3D.skipHighSymbolLods=r.graphics3D.skipHighSymbolLods;{const n=t.sceneService.object,s=r.sceneService.object;n.lodFactor=s.lodFactor,n.lodCrossfadeinDuration=s.lodCrossfadeinDuration,n.lodCrossfadeoutDuration=s.lodCrossfadeoutDuration,n.lodCrossfadeUncoveredDuration=s.lodCrossfadeUncoveredDuration}t.sceneService.point.lodFactor=r.sceneService.point.lodFactor,t.sceneService.integratedMesh.lodFactor=r.sceneService.integratedMesh.lodFactor,t.sceneService.pointCloud.lodFactor=r.sceneService.pointCloud.lodFactor,t.sceneService.uncompressedTextureDownsamplingEnabled=r.sceneService.uncompressedTextureDownsamplingEnabled,t.tiledSurface.lodBias=r.tiledSurface.lodBias,t.tiledSurface.angledSplitBias=r.tiledSurface.angledSplitBias,t.tiledSurface.reduceTileLevelDifferences=r.tiledSurface.reduceTileLevelDifferences,t.tiledSurface.textureFadeDuration=r.tiledSurface.textureFadeDuration,t.heatmap.pixelRatio=r.heatmap.pixelRatio,t.heatmap.maxTotalNumberOfFeatures=r.heatmap.maxTotalNumberOfFeatures,t.weatherFadeDuration=r.weatherFadeDuration,t.antialiasingEnabled=r.antialiasingEnabled,t.physicallyBasedRenderingEnabled=r.physicalBasedRenderingEnabled,t.highQualityTransparency=r.highQualityTransparency,t.memoryLimit=r.memoryLimit,t.additionalCacheMemory=r.additionalCacheMemory,t.frameRate=r.frameRate,t.maximumRenderResolution=r.maximumRenderResolution,t.maximumPixelRatio=r.maximumPixelRatio}};function kz(){const i=!!Ot("esri-mobile"),e=!!Ot("ios"),t=It(400);return{low:{graphics3D:{maxTotalNumberOfFeatures:25e3,maxTotalNumberOfPrimitives:85e4,polygonLodFactor:.5,polylineLodFactor:1,snapshotAvailable:!1,skipHighSymbolLods:!0},heatmap:{pixelRatio:.125,maxTotalNumberOfFeatures:25e3},sceneService:{object:{lodFactor:.2,lodCrossfadeinDuration:It(0),lodCrossfadeoutDuration:It(0),lodCrossfadeUncoveredDuration:It(0)},point:{lodFactor:1},integratedMesh:{lodFactor:.6},pointCloud:{lodFactor:.5},uncompressedTextureDownsamplingEnabled:!0},tiledSurface:{lodBias:-1,angledSplitBias:.5,reduceTileLevelDifferences:!1,textureFadeDuration:It(0)},weatherFadeDuration:It(0),antialiasingEnabled:!1,physicalBasedRenderingEnabled:!1,highQualityTransparency:!1,memoryLimit:200,additionalCacheMemory:0,frameRate:0,maximumRenderResolution:void 0,maximumPixelRatio:1},medium:{graphics3D:{maxTotalNumberOfFeatures:5e4,maxTotalNumberOfPrimitives:17e5,polygonLodFactor:i?.8:1,polylineLodFactor:i?1.2:1.5,snapshotAvailable:!e,skipHighSymbolLods:!1},heatmap:{pixelRatio:.25,maxTotalNumberOfFeatures:5e4},sceneService:{object:{lodFactor:1,lodCrossfadeinDuration:It(0),lodCrossfadeoutDuration:It(0),lodCrossfadeUncoveredDuration:t},point:{lodFactor:1},integratedMesh:{lodFactor:1},pointCloud:{lodFactor:1},uncompressedTextureDownsamplingEnabled:i},tiledSurface:{lodBias:0,angledSplitBias:1,reduceTileLevelDifferences:!Ot("disable-feature:reduce-map-tile-levels"),textureFadeDuration:t},weatherFadeDuration:t,antialiasingEnabled:!0,physicalBasedRenderingEnabled:!0,highQualityTransparency:!0,memoryLimit:i?600:750,additionalCacheMemory:i?0:150,frameRate:0,maximumRenderResolution:void 0,maximumPixelRatio:1},high:{graphics3D:{maxTotalNumberOfFeatures:5e4,maxTotalNumberOfPrimitives:17e5,polygonLodFactor:i?1.2:2,polylineLodFactor:i?1.2:2,snapshotAvailable:!e,skipHighSymbolLods:!1},heatmap:{pixelRatio:.5,maxTotalNumberOfFeatures:5e4},sceneService:{object:{lodFactor:1,lodCrossfadeinDuration:It(0),lodCrossfadeoutDuration:It(0),lodCrossfadeUncoveredDuration:t},point:{lodFactor:1},integratedMesh:{lodFactor:1},pointCloud:{lodFactor:1},uncompressedTextureDownsamplingEnabled:!1},tiledSurface:{lodBias:0,angledSplitBias:1,reduceTileLevelDifferences:!Ot("disable-feature:reduce-map-tile-levels"),textureFadeDuration:t},weatherFadeDuration:t,antialiasingEnabled:!0,physicalBasedRenderingEnabled:!0,highQualityTransparency:!0,memoryLimit:i?900:1500,additionalCacheMemory:0,frameRate:0,maximumRenderResolution:i?void 0:4096,maximumPixelRatio:i?1:void 0}}}bb.debug={reset(){const i=kz();for(const e in i)bb.profiles[e]=i[e]}},function(i){i.profiles=kz()}(bb||(bb={}));const _E=bb;let xh=class extends pe{constructor(){super(...arguments),this.color=new ti([0,255,255]),this.haloColor=null,this.haloOpacity=1,this.fillOpacity=.25,this.shadowOpacity=.4,this.shadowColor=new ti([0,0,0]),this.shadowDifference=.2}static toEngineOptions(e){const t=ti.toUnitRGBA(e.color),r=y(e.haloColor)?ti.toUnitRGBA(e.haloColor):t,n=ti.toUnitRGBA(e.shadowColor);return{color:J0(t[0],t[1],t[2],t[3]),haloColor:J0(r[0],r[1],r[2],r[3]),haloOpacity:e.haloOpacity,haloOpacityOccluded:.25*e.haloOpacity,fillOpacity:e.fillOpacity,fillOpacityOccluded:.25*e.fillOpacity,shadowOpacity:e.shadowOpacity,shadowColor:Bi(n[0],n[1],n[2],n[3]),occludedShadowOpacity:e.shadowOpacity*(1-e.shadowDifference)}}};h([p({type:ti})],xh.prototype,"color",void 0),h([p({type:ti})],xh.prototype,"haloColor",void 0),h([p()],xh.prototype,"haloOpacity",void 0),h([p()],xh.prototype,"fillOpacity",void 0),h([p()],xh.prototype,"shadowOpacity",void 0),h([p({type:ti})],xh.prototype,"shadowColor",void 0),h([p()],xh.prototype,"shadowDifference",void 0),xh=h([F("esri.views.3d.support.HighlightOptions")],xh);const x$=xh;let Bf=class extends xt{constructor(e){super(e),this.geometries=null,this.outSpatialReference=null,this.transformation=null,this.transformForward=null}toJSON(){const e=this.geometries.map(n=>n.toJSON()),t=this.geometries[0],r={};return r.outSR=this.outSpatialReference.wkid||JSON.stringify(this.outSpatialReference.toJSON()),r.inSR=t.spatialReference.wkid||JSON.stringify(t.spatialReference.toJSON()),r.geometries=JSON.stringify({geometryType:q7(t),geometries:e}),this.transformation&&(r.transformation=this.transformation.wkid||JSON.stringify(this.transformation)),this.transformForward!=null&&(r.transformForward=this.transformForward),r}};h([p()],Bf.prototype,"geometries",void 0),h([p({json:{read:{source:"outSR"}}})],Bf.prototype,"outSpatialReference",void 0),h([p()],Bf.prototype,"transformation",void 0),h([p()],Bf.prototype,"transformForward",void 0),Bf=h([F("esri.rest.support.ProjectParameters")],Bf);const Cx=Bf,RPe=Nx(Cx);async function gR(i,e,t){e=RPe(e);const r=Xie(i),n={...r.query,f:"json",...e.toJSON()},s=e.outSpatialReference,a=q7(e.geometries[0]),o=Qie(n,t);return Wh(r.path+"/project",o).then(({data:{geometries:l}})=>Zie(l,a,s))}async function j4(i=null,e){var n,s;if(Rg.geometryServiceUrl)return Rg.geometryServiceUrl;if(!i)throw new J("internal:geometry-service-url-not-configured");let t;t="portal"in i?i.portal||k1.getDefault():i,await t.load({signal:e});const r=(s=(n=t.helperServices)==null?void 0:n.geometry)==null?void 0:s.url;if(!r)throw new J("internal:geometry-service-url-not-configured");return r}async function PPe(i,e,t=null,r){const n=await j4(t,r),s=new Cx;s.geometries=[i],s.outSpatialReference=e;const a=await gR(n,s,{signal:r});if(a&&Array.isArray(a)&&a.length===1)return a[0];throw new J("internal:geometry-service-projection-failed")}const T$=Object.freeze(Object.defineProperty({__proto__:null,getGeometryServiceURL:j4,projectGeometry:PPe},Symbol.toStringTag,{value:"Module"}));let APe=class{constructor(e,t){this.spatialReference=t,this.unitInMeters=Hm(this.spatialReference,Kt(this.spatialReference).metersPerDegree),this._geometryServiceURLPromise=j4(e&&e.get("portalItem")).catch(()=>{throw new J("mapcoordshelper:missing-geometry-service","Must specify geometryService in esri/config")})}async toGeographic(e){const t=await this._geometryServiceURLPromise;let r,n=!0;Array.isArray(e[0])&&typeof e[0]!="number"?r=e:(r=[e],n=!1);const s=r.map(l=>l instanceof He?l:new He(l,this.spatialReference)),a=new Cx({geometries:s,outSpatialReference:Zt.WGS84}),o=(await gR(t,a)).map(l=>l.type==="point"?[l.x,l.y]:void 0);return n?o:o[0]}},pc=class extends pe{constructor(){super(...arguments),this.minTotalNumberOfFeatures=2e3,this.maxTotalNumberOfFeatures=5e4,this.maxTotalNumberOfPrimitives=17e5,this.snapshotAvailable=!0,this.polygonLodFactor=1,this.polylineLodFactor=1,this.skipHighSymbolLods=!1}};h([p()],pc.prototype,"minTotalNumberOfFeatures",void 0),h([p()],pc.prototype,"maxTotalNumberOfFeatures",void 0),h([p()],pc.prototype,"maxTotalNumberOfPrimitives",void 0),h([p()],pc.prototype,"snapshotAvailable",void 0),h([p()],pc.prototype,"polygonLodFactor",void 0),h([p()],pc.prototype,"polylineLodFactor",void 0),h([p()],pc.prototype,"skipHighSymbolLods",void 0),pc=h([F("esri.views.3d.support.QualitySettings.Graphics3DSettings")],pc);let Kh=class extends pe{constructor(){super(...arguments),this.lodFactor=1}};h([p()],Kh.prototype,"lodFactor",void 0),Kh=h([F("esri.views.3d.support.QualitySettings.LoDFactorSettings")],Kh);let _R=class extends Kh{constructor(){super(...arguments),this.lodCrossfadeinDuration=It(0),this.lodCrossfadeoutDuration=It(0),this.lodCrossfadeUncoveredDuration=It(0)}};_R=h([F("esri.views.3d.support.QualitySettings.LoDFactor3DObjectSettings")],_R);let Zu=class extends pe{constructor(){super(...arguments),this.object=new _R,this.point=new Kh,this.integratedMesh=new Kh,this.pointCloud=new Kh,this.uncompressedTextureDownsamplingEnabled=!1}};h([p({type:_R})],Zu.prototype,"object",void 0),h([p({type:Kh})],Zu.prototype,"point",void 0),h([p({type:Kh})],Zu.prototype,"integratedMesh",void 0),h([p({type:Kh})],Zu.prototype,"pointCloud",void 0),h([p()],Zu.prototype,"uncompressedTextureDownsamplingEnabled",void 0),Zu=h([F("esri.views.3d.support.QualitySettings.SceneServiceSettings")],Zu);let qp=class extends pe{constructor(){super(...arguments),this.lodBias=0,this.angledSplitBias=1,this.reduceTileLevelDifferences=!0,this.textureFadeDuration=It(400)}};h([p()],qp.prototype,"lodBias",void 0),h([p()],qp.prototype,"angledSplitBias",void 0),h([p()],qp.prototype,"reduceTileLevelDifferences",void 0),h([p()],qp.prototype,"textureFadeDuration",void 0),qp=h([F("esri.views.3d.support.QualitySettings.TiledSurfaceSettings")],qp);let w0=class extends pe{constructor(){super(...arguments),this.pixelRatio=1,this.maxTotalNumberOfFeatures=5e4}};h([p()],w0.prototype,"pixelRatio",void 0),h([p()],w0.prototype,"maxTotalNumberOfFeatures",void 0),w0=h([F("esri.views.3d.support.QualitySettings.HeatmapSettings")],w0);let Bs=class extends pe{constructor(){super(...arguments),this.graphics3D=new pc,this.sceneService=new Zu,this.tiledSurface=new qp,this.heatmap=new w0,this.weatherFadeDuration=It(400),this.antialiasingEnabled=!0,this.physicallyBasedRenderingEnabled=!1,this.highQualityTransparency=!0,this.memoryLimit=void 0,this.additionalCacheMemory=void 0,this.frameRate=void 0,this.maximumRenderResolution=void 0,this.maximumPixelRatio=void 0}};h([p({type:pc})],Bs.prototype,"graphics3D",void 0),h([p({type:Zu})],Bs.prototype,"sceneService",void 0),h([p({type:qp})],Bs.prototype,"tiledSurface",void 0),h([p({type:w0})],Bs.prototype,"heatmap",void 0),h([p()],Bs.prototype,"weatherFadeDuration",void 0),h([p()],Bs.prototype,"antialiasingEnabled",void 0),h([p()],Bs.prototype,"physicallyBasedRenderingEnabled",void 0),h([p()],Bs.prototype,"highQualityTransparency",void 0),h([p()],Bs.prototype,"memoryLimit",void 0),h([p()],Bs.prototype,"additionalCacheMemory",void 0),h([p()],Bs.prototype,"frameRate",void 0),h([p()],Bs.prototype,"maximumRenderResolution",void 0),h([p()],Bs.prototype,"maximumPixelRatio",void 0),Bs=h([F("esri.views.3d.support.QualitySettings.QualitySettings")],Bs);const Vz=Bs;function OPe(i){return D7(i)&&i.length>=3}function MPe(i){return(F7(i)||Array.isArray(i))&&i.length>=3}function IPe(i){return OPe(i)||MPe(i)}let LPe=class C${constructor(e,t,r,n){this.viewingMode=e,this.spatialReference=t,this.unitInMeters=r,this._coordinateSystem=n,this._tmpCoordinateSystem=t0e(n)}set extent(e){e&&i0e(this._coordinateSystem,e,this._coordinateSystem)}getAltitude(e){return h0e(this._coordinateSystem,e)}setAltitude(e,t,r=e){return GQ(this._coordinateSystem,r,t,e)}setAltitudeOfTransformation(e,t){u0e(this._coordinateSystem,t,e,t)}worldUpAtPosition(e,t){return a0e(this._coordinateSystem,e,t)}worldBasisAtPosition(e,t,r){return o0e(this._coordinateSystem,e,t,r)}basisMatrixAtPosition(e,t){const r=this.worldBasisAtPosition(e,tm.X,Xe.get()),n=this.worldBasisAtPosition(e,tm.Y,Xe.get()),s=this.worldBasisAtPosition(e,tm.Z,Xe.get());return IG(t,r[0],r[1],r[2],0,n[0],n[1],n[2],0,s[0],s[1],s[2],0,0,0,0,1),t}headingAtPosition(e,t){const r=this.worldUpAtPosition(e,Xe.get()),n=this.worldBasisAtPosition(e,tm.Y,Xe.get()),s=PG(t,n,r);return _o(s)}intersectManifoldClosestSilhouette(e,t,r){return xO(this._coordinateSystem,t,this._tmpCoordinateSystem),c0e(this._tmpCoordinateSystem,e,r),r}intersectManifold(e,t,r){xO(this._coordinateSystem,t,this._tmpCoordinateSystem);const n=Xe.get();return l0e(this._tmpCoordinateSystem,e,n)?X(r,n):null}intersectInfiniteManifold(e,t,r){if(this.viewingMode===Ie.Global)return this.intersectManifold(e,t,r);xO(this._coordinateSystem,t,this._tmpCoordinateSystem);const n=this._tmpCoordinateSystem.value,s=Xe.get();return e_(n.plane,e,s)?X(r,s):null}toRenderCoords(e,t,r){return iR(e)?bn(e,t,this.spatialReference):ss(e,t,r,this.spatialReference)}fromRenderCoords(e,t,r=null){return iR(t)?(y(r)&&(t.spatialReference=r),Y7(e,this.spatialReference,t)):IPe(t)?ss(e,this.spatialReference,t,r)?t:null:Am(e,this.spatialReference,t)}static create(e,t){switch(e){case Ie.Local:return new C$(Ie.Local,t,Hm(t),s0e());case Ie.Global:return new C$(Ie.Global,t,1,n0e(t))}}static renderUnitScaleFactor(e,t){return Uz(e)/Uz(t)}};function Uz(i){if(rR(i,Ie.Global))return 1;const e=HQ(!1,i);return Hm(e)}var Uh;(function(i){i[i.ELEVATION=0]="ELEVATION",i[i.BASEMAP=1]="BASEMAP",i[i.I3S_INDEX=2]="I3S_INDEX",i[i.I3S_DATA=3]="I3S_DATA",i[i.SYMBOLOGY=4]="SYMBOLOGY"})(Uh||(Uh={}));const $Pe=(()=>{const i=new Array;return i[Uh.ELEVATION]=10,i[Uh.BASEMAP]=10,i[Uh.I3S_INDEX]=10,i[Uh.I3S_DATA]=10,i[Uh.SYMBOLOGY]=5,i})(),DPe=30;function pJ(i){return typeof i.getUsedMemory=="function"}function FPe(i){return new ma({view:i})}const JC=1,zM=1,NPe=.75,kPe=.6,zz=1.3;let ma=class extends pe{constructor(e){super(e),this._quality=1,this._memoryUsed=0,this._updating=!1,this.minQuality=.1,this._stableQuality=0,this._downscaleMemoryUsed=0,this._canFastRecover=!1,this._memoryPredicted=0,this._cacheStorage=new Lae,this._warnMemoryUsage=null,this._numQualityChanges=0,this._maxMemory=500,this._additionalCacheMemory=100}destroy(){this._cacheStorage.destroy()}set maxMemory(e){e==null||e<=0||(this._stableQuality=0,this._canFastRecover=!1,this._maxMemory<e&&this._updateQuality(JC),this._maxMemory=e)}get maxMemory(){return this._maxMemory}set additionalCacheMemory(e){e!=null&&e>=0&&(this._additionalCacheMemory=e)}get additionalCacheMemory(){return this._additionalCacheMemory}get memoryFactor(){return this._quality}get updating(){return this._updating}get usedMemory(){return this._memoryUsed}newCache(e,t){return new $ae(e,this._cacheStorage,t)}resetStableQuality(){this._stableQuality=0}disableMemCache(){this.additionalCacheMemory=-4096}update(){if(this._updateMemory(),this._memoryPredicted<=0&&!this._updating)return;let e=this._layersUpdating();if(this._memoryPredicted<kPe&&this._canFastRecover)this._downscaleMemoryUsed=0,this._stableQuality=0,this._canFastRecover=!1,this._updateQuality(JC);else if(e)(this._memoryPredicted>1.1*zM||this._memoryUsed>zM)&&(this._stableQuality>0?(this._downscaleMemoryUsed=0,this._updateQuality(this._stableQuality)):this._quality>this.minQuality&&this._downscaleMemoryUsed<this._memoryUsed&&(this._updateQuality(this._quality/zz),this._downscaleMemoryUsed=this._memoryUsed,this._canFastRecover=!1));else if(this._downscaleMemoryUsed=0,this._memoryUsed>zM)this._stableQuality=0,this._canFastRecover=!1,e=this._updateQuality(this._quality/zz),this._downscaleMemoryUsed=this._memoryPredicted;else if(this._stableQuality!==this._quality)if(this._memoryUsed<NPe&&this._quality<JC){this._stableQuality=this._quality;const t=.05;e=this._updateQuality(this._quality+t)}else this._quality<1&&(this._canFastRecover=!0);this._updating=e}_updateQuality(e){return(e=Math.min(Math.max(e,this.minQuality),JC))!==this._quality&&(this._quality=e,++this._numQualityChanges,!0)}_layersUpdating(){return this.view.allLayerViews.some(e=>!!e.updating)}_updateMemory(){let e=0,t=0;this.view.basemapTerrain&&this.view.basemapTerrain.getUsedMemory&&(e+=this.view.basemapTerrain.getUsedMemory());const r=this.view._stage&&this.view._stage.renderView&&this.view._stage.renderView.edgeView;y(r)&&(e+=r.usedMemory),this.view.allLayerViews&&this.view.allLayerViews.forEach(o=>{if(pJ(o)){const l=o.ignoresMemoryFactor()?this._quality:1;e+=o.getUsedMemory()*l,t+=o.getUnloadedMemory()*l}});const n=C(this._warnMemoryUsage)||Math.round(10*e)!==Math.round(10*this._warnMemoryUsage),s=1048576*this.maxMemory;if(e>s&&n){this._warnMemoryUsage=e;const o=c=>(c/1048576).toLocaleString(void 0,{maximumFractionDigits:1})+" MB",l=Math.round(100*this._quality);ee.getLogger(this.declaredClass).warn(`Memory Limit exceeded! Limit: ${o(s)} Current: ${o(e)} Projected: ${o(e+t)} Quality: ${l}%`)}this._memoryUsed=e/s,this._memoryPredicted=(e+t)/s;const a=s-e;this._cacheStorage.maxSize=Math.max(0,a+1048576*this.additionalCacheMemory)}get test(){const e=this;return{cacheStorage:this._cacheStorage,resetQualityChanges:()=>{const t=e._numQualityChanges;return e._numQualityChanges=0,t}}}};h([p({constructOnly:!0})],ma.prototype,"view",void 0),h([p()],ma.prototype,"maxMemory",null),h([p()],ma.prototype,"additionalCacheMemory",null),h([p()],ma.prototype,"memoryFactor",null),h([p()],ma.prototype,"updating",null),h([p()],ma.prototype,"usedMemory",null),h([p()],ma.prototype,"_quality",void 0),h([p()],ma.prototype,"_memoryUsed",void 0),h([p()],ma.prototype,"_updating",void 0),h([p()],ma.prototype,"_stableQuality",void 0),h([p()],ma.prototype,"_maxMemory",void 0),h([p()],ma.prototype,"_additionalCacheMemory",void 0),ma=h([F("esri.views.3d.support.MemoryControllerImpl")],ma);let VPe=class{constructor(e){this.client=e,this._cancelled=!1,this.size=0,this.duration=0}},UPe=class{constructor(e){this.typeWorkerQuota=e,this.tasks=new Array,this.numWorkers=0,this.statistics=new zPe}},zPe=class{constructor(){this.requests=0,this.size=0,this.duration=0,this.speed=0}},BPe=class{constructor(e,t,r,n){this._workerFunc=e,this._callbackFunc=t,this._maxTotalNumWorkers=r,this._totalNumWorkers=0,this._clients=n.map(s=>new UPe(s))}destroy(){this._clients.length=0}hasQuota(e){const t=this._clients[e];return!!t&&(this._totalNumWorkers<this._maxTotalNumWorkers||t.numWorkers+t.tasks.length<t.typeWorkerQuota)}push(e){const t=this._clients[e.client];t&&(this._totalNumWorkers<this._maxTotalNumWorkers?(t.numWorkers++,this._totalNumWorkers++,this._workerFunc(e,(r,n)=>this._taskCallback(r,n))):t.tasks.push(e))}cancel(e){this._taskFinished(e),e._cancelled=!0}_taskFinished(e){const t=this._clients[e.client];this._totalNumWorkers--,t.numWorkers--,t.statistics.requests++,t.statistics.size+=e.size||0,t.statistics.duration+=e.duration||0,t.statistics.speed=t.statistics.duration>0?t.statistics.size/t.statistics.duration:0,ct(t.numWorkers>=0),this._next()}_next(){for(const e of this._clients)if(e&&e.numWorkers<e.typeWorkerQuota&&this._processQueue(e))return;for(const e of this._clients)if(e&&this._processQueue(e))return}_processQueue(e){for(;e.tasks.length>0;)if(this._workerFunc(e.tasks.shift(),(t,r)=>this._taskCallback(t,r)))return e.numWorkers++,this._totalNumWorkers++,!0;return!1}_taskCallback(e,t){e._cancelled||(this._callbackFunc(e,t),this._taskFinished(e))}getStatsForType(e){const t=this._clients[e];return t?{quota:t.typeWorkerQuota,workers:t.numWorkers,queueSize:t.tasks.length,requestStats:t.statistics}:null}get test(){const e=this;return{set workerFunc(t){e._workerFunc=t}}}},yE=class extends pe{constructor(){super(...arguments),this._tasks=new Map,this._onLoadQueue=new Array,this._doneQueue=new Array,this.updating=!1}setup(e,t,r){this._loadQueue=new BPe((n,s)=>this._startLoading(n,s),(n,s)=>this._doneLoadingCB(n,s),e,t),r&&(this._frameTask=r.registerTask(dr.STREAM_DATA_LOADER,this))}destroy(){this._frameTask=Os(this._frameTask),this._tasks.forEach(e=>iu(e.abortController)),this._loadQueue=Oe(this._loadQueue),this._onLoadQueue=null,this._doneQueue=null,this._tasks=null}hasDownloadSlots(e){return this._loadQueue.hasQuota(e)}request(e,t,r,n={}){const s=Vx();s.__signal=y(n)?n.signal:null;const a=this._createOrUpdateTask(e,t,r,n,s);return Rm(n,()=>this._cancelRequest(a,s)),s.promise}_createTask(e,t,r,n,s,a){const o=new jPe(e,t,r,n,s);return this._updateTask(o,a),this._tasks.set(s,o),this._tasks.size===1&&this._set("updating",!0),this._loadQueue.push(o),o}_cancelRequest(e,t){var r;k7(e.resolvers,t),t.reject(ts()),e.resolvers.length===0&&(e.status===bl.DOWNLOADING&&(e.status=bl.CANCELLED,this._loadQueue.cancel(e),(r=e.abortController)==null||r.abort(),e.request=null,e.abortController=null),e.status=bl.CANCELLED,this._tasks.delete(e.key),this._tasks.size===0&&this._set("updating",!1))}_updateTask(e,t){e.resolvers.push(t)}_createOrUpdateTask(e,t,r,n,s){const a=qPe(y(n)&&n.uid||e,t,r),o=this._tasks.get(a);return o?(this._updateTask(o,s),o):this._createTask(e,n,t,r,a,s)}_doneLoadingCB(e,t){this._loadQueue&&(ct(e.status===bl.DOWNLOADING),e.status=bl.DOWNLOADED,this._frameTask?this._doneQueue.push({task:e,err:t}):this._doneLoading(e,t))}get running(){return this._doneQueue.length>0||this._onLoadQueue.length>0}runTask(e){for(;!e.done&&this._onLoadQueue.length>0;){const t=this._onLoadQueue.shift();Ti(t.task.abortController),t.task.abortController=null,t.callback(t.task),e.madeProgress()}for(;!e.done&&this._doneQueue.length>0;){const t=this._doneQueue.shift();t.task.status!==bl.DOWNLOADED&&(t.err=t.err||ts()),this._doneLoading(t.task,t.err),e.madeProgress()}}_doneLoading(e,t){if(t&&!yo(t)&&e.numRetries>0)return--e.numRetries,void this._loadQueue.push(e);let r=e.result instanceof HTMLImageElement?0:e.resolvers.length;for(const n of e.resolvers)if(t)yo(t)?n.reject(t):n.reject(new J("stream-data-loader:request-error",`Failed to request resource at '${e.url}'. ${t}`,{url:e.url,error:t}));else{--r;const s=r<=0?e.result:Pr(e.result);n.resolve(s)}this._tasks.delete(e.key),this._tasks.size===0&&this._set("updating",!1)}_startLoading(e,t){if(e.status===bl.CANCELLED)return!1;let r,n;switch(e.startTime=performance.now(),e.status=bl.DOWNLOADING,e.docType){case"binary":n="array-buffer",r=0;break;case"image":n="image";break;case"image+type":n="array-buffer";break;default:n="json"}e.abortController=new AbortController;const s=e.abortController.signal;e.request=Wh(e.url,{...e.options,responseType:n,timeout:r,signal:s});let a=()=>{};const o=c=>{e.duration=performance.now()-e.startTime,e.size=c instanceof ArrayBuffer?c.byteLength:e.size||0,e.result=c,this._frameTask?this._onLoadQueue.push({callback:t,task:e}):(e.abortController=null,t(e))},l=c=>{e.status===bl.DOWNLOADING&&t(e,c),a()};return e.docType!=="image+type"?(e.request.then(c=>o(c.data),l),!0):(e.request.then(c=>{const u=c.data,d=HPe(u);if(n="image",e.size=u.byteLength,d==="unknown")return e.request=Wh(e.url,{responseType:n,timeout:r,signal:s}),void e.request.then(_=>o(_.data),l);const m=new Blob([u],{type:d}),f=window.URL.createObjectURL(m);a=()=>window.URL.revokeObjectURL(f),e.request=Wh(f,{responseType:n,timeout:r,signal:s}),e.request.then(_=>o(new WP(_.data,d,a)),l)},l),!0)}get test(){return{loadQueue:this._loadQueue}}};h([p({readOnly:!0})],yE.prototype,"updating",void 0),yE=h([F("esri.views.3d.support.StreamDataLoader")],yE);const GPe={numRetries:0};function HPe(i){if(i.byteLength<2)return"unknown";const e=new Uint8Array(i,0,i.byteLength);return e[0]===137&&e[1]===80?"image/png":e[0]===71&&e[1]===73?"image/gif":e[0]===66&&e[1]===77?"image/bmp":e[0]===255&&e[1]===216?"image/jpeg":"unknown"}let WP=class{constructor(e,t,r){this.image=e,this.type=t,this.release=r}get isOpaque(){return this.type==="image/jpeg"}},jPe=class extends VPe{constructor(e,t,r,n,s){super(n),this.url=e,this.options=t,this.docType=r,this.key=s,this.result=null,this.status=bl.QUEUED,this.request=null,this.abortController=null,this.resolvers=new Array,this.startTime=0,this.numRetries=GPe.numRetries}};function qPe(i,e,t){return`${i}:${e}:${t}`}var bl;(function(i){i[i.QUEUED=1]="QUEUED",i[i.DOWNLOADING=2]="DOWNLOADING",i[i.DOWNLOADED=3]="DOWNLOADED",i[i.CANCELLED=4]="CANCELLED"})(bl||(bl={}));let vE=class extends pe{constructor(){super(...arguments),this.updating=!1}};function WPe(i){return new Uu({view:i})}h([p({readOnly:!0})],vE.prototype,"updating",void 0),vE=h([F("esri.views.3d.support.ResourceControllerMain")],vE);let Uu=class extends vE{constructor(){super(...arguments),this._scheduler=null,this._memoryController=null,this._streamDataLoader=null,this._scheduleTask=yD,this._handles=new Vt,this._frameTask=null}initialize(){this._scheduler=ire(),this._memoryController=FPe(this.view),this._streamDataLoader=new yE,this._streamDataLoader.setup(DPe,$Pe,this._scheduler),this._handles.add([B(()=>{var e;return(e=this.view.state)==null?void 0:e.mode},e=>this._scheduler.state=e,ni),B(()=>this.view.stationary,()=>this._stationaryChangedHandler())]),this._frameTask=wd({update:e=>this._frame(e)}),this._scheduleTask=this._scheduler.registerTask(dr.RESOURCE_CONTROLLER)}destroy(){this._handles=Oe(this._handles),this._scheduleTask.remove(),this._frameTask=Os(this._frameTask),this._streamDataLoader=Oe(this._streamDataLoader),this._memoryController=Oe(this._memoryController),this._scheduler=Oe(this._scheduler)}get updating(){var e,t,r;return!!((e=this._memoryController)!=null&&e.updating||(t=this._streamDataLoader)!=null&&t.updating||(r=this._scheduleTask)!=null&&r.updating)}get scheduler(){return this._scheduler}get memoryController(){return this._memoryController}schedule(e,t,r){return this._scheduleTask.schedule(e,t,r)}createStreamDataRequester(e){const t=this._streamDataLoader;return{request:(r,n,s)=>t.request(r,n,e,s),get busy(){return!t.hasDownloadSlots(e)}}}_frame(e){this.view.suspended||this.view.stateManager&&(this.view.stateManager.step(aD(e.deltaTime)),!this._scheduler)||(this._scheduler.updateBudget(e)?(this._memoryController.update(),this._scheduler.frame()):this._memoryController.updating&&this._memoryController.update())}_stationaryChangedHandler(){this.memoryController.resetStableQuality()}get test(){return{getQueueStats:e=>this._streamDataLoader.test.loadQueue.getStatsForType(e)}}};h([p({constructOnly:!0})],Uu.prototype,"view",void 0),h([p()],Uu.prototype,"_scheduler",void 0),h([p()],Uu.prototype,"_memoryController",void 0),h([p()],Uu.prototype,"_streamDataLoader",void 0),h([p()],Uu.prototype,"_scheduleTask",void 0),h([p({readOnly:!0})],Uu.prototype,"updating",null),Uu=h([F("esri.views.3d.support.ResourceControllerImpl")],Uu);function XPe(i){return"performanceInfo"in i}const ey=P(),QPe=P(),Eu=P(),Ru=P();function ZPe(i,e,t=0){const r=i.extent;if(C(r))return!1;if(t===0)return CG(r,e);const n=Math.min(r[2]-r[0],r[3]-r[1]);return $re(r,e,t*n)}function eS(i,e,t,r){X(ey,t),ey[r]=e[r];const n=ae(ey,ey,e),s=ae(QPe,i,e),a=_e(s,n),o=_e(n,n);let l;l=a<=0?e:o<=a?t:ce(ey,e,Q(n,n,a/o));const c=ae(ey,i,l);return Math.PI/2-Math.atan(c[2]/Math.sqrt(c[0]*c[0]+c[1]*c[1]))}function YPe(i,e,t){const r=i.extent;if(C(r))return 0;Eu[0]=r[0],Eu[1]=r[1],Eu[2]=t,Ru[0]=r[2],Ru[1]=r[3],Ru[2]=t;let n=1/0,s=1/0;return e[0]<Eu[0]?n=eS(e,Eu,Ru,0):e[0]>Ru[0]&&(n=eS(e,Ru,Eu,0)),e[1]<Eu[1]?s=eS(e,Eu,Ru,1):e[1]>Ru[1]&&(s=eS(e,Ru,Eu,1)),Math.min(n,s)}function KPe(i,e,t){if(C(i))return WN();if(i.spatialReference.isGeographic&&!Pg(i.spatialReference))return new J("tilingscheme:local-unsupported-spatial-reference","The tiling scheme spatial reference is not supported in local scenes");const r=so.checkUnsupported(i);if(y(r))return r;if(C(t))return new J("tilingscheme:extent-not-exist","The layer does not provide a layer extent.");const n=JPe(i,t);if(n)return n;const s=i.spatialReference;return y(e)&&!(s.equals(e)||e.isWGS84&&s.isWebMercator)?new J("tilingscheme:spatial-reference-mismatch","The tiling scheme does not match the spatial reference of the local scene"):null}function JPe(i,e){const t=i.lods,r=t[0].resolution*2**t[0].level,n=[r*i.size[0],r*i.size[1]],s=[i.origin.x,i.origin.y],a=ww(e),o=Nt();so.computeRowColExtent(a,n,s,o);const l=(o[2]-o[0])*(o[3]-o[1]);if(l>d0){const c=t[0].scale*2**t[0].level;let u=Math.max((a[3]-a[1])/i.size[1],(a[2]-a[0])/i.size[0])*c/r;const d=Math.floor(Math.log(u)/Math.log(10));return u=Math.ceil(u/10**d)*10**d,new J("tilingscheme:too-many-root-tiles","Scale of level 0 of the tiling scheme (1:"+Math.floor(c).toLocaleString()+") is too large for the layer's extent. Suggested scale: 1:"+u.toLocaleString()+".",{level0Scale:c,suggestedLevel0Scale:u,requiredNumRootTiles:l,allowedNumRootTiles:d0})}return null}const eAe=Object.freeze(Object.defineProperty({__proto__:null,isInsideExtent:ZPe,tiltToExtentEdge:YPe,checkIfTileInfoSupportedForViewSR:KPe},Symbol.toStringTag,{value:"Module"}));function tAe(){return!0}function iAe(){return 0}function rAe(i,e){if(C(i))return WN();const t=i.lods.length-1,r=i.spatialReference,n=Pg(r)||Dx(r)||Fx(r);if(r.isWebMercator){if(!so.makeWebMercatorAuxiliarySphere(t).compatibleWith(i))return new J("tilingscheme:incompatible-global-web-mercator","The tiling scheme is not compatible with the ArcGIS Online Web Mercator tiling scheme")}else{if(!n)return new J("tilingscheme:global-unsupported-spatial-reference","The tiling scheme spatial reference is not supported in global scenes");if(!so.makeGCSWithTileSize(i.spatialReference,i.size[0],t).compatibleWith(i))return i.spatialReference.isWGS84?new J("tilingscheme:incompatible-global-wgs84","The tiling scheme is not compatible with the ArcGIS Online WGS84 tiling scheme"):new J("tilingscheme:incompatible-global","The tiling scheme is not compatible with the ArcGIS Online tiling scheme")}return y(e)&&!i.spatialReference.equals(e)?new J("tilingscheme:spatial-reference-mismatch","The tiling scheme does not match the spatial reference of the global scene"):void 0}const nAe=Object.freeze(Object.defineProperty({__proto__:null,isInsideExtent:tAe,tiltToExtentEdge:iAe,checkIfTileInfoSupportedForViewSR:rAe},Symbol.toStringTag,{value:"Module"})),sAe={[Ie.Global]:nAe,[Ie.Local]:eAe};function $h(i,e){i||console.warn("Terrain: "+e)}let gn=!1,yR=!1;function aAe(i){yR=i,gn=gn||i}function oAe(i){gn=i}function fe(i,e){if(gn&&!i){const t=new Error().stack.slice(5);throw console.warn("Terrain internal: "+(e||"")+" at "+t),new Error("Assertion failed"+(e?": "+e:""))}}function S$(i){return XP(i)?{fullExtent:i.fullExtent,minScale:i.layer.minScale,maxScale:i.layer.maxScale,tilemapCache:null}:i.layer}function vR(i){return(i==null?void 0:i.type)==="imagery-tile"||(i==null?void 0:i.type)==="wcs"}function XP(i){return(i==null?void 0:i.type)==="imagery-tile-3d"}function q4(i){return(i==null?void 0:i.type)==="tile-3d"}function Sx(i){return(i==null?void 0:i.type)==="vector-tile-3d"}function mJ(i){return(i==null?void 0:i.type)==="wmts-3d"}function E$(i){return(i==null?void 0:i.type)==="elevation-3d"}function P1(i){return(i==null?void 0:i.type)==="group"}function mv(i){return(i==null?void 0:i.type)==="group"}function bR(i){return i&&(q4(i)||mJ(i)||XP(i)||Sx(i))}function R$(i){return i&&(q4(i)||XP(i)||Sx(i)||mJ(i))}function Ex(i){return R$(i)||E$(i)}function lAe(i){var t;const e=(t=i==null?void 0:i.sourceLayerInfo)==null?void 0:t.data;return y(e)&&"type"in e&&e.type==="raster-tile"}function cAe(i){var t;const e=(t=i==null?void 0:i.sourceLayerInfo)==null?void 0:t.data;return y(e)&&"type"in e&&e.type==="vector-tile"}function hAe(i){var t;const e=(t=i==null?void 0:i.sourceLayerInfo)==null?void 0:t.data;return y(e)&&"type"in e&&e.type==="tile-texture"}function uAe(i){var t;const e=(t=i==null?void 0:i.sourceLayerInfo)==null?void 0:t.data;return e instanceof HTMLImageElement||e instanceof WP||e instanceof HTMLCanvasElement||e instanceof ImageData}function U0(i){return y(i)&&"release"in i&&i.release(),null}function Bz(i){return i.fetchTile&&i.hasOverriddenFetchTile!==!1}function W4(i,e,t,r){return sAe[r].checkIfTileInfoSupportedForViewSR(i,t,e)}function QP(i,e,t){let r=null,n=null;if((i==null?void 0:i.type)==="wmts"){const s=dAe(i,e,t);r=s.tileInfo,n=s.fullExtent}else{n=vR(i)?i.getCompatibleFullExtent(e):i.fullExtent;const s=t===Ie.Local;if(vR(i))r=i.getCompatibleTileInfo(e,n,s);else if((i==null?void 0:i.type)==="vector-tile"){const a=s&&!pAe(e)||mAe.force512VTL,o=i.tileInfo.spatialReference.isGeographic;r=a?i.tileInfo:i.tileInfo.getOrCreateCompatible(256,o?1:2)}else r=i.tileInfo}return y(r)&&y(n)&&W4(r,n,e,t)==null?{tileInfo:r,fullExtent:n}:null}function dAe(i,e,t){const r=cne(i);if(y(r)){if(!wt.isCollection(r))return{tileInfo:r.tileInfo,fullExtent:r.fullExtent};{const n=r.find(s=>W4(s.tileInfo,s.fullExtent,e,t)==null);if(n)return{tileInfo:n.tileInfo,fullExtent:n.fullExtent}}}return{tileInfo:null,fullExtent:null}}function pAe(i){return i.isWGS84||i.isWebMercator||$te(i)||!DE(i)}const mAe={force512VTL:!1};function Gz(i){return"["+i[0]+","+i[1]+","+i[2]+"]"}function Pu(i){return"("+i[0]+","+i[1]+","+i[2]+")"}function fAe(i,e,t=yAe){return Math.abs(i-e)<t}function P$(i){return i===qe.NORTH_EAST?qe.SOUTH_WEST:i===qe.NORTH_WEST?qe.SOUTH_EAST:i===qe.SOUTH_WEST?qe.NORTH_EAST:qe.NORTH_WEST}function wR(i){return i===qe.NORTH?qe.SOUTH:i===qe.EAST?qe.WEST:i===qe.SOUTH?qe.NORTH:qe.EAST}function gAe(i){return i===qe.NORTH_WEST||i===qe.SOUTH_WEST}function _Ae(i){return i===qe.NORTH_WEST||i===qe.NORTH_EAST}function Hz(i){return i===qe.NORTH_WEST||i===qe.WEST||i===qe.SOUTH_WEST}function jz(i){return i===qe.NORTH_EAST||i===qe.EAST||i===qe.SOUTH_EAST}function qz(i){return i===qe.SOUTH_EAST||i===qe.SOUTH||i===qe.SOUTH_WEST}function Wz(i){return i===qe.NORTH_EAST||i===qe.NORTH||i===qe.NORTH_WEST}const jh=[qe.NORTH,qe.EAST,qe.SOUTH,qe.WEST],xR=[qe.NORTH_EAST,qe.SOUTH_EAST,qe.SOUTH_WEST,qe.NORTH_WEST],yAe=1e-5;let vAe=class{constructor(e,t){if(this.layer=null,this.memory=0,this.displayedNumberOfFeatures=0,this.maximumNumberOfFeatures=null,this.totalNumberOfFeatures=null,this.layer=e.layer,this.memory=Ex(e)?t.basemapTerrain.getUsedMemoryForLayerView(e):e.getUsedMemory(),XPe(e)){const r=e.performanceInfo;this.displayedNumberOfFeatures=r.displayedNumberOfFeatures,this.maximumNumberOfFeatures=r.maximumNumberOfFeatures,this.totalNumberOfFeatures=r.totalNumberOfFeatures}}},bAe=class{constructor(e){if(this.totalMemory=0,this.usedMemory=0,this.quality=1,this.load=0,this.terrainMemory=0,this.edgesMemory=0,this.layerPerformanceInfos=new Array,y(e.resourceController)){const r=e.resourceController.memoryController;this.totalMemory=r.maxMemory*vI.MEGABYTES,this.usedMemory=Math.round(r.usedMemory*this.totalMemory),this.quality=r.memoryFactor,this.load=e.resourceController.scheduler.load}this.terrainMemory=e.basemapTerrain?e.basemapTerrain.getUsedMemory():0;const t=e._stage&&e._stage.renderView&&e._stage.renderView.edgeView;this.edgesMemory=y(t)?t.usedMemory:0,e.allLayerViews.items.forEach(r=>{(pJ(r)||Ex(r))&&this.layerPerformanceInfos.push(new vAe(r,e))}),this.layerPerformanceInfos.sort((r,n)=>n.memory-r.memory)}},wAe=class{constructor(e){this._gltfLoading=new Map,this._wosrLoading=new Map,this._gltfMemCache=e("gltf-resources",()=>{}),this._wosrMemCache=e("wosr-resources",()=>{})}destroy(){this._gltfLoading.forEach(e=>e.abortController.abort()),this._wosrLoading.forEach(e=>e.abortController.abort()),this._gltfMemCache.destroy(),this._wosrMemCache.destroy()}loadGLTF(e,t,r){const n=r?`gltfPBR:${e}`:`gltf:${e}`,s=this._gltfMemCache.get(n);return y(s)?Promise.resolve(s):this._loadOnce(this._gltfLoading,this._gltfMemCache,n,a=>Pse(new Ase(a.streamDataRequester),e,a,r),t)}loadWOSR(e,t){const r=`wosr:${e}:${t.disableTextures}`,n=this._wosrMemCache.get(r);return y(n)?Promise.resolve(n):this._loadOnce(this._wosrLoading,this._wosrMemCache,r,s=>gse(e,s),t)}async _loadOnce(e,t,r,n,s){Ti(s);const a=Rm(s,()=>this._abortLoad(e,r));let o=e.get(r);if(o)o.refCount++;else{const l=new AbortController;o={refCount:1,abortController:l,promise:n({...s,signal:l.signal})},e.set(r,o)}try{const l=await o.promise;return t.put(r,l,l.size),e.delete(r),Ti(s),l}finally{Os(a)}}_abortLoad(e,t){const r=e.get(t);y(r)&&--r.refCount>0||(e.delete(t),y(r)&&r.abortController.abort())}},xAe=class extends c0{constructor(e,t,r,n){super(t,n),this._streamDataRequester=e,this._parameters=r}async fromUrl(e,t,r){Ti(r);const n=y(r)&&r.signal,s=this.makeUid(e,t);let a=this._textureRequests.get(s);if(!a){const o=new AbortController,l=this._streamDataRequester.request(e,"image",{uid:s,signal:o.signal});a={referenceCount:0,texture:null,textureAsync:null,abortController:o},this._textureRequests.set(s,a),a.textureAsync=l.then(async c=>{const u=this._createTexture(e,c,t);return a.texture=u,a.abortController=null,this._stage.add(u),await this._stage.load(u),{uid:s,texture:u,release:()=>this._release(s)}},c=>{throw a.abortController=null,c})}return a.referenceCount++,new Promise((o,l)=>{Rm(n,()=>{l(ts())}),a.textureAsync.then(o,l)}).catch(o=>{throw this._release(s),o})}_createTexture(e,t,r){const n={...this._parameters,powerOfTwoResizeMode:YD.PAD};if(fD(e)){if(r||t.width===0&&t.height===0){const s=t.width?t.height/t.width:1;r=r||64,s>1?(t.width=Math.round(r/s),t.height=r):(t.width=r,t.height=Math.round(r*s))}this._stage.renderView&&this._stage.renderView.renderingContext.driverTest.svgAlwaysPremultipliesAlpha&&(n.preMultiplyAlpha=!1)}return n.width=t.width,n.height=t.height,new jR(t,n)}},TAe=class{constructor(e){this.textures=null,this.streamDataRequester=null,this._graphicsOwners=[],this._screenSizePerspectiveHandles=null,this.cimSymbolRasterizer=null,this._viewState=e.viewState,this._view=e.view,this._pointsOfInterest=e.pointsOfInterest,this.streamDataRequester=e.resourceController.createStreamDataRequester(Uh.SYMBOLOGY),this.objectResourceCache=new wAe((r,n)=>e.resourceController.memoryController.newCache(r,n)),this.textures=new xAe(this.streamDataRequester,e.view._stage,{preMultiplyAlpha:!0,wrap:{s:ai.CLAMP_TO_EDGE,t:ai.CLAMP_TO_EDGE}},e.resourceController.scheduler);const t=Kt(this._view.spatialReference).radius;this.screenSizePerspectiveSettings=eH(e.viewingMode,t),this.screenSizePerspectiveSettingsLabels=Hne(e.viewingMode,t)}destroy(){Oe(this.textures),this.textures=null,this.streamDataRequester=null}addGraphicsOwner(e){if(!e)return fw();this._graphicsOwners.push(e);const t=B(()=>{var r;return(r=e.layer)==null?void 0:r.screenSizePerspectiveEnabled},()=>this._updateScreenSizePerspectiveEnabled());return this._updateScreenSizePerspectiveEnabled(),fw(()=>{t.remove(),k7(this._graphicsOwners,e),this._updateScreenSizePerspectiveEnabled()})}_updateScreenSizePerspectiveEnabled(){const e=this._graphicsOwners.some(t=>{var r;return((r=t.layer)==null?void 0:r.screenSizePerspectiveEnabled)===!0});if(e&&!this._screenSizePerspectiveHandles){this._screenSizePerspectiveHandles=new Vt;const t=()=>this._updateScreenSizePerspectiveSettings();this._screenSizePerspectiveHandles.add([B(()=>this._pointsOfInterest.centerOnSurfaceInfrequent.distance,t,ni),this._viewState.events.on("camera-projection-changed",t)]),this._updateScreenSizePerspectiveSettings()}else!e&&this._screenSizePerspectiveHandles&&(this._screenSizePerspectiveHandles.destroy(),this._screenSizePerspectiveHandles=null)}_updateScreenSizePerspectiveSettings(){const e=this._pointsOfInterest;tS.distance=e.centerOnSurfaceInfrequent.distance,tS.fovY=this._viewState.camera.fovY,this.screenSizePerspectiveSettings.update(tS),this.screenSizePerspectiveSettingsLabels.update(tS),this._view._stage.renderView.requestRender()}get test(){return{screenSizePerspectiveHandles:this._screenSizePerspectiveHandles}}};const tS={distance:0,fovY:0};let $p=class{constructor(e,t,r=""){this.graphics=e,this._symbol=new Mie({symbolLayers:[new Iie({material:{color:t},outline:{color:[255,255,255],size:1},resource:{primitive:"circle"}}),new Lie({text:r,halo:{color:"white",size:1/.75},material:{color:t},size:12})]})}show(e,t){if(C(t))return;this.hide();const r=new He({x:e[0],y:e[1],z:e[2],spatialReference:t});this._graphic=new jc({geometry:r,symbol:this._symbol}),this.graphics.add(this._graphic)}hide(){y(this._graphic)&&(this.graphics.remove(this._graphic),this._graphic=null)}},Kp=class extends pe{constructor(e){super(e),this.handles=new Vt}destroy(){this.handles.destroy()}};h([p({constructOnly:!0})],Kp.prototype,"renderCoordsHelper",void 0),h([p({constructOnly:!0})],Kp.prototype,"surface",void 0),h([p({constructOnly:!0})],Kp.prototype,"state",void 0),Kp=h([F("esri.views.3d.support.PointOfInterest")],Kp);const CAe=Array;let No=class extends Kp{constructor(e){super(e),this._dirty=!1,this._propertiesPool=new Od({location:He,renderLocation:CAe},this),this._estimatedSurfaceAltitude=0,this._pendingElevationQueryController=null,this.cameraName="camera",this.renderLocation=P(),this._tmpPoint=new He}initialize(){if(this.scheduler&&this.handles.add(this.scheduler.registerTask(this.task,this)),this.runTask(),this.map){const e=()=>this._setDirty();this.handles.add(wr(()=>{var t,r;return(r=(t=this.map)==null?void 0:t.ground)==null?void 0:r.layers},"change",e,{onListenerAdd:e,onListenerRemove:e}))}this._updateRenderLocation()}destroy(){this._cancelPendingRequest(),this._propertiesPool.destroy(),this._propertiesPool=null}get _camera(){return this.state[this.cameraName]}get location(){const e=this._propertiesPool.get("location");return this.renderCoordsHelper.fromRenderCoords(this.renderLocation,e,this.state.spatialReference),e}get scale(){const e=this._camera,t=Li(e.eye,this.renderLocation),r={renderCoordsHelper:this.renderCoordsHelper,state:{camera:e}};return jg(r,t,0)}get updating(){return this._dirty||this._pendingElevationQueryController!=null}updateRenderLocation(){this._setDirty(),this._updateRenderLocation()}_setDirty(){this._dirty||(this._dirty=!0,this.notifyChange("updating"))}_cancelPendingRequest(){const e=this._pendingElevationQueryController;e&&(this._pendingElevationQueryController=null,e.abort(),this.notifyChange("updating"))}get running(){return!this._pendingElevationQueryController&&this._dirty}runTask(){if(this._cancelPendingRequest(),this._dirty=!1,this.notifyChange("updating"),!this.map||!this.map.ground)return void this._updateSurfaceAltitude(0);const e=this.state.spatialReference;this.renderCoordsHelper.fromRenderCoords(this._camera.eye,this._tmpPoint,e);const t=this._tmpPoint.z>SAe&&this.renderCoordsHelper.viewingMode===Ie.Global&&(e.isWGS84||e.isWebMercator);let r=new AbortController;this.map.ground.queryElevation(this._tmpPoint,{signal:r.signal,cache:this.cache,minDemResolution:t?EAe:0}).then(n=>this._updateSurfaceAltitude(n.geometry.z)).catch(n=>{yo(n)||this._updateSurfaceAltitude(0)}).catch(()=>{}).then(()=>{this._pendingElevationQueryController===r&&(this._pendingElevationQueryController=null,this.notifyChange("updating")),r=null}),this._pendingElevationQueryController=r}_updateSurfaceAltitude(e){this._estimatedSurfaceAltitude!==e&&(this._estimatedSurfaceAltitude=e,this._updateRenderLocation())}_updateRenderLocation(){this.renderCoordsHelper.setAltitude(BM,this._estimatedSurfaceAltitude,this._camera.eye),Oc(this._get("renderLocation"),BM)||(this._set("renderLocation",X(this._propertiesPool.get("renderLocation"),BM)),this.notifyChange("renderLocation"))}};h([p({constructOnly:!0})],No.prototype,"scheduler",void 0),h([p({constructOnly:!0})],No.prototype,"cache",void 0),h([p({constructOnly:!0})],No.prototype,"task",void 0),h([p({constructOnly:!0})],No.prototype,"cameraName",void 0),h([p({readOnly:!0})],No.prototype,"location",null),h([p({constructOnly:!0})],No.prototype,"map",void 0),h([p({readOnly:!0})],No.prototype,"renderLocation",void 0),h([p({readOnly:!0})],No.prototype,"scale",null),h([p({readOnly:!0})],No.prototype,"updating",null),No=h([F("esri.views.3d.support.CameraOnSurface")],No);const BM=P(),SAe=1e5,EAe=1e6,RAe=Array;let to=class extends Kp{constructor(e){super(e),this._propertiesPool=new Od({location:He,renderLocation:RAe},this),this._currentSurfaceAltitude=0,this._latestSurfaceAltitude=0,this.cameraName="camera",this.distance=0,this.renderLocation=P(),this.updating=!1}initialize(){this._frameWorker=this.scheduler.registerTask(this.task,this),this.runTask()}destroy(){this._frameWorker=Os(this._frameWorker),this._propertiesPool=Oe(this._propertiesPool)}get _camera(){return this.state[this.cameraName]}get location(){const e=this._propertiesPool.get("location");return this.renderCoordsHelper.fromRenderCoords(this.renderLocation,e,this.state.spatialReference),e}updateRenderLocation(){this.updating=!0,this._updateRenderLocation()}get estimatedSurfaceAltitude(){return this._latestSurfaceAltitude}get running(){return this.updating}runTask(){this._latestSurfaceAltitude=this.estimateSurfaceAltitudeAtCenter(),this._updateRenderLocation(),this.updating=!1}_updateRenderLocation(){const e=AAe;let t=this._calculateSurfaceIntersection(this._currentSurfaceAltitude,e);const r=this._currentSurfaceAltitude!==this._latestSurfaceAltitude;!t&&r&&(t=this._calculateSurfaceIntersection(this._latestSurfaceAltitude,e),t&&(this._currentSurfaceAltitude=this._latestSurfaceAltitude));const n=OAe;t&&this._latestSurfaceAltitudeChangesDistanceSignificantly(e,n)&&(X(e,n),this._currentSurfaceAltitude=this._latestSurfaceAltitude),t?this.distance=Li(this._camera.eye,e):(Q(e,this._camera.viewForward,this._get("distance")),ce(e,e,this._camera.eye)),Oc(this._get("renderLocation"),e)||this._set("renderLocation",X(this._propertiesPool.get("renderLocation"),e))}_calculateSurfaceIntersection(e,t){const r=this._camera;if(!this.renderCoordsHelper.intersectManifold(r.ray,e,t))return!1;if(this.state.isGlobal){const n=Kt(this.renderCoordsHelper.spatialReference).radius,s=n+e,a=Ml(r.eye),o=a<s*s,l=Li(r.eye,t);if(o&&l>n/4){const c=s-Math.sqrt(a);return Q(t,r.viewForward,c),ce(t,t,r.eye),!0}}else{const n=this.surface.ready?this.surface.extent:null;y(n)&&AR(n,this.surface.spatialReference,A1,this.renderCoordsHelper.spatialReference)&&(t[0]=ue(t[0],A1[0],A1[2]),t[1]=ue(t[1],A1[1],A1[3]))}return!0}_latestSurfaceAltitudeChangesDistanceSignificantly(e,t){if(this._latestSurfaceAltitude===this._currentSurfaceAltitude||e==null)return!1;if(this._calculateSurfaceIntersection(this._latestSurfaceAltitude,t)){if(Wt.TESTS_DISABLE_OPTIMIZATIONS)return!0;const r=this._camera.eye,n=Li(r,e),s=Li(r,t);if(Math.abs(s-n)/n>PAe)return!0}return!1}};h([p({constructOnly:!0})],to.prototype,"scheduler",void 0),h([p({constructOnly:!0})],to.prototype,"task",void 0),h([p({constructOnly:!0})],to.prototype,"cameraName",void 0),h([p()],to.prototype,"distance",void 0),h([p({constructOnly:!0})],to.prototype,"estimateSurfaceAltitudeAtCenter",void 0),h([p({readOnly:!0})],to.prototype,"location",null),h([p({readOnly:!0})],to.prototype,"renderLocation",void 0),h([p()],to.prototype,"updating",void 0),to=h([F("esri.views.3d.support.CenterOnSurface")],to);const PAe=.05,AAe=P(),OAe=P(),A1=Nt();let MAe=class{constructor(e){this._handles=new Vt,this.events=new nn,this._contentLayerViews=e.contentLayerViews,this._handles.add(this._contentLayerViews.on("change",t=>this._layerViewsChanged(t))),this._layerViewsChanged({added:this._contentLayerViews.toArray(),removed:[],moved:[],target:this._contentLayerViews})}destroy(){this._handles&&(this._handles.destroy(),this._handles=null)}_layerViewsChanged(e){e.added.forEach(t=>{t.declaredClass==="esri.views.3d.layers.SceneLayerView3D"&&this._handles.add(t.on("visible-geometry-changed",()=>this._contentChanged()),t.uid)}),e.removed.forEach(t=>this._handles.remove(t.uid))}_contentChanged(){this.events.emit("request-update",IAe)}};const IAe={},LAe=Array;let Th=class extends Kp{constructor(e){super(e),this._propertiesPool=new Od({location:He,renderLocation:LAe},this),this._dirty=!0,this.renderLocation=this._propertiesPool.get("renderLocation")}initialize(){this.handles.add([B(()=>this.centerOnSurface.renderLocation,()=>this.updateRenderLocation()),B(()=>this.state.contentCamera,()=>this.updateRenderLocation())]),this.scheduler&&this.handles.add(this.scheduler.registerTask(dr.POINT_OF_INTEREST_FREQUENT,this))}destroy(){this._propertiesPool.destroy(),this._propertiesPool=null}get updating(){return this._dirty||this.centerOnSurface.updating}get location(){const e=this._propertiesPool.get("location");return this.renderCoordsHelper.fromRenderCoords(this.renderLocation,e,this.state.spatialReference),e}get running(){return this._dirty}runTask(){const e=this._get("renderLocation"),t=this.centerOnSurface.renderLocation,r=this.renderCoordsHelper,n=this.state.contentCamera;this._dirty=!1,r.worldUpAtPosition(t,Xz);const s=Math.max(0,(Math.acos(_e(Xz,n.viewForward))-.5*Math.PI)*(n.aboveGround?1:-1));if(Number.isNaN(s)){if(!e||!Og(e,t)){const c=this._propertiesPool.get("renderLocation");X(c,t),this._set("renderLocation",c)}return}const a=1-ue(s/(.5*Math.PI),0,1),o=a*a*a;this._calculateScreenHorizontalEdgeOnSurface(Qz);const l=this._propertiesPool.get("renderLocation");Bn(l,t,Qz,o),e&&Og(e,l)||this._set("renderLocation",l)}_calculateScreenHorizontalEdgeOnSurface(e){const t=this.state.contentCamera,r=t.getRenderCenter(is());if(r[1]=t.aboveGround?t.padding[Je.BOTTOM]:t.fullHeight-t.padding[Je.TOP],this.estimateSurfaceIntersectionAtRenderPoint(r,e))return e;const n=this.renderCoordsHelper.getAltitude(this.centerOnSurface.renderLocation);if(t.unprojectFromRenderScreen(r,O1)){ae(O1,O1,t.eye);const s=de(O1,O1);if(this.renderCoordsHelper.intersectManifold(zc(t.eye,s),n,e))return e}return this.renderCoordsHelper.setAltitude(e,n,t.eye)}updateRenderLocation(){this._dirty=!0}};h([p()],Th.prototype,"_dirty",void 0),h([p({constructOnly:!0})],Th.prototype,"scheduler",void 0),h([p({constructOnly:!0})],Th.prototype,"centerOnSurface",void 0),h([p({constructOnly:!0})],Th.prototype,"estimateSurfaceIntersectionAtRenderPoint",void 0),h([p({readOnly:!0})],Th.prototype,"updating",null),h([p({readOnly:!0})],Th.prototype,"location",null),h([p({readOnly:!0})],Th.prototype,"renderLocation",void 0),Th=h([F("esri.views.3d.support.pointsOfInterest.Focus")],Th);const Xz=P(),O1=P(),Qz=P();let zu=class extends pe{constructor(e){super(e),this.location=null,this._updateController=null,this._handles=new Vt}get surface(){var e;return(e=this.view.map)==null?void 0:e.ground}get surfaceView(){return this.view.basemapTerrain}get renderLocation(){if(!this.location)return null;const e=P();return this.view.renderCoordsHelper.toRenderCoords(this.location,e),e}initialize(){this.view.state.isLocal&&(this._handles.add([B(()=>{var e,t;return[(e=this.surfaceView)==null?void 0:e.spatialReference,(t=this.surfaceView)==null?void 0:t.extent]},()=>this._update()),wr(()=>{var e;return(e=this.surface)==null?void 0:e.layers},"change",()=>this._update())]),this._update())}destroy(){this._handles.destroy()}_update(){if(this._updateController&&(this._updateController.abort(),this._updateController=null),!this.surfaceView||C(this.surfaceView.extent)||C(this.surfaceView.spatialReference))return void this._set("location",null);const e=CD(this.surfaceView.extent),t=new He({x:e[0],y:e[1],z:0,spatialReference:this.surfaceView.spatialReference});this.surface&&this.surface.layers.length>0?(this._set("location",null),this._updateController=new AbortController,this.surface.queryElevation(t,{noDataValue:0,signal:this._updateController.signal,cache:this.cache}).then(r=>{this._updateController=null,this._set("location",r.geometry)}).catch(r=>{yo(r)||r&&r.name==="elevation-query:invalid-layer"||console.error("StableSurfaceCenter failed to update: ",r)})):this._set("location",t)}};h([p({constructOnly:!0})],zu.prototype,"view",void 0),h([p({constructOnly:!0})],zu.prototype,"cache",void 0),h([p()],zu.prototype,"surface",null),h([p()],zu.prototype,"surfaceView",null),h([p({readOnly:!0})],zu.prototype,"location",void 0),h([p({readOnly:!0})],zu.prototype,"renderLocation",null),zu=h([F("esri.views.3d.terrain.StableSurfaceCenter")],zu);let Bu=class extends pe{constructor(e){super(e),this._handles=new Vt,this._tileGeometryUpdateExtent=Uc(),this._tileGeometryUpdateSpatialReference=null,this.events=new nn,this.updating=!1}initialize(){this._handles.add([this.surface.on("elevation-change",e=>this._tileGeometryChanged(e)),this.scheduler.registerTask(dr.SURFACE_GEOMETRY_UPDATES,this)])}destroy(){this._handles=Oe(this._handles)}get running(){return this.updating}runTask(){this.updating&&(this._centerIntersectsExtent(this._tileGeometryUpdateExtent,this._tileGeometryUpdateSpatialReference)&&this.events.emit("request-update",$Ae),Uc(this._tileGeometryUpdateExtent),this._set("updating",!1))}_tileGeometryChanged(e){this._tileGeometryUpdateSpatialReference=ft(e.spatialReference),um(this._tileGeometryUpdateExtent,e.extent,this._tileGeometryUpdateExtent),this._set("updating",!0)}_furthestCenterOnSurface(){let e=this.centerOnSurfaces[0];for(let t=1;t<this.centerOnSurfaces.length;t++){const r=this.centerOnSurfaces[t];r.distance>e.distance&&(e=r)}return e}_centerIntersectsExtent(e,t){const r=this.state.camera.eye,n=DAe,s=this._furthestCenterOnSurface();return this.renderCoordsHelper.fromRenderCoords(r,xf,t),this.renderCoordsHelper.fromRenderCoords(s.renderLocation,Tf,t),xf[0]<Tf[0]?(n[0]=xf[0],n[2]=Tf[0]):(n[0]=Tf[0],n[2]=xf[0]),xf[1]<Tf[1]?(n[1]=xf[1],n[3]=Tf[1]):(n[1]=Tf[1],n[3]=xf[1]),DR(n,e)}};h([p({constructOnly:!0})],Bu.prototype,"state",void 0),h([p({constructOnly:!0})],Bu.prototype,"centerOnSurfaces",void 0),h([p({constructOnly:!0})],Bu.prototype,"renderCoordsHelper",void 0),h([p({constructOnly:!0})],Bu.prototype,"scheduler",void 0),h([p({constructOnly:!0})],Bu.prototype,"surface",void 0),h([p({readOnly:!0})],Bu.prototype,"updating",void 0),Bu=h([F("esri.views.3d.support.SurfaceGeometryUpdates")],Bu);const $Ae={},xf=P(),Tf=P(),DAe=Uc();let vs=class extends pe{constructor(e){super(e),this._handles=new Vt,this._tmpRay=oo(),this._centerRayDirty=!0,this._surfaceAltitudeAtCenter=0,this._surfaceAltitudeAtCenterDirty=!0,this._contentAltitudeAtCenter=0,this._contentAltitudeAtCenterDirty=!0,this._propertiesPool=new Od({renderPointOfView:FAe},this),this.renderPointOfView=P(),this._pois=new Array,this._debugCenters=new Map}initialize(){var u;const{state:e,basemapTerrain:t,renderCoordsHelper:r,map:n}=this.view;this._surfaceIntersector=Xl(e.viewingMode),e.isGlobal?this._surfaceIntersector.options.backfacesTerrain=!1:this._surfaceIntersector.options.backfacesTerrain=!0,this._surfaceIntersector.options.invisibleTerrain=!1,this._surfaceIntersector.options.store=zn.MIN,this._contentIntersector=Xl(e.viewingMode);const s=()=>this._estimateSurfaceAltitudeAtCenter(),a=this.view.resourceController.scheduler,o=ft((u=this.view.basemapTerrain)==null?void 0:u.elevationQueryCache),l={state:e,scheduler:a,surface:t,renderCoordsHelper:r};this._set("centerOnSurfaceInfrequent",new to({...l,task:dr.POINT_OF_INTEREST_INFREQUENT,estimateSurfaceAltitudeAtCenter:s})),this._set("centerOnSurfaceFrequent",new to({...l,task:dr.POINT_OF_INTEREST_FREQUENT,estimateSurfaceAltitudeAtCenter:s})),this._set("contentCenterOnSurface",new to({...l,task:dr.POINT_OF_INTEREST_INFREQUENT,estimateSurfaceAltitudeAtCenter:s,cameraName:"contentCamera"})),this._set("centerOnContent",new to({...l,task:dr.POINT_OF_INTEREST_FREQUENT,estimateSurfaceAltitudeAtCenter:()=>this._estimateContentAltitudeAtCenter()})),this._set("cameraOnSurface",new No({...l,cache:o,task:dr.POINT_OF_INTEREST_INFREQUENT,map:n})),this._set("contentCameraOnSurface",new No({...l,cache:o,task:dr.POINT_OF_INTEREST_INFREQUENT,map:n,cameraName:"contentCamera"})),this._set("surfaceGeometryUpdates",new Bu({...l,centerOnSurfaces:[this.centerOnSurfaceFrequent,this.centerOnContent,this.centerOnSurfaceInfrequent]})),this._set("contentGeometryUpdates",new MAe({contentLayerViews:this.view.allLayerViews,renderCoordsHelper:r})),this._set("surfaceOrigin",new zu({cache:o,view:this.view})),this._set("focus",new Th({state:e,scheduler:a,surface:t,renderCoordsHelper:r,centerOnSurface:this.contentCenterOnSurface,estimateSurfaceIntersectionAtRenderPoint:(d,m)=>this._estimateSurfaceIntersectionAtRenderPoint(d,this.view.state.contentCamera,m)})),this._pois.push(this.centerOnContent,this.centerOnSurfaceFrequent,this.centerOnSurfaceInfrequent,this.contentCenterOnSurface,this.cameraOnSurface,this.contentCameraOnSurface,this.focus);const c=this.view.graphics;this._debugCenters.set(this.centerOnContent,new $p(c,"red","CenterOnContent")),this._debugCenters.set(this.centerOnSurfaceFrequent,new $p(c,"red","CenterOnSurface")),this._debugCenters.set(this.centerOnSurfaceInfrequent,new $p(c,"red","CenterOnSurface")),this._debugCenters.set(this.contentCenterOnSurface,new $p(c,"red","ContentCenterOnSurface")),this._debugCenters.set(this.cameraOnSurface,new $p(c,"blue","CameraOnSurface")),this._debugCenters.set(this.contentCameraOnSurface,new $p(c,"blue","ContentCameraOnSurface")),this._debugCenters.set(this.focus,new $p(c,"green","Focus")),this._handles.add([B(()=>e.camera,d=>this._cameraChanged(d),ni),B(()=>t.extent,()=>this._updateCenterPointsOfInterest()),cs(()=>!t.updating,()=>this._updateCenterPointsOfInterest(),ni),wr(()=>this.surfaceGeometryUpdates.events,"request-update",()=>this._updateCenterPointsOfInterest()),wr(()=>this.contentGeometryUpdates.events,"request-update",()=>this._updateCenterOnContent()),cs(()=>Wt.SHOW_POI,d=>this._setDebug(d),et)]),this._cameraChanged(this.view.state.camera);for(const d of this._pois)d.runTask()}destroy(){this._setDebug(!1),this._handles.destroy(),this._propertiesPool.destroy();for(const e of this._pois)e.destroy();this.surfaceOrigin.destroy()}get updating(){var e;return!(!((e=this.surfaceGeometryUpdates)!=null&&e.updating)&&!this._pois.some(t=>t.updating))}get _centerRay(){return this._centerRayDirty&&(this._centerRayCached=this.view.sceneIntersectionHelper.getCenterRayWithSubpixelOffset(this.view.state.camera,this._tmpRay),this._centerRayDirty=!1),this._centerRayCached}_estimateContentAltitudeAtCenter(){if(!this._contentAltitudeAtCenterDirty)return this._contentAltitudeAtCenter;this._contentAltitudeAtCenterDirty=!1;const e=this._centerRay;return C(e)||(this.view.sceneIntersectionHelper.intersectRay(e,this._contentIntersector,ty,kAe)?this._contentAltitudeAtCenter=this.view.renderCoordsHelper.getAltitude(ty):this._contentAltitudeAtCenter=this._estimateSurfaceAltitudeAtCenter()),this._contentAltitudeAtCenter}_estimateSurfaceAltitudeAtCenter(){if(!this.view.basemapTerrain)return 0;if(!this._surfaceAltitudeAtCenterDirty)return this._surfaceAltitudeAtCenter;this._surfaceAltitudeAtCenterDirty=!1;const e=this._centerRay;if(C(e))return this._surfaceAltitudeAtCenter;const t=e.origin,r=ce(ty,e.origin,e.direction);return this._surfaceIntersector.resetWithRay(e,this.view.state.camera),this.view.basemapTerrain.intersect(this._surfaceIntersector,null,t,r),this._surfaceIntersector.results.min.getIntersectionPoint(ty)&&(this._surfaceAltitudeAtCenter=this.view.renderCoordsHelper.getAltitude(ty)),this._surfaceAltitudeAtCenter}_estimateSurfaceIntersectionAtRenderPoint(e,t,r){const n=h4(t,e,NAe);if(C(n))return null;const s=n.origin,a=ce(ty,n.origin,n.direction);return this._surfaceIntersector.resetWithRay(n,t),this.view.basemapTerrain.intersect(this._surfaceIntersector,null,s,a),this._surfaceIntersector.results.min.getIntersectionPoint(r)?r:null}_cameraChanged(e){this._updateCenterPointsOfInterest();const t=e.eye;Oc(this.renderPointOfView,t)||this._set("renderPointOfView",X(this._propertiesPool.get("renderPointOfView"),t))}_updateCenterPointsOfInterest(){this._centerRayDirty=!0,this._surfaceAltitudeAtCenterDirty=!0,this._contentAltitudeAtCenterDirty=!0;for(const e of this._pois)e.updateRenderLocation()}_updateCenterOnContent(){this._contentAltitudeAtCenterDirty=!0,this.centerOnContent.updateRenderLocation()}_setDebug(e){if(!e)return this._debugCenters.forEach(t=>t.hide()),void this._handles.remove("debug");for(const t of this._pois)this._handles.add(B(()=>t.renderLocation,r=>this._debugCenters.get(t).show(r,t.renderCoordsHelper.spatialReference),et),"debug")}get test(){return{update:()=>{this.surfaceGeometryUpdates.runTask();for(const e of this._pois)e.runTask()},surfaceGeometryUpdates:this.surfaceGeometryUpdates}}};h([p({readOnly:!0})],vs.prototype,"centerOnContent",void 0),h([p({readOnly:!0})],vs.prototype,"centerOnSurfaceFrequent",void 0),h([p({readOnly:!0})],vs.prototype,"centerOnSurfaceInfrequent",void 0),h([p({readOnly:!0})],vs.prototype,"contentCenterOnSurface",void 0),h([p({readOnly:!0})],vs.prototype,"cameraOnSurface",void 0),h([p({readOnly:!0})],vs.prototype,"contentCameraOnSurface",void 0),h([p({readOnly:!0})],vs.prototype,"focus",void 0),h([p({readOnly:!0})],vs.prototype,"renderPointOfView",void 0),h([p({readOnly:!0})],vs.prototype,"surfaceOrigin",void 0),h([p({readOnly:!0})],vs.prototype,"contentGeometryUpdates",void 0),h([p({readOnly:!0})],vs.prototype,"surfaceGeometryUpdates",void 0),h([p({constructOnly:!0})],vs.prototype,"view",void 0),h([p({readOnly:!0})],vs.prototype,"updating",null),vs=h([F("esri.views.3d.support.PointsOfInterest")],vs);const FAe=Array,ty=P(),NAe=oo(),kAe={exclude:new Set([Ac])};let VAe=class{constructor(e){this._store=e}destroy(){this._store.destroy()}get(e){return this._store.get(e)}put(e,t){this._store.put(e,t,t.values.byteLength+256)}},UAe=class{constructor(e){this.xTile=0,this.yTile=0,this.hash=0,this.priority=1,this.colliders=[],this.textVertexRanges=[],this.iconVertexRanges=[],this.tile=e}},D7e=class{constructor(){this.tileSymbols=[],this.parts=[{startTime:0,startOpacity:0,targetOpacity:0,show:!1},{startTime:0,startOpacity:0,targetOpacity:0,show:!1}],this.show=!1}};function N7e(i,e,t,r,n,s){const a=t-n;if(a>=0)return(e>>a)+(r-(s<<a))*(i>>a);const o=-a;return e-(s-(r<<o))*(i>>o)<<o}let k7e=class{constructor(e,t,r){this._rows=Math.ceil(t/r),this._columns=Math.ceil(e/r),this._cellSize=r,this.cells=new Array(this._rows);for(let n=0;n<this._rows;n++){this.cells[n]=new Array(this._columns);for(let s=0;s<this._columns;s++)this.cells[n][s]=[]}}getCell(e,t){const r=Math.min(Math.max(Math.floor(t/this._cellSize),0),this._rows-1),n=Math.min(Math.max(Math.floor(e/this._cellSize),0),this._columns-1);return this.cells[r]&&this.cells[r][n]||null}getCellSpan(e,t,r,n){return[Math.min(Math.max(Math.floor(e/this._cellSize),0),this.columns-1),Math.min(Math.max(Math.floor(t/this._cellSize),0),this.rows-1),Math.min(Math.max(Math.floor(r/this._cellSize),0),this.columns-1),Math.min(Math.max(Math.floor(n/this._cellSize),0),this.rows-1)]}get cellSize(){return this._cellSize}get columns(){return this._columns}get rows(){return this._rows}};function zAe(i,e,t,r,n,s){const a=e[r++];for(let o=0;o<a;o++){const l=new UAe(s);l.xTile=e[r++],l.yTile=e[r++],l.hash=e[r++],l.priority=e[r++];const c=e[r++];for(let m=0;m<c;m++){const f=e[r++],_=e[r++],g=e[r++],w=e[r++],v=!!e[r++],b=e[r++],x=t[r++],T=t[r++],R=e[r++],E=e[r++];l.colliders.push({xTile:f,yTile:_,dxPixels:g,dyPixels:w,hard:v,partIndex:b,width:R,height:E,minLod:x,maxLod:T})}const u=i[r++];for(let m=0;m<u;m++)l.textVertexRanges.push([i[r++],i[r++]]);const d=i[r++];for(let m=0;m<d;m++)l.iconVertexRanges.push([i[r++],i[r++]]);n.push(l)}return r}function U7e(i,e,t){for(const[r,n]of i.symbols)BAe(i,e,t,n,r)}function BAe(i,e,t,r,n){const s=i.layerData.get(n);if(s.type===xl.SYMBOL){for(const a of r){const o=a.unique;let l;if(a.selectedForRendering){const c=o.parts[0],u=c.startOpacity,d=c.targetOpacity;i.allSymbolsFadingOut=i.allSymbolsFadingOut&&d===0;const m=t?Math.floor(127*u)|d<<7:d?255:0;l=m<<24|m<<16|m<<8|m}else l=0;for(const[c,u]of a.iconVertexRanges)for(let d=c;d<c+u;d+=4)s.iconOpacity[d/4]=l;if(a.selectedForRendering){const c=o.parts[1],u=c.startOpacity,d=c.targetOpacity;i.allSymbolsFadingOut=i.allSymbolsFadingOut&&d===0;const m=t?Math.floor(127*u)|d<<7:d?255:0;l=m<<24|m<<16|m<<8|m}else l=0;for(const[c,u]of a.textVertexRanges)for(let d=c;d<c+u;d+=4)s.textOpacity[d/4]=l}s.lastOpacityUpdate=e,s.opacityChanged=!0}}let ZP=class{constructor(e,t){this.layerUIDs=[],this.isDestroyed=!1,this._data=e,this.memoryUsed=e.byteLength;let r=1;const n=new Uint32Array(e);this.layerUIDs=[];const s=n[r++];for(let a=0;a<s;a++)this.layerUIDs[a]=n[r++];this.bufferDataOffset=r,t&&(this.layer=t.getStyleLayerByUID(this.layerUIDs[0]))}get isPreparedForRendering(){return C(this._data)}get offset(){return this.bufferDataOffset}destroy(){this.isDestroyed||(this.doDestroy(),this.isDestroyed=!0)}prepareForRendering(e){C(this._data)||(this.doPrepareForRendering(e,this._data,this.bufferDataOffset),this._data=null)}},GAe=class extends ZP{constructor(e,t){super(e,t),this.type=xl.LINE,this.lineIndexStart=0,this.lineIndexCount=0;const r=new Uint32Array(e);let n=this.bufferDataOffset;this.lineIndexStart=r[n++],this.lineIndexCount=r[n++];const s=r[n++];if(s>0){const a=new Map;for(let o=0;o<s;o++){const l=r[n++],c=r[n++],u=r[n++];a.set(l,[c,u])}this.patternMap=a}this.bufferDataOffset=n}hasData(){return this.lineIndexCount>0}triangleCount(){return this.lineIndexCount/3}doDestroy(){y(this.lineVertexArrayObject)&&this.lineVertexArrayObject.dispose(),y(this.lineVertexBuffer)&&this.lineVertexBuffer.dispose(),y(this.lineIndexBuffer)&&this.lineIndexBuffer.dispose(),this.lineVertexArrayObject=null,this.lineVertexBuffer=null,this.lineIndexBuffer=null,this.memoryUsed=0}doPrepareForRendering(e,t,r){const n=new Uint32Array(t),s=new Int32Array(n.buffer),a=n[r++];this.lineVertexBuffer=ui.createVertex(e,mi.STATIC_DRAW,new Int32Array(s.buffer,4*r,a)),r+=a;const o=n[r++];this.lineIndexBuffer=ui.createIndex(e,mi.STATIC_DRAW,new Uint32Array(n.buffer,4*r,o)),r+=o;const l=this.layer.lineMaterial;this.lineVertexArrayObject=new Gc(e,l.getAttributeLocations(),l.getLayoutInfo(),{geometry:this.lineVertexBuffer},this.lineIndexBuffer)}},HAe=class extends ZP{constructor(e,t){super(e,t),this.type=xl.FILL,this.fillIndexStart=0,this.fillIndexCount=0,this.outlineIndexStart=0,this.outlineIndexCount=0;const r=new Uint32Array(e);let n=this.bufferDataOffset;this.fillIndexStart=r[n++],this.fillIndexCount=r[n++],this.outlineIndexStart=r[n++],this.outlineIndexCount=r[n++];const s=r[n++];if(s>0){const a=new Map;for(let o=0;o<s;o++){const l=r[n++],c=r[n++],u=r[n++];a.set(l,[c,u])}this.patternMap=a}this.bufferDataOffset=n}hasData(){return this.fillIndexCount>0||this.outlineIndexCount>0}triangleCount(){return(this.fillIndexCount+this.outlineIndexCount)/3}doDestroy(){y(this.fillVertexArrayObject)&&this.fillVertexArrayObject.dispose(),y(this.fillVertexBuffer)&&this.fillVertexBuffer.dispose(),y(this.fillIndexBuffer)&&this.fillIndexBuffer.dispose(),this.fillVertexArrayObject=null,this.fillVertexBuffer=null,this.fillIndexBuffer=null,y(this.outlineVertexArrayObject)&&this.outlineVertexArrayObject.dispose(),y(this.outlineVertexBuffer)&&this.outlineVertexBuffer.dispose(),y(this.outlineIndexBuffer)&&this.outlineIndexBuffer.dispose(),this.outlineVertexArrayObject=null,this.outlineVertexBuffer=null,this.outlineIndexBuffer=null,this.memoryUsed=0}doPrepareForRendering(e,t,r){const n=new Uint32Array(t),s=new Int32Array(n.buffer),a=n[r++];this.fillVertexBuffer=ui.createVertex(e,mi.STATIC_DRAW,new Int32Array(s.buffer,4*r,a)),r+=a;const o=n[r++];this.fillIndexBuffer=ui.createIndex(e,mi.STATIC_DRAW,new Uint32Array(n.buffer,4*r,o)),r+=o;const l=n[r++];this.outlineVertexBuffer=ui.createVertex(e,mi.STATIC_DRAW,new Int32Array(s.buffer,4*r,l)),r+=l;const c=n[r++];this.outlineIndexBuffer=ui.createIndex(e,mi.STATIC_DRAW,new Uint32Array(n.buffer,4*r,c)),r+=c;const u=this.layer,d=u.fillMaterial,m=u.outlineMaterial;this.fillVertexArrayObject=new Gc(e,d.getAttributeLocations(),d.getLayoutInfo(),{geometry:this.fillVertexBuffer},this.fillIndexBuffer),this.outlineVertexArrayObject=new Gc(e,m.getAttributeLocations(),m.getLayoutInfo(),{geometry:this.outlineVertexBuffer},this.outlineIndexBuffer)}},jAe=class extends ZP{constructor(e,t,r){super(e,t),this.type=xl.SYMBOL,this.iconPerPageElementsMap=new Map,this.glyphPerPageElementsMap=new Map,this.symbolInstances=[],this.isIconSDF=!1,this.opacityChanged=!1,this.lastOpacityUpdate=0,this.symbols=[];const n=new Uint32Array(e),s=new Int32Array(e),a=new Float32Array(e);let o=this.bufferDataOffset;this.isIconSDF=!!n[o++];const l=n[o++];for(let m=0;m<l;m++){const f=n[o++],_=n[o++],g=n[o++];this.iconPerPageElementsMap.set(f,[_,g])}const c=n[o++];for(let m=0;m<c;m++){const f=n[o++],_=n[o++],g=n[o++];this.glyphPerPageElementsMap.set(f,[_,g])}const u=n[o++],d=n[o++];this.iconOpacity=new Int32Array(u),this.textOpacity=new Int32Array(d),o=zAe(n,s,a,o,this.symbols,r),this.bufferDataOffset=o}hasData(){return this.iconPerPageElementsMap.size>0||this.glyphPerPageElementsMap.size>0}triangleCount(){let e=0;for(const[t,r]of this.iconPerPageElementsMap)e+=r[1];for(const[t,r]of this.glyphPerPageElementsMap)e+=r[1];return e/3}doDestroy(){y(this.iconVertexArrayObject)&&this.iconVertexArrayObject.dispose(),y(this.iconVertexBuffer)&&this.iconVertexBuffer.dispose(),y(this.iconOpacityBuffer)&&this.iconOpacityBuffer.dispose(),y(this.iconIndexBuffer)&&this.iconIndexBuffer.dispose(),this.iconVertexArrayObject=null,this.iconVertexBuffer=null,this.iconOpacityBuffer=null,this.iconIndexBuffer=null,y(this.textVertexArrayObject)&&this.textVertexArrayObject.dispose(),y(this.textVertexBuffer)&&this.textVertexBuffer.dispose(),y(this.textOpacityBuffer)&&this.textOpacityBuffer.dispose(),y(this.textIndexBuffer)&&this.textIndexBuffer.dispose(),this.textVertexArrayObject=null,this.textVertexBuffer=null,this.textOpacityBuffer=null,this.textIndexBuffer=null,this.memoryUsed=0}updateOpacityInfo(){if(!this.opacityChanged)return;this.opacityChanged=!1;const e=ft(this.iconOpacity),t=ft(this.iconOpacityBuffer);e.length>0&&e.byteLength===t.size&&t.setSubData(e,0,0,e.length);const r=ft(this.textOpacity),n=ft(this.textOpacityBuffer);r.length>0&&r.byteLength===n.size&&n.setSubData(r,0,0,r.length)}doPrepareForRendering(e,t,r){const n=new Uint32Array(t),s=new Int32Array(n.buffer),a=n[r++];this.iconVertexBuffer=ui.createVertex(e,mi.STATIC_DRAW,new Int32Array(s.buffer,4*r,a)),r+=a;const o=n[r++];this.iconIndexBuffer=ui.createIndex(e,mi.STATIC_DRAW,new Uint32Array(n.buffer,4*r,o)),r+=o;const l=n[r++];this.textVertexBuffer=ui.createVertex(e,mi.STATIC_DRAW,new Int32Array(s.buffer,4*r,l)),r+=l;const c=n[r++];this.textIndexBuffer=ui.createIndex(e,mi.STATIC_DRAW,new Uint32Array(n.buffer,4*r,c)),r+=c,this.iconOpacityBuffer=ui.createVertex(e,mi.STATIC_DRAW,ft(this.iconOpacity).buffer),this.textOpacityBuffer=ui.createVertex(e,mi.STATIC_DRAW,ft(this.textOpacity).buffer);const u=this.layer,d=u.iconMaterial,m=u.textMaterial;this.iconVertexArrayObject=new Gc(e,d.getAttributeLocations(),d.getLayoutInfo(),{geometry:this.iconVertexBuffer,opacity:this.iconOpacityBuffer},this.iconIndexBuffer),this.textVertexArrayObject=new Gc(e,m.getAttributeLocations(),m.getLayoutInfo(),{geometry:this.textVertexBuffer,opacity:this.textOpacityBuffer},this.textIndexBuffer)}},qAe=class extends ZP{constructor(e,t){super(e,t),this.type=xl.CIRCLE,this.circleIndexStart=0,this.circleIndexCount=0;const r=new Uint32Array(e);let n=this.bufferDataOffset;this.circleIndexStart=r[n++],this.circleIndexCount=r[n++],this.bufferDataOffset=n}hasData(){return this.circleIndexCount>0}triangleCount(){return this.circleIndexCount/3}doDestroy(){y(this.circleVertexArrayObject)&&this.circleVertexArrayObject.dispose(),y(this.circleVertexBuffer)&&this.circleVertexBuffer.dispose(),y(this.circleIndexBuffer)&&this.circleIndexBuffer.dispose(),this.circleVertexArrayObject=null,this.circleVertexBuffer=null,this.circleIndexBuffer=null,this.memoryUsed=0}doPrepareForRendering(e,t,r){const n=new Uint32Array(t),s=new Int32Array(n.buffer),a=n[r++];this.circleVertexBuffer=ui.createVertex(e,mi.STATIC_DRAW,new Int32Array(s.buffer,4*r,a)),r+=a;const o=n[r++];this.circleIndexBuffer=ui.createIndex(e,mi.STATIC_DRAW,new Uint32Array(n.buffer,4*r,o)),r+=o;const l=this.layer.circleMaterial;this.circleVertexArrayObject=new Gc(e,l.getAttributeLocations(),l.getLayoutInfo(),{geometry:this.circleVertexBuffer},this.circleIndexBuffer)}},GM=class fJ extends Wae{constructor(e,t,r,n,s,a,o,l=null){super(e,t,r,n,s,a,4096,4096),this._memCache=l,this.type="vector-tile",this._referenced=0,this._hasSymbolBuckets=!1,this._memoryUsedByLayerData=0,this.layerData=new Map,this.layerCount=0,this.status="loading",this.allSymbolsFadingOut=!1,this.lastOpacityUpdate=0,this.symbols=new Map,this.isCoverage=!1,this.neededForCoverage=!1,this.decluttered=!1,this.invalidating=!1,this.parentTile=null,this.childrenTiles=new Set,this._processed=!1,this._referenced=1,this.styleRepository=o,this.id=e.id}get hasSymbolBuckets(){return this._hasSymbolBuckets}get isFading(){return this._hasSymbolBuckets&&performance.now()-this.lastOpacityUpdate<yk}get isHoldingForFade(){return this._hasSymbolBuckets&&(!this.allSymbolsFadingOut||performance.now()-this.lastOpacityUpdate<yk)}get wasRequested(){return this.status==="errored"||this.status==="loaded"||this.status==="reloading"}setData(e){this.changeDataImpl(e),this.requestRender(),this.ready(),this.invalidating=!1,this._processed=!0}deleteLayerData(e){let t=!1;for(const r of e)if(this.layerData.has(r)){const n=this.layerData.get(r);this._memoryUsedByLayerData-=n.memoryUsed,n.type===xl.SYMBOL&&this.symbols.has(r)&&(this.symbols.delete(r),t=!0),n.destroy(),this.layerData.delete(r),this.layerCount--}y(this._memCache)&&this._memCache.updateSize(this.key.id,this,this._memoryUsedByLayerData),t&&this.emit("symbols-changed"),this.requestRender()}processed(){return this._processed}hasData(){return this.layerCount>0}dispose(){this.status!=="unloaded"&&(gJ.delete(this),fJ._destroyRenderBuckets(this.layerData),this.layerData=null,this.layerCount=0,this._memoryUsedByLayerData=0,this.destroy(),this.status="unloaded")}release(){return--this._referenced==0&&(this.dispose(),this.stage=null,!0)}retain(){++this._referenced}get referenced(){return this._referenced}get memoryUsage(){return(this._memoryUsedByLayerData+256)/(this._referenced||1)}changeDataImpl(e){let t=!1;if(e){const{bucketsWithData:r,emptyBuckets:n}=e,s=this._createRenderBuckets(r);if(n&&n.byteLength>0){const a=new Uint32Array(n);for(const o of a)this._deleteLayerData(o)}for(const[a,o]of s)this._deleteLayerData(a),o.type===xl.SYMBOL&&(this.symbols.set(a,o.symbols),t=!0),this._memoryUsedByLayerData+=o.memoryUsed,this.layerData.set(a,o),this.layerCount++;y(this._memCache)&&this._memCache.updateSize(this.key.id,this,this._memoryUsedByLayerData)}this._hasSymbolBuckets=!1;for(const[r,n]of this.layerData)n.type===xl.SYMBOL&&(this._hasSymbolBuckets=!0);t&&this.emit("symbols-changed")}attachWithContext(e){this.stage={context:e,trashDisplayObject(t){t.processDetach()},untrashDisplayObject:()=>!1}}setTransform(e){super.setTransform(e);const t=this.resolution/(e.resolution*e.pixelRatio),r=this.width/this.rangeX*t,n=this.height/this.rangeY*t,s=[0,0];e.toScreen(s,[this.x,this.y]);const a=this.transforms.tileUnitsToPixels;_G(a),OI(a,a,s),yG(a,a,Math.PI*e.rotation/180),bG(a,a,[r,n,1])}_createTransforms(){return{dvs:hm(),tileMat3:hm(),tileUnitsToPixels:hm()}}static _destroyRenderBuckets(e){if(!e)return;const t=new Set;e.forEach(r=>{t.has(r)||(r.destroy(),t.add(r))}),e.clear()}_createRenderBuckets(e){const t=new Map,r=new Map;for(const n of e){const s=this._deserializeBucket(n,r);for(const a of s.layerUIDs)t.set(a,s)}return t}_deserializeBucket(e,t){let r=t.get(e);if(r)return r;switch(new Uint32Array(e)[0]){case xl.FILL:r=new HAe(e,this.styleRepository);break;case xl.LINE:r=new GAe(e,this.styleRepository);break;case xl.SYMBOL:r=new jAe(e,this.styleRepository,this);break;case xl.CIRCLE:r=new qAe(e,this.styleRepository)}return t.set(e,r),r}_deleteLayerData(e){if(!this.layerData.has(e))return;const t=this.layerData.get(e);this._memoryUsedByLayerData-=t.memoryUsed,t.destroy(),this.layerData.delete(e),this.layerCount--}};const gJ=new Map;function WAe(){gJ.forEach((i,e)=>{console.log(`
${e.key}:`),i[0].forEach(t=>console.log(t)),console.log("========"),i[1].forEach(t=>console.log(t))})}const q7e={value:.5,readOnly:!0},XAe={readOnly:!0,value:.5,get(){return this.updating?this.updatingProgressValue:1}};let x0=class{constructor(e=0,t=0){this.min=e,this.max=t,this.level=0,this.hasNoDataValues=!1}copyFrom(e){this.min=e.min,this.max=e.max,this.level=e.level,this.hasNoDataValues=e.hasNoDataValues}},QAe=class{constructor(e,t,r){this.type="elevation",this.level=e[0],this.i=e[1],this.j=e[2],this.extent=t;const n=r.noDataValue,s=r.values;let a=1/0,o=-1/0,l=!0,c=!1;for(let u=0;u<s.length;u++){const d=s[u];d!==n?(a=d<a?d:a,o=d>o?d:o,l=!1):c=!0}l&&(a=0,o=0),o=o>-3e38?o:0,this.samplerData=new dne(r,t),this.bounds=[a,o],this.hasNoDataValues=c}release(){this.samplerData=null,this.bounds=null}computeMinMaxValue(e,t,r,n){n.min=1/0,n.max=-1/0,n.hasNoDataValues=!1;const s=e-this.level;if(s<=0)return n;const a=2**s;if(!(Math.floor(t/a)===this.i&&Math.floor(r/a)===this.j))return n;let o=1/0,l=-1/0;const c=this.samplerData.width,u=this.samplerData.pixelData,d=.5*lx;let m=(c-1)/a,f=(r-this.j*a)*m,_=(t-this.i*a)*m;if(m<1){const g=Math.floor(f),w=Math.floor(_),v=g+w*c,b=u[v],x=u[v+1],T=u[v+c],R=u[v+c+1];if(b+x+T+R<d){const E=f-g,O=_-w,$=ZT(b,x,T,R,E,O),D=ZT(b,x,T,R,E+m,O),I=ZT(b,x,T,R,E,O+m),G=ZT(b,x,T,R,E+m,O+m);return n.min=Math.min($,D,I,G),n.max=Math.max($,D,I,G),n}f=g,_=w,m=1}else f=Math.floor(f),_=Math.floor(_),m=Math.ceil(m);for(let g=f;g<=f+m;g++)for(let w=_;w<=_+m;w++){const v=u[g+w*c];v<d?(o=Math.min(o,v),l=Math.max(l,v)):n.hasNoDataValues=!0}return n.min=o,n.max=l,n}};const ZAe=.5*lx;function Ei(i,e,t){if(C(t))return null;for(const r of t){if(!r)continue;const n=r.safeWidth;let s=ue(r.dy*(r.y1-e),0,n),a=ue(r.dx*(i-r.x0),0,n);const o=Math.floor(s),l=Math.floor(a),c=r.width,u=o*c+l,d=r.pixelData,m=d[u],f=d[u+1],_=u+c,g=d[_],w=d[_+1];if(m+g+f+w<ZAe){s-=o,a-=l;const v=m+(f-m)*a;return v+(g+(w-g)*a-v)*s}}return null}let vl=class extends pe{constructor(e){super(e),this._handles=new Vt}initialize(){this._handles.add([this.layerViews.on("change",()=>this.notifyChange("stencilEnabledExtents"))])}destroy(){this._handles.destroy(),this._handles=null}get layerViewsExtent(){return this._computeLayerViewsExtent()}get tiledLayersExtent(){return this._computeTiledLayersExtent()}get stencilEnabledExtents(){return this._computeStencilEnabledExtents()}_computeStencilEnabledExtents(){const e=[];return this.layerViews.forEach(t=>{const r=t.layer;if(r.operationalLayerType==="IntegratedMeshLayer"&&this.viewSpatialReference!=null){const n=_J(r.fullExtent,this.viewSpatialReference);y(n)&&e.push(ww(n))}}),e}};function YAe(i,e){return i===Ie.Global?new A$(e):new O$(e)}h([p({readOnly:!0})],vl.prototype,"layerViewsExtent",null),h([p({readOnly:!0})],vl.prototype,"tiledLayersExtent",null),h([p({readOnly:!0})],vl.prototype,"stencilEnabledExtents",null),h([p()],vl.prototype,"viewSpatialReference",void 0),h([p()],vl.prototype,"tilingScheme",void 0),h([p()],vl.prototype,"defaultTiledLayersExtent",void 0),h([p({constructOnly:!0})],vl.prototype,"layers",void 0),h([p({constructOnly:!0})],vl.prototype,"layerViews",void 0),vl=h([F("esri.views.3d.terrain.ExtentHelper")],vl);let A$=class extends vl{_computeLayerViewsExtent(){return this._globalExtent}_computeTiledLayersExtent(){return this._globalExtent}get _globalExtent(){return this.viewSpatialReference.isWebMercator?qQ:m0e}};A$=h([F("esri.views.3d.terrain.ExtentHelperGlobal")],A$);let O$=class extends vl{_computeLayerViewsExtent(){const e=Uc(),t=this.viewSpatialReference;this.layerViews.forEach(s=>{const a=s.layer;if(s.isResolved()&&(a.type!=="graphics"||!a.internal)){const o=_J("fullExtentInLocalViewSpatialReference"in s&&s.fullExtentInLocalViewSpatialReference||s.layer.fullExtent,t);um(e,o,e)}});const r=MI(e)?e:null,n=this._get("layerViewsExtent");return fg(r,n)?n:r}_computeTiledLayersExtent(){const e=this.tilingScheme;if(!e)return null;const t=this.viewSpatialReference,r=Uc();this.layers.forEach(a=>{if(a.loaded&&Fb(a)){const o=QP(a,t,Ie.Local);if(C(o))return;const{tileInfo:l,fullExtent:c}=o;y(l)&&y(c)&&(vR(a)||e.compatibleWith(l)&&c.spatialReference.equals(e.spatialReference))&&um(r,c,r)}}),um(r,this.defaultTiledLayersExtent,r);const n=MI(r)?r:null,s=this._get("tiledLayersExtent");return fg(n,s)?s:n}};function _J(i,e){return y(i)&&!i.spatialReference.equals(e)?Yte(i,i.spatialReference,e):i}O$=h([F("esri.views.3d.terrain.ExtentHelperLocal")],O$);var vt;(function(i){i[i.ELEVATION=0]="ELEVATION",i[i.MAP=1]="MAP"})(vt||(vt={}));const Gf=[vt.ELEVATION,vt.MAP];function yJ(){var e;const i=(e=globalThis.require)==null?void 0:e.modules;if(i){const t=Object.keys(i);for(const r of t)r.search(".glsl")!==-1&&delete i[r]}}const KAe=[[-.1,-2,3.9,2],[-.1,-3.9,3.9,.1],[-2,-3.9,2,.1],[-3.9,-3.9,.1,.1],[-3.9,-2,.1,2],[-3.9,-.1,.1,3.9],[-2,-.1,2,3.9],[-.1,-.1,3.9,3.9]];let fp,fa=class extends pe{constructor(e){super(e),this._handles=new Vt,this._spatialReference=null,this._renderSR=null,this._overlaySREqualsRenderSR=!0,this._drapeSources=new Set,this._drapeTargets=new Set,this._placementDirty=!1,this._contentUpdated=!1,this._drawTexturesDirty=!1,this._drawTexturesAnimateDirty=!1,this._hasUnusedRenderTargets=!1,this._longitudeCyclical=null,this._latestOriginId=0,this._maxResolution=Ot("esri-mobile")?2048:4096,this._animationTimeLast=0}get running(){return this._placementDirty&&(this._drapeSources.size>0||this._view.graphics.length>0||Wt.OVERLAY_DRAW_DEBUG_TEXTURE)&&!!this._spatialReference&&!this.suspended&&this.surface.ready}get _isSpherical(){return this._view.state.isGlobal}get _worldToPCSRatio(){return y(this._spatialReference)&&this._spatialReference.isGeographic&&!this._view.state.isLocal?Kt(this._spatialReference).metersPerDegree:1}get _view(){return this.surface.view}get suspended(){return this.surface.suspended}get updating(){return this.running||this.renderer.updating||this._contentUpdated}get hasHighlights(){return this.renderer.hasHighlights}get rendersOccluded(){return this.renderer.rendersOccluded}initialize(){var t;const e=this._view;this.renderer=new wh({view:e,worldToPCSRatio:this._worldToPCSRatio,spatialReference:this._spatialReference}),this._groundIntersector=Xl(this._view.state.viewingMode),this._groundIntersector.options.backfacesTerrain=!0,this._groundIntersector.options.invisibleTerrain=!0,this._groundIntersector.options.hud=!1,this._handles.add([this.renderer.events.on("has-highlights",()=>{this.setDrawTexturesDirty(),this.notifyChange("hasHighlights")}),this.renderer.events.on("has-water",r=>{var n;return(n=e._stage)==null?void 0:n.renderView.setRenderParameters({hasOverlayWater:r})}),this.renderer.events.on("renders-occluded",()=>{this.setDrawTexturesDirty(),this.notifyChange("rendersOccluded")}),this.renderer.events.on("content-changed",()=>this.setDrawTexturesDirty()),this.renderer.events.on("textures-disposed",()=>this.updateOverlayResult()),B(()=>{var r,n,s;return[(r=e.pointsOfInterest)==null?void 0:r.renderPointOfView,(s=(n=e.pointsOfInterest)==null?void 0:n.centerOnSurfaceFrequent)==null?void 0:s.location]},()=>this.setPlacementDirty()),B(()=>{var r;return(r=e.state)==null?void 0:r.pixelRatio},()=>this.setPlacementDirty(),ni),this.surface.on("elevation-change",()=>this.setPlacementDirty()),e.on("resize",()=>this.setPlacementDirty()),e.resourceController.scheduler.registerTask(dr.OVERLAY,this),e._stage.renderView.events.on("force-camera-for-screenshot",r=>{this._updateOverlays(r,vr.BACKGROUND),this.renderer.hasOverlays&&this._drawOverlayTextures(this.renderer.overlays,vr.BACKGROUND,r)})]),(t=e._stage)==null||t.renderView.setRenderParameters({renderOverlay:r=>{this._contentUpdated=!1,this.renderer.processSyncDrapeSources(),this.renderer.hasOverlays&&(this._dispatchAnimationUpdate(r),this._drawOverlayTextures(this.renderer.overlays,vr.UPDATE)),this._hasUnusedRenderTargets&&this._collectUnusedRenderTargetMemory()}})}destroy(){this.renderer.dispose(),this._handles&&(this._handles.destroy(),this._handles=null),y(fp)&&(fp.hide(),fp=null)}get hasOverlays(){return this.renderer.hasOverlays}setSpatialReference(e){this._spatialReference=e,this.renderer.spatialReference=e,this._longitudeCyclical=null;const t=this._view.renderSpatialReference;y(e)&&y(t)?(this._renderSR=t,this._overlaySREqualsRenderSR=e.equals(this._renderSR),this._isSpherical&&(this._longitudeCyclical=e.isWebMercator?new gw(-20037508342787e-6,20037508342787e-6):new gw(-180,180),this.renderer.longitudeCyclical=this._longitudeCyclical),this.renderer&&(this.renderer.worldToPCSRatio=this._worldToPCSRatio)):this.renderer.disposeOverlays()}get gpuMemoryUsage(){return this.renderer.gpuMemoryUsage}registerDrapeSource(e,t,r){this._drapeSources.add(e),this.renderer.ensureOverlays(this._drapeTargets,this._drapeSources);const n=this.renderer.createDrapeSourceRenderer(e,t,r);return this._updateDrapeSourceExtent(e),this._setContentDirty(),this.notifyChange("running"),n}registerGeometryDrapeSource(e){return this.registerDrapeSource(e,Oh)}_updateDrapeSourceExtent(e){this.renderer.overlays.length===2&&y(e.setDrapingExtent)&&y(this._spatialReference)&&e.setDrapingExtent(this.renderer.overlays,this._spatialReference)}unregisterDrapeSource(e){this._drapeSources.has(e)&&(this._drapeSources.delete(e),this.renderer.removeDrapeSourceRenderer(e),this.renderer.ensureDrapeSources(this._drapeSources),this._setContentDirty(),this.notifyChange("running"))}registerDrapeTarget(e){this._drapeTargets.add(e),this.renderer.ensureOverlays(this._drapeTargets,this._drapeSources)}updateOverlayResult(){var e;(e=this._view._stage)==null||e.renderView.setRenderParameters({overlays:this.renderer.overlays})}unregisterDrapeTarget(e){this._drapeTargets.delete(e),this.renderer.ensureDrapeTargets(this._drapeTargets)}_setContentDirty(){this.setPlacementDirty(),this.setDrawTexturesDirty()}setPlacementDirty(){this._placementDirty=!0}runTask(){this._updateOverlays(this._view.state.camera,vr.UPDATE)}_updateOverlays(e,t){if(!this._spatialReference)return;const r=LCe(e.fullWidth,e.fullHeight,this._maxResolution);this._computeOverlayExtents(e,r,Au);const n=Nh(Au.inner)/Nh(Au.outer);this.renderer.ensureOverlays(this._drapeTargets,this._drapeSources);const s=this._updateOverlay(ki.INNER,Au.inner,r,1*Au.pixelRatioAdjustment,Au.mapUnitsPerPixel),a=this._updateOverlay(ki.OUTER,Au.outer,r,n*Au.pixelRatioAdjustment,Au.mapUnitsPerPixel);s!==Mh.EXTENT&&a!==Mh.EXTENT||(this._drapeSources.forEach(o=>this._updateDrapeSourceExtent(o)),this.surface.updateTileOverlayParams(t)),s===Mh.NONE&&a===Mh.NONE||this.setDrawTexturesDirty(),this._placementDirty=!1}_updateOverlay(e,t,r,n,s){if(this.renderer.overlays.length===0)return Mh.NONE;const a=this.renderer.overlays[e],o=a.mapUnitsPerPixel;if(a.mapUnitsPerPixel=s,a.pixelRatio=n,JAe(t,a.extent)&&r===a.resolution)return o===s?Mh.NONE:Mh.RERENDER_ONLY;xw(a.extent,t),a.resolution=r;const l=CD(a.extent);return a.renderLocalOrigin=aw(l[0],l[1],0,"OV_"+this._latestOriginId++),Mh.EXTENT}setTileParameters(e){const t=e.renderData.overlay;if(this.renderer.overlays.length>0){const r=this.renderer.overlays[ki.INNER],n=this.renderer.overlays[ki.OUTER],s=e.extent;this._rectInsideRect(r.extent,s)||this._rectanglesOverlap(s,r.extent)||this._rectanglesOverlap(s,n.extent)?(this._setTileOverlayData(s,ki.INNER,t),this._setTileOverlayData(s,ki.OUTER,t)):(this._clearTileOverlayData(ki.INNER,t),this._clearTileOverlayData(ki.OUTER,t))}else this._clearTileOverlayData(ki.INNER,t),this._clearTileOverlayData(ki.OUTER,t)}overlayPixelSizeInMapUnits(e){if(this.renderer.overlays.length===0)return 0;const t=this.renderer.overlays[ki.INNER],r=this.renderer.overlays[ki.OUTER],n=this._pointIsInExtent(e,t.extent)?t:r;return(n.extent[2]-n.extent[0])/n.resolution}_setTileOverlayData(e,t,r){if(this.renderer.overlays.length===0)return;const n=this.renderer.overlays[t].extent,s=Nh(n),a=Mm(n);let o=e[0];if(this._longitudeCyclical){o=this._longitudeCyclical.minimalMonotonic(n[0],o);const l=this._longitudeCyclical.minimalMonotonic(n[0],e[2]);o>l&&(o=l-(e[2]-e[0]))}r.setScale(t,Nh(e)/s,Mm(e)/a),r.setOffset(t,(o-n[0])/s,(e[1]-n[1])/a)}_clearTileOverlayData(e,t){t.setScale(e,-1,-1),t.setOffset(e,-1,-1)}async reloadShaders(){yJ(),await this.renderer.reloadShaders(),this.setDrawTexturesDirty(),this.runTask()}_dispatchAnimationUpdate(e){const t=It(e-this._animationTimeLast);e=Ke(this._view.state.forcedAnimationTime,e),(t>=this.surface.view._stage.renderView.animationTimestep||y(this._view.state.forcedAnimationTime)||this._drawTexturesDirty||this._drawTexturesAnimateDirty)&&(this.renderer.updateAnimation({time:e,camera:this._view.state.camera})&&(this._drawTexturesAnimateDirty=!0),this._animationTimeLast=e)}setDrawTexturesDirty(){this.renderer.hasOverlays?(this._contentUpdated=!0,this._drawTexturesDirty=!0,this._view._stage.renderView.requestRender()):this.setPlacementDirty()}_intersectGroundFromView(e,t,r,n){const s=this._view.sceneIntersectionHelper.getCenterRayWithSubpixelOffset(e,iOe,t,r);if(C(s))return!1;const a=s.origin,o=ce(iS,s.origin,s.direction);return this._groundIntersector.reset(a,o,e),this._groundIntersector.intersect([],null),this._view.basemapTerrain.intersect(this._groundIntersector,null,a,o),this._groundIntersector.results.min.getIntersectionPoint(n)}_findHorizonBasedPointOfInterest(e,t){let r=.5;const n=.55,s=this._view.renderCoordsHelper.getAltitude(e.eye),a=this._view.pointsOfInterest.centerOnSurfaceFrequent,o=1e-5,l=ue(a.estimatedSurfaceAltitude,e.aboveGround?-1/0:s+o,e.aboveGround?s-o:1/0),c=e.aboveGround;if(this._view.viewingMode==="global"){const u=iS;NR(ED(RD,Kt(this._view.spatialReference).radius+l),zc(e.eye,e.viewForward),u),ae(u,u,e.eye);const d=Em.normalize(PG(e.viewForward,u,e.viewRight))/e.fovY+.5,m=d<=0||d>=1?.5:n;r=c?m*d:d+m*(1-d)}else{const u=.5*Math.PI-Math.acos(-e.viewForward[2]),d=Math.tan(u),m=Bi(0,d,1,0),f=sd(m,m,e.projectionMatrix)[1],_=ue(.5+.5*f,0,1);r=_===1||_===0?.5:c?_*n:1-(1-_)*n}return!!this._intersectGroundFromView(e,.5,r,t)&&wG(t,e.eye)<a.distance*a.distance}_computeOverlayExtents(e,t,r){const n=this._view.pointsOfInterest.centerOnSurfaceFrequent.renderLocation,s=P();this._findHorizonBasedPointOfInterest(e,s)||X(s,n);const a=Math.max(.1,Li(e.eye,s)),o=Um(this._view.renderCoordsHelper,n,e.eye),l=Math.PI/2-Math.abs(o-Math.PI/2);Wt.OVERLAY_SHOW_CENTER?(C(fp)&&(fp=new $p(this._view.graphics,"red")),fp.show(s,this._renderSR)):y(fp)&&fp.hide(),this._overlaySREqualsRenderSR||ss(s,this._renderSR,s,this._spatialReference);const c=this.surface.extent,u=!this._isSpherical&&y(this._spatialReference)&&this._spatialReference.isGeographic,d=u&&y(this._spatialReference)?1/Kt(this._spatialReference).metersPerDegree:1,m=e.perRenderPixelRatio*a*d;r.mapUnitsPerPixel=m/this._worldToPCSRatio;let f=t*m/2,_=!1,g=u?90:1/0;this._isSpherical&&y(c)&&y(this._spatialReference)&&(this._spatialReference.isWebMercator?(f/=Math.cos(fI(s[1])),g=c[3]):(_=!0,f/=Kt(this._spatialReference).metersPerDegree,g=90),f>=g&&(f=g,s[1]=0,this._spatialReference.isWebMercator&&(s[0]=0)));let w=1;_&&(w=1/Math.max(.2,Math.cos(Math.abs(At(s[1])))),f*w>180&&(w=180/f),r.mapUnitsPerPixel*=w);const v=Math.log(2)/12;f=Math.exp(Math.round(Math.log(f)/v)*v);const b=f*w,x=32,T=.5*t/(x*b),R=.5*t/(x*f);s[0]=Math.round(s[0]*T)/T,s[1]=Math.round(s[1]*R)/R;const E=r.inner;E[0]=s[0]-b,E[1]=s[1]-f,E[2]=s[0]+b,E[3]=s[1]+f,this._isSpherical&&this._shiftExtentToFitBounds(E,1/0,g);const O=r.outer;if(6*b>Nh(c))xw(O,ft(c));else if(l<=.25*Math.PI)O[0]=E[0]-b,O[1]=E[1]-f,O[2]=E[2]+b,O[3]=E[3]+f;else{ss(e.eye,this._renderSR,iS,this._spatialReference),Rc(Cf,s,iS);let D=-Math.atan2(Cf[1],Cf[0])+.125*Math.PI;D<0&&(D+=2*Math.PI);const I=Math.floor(D/(.25*Math.PI));$D(Cf,KAe[I],2*f),Cf[0]*=w,Cf[2]*=w,gne(O,E,Cf)}if(this._isSpherical)O[0]=this._longitudeCyclical.clamp(O[0]),O[2]=this._longitudeCyclical.clamp(O[2]),O[1]=Math.max(O[1],-g),O[3]=Math.min(O[3],g);else{const D=II(E,c,eOe),I=II(O,c,tOe);k5(D,I)&&(O[2]=O[0],O[3]=O[1])}const $=Math.abs(E[2]-E[0])/t;r.mapUnitsPerPixel=Math.max(r.mapUnitsPerPixel,$),r.pixelRatioAdjustment=r.mapUnitsPerPixel/$}_drawOverlayTextures(e,t,r=this._view.state.camera){if(e.length===0||!this._drawTexturesDirty&&!this._drawTexturesAnimateDirty)return;const n=this._drawTexturesDirty;this._drawTexturesDirty=!1,this._drawTexturesAnimateDirty=!1;const s=this._drawOverlay(e[ki.INNER],r),a=this._drawOverlay(e[ki.OUTER],r);s!==XE.CHANGED&&a!==XE.CHANGED||this.surface.updateTileOverlayParams(vr.UPDATE),this._collectUnusedRenderTargetMemory(),this.updateOverlayResult(),n?(this.surface.requestRender(t),t===vr.UPDATE&&this.surface.requestUpdate()):this.surface.requestRender(vr.BACKGROUND)}_drawOverlay(e,t){return this._longitudeCyclical?e.setupGeometryViewsCyclical(this._longitudeCyclical):e.setupGeometryViewsDirect(),e.draw(this.renderer,t.pixelRatio)}_collectUnusedRenderTargetMemory(){if(this._hasUnusedRenderTargets=!1,this.renderer.hasOverlays){const e=performance.now();this._hasUnusedRenderTargets=this.renderer.collectUnusedRenderTargetMemory(e)}}_rectanglesOverlap(e,t){return!C(e)&&(this._longitudeCyclical?(this._longitudeCyclical.contains(t[0],t[2],e[0])||this._longitudeCyclical.contains(t[0],t[2],e[2])||this._longitudeCyclical.contains(e[0],e[2],t[0]))&&!(e[1]>t[3]||e[3]<t[1]):DR(e,t))}_rectInsideRect(e,t){return!C(t)&&(this._longitudeCyclical?this._longitudeCyclical.contains(e[0],e[2],t[0])&&this._longitudeCyclical.contains(e[0],e[2],t[2])&&t[1]>e[1]&&t[3]<e[3]:k5(e,t))}_pointIsInExtent(e,t){if(this._longitudeCyclical)return this._longitudeCyclical.contains(t[0],t[2],e.x)&&e.y>=t[1]&&e.y<=t[3];const r=e.x,n=e.y;return r>t[0]&&r<t[2]&&n>t[1]&&n<t[3]}_shiftExtentToFitBounds(e,t,r){let n=0,s=0;e[0]<-t?n=e[0]+t:e[2]>t&&(n=t-e[2]),e[1]<-r?s=e[1]+r:e[3]>r&&(s=r-e[3]),GE(e,n,s)}get test(){return{renderer:this.renderer,update:()=>this.runTask()}}};function JAe(i,e){const r=Wt.TESTS_DISABLE_OPTIMIZATIONS?0:1e-5*Math.max(i[2]-i[0],i[3]-i[1],e[2]-e[0],e[3]-e[1]);return Math.abs(e[0]-i[0])<=r&&Math.abs(e[1]-i[1])<=r&&Math.abs(e[2]-i[2])<=r&&Math.abs(e[3]-i[3])<=r}h([p()],fa.prototype,"_spatialReference",void 0),h([p({readOnly:!0})],fa.prototype,"running",null),h([p()],fa.prototype,"_placementDirty",void 0),h([p()],fa.prototype,"_contentUpdated",void 0),h([p()],fa.prototype,"_isSpherical",null),h([p()],fa.prototype,"_worldToPCSRatio",null),h([p()],fa.prototype,"renderer",void 0),h([p({constructOnly:!0})],fa.prototype,"surface",void 0),h([p()],fa.prototype,"suspended",null),h([p()],fa.prototype,"updating",null),h([p({type:Boolean})],fa.prototype,"hasHighlights",null),h([p({type:Boolean})],fa.prototype,"rendersOccluded",null),fa=h([F("esri.views.3d.terrain.OverlayManager")],fa);const Cf=yi(),iS=P(),Au={inner:Nt(),outer:Nt(),mapUnitsPerPixel:0,pixelRatioAdjustment:1},eOe=Nt(),tOe=Nt(),iOe=oo();var Mh;(function(i){i[i.NONE=0]="NONE",i[i.EXTENT=1]="EXTENT",i[i.RERENDER_ONLY=2]="RERENDER_ONLY"})(Mh||(Mh={}));let vJ=class M${constructor(e,t){this._factoryCallback=e,this._lengthCallback=t,this._pool=new Map}acquire(e){if(!M$.test.disabled){const t=this._pool.get(e);if(t&&t.length!==0)return t.pop()}try{return this._factoryCallback(e)}catch(t){const r=window.performance&&window.performance.memory;let n="";throw r&&(n=`
  totalJSHeapSize: ${r.totalJSHeapSize}, usedJSHeapSize: ${r.usedJSHeapSize}, jsHeapSizeLimit: ${r.jsHeapSizeLimit}`),console.log("Array allocation of size "+e+" failed: "+t+n),t}}release(e){if(M$.test.disabled)return;const t=this._lengthCallback(e);let r=this._pool.get(t);r||(r=new Yt({shrink:!0}),this._pool.set(t,r)),r.push(e)}clear(){this._pool.clear()}get test(){return{size:this._pool.size}}};vJ.test={disabled:!1};let rOe=class{constructor(){this.indices=null,this.vertexAttributes=null,this.boundingBox=Ii(),this.indexCount=0,this.numVerticesPerSide=0,this.uvRange=[0,0,1,1],this.outerEdges=[null,null,null,null],this.innerEdges=[null,null,null,null]}},Zz=class{constructor(e,t,r,n,s){this.attributes=e,this.localOrigin=t,this.index0=r,this.stride=n,this.count=s}getVertexIndex(e){return this.getAttributeIndex(e)}getAttributeIndex(e){return fe(0<=e&&e<this.count),this.index0+this.stride*e}_getVertexRaw(e,t){this.attributes.position.getVec(e,t)}_getNormalRaw(e,t){this.attributes.normalCompressed.getVec(e,t)}getVertexPos(e,t){this._getVertexRaw(this.getAttributeIndex(t),e),ce(e,e,this.localOrigin)}getNormal(e,t){const r=Te();this._getNormalRaw(this.getAttributeIndex(t),r),oOe(e,r)}_setNormal(e,t,r,n){Rx(this.attributes.normalCompressed,e,t,r,n)}_setUV(e,t,r){go(this.attributes.uv0,e,t,r)}setNormalFromValues(e,t,r,n){this._setNormal(this.getAttributeIndex(e),t,r,n)}setVertexFromValuesRawPositionUV(e,t,r,n,s,a){const o=this.getAttributeIndex(e);this.attributes.position.setValues(o,t,r,n),this._setUV(o,s,a)}setVertexFromValuesRawPositionUVNormal(e,t,r,n,s,a,o,l,c){const u=this.getAttributeIndex(e);this.attributes.position.setValues(u,t,r,n),this._setUV(u,s,a),this._setNormal(u,o,l,c)}};const nOe=sn().vec3f(S.POSITION).vec2i16(S.UV0).vec2i16(S.NORMALCOMPRESSED,{glNormalized:!0}),X4=new vJ(i=>nOe.createBuffer(i),i=>i.count);function sOe(){X4.clear()}function bJ(i){return X4.acquire(i)}function aOe(i){X4.release(i.vertexAttributes),i.vertexAttributes=null,i.indices=null}function Rx(i,e,t,r,n){const s=1/(Math.abs(t)+Math.abs(r)+Math.abs(n)),a=t*s,o=r*s,l=n<=0?(a>=0?1:-1)*(1-Math.abs(o)):a,c=n<=0?(o>=0?1:-1)*(1-Math.abs(a)):o;i.setValues(e,Kz(l),Kz(c))}function oOe(i,e){const t=Jz(e[0]),r=Jz(e[1]),n=1-Math.abs(t)-Math.abs(r);i[2]=n,n<0?(i[0]=(t>=0?1:-1)*(1-Math.abs(r)),i[1]=(r>=0?1:-1)*(1-Math.abs(t))):(i[0]=t,i[1]=r),de(i,i)}const Yz=16384;function go(i,e,t,r){i.setValues(e,t*Yz,r*Yz)}function Kz(i){return ue(Math.round(32767*i),-32767,32767)}function Jz(i){return ue(i/32767,-1,1)}function Xs(i,e,t,r){i<r[0]?r[0]=i:i>r[3]&&(r[3]=i),e<r[1]?r[1]=e:e>r[4]&&(r[4]=e),t<r[2]?r[2]=t:t>r[5]&&(r[5]=t)}let lOe=class{constructor(){this.sinLonLUT=new Array(ib+1),this.cosLonLUT=new Array(ib+1),this.sinLatLUT=new Array(ib+1),this.cosLatLUT=new Array(ib+1)}update(e,t,r){const n=t[0],s=t[2];for(let a=0;a<=e;a++){const o=a/e,l=n*(1-o)+s*o;this.sinLonLUT[a]=Math.sin(l),this.cosLonLUT[a]=Math.cos(l);const c=r(o);this.sinLatLUT[a]=Math.sin(c),this.cosLatLUT[a]=Math.cos(c)}}},rS=class{constructor(){this.cornerTiles=[null,null,null,null],this.cornerTileSamplerVersions=[-1,-1,-1,-1]}},cOe=class{constructor(){this.cornerNeighborData=[new rS,new rS,new rS,new rS],this.edgeResolutions=[-1,-1,-1,-1],this.edgePeerNeighbors=[null,null,null,null],this.edgePeerNeighborSamplerVersions=[-1,-1,-1,-1],this.cornerPeerNeighbors=[null,null,null,null]}},hOe=class{constructor(){this.numVerticesPerSide=0,this.samplerData=null,this.clippingArea=null,this.wireframe=!1,this.shading=!1,this.samplerDataVersion=0,this.neighborData=new cOe}},wJ=class bE{constructor(e){this._getFadeDuration=e,this._fadeStart=0,this._delayedTime=0}clear(){this._current=Oe(this._current),this._next=Oe(this._next),this._waiting=Oe(this._waiting),this._delayed=Oe(this._delayed)}get current(){if(C(this._current))return null;if(!this._isFadingEnabled){const t=this._delayed||this._waiting||this._next||this._current;t!==this._current&&(this._current=null,this.clear(),this._current=t)}let e=bE.test.fadeMoment;if(y(this._delayed)&&(e=e||performance.now(),e>=this._delayedTime&&(this._push(this._delayed,yd.Immediate),this._delayed=null)),y(this._next)){e=e||performance.now();const t=this._fadeDuration,r=y(this._current)&&this._next.texture===this._current.texture,n=this._next.type!==fn.FADING,s=e-this._fadeStart>=t;(r||n||s)&&(Oe(this._current),this._current=this._next,this._next=this._waiting,this._waiting=null,this._fadeStart=this._alignFadeStart(e))}return this._current}get next(){return this._next}get fadeFactor(){if(C(this._next))return 1;const e=bE.test.fadeMoment||performance.now(),t=Math.max(0,e-this._fadeStart),r=this._fadeDuration;return t>r?0:1-t/r}get isFading(){return y(this._next)||y(this._delayed)}push(e,t=yd.Immediate){this._delayed=Oe(this._delayed),this._push(e,t)}_push(e,t){if(this._isFadingEnabled||this.clear(),C(this._current))return void(this._current=e);const r=bE.test.fadeMoment||performance.now();return t!==yd.Immediate?(this._delayed=e,void(this._delayedTime=r+t)):C(this._next)?(this._next=e,void(this._fadeStart=this._alignFadeStart(r))):void(C(e)||(Oe(this._waiting),this._waiting=e))}get _fadeDuration(){return C(this._waiting)?this._getFadeDuration():.5*this._getFadeDuration()}_alignFadeStart(e){const t=this._getFadeDuration();return e+t-e%t}get _isFadingEnabled(){return this._getFadeDuration()>0}};var yd;wJ.test={fadeMoment:0},function(i){i[i.Immediate=0]="Immediate",i[i.Delayed=5e3]="Delayed"}(yd||(yd={}));let xJ=class{constructor(){this._queue=new Yt,this._last=null,this.remove=()=>{}}get done(){return this._queue.length===0&&(!this._last||this._last.isLeaf)}resetOne(e){this._queue.clear(),this._queue.push(e),this._last=null}reset(e=null){this._queue.clear(),y(e)&&this._queue.pushArray(e),this._last=null}skipSubtree(){this._last=null}next(){return this._last&&!this._last.isLeaf&&this._queue.pushArray(this._last.children),this._last=this._queue.pop(),this._last}},uOe=class{constructor(){this._q=new Yt}get done(){return this._q.length===0}reset(e){if(this._q.clear(),!C(e)){this._q.pushArray(e);for(let t=0;t<this._q.length;++t){const r=this._q.data[t];r.isLeaf||this._q.pushArray(r.children)}}}next(){return this._q.pop()}};function hw(i,e,t){if(C(e)||C(e.fullExtent))return!1;const r=e.fullExtent,n=i.extent;if(t){if(n[0]<r.xmin||n[1]<r.ymin||n[2]>r.xmax||n[3]>r.ymax)return!1}else if(r.xmin>n[2]||r.ymin>n[3]||r.xmax<n[0]||r.ymax<n[1])return!1;const s=i.surface.tilingScheme.levels[i.level].scale;return!(e.minScale>0&&s>1.00000001*e.minScale)&&!(e.maxScale>0&&s<.99999999*e.maxScale)}function vd(i,e){return i.lij[0]-e.lij[0]||i.lij[1]-e.lij[1]||i.lij[2]-e.lij[2]}function TJ(i,e,t=null){C(t)||t.length===0?e.sort((r,n)=>Q4(r,n,i)):e.sort((r,n)=>dOe(r,n,i,t))}function Q4(i,e,t){const r=i.screenDepth,n=e.screenDepth;return r<n?-t:r>n?t:vd(i,e)}function dOe(i,e,t,r){return eB(i,r)===eB(e,r)?Q4(i,e,t):i?t:-t}function eB(i,e){for(const t of e)if(i.intersectsExtent(t))return!0;return!1}function pOe(i,e){const t=new Map;i.forAll(r=>t.set(r.lij,r.distanceToSquared(e))),i.sort((r,n)=>t.get(r.lij)-t.get(n.lij)||vd(r,n))}function mOe(i,e,t){let r=1,n=0,s=0;for(;i!==e;)if(r*=.5,n*=.5,s*=.5,1&i.lij[2]&&(n+=.5),!(1&i.lij[1])&&(s+=.5),(i=i.parent)==null)throw new Error("tile was not a descendant of upsampleTile");t.init(e,n,s,r)}function fOe(i){for(let e=0;e<i.length;e++){const t=i[e],r=t.parent;if(r)for(let n=0;n<4;n++){const s=r.children[n];if(s&&s!==t)return!0}}return!1}function oGe(i,e){if(!i||!e||i[0]===e[0])return!1;const t=i[0]<e[0],r=t?i:e,n=t?e:i,s=1<<n[0]-r[0];return Math.floor(n[1]/s)===r[1]&&Math.floor(n[2]/s)===r[2]}let Z4=class{get updating(){return!!this._tileRequested}init(e,t,r,n){this.tile=e,this._layerIdx=t,this._layerClass=r,this._suspended=n,this._tileLayerInfo=e.getLayerInfo(t,r),this._tileRequested=null;const s=this._findAncestorWithData();this._setUpsampleTile(s)}startLoading(){return this._requestNext()}dispose(){this._tileRequested&&(this._tileRequested.unrequestLayerData(this._layerIdx,this._layerClass,this),this._tileRequested=null),this.tile=null,this._tileLayerInfo=null}setSuspension(e){e!==this._suspended&&(this._suspended=e,e?this._tileRequested&&(this._tileRequested.unrequestLayerData(this._layerIdx,this._layerClass,this),this._tileRequested=null):this._tileLayerInfo.data||this.update())}update(){const e=this._findAncestorWithData();return this._setUpsampleTile(e),this._requestNext()}dataArrived(e){this._setUpsampleTile(e),this._tileRequested=null,e===this.tile?this.tile.updateRenderData(this._layerClass,fn.FADING):this._requestNext()}dataMissing(){this._tileRequested=null,this._tileLayerInfo.data=null,this._requestNext()}_agentDone(){this.tile.agentDone(this._layerIdx,this._layerClass),this.dispose()}_requestNext(){if(this._suspended)return!0;const e=this._findNextDownload();if(this._tileRequested){if(e===this._tileRequested)return!0;this._tileRequested.unrequestLayerData(this._layerIdx,this._layerClass,this),this._tileRequested=null}return y(e)?e.requestLayerData(this._layerIdx,this._layerClass,this)&&(this._tileRequested=e):this._agentDone(),!!this._tileRequested}_findNextDownload(){const e=this._layerIdx,t=this._layerClass,r=this.tile.surface.layerViewByIndex(e,t),n=S$(r),{minLevel:s,maxLevel:a}=r.dataLevelRange,o=this._desiredMinLevelDelta,l=this._progressiveLevelModulo+o,c=this._scaleRangeEnabled?hw:()=>!0;let u=this.tile;const d=u.level;let m;const f=this._tileLayerInfo.upsampleInfo,_=y(f)?f.tile.level:-1,g=!!y(f)&&_-d>=o,w=en(n,"tilemapCache");for(;u&&c(u,n,!1)&&u.level>=s;){const v=u.level,b=d-v,x=u.layerInfo[t][e];if(x.data&&b>=o){(!g||v>_)&&this._setUpsampleTile(u),x.dataInvalidated&&(m=u);break}if((C(w)||w.getAvailability(u.lij[0],u.lij[1],u.lij[2])!=="unavailable")&&v<=a&&!x.data&&!x.dataMissing&&((C(m)||u.level===s||v%jQ==0||d-m.level<o)&&(m=u),b>=l))break;u=u.parent}return y(m)&&d-m.level<o&&this._tileLayerInfo.upsampleInfo&&(m=null),m}_findAncestorWithData(){const e=this.tile.vlevel,t=this._desiredMinLevelDelta;let r;for(let n=this.tile;n;n=n.parent)if(n.hasLayerData(this._layerIdx,this._layerClass)){if(e-n.level>=t)return n;r=n}return r}_setUpsampleTile(e){this._tileLayerInfo.setUpsampleInfo(this.tile,e),this.tile.updateRenderData(this._layerClass,fn.FADING)}get test(){return{findNextDownload:()=>this._findNextDownload(),tileLayerInfo:this._tileLayerInfo}}},gOe=class extends Z4{get _desiredMinLevelDelta(){throw tB}get _progressiveLevelModulo(){throw tB}dispose(){}};const tB=new Error("Abstract method called on TileAgent"),za=new gOe;let CJ=class extends Z4{constructor(){super(...arguments),this._scaleRangeEnabled=!1}get _desiredMinLevelDelta(){return aE(this.tile.level)-(this.tile.vlevel-this.tile.level)}get _progressiveLevelModulo(){return 0}},SJ=class extends Z4{constructor(){super(),this._scaleRangeEnabled=!0}get _desiredMinLevelDelta(){return 0}get _progressiveLevelModulo(){return jQ}};var Sg,Xg;(function(i){i[i.Stretch=0]="Stretch",i[i.Lut=1]="Lut",i[i.Hillshade=2]="Hillshade",i[i.COUNT=3]="COUNT"})(Sg||(Sg={})),function(i){i[i.Noop=0]="Noop",i[i.PerBand=1]="PerBand",i[i.COUNT=2]="COUNT"}(Xg||(Xg={}));function _Oe(i,e){i.fragment.uniforms.add([new Ht("u_colormap",t=>t.u_colormap),new Pt("u_colormapOffset",t=>t.colormap.u_colormapOffset),new Pt("u_colormapMaxIndex",t=>t.colormap.u_colormapMaxIndex),new Pt("u_opacity",t=>t.common.u_opacity)]),i.fragment.code.add(A`
    vec4 colormap(vec4 currentPixel, bool isFloat) {
      float colorIndex = isFloat ? currentPixel.r - u_colormapOffset : currentPixel.r * 255.0 - u_colormapOffset;
      vec4 result;
      // handle no data and out of range pixels
      if (currentPixel.a == 0.0 || colorIndex > u_colormapMaxIndex) {
        result = vec4(0.0, 0.0, 0.0, 0.0);
      } else {
        // colormap lookup
        vec2 texelCoordinates = vec2((colorIndex + 0.5), 0.5);
        result = ${Ko(e,"u_colormap","texelCoordinates","(1.0 / vec2(u_colormapMaxIndex + 1.0, 1.0))")};
      }
      return result;
    }
  `)}function yOe(i,e){i.fragment.uniforms.add(HG("u_transformGrid",t=>t.u_transformGrid,e.hasWebGL2Context?il.None:il.InvSize)),i.fragment.uniforms.add(new Zs("u_transformSpacing",t=>t.common.u_transformSpacing)),i.fragment.uniforms.add(new Zs("u_targetImageSize",t=>t.common.u_targetImageSize)),i.fragment.code.add(A`
    vec2 projectPixelLocation(vec2 coords) {
      // Pixel index in row/column, corresponds to upperleft corner, e.g. [100, 20]
      vec2 index_image = floor(coords * u_targetImageSize);

      // Pixel's corresponding cell index in transform grid
      // Each transform cell corresponds to 4 pixels: 6 coefficients from lowerleft triangle followed by 6 coefficients from upperright triangle
      vec2 oneTransformPixel = vec2(4.0, 1.0);
      vec2 index_transform = floor(index_image / u_transformSpacing) * oneTransformPixel;

      // Correspoding position in transform grid cell, cell center coordinates
      vec2 pos = fract((index_image + 0.5) / u_transformSpacing);

      // Pixel's corresponding transform cell location, cell center coordinates
      vec2 transform_location = index_transform + 0.5;

      vec2 srcLocation;

      // Use lower triangle or upper triangle
      if (pos.s <= pos.t) {
        vec3 ll_abc = ${Ko(e,"u_transformGrid","transform_location")}.rgb;
        vec3 ll_def = ${Ko(e,"u_transformGrid","vec2(transform_location.s + 1.0, transform_location.t)")}.rgb;
        srcLocation.s = dot(ll_abc, vec3(pos, 1.0));
        srcLocation.t = dot(ll_def, vec3(pos, 1.0));
      } else {
        vec3 ur_abc = ${Ko(e,"u_transformGrid","vec2(transform_location.s + 2.0, transform_location.t)")}.rgb;
        vec3 ur_def = ${Ko(e,"u_transformGrid","vec2(transform_location.s + 3.0, transform_location.t)")}.rgb;
        srcLocation.s = dot(ur_abc, vec3(pos, 1.0));
        srcLocation.t = dot(ur_def, vec3(pos, 1.0));
      }

      return srcLocation;
    }
  `)}let EJ=class extends Ir{constructor(){super(...arguments),this.scale=1,this.offset=Ag}};function RJ(i){i.attributes.add(S.POSITION,"vec2"),i.attributes.add(S.UV0,"vec2"),i.vertex.uniforms.add(new Pt("scale",e=>e.scale)),i.vertex.uniforms.add(new Zs("offset",e=>e.offset)),i.varyings.add("uv","vec2"),i.varyings.add("vuv","vec2"),i.vertex.code.add(A`void main(void) {
gl_Position = vec4(position, 0.0, 1.0);
uv = uv0 * scale + offset;
vuv = uv0;
}`)}let vOe=class extends EJ{constructor(e,t,r){super(),this.common=e,this.u_image=t,this.u_transformGrid=r}};function bOe(i,e){i.include(yOe,e),i.fragment.uniforms.add([new Ht("u_image",t=>t.u_image),new Rw("u_flipY",t=>t.common.u_flipY),new Rw("u_applyTransform",t=>t.common.u_applyTransform)]),i.fragment.code.add(A`vec2 getPixelLocation(vec2 coords) {
vec2 targetLocation = u_flipY ? vec2(coords.s, 1.0 - coords.t) : coords;
if (!u_applyTransform) {
return targetLocation;
}
return projectPixelLocation(targetLocation);
}
bool isOutside(vec2 coords){
if (coords.t>1.00001 ||coords.t<-0.00001 || coords.s>1.00001 ||coords.s<-0.00001) {
return true;
} else {
return false;
}
}
vec4 getPixel(vec2 pixelLocation) {
return texture2D(u_image, pixelLocation);
}`)}var ye;(function(i){i[i.Normal=0]="Normal",i[i.Average=1]="Average",i[i.Lighten=2]="Lighten",i[i.Lighter=3]="Lighter",i[i.Plus=4]="Plus",i[i.Screen=5]="Screen",i[i.ColorDodge=6]="ColorDodge",i[i.Darken=7]="Darken",i[i.Multiply=8]="Multiply",i[i.ColorBurn=9]="ColorBurn",i[i.Overlay=10]="Overlay",i[i.SoftLight=11]="SoftLight",i[i.HardLight=12]="HardLight",i[i.VividLight=13]="VividLight",i[i.Hue=14]="Hue",i[i.Saturation=15]="Saturation",i[i.Luminosity=16]="Luminosity",i[i.Color=17]="Color",i[i.DestinationOver=18]="DestinationOver",i[i.DestinationAtop=19]="DestinationAtop",i[i.DestinationIn=20]="DestinationIn",i[i.DestinationOut=21]="DestinationOut",i[i.SourceAtop=22]="SourceAtop",i[i.SourceIn=23]="SourceIn",i[i.SourceOut=24]="SourceOut",i[i.Xor=25]="Xor",i[i.Difference=26]="Difference",i[i.Exclusion=27]="Exclusion",i[i.Minus=28]="Minus",i[i.Invert=29]="Invert",i[i.Reflect=30]="Reflect",i[i.COUNT=31]="COUNT"})(ye||(ye={}));const I$={normal:ye.Normal,average:ye.Average,lighten:ye.Lighten,lighter:ye.Lighter,screen:ye.Screen,plus:ye.Plus,"color-dodge":ye.ColorDodge,darken:ye.Darken,multiply:ye.Multiply,"color-burn":ye.ColorBurn,overlay:ye.Overlay,"soft-light":ye.SoftLight,"hard-light":ye.HardLight,"vivid-light":ye.VividLight,hue:ye.Hue,saturation:ye.Saturation,luminosity:ye.Luminosity,color:ye.Color,difference:ye.Difference,exclusion:ye.Exclusion,minus:ye.Minus,invert:ye.Invert,reflect:ye.Reflect,"destination-over":ye.DestinationOver,"destination-atop":ye.DestinationAtop,"destination-in":ye.DestinationIn,"destination-out":ye.DestinationOut,"source-atop":ye.SourceAtop,"source-in":ye.SourceIn,"source-out":ye.SourceOut,xor:ye.Xor};function wOe(i){return i===ye.DestinationOver||i===ye.DestinationAtop||i===ye.DestinationIn||i===ye.DestinationOut||i===ye.SourceAtop||i===ye.SourceIn||i===ye.SourceOut||i===ye.Xor}function Y4(i){i.code.add(A`
    float lineFactorAtPosition(float value) {
      float pos = value * ${A.float(257)};
      if(pos < 0.5 || pos > ${A.float(257-.5)}) {
        return 1.0;
      }

      pos = pos + 0.5;
      float modulo = mod(pos, 16.0);
      return modulo <= 2.0 ?  1.0 - abs(modulo - 1.0) : 0.0;
    }

    float lineFactorAtUV(vec2 uv) {
      return max(lineFactorAtPosition(uv.x), lineFactorAtPosition(uv.y));
    }

    float lineFactor(vec2 uv) {
      vec2 offset = fwidth(uv) * 0.25;
      return (lineFactorAtUV(vec2(uv.x + offset.x, uv.y + offset.y)) +
              lineFactorAtUV(vec2(uv.x - offset.x, uv.y + offset.y)) +
              lineFactorAtUV(vec2(uv.x + offset.x, uv.y - offset.y)) +
              lineFactorAtUV(vec2(uv.x - offset.x, uv.y - offset.y))) / 4.0;
    }

    vec4 gridColor(vec2 uv) {
      float line = lineFactor(uv) * 0.1 + 0.9;
      return vec4(vec3(1.0, 0.972, 0.918) * line, 1.0);
    }`)}function xOe(i,e){const t=e.blendMode;t!==ye.Normal&&(t===ye.Reflect&&i.code.add(A`float reflectBlend(in float cb, in float cl) {
return (cl == 1.0) ? cl : min(cb * cb / (1.0 - cl), 1.0);
}`),t!==ye.ColorDodge&&t!==ye.VividLight||i.code.add(A`float colorDodge(in float cb, in float cl) {
return (cb == 0.0) ? 0.0 : (cl == 1.0) ? 1.0 : min(1.0, cb / (1.0 - cl));
}`),t!==ye.ColorBurn&&t!==ye.VividLight||i.code.add(A`float colorBurn(in float cb, in float cl) {
return (cb == 1.0) ? 1.0 : (cl == 0.0) ? 0.0 : 1.0 - min(1.0, (1.0 - cb) / cl);
}`),t===ye.Overlay&&i.code.add(A`float overlay(in float cb, in float cl) {
return (1.0 - step(0.5, cl)) * (1.0 - 2.0 * (1.0 - cl ) * (1.0 - cb)) + step(0.5, cl) * (2.0 * cl * cb);
}`),t===ye.HardLight&&i.code.add(A`float hardLight(in float cb, in float cl) {
return (1.0 - step(0.5, cl)) * (2.0 * cl * cb) + step(0.5, cl) * (1.0 - 2.0 * (1.0 - cl) * (1.0 - cb));
}`),t===ye.SoftLight&&i.code.add(A`float softLight(in float cb, in float cl) {
if (cl <= 0.5) {
return cb - (1.0 - 2.0 * cl) * cb * (1.0 - cb);
}
if (cb <= 0.25) {
return cb + (2.0 * cl - 1.0) * cb * ((16.0 * cb - 12.0) * cb + 3.0);
}
return cb + (2.0 * cl - 1.0) * (sqrt(cb) - cb);
}`),t===ye.VividLight&&i.code.add(A`float vividLight(in float cb, in float cl) {
return (1.0 - step(0.5, cl)) * colorBurn(cb, 2.0 * cl) + step(0.5, cl) * colorDodge(cb, (2.0 * (cl - 0.5)));
}`),t!==ye.Hue&&t!==ye.Saturation&&t!==ye.Color&&t!==ye.Luminosity||(i.code.add(A`float minv3(in vec3 c) {
return min(min(c.r, c.g), c.b);
}
float maxv3(in vec3 c) {
return max(max(c.r, c.g), c.b);
}
float lumv3(in vec3 c) {
return dot(c, vec3(0.3, 0.59, 0.11));
}
vec3 clipColor(vec3 color) {
float lum = lumv3(color);
float mincol = minv3(color);
float maxcol = maxv3(color);
if (mincol < 0.0) {
color = lum + ((color - lum) * lum) / (lum - mincol);
}
if (maxcol > 1.0) {
color = lum + ((color - lum) * (1.0 - lum)) / (maxcol - lum);
}
return color;
}
vec3 setLum(vec3 cbase, vec3 clum) {
return clipColor(cbase + vec3(lumv3(clum) - lumv3(cbase)));
}`),t!==ye.Hue&&t!==ye.Saturation||i.code.add(A`float satv3(vec3 c) {
return maxv3(c) - minv3(c);
}
vec3 setLumSat(vec3 cbase, vec3 csat, vec3 clum)
{
float minbase = minv3(cbase);
float sbase = satv3(cbase);
float ssat = satv3(csat);
return setLum(sbase > 0.0 ? (cbase - minbase) * ssat / sbase : vec3(0.0), clum);
}`)),i.code.add(A`
    vec4 applyBlendMode(vec3 cl, float ol, vec3 cb, float ob) {
      ${t===ye.Multiply?A`return vec4(cl * ol * cb * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===ye.Average?A`return vec4((cb + cl) * 0.5 * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===ye.Lighten?A`return vec4(max(cb, cl) * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===ye.Darken?A`return vec4(min(cl, cb) * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===ye.Lighter?A`return vec4(cl * ol + cb * ob, ol + ob);`:t===ye.Plus?A`return clamp(vec4(cl.rgb + cb.rgb, ol + ob), 0.0, 1.0);`:t===ye.Minus?A`return vec4(clamp(vec3(cb.rgb - cl.rgb), 0.0, 1.0), ob * ol);`:t===ye.Screen?A`return vec4((cl + cb - cl * cb) * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===ye.Difference?A`return vec4(abs(cb - cl) * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===ye.Invert?A`return vec4((1.0 - cb) * ol * ob + cb * ob * (1.0 - ol), ob);`:t===ye.DestinationOver?A`return vec4(cl * ol * (1.0 - ob) + cb * ob, ol + ob - ol * ob);`:t===ye.DestinationAtop?A`return vec4(cl * ol * (1.0 - ob) + cb * ob * ol, ol);`:t===ye.DestinationOut?A`return vec4(cb * ob * (1.0 - ol), ob * (1.0 - ol));`:t===ye.SourceAtop?A`return vec4(cl * ol * ob + cb * ob * (1.0 - ol), ob);`:t===ye.SourceOut?A`return vec4(cl * ol * (1.0 - ob), ol * (1.0 - ob));`:t===ye.Xor?A`return vec4(cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), ol * (1.0 - ob) + ob * (1.0 - ol));`:t===ye.DestinationIn?A`return vec4(cb * ob * ol, ol * ob);`:t===ye.SourceIn?A`return vec4(cl * ol * ob, ol * ob);`:t===ye.Hue?A`
          vec3 f = setLumSat(cl, cb, cb);
          return vec4(f * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===ye.Saturation?A`
          vec3 f = setLumSat(cb, cl, cb);
          return vec4(f * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===ye.Color?A`
          vec3 f = setLum(cl, cb);
          return vec4(f * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===ye.Luminosity?A`
          vec3 f = setLum(cb, cl);
          return vec4(f * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===ye.Exclusion?A`
          vec3 f = cl + cb - 2.0 * cl * cb;
          return vec4(f * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===ye.Reflect?A`
          vec3 f = vec3(reflectBlend(cb.r, cl.r), reflectBlend(cb.g, cl.g), reflectBlend(cb.b, cl.b));
          return vec4(f * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===ye.ColorDodge?A`
          vec3 f = vec3(colorDodge(cb.r, cl.r), colorDodge(cb.g, cl.g), colorDodge(cb.b, cl.b));
          return vec4(f * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===ye.ColorBurn?A`
          vec3 f = vec3(colorBurn(cb.r, cl.r), colorBurn(cb.g, cl.g), colorBurn(cb.b, cl.b));
          return vec4(f * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===ye.Overlay?A`
          vec3 f = vec3(overlay(cb.r, cl.r), overlay(cb.g, cl.g), overlay(cb.b, cl.b));
          return vec4(f * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===ye.SoftLight?A`
          vec3 f = vec3(softLight(cb.r, cl.r), softLight(cb.g, cl.g), softLight(cb.b, cl.b));
          return vec4(f * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===ye.HardLight?A`
          vec3 f = vec3(hardLight(cb.r, cl.r), hardLight(cb.g, cl.g), hardLight(cb.b, cl.b));
          return vec4(f * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===ye.VividLight?A`
          vec3 f = vec3(vividLight(cb.r, cl.r), vividLight(cb.g, cl.g), vividLight(cb.b, cl.b));
          return vec4(f * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:A``}
    }
  `))}var Zr,Dc,bc;(function(i){i[i.Composite=0]="Composite",i[i.ColorComposite=1]="ColorComposite",i[i.GridComposite=2]="GridComposite",i[i.GroupBackgroundComposite=3]="GroupBackgroundComposite",i[i.COUNT=4]="COUNT"})(Zr||(Zr={})),function(i){i[i.NotRequired=0]="NotRequired",i[i.Required=1]="Required",i[i.COUNT=2]="COUNT"}(Dc||(Dc={})),function(i){i[i.Off=0]="Off",i[i.On=1]="On",i[i.COUNT=2]="COUNT"}(bc||(bc={}));function PJ(i,e){const t=e.output===Zr.GridComposite,r=e.output===Zr.ColorComposite,n=e.output===Zr.GroupBackgroundComposite,s=e.output===Zr.Composite;t&&(i.extensions.add("GL_OES_standard_derivatives"),i.fragment.include(Y4)),r&&i.fragment.uniforms.add(new Ps("backgroundColor",c=>c.backgroundColor));const a=e.baseOpacityMode===Dc.Required;if(a&&i.fragment.uniforms.add(new Pt("baseOpacity",c=>c.baseOpacity)),s){const c=e.hasWebGL2Context?il.None:il.InvSize;i.fragment.uniforms.add(HG("fboColor",u=>u.fboTexture,c))}const o=e.blendMode!==ye.Normal,l=e.premultipliedSource===bc.On;i.fragment.include(xOe,e),i.fragment.code.add(A`
    vec4 getBackground(vec2 uv) {
      return ${a?A`baseOpacity *`:""} ${n?A`vec4(0.0, 0.0, 0.0, 0.0)`:r?A`vec4(backgroundColor, 1.0)`:t?A`gridColor(uv)`:A`${Ko(e,"fboColor","gl_FragCoord.xy")}`};
    }

    vec4 blendLayers(vec4 bgColor, vec4 colorLayer, float opacity) {
      ${o?A`
          vec3 Cb = bgColor.a == 0.0 ? bgColor.rgb : vec3(bgColor.rgb * bgColor.a);
          return applyBlendMode(colorLayer.rgb, colorLayer.a * opacity, Cb, bgColor.a);`:A`
          vec4 pmColorLayer = vec4(colorLayer.xyz, 1.0);
          float composeAlpha = colorLayer.a * opacity;
          return ${l?A`bgColor * (1.0 - composeAlpha) + colorLayer * opacity;`:s&&!a||n?A`pmColorLayer * composeAlpha;`:A`mix(bgColor, pmColorLayer, composeAlpha);`}`}
    }`)}let YP=class extends vOe{constructor(e,t,r,n,s,a){super(e,n,s),this.colormap=t,this.symbolizer=r,this.u_colormap=a,this.backgroundColor=Gl,this.fboTexture=null,this.baseOpacity=1}},TOe=class extends YP{},COe=class extends YP{};function SOe(i){const e=new Yi;return e.include(RJ),e.include(bOe,i),e.include(_Oe,i),e.include(PJ,i),e.fragment.code.add(A`vec4 applyBackgroundBlend(vec4 layerColor) {
vec4 bgColor = getBackground(vuv);
return blendLayers(bgColor, layerColor, u_opacity);
}`),i.colorizerType===Sg.Stretch?ROe(e,i):i.colorizerType===Sg.Lut?EOe(e):i.colorizerType===Sg.Hillshade&&POe(e,i),e}function EOe(i){i.fragment.code.add(A`void main() {
vec2 pixelLocation = getPixelLocation(uv);
if (isOutside(pixelLocation)) {
gl_FragColor = applyBackgroundBlend(vec4(0.0, 0.0, 0.0, 0.0));
return;
}
vec4 currentPixel = getPixel(pixelLocation);
gl_FragColor = applyBackgroundBlend(colormap(currentPixel, true));
}`)}function ROe(i,e){i.fragment.uniforms.add([new DD("u_bandCount",r=>r.symbolizer.u_bandCount),new rd("u_minCutOff",r=>r.symbolizer.u_minCutOff,3),new rd("u_maxCutOff",r=>r.symbolizer.u_maxCutOff,3),new rd("u_factor",r=>r.symbolizer.u_factor,3),new Pt("u_minOutput",r=>r.symbolizer.u_minOutput),new Pt("u_maxOutput",r=>r.symbolizer.u_maxOutput),new Rw("u_useGamma",r=>r.symbolizer.u_useGamma),new rd("u_gamma",r=>r.symbolizer.u_gamma,3),new rd("u_gammaCorrection",r=>r.symbolizer.u_gammaCorrection,3),new Pt("u_opacity",r=>r.common.u_opacity)]),i.fragment.code.add(A`float stretchOneValue(float val, float minCutOff, float maxCutOff, float minOutput, float maxOutput, float factor, bool useGamma, float gamma, float gammaCorrection) {
if (val >= maxCutOff) {
return maxOutput;
} else if (val <= minCutOff) {
return minOutput;
}
float stretchedVal;
if (useGamma) {
float tempf = 1.0;
float outRange = maxOutput - minOutput;
float relativeVal = (val - minCutOff) / (maxCutOff - minCutOff);
if (gamma > 1.0) {
tempf -= pow(1.0 / outRange, relativeVal * gammaCorrection);
}
stretchedVal = (tempf * outRange * pow(relativeVal, 1.0 / gamma) + minOutput) / 255.0;
} else {
stretchedVal = minOutput + (val - minCutOff) * factor;
}
return stretchedVal;
}`);const t=e.applyColormap?A`gl_FragColor = applyBackgroundBlend(colormap(vec4(grayVal, grayVal, grayVal, currentPixel.a), !u_useGamma));`:A`gl_FragColor = applyBackgroundBlend(vec4(grayVal, grayVal, grayVal, currentPixel.a));`;i.fragment.code.add(A`
      void main() {
        vec2 pixelLocation = getPixelLocation(uv);
        if (isOutside(pixelLocation)) {
          gl_FragColor = applyBackgroundBlend(vec4(0.0, 0.0, 0.0, 0.0));
          return;
        }

        vec4 currentPixel = getPixel(pixelLocation);
        ${e.stretchType===Xg.Noop?A`
        gl_FragColor = applyBackgroundBlend(currentPixel);`:A`
        if (currentPixel.a == 0.0) {
          gl_FragColor = applyBackgroundBlend(vec4(0.0, 0.0, 0.0, 0.0));
          return;
        }
        if (u_bandCount == 1) {
          float grayVal = stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);
          ${t}
        } else {
          float redVal = stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);
          float greenVal = stretchOneValue(currentPixel.g, u_minCutOff[1], u_maxCutOff[1], u_minOutput, u_maxOutput, u_factor[1], u_useGamma, u_gamma[1], u_gammaCorrection[1]);
          float blueVal = stretchOneValue(currentPixel.b, u_minCutOff[2], u_maxCutOff[2], u_minOutput, u_maxOutput, u_factor[2], u_useGamma, u_gamma[2], u_gammaCorrection[2]);
          gl_FragColor = applyBackgroundBlend(vec4(redVal, greenVal, blueVal, currentPixel.a));
        }`}
      }`)}function POe(i,e){const t=i.fragment;t.uniforms.add([new Ht("u_image",n=>n.u_image),new DD("u_hillshadeType",n=>n.symbolizer.u_hillshadeType),new rd("u_sinZcosAs",n=>n.symbolizer.u_sinZcosAs,6),new rd("u_sinZsinAs",n=>n.symbolizer.u_sinZsinAs,6),new rd("u_cosZs",n=>n.symbolizer.u_cosZs,6),new rd("u_weights",n=>n.symbolizer.u_weights,6),new Zs("u_factor",n=>n.symbolizer.u_factor),new Pt("u_minValue",n=>n.symbolizer.u_minValue),new Pt("u_maxValue",n=>n.symbolizer.u_maxValue),new Zs("u_srcImageSize",n=>n.common.u_srcImageSize)]),t.include(nH),t.code.add(A`vec4 overlay(float val, float minValue, float maxValue, float hillshade, float alpha) {
val = clamp((val - minValue) / (maxValue - minValue), 0.0, 1.0);
vec3 hsv = rgb2hsv(colormap(vec4(val, val, val, 1.0), false).rgb);
hsv.z = hillshade;
return vec4(hsv2rgb(hsv) * alpha, alpha);
}`),t.code.add(A`float getNeighborHoodAlpha(float a, float b, float c, float d, float e, float f, float g, float h, float i){
if (a == 0.0 || a == 0.0 || a==0.0 || a == 0.0 || a == 0.0 || a==0.0 || a == 0.0 || a == 0.0 || a==0.0) {
return 0.0;
}  else {
return e;
}
}`);const r=e.applyColormap?A`gl_FragColor = applyBackgroundBlend(overlay(ve.r, u_minValue, u_maxValue, hillshade, alpha));`:A`hillshade *= alpha;
gl_FragColor = applyBackgroundBlend(vec4(hillshade, hillshade, hillshade, alpha));`;t.code.add(A`
    void main() {
      vec2 pixelLocation = getPixelLocation(uv);
      if (isOutside(pixelLocation)) {
        gl_FragColor = applyBackgroundBlend(vec4(0.0, 0.0, 0.0, 0.0));
        return;
      }

      vec4 currentPixel = getPixel(pixelLocation);
      if (currentPixel.a == 0.0) {
        gl_FragColor = applyBackgroundBlend(vec4(0.0, 0.0, 0.0, 0.0));
        return;
      }

      //mirror edge pixels
      vec2 axy = vec2(-1.0, -1.0);
      vec2 bxy = vec2(0.0, -1.0);
      vec2 cxy = vec2(1.0, -1.0);
      vec2 dxy = vec2(-1.0, 0.0);
      vec2 fxy = vec2(1.0, 0.0);
      vec2 gxy = vec2(-1.0, 1.0);
      vec2 hxy = vec2(0.0, 1.0);
      vec2 ixy = vec2(1.0, 1.0);
      vec2 onePixel = 1.0 / u_srcImageSize;
      if (pixelLocation.s < onePixel.s) {
        axy[0] = 1.0;
        dxy[0] = 1.0;
        gxy[0] = 1.0;
      }
      if (pixelLocation.t < onePixel.t) {
        axy[1] = 1.0;
        bxy[1] = 1.0;
        cxy[1] = 1.0;
      }
      if (pixelLocation.s > 1.0 - onePixel.s) {
        cxy[0] = -1.0;
        fxy[0] = -1.0;
        ixy[0] = -1.0;
      }
      if (pixelLocation.t > 1.0 - onePixel.t) {
        gxy[1] = -1.0;
        hxy[1] = -1.0;
        ixy[1] = -1.0;
      }

      // calculate hillshade
      vec4 va = texture2D(u_image, pixelLocation + onePixel * axy);
      vec4 vb = texture2D(u_image, pixelLocation + onePixel * bxy);
      vec4 vc = texture2D(u_image, pixelLocation + onePixel * cxy);
      vec4 vd = texture2D(u_image, pixelLocation + onePixel * dxy);
      vec4 ve = texture2D(u_image, pixelLocation);
      vec4 vf = texture2D(u_image, pixelLocation + onePixel * fxy);
      vec4 vg = texture2D(u_image, pixelLocation + onePixel * gxy);
      vec4 vh = texture2D(u_image, pixelLocation + onePixel * hxy);
      vec4 vi = texture2D(u_image, pixelLocation + onePixel * ixy);

      // calculate the rate of z change along the x, y, and diagonal direction
      float dzx = (vc + 2.0 * vf + vi - va - 2.0 * vd - vg).r * u_factor.s;
      float dzy = (vg + 2.0 * vh + vi - va - 2.0 * vb - vc).r * u_factor.t;
      float dzd = sqrt(1.0 + dzx * dzx + dzy * dzy);
      float hillshade = 0.0;

      // traditional single light source
      if (u_hillshadeType == 0){
        float cosDelta = u_sinZsinAs[0] * dzy - u_sinZcosAs[0] * dzx;
        float z = (u_cosZs[0] + cosDelta) / dzd;
        if (z < 0.0)  z = 0.0;
        hillshade = z;
      } else {
        // multi-directional with 6 light sources
        for (int k = 0; k < 6; k++) {
        float cosDelta = u_sinZsinAs[k] * dzy - u_sinZcosAs[k] * dzx;
        float z = (u_cosZs[k] + cosDelta) / dzd;
        if (z < 0.0) z = 0.0;
        hillshade = hillshade + z * u_weights[k];
        if (k == 5) break;
        }
      }

      // set color
      float alpha = getNeighborHoodAlpha(va.a, vb.a, vc.a, vd.a, ve.a, vf.a, vg.a, vh.a, vi.a);
      alpha *= u_opacity;
      ${r}
    }
  `)}const AOe=Object.freeze(Object.defineProperty({__proto__:null,ColorizerUniforms:YP,ColorizerStretchUniforms:TOe,ColorizerHillshadeUniforms:COe,build:SOe},Symbol.toStringTag,{value:"Module"})),iB={bandCount:3,outMin:0,outMax:1,minCutOff:[0,0,0],maxCutOff:[255,255,255],factor:[1/255,1/255,1/255],useGamma:!1,gamma:[1,1,1],gammaCorrection:[1,1,1],colormap:null,colormapOffset:null,stretchType:"none",type:"stretch"};let OOe=class{constructor(e,t,r=null,n=null){this.type="raster-tile",this._memoryUsed=null,this._source=null,this._symbolizerParameters=null,this._bandIds=null,this._interpolation=null,this._dirty=!1,this._transformGrid=null,this.isRendereredSource=!1,this.symbolizerRenderer=null,this.rawPixelData=null,this.lij=null,this.opacity=1,this.lij=e,this.source=t,this.width=r||t.width,this.height=n||t.height}get source(){return this._source}set source(e){this._source=e,this._rasterTexture=ke(this._rasterTexture),this._memoryUsed=null}get symbolizerParameters(){return this.isRendereredSource?{...iB,maxCutOff:[1,1,1],factor:[1,1,1]}:this._symbolizerParameters||iB}set symbolizerParameters(e){this._symbolizerParameters=e}get bandIds(){return this._bandIds}set bandIds(e){y(e)&&e.length>0?this._bandIds&&e.every((t,r)=>!!this._bandIds[r]&&t===this._bandIds[r])||(this._bandIds=e,this._dirty=!0):this._bandIds=null}get interpolation(){return this._interpolation||"nearest"}set interpolation(e){if(this._interpolation=e,y(this._rasterTexture)){const t=this._getRasterTextureInterpolation(e);this._rasterTexture.setSamplingMode(t==="bilinear"?Jt.LINEAR:Jt.NEAREST)}}get transformGrid(){return this._transformGrid}set transformGrid(e){this._transformGrid=e,this._transformGridTexture=ke(this._transformGridTexture),this._memoryUsed=null}bind(e){return!!(this.source&&this.source.pixels&&this.source.pixels.length>0)&&((C(this._rasterTexture)||this._dirty)&&this._updateRasterTexture(e,this.bandIds),y(this._rasterTexture)&&(this._updateColormapTexture(e),this.transformGrid&&C(this._transformGridTexture)&&(this._transformGridTexture=Xae(e,this.transformGrid))),!0)}getUniforms(){const{symbolizerParameters:e,transformGrid:t,width:r,height:n,opacity:s}=this,a=Qae(t,[r,n],[this.source.width,this.source.height],s),o=Zae(e.colormap,e.colormapOffset),l=this.symbolizerParameters.type==="stretch"?Yae(this.symbolizerParameters):null,c=this.symbolizerParameters.type==="hillshade"?Kae(this.symbolizerParameters):null;return new YP(a,o,l||c,this._rasterTexture,this._transformGridTexture,this._colormapTexture)}get memoryUsage(){if(C(this._memoryUsed)){const e=[this._rasterTexture,this._transformGridTexture,this._colormapTexture];this._memoryUsed=e.map(t=>y(t)?t.descriptor.width*t.descriptor.height*4:0).reduce((t,r)=>t+r,0)}return this._memoryUsed}release(){return this._rasterTexture=ke(this._rasterTexture),this._transformGridTexture=ke(this._transformGridTexture),this._colormapTexture=ke(this._colormapTexture),this.source=null,this.transformGrid=null,this.rawPixelData=null,!0}_updateRasterTexture(e,t){const r=this.source?this.source.extractBands(t):null;if(!(r&&r.pixels&&r.pixels.length>0))return void(this._rasterTexture=ke(this._rasterTexture));const n=C(t)&&C(this.bandIds)||y(t)&&y(this.bandIds)&&t.join("")===this.bandIds.join("");if(y(this._rasterTexture)&&n)return;this._rasterTexture=ke(this._rasterTexture);const s=this._getRasterTextureInterpolation(this.interpolation);this._rasterTexture=Jae(e,r,s,this.isRendereredSource||this.hasStretchTypeNone())}hasStretchTypeNone(){return"stretchType"in this.symbolizerParameters&&this.symbolizerParameters.stretchType==="none"&&!this.symbolizerParameters.useGamma&&this.source.pixelType==="u8"}_getRasterTextureInterpolation(e){return this.symbolizerParameters.type==="lut"||e==="nearest"||e==="majority"?"nearest":"bilinear"}_updateColormapTexture(e){const t=this._colormap,r=this.symbolizerParameters.colormap;return r?t?r.length!==t.length||r.some((n,s)=>n!==t[s])?(this._colormapTexture=ke(this._colormapTexture),this._colormapTexture=gk(e,r),void(this._colormap=r)):void 0:(this._colormapTexture=gk(e,r),void(this._colormap=r)):(this._colormapTexture=ke(this._colormapTexture),void(this._colormap=null))}},wE=class{constructor(){this.waitingAgents=new Yt,this._upsampleInfo=null,this.loadingAgent=null,this.requestPromise=null,this.requestAbort=null,this.pendingUpdates=0}static acquire(e){const t=HM.acquire();return t._init(e),t}release(){this.dispose(),xE.delete(this),HM.release(this)}dispose(){this.loadingAgent=ke(this.loadingAgent),this.abortRequest(),this._unsetUpsampleInfo(),this.pendingUpdates=0,this._data=U0(this._data)}static prune(){HM.prune(0)}_init(e){this.waitingAgents.clear(),this._data=U0(this._data),this.dataMissing=!1,this.dataInvalidated=!1,this._unsetUpsampleInfo(),this.abortRequest(),this.loadingAgent=null,this.pendingUpdates=0,this._pool=e,this.elevationBounds=null}invalidateSourceData(){this.dataInvalidated=!0,this.dataMissing=!1,this._unsetUpsampleInfo()}abortRequest(){this.requestAbort=iu(this.requestAbort),this.requestPromise=null}get upsampleInfo(){return this._upsampleInfo}_unsetUpsampleInfo(){y(this._upsampleInfo)&&(this._upsampleInfo.tile.unrefMapData(),this._pool.release(this._upsampleInfo),this._upsampleInfo=null)}setUpsampleInfo(e,t){if(e===t||C(t))this._unsetUpsampleInfo();else{if(C(this._upsampleInfo))this._upsampleInfo=this._pool.acquire();else{if(this._upsampleInfo.tile===t)return;this._upsampleInfo.tile.unrefMapData()}t.refMapData(),mOe(e,t,this._upsampleInfo)}}get data(){return this._data}set data(e){U0(this._data),this._data=e}};const HM=new Fl(wE,null,()=>{}),xE=new Map;function MOe(){xE.size>0&&(console.log(`${xE.size} live TilePerLayerInfo allocations:`),xE.forEach(i=>console.log(i,`
`)))}let $y=class{constructor(e){this._texture=e,this.type="tile-texture",this._refCount=1}retain(){++this._refCount}release(){--this._refCount,this._refCount===0&&this._texture.dispose()}get texture(){return this._texture}generateMipmap(){this._texture.generateMipmap()}get descriptor(){return this._texture.descriptor}};var Ge;(function(i){i[i.NONE=0]="NONE",i[i.NONE_HIT_MAXLOD=1]="NONE_HIT_MAXLOD",i[i.SPLIT=2]="SPLIT",i[i.VSPLITMERGE=4]="VSPLITMERGE",i[i.MERGE=8]="MERGE",i[i.RENDERDATA=16]="RENDERDATA",i[i.GEOMETRY=32]="GEOMETRY",i[i.TEXTURE_NOFADING=64]="TEXTURE_NOFADING",i[i.TEXTURE_FADING=128]="TEXTURE_FADING"})(Ge||(Ge={}));const jM=P(),iy=P(),Sn=P(),IOe=.1;let LOe=class{constructor(){this.fovX=0,this.fovY=0,this.relativeWidthLimit=0,this.relativeHeightLimit=0,this.maxLod=0,this.angledSplitBias=0,this.aboveGround=!0}},K4=class{constructor(){this.lij=[0,0,0],this._children=[null,null,null,null],this._pendingUpdates=0,this._dirty=!0,this._previouslyRendered=!1,this.extent=Nt(),this._elevationBounds=Te(),this.layerInfo=[[],[]],this.extentInRadians=Nt(),this.centerAtSeaLevel=P(),this._center=[P(),ou(),P()],this.up=kre(),this._isWithinClippingArea=!0,this._intersectsClippingArea=!0,this._maxTesselation=0,this._usedMemory=null,this._mapTileMemoryInternal=0,this._mapDataRefCount=0,this._screenDepth=0,this.renderOrder=0,this._edgeLen=0,this._edgeLen2=0,this._curvatureHeight=0,this.extentMidX=0,this.extentMidY=0}static prune(){J4.prune(0),e5.prune(0),wE.prune()}get _isCached(){return!this.shouldLoad&&this._mapDataRefCount<=0}get maxTesselation(){return this._maxTesselation}get isWithinClippingArea(){return this._isWithinClippingArea}get intersectsClippingArea(){return this._intersectsClippingArea}get clippingArea(){return this._clippingArea}get parent(){return this._parent}get children(){return this._children}get surface(){return this._surface}get elevationBounds(){return this._elevationBounds}get level(){return this.lij[0]}get key(){return`${this.lij[0]}/${this.lij[1]}/${this.lij[2]}`}get edgeLen(){return this._edgeLen}get radius(){return this._center[Hs.MIDDLE][3]}get screenDepth(){return this._screenDepth}get visible(){return this._dirty&&this.computeVisibility(),this._visible}get frustumVisibility(){return this._dirty&&this.computeVisibility(),this._frustumVisibility}computeVisibility(){var r;this._dirty=!1;const e=((r=this.parent)==null?void 0:r.frustumVisibility)??xs.INTERSECTS;this._frustumVisibility=e===xs.INSIDE?xs.INSIDE:e===xs.OUTSIDE?xs.OUTSIDE:this._calculateFrustumVisibilityStatus(this.surface.frustum);const t=this._frustumVisibility!==xs.OUTSIDE&&this._intersectsClippingArea;t!==this._visible&&(this._visible=t,this._surface.emit("tiles-visibility-changed"),this._surface.renderer.setDirty(),this.updateAgentSuspension())}get loadable(){return this.visible||this._surface.view.state.fixedContentCamera}get rendered(){const e=!!this.renderData;return e!==this._previouslyRendered&&(this._surface.emit("tiles-visibility-changed"),this._previouslyRendered=e,this._surface.renderer.setDirty()),e}get shouldLoad(){const e=this._surface.snapLevel;if(y(e)){const t=this.level-e;if(t===0)return!0;if(t===1)return!1}return this.isLeaf}init(e,t,r){this.lij[0]=e[0],this.lij[1]=e[1],this.lij[2]=e[2],this.ellipsoid=Kt(r.tilingScheme.spatialReference),r.tilingScheme.getExtent(e[0],e[1],e[2],this.extent),r.tilingScheme.convertExtentToRadians(this.extent,this.extentInRadians),this.extentMidX=.5*(this.extent[0]+this.extent[2]),this.extentMidY=.5*(this.extent[1]+this.extent[3]),this._isWithinClippingArea=!0,this._intersectsClippingArea=!0,this._clippingArea=null,this._mapDataRefCount=0,r.upsampleMapCache.pop(this.key),this._edgeLen=0,this._edgeLen2=0,this._center[Hs.MIDDLE][3]=0,this.vlevel=e?e[0]:0,t&&t.elevationBounds?wn(this._elevationBounds,t.elevationBounds):rt(this._elevationBounds,0,0),this._pendingUpdates=0,this.renderData=null,this._screenDepth=0,this._visible=!1,this._previouslyRendered=!1,this._parent=t,this.unsetChildren(),this._surface=r,this.updateVisibility();for(const n of Gf){const s=r.numLayers(n),a=this.layerInfo[n];for(const o of a)o.release();a.length=s;for(let o=0;o<s;o++)a[o]=wE.acquire(this._surface.upsampleInfoPool),n===vt.ELEVATION&&this.findElevationBoundsForLayer(o,-1)}this.computeElevationBounds(),this._maxTesselation=Math.min(r.tilingScheme.pixelSize,ib)}release(){$h(!this.renderData,"tile.renderData was not unloaded"),this._surface.upsampleMapCache.pop(this.key);for(const e of Gf){for(const t of this.layerInfo[e])t.release();this.layerInfo[e].length=0}this._parent=null;for(let e=0;e<4;++e)this._children[e]=null;this._surface=null,this.setMemoryDirty()}refMapData(){++this._mapDataRefCount,this._isCached||this._surface.upsampleMapCache.pop(this.key)}unrefMapData(){if(--this._mapDataRefCount,this._isCached){this.setMemoryDirty();const e=this._cachedMemory;e>0&&this._surface.upsampleMapCache.put(this.key,this,e)}}setMemoryDirty(){this._usedMemory=null}get usedMemory(){return this._ensureUsedMemory()+(this._isCached?0:this._mapTileMemoryInternal)}get _cachedMemory(){return this._isCached?this._mapTileMemory:0}get _mapTileMemory(){return this._ensureUsedMemory(),this.layerInfo[vt.MAP].reduce((e,t)=>e+(t instanceof GM?t.memoryUsage:0),this._mapTileMemoryInternal)}get _cpuImageMemorySize(){const t=this._surface.tilingScheme.pixelSize;return t*t*4}_ensureUsedMemory(){if(y(this._usedMemory))return this._usedMemory;this._usedMemory=0,this._mapTileMemoryInternal=0;let e=0;for(const{data:r}of this.layerInfo[vt.MAP])r instanceof GM?e+=this._getTerrainDataMemory(r):this._mapTileMemoryInternal+=this._getTerrainDataMemory(r);const t=this._cpuImageMemorySize;for(const r of this.layerInfo[vt.ELEVATION])this._usedMemory+=r.data?t:0;return this.renderData&&(this._usedMemory+=this.renderData.estimatedGeometryMemoryUsage,this._mapTileMemoryInternal+=qE(this.renderData.textureDescriptor)),this._isCached&&this._surface.upsampleMapCache.updateSize(this.key,this,this._mapTileMemoryInternal+e),this._usedMemory}getUsedMemoryForLayer(e,t){const r=this.layerInfo[e][t];return r!=null&&r.data?e===vt.MAP?this._isCached?0:this._getTerrainDataMemory(r.data):e===vt.ELEVATION?this._cpuImageMemorySize:0:0}_getTerrainDataMemory(e){return e instanceof $y?qE(e.texture):e instanceof HTMLImageElement||e instanceof WP?this._cpuImageMemorySize:e instanceof GM||e instanceof OOe?e.memoryUsage:0}updateScreenDepth(e){const t=this._center[Hs.MIDDLE],r=e,n=t[0],s=t[1],a=t[2],o=r[2]*n+r[6]*s+r[10]*a+r[14];this._screenDepth=o<0?0:o/(r[3]*n+r[7]*s+r[11]*a+r[15])}shouldSplit(e,t,r){if(!this.visible||y(e.frustum)&&(!this._intersectsClippingArea||this._calculateFrustumVisibilityStatus(e.frustum)===xs.OUTSIDE))return Ge.NONE;const n=this.level;ae(jM,this._center[Hs.MIDDLE],t);let s=Ml(jM),a=Hs.MIDDLE;ae(iy,this._center[Hs.TOP],t);const o=Ml(iy);o<s&&(s=o,a=Hs.TOP),ae(iy,this._center[Hs.BOTTOM],t);const l=Ml(iy);if(l<s&&(s=l,a=Hs.BOTTOM),this._edgeLen2>s&&n<e.maxLod)return Ge.SPLIT;const c=Math.sqrt(s),u=e.fovX*c*2,d=this._edgeLen/u,m=()=>{const w=n+Math.ceil(-Math.log2(e.relativeWidthLimit/d));return w!==this.vlevel?(this.vlevel=w,Ge.VSPLITMERGE):Ge.NONE_HIT_MAXLOD};if(y(r)&&r-n===1)return n>=e.maxLod?m():Ge.SPLIT;const f=_e(this.up,jM),_=this._elevationBounds[1]-this._elevationBounds[0],g=_/this.edgeLen;if(e.aboveGround&&f>0&&g<.001&&f/c-Math.sin(this._curvatureHeight/(this.edgeLen*Math.SQRT1_2)*Math.PI)-g>0)return Ge.NONE;if(d<e.relativeWidthLimit)return this.vlevel!==this.level?(this.vlevel=this.level,Ge.VSPLITMERGE):Ge.NONE;if(n>=e.maxLod)return m();if(n>6){ae(iy,this._center[a],t),Q(Sn,this.up,f),ae(Sn,Sn,iy);const w=Ml(Sn);if(w>this.radius*this.radius){Q(Sn,Sn,this.radius/Math.sqrt(w)),ce(Sn,Sn,this._center[a]),ae(Sn,t,Sn);const v=Math.min(1,(Math.abs(_e(Sn,this.up))+.5*_+this._curvatureHeight)/we(Sn)),b=IOe/e.angledSplitBias,x=e.fovY*c*2;if(v*(this._edgeLen/x)<b*e.relativeHeightLimit)return Ge.NONE}}return Ge.SPLIT}setChildren(e,t,r,n){$h(!!(e&&t&&r&&n),"Null child passed"),this._children[0]=e,this._children[1]=t,this._children[2]=r,this._children[3]=n}unsetChildren(){this._children[0]=null,this._children[1]=null,this._children[2]=null,this._children[3]=null}get isLoaded(){var e;return((e=this.renderData)==null?void 0:e.hasGeometry)??!1}load(){this.refMapData();for(const e of Gf)this._createOrUpdateAgents(0,e);this.surface.renderer.loadTile(this)}unload(e){e.unloadTile(this);for(const t of Gf){const r=this.layerInfo[t];for(const n of r)n.loadingAgent&&n.loadingAgent!==za&&(nS(n.loadingAgent),n.loadingAgent=null),n.pendingUpdates=0}this.resetPendingUpdate(Ge.GEOMETRY),this.resetPendingUpdate(Ge.TEXTURE_NOFADING),this.resetPendingUpdate(Ge.TEXTURE_FADING),this.unrefMapData()}unloadMapData(){const e=this.layerInfo[vt.MAP];for(const t of e)t.loadingAgent&&t.loadingAgent!==za&&(nS(t.loadingAgent),t.loadingAgent=null),t.pendingUpdates=0;this.renderData&&this.renderData.releaseTexture(),this.setMemoryDirty()}updateClippingStatus(e){if(fg(e,this._clippingArea))return!1;const t=this._intersectsClippingArea,r=this._isWithinClippingArea;y(e)?(this._intersectsClippingArea=this.intersectsExtent(e),this._isWithinClippingArea=this._isWithinExtent(e)):(this._intersectsClippingArea=!0,this._isWithinClippingArea=!0),this._clippingArea=e,this.updateVisibility();const n=r&&this._isWithinClippingArea,s=!(r||t||this._isWithinClippingArea||this._intersectsClippingArea);return!this.renderData||n||s||this.setPendingUpdate(Ge.GEOMETRY),!0}updateVisibility(){this._dirty=!0,this._surface.setTileTreeDirty()}getLayerInfo(e,t){return this.layerInfo[t][e]}hasLayerData(e,t){const r=this.layerInfo[t][e];return!(!r||!r.data||r.dataInvalidated)}get updating(){if(this.hasPendingUpdates)return!0;for(const e of Gf){const t=this.layerInfo[e];for(const r of t)if(r.loadingAgent&&r.loadingAgent!==za&&r.loadingAgent.updating)return!0}return!1}_isSuspended(e){return!!this.hasPendingUpdate(Ge.SPLIT)||e!==vt.ELEVATION&&!this.loadable}get hasPendingUpdates(){return this._pendingUpdates!==0}hasPendingUpdate(e){return(this._pendingUpdates&e)===e}setPendingUpdate(e){this._pendingUpdates|=e,e===Ge.SPLIT||e===Ge.MERGE?this._surface.setTileTreeDirty():this._surface.requestUpdate()}resetPendingUpdate(e){return!!this.hasPendingUpdate(e)&&(this._pendingUpdates&=~e,!0)}requestLayerData(e,t,r){const n=this.layerInfo[t][e];if(n.waitingAgents.has(r))return console.warn("agent already requested this piece of map data (tile %s, agent tile %s, layer: %d/%d)",this.lij.toString(),r.tile.lij.toString(),t,e),!0;if(n.waitingAgents.push(r),n.data&&!n.dataInvalidated)return console.warn("agent requested existing data (tile %s, agent tile %s, layer: %d/%d)",this.lij.toString(),r.tile.lij.toString(),t,e),r.dataArrived(this),!0;if(n.requestPromise)return!0;iu(n.requestAbort),n.requestAbort=new AbortController;const s=this._surface.requestTileData(this,e,t,n.requestAbort);if(!s)return n.requestAbort=null,!1;const a=()=>{n.requestPromise===s&&(n.requestPromise=null,n.requestAbort=null)};return n.requestPromise=s,s.then(a,a),!0}get isLeaf(){return this._children[0]==null}hasLij(e){return this.lij[0]===e[0]&&this.lij[1]===e[1]&&this.lij[2]===e[2]}findByLij(e){return this.hasLij(e)?this:this.isLeaf?null:this._children[0].findByLij(e)||this._children[1].findByLij(e)||this._children[2].findByLij(e)||this._children[3].findByLij(e)||null}distanceToSquared(e){return Ml(ae(Sn,this._center[Hs.MIDDLE],e))}containsPoint(e){const t=this.extent;return e[0]>=t[0]&&e[1]>=t[1]&&e[0]<=t[2]&&e[1]<=t[3]}containsPointXY(e,t){const r=this.extent;return e>=r[0]&&t>=r[1]&&e<=r[2]&&t<=r[3]}unrequestLayerData(e,t,r){const n=this.layerInfo[t][e],s=n.waitingAgents,a=s.removeUnordered(r)!=null;$h(a,"agent has not requested this piece of map data"),s.length<1&&(n.abortRequest(),this.setMemoryDirty())}dataArrived(e,t,r){const n=this.layerInfo[t][e];n.data=r,n.dataInvalidated=!1,n.waitingAgents.forAll(s=>s.dataArrived(this)),n.waitingAgents.clear(),this.setMemoryDirty()}dataMissing(e,t,r){r.notInTilemap||console.error(`Tile ${this.lij.toString()} layer ${t}/${e} error ${r}`);const n=this.layerInfo[t][e];n.dataMissing=!0,n.waitingAgents.forAll(s=>s.dataMissing()),n.waitingAgents.clear(),this.setMemoryDirty()}updateRenderData(e,t){switch(e){case vt.MAP:return this._updateTexture(t);case vt.ELEVATION:return this._updateGeometry()}}_updateTexture(e){this.renderData&&(this.resetPendingUpdate(e===fn.FADING?Ge.TEXTURE_NOFADING:Ge.TEXTURE_FADING),this.setPendingUpdate(e===fn.FADING?Ge.TEXTURE_FADING:Ge.TEXTURE_NOFADING))}_updateGeometry(){this.setPendingUpdate(Ge.GEOMETRY);for(const e of this.layerInfo[vt.ELEVATION])e.pendingUpdates|=Ge.GEOMETRY}invalidateLayerData(e,t){this.layerInfo[t][e].invalidateSourceData(),this.restartAgents(t)}computeElevationBounds(){const e=this._elevationBounds;rt(e,1/0,-1/0);const t=this.layerInfo[vt.ELEVATION];let r=!0;for(const n of t)y(n.elevationBounds)&&(e[0]=Math.min(e[0],n.elevationBounds.min),e[1]=Math.max(e[1],n.elevationBounds.max),n.elevationBounds.hasNoDataValues||(r=!1));r&&(e[0]=Math.min(e[0],0),e[1]=Math.max(e[1],0)),this.updateRadiusAndCenter(),this._surface.setTileTreeDirty()}_updateCenter(){const e=this._elevationBounds,t=.5*(e[0]+e[1]);Q(Sn,this.up,t),ce(this._center[Hs.MIDDLE],this.centerAtSeaLevel,Sn),Q(Sn,this.up,e[0]),ce(this._center[Hs.TOP],this.centerAtSeaLevel,Sn),Q(Sn,this.up,e[1]),ce(this._center[Hs.BOTTOM],this.centerAtSeaLevel,Sn)}findElevationBoundsForLayer(e,t){const r=this.layerInfo[vt.ELEVATION][e];if(y(r.elevationBounds)&&r.elevationBounds.level>=t)return;const n=this._surface.layerViewByIndex(e,vt.ELEVATION),s=S$(n);if(!hw(this,s,!1))return;const a=DOe;let o=!1;if(r.data){const l=r.data;a.min=l.bounds[0],a.max=l.bounds[1],a.hasNoDataValues=l.hasNoDataValues,a.level=this.level,o=!0}else{let l,c,u=0;for(let d=this._parent;d&&(!c||u<aE(this.level))&&(u=this.vlevel-d.level,l=c||l,c=d.layerInfo[vt.ELEVATION][e].data,!(!c&&l&&u>=aE(this.level)));d=d.parent);c=c||l,c&&(c.computeMinMaxValue(this.lij[0],this.lij[1],this.lij[2],a),a.min!==1/0&&(a.level=c.level,o=!0))}o&&(C(r.elevationBounds)&&(r.elevationBounds=new x0),r.elevationBounds.copyFrom(a))}modifyLayers(e,t,r){const n=this.layerInfo[r];for(const o of n)o.loadingAgent&&o.loadingAgent!==za&&(nS(o.loadingAgent),o.loadingAgent=null),o.waitingAgents.clear();for(let o=0;o<n.length;++o)e[o]===void 0&&n[o].release();const s=new Array(...n),a=t.length;n.length=a;for(let o=0;o<a;o++){const l=t[o];n[o]=l>-1?s[l]:wE.acquire(this._surface.upsampleInfoPool)}this.setMemoryDirty()}restartAgents(e){this.renderData&&(this._createOrUpdateAgents(0,e),this.updateRenderData(e,fn.FADING))}updateAgents(e){if(this.renderData){const t=this.layerInfo[e];for(const r of t)r.loadingAgent===za&&(r.loadingAgent=null);this._createOrUpdateAgents(0,e)}}updateAgentSuspension(){for(const e of Gf){const t=this._isSuspended(e);for(const r of this.layerInfo[e])r.loadingAgent&&r.loadingAgent!==za&&(r.loadingAgent.setSuspension(t),r.loadingAgent===za&&this.updateRenderData(e,fn.FADING))}}removeLayerAgent(e,t){const r=this.layerInfo[t][e];r.loadingAgent&&r.loadingAgent!==za&&r.loadingAgent.dispose(),r.loadingAgent=null}agentDone(e,t){const r=this.layerInfo[t][e];r.loadingAgent=za,!r.data&&C(r.upsampleInfo)&&this._createOrUpdateAgents(e+1,t)}_hasBlendableAncestor(e){return e.blendMode!=="normal"||mv(e.parent)&&this._hasBlendableAncestor(e.parent)}_hasBlendModes(e,t,r){var n,s,a;for(let o=e;o<t;++o){const l=this._surface.layerViewByIndex(o,r);if(bR(l)&&((n=l==null?void 0:l.layer)==null?void 0:n.blendMode)!=="normal"||mv((s=l==null?void 0:l.layer)==null?void 0:s.parent)&&this._hasBlendableAncestor((a=l==null?void 0:l.layer)==null?void 0:a.parent))return!0}return!1}_createOrUpdateAgents(e,t){const r=this.layerInfo[t];if(r.length===0)return;const n=this._isSuspended(t);for(let s=e;s<r.length;++s){const a=r[s];let o=!1;const l=this._surface.layerViewByIndex(s,t),c=S$(l);if(a.loadingAgent?hw(this,c,!1)?(a.loadingAgent!==za&&a.loadingAgent.setSuspension(n),a.loadingAgent!==za&&(o=a.loadingAgent.update())):a.dispose():hw(this,c,!1)&&(a.loadingAgent=$Oe(this,s,t,n),o=a.loadingAgent.startLoading(),o?a.loadingAgent===za&&this.setPendingUpdate(Ge.GEOMETRY):(nS(a.loadingAgent),a.loadingAgent=za)),a.loadingAgent===za&&this.updateRenderData(t,fn.FADING),!this._hasBlendModes(e,r.length,t)&&o&&l.isOpaque)return}}_isWithinExtent(e){const t=this.extent;return t[0]>=e[0]&&e[2]>=t[2]&&t[1]>=e[1]&&e[3]>=t[3]}intersectsExtent(e){const t=this.extent;return t[2]>=e[0]&&e[2]>=t[0]&&t[3]>=e[1]&&e[3]>=t[1]}getElevationBasedVerticesPerSide(e){const t=this.vlevel-this.level,r=Math.max(this.level-e,aE(this.level)-t);return ue(1+(this.maxTesselation>>r),2,this.maxTesselation+1)}get test(){return{cachedMemory:this._cachedMemory}}_findLIJ(e,t){if(!e)return null;const r=this.surface.rootTiles;if(y(r)){for(const n of r)if(FOe(n,e)){let s=n,a=e[0]-s.level-1;for(;a>=0&&!s.isLeaf&&!t(s);){const o=e[1]>>a&1,l=e[2]>>a&1;s=s.children[2*o+l],a--}return t(s)?s:null}}return null}findNeighborTile(e,t){const r=this.lij,n=this.getNeighborLIJ(r,e);return n?NOe(r,n)?t(this)?this:null:this._findLIJ(n,t):null}findCorner(e,t){const r=e===qe.NORTH_EAST?1:e===qe.NORTH_WEST?0:e===qe.SOUTH_WEST?2:3;let n=this;for(;!(n.isLeaf||t&&t(n));)n=n.children[r];return n}findNeighborCornerTileExact(e,t){var r;return(r=this.findNeighborTile(e,n=>t(n)||n.level===this.level))==null?void 0:r.findCorner(P$(e),t)}forAllSubtreeOnSide(e,t){const r=e===qe.NORTH?[0,1]:e===qe.NORTH_EAST?[1]:e===qe.EAST?[1,3]:e===qe.SOUTH_EAST?[3]:e===qe.SOUTH?[2,3]:e===qe.SOUTH_WEST?[2]:e===qe.WEST?[0,2]:[0],n=s=>{t(s)||s.isLeaf||r.forEach(a=>n(s.children[a]))};n(this)}forallNeighbors(e){xR.forEach(t=>this.findNeighborCornerTileExact(t,e)),jh.forEach(t=>{var r;return(r=this.findNeighborTile(t,n=>n.level===this.level||e(n)))==null?void 0:r.forAllSubtreeOnSide(wR(t),e)})}getNeighborEdgeStartVertexIndex(e,t){if(!t)return 0;const r=this.level-t.level;if(fe(!gn||r>=0),r===0)return 0;const n=2**r,s=(1&e)==1,a=s?0:1,o=t.lij[a+1]*n,l=this.lij[a+1],c=l-o,u=s?n-1-c:c;return gn&&(fe(o<=l&&l<o+n),fe(0<=u&&u<n)),u}forEachLoadedNeighbor(e){const t=this.level,r=n=>n.level===t||n.isLoaded;jh.forEach(n=>{const s=this.findNeighborTile(n,r);s!=null&&s!==this&&s.forAllSubtreeOnSide(wR(n),a=>!!a.isLoaded&&(e(a,n),!0))}),xR.forEach(n=>{var a;const s=(a=this.findNeighborTile(n,r))==null?void 0:a.findCorner(P$(n),o=>o.isLoaded);fe(!s||L$(this,s,n)),s!=null&&s.isLoaded&&e(s,n)})}getNeighborLIJ(e,t){const r=Wz(t)?-1:qz(t)?1:0,n=Hz(t)?-1:jz(t)?1:0,s=[e[0],e[1]+r,e[2]+n];return s[1]<0?null:this.surface.isGlobal?this.wrapLIJ(s):s[2]<0?null:s}wrapLIJ(e){return!e||e[1]<0||e[1]>=2**e[0]?null:this.surface.wrapEastWest(e)}get westNeighborWestExtent(){return this.extent[0]*(this.isWestEnd?-1:1)}get eastNeighborEastExtent(){return this.extent[2]*(this.isEastEnd?-1:1)}get isEastEnd(){return this.lij[2]===this.surface.lijEastEnd(this.level)-1}get isWestEnd(){return this.lij[2]===0}get isNorthEnd(){return this.lij[1]===0}get isSouthEnd(){return this.extent[1]+wD()>=this.surface.extent[1]}compareLIJs(e){const t=this.lij,r=t[0],n=e[0];if(r===n)return[t,e];const s=r-n;if(s<0){const a=2**-s;return[[n,t[1]*a,t[2]*a],e]}{const a=2**s;return[t,[r,e[1]*a,e[2]*a]]}}checkGeometryWaterproofness(){yR&&(fe(this.isLoaded),this.renderData.checkGeometryWaterproofness())}shouldHaveNeighbor(e){const t=this.extent,r=this.surface.rootTilesExtent,n=.25*(t[2]-t[0]);if(Wz(e)&&t[3]+n>=r[3]||qz(e)&&t[1]-n<=r[1])return!1;const s=this.surface.isGlobal;return!(!s&&Hz(e)&&t[0]-n<=r[0])&&!(!s&&jz(e)&&t[2]+n>=r[2])}};function $Oe(i,e,t,r){const n=t===vt.ELEVATION?e5.acquire():J4.acquire();return n.init(i,e,t,r),n}function nS(i){i.dispose(),i instanceof CJ?e5.release(i):i instanceof SJ&&J4.release(i)}const J4=new Fl(SJ),e5=new Fl(CJ),DOe=new x0;var Hs;function FOe(i,e){const t=i.level,r=e[0];if(t>r)return!1;const n=r-t,s=Math.floor(e[1]/2**n),a=Math.floor(e[2]/2**n);return s===i.lij[1]&&a===i.lij[2]}function NOe(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]}function id(i,e,t){return Math.abs(i-e)<=t}function kOe(i,e,t){if(C(i)||C(e))return!1;if(i.level===0&&e.level===0&&(i.isEastEnd&&e.isWestEnd&&t===qe.EAST||i.isWestEnd&&e.isEastEnd&&t===qe.WEST))return!0;const r=Math.max(1e-6*(i.extent[2]-i.extent[0]),1);switch(t){case qe.NORTH:return id(i.extent[3],e.extent[1],r);case qe.SOUTH:return id(i.extent[1],e.extent[3],r);case qe.EAST:return id(i.extent[2],e.extent[0],r)||id(i.extent[2],-e.extent[0],r);case qe.WEST:return id(i.extent[0],e.extent[2],r)||id(i.extent[0],-e.extent[2],r)}}function L$(i,e,t){return!C(i)&&!C(e)&&e!==i&&(i.level>=e.level?rB(i,e,t):rB(e,i,P$(t)))}function rB(i,e,t){fe(i.level>=e.level);const r=gAe(t),n=_Ae(t),s=i.extent,a=e.extent,o=[r?s[0]:s[2],n?s[3]:s[1]],l=[r?a[2]:a[0],n?a[1]:a[3]],c=1e-5*(s[2]-s[0]),u=id(o[0],l[0],c)||i.surface.isGlobal&&id(o[0],-l[0],c),d=id(o[1],l[1],c);if(u&&d)return!0;if(i.level===e.level||!u&&!d)return fe(!1),!1;const m=u?nB(a[1],a[3],s[1],s[3],c):nB(a[0],a[2],s[0],s[2],c);return fe(m),m}function nB(i,e,t,r,n=wD()){return i-n<=t&&t<=r&&r<=e+n}(function(i){i[i.TOP=0]="TOP",i[i.MIDDLE=1]="MIDDLE",i[i.BOTTOM=2]="BOTTOM"})(Hs||(Hs={}));let VOe=class{constructor(){this._scales=Bi(-1,-1,-1,-1),this._offsets=Bi(-1,-1,-1,-1)}clear(){this._scales[0]=this._scales[1]=this._scales[2]=this._scales[3]=-1,this._offsets[0]=this._offsets[1]=this._offsets[2]=this._offsets[3]=-1}setScale(e,t,r){this._scales[2*e]=t,this._scales[2*e+1]=r}setOffset(e,t,r){this._offsets[2*e]=t,this._offsets[2*e+1]=r}get scales(){return this._scales}get offsets(){return this._offsets}};function UOe(i,e){i.varyings.add("tbnTangent","vec3"),i.varyings.add("tbnBiTangent","vec3"),e.spherical?i.vertex.code.add(A`void forwardVertexTangent(vec3 n) {
tbnTangent = normalize(cross(vec3(0.0, 0.0, 1.0), n));
tbnBiTangent = normalize(cross(n, tbnTangent));
}`):i.vertex.code.add(A`void forwardVertexTangent(vec3 n) {
tbnTangent = vec3(1.0, 0.0, 0.0);
tbnBiTangent = normalize(cross(n, tbnTangent));
}`),i.fragment.code.add(A`mat3 getTBNMatrix(vec3 n) {
return mat3(tbnTangent, tbnBiTangent, n);
}`)}let t5=class extends Eae{constructor(){super(...arguments),this.slicePlaneLocalOrigin=P(),this.origin=this.slicePlaneLocalOrigin}};var Zo,yr;(function(i){i[i.Material=0]="Material",i[i.ShadowMap=1]="ShadowMap",i[i.Highlight=2]="Highlight"})(Zo||(Zo={})),function(i){i[i.Color=0]="Color",i[i.Alpha=1]="Alpha",i[i.Depth=2]="Depth",i[i.Normal=3]="Normal",i[i.ObjectAndLayerIdColor=4]="ObjectAndLayerIdColor"}(yr||(yr={}));let zOe=class extends t5{constructor(){super(...arguments),this.identifier=Zo.Material,this.transparent=!1,this.integratedMesh=!1}},BOe=class extends t5{constructor(){super(...arguments),this.identifier=Zo.ShadowMap}},GOe=class extends t5{constructor(){super(...arguments),this.identifier=Zo.Highlight}},TR=class extends t_{constructor(e,t){super(e,"vec4",UD.Draw,(r,n,s)=>r.setUniform4fv(e,t(n,s)))}};var bd;function HOe(i,e){const{vertex:t,fragment:r}=i;t.uniforms.add([new TR("overlayTexOffset",(n,s)=>jOe(n,s)),new TR("overlayTexScale",(n,s)=>qOe(n,s))]),r.constants.add("overlayOpacity","float",1),r.uniforms.add(new Ht("ovColorTex",(n,s)=>$$(n,s))),AJ(i,e)}function AJ(i,e){i.extensions.add("GL_OES_standard_derivatives"),e.pbrMode!==zr.Water&&e.pbrMode!==zr.WaterOnIntegratedMesh||i.include(Pne,e);const{vertex:t,fragment:r}=i;i.varyings.add("vtcOverlay","vec4"),t.code.add(A`void setOverlayVTC(in vec2 uv) {
vtcOverlay = vec4(uv, uv) * overlayTexScale + overlayTexOffset;
}`),r.code.add(A`bool isValid(vec2 uv, vec2 dxdy) {
return (uv.x >= 0.0 + dxdy.x) && (uv.x <= 1.0 - dxdy.x) && (uv.y >= 0.0 + dxdy.y) && (uv.y <= 1.0 - dxdy.y);
}
vec4 getOverlayColor(sampler2D ov0Tex, vec4 texCoords) {
vec4 color0 = texture2D(ov0Tex, vec2(texCoords.x * 0.5, texCoords.y));
vec4 color1 = texture2D(ov0Tex, vec2(texCoords.z * 0.5 + 0.5, texCoords.w));
bool isValid0 = isValid(texCoords.xy, fwidth(texCoords.xy));
bool isValid1 = isValid(texCoords.zw, vec2(0.0, 0.0));
return mix(color1 * float(isValid1), color0, float(isValid0));
}`),r.code.add(A`vec4 getCombinedOverlayColor() {
return overlayOpacity * getOverlayColor(ovColorTex, vtcOverlay);
}`),e.pbrMode!==zr.Water&&e.pbrMode!==zr.WaterOnIntegratedMesh||(VR(r),FD(r),r.code.add(A`vec4 getOverlayWaterColor(vec4 maskInput, vec4 colorInput, vec3 vposEyeDir,
float shadow, vec3 localUp, mat3 tbn, vec3 position, vec3 positionWorld) {
vec3 n = normalize(tbn *  (2.0 * maskInput.rgb - vec3(1.0)));
vec3 v = vposEyeDir;
vec3 final = getSeaColor(n, v, mainLightDirection, colorInput.rgb, mainLightIntensity, localUp, 1.0 - shadow, maskInput.w, position, positionWorld);
return vec4(final, colorInput.w);
}`))}function $$(i,e){return e.overlays.length===0?null:i.identifier===Zo.Material&&i.subPass===yr.Color?e.overlays[ki.INNER].getColorTextureNoRasterImage():i.identifier===Zo.Highlight?e.overlays[ki.INNER].getValidTexture(er.Highlight):null}function jOe(i,e){for(const t of e.overlays){const{index:r,extent:n}=t;EG(n)>0&&(z0[2*r]=i.toMapSpace[0]/Nh(n)-n[0]/Nh(n),z0[2*r+1]=i.toMapSpace[1]/Mm(n)-n[1]/Mm(n))}return z0}function qOe(i,e){for(const t of e.overlays){const{index:r,extent:n}=t;EG(n)>0&&(z0[2*r]=i.toMapSpace[2]/Nh(n),z0[2*r+1]=i.toMapSpace[3]/Mm(n))}return z0}(function(i){i[i.Disabled=0]="Disabled",i[i.Enabled=1]="Enabled",i[i.EnabledWithWater=2]="EnabledWithWater",i[i.COUNT=3]="COUNT"})(bd||(bd={}));const z0=yi();var qh;(function(i){i[i.LayerOnly=0]="LayerOnly",i[i.ColorComposite=1]="ColorComposite",i[i.GridComposite=2]="GridComposite",i[i.COUNT=3]="COUNT"})(qh||(qh={}));let WOe=class extends Ir{constructor(){super(...arguments),this.overlayOpacity=1}};function sS(i,e){i.vertex.uniforms.add([new CR("overlayTexOffset"),new CR("overlayTexScale")]),i.fragment.uniforms.add([new Pt("overlayOpacity",t=>t.overlayOpacity),new Ht("ovColorTex",(t,r)=>r.overlays.length===0?null:r.overlays[ki.INNER].getColorTexture(t.overlaySource))]),AJ(i,e)}function XOe(i,e){const{vertex:t,fragment:r,varyings:n}=i;n.add("vtc","vec2"),t.uniforms.add(new CR("texOffsetAndScale")),r.uniforms.add(new sB("tex")),r.uniforms.add(new qM("textureOpacities"));const s=e.textureFadingEnabled&&!e.renderOccluded;s&&(t.uniforms.add(new CR("nextTexOffsetAndScale")),n.add("nvtc","vec2"),r.uniforms.add(new sB("texNext")),r.uniforms.add(new qM("nextTexOpacities")),r.uniforms.add(new QOe("fadeFactor")));const a=e.tileBlendInput===qh.ColorComposite,o=e.tileBlendInput===qh.GridComposite;o&&r.include(Y4),a&&r.uniforms.add(new qM("backgroundColor")),t.code.add(A`
  void forwardTextureCoordinatesWithTransform(in vec2 uv) {
    vtc = uv * texOffsetAndScale.zw + texOffsetAndScale.xy;
    ${s?A`nvtc = uv * nextTexOffsetAndScale.zw + nextTexOffsetAndScale.xy;`:A``}
  }`),r.code.add(A`
    vec4 getColor(vec4 color, vec2 uv, vec3 opacities) {
      ${o||a?A`
              if (opacities.y <= 0.0) {
                return color * opacities.z * opacities.x;
              }
              vec4 bg = ${a?A`vec4(backgroundColor, 1.0)`:A`gridColor(uv)`} * opacities.y;
              float alpha = opacities.z * color.a;
              return mix(bg, color, alpha) * opacities.x;`:A`return color;`}
    }`),s?r.code.add(A`vec4 getTileColor() {
vec4 color = getColor(texture2D(tex, vtc), vtc, textureOpacities);
if (fadeFactor >= 1.0) {
return color;
}
vec4 nextColor = getColor(texture2D(texNext, nvtc), nvtc, nextTexOpacities);
return mix(nextColor, color, fadeFactor);
}`):r.code.add(A`vec4 getTileColor() {
return getColor(texture2D(tex, vtc), vtc, textureOpacities);
}`)}let QOe=class extends t_{constructor(e){super(e,"float")}},qM=class extends t_{constructor(e){super(e,"vec3")}},CR=class extends t_{constructor(e){super(e,"vec4")}},sB=class extends t_{constructor(e){super(e,"sampler2D")}},OJ=class extends WOe{};function ZOe(i){const e=new Yi,{vertex:t,fragment:r,varyings:n}=e;e.include(tse),e.include(Rae,i),e.include(kR,i);const s=()=>{e.include(ooe,i),t.code.add(A`
  vec3 decodeNormalTerrain(vec2 e) {
    float z = 1.0 - abs(e.x) - abs(e.y);
    vec3 n = vec3(e + vec2(e.x >= 0.0 ? 1.0 : -1.0, e.y >= 0.0 ? 1.0 : -1.0) * min(z,0.0),z);
    return normalize(n);
  }

  vec3 getNormal() {
    return  ${i.shading?A`normalize(decodeNormalTerrain(normalCompressed))`:A`getLocalUp(position, localOrigin)`};
  }
  `)};Ane(t,i),e.include(mH,i);const a=i.overlayMode!==bd.Disabled;switch(i.output){case V.Color:{e.include(XOe,i),e.include(jE,i);const o=i.overlayMode===bd.EnabledWithWater;a&&e.include(sS,{...i,pbrMode:zr.Water}),o&&e.include(UOe,i),n.add("vnormal","vec3"),n.add("vpos","vec3"),s(),(i.atmosphere||i.screenSizePerspective)&&q5(t);const l=i.receiveShadows&&!i.renderOccluded;l&&e.include(sH,i),i.atmosphere&&n.add("wnormal","vec3"),i.screenSizePerspective&&(n.add("screenSizeDistanceToCamera","float"),n.add("screenSizeCosAngle","float")),t.code.add(A`
        void main(void) {
          //Position
          vpos = position;
          vec3 positionWorld = position + localOrigin;
          gl_Position = transformPosition(proj, view, vpos);

          //Normal
          vnormal = getNormal();

          ${o?A`forwardVertexTangent(vnormal);`:A``}

          ${i.atmosphere?A`
          wnormal = normalize((viewNormal * vec4(normalize(positionWorld), 1.0)).xyz);`:""}

          //Texture UV
          vec2 uv = getUV0();
          forwardTextureCoordinatesWithTransform(uv);
          ${a?A`setOverlayVTC(uv);`:""}
          ${i.tileBorders?A`forwardTextureCoordinates();`:""}

          ${i.screenSizePerspective?A`
          vec3 viewPos = (view * vec4(vpos, 1.0)).xyz;
          screenSizeDistanceToCamera = length(viewPos);
          vec3 viewSpaceNormal = (viewNormal * vec4(normalize(positionWorld), 1.0)).xyz;
          screenSizeCosAngle = abs(viewSpaceNormal.z);`:""}

          ${l?A`forwardLinearDepth();`:""}

        }
      `),e.extensions.add("GL_OES_standard_derivatives"),e.extensions.add("GL_EXT_shader_texture_lod"),e.include(LH,i),e.include(jE,i),e.include(Dne,i),e.include(zG,i),o&&One(r,i),Fne(r),XG(r),r.uniforms.add([t.uniforms.get("localOrigin"),new Ps("viewDirection",(c,u)=>de(aB,Y(aB,u.camera.viewMatrix[12],u.camera.viewMatrix[13],u.camera.viewMatrix[14])))]),o&&r.uniforms.add([new Ht("ovWaterTex",(c,u)=>u.overlays.length===0?null:u.overlays[ki.INNER].getNormalTexture(c.overlaySource)),new Mne("view",(c,u)=>ru(YOe,u.camera.viewMatrix,c.origin))]),r.code.add(A`const float sliceOpacity = 0.2;
float lum(vec3 c) {
return (min(min(c.r, c.g), c.b) + max(max(c.r, c.g), c.b)) * 0.5;
}`),VR(r),FD(r),r.code.add(A`
        void main() {
          vec3 normal = normalize(vnormal);
          float vndl = dot(normal, mainLightDirection);

          float additionalAmbientScale = smoothstep(0.0, 1.0, clamp(vndl*2.5, 0.0, 1.0));
          float shadow = ${i.receiveShadows&&!i.renderOccluded?"readShadowMap(vpos, linearDepth)":i.spherical&&i.shading?"lightingGlobalFactor * (1.0 - additionalAmbientScale)":"0.0"};

          float ssao = evaluateAmbientOcclusionInverse();
          vec4 tileColor = getTileColor();

          ${a?A`
              vec4 overlayColorOpaque = getOverlayColor(ovColorTex, vtcOverlay);
              vec4 overlayColor = overlayOpacity * overlayColorOpaque;
              ${i.transparent?A`if (overlayColor.a == 0.0) { discard; }`:""}
              vec4 groundColor = tileColor;
              tileColor = tileColor * (1.0 - overlayColor.a) + overlayColor;`:""}
          if (rejectBySlice(vpos)) {
            tileColor *= sliceOpacity;
          }
          ${i.atmosphere?A`
              float ndotl = clamp(vndl, 0.0, 1.0);
              vec3 atm = vec3(clamp(1.0 - dot(-viewDirection, wnormal), 0.0, 1.0));
              atm *= clamp(1.0 - lum(tileColor.rgb) * 1.5, 0.0, 1.0); // avoid atmosphere on bright base maps
              atm *= clamp(ndotl * 2.0, 0.0, 1.0); // avoid atmosphere on dark side of the globe
              atm *= tileColor.a; // premultiply with tile alpha`:""}

          vec3 albedo = ${i.atmosphere?A`atm + tileColor.rgb;`:A`tileColor.rgb;`}

          // heuristic shading function used in the old terrain, now used to add ambient lighting

          vec3 additionalLight = ssao * mainLightIntensity * additionalAmbientScale * ambientBoostFactor * lightingGlobalFactor;

          gl_FragColor = vec4(evaluateSceneLighting(normal, albedo, shadow, 1.0 - ssao, additionalLight), tileColor.a);
          ${o?A`
              vec4 overlayWaterMask = getOverlayColor(ovWaterTex, vtcOverlay);
              float waterNormalLength = length(overlayWaterMask);
              if (waterNormalLength > 0.95) {
                mat3 tbnMatrix = mat3(tbnTangent, tbnBiTangent, vnormal);
                vec4 waterOverlayColor = vec4(overlayColor.w > 0.0 ? overlayColorOpaque.xyz/overlayColor.w : vec3(1.0), overlayColor.w);
                vec4 viewPosition = view*vec4(vpos, 1.0);
                vec4 waterColorLinear = getOverlayWaterColor(overlayWaterMask, waterOverlayColor, -normalize(vpos - cameraPosition), shadow, vnormal, tbnMatrix, viewPosition.xyz,  vpos + localOrigin);
                vec4 waterColorNonLinear = delinearizeGamma(vec4(waterColorLinear.xyz, 1.0));
                // un-gamma the ground color to mix in linear space
                gl_FragColor = mix(groundColor, waterColorNonLinear, waterColorLinear.w);
              }`:""}
          ${i.screenSizePerspective?A`
            float perspectiveScale = screenSizePerspectiveScaleFloat(1.0, screenSizeCosAngle, screenSizeDistanceToCamera, vec4(0.0, 0.0, 0.0, 0.0));
            if (perspectiveScale <= 0.25) {
              gl_FragColor = mix(gl_FragColor, vec4(1.0, 0.0, 0.0, 1.0), perspectiveScale * 4.0);
            }
            else if (perspectiveScale <= 0.5) {
              gl_FragColor = mix(gl_FragColor, vec4(0.0, 0.0, 1.0, 1.0), (perspectiveScale - 0.25) * 4.0);
            }
            else if (perspectiveScale >= 0.99) {
              gl_FragColor = mix(gl_FragColor, vec4(0.0, 1.0, 0.0, 1.0), 0.2);
            }
            else {
              gl_FragColor = mix(gl_FragColor, vec4(1.0, 0.0, 1.0, 1.0), (perspectiveScale - 0.5) * 2.0);
            }`:""}
          ${i.visualizeNormals?i.spherical?A`
              vec3 localUp = normalize(vpos + localOrigin);
              vec3 right = normalize(cross(vec3(0.0,0.0,1.0),localUp));
              vec3 forward = normalize(cross(localUp,right));
              mat3 tbn = mat3(right, forward, localUp);
              vec3 tNormal = normalize(normal* tbn);
              gl_FragColor = vec4(vec3(0.5) + 0.5 * tNormal, 0.0);
          `:A`
          vec3 tNormal = normalize(normal);
          gl_FragColor = vec4(vec3(0.5) + 0.5 * tNormal, 0.0);
      `:""}
          ${i.tileBorders?A`
              vec2 dVuv = fwidth(vuv0);
              vec2 edgeFactors = smoothstep(vec2(0.0), 1.5 * dVuv, min(vuv0, 1.0 - vuv0));
              float edgeFactor = 1.0 - min(edgeFactors.x, edgeFactors.y);
              gl_FragColor = mix(gl_FragColor, vec4(1.0, 0.0, 0.0, 1.0), edgeFactor);`:""}
          gl_FragColor = highlightSlice(gl_FragColor, vpos);
        }
      `)}break;case V.Depth:e.include(sS,i),e.include(jI,i),K5(e),J5(e),t.code.add(A`
              void main(void) {
                ${a?A`setOverlayVTC(getUV0());`:""}
                gl_Position = transformPositionWithDepth(proj, view, position, nearFar, linearDepth);
              }
          `),r.code.add(A`
              void main() {
                ${a?A`
                  vec4 overlayColor = getCombinedOverlayColor();
                  ${i.transparent?A`if (overlayColor.a == 0.0) { discard; }`:""}`:""}
                outputDepth(linearDepth);
              }
          `);break;case V.Shadow:case V.ShadowHighlight:case V.ShadowExludeHighlight:e.include(jI,i),K5(e),J5(e),t.code.add(A`void main(void) {
gl_Position = transformPositionWithDepth(proj, view, position, nearFar, linearDepth);
}`),r.code.add(A`void main() {
outputDepth(linearDepth);
}`);break;case V.Normal:n.add("vnormal","vec3"),q5(t),s(),t.code.add(A`void main(void) {
vec3 normal = getNormal();
gl_Position = transformPosition(proj, view, position);
vnormal = normalize((viewNormal * vec4(normal, 1.0)).xyz);
}`),r.code.add(A`void main() {
vec3 normal = normalize(vnormal);
if (gl_FrontFacing == false) {
normal = -normal;
}
gl_FragColor = vec4(vec3(0.5) + 0.5 * normal, 0.0);
}`);break;case V.Highlight:e.include(sS,i),t.code.add(A`void main() {
setOverlayVTC(getUV0());
gl_Position = transformPosition(proj, view, position);
}`),e.include($H,i),r.code.add(A`void main() {
vec4 overlayColor = getCombinedOverlayColor();
if (overlayColor.a == 0.0) {
discard;
}
outputHighlight();
}`)}return i.output===V.ObjectAndLayerIdColor&&(e.include(sS,{...i,pbrMode:zr.Disabled}),t.code.add(A`void main(void) {
gl_Position = transformPosition(proj, view, position);
setOverlayVTC(getUV0());
}`),r.code.add(A`
        void main() {
          vec2 texDim =  ${Hx(i,"ovColorTex")};
          gl_FragColor =  ${Ko(i,"ovColorTex","vec2(vtcOverlay.x * 0.5, vtcOverlay.y)*texDim")};
        }
    `)),e}const YOe=xe(),aB=P(),KOe=Object.freeze(Object.defineProperty({__proto__:null,TerrainPassParameters:OJ,build:ZOe},Symbol.toStringTag,{value:"Module"}));let MJ=class IJ extends ii{constructor(){super(...arguments),this.useStencil=!1}initializeConfiguration(e,t){t.hasWebGL2Context=e.rctx.type===Nn.WEBGL2,t.spherical=e.viewingMode===Ie.Global}initializeProgram(e){return new ei(e.rctx,IJ.shader.get().build(this.configuration),LJ)}initializePipeline(){return this._stencilPipelineState=this._createPipeline(!0),this._createPipeline(!1)}_createPipeline(e){const t=this.configuration,r=t.backfaceCullingEnabled&&!t.renderOccluded;return it({blending:t.renderOccluded?lu(me.ONE,me.ONE_MINUS_SRC_ALPHA):null,culling:r&&jG,depthTest:!t.renderOccluded&&{func:hs.LESS},depthWrite:!t.renderOccluded&&nl,colorWrite:gt,stencilTest:e?_se(kb.IntegratedMeshMaskExcluded):null})}getPipelineState(e,t){return this.useStencil?this._stencilPipelineState:super.getPipelineState(e,t)}};MJ.shader=new ri(KOe,()=>j(()=>import("./Terrain.glsl-478cb4a2.js"),["assets/Terrain.glsl-478cb4a2.js","assets/mat4-44a0988f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/mat4f64-1e28eae0.js","assets/vec3-e93e648f.js","assets/Matrix3PassUniform-ad9f953b.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/mat3f64-c6305894.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/Texture2DPassUniform-753de459.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/mathUtils-b4bb77e2.js","assets/vec4-790471c0.js","assets/context-util-a4ce3a7b.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/aaBoundingBox-657a9b82.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/aaBoundingRect-193543b5.js","assets/basicInterfaces-19ed850e.js","assets/ViewingMode-5d7d590b.js","assets/Util-a48361c6.js","assets/vec4f64-e407da96.js","assets/symbolColorUtils-b2b55883.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/compilerUtils-18d58939.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/sphere-2af0d852.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));const LJ=new Map([[S.POSITION,0],[S.UV0,1],[S.NORMALCOMPRESSED,2]]);let JOe=class{constructor(){this.geometryInfo=new rOe,this.intersectionData=null,this.geometryState=null,this._textureRef=new wJ(()=>this.tile.surface.textureFadeDuration),this.overlay=new VOe,this._geometryStateChangedSinceLastUpdate=!0,this._hasGeometry=!1,this._numVerticesPerSideChanged=!1,this._samplerDataChanged=!1,this._clippingAreaChanged=!1,this._wireframeChanged=!1,this._shadingChanged=!1,this._dirtyEdgeResolutions=15,this._dirtyEdges=15,this._dirtyCorners=15}get tile(){return this._tile}init(e){this.clear(),this._tile=e;const t=this.geometryInfo;t.indices=null,t.vertexAttributes=null,Ii(t.boundingBox),t.indexCount=0,t.numVerticesPerSide=0,this.intersectionData=null,this.geometryState=new hOe,this.localOrigin=null,this.overlay.clear()}clear(){this._releaseGeometry(),this.releaseTexture(),this._textureRef.clear(),this._tile=null,this.intersectionData=null,this.geometryState=null}updateGeometryIfNeeded(e){if((!this._vao||this._geometryStateChangedSinceLastUpdate||this._wireframeChanged||this._shadingChanged||this._clippingAreaChanged||this._samplerDataChanged||this._numVerticesPerSideChanged||this._dirtyCorners||this._dirtyEdgeResolutions||this._dirtyEdges)&&(this._updateGeometry(e),this._geometryStateChangedSinceLastUpdate=!1),gn&&this.tile.intersectsClippingArea)for(let t=0;t<4;++t)fe(this.geometryInfo.outerEdges[t].count===this.geometryState.neighborData.edgeResolutions[t]+1)}_calculateEdgeResolution(e,t){var l;const r=this.tile,n=this.geometryState.numVerticesPerSide-1;if(!r.surface.isGlobal){const c=r.surface.extent;if(y(c)&&(e===0&&r.extent[3]>c[3]||e===1&&r.extent[2]>c[2]||e===2&&r.extent[1]<c[1]||e===3&&r.extent[0]<c[0]))return n}const s=r.level,a=jh[e];if(!t)return fe(C((l=r.surface)==null?void 0:l.rootTiles)||r.surface.updatingRootTiles||!r.shouldHaveNeighbor(a)),n;if(t.isLoaded){const c=t,u=c.renderData.geometryState,d=s-c.level;if(fe(d>=0),d===0){const _=u.numVerticesPerSide-1;return Math.max(_,n)}const m=2**d,f=u.neighborData.edgeResolutions[(e+2)%4]/m;return Math.max(1,f)}fe(!t.isLeaf);let o=n;return t.forAllSubtreeOnSide(wR(a),c=>c===r||(c.isLoaded?(o=Math.max(o,2**(c.level-s)),!0):(fe(!c.isLeaf),!1))),o}updateNeighborData(){var o;const e=this.tile;if(!e.intersectsClippingArea)return;const t=e.renderData.geometryState.neighborData,r=l=>(l.isLoaded||l.level===e.level)&&(l==null?void 0:l.intersectsClippingArea),n=t.edgePeerNeighbors,s=t.edgePeerNeighborSamplerVersions;for(let l=0;l<4;++l){const c=e.findNeighborTile(jh[l],r),u=Jp(e,c),d=((o=u==null?void 0:u.renderData)==null?void 0:o.geometryState.samplerDataVersion)??-1,m=n[l],f=u!==Jp(e,m),_=s[l]!==d;n[l]=c,(f||_)&&(s[l]=d,this._markEdgeDirty(l));const g=t.edgeResolutions[l],w=this._calculateEdgeResolution(l,c);fe(_w(w)),fe(w>=1),t.edgeResolutions[l]=w,g!==w&&this._markEdgeResolutionDirty(l)}const a=t.cornerPeerNeighbors;for(let l=0;l<4;++l){const c=e.findNeighborTile(xR[l],r);a[l]=c;const u=Jp(e,n[l]),d=Jp(e,n[(l+1)%4]),m=Jp(e,c);rc[l]=m,rc[(l+1)%4]=d,rc[(l+2)%4]=e,rc[(l+3)%4]=u,fe(rc.some(w=>(w==null?void 0:w.isLoaded)||w===e));const f=rc.reduce((w,v)=>Math.min(w,(v==null?void 0:v.level)??1/0),1/0);rc.forEach((w,v)=>{(w==null?void 0:w.level)>f&&(rc[v]=null)}),fe(rc.some(w=>(w==null?void 0:w.isLoaded)||w===e));const _=t.cornerNeighborData[l].cornerTiles,g=t.cornerNeighborData[l].cornerTileSamplerVersions;for(let w=0;w<4;++w){const v=rc[w],b=(v==null?void 0:v.renderData.geometryState.samplerDataVersion)??-1,x=_[w]!==v,T=!x&&g[w]!==b;(x||T)&&(_[w]=v,g[w]=b,this._markCornerDirty(l))}fe(_.some(w=>(w==null?void 0:w.isLoaded)||w===e))}gn&&fe(this.geometryState.neighborData.edgeResolutions.every(l=>l>0));for(let l=0;l<4;++l)rc[l]=null}_updateGeometry(e){if(!this.tile.intersectsClippingArea)return;gn&&fe(!this.tile.intersectsClippingArea||this.geometryState.neighborData.edgeResolutions.every(l=>l>0)),this.intersectionData=null;const t=this.tile,r=this._vao,n=this.geometryInfo.vertexAttributes,s=!r||!n||this._wireframeChanged||this._shadingChanged||this._numVerticesPerSideChanged||this._samplerDataChanged||this._clippingAreaChanged||this._dirtyEdgeResolutions,a=!s&&(this._dirtyEdges!==0||this._dirtyEdgeResolutions!==0),o=!a&&this._dirtyCorners!==0;s?(this._releaseGeometry(),this._createGeometry(e)):a||o?t.updateEdgeElevations():o?t.updateCornerElevations():console.warn("Update for no reason?"),this._numVerticesPerSideChanged=!1,this._samplerDataChanged=!1,this._dirtyEdgeResolutions=0,this._dirtyEdges=0,this._dirtyCorners=0,this._clippingAreaChanged=!1,this._wireframeChanged=!1}releaseGeometry(){return this._releaseGeometry()}get hasGeometry(){return this._hasGeometry}ensureTexture(e,t){return y(this._texture)&&this._texture.descriptor.width!==e&&this.releaseTexture(),C(this._texture)&&(this._texture=t(),this.tile.setMemoryDirty()),this._texture}releaseTexture(){y(this._texture)&&(this._texture.release(),this._texture=null,this.tile.setMemoryDirty())}_markCornerDirty(e){const t=1<<e;this._dirtyCorners|=t}_markEdgeDirty(e){const t=1<<e;this._dirtyEdges|=t}_markEdgeResolutionDirty(e){const t=1<<e;this._dirtyEdgeResolutions|=t,this._dirtyEdges|=t}_markAllEdgesAndCornersDirty(){this._dirtyCorners=15,this._dirtyEdges=15,this._dirtyEdgeResolutions=15}updateGeometryState(){const e=this._getElevationInfo(),t=this.tile,r=e.samplerData?t.getElevationBasedVerticesPerSide(e.maxTileLevel):t.getDefaultVerticesPerRowOnLevel(),n=Math.max(r,5);let s=t.clippingArea;t.intersectsClippingArea&&!t.isWithinClippingArea||(s=null);const a=this.geometryState;let o=!1;a.numVerticesPerSide!==n&&(this._numVerticesPerSideChanged=!0,a.numVerticesPerSide=n,a.samplerDataVersion++,o=!0),e.changed&&(this._samplerDataChanged=!0,a.samplerData=e.samplerData,a.samplerDataVersion++,o=!0),cD(a.clippingArea,s)||(this._clippingAreaChanged=!0,a.clippingArea=s,o=!0);const l=t.surface,c=l.wireframe;a.wireframe!==c&&(this._wireframeChanged=!0,a.wireframe=c,o=!0);const u=l.shading;return a.shading!==u&&(this._shadingChanged=u,a.shading=u,o=u),this._geometryStateChangedSinceLastUpdate||(this._geometryStateChangedSinceLastUpdate=o),o&&this._markAllEdgesAndCornersDirty(),this._hasGeometry=!0,this._geometryStateChangedSinceLastUpdate}_createGeometry(e){this.tile.createGeometry();const t=this.geometryInfo.vertexAttributes,r=this.geometryInfo.indices,n=e.gl;this._vao=new nu(e,LJ,{geometry:Wc(t.layout)},{geometry:ui.createVertex(e,n.STATIC_DRAW,t.buffer)},ui.createIndex(e,n.STATIC_DRAW,r)),this._hasGeometry=!0}_releaseGeometry(){return this._hasGeometry=!1,this.intersectionData=null,!!this._vao&&(this._vao.dispose(),this._vao=null,aOe(this.geometryInfo),!0)}get vao(){return this._vao}setTextureReference(e,t=yd.Immediate){y(e)&&e.texture!==this._texture&&this.releaseTexture(),this._textureRef.push(e,t)}get textureReference(){return this._textureRef.current}get nextTextureReference(){return this._textureRef.next}get textureFadeFactor(){return this._textureRef.fadeFactor}get textureIsFading(){return this._textureRef.isFading}_getElevationInfo(){const e=this.geometryState.samplerData,t=this.tile.layerInfo[vt.ELEVATION],r=t.length;let n=new Array(r),s=0,a=0,o=!1;for(let l=0;l<r;l++){const c=t[l];if(y(c.upsampleInfo)){const u=c.upsampleInfo.tile,d=u.layerInfo[vt.ELEVATION][l].data,m=d&&d.samplerData;e&&e[s]===m||(o=!0),n[s++]=m,a=Math.max(a,u.lij[0])}else if(c.data){const u=this.tile.surface.layerViewByIndex(l,vt.ELEVATION);if(hw(this.tile,u.layer,!1)){const d=c.data;e&&e[s]===d.samplerData||(o=!0),n[s++]=d.samplerData,a=this.tile.level}}}return y(e)&&e.length!==s&&(o=!0),s>0?n.length=s:n=null,{changed:o,samplerData:n,maxTileLevel:a}}get estimatedGeometryMemoryUsage(){var t,r;const e=Np(this.intersectionData,0,n=>n.estimatedMemoryUsage);return(((t=this.geometryInfo.indices)==null?void 0:t.byteLength)??0)+(((r=this.geometryInfo.vertexAttributes)==null?void 0:r.byteLength)??0)+e}get textureDescriptor(){return y(this._texture)?this._texture.descriptor:null}get test(){return{hasTexture:this._texture!=null}}checkGeometryWaterproofness(){if(!gn)return;const e=this.tile;if(fe(e==null?void 0:e.isLoaded),!e.isLoaded||!e.intersectsClippingArea||e.level===0)return;const t=e.surface.extent;if(y(t)&&!e.intersectsExtent(t))return;const r=jh.map((o,l)=>!!y(t)&&(l<2?-1:1)*(e.extent[3-l]-t[3-l])<0),n=e.level;fe(this._dirtyCorners===0),fe(this._dirtyEdges===0),fe(this._dirtyEdgeResolutions===0),fe(!this._numVerticesPerSideChanged),fe(!this._samplerDataChanged),fe(!this._clippingAreaChanged),fe(!this._wireframeChanged);const s=xR.map(o=>e.findNeighborCornerTileExact(o,l=>!l.intersectsClippingArea||l.isLoaded||l.level===e.level)??null).map(o=>o!=null&&o.intersectsClippingArea?o:null),a=this.geometryState.neighborData;for(let o=0;o<4;++o){const l=a.cornerPeerNeighbors[o],c=s[o];fe(c===l,`Tile[${e.lij}].corner[${o}] out of date: cur=[${l==null?void 0:l.lij}] exp=[${c==null?void 0:c.lij}]`)}jh.forEach((o,l)=>{if(r[l])return;const c=e.findNeighborTile(o,M=>(M.level===n||(M==null?void 0:M.isLoaded))&&(M==null?void 0:M.intersectsClippingArea));if(!c){const M=!e.surface.updatingRootTiles&&y(e.surface.rootTiles)&&e.surface.rootTiles.length>0&&e.shouldHaveNeighbor(o);return void fe(!M)}fe(c.isLoaded||c.level===e.level),fe(c===this.geometryState.neighborData.edgePeerNeighbors[l]);const u=n-c.level;if(!c.isLoaded)return fe(!c.isLeaf),void fe(u===0);fe(kOe(e,c,o)),fe(u>=0);const d=2**u;if(u<0)return void fe(!1);const m=e.renderData.geometryInfo,f=m.outerEdges[l],_=m.numVerticesPerSide-1,g=c.renderData.geometryInfo;if(!g)return void fe(!1);{const M=this.geometryState.neighborData.edgePeerNeighbors[l];(M!=null&&M.isLoaded||M.isLoaded)&&(fe(M==M),fe(e.renderData.geometryState.neighborData.edgePeerNeighborSamplerVersions[l]===M.renderData.geometryState.samplerDataVersion),fe(this.geometryState.neighborData.edgePeerNeighborSamplerVersions[l]===M.renderData.geometryState.samplerDataVersion))}const w=(l+2)%4,v=g.outerEdges[w],b=f.count-1,x=v.count-1;fe(b*d===x,`Tile[${e.lij}]:e${l},res=${b} edgeRes mismatch with Neighbor[${c.lij}]:e${w},res=${x} (expected:${b*d})`);const T=e.extent,R=o===qe.NORTH||o===qe.SOUTH,E=v.count-1,O=E/2**u,$=f.count-1;if(O<1)return void fe($===1);fe(O===$),fe(_w(O));const D=g.numVerticesPerSide-1;fe(u>0||O===Math.max(D,_));const I=e.getNeighborEdgeStartVertexIndex(l,c);fe(0<=I&&I<d);const G=I*O;fe(0<=G&&G<=E-O);let W=0,re=G;f.getVertexPos(uh,0),f.getVertexPos(dh,f.count-1);const te=Li(uh,dh),H=Math.max(eMe,1e-4*te);for(let M=0;M<=O;++M){f.getVertexPos(uh,W),v.getVertexPos(dh,re);const U=M/O,L=R?T[0]+U*(T[2]-T[0]):o===qe.WEST?T[0]:T[2],z=R?o===qe.SOUTH?T[1]:T[3]:T[1]+U*(T[3]-T[1]),q=e.surface.extent;if(C(q)||Dre(q,L,z)){const K=xG(uh,dh),ie=jd(uh)-lo.radius,Z=jd(dh)-lo.radius,ne=K<H;if(!ne){console.warn(`Tile edge vertex position mismatch: between [${e.lij}].edge${l}[${W}/${f.count}] and [${c.lij}].edge${w}[${re}/${v.count}]`),y(q)&&console.warn("  surface extent= ",q," x,y=",L,",",z);const Ae=P();ae(Ae,e.renderData.localOrigin,c.renderData.localOrigin),jd(Ae)>0&&console.warn(`   localOrigins: ${e.renderData.localOrigin} vs ${c.renderData.localOrigin} d=${jd(Ae)} [${Ae}]`),(()=>{const Fe=as(uh),ze=as(dh);e.updateEdgeElevations(),c.updateEdgeElevations(),f.getVertexPos(uh,W),v.getVertexPos(dh,re);const Ye=P();tl(Ye,uh,Fe),jd(Ye)>0&&console.warn(`  XXX Tile[${e.lij}] edge out of date: ${Fe} vs ${uh} d=${jd(Ye)} [${Ye}]`),tl(Ye,dh,ze),jd(Ye)>0&&console.warn(`  XXX Neighbor[${c.lij}] edge out of date: ${ze} vs ${dh} d=${jd(Ye)} [${Ye}]`)})(),fe(ne,`Mismatch in tile [${e.lij}].edge[${l}][${W}/${f.count}] vs neighbor [${c.lij}].edge[${w}][${re}/${v.count}] ${Pu(uh)} vs ${Pu(dh)}  dist=${K} h(t|n|d)=${ie}|${Z}|${Z-ie}`)}if(e.surface.shading){f.getNormal(ry,W),v.getNormal(ny,re),de(oB,ry),de(lB,ny);const Ae=_e(oB,lB),Fe=!1,ze=1-Ae<.01||Fe||e===c;if(!ze){const Ye=P();tl(Ye,ry,ny);const Ce=()=>`Mismatch in tile edge normal ${Gz(e.lij)} (${W}/${f.count-1}) edge ${l} vs neighbor ${Gz(c.lij)}  (${re}/${v.count-1}) nedge ${w} :${Pu(ry)} vs ${Pu(ny)}  dot = ${Ae} : ${Pu(Ye)}`;console.warn("Mismatch in tile edge normal: ",Ce());{e.updateEdgeElevations(),c.updateEdgeElevations();const Ee=P(),je=P();f.getNormal(Ee,W),v.getNormal(je,re),Og(ry,Ee)||console.warn("Missing update in tile normal: ",Pu(ry)," => ",Pu(Ee)),Og(ny,je)||console.warn("Missing update in neighbor normal: ",Pu(ny)," => ",Pu(je))}fe(ze,Ce())}}}W+=1,re+=1}})}};const uh=P(),dh=P(),ry=P(),ny=P(),oB=P(),lB=P(),eMe=1,rc=[null,null,null,null];function Jp(i,e){return e!=null&&e.isLoaded||e===i?e:null}const tMe=65536;function iMe(i,e){const t=i.tile,{extent:r,extentInRadians:n,surface:s}=t,a=i.localOrigin,o=i.geometryState,l=s.isWebMercator,c=s.shading||Qg,u=o.numVerticesPerSide,d=u-1,m=(u-2)**2,f=l&&(e===Pl.HAS_SOUTH_POLE||e===Pl.HAS_BOTH_POLES),_=l&&(e===Pl.HAS_NORTH_POLE||e===Pl.HAS_BOTH_POLES),g=6,w=((f?1:0)+(_?1:0))*g*(d+1),v=o.neighborData,b=v.edgeResolutions.reduce(($,D)=>$+D+1,0),x=bJ(m+w+b),T=i.geometryInfo;T.numVerticesPerSide=o.numVerticesPerSide,T.vertexAttributes=x;const R=T.boundingBox;Ii(R);const E=i5(i);Tr.update(d,n,E),rMe(i),BJ(i,m),$J(i);const O=[];if((()=>{let $=m+b;const D=a[0],I=a[1],G=a[2],W=t.ellipsoid.radius,re=r[1],te=r[3],H=(M,U)=>{const L=U*u;Xs(-D,-I,M*W-G,R),O.push({connectedRowOffset:L,connectedOuterEdgeOffset:M===1?0:2,rowOffset:$,latitudeResolution:g});const z=NJ(M===-1?re:te,W),q=M*Math.PI/2-z,K=.99*(M===1?1:-1),ie=W+0,Z=x.position,ne=x.uv0,Ae=x.normalCompressed;for(let Fe=1;Fe<=g;++Fe){const ze=z+q*(Fe/g),Ye=Math.cos(ze),Ce=Math.sin(ze);for(let Ee=0;Ee<=d;Ee++){const je=Ee/d,nt=Tr.sinLonLUT[Ee],Mt=Tr.cosLonLUT[Ee]*Ye,st=nt*Ye,Be=Ce,Ve=Mt*ie-D,be=st*ie-I,_t=Be*ie-G;Xs(Ve,be,_t,R),Z.setValues($,Ve,be,_t),go(ne,$,je,K),c&&Rx(Ae,$,Mt,st,Be),++$}}};f&&H(-1,0),_&&H(1,d)})(),zJ(T,o.numVerticesPerSide,O,[0,u-1],[0,u-1],o.wireframe),i.intersectionData=null,gn)for(let $=0;$<4;++$)fe(T.outerEdges[$].count===v.edgeResolutions[$]+1)}function rMe(i){const e=i.tile;e.intersectsClippingArea&&(e.surface.shading||Qg?sMe(i):nMe(i))}function nMe(i){const e=i.geometryState,t=e.numVerticesPerSide,r=t-2,n=t-1,s=i.geometryInfo,a=s.vertexAttributes,o=a.position,l=a.uv0,c=i.tile,u=c.extent,d=u[0],m=u[2],f=u[1],_=u[3],g=c.ellipsoid.radius,w=e.samplerData,v=i.localOrigin,b=v[0],x=v[1],T=v[2],R=s.boundingBox,E=o.typedBuffer,O=o.typedBufferStride;let $=0;for(let D=1;D<=r;D++){const I=D/n,G=f*(1-I)+_*I,W=Tr.sinLatLUT[D],re=Tr.cosLatLUT[D];for(let te=1;te<=r;te++){const H=te/n,M=d*(1-H)+m*H,U=Tr.sinLonLUT[te],L=Tr.cosLonLUT[te],z=g+Ei(M,G,w),q=L*re*z-b,K=U*re*z-x,ie=W*z-T;Xs(q,K,ie,R);const Z=$*O;E[Z+0]=q,E[Z+1]=K,E[Z+2]=ie,go(l,$,H,I),++$}}}function sMe(i){const e=i.geometryState,t=e.numVerticesPerSide,r=t-2,n=t-1,s=i.geometryInfo,a=s.vertexAttributes,o=a.position,l=a.uv0,c=a.normalCompressed,u=i.tile,d=u.extent,m=d[0],f=d[2],_=d[1],g=d[3],w=u.ellipsoid.radius,v=e.samplerData,b=i.localOrigin,x=b[0],T=b[1],R=b[2],E=o.typedBuffer,O=o.typedBufferStride,$=1/n,D=s.boundingBox;let I=0;if(1<=r){const G=$,W=_*(1-G)+g*G,re=Tr.sinLatLUT[1],te=Tr.cosLatLUT[1];for(let H=1;H<=r;H++){const M=H*$,U=m*(1-M)+f*M,L=Tr.sinLonLUT[H],z=Tr.cosLonLUT[H],q=w+Ei(U,W,v),K=q*z*te-x,ie=q*L*te-T,Z=q*re-R;Xs(K,ie,Z,D);const ne=(H-1)*O;E[ne+0]=K,E[ne+1]=ie,E[ne+2]=Z,go(l,H-1,M,G)}}for(let G=1;G<=r;G++){const W=G*$,re=_*(1-W)+g*W,te=Tr.sinLatLUT[G],H=Tr.cosLatLUT[G],M=G+1,U=M*$,L=_*(1-U)+g*U,z=Tr.sinLatLUT[M],q=Tr.cosLatLUT[M],K=Tr.sinLonLUT[0],ie=Tr.cosLonLUT[0],Z=w+Ei(m,re,v);let ne=ie*H*Z-x,Ae=K*H*Z-T,Fe=te*Z-R;const ze=I*O;let Ye=E[ze+0],Ce=E[ze+1],Ee=E[ze+2];for(let je=1;je<=r;je++){const nt=je*$,Mt=m*(1-nt)+f*nt,st=Tr.sinLonLUT[je],Be=Tr.cosLonLUT[je],Ve=Be*H,be=st*H,_t=te;let Le=0,Pe=0,di=0;{let Lt=0,ot=0,oe=0;if(je<r){const Bt=(I+1)*O;Lt=E[Bt+0],ot=E[Bt+1],oe=E[Bt+2]}else{const Bt=Tr.sinLonLUT[n],Hi=Tr.cosLonLUT[n],ji=w+Ei(f,re,v);Lt=Hi*H*ji-x,ot=Bt*H*ji-T,oe=te*ji-R}const se=ne,ge=Ae,Re=Fe;ne=Ye,Ae=Ce,Fe=Ee,Ye=Lt,Ce=ot,Ee=oe;const We=Lt-se,at=ot-ge,yt=oe-Re,Et=at*_t-yt*be,dt=yt*Ve-We*_t,ci=We*be-at*Ve;Le=dt*yt-ci*at,Pe=ci*We-Et*yt,di=Et*at-dt*We}{let Lt=0,ot=0,oe=0;if(G>1){const se=(I-r)*O;Lt=E[se+0],ot=E[se+1],oe=E[se+2]}else{const se=Tr.sinLatLUT[0],ge=Tr.cosLatLUT[0],Re=w+Ei(Mt,_,v);Lt=Be*ge*Re-x,ot=st*ge*Re-T,oe=se*Re-R}{const se=w+Ei(Mt,L,v),ge=Be*q*se-x,Re=st*q*se-T,We=z*se-R;if(G<r){const Hi=I+r,ji=Hi*O;E[ji+0]=ge,E[ji+1]=Re,E[ji+2]=We,Xs(ge,Re,We,D),go(l,Hi,nt,U)}const at=Lt-ge,yt=ot-Re,Et=oe-We,dt=yt*_t-Et*be,ci=Et*Ve-at*_t,Bt=at*be-yt*Ve;Le+=ci*Et-Bt*yt,Pe+=Bt*at-dt*Et,di+=dt*yt-ci*at}}const zt=1/Math.sqrt(Le*Le+Pe*Pe+di*di);Rx(c,I,Le*zt,Pe*zt,di*zt),++I}}}function aMe(i){i.tile.intersectsClippingArea&&($J(i),KP(i))}function oMe(i){i.tile.intersectsClippingArea&&(FJ(i),DJ(i,!0),KP(i))}function $J(i){i.tile.intersectsClippingArea&&(FJ(i),DJ(i))}function DJ(i,e=!1){const t=i.geometryState,r=i.geometryInfo,n=t.neighborData,s=i.tile,a=s.level,o=s.extent,l=s.ellipsoid.radius,c=s.extentInRadians,u=c[0],d=c[2],m=c[1],f=c[3],_=t.samplerData,g=o[0],w=o[2],v=o[1],b=o[3],x=i5(i),T=r.boundingBox,R=i.localOrigin,E=R[0],O=R[1],$=R[2],D=s.surface.shading||Qg,I=r.vertexAttributes,G=I.position,W=G.typedBuffer,re=G.typedBufferStride,te=I.uv0;for(let H=0;H<4;++H){const M=H===1||H===3,U=n.edgeResolutions[H];fe(_w(U));const L=U+1,z=Jp(s,n.edgePeerNeighbors[H]);if(jJ(s,z,H)){GJ(i,H);continue}const q=y(z);fe(!q||z.level===s.level),fe(!q||vd(s,z)<=0);const K=z==null?void 0:z.renderData,ie=K==null?void 0:K.geometryState;if(gn){const se=s.surface;if(!z&&se&&!se.updatingRootTiles){const ge=jh[H],Re=s.findNeighborTile(ge,We=>We.isLoaded||We.isLeaf||We.level===s.level);Re?Re.intersectsClippingArea&&(fe(!Re.isLoaded),fe(!Re.isLeaf),fe(Re.level===a)):fe(C(se==null?void 0:se.rootTiles)||!s.shouldHaveNeighbor(ge))}}const Z=H===1?o[2]:o[0],ne=z==null?void 0:z.extent,Ae=q&&M?H===1?ne[0]:ne[2]:Z,Fe=H===0?o[3]:o[1],ze=H===1?1:0,Ye=H===0?1:0,Ce=H===1?d:u,Ee=H===0?f:m,je=Math.sin(Ce),nt=Math.cos(Ce),Mt=Math.sin(Ee),st=Math.cos(Ee),Be=ie==null?void 0:ie.samplerData,Ve=(se,ge,Re)=>Ei(se,ge,_),be=(se,ge,Re)=>.5*(Ei(se,ge,_)+Ei(Re,ge,Be)),_t=q?be:Ve,Le=r.outerEdges[H],Pe=e&&L>3?L-3:1,di=y(_)&&_.some(se=>se!=null),zt=y(Be)&&Be.some(se=>se!=null),Lt=di||zt,ot=1/U,oe=Le.index0;D?(fe(!q||fAe(ne[2]-ne[0],o[2]-o[0])),(()=>{const se=H===1?-1:H===3?1:0,ge=H===0?-1:H===2?1:0,Re=(o[2]-o[0])*ot,We=se*Re,at=ge*Re,yt=M?se*((d-u)*ot):0,Et=M?0:ge*ot,dt=Ye,ci=M?Ce+yt:Ce,Bt=M?Math.sin(ci):je,Hi=M?Math.cos(ci):nt,ji=M?Ce-yt:Ce,xn=M?Math.sin(ji):je,jn=M?Math.cos(ji):nt,an=M?Ee:x(dt+Et),cl=M?Mt:Math.sin(an),vo=M?st:Math.cos(an),qn=M?Ee:x(dt-Et),Tn=M?Mt:Math.sin(qn),Ki=M?st:Math.cos(qn),nr=(oe+0)*re;let Ut=W[nr+0]+E,wi=W[nr+1]+O,Lr=W[nr+2]+$,sr=0,on=0,bo=0;{const gr=1*ot,u_=M?Z:g*(1-gr)+w*gr,Mv=M?Ae:u_,Iv=M?v*(1-gr)+b*gr:Fe,Lv=M?Ce:u*(1-gr)+d*gr,lT=M?je:Math.sin(Lv),cT=M?nt:Math.cos(Lv),d_=M?x(gr):Ee,$v=M?Math.sin(d_):Mt,p_=M?Math.cos(d_):st,Dv=l+_t(u_,Iv,Mv);sr=cT*p_*Dv,on=lT*p_*Dv,bo=$v*Dv}for(let gr=1;gr<L-1;gr+=Pe){let u_=0,Mv=0,Iv=0;{const Zc=(oe+gr+1)*re;if(gr<L-2){const Ls=(gr+1)*ot,Yc=M?Z:g*(1-Ls)+w*Ls,pu=M?Ae:Yc,us=M?v*(1-Ls)+b*Ls:Fe,wo=M?Ce:u*(1-Ls)+d*Ls,Gd=M?je:Math.sin(wo),Zm=M?nt:Math.cos(wo),Hd=M?x(Ls):Ee,Ym=M?Math.sin(Hd):Mt,Fv=M?Math.cos(Hd):st,b_=l+_t(Yc,us,pu);u_=Zm*Fv*b_,Mv=Gd*Fv*b_,Iv=Ym*b_}else u_=W[Zc+0]+E,Mv=W[Zc+1]+O,Iv=W[Zc+2]+$}const Lv=u_,lT=Mv,cT=Iv,d_=sr,$v=on,p_=bo;sr=Lv,on=lT,bo=cT;{const Zc=oe+gr,Ls=Zc*re,Yc=d_-E,pu=$v-O,us=p_-$;W[Ls+0]=Yc,W[Ls+1]=pu,W[Ls+2]=us,Xs(Yc,pu,us,T);const wo=gr*ot;go(te,Zc,M?ze:wo,M?wo:Ye)}const Dv=Ut,cte=wi,hte=Lr;Ut=d_,wi=$v,Lr=p_;const m_=d_,f_=$v,g_=p_;let __=0,y_=0,v_=0;if(Lt){const Zc=1/Math.sqrt(m_*m_+f_*f_+g_*g_),Ls=m_*Zc,Yc=f_*Zc,pu=g_*Zc;{const us=Lv-Dv,wo=lT-cte,Gd=cT-hte,Zm=wo*pu-Gd*Yc,Hd=Gd*Ls-us*pu,Ym=us*Yc-wo*Ls;__+=Hd*Gd-Ym*wo,y_+=Ym*us-Zm*Gd,v_+=Zm*wo-Hd*us}{const us=gr*ot,wo=M?Z:g*(1-us)+w*us,Gd=M?Ae:wo,Zm=M?v*(1-us)+b*us:Fe,Hd=M?Ce:u*(1-us)+d*us,Ym=M?je:Math.sin(Hd),Fv=M?nt:Math.cos(Hd),b_=M?x(us):Ee,d5=M?Math.sin(b_):Mt,p5=M?Math.cos(b_):st;let nA=m_,sA=f_,aA=g_;if(q){const Km=l+Ei(Gd-We,Zm-at,Be),Nv=M?p5:Ki;nA=(M?jn:Fv)*Nv*Km,sA=(M?xn:Ym)*Nv*Km,aA=(M?d5:Tn)*Km}{const Km=l+Ei(wo+We,Zm+at,_),Nv=M?p5:vo,m5=(M?Hi:Fv)*Nv*Km,f5=(M?Bt:Ym)*Nv*Km,g5=(M?d5:cl)*Km;q||(nA=2*m_-m5,sA=2*f_-f5,aA=2*g_-g5);const hT=nA-m5,uT=sA-f5,dT=aA-g5,_5=uT*pu-dT*Yc,y5=dT*Ls-hT*pu,v5=hT*Yc-uT*Ls;__+=y5*dT-v5*uT,y_+=v5*hT-_5*dT,v_+=_5*uT-y5*hT}}}else __=m_,y_=f_,v_=g_;const rA=1/Math.sqrt(__*__+y_*y_+v_*v_);Le.setNormalFromValues(gr,__*rA,y_*rA,v_*rA)}})()):(()=>{for(let se=1;se<L-1;se+=Pe){const ge=se*ot,Re=M?ze:ge,We=M?ge:Ye,at=M?Z:g*(1-ge)+w*ge,yt=M?v*(1-ge)+b*ge:Fe,Et=M?Ae:at,dt=M?Ce:u*(1-ge)+d*ge,ci=M?je:Math.sin(dt),Bt=M?nt:Math.cos(dt),Hi=M?x(ge):Ee,ji=M?Math.sin(Hi):Mt,xn=M?Math.cos(Hi):st,jn=_t(at,yt,Et),an=l+jn,cl=Bt*xn*an-E,vo=ci*xn*an-O,qn=ji*an-$;Xs(cl,vo,qn,T);const Tn=oe+se,Ki=Tn*re;W[Ki+0]=cl,W[Ki+1]=vo,W[Ki+2]=qn,go(te,Tn,Re,We)}})()}}function FJ(i){HJ(i)}function NJ(i,e){return Math.PI/2-2*Math.atan(Math.exp(-i/e))}function lMe(i,e,t,r){return NJ(i*(1-r)+e*r,t)}function cMe(i,e,t){return i*(1-t)+e*t}function i5(i){const e=i.tile;if(e.surface.isWebMercator){const r=e.extent,n=e.ellipsoid.radius;return s=>lMe(r[1],r[3],n,s)}const t=e.extentInRadians;return r=>cMe(t[1],t[3],r)}function hMe(i,e){const t=i.tile.extent,r=i.geometryState,n=t[0],s=t[1],a=t[2]-n,o=t[3]-s,l=r.clippingArea,c=y(l)?Math.max(0,(l[0]-n)/a):0,u=y(l)?Math.max(0,(l[1]-s)/o):0,d=y(l)?Math.min(1,(l[2]-n)/a):1,m=y(l)?Math.min(1,(l[3]-s)/o):1,f=r.numVerticesPerSide,_=(f-2)**2,g=r.neighborData.edgeResolutions.reduce((x,T)=>x+T+1,0),w=bJ(_+g),v=i.geometryInfo,b=v.boundingBox;Ii(b),v.numVerticesPerSide=r.numVerticesPerSide,v.vertexAttributes=w,Qs(v.uvRange,c,u,d,m),uMe(i),BJ(i,_),kJ(i),zJ(v,r.numVerticesPerSide,[],[0,f-1],[0,f-1],r.wireframe),i.intersectionData=null}function uMe(i){const e=i.tile;e.intersectsClippingArea&&(e.surface.shading?pMe(i):dMe(i))}function dMe(i){const e=i.geometryState,t=e.samplerData,r=i.tile,n=r.surface,s=i.localOrigin,a=n.isWebMercatorOnPlateeCarree,o=e.clippingArea,l=y(o)?o:JP,c=r.extent,u=c[0],d=c[1],m=c[2],f=c[3],_=Math.max(u,l[0]),g=Math.min(m,l[2]),w=Math.max(d,l[1]),v=Math.min(f,l[3]),b=s[0],x=s[1],T=s[2],R=r.ellipsoid.radius,E=r.horizontalScale,O=r5(a,R,E),$=e.numVerticesPerSide,D=$-1,I=$-2,G=i.geometryInfo,W=G.uvRange,re=W[0],te=W[1],H=W[2],M=W[3],U=G.boundingBox,L=G.vertexAttributes,z=L.position,q=L.uv0;let K=0;for(let ie=1;ie<=I;ie++){const Z=ie/D,ne=ue(d*(1-Z)+f*Z,w,v),Ae=ue(Z,te,M),Fe=O(ne)-x;for(let ze=1;ze<=I;ze++){const Ye=ze/D,Ce=ue(u*(1-Ye)+m*Ye,_,g),Ee=ue(Ye,re,H),je=Ce*E-b,nt=Ei(Ce,ne,t)-T;Xs(je,Fe,nt,U),z.setValues(K,je,Fe,nt),go(q,K,Ee,Ae),++K}}}function pMe(i){const e=i.tile,t=e.surface;if(!(t.shading||Qg))return;const r=i.geometryState,n=r.samplerData,s=i.localOrigin,a=t.isWebMercatorOnPlateeCarree,o=r.clippingArea,l=y(o)?o:JP,c=e.extent,u=c[0],d=c[1],m=c[2],f=c[3],_=Math.max(u,l[0]),g=Math.min(m,l[2]),w=Math.max(d,l[1]),v=Math.min(f,l[3]),b=e.ellipsoid.radius,x=e.horizontalScale,T=r.numVerticesPerSide,R=T-1,E=T-2,O=i.geometryInfo,$=O.vertexAttributes,D=$.position,I=$.uv0,G=$.normalCompressed,W=O.uvRange,re=W[0],te=W[1],H=W[2],M=W[3],U=O.boundingBox,L=s[0],z=s[1],q=s[2],K=D.typedBuffer,ie=D.typedBufferStride;let Z=0;const ne=ue(d,w,v),Ae=a?(Math.PI/2-2*Math.atan(Math.exp(-ne/b)))*b:ne*x,Fe=1/R,ze=ue(d*(1-Fe)+f*Fe,w,v);let Ye=Ae,Ce=a?(Math.PI/2-2*Math.atan(Math.exp(-ze/b)))*b:ze*x;for(let Ee=1;Ee<=E;Ee++){const je=Ee/R,nt=ue(d*(1-je)+f*je,w,v),Mt=ue(je,te,M),st=Ce,Be=(Ee-1)/R,Ve=ue(d*(1-Be)+f*Be,w,v),be=Ye,_t=(Ee+1)/R,Le=ue(d*(1-_t)+f*_t,w,v),Pe=a?(Math.PI/2-2*Math.atan(Math.exp(-Le/b)))*b:Le*x,di=ue(_t,te,M);Ye=Ce,Ce=Pe;const zt=ue(u,_,g);let Lt=zt*x,ot=Ei(zt,nt,n);const oe=1/R,se=ue(oe,re,H),ge=ue(u*(1-se)+m*se,_,g);let Re=se,We=ge,at=ge*x,yt=Ei(ge,nt,n);if(Ee===1){const Et=at-L,dt=Ye-z,ci=yt-q,Bt=0*ie;K[Bt+0]=Et,K[Bt+1]=dt,K[Bt+2]=ci,Xs(Et,dt,ci,U);const Hi=ue(oe,re,H);go(I,Z,Hi,Mt)}for(let Et=1;Et<=E;Et++){const dt=at,ci=yt,Bt=(Et+1)/R,Hi=ue(Bt,re,H),ji=ue(u*(1-Bt)+m*Bt,_,g),xn=We;We=ji;{const nr=Z+1,Ut=nr*ie;if(Ee===1||Et===E){const wi=ji*x,Lr=st,sr=Ei(ji,nt,n);if(Ee===1&&Et<E){const on=wi-L,bo=Lr-z,gr=sr-q;K[Ut+0]=on,K[Ut+1]=bo,K[Ut+2]=gr,Xs(on,bo,gr,U),go(I,nr,Hi,Mt)}at=wi,yt=sr}else at=K[Ut+0]+L,yt=K[Ut+2]+q}const jn=at,an=yt,cl=Lt,vo=ot;Lt=dt,ot=ci;const qn=(Z-E)*ie,Tn=Ee===1?Ei(xn,Ve,n):K[qn+2]+q,Ki=Ei(xn,Le,n);if(Ee<E){const nr=Z+E,Ut=nr*ie,wi=dt-L,Lr=Pe-z,sr=Ki-q;K[Ut+0]=wi,K[Ut+1]=Lr,K[Ut+2]=sr,Xs(wi,Lr,sr,U);const on=Re;Re=Hi,go(I,nr,on,di)}{const nr=jn-cl,Ut=-nr*(an-vo),wi=be-Pe,Lr=-wi*(Tn-Ki),sr=nr*nr+wi*wi,on=Ut*Ut+Lr*Lr+sr*sr;if(on===0)Rx(G,Z,0,0,1);else{const bo=1/Math.sqrt(on);Rx(G,Z,Ut*bo,Lr*bo,sr*bo)}}++Z}}}function mMe(i,e){i.tile.intersectsClippingArea&&(UJ(i),VJ(i,!0),KP(i))}function fMe(i,e){i.tile.intersectsClippingArea&&(kJ(i),KP(i))}function kJ(i,e){i.tile.intersectsClippingArea&&(UJ(i),VJ(i,!1))}function VJ(i,e){const t=i.geometryState,r=t.neighborData,n=i.tile,s=n.surface,a=s.shading||Qg,o=n.extent,l=t.clippingArea,c=y(l)?l:JP,u=o[0],d=o[2],m=o[1],f=o[3],_=[f>c[3],d>c[2],m<c[1],u<c[0]],g=i.geometryInfo,w=n.horizontalScale,v=r5(s.isWebMercatorOnPlateeCarree,n.ellipsoid.radius,w),b=g.boundingBox,x=g.uvRange[0],T=g.uvRange[1],R=g.uvRange[2],E=g.uvRange[3],O=Math.max(u,c[0]),$=Math.min(d,c[2]),D=Math.max(m,c[1]),I=Math.min(f,c[3]),G=i.localOrigin,W=G[0],re=G[1],te=G[2],H=t.samplerData;for(let M=0;M<4;++M){const U=M===1||M===3,L=r.edgeResolutions[M];fe(_w(L));const z=L+1,q=_[M],K=Jp(n,r.edgePeerNeighbors[M]);if(!q&&jJ(n,K,M)){GJ(i,M);continue}const ie=y(K)&&!q,Z=K==null?void 0:K.renderData,ne=Z==null?void 0:Z.geometryState;if(gn&&(fe(!ie||K.level===n.level),fe(!ie||vd(n,K)<=0),n&&!K&&!s.updatingRootTiles)){const Be=jh[M],Ve=n.findNeighborTile(Be,be=>be.isLoaded||be.isLeaf||be.level===n.level);s.updatingRootTiles||(Ve?Ve.intersectsClippingArea&&(fe(!Ve.isLoaded),fe(!Ve.isLeaf),fe(Ve.level===n.level)):fe(C(s==null?void 0:s.rootTiles)||!n.shouldHaveNeighbor(Be)))}const Ae=ue(M===1?d:u,O,$),Fe=ue(M===0?f:m,D,I),ze=ne==null?void 0:ne.samplerData,Ye=g.outerEdges[M],Ce=e&&z>3?z-3:1,Ee=ue(M===1?1:0,x,R),je=ue(M===0?1:0,T,E),nt=(Be,Ve)=>Ei(Be,Ve,H),Mt=(Be,Ve)=>.5*(Ei(Be,Ve,ze)+Ei(Be,Ve,H)),st=ie?Mt:nt;if(a){const Be=(d-u)/L,Ve=U?M===1?Be:-Be:0,be=U?0:M===0?Be:-Be,_t=-Ve,Le=-be,Pe=Ye.attributes.position.typedBuffer,di=Ye.attributes.position.typedBufferStride,zt=Ye.index0,Lt=Ye.stride,ot=zt*di;let oe=Pe[ot+0]+W,se=Pe[ot+1]+re,ge=Pe[ot+2]+te,Re=0,We=0,at=0;{const yt=1/L,Et=U?Ae:ue(u*(1-yt)+d*yt,O,$),dt=U?ue(m*(1-yt)+f*yt,D,I):Fe,ci=st(Et,dt),Bt=Et*w,Hi=v(dt);Re=Bt,We=Hi,at=ci}for(let yt=1;yt<z-1;yt+=Ce){const Et=yt/L,dt=Re,ci=We,Bt=at;{const Ut=U?Ee:ue(Et,x,R),wi=U?ue(Et,T,E):je,Lr=dt-W,sr=ci-re,on=Bt-te;Xs(dt,sr,on,b),Ye.setVertexFromValuesRawPositionUV(yt,Lr,sr,on,Ut,wi)}const Hi=yt+1;if(yt===z-1){const Ut=(zt+Hi*Lt)*di;Re=Pe[Ut+0]+W,We=Pe[Ut+1]+re,at=Pe[Ut+2]+te}else{const Ut=Hi/L,wi=U?Ae:ue(u*(1-Ut)+d*Ut,O,$),Lr=U?ue(m*(1-Ut)+f*Ut,D,I):Fe,sr=st(wi,Lr);Re=wi*w,We=v(Lr),at=sr}const ji=Re,xn=We,jn=at,an=oe,cl=se,vo=ge;oe=dt,se=ci,ge=Bt;let qn=0,Tn=0,Ki=0;if(U){{const Ut=xn-ci,wi=cl-ci;Tn-=wi*(vo-Bt)+Ut*(jn-Bt),Ki+=wi*wi+Ut*Ut}{const Ut=ue(m*(1-Et)+f*Et,D,I),wi=Ae+_t,Lr=wi*w-dt;if(qn-=Lr*(Ei(wi,Ut,H)-Bt),Ki+=Lr*Lr,ie){const sr=Ae+Ve,on=sr*w-dt;qn-=on*(Ei(sr,Ut,ze)-Bt),Ki+=on*on}}}else{{const Ut=ji-dt,wi=an-dt;qn-=Ut*(jn-Bt)+wi*(vo-Bt),Ki+=Ut*Ut+wi*wi}{const Ut=ue(u*(1-Et)+d*Et,O,$),wi=Fe+Le,Lr=Ei(Ut,wi,H)-Bt,sr=v(wi)-ci;if(Tn-=sr*Lr,Ki+=sr*sr,ie){const on=Ut,bo=Fe+be,gr=v(bo)-ci;Tn-=gr*(Ei(on,bo,ze)-Bt),Ki+=gr*gr}}}const nr=1/Math.sqrt(qn*qn+Tn*Tn+Ki*Ki);Ye.setNormalFromValues(yt,qn*nr,Tn*nr,Ki*nr)}}else for(let Be=1;Be<z-1;Be+=Ce){const Ve=Be/L,be=U?Ae:ue(u*(1-Ve)+d*Ve,O,$),_t=U?ue(m*(1-Ve)+f*Ve,D,I):Fe,Le=U?Ee:ue(Ve,x,R),Pe=U?ue(Ve,T,E):je,di=st(be,_t),zt=be*w-W,Lt=v(_t)-re,ot=di-te;Xs(zt,Lt,ot,b),Ye.setVertexFromValuesRawPositionUV(Be,zt,Lt,ot,Le,Pe)}}}function UJ(i,e){HJ(i)}function gMe(i,e){return(Math.PI/2-2*Math.atan(Math.exp(-i/e)))*e}function _Me(i,e){return i*e}function r5(i,e,t){return i?r=>gMe(r,e):r=>_Me(r,t)}function zJ(i,e,t,r,n,s){const a=e-1,o=i.vertexAttributes.count,l=2*(Math.min(e-2,r[1])-Math.max(1,r[0]))*(Math.min(e-2,n[1])-Math.max(1,n[0])),c=jh.map((b,x)=>x===0&&n[1]<e-2||x===1&&r[1]<e-2||x===2&&n[0]>1||x===3&&r[0]>1),u=i.outerEdges.reduce((b,x,T)=>b+(c[T]?0:a-2+x.count-1),0),d=t.reduce((b,x)=>b+a*(2*(x.latitudeResolution-1)+1),0),m=s?2:1,f=3*(l+u+d)*m,_=o>=tMe?new Uint32Array(f):new Uint16Array(f);let g=0;const w=e-2,v=a-2;if(fe(v>=0),s){const b=(T,R,E)=>{_[g++]=T,_[g++]=R,_[g++]=R,_[g++]=E,_[g++]=E,_[g++]=T,gn&&(fe(T<o),fe(R<o),fe(E<o),fe(g<=f))};(()=>{for(let T=Math.max(n[0],1)-1;T<Math.min(n[1],e-2)-1;++T)for(let R=Math.max(r[0],1)-1;R<Math.min(r[1],e-2)-1;++R){const E=T*w+R,O=E+1,$=O+w,D=$-1;b(E,O,$),b($,D,E)}})(),fe(g===3*l*m),(()=>{for(let T=0;T<4;++T){const R=g;if(c[T])continue;const E=i.outerEdges[T],O=i.innerEdges[T];let $=0,D=0;const I=E.count,G=O.count;fe(G===a-1);let W=0;const re=T===1||T===2?(te,H,M)=>b(te,H,M):(te,H,M)=>b(te,M,H);for(;$<I-1||D<G-1;){const te=O.getVertexIndex(D),H=E.getVertexIndex($),M=$<I-1,U=D<G-1,L=M?0+a*($+.5)/(I-1):0,z=U?1+v*(D+.5)/(G-1):0;M&&(!U||L<=z)?(++$,gn&&fe($<I),re(te,H,E.getVertexIndex($)),W++):(++D,gn&&fe(D<G),re(te,H,O.getVertexIndex(D)),W++)}gn&&(fe($===I-1),fe(D===G-1),fe(W===I+G-2),fe(W===a-2+E.count-1),fe(g===R+3*W*m))}})(),fe(g===3*(l+u)*m);const x=T=>{const R=i.outerEdges[T.connectedOuterEdgeOffset];let E=R.getVertexIndex(0),O=R.stride;for(let $=0;$<T.latitudeResolution;++$){const D=$===0?T.rowOffset:E+e;for(let I=0;I<a;I++)b(E,E+1,D+I),$<T.latitudeResolution-1&&b(E+1,D+I+1,D+I),E+=O;E=D,O=1}};t.forEach(x)}else{(()=>{const x=Math.max(n[0],1)-1,T=Math.min(n[1],e-2)-1,R=Math.max(r[0],1)-1,E=Math.min(r[1],e-2)-1;for(let O=x;O<T;++O){const $=O*w;for(let D=R;D<E;++D){const I=$+D,G=I+1,W=G+w,re=W-1;_[g+0]=I,_[g+1]=G,_[g+2]=W,_[g+3]=W,_[g+4]=re,_[g+5]=I,g+=6}}})(),fe(g===3*l*m),(()=>{for(let x=0;x<4;++x){if(c[x])continue;const T=i.outerEdges[x],R=i.innerEdges[x];let E=0,O=0;const $=T.count,D=R.count;fe(D===a-1);const I=x===1||x===2,G=I?1:2,W=I?2:1,re=T.index0,te=T.stride,H=R.index0,M=R.stride;for(;E<$-1||O<D-1;){const U=H+O*M,L=re+E*te,z=E<$-1,q=O<D-1,K=z?0+a*(E+.5)/($-1):0,ie=q?1+v*(O+.5)/(D-1):0,Z=z&&(!q||K<=ie);Z?++E:++O;const ne=Z?L+te:U+M;_[g+0]=U,_[g+G]=L,_[g+W]=ne,g+=3}}})(),fe(g===3*(l+u)*m);const b=x=>{const T=i.outerEdges[x.connectedOuterEdgeOffset];let R=T.getVertexIndex(0),E=T.stride;for(let O=0;O<x.latitudeResolution;++O){const $=O===0?x.rowOffset:R+e;for(let D=0;D<a;D++){const I=$+D;_[g+0]=R,_[g+1]=R+1,_[g+2]=I,O<x.latitudeResolution-1?(_[g+3]=R+1,_[g+4]=I+1,_[g+5]=I,g+=6):g+=3,R+=E}R=$,E=1}};t.forEach(b)}fe(g===f),i.indices=_,i.indexCount=f}function BJ(i,e){const t=i.localOrigin,r=i.geometryInfo,n=i.geometryState.neighborData.edgeResolutions,s=r.numVerticesPerSide-2,a=r.vertexAttributes;let o=e;for(let l=0;l<4;++l){{const c=l===0||l===2,u=(l===0?s-1:0)*s+(l===1?s-1:0),d=(c?0:1)*s+(c?1:0);r.innerEdges[l]=new Zz(a,t,u,d,s)}{const c=o,u=n[l]+1;r.outerEdges[l]=new Zz(a,t,c,1,u),o+=u}}}function GJ(i,e){const t=(e+2)%4,r=i.geometryState,n=i.tile,s=r.neighborData,a=Jp(n,s.edgePeerNeighbors[e]),o=n.level-a.level,l=e===1||e===3,c=s.edgeResolutions[e];fe(_w(c));const u=c+1,d=i.geometryInfo,m=d.boundingBox,f=d.outerEdges[e],_=d.uvRange[0],g=d.uvRange[1],w=d.uvRange[2],v=d.uvRange[3],b=ue(e===1?1:0,_,w),x=ue(e===0?1:0,g,v),T=a.renderData,R=T.geometryState,E=T.geometryInfo.outerEdges[t],O=n.getNeighborEdgeStartVertexIndex(e,a)*c,$=c*2**o;fe(R.neighborData.edgeResolutions[t]===$),fe(E.count-1===$);const D=T.localOrigin[0]-i.localOrigin[0],I=T.localOrigin[1]-i.localOrigin[1],G=T.localOrigin[2]-i.localOrigin[2],W=f.attributes,re=f.index0,te=f.stride,H=W.position.typedBuffer,M=W.position.typedBufferStride,U=W.normalCompressed.typedBuffer,L=W.normalCompressed.typedBufferStride,z=W.uv0,q=E.attributes,K=E.index0,ie=E.stride,Z=q.position.typedBuffer,ne=q.position.typedBufferStride,Ae=q.normalCompressed.typedBuffer,Fe=q.normalCompressed.typedBufferStride;for(let ze=1;ze<u-1;++ze){const Ye=re+te*ze,Ce=K+ie*(O+ze),Ee=Ye*M,je=Ce*ne,nt=Z[je+0]+D,Mt=Z[je+1]+I,st=Z[je+2]+G;H[Ee+0]=nt,H[Ee+1]=Mt,H[Ee+2]=st,Xs(nt,Mt,st,m);const Be=Ye*L,Ve=Ce*Fe;U[Be+0]=Ae[Ve+0],U[Be+1]=Ae[Ve+1];const be=ze/c,_t=l?b:ue(be,_,w),Le=l?ue(be,g,v):x;go(z,Ye,_t,Le)}}function HJ(i){var Ye;const e=i.geometryState,t=e.neighborData,r=i.localOrigin,n=t.cornerNeighborData,s=i.geometryInfo,a=s.outerEdges,o=s.boundingBox,l=i.tile,c=((Ye=i.tile.surface.view)==null?void 0:Ye.viewingMode)==="local",u=l.ellipsoid.radius,d=l.extentInRadians,m=l.horizontalScale;let f=0,_=0,g=0,w=0,v=0,b=0;const x=(Ce,Ee,je)=>{const nt=d[Ee===0?1:3],Mt=d[Ce===0?0:2],st=Math.cos(nt),Be=Math.sin(nt),Ve=Math.sin(Mt),be=Math.cos(Mt),_t=u+je;f=be*st*_t,_=Ve*st*_t,g=Be*_t},T=c?(()=>{const Ce=i.geometryState.clippingArea,Ee=l.extent,je=y(Ce)&&(Ee[3]>Ce[3]||Ee[2]>Ce[2]||Ee[1]<Ce[1]||Ee[0]<Ce[0]),nt=r5(l.surface.isWebMercatorOnPlateeCarree,l.ellipsoid.radius,m);return(Mt,st,Be)=>{const Ve=Mt===0?I[0]:I[2],be=st===0?I[1]:I[3],_t=je?ue(Ve,Ce[0],Ce[2]):Ve,Le=je?ue(be,Ce[1],Ce[3]):be,Pe=Be;f=_t*m,_=nt(Le),g=Pe}})():x;let R=0,E=0,O=0;const $=c&&i.tile.surface.isWebMercatorOnPlateeCarree,D=(Ce,Ee,je,nt)=>{if(c){const Mt=Ee*m,st=$?(Math.PI/2-2*Math.atan(Math.exp(-je/u)))*u:je*m,Be=Mt-f,Ve=st-_,be=nt-g;R+=-Be*be,E+=-Ve*be,O+=Be*Be+Ve*Ve}else{const Mt=i5(Ce),st=Ce.tile,Be=st.extent,Ve=st.extentInRadians,be=(Ee-Be[0])/(Be[2]-Be[0]),_t=(je-Be[1])/(Be[3]-Be[1]),Le=Ve[0]*(1-be)+Ve[2]*be,Pe=Mt(_t),di=Math.cos(Pe),zt=Math.sin(Pe),Lt=Math.sin(Le),ot=Math.cos(Le),oe=u+nt,se=ot*di*oe-f,ge=Lt*di*oe-_,Re=zt*oe-g,We=ge*b-Re*v,at=Re*w-se*b,yt=se*v-ge*w;R+=at*Re-yt*ge,E+=yt*se-We*Re,O+=We*ge-at*se}},I=l.extent,G=e.clippingArea,W=y(G)?G:JP,re=I[0],te=I[2],H=I[1],M=I[3],U=[M>W[3],te>W[2],H<W[1],re<W[0]],L=Math.max(re,W[0]),z=Math.min(te,W[2]),q=Math.max(H,W[1]),K=Math.min(M,W[3]),ie=s.uvRange[0],Z=s.uvRange[1],ne=s.uvRange[2],Ae=s.uvRange[3],Fe=l.surface.shading||Qg,ze=Ce=>{var _t;if(!c){const Le=1/Math.sqrt(f*f+_*_+g*g);w=f*Le,v=_*Le,b=g*Le}const Ee=n[Ce].cornerTiles;R=0,E=0,O=0;let je=1/0;for(let Le=0;Le<4;++Le)je=Math.min(je,((_t=Ee[Le])==null?void 0:_t.level)??1/0);for(let Le=0;Le<4;++Le){const Pe=Ee[Le];M1[Le]=(Pe==null?void 0:Pe.level)===je?Pe:null}let nt=1,Mt=0;for(let Le=0;Le<4;++Le){const Pe=M1[Le];Pe&&(nt=Math.max(nt,Pe==null?void 0:Pe.renderData.geometryState.numVerticesPerSide),Mt=Pe.extent[2]-Pe.extent[0])}const st=Mt,Be=nt;fe(Be>1);const Ve=st/Be;for(let Le=0;Le<4;++Le){const Pe=M1[(Le+3)%4],di=M1[(Le+0)%4];if(!Pe&&!di)continue;const zt=Le===0?1:Le===1?2:Le===2?3:0,Lt=Le===0?2:Le===1?3:Le===2?0:1;if(Pe&&di){const ot=WM[Le][0]*Ve,oe=WM[Le][1]*Ve,se=Pe.extent,ge=se[zt===0||zt===1?2:0]+ot,Re=se[zt===0||zt===3?3:1]+oe,We=di.extent,at=We[Lt===0||Lt===1?2:0]+ot,yt=We[Lt===0||Lt===3?3:1]+oe,Et=Pe.renderData,dt=di.renderData,ci=Ei(ge,Re,Et.geometryState.samplerData),Bt=Ei(at,yt,dt.geometryState.samplerData);D(Et,ge,Re,.5*(ci+Bt))}else{const ot=Pe??di,oe=Pe?zt:Lt,se=ot.extent,ge=WM[Le],Re=se[oe===0||oe===1?2:0]+ge[0]*Ve,We=se[oe===0||oe===3?3:1]+ge[1]*Ve,at=ot.renderData,yt=Ei(Re,We,at.geometryState.samplerData);D(at,Re,We,yt)}}const be=1/Math.sqrt(R*R+E*E+O*O);R*=be,E*=be,O*=be};for(let Ce=0;Ce<4;++Ce){const Ee=Ce,je=(Ce+1)%4,nt=Ce===0||Ce===1?1:0,Mt=Ce===0||Ce===3?1:0,st=ue(nt,ie,ne),Be=ue(Mt,Z,Ae),Ve=a[Ee],be=Ce===0||Ce===3?Ve.count-1:0,_t=a[je],Le=Ce===0||Ce===1?_t.count-1:0,Pe=n[Ce].cornerTiles;let di=-1;for(let ot=0;ot<4;++ot){const oe=Pe[ot];oe&&(di===-1||vd(Pe[di],oe)>0)&&(di=ot)}const zt=di,Lt=Pe[zt];if(R=0,E=0,O=1,Lt!==l){const ot=l.level-Lt.level,oe=2**ot,se=[Lt.lij[0]+ot,Lt.lij[1]*oe,Lt.lij[2]*oe],ge=[se[1]+oe===l.lij[1],Ce===0&&(zt===1||zt===0&&Lt!==Pe[3])||Ce===1&&(zt===0||zt===1&&Lt!==Pe[2]),se[1]===l.lij[1]+1,Ce===2&&(zt===3||zt===2&&Lt!==Pe[1])||Ce===3&&(zt===2||zt===3&&Lt!==Pe[0])],Re=ge.reduce((dt,ci)=>dt+(ci?1:0),0);fe(Re===1||Re===2);let We=-1,at=-1;const yt=Lt.renderData;if(Re===1){const dt=ge.findIndex(Bt=>Bt);fe(0<=dt&&dt<=3),We=(dt+2)%4;const ci=i.geometryState.neighborData.edgeResolutions[dt];at=l.getNeighborEdgeStartVertexIndex(dt,Lt)*ci+ci*(dt===0&&Ce===0||dt===1&&Ce===0||dt===2&&Ce===1||dt===3&&Ce===3?1:0)}else{fe(ge[1]||ge[3]),We=ge[1]?3:1;const dt=yt.geometryState.neighborData.edgeResolutions[We];at=Ce===0||Ce===3?0:dt}const Et=yt.geometryInfo.outerEdges[We];{const dt=Ve.index0+be*Ve.stride,ci=_t.index0+Le*_t.stride,Bt=Et.index0+at*Et.stride;{const Hi=Et.attributes.position,ji=Hi.typedBuffer,xn=Bt*Hi.typedBufferStride,jn=i.localOrigin,an=Et.localOrigin,cl=ji[xn+0]+an[0]-jn[0],vo=ji[xn+1]+an[1]-jn[1],qn=ji[xn+2]+an[2]-jn[2];Xs(cl,vo,qn,o);{const Tn=Ve.attributes.position,Ki=Tn.typedBuffer,nr=dt*Tn.typedBufferStride;Ki[nr+0]=cl,Ki[nr+1]=vo,Ki[nr+2]=qn}{const Tn=_t.attributes.position,Ki=Tn.typedBuffer,nr=ci*Tn.typedBufferStride;Ki[nr+0]=cl,Ki[nr+1]=vo,Ki[nr+2]=qn}}go(Ve.attributes.uv0,dt,st,Be),go(_t.attributes.uv0,ci,st,Be);{const Hi=Et.attributes.normalCompressed.typedBuffer,ji=Bt*Et.attributes.normalCompressed.typedBufferStride;{const xn=Ve.attributes.normalCompressed,jn=xn.typedBuffer,an=dt*xn.typedBufferStride;jn[an+0]=Hi[ji+0],jn[an+1]=Hi[ji+1]}{const xn=_t.attributes.normalCompressed,jn=xn.typedBuffer,an=ci*xn.typedBufferStride;jn[an+0]=Hi[ji+0],jn[an+1]=Hi[ji+1]}}}}else{const ot=U[Ee],oe=U[je];let se;if(ot||oe){const at=ue(re*(1-nt)+te*nt,L,z),yt=ue(H*(1-Mt)+M*Mt,q,K),Et=e.samplerData;se=Ei(at,yt,Et)}else se=yMe(Pe);T(nt,Mt,se),(Fe||Qg)&&ze(Ce);const ge=f-r[0],Re=_-r[1],We=g-r[2];Xs(ge,Re,We,o),Ve.setVertexFromValuesRawPositionUVNormal(be,ge,Re,We,st,Be,R,E,O),_t.setVertexFromValuesRawPositionUVNormal(Le,ge,Re,We,st,Be,R,E,O)}}for(let Ce=0;Ce<4;++Ce)M1[Ce]=null}function yMe(i){var s,a;const e=i.reduce((o,l)=>Math.min(o,(l==null?void 0:l.level)??1/0),1/0);gn&&(fe(!i[0]||!i[2]||L$(i[0],i[2],qe.SOUTH_WEST)),fe(!i[1]||!i[3]||L$(i[1],i[3],qe.NORTH_WEST)));let t=0,r=0;for(let o=0;o<4;++o){const l=i[o];if(l&&l.level===e){const c=o===0||o===1,u=o===0||o===3,d=l.extent,m=d[c?0:2],f=d[u?1:3],_=(a=(s=l.renderData)==null?void 0:s.geometryState)==null?void 0:a.samplerData;r+=Ei(m,f,_),t++}}const n=t?r/t:0;return fe(n!=null),n}function KP(i){const e=i.vao,t=i.geometryInfo.vertexAttributes.position.typedBuffer;e.vertexBuffers.geometry.setSubData(t,0,0,t.length)}const WM=[[0,1],[1,0],[0,-1],[-1,0]],Tr=new lOe,JP=SG(-1/0,-1/0,1/0,1/0),M1=[null,null,null,null];function jJ(i,e,t){if(!e)return!1;const r=vd(i,e);return r>0||r===0&&t<2}const Qg=!0;let vMe=class extends K4{constructor(e,t,r){super(),this._horizontalScaleFactor=1,this._extentInRenderSR=Nt(),e!==void 0&&this.init(e,t,r)}get horizontalScale(){return this._horizontalScaleFactor}init(e,t,r){super.init(e,t,r);const n=r.view.renderSpatialReference,s=r.spatialReference,a=y(n)&&G7(n)&&y(s)&&s.isGeographic?this.ellipsoid.radius*Math.PI/180:1;this._horizontalScaleFactor=a;const o=this.surface.isWebMercatorOnPlateeCarree,l=this._extentInRenderSR,c=this.extent;if(o){const u=Ze(c[0],c[1],0);ss(u,Zt.WebMercator,u,Zt.PlateCarree);const d=Ze(c[2],c[3],0);ss(d,Zt.WebMercator,d,Zt.PlateCarree),l[0]=u[0],l[1]=u[1],l[2]=d[0],l[3]=d[1]}else for(let u=0;u<4;++u)l[u]=c[u]*a;this.centerAtSeaLevel[0]=.5*(l[0]+l[2]),this.centerAtSeaLevel[1]=.5*(l[1]+l[3]),this.centerAtSeaLevel[2]=0,this._edgeLen=Math.max(l[2]-l[0],l[3]-l[1]),this._edgeLen2=this._edgeLen*this._edgeLen,this.updateRadiusAndCenter()}updateRadiusAndCenter(){this._updateCenter();const e=this._extentInRenderSR,t=.5*(e[2]-e[0]),r=.5*(e[3]-e[1]),n=Math.sqrt(t*t+r*r),s=.5*(this.elevationBounds[0]-this.elevationBounds[1]),a=Math.max(n,s);this._center[Hs.MIDDLE][3]=a}_calculateFrustumVisibilityStatus(e){const t=this._aabb(),r=t[0],n=t[1],s=t[2],a=t[3],o=t[4],l=t[5];let c=!0;for(let u=0;u<6;u++){const d=e[u],m=d[0],f=d[1],_=d[2],g=d[3];if(m*(m>0?r:a)+f*(f>0?n:o)+_*(_>0?s:l)+g>=0)return xs.OUTSIDE;c=c&&m*(m<0?r:a)+f*(f<0?n:o)+_*(_<0?s:l)+g<=0}return c?xs.INSIDE:xs.INTERSECTS}_aabb(){const e=this._extentInRenderSR;return tae(e[0],e[1],this.elevationBounds[0],e[2],e[3],this.elevationBounds[1])}intersectsRay(e,t,r,n){return aS[0]=1/t[0],aS[1]=1/t[1],aS[2]=1/t[2],tH(this._aabb(),e,aS,r,n)}createGeometry(){hMe(this.renderData,this._horizontalScaleFactor),this.setMemoryDirty()}getDefaultVerticesPerRowOnLevel(){return this.level<9?3:2}updateCornerElevations(){mMe(this.renderData,this._horizontalScaleFactor)}updateEdgeElevations(){fMe(this.renderData,this._horizontalScaleFactor)}};const aS=P();var Px;(function(i){i[i.BACK_TO_FRONT=-1]="BACK_TO_FRONT",i[i.NONE=0]="NONE",i[i.FRONT_TO_BACK=1]="FRONT_TO_BACK"})(Px||(Px={}));let bMe=class extends K4{constructor(e,t,r){super(),this._obb=new Array(8);for(let n=0;n<8;n++)this._obb[n]=P();e!==void 0&&this.init(e,t,r)}init(e,t,r){super.init(e,t,r);const n=this.ellipsoid.radius,s=this.extentInRadians[0],a=this.extentInRadians[1],o=this.extentInRadians[2],l=this.extentInRadians[3],c=e[0],u=bt(a,l,.5),d=bt(s,o,.5),m=c===0?0:Math.min(Math.abs(a),Math.abs(l));this._edgeLen=(o-s)*Math.cos(m)*n,this._edgeLen2=this._edgeLen*this._edgeLen,this._curvatureHeight=n-Math.sqrt(n*n-this._edgeLen2/4),Vv(this.centerAtSeaLevel,d,u,this.ellipsoid.radius);const f=Tl(this.centerAtSeaLevel);de(f,f),this.up=f,this._updateOBB(),this.updateRadiusAndCenter()}updateRadiusAndCenter(){if(this.lij[0]===0)Y(this._center[mc.MIDDLE],0,0,0),Y(this._center[mc.TOP],0,0,0),Y(this._center[mc.BOTTOM],0,0,0),this.ellipsoid||(this.ellipsoid=Kt(this.surface.spatialReference)),this._center[mc.MIDDLE][3]=this.ellipsoid.radius+this.elevationBounds[1];else{this._updateCenter();const e=Math.max(Bl(this._center[mc.MIDDLE],this._obb[0]),Bl(this._center[mc.MIDDLE],this._obb[1]));this._center[mc.MIDDLE][3]=Math.sqrt(e)}}_calculateFrustumVisibilityStatus(e){if(!GR(e,this._center[mc.MIDDLE]))return xs.OUTSIDE;if(this.lij[0]<10)return xs.INTERSECTS;const t=this._obb,r=this.surface.view.state.camera.near;let n=!0;for(let s=0;s<Wse.NUM;s++){const a=s===hr.NEAR,o=e[s],l=o[0],c=o[1],u=o[2],d=o[3]-(a?r:0);let m=!1;for(let f=0;f<8;++f){const _=t[f];if(l*_[0]+c*_[1]+u*_[2]+d<0){if(m=!0,!n)break}else n=!1}if(!m)return xs.OUTSIDE}return n?xs.INSIDE:xs.INTERSECTS}computeElevationBounds(){super.computeElevationBounds(),this._updateOBB()}createGeometry(){const e=this._getPatchType(this.lij[1],this.lij[0]);iMe(this.renderData,e),this.setMemoryDirty()}_updateOBB(){const e=this.extentInRadians,t=this._obb;for(let r=0;r<2;r++){const n=this.elevationBounds[r];let s=4*r;Vv(t[s++],e[0],e[1],this.ellipsoid.radius+n),Vv(t[s++],e[0],e[3],this.ellipsoid.radius+n),Vv(t[s++],e[2],e[3],this.ellipsoid.radius+n),Vv(t[s++],e[2],e[1],this.ellipsoid.radius+n)}if(this.surface.isWebMercator)switch(this._getPatchType(this.lij[1],this.lij[0])){case Pl.HAS_NORTH_POLE:Y(t[1],0,0,this.ellipsoid.radius),Y(t[2],0,0,this.ellipsoid.radius),Y(t[5],0,0,this.ellipsoid.radius),Y(t[6],0,0,this.ellipsoid.radius);break;case Pl.HAS_SOUTH_POLE:Y(t[0],0,0,-this.ellipsoid.radius),Y(t[3],0,0,-this.ellipsoid.radius),Y(t[4],0,0,-this.ellipsoid.radius),Y(t[7],0,0,-this.ellipsoid.radius)}}_getPatchType(e,t){return e===(1<<t)-1?e===0?Pl.HAS_BOTH_POLES:Pl.HAS_SOUTH_POLE:e===0?Pl.HAS_NORTH_POLE:Pl.REGULAR}intersectsRay(e,t,r,n){const s=this._center[mc.MIDDLE],a=s[3]+r,o=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],l=s[0]-e[0],c=s[1]-e[1],u=s[2]-e[2],d=(l*t[0]+c*t[1]+u*t[2])/o,m=t[0]*d-l,f=t[1]*d-c,_=t[2]*d-u;return m*m+f*f+_*_<a*a}getDefaultVerticesPerRowOnLevel(){return this.level<cB.length?cB[this.level]+1:2}updateCornerElevations(){oMe(this.renderData)}updateEdgeElevations(){aMe(this.renderData)}};const cB=[128,64,32,16,16,8,8,4];var mc;(function(i){i[i.TOP=0]="TOP",i[i.MIDDLE=1]="MIDDLE",i[i.BOTTOM=2]="BOTTOM"})(mc||(mc={}));let wMe=class{constructor(){this.extent=yi(),this.minLevel=0,this.maxLevel=0,this.callback=null}},xMe=class{constructor(){this._queries=new Yt({initialSize:10}),this._queriesInvPtr=0,this._queryQueue=new Yt({initialSize:30}),this._queryPool=new Fl(wMe)}queryVisibleLevelRange(e,t,r,n){const s=this._queryPool.acquire();im(s.extent,e),s.minLevel=t||-Number.MAX_VALUE,s.maxLevel=r??Number.MAX_VALUE,s.callback=n,this._queryQueue.push(s)}hasPendingQueries(){return this._queryQueue.length!==0}prepareQueries(){for(;this._queries.length<this._queries.data.length&&this._queryQueue.length>0;){const e=this._queryQueue.pop();this._queries.push(e)}this._queriesInvPtr=this._queries.length}processQueries(){for(let e=0;e<this._queries.length;e++){const t=this._queries.data[e];this._queryPool.release(t),t.callback(e>=this._queriesInvPtr),t.callback=null}this._queries.clear()}scaleQueriesForTile(e){const t=e.level;let r=0;for(;r<this._queriesInvPtr;){const n=this._queries.data[r],s=n.extent;t>=n.minLevel&&t<=n.maxLevel&&s[0]<=e.extent[2]&&s[2]>=e.extent[0]&&s[1]<=e.extent[3]&&s[3]>=e.extent[1]?(this._queries.swapElements(r,this._queriesInvPtr-1),this._queriesInvPtr--):r++}}},qJ=class extends $a{constructor(){super(...arguments),this.blendMode=ye.Normal}};h([k({count:ye.COUNT})],qJ.prototype,"blendMode",void 0);let T0=class extends qJ{constructor(){super(...arguments),this.output=Zr.Composite,this.baseOpacityMode=Dc.NotRequired,this.premultipliedSource=bc.Off,this.hasWebGL2Context=!1}};h([k({count:Zr.COUNT})],T0.prototype,"output",void 0),h([k({count:Dc.COUNT})],T0.prototype,"baseOpacityMode",void 0),h([k()],T0.prototype,"premultipliedSource",void 0),h([k()],T0.prototype,"hasWebGL2Context",void 0);var Zg;function TMe(i){const e=new Yi;if(e.include(RJ),i.background===Zg.Only){const t=i.output===Zr.ColorComposite;return t?e.fragment.uniforms.add(new Ps("backgroundColor",r=>r.backgroundColor)):(e.extensions.add("GL_OES_standard_derivatives"),e.fragment.include(Y4)),e.fragment.code.add(A`
    void main() {
      gl_FragColor = ${t?A`vec4(backgroundColor, 1.0)`:A`gridColor(uv)`};
    }
  `),e}return e.include(PJ,i),e.fragment.uniforms.add(new Ht("tex",t=>t.texture)),e.fragment.uniforms.add(new Pt("opacity",t=>t.opacity)),e.fragment.code.add(A`void main() {
vec4 bgColor = getBackground(uv);
gl_FragColor = blendLayers(bgColor, texture2D(tex, uv), opacity);
}`),e}(function(i){i[i.BelowLayer=0]="BelowLayer",i[i.Only=1]="Only",i[i.COUNT=2]="COUNT"})(Zg||(Zg={}));const CMe=Object.freeze(Object.defineProperty({__proto__:null,get BackgroundMode(){return Zg},build:TMe},Symbol.toStringTag,{value:"Module"}));let SMe=class extends EJ{constructor(){super(...arguments),this.opacity=1,this.baseOpacity=1,this.texture=null,this.fboTexture=null,this.backgroundColor=Gl}},WJ=class XJ extends ii{initializeConfiguration(e,t){t.hasWebGL2Context=e.rctx.type===Nn.WEBGL2}initializeProgram(e){return new ei(e.rctx,XJ.shader.get().build(this.configuration),oi)}initializePipeline(){return it({blending:lu(me.ONE,me.ONE_MINUS_SRC_ALPHA),colorWrite:gt})}};WJ.shader=new ri(CMe,()=>j(()=>import("./BlendLayers.glsl-37569102.js"),["assets/BlendLayers.glsl-37569102.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/vec2f64-30dc1443.js","assets/VertexAttribute-9c5c630d.js","assets/vec2-528adfe4.js","assets/common-c186b691.js","assets/Texture2DPassUniform-753de459.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));let QJ=class extends T0{constructor(){super(...arguments),this.background=Zg.BelowLayer}};h([k()],QJ.prototype,"background",void 0);let XM=class{constructor(e,t,r,n,s,a){this.texture=e,this.type=t,e.retain(),this.offsetAndScale=Bi(r.offset[0],r.offset[1],r.scale,r.scale),this.opacities=Ze(n,s,a)}destroy(){this.texture.release()}};const EMe=.125;let RMe=class{constructor(){this._renderParams={context:null,drawPhase:1,state:new l3({viewpoint:new rr({targetGeometry:new He(0,0),scale:1,rotation:0}),size:[256,256]}),stationary:!0,pixelRatio:1,displayLevel:-1,requiredLevel:-1,globalOpacity:1,renderPass:"background",styleLayer:null,styleLayerUID:-1,painter:null,glyphMosaic:null,spriteMosaic:null,profiler:null,renderingOptions:null,requestRender:null,allowDelayedRender:!1,deltaTime:-1,timeline:null,time:0,hasClipping:!1,blendMode:null,dataUploadCounter:0,effects:null,inFadeTransition:!1,requireFBO:!1}}dispose(){this._renderParams=null}render(e,t,r,n,s,a,o,l,c,u){const d=a.adjustLevel(t[0]),m=this._renderParams;m.context=e,m.painter=n,m.glyphMosaic=n.glyphMosaic,m.spriteMosaic=n.spriteMosaic,m.pixelRatio=u,m.displayLevel=d,m.requiredLevel=d;const f=a.getScale(t[0]),[_,g]=a.getShift(t,o*f),w=EMe*o*f/c,v=r.transforms.dvs;v[0]=w,v[4]=-w,v[6]=-1-_-l[0]*o*2,v[7]=1+g+(1-l[1])*o*2-2,m.state.size[0]=c,m.state.size[1]=c,r.stage||r.attachWithContext(e),r.triangleCount=0,n.drawTile(m,r,s)}},ZJ=class YJ extends ii{initializeConfiguration(e,t){t.hasWebGL2Context=e.rctx.type===Nn.WEBGL2}initializeProgram(e){return new ei(e.rctx,YJ.shader.get().build(this.configuration),oi)}initializePipeline(){return it({blending:lu(me.ONE,me.ONE_MINUS_SRC_ALPHA),colorWrite:gt})}};ZJ.shader=new ri(AOe,()=>j(()=>import("./RasterColorizer.glsl-de9a5a50.js"),["assets/RasterColorizer.glsl-de9a5a50.js","assets/vec3f64-2f9cef06.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/vec2-528adfe4.js","assets/common-c186b691.js","assets/vec2f64-30dc1443.js","assets/Texture2DPassUniform-753de459.js","assets/VertexAttribute-9c5c630d.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));let TE=class extends T0{constructor(){super(...arguments),this.colorizerType=Sg.Stretch,this.stretchType=Xg.Noop,this.applyColormap=!0}};h([k({count:Sg.COUNT})],TE.prototype,"colorizerType",void 0),h([k({count:Xg.COUNT})],TE.prototype,"stretchType",void 0),h([k()],TE.prototype,"applyColormap",void 0);let hB=class{constructor(e){this._rctx=e,this._fbos=new Map}get(e){return this._getPool(e)}dispose(){this._fbos.forEach(e=>e.dispose()),this._fbos.clear()}_getPool(e){const t=this._fbos.get(e);if(t)return t;const r=new yn(this._rctx,{colorTarget:Vn.TEXTURE,depthStencilTarget:rs.DEPTH_RENDER_BUFFER,width:e,height:e});return this._fbos.set(e,r),r}};const PMe=ee.getLogger("esri.views.3d.terrain");let AMe=class{constructor(e,t){this._rctx=e,this._techniqueRepository=t,this._fbos=[],this._vectorTileHelper=new RMe,this._bindParameters=new AP(null,null,null),this._blendLayersTechniqueConfig=new QJ,this._current=0,this._lastUsedIds=new Array,this._lastCreatedBufferId=0,this._onHoldIds=new Array,this._vaoQuad=La(this._rctx,jx)}dispose(){this._fbos.forEach(e=>{e.dispose(),e=null}),this._fbos=null,this._vtFBO=ke(this._vtFBO),this._vaoQuad=ke(this._vaoQuad),this._vectorTileHelper=ke(this._vectorTileHelper),this._backgroundTechnique=Qi(this._backgroundTechnique),this._applyOpacityTechnique=Qi(this._applyOpacityTechnique),this._blendLayersTechnique=Qi(this._blendLayersTechnique)}_getBlendLayersTechnique(e,t,r,n=bc.Off,s=Zg.BelowLayer){return this._blendLayersTechniqueConfig.output=t,this._blendLayersTechniqueConfig.blendMode=e,this._blendLayersTechniqueConfig.baseOpacityMode=r,this._blendLayersTechniqueConfig.premultipliedSource=n,this._blendLayersTechniqueConfig.background=s,this._blendLayersTechnique=this._techniqueRepository.releaseAndAcquire(WJ,this._blendLayersTechniqueConfig,this._blendLayersTechnique),this._blendLayersTechnique}drawBackground(e,t){const r=this._getBlendLayersTechnique(ye.Normal,t?Zr.ColorComposite:Zr.GridComposite,Dc.NotRequired,bc.Off,Zg.Only),n=this._rctx.bindTechnique(r,e,this._bindParameters);this._render(n)}_render(e){this._rctx.bindVAO(this._vaoQuad),e.assertCompatibleVertexAttributeLocations(this._vaoQuad),this._rctx.drawArrays(kt.TRIANGLE_STRIP,0,Ws(this._vaoQuad,"geometry"))}drawGroup(e,t,r,n,s,a=bc.On){t===Zr.Composite&&(e.fboTexture=this._fbos[this.getLastOnHoldId()].get(r).colorTexture),e.texture=this.currentFBO(r).colorTexture,this.closeGroup(r);const o=this._getBlendLayersTechnique(n,t,s,a),l=this._rctx.bindTechnique(o,e,this._bindParameters);this._render(l)}drawRasterData(e,t,r,n,s,a=bc.Off){if(C(e.texture))return;e.fboTexture=t===Zr.GroupBackgroundComposite||n===ye.Normal&&s===Dc.NotRequired&&a===bc.Off?null:this.switch(r).colorTexture;const o=this._getBlendLayersTechnique(n,t,s,a),l=this._rctx.bindTechnique(o,e,this._bindParameters);this._render(l)}drawImageryTileData(e,t,r,n,s,a){const o=a.sourceLayerInfo.data;if(!o.source||(a.tile.surface.layerViewByIndex(a.layerIndex,vt.MAP).ensureSymbolizerParameters(o),!o.bind(this._rctx)))return;e.fboTexture=n===ye.Normal&&s===Dc.NotRequired?null:this.switch(r).colorTexture;const l=this._getRasterColorizerTechnique(o,t,n,s);o.opacity=e.opacity;const c=o.getUniforms();c.scale=a.scale,c.offset=a.offset,c.backgroundColor=e.backgroundColor,c.fboTexture=e.fboTexture,c.baseOpacity=e.baseOpacity;const u=this._rctx.bindTechnique(l,c,null);this._render(u)}_getRasterColorizerTechnique(e,t,r,n){const s=e.symbolizerParameters,a=["stretch","lut","hillshade"].indexOf(s.type);return C(this._rasterColorizerConfig)&&(this._rasterColorizerConfig=new TE,this._rctx.gl.getExtension("WEBGL_color_buffer_float"),this._rctx.gl.getExtension("OES_texture_float")),this._rasterColorizerConfig.output=t,this._rasterColorizerConfig.blendMode=r,this._rasterColorizerConfig.baseOpacityMode=n,this._rasterColorizerConfig.colorizerType=a,this._rasterColorizerConfig.applyColormap=!!s.colormap,this._rasterColorizerConfig.stretchType=e.hasStretchTypeNone()?Xg.Noop:Xg.PerBand,this._rasterColorizerTechnique=this._techniqueRepository.releaseAndAcquire(ZJ,this._rasterColorizerConfig,this._rasterColorizerTechnique),this._rasterColorizerTechnique}drawVectorData(e,t,r,n,s,a,o,l,c){const u=this._rctx,d=a.sourceLayerInfo.data,m=a.tile.surface.layerViewByIndex(a.layerIndex,vt.MAP),f=s===Dc.Required||e.opacity<1||n!==ye.Normal||t!==Zr.Composite,_=f?bc.On:bc.Off;this._getBlendLayersTechnique(n,t,s,_).bindPipelineState(u);let g=null,w=null;f?(w=this.currentFBO(r),C(this._vtFBO)&&(this._vtFBO=new hB(this._rctx)),g=this._vtFBO.get(r),u.bindFramebuffer(g),this._clearCurrentFBO()):c&&u.clearSafe(Oi.DEPTH_BUFFER_BIT);try{this._vectorTileHelper.render(u,a.sourceLod,d,m.painter,m.layer.styleRepository,m.schemaHelper,Math.round(1/a.scale),a.offset,l,o)}catch(v){PMe.warnOnce("A render call containing vector tiles did not resolve correctly.",v)}return!y(g)||(u.bindFramebuffer(w),e.texture=g.colorTexture,e.offset=Ag,e.scale=1,this.drawRasterData(e,t,r,n,s,_),c)}copyFBOToTexture(e){const t=this._rctx,r=t.bindTexture(e.texture,Gi.TEXTURE_UNIT_FOR_UPDATES),n=e.descriptor;t.gl.copyTexImage2D(bi.TEXTURE_2D,0,n.pixelFormat,0,0,n.width,n.height,0),e.generateMipmap(),t.bindTexture(r,Gi.TEXTURE_UNIT_FOR_UPDATES)}_clearCurrentFBO(){this._rctx.setClearColor(0,0,0,0),this._rctx.setClearDepth(1),this._rctx.clearSafe(Oi.COLOR_BUFFER_BIT|Oi.DEPTH_BUFFER_BIT)}_initFBO(e,t,r){this._rctx.bindFramebuffer(e),r&&(this._rctx.setViewport(0,0,t,t),this._clearCurrentFBO())}ensureBuffer(e){this._lastUsedIds.length=0,this._lastUsedIds.push(1),this._lastCreatedBufferId=1,this._onHoldIds.length=0,this.bind(e)}bind(e,t=0,r=!0){if(this._current=t,t>=this._fbos.length)for(let n=this._fbos.length;n<=t;n++)this._fbos.push(new hB(this._rctx));this._initFBO(this._fbos[t].get(e),e,r)}_bindNextFreeBuffer(e){this._lastUsedIds.length>0?this.bind(e,this._lastUsedIds.pop()):(this._lastCreatedBufferId++,this.bind(e,this._lastCreatedBufferId))}openGroup(e){this._onHoldIds.push(this._current),this._bindNextFreeBuffer(e)}switch(e){const t=this.currentFBO(e),r=this._current;return this._bindNextFreeBuffer(e),this._lastUsedIds.push(r),t}getLastOnHoldId(){return this._onHoldIds[this._onHoldIds.length-1]}closeGroup(e){const t=this._current;this._bindNextFreeBuffer(e),this._lastUsedIds.push(t),this._lastUsedIds.push(this._onHoldIds.pop())}unbind(){this._rctx.bindFramebuffer(null)}currentFBO(e){return this._fbos[this._current].get(e)}},OMe=class{constructor(e,t,r,n){this.start=e,this.end=t,this.blendMode=r,this.opacity=n}},MMe=class{constructor(e,t,r){this._rctx=e,this.tileSize=t,this._techniqueRepository=r,this._passParameters=new SMe,this._backgroundTexture=null,this._backgroundColor=null,this._backgroundDirty=!1,this._blackTex=null,this._maxAnisotropy=this._rctx.parameters.maxMaxAnisotropy,this._composition=new AMe(this._rctx,this._techniqueRepository),this._blackTex=new $y(jne(this._rctx,[0,0,0,1])),this._ensureBackgroundTexture(this.tileSize)}dispose(){this._composition=ke(this._composition),this._backgroundTexture=Qi(this._backgroundTexture),this._blackTex=Qi(this._blackTex)}get backgroundIsGrid(){return C(this._backgroundColor)}get backgroundColor(){return this._backgroundColor}updateTileTexture(e,t){if(!e.renderData)return;const r=e.surface,n=r.baseOpacity;let s=0,a=0,o=this.tileSize,l=!1;const c=r.view.state.pixelRatio;let u=!1;uw.clear(),sy.length=0;const d=e.layerInfo[vt.MAP];let m=d.length,f=0;for(;f<d.length;f++){const w=r.layerViewByIndex(f,vt.MAP),v=w.layer.opacity;uB[f]=v;const b=w.fullOpacity;if(dB[f]=b,VG(w.layer)&&m>=d.length&&(m=f),bR(w)){pB[f]=w.layer.blendMode;let T=w.layer.blendMode!=="normal";if(mv(w.layer.parent)){const R=D$(w.layer.parent);y(R)&&R!==""&&(T=KJ(w.layer.parent)||T)}T&&(u=T,l=!1)}if(v===0&&!u){d[f].pendingUpdates&=~(Ge.TEXTURE_NOFADING&Ge.TEXTURE_FADING);continue}++a;const x=QM(e,f);if(x){if(d[f].pendingUpdates&=~(Ge.TEXTURE_NOFADING&Ge.TEXTURE_FADING),mv(w.layer.parent)){const T=D$(w.layer.parent);y(T)&&T!==""&&JJ(w.layer.parent,f)}Sx(w)?o=Math.max(o,this.tileSize*c):n===1&&b===1&&(w.isOpaque||this._dataToTexture(x)&&x.sourceLayerInfo.data.descriptor.isOpaque)&&(l=!0),++s}}o=IMe(o);const _=o/this.tileSize,g=f-1;this._ensureBackgroundTexture(this.tileSize),s!==0?s===1&&!u&&this._useLayerTexture(e,g,m,dB[g])||this._composeMapLayers(e,t,g,m,uB,pB,o,_,!l||u,uw,u):this._useBackgroundTexture(e,a)}_ensureBackgroundTexture(e){C(this._backgroundTexture)&&(this._backgroundTexture=this._buildTexture(e),this._backgroundDirty=!0),this._backgroundDirty&&(this._composition.bind(e),this._passParameters.offset=Ag,this._passParameters.scale=1,this._passParameters.opacity=1,y(this.backgroundColor)&&(this._passParameters.backgroundColor=this.backgroundColor),this._composition.drawBackground(this._passParameters,y(this.backgroundColor)),this._composition.copyFBOToTexture(this._backgroundTexture),this._composition.unbind(),this._backgroundDirty=!1)}_useBackgroundTexture(e,t){let r=yd.Immediate;(e.surface.view.layerViewManager.updating||t>0)&&(r=yd.Delayed),this._backgroundTexture&&C(e.renderData.textureReference)&&(r=yd.Immediate),e.renderData.setTextureReference(y(this._backgroundTexture)?new XM(this._backgroundTexture,fn.FADING,mB,e.surface.baseOpacity,0,1):null,r)}_useLayerTexture(e,t,r,n){const s=t<r,a=s?1:e.surface.baseOpacity,o=s?e.surface.baseOpacity:1,l=QM(e,t);return!!this._dataToTexture(l)&&(e.renderData.setTextureReference(new XM(l.sourceLayerInfo.data,fn.FADING,l,a,o,n)),!0)}_composeMapLayers(e,t,r,n,s,a,o,l,c,u,d){this._composition.ensureBuffer(o);const m=e.surface.baseOpacity;let f=!1,_=Jt.LINEAR_MIPMAP_LINEAR,g=!1,w=0;for(let b=r;b>=0;b--){const x=QM(e,b);if(!x||s[b]===0&&!d)continue;const T=b<n&&m<1&&!f;this._passParameters.baseOpacity=T?m:1;const R=this._passParameters.baseOpacity<1?Dc.Required:Dc.NotRequired;T&&(f=!0);let E=!1;u.forEach(I=>{I.start===b&&(sy.push(I),this._composition.openGroup(o),E=!0)});const O=w===0,$=E?Zr.GroupBackgroundComposite:c&&O?this.backgroundIsGrid?Zr.GridComposite:Zr.ColorComposite:Zr.Composite,D=I$[a[b]];for(cAe(x)?(this._passParameters.opacity=s[b],g=this._composition.drawVectorData(this._passParameters,$,o,D,R,x,l,this.tileSize,g)):lAe(x)?(this._passParameters.opacity=s[b],this._composition.drawImageryTileData(this._passParameters,$,o,D,R,x),this._hasNearestInterpolation(x)&&(_=Jt.NEAREST)):this._dataToTexture(x)&&(this._passParameters.texture=x.sourceLayerInfo.data.texture,this._passParameters.offset=x.offset,this._passParameters.scale=x.scale,this._passParameters.opacity=s[b],this._composition.drawRasterData(this._passParameters,$,o,D,R));sy.length>0&&sy[sy.length-1].end===b;){const I=sy.pop();this._passParameters.opacity=I.opacity,this._passParameters.offset=Ag,this._passParameters.scale=1;const G=c&&O?this.backgroundIsGrid?Zr.GridComposite:Zr.ColorComposite:Zr.Composite;this._composition.drawGroup(this._passParameters,G,o,I$[I.blendMode],R)}w++}const v=e.renderData.ensureTexture(o,()=>this._buildTexture(o,_));this._composition.copyFBOToTexture(v),this._composition.unbind(),e.renderData.setTextureReference(new XM(v,t,mB,f?1:m,0,1))}_hasNearestInterpolation(e){const t=e.sourceLayerInfo.data;return!!t.source&&t.interpolation==="nearest"}_dataToTexture(e){if(uAe(e)){const t=e.sourceLayerInfo;t.data=this._buildTexture(t.data),e.tile.setMemoryDirty()}return hAe(e)}setBackground(e){this._backgroundColor!==e&&(this._backgroundColor=e,this._backgroundDirty=!0)}_buildTexture(e,t=Jt.LINEAR_MIPMAP_LINEAR){if(C(e))return null;const r={target:bi.TEXTURE_2D,pixelFormat:St.RGBA,dataType:Xt.UNSIGNED_BYTE,wrapMode:ai.CLAMP_TO_EDGE,samplingMode:t,maxAnisotropy:this._maxAnisotropy,flipped:!0,hasMipmap:!0},n=this._rctx;let s;if(typeof e=="number")r.width=r.height=e,s=new $y(new Gi(n,r));else if(e instanceof WP)r.isOpaque=e.isOpaque,s=new $y(new Gi(n,r,e.image)),e.release();else try{r.width=e.width,r.height=e.height,s=new $y(new Gi(n,r,e))}catch{s=new $y(iH(n)),console.warn("TileRenderer: failed to execute 'texImage2D', cross-origin image may not be loaded.")}const a=n.bindTexture(s.texture,Gi.TEXTURE_UNIT_FOR_UPDATES);return s.generateMipmap(),n.bindTexture(a,Gi.TEXTURE_UNIT_FOR_UPDATES),s}get test(){return{backgroundTexture:this._backgroundTexture}}};function IMe(i){const e=lD(i),t=e*e,r=i*i;if(t===r)return i;const n=e/2;return t-r<r-n*n?e:n}function QM(i,e){Oo.layerIndex=e;const t=i.layerInfo[vt.MAP][e];if(y(t.data))return rt(Oo.offset,0,0),Oo.tile=i,Oo.scale=1,Oo.sourceLod=i.lij,Oo.sourceLayerInfo=t,Oo;const r=t.upsampleInfo;if(y(r)){const n=r.tile.layerInfo[vt.MAP][e];return Oo.tile=r.tile,wn(Oo.offset,r.offset),Oo.scale=r.scale,Oo.sourceLod=r.tile.lij,Oo.sourceLayerInfo=n,Oo}return null}function D$(i){return i.get("uid")}function KJ(i){let e=i.blendMode!=="normal";return mv(i.parent)&&(e=KJ(i.parent)||e),e}function JJ(i,e){mv(i.parent)&&JJ(i.parent,e);const t=D$(i);y(t)&&t!==""&&(uw.has(t)?uw.get(t).start=e:uw.set(t,new OMe(e,e,i.blendMode,i.opacity)))}const uB=new Array,dB=new Array,pB=new Array,uw=new Map,sy=new Array,Oo={tile:null,sourceLayerInfo:null,sourceLod:null,offset:[0,0],scale:1,layerIndex:0},mB={offset:[0,0],scale:1},eee=200,ZM=40,LMe=.8,$Me=10,wb=1e-6;function DMe(i,e,t){const r=e,n=t;let s=0,a=1/0;for(let o=0;o<3;++o){{const l=i[o];if(r[o]<l){if(n[o]<=wb)return!1;const c=(l-r[o])/n[o];s=Math.max(s,c)}else if(n[o]<=-wb){const c=(l-r[o])/n[o];a=Math.min(a,c)}if(s>a)return!1}{const l=i[o+3];if(r[o]>l){if(n[o]>=-wb)return!1;const c=(l-r[o])/n[o];s=Math.max(s,c)}else if(n[o]>=wb){const c=(l-r[o])/n[o];a=Math.min(a,c)}if(s>a)return!1}}return!0}let fB=class{constructor(e,t,r,n,s){this.aabb=e,this.axis=t,this.d=r,this.midStartIndex=n,this.rightStartIndex=s}},n5=class F${constructor(e,t,r,n){this.globalTriangleVertexIndices=e,this.firstTriangleIndex=t,this.positionAttribute=n,this._rayDirection=P(),this.bspNodeTree=new Array,this.vertexPositionBuffer=n.data,this.vertexPositionStride=n.stride;const s=r-t,a=s<=tee?new Uint16Array(s):new Uint32Array(s);this.indices=a;for(let o=0;o<s;++o)a[o]=o;{const o=UMe(e,t,r,n.data,n.stride),l=ue(Math.log2(s/ZM),2,$Me),c=(u,d,m)=>{const f=kMe(a,o,u,d),_=d-u;if(_<=ZM){const T=new fB(f,void 0,0,u,d);return this.bspNodeTree.push(T),T}const{axis:g,midValue:w}=VMe(f),v=NMe(a,o,u,d,g,w),b=(T,R)=>{if(m>l)return;const E=R-T;return E<ZM||E>=LMe*_?void 0:c(T,R,m+1)},x=new fB(f,g,w,v.next,v.mid);return this.bspNodeTree.push(x),x.leftNode=b(u,v.next),x.rightNode=b(v.mid,d),x};c(0,s,0),this.triangleVertexIndices=zMe(a,e,t,r)}}intersectRayTriangleRange(e,t){{if(e>=t)return;const r=this.triangleVertexIndices,n=this.positionAttribute.data,s=this.positionAttribute.stride,a=this._rayOrigin,o=a[0],l=a[1],c=a[2],u=this._rayDirection,d=u[0],m=u[1],f=u[2];for(let _=e,g=3*e;_<t;++_){let w=r[g++]*s;const v=n[w++],b=n[w++],x=n[w];w=r[g++]*s;const T=n[w++],R=n[w++],E=n[w];w=r[g++]*s;const O=T-v,$=R-b,D=E-x,I=n[w++]-v,G=n[w++]-b,W=n[w]-x,re=m*W-G*f,te=f*I-W*d,H=d*G-I*m,M=O*re+$*te+D*H;if(Math.abs(M)<=Number.EPSILON)continue;const U=o-v,L=l-b,z=c-x,q=U*re+L*te+z*H;if(M>0){if(q<0||q>M)continue}else if(q>0||q<M)continue;const K=L*D-$*z,ie=z*O-D*U,Z=U*$-O*L,ne=d*K+m*ie+f*Z;if(M>0){if(ne<0||q+ne>M)continue}else if(ne>0||q+ne<M)continue;const Ae=(I*K+G*ie+W*Z)/M;if(Ae>=0){const Fe=this.indices[_]+this.firstTriangleIndex,ze=qne(O,$,D,I,G,W,FMe);this._callback(Ae,ze,Fe,!1)}}}F$.numFacesTested+=t-e}intersectRay(e,t){F$.numFacesTested=0;const r=Ze(e.r0[0],e.r0[1],e.r0[2]),n=Ze(e.r1[0],e.r1[1],e.r1[2]),s=n[0]-r[0],a=n[1]-r[1],o=n[2]-r[2];if(s*s+a*a+o*o<wb)return;this._rayOrigin=r;const l=this._rayDirection;l[0]=s,l[1]=a,l[2]=o;const c=this.triangleVertexIndices.length/3;this._callback=t;const u=this.bspNodeTree[0];this.intersectRayBSP(u,0,c)}intersectRayBSP(e,t,r){const n=this._rayOrigin,s=this._rayDirection;if(!DMe(e.aabb,n,s))return;const a=e.axis,o=e.d;if(n[a]<o||s[a]<0){const l=t,c=e.midStartIndex;if(l<c){const u=e.leftNode;u!==void 0?this.intersectRayBSP(u,l,c):this.intersectRayTriangleRange(l,c)}}if(this.intersectRayTriangleRange(e.midStartIndex,e.rightStartIndex),n[a]>o||s[a]>0){const l=e.rightStartIndex,c=r;if(l<c){const u=e.rightNode;u!==void 0?this.intersectRayBSP(u,l,c):this.intersectRayTriangleRange(l,c)}}}get estimatedMemoryUsage(){return this.triangleVertexIndices.byteLength+this.indices.byteLength}};n5.numFacesTested=0;const FMe=P(),ay=[1/0,1/0,1/0],oy=[-1/0,-1/0,-1/0];function NMe(i,e,t,r,n,s){let a=t,o=r;for(;a<o;){const c=i[a];e[6*c+n+3]<=s?++a:(--o,i[a]=i[o],i[o]=c)}let l=a;for(o=r;l<o;){const c=i[o-1];e[6*c+n]>=s?--o:(i[o-1]=i[l],i[l]=c,++l)}return{next:a,mid:l}}function kMe(i,e,t,r){if(r<=t)return HI(NaN,NaN,NaN,NaN,NaN,NaN);{const n=6*i[t];for(let s=0;s<3;++s)ay[s]=e[n+0+s],oy[s]=e[n+3+s]}for(let n=t+1;n<r;++n){const s=6*i[n];for(let a=0;a<3;++a)ay[a]=Math.min(ay[a],e[s+0+a]),oy[a]=Math.max(oy[a],e[s+3+a])}return HI(ay[0],ay[1],ay[2],oy[0],oy[1],oy[2])}function VMe(i){const e=i[3]-i[0],t=i[4]-i[1],r=i[5]-i[2],n=e>t?e>r?0:t>r?1:2:t>r?1:r>e?2:0;return{axis:n,midValue:(i[n]+i[n+3])/2}}function UMe(i,e,t,r,n){const s=t-e,a=new Float32Array(6*s);for(let o=0;o<s;++o){const l=3*(o+e),c=i[l+0]*n,u=i[l+1]*n,d=i[l+2]*n;for(let m=0;m<3;++m){const f=r[c+m],_=r[u+m],g=r[d+m];a[6*o+m]=Math.min(f,_,g),a[6*o+3+m]=Math.max(f,_,g)}}return a}function zMe(i,e,t,r){const n=r-t;let s=0;for(let o=t;o<r;++o)for(let l=0;l<3;++l)s=Math.max(e[3*o+l],s);const a=s<=tee?new Uint16Array(3*n):new Uint32Array(3*n);for(let o=0;o<n;++o){const l=3*(i[o]+t);for(let c=0;c<3;++c){const u=e[l+c];a[3*o+c]=u}}return a}const tee=65535;let Di=class extends cu{constructor(){super(...arguments),this.output=V.Color,this.overlayMode=bd.Disabled,this.tileBlendInput=qh.LayerOnly,this.spherical=!1,this.doublePrecisionRequiresObfuscation=!1,this.atmosphere=!1,this.receiveShadows=!1,this.hasSlicePlane=!1,this.backfaceCullingEnabled=!1,this.stencilEnabled=!1,this.textureFadingEnabled=!1,this.renderOccluded=!1,this.hasScreenSpaceReflections=!1,this.hasCloudsReflections=!1,this.shading=!Wt.TERRAIN_USE_LEGACY_SHADING,this.useLegacyTerrainShading=Wt.TERRAIN_USE_LEGACY_SHADING,this.transparent=!1,this.tileBorders=!1,this.visualizeNormals=!1,this.screenSizePerspective=!1,this.receiveAmbientOcclusion=!1}};h([k({count:V.COUNT})],Di.prototype,"output",void 0),h([k({count:bd.COUNT})],Di.prototype,"overlayMode",void 0),h([k({count:qh.COUNT})],Di.prototype,"tileBlendInput",void 0),h([k()],Di.prototype,"spherical",void 0),h([k()],Di.prototype,"doublePrecisionRequiresObfuscation",void 0),h([k()],Di.prototype,"atmosphere",void 0),h([k()],Di.prototype,"receiveShadows",void 0),h([k()],Di.prototype,"hasSlicePlane",void 0),h([k()],Di.prototype,"backfaceCullingEnabled",void 0),h([k()],Di.prototype,"stencilEnabled",void 0),h([k()],Di.prototype,"textureFadingEnabled",void 0),h([k()],Di.prototype,"renderOccluded",void 0),h([k()],Di.prototype,"hasScreenSpaceReflections",void 0),h([k()],Di.prototype,"hasCloudsReflections",void 0),h([k()],Di.prototype,"shading",void 0),h([k()],Di.prototype,"useLegacyTerrainShading",void 0),h([k()],Di.prototype,"transparent",void 0),h([k()],Di.prototype,"tileBorders",void 0),h([k()],Di.prototype,"visualizeNormals",void 0),h([k()],Di.prototype,"screenSizePerspective",void 0),h([k()],Di.prototype,"receiveAmbientOcclusion",void 0),h([k({constValue:zr.Disabled})],Di.prototype,"pbrMode",void 0),h([k({constValue:Il.CompressedAttribute})],Di.prototype,"normalType",void 0),h([k({constValue:Im.Compressed})],Di.prototype,"textureCoordinateType",void 0),h([k({constValue:!1})],Di.prototype,"highStepCount",void 0),h([k({constValue:!1})],Di.prototype,"useCustomDTRExponentForWater",void 0),h([k({constValue:!1})],Di.prototype,"useFillLights",void 0);const YM=7,BMe=10,KM=Ms();var Ts;(function(i){i[i.Opaque=0]="Opaque",i[i.Semitransparent=1]="Semitransparent",i[i.Invisible=2]="Invisible"})(Ts||(Ts={}));let Za=class extends pe{constructor(e){super(e),this.type=Ui.TERRAIN,this.isGround=!0,this._tileSize=256,this._techniqueConfiguration=new Di,this._passParameters=new OJ,this._rctx=null,this._scaleRangeQueries=new xMe,this._renderDataPool=new Fl(JOe),this._patchGroups=new Map,this._patchGroupsDirty=!0,this._patchSortingDirty=!0,this._tileIterator=new xJ,this._highestVisibleLODTile=null,this._visible=!0,this._transparencyState=Ts.Opaque,this._velvetOverground=!0,this._castShadows=!0,this._emptyTex=null,this._tileRenderer=null,this._stencilEnabledLayerExtents=new Array,this._numTilesRendered=0,this._numTilesCulled=0,this._numOriginsRendered=0,this.needsHighlight=!1,this.renderOccludedFlags=cr.Occlude}get _isGlobal(){return this._stage.viewingMode===Ie.Global}get shading(){return this._techniqueConfiguration.shading}set shading(e){this._techniqueConfiguration.shading=e}initialize(){const e=[le.OPAQUE_TERRAIN,le.TRANSPARENT_TERRAIN,le.OCCLUDED_TERRAIN];this._stage.addRenderPlugin(e,this)}destroy(){this._stage.removeRenderPlugin(this),sOe()}get canRender(){return this._visible&&!!this._rootTiles&&!this.renderingDisabled}set renderingDisabled(e){this._set("renderingDisabled",!!e),this.setDirty()}set transparency(e){this._transparencyState!==e&&(this._techniqueConfiguration.transparent=e===Ts.Invisible,this._transparencyState=e,this.setNeedsRender())}get transparency(){return this._transparencyState}get needsLinearDepth(){return this._overlayRenderer.hasWater}get renderPatchBorders(){return!!this._techniqueConfiguration.tileBorders}set renderPatchBorders(e){this._techniqueConfiguration.tileBorders!==e&&(this._techniqueConfiguration.tileBorders=e,this.setNeedsRender(),this.notifyChange("renderPatchBorders"))}get visualizeNormals(){return!!this._techniqueConfiguration.visualizeNormals}set visualizeNormals(e){this._techniqueConfiguration.visualizeNormals!==e&&(this._techniqueConfiguration.visualizeNormals=e,this.setNeedsRender(),this.notifyChange("visualizeNormals"))}get cullBackFaces(){return this._techniqueConfiguration.backfaceCullingEnabled}set cullBackFaces(e){this._techniqueConfiguration.backfaceCullingEnabled!==e&&(this._techniqueConfiguration.backfaceCullingEnabled=e,this.notifyChange("cullBackFaces"),this.setNeedsRender())}set renderOrder(e){this._set("renderOrder",e),this._setSortingDirty()}set velvetOverground(e){this._velvetOverground!==e&&(this._velvetOverground=e,this.setNeedsRender())}get layerUid(){return Ac}get slicePlaneEnabled(){return this._techniqueConfiguration.hasSlicePlane}set slicePlaneEnabled(e){this._techniqueConfiguration.hasSlicePlane!==e&&(this._techniqueConfiguration.hasSlicePlane=e,this.setNeedsRender())}set textureFadingEnabled(e){this._techniqueConfiguration.textureFadingEnabled!==e&&(this._techniqueConfiguration.textureFadingEnabled=e,this.setNeedsRender())}setDebugScreenSizePerspective(e){this._techniqueConfiguration.screenSizePerspective!==e&&(this._techniqueConfiguration.screenSizePerspective=e,this.setNeedsRender())}setRootTiles(e){this._rootTiles=e,this.setDirty()}setNeedsHighlight(e){this.needsHighlight=e,this.setNeedsRender()}setRenderOccludedOverlay(e){this.renderOccludedFlags=e?dR:cr.Occlude,this.setNeedsRender()}setStencilEnabledLayerExtents(e){this._stencilEnabledLayerExtents=e,this._setSortingDirty()}setTileSize(e){this._tileSize=e,y(this._tileRenderer)&&(this._tileRenderer.tileSize=e),this.setDirty()}_prepareTileForLoading(e){e.renderData||(e.renderData=this._renderDataPool.acquire(),e.renderData.init(e),e.renderData.localOrigin=this._getLocalOriginOfTile(e))}loadTile(e){this._prepareTileForLoading(e),this.updateTileGeometryState(e),this.updateTileTexture(e,Ge.TEXTURE_FADING)}queryVisibleLevelRange(e,t,r,n){this._scaleRangeQueries.queryVisibleLevelRange(e,t,r,n),this.setNeedsRender()}updateTileTexture(e,t){y(this._tileRenderer)&&(this._tileRenderer.updateTileTexture(e,t===Ge.TEXTURE_FADING?fn.FADING:fn.UNFADED),this.setNeedsRender(),e.resetPendingUpdate(t))}updateTileGeometryState(e){for(const r of e.layerInfo[vt.ELEVATION])r.pendingUpdates&=~Ge.GEOMETRY;e.resetPendingUpdate(Ge.GEOMETRY);const t=e.renderData.updateGeometryState();return t&&this.setDirty(),t}updateGeometryIfNeeded(e){e.isLoaded&&e.renderData.updateGeometryIfNeeded(this._rctx)}unloadTile(e){const t=e.renderData;t&&(t.releaseGeometry(),this._renderDataPool.release(t),t.clear(),e.renderData=null,e.setMemoryDirty(),this.setDirty())}_getLocalOriginOfTile(e){const t=BMe-YM,r=Math.max(0,Math.floor((e.level-t)/YM)*YM);if(this._isGlobal&&r===0)return Gl;for(;e.parent&&e.level>r;)e=e.parent;return e.centerAtSeaLevel}setVisibility(e){this._visible=e,this.setDirty()}getStats(){return{numTilesRendered:this._numTilesRendered,numTilesCulled:this._numTilesCulled,numOriginsRendered:this._numOriginsRendered}}set wireframe(e){this._get("wireframe")!==e&&(this._set("wireframe",e),this.setNeedsRender())}setDirty(e=vr.UPDATE){this._patchGroupsDirty=!0,this._context.requestRender(e)}_setSortingDirty(e=vr.UPDATE){this._patchSortingDirty=!0,this._context.requestRender(e)}setNeedsRender(e=vr.UPDATE){this._context.requestRender(e)}initializeRenderContext(e){this._context=e,this._rctx=e.renderContext.rctx,this._techniqueRepository=e.shaderTechniqueRepository,this._tileRenderer=new MMe(this._rctx,this._tileSize,this._techniqueRepository),this.updateTileBackground(),this._emptyTex=iH(this._rctx)}uninitializeRenderContext(){this._emptyTex=ke(this._emptyTex),this._tileRenderer=ke(this._tileRenderer)}intersect(e,t,r,n){if(!this._rootTiles||e.options.selectOpaqueTerrainOnly&&e.options.selectionMode&&this.transparency!==Ts.Opaque)return;const s=GMe,a=HMe;ae(s,n,r),Y(a,1/s[0],1/s[1],1/s[2]);const o=e.results.min,l=e.results.max,c=e.results.ground,u=e.options.store===zn.MIN,d=!!e.results.ground.target,m=yse(e.verticalOffset),f=e.tolerance;let _,g=u&&y(o.dist)?o.dist:1/0;const w=b=>{const x=b.renderData;if(!(x!=null&&x.vao))return;const T=x.geometryInfo;rF(KM,T.boundingBox);const R=x.localOrigin;y(m)&&(m.localOrigin=R,m.applyToAabb(KM));const E=KM;if(ly[0]=r[0]-R[0],ly[1]=r[1]-R[1],ly[2]=r[2]-R[2],!tH(E,ly,a,f,g))return;const O=(te,H,M)=>{te.set(this.type,b,H,M,rn),g=u&&y(o.dist)?o.dist:1/0},$=(te,H)=>{if(y(H)&&te>=0&&(e.options.backfacesTerrain||_e(H,s)<0)&&(e.options.invisibleTerrain||!e.options.selectionMode||t==null||t(r,n,te))){if((c.dist==null||te<c.dist)&&O(c,te,H),e.options.isFiltered)return;e.options.store===zn.ALL&&(C(_)?(_=e4(e.ray),O(_,te,H),e.results.all.push(_)):te<_.dist&&O(_,te,H)),(o.dist==null||te<o.dist)&&O(o,te,H),e.options.store!==zn.MIN&&(l.dist==null||te>l.dist)&&O(l,te,H)}},D=jMe;ae(D,n,R);const I=T.indices,G=T.vertexAttributes,W={data:G.getField(S.POSITION,Fm).typedBuffer,size:3,stride:G.stride/4},re=T.indexCount/3;if(C(m)&&re>eee){const te=b.renderData;C(te.intersectionData)&&(te.intersectionData=new n5(I,0,re,W)),te.intersectionData.intersectRay({r0:ly,r1:D},$)}else GD(ly,D,0,re,I,W,null,m,$)},v=this._rootTiles;y(v)&&(()=>{const b=this._tileIterator;b.reset(v);const x=e.options.invisibleTerrain;for(;!b.done;){const T=b.next();!(T.visible||x&&T.intersectsClippingArea)||!y(m)&&!T.intersectsRay(r,s,f,g)||d&&this._useStencilForTile(T)?b.skipSubtree():w(T)}})()}prepareTechnique(e){if(e.bindParameters.slot===le.OCCLUDED_TERRAIN){if(!(e.renderOccludedMask&dR))return null}else{const t=this.transparency===Ts.Opaque?le.OPAQUE_TERRAIN:le.TRANSPARENT_TERRAIN;if(e.bindParameters.slot!==t)return null}switch(e.output){case V.Color:{this._techniqueConfiguration.hasScreenSpaceReflections=e.bindParameters.ssr.enabled,this._techniqueConfiguration.hasCloudsReflections=y(e.bindParameters.cloudsFade.data),this._techniqueConfiguration.receiveShadows=e.bindParameters.shadowMap.ready,this._techniqueConfiguration.receiveAmbientOcclusion=e.bindParameters.ssaoHelper.ready,this._techniqueConfiguration.overlayMode=this._overlayRenderer.isEmpty()?bd.Disabled:this._overlayRenderer.hasWater?bd.EnabledWithWater:bd.Enabled;const t=e.bindParameters.slot===le.OCCLUDED_TERRAIN?Zn.Occluded:Zn.ColorAndWater;return this._updateTechnique(V.Color,t===Zn.Occluded)}case V.Shadow:case V.ShadowExludeHighlight:return this._castShadows&&e.bindParameters.lighting.globalFactor===1?(this._techniqueConfiguration.receiveShadows=this._techniqueConfiguration.receiveAmbientOcclusion=!1,this._updateTechnique(V.Shadow,!1)):null;case V.Depth:return this.transparency===Ts.Invisible&&this._overlayRenderer.isEmpty()?null:(this._techniqueConfiguration.receiveShadows=this._techniqueConfiguration.receiveAmbientOcclusion=!1,this._updateTechnique(V.Depth,!1));case V.Normal:return this._techniqueConfiguration.receiveShadows=this._techniqueConfiguration.receiveAmbientOcclusion=!1,this._updateTechnique(V.Normal,!1);case V.ObjectAndLayerIdColor:return this._updateTechnique(V.ObjectAndLayerIdColor,!1);case V.Highlight:return this.needsHighlight?(this._techniqueConfiguration.receiveShadows=this._techniqueConfiguration.receiveAmbientOcclusion=!1,this._updateTechnique(V.Highlight,!1)):null}return null}render(e,t){const r=e.bindParameters.lighting.globalFactor===1;switch(this._updatePatchGroups(),t.useStencil=!1,e.output){case V.Color:{const n=e.bindParameters.slot===le.OCCLUDED_TERRAIN?Zn.Occluded:Zn.ColorAndWater;this.transparency===Ts.Opaque?this._renderMaterialPass(e,t,n):e.offscreenRenderingHelper.renderToTargets(()=>this._renderMaterialPass(e,t,n),e.offscreenRenderingHelper.tmpColor,e.offscreenRenderingHelper.mainDepth,[0,0,0,0]);break}case V.Shadow:case V.ShadowExludeHighlight:this._castShadows&&r&&this._renderAuxiliaryPass(e,t,Zn.None);break;case V.Depth:this.transparency===Ts.Invisible&&this._overlayRenderer.isEmpty()||this._renderAuxiliaryPass(e,t,Zn.None);break;case V.Normal:this._renderAuxiliaryPass(e,t,Zn.None);break;case V.ObjectAndLayerIdColor:this._renderAuxiliaryPass(e,t,Zn.ObjectAndLayerIdColor);break;case V.Highlight:this.needsHighlight&&this._renderAuxiliaryPass(e,t,Zn.Highlight)}this._scaleRangeQueries.hasPendingQueries()&&this.setNeedsRender()}_renderMaterialPass(e,t,r){const{rctx:n}=e;this._passParameters.overlaySource=r,n.bindTechnique(t,this._passParameters,e.bindParameters),this._numTilesRendered=0,this._numTilesCulled=0,this._numOriginsRendered=0,this._scaleRangeQueries.prepareQueries(),this._renderPatchGroups(e,t,r),this._scaleRangeQueries.processQueries()}_renderAuxiliaryPass(e,t,r){const n=e.rctx;this._passParameters.overlaySource=r,n.bindTechnique(t,this._passParameters,e.bindParameters),this._renderPatchGroupsAuxiliary(e,t,r)}updateTileBackground(e=null){if(C(this._tileRenderer))return;const t=this._tileRenderer;let r=null;if(y(e)){const n=ti.toUnitRGBA(e);r=Ze(n[0]||0,n[1]||0,n[2]||0)}t.setBackground(r),this._allTiles.forAll(n=>t.updateTileTexture(n,fn.FADING)),this._techniqueConfiguration.tileBlendInput=t.backgroundIsGrid?qh.GridComposite:y(t.backgroundColor)?qh.ColorComposite:qh.LayerOnly,this.setNeedsRender()}_updatePatchGroups(){if(this._patchGroupsDirty&&(this._highestVisibleLODTile=null,this._rebuildPatchGroups(),this._patchGroupsDirty=!1,this._patchSortingDirty=!0),this._patchSortingDirty&&this.renderOrder!==Px.NONE){const e=Array.from(this._patchGroups.values());e.forEach(t=>TJ(this.renderOrder,t,this._stencilEnabledLayerExtents)),e.sort((t,r)=>Q4(t[0],r[0],this.renderOrder)),this._patchGroups=new Map(e.map(t=>[t[0].renderData.localOrigin,t])),this._patchSortingDirty=!1}}_rebuildPatchGroups(){var t;const e=this._rootTiles;if(!C(e)){(t=e[0])==null||t.surface.checkAllTilesWaterproofness(),this._patchGroups.clear();for(const r of e)this._rebuildPatchGroupsForRootTile(r)}}_rebuildPatchGroupsForRootTile(e){const t=this._tileIterator;for(t.resetOne(e);!t.done;){const r=t.next(),n=r.renderData;if(!n||r.visible)if(r.rendered){if(n){const s=this._patchGroups.get(n.localOrigin)||new Array;this._patchGroups.set(n.localOrigin,s),s.push(r),(!this._highestVisibleLODTile||r.vlevel>this._highestVisibleLODTile.vlevel)&&(this._highestVisibleLODTile=r),t.skipSubtree()}}else this._numTilesCulled++;else this._numTilesCulled++,t.skipSubtree()}}_useStencilForTile(e){for(const t of this._stencilEnabledLayerExtents)if(e.intersectsExtent(t))return!0;return!1}_renderPatchGroupsAuxiliary(e,t,r){const n=this._stencilEnabledLayerExtents.length>0;this._patchGroups.forEach(s=>{const a=s[0].renderData.localOrigin;t.program.bindDraw(new h$(a),e.bindParameters,this._passParameters);for(let o=0;o<s.length;o++)this._renderPatch(e,t,s[o],kt.TRIANGLES,n,r)}),e.rctx.bindVAO(null)}_renderPatchGroups(e,t,r){const n=e.bindParameters.camera,s=t.program;if(this._techniqueConfiguration.screenSizePerspective&&this.pointsOfInterest){const u=eH(this._stage.viewingMode,this._ellipsoidRadius),d=this.pointsOfInterest.centerOnSurfaceFrequent.distance;u.update({distance:d,fovY:n.fovY})}const a=this._stencilEnabledLayerExtents.length>0,o=r===Zn.Occluded;o&&(s.bindTexture("tex",this._emptyTex),s.setUniform1f("blend",1),s.setUniform4fv("texOffsetAndScale",C0));const l=y(this._tileRenderer)&&y(this._tileRenderer.backgroundColor)?this._tileRenderer.backgroundColor:Gl;this._techniqueConfiguration.tileBlendInput===qh.ColorComposite&&s.setUniform3fv("backgroundColor",l);const c=this.wireframe?kt.LINES:kt.TRIANGLES;this._techniqueConfiguration.textureFadingEnabled&&s.bindTexture("texNext",this._emptyTex),this._patchGroups.forEach(u=>{const d=u[0].renderData.localOrigin;t.program.bindDraw(new h$(d),e.bindParameters,this._passParameters),this._numOriginsRendered++;for(let m=0;m<u.length;m++){const f=u[m],_=f.renderData.textureReference;if(!C(_)){if(!o){this._scaleRangeQueries.scaleQueriesForTile(f),s.setUniform4fv("texOffsetAndScale",_.offsetAndScale),s.bindTexture("tex",_.texture.texture);const g=f.renderData.textureFadeFactor,w=g<1?f.renderData.nextTextureReference:null;this._techniqueConfiguration.textureFadingEnabled&&y(w)&&g<1?(s.setUniform1f("fadeFactor",g),s.setUniform4fv("nextTexOffsetAndScale",w.offsetAndScale),s.setUniform3fv("nextTexOpacities",w.opacities),s.bindTexture("texNext",w.texture.texture)):s.setUniform1f("fadeFactor",1),f.renderData.textureIsFading&&this.setNeedsRender(),s.setUniform3fv("textureOpacities",_.opacities)}this._renderPatch(e,t,f,c,a,r),f.renderOrder=this._numTilesRendered,this._numTilesRendered++}}}),e.rctx.bindVAO(null)}_renderPatch(e,t,r,n,s,a){const o=r.renderData,l=o.vao,c=l.indexBuffer;if(C(c))return void(gn&&console.error("Rendered tile with no indices: ",r.lij," : ",o));const u=t.program;a!==Zn.None&&this._bindOverlayPatchData(u,o.overlay),s&&(t.useStencil=this._useStencilForTile(r),t.bindPipelineState(e.rctx,e.bindParameters.slot));const d=o.geometryInfo.indexCount;e.rctx.bindVAO(l),u.assertCompatibleVertexAttributeLocations(l),e.rctx.drawElements(n,d,c.indexType,0)}_bindOverlayPatchData(e,t){e.setUniform4fv("overlayTexOffset",t.offsets),e.setUniform4fv("overlayTexScale",t.scales)}_updateTechnique(e,t){return this._techniqueConfiguration.output=e,e===V.Color&&(this._techniqueConfiguration.atmosphere=this._isGlobal&&this._velvetOverground),this._techniqueConfiguration.renderOccluded=t,this._techniqueConfiguration.stencilEnabled=!1,this._shaderTechnique=this._techniqueRepository.releaseAndAcquire(MJ,this._techniqueConfiguration,this._shaderTechnique),this._shaderTechnique}get test(){return{tileRenderer:this._tileRenderer}}};h([p({constructOnly:!0})],Za.prototype,"_overlayRenderer",void 0),h([p({constructOnly:!0})],Za.prototype,"_stage",void 0),h([p({readOnly:!0})],Za.prototype,"_isGlobal",null),h([p({constructOnly:!0})],Za.prototype,"_allTiles",void 0),h([p({constructOnly:!0})],Za.prototype,"_ellipsoidRadius",void 0),h([p({value:!1})],Za.prototype,"renderingDisabled",null),h([p()],Za.prototype,"renderPatchBorders",null),h([p()],Za.prototype,"visualizeNormals",null),h([p()],Za.prototype,"cullBackFaces",null),h([p({value:Px.FRONT_TO_BACK})],Za.prototype,"renderOrder",null),h([p()],Za.prototype,"wireframe",null),Za=h([F("esri.views.3d.terrain.TerrainRenderer")],Za);const GMe=P(),HMe=P(),ly=P(),jMe=P();let qMe=class{constructor(){this.numNodes=0,this.numLeaves=0,this.numVisible=0,this.numRendered=0,this.numSplit=0,this.numMerged=0,this.numRenderedPerLevel=new Array,this.numLoadedPerLevel=new Array}},Ch=class extends pe{constructor(e){super(e),this._handles=new Vt}initialize(){this._handles.add(this.layers.on("change",()=>this._update())),this._handles.add(B(()=>this.extentHelper.layerViewsExtent,()=>this._setAdHocTilingScheme())),this._update(),this.tilingSchemeLocked||this._setAdHocTilingScheme()}destroy(){this._handles=Oe(this._handles),this._waitTask=null}_update(){if(this._waitTask=null,this.tilingSchemeLocked)return;let e;if(this.layers.some(t=>!(!Fb(t)||t.isRejected())&&!(t.isFulfilled()&&!WMe(t,this.viewSpatialReference,this.viewingMode))&&(e=t,!((t==null?void 0:t.type)==="vector-tile"||vR(t)))),e)if(e.isResolved()){const t=QP(e,this.viewSpatialReference,this.viewingMode);if(y(t)){const r=new so(t.tileInfo);this._lockTilingScheme(r)}}else this._updateWhen(e)}_updateWhen(e){const t=e.when().catch(()=>{}).then(()=>{t!==this._waitTask||this.destroyed||this._update()});this._waitTask=t}_lockTilingScheme(e){if(this.viewingMode===Ie.Global){const t=e.levels.length-1;e.spatialReference.isWebMercator?e=so.makeWebMercatorAuxiliarySphere(t):Pg(e.spatialReference)&&(e=so.makeGCSWithTileSize(e.spatialReference,e.pixelSize,t))}this.tilingSchemeLocked=!0,this.tilingScheme=e,this.extentHelper.tilingScheme=this.tilingScheme,this._updateTiledLayerExtent(),this._handles.removeAll(),this._handles.add(B(()=>this.extentHelper.tiledLayersExtent,()=>this._updateTiledLayerExtent()))}_updateTiledLayerExtent(){this._set("extent",this.extentHelper.tiledLayersExtent)}_setAdHocTilingScheme(){if(this.viewingMode===Ie.Global){const e=this.extentHelper.viewSpatialReference,t=Pg(e)||Dx(e)||Fx(e);e.isWebMercator?this.tilingScheme=so.WebMercatorAuxiliarySphere:t&&(this.tilingScheme=so.makeGCSWithTileSize(e,256)),this._set("extent",this.extentHelper.layerViewsExtent)}else{const e=this.extentHelper.layerViewsExtent;y(e)&&!fg(e,this.extent)&&(this.tilingScheme=so.fromExtent(e,this.extentHelper.viewSpatialReference),this._set("extent",e))}}get test(){return{lockTilingScheme:e=>this._lockTilingScheme(e),done:!this._waitTask}}};function WMe(i,e,t){return y(QP(i,e,t))}h([p()],Ch.prototype,"tilingScheme",void 0),h([p({readOnly:!0})],Ch.prototype,"extent",void 0),h([p({value:!1})],Ch.prototype,"tilingSchemeLocked",void 0),h([p({constructOnly:!0})],Ch.prototype,"viewSpatialReference",void 0),h([p({constructOnly:!0})],Ch.prototype,"layers",void 0),h([p({constructOnly:!0})],Ch.prototype,"extentHelper",void 0),h([p({constructOnly:!0})],Ch.prototype,"viewingMode",void 0),Ch=h([F("esri.views.3d.terrain.TilingSchemeLogic")],Ch);let XMe=class{constructor(){this.offset=Te(),this.scale=0,this.tile=null}init(e,t,r,n){this.tile=e,this.offset[0]=t,this.offset[1]=r,this.scale=n}dispose(){this.tile=null,this.offset[0]=0,this.offset[1]=0,this.scale=0}},mt=class extends nn.EventedMixin(pe){constructor(i){var e,t;super(i),this._iteratorPool=new Fl(xJ,r=>r.remove=()=>this._iteratorPool.release(r)),this._postorderIterator=new uOe,this._hasPendingUpdates=!1,this._pendingUpdates=0,this._asyncWorkItems=0,this._allTilesDirty=!0,this._allTilesSorted=!0,this._visibleCached=!1,this._usedMemory=null,this._performanceInfo=new qMe,this._viewChanged=!1,this._inFrameTask=!1,this._viewChangeUpdateDirty=!1,this._eyePosRenderSR=P(),this._eyePosSurfaceSR=P(),this._splitLimits=new LOe,this._frustum=Iw(),this._viewProjectionMatrix=xe(),this._layerViews=[new Array,new Array],this._layerIndexByUid=[new Map,new Map],this._basemapLayerViewHandles=new Map,this._handles=new Vt,this._watchUpdatingTracking=new _v,this._frameTask=yD,this._allTiles=new Yt,this._upsampleInfoPool=new Fl(XMe),this._rootTilesExtent=Nt(),this._maxNumUpdating=1,this.maxTextureScale=1.2,this._spatialReference=Zt.WebMercator,this.visibleElevationBounds=new x0(1/0,-1/0),this.rootTileElevationBounds=new x0(1/0,-1/0),this._updatingRootTiles=!1,this._pendingTilesForElevationUpdateEvent=new Set,this._pendingTilesToUpdate=new Set,this.totalGeometryUpdates=0,this.totalTileUpdates=0,this.oneBatchPerFrameTask=!0,this._layerViewsDirty=!1,this._shading=!0,this._isWebMercator=!1,this._isWebMercatorOnPlateeCarree=!1,this._isGlobal=!((t=(e=i.view)==null?void 0:e.state)!=null&&t.isLocal)}initialize(){this._lercDecoder=roe(this.view.resourceController),this._tilePool=this.view.state.isLocal?new Fl(vMe):new Fl(bMe);const i=this.view.resourceController.memoryController;this._upsampleMapCache=i.newCache("esri.views.3d.terrain.upsample",n=>n.unloadMapData()),this._elevationQueryCache=new VAe(i.newCache("elevation-query")),this._set("overlayManager",new fa({surface:this})),this._handles.add([B(()=>this.overlayManager.hasHighlights,n=>this._renderer.setNeedsHighlight(n)),B(()=>this.overlayManager.rendersOccluded,n=>this._renderer.setRenderOccludedOverlay(n))],"overlayManager"),this._renderer=new Za({_overlayRenderer:this.overlayManager.renderer,_ellipsoidRadius:Kt(this.view.spatialReference).radius,_stage:this.view._stage,_allTiles:this._allTiles}),this._handles.add([B(()=>this.baseOpacity,n=>{this._handleLayerViewChanges(),this._updateBaseOpacity(n)},Mi),B(()=>this.hasCompositeBlendMode,()=>{this._updateBaseOpacity(this.baseOpacity)},Mi),B(()=>this.renderingDisabled,()=>{var n,s;return(s=(n=this.view)==null?void 0:n._stage)==null?void 0:s.renderView.setRenderParameters({terrainRenderingEnabled:!this.renderingDisabled})},ni),B(()=>this.backgroundColor,n=>{this._handleLayerViewChanges(),this._renderer.updateTileBackground(n)},Mi),B(()=>this.snapLevel,()=>this._viewChanged=!0,ni),B(()=>this.view.pointsOfInterest,n=>{this._renderer.pointsOfInterest=n,this._watchUpdatingTracking.removeAll(),n&&this._watchUpdatingTracking.add(()=>n.focus.renderLocation,()=>this._allTilesSorted=!1)}),B(()=>Wt.TERRAIN_TILE_TREE_SHOW_TILES,n=>{n&&!this._treeDebugger?j(()=>import("./TerrainTileTree3DDebugger-5baba38c.js"),["assets/TerrainTileTree3DDebugger-5baba38c.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/reactiveUtils-4dabbb80.js","assets/aaBoundingRect-193543b5.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/TileTreeDebugger-36d5c9d2.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js"]).then(({TerrainTileTree3DDebugger:s})=>{!this._treeDebugger&&Wt.TERRAIN_TILE_TREE_SHOW_TILES&&(this._treeDebugger=new s({view:this.view}))}):n||(this._treeDebugger=Oe(this._treeDebugger))},et)]),this._extentHelper=YAe(this.viewingMode,{layers:this.view.map.allLayers,layerViews:this.view.allLayerViews,viewSpatialReference:this.view.spatialReference});const e=new yw({getCollections:()=>{var n,s,a;return(a=(s=(n=this.view)==null?void 0:n.defaultsFromMap)==null?void 0:s.mapCollections)==null?void 0:a.map(({layers:o})=>o)},getChildrenFunction:n=>n&&"layers"in n?n.layers:null}),t=new Ch({layers:e,extentHelper:this._extentHelper,viewingMode:this.viewingMode,viewSpatialReference:this.view.spatialReference});this._set("tilingSchemeLogic",t),this._updateTilingScheme(),this._elevationDataRequester=this.view.resourceController.createStreamDataRequester(Uh.ELEVATION),this._mapDataRequester=this.view.resourceController.createStreamDataRequester(Uh.BASEMAP);const r=this.view.resourceController.scheduler;this._frameTask=r.registerTask(dr.TERRAIN_SURFACE,this),this._handles.add([B(()=>this._extentHelper.stencilEnabledExtents,n=>this._renderer.setStencilEnabledLayerExtents(n),et),B(()=>this.tilingSchemeLogic.tilingScheme,()=>this._updateTilingScheme(),ni),B(()=>this.extent,()=>this._updateRootTiles(),et),this.view.on("resize",()=>this._viewChangeUpdate()),B(()=>{var a,o;const n=this.view,s=n.state;return[this._lodBias,this.lodSnapping,(o=(a=n.resourceController)==null?void 0:a.memoryController)==null?void 0:o.memoryFactor,s.camera,s.contentCamera,s.fixedContentCamera]},()=>this._viewChangeUpdate(),Mi),B(()=>{var n,s;return(s=(n=this.view.qualitySettings)==null?void 0:n.tiledSurface)==null?void 0:s.textureFadeDuration},n=>this._renderer.textureFadingEnabled=n>0,et),B(()=>this._userClippingExtent,()=>this._updateClippingExtent(),ni)]),this._handles.add(this.view.allLayerViews.on("after-changes",()=>this._layerViewsDirty=!0)),this._handles.add([B(()=>{var n;return(n=this.view)==null?void 0:n.map.ground.shading},()=>{this._updateShadingIfChanged()})]),this._updateShading(),this._layerViewsDirty=!0,this._handleLayerViewChanges()}destroy(){this._frameTask.remove(),this._handles.destroy(),this._watchUpdatingTracking.destroy(),this._lercDecoder=Qi(this._lercDecoder),this._removeAllTiles(),this._upsampleMapCache=Oe(this._upsampleMapCache),this._elevationQueryCache=Oe(this._elevationQueryCache);const i=this.tilingSchemeLogic.layers;this._set("tilingSchemeLogic",Oe(this.tilingSchemeLogic)),i.destroy(),this._basemapLayerViewHandles.forEach((e,t)=>this._unregisterTiledLayerView(t)),this._elevationDataRequester=null,this._mapDataRequester=null,this._set("overlayManager",Oe(this.overlayManager)),this._tilePool=Oe(this._tilePool),K4.prune(),this._treeDebugger&&(this._treeDebugger.destroy(),this._treeDebugger=null),this._renderer=Oe(this._renderer),this._iteratorPool=Oe(this._iteratorPool),this._set("view",null),this._upsampleInfoPool=Oe(this._upsampleInfoPool),WAe(),MOe()}get renderer(){return this._renderer}get frustum(){return this._frustum}get snapLevel(){var i,e;if(this.lodSnapping===sw.ON){const t=this.view,r=this.tilingScheme,n=(e=(i=t.pointsOfInterest)==null?void 0:i.contentCameraOnSurface)==null?void 0:e.scale;if(n&&r){const s=t.state.contentCamera;let a=FP(t,s.eye,s.viewForward,s.up).tilt;a>90&&(a=180-a);const o=2*(a/90)**2,l=r.levelAtScale(n)-o;return Math.round(l)}}return null}get lodSnapping(){return this.view.qualitySettings.tiledSurface.reduceTileLevelDifferences?sw.ON:sw.OFF}get upsampleInfoPool(){return this._upsampleInfoPool}get upsampleMapCache(){return this._upsampleMapCache}get elevationQueryCache(){return this._elevationQueryCache}get mapTileRequester(){return this._mapDataRequester}get _userClippingExtent(){const{spatialReference:i}=this,{clippingArea:e}=this.view;if(C(e)||C(i))return null;const t=Nt(),r=dJ(e,t,i)?t:null,n=this._get("extent");return fg(r,n)?n:r}get rootTilesExtent(){return this._rootTilesExtent}get extent(){const i=II(this.groundExtent,this._userClippingExtent,Nt()),e=this._get("extent");return fg(i,e)?e:i}get groundExtent(){return y(this._tilingSchemeExtent)?this._tilingSchemeExtent:this._rootTilesExtent}get _tilingSchemeExtent(){var i;return(i=this.tilingSchemeLogic)==null?void 0:i.extent}get updating(){return this._hasPendingUpdates||(this._maxNumUpdating=1),!!((this.running||this._watchUpdatingTracking.updating||this._asyncWorkItems>0)&&this.ready&&!this.suspended||this.overlayManager.updating)}get running(){return(this._hasPendingUpdates||this._viewChanged||this._allTilesDirty||!this._allTilesSorted||this._layerViewsDirty||this._frameTask.updating)&&this.ready&&!this.suspended}get updatingProgressValue(){return this._maxNumUpdating=Math.max(this._pendingUpdates,this._maxNumUpdating),1-this._pendingUpdates/this._maxNumUpdating}get baseOpacity(){return this.view.map.ground.opacity}set baseOpacity(i){this.view.map.ground.opacity=i}get viewingMode(){return this.view.state.viewingMode}get ready(){return y(this.rootTiles)}set renderOrder(i){this._renderer.renderOrder=i,this._set("renderOrder",i)}get spatialReference(){var i;return((i=this.tilingScheme)==null?void 0:i.spatialReference)??null}get backgroundColor(){return this.view.map.ground.surfaceColor}set backgroundColor(i){this.view.map.ground.surfaceColor=i}set slicePlaneEnabled(i){this._renderer.slicePlaneEnabled=i,this._set("slicePlaneEnabled",i),this._evaluateTransparency(this.baseOpacity)}get tilingSchemeLocked(){var i;return((i=this.tilingSchemeLogic)==null?void 0:i.tilingSchemeLocked)??!1}set velvetOverground(i){i!==this.velvetOverground&&(this._renderer.velvetOverground=i),this._set("velvetOverground",i)}get wireframe(){return this._renderer.wireframe}set wireframe(i){i!==this._renderer.wireframe&&(this._renderer.wireframe=i,this._updateAllTileGeometries())}set _visible(i){i!==this._visibleCached&&(this._visibleCached=i,this._renderer.setVisibility(i),this.suspended=!i)}get opaque(){return this._renderer.transparency===Ts.Opaque}set suspended(i){this._set("suspended",i),this._viewChangeUpdate()}get textureFadeDuration(){return this.view.qualitySettings.tiledSurface.textureFadeDuration??0}intersect(i,e,t,r){this._renderer.intersect(i,e,t,r)}getElevation(i,e,t,r){const n=this.rootTiles;if(C(n)||!n.length||n[0].layerInfo[vt.ELEVATION].length===0)return null;const s=la;return s[0]=i,s[1]=e,s[2]=t,ss(s,r,s,this._spatialReference)?_B(n,s[0],s[1]):(ee.getLogger(this.declaredClass).error("TerrainSurface.getElevation(): could not project given point to tiling scheme coordinate system"),null)}getElevations(i,e,t){const r=this.rootTiles,n=r?r[0].layerInfo[vt.ELEVATION].length:0;if(!C(r)&&r.length&&n!==0)for(let s=0;s<e;++s){const a=3*s;t(s,_B(r,i[a+0],i[a+1]))}else for(let s=0;s<e;++s)t(s,null)}getScale(i){if(this.tilingScheme){if(!bn(i,la,this.spatialReference))return ee.getLogger(this.declaredClass).error("TerrainSurface.getScale(): could not project given point to tiling scheme coordinate system"),null;const e=this.rootTiles;if(y(e)){for(let t of e)if(t!=null&&t.containsPoint(la)){for(;!t.isLeaf&&!t.rendered;){let r=0;la[0]>t.children[0].extent[2]&&(r+=1),la[1]<t.children[0].extent[1]&&(r+=2),t=t.children[r]}return this._getLodBiasCorrectedScale(t.level)}}}return 1e100}getSphereElevationBounds(i,e,t,r,n){var c;if(la[0]=i,la[1]=e,la[2]=t,la[3]=r,!ss(la,n,la,(c=this.tilingScheme)==null?void 0:c.spatialReference))return ee.getLogger(this.declaredClass).error("TerrainSurface.getSphereElevationBounds(): could not project given point to tiling scheme coordinate system"),null;let s=1/0,a=-1/0;const o=u=>{if(u&&V5(u.extent,la))if(u.isLeaf||u.rendered)s=Math.min(s,u.elevationBounds[0]),a=Math.max(a,u.elevationBounds[1]);else for(const d of u.children)o(d)},l=this.rootTiles;if(y(l))for(const u of l)o(u);return{min:s,max:a}}getSphereScale(i,e){if(!this.tilingScheme)return null;if(!bn(i,la,this.spatialReference))return ee.getLogger(this.declaredClass).error("TerrainSurface.getSphereScale(): could not project given point to tiling scheme coordinate system"),null;la[3]=e;let t=null;const r=s=>{if(s&&V5(s.extent,la))if(s.isLeaf||s.rendered){const a=this._getLodBiasCorrectedScale(s.level);t=t==null?a:Math.min(t,a)}else for(const a of s.children)r(a)},n=this.rootTiles;if(y(n))for(const s of n)r(s);return t}queryVisibleScaleRange(i,e,t,r){const n=e?this.tilingScheme.levelAtScale(e):0,s=t?this.tilingScheme.levelAtScale(t):1/0,a=this._lodBias;this._renderer.queryVisibleLevelRange(i,n+a,s+a,r)}_evaluateTransparency(i){var n,s;const e=this._renderer.transparency,t=this._allSurfaceLayersTransparent()?Ts.Invisible:i>=1&&!this.hasCompositeBlendMode&&!this._renderer.slicePlaneEnabled?Ts.Opaque:Ts.Semitransparent,r=e!==t;return r&&(this._renderer.transparency=t,(s=(n=this.view)==null?void 0:n._stage)==null||s.renderView.setRenderParameters({terrainTransparency:this._renderer.transparency})),r}_updateBaseOpacity(i){const e=this._evaluateTransparency(i);this._updateTileTextures(e?fn.UNFADED:fn.IMMEDIATE)}_updateTilingScheme(){var e,t,r,n;const i=this.tilingSchemeLogic.tilingScheme;i!==this.tilingScheme&&($h(!!i,"tiling scheme cannot be reset to undefined"),this._isGlobal=!((t=(e=this.view)==null?void 0:e.state)!=null&&t.isLocal),this.tilingScheme&&this._removeAllTiles(),this._spatialReference=(i==null?void 0:i.spatialReference)??Zt.WebMercator,this._set("tilingScheme",i),this._updateClippingExtent(),i&&(this._updateTiledLayers(),this._renderer.setTileSize(i.pixelSize),this.overlayManager.setSpatialReference(i.spatialReference),this._updateRootTiles()),this._isWebMercator=!!((r=this.tilingScheme)!=null&&r.spatialReference.isWebMercator),this._isWebMercatorOnPlateeCarree=this._isWebMercator&&G7((n=this.view)==null?void 0:n.renderSpatialReference))}_acquireTile(i,e,t,r){const n=this._tilePool.acquire();return oS[0]=i,oS[1]=e,oS[2]=t,n.init(oS,r,this),n}get updatingRootTiles(){return this._updatingRootTiles}_updateRootTiles(){const{extent:i,tilingScheme:e}=this;if(!e)return;const t=YMe;let r=e.rootTilesInExtent(i,t,5*d0);if(y(this.rootTiles)){if(r.length>d0)return void ee.getLogger(this.declaredClass).warn(f0e);const n=this.rootTiles.map(a=>a.lij),s=Ete(n,r,gB);if(this._updatingRootTiles=!0,s.removed.length>0||s.added.length>0){const a=this.rootTiles.filter(o=>!(s.removed.findIndex(l=>gB(l,o.lij))>-1)||(this._purgeTile(o),!1));s.added.forEach(o=>a.push(this._newRootTile(o))),this._setRootTiles(a)}}else this._updatingRootTiles=!0,r.length>d0&&(ee.getLogger(this.declaredClass).warn(g0e),r=e.rootTilesInExtent(i,t,d0)),this._setRootTiles(r.map(n=>this._newRootTile(n)));fg(t,this._rootTilesExtent)||(this._rootTilesExtent=Nt(t)),this._visible=!0,this._viewChangeUpdate(),this.overlayManager.setPlacementDirty(),this.notifyChange("ready"),this._updateAllTileGeometries(),this._updatingRootTiles=!1,this.checkAllTilesWaterproofness()}_updateAllTileGeometries(){const i=this._allTiles.filter(e=>e.isLoaded&&e.intersectsClippingArea);i.forEach(e=>this._renderer.updateTileGeometryState(e)),i.forEach(e=>e.renderData.updateNeighborData()),this._updateTilesGeometries(i),this._pendingTilesToUpdate.clear()}_updateTilesGeometries(i){if(i.length===0)return;i.sort(vd);const e=this.renderer;i.forEach(t=>e.updateGeometryIfNeeded(t)),i.forEach(t=>this._pendingTilesForElevationUpdateEvent.add(t))}_shouldSplit(i){return i.shouldSplit(this._splitLimits,this._eyePosRenderSR,this.snapLevel)===Ge.SPLIT}_newRootTile(i){const e=this._acquireTile(0,i[1],i[2],null);return this._shouldSplit(e)&&e.setPendingUpdate(Ge.SPLIT),this._loadTile(e),this._markTileToUpdate(e),this._updateRootTileElevationBounds(),e}_setRootTiles(i){if(this._set("rootTiles",i),this._allTiles.clear(),y(i)){const e=this._iteratorPool.acquire();for(e.reset(i);!e.done;)this._allTiles.push(e.next());e.remove()}this._renderer.setRootTiles(this.rootTiles),this._updateTilesVisibility(i)}_runViewChangeUpdateIfDirty(){this._viewChangeUpdateDirty&&(this._viewChangeUpdateDirty=!1,this._viewChangeUpdate())}_viewChangeUpdate(){this.view&&!this.suspended&&this.tilingScheme&&this._visibleCached&&(this._inFrameTask?this._viewChangeUpdateDirty=!0:(this._viewChangeUpdateDirty=!1,this._updateViewDependentParameters(),this._updateTilesVisibility(this.rootTiles)))}_updateClippingStatus(i){i.updateClippingStatus(this.extent)&&i.resetPendingUpdate(Ge.GEOMETRY)&&this._updateTileGeometryState(i)}_updateTilesVisibility(i){if(C(i))return;const e=fOe(i),t=this.visibleElevationBounds;let r=e?t.min:1/0,n=e?t.max:-1/0;const s=this.extent,a=this._viewProjectionMatrix;this.setTileTreeDirty();const o=this._iteratorPool.acquire();for(o.reset(i);!o.done;){const l=o.next();l.updateClippingStatus(s)&&l.resetPendingUpdate(Ge.GEOMETRY)&&this._updateTileGeometryState(l),l.setPendingUpdate(Ge.RENDERDATA),l.computeVisibility(),l.updateScreenDepth(a),l.renderData&&(r=Math.min(l.elevationBounds[0],r),n=Math.max(l.elevationBounds[1],n))}o.remove(),this._viewChanged=!0,this._allTilesDirty=!0,this._batchUpdatePendingTileGeometries(),isFinite(r)&&isFinite(n)&&(t.min!==r||t.max!==n)&&(this.visibleElevationBounds=new x0(r,n))}_updateRootTileElevationBounds(){let i=1/0,e=-1/0;const t=this.rootTiles;y(t)&&t.forEach(({elevationBounds:n})=>{i=Math.min(i,n[0]),e=Math.max(e,n[1])});const r=this.rootTileElevationBounds;r.min===i&&r.max===e||(this.rootTileElevationBounds=new x0(i,e))}_updateViewDependentParameters(){const i=this.view.state.camera,e=this.view.state.contentCamera,t=Math.tan(.5*e.fovX),r=Math.tan(.5*e.fovY),n=this.tilingScheme.pixelSize,s=2**-this._lodBias*i.pixelRatio;this._splitLimits.aboveGround=i.aboveGround,this._splitLimits.fovX=t,this._splitLimits.fovY=r,this._splitLimits.relativeWidthLimit=n/i.width*this.maxTextureScale*s,this._splitLimits.relativeHeightLimit=n/i.height*this.maxTextureScale*s,this._splitLimits.maxLod=this.tilingScheme.getMaxLod(),this._splitLimits.angledSplitBias=this.view.qualitySettings.tiledSurface.angledSplitBias,this.view.state.fixedContentCamera?(C(this._splitLimits.frustum)&&(this._splitLimits.frustum=Iw()),ZE(this._splitLimits.frustum,e.frustum)):this._splitLimits.frustum=null,ZE(this._frustum,i.frustum),Hr(this._viewProjectionMatrix,e.projectionMatrix,e.viewMatrix),X(this._eyePosRenderSR,e.eye),ss(i.eye,this.view.renderSpatialReference,this._eyePosSurfaceSR,this.spatialReference)}_updateRenderData(i){i.rendered&&!i.shouldLoad&&(iee(i)?this._loadChildren(i):ZMe(i)&&this._loadParent(i))}_updateTileGeometryState(i){i.updateVisibility(),this._renderer.updateTileGeometryState(i)&&this._markTileToUpdate(i),this._usedMemory=null}_markAllTileNeighborsForGeometryUpdate(i){const e=this._pendingTilesToUpdate;i.forEachLoadedNeighbor(t=>{e.add(t)})}_updateTileTexture(i,e){const t=i.resetPendingUpdate(Ge.TEXTURE_FADING)?Ge.TEXTURE_FADING:!!i.resetPendingUpdate(Ge.TEXTURE_NOFADING)&&Ge.TEXTURE_NOFADING;t&&(this._renderer.updateTileTexture(i,t),this._usedMemory=null,e.madeProgress())}_emitElevationUpdateEventForTiles(){const i=eI.extent;Uc(i),this._pendingTilesForElevationUpdateEvent.forEach(e=>um(i,e.extent,i)),this._pendingTilesForElevationUpdateEvent.clear(),eI.spatialReference=this.spatialReference,this.emit("elevation-change",eI)}runTask(i){this._handleLayerViewChanges(i),this._frameTask.processQueue(i),this._inFrameTask=!0,this._pendingUpdates=0,this._hasPendingUpdates=!1,this._updateAllTilesStatus(i),this._sortTiles(i);const e=!this.view.state.fixedContentCamera;this._mergeAndSplit(i,e),this._updateElevation(i),this._updateTextures(i),e||this._mergeAndSplit(i,!0),this._inFrameTask=!1,this._runViewChangeUpdateIfDirty(),this._batchUpdatePendingTileGeometries(),this._emitElevationUpdateEventForTiles(),i.done?this.requestUpdate():this.getUsedMemory(),this.notifyChange("updatingProgressValue")}_updateAllTilesStatus(i){if(!this._viewChanged||!this.rootTiles||i.done)return;this._viewChanged=!1;const e=this._iteratorPool.acquire();e.reset(this.rootTiles);const t=this.snapLevel,r=this._splitLimits,n=this._eyePosRenderSR;for(;!e.done;){const s=e.next(),a=s.shouldSplit(r,n,t);if(a!==Ge.SPLIT){if(s.resetPendingUpdate(Ge.SPLIT)&&s.updateAgentSuspension(),a===Ge.VSPLITMERGE&&s.updateAgents(vt.ELEVATION),e.skipSubtree(),!s.isLeaf){s.setPendingUpdate(Ge.MERGE),s.resetPendingUpdate(Ge.SPLIT);const o=this._iteratorPool.acquire();o.resetOne(s);const l=this._viewProjectionMatrix;for(let c=o.next();!o.done;c=o.next())this._updateClippingStatus(c),c.updateVisibility(),c.updateScreenDepth(l);o.remove()}}else s.resetPendingUpdate(Ge.MERGE),s.isLeaf&&(s.setPendingUpdate(Ge.SPLIT),e.skipSubtree()),s.rendered&&s.setPendingUpdate(Ge.RENDERDATA)}e.remove(),this.requestUpdate(),(this.shortBatches||!this.oneBatchPerFrameTask)&&this._batchUpdatePendingTileGeometries(),i.madeProgress()}_sortTiles(i){i.done||this._allTilesSorted||(pOe(this._allTiles,this.view.pointsOfInterest.focus.renderLocation),this._allTilesSorted=!0,this._treeDebugger&&this._treeDebugger.update(),i.madeProgress())}_markTileToUpdate(i){fe(i.isLoaded),i.intersectsClippingArea&&(this._pendingTilesToUpdate.add(i),this._markAllTileNeighborsForGeometryUpdate(i))}_batchUpdatePendingTileGeometries(){const i=this._pendingTilesToUpdate;if(i.size===0)return;const e=Array.from(this._pendingTilesToUpdate.keys()).filter(n=>n.isLoaded&&n.intersectsClippingArea),t=(n,s)=>{!(s!=null&&s.isLoaded)||!s.intersectsClippingArea||s.level<n.level||i.has(s)||(i.add(s),e.push(s),s.renderData.updateNeighborData())};e.sort(vd);const r=e.length;for(let n=0;n<r;++n){const s=e[n];fe(s.isLoaded),fe(s.intersectsClippingArea);const a=s.renderData;a.updateNeighborData();const o=a._dirtyEdgeResolutions,l=a.geometryState.neighborData;for(let c=0;c<4;++c)if(o&1<<c){const u=s.renderData.geometryState.neighborData.edgePeerNeighbors[c];u&&(u==null?void 0:u.level)>=s.level&&u.forAllSubtreeOnSide(wR(jh[c]),d=>!(!d.isLoaded||!d.intersectsClippingArea)&&(fe(i.has(d)||vd(s,d)<0),t(s,d),!0)),t(s,l.cornerPeerNeighbors[c]),t(s,l.cornerPeerNeighbors[(c+1)%4])}}i.clear(),this._updateTilesGeometries(e),gn&&yR&&this.checkAllTilesWaterproofness()}_mergeAndSplit(i,e){if(this.suspended||i.done||!this._allTilesDirty)return;this._allTilesDirty=!1,this.requestUpdate();let t=!1,r=!1;for(;!i.done;){r=!0;let n=!1;const s=!this._allTiles.some(a=>{var l;if(!t&&!a.loadable)return i.done;let o=a;if(a.resetPendingUpdate(Ge.MERGE)){if(!e)return a.setPendingUpdate(Ge.MERGE),i.done;for(;(l=o.parent)!=null&&l.resetPendingUpdate(Ge.MERGE);)o=o.parent;this._mergeTile(o),n=!0,i.madeProgress()}else a.resetPendingUpdate(Ge.SPLIT)&&(this._splitTile(a),n=!0,i.madeProgress());return!i.done&&o===a&&a.resetPendingUpdate(Ge.RENDERDATA)&&(this._updateRenderData(a),i.madeProgress()),i.done});if(n&&(this._allTilesSorted=!1,this._allTilesDirty=!0),s){if(!t){t=!0;continue}if(!n)break}else this._allTilesDirty=!0}r||(this._allTilesDirty=!0),!this.oneBatchPerFrameTask&&this._batchUpdatePendingTileGeometries(),this._sortTiles(i)}_updateElevation(i){i.done||(this._allTiles.some(e=>(e.resetPendingUpdate(Ge.GEOMETRY)&&(this._updateTileGeometryState(e),this._updateTileTexture(e,i),this.shortBatches&&this._batchUpdatePendingTileGeometries(),i.madeProgress()),i.done)),!this.oneBatchPerFrameTask&&this._batchUpdatePendingTileGeometries())}_updateTextures(i){i.done||this._allTiles.some(e=>(this._updateTileTexture(e,i),i.done))}_updateClippingExtent(){this.spatialReference&&(this.updateTileOverlayParams(vr.UPDATE),this.overlayManager.setPlacementDirty(),this._updateRootTiles())}get _lodBias(){const i=this.view.resourceController.memoryController.memoryFactor;return this.view.qualitySettings.tiledSurface.lodBias-(1-i)*p0e}_getLodBiasCorrectedScale(i){const e=this.tilingScheme.levels,t=ue(i-this._lodBias,0,e.length-1),r=t-Math.floor(t);return e[Math.floor(t)].scale*(1-r)+e[Math.ceil(t)].scale*r}_removeAllTiles(){y(this.rootTiles)&&(this.rootTiles.forEach(i=>this._purgeTile(i)),this._setRootTiles(null),this.notifyChange("ready")),this._allTiles.clear(),this._visible=!1}_purgeDescendantTiles(i){if(i.isLeaf)return!1;let e=!1;for(let t=0;t<4;++t)e=this._purgeTile(i.children[t])||e;return i.unsetChildren(),e}_purgeTile(i){const e=this._purgeDescendantTiles(i)||i.rendered;return this._allTiles.removeUnordered(i),this._unloadTile(i),this._tilePool.release(i),e}_unloadTile(i){this._pendingTilesToUpdate.delete(i),this._pendingTilesForElevationUpdateEvent.delete(i),i.unload(this._renderer)}_splitTile(i){$h(i.isLeaf,"tile that is already split should not be split again!");const e=i.level+1,t=2*i.lij[1],r=2*i.lij[2];i.setChildren(this._createTile(e,t,r,i),this._createTile(e,t,r+1,i),this._createTile(e,t+1,r,i),this._createTile(e,t+1,r+1,i)),i.setPendingUpdate(Ge.RENDERDATA),i.updateAgentSuspension(),this._allTiles.pushArray(i.children),this._allTilesDirty=!0,++this._performanceInfo.numSplit}_emitTileScaleChange(i,e=i.level){lS.spatialReference=this.spatialReference,lS.extent=i.extent,lS.scale=this._getLodBiasCorrectedScale(e),this.emit("scale-change",lS)}_createTile(i,e,t,r){$h(!!r,"_createTile sanity check");const n=this._acquireTile(i,e,t,r);return n.updateClippingStatus(this.extent),n.updateScreenDepth(this._viewProjectionMatrix),this._shouldSplit(n)&&n.setPendingUpdate(Ge.SPLIT),n}get shortBatches(){return this.view.state.mode!==Fh.IDLE}_mergeTile(i){$h(!i.hasPendingUpdate(Ge.SPLIT),"_mergeTile sanity check"),this._purgeDescendantTiles(i)&&($h(!i.renderData,"_mergeTile sanity check"),this._loadTile(i),this._markTileToUpdate(i),this._emitTileScaleChange(i),this.shortBatches&&this._batchUpdatePendingTileGeometries()),this._allTilesDirty=!0,++this._performanceInfo.numMerged}_loadChildren(i){$h(i.rendered,"parent should be rendered"),this._unloadTile(i);const e=i.children;e.forEach(t=>this._loadTile(t)),e.forEach(t=>this._pendingTilesToUpdate.add(t)),this._markAllTileNeighborsForGeometryUpdate(i),this._emitTileScaleChange(i,i.level+1),this.shortBatches&&this._batchUpdatePendingTileGeometries()}_loadParent(i){const e=i.parent;this._unloadChildren(e),this._loadTile(e),this._markTileToUpdate(e),this._emitTileScaleChange(e,e.level),this.shortBatches&&this._batchUpdatePendingTileGeometries()}_unloadChildren(i){if(!i.isLeaf)for(let e=0;e<4;++e){const t=i.children[e];this._unloadChildren(t),this._unloadTile(t)}}_loadTile(i){i.load(),i.setPendingUpdate(Ge.RENDERDATA),this.requestUpdate(),this._allTilesDirty=!0,this.overlayManager&&this.overlayManager.hasOverlays&&this.overlayManager.setTileParameters(i)}_elevationDataArrived(i,e,t){const r=new QAe(i.lij,i.extent,t);i.dataArrived(e,vt.ELEVATION,r);const n=[i],s=i.level,a=this._iteratorPool.acquire();for(a.reset(n);!a.done;){const o=a.next();o.findElevationBoundsForLayer(e,s),o.computeElevationBounds()}s===0&&this._updateRootTileElevationBounds(),a.remove(),this._updateTilesVisibility(n)}_handleLayerViewChanges(i=LR){if(!this._layerViewsDirty)return;this._layerViewsDirty=!1;let e=!1;const t=new Set;let r=-1;for(const n of this.view.allLayerViews.items)if(t.add(n.uid),Ex(n)||P1(n))if(this._basemapLayerViewHandles.has(n.uid)&&!P1(n)){const s=this._layerClassFromLayerView(n),a=this._getLayerIdxByUID(s,n.uid);y(a)&&((a<r||C(r))&&(e=!0),r=a)}else this._registerTiledLayerView(n),n.layer.loaded&&(e=!0);this._basemapLayerViewHandles.forEach((n,s)=>{t.has(s)||(this._unregisterTiledLayerView(s),e=!0)}),e&&this._updateTiledLayers(),this._renderer.transparency=this._allSurfaceLayersTransparent()?Ts.Invisible:this._renderer.transparency,this.hasCompositeBlendMode=this._hasCompositeBlendMode(),i.madeProgress()}_allSurfaceLayersTransparent(){var e,t;let i=((t=(e=this.view.map)==null?void 0:e.ground)==null?void 0:t.opacity)===0;for(const r of this.view.allLayerViews.items)if(R$(r)&&!VG(r.layer)&&r.fullOpacity!==0)return i=!1,i;return i}_hasCompositeBlendMode(){for(const i of this.view.allLayerViews.items)if((bR(i)||P1(i))&&wOe(I$[i.layer.blendMode]))return!0;return!1}_layerClassFromLayerView(i){return E$(i)?vt.ELEVATION:vt.MAP}_registerTiledLayerView(i){const e=[];if((bR(i)||P1(i))&&e.push(B(()=>i.layer.blendMode,()=>{this.hasCompositeBlendMode=this._hasCompositeBlendMode(),this._updateTileTextures(fn.UNFADED)})),P1(i))return;const t=this._layerClassFromLayerView(i);e.push(B(()=>i.suspended,()=>this._updateTiledLayers())),e.push(B(()=>i.fullOpacity,()=>this._updateTileTextures(fn.UNFADED))),e.push(B(()=>"effectiveScaleRange"in i.layer?i.layer.effectiveScaleRange:null,()=>this._restartAllAgents(t))),i.on("data-changed",()=>{const r=this._getLayerIdxByUID(t,i.uid);y(r)&&this._invalidateLayerData(r,t)}),this._basemapLayerViewHandles.set(i.uid,e)}_unregisterTiledLayerView(i){const e=this._basemapLayerViewHandles.get(i);if(e){for(let t=0;t<e.length;t++)e[t].remove();this._basemapLayerViewHandles.delete(i)}}_updateTiledLayers(){if(!this.tilingScheme||this.view.suspended)return;const i=this.view.allLayerViews,e=[[],[]];let t=null;i.forEach(r=>{if(!r.layer||r.suspended||!Ex(r)||!r.fullExtent)return;const n=this._layerClassFromLayerView(r);if(n===vt.MAP){const s=r.displayLevelRange.maxLevel;s!==1/0&&(t===null||s>t)&&(t=s)}e[n].push(r)});for(const r of Gf){const n=this._layerViews[r],s=e[r];s.reverse();const a=s.length;let o=n.length!==a;const l=new Array(a),c=new Array(n.length);this._layerIndexByUid[r].clear();for(let u=0;u<a;u++){const d=s[u].uid;this._layerIndexByUid[r].set(d,u);const m=n.indexOf(s[u]);l[u]=m,u!==m&&(o=!0),m>-1&&(c[m]=u)}if(o){const u=this._postorderIterator;for(u.reset(this.rootTiles);!u.done;)u.next().modifyLayers(c,l,r);this._layerViews[r]=s,this._restartAllAgents(r),this._updateTilesVisibility(this.rootTiles)}}this.tilingScheme.ensureMaxLod(t)&&this._viewChangeUpdate()}_restartAllAgents(i){const e=this._postorderIterator;for(e.reset(this.rootTiles);!e.done;){const t=e.next();t.restartAgents(i),i===vt.ELEVATION&&t.computeElevationBounds()}this._updateRootTileElevationBounds()}layerViewByIndex(i,e){return this._layerViews[e][i]}numLayers(i){return this._layerViews[i].length}_updateTileTextures(i){this._allTiles.forAll(e=>{e.updateAgents(vt.MAP),i===fn.IMMEDIATE?this.renderer.updateTileTexture(e,Ge.TEXTURE_NOFADING):e.updateRenderData(vt.MAP,i)}),this._renderer.transparency=this._allSurfaceLayersTransparent()?Ts.Invisible:this._renderer.transparency}_invalidateLayerData(i,e){this._allTiles.forAll(t=>t.removeLayerAgent(i,e)),this._allTiles.forAll(t=>t.invalidateLayerData(i,e))}setTileTreeDirty(){this._allTilesDirty=!0}requestRender(i=vr.UPDATE){this.renderer.setNeedsRender(i)}requestUpdate(){++this._pendingUpdates==1&&(this._hasPendingUpdates=!0)}requestTileData(i,e,t,r){const n=this.layerViewByIndex(e,t),s=n.layer;return!s.tilemapCache||Sx(n)?this._requestTileData(i,t,n,r):(++this._asyncWorkItems,s.tilemapCache.fetchAvailability(i.lij[0],i.lij[1],i.lij[2],{...r,timeout:6e3}).then(()=>--this._asyncWorkItems).catch(a=>{throw--this._asyncWorkItems,Ti(r),yo(a)||this._dataMissing(i,t,n,{notInTilemap:!0}),a}).then(()=>this._frameTask.schedule(()=>this._requestTileData(i,t,n,r),r.signal)))}_requestTileData(i,e,t,r){return e===vt.ELEVATION?E$(t)?this._requestElevationTileData(i,t,r):Promise.reject():R$(t)?this._requestMapTileData(i,t,r):Promise.reject()}_requestElevationTileData(i,e,t){++this._asyncWorkItems;const r=a=>{if(Ec(t))return;const o=this._layerIndexByUid[vt.ELEVATION].get(e.uid);o!=null?(this._usedMemory=null,this.requestUpdate(),this._elevationDataArrived(i,o,a)):ee.getLogger(this.declaredClass).warn("TerrainSurface: received data from unknown layer %d %s",vt.ELEVATION,i.lij.toString())},n=a=>{yo(a)||(this._dataMissing(i,vt.ELEVATION,e,a),this.requestUpdate())};if(Bz(e.layer))return e.layer.fetchTile(i.lij[0],i.lij[1],i.lij[2],{noDataValue:lx,signal:t.signal}).then(a=>{if(!Ec(t))return this._frameTask.schedule(()=>r(a),t.signal,n);ee.getLogger(this.declaredClass).warnOnce("A call to fetchTile resolved even though the request was aborted. fetchTile should not resolve if options.signal.aborted is true.")},n).finally(()=>{--this._asyncWorkItems});const s=e.getTileUrl(i.lij[0],i.lij[1],i.lij[2]);return this._elevationDataRequester.request(s,"binary",t).then(a=>this._lercDecoder.decode(a,{noDataValue:lx},t.signal)).then(a=>{a?r({values:a.pixelData,width:a.width,height:a.height,noDataValue:a.noDataValue,minValue:a.minValue,maxValue:a.maxValue}):n(new Error("LERC decoding failed"))},n).finally(()=>{--this._asyncWorkItems})}_requestMapTileData(i,e,t){++this._asyncWorkItems;const r=(c,u)=>{--this._asyncWorkItems,U0(u),Ec(t)||(this._dataMissing(i,vt.MAP,e,c),this.requestUpdate())},n=c=>u=>r(u,c),s=c=>this._frameTask.schedule(()=>{--this._asyncWorkItems,this.requestUpdate(),Ec(t)?U0(c):this._mapTileDataArrived(i,e,c)},t.signal,n(c)).catch(n(c)),a=(c,u=null)=>this._frameTask.schedule(()=>r(c,u));if(Sx(e)){const c=e.schemaHelper.getLevelRowColumn(i.lij);return e.fetchTile(c[0],c[1],c[2],t).then(s,a)}if(XP(e))return e.fetchTile(i.lij[0],i.lij[1],i.lij[2],t).then(s,a);if(q4(e)&&Bz(e.layer))return e.layer.fetchTile(i.lij[0],i.lij[1],i.lij[2],t).then(c=>{if(Ec(t))return ee.getLogger(this.declaredClass).warnOnce("A call to fetchTile resolved even though the request was aborted. fetchTile should not resolve if options.signal.aborted is true."),void a(ts());s(c)},a);let o=e.getTileUrl(i.lij[0],i.lij[1],i.lij[2]);ioe(e.layer)&&e.layer.refreshTimestamp&&(o+=`${o.includes("?")?"&":"?"}_ts=${e.layer.refreshTimestamp}`);const l=e.hasMixedImageFormats?"image+type":"image";return this._mapDataRequester.request(o,l,t).then(s,a)}_mapTileDataArrived(i,e,t){const r=this._getLayerIdxByUID(vt.MAP,e.uid);y(r)?i.dataArrived(r,vt.MAP,t):(U0(t),ee.getLogger(this.declaredClass).warn("TerrainSurface: received data from unknown layer"))}_getLayerIdxByUID(i,e){return this._layerIndexByUid[i].get(e)}_dataMissing(i,e,t,r){const n=this._getLayerIdxByUID(e,t.uid);y(n)?i.dataMissing(n,e,r):ee.getLogger(this.declaredClass).warn("TerrainSurface: received data from unknown layer")}updateTileOverlayParams(i){this.rootTiles&&this.overlayManager&&(this._allTiles.forAll(e=>{e.renderData&&this.overlayManager.setTileParameters(e)}),this._renderer.setNeedsRender(i))}get performanceInfo(){const i=this._performanceInfo;return i.numNodes=this._allTiles.length,i.numLeaves=i.numVisible=i.numRendered=i.numLoadedPerLevel.length=i.numRenderedPerLevel.length=0,this._allTiles.forAll(e=>{e.isLeaf&&i.numLeaves++;const t=e.level;e.renderData&&(i.numLoadedPerLevel[t]=(i.numLoadedPerLevel[t]||0)+1),e.visible&&(i.numVisible++,e.rendered&&(i.numRenderedPerLevel[t]=(i.numRenderedPerLevel[t]||0)+1,i.numRendered++))}),i}getUsedMemory(){return this.tilingScheme?(C(this._usedMemory)&&(this._usedMemory=this._recalculateUsedMemory()),y(this._usedMemory)?this._usedMemory:0):0}_recalculateUsedMemory(){return this.tilingScheme?this._allTiles.reduce((i,e)=>i+e.usedMemory,0):null}getUsedMemoryForLayerView(i){let e=0;const t=this._layerClassFromLayerView(i),r=this._getLayerIdxByUID(t,i.uid);return y(r)&&this._allTiles.forAll(n=>e+=n.getUsedMemoryForLayer(t,r)),e}getTile(i){if(C(i)||C(this.rootTiles))return null;const e=i.split("/").map(a=>+a);if(e[0]===0)return this.rootTiles.find(a=>a.lij[1]===e[1]&&a.lij[2]===e[2]);const t=2**e[0],r=Math.floor(e[1]/t),n=Math.floor(e[2]/t);let s;if(this.rootTiles.some(a=>a.lij[1]===r&&a.lij[2]===n&&(s=a,!0)),s){let a=1<<e[0]-1;for(;s.lij[0]<e[0];){let o=e[1]&a?2:0;if((e[2]&a)>0&&o++,!s.children[o])return null;s=s.children[o],a>>=1}return $h(s.lij[0]===e[0]&&s.lij[1]===e[1]&&s.lij[2]===e[2],"not the right tile?"),s}return null}get renderPatchBorders(){return this._renderer.renderPatchBorders}set renderPatchBorders(i){this._renderer.renderPatchBorders=i}get visualizeNormals(){return this._renderer.visualizeNormals}set visualizeNormals(i){this._renderer.visualizeNormals=i}get renderingDisabled(){return this._renderer.renderingDisabled}set renderingDisabled(i){this._renderer.renderingDisabled=i}get test(){const i=this;return{renderer:i._renderer,lercDecoder:i._lercDecoder,forceReload:()=>{y(i.rootTiles)&&(i._mergeTile(i.rootTiles[0]),i._viewChangeUpdate())},getTiles:()=>i._allTiles.toArray(),getRenderedTiles(){JM.clear(),i._allTiles.forAll(t=>{t.visible&&t.rendered&&JM.push(t)});const e=JM.toArray();return TJ(i.renderOrder,e),e},lockTilingScheme(e,t){i._extentHelper.defaultTiledLayersExtent=t,i.tilingSchemeLogic.test.lockTilingScheme(e)}}}checkAllTilesWaterproofness(){if(!yR)return;const i=this.rootTiles;if(C(i))return;const e=s=>{var a,o,l;return((l=(o=(a=s==null?void 0:s.renderData)==null?void 0:a.geometryInfo)==null?void 0:o.indices)==null?void 0:l.length)>0},t=(s,a)=>{e(s)&&console.error("Tile[",s.lij,"] has geometry although parent[",a.lij,"] has geom")},r=s=>{var a,o;if(s.intersectsClippingArea)if(s.renderData&&!s.renderData.geometryState&&console.error("Tile[",s.lij,"] has renderData but not geometryState"),s.renderData&&!s.renderData.geometryInfo&&console.error("Tile[",s.lij,"] has renderData but not geometryInfo"),!((a=s.renderData)!=null&&a.geometryInfo)||(((o=s.renderData.geometryInfo.indices)==null?void 0:o.length)??0)>0||console.error("Tile[",s.lij,"] has renderData but no indices - geometryInfo: ",s.renderData.geometryInfo),e(s)){s.checkGeometryWaterproofness();for(const l of s.children)t(l,s)}else if(s.isLeaf)console.error("Tile[",s.lij,"] has no geometry and no children, from root to leaf");else for(const l of s.children)r(l)},n=s=>{var c;const a=((c=s.parent)==null?void 0:c.visible)??!0,o=s.visible;s.computeVisibility();const l=s.visible;if(o!==l&&a&&console.error(" Tile[",s.lij,"] has out of date visibility: ",o," instead of ",l),!s.isLeaf)for(const u of s.children)n(u)};for(const s of i)r(s),n(s)}get isGlobal(){return this._isGlobal}get shading(){return this._shading}_updateShadingIfChanged(){var e,t,r;((r=(t=(e=this.view)==null?void 0:e.map)==null?void 0:t.ground)==null?void 0:r.shading)!==this._shading&&this._updateShading()}_updateShading(){var e,t,r;const i=(r=(t=(e=this.view)==null?void 0:e.map)==null?void 0:t.ground)==null?void 0:r.shading;this._shading=i,this.renderer&&(this.renderer.shading=i,this.renderer.setNeedsRender()),this._updateAllTileGeometries()}get isWebMercator(){return this._isWebMercator}get isWebMercatorOnPlateeCarree(){return this._isWebMercatorOnPlateeCarree}isEastEndWrap(i){return this.isGlobal&&i[2]===this.lijEastEnd(i[0])-1}isWestEndWrap(i){return this.isGlobal&&i[2]===0}lijEastEnd(i){return 2**(i+(y(this.spatialReference)&&this.spatialReference.isGeographic?1:0))}wrapEastWest(i){const e=this.lijEastEnd(i[0]),t=i[2];if(0<=t&&t<e)return i;if(!this.isGlobal)return null;const r=(t+(t<0?e:0))%e;return[i[0],i[1],r]}enableInternalChecks(i){oAe(i)}enableWaterproofnessChecks(i){aAe(i)}};h([p()],mt.prototype,"_renderer",void 0),h([p()],mt.prototype,"_hasPendingUpdates",void 0),h([p()],mt.prototype,"_asyncWorkItems",void 0),h([p()],mt.prototype,"_allTilesDirty",void 0),h([p()],mt.prototype,"_allTilesSorted",void 0),h([p()],mt.prototype,"_viewChanged",void 0),h([p({readOnly:!0})],mt.prototype,"_watchUpdatingTracking",void 0),h([p()],mt.prototype,"_frameTask",void 0),h([p({readOnly:!0})],mt.prototype,"snapLevel",null),h([p({readOnly:!0})],mt.prototype,"lodSnapping",null),h([p({constructOnly:!0})],mt.prototype,"view",void 0),h([p()],mt.prototype,"_userClippingExtent",null),h([p()],mt.prototype,"_rootTilesExtent",void 0),h([p({readOnly:!0})],mt.prototype,"extent",null),h([p({readOnly:!0})],mt.prototype,"groundExtent",null),h([p({readOnly:!0})],mt.prototype,"_tilingSchemeExtent",null),h([p({readOnly:!0})],mt.prototype,"updating",null),h([p({readOnly:!0})],mt.prototype,"running",null),h([p(XAe)],mt.prototype,"updatingProgress",void 0),h([p({readOnly:!0})],mt.prototype,"updatingProgressValue",null),h([p()],mt.prototype,"_maxNumUpdating",void 0),h([p()],mt.prototype,"baseOpacity",null),h([p()],mt.prototype,"hasCompositeBlendMode",void 0),h([p({readOnly:!0})],mt.prototype,"overlayManager",void 0),h([p({readOnly:!0})],mt.prototype,"viewingMode",null),h([p()],mt.prototype,"maxTextureScale",void 0),h([p({readOnly:!0})],mt.prototype,"ready",null),h([p({value:Px.FRONT_TO_BACK})],mt.prototype,"renderOrder",null),h([p({readOnly:!0})],mt.prototype,"rootTiles",void 0),h([p({readOnly:!0})],mt.prototype,"spatialReference",null),h([p({type:ti})],mt.prototype,"backgroundColor",null),h([p({value:!1})],mt.prototype,"slicePlaneEnabled",null),h([p({readOnly:!0})],mt.prototype,"tilingScheme",void 0),h([p({readOnly:!0})],mt.prototype,"tilingSchemeLocked",null),h([p({readOnly:!0})],mt.prototype,"tilingSchemeLogic",void 0),h([p({value:!0})],mt.prototype,"velvetOverground",null),h([p()],mt.prototype,"wireframe",null),h([p({value:!1})],mt.prototype,"suspended",null),h([p()],mt.prototype,"textureFadeDuration",null),h([p()],mt.prototype,"visibleElevationBounds",void 0),h([p()],mt.prototype,"rootTileElevationBounds",void 0),h([p()],mt.prototype,"_layerViewsDirty",void 0),h([p()],mt.prototype,"renderPatchBorders",null),h([p()],mt.prototype,"visualizeNormals",null),h([p()],mt.prototype,"renderingDisabled",null),mt=h([F("esri.views.3d.terrain.TerrainSurface")],mt);const QMe=mt;function gB(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]}function iee(i){return!i.isLeaf&&(i.children.some(e=>e.shouldLoad)||i.children.some(e=>iee(e)))}function ZMe(i){return i.isLeaf&&i.parent&&i.parent.shouldLoad}const la=yi(),YMe=Nt(),oS=[0,0,0],JM=new Yt,eI={spatialReference:null,extent:Nt(),context:"ground"},lS={spatialReference:null,extent:null,scale:0};function _B(i,e,t){var r;for(const n of i){if(!n.containsPointXY(e,t))continue;let s=n;for(;s&&!s.renderData;){const o=(e>s.extentMidX?1:0)+(t<s.extentMidY?2:0);s=s.children[o]}const a=((r=s==null?void 0:s.renderData)==null?void 0:r.geometryState.samplerData)??null;return Ei(e,t,a)}return null}let KMe=class{constructor(e,t){this.geometryRecord=e,this.renderGeometry=t}},JMe=class{constructor(e,t,r){this.operation=e,this.geometryRecord=t,this.states=r}},xb=class extends pe{constructor(e){super(e),this._residentGeomRecords=new Map,this._dirtyGeomRecords=new Map,this.dirty=!1}commit(e){this.dirty=!1,this._dirtyGeomRecords.forEach((t,r)=>this.commitLayer(r,e))}commitLayer(e,t){const r=this._dirtyGeomRecords.get(e);r&&(r.forEach((n,s)=>{const a=this._ensureGeomRecord(e,s);n.forEach(({geometryRecord:o,operation:l,states:c},u)=>{let d=!1;if(l===Fi.UPDATE){const m=a.get(u);if(m){const f=m.renderGeometry;if(c&Ur.TRANSFORMATION){const _=this.model.getObject(s);this.model.updateRenderGeometryTransformation(_,o,f)&&(d=!0)}d||t.updates.push({renderGeometry:f,updateType:c})}else ct(!1,"ModelDirtySet.getAddRemoveListFilteredByLayers: invalid update")}if(l===Fi.REMOVE||d){const m=a.get(u);m?(t.removes.push(m.renderGeometry),a.delete(u),m.geometryRecord.disposed&&Wg.pool.release(m.geometryRecord)):l===Fi.REMOVE&&ct(!1,"ModelDirtySet.getAddRemoveListFilteredByLayers: invalid remove")}if(l===Fi.ADD||d){const m=this.model.getObject(s);if(y(m)){const f=this.model.getRenderGeometry(m,o),_=new KMe(o,f);t.adds.push(f),a.set(u,_)}}}),a.size===0&&this._residentGeomRecords.get(e).delete(s)}),this._residentGeomRecords.get(e).size===0&&this._residentGeomRecords.delete(e),this._dirtyGeomRecords.delete(e))}getResidentRenderGeometries(e,t){const r=this._residentGeomRecords.get(e);r&&r.forEach(n=>n.forEach(s=>t.push(s.renderGeometry)))}_objectStateChanged(e,t){for(const r of t.geometryRecords)this._updateOrCreateDirtyRecord(t,r,null,Fi.UPDATE,e)}visibilityChanged(e){this._objectStateChanged(Ur.VISIBILITIES,e)}highlightChanged(e){this._objectStateChanged(Ur.HIGHLIGHTS,e)}occlusionChanged(e){this._objectStateChanged(Ur.OCCLUDEES,e)}vertexAttrsUpdated(e){this._updateOrCreateDirtyRecord(e.object,e.record,null,Fi.UPDATE,Ur.VERTEXATTRS)}layerAdded(e){e.objects.forAll(t=>this._layerObjectAdded(e,t))}layerRemoved(e){e.objects.forAll(t=>this._layerObjectRemoved(e,t))}layerObjectAdded(e){this._layerObjectAdded(e.layer,e.object)}_layerObjectAdded(e,t){const r=e.id;for(const n of t.geometryRecords)this._objectGeometryAdded(t,n,r)}layerObjectRemoved(e){this._layerObjectRemoved(e.layer,e.object)}layerObjectsAdded(e){for(const t of e.objects)this._layerObjectAdded(e.layer,t)}layerObjectsRemoved(e){for(const t of e.objects)this._layerObjectRemoved(e.layer,t)}_layerObjectRemoved(e,t){const r=e.id;for(const n of t.geometryRecords)this._objectGeometryRemoved(t,n,r)}shaderTransformationChanged(e){const t=this._residentGeomRecords.get(e.id);t&&t.forEach((r,n)=>{const s=this.model.getObject(n);s&&s.hasVolativeTransformation()&&r.forEach(a=>{a.renderGeometry.shaderTransformationChanged()})})}objectTransformation(e){const t=this._getParentLayerId(e),r=e.id;this._ensureGeomRecord(t,r).forEach(n=>{this._updateOrCreateDirtyRecord(e,n.geometryRecord,t,Fi.UPDATE,Ur.TRANSFORMATION)})}objectGeometryAdded(e){this._objectGeometryAdded(e.object,e.record)}_objectGeometryAdded(e,t,r=null){this._updateOrCreateDirtyRecord(e,t,r,Fi.ADD)}objectGeometryRemoved(e){this._objectGeometryRemoved(e.object,e.record)}_objectGeometryRemoved(e,t,r=null){this._updateOrCreateDirtyRecord(e,t,r,Fi.REMOVE)}_updateOrCreateDirtyRecord(e,t,r,n,s=Ur.NONE){r=Ke(r,this._getParentLayerId(e));const a=e.id,o=t.id,l=this._ensureDirtyRecord(r,a),c=l.get(o);if(c){const u=c.operation;u===Fi.REMOVE&&n===Fi.ADD&&c.states!==Ur.NONE?c.operation=Fi.UPDATE:u===Fi.REMOVE&&n===Fi.ADD||u===Fi.ADD&&n===Fi.REMOVE?(l.delete(o),c.geometryRecord.disposed&&Wg.pool.release(c.geometryRecord)):u!==Fi.UPDATE||n!==Fi.REMOVE&&n!==Fi.UPDATE?(ct((u===Fi.REMOVE||u===Fi.ADD)&&n===Fi.UPDATE,"ModelDirtySet.objectGeometryAdded: inconsistent state"),c.states|=s):(c.operation=n,c.states|=s)}else l.set(o,new JMe(n,t,s));this.dirty=this._hasDirtyGeometryRecords}_ensureGeomRecord(e,t){let r=this._residentGeomRecords.get(e);r||(r=new Map,this._residentGeomRecords.set(e,r));let n=r.get(t);return n||(n=new Map,r.set(t,n)),n}get _hasDirtyGeometryRecords(){return Er(this._dirtyGeomRecords,e=>Er(e,t=>t&&t.size>0))}_ensureDirtyRecord(e,t){let r=this._dirtyGeomRecords.get(e);r||(r=new Map,this._dirtyGeomRecords.set(e,r));let n=r.get(t);return n||(n=new Map,r.set(t,n)),n}_getParentLayerId(e){return y(e.parentLayer)?e.parentLayer.id:pte}formatDebugInfo(){const e=["ADD","UPD",void 0,"REM"];let t="";return this._dirtyGeomRecords.forEach((r,n)=>{r.forEach((s,a)=>{t.length>0&&(t+=`
`),t+=n+"."+a;const o=[];s.forEach(l=>{const c=l.operation;o[c]||(o[c]=[]),o[c].push(l.geometryRecord.geometry.id)});for(let l=0;l<o.length;l++)if(o[l]){t+=" "+e[l-1]+": ";for(let c=0;c<o[l].length;c++)t+=o[l][c]+", "}})}),t}get test(){const e=this;return{get residentLayerCount(){return e._residentGeomRecords.size},get residentObjectCount(){return Array.from(e._residentGeomRecords.values()).reduce((t,r)=>t+r.size,0)}}}};h([p({constructOnly:!0})],xb.prototype,"model",void 0),h([p()],xb.prototype,"dirty",void 0),xb=h([F("esri.views.3d.webgl-engine.lib.ModelDirtySet")],xb);const eIe=xb;let CE=class extends pe{constructor(){super(...arguments),this.dirtySet=new eIe({model:this}),this._content=new Map,this._originFactory=new M4(null)}getObject(e){return this._content.get(e)}add(e){const t=e.id;ct(!this._content.has(t),"Model/Stage already contains object to be added"),this._content.set(t,e),uR(e)&&this.dirtySet.layerAdded(e)}remove(e){ct(this._content.has(e.id),"Model/Stage doesn't contain object to be removed"),this._content.delete(e.id),e.unload(),uR(e)&&this.dirtySet.layerRemoved(e)}addMany(e){for(const t of e)y(t)&&(ct(!this._content.has(t.id),"Model/Stage already contains object to be added"),this._content.set(t.id,t))}removeMany(e){for(const t of e)ct(this._content.has(t.id),"Model/Stage doesn't contain object to be removed"),this._content.delete(t.id),t.unload()}has(e){return this._content.has(e.id)}forEachOfType(e,t){this._content.forEach(r=>{r.type===e&&t(r)})}getRenderGeometry(e,t){const{geometry:r,material:n,id:s,shaderTransformation:a,origin:o,instanceParameters:l}=t,c=new pv(r,n,{id:s,boundingInfo:r.boundingInfo,calculateShaderTransformation:a,castShadow:e.castShadow});return c.updateTransformation(u=>e.getCombinedStaticTransformation(t,u)),c.origin=y(o)?o:this._originFactory.getOrigin(c.boundingSphere),c.instanceParameters=l,c}updateRenderGeometryTransformation(e,t,r){if(C(e))return!1;r.updateTransformation(s=>e.getCombinedStaticTransformation(t,s));const n=this._originFactory.getOrigin(r.boundingSphere);return r.origin!==n}getStats(){const e={},t=Array.from(this._content.values());for(let r=0;r<vv.COUNT;++r)e[r]=t.filter(n=>n.type===r).length;return{contentTypes:e,dirtySet:this.dirtySet.formatDebugInfo()}}get test(){return{content:Array.from(this._content.values())}}};h([p({constructOnly:!0})],CE.prototype,"dirtySet",void 0),CE=h([F("esri.views.3d.webgl-engine.parts.Model")],CE);let tIe=class{constructor(e){this._totalCount=e,this._indexRanges=[0,e]}allVisible(){return this.componentCount()===this._totalCount}allInvisible(){return this._indexRanges.length===0}componentCount(){const e=this._indexRanges;let t=0;for(let r=0;r<e.length;r+=2)t+=e[r+1];return t}reset(e){e==="all"||e.length===this._totalCount?this._indexRanges=[0,this._totalCount]:this._indexRanges=iIe(e)}forEachComponent(e){const t=this._indexRanges;for(let r=0;r<t.length;r+=2){const n=t[r],s=n+t[r+1];for(let a=n;a<s;a++)if(!e(a))return!1}return!0}forEachComponentRange(e){const t=this._indexRanges;for(let r=0;r<t.length;r+=2){const n=t[r];if(!e(n,n+t[r+1]))return!1}return!0}computeOffsetRanges(e){const t=new Array(this._indexRanges.length),r=this._indexRanges;for(let n=0;n<r.length;n+=2){const s=r[n],a=s+r[n+1],o=e[s],l=e[a];t[n]=o,t[n+1]=l-o}return t}};function iIe(i){const e=new Array;if(i.length===0)return e;let t=i[0],r=1;for(let n=1;n<i.length;n++){const s=i[n];t+r===s?r+=1:(e.push(t),e.push(r),t=s,r=1)}return e.push(t),e.push(r),e}let rIe=class extends GP{constructor(e,t){super(),this.pickability=null,this.highlightCounts=null,this.verticalOffsets=null,this.cachedGeometryRanges=null,this.cachedHighlightRanges=null,this.cachedDefaultRanges=null,this.offsets=N7(t);const r=this.count;this.visibility=new tIe(r),this.materialDataBuffer=e.getBuffer(r),this.materialDataIndices=new Uint16Array(r);for(let n=0;n<r;n++)this.materialDataIndices[n]=this.materialDataBuffer.acquireIndex()}dispose(){super.dispose();for(let e=0;e<this.count;e++)this.materialDataBuffer.releaseIndex(this.materialDataIndices[e])}get count(){return this.offsets.length-1}get geometryRanges(){return C(this.cachedGeometryRanges)&&(this.cachedGeometryRanges=this.visibility.computeOffsetRanges(this.offsets)),this.cachedGeometryRanges}get highlightRanges(){return C(this.highlightCounts)?null:(this._updateCachedHighlightRanges(),this.cachedHighlightRanges)}get defaultShadowMapRanges(){return C(this.highlightCounts)?this.geometryRanges:(this._updateCachedHighlightRanges(),this.cachedDefaultRanges)}highlightsDirty(){this.cachedHighlightRanges=null,this.cachedDefaultRanges=null}visibilityDirty(){this.cachedGeometryRanges=null,this.highlightsDirty()}_updateCachedHighlightRanges(){if((C(this.cachedHighlightRanges)||C(this.cachedDefaultRanges))&&y(this.highlightCounts)){const{highlightRanges:e,defaultRanges:t}=nIe(this.highlightCounts,this.visibility,this.offsets);this.cachedHighlightRanges=e,this.cachedDefaultRanges=t}}};function nIe(i,e,t){const r=[],n=[];let s=t.length,a=t.length;return e.forEachComponent(o=>(i[o]>0?(s!==o-1&&(r.length&&r.push(t[s+1]-r[r.length-1]),r.push(t[o])),s=o):(a!==o-1&&(n.length&&n.push(t[a+1]-n[n.length-1]),n.push(t[o])),a=o),!0)),r.length&&r.push(t[s+1]-r[r.length-1]),n.length&&n.push(t[a+1]-n[n.length-1]),{highlightRanges:r,defaultRanges:n}}let N$=class extends GP{constructor(){super(...arguments),this.visible=B0.Hidden}};var B0;h([Yn()],N$.prototype,"renderable",void 0),h([Yn()],N$.prototype,"components",void 0),function(i){i[i.Hidden=0]="Hidden",i[i.Visible=1]="Visible"}(B0||(B0={}));function sIe(i,e,t,r){if(t>=e)return i;i==null&&(i=aIe());const n=i.isVisibleBit;let s=i.data;const a=nee(s),o=t/a|0,l=t-a*o,c=(e-1)/a|0,u=s,d=r===n;if(!(t<u.length*a)&&d){const f=o+1,_=Math.ceil(u.length*1.5),g=c+1;let w=Math.max(f,_);w=Math.min(w,g),s=new Uint32Array(w),s.set(u)}return o<s.length&&(s[o]=lIe(s[o],l,d)),i.data=s,i}function ree(i,e){if(i==null)return!0;const{isVisibleBit:t,data:r}=i,n=nee(r);return e<r.length*n?oIe(t,r,e,n):!i.isVisibleBit}function aIe(i=!0){return{isVisibleBit:!i,data:new Uint32Array(0)}}function oIe(i,e,t,r){const n=t/r|0,s=t-n*r;return cIe(e[n],s)===i}function nee(i){return i.BYTES_PER_ELEMENT*8}function lIe(i,e,t){return i&~(1<<e)|(t?1:0)<<e}function cIe(i,e){return(i&1<<e)!=0}let hIe=class{constructor(e,t){this._indices=y(e.indices)?e.indices:KD(e.positions.length/3),this._positions=new Fm(e.positions),this._components=t,this._componentIntersectionData=new Array(t.count)}getComponentAabb(e,t){if(y(this._perComponentAabbs)){for(let r=0;r<6;r++)t[r]=this._perComponentAabbs[6*e+r];return t}return this._computePerComponentAabbs(),this.getComponentAabb(e,t)}getComponentPositions(e,t){t.indices=this._indices,t.data=this._positions.typedBuffer,t.stride=this._positions.typedBufferStride,t.startIndex=this._components.offsets[e],t.endIndex=this._components.offsets[e+1]}intersect(e,t,r,n,s,a,o){const l={data:this._positions.typedBuffer,stride:this._positions.typedBufferStride,size:3},c=this._indices,u=this._components.offsets,d=Wne(e,t,uIe),m=e[2],f=t[2];this._components.visibility.forEachComponent(_=>{if(!ree(this._components.pickability,_))return!0;const g=this.getComponentAabb(_,dIe);if(y(a)){const T=a[_];y(s)?s.componentOffset=T:(e[2]=m-T,t[2]=f-T)}if(y(s)&&s.applyToAabb(g),!JG(g,e,d,r))return!0;const w=u[_]/3,v=u[_+1]/3,b=(T,R,E)=>{o(_,T,Nl(R,R,n),E)},x=v-w;return C(s)&&x>eee?(this._componentIntersectionData[_]==null&&(this._componentIntersectionData[_]=new n5(this._indices,w,v,l)),this._componentIntersectionData[_].intersectRay({r0:e,r1:t},b)):GD(e,t,w,v,c,l,void 0,s,b),!0})}_computePerComponentAabbs(){const e=this._components.count;this._perComponentAabbs=new Float32Array(6*e);const t=this._indices,r=this._positions.typedBuffer,n=this._positions.typedBufferStride,s=this._components.offsets;let a=0;for(let o=0;o<e;o++){const l=s[o],c=s[o+1];let u=1/0,d=1/0,m=1/0,f=-1/0,_=-1/0,g=-1/0;for(let w=l;w<c;w++){const v=t[w]*n,b=r[v],x=r[v+1],T=r[v+2];u=Math.min(u,b),d=Math.min(d,x),m=Math.min(m,T),f=Math.max(f,b),_=Math.max(_,x),g=Math.max(g,T)}this._perComponentAabbs[a++]=u,this._perComponentAabbs[a++]=d,this._perComponentAabbs[a++]=m,this._perComponentAabbs[a++]=f,this._perComponentAabbs[a++]=_,this._perComponentAabbs[a++]=g}}get positions(){return this._positions}get indices(){return this._indices}};const uIe=P(),dIe=Ms();let pIe=class{constructor(e,t,r){this.material=e,this.geometry=t,this.meta=r}dispose(){this.material.dispose(),this.geometry.dispose()}},see=class extends GP{constructor(e,t,r,n){super(),this.primitiveType=t,this.parameters=r,this.indexed=n,this.vao=e}};h([Yn()],see.prototype,"vao",void 0);function mIe(i,e){return{near:i,far:e}}function oT(i){return i?Ax(i,1/0,-1/0):mIe(1/0,-1/0)}function Ax(i,e,t){return i.near=e,i.far=t,i}function fv(i,e,t=i){return t.near=Math.min(i.near,e.near),t.far=Math.max(i.far,e.far),t}function cS(i,e){return i.near<=e&&e<=i.far}const k$={near:0,far:0};function fIe(i,e){const t=oT(),{eye:r,frustum:n,viewForward:s}=i;e.forAll(a=>{const o=y(a.offsetObb)?a.offsetObb:a.obb,l=_e(tl($o,o.center,r),s),c=hae(o,s);if(cS(t,l-c)&&cS(t,l+c))return;const u=bIe(o,n);if(u===-1)return;if(u===0)return Ou.far=l+c,Ou.near=l-c,void fv(t,Ou);const d=hS.pushNew();d.near=l-c,d.far=l+c,d.mask=u,d.object=a});for(let a=0;a<hS.length;a++){const o=hS.data[a];if(cS(t,o.near)&&cS(t,o.far))continue;Ou.far=o.far,Ou.near=1/0,vIe(y(o.object.offsetObb)?o.object.offsetObb:o.object.obb,r,gIe,c=>{let u=_Ie;for(let d=0;d<aee&&c.length>0;d++){if(!(o.mask&1<<d))continue;yIe(n[d],c,u);const m=c;c=u,u=m}for(let d=0;d<c.length;d+=3){Y(ya,c.data[d+0],c.data[d+1],c.data[d+2]);const m=_e(tl(ya,ya,r),s);Ou.near=Math.min(Ou.near,m)}})===0&&(Ou.near=0),fv(t,Ou)}return hS.length=0,t}const hS=new Yt({allocator:i=>i||{near:1/0,far:-1/0,mask:0,object:null},deallocator:i=>(i.object=mI(i.object),i)}),Ou=oT(),ya=P(),Sf=P(),gIe=new Yt({deallocator:null}),_Ie=new Yt({deallocator:null});function yIe(i,e,t){t.length=0;const r=e.length-3;tI(ya,e,r);const n=tr(i,ya);n<=0&&(t.push(ya[0]),t.push(ya[1]),t.push(ya[2]));let s=0,a=n;for(;s<r;s+=3){tI(Sf,e,s);const o=tr(i,Sf);a*o<0&&(Bn(ya,Sf,ya,o/(o-a)),va(t,ya)),o<=0&&va(t,Sf),a=o,X(ya,Sf)}a*n<0&&(tI(Sf,e,r),Bn(ya,Sf,ya,n/(n-a)),va(t,ya))}function tI(i,e,t){return Y(i,e.data[t+0],e.data[t+1],e.data[t+2])}function va(i,e){i.push(e[0]),i.push(e[1]),i.push(e[2])}function vIe(i,e,t,r){Xse(vB,i.quaternion),tl($o,e,i.center),Ere($o,$o,vB);const n=8*(($o[0]<-i.halfSize[0]?-1:$o[0]>i.halfSize[0]?1:0)+3*($o[1]<-i.halfSize[1]?-1:$o[1]>i.halfSize[1]?1:0)+9*($o[2]<-i.halfSize[2]?-1:$o[2]>i.halfSize[2]?1:0)+13),s=yB[n];if(s===0)return s;vre(uS,i.quaternion),bG(uS,uS,i.halfSize);const a=(o,l)=>{const c=yB[n+l+1];return Y(o,((1&c)<<1)-1,(2&c)-1,((4&c)>>1)-1),Nl(o,o,uS),ce(o,i.center,o)};return t.length=0,va(t,a(iI,0)),va(t,a(bB,1)),va(t,a($o,2)),va(t,a(wB,3)),r(t),s===1||(t.length=0,va(t,iI),va(t,wB),va(t,a($o,4)),va(t,a(xB,5)),r(t),s===2||(t.length=0,va(t,iI),va(t,xB),va(t,a($o,6)),va(t,bB),r(t))),s}const yB=(()=>{const i=new Int8Array(216);let e=0;const t=r=>{for(let n=0;n<r.length;n++)i[e+n]=r[n];e+=8};return t([3,0,6,2,3,1,5,4]),t([2,0,2,3,1,5,4,0]),t([3,1,0,2,3,7,5,4]),t([2,0,1,3,2,6,4,0]),t([1,0,1,3,2,0,0,0]),t([2,1,5,7,3,2,0,0]),t([3,2,0,1,3,7,6,4]),t([2,2,0,1,3,7,6,0]),t([3,3,0,1,5,7,6,2]),t([2,0,1,5,4,6,2,0]),t([1,0,1,5,4,0,0,0]),t([2,1,3,7,5,4,0,0]),t([1,0,2,6,4,0,0,0]),t([0,0,0,0,0,0,0,0]),t([1,1,3,7,5,0,0,0]),t([2,2,3,7,6,4,0,0]),t([1,2,3,7,6,0,0,0]),t([2,3,1,5,7,6,2,0]),t([3,4,0,1,5,7,6,2]),t([2,5,7,6,4,0,1,0]),t([3,5,0,1,3,7,6,4]),t([2,4,5,7,6,2,0,0]),t([1,4,5,7,6,0,0,0]),t([2,5,1,3,7,6,4,0]),t([3,6,0,2,3,7,5,4]),t([2,6,2,3,7,5,4,0]),t([3,7,6,2,3,1,5,4]),i})(),aee=4;function bIe(i,e){let t=0;for(let r=0;r<aee;r++){const n=uae(i,e[r]);if(n>0)return-1;n===0&&(t|=1<<r)}return t}const uS=Or(),vB=Qse(),$o=P(),iI=P(),bB=P(),wB=P(),xB=P();let wIe=class{constructor(e){this._objects=e}submit(e,t){this._objects.preSubmit(t),this._objects.visibleObjects.forAll(r=>r.renderable.material.submit(e,t,r))}queryShadowCasterDepthRange(e){return this._objects.visibleObjects.length?fIe(e,this._objects.visibleObjects):null}};function xIe(i){const e=sn().vec3f(S.POSITION);return i.normals&&e.vec2i16(S.NORMALCOMPRESSED,{glNormalized:!0}),i.textureCoordinates===Im.Default?e.vec2f(S.UV0):i.textureCoordinates===Im.Atlas&&(e.vec2f(S.UV0),e.vec4u16(S.UVREGION,{glNormalized:!0})),i.colors&&e.vec4u8(S.COLOR,{glNormalized:!0}),e.alignTo(4)}let TIe=class extends t_{constructor(e,t){super(e,"int",UD.Draw,(r,n,s)=>r.setUniform1i(e,t(n,s)))}};var Jh;(function(i){i[i.Uniform=0]="Uniform",i[i.Varying=1]="Varying",i[i.COUNT=2]="COUNT"})(Jh||(Jh={}));const s5=429496.7296;function oee(i,e){qI(i/s5*.5+.5,e)}function CIe(i,e){switch(e.componentData){case Jh.Varying:return SIe(i,e);case Jh.Uniform:return EIe(i);case Jh.COUNT:return;default:Ra(e.componentData)}}function SIe(i,e){const{vertex:t,fragment:r}=i;t.include(i_),t.uniforms.add(qR("componentColorTex",s=>s.componentParameters.texture.texture,e.hasWebGL2Context?il.None:il.Size)),i.attributes.add(S.COMPONENTINDEX,"float"),i.varyings.add("vExternalColorMixMode","mediump float"),i.varyings.add("vExternalColor","vec4");const n=e.output===V.ObjectAndLayerIdColor;n&&i.varyings.add("vObjectAndLayerIdColor","vec4"),i.include(Pae),t.constants.add("elevationScale","float",2*s5),t.constants.add("stride","float",Ot("enable-feature:objectAndLayerId-rendering")?3:2),t.code.add(A`
  vec2 getComponentTextureCoordinates(float componentIndex, float typeOffset) {
    vec2 textureSize = ${Hx(e,"componentColorTex")};

    float index = componentIndex * stride + typeOffset;
    float coordX = mod(index, textureSize.x);
    float coordY = floor(index / textureSize.x);

    return vec2(coordX, coordY) + 0.5;
  }
  `),t.code.add(A`
  vec4 _readComponentColor() {
    vec2 textureCoordinates = getComponentTextureCoordinates(componentIndex, 0.0);

    return ${Ko(e,"componentColorTex","textureCoordinates","1.0 / componentColorTexSize")};
   }

   float readElevationOffset() {
    vec2 textureCoordinates = getComponentTextureCoordinates(componentIndex, 1.0);

    vec4 encodedElevation = ${Ko(e,"componentColorTex","textureCoordinates","1.0 / componentColorTexSize")};
    return (rgba2float(encodedElevation) - 0.5) * elevationScale;
  }

  ${n?A`
          void forwardObjectAndLayerIdColor() {
            vec2 textureCoordinates = getComponentTextureCoordinates(componentIndex, 2.0);

            vObjectAndLayerIdColor = ${Ko(e,"componentColorTex","textureCoordinates","1.0 / componentColorTexSize")};
          }`:A`void forwardObjectAndLayerIdColor() {}`}

  vec4 forwardExternalColor(out bool castShadows) {
    vec4 componentColor = _readComponentColor() * 255.0;

    float shadowFlag = mod(componentColor.b * 255.0, 2.0);
    componentColor.b -= shadowFlag;
    castShadows = shadowFlag >= 1.0;

    int decodedColorMixMode;
    vExternalColor = decodeSymbolColor(componentColor, decodedColorMixMode) * 0.003921568627451; // = 1/255;
    vExternalColorMixMode = float(decodedColorMixMode) + 0.5; // add 0.5 to avoid interpolation artifacts

    return vExternalColor;
  }
`),r.code.add(A`
  void readExternalColor(out vec4 externalColor, out int externalColorMixMode) {
    externalColor = vExternalColor;
    externalColorMixMode = int(vExternalColorMixMode);
  }

  void outputObjectAndLayerIdColor() {
     ${n?A`gl_FragColor = vObjectAndLayerIdColor;`:""}
  }
`)}function EIe(i){const{vertex:e,fragment:t}=i;e.uniforms.add(new TR("externalColor",r=>r.componentParameters.externalColor)),t.uniforms.add(new TIe("externalColorMixMode",r=>r.componentParameters.externalColorMixMode)),i.varyings.add("vExternalColor","vec4"),e.code.add(A`float readElevationOffset() {
return 0.0;
}
void forwardObjectAndLayerIdColor() {
}
vec4 forwardExternalColor(out bool castShadows) {
vExternalColor = externalColor;
castShadows = true;
return externalColor;
}`),t.code.add(A`void readExternalColor(out vec4 color, out int colorMixMode) {
color = vExternalColor;
colorMixMode = externalColorMixMode;
}
void outputObjectAndLayerIdColor() {
gl_FragColor = vec4(1.0,0.0,0.0,0.0);
}`)}var $l;function RIe(i,e){const t=i.vertex;switch(t.code.add(A`#define VERTEX_DISCARD_CUTOFF (1.0 - 1.0 / 255.0)`),e.vertexDiscardMode){case $l.None:t.code.add(A`#define vertexDiscardByOpacity(_opacity_) {}`);break;case $l.Opaque:t.code.add(A`#define vertexDiscardByOpacity(_opacity_) { if (_opacity_ >  VERTEX_DISCARD_CUTOFF) {  gl_Position = vec4(1e38, 1e38, 1e38, 1.0); return; } }`);break;case $l.Transparent:t.code.add(A`#define vertexDiscardByOpacity(_opacity_) { if (_opacity_ <= VERTEX_DISCARD_CUTOFF) {  gl_Position = vec4(1e38, 1e38, 1e38, 1.0); return; } }`)}}(function(i){i[i.None=0]="None",i[i.Transparent=1]="Transparent",i[i.Opaque=2]="Opaque",i[i.COUNT=3]="COUNT"})($l||($l={}));var eu;function mHe(i){return i&&Dx(i)?eu.Mars:i&&Fx(i)?eu.Moon:eu.Earth}(function(i){i[i.Earth=1]="Earth",i[i.Mars=2]="Mars",i[i.Moon=3]="Moon",i[i.COUNT=4]="COUNT"})(eu||(eu={}));var qo;(function(i){i[i.None=0]="None",i[i.NoOverlay=1]="NoOverlay",i[i.ColorOverlay=2]="ColorOverlay",i[i.ColorOverlayWithWater=3]="ColorOverlayWithWater",i[i.COUNT=4]="COUNT"})(qo||(qo={}));let Tt=class extends $a{constructor(){super(...arguments),this.output=V.Color,this.textureCoordinateType=Im.None,this.componentData=Jh.Uniform,this.cullFace=tn.Back,this.vertexDiscardMode=$l.None,this.doubleSidedMode=ho.WindingOrder,this.alphaDiscardMode=Ho.Opaque,this.integratedMeshMode=qo.None,this.transparencyPassType=qt.NONE,this.ellipsoidMode=eu.Earth,this.pbrMode=zr.Disabled,this.normalType=Il.Attribute,this.spherical=!1,this.doublePrecisionRequiresObfuscation=!1,this.hasVertexColors=!1,this.hasNormals=!1,this.hasSlicePlane=!1,this.hasBaseColorTexture=!1,this.receiveAmbientOcclusion=!0,this.receiveShadows=!0,this.blendingEnabled=!0,this.hasScreenSpaceReflections=!1,this.hasPolygonOffset=!1,this.hasMetallicRoughnessTexture=!1,this.hasEmissionTexture=!1,this.hasOcclusionTexture=!1,this.hasNormalTexture=!1,this.hasOccludees=!1,this.hasMultipassTerrain=!1,this.cullAboveGround=!1,this.useLegacyTerrainShading=!1,this.hasCloudsReflections=!0,this.snowCover=!1,this.objectAndLayerIdColor=!1,this.hasWebGL2Context=!1}};h([k({count:V.COUNT})],Tt.prototype,"output",void 0),h([k({count:Im.COUNT})],Tt.prototype,"textureCoordinateType",void 0),h([k({count:Jh.COUNT})],Tt.prototype,"componentData",void 0),h([k({count:tn.COUNT})],Tt.prototype,"cullFace",void 0),h([k({count:$l.COUNT})],Tt.prototype,"vertexDiscardMode",void 0),h([k({count:ho.COUNT})],Tt.prototype,"doubleSidedMode",void 0),h([k({count:Ho.COUNT})],Tt.prototype,"alphaDiscardMode",void 0),h([k({count:qo.COUNT})],Tt.prototype,"integratedMeshMode",void 0),h([k({count:qt.COUNT})],Tt.prototype,"transparencyPassType",void 0),h([k({count:eu.COUNT})],Tt.prototype,"ellipsoidMode",void 0),h([k({count:zr.COUNT})],Tt.prototype,"pbrMode",void 0),h([k({count:Il.COUNT})],Tt.prototype,"normalType",void 0),h([k()],Tt.prototype,"spherical",void 0),h([k()],Tt.prototype,"doublePrecisionRequiresObfuscation",void 0),h([k()],Tt.prototype,"hasVertexColors",void 0),h([k()],Tt.prototype,"hasNormals",void 0),h([k()],Tt.prototype,"hasSlicePlane",void 0),h([k()],Tt.prototype,"hasBaseColorTexture",void 0),h([k()],Tt.prototype,"receiveAmbientOcclusion",void 0),h([k()],Tt.prototype,"receiveShadows",void 0),h([k()],Tt.prototype,"blendingEnabled",void 0),h([k()],Tt.prototype,"hasScreenSpaceReflections",void 0),h([k()],Tt.prototype,"hasPolygonOffset",void 0),h([k()],Tt.prototype,"hasMetallicRoughnessTexture",void 0),h([k()],Tt.prototype,"hasEmissionTexture",void 0),h([k()],Tt.prototype,"hasOcclusionTexture",void 0),h([k()],Tt.prototype,"hasNormalTexture",void 0),h([k()],Tt.prototype,"hasOccludees",void 0),h([k()],Tt.prototype,"hasMultipassTerrain",void 0),h([k()],Tt.prototype,"cullAboveGround",void 0),h([k()],Tt.prototype,"useLegacyTerrainShading",void 0),h([k()],Tt.prototype,"hasCloudsReflections",void 0),h([k()],Tt.prototype,"snowCover",void 0),h([k()],Tt.prototype,"objectAndLayerIdColor",void 0),h([k()],Tt.prototype,"hasWebGL2Context",void 0),h([k({constValue:UD.Draw})],Tt.prototype,"pbrTextureBindType",void 0),h([k({constValue:!0})],Tt.prototype,"hasSliceHighlight",void 0),h([k({constValue:!1})],Tt.prototype,"hasSliceInVertexProgram",void 0),h([k({constValue:!1})],Tt.prototype,"useCustomDTRExponentForWater",void 0),h([k({constValue:!1})],Tt.prototype,"hasVertexTangents",void 0),h([k({constValue:!0})],Tt.prototype,"supportsTextureAtlas",void 0),h([k({constValue:!1})],Tt.prototype,"highStepCount",void 0),h([k({constValue:!1})],Tt.prototype,"instancedDoublePrecision",void 0),h([k({constValue:!0})],Tt.prototype,"useFillLights",void 0),h([k({constValue:!1})],Tt.prototype,"objectAndLayerIdColorInstanced",void 0);function TB(i,e){i.include(NH,e),i.fragment.include(Aae);const t=i.fragment;t.uniforms.add(new TR("baseColor",r=>r.baseColor)),t.uniforms.add(new R0("objectOpacity",r=>r.objectOpacity)),e.hasVertexColors?t.code.add(A`vec3 _baseColor() {
return baseColor.rgb * vColor.rgb;
}
float _baseOpacity() {
return baseColor.a * vColor.a;
}`):t.code.add(A`vec3 _baseColor() {
return baseColor.rgb;
}
float _baseOpacity() {
return baseColor.a;
}`),t.code.add(A`vec4 computeMaterialColor(vec4 textureColor, vec4 externalColor, int externalColorMixMode) {
vec3 baseColor = _baseColor();
float baseOpacity = _baseOpacity();
vec3 color = mixExternalColor(
baseColor,
textureColor.rgb,
externalColor.rgb,
externalColorMixMode
);
float opacity = objectOpacity * mixExternalOpacity(
baseOpacity,
textureColor.a,
externalColor.a,
externalColorMixMode
);
return vec4(color, opacity);
}`)}function CB(i,e){const t=i.fragment;switch(e.doubleSidedMode){case ho.None:t.code.add(A`vec3 _adjustDoublesided(vec3 normal) {
return normal;
}`);break;case ho.View:i.include(RS,e),t.code.add(A`vec3 _adjustDoublesided(vec3 normal) {
return dot(normal, vPositionWorldCameraRelative) > 0.0 ? -normal : normal;
}`);break;case ho.WindingOrder:t.code.add(A`vec3 _adjustDoublesided(vec3 normal) {
return gl_FrontFacing ? normal : -normal;
}`);break;default:Ra(e.doubleSidedMode);case ho.COUNT:}switch(e.normalType){case Il.Attribute:case Il.CompressedAttribute:i.include(OH,e),t.code.add(A`vec3 shadingNormalWorld() {
return _adjustDoublesided(normalize(vNormalWorld));
}
vec3 shadingNormal_view() {
vec3 normal = normalize(vNormalView);
return gl_FrontFacing ? normal : -normal;
}`);break;case Il.ScreenDerivative:i.extensions.add("GL_OES_standard_derivatives"),i.include(RS,e),t.code.add(A`vec3 shadingNormalWorld() {
return normalize(cross(
dFdx(vPositionWorldCameraRelative),
dFdy(vPositionWorldCameraRelative)
));
}
vec3 shadingNormal_view() {
return normalize(cross(dFdx(vPosition_view),dFdy(vPosition_view)));
}`);break;case Il.Ground:e.spherical?(i.include(RS,e),t.code.add(A`vec3 shadingNormalWorld() {
return normalize(positionWorld());
}`)):t.code.add(A`vec3 shadingNormalWorld() {
return vec3(0.0, 0.0, 1.0);
}`),i.extensions.add("GL_OES_standard_derivatives"),t.code.add(A`vec3 shadingNormal_view() {
return normalize(cross(dFdx(vPosition_view),dFdy(vPosition_view))).xyz;
}`);break;default:Ra(e.normalType);case Il.COUNT:}}function PIe(i,e){const t=i.fragment;if(e.hasBaseColorTexture&&(e.output===V.Color||e.alphaDiscardMode!==Ho.Opaque)){i.include(bne,e);const r=e.textureCoordinateType===Im.Atlas;t.uniforms.add(qR("baseColorTexture",n=>n.texture,r?e.hasWebGL2Context?il.None:il.Size:il.None)),r?(i.include(wne),t.code.add(A`
        vec4 readBaseColorTexture() {
          vec2 textureSize = ${Hx(e,"baseColorTexture")};
          return textureAtlasLookup(baseColorTexture, textureSize, vuv0, vuvRegion);
        }
      `)):t.code.add(A`vec4 readBaseColorTexture() {
return texture2D(baseColorTexture, vuv0);
}`)}else t.code.add(A`vec4 readBaseColorTexture() { return vec4(1.0); }`)}function AIe(i){const e=new Yi;e.include(RS,i),e.include(OH,i),e.include(NH,i),e.include(kR,i),e.include(sH,i),e.include(CIe,i),e.include(Oae,i),e.include(soe,i),e.include(PIe,i),e.include(RIe,i);const{vertex:t,fragment:r}=e;i.pbrMode!==zr.Normal&&i.pbrMode!==zr.Schematic||(e.include(xne,i),i.hasNormalTexture&&e.include(loe,i));const n=i.output===V.Shadow||i.output===V.ShadowHighlight||i.output===V.ShadowExludeHighlight;n&&i.componentData===Jh.Varying?t.code.add(A`#define discardShadows(castShadows) { if(!castShadows) { gl_Position = vec4(1e38, 1e38, 1e38, 1.0); return; } }`):t.code.add(A`#define discardShadows(castShadows) {}`);const s=i.integratedMeshMode===qo.ColorOverlay||i.integratedMeshMode===qo.ColorOverlayWithWater,a=s&&i.output===V.Color&&i.pbrMode===zr.WaterOnIntegratedMesh;return s&&(e.include(jE,i),e.include(HOe,i),i.spherical?t.code.add(A`
      const float invEllipsoidRadius = ${A.float(1/(i.ellipsoidMode===eu.Earth?lo.radius:i.ellipsoidMode===eu.Mars?pne.radius:mne.radius))};
      vec2 projectOverlay(vec3 pos) {
        return pos.xy / (1.0 + invEllipsoidRadius * pos.z);
      }
      `):t.code.add(A`vec2 projectOverlay(vec3 pos) { return pos.xy; }`)),a&&(e.varyings.add("tbnTangent","vec3"),e.varyings.add("tbnBiTangent","vec3"),e.varyings.add("groundNormal","vec3")),t.code.add(A`
    void main() {
      bool castShadows;
      vec4 externalColor = forwardExternalColor(castShadows);
      discardShadows(castShadows);

      vertexDiscardByOpacity(externalColor.a);

      if (externalColor.a < ${A.float(coe)}) {
        // Discard this vertex
        gl_Position = vec4(1e38, 1e38, 1e38, 1.0);
        return;
      }

      forwardPosition(readElevationOffset());
      forwardNormal();
      forwardTextureCoordinates();
      forwardVertexColor();
      forwardLinearDepth();
      ${i.output===V.ObjectAndLayerIdColor?A`forwardObjectAndLayerIdColor();`:""}
      ${a?i.spherical?A`
                groundNormal = normalize(positionWorld());
                tbnTangent = normalize(cross(vec3(0.0, 0.0, 1.0), groundNormal));
                tbnBiTangent = normalize(cross(groundNormal, tbnTangent));`:A`
                groundNormal = vec3(0.0, 0.0, 1.0);
                tbnTangent = vec3(1.0, 0.0, 0.0);
                tbnBiTangent = vec3(0.0, 1.0, 0.0);`:""}
      ${s?A`setOverlayVTC(projectOverlay(position));`:""}
    }
  `),i.output===V.Alpha&&(r.include(Ig),e.include(zI,i),e.include(TB,i),s&&r.uniforms.add(new Ht("ovColorTex",(o,l)=>$$(o,l))),r.code.add(A`
      void main() {
        discardBySlice(vPositionWorldCameraRelative);
        ${i.hasMultipassTerrain?A`terrainDepthTest(gl_FragCoord, vPosition_view.z);`:""}

        vec4 textureColor = readBaseColorTexture();
        discardOrAdjustAlpha(textureColor);

        vec4 externalColor;
        int externalColorMixMode;
        readExternalColor(externalColor, externalColorMixMode);

        vec4 materialColor = computeMaterialColor(
          textureColor,
          externalColor,
          externalColorMixMode
        );
        ${s?A`
                vec4 overlayColor = getOverlayColor(ovColorTex, vtcOverlay);
                materialColor = materialColor * (1.0 - overlayColor.a) + overlayColor;`:""}

        gl_FragColor = vec4(materialColor.a);
      }
    `)),i.output===V.Color&&(r.include(Ig),e.include(zI,i),e.include(TB,i),e.include(CB,i),e.include(jE,i),i.receiveShadows?(e.include(BG,i),r.code.add(A`float evaluateShadow() {
return readShadowMap(vPositionWorldCameraRelative, linearDepth);
}`)):r.code.add(A`float evaluateShadow() { return 0.0; }`),s&&r.uniforms.add(new Ht("ovColorTex",(o,l)=>$$(o,l))),r.code.add(A`
      void main() {
        discardBySlice(vPositionWorldCameraRelative);
        ${i.hasMultipassTerrain?A`terrainDepthTest(gl_FragCoord, vPosition_view.z);`:""}

        vec4 textureColor = readBaseColorTexture();
        discardOrAdjustAlpha(textureColor);

        vec4 externalColor;
        int externalColorMixMode;
        readExternalColor(externalColor, externalColorMixMode);

        vec4 materialColor = computeMaterialColor(
          textureColor,
          externalColor,
          externalColorMixMode
        );
        ${s?A`vec4 overlayColor = getOverlayColor(ovColorTex, vtcOverlay);`:""}
    `),i.pbrMode===zr.Normal||i.pbrMode===zr.Schematic?(FD(r),r.code.add(A`
        ${i.pbrMode===zr.Normal?A`
                applyPBRFactors();
                if (int(externalColorMixMode) == 3) {
                  mrr = vec3(0.0, 0.6, 0.2);
                }`:""}
        vec3 normalVertex = shadingNormalWorld();
        float additionalIrradiance = 0.02 * mainLightIntensity[2];
      `),i.hasNormalTexture?r.code.add(A`mat3 tangentSpace = computeTangentSpace(normalVertex, vPositionWorldCameraRelative, vuv0);
vec3 shadingNormal = computeTextureNormal(tangentSpace, vuv0);`):r.code.add(A`vec3 shadingNormal = normalVertex;`),r.code.add(A`${i.spherical?A`vec3 normalGround = normalize(positionWorld());`:A`vec3 normalGround = vec3(0.0, 0.0, 1.0);`}
      `),r.code.add(A`
        vec3 viewDir = normalize(vPositionWorldCameraRelative);
        float ssao = 1.0 - occlusion * (1.0 - evaluateAmbientOcclusion());

        ${i.snowCover?A`
                vec3 surfaceNormal = normalize(shadingNormalWorld());
                float snow = smoothstep(0.5, 0.55, dot(surfaceNormal, normalize(positionWorld())));
                materialColor.rgb = mix(materialColor.rgb, vec3(1), snow);

                shadingNormal = mix(shadingNormal, surfaceNormal, snow);
                ssao = mix(ssao, 0.0, snow);
                mrr = mix(mrr, vec3(0.0, 1.0, 0.04), snow);
                emission = mix(emission, vec3(0.0), snow);`:""}

        ${s?A` materialColor = materialColor * (1.0 - overlayColor.a) + overlayColor;`:""}

        vec3 additionalLight = evaluateAdditionalLighting(ssao, positionWorld());
        vec4 shadedColor = vec4(evaluateSceneLightingPBR(shadingNormal, materialColor.rgb, evaluateShadow(), ssao, additionalLight, viewDir, normalGround, mrr, emission, additionalIrradiance), materialColor.a);
        `)):(i.receiveShadows?r.code.add(A`float shadow = evaluateShadow();`):i.spherical?(XG(r),r.code.add(A`float additionalAmbientScale = additionalDirectedAmbientLight(positionWorld());
float shadow = lightingGlobalFactor * (1.0 - additionalAmbientScale);`)):r.code.add(A`float shadow = 0.0;`),a&&r.uniforms.add(new Ht("ovNormalTex",(o,l)=>a5(l))),i.snowCover&&(e.extensions.add("GL_OES_standard_derivatives"),r.code.add(A`vec3 surfaceNormal = normalize(cross(dFdx(vPositionWorldCameraRelative), dFdy(vPositionWorldCameraRelative)));
float snow = smoothstep(0.5, 0.55, dot(surfaceNormal, normalize(positionWorld())));
materialColor.rgb = mix(materialColor.rgb, vec3(1), snow);`)),r.code.add(A`
        float ambientOcclusion = evaluateAmbientOcclusion();
        vec3 additionalLight = evaluateAdditionalLighting(ambientOcclusion, positionWorld());

        ${s?A` materialColor = materialColor * (1.0 - overlayColor.a) + overlayColor;`:""}

        vec4 shadedColor = vec4(evaluateSceneLighting(shadingNormalWorld(), materialColor.rgb, shadow, ambientOcclusion, additionalLight), materialColor.a);
      ${a?A`
              vec4 overlayWaterMask = getOverlayColor(ovNormalTex, vtcOverlay);
              float waterNormalLength = length(overlayWaterMask);
              if (waterNormalLength > 0.95) {
                mat3 tbnMatrix = mat3(tbnTangent, tbnBiTangent, groundNormal);
                vec4 waterColorLinear = getOverlayWaterColor(overlayWaterMask, overlayColor, -normalize(vPositionWorldCameraRelative), shadow, groundNormal, tbnMatrix, vPosition_view, positionWorld());
                vec4 waterColorNonLinear = delinearizeGamma(vec4(waterColorLinear.xyz, 1.0));
                // un-gamma the ground color to mix in linear space
                shadedColor = mix(shadedColor, waterColorNonLinear, waterColorLinear.w);
              }`:""}
      `)),r.code.add(A`
        gl_FragColor = highlightSlice(shadedColor, vPositionWorldCameraRelative);
        ${i.transparencyPassType===qt.Color?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""}
      }
    `)),(i.output===V.Depth||n)&&(e.include(jI,i),r.code.add(A`void main() {
discardBySlice(vPositionWorldCameraRelative);
vec4 textureColor = readBaseColorTexture();
discardOrAdjustAlpha(textureColor);
outputDepth(linearDepth);
}`)),i.output===V.Normal&&(e.include(CB,i),r.code.add(A`
      void main() {
        discardBySlice(vPositionWorldCameraRelative);

        vec4 textureColor = readBaseColorTexture();
        discardOrAdjustAlpha(textureColor);

        // note: the alpha component needs to be 1.0 in order for this material
        // to influence ambient occlusion, see the ssao fragment shader
        float alpha = ${i.normalType===Il.Ground?"0.0":"1.0"};
        gl_FragColor = vec4(vec3(.5) + .5 * shadingNormal_view(), alpha);
      }
    `)),i.output===V.ObjectAndLayerIdColor&&e.fragment.code.add(A`void main() {
discardBySlice(vPositionWorldCameraRelative);
vec4 textureColor = readBaseColorTexture();
discardOrAdjustAlpha(textureColor);
outputObjectAndLayerIdColor();
}`),i.output===V.Highlight&&(e.include($H,i),r.code.add(A`
      void main() {
        discardBySlice(vPositionWorldCameraRelative);

        vec4 textureColor = readBaseColorTexture();
        discardOrAdjustAlpha(textureColor);

        ${s?A`
                vec4 overlayColor = getCombinedOverlayColor();
                if (overlayColor.a == 0.0) {
                  gl_FragColor = vec4(0.0);
                  return;
                }`:""}

        outputHighlight();
      }
    `)),e}function a5(i){return i.overlays.length===0?null:i.overlays[ki.INNER].getValidTexture(er.Water)}const OIe=Object.freeze(Object.defineProperty({__proto__:null,build:AIe,getOverlayNormalTexture:a5},Symbol.toStringTag,{value:"Module"}));let lee=class cee extends ii{initializeConfiguration(e,t){t.hasWebGL2Context=e.rctx.type===Nn.WEBGL2,t.spherical=e.viewingMode===Ie.Global,t.doublePrecisionRequiresObfuscation=zR(e.rctx)}initializeProgram(e){return new ei(e.rctx,cee.shader.get().build(this.configuration),hee)}_setPipelineState(e){const t=this.configuration,r=t.integratedMeshMode!==qo.None,n=e===qt.NONE,s=e===qt.FrontFace;return it({blending:t.output!==V.Color&&t.output!==V.Alpha||!t.blendingEnabled?null:n?Hl:qm(e),culling:zD(t.cullFace),depthTest:{func:n_(e)},depthWrite:n||s?nl:null,colorWrite:gt,stencilWrite:r||t.hasOccludees?Cd:null,stencilTest:r?vse(kb.IntegratedMeshMaskExcluded):t.hasOccludees?s_:null,polygonOffset:n||s?t.hasPolygonOffset?{factor:2,units:2}:null:jD})}initializePipeline(){return this._setPipelineState(this.configuration.transparencyPassType)}};lee.shader=new ri(OIe,()=>j(()=>import("./ComponentShader.glsl-b6366d84.js"),["assets/ComponentShader.glsl-b6366d84.js","assets/Matrix3PassUniform-ad9f953b.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/mat3f64-c6305894.js","assets/mat4f64-1e28eae0.js","assets/vec3f32-c9aa289f.js","assets/vec3f64-2f9cef06.js","assets/VertexAttribute-9c5c630d.js","assets/mat4-44a0988f.js","assets/common-c186b691.js","assets/vec3-e93e648f.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/Texture2DPassUniform-753de459.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/mathUtils-b4bb77e2.js","assets/vec4-790471c0.js","assets/context-util-a4ce3a7b.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/aaBoundingBox-657a9b82.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/aaBoundingRect-193543b5.js","assets/basicInterfaces-19ed850e.js","assets/ViewingMode-5d7d590b.js","assets/Util-a48361c6.js","assets/vec4f64-e407da96.js","assets/symbolColorUtils-b2b55883.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/compilerUtils-18d58939.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/sphere-2af0d852.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));const hee=new Map([[S.POSITION,0],[S.NORMAL,1],[S.NORMALCOMPRESSED,1],[S.COLOR,2],[S.UV0,3],[S.UVREGION,4],[S.COMPONENTINDEX,5]]);let MIe=class extends Ir{constructor(){super(...arguments),this._dirty=!0}_setDirty(){this._dirty=!0}_setClean(){if(this._dirty=!1,this._parameterBlocks!=null)for(const e of this._parameterBlocks)this[e]._setClean()}get dirty(){return this._dirty||this._checkParameterBlocksDirty()}_checkParameterBlocksDirty(){if(this._parameterBlocks==null)return!1;for(const e of this._parameterBlocks)if(this[e].dirty)return!0;return!1}},o5=class{constructor(){this._dirty=!0}_setDirty(){this._dirty=!0}_setClean(){this._dirty=!1}get dirty(){return this._dirty}};function Wi(i={}){return(e,t)=>{const r=e._parameterCount??0;if(e._parameterCount=r+1,i.vectorOps){const n=i.vectorOps;Object.defineProperty(e,t,{get(){return this[r]},set(s){const a=this[r];if(a==null)this[r]=s;else{if(n.equals(a,s))return;n.copy(a,s)}this._setDirty()}})}else Object.defineProperty(e,t,{get(){return this[r]},set(n){this[r]!==n&&(i.dispose&&this[r]&&this[r].dispose(),this[r]=n,this._setDirty())}})}}function SB(){return(i,e)=>{const t=i._parameterCount??0;i._parameterCount=t+1,i._parameterBlocks=i._parameterBlocks||[],i._parameterBlocks.push(t),Object.defineProperty(i,e,{get(){return this[t]},set(r){this[t]!==r&&(this[t]=r,this._setDirty())}})}}let eA=class{constructor(e){this._low=Xi(),this._high=Xi(),e&&this.set(e)}get low(){return this._low}get high(){return this._high}set(e){const t=this._low,r=this._high;X(t,e),tl(r,e,t)}setElements(e,t,r){Y(EB,e,t,r),this.set(EB)}get(e){return ce(e,this._low,this._high)}getLowScaled(e){return Q(e,this._low,1)}};const EB=P();let un=class extends MIe{constructor(e,t){super(),this.toMapSpace=t,this.baseColor=J0(1,1,1,1),this.usePBR=!1,this.hasParametersFromSource=!1,this.mrrFactors=_i(1,1,.5),this.emissiveFactor=_i(0,0,0),this.baseColorTexture=null,this.metallicRoughnessTexture=null,this.emissionTexture=null,this.occlusionTexture=null,this.normalTexture=null,this.objectOpacity=1,this.commonMaterialParameters=new SE,this.componentParameters=new dw,this.textureAlphaCutoff=hoe,this.alphaDiscardMode=Ho.Opaque,this.isIntegratedMesh=!1,this.polygonOffsetEnabled=!1,this.ellipsoidMode=eu.Earth,this.hasOccludees=!1,this._techniqueConfiguration=new Tt;const r=new eA(e.position),n=bre(e.rotationScale);Kg(n,n),this.transformNormalGlobalFromModel=qc(n,n),this.transformWorldFromModelTL=r.low,this.transformWorldFromModelTH=r.high,this.transformWorldFromModelRS=e.rotationScale}dispose(){this._technique=Qi(this._technique),this.baseColorTexture=null,this.metallicRoughnessTexture=null,this.emissionTexture=null,this.occlusionTexture=null,this.normalTexture=null}get texture(){return y(this.baseColorTexture)?this.baseColorTexture.glTexture:null}get textureMetallicRoughness(){return y(this.metallicRoughnessTexture)?this.metallicRoughnessTexture.glTexture:null}get textureEmissive(){return y(this.emissionTexture)?this.emissionTexture.glTexture:null}get textureOcclusion(){return y(this.occlusionTexture)?this.occlusionTexture.glTexture:null}get textureNormal(){return y(this.normalTexture)?this.normalTexture.glTexture:null}prepareTechnique(e,t,r,n){const s=this._techniqueConfiguration;s.hasVertexColors=n.colors,s.hasNormals=n.normals,s.textureCoordinateType=n.textureCoordinates,s.hasMetallicRoughnessTexture=y(this.metallicRoughnessTexture),s.hasEmissionTexture=y(this.emissionTexture),s.hasOcclusionTexture=y(this.occlusionTexture),s.hasNormalTexture=y(this.normalTexture),s.transparencyPassType=t.identifier===Zo.Material&&r.transparencyPassType!=null?r.transparencyPassType:qt.NONE,s.hasMultipassTerrain=t.identifier===Zo.Material&&r.multipassTerrain!=null&&r.multipassTerrain.enabled,s.cullAboveGround=t.identifier===Zo.Material&&r.multipassTerrain!=null&&r.multipassTerrain.cullAboveGround,s.ellipsoidMode=this.ellipsoidMode,s.componentData=this.componentParameters.type,s.cullFace=this.commonMaterialParameters.cullFace,s.doubleSidedMode=this.commonMaterialParameters.doubleSided?ho.View:ho.None,s.hasBaseColorTexture=y(this.baseColorTexture);const a=this._computeWhichMaterialPass();s.blendingEnabled=a===Gs.Transparent||a===Gs.OpaqueAndTransparent,s.alphaDiscardMode=this.alphaDiscardMode,s.integratedMeshMode=this.isIntegratedMesh?$Ie(r)?a5(r)?qo.ColorOverlayWithWater:qo.ColorOverlay:qo.NoOverlay:qo.None,s.useLegacyTerrainShading=this.isIntegratedMesh&&Wt.TERRAIN_USE_LEGACY_SHADING,s.hasPolygonOffset=this.polygonOffsetEnabled;const o=this.hasParametersFromSource&&C(this.baseColorTexture);return s.pbrMode=s.integratedMeshMode===qo.ColorOverlayWithWater?zr.WaterOnIntegratedMesh:this.usePBR?o?zr.Schematic:zr.Normal:zr.Disabled,s.normalType=s.integratedMeshMode===qo.None?s.hasNormals?Il.CompressedAttribute:Il.ScreenDerivative:Il.Ground,s.hasSlicePlane=y(r.slicePlane)&&this.commonMaterialParameters.hasSlicePlane,t.identifier===Zo.ShadowMap?(s.output=V.Shadow,s.vertexDiscardMode=$l.None):t.identifier===Zo.Highlight?(s.output=V.Highlight,s.vertexDiscardMode=$l.None):(this._computeWhichMaterialPass()===Gs.OpaqueAndTransparent?s.vertexDiscardMode=t.transparent?$l.Opaque:$l.Transparent:s.vertexDiscardMode=$l.None,s.output=IIe(t.subPass),t.subPass===yr.Alpha&&(s.hasOccludees=r.hasOccludees),t.subPass===yr.Color?(s.receiveAmbientOcclusion=r.ssaoHelper.ready,s.hasOccludees=r.hasOccludees,s.receiveShadows=r.shadowMap.ready,s.hasScreenSpaceReflections=r.ssr.enabled,s.hasCloudsReflections=y(r.cloudsFade.data)):(s.receiveAmbientOcclusion=!1,s.receiveShadows=!1),s.snowCover=this.hasSnowCover(r),t.subPass===yr.ObjectAndLayerIdColor&&(s.objectAndLayerIdColor=!0)),this._technique=e.releaseAndAcquire(lee,s,this._technique),this._setClean(),this._technique}hasSnowCover(e){return y(e.weather)&&e.weatherVisible&&e.weather.type==="snowy"&&e.weather.snowCover==="enabled"}submit(e,t,r){if(this.objectOpacity===0)return;const n=r.renderable.geometry,s=r.components,a=r.renderable.meta.cameraDepthSquared,o=s.geometryRanges,l=s.highlightRanges,c=s.defaultShadowMapRanges;switch(this._computeWhichMaterialPass()){case Gs.Opaque:e.materialOpaque.submitDraw(this,n,o,a);break;case Gs.Transparent:e.materialTransparent.submitDraw(this,n,o,a);break;case Gs.OpaqueAndTransparent:e.materialOpaque.submitDraw(this,n,o,a),e.materialTransparent.submitDraw(this,n,o,a);break;case Gs.IntegratedMesh:e.materialIntegratedMesh.submitDraw(this,n,o,a),LIe(t)&&e.highlightIntegratedMesh.submitDraw(this,n,o,a)}const u=this.componentParameters.castShadows!==Yr.None;u&&e.shadowMap.submitDraw(this,n,o,a),y(l)&&(e.highlight.submitDraw(this,n,l,a),u&&e.highlightShadowMap.submitDraw(this,n,l,a)),u&&y(c)&&e.defaultShadowMap.submitDraw(this,n,c,a)}_computeWhichMaterialPass(){return this.isIntegratedMesh?Gs.IntegratedMesh:this.objectOpacity<1?Gs.Transparent:this.componentParameters.opaqueOverride===Yr.All?Gs.Opaque:this.baseColor[3]<1||this.alphaDiscardMode===Ho.Blend||this.alphaDiscardMode===Ho.MaskBlend?Gs.Transparent:this.componentParameters.transparent===Yr.None?Gs.Opaque:this.componentParameters.transparent===Yr.All?Gs.Transparent:Gs.OpaqueAndTransparent}};var Gs,Yr;h([Wi({vectorOps:UG})],un.prototype,"baseColor",void 0),h([Wi()],un.prototype,"usePBR",void 0),h([Wi()],un.prototype,"hasParametersFromSource",void 0),h([Wi({vectorOps:N5})],un.prototype,"mrrFactors",void 0),h([Wi({vectorOps:N5})],un.prototype,"emissiveFactor",void 0),h([Wi({dispose:!0})],un.prototype,"baseColorTexture",void 0),h([Wi({dispose:!0})],un.prototype,"metallicRoughnessTexture",void 0),h([Wi({dispose:!0})],un.prototype,"emissionTexture",void 0),h([Wi({dispose:!0})],un.prototype,"occlusionTexture",void 0),h([Wi({dispose:!0})],un.prototype,"normalTexture",void 0),h([Wi()],un.prototype,"objectOpacity",void 0),h([SB()],un.prototype,"commonMaterialParameters",void 0),h([SB()],un.prototype,"componentParameters",void 0),h([Wi()],un.prototype,"textureAlphaCutoff",void 0),h([Wi()],un.prototype,"alphaDiscardMode",void 0),h([Wi()],un.prototype,"isIntegratedMesh",void 0),h([Wi()],un.prototype,"polygonOffsetEnabled",void 0),h([Wi()],un.prototype,"ellipsoidMode",void 0),h([Wi()],un.prototype,"hasOccludees",void 0),function(i){i[i.Opaque=0]="Opaque",i[i.Transparent=1]="Transparent",i[i.OpaqueAndTransparent=2]="OpaqueAndTransparent",i[i.IntegratedMesh=3]="IntegratedMesh"}(Gs||(Gs={}));let SE=class extends o5{constructor(){super(...arguments),this.doubleSided=!1,this.cullFace=tn.Back,this.hasSlicePlane=!0}};h([Wi()],SE.prototype,"doubleSided",void 0),h([Wi()],SE.prototype,"cullFace",void 0),h([Wi()],SE.prototype,"hasSlicePlane",void 0);let dw=class extends o5{constructor(){super(...arguments),this.externalColor=J0(1,1,1,1),this.externalColorMixMode=KE.Multiply,this.castShadows=Yr.All}get transparent(){return this.externalColor[3]<1?Yr.All:Yr.None}get opaqueOverride(){return this.externalColorMixMode===KE.Replace&&this.externalColor[3]===1?Yr.All:Yr.None}get visible(){return this.externalColor[3]>0?Yr.All:Yr.None}get type(){return Jh.Uniform}};h([Wi({vectorOps:UG})],dw.prototype,"externalColor",void 0),h([Wi()],dw.prototype,"externalColorMixMode",void 0),h([Wi()],dw.prototype,"castShadows",void 0),function(i){i[i.All=0]="All",i[i.Some=1]="Some",i[i.None=2]="None"}(Yr||(Yr={}));class Tb extends o5{constructor(){super(...arguments),this.texture=null,this.transparent=Yr.None,this.opaqueOverride=Yr.None,this.castShadows=Yr.None}get type(){return Jh.Varying}}function IIe(i){switch(i){case yr.Color:return V.Color;case yr.Alpha:return V.Alpha;case yr.Depth:return V.Depth;case yr.Normal:return V.Normal;case yr.ObjectAndLayerIdColor:return V.ObjectAndLayerIdColor}}function LIe(i){return i.overlays.length!==0&&y(i.overlays[ki.INNER].getValidTexture(er.Highlight))}function $Ie(i){return i.overlays.length!==0&&y(i.overlays[ki.INNER].getColorTextureNoRasterImage())}h([Wi()],Tb.prototype,"texture",void 0),h([Wi()],Tb.prototype,"transparent",void 0),h([Wi()],Tb.prototype,"opaqueOverride",void 0),h([Wi()],Tb.prototype,"castShadows",void 0);let DIe=class{constructor(e){this._maxCount=e,this._nextIndex=0,this._recycledIndices=[]}get activeCount(){return this._nextIndex-this._recycledIndices.length}get availableCount(){return this._recycledIndices.length+this._maxCount-this._nextIndex}acquire(){return this._recycledIndices.length>0?this._recycledIndices.pop():this.availableCount?this._nextIndex++:void 0}release(e){this._recycledIndices.push(e)}},FIe=class{constructor(e,t=1){this._rctx=e,this._fieldCount=t,this.textureWidth=4096,this._dirty=!0,this._texture=new Gi(this._rctx,{target:bi.TEXTURE_2D,pixelFormat:St.RGBA,dataType:Xt.UNSIGNED_BYTE,samplingMode:Jt.NEAREST,wrapMode:ai.CLAMP_TO_EDGE,width:this.textureWidth,height:1,flipped:!1}),this._data=new $m(new ArrayBuffer(4*this.textureWidth))}dispose(){this._texture.dispose(),this._texture=void 0,this._data=void 0}setData(e,t,r,n,s,a){const o=e*this._fieldCount+t;this._dirty=!0,this._data.set(o,0,r),this._data.set(o,1,n),this._data.set(o,2,s),this._data.set(o,3,a)}setDataElement(e,t,r,n){const s=e*this._fieldCount+t;this._dirty=!0,this._data.set(s,r,n)}resizeToFit(e){const t=e*this._fieldCount;if(t>=this._data.count){const r=Math.ceil((t+1)/this.textureWidth)*this.textureWidth,n=new $m(new ArrayBuffer(4*r));n.typedBuffer.set(this._data.typedBuffer),this._data=n}}updateTexture(){if(!this._dirty)return;const e=this._texture.descriptor.width,t=this._texture.descriptor.height;this._data.count>e*t&&this._texture.resize(e,this._data.count/e),this._texture.setData(this._data.typedBuffer),this._dirty=!1}get texture(){return this._texture}};const uee=65536;let NIe=class{constructor(e,t=1){this.textureBuffer=new FIe(e,t),this._indexManager=new DIe(uee)}dispose(){this.textureBuffer.dispose(),this.textureBuffer=void 0}get availableCount(){return this._indexManager.availableCount}get activeCount(){return this._indexManager.activeCount}acquireIndex(){const e=this._indexManager.acquire();return this.textureBuffer.resizeToFit(e),e}releaseIndex(e){this._indexManager.release(e)}},dee=class{constructor(e,t=1){this._rctx=e,this._fieldCount=t,this._buffers=[]}garbageCollect(){this._buffers=this._buffers.filter(e=>e.activeCount!==0||(e.dispose(),!1))}destroy(){this._buffers.forEach(e=>e.dispose()),this._buffers=[]}getBuffer(e){for(const r of this._buffers)if(r.availableCount>=e)return r;if(e>uee)return null;const t=new NIe(this._rctx,this._fieldCount);return this._buffers.push(t),t}updateTextures(){for(const e of this._buffers)e.textureBuffer.updateTexture()}};const RB=ee.getLogger("esri.views.3d.webgl-engine.collections.Component.ComponentObjectCollection");class kIe{constructor(e,t){this._renderManager=e,this._viewingMode=t,this._objects=[new Yt,new Yt],this._renderSubmit=new wIe(this),this._renderManager.register(this._renderSubmit),this._hasObjectAndLayerId=Ot("enable-feature:objectAndLayerId-rendering"),this._componentBufferManager=new dee(e.rctx,2+(this._hasObjectAndLayerId?1:0))}dispose(){ct(this._objects[B0.Hidden].length===0&&this._objects[B0.Visible].length===0,"ObjectCollection should be empty upon disposal"),this._componentBufferManager.destroy()}createObject(e){const t=new N$;return t.toMapSpace=e.toMapSpace,t.transform=e.transform,t.obb=dk(e.obb),t.components=new rIe(this._componentBufferManager,e.geometry.componentOffsets),t.renderable=this._createRenderable(e,t.components),t.intersectionGeometry=new hIe(e.geometry.positionData,t.components),this._objects[t.visible].push(t),t}destroyObject(e){const t=e;this._objects[t.visible].removeUnordered(t),t.dispose(),this._notifyDirty()}setObjectVisibility(e,t){const r=e;t!==r.visible&&(this._objects[r.visible].removeUnordered(r),this._objects[t].push(r),r.visible=t,this._notifyDirty())}preSubmit(e){const t=e.camera.eye;this.visibleObjects.forAll(r=>r.renderable.meta.cameraDepthSquared=Bl(t,r.obb.center))}getMaterial(e){return e.renderable.material}updateMaterial(e,t){const r=e.renderable.material;t(r),r.dirty&&this._notifyDirty()}setAllComponentVisibilities(e,t){const r=e;r.components.visibility.reset(t),r.components.visibilityDirty(),this._notifyDirty()}forEachVisibleComponent(e,t){return e.components.visibility.forEachComponent(t)}getComponentCount(e){const t=e,r=t.components.visibility.componentCount();return{visible:r,invisible:t.components.count-r}}setComponentData(e,t){const r=e,n=r.renderable.material,s=r.components,a=s.materialDataBuffer,o=s.materialDataIndices,l={castShadows:!0,pickable:!0,externalColor:_k(),externalColorMixMode:KE.Multiply,elevationOffset:0,objectAndLayerIdColor:this._hasObjectAndLayerId?_k():null},c=a.textureBuffer,u=new Uint8Array(4),d=new Uint32Array(u.buffer);let m=0,f=0,_=0,g=s.verticalOffsets,w=1/0,v=-1/0,b=!1,x=!1,T=0;for(let R=0;R<s.count;R++){if(t(R,l),m+=+(l.externalColor[3]<1),f+=+(l.externalColorMixMode===KE.Replace&&l.externalColor[3]===1),_+=+l.castShadows,IH(l.externalColor,l.externalColorMixMode,u),u[2]=254&u[2]|+l.castShadows,c.setData(o[R],0,u[0],u[1],u[2],u[3]),b||(b=R>0&&T!==d[0]),T=d[0],x||(x=l.elevationOffset!==0),x&&C(g)&&(g=new Array(R).fill(0)),y(g)&&(g[R]=l.elevationOffset),w=Math.min(w,l.elevationOffset),v=Math.max(v,l.elevationOffset),oee(l.elevationOffset,u),c.setData(o[R],1,u[0],u[1],u[2],u[3]),this._hasObjectAndLayerId){const E=l.objectAndLayerIdColor;c.setData(o[R],2,E[0],E[1],E[2],E[3])}l.pickable!==ree(s.pickability,R)&&(s.pickability=sIe(s.pickability,s.count,R,l.pickable))}s.verticalOffsets=x?g:null,r.offsetObb=x?dae(r.obb,w,v,this._viewingMode,y(r.offsetObb)?r.offsetObb:dk(r.obb)):null,b||x||this._hasObjectAndLayerId?(n.componentParameters=new Tb,n.componentParameters.castShadows=rI(_,s.count),n.componentParameters.transparent=rI(m,s.count),n.componentParameters.opaqueOverride=rI(f,s.count),n.componentParameters.texture=c,c.updateTexture()):(n.componentParameters=new dw,n.componentParameters.castShadows=l.castShadows?Yr.All:Yr.None,n.componentParameters.externalColor=l.externalColor,n.componentParameters.externalColorMixMode=l.externalColorMixMode),this._notifyDirty()}getComponentAabb(e,t,r,n=!1){e.intersectionGeometry.getComponentAabb(t,r);const s=e,a=s.components.verticalOffsets;if(n||C(a))return r;const o=a[t];if(this._viewingMode===Ie.Local||o===0)return r[2]+=o,r[5]+=o,r;const l=ft(bse(o));return l.localOrigin=s.transform.position,l.applyToAabb(r)}getComponentObb(e){return e.obb}getObjectTransform(e){return e.transform}getComponentPositions(e,t,r){return e.intersectionGeometry.getComponentPositions(t,r)}intersect(e,t,r,n,s,a){const o=e;y(s)&&(s.localOrigin=o.transform.position);const l=Kg(PB,o.transform.rotationScale);tl(dS,t,o.transform.position),tl(pS,r,o.transform.position),Nl(dS,dS,l),Nl(pS,pS,l);const c=qc(PB,l);return o.intersectionGeometry.intersect(dS,pS,n,c,s,o.components.verticalOffsets,a)}addEdges(e,t,r,n){const s=e,{indices:a,positions:o}=s.intersectionGeometry,l=s.components.offsets;return t.addComponentObject(e,s.transform,{center:s.obb.center,radius:pae(s.obb)},o,a,l,r,n)}async extractEdgeInformation(e,t,r){const n=e,s=n.components.visibility;if(s.allInvisible())return{buffer:Tse.createBuffer(0),origin:[0,0,0]};const{indices:a,positions:o}=n.intersectionGeometry,l=n.components.offsets,c=BI.createBuffer(o.count);RH(c.position,o),YE(c.position,c.position,n.transform.rotationScale),this._setComponentIndices(c.componentIndex,a,l);const u=c.count,d=this._computeVisibilityIndices(a,s,l,u);return{origin:as(n.transform.position),buffer:await t.extractComponentsEdgeLocations({indices:d,indicesLength:d.length,skipDeduplicate:!0,data:c,writerSettings:{reducedPrecision:!1,variants:0}},r)}}_setComponentIndices(e,t,r){let n=0;for(let s=0;s<r.length-1;s++){const a=r[s],o=r[s+1];for(let l=a;l<o;l++){const c=t?t[l]:l;e.set(c,n)}n++}}_computeVisibilityIndices(e,t,r,n){if(e&&t.allVisible())return e;let s=0;t.forEachComponentRange((l,c)=>(s+=r[c]-r[l],!0));const a=Array.isArray(e)?new Array(s):(e==null?void 0:e.BYTES_PER_ELEMENT)===2||n<=65536?new Uint16Array(s):new Uint32Array(s);let o=0;return t.forEachComponentRange((l,c)=>{const u=r[l],d=r[c];for(let m=u;m<d;m++)a[o++]=e?e[m]:m;return!0}),a}addComponentHighlight(e,t){const r=e.components;C(r.highlightCounts)&&(r.highlightCounts=new Uint32Array(r.count+1)),r.highlightCounts[t]++===0&&(r.highlightsDirty(),this._notifyDirty()),r.highlightCounts[r.count]++}removeComponentHighlight(e,t){const r=e.components;if(C(r.highlightCounts))return void RB.warn("Removing non-existing highlight.");const n=r.highlightCounts[t],s=r.highlightCounts[r.count];if(n!==0){if(n>1)return r.highlightCounts[t]=n-1,void(r.highlightCounts[r.count]=s-1);r.highlightCounts[t]=0,r.highlightsDirty(),this._notifyDirty(),s===1?r.highlightCounts=null:r.highlightCounts[r.count]=s-1}else RB.warn("Removing non-existing highlight.")}clearHighlights(e){const t=e.components;y(t.highlightCounts)&&(t.highlightCounts=null,t.highlightsDirty(),this._notifyDirty())}getObjectGPUMemoryUsage(e){return e.renderable.meta.gpuMemoryEstimate}get visibleObjects(){return this._objects[B0.Visible]}_createRenderable(e,t){const r=this._renderManager.rctx,n=e.geometry,s=n.vertices.layoutParameters,a=ui.createVertex(r,mi.STATIC_DRAW,n.vertices.data),o=co(n.indices,g=>ui.createIndex(r,mi.STATIC_DRAW,g)),l=Wc(xIe(s)),c=new Uint16Array(n.vertices.count);for(let g=0;g<t.count;g++){const w=t.offsets[g],v=t.offsets[g+1],b=t.materialDataIndices[g];if(y(n.indices))for(let x=w;x<v;x++)c[n.indices[x]]=b;else for(let x=w;x<v;x++)c[x]=b}const u=ui.createVertex(r,mi.STATIC_DRAW,c.buffer),d=new un(e.transform,e.toMapSpace),m=new Gc(r,hee,{data:l,componentIndices:VIe},{data:a,componentIndices:u},ft(o)),f=new see(m,kt.TRIANGLES,s,y(o)),_={cameraDepthSquared:.5,gpuMemoryEstimate:a.byteSize+u.byteSize+(y(o)?o.byteSize:0)};return new pIe(d,f,_)}_notifyDirty(){this._renderManager.notifyDirty()}}const VIe=Wc(sn().u16(S.COMPONENTINDEX));function rI(i,e){return i===e?Yr.All:i===0?Yr.None:Yr.Some}const PB=hm(),dS=P(),pS=P();let pee=class extends Ir{constructor(){super(...arguments),this.opacity=1}};function UIe(i){const e=new Yi;return e.include(Nd),e.fragment.uniforms.add(new Ht("tex",t=>t.texture)),i.hasOpacityFactor&&e.fragment.uniforms.add(new Pt("opacity",t=>t.opacity)),e.fragment.code.add(A`
    void main() {
      gl_FragColor = texture2D(tex, uv) ${i.hasOpacityFactor?"* opacity":""};
    }`),e}const zIe=Object.freeze(Object.defineProperty({__proto__:null,CompositingPassParameters:pee,build:UIe},Symbol.toStringTag,{value:"Module"}));var Es;(function(i){i[i.None=0]="None",i[i.Alpha=1]="Alpha",i[i.PremultipliedAlpha=2]="PremultipliedAlpha",i[i.COUNT=3]="COUNT"})(Es||(Es={}));let V$=class extends $a{constructor(){super(...arguments),this.alphaMode=Es.None,this.hasOpacityFactor=!1}};h([k({count:Es.COUNT})],V$.prototype,"alphaMode",void 0),h([k()],V$.prototype,"hasOpacityFactor",void 0);let mee=class fee extends ii{initializeProgram(e){return new ei(e.rctx,fee.shader.get().build(this.configuration),oi)}initializePipeline(){switch(this.configuration.alphaMode){case Es.None:return it({colorWrite:gt});case Es.Alpha:return it({blending:Gn(me.SRC_ALPHA,me.ONE,me.ONE_MINUS_SRC_ALPHA,me.ONE_MINUS_SRC_ALPHA),colorWrite:gt});case Es.PremultipliedAlpha:case Es.COUNT:return it({blending:lu(me.ONE,me.ONE_MINUS_SRC_ALPHA),colorWrite:gt})}}};mee.shader=new ri(zIe,()=>j(()=>import("./Compositing.glsl-da5c6c92.js"),["assets/Compositing.glsl-da5c6c92.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/VertexAttribute-9c5c630d.js","assets/vec2-528adfe4.js","assets/common-c186b691.js","assets/vec2f64-30dc1443.js","assets/Texture2DPassUniform-753de459.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));let gee=class extends Ir{};function BIe(){const i=new Yi;return i.include(Nd),i.fragment.uniforms.add(new Ht("tex",e=>e.texture)),i.fragment.code.add(A`void main() {
gl_FragColor = vec4(1.0 - texture2D(tex, uv).a);
}`),i}const GIe=Object.freeze(Object.defineProperty({__proto__:null,HUDCompositingPassParameters:gee,build:BIe},Symbol.toStringTag,{value:"Module"}));let _ee=class yee extends ii{initializeProgram(e){return new ei(e.rctx,yee.shader.get().build(),oi)}initializePipeline(){return it({colorWrite:{r:!1,g:!0,b:!1,a:!1}})}};_ee.shader=new ri(GIe,()=>j(()=>import("./HUDCompositing.glsl-a6172aef.js"),["assets/HUDCompositing.glsl-a6172aef.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/VertexAttribute-9c5c630d.js","assets/vec2-528adfe4.js","assets/common-c186b691.js","assets/vec2f64-30dc1443.js","assets/Texture2DPassUniform-753de459.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));let vee=class extends Ir{};function HIe(){const i=new Yi;return i.include(Nd),i.fragment.uniforms.add([new Ht("colorTexture",e=>e.colorTexture),new Ht("alphaTexture",e=>e.alphaTexture),new Ht("frontFaceTexture",e=>e.frontFaceTexture)]),i.fragment.code.add(A`void main() {
vec4 srcColor = texture2D(colorTexture, uv);
if(srcColor.a <= 1e-5){
discard;
}
float srcAlpha = texture2D(alphaTexture, uv).r;
vec4 frontFace = texture2D(frontFaceTexture, uv);
gl_FragColor = vec4(mix(srcColor.rgb/srcColor.a, frontFace.rgb, frontFace.a), 1.0 - srcAlpha);
}`),i}const jIe=Object.freeze(Object.defineProperty({__proto__:null,OITCompositingPassParameters:vee,build:HIe},Symbol.toStringTag,{value:"Module"}));let bee=class wee extends ii{initializeProgram(e){return new ei(e.rctx,wee.shader.get().build(),oi)}initializePipeline(){return it({blending:Gn(me.SRC_ALPHA,me.ONE,me.ONE_MINUS_SRC_ALPHA,me.ONE_MINUS_SRC_ALPHA),colorWrite:gt})}};bee.shader=new ri(jIe,()=>j(()=>import("./OITCompositing.glsl-354e61c6.js"),["assets/OITCompositing.glsl-354e61c6.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/VertexAttribute-9c5c630d.js","assets/vec2-528adfe4.js","assets/common-c186b691.js","assets/vec2f64-30dc1443.js","assets/Texture2DPassUniform-753de459.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));let xee=class extends Ir{constructor(){super(...arguments),this.overlayIndex=ki.INNER,this.opacity=1}};function qIe(){const i=new Yi;return i.include(Nd),i.fragment.uniforms.add(new Ht("tex",e=>e.texture)),i.fragment.uniforms.add(new DD("overlayIdx",e=>e.overlayIndex)),i.fragment.uniforms.add(new Pt("opacity",e=>e.opacity)),i.fragment.code.add(A`void main() {
vec2 overlayUV = overlayIdx == 0 ? vec2(uv.x * 0.5, uv.y) : vec2(uv.x * 0.5 + 0.5, uv.y);
gl_FragColor = texture2D(tex, overlayUV) * opacity;
}`),i}const WIe=Object.freeze(Object.defineProperty({__proto__:null,OverlayCompositingPassParameters:xee,build:qIe},Symbol.toStringTag,{value:"Module"}));let Tee=class Cee extends ii{initializeProgram(e){return new ei(e.rctx,Cee.shader.get().build(),oi)}initializePipeline(){return it({blending:lu(me.ONE,me.ONE_MINUS_SRC_ALPHA),colorWrite:gt})}};Tee.shader=new ri(WIe,()=>j(()=>import("./OverlayCompositing.glsl-254fa760.js"),["assets/OverlayCompositing.glsl-254fa760.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/VertexAttribute-9c5c630d.js","assets/vec2-528adfe4.js","assets/common-c186b691.js","assets/vec2f64-30dc1443.js","assets/Texture2DPassUniform-753de459.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));let XIe=class{constructor(e,t){this._rctx=e,this._techniqueRepository=t,this._configuration=new V$,this._passParameters=new pee,this._oitParameters=new vee,this._hudParameters=new gee,this._overlayParameters=new xee}dispose(){this._vao=ke(this._vao)}compositeOIT(e,t,r,n){this._oitParameters.colorTexture=t,this._oitParameters.alphaTexture=r,this._oitParameters.frontFaceTexture=n;const s=this._rctx,a=this._techniqueRepository.acquire(bee);s.bindTechnique(a,this._oitParameters,e);const o=this._ensureVAO();s.bindVAO(o),s.drawArrays(kt.TRIANGLE_STRIP,0,Ws(o,"geometry")),a.release()}compositeHUD(e,t){this._hudParameters.texture=t;const r=this._rctx,n=this._techniqueRepository.acquire(_ee);r.bindTechnique(n,this._hudParameters,e);const s=this._ensureVAO();r.bindVAO(s),r.drawArrays(kt.TRIANGLE_STRIP,0,Ws(s,"geometry")),n.release()}compositeOverlay(e,t,r,n){this._overlayParameters.texture=t,this._overlayParameters.opacity=r,this._overlayParameters.overlayIndex=n;const s=this._rctx,a=this._techniqueRepository.acquire(Tee);s.bindTechnique(a,this._overlayParameters,e);const o=this._ensureVAO();s.bindVAO(o),s.drawArrays(kt.TRIANGLE_STRIP,0,Ws(o,"geometry")),a.release()}composite(e,t,r=Es.None,n=1){const s=this._rctx;this._configuration.alphaMode=r,this._configuration.hasOpacityFactor=n!==1,this._passParameters.texture=t,this._passParameters.opacity=n;const a=this._techniqueRepository.acquire(mee,this._configuration);s.bindTechnique(a,this._passParameters,e);const o=this._ensureVAO();s.bindVAO(o),s.drawArrays(kt.TRIANGLE_STRIP,0,Ws(o,"geometry")),a.release()}_ensureVAO(){return C(this._vao)&&(this._vao=La(this._rctx)),this._vao}};const QIe=1e4,U$=100,ZIe=500,YIe=500,KIe=.1;function JIe(i,e,t){return DH(e,i)*(t[1]-t[0])+t[0]}function eLe(i,e,t){if(e.size<QIe)return lLe.compute(i,e);const r=oT();return t.forAll(n=>{n.isVisible&&fv(r,tLe(i,n))}),r}function tLe(i,e){if(!e.isVisible)return;const t=oT(),r=e.getSpatialQueryAccelerator();return y(r)?iLe(t,i,r):rLe(t,i,e.objects),t}function iLe(i,e,t){const r=e.eye,n=e.viewForward,s=e.frustum,a=l=>l.isVisible,o=t.objectCount;if(o<ZIe)Ax(wl,e.near,Math.min(i.near,e.far)),t.forEachInDepthRange(r,n,Mc.DepthOrder.FRONT_TO_BACK,wl,(l,c)=>{z$(i,e,l),wl.far=i.near,c.setRange(wl)},s,a),Ax(wl,Math.max(i.far,e.near),e.far),t.forEachInDepthRange(r,n,Mc.DepthOrder.BACK_TO_FRONT,wl,(l,c)=>{z$(i,e,l),wl.near=i.far,c.setRange(wl)},s,a);else{const l=Math.max(Math.min(o,YIe),Math.ceil(o*KIe)),c=t.findClosest(n,Mc.DepthOrder.FRONT_TO_BACK,s,a,l),u=t.findClosest(n,Mc.DepthOrder.BACK_TO_FRONT,s,a,l);c&&u&&(AB(i,e,c.boundingVolumeWorldSpace.bounds),AB(i,e,u.boundingVolumeWorldSpace.bounds))}}function rLe(i,e,t){cy.clear(),t.forAll(r=>{r.isVisible&&r.geometryRecords.length!==0&&cy.add(r)}),cy.empty||(cy.sort(e),Ax(wl,e.near,Math.min(i.near,e.far)),cy.forEachInDepthRange(wl,Mc.DepthOrder.FRONT_TO_BACK,(r,n)=>{n<i.near&&z$(i,e,r)}),Ax(wl,Math.max(i.far,e.near),e.far),cy.forEachInDepthRange(wl,Mc.DepthOrder.BACK_TO_FRONT,(r,n,s)=>{i.far=Math.max(i.far,s)}))}function z$(i,e,t){if(!t.isVisible||!GR(e.frustum,t.boundingVolumeWorldSpace.bounds))return;const r=t.transformation,n=oLe;t.geometryRecords.forEach(s=>{Hr(n,r,s.getShaderTransformation());const a=Gg(n);See(i,e,s.geometry.boundingInfo,n,a)})}function See(i,e,t,r,n){if(C(t))return;Me(Kn,t.center,r);const{eye:s,viewForward:a}=e,o=a[0]*(Kn[0]-s[0])+a[1]*(Kn[1]-s[1])+a[2]*(Kn[2]-s[2]);if(Kn[3]=t.radius*n,!(o-Kn[3]>i.near&&o+Kn[3]<i.far)&&GR(e.frustum,Kn))if(t.radius>U$&&t.getChildren()){const l=t.getChildren();for(let c=0;c<8;++c)l[c]&&See(i,e,l[c],r,n)}else B$.unionDepthRangeWithAABB(i,e.viewProjectionMatrix,r,t.bbMin,t.bbMax)}function AB(i,e,t){const r=e.eye,n=e.viewForward,s=(t[0]-r[0])*n[0]+(t[1]-r[1])*n[1]+(t[2]-r[2])*n[2];i.near=Math.min(i.near,s-t[3]),i.far=Math.max(i.far,s+t[3])}let nLe=class{constructor(){this._items=new Yt({allocator:e=>e||{obj:null,distance:0,near:0,far:0},deallocator:e=>(e.obj=null,e.distance=0,e.near=0,e.far=0,e)})}get length(){return this._items.length}get empty(){return this._items.length===0}clear(){this._items.clear()}add(e){this._items.pushNew().obj=e}sort(e){const t=e.eye,r=e.viewForward;this._items.forAll(n=>{const s=n.obj.boundingVolumeWorldSpace.bounds,a=(s[0]-t[0])*r[0]+(s[1]-t[1])*r[1]+(s[2]-t[2])*r[2];n.distance=a,n.near=a-s[3],n.far=a+s[3]}),this._items.sort((n,s)=>n.distance-s.distance)}forEachInDepthRange(e,t,r){if(t===Mc.DepthOrder.FRONT_TO_BACK)for(let n=0;n<this._items.length;++n){const s=this._items.data[n];s.far<e.near||s.near>e.far||r(s.obj,s.near,s.far)}else for(let n=this._items.length-1;n>=0;--n){const s=this._items.data[n];s.far<e.near||s.near>e.far||r(s.obj,s.near,s.far)}}},sLe=class{constructor(){this._view=xe(),this._viewProj=xe(),this._frustum=Iw(),this._geometries=[],this._near=[],this._far=[],this._nearCandidates=[],this._farCandidates=[],this._range={near:0,far:0},this._looseRange={near:0,far:0}}compute(e,t){this._reset(),pn(this._view,e.viewMatrix),Hr(this._viewProj,e.projectionMatrix,this._view),ZE(this._frustum,e.frustum);const r=this._view,n=r[2],s=r[6],a=r[10],o=r[14],l=this._range;let c=0;if(t.forEach(f=>{if(!f.instanceParameters.visible||!f.castShadow)return;let _;f.hasShaderTransformation?(f.computeBoundingSphere(f.getShaderTransformation(),Kn,1),_=Kn):_=f.boundingSphere;const g=n*_[0]+s*_[1]+a*_[2]+o,w=g-_[3],v=g+_[3];this._geometries[c]=f,this._near[c]=-v,this._far[c]=-w,++c}),this._geometries.length===0)return l;for(let f=0;f<this._geometries.length;++f)this._near[f]>l.far&&(l.far=this._near[f]),this._near[f]>2&&this._far[f]<l.near&&(l.near=this._far[f]);const u=this._looseRange;u.near=Math.max(.5*l.near,2),u.far=2*l.far;let d=0,m=0;for(let f=0;f<this._geometries.length;++f)this._near[f]<l.near&&(this._near[f]>=u.near?l.near=this._near[f]:this._nearCandidates[d++]=f),this._far[f]>l.far&&(this._far[f]<=u.far?l.far=this._far[f]:this._farCandidates[m++]=f);if(this._nearCandidates.length===0&&this._farCandidates.length===0)return l;this._nearCandidates.sort((f,_)=>this._near[f]<this._near[_]?-1:this._near[f]>this._near[_]?1:0),this._farCandidates.sort((f,_)=>this._far[f]<this._far[_]?1:this._far[f]>this._far[_]?-1:0);for(let f=0;f<this._nearCandidates.length;++f){const _=this._nearCandidates[f];if(this._near[_]<l.near){const g=this._geometries[_],w=g.boundingInfo;this._includeNearBoundingInfoRec(w,g.getShaderTransformation())}}for(let f=0;f<this._farCandidates.length;++f){const _=this._farCandidates[f];if(this._far[_]>l.far){const g=this._geometries[_],w=g.boundingInfo;this._includeFarBoundingInfoRec(w,g.getShaderTransformation())}}return l}_reset(){this._geometries.length=0,this._near.length=0,this._far.length=0,this._nearCandidates.length=0,this._farCandidates.length=0,this._range.near=Number.MAX_VALUE,this._range.far=-Number.MAX_VALUE}_includeNearBoundingInfoRec(e,t){if(C(e))return;const r=e.getCenter();Me(Kn,r,t);const n=Gg(t),s=Kn[0],a=Kn[1],o=Kn[2],l=e.getBSRadius()*n,c=this._frustum;if(c[0][0]*s+c[0][1]*a+c[0][2]*o+c[0][3]>l||c[1][0]*s+c[1][1]*a+c[1][2]*o+c[1][3]>l||c[2][0]*s+c[2][1]*a+c[2][2]*o+c[2][3]>l||c[3][0]*s+c[3][1]*a+c[3][2]*o+c[3][3]>l)return;const u=this._view[2]*s+this._view[6]*a+this._view[10]*o+this._view[14],d=u+l;if(!(-(u-l)<2||-d>=this._range.near))if(-d>this._looseRange.near)this._range.near=-d;else{if(l>U$){const m=e.getChildren();if(m!==void 0){for(let f=0;f<8;++f)m[f]!==void 0&&this._includeNearBoundingInfoRec(m[f],t);return}}B$.unionDepthRangeWithAABB(this._range,this._viewProj,t,e.getBBMin(),e.getBBMax())}}_includeFarBoundingInfoRec(e,t){if(C(e))return;let r=e.getBSRadius();const n=e.getCenter();Me(Kn,n,t);const s=Gg(t),a=Kn[0],o=Kn[1],l=Kn[2];r*=s;const c=this._frustum;if(c[0][0]*a+c[0][1]*o+c[0][2]*l+c[0][3]>r||c[1][0]*a+c[1][1]*o+c[1][2]*l+c[1][3]>r||c[2][0]*a+c[2][1]*o+c[2][2]*l+c[2][3]>r||c[3][0]*a+c[3][1]*o+c[3][2]*l+c[3][3]>r)return;const u=this._view[2]*a+this._view[6]*o+this._view[10]*l+this._view[14]-r;if(!(-u<=this._range.far))if(-u<this._looseRange.far)this._range.far=-u;else{if(r>U$){const d=e.getChildren();if(d!==void 0){for(let m=0;m<8;++m)d[m]!==void 0&&this._includeFarBoundingInfoRec(d[m],t);return}}B$.unionDepthRangeWithAABB(this._range,this._viewProj,t,e.getBBMin(),e.getBBMax())}}},aLe=class{constructor(){this._modelViewProj=xe(),this._clipPosition=[yi(),yi(),yi(),yi(),yi(),yi(),yi(),yi()]}unionDepthRangeWithAABB(e,t,r,n,s){const a=this._modelViewProj;Hr(a,t,r);let o=!1;for(let l=0;l<8;++l){const c=this._clipPosition[l],u=l===0||l===3||l===4||l===7?n[0]:s[0],d=l===0||l===1||l===4||l===5?n[1]:s[1],m=l<4?n[2]:s[2];c[0]=a[0]*u+a[4]*d+a[8]*m+a[12],c[1]=a[1]*u+a[5]*d+a[9]*m+a[13],c[2]=a[2]*u+a[6]*d+a[10]*m+a[14],c[3]=a[3]*u+a[7]*d+a[11]*m+a[15]}for(let l=0;l<12;++l){const c=this._clipPosition[nI[l][0]],u=this._clipPosition[nI[l][1]],d=this._clipPosition[nI[l][2]],m=this._clipTriangle(c,u,d);let f=!0;for(let _=0;_<m.length;++_)if(m[_][3]>=2){f=!1;break}if(!f){o=!0;for(let _=0;_<m.length;++_){const g=m[_][3];Number.isFinite(g)&&(e.near=Math.min(g,e.near),e.far=Math.max(g,e.far))}}}return o}_inside(e,t){return t===0?e[0]>=-e[3]:t===1?e[1]>=-e[3]:t===2?e[0]<=e[3]:t===3?e[1]<=e[3]:void ct(!1)}_intersect(e,t,r){let n=0;return r===0?n=(-e[3]-e[0])/(t[0]-e[0]+t[3]-e[3]):r===1?n=(-e[3]-e[1])/(t[1]-e[1]+t[3]-e[3]):r===2?n=(e[3]-e[0])/(t[0]-e[0]-t[3]+e[3]):r===3&&(n=(e[3]-e[1])/(t[1]-e[1]-t[3]+e[3])),_ne(yi(),e,t,n)}_clipTriangle(e,t,r){let n=[e,t,r];for(let s=0;s<4;++s){const a=n;n=[];for(let o=0;o<a.length;++o){const l=a[o],c=a[(o+1)%a.length];this._inside(c,s)?(this._inside(l,s)||n.push(this._intersect(l,c,s)),n.push(c)):this._inside(l,s)&&n.push(this._intersect(l,c,s))}}return n}};const nI=[[0,1,3],[2,3,1],[1,5,2],[6,2,5],[5,4,6],[7,6,4],[4,0,7],[3,7,0],[3,2,7],[6,7,2],[4,5,0],[1,0,5]],Kn=ou(),oLe=xe(),wl=oT(),cy=new nLe,lLe=new sLe,B$=new aLe;let cLe=class{},hLe=class extends Ir{constructor(){super(...arguments),this.textures=new cLe}};function uLe(){const i=new Yi;return i.attributes.add(S.POSITION,"vec2"),i.vertex.uniforms.add(new Xh("drawPosition",(e,t)=>dLe(e,t))),i.varyings.add("vUV","vec2"),i.vertex.code.add(A`void main(void) {
vUV = position;
gl_Position = vec4(drawPosition.xy + vec2(position - 0.5) * drawPosition.zw, 0.0, 1.0);
}`),i.fragment.uniforms.add(new Ht("textureInput",e=>e.textures.input)),i.fragment.uniforms.add(new Ht("textureMask",e=>e.textures.mask)),i.fragment.uniforms.add(new Ht("textureOverlay",e=>e.textures.overlay)),i.fragment.uniforms.add(new Rw("maskEnabled",e=>e.magnifier.maskEnabled)),i.fragment.uniforms.add(new Rw("overlayEnabled",e=>e.magnifier.overlayEnabled)),i.fragment.code.add(A`const float barrelFactor = 1.1;
vec2 barrel(vec2 uv) {
vec2 uvn = uv * 2.0 - 1.0;
if (uvn.x == 0.0 && uvn.y == 0.0) {
return vec2(0.5, 0.5);
}
float theta = atan(uvn.y, uvn.x);
float r = pow(length(uvn), barrelFactor);
return r * vec2(cos(theta), sin(theta)) * 0.5 + 0.5;
}
void main() {
float mask = maskEnabled ? texture2D(textureMask, vUV).a : 1.0;
vec4 inputColor = texture2D(textureInput, barrel(vUV)) * mask;
vec4 overlayColor = overlayEnabled ? texture2D(textureOverlay, vUV) : vec4(0);
gl_FragColor = overlayColor + (1.0 - overlayColor.a) * inputColor;
}`),i}function dLe(i,e){const t=e.camera.pixelRatio,r=i.magnifier.offset.x*t,n=i.magnifier.offset.y*t;Dh(i.magnifier.position,OB);const s=e.camera.screenToRender(OB,pLe),a=Math.ceil(t*i.magnifier.size),o=e.camera.fullWidth,l=e.camera.fullHeight;return Qs(mLe,(s[0]+r)/o*2-1,(s[1]-n)/l*2-1,a/o*2,a/l*2)}const OB=zi(),pLe=X7(),mLe=yi();async function fLe(i){const e=j(()=>import("./mask-svg-82caf882.js"),[]),t=j(()=>import("./overlay-svg-615b0a3b.js"),[]),r=Lg((await e).default,{signal:i}),n=Lg((await t).default,{signal:i}),s={mask:await r,overlay:await n};return Ti(i),s}let Dy=class extends pe{constructor(){super(...arguments),this._handles=new Vt,this._magnifier=null,this._imageSources=null,this._imageLoadTask=null,this._resources=null,this._passParameters=new hLe,this.events=new nn,this.attributeLocations=new Map([[S.POSITION,0]]),this._tmpScreenPoint=zi(),this._tmpRenderPoint=X7()}get updating(){return C(this._imageSources)&&y(this._imageLoadTask)&&!this._imageLoadTask.task.finished}get magnifier(){return this._magnifier}set magnifier(e){if(e===this._magnifier)return;this._handles.removeAll(),this._magnifier=e;const t=()=>{this._updateResourceLoading(),this.events.emit("request-render")};y(this._magnifier)&&this._handles.add(B(()=>co(this._magnifier,r=>r.version),t)),t()}get enabled(){return y(this._validMagnifier)}get _validMagnifier(){return y(this._magnifier)&&this._magnifier.visible&&y(this._magnifier.position)&&this._magnifier.size>0?this._magnifier:null}get _factor(){return y(this._magnifier)&&this._magnifier.factor||1}dispose(){this._magnifier=null,this._handles.destroy(),y(this._imageLoadTask)&&(this._imageLoadTask.task.abort(),this._imageLoadTask=null),this._disposeResources()}render(e,t){const r=this._validMagnifier;if(C(r))return;const n=t.camera.pixelRatio,s=Math.ceil(n*r.size);if(this._updateResources(e,s),C(this._resources))return;const a=this._passParameters.textures,o=Math.ceil(1/this._factor*s);a.input.resize(o,o),Dh(r.position,this._tmpScreenPoint);const l=t.camera.screenToRender(this._tmpScreenPoint,this._tmpRenderPoint),c=t.camera.fullWidth,u=t.camera.fullHeight,d=.5*o,m=.5*o;l[0]=ue(l[0],d,c-d-1),l[1]=ue(l[1],m,u-m-1);const f=Math.floor(l[0]-d),_=Math.floor(l[1]-m),g=this._resources.program;g.bindTexture("textureInput",a.input),e.gl.copyTexImage2D(a.input.descriptor.target,0,a.input.descriptor.pixelFormat,f,_,o,o,0),this._passParameters.magnifier=r,e.useProgram(g),g.bindPass(this._passParameters,t),e.bindVAO(this._resources.vao),e.setPipelineState(this._resources.pipelineState),e.drawArrays(kt.TRIANGLE_STRIP,0,4)}_updateResourceLoading(){const e=this._validMagnifier;if(C(e))return;const t=e.maskUrl,r=e.overlayUrl;!y(this._imageLoadTask)||this._imageLoadTask.maskUrl===t&&this._imageLoadTask.overlayUrl===r||(this._imageLoadTask.task.abort(),this._imageLoadTask=null,this._imageSources=null),y(this._imageSources)||y(this._imageLoadTask)||(this._imageLoadTask={maskUrl:t,overlayUrl:r,task:Bx(async n=>{const s=C(t)||C(r)?fLe(n):null,a=y(t)?Lg(t,{signal:n}):s.then(l=>l.mask),o=y(r)?Lg(r,{signal:n}):s.then(l=>l.overlay);this._imageSources={mask:await a,overlay:await o},this._disposeResources(),this.events.emit("request-render")})},this._imageLoadTask.task.promise.then(()=>this.notifyChange("updating"),()=>this.notifyChange("updating")))}_updateResources(e,t){if(!this.enabled)return void this._disposeResources();if(y(this._resources)){if(this._passParameters.textures.size!==t){const n=this._createTextureResources(e,t);if(C(n))return void this._disposeResources();this._disposeTextureResources(this._passParameters.textures),this._passParameters.textures=n}return}const r=this._createTextureResources(e,t);C(r)||(this._resources={program:this._createProgram(e),vao:La(e,Xne,this.attributeLocations,0,1),pipelineState:it({blending:lu(me.ONE,me.ONE_MINUS_SRC_ALPHA),depthTest:null,depthWrite:null,colorWrite:gt})},this._passParameters.textures=r)}_disposeResources(){C(this._resources)||(this._disposeTextureResources(this._passParameters.textures),this._resources.program.dispose(),this._resources.vao.dispose(),this._resources=null)}_disposeTextureResources(e){e.mask.dispose(),e.overlay.dispose(),e.input.dispose()}_createTextureResources(e,t){if(C(this._imageSources))return null;this._imageSources.overlay.width=t,this._imageSources.overlay.height=t,this._imageSources.mask.width=t,this._imageSources.mask.height=t;const r=new Gi(e,{target:bi.TEXTURE_2D,pixelFormat:St.RGBA,internalFormat:St.RGBA,dataType:Xt.UNSIGNED_BYTE,wrapMode:ai.CLAMP_TO_EDGE,samplingMode:Jt.LINEAR,flipped:!0,preMultiplyAlpha:!fD(this._imageSources.overlay.src)||!e.driverTest.svgAlwaysPremultipliesAlpha},this._imageSources.overlay),n=new Gi(e,{target:bi.TEXTURE_2D,pixelFormat:St.ALPHA,internalFormat:St.ALPHA,dataType:Xt.UNSIGNED_BYTE,wrapMode:ai.CLAMP_TO_EDGE,samplingMode:Jt.LINEAR,flipped:!0},this._imageSources.mask);return{input:new Gi(e,{target:bi.TEXTURE_2D,pixelFormat:St.RGBA,internalFormat:St.RGBA,dataType:Xt.UNSIGNED_BYTE,wrapMode:ai.CLAMP_TO_EDGE,samplingMode:Jt.LINEAR,flipped:!1}),mask:n,overlay:r,size:t}}_createProgram(e){return new ei(e,uLe(),this.attributeLocations)}};h([p()],Dy.prototype,"_imageSources",void 0),h([p()],Dy.prototype,"_imageLoadTask",void 0),h([p({readOnly:!0})],Dy.prototype,"updating",null),Dy=h([F("esri/views/3d/webgl-engine/lib/MagnifierHelper")],Dy);let gLe=class{constructor(){this.declaredClass="esri.views.3d.webgl-engine.lib.ObjectAndLayerIdRenderHelper",this.colorZero=new $m(new ArrayBuffer(4)),this._uidToRenderColor=new Map,this._colorToUID=new Map,this._layerUidToGraphicsUidToObjectId=new Map,this._layerUidToId=new Map,this._layerUidToPopupEnabled=new Map}setUidToObjectAndLayerId(e,t,r,n,s,a=null,o=null,l=null){if(!(e&&t&&r&&n)||(this._layerUidToId.set(n,r),this._layerUidToPopupEnabled.set(n,s),!s))return;let c=this._layerUidToGraphicsUidToObjectId.get(n);c||(c=new Map,this._layerUidToGraphicsUidToObjectId.set(n,c)),c.set(t,{objectId:e,attributeNodeId:a,attributeIndex:o,subLayerId:l})}getObjectAndLayerIdColor(e){const t=this.getObjectAndLayerIdColorArray(e);return Bi(t.get(0,1),t.get(0,2),t.get(0,3),255)}getObjectAndLayerIdColorArray(e){if(!e.layerUid||!e.graphicUid)return this.colorZero;const t=this._layerUidToPopupEnabled.get(e.layerUid);if(t===void 0)return ee.getLogger(this.declaredClass).warn("popupEnabled is undefined for layerUid "+e.layerUid),this.colorZero;if(t===!1)return this.colorZero;let r=this._uidToRenderColor.get(e.layerUid);r||(r=new Map,this._uidToRenderColor.set(e.layerUid,r));let n=r.get(e.graphicUid);if(!n){for(;!n;){const a=Math.floor(16777214*Math.random())+1;this._colorToUID.has(a)||(n=a)}if(n>16777215)throw new Error("Object ID Overflow");r.set(e.graphicUid,n),this._colorToUID.set(n,e)}const s=new ArrayBuffer(4);return new DataView(s).setUint32(0,n,!1),new $m(s)}getColorToObjectAndLayerIdMapping(){const e=new Map;for(const[t,r]of this._colorToUID.entries()){const n=this._layerUidToGraphicsUidToObjectId.get(r.layerUid);let s=null;n?(s=n.get(r.graphicUid),s||ee.getLogger(this.declaredClass).warn("getColorMapping: no entry found for graphicsId "+r.graphicUid)):ee.getLogger(this.declaredClass).warn("getColorMapping: no entry found for layerUid "+r.layerUid);const a=this._layerUidToId.get(r.layerUid);a||ee.getLogger(this.declaredClass).warn("no layerId found for uid "+r.layerUid),s&&a&&e.set(t,s.attributeNodeId?{type:"object-and-layer-and-i3s-id",oid:s.objectId,lid:a,attrId:s.attributeNodeId,attrIdx:s.attributeIndex,subLayerId:s.subLayerId}:{type:"object-and-layer-id",oid:s.objectId,lid:a})}return e}};const _Le=.5,yLe=30,MB=It(1e3/1),vLe=It(1e3/yLe);var Ox;(function(i){i[i.FrontToBack=0]="FrontToBack",i[i.BackToFront=1]="BackToFront"})(Ox||(Ox={}));let gp=class{constructor(e,t,r=Ox.FrontToBack){this._rctx=e,this._techniqueRepository=t,this._sorting=r,this._draws=new Yt({initialSize:32,allocator:n=>n||{material:null,geometry:null,geometryRanges:null,bindDrawParams:null,depthSquaredHint:0,indexType:0}}),this._previouslyBoundDraw=new Map}submitDraw(e,t,r,n){const s=this._draws.pushNew();s.geometry=t,s.geometryRanges=r,s.material=e,s.depthSquaredHint=n,s.indexType=t.indexed?ft(t.vao.indexBuffer).indexType:0}dispatch(e,t){const r=this._rctx;this._previouslyBoundDraw.clear();let n=null;const s=this._draws.map(o=>o.material.prepareTechnique(this._techniqueRepository,e,t,o.geometry.parameters)),a=this._draws.length;for(let o=0;o<a;o++){const l=s[o];l===n&&l.configuration.transparencyPassType===qt.NONE||(r.bindTechnique(l,e,t),n=l);const c=this._draws.data[o],u=c.geometry;r.bindVAO(u.vao),this._previouslyBoundDraw.get(l)!==c.material&&(l.program.bindDraw(c.material,t,e),this._previouslyBoundDraw.set(l,c.material));const d=c.geometryRanges,m=d.length;if(c.indexType!==0){const f=EE.get(c.indexType);for(let _=0;_<m;_+=2){const g=d[_],w=d[_+1];r.drawElements(u.primitiveType,w,c.indexType,g*f)}}else for(let f=0;f<m;f+=2){const _=d[f],g=d[f+1];r.drawArrays(u.primitiveType,_,g)}}}prepareSubmit(){this._draws.clear()}finishSubmit(){const e=this._sorting===Ox.FrontToBack?1:-1;this._draws.sort((t,r)=>{const n=e*(t.depthSquaredHint-r.depthSquaredHint);return n!==0?n:t.geometry.vao.size-r.geometry.vao.size})}get count(){return this._draws.length}};const EE=new Map;EE.set(dm.UNSIGNED_BYTE,1),EE.set(dm.UNSIGNED_SHORT,2),EE.set(dm.UNSIGNED_INT,4);let bLe=class{constructor(e,t){this.rctx=e,this.shaderTechniqueRepository=t,this.canRender=!0,this._materialPassParameters=new zOe,this._shadowPassParameters=new BOe,this._highlightPassParameters=new GOe,this._systems=new Set,this._passes={materialOpaque:new gp(e,t),materialTransparent:new gp(e,t,Ox.BackToFront),materialIntegratedMesh:new gp(e,t),shadowMap:new gp(e,t),highlight:new gp(e,t),highlightIntegratedMesh:new gp(e,t),highlightShadowMap:new gp(e,t),defaultShadowMap:new gp(e,t)}}register(e){this._systems.add(e)}prepareRender(e){if(this._systems.size!==0){for(const t of Object.values(this._passes))t.prepareSubmit();this._systems.forEach(t=>t.submit(this._passes,e.bindParameters));for(const t of Object.values(this._passes))t.finishSubmit();this.shaderTechniqueRepository.frameUpdate()}}render(e){if(this._systems.size!==0)switch(this._configure(e),e.bindParameters.slot){case le.OPAQUE_MATERIAL:switch(e.output){case V.Color:return this._materialPassParameters.subPass=yr.Color,this._passes.materialOpaque.dispatch(this._materialPassParameters,e.bindParameters);case V.Depth:return this._materialPassParameters.subPass=yr.Depth,this._passes.materialOpaque.dispatch(this._materialPassParameters,e.bindParameters);case V.Normal:return this._materialPassParameters.subPass=yr.Normal,this._passes.materialOpaque.dispatch(this._materialPassParameters,e.bindParameters);case V.Highlight:return this._passes.highlight.dispatch(this._highlightPassParameters,e.bindParameters);case V.Shadow:return this._passes.shadowMap.dispatch(this._shadowPassParameters,e.bindParameters);case V.ShadowHighlight:return this._passes.highlightShadowMap.dispatch(this._shadowPassParameters,e.bindParameters);case V.ShadowExludeHighlight:return this._passes.defaultShadowMap.dispatch(this._shadowPassParameters,e.bindParameters);case V.ObjectAndLayerIdColor:return this._materialPassParameters.subPass=yr.ObjectAndLayerIdColor,this._passes.materialOpaque.dispatch(this._materialPassParameters,e.bindParameters)}return;case le.TRANSPARENT_MATERIAL:switch(e.output){case V.Color:return this._materialPassParameters.subPass=yr.Color,this._passes.materialTransparent.dispatch(this._materialPassParameters,e.bindParameters);case V.Alpha:return this._materialPassParameters.subPass=yr.Alpha,this._passes.materialTransparent.dispatch(this._materialPassParameters,e.bindParameters);case V.Depth:return this._materialPassParameters.subPass=yr.Depth,this._passes.materialTransparent.dispatch(this._materialPassParameters,e.bindParameters);case V.Normal:return this._materialPassParameters.subPass=yr.Normal,this._passes.materialTransparent.dispatch(this._materialPassParameters,e.bindParameters);case V.ObjectAndLayerIdColor:return this._materialPassParameters.subPass=yr.ObjectAndLayerIdColor,this._passes.materialTransparent.dispatch(this._materialPassParameters,e.bindParameters)}return;case le.INTEGRATED_MESH:switch(e.output){case V.Color:return this._materialPassParameters.subPass=yr.Color,this._passes.materialIntegratedMesh.dispatch(this._materialPassParameters,e.bindParameters);case V.Depth:return this._materialPassParameters.subPass=yr.Depth,this._passes.materialIntegratedMesh.dispatch(this._materialPassParameters,e.bindParameters);case V.Normal:return this._materialPassParameters.subPass=yr.Normal,this._passes.materialIntegratedMesh.dispatch(this._materialPassParameters,e.bindParameters);case V.Highlight:return this._passes.highlightIntegratedMesh.dispatch(this._highlightPassParameters,e.bindParameters);case V.ObjectAndLayerIdColor:return this._materialPassParameters.subPass=yr.ObjectAndLayerIdColor,this._passes.materialIntegratedMesh.dispatch(this._materialPassParameters,e.bindParameters)}return}}notifyDirty(){this._context.requestRender()}slots(){return[le.OPAQUE_MATERIAL,le.TRANSPARENT_MATERIAL,le.INTEGRATED_MESH]}initializeRenderContext(e){this._context=e}uninitializeRenderContext(){}queryDepthRange(e){const t={near:1/0,far:-1/0};return this._systems.forEach(r=>{const n=r.queryShadowCasterDepthRange(e);y(n)&&fv(t,n,t)}),t}_configure(e){const t=e.output===V.Shadow||e.output===V.ShadowHighlight||e.output===V.ShadowExludeHighlight?this._shadowPassParameters:e.output===V.Highlight?this._highlightPassParameters:this._materialPassParameters;this._updateParameters(e,t)}_updateParameters(e,t){const r=e.bindParameters.camera,n=r.viewInverseTransposeMatrix;Y(sI,n[3],n[7],n[11]),aI.set(sI),X(t.transformWorldFromViewTH,aI.high),X(t.transformWorldFromViewTL,aI.low),X(t.slicePlaneLocalOrigin,sI),Td(t.transformViewFromCameraRelativeRS,r.viewMatrix),pn(t.transformProjFromView,r.projectionMatrix),t.identifier===Zo.Material&&(this._materialPassParameters.transparent=e.bindParameters.slot===le.TRANSPARENT_MATERIAL,this._materialPassParameters.integratedMesh=e.bindParameters.slot===le.INTEGRATED_MESH,qc(IB,t.transformViewFromCameraRelativeRS),Kg(t.transformNormalViewFromGlobal,IB))}get needsHighlight(){return this._passes.highlight.count>0||this._passes.highlightIntegratedMesh.count>0}get needsTransparentPass(){return this._passes.materialTransparent.count>0}};const sI=P(),IB=Or(),aI=new eA,wLe=8.6,xLe=.4;function TLe(){const i=new Yi,{vertex:e,fragment:t}=i,r=e.code,n=t.code;return i.attributes.add(S.POSITION,"vec2"),i.varyings.add("uv","vec2"),i.attributes.add(S.UV0,"vec2"),e.uniforms.add(new Ht("coverageTex",s=>s.coverageTexture)),r.add(A`void main() {
vec4 cov = texture2D(coverageTex, uv0);
if (cov.r == 0.0) {
gl_Position = vec4(0.0);
return;
}
gl_Position = vec4(position, 0.0, 1.0);
uv = position.xy * 0.5 + vec2(0.5);
}`),t.uniforms.add(new Ht("tex",s=>s.blurColorTexture)),t.uniforms.add(new Ht("origin",s=>s.highlightColorTexture)),t.uniforms.add(new Xh("uColor",s=>s.color)),t.uniforms.add(new Xh("haloColor",s=>s.haloColor)),t.uniforms.add(new Xh("opacities",s=>Qs(CLe,s.haloOpacity,s.haloOpacityOccluded,s.fillOpacity,s.fillOpacityOccluded))),t.constants.add("outlineSize","float",wLe),t.constants.add("blurSize","float",xLe),n.add(A`void main() {
vec4 blurredHighlightValue = texture2D(tex, uv);
float highlightIntensity = blurredHighlightValue.a;
if (highlightIntensity == 0.0) {
discard;
}
vec4 origin_color = texture2D(origin, uv);
float outlineIntensity;
float fillIntensity;
if (blurredHighlightValue.g > blurredHighlightValue.b) {
outlineIntensity = haloColor.w * opacities[1];
fillIntensity = uColor.w * opacities[3];
}
else {
outlineIntensity = haloColor.w * opacities[0];
fillIntensity = uColor.w * opacities[2];
}
float inner = 1.0 - outlineSize / 9.0;
float outer = 1.0 - (outlineSize + blurSize) / 9.0;
float outlineFactor = smoothstep(outer, inner, highlightIntensity);
float fillFactor = any(notEqual(origin_color, vec4(0.0, 0.0, 0.0, 0.0))) ? 1.0 : 0.0;
float intensity = outlineIntensity * outlineFactor * (1.0 - fillFactor) + fillIntensity * fillFactor;
gl_FragColor = vec4(mix(haloColor.rgb, uColor.rgb, fillFactor), intensity);
}`),i}const CLe=yi(),SLe=Object.freeze(Object.defineProperty({__proto__:null,build:TLe},Symbol.toStringTag,{value:"Module"}));let Eee=class Ree extends ii{initializeProgram(e){return new ei(e.rctx,Ree.shader.get().build(),oi)}initializePipeline(){return it({blending:Gn(me.SRC_ALPHA,me.ONE,me.ONE_MINUS_SRC_ALPHA,me.ONE_MINUS_SRC_ALPHA),colorWrite:gt})}};Eee.shader=new ri(SLe,()=>j(()=>import("./HighlightApply.glsl-f0f77247.js"),["assets/HighlightApply.glsl-f0f77247.js","assets/vec4-790471c0.js","assets/common-c186b691.js","assets/vec4f64-e407da96.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/Texture2DPassUniform-753de459.js","assets/VertexAttribute-9c5c630d.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));let Pee=class extends Ir{constructor(){super(...arguments),this.blurSize=Te()}};function ELe(){const i=new Yi,{vertex:e,fragment:t}=i,r=e.code,n=t.code;return i.attributes.add(S.POSITION,"vec2"),i.attributes.add(S.UV0,"vec2"),i.varyings.add("blurCoordinate","vec3"),e.uniforms.add(new Ht("coverageTex",s=>s.coverageTexture)),t.uniforms.add(new FH("blurSize",s=>s.blurSize)),r.add(A`void main() {
gl_Position = vec4(position, 0.0, 1.0);
vec4 cov = texture2D(coverageTex, uv0);
if (cov.r == 0.0) {
gl_Position = vec4(0.0);
}
blurCoordinate = vec3(gl_Position.xy * 0.5 + vec2(0.5), max(cov.g, cov.b));
}`),t.uniforms.add(new nF("tex",s=>s.blurInputTexture)),n.add(A`void main() {
vec2 uv = blurCoordinate.xy;
vec4 center = texture2D(tex, uv);
if (blurCoordinate.z == 1.0) {
gl_FragColor = center;
} else {
vec4 sum = vec4(0.0);
sum += center * 0.204164;
sum += texture2D(tex, uv + blurSize * 1.407333) * 0.304005;
sum += texture2D(tex, uv - blurSize * 1.407333) * 0.304005;
sum += texture2D(tex, uv + blurSize * 3.294215) * 0.093913;
sum += texture2D(tex, uv - blurSize * 3.294215) * 0.093913;
gl_FragColor = sum;
}
}`),i}const RLe=Object.freeze(Object.defineProperty({__proto__:null,HighlightBlurDrawParameters:Pee,build:ELe},Symbol.toStringTag,{value:"Module"}));let Aee=class Oee extends ii{initializeProgram(e){return new ei(e.rctx,Oee.shader.get().build(),oi)}initializePipeline(){return it({colorWrite:gt})}};Aee.shader=new ri(RLe,()=>j(()=>import("./HighlightBlur.glsl-0c0e826f.js"),["assets/HighlightBlur.glsl-0c0e826f.js","assets/vec2f64-30dc1443.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/vec2-528adfe4.js","assets/common-c186b691.js","assets/Texture2DPassUniform-753de459.js","assets/VertexAttribute-9c5c630d.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));let Mee=class extends Ir{constructor(){super(...arguments),this.invFramebufferDim=Te()}};function PLe(){const i=new Yi,{vertex:e,fragment:t}=i,r=e.code,n=t.code;return i.attributes.add(S.POSITION,"vec2"),r.add(A`void main() {
gl_Position = vec4(vec2(1.0) - position * 2.0, 0.0, 1.0);
}`),t.uniforms.add(new nF("tex",s=>s.inputTexture)),t.uniforms.add(new FH("invFramebufferDim",s=>s.invFramebufferDim)),n.add(A`void main() {
vec2 coord = gl_FragCoord.xy * invFramebufferDim;
vec4 value = texture2D(tex, coord);
float mx = floor(max(value.g, value.b));
gl_FragColor = vec4(ceil(value.r), mx, mx, 1.0);
}`),i}const ALe=Object.freeze(Object.defineProperty({__proto__:null,HighlightDownsampleDrawParameters:Mee,build:PLe},Symbol.toStringTag,{value:"Module"}));let Iee=class Lee extends ii{initializeProgram(e){return new ei(e.rctx,Lee.shader.get().build(),oi)}initializePipeline(){return it({colorWrite:gt})}};Iee.shader=new ri(ALe,()=>j(()=>import("./HighlightDownsample.glsl-1bdb97e2.js"),["assets/HighlightDownsample.glsl-1bdb97e2.js","assets/vec2f64-30dc1443.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/vec2-528adfe4.js","assets/common-c186b691.js","assets/Texture2DPassUniform-753de459.js","assets/VertexAttribute-9c5c630d.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));let LB=class extends Ir{constructor(){super(...arguments),this.color=J0(1,0,1,1),this.haloColor=J0(1,0,1,1),this.haloOpacity=1,this.haloOpacityOccluded=.25,this.fillOpacity=.2,this.fillOpacityOccluded=.05,this.shadowColor=Bi(1,0,1,1),this.shadowOpacity=.15,this.occludedShadowOpacity=.075}};const OLe=32;class MLe{constructor(e,t){this._techniqueRep=e,this._rctx=t,this._viewportToRestore=yi(),this._passParameters=new LB,this._downsampleDrawParameters=new Mee,this._blurDrawParameters=new Pee,this._grid={coverageMipmap:null,vao:null,verticalCellCount:0,horizontalCellCount:0,cellPixelSize:0,mipmapLevels:0,viewportWidth:0,viewportHeight:0}}_assertResources(){if(this._quadVAO)return;this._quadVAO=La(this._rctx);const e={colorTarget:Vn.TEXTURE,depthStencilTarget:rs.NONE,width:0,height:0},t={target:bi.TEXTURE_2D,pixelFormat:St.RGBA,dataType:Xt.UNSIGNED_BYTE,samplingMode:Jt.LINEAR,wrapMode:ai.CLAMP_TO_EDGE,width:0,height:0};this._blur0Fbo=new yn(this._rctx,e,t),this._blur1Fbo=new yn(this._rctx,e,t),this._blurTechnique=this._techniqueRep.acquire(Aee),this._downsampleTechnique=this._techniqueRep.acquire(Iee),this._applyTechnique=this._techniqueRep.acquire(Eee)}dispose(){if(this._blurTechnique=Qi(this._blurTechnique),this._downsampleTechnique=Qi(this._downsampleTechnique),this._applyTechnique=Qi(this._applyTechnique),this._grid.coverageMipmap)for(let e=1;e<this._grid.coverageMipmap.length;e++)this._grid.coverageMipmap[e].dispose();this._grid.vao&&this._grid.vao.dispose(!0),this._quadVAO&&(this._quadVAO.dispose(!0),this._quadVAO=null),this._blur0Fbo=ke(this._blur0Fbo),this._blur1Fbo=ke(this._blur1Fbo)}setDefaultOptions(e){this._passParameters={...new LB,...e}}render(e,t,r){this._passParameters.highlightColorTexture=t.colorTexture,this._assertResources();const n=e.camera;im(this._viewportToRestore,n.fullViewport);const s=n.fullWidth,a=n.fullHeight,o=n.pixelRatio,l=Math.ceil(s/o),c=Math.ceil(a/o);this._blur0Fbo.resize(l,c),this._blur1Fbo.resize(l,c);const u=this._rctx;u.bindVAO(this._quadVAO);let d=null;this._gridUpdateResources(t,OLe),this._gridComputeMipmap(e),this._passParameters.coverageTexture=this._grid.coverageMipmap[this._grid.mipmapLevels].colorTexture,d=this._grid.vao;const m=u.bindTechnique(this._blurTechnique,this._passParameters,e);u.bindVAO(d),u.bindFramebuffer(this._blur0Fbo),u.setViewport(0,0,l,c),u.setClearColor(0,0,0,0),u.clear(Oi.COLOR_BUFFER_BIT),this._blurDrawParameters.blurInputTexture=t.colorTexture,rt(this._blurDrawParameters.blurSize,1/l,0),m.bindDraw(this._blurDrawParameters,e,this._passParameters),u.drawArrays(this._blurTechnique.primitiveType,0,Ws(d,"geometry")),u.bindFramebuffer(this._blur1Fbo),u.clear(Oi.COLOR_BUFFER_BIT),this._blurDrawParameters.blurInputTexture=this._blur0Fbo.colorTexture,rt(this._blurDrawParameters.blurSize,0,1/c),m.bindDraw(this._blurDrawParameters,e,this._passParameters),u.drawArrays(this._blurTechnique.primitiveType,0,Ws(d,"geometry")),u.bindFramebuffer(r),u.setViewport(this._viewportToRestore[0],this._viewportToRestore[1],this._viewportToRestore[2],this._viewportToRestore[3]),this._passParameters.blurColorTexture=this._blur1Fbo.colorTexture,u.bindTechnique(this._applyTechnique,this._passParameters,e),u.drawArrays(this._applyTechnique.primitiveType,0,Ws(d,"geometry")),u.bindVAO(null)}_gridUpdateResources(e,t){const r=this._rctx,n=this._grid;let s=!1;if(n.coverageMipmap===null&&(n.coverageMipmap=[e],s=!0),n.viewportWidth===e.width&&n.viewportHeight===e.height||(s=!0,n.viewportWidth=e.width,n.viewportHeight=e.height),n.coverageMipmap[0]=e,n.cellPixelSize!==t&&(n.cellPixelSize=t,s=!0),s){for(let l=1;l<n.coverageMipmap.length;l++)n.coverageMipmap[l].dispose();n.mipmapLevels=Math.ceil(Math.log(n.cellPixelSize)*Math.LOG2E),n.coverageMipmap.length=n.mipmapLevels+1;for(let l=0;l<n.mipmapLevels;l++){const c=n.coverageMipmap[l],u={target:bi.TEXTURE_2D,pixelFormat:St.RGB,dataType:Xt.UNSIGNED_SHORT_5_6_5,samplingMode:Jt.LINEAR,wrapMode:ai.CLAMP_TO_EDGE,width:Math.ceil(c.width/2),height:Math.ceil(c.height/2)},d={colorTarget:Vn.TEXTURE,depthStencilTarget:rs.NONE,width:Math.ceil(c.width/2),height:Math.ceil(c.height/2)};n.coverageMipmap[l+1]=new yn(r,d,u)}}const a=Math.ceil(e.height/n.cellPixelSize),o=Math.ceil(e.width/n.cellPixelSize);if(!n.vao||n.verticalCellCount!==a||n.horizontalCellCount!==o){n.verticalCellCount=a,n.horizontalCellCount=o;const l=a+1,c=o+1,u=1/a,d=1/o,m=6,f=4,_=new Float32Array(m*f*l*c);let g=0;for(let w=0;w<l;w++)for(let v=0;v<c;v++)_[g+0]=(v-.5)*d*2-1,_[g+1]=(w-.5)*u*2-1,_[g+2]=v*d,_[g+3]=w*u,_[g+4]=(v+.5)*d*2-1,_[g+5]=(w-.5)*u*2-1,_[g+6]=v*d,_[g+7]=w*u,_[g+8]=(v-.5)*d*2-1,_[g+9]=(w+.5)*u*2-1,_[g+10]=v*d,_[g+11]=w*u,_[g+12]=(v-.5)*d*2-1,_[g+13]=(w+.5)*u*2-1,_[g+14]=v*d,_[g+15]=w*u,_[g+16]=(v+.5)*d*2-1,_[g+17]=(w-.5)*u*2-1,_[g+18]=v*d,_[g+19]=w*u,_[g+20]=(v+.5)*d*2-1,_[g+21]=(w+.5)*u*2-1,_[g+22]=v*d,_[g+23]=w*u,g+=m*f;n.vao&&n.vao.dispose(!0),n.vao=new nu(r,oi,{geometry:jx},{geometry:ui.createVertex(r,mi.STATIC_DRAW,_)})}}_gridComputeMipmap(e){const t=this._rctx,r=this._grid,n=t.bindTechnique(this._downsampleTechnique,this._passParameters,e);t.bindVAO(this._quadVAO);for(let s=0;s<r.mipmapLevels;s++){t.bindFramebuffer(r.coverageMipmap[s+1]);const a=r.coverageMipmap[s+1].width,o=r.coverageMipmap[s+1].height;this._downsampleDrawParameters.inputTexture=r.coverageMipmap[s].colorTexture,rt(this._downsampleDrawParameters.invFramebufferDim,1/a,1/o),n.bindDraw(this._downsampleDrawParameters,e,this._passParameters),t.setViewport(0,0,a,o),t.drawArrays(kt.TRIANGLE_STRIP,0,Ws(this._quadVAO,"geometry"))}}get gpuMemoryUsage(){let e=(y(this._blur0Fbo)?this._blur0Fbo.gpuMemoryUsage:0)+(y(this._blur1Fbo)?this._blur1Fbo.gpuMemoryUsage:0);if(this._grid.coverageMipmap)for(const t of this._grid.coverageMipmap)e+=t.gpuMemoryUsage;return e}get test(){return{coverage:this._grid.coverageMipmap,blur:[this._blur0Fbo,this._blur1Fbo]}}}const ILe={dataType:Xt.UNSIGNED_BYTE,internalFormat:St.RGBA},LLe={};let $Le=class{constructor(e){this._rctx=e,this._activeTargets=new Set,this._depthTextures=new Map,this._depthBuffers=new Map,this._colorTextures=new Map,this._framebuffers=new Map,this.depthTextureSupported=e.capabilities.depthTexture}dispose(){this._depthBuffers.forEach(e=>e.dispose()),this._depthBuffers.clear(),this._depthTextures.forEach(e=>e.dispose()),this._depthTextures.clear(),this._colorTextures.forEach(e=>e.dispose()),this._colorTextures.clear(),this._framebuffers.forEach(e=>e.dispose()),this._framebuffers.clear(),this._activeTargets.clear()}disposeTargetResource(e){const t=e.id;this._activeTargets.has(t)&&(this._activeTargets.delete(t),this._disposeWithFramebuffers(this._depthTextures,t),this._disposeWithFramebuffers(this._depthBuffers,t),this._disposeWithFramebuffers(this._colorTextures,t))}_disposeWithFramebuffers(e,t){const r=e.get(t);r&&(this._framebuffers.forEach((n,s)=>{n.colorAttachment!==r&&n.depthStencilAttachment!==r||(n.detachAll(),n.dispose(),this._framebuffers.delete(s))}),r.dispose(),e.delete(t))}getDepthTexture(e,t){if(!this.depthTextureSupported)return null;let r=this._depthTextures.get(e.id);return!r||r.descriptor.width===t.width&&r.descriptor.height===t.height||(r.dispose(),r=mI()),r||(r=new Gi(this._rctx,{target:bi.TEXTURE_2D,pixelFormat:St.DEPTH_STENCIL,dataType:Xt.UNSIGNED_INT_24_8,samplingMode:Jt.NEAREST,wrapMode:ai.CLAMP_TO_EDGE,width:t.width,height:t.height}),this._depthTextures.set(e.id,r),this._activeTargets.add(e.id)),r}getAllocatedDepthTexture(e){return this._depthTextures.get(e.id)}getDepthBuffer(e,t){if(this.depthTextureSupported)return null;let r=this._depthBuffers.get(e.id);return r?r.descriptor.width===t.width&&r.descriptor.height===t.height||r.resize(t.width,t.height):(r=new nse(this._rctx,{internalFormat:Zne.DEPTH_STENCIL,...t}),this._depthBuffers.set(e.id,r),this._activeTargets.add(e.id)),r}getColorTexture(e,t){let r=this._colorTextures.get(e.id);return r&&(r.descriptor.width===t.width&&r.descriptor.height===t.height||(r.dispose(),r=mI())),r||(r=new Gi(this._rctx,{target:bi.TEXTURE_2D,pixelFormat:St.RGBA,internalFormat:e.internalFormat,dataType:e.dataType,samplingMode:e.samplingMode!=null?e.samplingMode:Jt.LINEAR,wrapMode:ai.CLAMP_TO_EDGE,width:t.width,height:t.height}),this._colorTextures.set(e.id,r),this._activeTargets.add(e.id)),r}getAllocatedColorTexture(e){return this._colorTextures.get(e.id)}registerDepthTarget(e={}){return{id:Sm(),...LLe,...e}}registerColorTarget(e={}){return{id:Sm(),...ILe,...e}}getFramebuffer(e,t,r){const n=this._getKey(t,r);let s=this._framebuffers.get(n);const a=this.getColorTexture(t,e);if(this.depthTextureSupported){const l=r?this.getDepthTexture(r,e):void 0;return s?((s.width!==e.width||s.height!==e.height||s.colorTexture!==a||s.depthStencilTexture!==l)&&(s.detachAll(),s.resize(e.width,e.height),s.attachColorTexture(a),s.attachDepthStencilTexture(l)),s):(s=y(r)?new yn(this._rctx,{colorTarget:Vn.TEXTURE,depthStencilTarget:rs.DEPTH_STENCIL_TEXTURE},a,l):new yn(this._rctx,{colorTarget:Vn.TEXTURE,depthStencilTarget:rs.NONE},a),this._framebuffers.set(n,s),s)}const o=r?this.getDepthBuffer(r,e):void 0;return s?((s.width!==e.width||s.height!==e.height||s.colorTexture!==a)&&(s.detachAll(),s.resize(e.width,e.height),s.attachColorTexture(a),s.attachDepthStencilBuffer(o)),s):(s=new yn(this._rctx,{colorTarget:Vn.TEXTURE,depthStencilTarget:r?rs.DEPTH_STENCIL_RENDER_BUFFER:rs.NONE},a,o),this._framebuffers.set(n,s),s)}_getKey(e,t){return`${e.id}_${t?t.id:"X"}_${e.name}${t?"_"+t.name:""}`}get gpuMemoryUsage(){let e=0;const t=new Set,r=n=>{t.has(n)||(t.add(n),e+=qE(n))};return this._depthTextures.forEach(r),this._colorTextures.forEach(r),this._depthBuffers.forEach(r),e}},DLe=class{constructor(e,t){this._rctx=e,this._compositingHelper=t,this._mainColorTarget=0,this._dimensions={width:4,height:4},this._background={type:"color",color:[0,0,0,1]};const r=e.type===Nn.WEBGL2;this._renderTargetHelper=new $Le(e);const n=this._renderTargetHelper;this._mainColorTargets=[n.registerColorTarget({name:"mainColorTarget0"}),n.registerColorTarget({name:"mainColorTarget1"})],this.frontFaceTarget=n.registerColorTarget({name:"frontFaceTarget"});const s=a=>n.registerColorTarget({name:a,dataType:Xt.FLOAT,internalFormat:r?ES.RGBA32F:St.RGBA,samplingMode:Jt.NEAREST});this.colorFloatTarget=s("colorFloatTarget"),this.alphaFloatTarget=s("alphaFloatTarget"),this.mainDepth=n.registerDepthTarget({name:"mainDepth"}),this.linearDepth=n.registerColorTarget({name:"linearDepth",samplingMode:Jt.NEAREST}),this.terrainLinearDepth=n.registerColorTarget({name:"terrainLinearDepth"}),this.geometryLinearDepth=n.registerColorTarget({name:"geometryLinearDepth"}),this.normal=n.registerColorTarget({name:"normal"}),this.highlight=n.registerColorTarget({name:"highlight",internalFormat:r?ES.RGBA4:St.RGBA,dataType:Xt.UNSIGNED_SHORT_4_4_4_4}),this.hudVisibility=n.registerColorTarget({name:"hudVisibility",internalFormat:r?ES.RGBA4:St.RGBA,dataType:Xt.UNSIGNED_SHORT_4_4_4_4}),this.tmpColor=n.registerColorTarget({name:"tmpColor"}),this.tmpDepth=n.registerDepthTarget({name:"tmpDepth"}),this.hudColor=n.registerColorTarget({name:"hudColor"})}dispose(){this._renderTargetHelper.dispose()}get width(){return this._dimensions.width}get height(){return this._dimensions.height}set background(e){this._background=e}get background(){return this._background}get currentColorTarget(){return this._mainColorTargets[this._mainColorTarget]}get previousColorTarget(){return this._mainColorTargets[1-this._mainColorTarget]}get framebuffer(){return this.getFramebuffer(this.currentColorTarget,this.mainDepth)}getFramebuffer(e,t){return this._renderTargetHelper.getFramebuffer(this._dimensions,e,t)}get colorTexture(){return this._renderTargetHelper.getAllocatedColorTexture(this.currentColorTarget)}get depthTexture(){return this._renderTargetHelper.getAllocatedDepthTexture(this.mainDepth)}get linearDepthTexture(){return this._renderTargetHelper.getAllocatedColorTexture(this.linearDepth)}get terrainLinearDepthTexture(){return this._renderTargetHelper.getAllocatedColorTexture(this.terrainLinearDepth)}get geometryLinearDepthTexture(){return this._renderTargetHelper.getAllocatedColorTexture(this.geometryLinearDepth)}get lastFrameColorTexture(){return this._renderTargetHelper.getAllocatedColorTexture(this.previousColorTarget)}get normalTexture(){return this._renderTargetHelper.getAllocatedColorTexture(this.normal)}get highlightTexture(){return this._renderTargetHelper.getAllocatedColorTexture(this.highlight)}get hudVisibilityTexture(){return this._getColorTexture(this.hudVisibility)}get tmpColorTexture(){return this._getColorTexture(this.tmpColor)}get hudColorTexture(){return this._getColorTexture(this.hudColor)}get mainColorTexture(){return this._getColorTexture(this.currentColorTarget)}setupRenderTarget(e){e||(this._mainColorTarget=0,this.disposeTarget(this._mainColorTargets[1])),this._mainColorTarget=this._mainColorTarget===0&&e?1:0}initializeFrame(e){const t=this._rctx;this._dimensions.width=e.fullWidth,this._dimensions.height=e.fullHeight,this.bindTarget(this.currentColorTarget,this.mainDepth),t.setClearStencil(0);const r=this._background.color;t.setClearColor(r[0]*r[3],r[1]*r[3],r[2]*r[3],r[3]),t.clearSafe(Oi.COLOR_BUFFER_BIT|Oi.DEPTH_BUFFER_BIT|Oi.STENCIL_BUFFER_BIT)}composite(e){y(this.colorTexture)&&this._compositingHelper.composite(e,this.colorTexture,Es.None)}renderTmpAndCompositeToMain(e,t,r,n=!1){this.renderToTargets(e,this.tmpColor,n?this.tmpDepth:this.mainDepth,FLe),this._compositingHelper.composite(t,this._getColorTexture(this.tmpColor),r)}renderHUDVisibility(e,t=!1){this.renderToTargets(e,this.hudVisibility,t?this.tmpDepth:this.mainDepth,NLe)}compositeTransparentTerrainOntoHUDVisibility(e){this.renderToTargets(()=>this._compositingHelper.compositeHUD(e,this._getColorTexture(this.tmpColor)),this.hudVisibility,this.tmpDepth)}renderOITPass(e,t,r){let n,s;switch(t){case qt.Color:n=this.colorFloatTarget,s=[0,0,0,0];break;case qt.Alpha:n=this.alphaFloatTarget,s=[1,1,1,1];break;case qt.FrontFace:n=this.frontFaceTarget,s=[0,0,0,0]}r?this.renderToTargets(e,n,this.tmpDepth,s,!0,!0):this.renderToTargets(e,n,this.mainDepth,s,!1)}compositeTransparentTerrainOntoMain(e){this.bindFramebuffer(),this._compositingHelper.composite(e,this._getColorTexture(this.tmpColor),Es.PremultipliedAlpha)}compositeOccludedOntoMain(e,t){this.bindFramebuffer(),this._compositingHelper.composite(e,this._getColorTexture(this.tmpColor),Es.PremultipliedAlpha,t)}compositeTransparentOntoOpaque(e,t){t?(this.bindTarget(this.hudColor,this.tmpDepth),this._rctx.setClearColor(0,0,0,1e-13),this._rctx.clearSafe(Oi.COLOR_BUFFER_BIT)):this.bindFramebuffer(),this._compositingHelper.compositeOIT(e,this._getColorTexture(this.colorFloatTarget),this._getColorTexture(this.alphaFloatTarget),this._getColorTexture(this.frontFaceTarget))}bindFramebuffer(){this._rctx.bindFramebuffer(this.framebuffer)}renderDepthDetached(e){this.bindTarget(this.currentColorTarget),e(),this.bindTarget(this.currentColorTarget,this.mainDepth)}disposeTarget(e){this._renderTargetHelper.disposeTargetResource(e)}renderToFBO(e,t,r=!1,n=!1){const s=this._rctx;let a=0;if(t){const l=Math.max(1e-13,t[3]);s.setClearColor(t[0],t[1],t[2],l),a|=Oi.COLOR_BUFFER_BIT}r&&(a|=Oi.DEPTH_BUFFER_BIT),n===!1?n=0:(n===!0&&(n=255),a|=Oi.STENCIL_BUFFER_BIT),a&&s.clearSafe(a,n),e(),s.gl.flush(),this.bindTarget(this.currentColorTarget,this.mainDepth)}renderToTargets(e,t,r,n,s=!1,a=!1){const o=this.bindTarget(t,r);return this.renderToFBO(e,n,s,a),o}bindTarget(e,t){const r=this._renderTargetHelper.getFramebuffer(this._dimensions,e,t);return this._rctx.bindFramebuffer(r),r}_getColorTexture(e){return this._renderTargetHelper.getColorTexture(e,this._dimensions)}get gpuMemoryUsage(){let e=0;return this._renderTargetHelper&&(e+=this._renderTargetHelper.gpuMemoryUsage),e}};const FLe=[0,0,0,0],NLe=[0,1,0,1];let kLe=class{constructor(e){this._context=e,this._renderPlugins=new Yt,this._slots=[];for(let t=0;t<le.MAX_SLOTS;++t)this._slots[t]=[]}add(e,t,r){const n=()=>{if(r!=null&&r.aborted)throw t.uninitializeRenderContext(),ts();this._renderPlugins.push(t);for(const a of e)this._slots[a].push(t);this._context.requestRender()},s=t.initializeRenderContext(this._context,r);if(kx(s))return s.then(n);n()}remove(e){if(this._renderPlugins.removeUnordered(e)!=null){for(let t=0;t<this._slots.length;++t)this._slots[t]=this._slots[t].filter(r=>r!==e);e.uninitializeRenderContext(),this._context.requestRender()}}prepareRender(){this._renderPlugins.forAll(e=>{e.prepareRender&&e.prepareRender(this._context.renderContext)})}updateAnimation(e){let t=!1;return this._renderPlugins.forAll(r=>{r.updateAnimation&&(t=r.updateAnimation(e)||t)}),t}render(){const e=this._slots[this._context.renderContext.bindParameters.slot],t=new Array;e.filter(r=>{if(!r.canRender)return!1;if(VLe(r)){const n=r.prepareTechnique(this._context.renderContext);return!!n&&(t.push(n),!0)}return t.push(null),!0}).forEach((r,n)=>r.render(this._context.renderContext,t[n]))}queryDepthRange(e){const t=ULe;return t.near=1/0,t.far=-1/0,this._renderPlugins.forAll(r=>{if(r.queryDepthRange){const n=r.queryDepthRange(e);n&&fv(t,n,t)}}),t}get needsTransparentPass(){return this._renderPlugins.some(e=>e.needsTransparentPass)}get needsHighlight(){return this._renderPlugins.some(e=>e.needsHighlight)}get needsLinearDepth(){return this._renderPlugins.some(e=>e.needsLinearDepth)}get needsLaserlineWithContrastControl(){const e=this._slots[le.LASERLINES_CONTRAST_CONTROL];return!!e&&e.length>0}get renderOccludedFlags(){return this._renderPlugins.reduce((e,t)=>e|t.renderOccludedFlags,0)}};function VLe(i){return"prepareTechnique"in i}const ULe={near:0,far:0};let $ee=class extends GG{};const tA=255,zLe=1/tA;function BLe(i){const e=new Yi,t=e.fragment;return t.include(i_),t.include(Ig),e.include(sF),e.include(Nd),e.include(BG,i),t.uniforms.add([new Ht("depthMap",r=>r.linearDepthTexture),new Ys("inverseViewMatrix",(r,n)=>kn($B,ru($B,n.camera.viewMatrix,n.camera.center))),new Zs("nearFar",(r,n)=>n.camera.nearFar)]),t.constants.add("sampleValue","float",zLe),t.code.add(A`void main(void) {
float depth = rgba2float(texture2D(depthMap, uv));
if (depth == 0.0) {
discard;
}
float currentPixelDepth = linearDepthFromFloat(depth, nearFar);
if (-currentPixelDepth > nearFar.y || -currentPixelDepth < nearFar.x) {
discard;
}
vec4 currentPixelPos = vec4(reconstructPosition(gl_FragCoord.xy, currentPixelDepth), 1.0);
vec4 worldSpacePos = inverseViewMatrix * currentPixelPos;
mat4 shadowMatrix;
float linearDepth = -currentPixelDepth;
int i = chooseCascade(linearDepth, shadowMatrix);
if (i >= numCascades) {
discard;
}
vec3 lvpos = lightSpacePosition(worldSpacePos.xyz, shadowMatrix);
if (lvpos.z >= 1.0 || lvpos.x < 0.0 || lvpos.x > 1.0 || lvpos.y < 0.0 || lvpos.y > 1.0) {
discard;
}
vec2 uvShadow = cascadeCoordinates(i, lvpos);
float depthShadow = readShadowMapDepth(uvShadow, shadowMapTex);
bool shadow = depthShadow < lvpos.z;
if (!shadow) {
discard;
}
gl_FragColor = vec4(sampleValue);
}`),e}const $B=xe(),GLe=Object.freeze(Object.defineProperty({__proto__:null,ShadowCastAccumulatePassParameters:$ee,shadowCastMaxSamples:tA,build:BLe},Symbol.toStringTag,{value:"Module"}));var Yg;(function(i){i[i.Gradient=0]="Gradient",i[i.Threshold=1]="Threshold",i[i.COUNT=2]="COUNT"})(Yg||(Yg={}));let G$=class extends $a{constructor(){super(...arguments),this.visualization=Yg.Gradient,this.bandsEnabled=!1}};h([k({count:Yg.COUNT})],G$.prototype,"visualization",void 0),h([k()],G$.prototype,"bandsEnabled",void 0);function HLe(i){const e=new Yi,t=e.fragment;t.include(i_),t.include(Ig),e.include(sF),e.include(Nd);const{visualization:r,bandsEnabled:n}=i;t.constants.add("inverseSampleValue","float",tA),t.uniforms.add([new Ht("shadowCastMap",o=>o.shadowCastMap),new Pt("sampleScale",o=>o.sampleScale),new Pt("opacityFromElevation",o=>o.opacityFromElevation),new Xh("uColor",o=>o.color)]);const s=r===Yg.Gradient,a=r===Yg.Threshold;return s&&n?t.uniforms.add(new Pt("bandSize",o=>o.bandSize)):a&&t.uniforms.add(new Pt("threshold",o=>o.threshold)),t.code.add(A`
      void main(void) {
        vec4 record = texture2D(shadowCastMap, uv);
        float pixelSamples = record.r * inverseSampleValue;
        if (pixelSamples < 1.0) {
          discard;
        }

        float strength = pixelSamples * sampleScale;

        ${a?A`
            if (strength <= threshold) {
              discard;
            }`:""}

        ${s&&n?A`strength = ceil(strength / bandSize) * bandSize;`:""}

        gl_FragColor = vec4(uColor.xyz, uColor.a * opacityFromElevation ${s?A`* strength`:""});
      }
    `),e}const jLe=Object.freeze(Object.defineProperty({__proto__:null,build:HLe},Symbol.toStringTag,{value:"Module"}));let Dee=class Fee extends ii{constructor(e,t){super(e,t,()=>this.destroy())}initializeProgram(e){return new ei(e.rctx,Fee.shader.get().build(this.configuration),oi)}initializePipeline(){return it({blending:Hl,colorWrite:gt,depthTest:null,depthWrite:null})}get primitiveType(){return kt.TRIANGLE_STRIP}};Dee.shader=new ri(jLe,()=>j(()=>import("./ShadowCastVisualize.glsl-1d5189c2.js"),["assets/ShadowCastVisualize.glsl-1d5189c2.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/VertexAttribute-9c5c630d.js","assets/vec2-528adfe4.js","assets/common-c186b691.js","assets/vec2f64-30dc1443.js","assets/vec4-790471c0.js","assets/vec4f64-e407da96.js","assets/Texture2DPassUniform-753de459.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));const qLe=Bi(.01,0,.25,1),WLe=4e4,XLe=5e4,Nee=1/512;let RE=class extends pe{constructor(i,e,t,r){super({}),this._techniqueRepository=i,this._rctx=e,this._shadowAccumulator=t,this._requestRender=r,this._passParameters={shadowCastMap:this._shadowCastTexture,sampleScale:0,color:qLe,threshold:.5,bandSize:.1,opacityFromElevation:1,__tagStrict:"NoParameters"},this._techniqueConfig=new G$,this._enabled=!1,this._vao=La(e),this._techniqueConfig.visualization=Yg.Gradient}normalizeCtorArgs(){return{}}dispose(){this._stop(),this._vao=ke(this._vao),this._techniqueRepository.release(this._technique),this._technique=null,this._shadowAccumulator=null}get _visualizeShadowCastTechnique(){return this._technique=this._techniqueRepository.releaseAndAcquire(Dee,this._techniqueConfig,this._technique),this._technique}render(i){if(!this._isRenderingVisualization)return;this._passParameters.sampleScale=1/this._computedSamples;const e=this._visualizeShadowCastTechnique;this._rctx.bindVAO(this._vao),this._rctx.bindTechnique(e,this._passParameters,i),this._rctx.drawArrays(e.primitiveType,0,Ws(this._vao,"geometry"))}setOptions(i){i.enabled!==void 0&&this._setEnabled(i.enabled),i.color!==void 0&&this._setColor(i.color),i.threshold!==void 0&&(this._threshold=i.threshold),i.visualization!==void 0&&(this._visualization=i.visualization),i.bandSize!==void 0&&(this._bandSize=i.bandSize),i.bandsEnabled!==void 0&&(this._bandsEnabled=i.bandsEnabled)}get opacityFromElevation(){return this._passParameters.opacityFromElevation}set opacityFromElevation(i){this._passParameters.opacityFromElevation!==i&&(this._passParameters.opacityFromElevation=i,this.notifyChange("opacityFromElevation"))}get _isRenderingVisualization(){return this._enabled&&this._computedSamples>0&&this.opacityFromElevation>Nee}get _computedSamples(){return this._shadowAccumulator.computedSamples}get _shadowCastTexture(){return this._shadowAccumulator.shadowCastTexture}get _threshold(){return this._passParameters.threshold}set _threshold(i){this._threshold!==i&&(this._passParameters.threshold=i,this._requestRenderIfRunning())}get _visualization(){return this._techniqueConfig.visualization}set _visualization(i){i!==this._visualization&&(this._techniqueConfig.visualization=i,this._techniqueRepository.release(this._technique),this._technique=null,this._requestRenderIfRunning())}get _bandSize(){return this._passParameters.bandSize}set _bandSize(i){i!==this._bandSize&&(this._passParameters.bandSize=i,this._requestRenderIfRunning())}get _bandsEnabled(){return this._techniqueConfig.bandsEnabled}set _bandsEnabled(i){i!==this._bandsEnabled&&(this._techniqueConfig.bandsEnabled=i,this._techniqueRepository.release(this._technique),this._technique=null,this._requestRenderIfRunning())}_setColor(i){const e=this._passParameters.color;NI(i,e)||(im(this._passParameters.color,i),this._requestRenderIfRunning())}_setEnabled(i){i!==this._enabled&&(i?this._start():this._stop())}_requestRenderIfRunning(){this._enabled&&this._requestRender()}_start(){this._enabled=!0,this._requestRender()}_stop(){this._enabled=!1,this._requestRender()}};h([p()],RE.prototype,"opacityFromElevation",null),RE=h([F("esri.views.3d.webgl-engine.lib.ShadowCastRenderer")],RE);let SR=class extends $a{constructor(){super(...arguments),this.receiveShadows=!0,this.hasWebGL2Context=!1}};h([k()],SR.prototype,"receiveShadows",void 0),h([k()],SR.prototype,"hasWebGL2Context",void 0);let kee=class Vee extends ii{constructor(e){super(e,new SR,()=>this.destroy())}initializeConfiguration(e,t){t.hasWebGL2Context=e.rctx.type===Nn.WEBGL2}initializeProgram(e){return new ei(e.rctx,Vee.shader.get().build(this.configuration),oi)}initializePipeline(){return it({blending:Gn(me.ONE,me.ONE,me.ONE,me.ONE),colorWrite:gt,depthTest:null,depthWrite:null})}get primitiveType(){return kt.TRIANGLE_STRIP}};kee.shader=new ri(GLe,()=>j(()=>import("./ShadowCastAccumulate.glsl-949c642d.js"),["assets/ShadowCastAccumulate.glsl-949c642d.js","assets/mat4-44a0988f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/mat4f64-1e28eae0.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/VertexAttribute-9c5c630d.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/Texture2DPassUniform-753de459.js","assets/vec4-790471c0.js","assets/vec4f64-e407da96.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));var Cb;let _s=Cb=class extends pe{constructor(i,e,t,r,n,s){super({}),this._rctx=i,this._stage=t,this._prepareForShadowMapPass=r,this._renderToShadowMap=n,this._requestRender=s,this._progress=0,this._sampleCount=0,this._passParameters=new $ee,this._enabledInternal=!1,this._cachedLightDirections=[],this._depthRange=k$,this._previewingCached=!1,this._handles=new Vt,this._cameraForcedForScreenshot=!1,this._bindParameters=new AP(new I4(i,t.viewingMode),null,null),this._bindParameters.shadowMap.enabled=!0,this._bindParameters.camera=new vi,this._vao=La(i);const a={colorTarget:Vn.TEXTURE,depthStencilTarget:rs.NONE,width:0,height:0},o={target:bi.TEXTURE_2D,pixelFormat:St.RGBA,dataType:Xt.UNSIGNED_BYTE,samplingMode:Jt.LINEAR,wrapMode:ai.CLAMP_TO_EDGE,width:0,height:0};this._fbo=new yn(i,a,o),this._accumulationRenderer=new RE(e,i,this,s);const l=this._stage.resourceController.scheduler;this._handles.add(l.registerTask(dr.SHADOW_ACCUMULATOR,this)),this._handles.add(B(()=>t.renderView,c=>{this._handles.remove(Cb.renderViewHandleKey),C(c)||this._handles.add(c.events.on("force-camera-for-screenshot",()=>this._cameraForcedForScreenshot=!0),Cb.renderViewHandleKey)},Mi))}normalizeCtorArgs(){return{}}get computedSamples(){return this._progress}get shadowCastTexture(){return this._fbo.colorTexture}get isAccumulating(){return this._isPreviewing||this._isRefining}get _accumulationTechnique(){if(C(this._accumulationTechniqueCached)){const i={rctx:this._rctx,viewingMode:this._stage.viewingMode};this._accumulationTechniqueCached=new kee(i)}return this._accumulationTechniqueCached}get _isRefining(){return this._isActive&&!this._isDoneAccumulating&&!this._previewingCached}get _isPreviewing(){return this._isActive&&this._previewingCached}get _isActive(){return this._enabledInternal&&this._sampleCount>0}get canAccumulate(){return this._passParameters.linearDepthTexture!==null&&this._depthRange!==k$&&this._opacityFromElevation>Nee}get _isDoneAccumulating(){return this._progress>=this._sampleCount}get _lightDirectionsInternal(){return this._cachedLightDirections}set _lightDirectionsInternal(i){const e=this._cachedLightDirections;if(cD(e,i,Og))return;const t=i.length;e.length=t,this._sampleCount=Math.min(tA,t);for(let r=0;r<t;++r){const n=i[r],s=e[r]||P();X(s,n),e[r]=s}this._invalidate()}get _opacityFromElevation(){return this._accumulationRenderer.opacityFromElevation}set _opacityFromElevation(i){this._accumulationRenderer.opacityFromElevation=i}get running(){return this._isRefining&&this.canAccumulate&&this._progress>0}runTask(i){for(this._prepareForShadowMapPass(this._bindParameters);!i.done&&!this._isDoneAccumulating;)this._accumulateShadow(),i.madeProgress();this._requestRender()}renderAccumulation(i,e,t,r){if(this._passParameters.linearDepthTexture=i,this._depthRange=e,this._updateCamera(t),this._bindParameters.contentCamera=r,this.notifyChange("canAccumulate"),!this.isAccumulating||!this.canAccumulate)return;(this._previewingCached||this._progress===0||this._cameraForcedForScreenshot)&&this._clear();const n=this._cameraForcedForScreenshot?this._sampleCount:Math.min(Cb.previewSamples,this._sampleCount-this._progress);for(let s=0;s<n;++s)this._accumulateShadow();this._cameraForcedForScreenshot=!1}render(i){this._accumulationRenderer.render(i)}dispose(){this._stop(),this._handles.destroy(),this._accumulationRenderer=ke(this._accumulationRenderer),this._bindParameters.shadowMap.dispose(),this._fbo=ke(this._fbo),this._vao=ke(this._vao),this._accumulationTechniqueCached=Qi(this._accumulationTechniqueCached),this._cachedLightDirections.length=0,this._sampleCount=0}setOptions(i){i.enabled!==void 0&&(this._enabled=i.enabled),i.previewing!==void 0&&(this._previewing=i.previewing),i.lightDirections!==void 0&&(this._lightDirections=i.lightDirections),this._accumulationRenderer.setOptions(i)}set _previewing(i){this._previewingCached!==i&&(this._previewingCached=i,this._requestRenderIfEnabled())}set _lightDirections(i){this._lightDirectionsInternal=i}readAccumulatedShadow(i,e){if(!this._isActive||this._progress<1||i<0||i>this._fbo.width||e<0||e>this._fbo.height)return 0;const t=QLe;return this._fbo.readPixels(i,e,1,1,St.RGBA,Xt.UNSIGNED_BYTE,t),t[0]/this._progress}_start(){this._progress=0,this._enabledInternal=!0}_stop(){this._enabledInternal=!1}_invalidate(){this._progress=0,this._requestRenderIfEnabled()}_clear(){this._rctx.bindFramebuffer(this._fbo),this._rctx.setClearColor(0,0,0,0),this._rctx.clearSafe(Oi.COLOR_BUFFER_BIT),this._progress=0}_accumulateShadow(){const i=this._lightDirectionsInternal[this._progress];this._renderToShadowMap(this._bindParameters,i,this._depthRange),this._passParameters.origin=this._bindParameters.camera.center,this._rctx.bindFramebuffer(this._fbo);const e=this._accumulationTechnique;this._rctx.bindTechnique(e,this._passParameters,this._bindParameters),this._rctx.bindVAO(this._vao),this._rctx.drawArrays(e.primitiveType,0,Ws(this._vao,"geometry")),this._progress++}_updateCamera(i){i.equals(this._bindParameters.camera)||(this._bindParameters.camera.copyFrom(i),this._fbo.resize(i.fullWidth,i.fullHeight),this._opacityFromElevation=1-G0(WLe,XLe,i.relativeElevation))}set _enabled(i){i!==this._enabledInternal&&(i?this._start():this._stop())}_requestRenderIfEnabled(){this._enabledInternal&&this._requestRender()}get test(){const i=this;return{lightDirections:this._lightDirectionsInternal,get isDone(){return i._isDoneAccumulating},get isActive(){return i._isActive}}}};_s.previewSamples=6,_s.renderViewHandleKey="renderView",h([p()],_s.prototype,"_progress",void 0),h([p()],_s.prototype,"_sampleCount",void 0),h([p()],_s.prototype,"_enabledInternal",void 0),h([p()],_s.prototype,"_depthRange",void 0),h([p()],_s.prototype,"_previewingCached",void 0),h([p()],_s.prototype,"_accumulationRenderer",void 0),h([p()],_s.prototype,"_isRefining",null),h([p()],_s.prototype,"_isActive",null),h([p()],_s.prototype,"canAccumulate",null),h([p()],_s.prototype,"_isDoneAccumulating",null),h([p()],_s.prototype,"_opacityFromElevation",null),h([p()],_s.prototype,"running",null),_s=Cb=h([F("esri.views.3d.webgl-engine.lib.ShadowAccumulator")],_s);const QLe=new Uint8Array(4),DB={highlightedThreshold:.99999,selfShadowThreshold:.025};function ZLe(i){const e=new Yi;e.include(zG,i);const t=e.fragment;return t.include(i_),t.include(Ig),e.include(sF),e.include(Nd),t.uniforms.add([new Ht("defaultDepthTex",(r,n)=>n.shadowMap.getSnapshot(dv.Default)),new Ht("highlightDepthTex",(r,n)=>n.shadowMap.getSnapshot(dv.Highlight)),new Ht("depthMap",(r,n)=>n.linearDepthTexture),new Ht("highlightMap",(r,n)=>n.highlightColorTexture),new Xh("uColor",r=>r.shadowColor),new Zs("nearFar",(r,n)=>n.camera.nearFar),new Pt("opacity",r=>r.shadowOpacity),new Pt("occludedOpacity",r=>r.occludedShadowOpacity),new Pt("terminationFactor",r=>r.opacityElevation*r.dayNightTerminator),new Ps("lightingMainDirectionView",(r,n)=>de(NB,Me(NB,n.lighting.mainLight.direction,n.camera.viewInverseTransposeMatrix))),new Zs("texelSize",(r,n)=>y(n.linearDepthTexture)?rt(YLe,1/n.linearDepthTexture.descriptor.width,1/n.linearDepthTexture.descriptor.height):Ag),new Ys("inverseViewMatrix",(r,n)=>kn(FB,ru(FB,n.camera.viewMatrix,n.camera.center)))]),t.constants.add("unoccludedHighlightFlag","vec4",aoe).add("highlightedThreshold","float",DB.highlightedThreshold).add("selfShadowThreshold","float",DB.selfShadowThreshold),t.code.add(A`vec3 normalFromDepth(vec3 pixelPos, vec2 fragCoord, vec2 uv, vec2 texelSize, sampler2D depthMap, vec2 nearFar) {
float leftPixelDepth = linearDepthFromTexture(depthMap, uv + vec2(-1.0, 0.0) * texelSize, nearFar);
float rightPixelDepth = linearDepthFromTexture(depthMap, uv + vec2(1.0, 0.0) * texelSize, nearFar);
float bottomPixelDepth = linearDepthFromTexture(depthMap, uv + vec2(0.0, -1.0) * texelSize, nearFar);
float topPixelDepth = linearDepthFromTexture(depthMap, uv + vec2(0.0, 1.0) * texelSize, nearFar);
bool pickLeft = abs(pixelPos.z - leftPixelDepth) < abs(pixelPos.z - rightPixelDepth);
bool pickBottom = abs(pixelPos.z - bottomPixelDepth) < abs(pixelPos.z - topPixelDepth);
vec3 fragCoordHorizontal = pickLeft
? vec3(fragCoord + vec2(-1.0, 0.0), leftPixelDepth)
: vec3(fragCoord + vec2(1.0, 0.0), rightPixelDepth);
vec3 fragCoordVertical = pickBottom
? vec3(fragCoord + vec2(0.0, -1.0), bottomPixelDepth)
: vec3(fragCoord + vec2(0.0, 1.0), topPixelDepth);
vec3 verticalPixelPos = reconstructPosition(fragCoordHorizontal.xy, fragCoordHorizontal.z);
vec3 horizontalPixelPos = reconstructPosition(fragCoordVertical.xy, fragCoordVertical.z);
vec3 normal = normalize(cross(verticalPixelPos - pixelPos, horizontalPixelPos - pixelPos));
return pickLeft == pickBottom ? normal : -normal;
}`),t.code.add(A`void main(void) {
vec4 highlightInfo = texture2D(highlightMap, uv);
float visiblyHighlighted = (1.0 - clamp(distance(unoccludedHighlightFlag, highlightInfo), 0.0, 1.0)) * highlightInfo.a;
if (visiblyHighlighted > highlightedThreshold) {
discard;
}
float depth = rgba2float(texture2D(depthMap, uv));
if (depth == 0.0) {
discard;
}
float currentPixelDepth = linearDepthFromFloat(depth, nearFar);
if (-currentPixelDepth>nearFar.y || -currentPixelDepth<nearFar.x) {
discard;
}
vec4 currentPixelPos = vec4(reconstructPosition(gl_FragCoord.xy, currentPixelDepth), 1.0);
vec4 worldSpacePos = inverseViewMatrix * currentPixelPos;
mat4 shadowMatrix;
float linearDepth = -currentPixelDepth;
int i = chooseCascade(linearDepth, shadowMatrix);
if (i >= numCascades) {
discard;
}
vec3 lvpos = lightSpacePosition(worldSpacePos.xyz, shadowMatrix);
if (lvpos.z >= 1.0 || lvpos.x < 0.0 || lvpos.x > 1.0 || lvpos.y < 0.0 || lvpos.y > 1.0) {
discard;
}
vec2 uvShadow = cascadeCoordinates(i, lvpos);
float depthHighlight = readShadowMapDepth(uvShadow, highlightDepthTex);
bool shadowHighlight = depthHighlight < lvpos.z;
if (!shadowHighlight) {
discard;
}
float depthDefault = readShadowMapDepth(uvShadow, defaultDepthTex);
bool shadowDefault = depthDefault < lvpos.z;
vec3 normal = normalFromDepth(currentPixelPos.xyz, gl_FragCoord.xy, uv, texelSize, depthMap, nearFar);
bool shaded = dot(normal, lightingMainDirectionView) < selfShadowThreshold;
float fragOpacity = (shadowDefault || shaded) ? occludedOpacity : opacity;
gl_FragColor = vec4(uColor.rgb, uColor.a * fragOpacity * terminationFactor);
}`),e}const FB=xe(),NB=P(),YLe=Te(),KLe=Object.freeze(Object.defineProperty({__proto__:null,build:ZLe},Symbol.toStringTag,{value:"Module"}));let JLe=class extends Ir{constructor(){super(...arguments),this.shadowColor=Bi(1,0,1,1),this.shadowOpacity=.2,this.occludedShadowOpacity=.1,this.opacityElevation=1,this.dayNightTerminator=1}},Uee=class zee extends ii{constructor(e){super(e,new SR,()=>this.destroy())}initializeConfiguration(e,t){t.hasWebGL2Context=e.rctx.type===Nn.WEBGL2}initializeProgram(e){return new ei(e.rctx,zee.shader.get().build(this.configuration),oi)}initializePipeline(){return it({blending:Gn(me.SRC_ALPHA,me.ONE,me.ONE_MINUS_SRC_ALPHA,me.ONE_MINUS_SRC_ALPHA),colorWrite:gt,depthTest:null,depthWrite:null})}get primitiveType(){return kt.TRIANGLE_STRIP}};Uee.shader=new ri(KLe,()=>j(()=>import("./ShadowHighlight.glsl-e3a4d470.js"),["assets/ShadowHighlight.glsl-e3a4d470.js","assets/mat4-44a0988f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/mat4f64-1e28eae0.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/vec3-e93e648f.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/VertexAttribute-9c5c630d.js","assets/vec4f64-e407da96.js","assets/Texture2DPassUniform-753de459.js","assets/vec4-790471c0.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));const e3e=.001953125,t3e=4e4,i3e=5e4;let r3e=class{constructor(e,t){this._rctx=e,this._viewingMode=t,this._maxOpacity=1,this._passParameters=new JLe,this._drawParameters=new GG,this._vao=La(this._rctx)}get _technique(){return C(this._techniqueCached)&&(this._techniqueCached=new Uee({rctx:this._rctx,viewingMode:this._viewingMode})),this._techniqueCached}render(e,t){if(!e.shadowMap.enabled||!e.linearDepthTexture||!this.isVisible)return;const r=this._technique;this._drawParameters.origin=e.camera.center,this._rctx.bindFramebuffer(t),this._rctx.bindTechnique(r,this._passParameters,e).bindDraw(this._drawParameters,e,this._passParameters),this._rctx.bindVAO(this._vao),this._rctx.drawArrays(r.primitiveType,0,Ws(this._vao,"geometry"))}get gpuMemoryUsage(){var e;return((e=this._vao)==null?void 0:e.size)??0}setDefaultOptions(e){this._passParameters={...this._passParameters,...e},this._updateMaxOpacity()}updateParameters(e,t){this._passParameters.opacityElevation=1-G0(t3e,i3e,e.relativeElevation);const r=this._viewingMode===Ie.Global?de(kB,e.center):Y(kB,0,0,1),n=_e(r,t);this._passParameters.dayNightTerminator=G0(0,1,ue(30*n,0,1))}dispose(){this._vao=ke(this._vao),this._techniqueCached=Qi(this._techniqueCached)}get isVisible(){const{opacityElevation:e,dayNightTerminator:t}=this._passParameters;return this._maxOpacity*e*t>=e3e}_updateMaxOpacity(){const e=Math.max(this._passParameters.shadowOpacity,this._passParameters.occludedShadowOpacity);this._maxOpacity=e*this._passParameters.shadowColor[3]}};const kB=P(),VB=zd();let n3e=class{constructor(){this._plane=zd()}get isEnabled(){return!NQ(this.plane,VB)}get plane(){return this._plane}set plane(e){c_(e||VB,this._plane)}},s3e=class extends Ir{};function Mx(i){i.uniforms.add(new Xh("resolution",e=>Qs(a3e,1/e.colorTexture.descriptor.width,1/e.colorTexture.descriptor.height,e.colorTexture.descriptor.width,e.colorTexture.descriptor.height)))}const a3e=yi(),hy={maxSearchSteps:8,maxDistanceAreaTex:16};function o3e(){const i=new Yi,{attributes:e,varyings:t,vertex:r,fragment:n}=i;return e.add(S.POSITION,"vec2"),t.add("fTexCoord","vec2"),t.add("fOffset[3]","vec4"),t.add("fPixCoord","vec2"),Mx(r),r.code.add(A`
      void SMAABlendingWeightCalculationVS( vec2 texcoord ) {
        fPixCoord = texcoord * resolution.zw;
        fOffset[0] = texcoord.xyxy + resolution.xyxy * vec4( -0.25, 0.125, 1.25, 0.125 );
        fOffset[1] = texcoord.xyxy + resolution.xyxy * vec4( -0.125, 0.25, -0.125, -1.25 );
        fOffset[2] = vec4( fOffset[0].xz, fOffset[1].yw ) + vec4( -2.0, 2.0, -2.0, 2.0 ) * resolution.xxyy * float( ${A.int(hy.maxSearchSteps)} );
      }

      void main() {
        fTexCoord = (position + 1.0 ) * 0.5;
        gl_Position = vec4(position, 0, 1);
        SMAABlendingWeightCalculationVS( fTexCoord );
      }
    `),n.uniforms.add(new Ht("tEdges",s=>s.edges.colorTexture)),n.uniforms.add(new Ht("tArea",s=>s.areaTexture)),n.uniforms.add(new Ht("tSearch",s=>s.searchTexture)),n.uniforms.add(new Ht("tColor",s=>s.colorTexture)),Mx(n),n.code.add(A`
      #define SMAA_AREATEX_PIXEL_SIZE ( 1.0 / vec2( 160.0, 560.0 ) )
      #define SMAA_AREATEX_SUBTEX_SIZE ( 1.0 / 7.0 )

      vec4 SMAASampleLevelZeroOffset(sampler2D texture, vec2 coord, vec2 offset) {
        return texture2D(texture, coord + offset.x * resolution.xy, 0.0);
      }

      vec2 round( vec2 x ) {
        return sign( x ) * floor( abs( x ) + 0.5 );
      }

      float SMAASearchLength( sampler2D searchTex, vec2 e, float bias, float scale ) {
        e.r = bias + e.r * scale;
        return 255.0 * texture2D( searchTex, e, 0.0 ).r;
      }

      float SMAASearchXLeft( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
        vec2 e = vec2( 0.0, 1.0 );
        for ( int i = 0; i < ${A.int(hy.maxSearchSteps)}; i ++ ) {
          e = texture2D( edgesTex, texcoord, 0.0 ).rg;
          texcoord -= vec2( 2.0, 0.0 ) * resolution.xy;
          if ( ! ( texcoord.x > end && e.g > 0.8281 && e.r == 0.0 ) ) break;
        }
        texcoord.x += 0.25 * resolution.x;
        texcoord.x += resolution.x;
        texcoord.x += 2.0 * resolution.x;
        texcoord.x -= resolution.x * SMAASearchLength(searchTex, e, 0.0, 0.5);
        return texcoord.x;
      }

      float SMAASearchXRight( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
        vec2 e = vec2( 0.0, 1.0 );
        for ( int i = 0; i < ${A.int(hy.maxSearchSteps)}; i ++ ) {
          e = texture2D( edgesTex, texcoord, 0.0 ).rg;
          texcoord += vec2( 2.0, 0.0 ) * resolution.xy;
          if ( ! ( texcoord.x < end && e.g > 0.8281 && e.r == 0.0 ) ) break;
        }
        texcoord.x -= 0.25 * resolution.x;
        texcoord.x -= resolution.x;
        texcoord.x -= 2.0 * resolution.x;
        texcoord.x += resolution.x * SMAASearchLength( searchTex, e, 0.5, 0.5 );
        return texcoord.x;
      }

      float SMAASearchYUp( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
        vec2 e = vec2( 1.0, 0.0 );
        for ( int i = 0; i < ${A.int(hy.maxSearchSteps)}; i ++ ) {
          e = texture2D( edgesTex, texcoord, 0.0 ).rg;
          texcoord += vec2( 0.0, 2.0 ) * resolution.xy;
          if ( ! ( texcoord.y > end && e.r > 0.8281 && e.g == 0.0 ) ) break;
        }
        texcoord.y -= 0.25 * resolution.y;
        texcoord.y -= resolution.y;
        texcoord.y -= 2.0 * resolution.y;
        texcoord.y += resolution.y * SMAASearchLength( searchTex, e.gr, 0.0, 0.5 );
        return texcoord.y;
      }

      float SMAASearchYDown( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
        vec2 e = vec2( 1.0, 0.0 );
        for ( int i = 0; i < ${A.int(hy.maxSearchSteps)}; i ++ ) {
          e = texture2D( edgesTex, texcoord, 0.0 ).rg;
          texcoord -= vec2( 0.0, 2.0 ) * resolution.xy;
          if ( ! ( texcoord.y < end && e.r > 0.8281 && e.g == 0.0 ) ) break;
        }
        texcoord.y += 0.25 * resolution.y;
        texcoord.y += resolution.y;
        texcoord.y += 2.0 * resolution.y;
        texcoord.y -= resolution.y * SMAASearchLength( searchTex, e.gr, 0.5, 0.5 );
        return texcoord.y;
      }

      vec2 SMAAArea( sampler2D areaTex, vec2 dist, float e1, float e2, float offset ) {
        vec2 texcoord = float( ${A.int(hy.maxDistanceAreaTex)} ) * round( 4.0 * vec2( e1, e2 ) ) + dist;
        texcoord = SMAA_AREATEX_PIXEL_SIZE * texcoord + ( 0.5 * SMAA_AREATEX_PIXEL_SIZE );
        texcoord.y += SMAA_AREATEX_SUBTEX_SIZE * offset;
        return texture2D( areaTex, texcoord, 0.0 ).rg;
      }

      vec4 SMAABlendingWeightCalculationPS( vec2 texcoord, vec2 pixcoord, vec4 offset[ 3 ], sampler2D edgesTex, sampler2D areaTex, sampler2D searchTex, ivec4 subsampleIndices ) {
        vec4 weights = vec4( 0.0, 0.0, 0.0, 0.0 );
        vec2 e = texture2D( edgesTex, texcoord ).rg;
        if ( e.g > 0.0 ) {
          vec2 d;
          vec2 coords;
          coords.x = SMAASearchXLeft( edgesTex, searchTex, offset[ 0 ].xy, offset[ 2 ].x );
          coords.y = offset[ 1 ].y;
          d.x = coords.x;
          float e1 = texture2D( edgesTex, coords, 0.0 ).r;
          coords.x = SMAASearchXRight( edgesTex, searchTex, offset[ 0 ].zw, offset[ 2 ].y );
          d.y = coords.x;
          d = d * resolution.z - pixcoord.x;
          vec2 sqrt_d = sqrt( abs( d ) );
          coords.y -= 1.0 * resolution.y;
          float e2 = SMAASampleLevelZeroOffset( edgesTex, coords, vec2( 1.0, 0.0 ) ).r;
          weights.rg = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.y ) );
        }

        if ( e.r > 0.0 ) {
          vec2 d;
          vec2 coords;
          coords.y = SMAASearchYUp( edgesTex, searchTex, offset[ 1 ].xy, offset[ 2 ].z );
          coords.x = offset[ 0 ].x;
          d.x = coords.y;
          float e1 = texture2D( edgesTex, coords, 0.0 ).g;
          coords.y = SMAASearchYDown( edgesTex, searchTex, offset[ 1 ].zw, offset[ 2 ].w );
          d.y = coords.y;
          d = d * resolution.w - pixcoord.y;
          vec2 sqrt_d = sqrt( abs( d ) );
          coords.y -= 1.0 * resolution.y;
          float e2 = SMAASampleLevelZeroOffset( edgesTex, coords, vec2( 0.0, 1.0 ) ).g;
          weights.ba = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.x ) );

          // for some reason the following lines are necessary to prevent
          // texture lookup precision issues on some Intel integrated graphics chips
          vec4 dbg = (offset[ 0 ]+offset[ 1 ]+offset[ 2 ] + coords.xyyx);
          weights.r += 0.00000001 * dot(vec4(0,1,0,1),dbg);
        }
        return weights;
      }

      void main() {
        gl_FragColor = SMAABlendingWeightCalculationPS( fTexCoord, fPixCoord, fOffset, tEdges, tArea, tSearch, ivec4( 0.0 ) );
      }
    `),i}const l3e=Object.freeze(Object.defineProperty({__proto__:null,build:o3e},Symbol.toStringTag,{value:"Module"}));let Bee=class Gee extends ii{initializeProgram(e){return new ei(e.rctx,Gee.shader.get().build(),oi)}initializePipeline(){return it({colorWrite:gt})}};Bee.shader=new ri(l3e,()=>j(()=>import("./BlendWeights.glsl-239b2dd7.js"),["assets/BlendWeights.glsl-239b2dd7.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/vec2-528adfe4.js","assets/common-c186b691.js","assets/vec2f64-30dc1443.js","assets/Texture2DPassUniform-753de459.js","assets/VertexAttribute-9c5c630d.js","assets/vec4-790471c0.js","assets/vec4f64-e407da96.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));function c3e(){const i=new Yi,{attributes:e,varyings:t,vertex:r,fragment:n}=i;return e.add(S.POSITION,"vec2"),t.add("fTexCoord","vec2"),t.add("fOffset[2]","vec4"),Mx(r),r.code.add(A`void SMAANeighborhoodBlendingVS( vec2 texcoord ) {
fOffset[0] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0, 1.0 );
fOffset[1] = texcoord.xyxy + resolution.xyxy * vec4( 1.0, 0.0, 0.0, -1.0 );
}
void main() {
fTexCoord = (position + 1.0 ) * 0.5;
gl_Position = vec4(position, 0, 1);
SMAANeighborhoodBlendingVS(fTexCoord);
}`),n.uniforms.add(new Ht("tBlendWeights",s=>s.blend.colorTexture)),n.uniforms.add(new Ht("tColor",s=>s.colorTexture)),Mx(n),n.code.add(A`vec4 SMAANeighborhoodBlendingPS( vec2 texcoord, vec4 offset[ 2 ], sampler2D colorTex, sampler2D blendTex ) {
vec4 a;
a.xz = texture2D( blendTex, texcoord ).xz;
a.y = texture2D( blendTex, offset[ 1 ].zw ).g;
a.w = texture2D( blendTex, offset[ 1 ].xy ).a;
if ( dot(a, vec4( 1.0, 1.0, 1.0, 1.0 )) < 1e-5 ) {
return texture2D( colorTex, texcoord, 0.0 );
} else {
vec2 offset;
offset.x = a.a > a.b ? a.a : -a.b;
offset.y = a.g > a.r ? -a.g : a.r;
if ( abs( offset.x ) > abs( offset.y )) {
offset.y = 0.0;
} else {
offset.x = 0.0;
}
vec4 C = texture2D( colorTex, texcoord, 0.0 );
texcoord += sign( offset ) * resolution.xy;
vec4 Cop = texture2D( colorTex, texcoord, 0.0 );
float s = abs( offset.x ) > abs( offset.y ) ? abs( offset.x ) : abs( offset.y );
vec4 mixed = mix(C, Cop, s);
return mixed;
}
}
void main() {
gl_FragColor = SMAANeighborhoodBlendingPS( fTexCoord, fOffset, tColor, tBlendWeights );
}`),i}const h3e=Object.freeze(Object.defineProperty({__proto__:null,build:c3e},Symbol.toStringTag,{value:"Module"}));let Hee=class jee extends ii{initializeProgram(e){return new ei(e.rctx,jee.shader.get().build(),oi)}initializePipeline(){return it({colorWrite:gt})}};Hee.shader=new ri(h3e,()=>j(()=>import("./Blur.glsl-85676c5e.js"),["assets/Blur.glsl-85676c5e.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/vec2-528adfe4.js","assets/common-c186b691.js","assets/vec2f64-30dc1443.js","assets/Texture2DPassUniform-753de459.js","assets/VertexAttribute-9c5c630d.js","assets/vec4-790471c0.js","assets/vec4f64-e407da96.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));const UB={threshold:.05,localConstrastAdaption:2};function u3e(){const i=new Yi,{attributes:e,varyings:t,vertex:r,fragment:n}=i;return e.add(S.POSITION,"vec2"),Mx(r),t.add("fTexCoord","vec2"),t.add("fOffset[3]","vec4"),r.code.add(A`void EdgeDetectEdgeDetectionVS( vec2 texcoord ) {
fOffset[0] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0,  1.0 );
fOffset[1] = texcoord.xyxy + resolution.xyxy * vec4(  1.0, 0.0, 0.0, -1.0 );
fOffset[2] = texcoord.xyxy + resolution.xyxy * vec4( -2.0, 0.0, 0.0,  2.0 );
}
void main() {
fTexCoord = (position + 1.0) * 0.5;
gl_Position = vec4(position, 0, 1);
EdgeDetectEdgeDetectionVS(fTexCoord);
}`),n.uniforms.add(new Ht("tColor",s=>s.colorTexture)),n.code.add(A`
    vec4 EdgeDetectColorEdgeDetectionPS(vec2 texcoord, vec4 offset[3], sampler2D colorTex) {
      vec2 threshold = vec2( ${A.float(UB.threshold)} );

      // Calculate color deltas:
      vec4 delta;
      vec3 C = texture2D( colorTex, texcoord ).rgb;

      vec3 Cleft = texture2D( colorTex, offset[0].xy ).rgb;
      vec3 t = abs( C - Cleft );
      delta.x = max( max( t.r, t.g ), t.b );

      vec3 Ctop = texture2D( colorTex, offset[0].zw ).rgb;
      t = abs( C - Ctop );
      delta.y = max( max( t.r, t.g ), t.b );

      // We do the usual threshold:
      vec2 edges = step( threshold, delta.xy );

      // Then discard if there is no edge:
      if ( dot( edges, vec2( 1.0, 1.0 ) ) == 0.0 )
          discard;

      // Calculate right and bottom deltas:
      vec3 Cright = texture2D( colorTex, offset[1].xy ).rgb;
      t = abs( C - Cright );
      delta.z = max( max( t.r, t.g ), t.b );

      vec3 Cbottom  = texture2D( colorTex, offset[1].zw ).rgb;
      t = abs( C - Cbottom );
      delta.w = max( max( t.r, t.g ), t.b );

      // Calculate the maximum delta in the direct neighborhood:
      float maxDelta = max( max( max( delta.x, delta.y ), delta.z ), delta.w );

      // Calculate left-left and top-top deltas:
      vec3 Cleftleft  = texture2D( colorTex, offset[2].xy ).rgb;
      t = abs( C - Cleftleft );
      delta.z = max( max( t.r, t.g ), t.b );

      vec3 Ctoptop = texture2D( colorTex, offset[2].zw ).rgb;
      t = abs( C - Ctoptop );
      delta.w = max( max( t.r, t.g ), t.b );

      // Calculate the final maximum delta:
      maxDelta = max( max( maxDelta, delta.z ), delta.w );

      // Local contrast adaptation in action:
      edges.xy *= step( maxDelta, float(${A.float(UB.localConstrastAdaption)}) * delta.xy );

      return vec4( edges, 0.0, 0.0 );
    }

    void main() {
      gl_FragColor = EdgeDetectColorEdgeDetectionPS(fTexCoord, fOffset, tColor);
    }
  `),i}const d3e=Object.freeze(Object.defineProperty({__proto__:null,build:u3e},Symbol.toStringTag,{value:"Module"}));let qee=class Wee extends ii{initializeProgram(e){return new ei(e.rctx,Wee.shader.get().build(),oi)}initializePipeline(){return it({colorWrite:gt})}};qee.shader=new ri(d3e,()=>j(()=>import("./EdgeDetect.glsl-b2287c23.js"),["assets/EdgeDetect.glsl-b2287c23.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/vec2-528adfe4.js","assets/common-c186b691.js","assets/vec2f64-30dc1443.js","assets/Texture2DPassUniform-753de459.js","assets/VertexAttribute-9c5c630d.js","assets/vec4-790471c0.js","assets/vec4f64-e407da96.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));let Sb=class extends pe{constructor(e,t){super({}),this._rctx=e,this._techniqueRep=t,this._passParameters=new s3e,this._isEnabled=!1}normalizeCtorArgs(){return{}}dispose(){this._abortController=iu(this._abortController),this.disable()}_loadResources(e){if(y(this._abortController))return!1;if(y(this._passParameters.searchTexture))return!0;this._abortController=new AbortController;const t=this._abortController.signal;return j(()=>import("./SmaaRenderPassData-660b7d34.js"),[]).then(r=>this._loadTextures(r,t)).then(()=>e()).finally(()=>this._abortController=null),!1}_loadTextures(e,t){return Ti(t),Promise.all([this._loadTextureFromBase64(e.areaTexture,Jt.LINEAR,St.RGB),this._loadTextureFromBase64(e.searchTexure,Jt.NEAREST,St.LUMINANCE)]).then(([r,n])=>{Ec(t)?(r.dispose(),n.dispose(),Ti(t)):(this._passParameters.areaTexture=r,this._passParameters.searchTexture=n)})}get updating(){return y(this._abortController)}enable(e){if(this._isEnabled)return!0;if(!this._edgeDetectTechnique||!this._blendWeightsTechnique||!this._blurTechnique){const t=new $a;this._edgeDetectTechnique=this._techniqueRep.releaseAndAcquire(qee,t,this._edgeDetectTechnique),this._blendWeightsTechnique=this._techniqueRep.releaseAndAcquire(Bee,t,this._blendWeightsTechnique),this._blurTechnique=this._techniqueRep.releaseAndAcquire(Hee,t,this._blurTechnique)}return!!this._loadResources(e)&&(this._vao=Qne(this._rctx),this._passParameters.edges=new yn(this._rctx,{colorTarget:Vn.TEXTURE,depthStencilTarget:rs.NONE},{target:bi.TEXTURE_2D,pixelFormat:St.RGB,dataType:Xt.UNSIGNED_BYTE,samplingMode:Jt.LINEAR,wrapMode:ai.CLAMP_TO_EDGE,width:4,height:4}),this._passParameters.blend=new yn(this._rctx,{colorTarget:Vn.TEXTURE,depthStencilTarget:rs.NONE},{target:bi.TEXTURE_2D,pixelFormat:St.RGBA,dataType:Xt.UNSIGNED_BYTE,samplingMode:Jt.LINEAR,wrapMode:ai.CLAMP_TO_EDGE,width:4,height:4}),this._isEnabled=!0,!0)}disable(){this._isEnabled&&(this._vao=ke(this._vao),this._passParameters.areaTexture=ke(this._passParameters.areaTexture),this._passParameters.searchTexture=ke(this._passParameters.searchTexture),this._passParameters.blend=ke(this._passParameters.blend),this._passParameters.edges=ke(this._passParameters.edges),this._isEnabled=!1)}get _validPassParameters(){return this._isEnabled?this._passParameters:null}render(e){const t=this._validPassParameters;if(C(t))return;t.colorTexture=e;const r=this._rctx,n=r.getBoundFramebufferObject(),s=e.descriptor.width,a=e.descriptor.height;r.bindVAO(this._vao),r.setViewport(0,0,s,a),t.edges.resize(s,a),r.bindFramebuffer(t.edges),r.setClearColor(0,0,0,1),r.clear(Oi.COLOR_BUFFER_BIT),r.bindTechnique(this._edgeDetectTechnique,t,null),r.drawArrays(kt.TRIANGLES,0,3),t.blend.resize(s,a),r.bindFramebuffer(t.blend),r.setClearColor(0,0,1,1),r.clear(Oi.COLOR_BUFFER_BIT),r.bindTechnique(this._blendWeightsTechnique,t,null),r.drawArrays(kt.TRIANGLES,0,3),r.bindFramebuffer(n),r.setClearColor(0,1,0,1),r.clear(Oi.COLOR_BUFFER_BIT),r.bindTechnique(this._blurTechnique,t,null),r.drawArrays(kt.TRIANGLES,0,3)}_loadTextureFromBase64(e,t,r){return Lg(e).then(n=>new Gi(this._rctx,{pixelFormat:r,dataType:Xt.UNSIGNED_BYTE,wrapMode:ai.CLAMP_TO_EDGE,width:n.width,height:n.height,samplingMode:t},n))}};h([p()],Sb.prototype,"_abortController",void 0),h([p({readOnly:!0})],Sb.prototype,"updating",null),Sb=h([F("esri.views.3d.webgl-engine.lib.SmaaRenderPass")],Sb);function p3e(i,e){const t=-i[0],r=-i[1],n=-i[2],s=e[3],a=e[7],o=e[11],l=e[15];e[0]+=s*t,e[1]+=s*r,e[2]+=s*n,e[4]+=a*t,e[5]+=a*r,e[6]+=a*n,e[8]+=o*t,e[9]+=o*r,e[10]+=o*n,e[12]+=l*t,e[13]+=l*r,e[14]+=l*n}function m3e(i,e){const t=i[0],r=i[1],n=i[2];e[12]+=t*e[0]+r*e[4]+n*e[8],e[13]+=t*e[1]+r*e[5]+n*e[9],e[14]+=t*e[2]+r*e[6]+n*e[10],e[14]+=t*e[3]+r*e[7]+n*e[11]}let f3e=class{constructor(e){this._factory=e,this._originData=new Map}acquire(e){return this.register(this._factory.getOrigin(e))}register(e){const t=this._originData.get(e.id)||new g3e(e);return t.refCount++,this._originData.has(t.origin.id)||this._originData.set(t.origin.id,t),t}release(e){e.refCount--,e.refCount===0&&this._originData.delete(e.origin.id)}updateViewMatrices(e){this._originData.forEach(t=>{pn(t.viewMatrix,e),m3e(t.origin.vec3,t.viewMatrix)})}},g3e=class{constructor(e){this.origin=e,this.refCount=0,this.viewMatrix=xe()}},_3e=class extends ise{constructor(e,t){super(),this.distanceFalloffFactor=e,this.transparency=t,this.transformNormalViewFromGlobal=Or()}},y3e=class extends rse{constructor(){super(...arguments),this.transformNormalViewFromGlobal=Or(),this.slicePlaneLocalOrigin=P(),this.transformNormalGlobalFromModel=Or()}};function v3e(i){const e=A`bool isNaN( float val )
{
return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true;
}`;i.code.add(e)}const b3e=Qt(.5,-4e-4);function w3e(i,e){const t=i.vertex;t.include(v3e),t.constants.add("depthBias","vec2",b3e),t.uniforms.add(new Zs("inverseViewport",(r,n)=>n.inverseViewport)),e.legacy?(t.uniforms.add(new Ys("proj",(r,n)=>n.camera.projectionMatrix)),t.code.add(A`vec2 calculateProjectedBiasXY(vec4 projPos, vec3 globalNormal) {
float offsetXY = depthBias.x;
vec4 projNormal = proj * localView * vec4(globalNormal, 0.0);
return offsetXY * projPos.w * 2.0 * inverseViewport * normalize(projNormal.xyz).xy;
}`)):(t.uniforms.add(new gH("transformNormalViewFromGlobal",r=>r.transformNormalViewFromGlobal)),t.uniforms.add(new Ys("transformProjFromView",r=>r.transformProjFromView)),t.code.add(A`vec2 calculateProjectedBiasXY(vec4 projPos, vec3 globalNormal) {
float offsetXY = depthBias.x;
vec4 projNormal = transformProjFromView * vec4(transformNormalViewFromGlobal * globalNormal, 0.0);
return offsetXY * projPos.w * 2.0 * inverseViewport * normalize(projNormal.xyz).xy;
}`)),t.code.add(A`float _calculateProjectedBiasZ(vec4 projPos) {
float offsetZ = depthBias.y;
return sqrt(max(projPos.z,0.0)) * offsetZ;
}
vec4 adjustProjectedPosition(vec4 projPos, vec3 worldNormal, float lineWidth) {
vec2 offsetXY = calculateProjectedBiasXY(projPos, worldNormal);
if (!isNaN(offsetXY.x) && !isNaN(offsetXY.y)) {
projPos.xy += offsetXY;
}
projPos.z += _calculateProjectedBiasZ(projPos);
return projPos;
}`)}function x3e(i,e){const t=i.fragment;t.constants.add("coverageTestThreshold","float",.01),e.antialiasing?t.code.add(A`#define discardByCoverage(radius, coverage) { if (coverage < coverageTestThreshold) discard; }`):t.code.add(A`#define discardByCoverage(radius, coverage) { float coverageLimit = radius <= 0.5 ? coverageTestThreshold : 0.75; if (coverage < coverageLimit) discard; }`)}function T3e(i,e){const t=i.vertex;e.silhouette?(t.code.add(A`bool isSilhouetteEdge(vec3 viewDir, vec3 normalA, vec3 normalB) {
float faceAVisible = dot(viewDir, normalA);
float faceBVisible = dot(viewDir, normalB);
return faceAVisible * faceBVisible < 0.0;
}`),e.legacy?t.code.add(A`bool discardNonSilhouetteEdges(vec3 viewPos, vec3 worldPos) {
vec3 viewNormalA = _modelToViewNormal(normalA);
vec3 viewNormalB = _modelToViewNormal(normalB);
vec3 viewDir = -viewPos;
if (isSilhouetteEdge(viewDir, viewNormalA, viewNormalB)) {
return false;
}
gl_Position = vec4(10.0, 10.0, 10.0, 1.0);
return true;
}`):t.code.add(A`bool discardNonSilhouetteEdges(vec3 viewPos, vec3 worldPos) {
vec3 worldNormalA = _modelToWorldNormal(normalA);
vec3 worldNormalB = _modelToWorldNormal(normalB);
vec3 viewDir = -worldPos;
if (isSilhouetteEdge(viewDir, worldNormalA, worldNormalB)) {
return false;
}
gl_Position = vec4(10.0, 10.0, 10.0, 1.0);
return true;
}`)):t.code.add(A`bool discardNonSilhouetteEdges(vec3 viewPos, vec3 worldPos) {
return false;
}`)}function C3e(i,e){const t=i.vertex;t.include(i_),t.uniforms.add(new Pt("distanceFalloffFactor",r=>r.distanceFalloffFactor)),t.code.add(A`float distanceBasedPerspectiveFactor(float distance) {
return clamp(sqrt(distanceFalloffFactor / distance), 0.0, 1.0);
}`),t.uniforms.add(qR("componentDataTex",r=>r.componentDataTexture,e.hasWebGL2Context?il.None:il.InvSize)),i.attributes.add(S.COMPONENTINDEX,"float"),t.constants.add("componentColorFieldOffset","float",0),t.constants.add("componentOtherFieldOffset","float",1),t.constants.add("componentVerticalOffsetFieldOffset","float",2),t.constants.add("componentFieldCount","float",3),t.constants.add("lineWidthFractionFactor","float",8),t.constants.add("extensionLengthOffset","float",128),t.constants.add("verticalOffsetScale","float",2*s5),t.code.add(A`
    vec2 _componentTextureCoords(float componentIndex, float fieldOffset) {
      float fieldIndex = componentFieldCount * componentIndex + fieldOffset;

      vec2 textureSizeInverse = ${Hx(e,"componentDataTex",!0)};

      float colIndex = mod(fieldIndex, 1.0 / textureSizeInverse.x);
      float rowIndex = floor(fieldIndex * textureSizeInverse.x);

      vec2 textureCoordinates = vec2(colIndex, rowIndex) + 0.5;

      return textureCoordinates;
    }

    struct ComponentData {
      vec4 color;
      float lineWidth;
      float extensionLength;
      float type;
      float verticalOffset;
    };

    ComponentData readComponentData() {
      vec2 colorIndex = _componentTextureCoords(componentIndex, componentColorFieldOffset);
      vec2 otherIndex = _componentTextureCoords(componentIndex, componentOtherFieldOffset);
      vec2 verticalOffsetIndex = _componentTextureCoords(componentIndex, componentVerticalOffsetFieldOffset);

      vec4 colorValue = ${Ko(e,"componentDataTex","colorIndex")};
      vec4 otherValue = ${Ko(e,"componentDataTex","otherIndex")};
      float verticalOffset = (rgba2float(${Ko(e,"componentDataTex","verticalOffsetIndex")}) - 0.5) * verticalOffsetScale;

      return ComponentData(
        vec4(colorValue.rgb, colorValue.a * otherValue.w), // otherValue.w stores separate opacity
        otherValue.x * (255.0 / lineWidthFractionFactor),
        otherValue.y * 255.0 - extensionLengthOffset,
        -(otherValue.z * 255.0) + 0.5, // SOLID (=0/255) needs to be > 0.0, SKETCHY (=1/255) needs to be <= 0;
        verticalOffset
      );
    }
  `),e.legacy?t.code.add(A`vec3 _modelToWorldNormal(vec3 normal) {
return (model * vec4(normal, 0.0)).xyz;
}
vec3 _modelToViewNormal(vec3 normal) {
return (localView * model * vec4(normal, 0.0)).xyz;
}`):(t.uniforms.add(new UI("transformNormalGlobalFromModel",r=>r.transformNormalGlobalFromModel)),t.code.add(A`vec3 _modelToWorldNormal(vec3 normal) {
return transformNormalGlobalFromModel * normal;
}`)),e.silhouette?(i.attributes.add(S.NORMALA,"vec3"),i.attributes.add(S.NORMALB,"vec3"),t.code.add(A`vec3 worldNormal() {
return _modelToWorldNormal(normalize(normalA + normalB));
}`)):(i.attributes.add(S.NORMAL,"vec3"),t.code.add(A`vec3 worldNormal() {
return _modelToWorldNormal(normal);
}`)),e.legacy?t.code.add(A`void worldAndViewFromModelPosition(vec3 modelPos, float verticalOffset, out vec3 worldPos, out vec3 viewPos) {
worldPos = (model * vec4(modelPos, 1.0)).xyz;
viewPos = (localView * vec4(worldPos, 1.0)).xyz;
}`):(t.include(ek,e),t.include(ek,e),t.uniforms.add([new gH("transformViewFromCameraRelativeRS",r=>r.transformViewFromCameraRelativeRS),new UI("transformWorldFromModelRS",r=>r.transformWorldFromModelRS),new W5("transformWorldFromModelTL",r=>r.transformWorldFromModelTL),new W5("transformWorldFromModelTH",r=>r.transformWorldFromModelTH),new Ps("transformWorldFromViewTL",r=>r.transformWorldFromViewTL),new Ps("transformWorldFromViewTH",r=>r.transformWorldFromViewTH)]),t.code.add(A`
      void worldAndViewFromModelPosition(vec3 modelPos, float verticalOffset, out vec3 worldPos, out vec3 viewPos) {
        vec3 rotatedModelPosition = transformWorldFromModelRS * modelPos;

        vec3 transformCameraRelativeFromModel = dpAdd(
          transformWorldFromModelTL,
          transformWorldFromModelTH,
          -transformWorldFromViewTL,
          -transformWorldFromViewTH
        );

        worldPos = transformCameraRelativeFromModel + rotatedModelPosition;

        if (verticalOffset != 0.0) {
          vec3 vUp = ${e.spherical?A`normalize(transformWorldFromModelTL + rotatedModelPosition);`:A`vec3(0.0, 0.0, 1.0);`}
          worldPos += verticalOffset * vUp;
        }

        viewPos = transformViewFromCameraRelativeRS * worldPos;
      }
    `)),t.uniforms.add(new Ys("transformProjFromView",(r,n)=>n.camera.projectionMatrix)),t.code.add(A`vec4 projFromViewPosition(vec3 position) {
return transformProjFromView * vec4(position, 1.0);
}`),t.code.add(A`float calculateExtensionLength(float extensionLength, float lineLength) {
return extensionLength / (log2(max(1.0, 256.0 / lineLength)) * 0.2 + 1.0);
}`)}function S3e(i){return i.mode===Rr.SKETCH||i.mode===Rr.MIXED}var Rr;(function(i){i[i.SOLID=0]="SOLID",i[i.SKETCH=1]="SKETCH",i[i.MIXED=2]="MIXED",i[i.COUNT=3]="COUNT"})(Rr||(Rr={}));function E3e(i,e){const t=i.vertex;switch(e.mode){case Rr.SKETCH:t.code.add(A`#define discardShortEdges(unpackedAttributes, lineLengthPixels) { if (lineLengthPixels <= 3.0) { gl_Position = vec4(10.0, 10.0, 10.0, 1.0); return; }}`);break;case Rr.MIXED:t.code.add(A`#define discardShortEdges(unpackedAttributes, lineLengthPixels) { if (unpackedAttributes.type <= 0.0 && lineLengthPixels <= 3.0) { gl_Position = vec4(10.0, 10.0, 10.0, 1.0); return; }}`);break;case Rr.SOLID:t.code.add(A`#define discardShortEdges(unpackedAttributes, lineLengthPixels) {}`)}}function l5(i,e){const t=i.vertex;switch(i.attributes.add(S.SIDENESS,"vec2"),e.mode===Rr.MIXED?t.code.add(A`struct UnpackedAttributes {
vec2 sideness;
vec2 sidenessNorm;
float lineWidthPixels;
float extensionLengthPixels;
float type;
};`):t.code.add(A`struct UnpackedAttributes {
vec2 sideness;
vec2 sidenessNorm;
float lineWidthPixels;
float extensionLengthPixels;
};`),e.mode){case Rr.MIXED:t.code.add(A`UnpackedAttributes unpackAttributes(ComponentData component) {
vec2 sidenessNorm = sideness;
vec2 sideness = sidenessNorm * 2.0 - 1.0;
float fType = component.type;
float extensionLengthPixels = component.extensionLength;
float lineWidth = component.lineWidth;
if (fType <= 0.0) {
extensionLengthPixels *= variantExtension * 2.0 - 1.0;
}
return UnpackedAttributes(sideness, sidenessNorm, lineWidth, extensionLengthPixels, fType);
}`);break;case Rr.SKETCH:t.code.add(A`UnpackedAttributes unpackAttributes(ComponentData component) {
vec2 sidenessNorm = sideness;
vec2 sideness = sidenessNorm * 2.0 - 1.0;
float extensionLengthPixels = component.extensionLength;
extensionLengthPixels *= variantExtension * 2.0 - 1.0;
float lineWidth = component.lineWidth;
return UnpackedAttributes(sideness, sidenessNorm, lineWidth, extensionLengthPixels);
}`);break;case Rr.SOLID:t.code.add(A`UnpackedAttributes unpackAttributes(ComponentData component) {
vec2 sidenessNorm = sideness;
vec2 sideness = sidenessNorm * 2.0 - 1.0;
float extensionLengthPixels = component.extensionLength;
float lineWidth = component.lineWidth;
return UnpackedAttributes(sideness, sidenessNorm, lineWidth, extensionLengthPixels);
}`);break;case Rr.COUNT:break;default:Ra(e.mode)}}function R3e(i,e){const t=i.vertex;switch(i.include(l5,e),e.mode){case Rr.SOLID:t.code.add(A`float calculateLineAmplitude(UnpackedAttributes unpackedAttributes) {
return 0.0;
}`);break;case Rr.SKETCH:t.uniforms.add(new R0("strokesAmplitude",r=>r.strokesTexture.amplitude)),t.code.add(A`float calculateLineAmplitude(UnpackedAttributes unpackedAttributes) {
return strokesAmplitude;
}`);break;case Rr.MIXED:t.uniforms.add(new R0("strokesAmplitude",r=>r.strokesTexture.amplitude)),t.code.add(A`float calculateLineAmplitude(UnpackedAttributes unpackedAttributes) {
float type = unpackedAttributes.type;
if (type <= 0.0) {
return strokesAmplitude;
}
else {
return 0.0;
}
}`)}}function P3e(i,e){i.include(l5,e);const{vertex:t,fragment:r}=i;switch(S3e(e)&&(t.uniforms.add(qR("strokesTexture",n=>n.strokesTexture.texture,e.hasWebGL2Context?il.None:il.InvSize)),t.uniforms.add([new R0("strokesLog2Resolution",n=>Math.log2(n.strokesTexture.resolution)),new R0("strokeVariants",n=>n.strokesTexture.variants)]),i.varyings.add("vStrokeUV","vec2"),r.uniforms.add([new nF("strokesTexture",n=>n.strokesTexture.texture),new R0("strokesNormalizationScale",n=>n.strokesTexture.normalizationScale)]),t.code.add(A`
      void calculateStyleOutputsSketch(float lineLength, UnpackedAttributes unpackedAttributes) {
        vec2 sidenessNorm = unpackedAttributes.sidenessNorm;

        float lineIndex = clamp(ceil(log2(lineLength)), 0.0, strokesLog2Resolution);

        vec2 textureSizeInverse = ${Hx(e,"strokesTexture",!0)};
        vStrokeUV = vec2(exp2(lineIndex) * sidenessNorm.y, lineIndex * strokeVariants + variantStroke + 0.5) * textureSizeInverse;
        vStrokeUV.x += variantOffset;
      }
    `),i.fragment.include(i_),r.code.add(A`float calculateLineOffsetSketch() {
float offsetNorm = rgba2float(texture2D(strokesTexture, vStrokeUV));
return (offsetNorm - 0.5) * strokesNormalizationScale;
}
float calculateLinePressureSketch() {
return rgba2float(texture2D(strokesTexture, vStrokeUV + vec2(0.0, 0.5)));
}`)),e.mode){case Rr.SOLID:t.code.add(A`void calculateStyleOutputs(UnpackedAttributes unpackedAttributes) {}`),r.code.add(A`float calculateLineOffset() {
return 0.0;
}
float calculateLinePressure() {
return 1.0;
}`);break;case Rr.SKETCH:t.code.add(A`void calculateStyleOutputs(UnpackedAttributes unpackedAttributes)
{
calculateStyleOutputsSketch(vLineLengthPixels, unpackedAttributes);
}`),r.code.add(A`float calculateLineOffset() {
return calculateLineOffsetSketch();
}
float calculateLinePressure() {
return calculateLinePressureSketch();
}`);break;case Rr.MIXED:i.varyings.add("vType","float"),t.code.add(A`void calculateStyleOutputs(UnpackedAttributes unpackedAttributes)
{
vType = unpackedAttributes.type;
if (unpackedAttributes.type <= 0.0) {
calculateStyleOutputsSketch(vLineLengthPixels, unpackedAttributes);
}
}`),r.code.add(A`float calculateLineOffset() {
if (vType <= 0.0) {
return calculateLineOffsetSketch();
}
else {
return 0.0;
}
}
float calculateLinePressure() {
if (vType <= 0.0) {
return calculateLinePressureSketch();
}
else {
return 1.0;
}
}`)}}function A3e(i){const e=new Yi,{vertex:t,fragment:r}=e;return i.antialiasing&&(t.code.add(A`#define ANTIALIASING 1`),r.code.add(A`#define ANTIALIASING 1`)),i.legacy&&t.uniforms.add([new zB("model"),new zB("localView")]),e.include(w3e,i),e.include(C3e,i),e.include(R3e,i),e.include(l5,i),e.include(P3e,i),e.include(LH,i),e.include(T3e,i),e.include(x3e,i),e.include(E3e,i),e.include(zI,i),e.varyings.add("vColor","vec4"),e.varyings.add("vRadius","float"),e.varyings.add("vPosition","vec3"),e.varyings.add("vWorldPosition","vec3"),e.varyings.add("vViewPos","vec3"),e.varyings.add("vLineLengthPixels","float"),e.varyings.add("vSizeFalloffFactor","float"),t.uniforms.add([new Zs("pixelToNDC",(n,s)=>rt(O3e,2/s.camera.fullViewport[2],2/s.camera.fullViewport[3])),new Xh("viewport",(n,s)=>s.camera.fullViewport),new Pt("pixelRatio",(n,s)=>s.camera.pixelRatio)]),e.attributes.add(S.POSITION0,"vec3"),e.attributes.add(S.POSITION1,"vec3"),e.attributes.add(S.VARIANTOFFSET,"float"),e.attributes.add(S.VARIANTSTROKE,"float"),e.attributes.add(S.VARIANTEXTENSION,"float"),t.code.add(A`const float opaqueCutoff = 1.0 / 255.0;
void calculateGeometricOutputs(vec3 viewPosV0, vec3 viewPosV1, vec3 worldPosV0, vec3 worldPosV1, vec3 worldNormal, UnpackedAttributes unpackedAttributes) {
vec2 sideness = unpackedAttributes.sideness;
vec2 sidenessNorm = unpackedAttributes.sidenessNorm;
vWorldPosition = mix(worldPosV0, worldPosV1, sidenessNorm.y).xyz;
vec3 viewPos = mix(viewPosV0, viewPosV1, sidenessNorm.y);
vViewPos = viewPos;
vec4 projPosV0 = projFromViewPosition(viewPosV0);
vec4 projPosV1 = projFromViewPosition(viewPosV1);
vec4 projPos = projFromViewPosition(viewPos);
vec3 screenSpaceLineNDC = (projPosV1.xyz / projPosV1.w - projPosV0.xyz / projPosV0.w);
vec2 ndcToPixel = viewport.zw * 0.5;
vec2 screenSpaceLinePixels = screenSpaceLineNDC.xy * ndcToPixel;
float lineLengthPixels = length(screenSpaceLinePixels);
float dzPerPixel = screenSpaceLineNDC.z / lineLengthPixels;
vec2 screenSpaceDirection = screenSpaceLinePixels / lineLengthPixels;
vec2 perpendicularScreenSpaceDirection = vec2(screenSpaceDirection.y, -screenSpaceDirection.x) * sideness.x;
float falloffFactor = distanceBasedPerspectiveFactor(-viewPos.z) * pixelRatio;
float lineWidthPixels = unpackedAttributes.lineWidthPixels * falloffFactor;
float extensionLengthPixels = calculateExtensionLength(unpackedAttributes.extensionLengthPixels, lineLengthPixels) * falloffFactor;
float lineAmplitudePixels = calculateLineAmplitude(unpackedAttributes) * pixelRatio;
vSizeFalloffFactor = falloffFactor;
float lineWidthAndAmplitudePixels = lineWidthPixels + lineAmplitudePixels + lineAmplitudePixels;
float extendedLineLengthPixels = lineLengthPixels + extensionLengthPixels + extensionLengthPixels;
#ifdef ANTIALIASING
const float aaPaddingPixels = 1.0;
float halfAAPaddedLineWidthAndAmplitudePixels = lineWidthAndAmplitudePixels * 0.5 + aaPaddingPixels;
float aaPaddedRoundedCapSizePixels = lineWidthPixels * 0.5 + aaPaddingPixels;
#else
float halfAAPaddedLineWidthAndAmplitudePixels = max(lineWidthAndAmplitudePixels, 1.0) * 0.5;
float aaPaddedRoundedCapSizePixels = max(lineWidthPixels, 1.0) * 0.5;
#endif
vec2 halfAAPaddedLineWidthAndAmplitudeNDC = halfAAPaddedLineWidthAndAmplitudePixels * pixelToNDC;
vec2 aaPaddedRoundedCapSizeNDC = aaPaddedRoundedCapSizePixels * pixelToNDC;
vec2 extensionLengthNDC = extensionLengthPixels * pixelToNDC;
vec2 ndcOffset = (
screenSpaceDirection * sideness.y * (aaPaddedRoundedCapSizeNDC + extensionLengthNDC)
+ perpendicularScreenSpaceDirection * halfAAPaddedLineWidthAndAmplitudeNDC
);
projPos.xy += ndcOffset * projPos.w;
projPos.z += (dzPerPixel * (aaPaddedRoundedCapSizePixels + extensionLengthPixels)) * sideness.y * projPos.w;
projPos = adjustProjectedPosition(projPos, worldNormal, 1.0 + max((lineWidthAndAmplitudePixels - 1.0) * 0.5, 0.0));
float aaPaddedLineWithCapsLengthPixels = extendedLineLengthPixels + aaPaddedRoundedCapSizePixels + aaPaddedRoundedCapSizePixels;
float pixelPositionAlongLine = aaPaddedLineWithCapsLengthPixels * sidenessNorm.y - aaPaddedRoundedCapSizePixels;
vPosition = vec3(
halfAAPaddedLineWidthAndAmplitudePixels * sideness.x,
pixelPositionAlongLine,
pixelPositionAlongLine / extendedLineLengthPixels
);
vRadius = lineWidthPixels * 0.5;
vLineLengthPixels = extendedLineLengthPixels;
discardShortEdges(unpackedAttributes, lineLengthPixels);
gl_Position = projPos;
}
void main() {
ComponentData component = readComponentData();
UnpackedAttributes unpackedAttributes = unpackAttributes(component);
vec3 worldPosV0, worldPosV1, viewPosV0, viewPosV1;
worldAndViewFromModelPosition(position0, component.verticalOffset, worldPosV0, viewPosV0);
worldAndViewFromModelPosition(position1, component.verticalOffset, worldPosV1, viewPosV1);
vColor = component.color;
if (vColor.a < opaqueCutoff) {
gl_Position = vec4(10.0, 10.0, 10.0, 1.0);
return;
}
if (discardNonSilhouetteEdges(viewPosV0, worldPosV0)) {
return;
}
calculateGeometricOutputs(viewPosV0, viewPosV1, worldPosV0, worldPosV1, worldNormal(), unpackedAttributes);
calculateStyleOutputs(unpackedAttributes);
}`),e.fragment.code.add(A`
    vec2 lineWithCapsDistance(float radius, vec2 position, float lineLength) {
      float lineOffset = calculateLineOffset();
      float positionX = position.x - lineOffset;

      if (radius < 1.0) {
        // Handle this specifically for subpixel sizes:
        // 1. Compute correct coverage (note coverage is computed by
        //    0.5 - dist, so we make sure that that will lead to correct
        //    subpixel coverage
        // 2. Ignore rounded caps
        float coverageX = clamp(min(radius, positionX + 0.5) - max(-radius, positionX - 0.5), 0.0, 1.0);
        float coverageY = clamp(min(lineLength, position.y + 0.5) - max(0.0, position.y - 0.5), 0.0, 1.0);

        float coverage = min(coverageX, coverageY);

        return vec2(0.5 - coverage, 0.0);
      }
      else {
        // Between -radius -> 0 for start cap, 0 for line, 0 -> radius
        float positionOnCap = position.y - clamp(position.y, 0.0, lineLength);

        vec2 lineToPosition = vec2(positionX, positionOnCap);
        return vec2(length(lineToPosition) - radius, positionOnCap / radius);
      }
    }

    void main() {
      ${i.hasMultipassTerrain?"terrainDepthTest(gl_FragCoord, vViewPos.z);":""}
      float radius = vRadius * calculateLinePressure();

      vec2 distance = lineWithCapsDistance(radius, vPosition.xy, vLineLengthPixels);
      float coverage = clamp(0.5 - distance.x, 0.0, 1.0);

      discardByCoverage(radius, coverage);
      discardBySlice(vWorldPosition);

      float alpha = vColor.a * coverage;

      gl_FragColor = vec4(vColor.rgb, alpha);

    }
  `),e}const O3e=Te();let zB=class extends t_{constructor(e){super(e,"mat4")}};const M3e=Object.freeze(Object.defineProperty({__proto__:null,build:A3e},Symbol.toStringTag,{value:"Module"}));let Xee=class Qee extends ii{initializeConfiguration(e,t){t.hasWebGL2Context=e.rctx.type===Nn.WEBGL2}initializeProgram(e){return new ei(e.rctx,Qee.shader.get().build(this.configuration),GI)}initializePipeline(e){return e.blendMinMax?it({blending:Gn(me.ONE,me.ONE,me.ZERO,me.ONE,Pw.ADD,e.blendMinMax.MAX),depthTest:{func:hs.LEQUAL},colorWrite:gt}):it({depthTest:{func:hs.LEQUAL},depthWrite:nl,colorWrite:gt})}};Xee.shader=new ri(M3e,()=>j(()=>import("./EdgeShader.glsl-88af796f.js"),["assets/EdgeShader.glsl-88af796f.js","assets/vec2-528adfe4.js","assets/common-c186b691.js","assets/vec2f64-30dc1443.js","assets/mat4-44a0988f.js","assets/vec3f64-2f9cef06.js","assets/mat4f64-1e28eae0.js","assets/vec3-e93e648f.js","assets/ShaderBuilder-a7d0da4e.js","assets/typedArrayUtil-4d7bb04c.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/Texture2DPassUniform-753de459.js","assets/VertexAttribute-9c5c630d.js","assets/preload-helper-3bce6601.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/vec3f32-c9aa289f.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]));let Sh=class extends cu{constructor(){super(...arguments),this.mode=Rr.SOLID,this.hasSlicePlane=!1,this.silhouette=!1,this.legacy=!1,this.antialiasing=!1,this.doublePrecisionRequiresObfuscation=!1,this.hasMultipassTerrain=!1,this.cullAboveGround=!1,this.spherical=!1}};h([k({count:Rr.COUNT})],Sh.prototype,"mode",void 0),h([k()],Sh.prototype,"hasSlicePlane",void 0),h([k()],Sh.prototype,"silhouette",void 0),h([k()],Sh.prototype,"legacy",void 0),h([k()],Sh.prototype,"antialiasing",void 0),h([k()],Sh.prototype,"doublePrecisionRequiresObfuscation",void 0),h([k()],Sh.prototype,"hasMultipassTerrain",void 0),h([k()],Sh.prototype,"cullAboveGround",void 0),h([k()],Sh.prototype,"spherical",void 0);const I3e=8,oI=128,L3e={type:"uber",hasSlicePlane:!1,strokesTexture:null,legacy:!0,spherical:!0},$3e={solid:Rr.SOLID,sketch:Rr.SKETCH,uber:Rr.MIXED};let lI=class Zee{constructor(e,t,r){this._rctx=e,this._shaderTechniqueRepository=t,this._configuration=new Sh,this.refCount=0,this._renderables=new Set,this._sortedRenderables={[Ct.TRANSPARENT]:{[Ct.TRANSPARENT]:new Yt,[Ct.OPAQUE]:new Yt},[Ct.OPAQUE]:{[Ct.TRANSPARENT]:new Yt,[Ct.OPAQUE]:new Yt}},this._renderablesDirty=!1,this._drawParameters=new y3e,this._settings={...L3e,...r},this.key=Zee.getKey(this._settings.type,this._settings.hasSlicePlane,this._settings.legacy);const n=this._settings.strokesTexture.variants;this.writerSettings={variants:n,reducedPrecision:Wt.TESTS_DISABLE_OPTIMIZATIONS},this._configuration.legacy=this._settings.legacy,this._configuration.mode=$3e[this._settings.type],this._configuration.silhouette=!1,this._configuration.antialiasing=!!this._rctx.capabilities.blendMinMax,this._configuration.hasSlicePlane=this._settings.hasSlicePlane,this._configuration.doublePrecisionRequiresObfuscation=zR(e),this._configuration.spherical=r.spherical}dispose(){this._technique=Qi(this._technique)}addRenderable(e){this._renderables.add(e),this._renderablesDirty=!0}removeRenderable(e){this._renderables.delete(e),this._renderablesDirty=!0}setRenderablesDirty(){this._renderablesDirty=!0}forEachRenderable(e,t){this._renderablesDirty&&this._sortRenderables(),this._sortedRenderables[t][Ct.TRANSPARENT].forAll(e),this._sortedRenderables[t][Ct.OPAQUE].forAll(e)}updateTechnique(e,t){return this._configuration.hasMultipassTerrain=!!e.multipassTerrain.enabled,this._configuration.cullAboveGround=!!e.multipassTerrain.cullAboveGround,this._configuration.silhouette=t,this._technique=this._shaderTechniqueRepository.releaseAndAcquire(Xee,this._configuration,this._technique),this._technique}bindRegularEdges(e,t){return this._lastOriginId=null,this._rctx.bindTechnique(this.updateTechnique(t,!1),e,t)}bindSilhouetteEdges(e,t){return this._lastOriginId=null,this._rctx.bindTechnique(this.updateTechnique(t,!0),e,t)}renderRegularEdges(e,t,r,n,s){this._render(e,t,t.regular.vao,r,n,s)}renderSilhouetteEdges(e,t,r,n,s){this._render(e,t,t.silhouette.vao,r,n,s)}_render(e,t,r,n,s,a){a>0&&(this._bindDraw(e,t,n,s),this._rctx.bindVAO(r),this._rctx.capabilities.instancing.drawArraysInstanced(kt.TRIANGLE_FAN,0,4,a))}_bindDraw(e,t,r,n){if(this._drawParameters.componentDataTexture=t.components.buffer.textureBuffer.texture,this._drawParameters.strokesTexture=this._settings.strokesTexture,"origin"in t.transform)this._lastOriginId!==t.transform.origin.origin.id&&(e.setUniformMatrix4fv("localView",t.transform.origin.viewMatrix),this._lastOriginId=t.transform.origin.origin.id),e.setUniformMatrix4fv("model",t.transform.modelMatrix),this._drawParameters.slicePlaneLocalOrigin=t.transform.origin.origin.vec3;else{const s=new eA(t.transform.position),a=qc(BB,Kg(BB,t.transform.rotationScale));this._drawParameters.transformWorldFromModelTL=s.low,this._drawParameters.transformWorldFromModelTH=s.high,this._drawParameters.transformWorldFromModelRS=t.transform.rotationScale,this._drawParameters.transformNormalGlobalFromModel=a;const o=n.camera.viewInverseTransposeMatrix;Y(this._drawParameters.slicePlaneLocalOrigin,o[3],o[7],o[11])}e.bindDraw(this._drawParameters,n,r)}_sortRenderables(){this._renderablesDirty=!1,this._sortedRenderables[Ct.TRANSPARENT][Ct.TRANSPARENT].clear(),this._sortedRenderables[Ct.TRANSPARENT][Ct.OPAQUE].clear(),this._sortedRenderables[Ct.OPAQUE][Ct.TRANSPARENT].clear(),this._sortedRenderables[Ct.OPAQUE][Ct.OPAQUE].clear(),this._renderables.forEach(t=>{t.objectTransparency!==Ct.INVISIBLE&&t.edgeTransparency!==Ct.INVISIBLE&&this._sortedRenderables[t.objectTransparency][t.edgeTransparency].push(t)});const e=(t,r)=>"origin"in t.transform?"origin"in r.transform?t.transform.origin.origin.id<r.transform.origin.origin.id?-1:t.transform.origin.origin.id>r.transform.origin.origin.id?1:0:1:0;this._sortedRenderables[Ct.TRANSPARENT][Ct.TRANSPARENT].sort(e),this._sortedRenderables[Ct.TRANSPARENT][Ct.OPAQUE].sort(e),this._sortedRenderables[Ct.OPAQUE][Ct.TRANSPARENT].sort(e),this._sortedRenderables[Ct.OPAQUE][Ct.OPAQUE].sort(e)}static getKey(e,t,r){return`edges-t:${e}:${t}:${r}`}};const BB=hm();let D3e=class extends noe{constructor(e){super("EdgeProcessingWorker","extract",{extract:t=>[t.dataBuffer],extractComponentsEdgeLocations:t=>[t.dataBuffer],extractEdgeLocations:t=>[t.dataBuffer]},e)}async process(e,t,r){if(r)return Cse(e);const n=await this.invoke(new cI(e),t);return this._unpackOutput(n)}async extractEdgeLocations(e,t){const r=await this.invokeMethod("extractEdgeLocations",new cI(e),t);return yT(r)}async extractComponentsEdgeLocations(e,t){const r=await this.invokeMethod("extractComponentsEdgeLocations",new cI(e),t);return yT(r)}_unpackOutput(e){return{regular:{instancesData:yT(e.regular.instancesData),lodInfo:{lengths:new Float32Array(e.regular.lodInfo.lengths)}},silhouette:{instancesData:yT(e.silhouette.instancesData),lodInfo:{lengths:new Float32Array(e.silhouette.lodInfo.lengths)}},averageEdgeLength:e.averageEdgeLength}}},cI=class{constructor(e){this.dataBuffer=e.data.buffer,this.writerSettings=e.writerSettings,this.skipDeduplicate=e.skipDeduplicate,this.indices=Array.isArray(e.indices)?e.indices:e.indices.buffer,this.indicesType=Array.isArray(e.indices)?"Array":Rte(e.indices)?"Uint32Array":"Uint16Array",this.indicesLength=e.indicesLength}};function F3e(i){const t=I1.resolution,r=t/2,n=new Uint8Array(4*t*t),s=4*t*r,a=I1.amplitude,o=2*a,l=4*t,c=Math.log2(t)+1,u=I1.strokes.length;let d=(c-1)*u*l;for(const{distance:f,pressure:_}of I1.strokes){let g=f,w=_,v=d;for(let b=0;b<c;b++){b!==0&&(g=GB(g,Ix.DISTANCE),w=GB(w,Ix.PRESSURE));for(let x=0;x<I1.resolution;x++){const T=.5+(g?g[x%g.length]/o:0),R=w?w[x%w.length]:1;qI(T,n,v),qI(R,n,v+s),v+=4}v-=l*(u+1)}d+=l}const m=new Gi(i,{pixelFormat:St.RGBA,dataType:Xt.UNSIGNED_BYTE,hasMipmap:!1,samplingMode:Jt.LINEAR,width:t,height:t,wrapMode:ai.REPEAT},n);return new k3e(t,o,a,u,m)}function GB(i,e){if(!i)return null;const t=i.length/2,r=N3e*t,n=new Array(t);let s=0;const a=e===Ix.PRESSURE;for(let o=0;o<i.length;o+=2){const l=(i[o]+i[o+1])/2;n[s++]=a?Math.min(r,1-(1-l)*HB):Math.min(r,l*HB)}return n}var Ix;(function(i){i[i.DISTANCE=0]="DISTANCE",i[i.PRESSURE=1]="PRESSURE"})(Ix||(Ix={}));const N3e=.1,HB=.5;let k3e=class{constructor(e,t,r,n,s){this.resolution=e,this.normalizationScale=t,this.amplitude=r,this.variants=n,this.texture=s}dispose(){this.texture=ke(this.texture)}};const I1={amplitude:8,resolution:256,strokes:[{distance:[-1.59027,-1.59426,-1.59674,-1.59766,-1.59702,-1.59479,-1.59095,-1.5855,-1.57843,-1.56973,-1.55942,-1.5475,-1.53398,-1.5189,-1.50226,-1.4841,-1.46446,-1.44337,-1.42088,-1.39703,-1.37188,-1.34547,-1.31786,-1.28912,-1.2593,-1.22847,-1.19668,-1.16402,-1.13053,-1.09629,-1.06137,-1.02582,-.98972,-.95313,-.91611,-.87872,-.84102,-.80306,-.76488,-.72654,-.68807,-.64952,-.61092,-.57232,-.53375,-.49527,-.45692,-.41874,-.38078,-.34309,-.3057,-.26867,-.23204,-.19585,-.16015,-.12497,-.09036,-.05634,-.02296,.00977,.04183,.07321,.10389,.13386,.16313,.19169,.21956,.24672,.27321,.299,.32413,.34858,.37237,.3955,.41798,.43981,.461,.48154,.50145,.52073,.53939,.55744,.57488,.5917,.6079,.62347,.63837,.65259,.66609,.67885,.69083,.70201,.71235,.72183,.73042,.73812,.7449,.75076,.7557,.75973,.76284,.76507,.76642,.76692,.76659,.76545,.76352,.76083,.7574,.75324,.74837,.74279,.73652,.72959,.72199,.71377,.70493,.69553,.68558,.67515,.66426,.65298,.64135,.62944,.6173,.60499,.59257,.58008,.56759,.55513,.54275,.5305,.51842,.50654,.4949,.48353,.47246,.4617,.45128,.44121,.43149,.42213,.41313,.40448,.39617,.38818,.3805,.37309,.36594,.35902,.35229,.34572,.33927,.33292,.32663,.32035,.31407,.30774,.30135,.29486,.28824,.28148,.27454,.26739,.26002,.25241,.24454,.23639,.22796,.21922,.21016,.20076,.19098,.18082,.17023,.1592,.14768,.13566,.1231,.10996,.09624,.08188,.06688,.05121,.03485,.01778,0,-.0185,-.03771,-.05763,-.07824,-.09952,-.12144,-.14396,-.16706,-.19069,-.21481,-.23938,-.26436,-.28971,-.31539,-.34136,-.36759,-.39404,-.42067,-.44746,-.47437,-.50136,-.52839,-.55544,-.58248,-.60948,-.63642,-.66329,-.6901,-.71684,-.74352,-.77015,-.79675,-.82332,-.84988,-.87644,-.90301,-.92958,-.95615,-.98272,-1.00926,-1.03575,-1.06217,-1.08847,-1.11463,-1.1406,-1.16633,-1.19178,-1.2169,-1.24164,-1.26595,-1.28979,-1.31312,-1.3359,-1.35809,-1.37963,-1.4005,-1.42064,-1.44,-1.45853,-1.47616,-1.49285,-1.50853,-1.52313,-1.53659,-1.54886,-1.55986,-1.56955,-1.57788,-1.5848],pressure:[-.01365,-.00206,.01025,.02327,.03696,.05129,.06619,.08163,.09755,.11393,.1307,.14784,.16531,.18308,.20111,.21938,.23786,.25651,.2753,.29419,.31315,.33215,.35115,.37015,.38913,.40806,.42694,.44576,.46449,.48313,.50167,.5201,.53839,.55653,.57448,.59222,.60971,.62692,.6438,.66033,.67648,.69221,.70753,.72242,.73688,.75093,.76456,.77779,.79063,.80309,.81517,.82686,.83817,.84911,.85967,.86987,.87972,.88924,.89845,.90734,.91594,.92425,.93229,.94005,.94754,.95475,.96166,.96826,.97451,.9804,.98588,.99092,.99549,.99957,.99685,.99381,.99131,.98936,.98796,.98711,.98681,.98706,.98787,.98923,.99113,.99357,.99654,1,.99607,.99171,.98695,.98181,.97634,.97057,.96452,.95824,.95175,.94506,.93818,.93113,.92389,.91647,.90887,.90109,.89314,.88501,.87672,.86831,.85978,.85119,.84256,.83393,.82533,.8168,.80836,.80002,.79181,.78374,.77582,.7681,.76059,.75331,.74629,.73955,.73311,.72697,.72116,.71568,.71054,.70572,.70121,.697,.69304,.68931,.68576,.68236,.67905,.67582,.67262,.66941,.66619,.66291,.65957,.65613,.65259,.64892,.6451,.6411,.6369,.63248,.62783,.62295,.61783,.61247,.60688,.60104,.59498,.58868,.58216,.57542,.56845,.56125,.5538,.5461,.53813,.52986,.52129,.51239,.50316,.49359,.4837,.47349,.46299,.45223,.44124,.43005,.41869,.40719,.39557,.38386,.37207,.36023,.34836,.33648,.32464,.31287,.30119,.28963,.27822,.26698,.25594,.2451,.23448,.22409,.21391,.20394,.19415,.18452,.17503,.16565,.15636,.14713,.13794,.1288,.11968,.11058,.10151,.09247,.08346,.07447,.06552,.05659,.0477,.03885,.03007,.02137,.01278,.00433,-.00393,-.012,-.01983,-.02738,-.03463,-.04155,-.0481,-.05429,-.0601,-.06553,-.07057,-.07524,-.07954,-.08347,-.08703,-.09022,-.09303,-.09544,-.09744,-.09898,-.10004,-.10059,-.1006,-.10005,-.09892,-.0972,-.09487,-.09192,-.08833,-.08409,-.07918,-.07357,-.06724,-.06019,-.0524,-.04386,-.03455,-.02448]},{distance:[-3.46259,-3.47131,-3.47668,-3.47863,-3.47712,-3.4721,-3.46352,-3.45138,-3.43566,-3.41635,-3.39347,-3.36704,-3.33709,-3.30368,-3.26684,-3.22667,-3.18322,-3.1366,-3.08689,-3.0342,-2.97865,-2.92036,-2.85946,-2.79607,-2.73034,-2.66241,-2.59242,-2.52052,-2.44686,-2.37159,-2.29485,-2.2168,-2.13757,-2.05731,-1.97616,-1.89426,-1.81174,-1.72875,-1.64543,-1.56191,-1.47833,-1.39483,-1.3115,-1.22847,-1.14581,-1.06361,-.98193,-.90083,-.82036,-.74054,-.66141,-.583,-.50532,-.4284,-.35228,-.277,-.20261,-.12916,-.05672,.01463,.08485,.15384,.22153,.28784,.35269,.41602,.47776,.53787,.59629,.653,.70799,.76123,.81274,.86253,.9106,.95698,1.0017,1.04477,1.0862,1.126,1.16415,1.20065,1.23546,1.26857,1.29994,1.32953,1.35731,1.38321,1.40719,1.42921,1.44922,1.46719,1.48309,1.49691,1.50862,1.51825,1.52581,1.53133,1.53486,1.53644,1.53616,1.53409,1.53031,1.52493,1.51803,1.50972,1.50009,1.48924,1.47725,1.46421,1.45019,1.43527,1.4195,1.40295,1.38568,1.36778,1.34929,1.3303,1.31087,1.29108,1.27099,1.25066,1.23018,1.2096,1.18898,1.16838,1.14785,1.12745,1.10721,1.08719,1.06741,1.04791,1.02871,1.00986,.99136,.97324,.95551,.93819,.92127,.90476,.88866,.87296,.85767,.84277,.82823,.81406,.80022,.7867,.77346,.76049,.74774,.73519,.72278,.71049,.69827,.68606,.67381,.66145,.64893,.63618,.62313,.60973,.5959,.5816,.56675,.5513,.53516,.51826,.50053,.4819,.46231,.44169,.42002,.39725,.37336,.34834,.32219,.2949,.2665,.23698,.20638,.17469,.14193,.10809,.07316,.03714,0,-.03827,-.07772,-.11836,-.16022,-.20332,-.24768,-.29332,-.34024,-.38844,-.43788,-.48854,-.54036,-.59329,-.64724,-.70211,-.75782,-.81425,-.87128,-.92881,-.98674,-1.04498,-1.10346,-1.1621,-1.22086,-1.27969,-1.33854,-1.3974,-1.45625,-1.51511,-1.57396,-1.63283,-1.69173,-1.75067,-1.80968,-1.86875,-1.9279,-1.98712,-2.04639,-2.10568,-2.16495,-2.22416,-2.28322,-2.34208,-2.40063,-2.4588,-2.51647,-2.57354,-2.62989,-2.68543,-2.74002,-2.79357,-2.84597,-2.89711,-2.94689,-2.99521,-3.04195,-3.087,-3.13023,-3.17152,-3.21075,-3.24779,-3.28252,-3.3148,-3.34451,-3.37154,-3.39577,-3.41709,-3.43539,-3.45059],pressure:[.87183,.87151,.87129,.87118,.87117,.87128,.87149,.87182,.87225,.8728,.87347,.87424,.87513,.87613,.87723,.87845,.87978,.88122,.88276,.88441,.88616,.88801,.88996,.892,.89414,.89637,.89868,.90108,.90356,.90611,.90874,.91144,.91421,.91704,.91993,.92287,.92587,.92892,.93201,.93514,.93831,.94151,.94474,.94799,.95126,.95456,.95786,.96118,.9645,.96783,.97116,.97448,.9778,.98111,.98441,.9877,.99096,.99421,.99742,.99938,.99622,.9931,.99001,.98697,.98397,.98101,.97811,.97526,.97246,.96972,.96703,.96441,.96185,.95935,.95691,.95455,.95225,.95002,.94786,.94577,.94376,.94182,.93995,.93817,.93646,.93483,.93328,.93181,.93042,.92911,.92788,.92673,.92566,.92467,.92376,.92293,.92217,.92149,.92088,.92034,.91987,.91947,.91913,.91886,.91864,.91849,.91838,.91833,.91834,.91839,.91849,.91863,.91883,.91907,.91935,.91968,.92005,.92046,.92092,.92142,.92195,.92253,.92314,.9238,.92449,.92521,.92598,.92677,.9276,.92847,.92936,.93029,.93125,.93224,.93325,.9343,.93537,.93646,.93758,.93872,.93988,.94106,.94225,.94346,.94469,.94593,.94718,.94844,.94971,.95098,.95226,.95354,.95482,.9561,.95738,.95867,.95995,.96122,.9625,.96377,.96504,.9663,.96757,.96883,.97009,.97135,.97261,.97387,.97513,.9764,.97767,.97895,.98023,.98153,.98284,.98416,.98549,.98684,.98821,.9896,.99101,.99244,.99389,.99537,.99688,.99842,1,.99839,.99675,.99508,.99336,.99161,.98982,.98799,.98613,.98422,.98228,.98029,.97827,.97622,.97414,.97202,.96987,.9677,.96551,.9633,.96107,.95882,.95656,.9543,.95202,.94975,.94747,.94519,.94292,.94065,.93838,.93613,.93388,.93164,.92941,.9272,.92499,.9228,.92062,.91846,.91631,.91418,.91207,.90998,.90792,.90588,.90387,.90189,.89995,.89804,.89617,.89434,.89256,.89083,.88914,.88752,.88595,.88443,.88299,.88161,.8803,.87907,.87791,.87683,.87584,.87494,.87412,.8734,.87278,.87225]},{distance:[.39335,.43437,.47737,.52234,.56923,.61801,.66864,.72109,.7753,.83123,.88882,.94801,1.00875,1.07097,1.13461,1.1996,1.26586,1.33333,1.40193,1.47158,1.54221,1.61373,1.68607,1.75913,1.83284,1.90711,1.98186,2.05699,2.13243,2.20809,2.28387,2.35971,2.4355,2.51117,2.58663,2.66179,2.73658,2.81092,2.88473,2.95792,3.03043,3.10217,3.17308,3.24309,3.31211,3.3801,3.44697,3.51267,3.57712,3.64028,3.70208,3.76247,3.8214,3.87881,3.93467,3.98892,4.04152,4.09244,4.14164,4.18908,4.23474,4.27859,4.32061,4.36077,4.39905,4.43544,4.46992,4.50249,4.53314,4.56185,4.58864,4.61349,4.63642,4.65745,4.67657,4.69381,4.7092,4.72274,4.73447,4.74441,4.75259,4.75903,4.76376,4.76682,4.76822,4.768,4.76618,4.76279,4.75786,4.75142,4.74348,4.73409,4.72326,4.71102,4.69739,4.68241,4.6661,4.64849,4.6296,4.60948,4.58816,4.56567,4.54204,4.51732,4.49154,4.46473,4.43694,4.4082,4.37854,4.348,4.31662,4.28443,4.25145,4.21773,4.1833,4.14819,4.11243,4.07606,4.03912,4.00162,3.96361,3.92512,3.88618,3.84683,3.80708,3.76697,3.72653,3.68579,3.64478,3.60351,3.56202,3.52033,3.47845,3.43642,3.39425,3.35196,3.30957,3.2671,3.22455,3.18196,3.13933,3.09668,3.05402,3.01136,2.96873,2.92613,2.88357,2.84108,2.79865,2.75631,2.71407,2.67195,2.62994,2.58807,2.54634,2.50477,2.46338,2.42216,2.38114,2.34032,2.29971,2.25933,2.21916,2.17923,2.13954,2.10008,2.06087,2.02189,1.98316,1.94468,1.90644,1.86845,1.83069,1.79316,1.75586,1.71877,1.68189,1.6452,1.60868,1.57232,1.53611,1.50004,1.46407,1.4282,1.39241,1.35668,1.321,1.28535,1.24972,1.2141,1.17849,1.14286,1.10723,1.07158,1.03593,1.00028,.96464,.92902,.89344,.85793,.8225,.78719,.75203,.71705,.68231,.64784,.61369,.57991,.54656,.51368,.48134,.44959,.41849,.3881,.35848,.32967,.30174,.27474,.24872,.22373,.19982,.17702,.15539,.13497,.11579,.09791,.08137,.06621,.05248,.04022,.02948,.02029,.01271,.00677,.00252,0,-76e-5,27e-5,.00314,.00788,.01451,.02307,.03357,.04604,.0605,.07697,.09546,.11599,.13858,.16322,.18992,.21869,.24952,.28241,.31735,.35434],pressure:[.95248,.95236,.95228,.95223,.95222,.95224,.95231,.95241,.95256,.95274,.95296,.95322,.95352,.95385,.95423,.95465,.9551,.9556,.95613,.9567,.95731,.95796,.95864,.95936,.96012,.96091,.96173,.96259,.96348,.9644,.96535,.96633,.96734,.96838,.96944,.97053,.97164,.97277,.97393,.9751,.97629,.9775,.97873,.97997,.98122,.98249,.98376,.98505,.98634,.98763,.98893,.99023,.99154,.99284,.99414,.99544,.99673,.99802,.9993,.99942,.99816,.99691,.99568,.99445,.99324,.99205,.99087,.98972,.98858,.98746,.98636,.98528,.98423,.9832,.98219,.98121,.98025,.97931,.9784,.97752,.97666,.97582,.97501,.97423,.97347,.97274,.97203,.97135,.9707,.97007,.96948,.9689,.96836,.96784,.96735,.96689,.96646,.96605,.96567,.96533,.965,.96471,.96445,.96421,.964,.96382,.96367,.96355,.96346,.96339,.96335,.96334,.96336,.9634,.96348,.96358,.9637,.96385,.96403,.96423,.96446,.96471,.96499,.96529,.96561,.96595,.96631,.96669,.96709,.96751,.96795,.9684,.96887,.96935,.96984,.97035,.97087,.9714,.97194,.97249,.97304,.97361,.97418,.97476,.97534,.97592,.97651,.97711,.9777,.9783,.9789,.9795,.9801,.9807,.9813,.9819,.9825,.98309,.98369,.98428,.98486,.98545,.98603,.98661,.98718,.98775,.98832,.98888,.98944,.99,.99056,.99112,.99167,.99223,.99279,.99335,.99392,.99449,.99507,.99565,.99624,.99684,.99745,.99807,.9987,.99934,1,.99933,.99866,.99797,.99727,.99656,.99583,.9951,.99435,.99359,.99283,.99205,.99126,.99046,.98966,.98885,.98803,.9872,.98637,.98554,.9847,.98387,.98303,.98219,.98134,.9805,.97967,.97883,.978,.97717,.97634,.97552,.97471,.97389,.97309,.97229,.9715,.97071,.96993,.96915,.96838,.96762,.96687,.96612,.96539,.96466,.96395,.96324,.96255,.96187,.9612,.96055,.95991,.95929,.95869,.95811,.95754,.957,.95648,.95599,.95552,.95508,.95467,.95428,.95393,.9536,.95331,.95305,.95283,.95264]},{distance:[2.85606,2.86149,2.86432,2.8645,2.862,2.85686,2.84912,2.83886,2.82618,2.81117,2.79393,2.77456,2.75314,2.72975,2.70447,2.67734,2.64844,2.61784,2.58564,2.55196,2.5169,2.48057,2.44305,2.40438,2.36462,2.32383,2.28208,2.23943,2.19591,2.15153,2.10628,2.06016,2.01321,1.96548,1.91702,1.86793,1.8183,1.76829,1.71803,1.66767,1.61737,1.56726,1.51746,1.46803,1.41902,1.37044,1.32228,1.27452,1.22716,1.18023,1.13376,1.08781,1.04244,.99769,.95357,.91003,.86701,.82447,.78238,.74069,.69938,.65836,.61758,.57699,.53656,.49627,.45611,.41611,.37632,.33683,.29776,.25924,.22141,.18441,.14839,.11346,.07972,.04727,.01619,-.01348,-.0417,-.0684,-.09351,-.11698,-.13875,-.1588,-.17713,-.19381,-.20889,-.22242,-.23444,-.24501,-.25421,-.26216,-.26897,-.27473,-.27951,-.28336,-.28631,-.28836,-.28948,-.28963,-.28873,-.28673,-.28355,-.27916,-.27354,-.26673,-.25878,-.2498,-.23992,-.22929,-.21802,-.20623,-.19398,-.18134,-.16836,-.1551,-.14163,-.12809,-.11461,-.1013,-.08826,-.07557,-.06335,-.0517,-.04077,-.03065,-.02143,-.01321,-.00606,0,.00496,.00888,.01181,.01385,.01511,.0157,.01574,.01533,.01458,.01358,.0124,.01112,.00979,.00851,.00738,.0065,.006,.00596,.00646,.00754,.00924,.01161,.01471,.01858,.02323,.02865,.03481,.04169,.0493,.05765,.06677,.07671,.08754,.09934,.11222,.12628,.14159,.15823,.17624,.19561,.21632,.23828,.26142,.28563,.31083,.33696,.36397,.39185,.42057,.4501,.48036,.51125,.54264,.5744,.60646,.63871,.67105,.70337,.73556,.76751,.79918,.83048,.86139,.8919,.92202,.95184,.98144,1.01094,1.04045,1.0701,1.10002,1.13029,1.16103,1.1923,1.22416,1.25664,1.28979,1.32364,1.35824,1.39363,1.42985,1.4669,1.50475,1.54332,1.58252,1.62227,1.6625,1.70312,1.744,1.78501,1.82598,1.8668,1.90734,1.94754,1.98732,2.02666,2.06555,2.10402,2.1421,2.17985,2.2173,2.25448,2.29139,2.328,2.36424,2.4,2.43515,2.46955,2.50309,2.53565,2.56717,2.59761,2.62692,2.65505,2.68191,2.7074,2.73138,2.75375,2.7744,2.79324,2.81017,2.82504,2.83772,2.8481],pressure:[.22758,.23641,.24578,.25568,.26609,.27699,.28835,.30016,.31237,.32495,.33789,.35113,.36466,.37843,.39241,.40658,.4209,.43535,.44989,.4645,.47916,.49385,.50853,.5232,.53784,.55243,.56696,.58141,.59578,.61004,.62419,.63821,.65209,.6658,.67934,.69268,.70582,.71873,.73139,.7438,.75594,.76779,.77935,.79061,.80156,.81221,.82254,.83258,.84231,.85176,.86091,.86978,.87837,.88669,.89473,.9025,.91,.91725,.92425,.931,.93752,.9438,.94985,.95566,.96124,.96658,.97168,.97652,.98109,.98539,.98939,.99309,.99646,.99949,.99783,.99552,.99361,.99209,.99098,.99029,.99003,.99019,.99079,.99181,.99324,.9951,.99735,1,.99698,.99361,.98992,.98592,.98163,.97709,.97231,.96731,.96212,.95676,.95122,.94554,.93973,.93378,.92773,.92157,.91532,.90899,.90258,.89612,.88961,.88308,.87653,.87,.8635,.85705,.85068,.8444,.83823,.83219,.82628,.82052,.81493,.80952,.8043,.79929,.7945,.78994,.78561,.78151,.77765,.77402,.77062,.76742,.76443,.76161,.75896,.75645,.75406,.75175,.74951,.7473,.74511,.74289,.74064,.73833,.73592,.73341,.73078,.728,.72507,.72197,.71869,.71522,.71156,.70769,.70363,.69936,.69489,.69021,.68533,.68023,.67492,.66939,.66363,.65765,.65145,.64501,.63833,.63143,.62428,.61691,.60931,.60148,.59344,.58521,.57679,.5682,.55948,.55063,.54167,.53264,.52354,.51439,.50522,.49603,.48686,.47773,.46865,.45964,.45072,.44192,.43324,.42469,.41629,.40804,.39994,.392,.3842,.37655,.36903,.36164,.35437,.3472,.34012,.33312,.3262,.31933,.31251,.30574,.299,.2923,.28563,.27899,.27239,.26583,.25933,.25288,.24652,.24025,.2341,.22808,.22221,.21653,.21104,.20576,.20072,.19592,.19138,.18712,.18313,.17943,.17602,.17292,.17013,.16766,.16551,.16369,.16222,.1611,.16036,.16001,.16007,.16055,.16148,.16286,.16471,.16705,.16988,.17321,.17706,.18144,.18636,.19182,.19785,.20443,.21158,.2193]},{distance:[-2.31317,-2.3191,-2.32189,-2.32154,-2.31811,-2.31174,-2.30254,-2.29062,-2.27609,-2.25904,-2.23954,-2.21767,-2.19355,-2.16732,-2.13907,-2.10885,-2.07672,-2.04268,-2.00677,-1.96911,-1.92985,-1.88914,-1.84713,-1.80397,-1.75979,-1.71467,-1.66864,-1.62171,-1.57395,-1.52546,-1.47625,-1.42628,-1.3755,-1.32384,-1.27131,-1.218,-1.16408,-1.10972,-1.05508,-1.00031,-.94551,-.89077,-.83615,-.7817,-.72757,-.6739,-.62076,-.56821,-.51625,-.46484,-.41397,-.36366,-.314,-.26506,-.21689,-.16957,-.12316,-.07766,-.03301,.01085,.05399,.09643,.13827,.17967,.22079,.26176,.30265,.34342,.38397,.42414,.46381,.50285,.54115,.57863,.61524,.65093,.6856,.71914,.75153,.78275,.81283,.84182,.86972,.89651,.92208,.94634,.96919,.99052,1.01025,1.02835,1.04484,1.05976,1.07309,1.08479,1.09492,1.1036,1.11096,1.11714,1.12224,1.12627,1.12916,1.13083,1.13125,1.13036,1.12816,1.12466,1.11992,1.11397,1.10677,1.09827,1.08849,1.07746,1.06527,1.05203,1.03786,1.02283,1.00695,.99025,.97279,.9546,.93573,.9163,.8965,.8765,.85647,.83652,.81687,.79775,.77939,.76199,.74568,.73049,.71635,.70316,.69082,.67925,.66834,.65804,.64831,.63911,.63032,.62184,.61363,.60564,.59788,.59036,.58308,.57597,.5689,.56177,.55447,.5469,.53896,.53062,.5219,.51283,.5034,.49355,.48335,.47287,.46223,.45154,.44085,.43012,.41923,.40805,.39648,.38441,.37176,.35849,.34458,.32999,.31461,.29833,.28109,.26288,.2437,.22361,.20265,.18082,.15807,.13434,.1096,.0838,.0569,.02894,0,-.0298,-.0604,-.09173,-.12364,-.15594,-.18843,-.22092,-.25331,-.28559,-.31781,-.35006,-.38244,-.41502,-.44785,-.48098,-.5144,-.54811,-.58218,-.61666,-.65153,-.68677,-.72232,-.75807,-.79397,-.83002,-.86628,-.90281,-.93968,-.97693,-1.01465,-1.05282,-1.09139,-1.13031,-1.16956,-1.20917,-1.24905,-1.28907,-1.32908,-1.36891,-1.40844,-1.44765,-1.48658,-1.52527,-1.56376,-1.60206,-1.64016,-1.67801,-1.71552,-1.75264,-1.78936,-1.8257,-1.86161,-1.89702,-1.93182,-1.96584,-1.99894,-2.03102,-2.06203,-2.0919,-2.12056,-2.14794,-2.17397,-2.19852,-2.22138,-2.24235,-2.26129,-2.27805,-2.29243,-2.30422],pressure:[.9681,.97424,.98046,.98674,.99309,.9995,.99404,.98754,.981,.97444,.96785,.96124,.95462,.94801,.94139,.93479,.92822,.92167,.91515,.90868,.90225,.89589,.88959,.88336,.87722,.87115,.86519,.85932,.85356,.84792,.84239,.83699,.83173,.8266,.82162,.81679,.81211,.80759,.80324,.79906,.79505,.79121,.78756,.78409,.78081,.77771,.77481,.77211,.76959,.76728,.76516,.76324,.76153,.76001,.75869,.75757,.75665,.75593,.7554,.75507,.75493,.75498,.75523,.75565,.75627,.75706,.75803,.75917,.76049,.76197,.76361,.76541,.76737,.76947,.77172,.77409,.7766,.77923,.78198,.78484,.7878,.79086,.79401,.79724,.80055,.80394,.8074,.81092,.8145,.81813,.82182,.82556,.82934,.83317,.83703,.84093,.84487,.84884,.85284,.85687,.86094,.86503,.86915,.87329,.87746,.88166,.88587,.89011,.89436,.89863,.90291,.9072,.91149,.91579,.92009,.92438,.92867,.93295,.9372,.94144,.94566,.94985,.954,.95812,.96219,.96623,.97021,.97415,.97802,.98184,.9856,.9893,.99293,.9965,1,.99657,.9932,.98991,.98668,.98352,.98042,.97738,.9744,.97148,.9686,.96577,.96298,.96023,.95751,.95482,.95214,.94949,.94684,.9442,.94156,.93892,.93627,.93361,.93094,.92825,.92555,.92284,.9201,.91735,.91458,.91179,.90899,.90616,.90332,.90047,.8976,.89472,.89183,.88893,.88603,.88314,.88024,.87735,.87448,.87162,.86878,.86597,.86319,.86044,.85774,.85508,.85247,.84993,.84744,.84503,.84269,.84042,.83825,.83616,.83417,.83227,.83048,.8288,.82724,.82578,.82445,.82324,.82215,.82119,.82037,.81967,.81911,.81868,.81839,.81824,.81823,.81835,.81862,.81903,.81957,.82026,.82109,.82206,.82317,.82443,.82583,.82737,.82906,.83089,.83287,.83499,.83726,.83968,.84223,.84494,.84778,.85077,.8539,.85717,.86058,.86412,.86781,.87163,.87559,.87968,.88391,.88826,.89275,.89737,.90211,.90698,.91198,.91709,.92233,.92768,.93315,.93873,.94441,.95019,.95607,.96205]},{distance:[4.72925,4.81721,4.9037,4.98859,5.07177,5.15311,5.23249,5.3098,5.38491,5.45772,5.52811,5.59598,5.66122,5.72375,5.78346,5.84028,5.8941,5.94486,5.99248,6.03689,6.07803,6.11584,6.15028,6.18128,6.20882,6.23285,6.25336,6.27031,6.28369,6.29348,6.29969,6.3023,6.30133,6.29678,6.28867,6.27703,6.26187,6.24324,6.22116,6.19567,6.16683,6.13468,6.09928,6.06068,6.01896,5.97417,5.92639,5.87569,5.82217,5.76589,5.70696,5.64545,5.58147,5.5151,5.44644,5.37559,5.30265,5.2277,5.15085,5.0722,4.99184,4.90987,4.82639,4.74151,4.65533,4.56794,4.47945,4.38996,4.29959,4.20843,4.11658,4.02416,3.93125,3.83796,3.74437,3.65057,3.55666,3.46272,3.36884,3.27509,3.18155,3.08831,2.99545,2.90303,2.81114,2.71984,2.62922,2.53933,2.45026,2.36207,2.27484,2.18862,2.10349,2.01951,1.93675,1.85528,1.77515,1.69644,1.61919,1.54348,1.46935,1.39685,1.32605,1.25698,1.18967,1.12417,1.06049,.99863,.93862,.88044,.82408,.76953,.71676,.66574,.61644,.56882,.52282,.47841,.43553,.39413,.35414,.31551,.27817,.24206,.20712,.17328,.14048,.10866,.07776,.04772,.01848,-.00999,-.03776,-.06487,-.09134,-.11721,-.14251,-.16725,-.19144,-.21509,-.2382,-.26076,-.28275,-.30416,-.32496,-.34511,-.36459,-.38334,-.40134,-.41852,-.43485,-.45026,-.46471,-.47815,-.49052,-.50179,-.51189,-.52081,-.52849,-.5349,-.54003,-.54383,-.54627,-.54734,-.54702,-.54528,-.54211,-.53752,-.53149,-.52403,-.51515,-.50487,-.4932,-.48015,-.46575,-.45001,-.43297,-.41463,-.39503,-.37419,-.35213,-.32887,-.30443,-.27885,-.25214,-.22432,-.19541,-.16544,-.13442,-.10235,-.06926,-.03514,0,.03616,.07336,.11159,.15088,.19125,.23272,.27531,.31906,.36401,.41019,.45764,.5064,.55651,.60802,.66096,.71538,.77129,.82874,.88776,.94836,1.01056,1.07438,1.13982,1.20687,1.27554,1.34581,1.41766,1.49107,1.56599,1.64239,1.72025,1.79951,1.88013,1.96209,2.04532,2.12979,2.21546,2.30226,2.39017,2.47911,2.56905,2.65991,2.75164,2.84416,2.93742,3.03133,3.12582,3.2208,3.31619,3.41191,3.50785,3.60393,3.70006,3.79612,3.89202,3.98765,4.08291,4.17767,4.27182,4.36525,4.45783,4.54944,4.63995],pressure:[.30942,.30838,.30765,.30724,.30715,.30738,.30795,.30884,.31007,.31164,.31354,.31578,.31837,.32129,.32455,.32815,.33209,.33636,.34097,.34591,.35117,.35675,.36265,.36887,.37539,.38221,.38933,.39674,.40442,.41238,.4206,.42907,.43779,.44675,.45593,.46533,.47493,.48473,.49471,.50486,.51517,.52563,.53623,.54694,.55777,.5687,.57971,.59079,.60194,.61313,.62435,.6356,.64686,.65811,.66935,.68056,.69174,.70286,.71391,.72489,.73579,.74659,.75728,.76785,.7783,.7886,.79876,.80877,.81861,.82827,.83776,.84706,.85617,.86507,.87378,.88227,.89056,.89863,.90649,.91412,.92153,.92872,.93568,.94241,.94892,.95519,.96122,.96702,.97258,.97791,.98299,.98783,.99242,.99677,.99911,.99525,.99164,.98827,.98515,.98228,.97966,.97728,.97514,.97324,.97159,.97017,.96898,.96801,.96727,.96674,.96641,.96629,.96635,.96661,.96703,.96762,.96838,.96928,.97032,.97149,.97279,.9742,.97572,.97734,.97905,.98085,.98273,.98468,.98669,.98877,.99091,.99311,.99535,.99765,1,.9976,.99516,.99267,.99014,.98755,.98491,.98222,.97947,.97666,.97378,.97083,.96781,.96471,.96153,.95826,.9549,.95144,.94787,.9442,.94042,.93651,.93249,.92834,.92407,.91966,.91512,.91045,.90564,.90069,.8956,.89037,.885,.87949,.87384,.86806,.86214,.85608,.84988,.84356,.83711,.83053,.82383,.81702,.81009,.80306,.79594,.78872,.78141,.77403,.76657,.75905,.75148,.74385,.73619,.72849,.72076,.71302,.70526,.69749,.68972,.68195,.67419,.66644,.65871,.65099,.64329,.63561,.62795,.62032,.61271,.60512,.59755,.59001,.58248,.57497,.56749,.56002,.55256,.54512,.5377,.5303,.52291,.51554,.50819,.50087,.49358,.48632,.4791,.47192,.4648,.45773,.45072,.44378,.43692,.43015,.42346,.41687,.41039,.40403,.39779,.39168,.38571,.37989,.37423,.36873,.36342,.35828,.35335,.34862,.34409,.3398,.33573,.3319,.32831,.32498,.32192,.31912,.3166,.31436,.31242,.31077]}]};function jB(i){let e=null;for(const t of i){const r=t.type;if(V3e(t)){if(C(e))e=r;else if(e!==r)return"uber"}}return y(e)?e:"uber"}function qB(i){let e=Ct.INVISIBLE;for(const{material:t}of i)if(Yee(t)){if(t.color[3]*t.opacity<1)return Ct.TRANSPARENT;e=Ct.OPAQUE}return e}function WB(i){let e=Ct.INVISIBLE;for(const{material:t}of i)if(Yee(t)){switch(t.objectTransparency){case Ct.TRANSPARENT:case Ct.INVISIBLE:return Ct.TRANSPARENT;case Ct.OPAQUE:if(t.opacity<1)return Ct.TRANSPARENT}e=Ct.OPAQUE}return e}function Yee(i){return i.size*i.color[3]*i.opacity>0}function V3e(i){return i.size*i.color[3]>0}function XB(i,e,t,r){for(let n=0;n<i.length;n++){const s=i[n].index,a=e[n],o=e[n+1];if(r)for(let l=a;l<o;l++){const c=r[l];t.set(c,s)}else for(let l=a;l<o;l++)t.set(l,s)}}let lc=class extends pe{constructor(e){super(e),this._updatingHandles=new _v,this._perObjectData=new Map,this._perObjectDataEvictionCache=new Set,this._renderers=new Map,this._gpuMemoryUsage=0,this._workerAbort=new AbortController,this._tmpModelPosition=P(),this._localOrigins=new f3e(new M4(e.renderSR))}initialize(){this._worker=new D3e(this.schedule),this._componentColorManager=new dee(this.rctx,3);const e=Sse.createBuffer(4);for(let t=0;t<4;t++)e.sideness.set(t,0,t===0||t===3?0:1),e.sideness.set(t,1,t===0||t===1?0:1);this._verticesBufferObject=ui.createVertex(this.rctx,mi.STATIC_DRAW,e.buffer)}destroy(){this.destroyed||(this._perObjectData.forEach(e=>this._discardObjectEntry(e)),this._perObjectData.clear(),this._strokesTexture=ke(this._strokesTexture),this._componentColorManager=Oe(this._componentColorManager),this._workerAbort.abort(),this._worker.destroy(),this._verticesBufferObject=ke(this._verticesBufferObject),this._renderers.clear(),this._updatingHandles.destroy())}get updating(){return this._updatingHandles.updating}get usedMemory(){return this._gpuMemoryUsage}shouldRender(){return this._renderers.size>0}async addComponentObject(e,t,r,n,s,a,o,l){if(this.hasObject(e))return this.getObjectMemoryUsage(e);let c;const u=new QB(new Promise(m=>c=m),r.center,r.radius);this._perObjectData.set(e,u);const d=await this._updatingHandles.addPromise(this._addComponentGeometry(t,u,n,s,a,o,l));return this.setNeedsRender(),c(),d}async addOrUpdateObject3D(e,t,r,n){if(this.destroyed)return void ee.getLogger(this.declaredClass).warn("Attempt to add an object to a destroyed instance");const s=this._perObjectData.get(e);let a;(s==null?void 0:s.renderables.length)>0&&this._perObjectDataEvictionCache.add(s);const o=e.boundingVolumeWorldSpace.bounds,l=new QB(new Promise(u=>a=u),PD(o),AG(o));this._perObjectData.set(e,l);const c=new Array;if(r.mergeGeometries&&e.geometries.length>1&&z3e(e))c.push(this._addObjectMergedGeometries(e,l,t,r,n));else for(let u=0;u<e.geometries.length;u++){const d=e.geometryRecords[u];if(!d.material.supportsEdges)continue;const m=e.geometries[u];c.push(this._addGeometry(e,l,m,d,t[0],r,n))}await this._updatingHandles.addPromise(Promise.all(c)),this._perObjectDataEvictionCache.delete(l),this._discardObjectEntry(s),this.setNeedsRender(),a()}_discardObjectEntry(e){e&&(e.renderables.length&&(e.renderables.forEach(t=>this._removeRenderable(t)),this.setNeedsRender()),e.loaded=null)}hasObject(e){return this._perObjectData.has(e)}async updateAllComponentOpacities(e,t){const r=await this._updatingHandles.addPromise(this._getObjectEntry(e));if(C(r))return;const n=t instanceof Array?s=>t[s]:()=>t;r.renderables.forEach(s=>{const a=s.components.meta.length;for(let o=0;o<a;o++){const l=n(o),c=s.components.meta[o],u=c.index;c.material.opacity=l,s.components.buffer.textureBuffer.setDataElement(u,1,3,255*l)}this._updateTransparency(s)}),this.setNeedsRender()}async getObjectMemoryUsage(e){const t=await this._getObjectEntry(e);return y(t)?t.renderables.reduce((r,n)=>r+n.statistics.gpuMemoryUsage,0):0}async updateAllComponentMaterials(e,t,r,n){const s=e instanceof Bd,a=!!r.hasSlicePlane,o=jB(t),l=lI.getKey(o,a,s),c=await this._updatingHandles.addPromise(this._getObjectEntry(e));C(c)||(c.renderables.forEach(u=>{if(l!==u.rendererKey){const d=this._renderers.get(u.rendererKey),m=this._acquireRenderer(o,a,s);d.removeRenderable(u),--d.refCount,u.rendererKey=l,m.addRenderable(u)}for(let d=0;d<t.length;d++)u.components.meta[d].material=t[d];n&&this._updateComponentBuffer(u.components),this._updateTransparency(u)}),this.setNeedsRender())}async updateAllVerticalOffsets(e,t){const r=await this._updatingHandles.addPromise(this._getObjectEntry(e));C(r)||(r.renderables.forEach(n=>{const s=n.components.meta;for(let a=0;a<s.length;a++)n.components.meta[a].verticalOffset=(t==null?void 0:t[a])??0;this._updateComponentBuffer(n.components)}),this.setNeedsRender())}async updateObjectVisibility(e,t){const r=await this._updatingHandles.addPromise(this._getObjectEntry(e));y(r)&&(r.renderables.forEach(n=>n.visible=t),this.setNeedsRender())}removeObject(e){const t=this._perObjectData.get(e);t&&(this._perObjectData.delete(e),this._discardObjectEntry(t))}async _getObjectEntry(e){const t=this._perObjectData.get(e);if(!t)throw"no object";return await t.loaded,t.loaded==null?null:t}render(e,t){if(C(this._componentColorManager))return;this._localOrigins.updateViewMatrices(e.camera.viewMatrix);const r=e.camera.viewInverseTransposeMatrix,n=P(),s=new eA;let a=0,o=0;if(this._renderers.forEach(c=>{if(c.refCount===0)this._renderers.delete(c.key),c.dispose();else{let u=!0,d=!0;c.forEachRenderable(m=>{m.visible&&(a+=m.statistics.averageEdgeLength,o++,u&&m.regular&&(c.updateTechnique(e,!1),u=!1),d&&m.silhouette&&(c.updateTechnique(e,!0),d=!1))},t)}}),this._componentColorManager.garbageCollect(),this._componentColorManager.updateTextures(),o===0)return;const l=new _3e(40*a/o,t);Y(n,r[3],r[7],r[11]),s.set(n),X(l.transformWorldFromViewTH,s.high),X(l.transformWorldFromViewTL,s.low),Td(l.transformViewFromCameraRelativeRS,e.camera.viewMatrix),qc(e7,l.transformViewFromCameraRelativeRS),Kg(l.transformNormalViewFromGlobal,e7),l.transformProjFromView=e.camera.projectionMatrix,this._updateObjectCameraDistances(e),this._renderers.forEach(c=>{this._renderRegularEdges(c,e,l),this._renderSilhouetteEdges(c,e,l)})}_updateTransparency(e){const t=qB(e.components.meta),r=WB(e.components.meta);t===e.edgeTransparency&&r===e.objectTransparency||(e.edgeTransparency=t,e.objectTransparency=r,this._renderers.get(e.rendererKey).setRenderablesDirty())}_computeModelTransformWithLocalOrigin(e,t,r){e.getCombinedStaticTransformation(t,r);const n=y(t.origin)?this._localOrigins.register(t.origin):this._localOrigins.acquire(Y(this._tmpModelPosition,r[12],r[13],r[14]));return t.origin=n.origin,p3e(n.origin.vec3,r),n}_updateComponentBuffer(e){const{meta:t,buffer:r}=e,n=new Uint8Array(4);for(let s=0;s<t.length;s++){const a=t[s].material,o=t[s].index,l=ue(Math.round(a.size*I3e),0,255),c=ue(a.extensionLength,-oI,255-oI)+oI,u=a.type==="solid"?nk.SOLID:nk.SKETCH,d=255*a.opacity,m=a.color,f=255*m[0],_=255*m[1],g=255*m[2],w=255*m[3];r.textureBuffer.setData(o,0,f,_,g,w),r.textureBuffer.setData(o,1,l,c,u,d),oee(t[s].verticalOffset,n),r.textureBuffer.setData(o,2,n[0],n[1],n[2],n[3])}}_createComponentBuffers(e){if(C(this._componentColorManager))return null;const t=new Array,r=this._componentColorManager.getBuffer(e.length);for(let s=0;s<e.length;s++){const a=e[s],o=r.acquireIndex();t.push({index:o,verticalOffset:0,material:a})}const n=new B3e(r,t);return this._updateComponentBuffer(n),n}_extractEdges(e,t,r,n,s,a=s.length){return this._worker.process({data:t,indices:s,indicesLength:a,writerSettings:e,skipDeduplicate:r},this._workerAbort.signal,n)}_createRenderable(e,t,r,n,s){const a=y(this._verticesBufferObject)&&e.regular.lodInfo.lengths.length>0?new ZB(new nu(this.rctx,GI,{vertices:sk,instances:Ese.glLayout},{vertices:this._verticesBufferObject,instances:ui.createVertex(this.rctx,mi.STATIC_DRAW,e.regular.instancesData.buffer)}),e.regular.lodInfo):null,o=y(this._verticesBufferObject)&&e.silhouette.lodInfo.lengths.length>0?new ZB(new nu(this.rctx,GI,{vertices:sk,instances:Rse.glLayout},{vertices:this._verticesBufferObject,instances:ui.createVertex(this.rctx,mi.STATIC_DRAW,e.silhouette.instancesData.buffer)}),e.silhouette.lodInfo):null,l=(y(a)?a.vao.size:0)+(y(o)?o.vao.size:0);return new H3e(a,o,{gpuMemoryUsage:l,externalMemoryUsage:s,averageEdgeLength:e.averageEdgeLength},r,qB(t.meta),WB(t.meta),t,n)}async _addGeometry(e,t,r,n,s,a,o){const l=r.vertexAttributes.get(S.POSITION),c=r.indices.get(S.POSITION),u=xe(),d=this._computeModelTransformWithLocalOrigin(e,n,u),m=new JB(l,c,u,d);return this._addPositionData(t,m,r.edgeIndicesLength,s,a,o)}async _addPositionData(e,t,r,n,s,a=!1){if(e.loaded==null)return;const o=this._createComponentBuffers([n]);if(C(o)||r<=0)return;const l=this._acquireRenderer(n.type,!!s.hasSlicePlane,!0),{modelTransform:c,origin:u}=t,d=t.indices,m=t.position,f=m.data.length/m.size,_=BI.createBuffer(f);for(let v=0;v<f;v++)_.position.set(v,0,m.data[v*m.size+0]),_.position.set(v,1,m.data[v*m.size+1]),_.position.set(v,2,m.data[v*m.size+2]);XB(o.meta,[0,_.componentIndex.count],_.componentIndex);const g=await this._updatingHandles.addPromise(this._extractEdges(l.writerSettings,_,!1,a,d,r));if(e.loaded==null)return;const w=this._createRenderable(g,o,new G3e(c,u),l.key,!1);e.renderables.push(w),l.addRenderable(w),this._gpuMemoryUsage+=w.statistics.gpuMemoryUsage}async _addComponentGeometry(e,t,r,n,s,a,o){if(t.loaded==null)return 0;const l=this._createComponentBuffers(a);if(C(l))return 0;const c=jB(a),u=this._acquireRenderer(c,o.hasSlicePlane||!1,!1),d=BI.createBuffer(r.count);RH(d.position,r),XB(l.meta,s,d.componentIndex,n);const m=!0,f=u.writerSettings,_=await this._updatingHandles.addPromise(this._extractEdges(f,d,m,!1,n));if(t.loaded==null)return 0;const g=this._createRenderable(_,l,e,u.key,!0);return t.renderables.push(g),u.addRenderable(g),g.statistics.gpuMemoryUsage}async _addObjectMergedGeometries(e,t,r,n,s){const a=new Map;let o=0,l=null,c=0;for(let b=0;b<e.geometries.length;b++){const x=e.geometries[b],T=e.geometryRecords[b];if(!T.material.supportsEdges)continue;!l&&T.origin&&(l=T);const R=x.vertexAttributes.get(S.POSITION);c+=R.data.length/R.size,o+=x.edgeIndicesLength}const u=c>=65536?Uint32Array:Uint16Array,d=o?new u(o):null,m=[];let f=0;for(let b=0;b<e.geometries.length;b++){const x=e.geometries[b];if(!e.geometryRecords[b].material.supportsEdges)continue;const T=x.vertexAttributes.get(S.POSITION),R=x.indices.get(S.POSITION);let E=a.get(T.data);if(E==null){E=m.length/3;for(let O=0;O<T.data.length;O+=T.size)m.push(T.data[O+0]),m.push(T.data[O+1]),m.push(T.data[O+2]);a.set(T.data,E)}if(R)for(let O=0;O<x.edgeIndicesLength;O++)d[f++]=E+R[O]}const _=l||e.geometryRecords[0],g=xe(),w=this._computeModelTransformWithLocalOrigin(e,_,g);for(let b=0;b<e.geometryRecords.length;b++)e.geometryRecords[b].origin=w.origin;const v=new JB({data:m,size:3},d,g,w);await this._updatingHandles.addPromise(this._addPositionData(t,v,d.length,r[0],n,s))}_acquireRenderer(e,t,r){const n=lI.getKey(e,t,r);let s=this._renderers.get(n);return C(this._strokesTexture)&&(this._strokesTexture=F3e(this.rctx)),s||(s=new lI(this.rctx,this.techniqueRepository,{type:e,hasSlicePlane:t,strokesTexture:this._strokesTexture,legacy:r,spherical:this.viewingMode===Ie.Global}),this._renderers.set(n,s)),++s.refCount,s}_removeRenderable(e){U3e(e);const t=this._renderers.get(e.rendererKey);if(t){t.removeRenderable(e),--t.refCount,"origin"in e.transform&&this._localOrigins.release(e.transform.origin),this._gpuMemoryUsage-=e.statistics.externalMemoryUsage?0:e.statistics.gpuMemoryUsage;for(const r of e.components.meta)e.components.buffer.releaseIndex(r.index)}}_updateObjectCameraDistances(e){const t=e.camera.eye,r=e.camera.viewForward,n=P(),s=a=>{tl(n,a.center,t);const o=_e(n,r),l=a.radius,c=o<-l?1/0:o<l?0:o-l;a.renderables.forEach(u=>u.distanceToCamera=c)};this._perObjectData.forEach(s),this._perObjectDataEvictionCache.forEach(s)}_renderRegularEdges(e,t,r){const n=e.bindRegularEdges(r,t),s=r.transparency,a=t.camera.perScreenPixelRatio;e.forEachRenderable(o=>{if(!YB(o)||!o.visible)return;const l=mS(o.regular.lod.lengths,o.distanceToCamera,a);e.renderRegularEdges(n,o,r,t,l)},s)}_renderSilhouetteEdges(e,t,r){const n=e.bindSilhouetteEdges(r,t),s=r.transparency,a=t.camera.perScreenPixelRatio;e.forEachRenderable(o=>{if(!KB(o)||!o.visible)return;const l=mS(o.silhouette.lod.lengths,o.distanceToCamera,a);e.renderSilhouetteEdges(n,o,r,t,l)},s)}get test(){return{hasRenderedPrimitives:e=>{let t=!1;const r=e.perScreenPixelRatio,n=(s,a)=>s.forEachRenderable(o=>{o.visible&&!t&&(YB(o)&&(t=mS(o.regular.lod.lengths,o.distanceToCamera,r)>0),!t&&KB(o)&&(t=mS(o.silhouette.lod.lengths,o.distanceToCamera,r)>0))},a);return this._renderers.forEach(s=>{t||(n(s,Ct.OPAQUE),n(s,Ct.TRANSPARENT))}),t}}}};function U3e(i){y(i.regular)&&(i.regular.vao.vertexBuffers.instances.dispose(),i.regular.vao.dispose(!1),i.regular.vao=null),y(i.silhouette)&&(i.silhouette.vao.vertexBuffers.instances.dispose(),i.silhouette.vao.dispose(!1),i.silhouette.vao=null)}function z3e(i){let e=null,t=null;for(let r=0;r<i.geometries.length;r++){const n=i.geometryRecords[r];if(n.material.supportsEdges){if(e){if(!cD(e,n.transformation))return!1}else e=n.transformation;if(!t&&y(n.origin))t=n;else if(y(t==null?void 0:t.origin)&&y(n.origin)&&t.origin.id!==n.origin.id)return!1}}return!0}h([p({constructOnly:!0})],lc.prototype,"rctx",void 0),h([p({constructOnly:!0})],lc.prototype,"renderSR",void 0),h([p({constructOnly:!0})],lc.prototype,"viewingMode",void 0),h([p({constructOnly:!0})],lc.prototype,"techniqueRepository",void 0),h([p({constructOnly:!0})],lc.prototype,"setNeedsRender",void 0),h([p({constructOnly:!0})],lc.prototype,"schedule",void 0),h([p({readOnly:!0})],lc.prototype,"_updatingHandles",void 0),h([p({readOnly:!0})],lc.prototype,"updating",null),lc=h([F("esri.views.3d.webgl-engine.lib.edgeRendering.EdgeView")],lc);let QB=class{constructor(e,t,r){this.center=t,this.radius=r,this.renderables=new Array,this.loaded=e,this.loaded.then(()=>{this.loaded!=null&&(this.loaded=!0)})}},B3e=class{constructor(e,t){this.buffer=e,this.meta=t}},ZB=class{constructor(e,t){this.vao=e,this.lod=t}},G3e=class{constructor(e,t){this.modelMatrix=e,this.origin=t}},H3e=class{constructor(e,t,r,n,s,a,o,l){this.regular=e,this.silhouette=t,this.statistics=r,this.transform=n,this.edgeTransparency=s,this.objectTransparency=a,this.components=o,this.rendererKey=l,this.distanceToCamera=0,this.visible=!0}};function YB(i){return y(i.regular)}function KB(i){return y(i.silhouette)}function mS(i,e,t){const r=e*t,n=Pte(i,r,!0);return n===-1?r<i[0]?i.length:0:i.length-n}let JB=class{constructor(e,t,r,n){this.position=e,this.indices=t,this.modelTransform=r,this.origin=n}};const e7=Or();let t7=class{constructor(e,t,r,n,s,a,o,l,c){this.createQuery=e,this.deleteQuery=t,this.resultAvailable=r,this.getResult=n,this.disjoint=s,this.beginTimeElapsed=a,this.endTimeElapsed=o,this.createTimestamp=l,this.timestampBits=c}},Gu=!1;function j3e(i,e){if(e.disjointTimerQuery)return null;let t=i.getExtension("EXT_disjoint_timer_query_webgl2");return t&&Ca(i)?new t7(()=>i.createQuery(),r=>{i.deleteQuery(r),Gu=!1},r=>i.getQueryParameter(r,i.QUERY_RESULT_AVAILABLE),r=>i.getQueryParameter(r,i.QUERY_RESULT),()=>i.getParameter(t.GPU_DISJOINT_EXT),r=>{Gu||(Gu=!0,i.beginQuery(t.TIME_ELAPSED_EXT,r))},()=>{i.endQuery(t.TIME_ELAPSED_EXT),Gu=!1},r=>t.queryCounterEXT(r,t.TIMESTAMP_EXT),()=>i.getQuery(t.TIMESTAMP_EXT,t.QUERY_COUNTER_BITS_EXT)):(t=i.getExtension("EXT_disjoint_timer_query"),t?new t7(()=>t.createQueryEXT(),r=>{t.deleteQueryEXT(r),Gu=!1},r=>t.getQueryObjectEXT(r,t.QUERY_RESULT_AVAILABLE_EXT),r=>t.getQueryObjectEXT(r,t.QUERY_RESULT_EXT),()=>i.getParameter(t.GPU_DISJOINT_EXT),r=>{Gu||(Gu=!0,t.beginQueryEXT(t.TIME_ELAPSED_EXT,r))},()=>{t.endQueryEXT(t.TIME_ELAPSED_EXT),Gu=!1},r=>t.queryCounterEXT(r,t.TIMESTAMP_EXT),()=>t.getQueryEXT(t.TIMESTAMP_EXT,t.QUERY_COUNTER_BITS_EXT)):null)}function q3e(i,e){const t=i.capabilities.disjointTimerQuery;return C(t)?null:new W3e(t,e)}let W3e=class{constructor(e,t){this._timer=e,this._queryPool=new Array,this._queryResults=new Map,this._currentQuery=null,t.forEach(r=>{const n=this._timer.createQuery(),s=this._timer.createQuery();this._queryPool.push(n,s),this._queryResults.set(r,null)})}start(){Gu||(this._currentQuery=this._queryPool.pop(),C(this._currentQuery)||(this._timer.disjoint(),this._timer.beginTimeElapsed(this._currentQuery)))}stop(e){if(this._timer.disjoint()||C(this._currentQuery)||!this._queryResults.has(e))return this.abort(),null;this._timer.endTimeElapsed();const t=this._queryResults.get(e);if(C(t))return this._queryResults.set(e,this._currentQuery),this._currentQuery=null,null;if(!this._timer.resultAvailable(t))return this._queryPool.unshift(this._currentQuery),this._currentQuery=null,null;const r=this._timer.getResult(t)/1e6;return this._queryPool.unshift(t),this._queryResults.set(e,this._currentQuery),this._currentQuery=null,r}abort(){y(this._currentQuery)&&(this._timer.deleteQuery(this._currentQuery),this._queryPool.unshift(this._timer.createQuery()),this._currentQuery=null)}dispose(){y(this._currentQuery)&&this._timer.deleteQuery(this._currentQuery),this._queryPool.forEach(e=>{this._timer.deleteQuery(e)}),this._queryResults.forEach(e=>{C(e)||this._timer.deleteQuery(e)})}};var gi;(function(i){i.OVERLAY="overlay",i.PREPARE="prepare",i.SHADOW_MAP="shadow map",i.LINEAR_DEPTH="linear depth",i.ACCUMULATED_SHADOWS="accumulated shadows",i.NORMALS="normals",i.OBJECT_AND_LAYER_ID_COLOR="object/layer id color",i.SSAO="SSAO",i.OPAQUE="opaque",i.OPAQUE_EDGES="opaque edges",i.VOXEL="voxel",i.TRANSPARENT="transparent",i.TRANSPARENT_EDGES="transparent edges",i.HUD_VISIBILITY="HUD visibility",i.TRANSPARENT_TERRAIN="transparent terrain",i.ENVIRONMENT="environment",i.LASER_LINE="laser line",i.OCCLUDED="occluded",i.ANTIALIASING="antialiasing",i.HIGHLIGHTS="highlights",i.HUD_OCCLUDED="HUD occluded",i.HUD_NOT_OCCLUDED="HUD not occluded",i.FINISH="finish"})(gi||(gi={}));const i7="Total";let X3e=class{constructor(e){this._rctx=e,this._startTimeStampCPU=It(0),this._lastTimeStampCPU=It(0),this._totalCPUTime=new pT(i7),this._cpuTimeSamplers=new Map(Object.values(gi).map(t=>[t,new pT(t)])),this._enableGPUTimer=0,this._totalGPUTime=new pT("GPU"),this._gpuTimeSamplers=new Map(Object.values(gi).map(t=>[t,new pT(t)])),this._totalTime=It(0),this._totalFrameCount=0}get totalCPUTimeSampler(){return this._totalCPUTime}get cpuTimeSamplers(){return Array.from(this._cpuTimeSamplers.values())}get totalGPUTimeSampler(){return this._totalGPUTime}get gpuTimeSamplers(){return Array.from(this._gpuTimeSamplers.values())}get gpuSamplingEnabled(){return y(this._gpuTimerPool)}get totalTime(){return this._totalTime}get totalFrameCount(){return this._totalFrameCount}get elapsedTime(){return It(performance.now()-this._startTimeStampCPU)}enableGPUPerformanceInfo(){if(C(this._gpuTimerPool)){const e=[...Object.values(gi),i7];this._gpuTimerPool=q3e(this._rctx,e)}return C(this._gpuTimerPool)?{hasGPUTimerSupport:!1,remove:()=>{}}:(++this._enableGPUTimer,{hasGPUTimerSupport:!0,remove:mte(()=>{--this._enableGPUTimer,this._enableGPUTimer===0&&(this._gpuTimerPool=ke(this._gpuTimerPool))})})}startFrame(){this._startTimeStampCPU=this._lastTimeStampCPU=It(performance.now()),y(this._gpuTimerPool)&&this._gpuTimerPool.start()}advance(e){const t=It(performance.now());if(this._cpuTimeSamplers.get(e).record(t-this._lastTimeStampCPU),this._lastTimeStampCPU=t,y(this._gpuTimerPool)){const r=this._gpuTimerPool.stop(e);this._gpuTimeSamplers.get(e).record(r),this._gpuTimerPool.start()}}finishFrame(){if(y(this._gpuTimerPool)){const t=this._gpuTimerPool.stop(gi.FINISH);this._gpuTimeSamplers.get(gi.FINISH).record(t)}const e=It(performance.now()-this._startTimeStampCPU);this._totalTime=It(this._totalTime+e),this._totalCPUTime.record(e),y(this._gpuTimerPool)&&this._totalGPUTime.record(this.gpuTimeSamplers.reduce((t,r)=>t+(r.last||0),0)),++this._totalFrameCount}};const r7=.9;let Hu=class extends pe{constructor(e,t,r,n,s,a,o,l,c){super({}),this._materialRepository=e,this._shaderTechniqueRepository=r,this._rctx=n,this._compositingHelper=s,this._magnifierHelper=a,this._requestRender=o,this._stage=c,this._materialRenderers=new Map,this._needsTransparentPass=!1,this._hasHUDElements=!1,this._hasHighlights=!1,this._hasWater=!1,this._hasOverlayWater=!1,this._renderOverlay=u=>{},this._content=new Map,this._isRendering=!1,this._fallbackDepthStencilTexture=null,this._sliceHelper=new n3e,this._antialiasing=!0,this._oitEnabled=!1,this._multipassTerrain=!0,this._terrainRenderingEnabled=!0,this._terrainTransparency=Ts.Opaque,this._waterReflectionEnabled=!1,this._hasAnimations=!1,this._animationTimestep=MB,this._handles=new Vt,this._renderHiddenTransparentEdges=()=>{},this._oitUsed=!1,this._smaaPass=new Sb(this._rctx,r),this._oitEnabled=this._hasOITSupport,this._requestRender(),this._offscreenRendering=new DLe(this._rctx,this._compositingHelper),this.performanceInfo=new X3e(this._rctx),this._shadowMap=new I4(this._rctx,c.viewingMode),this._ssaoHelper=new WG(r,this._rctx,()=>this._requestRender()),this._highlight=new MLe(r,this._rctx),this._shadowHighlight=new r3e(this._rctx,c.viewingMode),this._shadowAccumulator=new _s(this._rctx,r,c,u=>{const d=this.shadowsEnabled;this._shadowMap.enabled=!0,this._prepare(u.camera,u.contentCamera),this._renderPlugins.prepareRender(),this._shadowMap.enabled=d},(u,d,m)=>{u.shadowMap.start(u.camera,d,m),this._renderShadowCascades(V.Shadow,u.shadowMap),u.camera.setGLViewport(this._rctx),this._prepare(u.camera,u.contentCamera)},()=>this._requestRender()),this._renderContext=new KCe(this._rctx,this._offscreenRendering,this._shadowMap,this._ssaoHelper,this._sliceHelper),this._renderPlugins=new kLe({renderContext:this._renderContext,shaderTechniqueRepository:r,textureRep:t,materialRep:this._materialRepository,requestRender:this._requestRender,schedule:l}),this.renderPassManager=new bLe(this._rctx,this._shaderTechniqueRepository),this._renderPlugins.add(this.renderPassManager.slots(),this.renderPassManager),this._handles.add([B(()=>this._stage.state.camera,()=>this._requestRender(),Mi),B(()=>Wt.EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES,u=>{this._renderHiddenTransparentEdges=u?()=>this._renderEdges(Ct.TRANSPARENT):()=>{},this._requestRender()},et)])}get _bindParameters(){return this._renderContext.bindParameters}get hasWater(){return this._hasWater||this._hasOverlayWater}get hasWaterReflection(){return this.hasWater&&this._waterReflectionEnabled}normalizeCtorArgs(){return{}}dispose(){this._handles.destroy(),this._smaaPass.dispose(),this._materialRenderers.forEach(e=>e.dispose()),this._materialRenderers.clear(),this._edgeView=Oe(this._edgeView),this._offscreenRendering.dispose(),this._fallbackDepthStencilTexture=ke(this._fallbackDepthStencilTexture),this._shadowMap.enabled=!1,this._shadowMap.dispose(),this._ssaoHelper.enabled=!1,this._ssaoHelper.dispose(),this._highlight.dispose(),this._shadowHighlight.dispose(),this._shadowAccumulator.dispose(),wse.prune(),this._content.clear()}disposeOffscreenBuffers(){this._offscreenRendering.dispose(),this._shadowMap.dispose(),this._smaaPass.disable(),this._ssaoHelper.disposeOffscreenBuffers()}get updating(){return this._antialiasing&&this._smaaPass.updating||y(this._edgeView)&&this._edgeView.updating||this._shadowAccumulator.running||!this.isCameraFinal}ensureEdgeView(){return C(this._edgeView)&&(this._edgeView=new lc({rctx:this._rctx,renderSR:this._stage.renderSR,viewingMode:this._stage.viewingMode,techniqueRepository:this._shaderTechniqueRepository,setNeedsRender:()=>this._requestRender(),schedule:e=>this._stage.resourceController.schedule(e)}),this._handles.add(B(()=>co(this._edgeView,e=>e.updating),()=>this._requestRender(),ni)),this._requestRender()),this._edgeView}get edgeView(){return this._edgeView}get isCameraFinal(){return Jre(this._bindParameters.ssr.reprojectionMatrix,rn)}set _reprojectionMatrix(e){Ate(this._bindParameters.ssr.reprojectionMatrix,e)&&this.notifyChange("isCameraFinal")}get shadowsEnabled(){var e;return!!((e=this._shadowMap)!=null&&e.enabled)}setRenderParameters(e){const{_shadowMap:t,_ssaoHelper:r,_bindParameters:n}=this;if(e.screenSpaceReflectionsEnabled!==void 0&&n.ssr.enabled!==e.screenSpaceReflectionsEnabled&&(n.ssr.enabled=e.screenSpaceReflectionsEnabled,this._requestRender()),e.shadowMap!==void 0&&t.enabled!==e.shadowMap&&(t.enabled=e.shadowMap,this._requestRender()),e.shadowMapMaxCascades!==void 0&&t.maxCascades!==e.shadowMapMaxCascades&&(t.maxCascades=e.shadowMapMaxCascades,this._requestRender()),y(e.environment)){y(e.environment.weather)&&(this._bindParameters.weather=e.environment.weather,this._bindParameters.weatherVisible=e.weatherVisible),e.environment.lighting.ambientOcclusionEnabled!==void 0&&r.enabled!==e.environment.lighting.ambientOcclusionEnabled&&(r.enabled=e.environment.lighting.ambientOcclusionEnabled,this._requestRender()),e.environment.lighting.waterReflectionEnabled!==void 0&&this._waterReflectionEnabled!==e.environment.lighting.waterReflectionEnabled&&(this._waterReflectionEnabled=e.environment.lighting.waterReflectionEnabled,this._requestRender());const s=e.environment.lighting.type!=="virtual";n.enableFillLights!==s&&(n.enableFillLights=s,this._requestRender())}e.background&&this._offscreenRendering.background!==e.background&&(this._offscreenRendering.background=e.background,this._requestRender()),e.antialiasingEnabled!==void 0&&this._antialiasing!==e.antialiasingEnabled&&(this._antialiasing=e.antialiasingEnabled,this._requestRender()),e.highQualityTransparency!==void 0&&this._multipassTerrain!==e.highQualityTransparency&&(this._multipassTerrain=e.highQualityTransparency,this._oitEnabled=e.highQualityTransparency&&this._hasOITSupport,this._requestRender()),e.defaultHighlightOptions!==void 0&&(this._highlight.setDefaultOptions(e.defaultHighlightOptions),this._shadowHighlight.setDefaultOptions(e.defaultHighlightOptions),this._requestRender()),e.overlays!==void 0&&this._bindParameters.overlays!==e.overlays&&(this._bindParameters.overlays=e.overlays,this._requestRender()),e.hasOverlayWater!==void 0&&this._hasOverlayWater!==e.hasOverlayWater&&(this._hasOverlayWater=e.hasOverlayWater,this._requestRender()),e.renderOverlay!==void 0&&this._renderOverlay!==e.renderOverlay&&(this._renderOverlay=e.renderOverlay,this._requestRender()),e.slicePlane!==void 0&&this._sliceHelper.plane!==e.slicePlane&&(this._sliceHelper.plane=ft(e.slicePlane),this._requestRender()),e.terrainRenderingEnabled!==void 0&&this._terrainRenderingEnabled!==e.terrainRenderingEnabled&&(this._terrainRenderingEnabled=e.terrainRenderingEnabled,this._requestRender()),e.terrainTransparency!==void 0&&this._terrainTransparency!==e.terrainTransparency&&(this._terrainTransparency=e.terrainTransparency,this._requestRender()),e.shadowCastOptions!==void 0&&this._shadowAccumulator.setOptions(e.shadowCastOptions)}get hasSlicePlane(){return!!this._sliceHelper.plane}get renderPlugins(){return this._renderPlugins}get _hasOITSupport(){return this._rctx.driverTest.floatBufferBlendWorking}modify(e){this._isRendering&&console.warn("Renderer.modify called while rendering");const{adds:t,removes:r,updates:n}=e;if(t.length===0&&r.length===0&&n.length===0)return;r.forAll(({id:o})=>this._content.delete(o)),t.forAll(o=>this._content.set(o.id,o));const s=mK(e);let a=!1;s.forEach((o,l)=>{let c=this._materialRenderers.get(l);if(!c){if(!(o.adds.length>0))return;c=new wK(this._rctx,this._materialRepository,l),this._materialRenderers.set(l,c)}c.modify(o),c.isEmpty&&(a=!0)}),a&&this._materialRenderers.forEach((o,l)=>{o.isEmpty&&(this._materialRenderers.delete(l),o.dispose())}),this._hasHighlights=Er(this._materialRenderers,o=>o.hasHighlights),this._bindParameters.hasOccludees=Er(this._materialRenderers,o=>o.hasOccludees),this._hasWater=Er(this._materialRenderers,o=>o.hasWater),this._hasHUDElements=Er(this._materialRenderers,o=>o.requiresSlot(le.LINE_CALLOUTS_HUD_DEPTH,V.Color)||o.requiresSlot(le.HUD_MATERIAL,V.Color)||o.requiresSlot(le.LABEL_MATERIAL,V.Color)),this._requestRender()}updateAnimation(e){return this._hasAnimations=!1,this._materialRenderers.forEach(t=>this._hasAnimations=t.updateAnimation(e)||this._hasAnimations),this._hasAnimations=this._renderPlugins.updateAnimation(e)||this._hasAnimations,this._hasAnimations}get animationTimestep(){return this._animationTimestep}render(e,t,r,n,s){this._isRendering=!0;const{camera:a,contentCamera:o}=r;this._renderContext.time=s,this.performanceInfo.startFrame(),this._renderOverlay(s),this.performanceInfo.advance(gi.OVERLAY),this._bindParameters.transparencyPassType=qt.NONE;const l=this._offscreenRendering;l.setupRenderTarget(this.hasWaterReflection);const c=zd(this._sliceHelper.plane);n===Mw.OFF&&(this._sliceHelper.plane=null),this._rctx.bindFramebuffer(e),a.setGLViewport(this._rctx),this._prepare(a,o),this._renderPlugins.prepareRender(),this.performanceInfo.advance(gi.PREPARE);const u=this._computeDepthRange(a);this._renderShadowMap(e,a,this._bindParameters.lighting.mainLight.direction,u),this.performanceInfo.advance(gi.SHADOW_MAP),l.initializeFrame(a),this._ensureBindParameters(a,o),this._renderLinearDepth(),this.performanceInfo.advance(gi.LINEAR_DEPTH),this._accumulateShadows(u,a,o),this.performanceInfo.advance(gi.ACCUMULATED_SHADOWS),this._renderNormal(),this.performanceInfo.advance(gi.NORMALS),this._ensureBindParametersSSR(),this._renderSSAO(),this.performanceInfo.advance(gi.SSAO),this._renderContext.output=V.Color,l.bindFramebuffer(),this._renderOpaqueGeometry(),this.performanceInfo.advance(gi.OPAQUE);const d=this._terrainRenderingEnabled&&this._terrainTransparency!==Ts.Opaque,m=this._multipassTerrain&&d;this._renderTerrainLinearDepth(m),this._setMultipassEnabled(m),this._setTerrainCulling(m),this._renderEdges(Ct.OPAQUE),this.performanceInfo.advance(gi.OPAQUE_EDGES),this._offscreenRendering.bindTarget(this._offscreenRendering.currentColorTarget,this._offscreenRendering.mainDepth),this._renderSlot(le.VOXEL),this.performanceInfo.advance(gi.VOXEL),this._renderHiddenTransparentEdges();const f=this._needsTransparentPass||this._renderPlugins.needsTransparentPass;f&&(this._oitEnabled?this._renderOrderIndependentTransparency(()=>this._renderTransparentGeometry(),!1):this._renderTransparentGeometry()),this.performanceInfo.advance(gi.TRANSPARENT),this._renderGeometryLinearDepth(m);const _=this._renderHUDVisibility(this._multipassTerrain&&d);m||this._renderInternalSlot(le.LINE_CALLOUTS),this.performanceInfo.advance(gi.HUD_VISIBILITY),this._renderObjectAndLayerIdColor(t),this.performanceInfo.advance(gi.OBJECT_AND_LAYER_ID_COLOR),this._renderEdges(Ct.TRANSPARENT,m),this.performanceInfo.advance(gi.TRANSPARENT_EDGES),this._renderTransparentTerrain(),d&&_&&(m?this._renderLineCallouts(mu.Occluded):l.compositeTransparentTerrainOntoHUDVisibility(this._bindParameters),this._renderHUD(mu.Occluded,l.framebuffer),this.performanceInfo.advance(gi.HUD_OCCLUDED)),this.performanceInfo.advance(gi.TRANSPARENT_TERRAIN),this._setTerrainCulling(!1),d&&(l.compositeTransparentTerrainOntoMain(this._bindParameters),m&&(this._renderEdges(Ct.OPAQUE),this.performanceInfo.advance(gi.OPAQUE_EDGES),f&&(this._oitEnabled?this._renderOrderIndependentTransparency(()=>this._renderTransparentGeometry(),!1):this._renderTransparentGeometry()),this.performanceInfo.advance(gi.TRANSPARENT),this._renderEdges(Ct.TRANSPARENT),this.performanceInfo.advance(gi.TRANSPARENT_EDGES))),m&&this._renderLineCallouts(mu.NotOccluded),this._setMultipassEnabled(!1),this._shadowAccumulator.render(this._bindParameters),l.renderToTargets(()=>{this._renderInternalSlot(le.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL),this._renderSlot(le.POSTPROCESSING_ENVIRONMENT_TRANSPARENT),this._renderSlot(le.LASERLINES)},l.currentColorTarget,l.mainDepth),this.performanceInfo.advance(gi.ENVIRONMENT),this._renderPlugins.needsLaserlineWithContrastControl&&l.renderTmpAndCompositeToMain(()=>this._renderSlot(le.LASERLINES_CONTRAST_CONTROL),this._bindParameters,Es.PremultipliedAlpha),this.performanceInfo.advance(gi.LASER_LINE),this._renderOccluded(),this.performanceInfo.advance(gi.OCCLUDED);const g=n===Mw.ON&&this._magnifierHelper.enabled,w=g&&C(e)?this._offscreenRendering.getFramebuffer(this._offscreenRendering.tmpColor,this._offscreenRendering.tmpDepth):e;this._rctx.bindFramebuffer(w);const v=this._offscreenRendering.colorTexture;!this._renderAntiAliasing(v)&&y(v)&&this._compositingHelper.composite(this._bindParameters,v,Es.None),this.performanceInfo.advance(gi.ANTIALIASING),this._renderHUD(mu.NotOccluded,w),this.performanceInfo.advance(gi.HUD_NOT_OCCLUDED),this._renderHighlights(w,this._bindParameters),this.performanceInfo.advance(gi.HIGHLIGHTS),g&&this._magnifierHelper.render(this._rctx,this._bindParameters),w!==e&&(this._rctx.bindFramebuffer(e),this._compositingHelper.composite(this._bindParameters,this._offscreenRendering.tmpColorTexture,Es.None)),this._disposeOITBuffers(),this._renderContext.lastFrameCamera.copyFrom(this._bindParameters.camera),this._sliceHelper.plane=c,this._isRendering=!1,this.onPostRender&&this.onPostRender(),this.performanceInfo.finishFrame()}_renderObjectAndLayerIdColor(e){y(e)&&Ot("enable-feature:objectAndLayerId-rendering")&&(this._rctx.bindFramebuffer(e),this._offscreenRendering.renderToFBO(()=>this._renderGeometryAndTransparentTerrainPass(V.ObjectAndLayerIdColor),[0,0,0,0],!0,!0),this._rctx.bindFramebuffer(e),this._offscreenRendering.renderToFBO(()=>{this._bindParameters.renderTransparentlyOccludedHUD=mu.NotOccluded,this._renderInternalSlot(le.HUD_MATERIAL)},null,!0,!0))}finish(e){if(this._hasAnimations||(this._animationTimestep=It(0)),e===vr.BACKGROUND){let t=0;this.performanceInfo.gpuSamplingEnabled?t=this.performanceInfo.totalGPUTimeSampler.last:this._rctx.gl.getError();const r=this.performanceInfo.elapsedTime,n=Math.max(r,t),s=ue(n/_Le,vLe,MB);this._animationTimestep=It(this._animationTimestep*r7+s*(1-r7))}}readDepthPixels(e,t,r){const n=this._offscreenRendering.bindTarget(this._offscreenRendering.linearDepth,this._offscreenRendering.tmpDepth);if(!this._needsLinearDepth){this._ensureBindParameters(e,e),this._bindParameters.camera.setGLViewport(this._rctx),this._rctx.setClearColor(0,0,0,0);const s=Oi.COLOR_BUFFER_BIT|Oi.DEPTH_BUFFER_BIT|Oi.STENCIL_BUFFER_BIT;this._rctx.clearSafe(s),this._renderGeometryAndTransparentTerrainPass(V.Depth)}n.readPixels(t[0],t[1],t[2],t[3],St.RGBA,Xt.UNSIGNED_BYTE,r)}readHUDVisibility(e,t,r,n,s){this._offscreenRendering.bindTarget(this._offscreenRendering.hudVisibility).readPixels(e,t,r,n,St.RGBA,Xt.UNSIGNED_BYTE,s)}readAccumulatedShadow(e,t){return this._shadowAccumulator.readAccumulatedShadow(e,t)}_setMultipassEnabled(e){this._bindParameters.multipassTerrain.enabled=this._bindParameters.multipassGeometry.enabled=e}_setTerrainCulling(e){this._bindParameters.multipassTerrain.cullAboveGround=e}_renderSlot(e){this._bindParameters.slot=e,this._renderPlugins.render()}_renderEdges(e,t=!1){const r=this._edgeView;y(r)&&r.shouldRender()&&this._offscreenRendering.renderTmpAndCompositeToMain(()=>r.render(this._bindParameters,e),this._bindParameters,Es.Alpha,t)}_renderShadowMap(e,t,r,n){const s=this._shadowMap;s.enabled&&(s.start(t,r,n),this._shadowHighlight.updateParameters(t,r),this._needsShadowHighlight?(this._renderShadowCascades(V.ShadowHighlight,this._shadowMap,a=>s.takeCascadeSnapshotTo(a,dv.Highlight)),s.clear(),this._renderShadowCascades(V.ShadowExludeHighlight,this._shadowMap,a=>{s.takeCascadeSnapshotTo(a,dv.Default),this._renderGeometryAndTransparentTerrainPass(V.ShadowHighlight)})):this._renderShadowCascades(V.Shadow),s.finish(e),t.setGLViewport(this._rctx))}_renderShadowCascades(e,t=this._shadowMap,r=n=>{}){for(const n of t.getCascades())n.camera.setGLViewport(this._rctx),this._prepare(n.camera,n.camera),this._renderGeometryAndTransparentTerrainPass(e),r(n)}get _needsLinearDepth(){return this._ssaoHelper.ready||this._renderPlugins.needsLinearDepth||this._hasWater&&this._waterReflectionEnabled||this._needsShadowHighlight||this._needsShadowCast}_renderLinearDepth(){this._needsLinearDepth?this._offscreenRendering.renderToTargets(()=>this._renderGeometryAndTransparentTerrainPass(V.Depth),this._offscreenRendering.linearDepth,this._offscreenRendering.tmpDepth,[0,0,0,0],!0,!0):this._offscreenRendering.disposeTarget(this._offscreenRendering.linearDepth),this._bindParameters.linearDepthTexture=this._offscreenRendering.linearDepthTexture}_renderTerrainLinearDepth(e){if(e){const t=this._renderContext.output;this._renderContext.output=V.Depth,this._offscreenRendering.renderToTargets(()=>this._renderTransparentTerrain(),this._offscreenRendering.terrainLinearDepth,this._offscreenRendering.tmpDepth,[-1e10,-1e10,-1e10,1],!0,!0),this._renderContext.output=t}else this._offscreenRendering.disposeTarget(this._offscreenRendering.terrainLinearDepth);this._bindParameters.multipassTerrain.linearDepthTexture=this._offscreenRendering.terrainLinearDepthTexture}_renderGeometryLinearDepth(e){if(e){const t=this._renderContext.output;this._offscreenRendering.renderToTargets(()=>this._renderGeometryPass(V.Depth),this._offscreenRendering.geometryLinearDepth,this._offscreenRendering.tmpDepth,[1,1,1,1],!0,!0),this._renderContext.output=t}else this._offscreenRendering.disposeTarget(this._offscreenRendering.geometryLinearDepth);this._bindParameters.multipassGeometry.linearDepthTexture=this._offscreenRendering.geometryLinearDepthTexture}get _needsNormal(){return this._ssaoHelper.ready}_renderNormal(){this._needsNormal?this._offscreenRendering.renderToTargets(()=>{this._renderGeometryAndTransparentTerrainPass(V.Normal)},this._offscreenRendering.normal,this._offscreenRendering.tmpDepth,[0,0,0,0],!0,!0):this._offscreenRendering.disposeTarget(this._offscreenRendering.normal)}get _needsDepthRange(){return this._shadowMap.enabled||this._needsShadowCast}_computeDepthRange(e){if(!this._needsDepthRange)return k$;const t=eLe(e,this._content,this._stage.layers);return fv(t,this.renderPlugins.queryDepthRange(e)),t.near=Math.max(e.near,t.near),t.far=Math.min(e.far,t.far),t}_renderGeometryAndTransparentTerrainPass(e){this._renderContext.output=e,this._renderGeometryPass(e),this._renderTransparentTerrain()}_renderGeometryPass(e){this._renderContext.output=e,this._renderOpaqueGeometry(),this._renderTransparentGeometry()}_renderSSAO(){this._ssaoHelper.loading?this._requestRender():this._ssaoHelper.computeSSAO(this._bindParameters,this._offscreenRendering.linearDepthTexture,this._offscreenRendering.normalTexture)}_renderOpaqueGeometry(){this._renderSlot(le.INTEGRATED_MESH),this._renderSlot(le.OPAQUE_TERRAIN),this._renderInternalSlot(le.OPAQUE_MATERIAL),this._renderSlot(le.OPAQUE_MATERIAL),this._renderSlot(le.POSTPROCESSING_ENVIRONMENT_OPAQUE)}_renderTransparentGeometry(){this._renderInternalSlot(le.TRANSPARENT_MATERIAL),this._renderSlot(le.TRANSPARENT_MATERIAL)}_renderTransparentTerrain(){this._renderSlot(le.TRANSPARENT_TERRAIN)}_renderHUDVisibility(e){let t=!1;return this._renderContext.offscreenRenderingHelper&&this._renderContext.offscreenRenderingHelper.renderHUDVisibility(()=>{this._bindParameters.hudVisibilityTexture=this._renderContext.offscreenRenderingHelper.hudVisibilityTexture,t=this._renderInternalSlot(le.OCCLUSION_PIXELS)},e),t}_renderLineCallouts(e){this._bindParameters.renderTransparentlyOccludedHUD=e,e===mu.Occluded?this._offscreenRendering.renderToTargets(()=>this._renderInternalSlot(le.LINE_CALLOUTS),this._offscreenRendering.currentColorTarget,this._offscreenRendering.tmpDepth,void 0,!0,!0):this._renderInternalSlot(le.LINE_CALLOUTS)}_renderHUD(e,t){this._hasHUDElements&&(this._oitEnabled?(this._renderOrderIndependentTransparency(()=>this._renderHUDElements(e),!0),this._rctx.bindFramebuffer(t),this._compositingHelper.composite(this._bindParameters,this._offscreenRendering.hudColorTexture,Es.PremultipliedAlpha)):e===mu.Occluded?this._offscreenRendering.renderToTargets(()=>this._renderHUDElements(mu.Occluded),this._offscreenRendering.currentColorTarget,this._offscreenRendering.tmpDepth,void 0,!0,!0):this._renderHUDElements(e))}_renderHUDElements(e){this._bindParameters.renderTransparentlyOccludedHUD=e,this._renderInternalSlot(le.LINE_CALLOUTS_HUD_DEPTH),this._renderInternalSlot(le.HUD_MATERIAL),this._renderInternalSlot(le.LABEL_MATERIAL)}get _needsHighlight(){return this._hasHighlights||this._renderPlugins.needsHighlight}get _needsShadowHighlight(){return this._shadowMap.enabled&&this._shadowHighlight.isVisible&&this._needsHighlight}_renderHighlights(e,t){if(!this._needsHighlight)return void this._offscreenRendering.disposeTarget(this._offscreenRendering.highlight);const r=this._highlight,n=this._offscreenRendering.renderToTargets(()=>{this._renderGeometryAndTransparentTerrainPass(V.Highlight),this._rctx.clearSafe(Oi.DEPTH_BUFFER_BIT),this._renderHUDElements(mu.Both)},this._offscreenRendering.highlight,this._offscreenRendering.tmpDepth,[0,0,0,0],!0,!0);this._bindParameters.highlightColorTexture=n.colorTexture,this._needsShadowHighlight&&this._shadowHighlight.render(t,e),r.render(this._bindParameters,n,e)}get _needsShadowCast(){return this._shadowAccumulator.isAccumulating}_accumulateShadows(e,t,r){this._needsShadowCast&&this._shadowAccumulator.renderAccumulation(this._offscreenRendering.linearDepthTexture,e,t,r)}_renderOrderIndependentTransparency(e,t){const r=s=>{this._bindParameters.transparencyPassType=s,this._offscreenRendering.renderOITPass(()=>e(),s,t)},n=this._renderContext.output;this._renderContext.output=V.Alpha,r(qt.Alpha),this._renderContext.output=V.Color,r(qt.Color),r(qt.FrontFace),this._offscreenRendering.compositeTransparentOntoOpaque(this._bindParameters,t),this._bindParameters.transparencyPassType=qt.NONE,this._renderContext.output=n,this._oitUsed=!0}_disposeOITBuffers(){this._oitUsed||(this._offscreenRendering.disposeTarget(this._offscreenRendering.alphaFloatTarget),this._offscreenRendering.disposeTarget(this._offscreenRendering.colorFloatTarget),this._offscreenRendering.disposeTarget(this._offscreenRendering.frontFaceTarget)),this._oitUsed=!1}_renderOccluded(){let e=0;this._materialRenderers.forEach((a,o)=>{o&&o.isVisible()&&o.renderOccluded===cr.OccludeAndTransparentStencil&&(e|=o.renderOccluded,$1.push(o))});const t=this._offscreenRendering,r=(a,o,l,c,u)=>{e&o&&(t.renderToTargets(l,t.tmpColor,t.mainDepth,[0,0,0,0],c,u),t.compositeOccludedOntoMain(this._bindParameters,a))};$1.length!==0&&(this._renderInternalSlot(le.OCCLUDER_MATERIAL,$1),r(.5,cr.OccludeAndTransparentStencil,()=>this._renderInternalSlot(le.TRANSPARENT_OCCLUDER_MATERIAL,$1),!1,!1),$1.length=0),this._materialRenderers.forEach((a,o)=>{o&&o.isVisible()&&(o.renderOccluded===cr.OccludeAndTransparent||o.renderOccluded===cr.Transparent||o.renderOccluded===cr.Opaque)&&(e|=o.renderOccluded,L1.push(o))});const n=this._renderPlugins.renderOccludedFlags;if(e|=n,!e)return;const s=a=>{this._renderContext.renderOccludedMask=a,n>cr.Occlude&&this._renderSlot(le.OCCLUDED_TERRAIN),this._renderInternalSlot(le.OPAQUE_MATERIAL,L1),this._renderInternalSlot(le.TRANSPARENT_MATERIAL,L1),this._renderInternalSlot(le.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL,L1),this._renderContext.resetRenderOccludedMask()};this._renderContext.output=V.Color,r(.5,cr.OccludeAndTransparent,()=>s(cr.OccludeAndTransparent),!0,kb.OutlineVisualElementMask),r(.5,cr.Transparent,()=>s(cr.Transparent),!0,kb.OutlineVisualElementMask),r(1,cr.Opaque,()=>s(cr.Opaque),!0,kb.OutlineVisualElementMask),L1.length=0}_renderAntiAliasing(e){if(this._antialiasing){if(this._smaaPass.enable(()=>this._requestRender())&&y(e))return this._smaaPass.render(e),!0}else this._smaaPass.disable();return!1}_prepare(e,t){this._needsTransparentPass=Er(this._materialRenderers,r=>r.requiresSlot(le.TRANSPARENT_MATERIAL,V.Color)),this._bindParameters.camera=e,this._bindParameters.contentCamera=t}_ensureBindParameters(e,t){this._bindParameters.camera=e,this._bindParameters.contentCamera=t;const r=this._renderContext.offscreenRenderingHelper;this._bindParameters.hudVisibilityTexture=r.hudVisibilityTexture,this._bindParameters.mainColorTexture=r.mainColorTexture,this._bindParameters.highlightDepthTexture=r.depthTexture??this._getFallbackDepthTexture()}_ensureBindParametersSSR(){this.hasWaterReflection?(this._renderContext.lastFrameCamera.equals(this._bindParameters.camera)?this._reprojectionMatrix=rn:(kn(s7,this._bindParameters.camera.viewMatrix),kn(n7,this._bindParameters.camera.projectionMatrix),Hr(uy,s7,n7),Hr(uy,this._renderContext.lastFrameCamera.viewMatrix,uy),Hr(uy,this._renderContext.lastFrameCamera.projectionMatrix,uy),this._reprojectionMatrix=uy),this._bindParameters.ssr.lastFrameColorTexture=this._offscreenRendering.lastFrameColorTexture):this._bindParameters.ssr.lastFrameColorTexture=null,this._bindParameters.ssr.enabled=this.hasWaterReflection}_renderInternalSlot(e,t){let r=!1;return this._bindParameters.slot=e,y(t)?t.forEach(n=>{if(!n.shouldRender(this._renderContext))return;const s=this._materialRenderers.get(n);y(s)&&(r=s.render(this._renderContext.output,this._bindParameters)||r)}):this._materialRenderers.forEach((n,s)=>{s.shouldRender(this._renderContext)&&n.render(this._renderContext.output,this._bindParameters)&&(r=!0)}),r}_getFallbackDepthTexture(){return this._fallbackDepthStencilTexture||(this._fallbackDepthStencilTexture=KG(this._rctx)),this._fallbackDepthStencilTexture}get gpuMemoryUsage(){var e,t,r,n,s;return{offscreen:((e=this._offscreenRendering)==null?void 0:e.gpuMemoryUsage)??0,highlights:(((t=this._highlight)==null?void 0:t.gpuMemoryUsage)??0)+(((r=this._shadowHighlight)==null?void 0:r.gpuMemoryUsage)??0),shadows:((n=this._shadowMap)==null?void 0:n.gpuMemoryUsage)??0,ssao:((s=this._ssaoHelper)==null?void 0:s.gpuMemoryUsage)??0}}get test(){const e=this;return{offscreen:this._offscreenRendering,shadowMap:this._shadowMap,ssao:this._ssaoHelper,highlight:this._highlight,lighting:this._bindParameters.lighting,materialRenderers:this._materialRenderers,shadowAccumulator:this._shadowAccumulator,weatherIsFading:this._bindParameters.cloudsFade.isFading,getFramebufferTexture:t=>{switch(t){case Wp.Color:return e._offscreenRendering.colorTexture;case Wp.LinearDepth:return e._offscreenRendering.linearDepthTexture;case Wp.Normals:return e._offscreenRendering.normalTexture;case Wp.ShadowMap:return e._shadowMap.depthTexture;case Wp.HudVisibility:return e._offscreenRendering.hudVisibilityTexture;case Wp.Highlight:return e._offscreenRendering.highlightTexture}}}}};var Wp;h([p()],Hu.prototype,"_shadowAccumulator",void 0),h([p()],Hu.prototype,"_smaaPass",void 0),h([p()],Hu.prototype,"_antialiasing",void 0),h([p()],Hu.prototype,"_edgeView",void 0),h([p()],Hu.prototype,"updating",null),h([p()],Hu.prototype,"isCameraFinal",null),Hu=h([F("esri.views.3d.webgl-engine.lib.Renderer")],Hu),function(i){i[i.Color=0]="Color",i[i.LinearDepth=1]="LinearDepth",i[i.Normals=2]="Normals",i[i.ShadowMap=3]="ShadowMap",i[i.HudVisibility=4]="HudVisibility",i[i.Highlight=5]="Highlight"}(Wp||(Wp={}));const L1=[],$1=[],n7=xe(),s7=xe(),uy=xe();let a7=class{constructor(){this.blend=!1,this.blendColor={r:0,g:0,b:0,a:0},this.blendFunction={srcRGB:me.ONE,dstRGB:me.ZERO,srcAlpha:me.ONE,dstAlpha:me.ZERO},this.blendEquation={mode:Pw.ADD,modeAlpha:Pw.ADD},this.colorMask={r:!0,g:!0,b:!0,a:!0},this.faceCulling=!1,this.cullFace=ig.BACK,this.frontFace=rH.CCW,this.scissorTest=!1,this.scissorRect={x:0,y:0,width:0,height:0},this.depthTest=!1,this.depthFunction=hs.LESS,this.clearDepth=1,this.depthWrite=!0,this.depthRange={zNear:0,zFar:1},this.viewport=null,this.stencilTest=!1,this.polygonOffsetFill=!1,this.polygonOffset=[0,0],this.stencilFunction={face:ig.FRONT_AND_BACK,func:hs.ALWAYS,ref:0,mask:1},this.clearStencil=0,this.stencilWriteMask=1,this.stencilOperation={face:ig.FRONT_AND_BACK,fail:S0.KEEP,zFail:S0.KEEP,zPass:S0.KEEP},this.clearColor={r:0,g:0,b:0,a:0},this.program=null,this.vertexBuffer=null,this.indexBuffer=null,this.uniformBuffer=null,this.pixelPackBuffer=null,this.pixelUnpackBuffer=null,this.copyReadBuffer=null,this.copyWriteBuffer=null,this.uniformBufferBindingPoints=new Array,this.readFramebuffer=null,this.drawFramebuffer=null,this.renderbuffer=null,this.activeTexture=0,this.textureUnitMap=new Array,this.vertexArrayObject=null}},Q3e=class{constructor(e){this._allocations=new Map,e?Error.stackTraceLimit=1/0:(this.add=()=>{},this.remove=()=>{})}add(e){this._allocations.set(e,new Error().stack)}remove(e){this._allocations.delete(e)}print(){if(this._allocations.size>0){console.log(`${this._allocations.size} live object allocations:`);const e=new Map;this._allocations.forEach(t=>{e.set(t,(e.get(t)??0)+1)}),e.forEach((t,r)=>{const n=r.split(`
`);n.shift(),n.shift(),console.log(`${t}: ${n.shift()}`),n.forEach(s=>console.log("   ",s))})}}};const Z3e={RECORD_ALLOCATIONS:!1};let Y3e=class{constructor(){for(this._current=new Array,this._max=new Array,this._allocations=new Q3e(Z3e.RECORD_ALLOCATIONS);this._current.length<Nb.COUNT;)this._current.push(0),this._max.push(0)}resetMax(){for(this._max.length=0;this._max.length<this._current.length;)this._max.push(0)}increment(e,t){const r=++this._current[e];this._max[e]=Math.max(r,this._max[e]),this._allocations.add(t)}decrement(e,t){--this._current[e],this._allocations.remove(t)}get max(){return this._max}get current(){return this._current}get total(){return this.current.reduce((e,t)=>e+t,0)}printResourceCount(){if(this.total>0){console.log("Live objects:");for(let e=0;e<Nb.COUNT;++e){const t=this._current[e];t>0&&console.log(`${Nb[e]}: ${t}`)}}this._allocations.print()}},K3e=class{constructor(e){this._rctx=e,this._store=new O4}dispose(){this._store.forEach(e=>e.forEach(t=>t.dispose())),this._store.clear()}acquire(e,t,r,n){const s=this._store.get(e,t);if(y(s))return s.ref(),s;const a=new eoe(this._rctx,e,t,r,n);return a.ref(),this._store.set(e,t,a),a}get test(){let e=0;return this._store.forEach(t=>t.forEach(r=>e+=r.hasGLName?2:1)),{cachedWebGLObjects:e}}};function o7(i,e){i.resetState();const t=new yn(i,{colorTarget:Vn.TEXTURE,depthStencilTarget:rs.NONE},{target:bi.TEXTURE_2D,wrapMode:ai.CLAMP_TO_EDGE,pixelFormat:St.RGBA,dataType:Xt.UNSIGNED_BYTE,samplingMode:Jt.NEAREST,width:1,height:1}),r=ui.createVertex(i,mi.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),n=new Gc(i,new Map([["position",0]]),{geometry:[new aF("position",2,dm.UNSIGNED_SHORT,0,4)]},{geometry:r}),s=Ze(5633261287538229e-9,2626832878767164e-9,1.4349880495278358e6),a=Ze(563327146742708e-8,2.6268736381334523e6,1434963231608387e-9),o=J3e(i,s,a,e);i.bindFramebuffer(t),i.setViewport(0,0,1,1),i.bindVAO(n),i.drawArrays(kt.TRIANGLE_STRIP,0,4);const l=new Uint8Array(4);t.readPixels(0,0,1,1,St.RGBA,Xt.UNSIGNED_BYTE,l),o.dispose(),n.dispose(!1),r.dispose(),t.dispose();const c=(s[2]-a[2])/25,u=DH(l);return Math.abs(c-u)}function J3e(i,e,t,r){const n=`

  precision highp float;

  attribute vec2 position;

  uniform vec3 u_highA;
  uniform vec3 u_lowA;
  uniform vec3 u_highB;
  uniform vec3 u_lowB;

  varying vec4 v_color;

  ${r?"#define DOUBLE_PRECISION_REQUIRES_OBFUSCATION":""}

  #ifdef DOUBLE_PRECISION_REQUIRES_OBFUSCATION

  vec3 dpPlusFrc(vec3 a, vec3 b) {
    return mix(a, a + b, vec3(notEqual(b, vec3(0))));
  }

  vec3 dpMinusFrc(vec3 a, vec3 b) {
    return mix(vec3(0), a - b, vec3(notEqual(a, b)));
  }

  vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {
    vec3 t1 = dpPlusFrc(hiA, hiB);
    vec3 e = dpMinusFrc(t1, hiA);
    vec3 t2 = dpMinusFrc(hiB, e) + dpMinusFrc(hiA, dpMinusFrc(t1, e)) + loA + loB;
    return t1 + t2;
  }

  #else

  vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {
    vec3 t1 = hiA + hiB;
    vec3 e = t1 - hiA;
    vec3 t2 = ((hiB - e) + (hiA - (t1 - e))) + loA + loB;
    return t1 + t2;
  }

  #endif

  const float MAX_RGBA_FLOAT =
    255.0 / 256.0 +
    255.0 / 256.0 / 256.0 +
    255.0 / 256.0 / 256.0 / 256.0 +
    255.0 / 256.0 / 256.0 / 256.0 / 256.0;

  const vec4 FIXED_POINT_FACTORS = vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);

  vec4 float2rgba(const float value) {
    // Make sure value is in the domain we can represent
    float valueInValidDomain = clamp(value, 0.0, MAX_RGBA_FLOAT);

    // Decompose value in 32bit fixed point parts represented as
    // uint8 rgba components. Decomposition uses the fractional part after multiplying
    // by a power of 256 (this removes the bits that are represented in the previous
    // component) and then converts the fractional part to 8bits.
    vec4 fixedPointU8 = floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);

    // Convert uint8 values (from 0 to 255) to floating point representation for
    // the shader
    const float toU8AsFloat = 1.0 / 255.0;

    return fixedPointU8 * toU8AsFloat;
  }

  void main() {
    vec3 val = dpAdd(u_highA, u_lowA, -u_highB, -u_lowB);

    v_color = float2rgba(val.z / 25.0);

    gl_Position = vec4(position * 2.0 - 1.0, 0.0, 1.0);
  }
  `,s=`
  precision highp float;

  varying vec4 v_color;

  void main() {
    gl_FragColor = v_color;
  }
  `,a=i.programCache.acquire(n,s,new Map([["position",0]])),o=new Float32Array(6);Q5(e,o,3);const l=new Float32Array(6);return Q5(t,l,3),i.useProgram(a),a.setUniform3f("u_highA",o[0],o[2],o[4]),a.setUniform3f("u_lowA",o[1],o[3],o[5]),a.setUniform3f("u_highB",l[0],l[2],l[4]),a.setUniform3f("u_lowB",l[1],l[3],l[5]),a}var l7,c7,h7,Kee={exports:{}};function e$e(i){var _,g,w,v,b;if(!i.gl)return!1;if(i.type===Nn.WEBGL1)return!(!((_=i.capabilities.textureFloat)!=null&&_.textureFloat)||!((g=i.capabilities.colorBufferFloat)!=null&&g.textureFloat));if(!((w=i.capabilities.textureFloat)!=null&&w.textureFloat&&((v=i.capabilities.colorBufferFloat)!=null&&v.textureFloat)&&((b=i.capabilities.colorBufferFloat)!=null&&b.floatBlend)))return!1;const e=new yn(i,{colorTarget:Vn.TEXTURE,depthStencilTarget:rs.NONE},{target:bi.TEXTURE_2D,wrapMode:ai.CLAMP_TO_EDGE,pixelFormat:St.RGBA,dataType:Xt.FLOAT,internalFormat:ES.RGBA32F,samplingMode:Jt.NEAREST,width:1,height:1}),t=ui.createVertex(i,mi.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),r=new Gc(i,new Map([["a_pos",0]]),{geometry:[new aF("a_pos",2,dm.UNSIGNED_SHORT,0,4)]},{geometry:t}),n=`
  precision highp float;
  attribute vec2 a_pos;

  void main() {
    gl_Position = vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);
  }
  `,s=`
   precision highp float;

   void main() {
    gl_FragColor = vec4(0.5, 0.5, 0.5, 0.5);
   }
  `,a=i.programCache.acquire(n,s,new Map([["a_pos",0]]));i.useProgram(a);const o=i.getBoundFramebufferObject(),{x:l,y:c,width:u,height:d}=i.getViewport();i.bindFramebuffer(e),i.setViewport(0,0,1,1),i.bindVAO(r),i.drawArrays(kt.TRIANGLE_STRIP,0,4);const m=it({blending:xse});i.setPipelineState(m),i.drawArrays(kt.TRIANGLE_STRIP,0,4),Kee.exports.init(i);const f=i.gl.getError();return i.setViewport(l,c,u,d),i.bindFramebuffer(o),a.dispose(),r.dispose(!1),t.dispose(),e.dispose(),f!==1282||(console.warn("Device claims support for WebGL extension EXT_float_blend but does not support it. Using fall back."),!1)}l7=Kee,c7=function(){var i=function(g){window.console&&window.console.log&&window.console.log(g)},e=function(g){window.console&&window.console.error?window.console.error(g):i(g)},t={enable:{1:{0:!0}},disable:{1:{0:!0}},getParameter:{1:{0:!0}},drawArrays:{3:{0:!0}},drawElements:{4:{0:!0,2:!0}},createShader:{1:{0:!0}},getShaderParameter:{2:{1:!0}},getProgramParameter:{2:{1:!0}},getShaderPrecisionFormat:{2:{0:!0,1:!0}},getVertexAttrib:{2:{1:!0}},vertexAttribPointer:{6:{2:!0}},bindTexture:{2:{0:!0}},activeTexture:{1:{0:!0}},getTexParameter:{2:{0:!0,1:!0}},texParameterf:{3:{0:!0,1:!0}},texParameteri:{3:{0:!0,1:!0,2:!0}},texImage2D:{9:{0:!0,2:!0,6:!0,7:!0},6:{0:!0,2:!0,3:!0,4:!0}},texSubImage2D:{9:{0:!0,6:!0,7:!0},7:{0:!0,4:!0,5:!0}},copyTexImage2D:{8:{0:!0,2:!0}},copyTexSubImage2D:{8:{0:!0}},generateMipmap:{1:{0:!0}},compressedTexImage2D:{7:{0:!0,2:!0}},compressedTexSubImage2D:{8:{0:!0,6:!0}},bindBuffer:{2:{0:!0}},bufferData:{3:{0:!0,2:!0}},bufferSubData:{3:{0:!0}},getBufferParameter:{2:{0:!0,1:!0}},pixelStorei:{2:{0:!0,1:!0}},readPixels:{7:{4:!0,5:!0}},bindRenderbuffer:{2:{0:!0}},bindFramebuffer:{2:{0:!0}},checkFramebufferStatus:{1:{0:!0}},framebufferRenderbuffer:{4:{0:!0,1:!0,2:!0}},framebufferTexture2D:{5:{0:!0,1:!0,2:!0}},getFramebufferAttachmentParameter:{3:{0:!0,1:!0,2:!0}},getRenderbufferParameter:{2:{0:!0,1:!0}},renderbufferStorage:{4:{0:!0,1:!0}},clear:{1:{0:{enumBitwiseOr:["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]}}},depthFunc:{1:{0:!0}},blendFunc:{2:{0:!0,1:!0}},blendFuncSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},blendEquation:{1:{0:!0}},blendEquationSeparate:{2:{0:!0,1:!0}},stencilFunc:{3:{0:!0}},stencilFuncSeparate:{4:{0:!0,1:!0}},stencilMaskSeparate:{2:{0:!0}},stencilOp:{3:{0:!0,1:!0,2:!0}},stencilOpSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},cullFace:{1:{0:!0}},frontFace:{1:{0:!0}},drawArraysInstancedANGLE:{4:{0:!0}},drawElementsInstancedANGLE:{5:{0:!0,2:!0}},blendEquationEXT:{1:{0:!0}}},r=null,n=null;function s(g){if(r==null)for(var w in r={},n={},g)typeof g[w]=="number"&&(r[g[w]]=w,n[w]=g[w])}function a(){if(r==null)throw"WebGLDebugUtils.init(ctx) not called"}function o(g){return a(),r[g]!==void 0}function l(g){a();var w=r[g];return w!==void 0?"gl."+w:"/*UNKNOWN WebGL ENUM*/ 0x"+g.toString(16)}function c(g,w,v,b){var x;if((x=t[g])!==void 0&&(x=x[w])!==void 0&&x[v]){if(typeof x[v]=="object"&&x[v].enumBitwiseOr!==void 0){for(var T=x[v].enumBitwiseOr,R=0,E=[],O=0;O<T.length;++O){var $=n[T[O]];b&$&&(R|=$,E.push(l($)))}return R===b?E.join(" | "):l(b)}return l(b)}return b===null?"null":b===void 0?"undefined":b.toString()}function u(g,w){for(var v="",b=w.length,x=0;x<b;++x)v+=(x==0?"":", ")+c(g,b,x,w[x]);return v}function d(g,w,v){g.__defineGetter__(v,function(){return w[v]}),g.__defineSetter__(v,function(b){w[v]=b})}function m(g,w,v,b){b=b||g,s(g),w=w||function($,D,I){for(var G="",W=I.length,re=0;re<W;++re)G+=(re==0?"":", ")+c(D,W,re,I[re]);e("WebGL error "+l($)+" in "+D+"("+G+")")};var x={};function T($,D){return function(){v&&v(D,arguments);var I=$[D].apply($,arguments),G=b.getError();return G!=0&&(x[G]=!0,w(G,D,arguments)),I}}var R={};for(var E in g)if(typeof g[E]=="function")if(E!="getExtension")R[E]=T(g,E);else{var O=T(g,E);R[E]=function(){return m(O.apply(g,arguments),w,v,b)}}else d(R,g,E);return R.getError=function(){for(var $ in x)if(x.hasOwnProperty($)&&x[$])return x[$]=!1,$;return g.NO_ERROR},R}function f(g){var w=g.getParameter(g.MAX_VERTEX_ATTRIBS),v=g.createBuffer();g.bindBuffer(g.ARRAY_BUFFER,v);for(var b=0;b<w;++b)g.disableVertexAttribArray(b),g.vertexAttribPointer(b,4,g.FLOAT,!1,0,0),g.vertexAttrib1f(b,0);g.deleteBuffer(v);var x=g.getParameter(g.MAX_TEXTURE_IMAGE_UNITS);for(b=0;b<x;++b)g.activeTexture(g.TEXTURE0+b),g.bindTexture(g.TEXTURE_CUBE_MAP,null),g.bindTexture(g.TEXTURE_2D,null);for(g.activeTexture(g.TEXTURE0),g.useProgram(null),g.bindBuffer(g.ARRAY_BUFFER,null),g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,null),g.bindFramebuffer(g.FRAMEBUFFER,null),g.bindRenderbuffer(g.RENDERBUFFER,null),g.disable(g.BLEND),g.disable(g.CULL_FACE),g.disable(g.DEPTH_TEST),g.disable(g.DITHER),g.disable(g.SCISSOR_TEST),g.blendColor(0,0,0,0),g.blendEquation(g.FUNC_ADD),g.blendFunc(g.ONE,g.ZERO),g.clearColor(0,0,0,0),g.clearDepth(1),g.clearStencil(-1),g.colorMask(!0,!0,!0,!0),g.cullFace(g.BACK),g.depthFunc(g.LESS),g.depthMask(!0),g.depthRange(0,1),g.frontFace(g.CCW),g.hint(g.GENERATE_MIPMAP_HINT,g.DONT_CARE),g.lineWidth(1),g.pixelStorei(g.PACK_ALIGNMENT,4),g.pixelStorei(g.UNPACK_ALIGNMENT,4),g.pixelStorei(g.UNPACK_FLIP_Y_WEBGL,!1),g.pixelStorei(g.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),g.UNPACK_COLORSPACE_CONVERSION_WEBGL&&g.pixelStorei(g.UNPACK_COLORSPACE_CONVERSION_WEBGL,g.BROWSER_DEFAULT_WEBGL),g.polygonOffset(0,0),g.sampleCoverage(1,!1),g.scissor(0,0,g.canvas.width,g.canvas.height),g.stencilFunc(g.ALWAYS,0,4294967295),g.stencilMask(4294967295),g.stencilOp(g.KEEP,g.KEEP,g.KEEP),g.viewport(0,0,g.canvas.width,g.canvas.height),g.clear(g.COLOR_BUFFER_BIT|g.DEPTH_BUFFER_BIT|g.STENCIL_BUFFER_BIT);g.getError(););}function _(g){var w,v,b=[],x=[],T={},R=1,E=!1,O=[],$=0,D=0,I=!1,G=0,W={};function re(Z){return typeof Z=="function"?Z:function(ne){Z.handleEvent(ne)}}g.getContext=(v=g.getContext,function(){var Z=v.apply(g,arguments);if(Z instanceof WebGLRenderingContext){if(Z!=w){if(w)throw"got different context";T=ie(w=Z)}return T}return Z});var te=function(Z){b.push(re(Z))},H=function(Z){x.push(re(Z))};function M(Z){var ne=Z.addEventListener;Z.addEventListener=function(Ae,Fe,ze){switch(Ae){case"webglcontextlost":te(Fe);break;case"webglcontextrestored":H(Fe);break;default:ne.apply(Z,arguments)}}}function U(){for(var Z=Object.keys(W),ne=0;ne<Z.length;++ne)delete W[Z]}function L(){++D,E||$==D&&g.loseContext()}function z(Z,ne){var Ae=Z[ne];return function(){if(L(),!E)return Ae.apply(Z,arguments)}}function q(){for(var Z=0;Z<O.length;++Z){var ne=O[Z];ne instanceof WebGLBuffer?w.deleteBuffer(ne):ne instanceof WebGLFramebuffer?w.deleteFramebuffer(ne):ne instanceof WebGLProgram?w.deleteProgram(ne):ne instanceof WebGLRenderbuffer?w.deleteRenderbuffer(ne):ne instanceof WebGLShader?w.deleteShader(ne):ne instanceof WebGLTexture&&w.deleteTexture(ne)}}function K(Z){return{statusMessage:Z,preventDefault:function(){I=!0}}}return M(g),g.loseContext=function(){if(!E){for(E=!0,$=0,++R;w.getError(););U(),W[w.CONTEXT_LOST_WEBGL]=!0;var Z=K("context lost"),ne=b.slice();setTimeout(function(){for(var Ae=0;Ae<ne.length;++Ae)ne[Ae](Z);G>=0&&setTimeout(function(){g.restoreContext()},G)},0)}},g.restoreContext=function(){E&&x.length&&setTimeout(function(){if(!I)throw"can not restore. webglcontestlost listener did not call event.preventDefault";q(),f(w),E=!1,D=0,I=!1;for(var Z=x.slice(),ne=K("context restored"),Ae=0;Ae<Z.length;++Ae)Z[Ae](ne)},0)},g.loseContextInNCalls=function(Z){if(E)throw"You can not ask a lost contet to be lost";$=D+Z},g.getNumCalls=function(){return D},g.setRestoreTimeout=function(Z){G=Z},g;function ie(Z){for(var ne in Z)typeof Z[ne]=="function"?T[ne]=z(Z,ne):d(T,Z,ne);T.getError=function(){if(L(),!E)for(;Ee=w.getError();)W[Ee]=!0;for(var Ee in W)if(W[Ee])return delete W[Ee],Ee;return T.NO_ERROR};for(var Ae=["createBuffer","createFramebuffer","createProgram","createRenderbuffer","createShader","createTexture"],Fe=0;Fe<Ae.length;++Fe){var ze=Ae[Fe];T[ze]=function(Ee){return function(){if(L(),E)return null;var je=Ee.apply(Z,arguments);return je.__webglDebugContextLostId__=R,O.push(je),je}}(Z[ze])}var Ye=["getActiveAttrib","getActiveUniform","getBufferParameter","getContextAttributes","getAttachedShaders","getFramebufferAttachmentParameter","getParameter","getProgramParameter","getProgramInfoLog","getRenderbufferParameter","getShaderParameter","getShaderInfoLog","getShaderSource","getTexParameter","getUniform","getUniformLocation","getVertexAttrib"];for(Fe=0;Fe<Ye.length;++Fe)ze=Ye[Fe],T[ze]=function(Ee){return function(){return L(),E?null:Ee.apply(Z,arguments)}}(T[ze]);var Ce=["isBuffer","isEnabled","isFramebuffer","isProgram","isRenderbuffer","isShader","isTexture"];for(Fe=0;Fe<Ce.length;++Fe)ze=Ce[Fe],T[ze]=function(Ee){return function(){return L(),!E&&Ee.apply(Z,arguments)}}(T[ze]);return T.checkFramebufferStatus=function(Ee){return function(){return L(),E?T.FRAMEBUFFER_UNSUPPORTED:Ee.apply(Z,arguments)}}(T.checkFramebufferStatus),T.getAttribLocation=function(Ee){return function(){return L(),E?-1:Ee.apply(Z,arguments)}}(T.getAttribLocation),T.getVertexAttribOffset=function(Ee){return function(){return L(),E?0:Ee.apply(Z,arguments)}}(T.getVertexAttribOffset),T.isContextLost=function(){return E},T}}return{init:s,mightBeEnum:o,glEnumToString:l,glFunctionArgToString:c,glFunctionArgsToString:u,makeDebugContext:m,makeLostContextSimulatingCanvas:_,resetToInitialState:f}},(h7=c7())!==void 0&&(l7.exports=h7);function t$e(i){const e=new yn(i,{colorTarget:Vn.TEXTURE,depthStencilTarget:rs.NONE},{target:bi.TEXTURE_2D,wrapMode:ai.CLAMP_TO_EDGE,pixelFormat:St.RGBA,dataType:Xt.UNSIGNED_BYTE,samplingMode:Jt.NEAREST,width:1,height:1}),t=`
precision highp float;
attribute vec2 a_pos;
uniform highp sampler2D u_texture;
varying vec4 v_color;

float getBit(in float bitset, in int bitIndex) {
  float offset = pow(2.0, float(bitIndex));
  return mod(floor(bitset / offset), 2.0);
}

void main() {
  vec4 value = texture2D(u_texture, vec2(0.0));
  float bit = getBit(value.x * 255.0, 1);

  v_color = bit * vec4(1.0);
  gl_Position = vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);
}
`,r=`
precision highp float;
varying vec4 v_color;

void main() {
  gl_FragColor = v_color;
}
`,n=new Uint8Array(4),s=ui.createVertex(i,mi.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),a=new Gc(i,new Map([["a_position",0]]),{geometry:[new aF("a_position",2,dm.SHORT,0,4)]},{geometry:s}),o=i.programCache.acquire(t,r,new Map([["a_pos",0]]));i.useProgram(o);const l=new Gi(i,{target:bi.TEXTURE_2D,wrapMode:ai.CLAMP_TO_EDGE,pixelFormat:St.RGBA,dataType:Xt.UNSIGNED_BYTE,samplingMode:Jt.NEAREST,width:1,height:1},new Uint8Array([2,255,0,0]));o.setUniform1i("u_texture",0),i.bindTexture(l,0);const c=i.getBoundFramebufferObject();i.bindFramebuffer(e),i.useProgram(o);const{x:u,y:d,width:m,height:f}=i.getViewport();i.setViewport(0,0,1,1),i.bindVAO(a),i.drawArrays(kt.TRIANGLE_STRIP,0,4),i.setViewport(u,d,m,f),e.readPixels(0,0,1,1,St.RGBA,Xt.UNSIGNED_BYTE,n),o.dispose(),a.dispose(!1),s.dispose(),e.dispose();const _=n[0]!==255||n[1]!==255||n[2]!==255||n[3]!==255;return _&&ee.getLogger("esri.views.webgl.testSamplerPrecision").warn(`A problem was detected with your graphics driver. Your driver does not appear to honor sampler precision specifiers, which may result in rendering issues due to numerical instability. We recommend ensuring that your drivers have been updated to the latest version. Applying lowp sampler workaround. [${n[0]}.${n[1]}.${n[2]}.${n[3]}]`),i.bindFramebuffer(c),_}async function i$e(i){const e=new Image;if(e.src="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='5' height='5' version='1.1' viewBox='0 0 5 5' xmlns='http://www.w3.org/2000/svg'%3E%3Crect width='5' height='5' fill='%23f00' fill-opacity='.5'/%3E%3C/svg%3E%0A",e.width=5,e.height=5,await e.decode(),!i.gl)return!0;const t=new yn(i,{colorTarget:Vn.TEXTURE,depthStencilTarget:rs.NONE},{target:bi.TEXTURE_2D,wrapMode:ai.CLAMP_TO_EDGE,pixelFormat:St.RGBA,dataType:Xt.UNSIGNED_BYTE,samplingMode:Jt.NEAREST,width:1,height:1}),r=ui.createVertex(i,mi.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),n=new Gc(i,new Map([["a_pos",0]]),toe,{geometry:r}),s=`
  precision highp float;

  attribute vec2 a_pos;
  varying vec2 v_uv;

  void main() {
    v_uv = a_pos;
    gl_Position = vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);
  }
  `,a=`
  precision highp float;

  varying vec2 v_uv;
  uniform sampler2D u_texture;

  void main() {
    gl_FragColor = texture2D(u_texture, v_uv);
  }
  `,o=i.programCache.acquire(s,a,new Map([["a_pos",0]]));i.useProgram(o);const l=new Gi(i,{dataType:Xt.UNSIGNED_BYTE,pixelFormat:St.RGBA,preMultiplyAlpha:!1,wrapMode:ai.CLAMP_TO_EDGE,samplingMode:Jt.LINEAR},e);i.bindTexture(l,0),o.setUniform1i("u_texture",0);const c=i.getBoundFramebufferObject(),{x:u,y:d,width:m,height:f}=i.getViewport();i.bindFramebuffer(t),i.setViewport(0,0,1,1),i.setClearColor(0,0,0,0),i.setBlendingEnabled(!1),i.clearSafe(Oi.COLOR_BUFFER_BIT),i.bindVAO(n),i.drawArrays(kt.TRIANGLE_STRIP,0,4);const _=new Uint8Array(4);return t.readPixels(0,0,1,1,St.RGBA,Xt.UNSIGNED_BYTE,_),o.dispose(),n.dispose(!1),r.dispose(),t.dispose(),l.dispose(),i.setViewport(u,d,m,f),i.bindFramebuffer(c),e.src="",_[0]===255}let r$e=class{constructor(e){this.context=e,this._floatBufferBlendWorking=e$e(e),i$e(e).then(t=>this._svgAlwaysPremultipliesAlpha=!t)}get floatBufferBlendWorking(){if(C(this._floatBufferBlendWorking))throw new Error("floatBufferBlendWorking test not yet available");return this._floatBufferBlendWorking}get svgAlwaysPremultipliesAlpha(){if(C(this._svgAlwaysPremultipliesAlpha))throw new Error("svgAlwaysPremultipliesAlpha test not yet available");return this._svgAlwaysPremultipliesAlpha}get doublePrecisionRequiresObfuscation(){if(C(this._doublePrecisionRequiresObfuscation)){const e=o7(this.context,!1),t=o7(this.context,!0);this._doublePrecisionRequiresObfuscation=e!==0&&(t===0||e/t>5)}return this._doublePrecisionRequiresObfuscation}get ignoresSamplerPrecision(){return C(this._ignoresSamplerPrecision)&&(this._ignoresSamplerPrecision=t$e(this.context)),this._ignoresSamplerPrecision}};function n$e(i,e){if(e.disjointTimerQuery)return null;if(Ca(i))return{drawBuffers:i.drawBuffers.bind(i),MAX_DRAW_BUFFERS:i.MAX_DRAW_BUFFERS,MAX_COLOR_ATTACHMENTS:i.MAX_COLOR_ATTACHMENTS};if(e.drawBuffers)return null;const t=i.getExtension("WEBGL_draw_buffers");return t?{drawBuffers:t.drawBuffersWEBGL.bind(t),MAX_DRAW_BUFFERS:t.MAX_DRAW_BUFFERS_WEBGL,MAX_COLOR_ATTACHMENTS:t.MAX_COLOR_ATTACHMENTS_WEBGL}:null}function s$e(i){if(Ca(i))return i;const e=i.getExtension("ANGLE_instanced_arrays");return e?{drawArraysInstanced:e.drawArraysInstancedANGLE.bind(e),drawElementsInstanced:e.drawElementsInstancedANGLE.bind(e),vertexAttribDivisor:e.vertexAttribDivisorANGLE.bind(e)}:null}function a$e(i,e){if(e.compressedTextureETC)return null;const t=i.getExtension("WEBGL_compressed_texture_etc");return t?{COMPRESSED_R11_EAC:t.COMPRESSED_R11_EAC,COMPRESSED_SIGNED_R11_EAC:t.COMPRESSED_SIGNED_R11_EAC,COMPRESSED_RG11_EAC:t.COMPRESSED_RG11_EAC,COMPRESSED_SIGNED_RG11_EAC:t.COMPRESSED_SIGNED_RG11_EAC,COMPRESSED_RGB8_ETC2:t.COMPRESSED_RGB8_ETC2,COMPRESSED_SRGB8_ETC2:t.COMPRESSED_SRGB8_ETC2,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2,COMPRESSED_RGBA8_ETC2_EAC:t.COMPRESSED_RGBA8_ETC2_EAC,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC}:null}function o$e(i,e){if(e.compressedTextureS3TC)return null;const t=i.getExtension("WEBGL_compressed_texture_s3tc");return t?{COMPRESSED_RGB_S3TC_DXT1:t.COMPRESSED_RGB_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT1:t.COMPRESSED_RGBA_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT3:t.COMPRESSED_RGBA_S3TC_DXT3_EXT,COMPRESSED_RGBA_S3TC_DXT5:t.COMPRESSED_RGBA_S3TC_DXT5_EXT}:null}function l$e(i,e){if(Ca(i))return{MIN:i.MIN,MAX:i.MAX};if(e.blendMinMax)return null;{const t=i.getExtension("EXT_blend_minmax");return t?{MIN:t.MIN_EXT,MAX:t.MAX_EXT}:null}}function c$e(i,e){if(e.textureFilterAnisotropic)return null;const t=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");return t?{MAX_TEXTURE_MAX_ANISOTROPY:t.MAX_TEXTURE_MAX_ANISOTROPY_EXT,TEXTURE_MAX_ANISOTROPY:t.TEXTURE_MAX_ANISOTROPY_EXT}:null}function h$e(i,e){if(Ca(i))return{textureFloat:!0,textureFloatLinear:!e.textureFloatLinear&&!!i.getExtension("OES_texture_float_linear"),textureHalfFloat:!0,textureHalfFloatLinear:!0,HALF_FLOAT:i.HALF_FLOAT,R16F:i.R16F,RG16F:i.RG16F,RGBA16F:i.RGBA16F,R32F:i.R32F,RG32F:i.RG32F,RGBA32F:i.RGBA32F,R11F_G11F_B10F:i.R11F_G11F_B10F,RGB16F:i.RGB16F};if(i instanceof WebGLRenderingContext){const t=!e.textureHalfFloat&&i.getExtension("OES_texture_half_float");return{textureFloat:!e.textureFloat&&!!i.getExtension("OES_texture_float"),textureFloatLinear:!e.textureFloatLinear&&!!i.getExtension("OES_texture_float_linear"),textureHalfFloat:!!t,textureHalfFloatLinear:!e.textureHalfFloatLinear&&!!i.getExtension("OES_texture_half_float_linear"),HALF_FLOAT:t?t.HALF_FLOAT_OES:void 0}}return null}function u$e(i,e){if(Ca(i)){const t=!e.colorBufferHalfFloat&&i.getExtension("EXT_color_buffer_half_float")||!e.colorBufferFloat&&i.getExtension("EXT_color_buffer_float"),r=!e.colorBufferFloat&&i.getExtension("EXT_color_buffer_float"),n=!e.floatBlend&&!e.colorBufferFloat&&i.getExtension("EXT_float_blend");return t||r||n?{textureFloat:!!r,textureHalfFloat:!!t,floatBlend:!!n,R16F:i.R16F,RG16F:i.RG16F,RGBA16F:i.RGBA16F,R32F:i.R32F,RG32F:i.RG32F,RGBA32F:i.RGBA32F,R11F_G11F_B10F:i.R11F_G11F_B10F,RGB16F:i.RGB16F}:null}if(i instanceof WebGLRenderingContext){const t=!e.colorBufferHalfFloat&&i.getExtension("EXT_color_buffer_half_float"),r=!e.colorBufferFloat&&i.getExtension("WEBGL_color_buffer_float"),n=!e.floatBlend&&!e.colorBufferFloat&&i.getExtension("EXT_float_blend");return t||r||n?{textureFloat:!!r,textureHalfFloat:!!t,floatBlend:!!n,RGBA16F:t?t.RGBA16F_EXT:void 0,RGB16F:t?t.RGB16F_EXT:void 0,RGBA32F:r?r.RGBA32F_EXT:void 0}:null}return null}function D1(i,e,t,r,n){if(r&&Ca(i))return!0;if(e[t])return!1;for(const s of n)if(i.getExtension(s))return!0;return!1}function d$e(i,e){if(!Ca(i)||e.textureNorm16)return null;const t=i.getExtension("EXT_texture_norm16");return t?{R16:t.R16_EXT,RG16:t.RG16_EXT,RGB16:t.RGB16_EXT,RGBA16:t.RGBA16_EXT,R16_SNORM:t.R16_SNORM_EXT,RG16_SNORM:t.RG16_SNORM_EXT,RGB16_SNORM:t.RGB16_SNORM_EXT,RGBA16_SNORM:t.RGBA16_SNORM_EXT}:null}function p$e(i,e){const t=e.loseContext&&i.getExtension("WEBGL_lose_context");return t?{loseRenderingContext:()=>t.loseContext()}:null}function m$e(i,e){if(Ca(i))return{createVertexArray:i.createVertexArray.bind(i),deleteVertexArray:i.deleteVertexArray.bind(i),bindVertexArray:i.bindVertexArray.bind(i)};if(e.vao)return null;const t=i.getExtension("OES_vertex_array_object")||i.getExtension("MOZ_OES_vertex_array_object")||i.getExtension("WEBKIT_OES_vertex_array_object");return t?{createVertexArray:t.createVertexArrayOES.bind(t),deleteVertexArray:t.deleteVertexArrayOES.bind(t),bindVertexArray:t.bindVertexArrayOES.bind(t)}:null}class f$e{constructor(e,t){this._gl=e,this._instancing=null,this._vertexArrayObject=null,this._compressedTextureETC=null,this._compressedTextureS3TC=null,this._textureFilterAnisotropic=null,this._textureFloat=null,this._colorBufferFloat=null,this._minMaxBlending=null,this._loseContext=null,this._drawBuffers=null,this._textureNorm16=null,this._depthTexture=null,this._standardDerivatives=null,this._shaderTextureLOD=null,this._fragDepth=null,this._textureFloatLinear=null,this._disabledExtensions=t.disabledExtensions||{},this._debugWebGLExtensions=t.debugWebGLExtensions||{}}get drawBuffers(){return this._drawBuffers||(this._drawBuffers=n$e(this._gl,this._disabledExtensions)),this._drawBuffers}get instancing(){return this._instancing||(this._instancing=s$e(this._gl)),this._instancing}get vao(){return this._vertexArrayObject||(this._vertexArrayObject=m$e(this._gl,this._disabledExtensions)),this._vertexArrayObject}get compressedTextureETC(){return this._compressedTextureETC||(this._compressedTextureETC=a$e(this._gl,this._disabledExtensions)),this._compressedTextureETC}get compressedTextureS3TC(){return this._compressedTextureS3TC||(this._compressedTextureS3TC=o$e(this._gl,this._disabledExtensions)),this._compressedTextureS3TC}get textureFilterAnisotropic(){return this._textureFilterAnisotropic||(this._textureFilterAnisotropic=c$e(this._gl,this._disabledExtensions)),this._textureFilterAnisotropic}get disjointTimerQuery(){return this._disjointTimerQuery||(this._disjointTimerQuery=j3e(this._gl,this._disabledExtensions)),this._disjointTimerQuery}get textureFloat(){return this._textureFloat||(this._textureFloat=h$e(this._gl,this._disabledExtensions)),this._textureFloat}get colorBufferFloat(){return this._colorBufferFloat||(this._colorBufferFloat=u$e(this._gl,this._disabledExtensions)),this._colorBufferFloat}get blendMinMax(){return this._minMaxBlending||(this._minMaxBlending=l$e(this._gl,this._disabledExtensions)),this._minMaxBlending}get depthTexture(){return this._depthTexture===null&&(this._depthTexture=D1(this._gl,this._disabledExtensions,"depthTexture",!0,["WEBGL_depth_texture","MOZ_WEBGL_depth_texture","WEBKIT_WEBGL_depth_texture"])),this._depthTexture}get standardDerivatives(){return this._standardDerivatives===null&&(this._standardDerivatives=D1(this._gl,this._disabledExtensions,"standardDerivatives",!0,["OES_standard_derivatives"])),this._standardDerivatives}get shaderTextureLOD(){return this._shaderTextureLOD===null&&(this._shaderTextureLOD=D1(this._gl,this._disabledExtensions,"shaderTextureLOD",!0,["EXT_shader_texture_lod"])),this._shaderTextureLOD}get fragDepth(){return this._fragDepth===null&&(this._fragDepth=D1(this._gl,this._disabledExtensions,"fragDepth",!0,["EXT_frag_depth"])),this._fragDepth}get loseContext(){return this._loseContext||(this._loseContext=p$e(this._gl,this._debugWebGLExtensions)),this._loseContext}get textureNorm16(){return this._textureNorm16||(this._textureNorm16=d$e(this._gl,this._disabledExtensions)),this._textureNorm16}get textureFloatLinear(){return this._textureFloatLinear===null&&(this._textureFloatLinear=D1(this._gl,this._disabledExtensions,"textureFloatLinear",!1,["OES_texture_float_linear"])),this._textureFloatLinear}enable(e){return this[e]}}let g$e=class{constructor(e,t){this.gl=e,this.instanceCounter=new Y3e,this.programCache=new K3e(this),this._state=new a7,this._numOfDrawCalls=0,this._numOfTriangles=0,this.type=Ca(e)?Nn.WEBGL2:Nn.WEBGL1,this._loadExtensions(),this.configure(t)}configure(e){this._capabilities=new f$e(this.gl,e),this._parameters=this._loadParameters(e);const t=this.gl.getParameter(this.gl.VIEWPORT);this._state=new a7,this._state.viewport={x:t[0],y:t[1],width:t[2],height:t[3]},this._stateTracker=new Nne({setBlending:r=>{if(r){this.setBlendingEnabled(!0),this.setBlendEquationSeparate(r.opRgb,r.opAlpha),this.setBlendFunctionSeparate(r.srcRgb,r.dstRgb,r.srcAlpha,r.dstAlpha);const n=r.color;this.setBlendColor(n.r,n.g,n.b,n.a)}else this.setBlendingEnabled(!1)},setCulling:r=>{r?(this.setFaceCullingEnabled(!0),this.setCullFace(r.face),this.setFrontFace(r.mode)):this.setFaceCullingEnabled(!1)},setPolygonOffset:r=>{r?(this.setPolygonOffsetFillEnabled(!0),this.setPolygonOffset(r.factor,r.units)):this.setPolygonOffsetFillEnabled(!1)},setDepthTest:r=>{r?(this.setDepthTestEnabled(!0),this.setDepthFunction(r.func)):this.setDepthTestEnabled(!1)},setStencilTest:r=>{if(r){this.setStencilTestEnabled(!0);const n=r.function;this.setStencilFunction(n.func,n.ref,n.mask);const s=r.operation;this.setStencilOp(s.fail,s.zFail,s.zPass)}else this.setStencilTestEnabled(!1)},setDepthWrite:r=>{r?(this.setDepthWriteEnabled(!0),this.setDepthRange(r.zNear,r.zFar)):this.setDepthWriteEnabled(!1)},setColorWrite:r=>{r?this.setColorMask(r.r,r.g,r.b,r.a):this.setColorMask(!1,!1,!1,!1)},setStencilWrite:r=>{r?this.setStencilWriteMask(r.mask):this.setStencilWriteMask(0)}}),this.enforceState(),this._driverTest=new r$e(this)}get driverTest(){return this._driverTest}get contextAttributes(){return this.gl.getContextAttributes()}get parameters(){return this._parameters}dispose(){this.programCache.dispose(),this.bindVAO(null),this.unbindBuffer($t.ARRAY_BUFFER),this.unbindBuffer($t.ELEMENT_ARRAY_BUFFER),Ca(this.gl)&&(this.unbindBuffer($t.UNIFORM_BUFFER),this._state.uniformBufferBindingPoints.length=0,this.unbindBuffer($t.PIXEL_PACK_BUFFER),this.unbindBuffer($t.PIXEL_UNPACK_BUFFER),this.unbindBuffer($t.COPY_READ_BUFFER),this.unbindBuffer($t.COPY_WRITE_BUFFER)),this._state.textureUnitMap.length=0,qd()&&this.instanceCounter.printResourceCount()}setPipelineState(e){this._stateTracker.setPipeline(e)}setBlendingEnabled(e){this._state.blend!==e&&(e===!0?this.gl.enable(this.gl.BLEND):this.gl.disable(this.gl.BLEND),this._state.blend=e,this._stateTracker.invalidateBlending())}externalProgramUpdate(){var e;(e=this._state.program)==null||e.stop(),this._state.program=null}externalTextureUnitUpdate(e,t){for(let r=0;r<e.length;++r)this._state.textureUnitMap[e[r]]=null;t>=0&&(this._state.activeTexture=t)}externalVertexArrayObjectUpdate(){const e=this.capabilities.vao;e&&(e.bindVertexArray(null),this._state.vertexArrayObject=null),this._state.vertexBuffer=null,this._state.indexBuffer=null}externalVertexBufferUpdate(){this._state.vertexBuffer=null}externalIndexBufferUpdate(){this._state.indexBuffer=null}setBlendColor(e,t,r,n){e===this._state.blendColor.r&&t===this._state.blendColor.g&&r===this._state.blendColor.b&&n===this._state.blendColor.a||(this.gl.blendColor(e,t,r,n),this._state.blendColor.r=e,this._state.blendColor.g=t,this._state.blendColor.b=r,this._state.blendColor.a=n,this._stateTracker.invalidateBlending())}setBlendFunction(e,t){e===this._state.blendFunction.srcRGB&&t===this._state.blendFunction.dstRGB||(this.gl.blendFunc(e,t),this._state.blendFunction.srcRGB=e,this._state.blendFunction.srcAlpha=e,this._state.blendFunction.dstRGB=t,this._state.blendFunction.dstAlpha=t,this._stateTracker.invalidateBlending())}setBlendFunctionSeparate(e,t,r,n){this._state.blendFunction.srcRGB===e&&this._state.blendFunction.srcAlpha===r&&this._state.blendFunction.dstRGB===t&&this._state.blendFunction.dstAlpha===n||(this.gl.blendFuncSeparate(e,t,r,n),this._state.blendFunction.srcRGB=e,this._state.blendFunction.srcAlpha=r,this._state.blendFunction.dstRGB=t,this._state.blendFunction.dstAlpha=n,this._stateTracker.invalidateBlending())}setBlendEquation(e){this._state.blendEquation.mode!==e&&(this.gl.blendEquation(e),this._state.blendEquation.mode=e,this._state.blendEquation.modeAlpha=e,this._stateTracker.invalidateBlending())}setBlendEquationSeparate(e,t){this._state.blendEquation.mode===e&&this._state.blendEquation.modeAlpha===t||(this.gl.blendEquationSeparate(e,t),this._state.blendEquation.mode=e,this._state.blendEquation.modeAlpha=t,this._stateTracker.invalidateBlending())}setColorMask(e,t,r,n){this._state.colorMask.r===e&&this._state.colorMask.g===t&&this._state.colorMask.b===r&&this._state.colorMask.a===n||(this.gl.colorMask(e,t,r,n),this._state.colorMask.r=e,this._state.colorMask.g=t,this._state.colorMask.b=r,this._state.colorMask.a=n,this._stateTracker.invalidateColorWrite())}setClearColor(e,t,r,n){this._state.clearColor.r===e&&this._state.clearColor.g===t&&this._state.clearColor.b===r&&this._state.clearColor.a===n||(this.gl.clearColor(e,t,r,n),this._state.clearColor.r=e,this._state.clearColor.g=t,this._state.clearColor.b=r,this._state.clearColor.a=n)}setFaceCullingEnabled(e){this._state.faceCulling!==e&&(e===!0?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this._state.faceCulling=e,this._stateTracker.invalidateCulling())}setPolygonOffsetFillEnabled(e){this._state.polygonOffsetFill!==e&&(e===!0?this.gl.enable(this.gl.POLYGON_OFFSET_FILL):this.gl.disable(this.gl.POLYGON_OFFSET_FILL),this._state.polygonOffsetFill=e,this._stateTracker.invalidatePolygonOffset())}setPolygonOffset(e,t){this._state.polygonOffset[0]===e&&this._state.polygonOffset[1]===t||(this._state.polygonOffset[0]=e,this._state.polygonOffset[1]=t,this.gl.polygonOffset(e,t),this._stateTracker.invalidatePolygonOffset())}setCullFace(e){this._state.cullFace!==e&&(this.gl.cullFace(e),this._state.cullFace=e,this._stateTracker.invalidateCulling())}setFrontFace(e){this._state.frontFace!==e&&(this.gl.frontFace(e),this._state.frontFace=e,this._stateTracker.invalidateCulling())}setScissorTestEnabled(e){this._state.scissorTest!==e&&(e===!0?this.gl.enable(this.gl.SCISSOR_TEST):this.gl.disable(this.gl.SCISSOR_TEST),this._state.scissorTest=e)}setScissorRect(e,t,r,n){this._state.scissorRect.x===e&&this._state.scissorRect.y===t&&this._state.scissorRect.width===r&&this._state.scissorRect.height===n||(this.gl.scissor(e,t,r,n),this._state.scissorRect.x=e,this._state.scissorRect.y=t,this._state.scissorRect.width=r,this._state.scissorRect.height=n)}setDepthTestEnabled(e){this._state.depthTest!==e&&(e===!0?this.gl.enable(this.gl.DEPTH_TEST):this.gl.disable(this.gl.DEPTH_TEST),this._state.depthTest=e,this._stateTracker.invalidateDepthTest())}setClearDepth(e){this._state.clearDepth!==e&&(this.gl.clearDepth(e),this._state.clearDepth=e)}setDepthFunction(e){this._state.depthFunction!==e&&(this.gl.depthFunc(e),this._state.depthFunction=e,this._stateTracker.invalidateDepthTest())}setDepthWriteEnabled(e){this._state.depthWrite!==e&&(this.gl.depthMask(e),this._state.depthWrite=e,this._stateTracker.invalidateDepthWrite())}setDepthRange(e,t){this._state.depthRange.zNear===e&&this._state.depthRange.zFar===t||(this.gl.depthRange(e,t),this._state.depthRange.zNear=e,this._state.depthRange.zFar=t,this._stateTracker.invalidateDepthWrite())}setStencilTestEnabled(e){this._state.stencilTest!==e&&(e===!0?this.gl.enable(this.gl.STENCIL_TEST):this.gl.disable(this.gl.STENCIL_TEST),this._state.stencilTest=e,this._stateTracker.invalidateStencilTest())}setClearStencil(e){e!==this._state.clearStencil&&(this.gl.clearStencil(e),this._state.clearStencil=e)}setStencilFunction(e,t,r){this._state.stencilFunction.func===e&&this._state.stencilFunction.ref===t&&this._state.stencilFunction.mask===r||(this.gl.stencilFunc(e,t,r),this._state.stencilFunction.face=ig.FRONT_AND_BACK,this._state.stencilFunction.func=e,this._state.stencilFunction.ref=t,this._state.stencilFunction.mask=r,this._stateTracker.invalidateStencilTest())}setStencilFunctionSeparate(e,t,r,n){this._state.stencilFunction.face===e&&this._state.stencilFunction.func===t&&this._state.stencilFunction.ref===r&&this._state.stencilFunction.mask===n||(this.gl.stencilFuncSeparate(e,t,r,n),this._state.stencilFunction.face=e,this._state.stencilFunction.func=t,this._state.stencilFunction.ref=r,this._state.stencilFunction.mask=n,this._stateTracker.invalidateStencilTest())}setStencilWriteMask(e){this._state.stencilWriteMask!==e&&(this.gl.stencilMask(e),this._state.stencilWriteMask=e,this._stateTracker.invalidateStencilWrite())}setStencilOp(e,t,r){this._state.stencilOperation.face===ig.FRONT_AND_BACK&&this._state.stencilOperation.fail===e&&this._state.stencilOperation.zFail===t&&this._state.stencilOperation.zPass===r||(this.gl.stencilOp(e,t,r),this._state.stencilOperation.face=ig.FRONT_AND_BACK,this._state.stencilOperation.fail=e,this._state.stencilOperation.zFail=t,this._state.stencilOperation.zPass=r,this._stateTracker.invalidateStencilTest())}setStencilOpSeparate(e,t,r,n){this._state.stencilOperation.face===e&&this._state.stencilOperation.fail===t&&this._state.stencilOperation.zFail===r&&this._state.stencilOperation.zPass===n||(this.gl.stencilOpSeparate(e,t,r,n),this._state.stencilOperation.face=e,this._state.stencilOperation.fail=t,this._state.stencilOperation.zFail=r,this._state.stencilOperation.zPass=n,this._stateTracker.invalidateStencilTest())}setActiveTexture(e,t=!1){const r=this._state.activeTexture;return e>=0&&(t||e!==this._state.activeTexture)&&(this.gl.activeTexture(mA+e),this._state.activeTexture=e),r}clear(e){e&&this.gl.clear(e)}clearSafe(e,t=255){e&&(e&Oi.COLOR_BUFFER_BIT&&this.setColorMask(!0,!0,!0,!0),e&Oi.DEPTH_BUFFER_BIT&&this.setDepthWriteEnabled(!0),e&Oi.STENCIL_BUFFER_BIT&&this.setStencilWriteMask(t),this.gl.clear(e))}drawArrays(e,t,r){if(qd()&&(this._numOfDrawCalls++,this._numOfTriangles+=u7(e,r)),this.gl.drawArrays(e,t,r),qd()){const n=tk(this);n&&console.error("drawArrays:",n)}}drawElements(e,t,r,n){if(qd()&&(this._numOfDrawCalls++,this._numOfTriangles+=u7(e,t)),this.gl.drawElements(e,t,r,n),qd()){const s=tk(this);if(s){const a=this.getBoundVAO(),o=a==null?void 0:a.indexBuffer,l=a==null?void 0:a.vertexBuffers,c={indexBuffer:o,vertexBuffers:l},u={mode:e,count:t,type:r,offset:n},d=co(o,_=>_.size)??0,m=n+t,f=d<m?`. Buffer is too small. Attempted to draw index ${m} of ${d}`:"";console.error(`drawElements: ${s}${f}`,{args:u,vao:c})}}}logInfo(){qd()&&console.log(`DrawCalls: ${this._numOfDrawCalls}, Triangles: ${this._numOfTriangles}`)}resetInfo(){qd()&&(this._numOfDrawCalls=0,this._numOfTriangles=0)}get capabilities(){return this._capabilities}setViewport(e,t,r,n){r=Math.max(Math.round(r),1),n=Math.max(Math.round(n),1);const s=this._state.viewport;s.x===e&&s.y===t&&s.width===r&&s.height===n||(s.x=e,s.y=t,s.width=r,s.height=n,this.gl.viewport(e,t,r,n))}getViewport(){const e=this._state.viewport;return{x:e.x,y:e.y,width:e.width,height:e.height}}useProgram(e){var t;this._state.program!==e&&((t=this._state.program)==null||t.stop(),this._state.program=e,this.gl.useProgram((e==null?void 0:e.glName)??null))}bindTexture(e,t,r=!1){(t>=this.parameters.maxTextureImageUnits||t<0)&&console.error("Input texture unit is out of range of available units!");const n=this._state.textureUnitMap[t];return C(e)||e.glName==null?(y(n)&&(this.setActiveTexture(t,r),this.gl.bindTexture(n.descriptor.target,null)),this._state.textureUnitMap[t]=null,n):r||n!==e?(this.setActiveTexture(t,r),this.gl.bindTexture(e.descriptor.target,e.glName),e.applyChanges(),this._state.textureUnitMap[t]=e,n):(e.isDirty&&(this.setActiveTexture(t,r),e.applyChanges()),n)}unbindTexture(e){if(!C(e))for(let t=0;t<this.parameters.maxTextureImageUnits;t++)this._state.textureUnitMap[t]===e&&(this.bindTexture(null,t),this._state.textureUnitMap[t]=null)}bindFramebuffer(e,t=!1){if(t||this._state.readFramebuffer!==e||this._state.drawFramebuffer!==e){if(C(e))return this.gl.bindFramebuffer(Kl.FRAMEBUFFER,null),this._state.readFramebuffer=null,void(this._state.drawFramebuffer=null);e.initializeAndBind(Kl.FRAMEBUFFER),this._state.readFramebuffer=e,this._state.drawFramebuffer=e}}bindFramebufferSeparate(e,t,r=!1){const n=t===Kl.READ_FRAMEBUFFER,s=n?this._state.readFramebuffer:this._state.drawFramebuffer;(r||s!==e)&&(C(e)?this.gl.bindFramebuffer(t,null):e.initializeAndBind(t),n?this._state.readFramebuffer=Ke(e,null):this._state.drawFramebuffer=Ke(e,null))}blitFramebuffer(e,t,r=0,n=0,s=e.width,a=e.height,o=0,l=0,c=t.width,u=t.height,d=Oi.COLOR_BUFFER_BIT,m=Jt.NEAREST){this.bindFramebufferSeparate(e,Kl.READ_FRAMEBUFFER),this.bindFramebufferSeparate(t,Kl.DRAW_FRAMEBUFFER),this.gl.blitFramebuffer(r,n,s,a,o,l,c,u,d,m)}bindBuffer(e,t){if(e)switch(t??(t=e.bufferType),t){case $t.ARRAY_BUFFER:this._state.vertexBuffer=Ba(this.gl,e,t,this._state.vertexBuffer);break;case $t.ELEMENT_ARRAY_BUFFER:this._state.indexBuffer=Ba(this.gl,e,t,this._state.indexBuffer);break;case $t.UNIFORM_BUFFER:this._state.uniformBuffer=Ba(this.gl,e,t,this._state.uniformBuffer);break;case $t.PIXEL_PACK_BUFFER:this._state.pixelPackBuffer=Ba(this.gl,e,t,this._state.pixelPackBuffer);break;case $t.PIXEL_UNPACK_BUFFER:this._state.pixelUnpackBuffer=Ba(this.gl,e,t,this._state.pixelUnpackBuffer);break;case $t.COPY_READ_BUFFER:this._state.copyReadBuffer=Ba(this.gl,e,t,this._state.copyReadBuffer);break;case $t.COPY_WRITE_BUFFER:this._state.copyWriteBuffer=Ba(this.gl,e,t,this._state.copyWriteBuffer)}}bindRenderbuffer(e){const t=this.gl;e||(t.bindRenderbuffer(t.RENDERBUFFER,null),this._state.renderbuffer=null),this._state.renderbuffer!==e&&(t.bindRenderbuffer(t.RENDERBUFFER,e.glName),this._state.renderbuffer=e)}_getBufferBinding(e,t){if(t>=this.parameters.maxUniformBufferBindings||t<0)return console.error("Uniform buffer binding point is out of range!"),null;const r=this._state.uniformBufferBindingPoints;let n=r[t];return C(n)&&(n={buffer:null,offset:0,size:0},r[t]=n),n}bindBufferBase(e,t,r){const n=this._getBufferBinding(e,t);C(n)||n.buffer===r&&n.offset===0&&n.size===0||(this.gl.bindBufferBase(e,t,r?r.glName:null),n.buffer=r,n.offset=0,n.size=0)}bindBufferRange(e,t,r,n,s){const a=this._getBufferBinding(e,t);if(!C(a)&&!(a.buffer===r&&a.offset===n&&a.size===s)){if(n%this._parameters.uniformBufferOffsetAlignment!=0)return void console.error("Uniform buffer binding offset is not a multiple of the context offset alignment");this.gl.bindBufferRange(e,t,r.glName,n,s),a.buffer=r,a.offset=n,a.size=s}}bindUBO(e,t,r,n){C(t)?this.bindBufferBase($t.UNIFORM_BUFFER,e,null):(qd()&&(n??t.byteLength)>this._parameters.maxUniformBlockSize&&console.error("Attempting to bind more data than the maximum uniform block size"),t.initialize(),r!==void 0&&n!==void 0?this.bindBufferRange($t.UNIFORM_BUFFER,e,t.buffer,r,n):this.bindBufferBase($t.UNIFORM_BUFFER,e,t.buffer))}unbindUBO(e){for(let t=0,r=this._state.uniformBufferBindingPoints.length;t<r;t++){const n=this._state.uniformBufferBindingPoints[t];y(n)&&n.buffer===e.buffer&&this.bindBufferBase($t.UNIFORM_BUFFER,t,null)}}unbindBuffer(e){switch(e){case $t.ARRAY_BUFFER:this._state.vertexBuffer=Ba(this.gl,null,e,this._state.vertexBuffer);break;case $t.ELEMENT_ARRAY_BUFFER:this._state.indexBuffer=Ba(this.gl,null,e,this._state.indexBuffer);break;case $t.UNIFORM_BUFFER:this._state.uniformBuffer=Ba(this.gl,null,e,this._state.uniformBuffer);break;case $t.PIXEL_PACK_BUFFER:this._state.pixelPackBuffer=Ba(this.gl,null,e,this._state.pixelPackBuffer);break;case $t.PIXEL_UNPACK_BUFFER:this._state.pixelUnpackBuffer=Ba(this.gl,null,e,this._state.pixelUnpackBuffer);break;case $t.COPY_READ_BUFFER:this._state.copyReadBuffer=Ba(this.gl,null,e,this._state.copyReadBuffer);break;case $t.COPY_WRITE_BUFFER:this._state.copyWriteBuffer=Ba(this.gl,null,e,this._state.copyWriteBuffer)}}bindVAO(e=null){C(e)?this._state.vertexArrayObject&&(this._state.vertexArrayObject.unbind(),this._state.vertexArrayObject=null):this._state.vertexArrayObject!==e&&(e.bind(),this._state.vertexArrayObject=e)}async clientWaitAsync(e=It(10)){const t=this.gl,r=t.fenceSync(Yne.SYNC_GPU_COMMANDS_COMPLETE,0);if(!r)throw new Error("Client wait failed, could not create sync object");let n;this.instanceCounter.increment(Nb.Sync,r),t.flush();do await j0(e),n=t.clientWaitSync(r,0,0);while(n===Z5.TIMEOUT_EXPIRED);if(this.instanceCounter.decrement(Nb.Sync,r),t.deleteSync(r),n===Z5.WAIT_FAILED)throw new Error("Client wait failed")}getBoundFramebufferObject(e=Kl.FRAMEBUFFER){return e===Kl.READ_FRAMEBUFFER?this._state.readFramebuffer:this._state.drawFramebuffer}getBoundVAO(){return this._state.vertexArrayObject}resetState(){this.useProgram(null),this.bindVAO(null),this.bindFramebuffer(null,!0),this.unbindBuffer($t.ARRAY_BUFFER),this.unbindBuffer($t.ELEMENT_ARRAY_BUFFER),Ca(this.gl)&&(this.unbindBuffer($t.UNIFORM_BUFFER),this._state.uniformBufferBindingPoints.length=0,this.unbindBuffer($t.PIXEL_PACK_BUFFER),this.unbindBuffer($t.PIXEL_UNPACK_BUFFER),this.unbindBuffer($t.COPY_READ_BUFFER),this.unbindBuffer($t.COPY_WRITE_BUFFER));for(let e=0;e<this.parameters.maxTextureImageUnits;++e)this.bindTexture(null,e);this.setBlendingEnabled(!1),this.setBlendFunction(me.ONE,me.ZERO),this.setBlendEquation(Pw.ADD),this.setBlendColor(0,0,0,0),this.setFaceCullingEnabled(!1),this.setCullFace(ig.BACK),this.setFrontFace(rH.CCW),this.setPolygonOffsetFillEnabled(!1),this.setPolygonOffset(0,0),this.setScissorTestEnabled(!1),this.setScissorRect(0,0,this.gl.canvas.width,this.gl.canvas.height),this.setDepthTestEnabled(!1),this.setDepthFunction(hs.LESS),this.setDepthRange(0,1),this.setStencilTestEnabled(!1),this.setStencilFunction(hs.ALWAYS,0,0),this.setStencilOp(S0.KEEP,S0.KEEP,S0.KEEP),this.setClearColor(0,0,0,0),this.setClearDepth(1),this.setClearStencil(0),this.setColorMask(!0,!0,!0,!0),this.setStencilWriteMask(4294967295),this.setDepthWriteEnabled(!0),this.setViewport(0,0,this.gl.canvas.width,this.gl.canvas.height)}enforceState(){var n,s,a;const e=this.gl,t=this.capabilities.vao;t&&t.bindVertexArray(null);for(let o=0;o<this.parameters.maxVertexAttributes;o++)e.disableVertexAttribArray(o);if(this._state.vertexBuffer?e.bindBuffer(this._state.vertexBuffer.bufferType,this._state.vertexBuffer.glName):e.bindBuffer($t.ARRAY_BUFFER,null),this._state.indexBuffer?e.bindBuffer(this._state.indexBuffer.bufferType,this._state.indexBuffer.glName):e.bindBuffer($t.ELEMENT_ARRAY_BUFFER,null),Ca(e)){this._state.uniformBuffer?e.bindBuffer(this._state.uniformBuffer.bufferType,this._state.uniformBuffer.glName):e.bindBuffer($t.UNIFORM_BUFFER,null);for(let o=0;o<this._parameters.maxUniformBufferBindings;o++){const l=this._state.uniformBufferBindingPoints[o];if(y(l)){const{buffer:c,offset:u,size:d}=l;c!==null?u===0&&d===0?e.bindBufferBase($t.UNIFORM_BUFFER,o,c.glName):e.bindBufferRange($t.UNIFORM_BUFFER,o,c.glName,u,d):e.bindBufferBase($t.UNIFORM_BUFFER,o,null)}}this._state.pixelPackBuffer?e.bindBuffer(this._state.pixelPackBuffer.bufferType,this._state.pixelPackBuffer.glName):e.bindBuffer($t.PIXEL_PACK_BUFFER,null),this._state.pixelUnpackBuffer?e.bindBuffer(this._state.pixelUnpackBuffer.bufferType,this._state.pixelUnpackBuffer.glName):e.bindBuffer($t.PIXEL_UNPACK_BUFFER,null),this._state.copyReadBuffer?e.bindBuffer(this._state.copyReadBuffer.bufferType,this._state.copyReadBuffer.glName):e.bindBuffer($t.COPY_READ_BUFFER,null),this._state.copyWriteBuffer?e.bindBuffer(this._state.copyWriteBuffer.bufferType,this._state.copyWriteBuffer.glName):e.bindBuffer($t.COPY_WRITE_BUFFER,null),e.bindFramebuffer(Kl.READ_FRAMEBUFFER,null),e.readBuffer(e.BACK),this._state.readFramebuffer&&(e.bindFramebuffer(Kl.READ_FRAMEBUFFER,this._state.readFramebuffer.glName),e.readBuffer(Kne.COLOR_ATTACHMENT0)),e.bindFramebuffer(Kl.DRAW_FRAMEBUFFER,((n=this._state.drawFramebuffer)==null?void 0:n.glName)??null)}else this._state.readFramebuffer=this._state.drawFramebuffer,e.bindFramebuffer(Kl.FRAMEBUFFER,((s=this._state.drawFramebuffer)==null?void 0:s.glName)??null);if(t&&this._state.vertexArrayObject){const o=this._state.vertexArrayObject;this._state.vertexArrayObject&&(this._state.vertexArrayObject.unbind(),this._state.vertexArrayObject=null),this.bindVAO(o)}e.useProgram(((a=this._state.program)==null?void 0:a.glName)??null),e.blendColor(this._state.blendColor.r,this._state.blendColor.g,this._state.blendColor.b,this._state.blendColor.a),e.bindRenderbuffer(e.RENDERBUFFER,this._state.renderbuffer?this._state.renderbuffer.glName:null),this._state.blend===!0?e.enable(this.gl.BLEND):e.disable(this.gl.BLEND),e.blendEquationSeparate(this._state.blendEquation.mode,this._state.blendEquation.modeAlpha),e.blendFuncSeparate(this._state.blendFunction.srcRGB,this._state.blendFunction.dstRGB,this._state.blendFunction.srcAlpha,this._state.blendFunction.dstAlpha),e.clearColor(this._state.clearColor.r,this._state.clearColor.g,this._state.clearColor.b,this._state.clearColor.a),e.clearDepth(this._state.clearDepth),e.clearStencil(this._state.clearStencil),e.colorMask(this._state.colorMask.r,this._state.colorMask.g,this._state.colorMask.b,this._state.colorMask.a),e.cullFace(this._state.cullFace),e.depthFunc(this._state.depthFunction),e.depthRange(this._state.depthRange.zNear,this._state.depthRange.zFar),this._state.depthTest===!0?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),e.depthMask(this._state.depthWrite),e.frontFace(this._state.frontFace),e.lineWidth(1),this._state.faceCulling===!0?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),e.polygonOffset(this._state.polygonOffset[0],this._state.polygonOffset[1]),this._state.polygonOffsetFill===!0?e.enable(e.POLYGON_OFFSET_FILL):e.disable(e.POLYGON_OFFSET_FILL),e.scissor(this._state.scissorRect.x,this._state.scissorRect.y,this._state.scissorRect.width,this._state.scissorRect.height),this._state.scissorTest===!0?e.enable(e.SCISSOR_TEST):e.disable(e.SCISSOR_TEST),e.stencilFunc(this._state.stencilFunction.func,this._state.stencilFunction.ref,this._state.stencilFunction.mask),e.stencilOpSeparate(this._state.stencilOperation.face,this._state.stencilOperation.fail,this._state.stencilOperation.zFail,this._state.stencilOperation.zPass),this._state.stencilTest===!0?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),e.stencilMask(this._state.stencilWriteMask);for(let o=0;o<this.parameters.maxTextureImageUnits;o++){e.activeTexture(mA+o),e.bindTexture(bi.TEXTURE_2D,null),e.bindTexture(bi.TEXTURE_CUBE_MAP,null),Ca(e)&&(e.bindTexture(bi.TEXTURE_3D,null),e.bindTexture(bi.TEXTURE_2D_ARRAY,null));const l=this._state.textureUnitMap[o];y(l)&&e.bindTexture(l.descriptor.target,l.glName)}e.activeTexture(mA+this._state.activeTexture);const r=this._state.viewport;e.viewport(r.x,r.y,r.width,r.height),this.resetInfo()}_loadExtensions(){this.type===Nn.WEBGL1&&this.gl.getExtension("OES_element_index_uint"),this.gl.getExtension("KHR_parallel_shader_compile")}_loadParameters(e){const t=this.capabilities.textureFilterAnisotropic,r=e.maxAnisotropy??1/0,n=Ca(this.gl),s=this.gl,a={versionString:this.gl.getParameter(this.gl.VERSION),maxVertexTextureImageUnits:this.gl.getParameter(this.gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxVertexAttributes:this.gl.getParameter(this.gl.MAX_VERTEX_ATTRIBS),maxMaxAnisotropy:t?Math.min(this.gl.getParameter(t.MAX_TEXTURE_MAX_ANISOTROPY),r):1,maxTextureImageUnits:this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),maxTextureSize:this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE),maxUniformBufferBindings:n?s.getParameter(s.MAX_UNIFORM_BUFFER_BINDINGS):0,maxVertexUniformBlocks:n?s.getParameter(s.MAX_VERTEX_UNIFORM_BLOCKS):0,maxFragmentUniformBlocks:n?s.getParameter(s.MAX_FRAGMENT_UNIFORM_BLOCKS):0,maxUniformBlockSize:n?s.getParameter(s.MAX_UNIFORM_BLOCK_SIZE):0,uniformBufferOffsetAlignment:n?s.getParameter(s.UNIFORM_BUFFER_OFFSET_ALIGNMENT):1,maxArrayTextureLayers:n?s.getParameter(s.MAX_ARRAY_TEXTURE_LAYERS):1,maxSamples:n?s.getParameter(s.MAX_SAMPLES):1};return Gi.TEXTURE_UNIT_FOR_UPDATES=a.maxTextureImageUnits-1,a}};function Ba(i,e,t,r){return e?r!==e&&i.bindBuffer(t,e.glName):i.bindBuffer(t,null),e}function u7(i,e){switch(i){case kt.POINTS:return 2*e;case kt.TRIANGLES:return e/3;case kt.TRIANGLE_STRIP:case kt.TRIANGLE_FAN:return e-2;default:return 0}}let _$e=class extends g$e{constructor(e,t,r){super(e,t),this.newCache=r,this._refCount=1}dispose(){--this._refCount>0||super.dispose()}ref(){++this._refCount}bindTechnique(e,t,r,n){return this.useProgram(e.program),e.bindPipelineState(this,r==null?void 0:r.slot,n),e.program.bindPass(t,r),e.program}get test(){return this.programCache.test}},Fy=class extends pe{constructor(e,t,r){super({}),this._stage=e,this._techniqueRepository=t,this._rctx=r,this._textures=new Map,this._loadingCount=0,this._frameUpdates=new Map,this.events=new nn,this._frameTask=e.resourceController.scheduler.registerTask(dr.TEXTURE_UNLOAD)}normalizeCtorArgs(){return{}}dispose(){this._frameTask.remove(),this._stage.forEachOfType(vv.Texture,e=>e.unload())}get updating(){return this._loadingCount>0||this._frameTask.updating}get textureTechnique(){return C(this._textureTechnique)&&(this._textureTechnique=this._techniqueRepository.acquire(L4,new $4)),this._textureTechnique}acquire(e){const t=this._textures.get(e);return t?(t.ref(),Ke(t.loadingPromise,t)):this._createNewRef(e)}update(){let e=!1;this._frameUpdates.forEach(t=>{const r=t.texture.frameUpdate(this._rctx,this.textureTechnique,t.previousToken);r>=0&&r!==t.previousToken&&(t.previousToken=r,e=!0)}),e&&this.events.emit("changed",vr.BACKGROUND)}_createNewRef(e){const t=this._stage.getObject(e);if(C(t))return ct(t!==void 0),null;const r=t.events.on("unloaded",()=>{r.remove(),this._onTextureUnloaded(e)}),n=new y$e(e,()=>{this._frameTask.schedule(()=>{n.isUnreferenced&&t.unload()})});return this._textures.set(e,n),n.ref(),y(t.glTexture)?(this._updateGLTexture(n,t.glTexture),t.requiresFrameUpdates&&this._frameUpdates.set(e,{texture:t,previousToken:-1}),n):(this._loadingCount++,n.loadingPromise=this._stage.schedule(()=>{const s=t.load(this._rctx,()=>this.textureTechnique),a=l=>(this._loadingCount--,n.loadingPromise=null,this._updateGLTexture(n,l),t.requiresFrameUpdates&&this._frameUpdates.set(e,{texture:t,previousToken:-1}),n),o=l=>(this._loadingCount--,n.loadingPromise=null,yo(l)||ee.getLogger(this.declaredClass).error(l),null);return kx(s)?s.then(a,o):a(s)}),n.loadingPromise)}_updateGLTexture(e,t){e.glTexture=t,this.events.emit("changed",vr.UPDATE)}_onTextureUnloaded(e){this._textures.delete(e),this._frameUpdates.delete(e)}};h([p()],Fy.prototype,"_loadingCount",void 0),h([p()],Fy.prototype,"_frameTask",void 0),h([p()],Fy.prototype,"updating",null),Fy=h([F("esri.views.3d.webgl-engine.lib.TextureRepository")],Fy);let y$e=class{constructor(e,t){this.id=e,this._release=t,this._refCount=0}get isUnreferenced(){return this._refCount===0}ref(){++this._refCount}release(){--this._refCount,this._refCount>0||(this._refCount!==0?(ee.getLogger("esri.views.3d.webgl-engine.lib.TextureRepository.RefCountedTextureImpl").error("Cannot dereference texture that has no references!"),this._refCount=0):this._release())}};const v$e="esri.views.3d.webgl-engine.materials.internal.WaterTextureRepository";let Eb=class extends pe{constructor(){super(...arguments),this._passParameters=new b$e,this._loading=0}get passParameters(){return this._passParameters}dispose(){this._passParameters.waveNormal=ke(this._passParameters.waveNormal),this._passParameters.wavePertubation=ke(this._passParameters.wavePertubation)}get updating(){return this._loading>0}ensureResources(e){if(this._loading>0)return PS.LOADING;if(y(this._passParameters.waveNormal)&&y(this._passParameters.wavePertubation))return PS.LOADED;const t={target:bi.TEXTURE_2D,pixelFormat:St.RGBA,dataType:Xt.UNSIGNED_BYTE,wrapMode:ai.REPEAT,samplingMode:Jt.LINEAR_MIPMAP_LINEAR,hasMipmap:!0,maxAnisotropy:8};return++this._loading,Lg(wI("esri/images/materials/water/normals.jpg")).then(r=>this._passParameters.waveNormal=new Gi(e,{...t,width:r.width,height:r.height},r)).catch(r=>ee.getLogger(this.declaredClass).error("Failed to load water material normal texture.",r)).finally(()=>--this._loading),++this._loading,Lg(wI("esri/images/materials/water/perturbation.jpg")).then(r=>this._passParameters.wavePertubation=new Gi(e,{...t,width:r.width,height:r.height},r)).catch(r=>ee.getLogger(this.declaredClass).error("Failed to load water material pertubation texture.",r)).finally(()=>--this._loading),PS.LOADING}};h([p()],Eb.prototype,"_loading",void 0),h([p({type:Boolean,readOnly:!0})],Eb.prototype,"updating",null),Eb=h([F(v$e)],Eb);class b$e extends Ir{}let w$e=class{constructor(e,t){this.viewCamera=e,this.frameHasDecorations=t}},x$e=class extends GP{constructor(e,t,r,n){super(),this._rctx=e,this._renderFunctions=t,this._forceCameraHook=r,this._disposeOffscreenBuffers=n,this.supersample=!0,this._screenshotQueue=new Array}dispose(){this._rctx=null}async takeScreenshot(e){await this._renderFunctions.prepareOverlay(),this._renderFunctions.requestRenderScene(vr.BACKGROUND);const t=Vx();return this._screenshotQueue.push({settings:e,resolver:t}),t.promise}update(e,t){for(const r of this._screenshotQueue){if(this.isDisposed){r.resolver.reject();continue}const n={...r.settings,pixelRatio:r.settings.pixelRatio*e.viewCamera.pixelRatio},s=this._renderScreenshot(e,n,t);r.resolver(s)}this._screenshotQueue.length=0}_renderScreenshotOverlay(e,t,r){e.width=t.width,e.height=t.height;const n=e.getContext("2d"),s=r.pixelRatio;return n.save(),n.translate(0,t.height),n.scale(1,-1),r.region&&n.translate(-r.region.x,-r.region.y),n.scale(s,s),t=this._renderFunctions.renderOverlay(e,t),n.restore(),t}_readbackScreenshot(e,t){return e.resample?this._readbackScreenshotResampled(e,t):this._readbackScreenshotImmediate(e,t)}_readbackScreenshotResampled(e,t){const{framebufferWidth:r,framebufferHeight:n,region:s,resample:a}=e,o=this._ensureScreenshotEncodeCanvas();let l=fA(r,n,o);this._rctx.gl.readPixels(0,0,r,n,St.RGBA,dm.UNSIGNED_BYTE,new Uint8Array(l.data.buffer)),t(),l=this._renderScreenshotOverlay(o,l,{...e,region:null});const c=fA(s.width,s.height,o);return efe(l,c,!0,a.region.x,n-(a.region.y+a.region.height),a.region.width,a.region.height)}_readbackScreenshotImmediate(e,t){const{framebufferHeight:r,region:n}=e,s=this._ensureScreenshotEncodeCanvas(),a=fA(n.width,n.height,s);return this._rctx.gl.readPixels(n.x,r-(n.y+n.height),n.width,n.height,St.RGBA,dm.UNSIGNED_BYTE,new Uint8Array(a.data.buffer)),t(),this._renderScreenshotOverlay(s,a,e)}_renderScreenshot(e,t,r){let n=null,s=null;const a=e.viewCamera,{framebufferWidth:o,framebufferHeight:l}=t;let c=!1;const u=t.disableDecorations&&e.frameHasDecorations,d=o!==a.fullWidth||l!==a.fullHeight,m=t.ignorePadding&&a.pixelRatio!==t.pixelRatio,f=d||u||m||t.objectAndLayerIdColor;if(t.objectAndLayerIdColor&&(s=new yn(this._rctx,{width:o,height:l,colorTarget:Vn.TEXTURE,depthStencilTarget:rs.DEPTH_STENCIL_RENDER_BUFFER})),f){const v=a.clone();if(t.ignorePadding){const T=LD(v.padding);for(let R=0;R<4;R++)T[R]=Math.round(T[R]/v.pixelRatio*t.pixelRatio);v.padding=T}v.fullWidth=o,v.fullHeight=l,v.pixelRatio=t.pixelRatio;const b=a.fovX-v.fovX,x=a.fovY-v.fovY;b<0&&b<x?v.fovX=a.fovX:x<0&&x<b&&(v.fovY=a.fovY),this._forceCameraHook(v),c=!0,n=new yn(this._rctx,{width:v.fullWidth,height:v.fullHeight,colorTarget:Vn.TEXTURE,depthStencilTarget:rs.DEPTH_STENCIL_RENDER_BUFFER}),this._renderFunctions.renderScene(n,s,v,t.disableDecorations?Mw.OFF:Mw.ON,r),this._disposeOffscreenBuffers()}const _=()=>{this._rctx.bindFramebuffer(null),ke(n)},g=this._readbackScreenshot(t,_);_();let w=null;if(t.objectAndLayerIdColor){const v=()=>{this._rctx.bindFramebuffer(null),ke(s)};this._rctx.bindFramebuffer(s),w=this._readbackScreenshot(t,v),this._rctx.bindFramebuffer(null),v()}if(f&&!this._rctx.contextAttributes.alpha)for(let v=3;v<g.data.length;v+=4)g.data[v]=255;if(w&&!this._rctx.contextAttributes.alpha)for(let v=3;v<w.data.length;v+=4)w.data[v]=255;return c&&this._forceCameraHook(a),[g,w]}_ensureScreenshotEncodeCanvas(){return this._screenshotEncodeCanvas||(this._screenshotEncodeCanvas=document.createElement("canvas")),this._screenshotEncodeCanvas}},Pn=class extends BP(pe){constructor(e){super({}),this.events=new nn,this.waterTextureRepository=new Eb,this._magnifierHelper=new Dy,this._objectAndLayerIdRenderHelper=Ot("enable-feature:objectAndLayerId-rendering")?new gLe:null,this._needsUpdate=!0,this._needsRender=!0,this._idleSuspend=!0,this._needsWaterReflectionUpdate=!1,this._lastAnimationUpdate=0,this._container=e.container,this._viewingMode=e.viewingMode,this._initializeContext(e),B(()=>{var r;return(r=this.waterTextureRepository)==null?void 0:r.updating},()=>this.requestRender(),et),this._magnifierHelper.events.on("request-render",()=>this.requestRender()),this._stippleTextureRepository=new MH(this._rctx),this._shaderTechniqueRepository=new sK({rctx:this._rctx,viewingMode:e.viewingMode,stippleTextureRepository:this._stippleTextureRepository,waterTextureRepository:this.waterTextureRepository}),this._textureRepository=new Fy(e,this._shaderTechniqueRepository,this._rctx),this._textureRepository.events.on("changed",r=>this.requestRender(r)),this._materialRepository=new aK(this._textureRepository,this._shaderTechniqueRepository,()=>this.requestRender(),()=>this.requestRender()),this._compositingHelper=new XIe(this._rctx,this._shaderTechniqueRepository),this._renderer=new Hu(this._materialRepository,this._textureRepository,this._shaderTechniqueRepository,this._rctx,this._compositingHelper,this._magnifierHelper,r=>this.requestRender(r),(r,n)=>e.schedule(r,n),e);const t={renderScene:(r,n,s,a,o)=>this._renderer.render(r,n,{camera:s,contentCamera:s,mode:Fh.IDLE},a,o),requestRenderScene:r=>this.requestRender(r),prepareOverlay:()=>e.options.screenshot.prepareOverlay(),renderOverlay:(r,n)=>e.options.screenshot.renderOverlay(r,n)};this._screenshotManager=new x$e(this._rctx,t,r=>this.events.emit("force-camera-for-screenshot",r),()=>this._renderer.disposeOffscreenBuffers()),this._registerFrameTask(e)}normalizeCtorArgs(){return{}}dispose(){this._container.contains(this._canvas)&&this._container.removeChild(this._canvas),this._frameTask=Os(this._frameTask),this._shaderTechniqueRepository=ke(this._shaderTechniqueRepository),super.dispose(),this._tmpDepthBuffer=null,this._rctx=null}get performanceInfo(){const e=this._rctx.gl;return{renderer:this._renderer.performanceInfo,textureMemory:e.getUsedTextureMemory!==void 0?e.getUsedTextureMemory():void 0,renderbufferMemory:e.getUsedRenderbufferMemory!==void 0?e.getUsedRenderbufferMemory():void 0,VBOMemory:e.getUsedVBOMemory!==void 0?e.getUsedVBOMemory():void 0}}requestRender(e=vr.UPDATE){this._needsRender=!0,e===vr.UPDATE&&(this._needsUpdate=!0)}get updating(){return this._needsUpdate||this._needsWaterReflectionUpdate||this._renderer.updating||this._textureRepository.updating||this.waterTextureRepository.updating||this._magnifierHelper.updating}ensureEdgeView(){return this._renderer.ensureEdgeView()}get edgeView(){return this._renderer.edgeView}get textureRepository(){return this._textureRepository}get compositingHelper(){return this._compositingHelper}set magnifier(e){this._magnifierHelper.magnifier=e}setRenderParameters(e){e.idleSuspend!==void 0&&this._idleSuspend!==!!e.idleSuspend&&(this._idleSuspend=!!e.idleSuspend,this.requestRender()),this._renderer.setRenderParameters(e)}get renderingContext(){return this._rctx}get capabilities(){return this._rctx.capabilities}modify(e){this._renderer.modify(e),e.clear()}get canvas(){return this._canvas}takeScreenshot(e){return this._screenshotManager.takeScreenshot(e).then(t=>t[0])}takeScreenshotWithOID(e){return e.objectAndLayerIdColor=!0,this._screenshotManager.takeScreenshot(e)}getAlpha(){return this._rctx.contextAttributes.alpha}get shadowsEnabled(){return this._renderer.shadowsEnabled}readAccumulatedShadow(e){return this._renderer.readAccumulatedShadow(e[0],e[1])}readHUDVisibility(e,t,r,n,s){this._renderer.readHUDVisibility(e,t,r,n,s)}getMinimalDepthForArea(e,t,r,n,s,a=s){const o=n.constrainWindowSize(t,r,s*n.pixelRatio,a*n.pixelRatio),l=this._ensureDepthBuffer(o);this._renderer.readDepthPixels(n,o,l);let c=Number.MAX_VALUE;for(let u=0;u<o[2]*o[3];u++){const d=JIe(4*u,l,n.nearFar);c>d&&d!==n.nearFar[0]&&d!==n.nearFar[1]&&(c=d)}if(y(e)){const u=e.pickDepth(t*n.pixelRatio,r*n.pixelRatio,n);y(u)&&c>u&&u!==n.nearFar[0]&&u!==n.nearFar[1]&&(c=u)}return c===Number.MAX_VALUE?void 0:c}_ensureDepthBuffer(e){const t=4*e[2]*e[3];return(C(this._tmpDepthBuffer)||this._tmpDepthBuffer.byteLength<t)&&(this._tmpDepthBuffer=new Uint8Array(t)),this._tmpDepthBuffer}get renderPlugins(){return this._renderer.renderPlugins}get test(){return{renderer:this._renderer}}get gpuMemoryUsage(){return this._renderer.gpuMemoryUsage}async reloadShaders(){yJ(),await this._shaderTechniqueRepository.reloadAll(),this.requestRender()}get animationTimestep(){return this._renderer.animationTimestep}_registerFrameTask(e){const t=e.state;let r=!1,n=vr.BACKGROUND,s=!1;const a={preRender:({time:o})=>{r=this.updating,n=this._needsUpdate?vr.UPDATE:vr.BACKGROUND,e.processSyncLayers(),(o-this._lastAnimationUpdate>this.animationTimestep||y(t.forcedAnimationTime)||r||this._needsRender)&&(o=Ke(t.forcedAnimationTime,o),this._renderer.updateAnimation({camera:t.camera,time:o})&&this.requestRender(vr.BACKGROUND),this._lastAnimationUpdate=o)},render:({time:o})=>{if((this._needsRender||!this._idleSuspend||!this._renderer.isCameraFinal||this._needsWaterReflectionUpdate)&&t.camera.fullWidth>0&&t.camera.fullHeight>0){const l=this._needsUpdate&&this._idleSuspend&&this._renderer.isCameraFinal;this._needsRender=!1,this._needsUpdate=!1,this._needsWaterReflectionUpdate=!1,this._renderer.render(null,null,t,Mw.ON,o),s=!0,l&&this._renderer.hasWaterReflection&&(this.requestRender(vr.BACKGROUND),this._needsWaterReflectionUpdate=!0)}},update:({time:o})=>{const l=new w$e(t.camera,this._renderer.hasSlicePlane||this._magnifierHelper.enabled);this._textureRepository.update(),this._screenshotManager.update(l,o)},finish:()=>{s&&(this._renderer.finish(t.mode===Fh.IDLE?n:vr.UPDATE),s=!1)}};this._frameTask=wd(a)}_initializeContext(e){const t=e.options;this._canvas=t.canvas,this._canvas||(this._canvas=document.createElement("canvas")),this._canvas.setAttribute("style","width: 100%; height:100%; display:block;");const r={alpha:t.alpha||!1,premultipliedAlpha:!0,antialias:!1,depth:!0,stencil:t.stencil==null||t.stencil,powerPreference:"high-performance",preserveDrawingBuffer:t.preserveDrawingBuffer??!1},n=Pre("3d",this._canvas,r);if(C(n)){const s=Ot("esri-force-webgl");ee.getLogger(this.declaredClass).error(s)}else this._rctx=this._newRenderingContext(n,e),this._loadShaderOnlyExtensions(),!t.alpha&&this._rctx.contextAttributes.alpha&&ee.getLogger(this.declaredClass).error("WebGL context has alpha channel even though no alpha channel was requested"),!this._rctx.contextAttributes.alpha&&Ot("safari")>=11&&(this._container.style.backgroundColor="black"),this._container.appendChild(this._canvas)}_newRenderingContext(e,t){const r={disabledExtensions:t.options.deactivatedWebGLExtensions||{},debugWebGLExtensions:t.options.debugWebGLExtensions||{},maxAnisotropy:8},n=(s,a)=>t.resourceController.memoryController.newCache(s,a);return new _$e(e,r,n)}_loadShaderOnlyExtensions(){this._rctx.capabilities.enable("standardDerivatives"),this._rctx.capabilities.enable("shaderTextureLOD"),this._rctx.capabilities.enable("textureFloat")}_getObjectAndLayerIdColor(e){return this._objectAndLayerIdRenderHelper?this._objectAndLayerIdRenderHelper.getObjectAndLayerIdColor(e):null}get componentObjectCollection(){return C(this._componentObjectCollection)&&(this._componentObjectCollection=new kIe(this._renderer.renderPassManager,this._viewingMode)),this._componentObjectCollection}set componentObjectCollection(e){this._componentObjectCollection=e}};h([p({type:Boolean,readOnly:!0})],Pn.prototype,"updating",null),h([Yn()],Pn.prototype,"_rctx",void 0),h([Yn()],Pn.prototype,"_container",void 0),h([Yn()],Pn.prototype,"_canvas",void 0),h([Yn()],Pn.prototype,"_stippleTextureRepository",void 0),h([Yn(),p()],Pn.prototype,"waterTextureRepository",void 0),h([Yn(),p()],Pn.prototype,"_magnifierHelper",void 0),h([p()],Pn.prototype,"_objectAndLayerIdRenderHelper",void 0),h([Yn(),p()],Pn.prototype,"_textureRepository",void 0),h([Yn()],Pn.prototype,"_compositingHelper",void 0),h([Yn()],Pn.prototype,"_renderer",void 0),h([Yn()],Pn.prototype,"_screenshotManager",void 0),h([Yn()],Pn.prototype,"componentObjectCollection",null),h([Yn()],Pn.prototype,"_componentObjectCollection",void 0),h([p()],Pn.prototype,"_needsUpdate",void 0),h([p()],Pn.prototype,"_needsWaterReflectionUpdate",void 0),Pn=h([F("esri.views.3d.webgl-engine.parts.RenderView")],Pn);var PE;let ga=PE=class extends BP(pe){constructor(i){super(i),this._handles=new Vt,this._model=new CE,this._layers=new Yt,this._changeSet=new pK,this._layerSyncSet=new Set}initialize(){this._set("renderView",new Pn(this)),this._frameTask=this.resourceController.scheduler.registerTask(dr.STAGE,this),this._handles.add(this._frameTask)}destroy(){Wg.pool.prune(0),this._handles.destroy(),this.dispose()}get viewingMode(){return this.state.viewingMode}get updating(){return this._model.dirtySet.dirty||this.renderView.updating||this._frameTask.updating}add(i){this._model.add(i),uR(i)&&(i.attachStage(this),this._addLayer(i)),this.renderView.requestRender()}remove(i){C(i)||(this.renderView.requestRender(),this._model.remove(i),uR(i)&&(this._removeLayer(i),i.detachStage()))}addMany(i){y(i)&&(this._model.addMany(i),this.renderView.requestRender())}removeMany(i){y(i)&&(this._model.removeMany(i),this.renderView.requestRender())}async load(i){C(i)||(Array.isArray(i)||(i=[i]),await Promise.all(i.filter(e=>C(e.glTexture)).map(e=>this.schedule(()=>this._model.has(e)?e.load(this.renderView.renderingContext,()=>this.renderView.textureRepository.textureTechnique):null))))}loadImmediate(i){return i.load(this.renderView.renderingContext,()=>this.renderView.textureRepository.textureTechnique)}forEachOfType(i,e){this._model.forEachOfType(i,e)}handleEvent(i,e){this.destroyed||(this._model.dirtySet[i](e),this.renderView.requestRender())}get running(){return this._model.dirtySet.dirty}runTask(i){this._frameTask.processQueue(i),i.done||this._commit()}_commit(){const i=this._model.dirtySet;PE.DebugSettings.logDirtySet&&console.log("Dirty set: "+i.formatDebugInfo()),i.commit(this._changeSet),PE.DebugSettings.logDirtySet&&(console.log("RGs add: "+this._changeSet.adds.map(e=>e.id)),console.log("RGs remove: "+this._changeSet.removes.map(e=>e.id))),this._layerSyncSet.clear(),this.renderView.modify(this._changeSet),this.renderView.requestRender()}schedule(i,e){return this._frameTask.schedule(i,e)}syncLayer(i){this._layerSyncSet.add(i),this.renderView.requestRender()}processSyncLayers(){const i=this._model.dirtySet;this._layers.forAll(e=>{(this._layerSyncSet.has(e.id)||e.updatePolicy===QE.SYNC)&&(i.commitLayer(e.id,this._changeSet),this._layerSyncSet.delete(e.id))});for(const e of this._layerSyncSet)i.commitLayer(e,this._changeSet);this._layerSyncSet.clear(),this.renderView.modify(this._changeSet)}getObject(i){return this._model.getObject(i)}get layers(){return this._layers}_addLayer(i){this._layers.includes(i)||this._layers.push(i)}_removeLayer(i){this._commit(),this._layers.removeUnordered(i)!=null&&(this._model.dirtySet.getResidentRenderGeometries(i.id,this._changeSet.removes),this.renderView.modify(this._changeSet))}addRenderPlugin(i,e,t){const r=this.renderView.renderPlugins.add(i,e,t),n=()=>{Nz(e)&&this.sceneIntersectionHelper.addIntersectionHandler(e)};if(kx(r))return r.then(n);n()}removeRenderPlugin(i){Nz(i)&&this.sceneIntersectionHelper.removeIntersectionHandler(i),this.renderView.renderPlugins.remove(i)}get performanceInfo(){return{renderView:this.renderView.performanceInfo,model:this._model.getStats()}}get test(){const i=this;return{getCount:e=>i._model.test.content.filter(t=>t.type===e).length,model:i._model}}};ga.DebugSettings={endFrameContentValidation:!1,logDirtySet:!1},h([p({constructOnly:!0})],ga.prototype,"resourceController",void 0),h([p({constructOnly:!0})],ga.prototype,"options",void 0),h([p({constructOnly:!0})],ga.prototype,"state",void 0),h([p({constructOnly:!0})],ga.prototype,"sceneIntersectionHelper",void 0),h([p({readOnly:!0})],ga.prototype,"viewingMode",null),h([p({constructOnly:!0})],ga.prototype,"container",void 0),h([p({constructOnly:!0})],ga.prototype,"renderSR",void 0),h([p({constructOnly:!0})],ga.prototype,"_handles",void 0),h([p({readOnly:!0})],ga.prototype,"updating",null),h([p({constructOnly:!0})],ga.prototype,"_model",void 0),h([Yn(),p()],ga.prototype,"renderView",void 0),ga=PE=h([F("esri.views.3d.webgl-engine.Stage")],ga);function Jee(i){return hu(i)&&i.intersector===Ui.PCL&&!!i.target}function iA(i){return hu(i)&&i.intersector===Ui.I3S&&!!i.target}function T$e(i){return hu(i)&&i.intersector===Ui.TERRAIN&&!!i.target}function ete(i){return hu(i)&&i.intersector===Ui.OVERLAY&&!!i.target}function c5(i){return hu(i)&&i.intersector===Ui.LOD&&!!i.target}function d7(i,e){var t;return OP(i)||MP(i)?Lx(i.target.object.metadata,e):T$e(i)?(t=e.map)==null?void 0:t.ground:Jee(i)||iA(i)||ete(i)?Lx(i.target,e):null}function $je(i,e){const t=H$(i,e);return y(t)&&t.type==="graphic"?t.graphic:null}function H$(i,e){if(C(i))return null;if(OP(i)||MP(i))return p7(i.target.object.metadata,e);if(Jee(i)){const t=i.target.createGraphic();return{type:"graphic",graphic:t,layer:t.layer}}return ete(i)||c5(i)?p7(i.target,e):iA(i)?C$e(i.target,e):null}function p7(i,e){if(C(i)||C(i.graphicUid))return null;const t=Lx(i,e);if(C(t))return null;if(t===e.graphics)return C(e.graphicsView)||typeof i.graphicUid!="number"?null:e.graphicsView.getHit(i.graphicUid);const r=e.allLayerViews.find(n=>n.layer===t);return!r||r.suspended||C(i.graphicUid)?null:"getHit"in r?r.getHit(i.graphicUid):null}function C$e(i,e){const t=Lx(i,e);if(C(t))return null;const r=e.allLayerViews.find(n=>n.layer===t);return r&&!r.suspended&&"getGraphicFromIntersectorTarget"in r?E$e(r.getGraphicFromIntersectorTarget(i)):null}function S$e(i,e){const t=Lx(i,e);if(C(t))return null;const r=e.allLayerViews.find(n=>n.layer===t);return r&&!r.suspended&&"getAABBFromIntersectorTarget"in r?r.getAABBFromIntersectorTarget(i):null}function E$e(i){return y(i)?{type:"graphic",graphic:i,layer:i.layer}:null}function Lx(i,e){return C(i.layerUid)?null:y(e.graphicsView)&&i.layerUid===e.graphicsView.processor.layer.id?e.graphics:e.map.findLayerByUid(i.layerUid)}function Dje(i,e){if(OP(i)||MP(i))return AG(i.target.object.boundingVolumeWorldSpace.bounds);if(c5(i)){ene(fS,i.transformation);const t=Math.max(fS[0],fS[1],fS[2]);return i.target.baseBoundingSphere.radius*t}return iA(i)?co(S$e(i.target,e),t=>.5*xH(t)):null}function Fje(i){return!OP(i)&&!MP(i)&&(c5(i)?i.target.numLodLevels>1:!!iA(i))}const fS=P();async function R$e(i,e){if(i.type==="2d")return i.hitTest(e);const t=await i.hitTest(e);if(t.results.length===0)return t;const r=t.results[0],n=y(r.distance)?r.distance*(1+P$e):r.distance,s=t.results.findIndex(a=>a.distance>n);return s!==-1&&(t.results=t.results.slice(0,s)),t}const P$e=.05;let AE=class extends CX{constructor(e){super(e),this.components=["attribution","zoom","navigation-toggle","compass"]}};h([p()],AE.prototype,"components",void 0),AE=h([F("esri.views.ui.3d.DefaultUI3D")],AE);const tte=AE;let Ne=class extends sW(OW(MW(qW))){constructor(i){super(i),this._userClippingArea=null,this._clippingArea=null,this._initialDefaultSpatialReference=null,this._defaults={},this._externallySet={environment:!1},this._createGraphicsViewController=null,this._resolveWhenReady=[],this._propertiesPool=new Od({slicePlane:OQ},this),this._resourceController=WPe(this),this._defaultToMapOptions={include:new Set},this._defaultHitTestOptions={exclude:new Set},this.deconflictor=new a$({view:this}),this.labeler=new zf({view:this,deconflictor:this.deconflictor.labels}),this.sharedSymbolResources=null,this.analyses=new ov,this.basemapTerrain=null,this.elevationProvider=null,this.canvas=null,this.constraints=new eg,this.environmentManager=new sc,this.floors=new wt,this.fullOpacity=1,this.graphicsView=null,this.analysisViewManager=new w0e({view:this}),this.groundView=null,this.map=null,this.screenSizePerspectiveEnabled=!0,this.state=new xPe,this.spatialReference=null,this.alphaCompositingEnabled=!1,this.preserveDrawingBufferEnabled=!1,this.supersampleScreenshotsEnabled=!0,this.type="3d",this.ui=new tte,this._numUpdating=0,this._lastUpdateTime=0,this.updatingProgress=.5,this.highlightOptions=new x$,this.voxelWasm=null,this.voxelWasmPromise=null,Q7(),i&&i.environment||(this._defaults.environment=new Oy,this.environment=this._defaults.environment);const e=(t=null)=>{y(t)&&t.type===C5.MOVE||(this._updatingChanged(),this.map&&this.map.allLayers.forEach(async r=>{try{await r.when()}catch{}this._updatingChanged()}))};this.handles.add([wr(()=>{var t;return(t=this.map)==null?void 0:t.allLayers},"after-changes",t=>e(t),{onListenerAdd:()=>e(),onListenerRemove:()=>e(),sync:!0}),this.allLayerViews.on("after-changes",t=>this._updateUpdatingMonitors(t)),B(()=>this.map,t=>{t&&"load"in t&&t.load&&t.load().catch(()=>{})})]),this.inputManager=new Jxe({view:this}),this.stateManager=new Xr({view:this})}initialize(){this.groundView=new v0e({view:this}),this._updateUpdatingMonitors();const i=()=>this._updateDefaultToMapOptions();this.handles.add(wr(()=>{var e;return(e=this.map)==null?void 0:e.allLayers},"after-changes",i,{onListenerAdd:i,onListenerRemove:i})),this.updatingHandles.add(()=>this.qualitySettings.memoryLimit,e=>{this.resourceController&&(this.resourceController.memoryController.maxMemory=e)},et),this.updatingHandles.add(()=>this.qualitySettings.additionalCacheMemory,e=>{this.resourceController&&(this.resourceController.memoryController.additionalCacheMemory=e)},et),this.updatingHandles.add(()=>this.qualitySettings.frameRate,e=>fte(e>0?1e3/Math.ceil(e):0),et),this.updatingHandles.add(()=>{var e;return(e=this.map)==null?void 0:e.ground},i,Mi),this.updatingHandles.add(()=>{var e,t;return(t=(e=this.map)==null?void 0:e.ground)==null?void 0:t.opacity},()=>this._updateDefaultHitTestOptions(),Mi),this.handles.add(B(()=>this.spatialReference,()=>this.notifyChange("clippingArea"),ni))}destroy(){this.destroyed||(this.invalidate(),this.activeTool=null,this.layerViewManager.clear(),this._exitSurface(),this._disposeGraphicsView(),this.sharedSymbolResources=Oe(this.sharedSymbolResources),this._set("labeler",Oe(this.labeler)),this._set("deconflictor",Oe(this.deconflictor)),this._resourceController=Oe(this._resourceController),this._set("stateManager",Oe(this.stateManager)),this._set("inputManager",Oe(this.inputManager)),this.state.destroy(),this._propertiesPool.destroy(),this.handles.remove("updatingMonitors"),this._set("environmentManager",Oe(this.environmentManager)),this.groundView=Oe(this.groundView))}get renderSpatialReference(){return this.renderCoordsHelper&&this.renderCoordsHelper.spatialReference}get basemapSpatialReference(){var i;return(i=this.basemapTerrain)==null?void 0:i.spatialReference}get animation(){var i;return(i=this.state)==null?void 0:i.animation}get camera(){var i;return(i=this.stateManager)==null?void 0:i.camera}set camera(i){this.stateManager&&(this.stateManager.camera=i)}get contentCamera(){var i;return(i=this.stateManager)==null?void 0:i.contentCamera}set contentCamera(i){this.stateManager&&(this.stateManager.contentCamera=i)}installContentCameraReset(i={sticky:!1}){return this.stateManager.installContentCameraReset(i)}get center(){var i;return(i=this.stateManager)==null?void 0:i.center}set center(i){this.stateManager&&(this.stateManager.center=i)}get clippingArea(){if(this.viewingMode==="global")return null;let i=this._userClippingArea||this.get("map.clippingArea");return!(this._userClippingArea||this.get("map.clippingEnabled"))||C(i)?(this._clippingArea=null,null):i instanceof pi?this.spatialReference&&(i=gS(i,this.spatialReference),C(i))?(ee.getLogger(this.declaredClass).error("#clippingArea","setting clippingArea with incompatible SpatialReference"),this._clippingArea):(i=i.clone(),C(i.intersection(this._groundAndLayersExtent))&&(i.xmin=i.xmax,i.ymin=i.ymax),i.zmin=void 0,i.zmax=void 0,i.equals(this._clippingArea)||(this._clippingArea=i),this._clippingArea):(ee.getLogger(this.declaredClass).error("#clippingArea","only clippingArea geometries of type Extent are supported"),this._clippingArea)}set clippingArea(i){this.ready&&this.viewingMode==="global"&&y(i)?ee.getLogger(this.declaredClass).error("#clippingArea=","Clipping area is only supported in local viewingMode"):this._userClippingArea=i}get renderDataExtent(){if(this.state.viewingMode===Ie.Global)return null;const i=this.renderSpatialReference,e=this.dataExtent;return C(e)||C(i)||e.spatialReference.equals(i)?e:gS(e,i)}get dataExtent(){let i=this._groundAndLayersExtent;const e=this.spatialReference||Zt.WGS84,t=gS(this.clippingArea,e);y(t)&&(i=y(i)?i.intersection(t):t);const r=this._get("dataExtent");return y(i)&&i.equals(r)?r:i}get _groundAndLayersExtent(){const i=this.spatialReference||Zt.WGS84;let e;const t=s=>{const a=gS(s,i);C(a)||(y(e)?e.union(a):e=a.clone())},r=this.basemapTerrain;if(r!=null&&r.spatialReference){const s=r.groundExtent;t(new pi({xmin:s[0],ymin:s[1],zmin:0,xmax:s[2],ymax:s[3],zmax:0,spatialReference:r.spatialReference}))}if(this.map){const s=a=>{!y(a.fullExtent)||a.type==="graphics"&&a.internal||t(a.fullExtent)};this.map.allLayers.forEach(a=>s(a))}if(C(e))return null;e.hasZ?(e.zmin=Math.min(0,e.zmin),e.zmax=Math.max(0,e.zmax)):(e.zmin=0,e.zmax=0);const n=this._get("_groundAndLayersExtent");return e.equals(n)?n:e}set environment(i){i!==this._defaults.environment&&(this._externallySet.environment=!0),this._set("environment",i)}castEnvironment(i){return i?i instanceof Oy?i:i instanceof YQ?this.environment!=null?this.environment.cloneWithWebsceneEnvironment(i):Oy.fromWebsceneEnvironment(i):Nx(Oy,i):new Oy}get extent(){var i;return(i=this.stateManager)==null?void 0:i.extent}set extent(i){this.stateManager&&(this.stateManager.extent=i)}get screenCenter(){var i;return(i=this.stateManager)==null?void 0:i.screenCenter}get frustum(){var i;return(i=this.stateManager)==null?void 0:i.frustum}get initialExtentRequired(){return this.stateManager&&!this.stateManager.hasInitialView}get _defaultsFromMapSettings(){return{required:{tileInfo:!1,heightModelInfo:!0,extent:!1}}}get interacting(){return this.navigating||y(this.activeTool)}get stationary(){return!this.animation&&!this.resizing&&(C(this.state)||this.state.stationary)}get navigating(){var i;return((i=this.state)==null?void 0:i.navigating)??!1}get padding(){var i;return(i=this.stateManager)==null?void 0:i.padding}set padding(i){this.stateManager&&(this.stateManager.padding=i)}set qualityProfile(i){_E.isValidProfile(i)&&(_E.apply(i,this.qualitySettings),this._set("qualityProfile",i))}get qualityProfile(){return this._get("qualityProfile")||_E.getDefaultProfile()}set slicePlane(i){if(y(this._stage)&&this._stage.renderView.setRenderParameters({slicePlane:i}),C(i))return void this._set("slicePlane",null);const e=this._propertiesPool.get("slicePlane");c_(i,e),this._set("slicePlane",e)}get typeSpecificPreconditionsReady(){return!!this.viewingMode}get resolution(){return this.spatialReference!=null?lne(this.scale,this.spatialReference):0}get scale(){var i;return(i=this.stateManager)==null?void 0:i.scale}set scale(i){this.stateManager&&(this.stateManager.scale=i)}get heightModelInfo(){const i=this.getDefaultHeightModelInfo();return i!=null?Gx.deriveUnitFromSR(i,this.spatialReference):null}get updating(){var r,n,s;if(this.destroyed)return!1;let i=0,e=this.layerViewManager.updating,t=e?this.layerViewManager.updatingRemaining:0;this.allLayerViews.forEach(a=>{if(a.isFulfilled()){if(a.updating){if(e=!0,a.suspended||Ex(a))return;++t,i+=a.updatingProgress}}else++t});for(const a of[this.graphicsView,this.basemapView,this._resourceController,this._stage,this.featureTiles,this.pointsOfInterest,this.environmentManager,this.overlay,this._featureTreeDebugger,this.toolViewManager,this.analysisViewManager])y(a)&&a.updating&&(t+=.1,i+=.5*.1);for(const a of[this.deconflictor,this.labeler,this.basemapTerrain])y(a)&&a.updating&&(++t,i+=a.updatingProgress);if(e=!!(e||t>0||this.updatingHandles.updating||!this.ready||!this.stationary||this._createGraphicsViewController||(r=this.inputManager)!=null&&r.hasPendingInputs||(s=(n=this.map)==null?void 0:n.allLayers)!=null&&s.some(a=>!a.isFulfilled())),e?(this._numUpdating=Math.max(t,this._numUpdating),i+=this._numUpdating-t):this._numUpdating=0,this._numUpdating>0?i/=this._numUpdating:i=e?0:1,this._get("updatingProgress")!==i){const a=performance.now();if(i<1){const o=Math.min((a-this._lastUpdateTime)/2e3,1);i=this.updatingProgress*(1-o)+i*o}this._set("updatingProgress",i),this._lastUpdateTime=e&&i<1?a:0}return e}get viewingMode(){var t;const i=this._predeterminedViewingMode;if(y(i))return dA(i);const e=this.spatialReference;return e?y((t=this.defaultsFromMap)==null?void 0:t.viewingMode)&&e.equals(this.defaultsFromMap.spatialReference)?dA(this.defaultsFromMap.viewingMode):rR(e,Ie.Global)?"global":"local":"global"}set viewingMode(i){this.ready?ee.getLogger(this.declaredClass).error("#viewingMode","viewingMode cannot be set once view is ready"):this._overrideIfSome("viewingMode",i)}get viewpoint(){var i;return(i=this.stateManager)==null?void 0:i.viewpoint}set viewpoint(i){this.stateManager&&(this.stateManager.viewpoint=i)}get zoom(){var i;return(i=this.stateManager)==null?void 0:i.zoom}set zoom(i){this.stateManager&&(this.stateManager.zoom=i)}get resourceController(){return this._resourceController}get performanceInfo(){return new bAe(this)}on(i,e,t,r){return this.viewEvents.on(i,e,t,r)||super.on(i,e)}hasEventListener(i){return super.hasEventListener(i)||this.viewEvents.hasHandler(i)}toMap(i,e){if(!this.ready)return ee.getLogger(this.declaredClass).error("#toMap()","Scene view cannot be used before it is ready"),null;const t=e?this.externalToInternalIntersectOptions(e):this._defaultToMapOptions,r=y(t.graphics)&&(y(t.graphics.include)||y(t.graphics.exclude)),n=L2(i)?I2(this,i):i,s=Dh(n);t.enableDraped=t.include&&!t.include.has(Ac)||t.exclude&&t.exclude.has(Ac);const a=this.sceneIntersectionHelper,o=Xl(this.state.viewingMode);if(o.options.selectionMode=!0,o.options.store=r?zn.ALL:zn.MIN,a.intersectIntersectorScreen(s,o,t),r){for(const l of o.results.all){const c=H$(l,this);if(C(c))return this._intersectResultToMapPoint(l);if(c.type!=="graphic"||this._testGraphicUidFilter(t.graphics,c.graphic))return this._intersectResultToMapPoint(l)}return null}return this._intersectResultToMapPoint(o.results.min)}toScreen(i){if(!this.ready)return ee.getLogger(this.declaredClass).error("#toScreen()","Scene view cannot be used before it is ready"),null;const e=Ke(i.z==null&&Gh(this.elevationProvider,i),0);return bn(i,dy,this.renderSpatialReference,e),this.state.camera.projectToScreen(dy,hI),Rs(hI[0],hI[1])}pixelSizeAt(i){return this.ready?i?(bn(i,dy,this.renderSpatialReference),this.state.camera.computeScreenPixelSizeAt(dy)):0:(ee.getLogger(this.declaredClass).error("#pixelSizeAt()","Scene view cannot be used before it is ready"),null)}overlayPixelSizeInMapUnits(i){const e=this.basemapTerrain.overlayManager;return e?e.overlayPixelSizeInMapUnits(i):1}hitTest(i,e){if(!this.ready)return ee.getLogger(this.declaredClass).error("#hitTest()","Scene view cannot be used before it is ready"),null;const t=L2(i)?I2(this,i):i,r=zi(t.x,t.y),n=e?this.externalToInternalIntersectOptions(e):this._defaultHitTestOptions;n.requiresGroundFeedback=!0,n.enableDraped=!0;const s=Xl(this.state.viewingMode);s.options.selectionMode=!0,s.options.store=zn.ALL,this.sceneIntersectionHelper.intersectIntersectorScreen(r,s,n);const a=this._intersectResultsToHits(s.results.all,n.graphics),o=s.results.ground,l=d7(o,this),c=y(l)&&"type"in l&&l.type==="integrated-mesh"?l:null,u={screenPoint:t,results:a,ground:{mapPoint:this._intersectResultToMapPoint(o),distance:hu(o)?o.distanceInRenderSpace:0,layer:c}};return Wt.SCENEVIEW_HITTEST_RETURN_INTERSECTOR&&(u.intersector=s),Promise.resolve(u)}async popupHitTest(i){const{results:e,ground:t}=await R$e(this,i);let r=null;return!(e.length===0||Math.abs(Ke(e[0].distance,0)-t.distance)<1e-5)||t.layer&&t.layer.type==="integrated-mesh"||(r=t.mapPoint),{results:e,screenPoint:i,mapPoint:r}}goTo(i,e){return this.updatingHandles.addPromise(this.stateManager.goTo(i,e))}async whenAnalysisView(i){if(C(i.parent))throw new J("view:no-analysisview-for-analysis","The analysis has not been added to view.analyses",{analysis:i});switch(i.parent.type){case"line-of-sight":case"dimension":return(await this.whenLayerView(i.parent)).whenAnalysisView();default:return this.analysisViewManager.whenAnalysisView(i)}}whenLayerView(i){return super.whenLayerView(i)}async takeScreenshot(i){const e=this._completeSettings(i);await this.whenReady();const t=await this._stage.renderView.takeScreenshot(e);return YS(t,e,this._pixelFormat())}async _takeScreenshot(i){const e=this._completeSettings(i);await this.whenReady();const t=await this._stage.renderView.takeScreenshot(e);return pX(t,this._pixelFormat())}_completeSettings(i){const e=Qme(i,this);return e.pixelRatio/=this.state.pixelRatio,tfe(e,this.supersampleScreenshotsEnabled,this.padding)}_pixelFormat(){return{flipY:!0,premultipliedAlpha:this._stage.renderView.getAlpha()}}get test(){return{takeScreenshot:i=>this._takeScreenshot(i)}}async takeScreenshotWithObjectAndLayerId(i){if(!Ot("enable-feature:objectAndLayerId-rendering"))throw new Error("has enable-feature:objectAndLayerId-rendering must be true");const e=this._completeSettings(i);await this.whenReady();const t=await this._stage.renderView.takeScreenshotWithOID(e),r=YS(t[0],e,this._pixelFormat()),n=this._completeSettings(i);return n.format="png",[r,YS(t[1],n,this._pixelFormat())]}getColorToObjectAndLayerIdMapping(){if(!Ot("enable-feature:objectAndLayerId-rendering"))throw new Error("has enable-feature:objectAndLayerId-rendering must be true");return this._stage.renderView._objectAndLayerIdRenderHelper.getColorToObjectAndLayerIdMapping()}addUpdatingPromise(i){return this.updatingHandles.addPromise(i)}importLayerView(i){return O6.importLayerView(i)}hasLayerViewModule(i){return O6.hasLayerViewModule(i)}forceDOMReadyCycle(){this.forceReadyCycle()}getDefaultSpatialReference(){var i,e,t,r;return this.map&&"initialViewProperties"in this.map&&((e=(i=this.map)==null?void 0:i.initialViewProperties)==null?void 0:e.spatialReference)||((t=this.defaultsFromMap)==null?void 0:t.spatialReference)||((r=this.defaultsFromMap)==null?void 0:r.ready)&&this._initialDefaultSpatialReference||null}async validate(){let i=yX(this.type);if(Ot("safari")&&Ot("safari")<9&&(i=new J("sceneview:browser-not-supported","This browser is not supported by SceneView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:Ot("safari")})),y(i))throw ee.getLogger(this.declaredClass).warn("#validate()",i.message),i}get _predeterminedViewingMode(){var e;const i=this._isOverridden("viewingMode")?this._get("viewingMode"):(this.map&&"initialViewProperties"in this.map?(e=this.map.initialViewProperties)==null?void 0:e.viewingMode:null)??null;return y(i)?I5(i):null}getSpatialReferenceSupport({spatialReference:i,layer:e}){const t=this._predeterminedViewingMode;if(y(t))return this._validateSpatialReferenceForViewingMode(i,e,t)?{constraints:this._makeSpatialReferenceConstraints(i,e,t)}:null;const r=this._validateSpatialReferenceForViewingMode(i,e,Ie.Local),n=this._validateSpatialReferenceForViewingMode(i,e,Ie.Global);return r||n?r&&n?{constraints:this._makeSpatialReferenceConstraints(i,e,null)}:r?{constraints:this._makeSpatialReferenceConstraints(i,e,Ie.Local)}:{constraints:this._makeSpatialReferenceConstraints(i,e,Ie.Global)}:null}_validateSpatialReferenceForViewingMode(i,e,t){return!!rR(i,t)&&(!!C(e)||!!B5(e)||(!Fb(e)||!C(QP(e,i,t)))&&(!G5(e)||t!==Ie.Global))}_makeSpatialReferenceConstraints(i,e,t){if(C(e))return[{spatialReference:i,viewingMode:t}];const r=i.isWebMercator,n=i.isWGS84;return B5(e)&&(r||n)?!n||t===Ie.Local||W4(e.tileInfo,e.fullExtent,i,Ie.Global)===null?[{spatialReference:i,viewingMode:t},{spatialReference:Zt.WebMercator,viewingMode:t}]:[{spatialReference:r?Zt.WGS84:Zt.WebMercator,viewingMode:t}]:Fb(e)||G5(e)||!r&&!n?Fb(e)&&r&&t!==Ie.Global?[{spatialReference:i,viewingMode:t},{spatialReference:Zt.WGS84,viewingMode:Ie.Local}]:[{spatialReference:i,viewingMode:t}]:[{spatialReference:i,viewingMode:t},{spatialReference:r?Zt.WGS84:Zt.WebMercator,viewingMode:t}]}_validateSpatialReference(i){const e=y(this.getSpatialReferenceSupport({spatialReference:i})),t=this._predeterminedViewingMode;return e||(y(t)?ee.getLogger(this.declaredClass).warnOnce(`Spatial reference defined on view not supported in ${dA(t)} viewing mode.`):i.isGeographic&&ee.getLogger(this.declaredClass).warnOnce("Spatial reference is geographic but not supported.")),e}whenReady(){return new Promise(i=>{this.ready?i(this):this._resolveWhenReady.push(i)})}computeMapPointFromVec3d(i,e){let t=this.spatialReference||Zt.WGS84;return ss(i,this.renderSpatialReference,i,t)||(t=Zt.WGS84,ss(i,this.renderSpatialReference,i,t)),e?(e.x=i[0],e.y=i[1],e.z=i[2],e.spatialReference=t):e=new He(i,t),e}trackGraphicState(i){if(!i.graphic)return ee.getLogger(this.declaredClass).error("trackGraphicState","GraphicState.graphic must not be null or undefined to start tracking"),null;const e=this.getViewForGraphic(i.graphic);let t=null,r=!1;const n=s=>{var a;!r&&y(s)&&"processor"in s&&((a=s.processor)==null?void 0:a.type)==="graphics-3d"&&s.processor.graphicsCore&&(t=s.processor.graphicsCore.trackGraphicState(i))};return y(e)?n(e):this.whenViewForGraphic(i.graphic,{waitForLayer:!0}).then(s=>n(s),()=>{}).catch(()=>{}),{remove:()=>{r=!0,y(t)&&(t.remove(),t=null)}}}highlight(i){if(Array.isArray(i))return x5(i.map(t=>this.highlight(t)));if(wt.isCollection(i))return x5(i.toArray().map(t=>this.highlight(t)));const e=this.getViewForGraphic(i);return e&&"highlight"in e?e.highlight(i):fw()}maskOccludee(i){if(!i)return ee.getLogger(this.declaredClass).error("maskOccludee","GraphicState.graphic must not be null or undefined to mask an occludee"),null;const e=this.getViewForGraphic(i);let t=null,r=!1;const n=s=>{!r&&y(s)&&Yde(s)&&(t=s.maskOccludee(i))};return y(e)?n(e):this.whenViewForGraphic(i,{waitForLayer:!0}).then(s=>n(s),()=>{}).catch(()=>{}),{remove:()=>{r=!0,y(t)&&(t.remove(),t=null)}}}getViewForGraphic(i){return i.layer===this.graphics?this.graphicsView:i.layer?this.allLayerViews.find(e=>e.layer===i.layer):null}graphicChanged(i){y(this.graphicsView)&&this.graphicsView.graphicChanged(i)}async whenViewForGraphic(i,e){if(i.layer===this)return await Pm(()=>this.graphicsView),this.graphicsView;if(!i.layer||!this.map)throw new J("no-view-for-graphic");return e&&e.waitForLayer&&!this.map.allLayers.includes(i.layer)?new Promise((t,r)=>{const n=this.map.allLayers.on("change",s=>{s.added.includes(i.layer)&&(n.remove(),this.whenLayerView(i.layer).then(t,r))})}):this.whenLayerView(i.layer)}externalToInternalIntersectOptions(i){const e=this._externalToInternalRenderItems(i.include,pw.INCLUDE),t=this._externalToInternalRenderItems(i.exclude,pw.EXCLUDE);return{include:e.layerUids,exclude:t.layerUids,graphics:{include:e.graphicUids,exclude:t.graphicUids}}}_intersectResultToMapPoint(i,e){return i.getIntersectionPoint(dy)?(e=this.computeMapPointFromVec3d(dy,e),i.intersector===Ui.TERRAIN&&this.basemapTerrain&&(e.z=Ke(Gh(this.basemapTerrain,e),0)),e):null}_intersectResultsToHits(i,e){const t=new Array;let r=null;for(let n=0;n<i.length;n++){const s=i[n],a=d7(s,this);if(y(a)&&(a===this.map.ground||"type"in a&&a.type==="integrated-mesh"))break;const o=H$(s,this);if(C(o))continue;if(o.type==="graphic"){if(C(r)&&n!==i.length-1&&(r=new Set),y(r)){const u=this._getGraphicFilterUid(o.graphic);if(r.has(u))continue;r.add(u)}if(!this._testGraphicUidFilter(e,o.graphic))continue}const l=this._intersectResultToMapPoint(s),c=s.distanceInRenderSpace;t.push({...o,mapPoint:l,distance:c})}return t}_getGraphicFilterUid(i){const e=i.sourceLayer,t=i.layer,r=e&&"objectIdField"in e?e:t&&"objectIdField"in t?t:e;if(r){const n=r.objectIdField??SW,s=i.attributes[n];if(s)return`o-${r.id}-${s}`}return`u-${i.uid}`}_testGraphicUidFilter(i,e){const t=this._getGraphicFilterUid(e);return C(i)||(C(i.include)||i.include.has(t))&&(C(i.exclude)||!i.exclude.has(t))}_externalToInternalRenderItems(i,e,t={layerUids:null,graphicUids:null}){if(!i)return t;if(i instanceof jc)A$e(t,this._getGraphicFilterUid(i)),e===pw.INCLUDE&&(y(this.graphicsView)&&i.layer===this?F1(t,this.graphicsView.processor.layer.id):i.layer&&F1(t,i.layer.uid));else if(dI(i))for(const r of i)r===this.graphics&&y(this.graphicsView)?F1(t,this.graphicsView.processor.layer.id):r===this.map.ground?F1(t,Ac):this._externalToInternalRenderItems(r,e,t);else"uid"in i&&F1(t,i.uid);return t}_initBasemapTerrain(){this._set("basemapTerrain",new QMe({view:this})),this._set("elevationProvider",new vb({view:this})),this.elevationProvider.register("ground",this.basemapTerrain)}_exitBasemapTerrain(){this.basemapTerrain&&(this.elevationProvider.unregister(this.basemapTerrain),this.elevationProvider.destroy(),this._set("elevationProvider",null),this.basemapTerrain.destroy(),this._set("basemapTerrain",null))}_initGlobe(){this._initCoordinateSystem(),this.state.createInitialCamera(),this._initBasemapTerrain(),this._set("pointsOfInterest",new vs({view:this})),this._set("featureTiles",new Mn({renderCoordsHelper:this.renderCoordsHelper,cameraOnSurface:this.pointsOfInterest.contentCameraOnSurface,focus:this.pointsOfInterest.focus,tilingSchemeOwner:this.basemapTerrain,viewState:this.state,scheduler:this._resourceController.scheduler,terrain:this.basemapTerrain}));const i=()=>{var t;const e=(t=this.basemapTerrain)==null?void 0:t.extent;if(this.clippingArea||e)if(e&&this.basemapTerrain.spatialReference){const r=y(this.basemapTerrain.extent)&&y(this.basemapTerrain.spatialReference)?Dd(TG(this.basemapTerrain.extent,this.basemapTerrain.spatialReference),this.spatialReference):null;y(this.clippingArea)?this.featureTiles.filterExtent=this.clippingArea.intersection(r):this.featureTiles.filterExtent=r}else this.featureTiles.filterExtent=this.clippingArea;else this.featureTiles.filterExtent=null};this.handles.add([this.updatingHandles.add(()=>Wt.FEATURE_TILE_TREE_SHOW_TILES,e=>{e&&this.featureTiles&&!this._featureTreeDebugger?this.updatingHandles.addPromise(j(()=>import("./FeatureTileTree3DDebugger-e86d4e2f.js"),["assets/FeatureTileTree3DDebugger-e86d4e2f.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/reactiveUtils-4dabbb80.js","assets/HandleOwner-9b396af1.js","assets/TileTreeDebugger-36d5c9d2.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js"])).then(({FeatureTileTree3DDebugger:t})=>{!this._featureTreeDebugger&&Wt.FEATURE_TILE_TREE_SHOW_TILES&&(this._featureTreeDebugger=new t({view:this}))}):e||!this._featureTreeDebugger||Wt.FEATURE_TILE_TREE_SHOW_TILES||(this._featureTreeDebugger.destroy(),this._featureTreeDebugger=null)},Mi),this.updatingHandles.add(()=>this.clippingArea,i,Mi),this.updatingHandles.add(()=>this.basemapTerrain.extent,i,Mi)],"feature-tiles"),this.stateManager.init()}_exitGlobe(){this.state&&(this.stateManager.exit(),this.handles.remove("render-coords-helper"),this.handles.remove("feature-tiles"),this.featureTiles.destroy(),this._set("featureTiles",null),this.pointsOfInterest.destroy(),this._set("pointsOfInterest",null),this._exitBasemapTerrain(),this.state.exit(),this._exitCoordinateSystem())}_initCoordinateSystem(){if(this.spatialReference){const i=this.spatialReference;this.mapCoordsHelper&&this.mapCoordsHelper.spatialReference.equals(i)||this._set("mapCoordsHelper",new APe(this.map,i));const e=this.state.isGlobal,t=HQ(e,i);t!==this.renderSpatialReference&&(this._set("renderCoordsHelper",LPe.create(this.state.viewingMode,t)),e||this.handles.add(B(()=>{var r;return(r=this.basemapTerrain)==null?void 0:r.extent},r=>{const n=this.renderCoordsHelper.spatialReference;r&&(r[0]!==0||r[1]!==0||r[2]!==0||r[3]!==0)&&AR(r,this.basemapTerrain.spatialReference,m7,n)&&(this.renderCoordsHelper.extent=m7)},ni),"render-coords-helper"),this.sceneIntersectionHelper&&this.sceneIntersectionHelper.setTolerance(lv/this.renderCoordsHelper.unitInMeters))}else this._set("mapCoordsHelper",null),this._set("renderCoordsHelper",null)}_exitCoordinateSystem(){this.mapCoordsHelper&&(this.handles.remove("render-coords-helper"),this._set("renderCoordsHelper",null),this._set("mapCoordsHelper",null))}_updatingChanged(){this.notifyChange("updating")}_updateUpdatingMonitors(i=null){y(i)&&i.type===C5.MOVE||(this.handles.remove("updatingMonitors"),this.allLayerViews.forEach(e=>{e.destroyed||(this.handles.add(B(()=>[e.updating,e.updatingProgress],()=>this._updatingChanged(),ni),"updatingMonitors"),e.when(()=>this._updatingChanged(),()=>this._updatingChanged()))}),this._updatingChanged())}async _prepareScreenshotOverlay(){this.overlay&&await this.overlay.prepare()}_renderScreenshotOverlay(i,e){if(!this.overlay||!this.overlay.hasVisibleItems)return e;const t=i.getContext("2d");return t.putImageData(e,0,0),this.overlay.renderCanvas(i),t.getImageData(0,0,e.width,e.height)}_initStage(){const i={deactivatedWebGLExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions,alpha:this.alphaCompositingEnabled,preserveDrawingBuffer:this.preserveDrawingBufferEnabled,canvas:this.renderCanvas,screenshot:{prepareOverlay:()=>this._prepareScreenshotOverlay(),renderOverlay:(o,l)=>this._renderScreenshotOverlay(o,l)}},e=new TPe(this.state.viewingMode,o=>this._stage.layers.forAll(o),this);this._set("sceneIntersectionHelper",e);const t=uD(this.surface),{resourceController:r,state:n,renderSpatialReference:s}=this;this._stage=new ga({options:i,container:t,resourceController:r,state:n,sceneIntersectionHelper:e,renderSR:s}),this._stage.renderView.setRenderParameters({slicePlane:this.slicePlane}),this._lostWebGLContextHandle=qte(this._stage.renderView.canvas,"webglcontextlost",()=>this.fatalError=new J("webgl-context-lost")),this.handles.add([this.updatingHandles.add(()=>this.qualitySettings.antialiasingEnabled,()=>this._stage.renderView.setRenderParameters({antialiasingEnabled:this.qualitySettings.antialiasingEnabled}),et),this.updatingHandles.add(()=>this.qualitySettings.highQualityTransparency,()=>this._stage.renderView.setRenderParameters({highQualityTransparency:this.qualitySettings.highQualityTransparency}),et),B(()=>this.magnifier,o=>this._stage.renderView.magnifier=o,Mi)],"stage");const a=()=>{this._stage.renderView.setRenderParameters({defaultHighlightOptions:x$.toEngineOptions(this.highlightOptions)})};this.handles.add(this.updatingHandles.add(()=>[this.highlightOptions.color,this.highlightOptions.haloColor,this.highlightOptions.haloOpacity,this.highlightOptions.fillOpacity,this.highlightOptions.shadowOpacity,this.highlightOptions.shadowColor,this.highlightOptions.shadowDifference],a),"stage"),a(),this.renderCoordsHelper&&this.sceneIntersectionHelper.setTolerance(lv/this.renderCoordsHelper.unitInMeters),this._set("canvas",this._stage.renderView.canvas)}_exitStage(){this._set("sceneIntersectionHelper",null),this._stage.destroy(),this._stage=null,this._lostWebGLContextHandle.remove(),this._lostWebGLContextHandle=null,this.handles.remove("stage"),this._set("canvas",null)}_initSurface(i){this._exitSurface(),this.state.init(i,this.spatialReference),this._initStage(),this._initGlobe(),this.sharedSymbolResources=new TAe({view:this,viewingMode:i,resourceController:this._resourceController,pointsOfInterest:this.pointsOfInterest,viewState:this.state})}_exitSurface(){this.sharedSymbolResources&&(this.sharedSymbolResources.objectResourceCache.destroy(),this.sharedSymbolResources.destroy(),this.sharedSymbolResources=null,this._exitGlobe(),this._exitStage())}_createGraphicsViewIfNeeded(){if(this.graphicsView||this._createGraphicsViewController||this.graphics.length===0)return;this.handles.remove("graphics-view"),this._createGraphicsViewController=new AbortController;const i=()=>{this._createGraphicsViewController=null,this._updatingChanged()};this._createGraphicsViewAsync(this._createGraphicsViewController.signal).then(i,i),this._updatingChanged()}async _createGraphicsViewAsync(i){const e=(await j(()=>import("./GraphicsView3D-4d364982.js"),["assets/GraphicsView3D-4d364982.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Identifiable-bfe1ff30.js","assets/GraphicsProcessor-220bbf91.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/preload-helper-3bce6601.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/request-6fc81c4c.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/HandleOwner-9b396af1.js","assets/reactiveUtils-4dabbb80.js","assets/diffUtils-68b89c71.js","assets/Layer-5ffe0eda.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Graphics3DObjectStates-56cfe062.js","assets/UniqueValueRenderer-08f8851c.js","assets/LegendOptions-010d0873.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/unitUtils-45d1147c.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/jsonUtils-f5674613.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/MemCache-18a255ed.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/projection-290b739f.js","assets/mat4-44a0988f.js","assets/assets-8d3e737a.js","assets/zscale-89472cba.js","assets/dehydratedFeatures-0557137d.js","assets/byteSizeEstimations-f0cab514.js","assets/quantizationUtils-4dd81f85.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OptimizedFeature-4ab8d380.js","assets/optimizedFeatureQueryEngineAdapter-d72f082e.js","assets/centroid-5c988df3.js","assets/asyncUtils-437defc4.js","assets/PooledRBush-3e149119.js","assets/quickselect-322ec8e1.js","assets/ElevationInfo-215614d8.js","assets/basicInterfaces-19ed850e.js","assets/Scheduler-540208b6.js","assets/GraphicsView-d3b9d029.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/RelationshipQuery-0dda77ad.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"])).default;Ti(i),await Pm(()=>{var t;return(t=this.basemapTerrain)==null?void 0:t.ready},i),this._set("graphicsView",new e({view:this}))}_disposeGraphicsView(){this._createGraphicsViewController&&(this._createGraphicsViewController.abort(),this._createGraphicsViewController=null),this.handles.remove("graphics-view"),y(this.graphicsView)&&(this.handles.remove(this.graphicsView.processor.layer.id),this.graphicsView.destroy(),this._set("graphicsView",null))}_startup(){const i=I5(this.viewingMode);if(i===Ie.Global&&(this._clippingArea=null),this._initSurface(i),this._set("ready",!0),this.handles.add(wr(()=>this.graphics,"after-changes",()=>this._createGraphicsViewIfNeeded()),"graphics-view"),this._createGraphicsViewIfNeeded(),!this._externallySet.environment){const t=this.get("map.initialViewProperties.environment");t&&(this.environment=t)}this.labeler.setup(),this.environmentManager.connectView(this),this.inputManager.connect();const e=this._resolveWhenReady;this._resolveWhenReady=[],e.forEach(t=>t(this))}_teardown(){this._initialDefaultSpatialReference=null,this.inputManager.disconnect(),this.environmentManager.disconnectView(),this.labeler.dispose(),this._disposeGraphicsView(),this.handles.remove("graphics-view"),this._exitSurface(),this._set("ready",!1)}_updateDefaultToMapOptions(){if(this._defaultToMapOptions.include.clear(),this.map){this.map.ground&&this._defaultToMapOptions.include.add(Ac);for(const i of this.map.allLayers.items)i.type==="integrated-mesh"&&this._defaultToMapOptions.include.add(i.uid)}}_updateDefaultHitTestOptions(){if(this._defaultHitTestOptions.exclude.clear(),this.map){this.map.ground&&this.map.ground.opacity<1&&this._defaultHitTestOptions.exclude.add(Ac);for(const i of this.map.allLayers.items)i.type==="integrated-mesh"&&i.opacity<1&&this._defaultToMapOptions.exclude.add(i.uid)}}addVoxelLayerViewToWasm(i){return C(this.voxelWasm)?(C(this.voxelWasmPromise)&&(this.voxelWasmPromise=j(()=>import("./VoxelWasmPerSceneView-b4e1dc7a.js"),["assets/VoxelWasmPerSceneView-b4e1dc7a.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/typedArrayUtil-4d7bb04c.js","assets/promiseUtils-1e54421e.js","assets/reactiveUtils-4dabbb80.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/Octree-0a267ea2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/sphere-2af0d852.js","assets/mathUtils-b4bb77e2.js","assets/vec4-790471c0.js","assets/mat4-44a0988f.js","assets/vec4f64-e407da96.js","assets/byteSizeEstimations-f0cab514.js","assets/mat3f64-c6305894.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/vec2f64-30dc1443.js","assets/plane-b575face.js","assets/Util-a48361c6.js","assets/assets-8d3e737a.js","assets/ViewingMode-5d7d590b.js","assets/Matrix3PassUniform-ad9f953b.js","assets/ShaderBuilder-a7d0da4e.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/mat3-3fc68e72.js","assets/aaBoundingBox-657a9b82.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/aaBoundingRect-193543b5.js","assets/BufferView-903d1848.js","assets/vec2-528adfe4.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/asyncUtils-437defc4.js","assets/enums-64ab819c.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/compilerUtils-18d58939.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/VisualVariablePassParameters-d460182b.js","assets/VertexAttribute-9c5c630d.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/context-util-a4ce3a7b.js","assets/basicInterfaces-19ed850e.js","assets/lineSegment-10422ca0.js","assets/Texture-46c8c2cb.js","assets/Evented-a45c8b0f.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/ScreenSpacePass-d5e48a9b.js","assets/Float4PassUniform-d7bdbc81.js","assets/Texture2DPassUniform-753de459.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/vec3f32-c9aa289f.js","assets/View.glsl-3ce196d4.js","assets/mat4f32-77b3d8ac.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/symbolColorUtils-b2b55883.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/FloatPassUniform-68d54f51.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DDrawUniform-053796dc.js","assets/PiUtils.glsl-db6418ee.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/OutputHighlight.glsl-fbac199a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/Normals.glsl-76f97814.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/SSAO.glsl-980b3771.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/Graphic-f0e54e86.js","assets/geometry-b7901087.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/jsonUtils-229211af.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/executeQueryJSON-2fe748db.js","assets/normalizeUtils-27e29a72.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/parser-498c8be0.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/enums-0fc02184.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/NormalUtils.glsl-c12729bf.js","assets/HUD.glsl-d3a072ad.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]).then(e=>(this.voxelWasm=new e.default(this),this.voxelWasm))),this.voxelWasmPromise.then(e=>e.addVoxelLayer(i))):this.voxelWasm.addVoxelLayer(i)}removeVoxelLayerViewFromWasm(i){y(this.voxelWasm)&&this.voxelWasm.removeVoxelLayer(i)<1&&(this.voxelWasm=null,this.voxelWasmPromise=null)}};function F1(i,e){i.layerUids||(i.layerUids=new Set),i.layerUids.add(e)}function A$e(i,e){i.graphicUids||(i.graphicUids=new Set),i.graphicUids.add(e)}function gS(i,e){return y(i)&&gv(i.spatialReference,e)?Dd(i,e):null}var pw;Ne.type="3d",h([p()],Ne.prototype,"_userClippingArea",void 0),h([p()],Ne.prototype,"_resourceController",void 0),h([p()],Ne.prototype,"_stage",void 0),h([p({readOnly:!0})],Ne.prototype,"deconflictor",void 0),h([p({readOnly:!0})],Ne.prototype,"labeler",void 0),h([p(SI(ov,"analyses"))],Ne.prototype,"analyses",void 0),h([p({type:Md,readOnly:!0})],Ne.prototype,"animation",null),h([p({readOnly:!0})],Ne.prototype,"basemapTerrain",void 0),h([p({readOnly:!0})],Ne.prototype,"elevationProvider",void 0),h([p()],Ne.prototype,"camera",null),h([p({type:al})],Ne.prototype,"contentCamera",null),h([p({readOnly:!0})],Ne.prototype,"canvas",void 0),h([p({type:He})],Ne.prototype,"center",null),h([p({type:pi})],Ne.prototype,"clippingArea",null),h([p({type:eg})],Ne.prototype,"constraints",void 0),h([p({type:pi,readOnly:!0})],Ne.prototype,"renderDataExtent",null),h([p({type:pi,readOnly:!0})],Ne.prototype,"dataExtent",null),h([p({type:pi,readOnly:!0})],Ne.prototype,"_groundAndLayersExtent",null),h([p({value:null,type:Oy})],Ne.prototype,"environment",null),h([qr("environment")],Ne.prototype,"castEnvironment",null),h([p({readOnly:!0})],Ne.prototype,"environmentManager",void 0),h([p({type:pi})],Ne.prototype,"extent",null),h([p()],Ne.prototype,"floors",void 0),h([p()],Ne.prototype,"screenCenter",null),h([p()],Ne.prototype,"frustum",null),h([p({type:Number,readOnly:!0})],Ne.prototype,"fullOpacity",void 0),h([p({readOnly:!0})],Ne.prototype,"graphicsView",void 0),h([p({readOnly:!0})],Ne.prototype,"analysisViewManager",void 0),h([p()],Ne.prototype,"groundView",void 0),h([p({type:Boolean})],Ne.prototype,"initialExtentRequired",null),h([p()],Ne.prototype,"_defaultsFromMapSettings",null),h([p()],Ne.prototype,"interacting",null),h([p()],Ne.prototype,"stationary",null),h([p()],Ne.prototype,"navigating",null),h([p()],Ne.prototype,"map",void 0),h([p({readOnly:!0})],Ne.prototype,"mapCoordsHelper",void 0),h([p()],Ne.prototype,"padding",null),h([p({type:vs,readOnly:!0})],Ne.prototype,"pointsOfInterest",void 0),h([p({type:Mn,readOnly:!0})],Ne.prototype,"featureTiles",void 0),h([p()],Ne.prototype,"_featureTreeDebugger",void 0),h([p({type:Boolean})],Ne.prototype,"screenSizePerspectiveEnabled",void 0),h([p({constructOnly:!0})],Ne.prototype,"deactivatedWebGLExtensions",void 0),h([p({constructOnly:!0})],Ne.prototype,"debugWebGLExtensions",void 0),h([p({constructOnly:!0})],Ne.prototype,"renderCanvas",void 0),h([p({constructOnly:!0})],Ne.prototype,"state",void 0),h([p({readOnly:!0})],Ne.prototype,"inputManager",void 0),h([p({readOnly:!0})],Ne.prototype,"stateManager",void 0),h([p({type:["low","medium","high"]})],Ne.prototype,"qualityProfile",null),h([p({type:Vz,get(){let i=this._get("qualitySettings");return i||(i=new Vz,_E.apply(this.qualityProfile,i)),i}})],Ne.prototype,"qualitySettings",void 0),h([p()],Ne.prototype,"slicePlane",null),h([p({readOnly:!0})],Ne.prototype,"typeSpecificPreconditionsReady",null),h([p({readOnly:!0})],Ne.prototype,"renderCoordsHelper",void 0),h([p({readOnly:!0})],Ne.prototype,"sceneIntersectionHelper",void 0),h([p({type:Number,dependsOn:["scale","spatialReference"],readOnly:!0})],Ne.prototype,"resolution",null),h([p({type:Number})],Ne.prototype,"scale",null),h([p()],Ne.prototype,"heightModelInfo",null),h([p()],Ne.prototype,"spatialReference",void 0),h([p({type:Boolean,constructOnly:!0})],Ne.prototype,"alphaCompositingEnabled",void 0),h([p({constructOnly:!0})],Ne.prototype,"preserveDrawingBufferEnabled",void 0),h([p({type:Boolean})],Ne.prototype,"supersampleScreenshotsEnabled",void 0),h([p({readOnly:!0})],Ne.prototype,"type",void 0),h([p({type:tte})],Ne.prototype,"ui",void 0),h([p({type:Boolean,readOnly:!0,dependsOn:["graphicsView.updating","basemapView.updating","basemapTerrain.updating","layerViewManager.updating","layerViewManager.updatingRemaining","_resourceController.updating","_stage.updating","featureTiles.updating","pointsOfInterest.updating","environmentManager.updating","overlay.updating","updatingHandles.updating","featureTreeDebugger.updating","labeler.updating","deconflictor.updating","ready","stationary","inputManager.hasPendingInputs","toolViewManager.updating","analysisViewManager.updating"]})],Ne.prototype,"updating",null),h([p({type:Number,readOnly:!0,dependsOn:["updating"]})],Ne.prototype,"updatingProgress",void 0),h([p({type:["global","local"]})],Ne.prototype,"viewingMode",null),h([p({type:rr})],Ne.prototype,"viewpoint",null),h([p({type:Number})],Ne.prototype,"zoom",null),h([p({type:x$})],Ne.prototype,"highlightOptions",void 0),Ne=h([F("esri.views.SceneView")],Ne),function(i){i[i.INCLUDE=0]="INCLUDE",i[i.EXCLUDE=1]="EXCLUDE"}(pw||(pw={}));const dy=P(),hI=zi(),m7=Nt(),O$e=Ne;let _a=class extends pe{constructor(e){super(e),this.precision=4,this.thumbsConstrained=!0}set effectiveMax(e){this.setEffectiveMax(e)}set effectiveMin(e){this.setEffectiveMin(e)}set labelFormatFunction(e){this._set("labelFormatFunction",e)}set inputFormatFunction(e){this._set("inputFormatFunction",e)}set inputParseFunction(e){this._set("inputParseFunction",e)}get labels(){const{max:e,min:t,values:r}=this,n=r&&r.length?r.map((s,a)=>this.getLabelForValue(s,"value",a)):[];return{max:this.getLabelForValue(e,"max"),min:this.getLabelForValue(t,"min"),values:n}}set max(e){this.setMax(e)}set min(e){this.setMin(e)}get state(){const{max:e,min:t}=this;return e!=null&&t!=null&&e>t?"ready":"disabled"}set values(e){const{max:t,min:r}=this,n=this.values;n&&e&&n.length===e.length&&n.every((s,a)=>s===e[a])||(this._set("values",null),e&&e.length&&(r!=null&&e.some(s=>s<r)&&(this.min=Math.min(...e)),t!=null&&e.some(s=>s>t)&&(this.max=Math.max(...e))),this._set("values",e))}toPrecision(e){return parseFloat(e.toFixed(this.precision))}defaultLabelFormatFunction(e){const{max:t,min:r,precision:n}=this,s=t!=null&&r!=null&&t-r>10?2:n;return parseFloat(e.toFixed(s)).toString()}defaultInputFormatFunction(e){return e.toString()}defaultInputParseFunction(e){return parseFloat(e)}getBounds(){const{effectiveMax:e,effectiveMin:t,max:r,min:n}=this;return{min:t!=null&&n!=null?Math.max(n,t):n,max:e!=null&&r!=null?Math.min(r,e):r}}getBoundsForValueAtIndex(e){const{thumbsConstrained:t,values:r}=this,{min:n,max:s}=this.getBounds();if(t&&r){const a=e-1,o=e+1;return{min:r[a]!=null?r[a]:n,max:r[o]!=null?r[o]:s}}return{min:n,max:s}}getLabelForValue(e,t,r){return e==null?null:this.labelFormatFunction?this.labelFormatFunction(e,t,r):this.defaultLabelFormatFunction(e)}setMax(e){const{max:t,values:r}=this;if(e==null)return void this._set("max",null);if(isNaN(e))return void this._logError("slider:invalid-value","Supplied value for property 'max' is NaN.");const n=this.toPrecision(e);if(t!==n&&(this._set("max",n),r&&r.length))for(let s=0;s<r.length;s++)n<r[s]&&this.setValue(s,n)}setMin(e){const{min:t,values:r}=this;if(e==null)return void this._set("min",null);if(isNaN(e))return void this._logError("slider:invalid-value","Supplied value for property 'min' is NaN.");const n=this.toPrecision(e);if(t!==n&&(this._set("min",n),r&&r.length))for(let s=0;s<r.length;s++)n>r[s]&&this.setValue(s,n)}setEffectiveMax(e){if(e==null)return void this._set("effectiveMax",null);if(isNaN(e))return void this._logError("slider:invalid-value","Supplied value for property 'effectiveMax' is NaN.");const t=this.toPrecision(e);this.effectiveMax!==t&&this._set("effectiveMax",this._applyBoundsToValue(t))}setEffectiveMin(e){if(e==null)return void this._set("effectiveMin",null);if(isNaN(e))return void this._logError("slider:invalid-value","Supplied value for property 'effectiveMin' is NaN.");const t=this.toPrecision(e);this.effectiveMin!==t&&this._set("effectiveMin",this._applyBoundsToValue(t))}setValue(e,t){if(isNaN(t))return void this._logError("slider:invalid-value","Supplied value for member of property 'values' is NaN.");const{values:r}=this;if(r==null)return void this._logError("slider:invalid-value","Supplied value for member of property 'values' is null.");const n=r[e],s=this.toPrecision(t);if(n===s)return;const a=[...r];a[e]=s,this._set("values",a),this.notifyChange("labels")}_applyBoundsToValue(e){const{max:t,min:r}=this;return r!=null&&e<r?r:t!=null&&e>t?t:e}_logError(e,t,r){ee.getLogger(this.declaredClass).error(new J(e,t,r))}};h([p()],_a.prototype,"effectiveMax",null),h([p()],_a.prototype,"effectiveMin",null),h([p()],_a.prototype,"labelFormatFunction",null),h([p()],_a.prototype,"inputFormatFunction",null),h([p()],_a.prototype,"inputParseFunction",null),h([p({readOnly:!0})],_a.prototype,"labels",null),h([p()],_a.prototype,"max",null),h([p()],_a.prototype,"min",null),h([p()],_a.prototype,"precision",void 0),h([p({readOnly:!0})],_a.prototype,"state",null),h([p()],_a.prototype,"thumbsConstrained",void 0),h([p()],_a.prototype,"values",null),_a=h([F("esri.widgets.Slider.SliderViewModel")],_a);const M$e=_a,Rt={base:"esri-slider",reversed:"esri-slider--reversed",horizontalLayout:"esri-slider--horizontal",verticalLayout:"esri-slider--vertical",contentElement:"esri-slider__content",extraContentElement:"esri-slider__extra-content",trackElement:"esri-slider__track",ticksContainerElement:"esri-slider__ticks",tickElement:"esri-slider__tick",tickLabelElement:"esri-slider__tick-label",maxElement:"esri-slider__max",minElement:"esri-slider__min",maxElementInteractive:"esri-slider__max--interactive",minElementInteractive:"esri-slider__min--interactive",rangeElementActive:"esri-slider__range--active",rangeInput:"esri-slider__range-input",anchorElement:"esri-slider__anchor",movingAnchorElement:"esri-slider__anchor--moving",lastMovedAnchorElement:"esri-slider__anchor--moved",anchorElementActive:"esri-slider__anchor--active",anchorElementIndexPrefix:"esri-slider__anchor-",segmentElement:"esri-slider__segment",segmentElementIndexPrefix:"esri-slider__segment-",segmentElementInteractive:"esri-slider__segment--interactive",segmentElementActive:"esri-slider__segment--active",effectiveSegmentElement:"esri-slider__effective-segment",effectiveMaxSegmentElement:"esri-slider__effective-max-segment",effectiveMinSegmentElement:"esri-slider__effective-min-segment",thumbElement:"esri-slider__thumb",labelElement:"esri-slider__label",labelElementInteractive:"esri-slider__label--interactive",labelInput:"esri-slider__label-input",esriWidget:"esri-widget",widgetIcon:"esri-icon-edit",disabled:"esri-disabled",hidden:"esri-hidden"},Ga={showInput:"Enter",hideInput1:"Enter",hideInput2:"Escape",hideInput3:"Tab",moveAnchorUp:"ArrowUp",moveAnchorDown:"ArrowDown",moveAnchorLeft:"ArrowLeft",moveAnchorRight:"ArrowRight",moveAnchorToMax:"End",moveAnchorToMin:"Home"},I$e="esri.widgets.Slider",f7={labels:!1,rangeLabels:!1};let Gt=class extends Hn{constructor(e,t){super(e,t),this._activeLabelInputIndex=null,this._anchorElements=[],this._dragged=!1,this._dragStartInfo=null,this._focusedAnchorIndex=null,this._isMinInputActive=!1,this._isMaxInputActive=!1,this._lastMovedHandleIndex=null,this._positionPrecision=5,this._segmentDragStartInfo=null,this._trackHeight=null,this._trackWidth=null,this._zIndices=null,this._zIndexOffset=3,this.disabled=!1,this.draggableSegmentsEnabled=!0,this.effectiveSegmentElements=new wt,this.extraNodes=[],this.inputCreatedFunction=null,this.labelElements=new wt,this.labelInputsEnabled=!1,this.maxLabelElement=null,this.messages=null,this.minLabelElement=null,this.rangeLabelInputsEnabled=!1,this.segmentElements=new wt,this.snapOnClickEnabled=!0,this.steps=null,this.syncedSegmentsEnabled=!1,this.thumbCreatedFunction=null,this.thumbElements=new wt,this.tickElements=new wt,this.trackElement=null,this.viewModel=new M$e,this.visibleElements={...f7},this._onAnchorPointerDown=this._onAnchorPointerDown.bind(this),this._onAnchorPointerMove=this._onAnchorPointerMove.bind(this),this._onAnchorPointerUp=this._onAnchorPointerUp.bind(this),this._onLabelPointerDown=this._onLabelPointerDown.bind(this),this._onLabelPointerUp=this._onLabelPointerUp.bind(this),this._onSegmentPointerDown=this._onSegmentPointerDown.bind(this),this._onSegmentPointerMove=this._onSegmentPointerMove.bind(this),this._onSegmentPointerUp=this._onSegmentPointerUp.bind(this),this._onTrackPointerDown=this._onTrackPointerDown.bind(this),this._onTrackPointerMove=this._onTrackPointerMove.bind(this),this._onTrackPointerUp=this._onTrackPointerUp.bind(this)}destroy(){document.removeEventListener("pointerup",this._onLabelPointerUp),document.removeEventListener("pointermove",this._onLabelPointerMove),document.removeEventListener("pointerup",this._onAnchorPointerUp),document.removeEventListener("pointermove",this._onAnchorPointerMove),this.labelElements.removeAll(),this.labelElements.destroy(),this.segmentElements.removeAll(),this.segmentElements.destroy(),this.effectiveSegmentElements.removeAll(),this.effectiveSegmentElements.destroy(),this.thumbElements.removeAll(),this.thumbElements.destroy(),this.tickElements.removeAll(),this.tickElements.destroy()}get effectiveMax(){return this.viewModel.effectiveMax}set effectiveMax(e){this.viewModel.effectiveMax=e}get effectiveMin(){return this.viewModel.effectiveMin}set effectiveMin(e){this.viewModel.effectiveMin=e}get inputFormatFunction(){return this.viewModel.inputFormatFunction}set inputFormatFunction(e){this.viewModel.inputFormatFunction=e}get inputParseFunction(){return this.viewModel.inputParseFunction}set inputParseFunction(e){this.viewModel.inputParseFunction=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get labelFormatFunction(){return this.viewModel.labelFormatFunction}set labelFormatFunction(e){this.viewModel.labelFormatFunction=e}get labels(){return this.viewModel.labels}set layout(e){["vertical","vertical-reversed","horizontal","horizontal-reversed"].includes(e)||(e="horizontal"),this._set("layout",e)}get max(){return this.viewModel.max}set max(e){this.viewModel.max=e}get min(){return this.viewModel.min}set min(e){this.viewModel.min=e}get precision(){return this.viewModel.precision}set precision(e){this.viewModel.precision=e}get state(){const{_activeLabelInputIndex:e,_isMaxInputActive:t,_isMinInputActive:r,_dragStartInfo:n,_segmentDragStartInfo:s,disabled:a,viewModel:o}=this,l=y(n)||y(s);return a?"disabled":e===null&&!t&&!r?l?"dragging":o.state:"editing"}get thumbsConstrained(){return this.viewModel.thumbsConstrained}set thumbsConstrained(e){this.viewModel.thumbsConstrained=e}set tickConfigs(e){this._set("tickConfigs",e),this.scheduleRender()}get values(){return this.viewModel.values}set values(e){this.viewModel.values=e}castVisibleElements(e){return{...f7,...e}}render(){const{label:e}=this,t=this.classes(Rt.base,Rt.esriWidget,this._isHorizontalLayout()?Rt.horizontalLayout:Rt.verticalLayout,this._isReversedLayout()?Rt.reversed:null,this._isDisabled()?Rt.disabled:null);return this._storeTrackDimensions(),N("div",{"aria-label":e,class:t,"touch-action":"none",bind:this,afterCreate:this._afterContainerCreate},this.renderContent())}toNextStep(e){this._toStep(e,1)}toPreviousStep(e){this._toStep(e,-1)}renderContent(){const{max:e,min:t}=this;if(!(C(t)||C(e)||t>=e))return[this.renderMin(),this.renderSliderContainer(),this.renderMax()]}renderSliderContainer(){return N("div",{key:"slider-container",bind:this,class:Rt.contentElement},this.renderTrackElement(),this.renderTicksContainer(),this.renderExtraContentElements())}renderTrackElement(){return N("div",{afterCreate:this._afterTrackCreate,afterRemoved:this._afterTrackRemoved,bind:this,class:Rt.trackElement,"touch-action":"none"},this.renderEffectiveSegmentElements(),this.renderSegmentElements(),this.renderAnchorElements())}renderEffectiveSegmentElements(){if(!this.trackElement||!this.values||!this.values.length)return;const e=y(this.effectiveMax),t=y(this.effectiveMin);if(!e&&!t)return;const{max:r,min:n,viewModel:s}=this,a=s.getBounds(),o=[];return t&&o.push(this.renderEffectiveSegmentElement(n,a.min,!0)),e&&o.push(this.renderEffectiveSegmentElement(a.max,r,!1)),o}renderSegmentElements(){if(!this.trackElement||!this.values||!this.values.length)return;const e=this.values.length,t=[];for(let r=0;r<=e;r++)t.push(this.renderSegmentElement(r));return t}renderSegmentElement(e){const{_trackHeight:t,_trackWidth:r,draggableSegmentsEnabled:n,id:s,state:a,values:o}=this,l=this._isHorizontalLayout(),c=l?r:t,u=this.viewModel.getBounds(),d=this._positionFromValue(u.max),m=this._positionFromValue(u.min),f=e===o.length?null:e,_=e===0?null:e-1,g=y(f),w=y(_);let v,b;const x=[...o].sort(($,D)=>$-D);this._isReversedLayout()?(v=w?this._positionFromValue(x[_]):m,b=g?this._positionFromValue(x[f]):d):(v=g?this._positionFromValue(x[f]):d,b=w?this._positionFromValue(x[_]):m);const T=this._applyPrecisionToPosition(100*b/c),R=(v-b)/c,E=l?`transform: translate(${T}%, 0px) scale(${R}, 1);`:`transform: translate(0px, ${T}%) scale(1, ${R});`,O=this.classes(Rt.segmentElement,Rt.segmentElementIndexPrefix+e,n&&g&&w&&a!=="disabled"?Rt.segmentElementInteractive:null);return N("div",{afterCreate:this._afterSegmentCreate,afterRemoved:this._afterSegmentRemoved,bind:this,class:O,"data-max-thumb-index":f,"data-min-thumb-index":_,"data-segment-index":e,key:`${s}-segment-${e}`,style:E,"touch-action":"none"})}renderEffectiveSegmentElement(e,t,r){const{_trackHeight:n,_trackWidth:s,layout:a}=this,o=this._positionFromValue(e),l=this._positionFromValue(t),c=this._isHorizontalLayout(),u=c?s:n,d=this._applyPrecisionToPosition(100*o/u);let m=null;if(a==="horizontal"){const g=r?u-l:l,w=o===u?0:d;m=`clip-path: inset(0% ${l===u?0:this._applyPrecisionToPosition(g/u*100)}% 0% ${w}%);`}else{const g=(l-o)/u;m=c?`transform: translate(${d}%, 0px) scale(${g}, 1);`:`transform: translate(0px, ${d}%) scale(1, ${g});`}const f=r?Rt.effectiveMinSegmentElement:Rt.effectiveMaxSegmentElement,_=this.classes(Rt.segmentElement,Rt.effectiveSegmentElement,f);return N("div",{afterCreate:this._afterEffectiveSegmentCreate,afterRemoved:this._afterEffectiveSegmentRemoved,bind:this,class:_,style:m,"touch-action":"none"})}renderAnchorElements(){const{trackElement:e,values:t}=this;if(t&&t.length)return this._zIndices=t.map((r,n)=>{const s=this._positionFromValue(r),a=this._positionToPercent(s),o=(this._isHorizontalLayout()?a>50:a<50)?-1:1;return this._zIndexOffset+(t.length+o*n)}),e&&t&&t.length?t.map((r,n)=>this.renderAnchorElement(r,n)):null}renderAnchorElement(e,t){const r=this._positionFromValue(e),n=this._valueFromPosition(r);if(C(n)||isNaN(n))return;const{_dragStartInfo:s,_lastMovedHandleIndex:a,id:o,layout:l,values:c,visibleElements:{labels:u}}=this,d=s&&s.index===t,m=a===t,f=this.classes(Rt.anchorElement,Rt.anchorElementIndexPrefix+t,d?Rt.movingAnchorElement:null,m?Rt.lastMovedAnchorElement:null),_=this.labels.values[t],g=this._getStyleForAnchor(e,t,d||m),{min:w,max:v}=this.viewModel.getBoundsForValueAtIndex(t),{disabled:b,messages:x}=this,T=c.length===2?gc(t===0?x.rangeMinimum:x.rangeMaximum,{value:e}):_,R=c.length===1?null:t===0?`${o}-handle-${t+1}`:t===c.length-1?`${o}-handle-${t-1}`:`${o}-handle-${t-1} ${o}-handle-${t+1}`;return N("div",{afterCreate:this._afterAnchorCreate,afterUpdate:this._afterAnchorUpdate,afterRemoved:this._afterAnchorRemoved,"aria-controls":R,"aria-label":x.sliderValue,"aria-labelledby":u?`${o}-label-${t}`:null,"aria-orientation":l,"aria-valuemax":v.toString(),"aria-valuemin":w.toString(),"aria-valuenow":e.toString(),"aria-valuetext":T,bind:this,class:f,"data-thumb-index":t,"data-value":e,id:`${o}-handle-${t}`,key:`${o}-handle-${t}`,onkeydown:this._onAnchorKeyDown,"touch-action":"none",role:"slider",style:g,tabIndex:b?-1:0},N("span",{afterCreate:this._afterThumbCreate,afterRemoved:this._afterThumbRemoved,bind:this,class:Rt.thumbElement,"data-thumb-index":t,"touch-action":"none"}),this.renderThumbLabel(t))}renderThumbLabel(e){const{id:t,labels:r,labelInputsEnabled:n,state:s}=this,a=this.visibleElements.labels,o=r.values[e],l=this.classes(Rt.labelElement,a?null:Rt.hidden,n&&s!=="disabled"?Rt.labelElementInteractive:null);return N("span",{afterCreate:this._afterLabelCreate,afterRemoved:this._afterLabelRemoved,"aria-hidden":(!a).toString(),bind:this,class:l,"data-thumb-index":e,key:`${t}-label-${e}`,id:`${t}-label-${e}`,role:n?"button":null,"touch-action":"none"},this._activeLabelInputIndex===e?this.renderValueInput(e):o)}renderValueInput(e){const{disabled:t,values:r}=this,n=r[e];return N("input",{key:`value-input-${e}`,afterCreate:this._afterInputCreate,"aria-label":this.messages.sliderValue,bind:this,class:Rt.labelInput,"data-input-type":"thumb","data-input-index":e,required:!0,tabIndex:t?-1:0,type:"text",value:this._formatInputValue(n,"value",e),onblur:this._onLabelInputBlur,onkeydown:this._onInputKeyDown})}renderMax(){const{_isMaxInputActive:e,labels:t,rangeLabelInputsEnabled:r,state:n}=this,s=this.visibleElements.rangeLabels,a=this.classes(Rt.maxElement,{[Rt.hidden]:!s,[Rt.maxElementInteractive]:r&&n!=="disabled",[Rt.rangeElementActive]:e});return N("div",{"aria-hidden":(!s).toString(),afterCreate:this._afterMaxLabelCreate,bind:this,class:a,onclick:this._onMaxLabelClick,onkeydown:this._onMaxLabelKeyDown,role:r?"button":null,tabIndex:!this.disabled&&r?0:-1},e?this.renderMaxInput():t.max)}renderMin(){const{_isMinInputActive:e,labels:t,rangeLabelInputsEnabled:r,state:n}=this,s=this.visibleElements.rangeLabels,a=this.classes(Rt.minElement,{[Rt.hidden]:!s,[Rt.minElementInteractive]:r&&n!=="disabled",[Rt.rangeElementActive]:e});return N("div",{"aria-hidden":(!s).toString(),afterCreate:this._afterMinLabelCreate,bind:this,class:a,onclick:this._onMinLabelClick,onkeydown:this._onMinLabelKeyDown,role:r?"button":null,tabIndex:!this.disabled&&r?0:-1},e?this.renderMinInput():t.min)}renderMaxInput(){return N("input",{afterCreate:this._afterInputCreate,"aria-label":this.messages.maximumValue,bind:this,class:Rt.rangeInput,"data-input-type":"max",required:!0,tabIndex:this.disabled?-1:0,type:"text",value:this._formatInputValue(this.max,"max"),onblur:this._onMaxInputBlur,onkeydown:this._onInputKeyDown})}renderMinInput(){return N("input",{afterCreate:this._afterInputCreate,"aria-label":this.messages.minimumValue,bind:this,class:Rt.rangeInput,"data-input-type":"min",required:!0,tabIndex:this.disabled?-1:0,type:"text",value:this._formatInputValue(this.min,"min"),onblur:this._onMinInputBlur,onkeydown:this._onInputKeyDown})}renderExtraContentElements(){return N("div",{bind:this,class:Rt.extraContentElement},this.extraNodes)}renderTicksContainer(){if(this.tickConfigs&&this.trackElement&&(this._trackHeight!==0||this._trackWidth!==0))return this.tickConfigs.map((e,t)=>N("div",{key:"ticks-container",class:this.classes(Rt.ticksContainerElement)},this.renderTicks(e,t)))}renderTicks(e,t){const{mode:r,values:n}=e;if(this.tickElements.getItemAt(t)||this.tickElements.add(new wt,t),r==="position"){const o=Array.isArray(n)?n:[n];return this._calculateTickPositions(o).map((l,c)=>this.renderTickGroup(e,c,t,l))}if(r==="percent"&&Array.isArray(n)){const{max:o,min:l}=this,c=o-l,u=n.map(d=>this._applyPrecisionToPosition(d/100*c+l));return this._calculateTickPositions(u).map((d,m)=>this.renderTickGroup(e,m,t,d))}const s=Array.isArray(n)&&n.length?n[0]:isNaN(n)?null:n,a=this._getTickCounts(s,e);return this._calculateEquidistantTickPositions(a).map((o,l)=>this.renderTickGroup(e,l,t,o))}renderTickGroup(e,t,r,n){const s=e.mode==="position"?Array.isArray(e.values)?e.values[t]:e.values:this._valueFromPosition(n);if(!C(s)&&!isNaN(s))return N("div",{afterCreate:this._afterTickGroupCreate,afterRemoved:this._afterTickGroupRemoved,bind:this,"data-config":e,"data-position":n,"data-tick-config-index":r,"data-tick-group-index":t,"data-value":s,onclick:this._onTickGroupClick,key:`tick-group-${t}`},this.renderTickLine(e,t,r,s),e.labelsVisible?this.renderTickLabel(e,t,r,s):null)}renderTickLine(e,t,r,n){return N("div",{afterCreate:this._afterTickLineCreate,"aria-valuenow":n.toString(),bind:this,class:Rt.tickElement,"data-config":e,"data-tick-config-index":r,"data-tick-group-index":t,"data-value":n,key:`tick-label-${t}`,style:this._getPositionStyleForElement(n)})}renderTickLabel(e,t,r,n){const s=e.labelFormatFunction?e.labelFormatFunction(n,"tick",t):this.viewModel.getLabelForValue(n,"tick",t);return N("div",{afterCreate:this._afterTickLabelCreate,"aria-label":s,"aria-valuenow":n.toString(),"aria-valuetext":s,bind:this,class:Rt.tickLabelElement,"data-config":e,"data-tick-config-index":r,"data-tick-group-index":t,"data-value":n,key:`tick-label-${t}`,style:`transform: translate(-50%); ${this._getPositionStyleForElement(n)}`},s)}_afterContainerCreate(e){this.addHandles(iie(e,()=>this.scheduleRender()))}_afterTrackCreate(e){this._set("trackElement",e),e.addEventListener("pointerdown",this._onTrackPointerDown),this.scheduleRender()}_afterTrackRemoved(e){e.removeEventListener("pointerdown",this._onTrackPointerDown),document.removeEventListener("pointermove",this._onTrackPointerMove),document.removeEventListener("pointerup",this._onTrackPointerUp)}_afterSegmentCreate(e){this.segmentElements.add(e),e.addEventListener("pointerdown",this._onSegmentPointerDown)}_afterSegmentRemoved(e){this.segmentElements.remove(e),e.removeEventListener("pointerdown",this._onSegmentPointerDown)}_afterEffectiveSegmentCreate(e){this.effectiveSegmentElements.add(e)}_afterEffectiveSegmentRemoved(e){this.effectiveSegmentElements.remove(e)}_afterAnchorCreate(e){if(this._anchorElements.push(e),e.addEventListener("pointerdown",this._onAnchorPointerDown),this.thumbCreatedFunction){const t=e["data-thumb-index"],r=e["data-value"],n=this.thumbElements.getItemAt(t)||null,s=this.labelElements.getItemAt(t)||null;this.thumbCreatedFunction(t,r,n,s)}}_afterAnchorUpdate(e){y(this._focusedAnchorIndex)&&e["data-thumb-index"]===this._focusedAnchorIndex&&(e.focus(),this._focusedAnchorIndex=null)}_afterAnchorRemoved(e){const t=this._anchorElements.indexOf(e,0);t>-1&&this._anchorElements.splice(t,1),e.removeEventListener("pointerdown",this._onAnchorPointerDown)}_afterThumbCreate(e){this.thumbElements.add(e)}_afterThumbRemoved(e){this.thumbElements.remove(e)}_afterLabelCreate(e){this.labelElements.add(e),e.addEventListener("pointerdown",this._onLabelPointerDown),e.addEventListener("pointerup",this._onLabelPointerUp)}_afterLabelRemoved(e){this.labelElements.remove(e),e.removeEventListener("pointerdown",this._onLabelPointerDown),e.removeEventListener("pointerup",this._onLabelPointerUp)}_afterInputCreate(e){if(e.focus(),e.select(),this.inputCreatedFunction){const t=e.getAttribute("data-input-type"),r=t==="thumb"?e["data-input-index"]:null;this.inputCreatedFunction(e,t,r)}}_afterTickLineCreate(e){const t=e["data-tick-config-index"],r=e["data-tick-group-index"],n=this.tickElements.getItemAt(t);n.getItemAt(r)?n.getItemAt(r).tickElement=e:n.add({groupElement:null,tickElement:e,labelElement:null},r)}_afterTickLabelCreate(e){const t=e["data-tick-config-index"],r=e["data-tick-group-index"],n=this.tickElements.getItemAt(t);n.getItemAt(r)?n.getItemAt(r).labelElement=e:n.add({groupElement:null,labelElement:e,tickElement:null},r)}_afterTickGroupRemoved(e){const t=e["data-tick-config-index"],r=this.tickElements.items[t],n=r==null?void 0:r.find(s=>s.groupElement===e);n&&r.remove(n)}_afterTickGroupCreate(e){var r,n;const t=e["data-config"];if(t&&t.tickCreatedFunction){const s=e["data-tick-config-index"],a=e["data-tick-group-index"],o=e["data-value"],l=(n=(r=this.tickElements)==null?void 0:r.getItemAt(s))==null?void 0:n.getItemAt(a);if(l){l.groupElement=e;const c=l.tickElement||null,u=l.labelElement||null;t.tickCreatedFunction(o,c,u)}}}_afterMaxLabelCreate(e){this._set("maxLabelElement",e)}_afterMinLabelCreate(e){this._set("minLabelElement",e)}_onAnchorKeyDown(e){if(this._isDisabled()||this.state==="editing")return;const{target:t}=e,r=Ol(e),{_anchorElements:n,values:s}=this,a=t["data-thumb-index"],o=n[a],l=s[a],c=[Ga.moveAnchorUp,Ga.moveAnchorDown,Ga.moveAnchorLeft,Ga.moveAnchorRight];if(r===Ga.showInput&&this.labelInputsEnabled)this._activeLabelInputIndex=a,this.notifyChange("state");else if(c.includes(r)){e.preventDefault();const{steps:u}=this,d=r===Ga.moveAnchorUp||r===Ga.moveAnchorRight?1:-1;if(y(u))this._toStep(a,this._isReversedLayout()?-1*d:d);else{const{precision:f}=this,_=this._getPositionOfElement(o),g=this._valueFromPosition(_),w=this._isHorizontalLayout()?d:-1*d;let v;v=f===0?this._positionFromValue(g+w):f===1?this._positionFromValue(g+.1*w):_+w,this._toPosition(a,v)}const m=this.values[a];l!==m&&this._emitThumbChangeEvent({index:a,oldValue:l,value:m})}else if(r===Ga.moveAnchorToMax||r===Ga.moveAnchorToMin){e.preventDefault();const{min:u,max:d}=this._getAnchorBoundsInPixels(a),m=this._isPositionInverted()?r===Ga.moveAnchorToMax?u:d:r===Ga.moveAnchorToMin?u:d;this._toPosition(a,m);const f=this.values[a];l!==f&&this._emitThumbChangeEvent({index:a,oldValue:l,value:f})}}_onAnchorPointerDown(e){if(this._isDisabled())return;const{target:t,clientX:r,clientY:n}=e,s=t["data-thumb-index"];s!==void 0&&(e.preventDefault(),this._anchorElements[s]&&this._anchorElements[s].focus(),this._storeTrackDimensions(),this._dragStartInfo={clientX:r,clientY:n,index:s,position:this._getPositionOfElement(this._anchorElements[s])},this.notifyChange("state"),document.addEventListener("pointerup",this._onAnchorPointerUp),document.addEventListener("pointermove",this._onAnchorPointerMove))}_onAnchorPointerMove(e){if(this.state==="editing"||!this._dragStartInfo)return;e.preventDefault();const{values:t,_anchorElements:r,_dragged:n,_dragStartInfo:s,_dragStartInfo:{index:a,position:o}}=this,{clientX:l,clientY:c}=e,u=n?"drag":"start",d=r[a],m=this._getPositionOfElement(d),f=this._applyPrecisionToPosition(this._isHorizontalLayout()?o+l-s.clientX:o+c-s.clientY);if(m===f)return;const _=t[a];this._dragged=!0,this._toPosition(a,f);const g=this.values[a];n?_!==g&&this._emitThumbDragEvent({index:a,state:u,value:g}):this._emitThumbDragEvent({index:a,state:u,value:_})}_onAnchorPointerUp(e){if(document.removeEventListener("pointerup",this._onAnchorPointerUp),document.removeEventListener("pointermove",this._onAnchorPointerMove),!this._dragStartInfo)return;e.preventDefault();const{index:t}=this._dragStartInfo,r=this._dragged,n=this.values[t];this._dragged=!1,this._dragStartInfo=null,this._lastMovedHandleIndex=t,this.notifyChange("state"),r?this._emitThumbDragEvent({index:t,state:"stop",value:n}):(this.scheduleRender(),this.state!=="editing"&&this._emitThumbClickEvent({index:t,value:n}))}_onTrackPointerDown(e){const{_dragStartInfo:t,snapOnClickEnabled:r,state:n,values:s}=this;if(this._isDisabled()||n==="editing"||t||(document.addEventListener("pointermove",this._onTrackPointerMove),document.addEventListener("pointerup",this._onTrackPointerUp),!r||!s.length))return;const{steps:a}=this,{clientX:o,clientY:l}=e,c=this._getCursorPositionFromEvent(e),u=this._valueFromPosition(c),d=this._getIndexOfNearestValue(u),m=s[d],f=s.some((v,b)=>v===m&&b!==d)&&u>m?this.values.lastIndexOf(m):d;if(C(f))return;const _=s[f],g=y(a)?this._calculateNearestStepPosition(c):c;this._toPosition(f,g),this._dragged=!0,this._dragStartInfo={clientX:o,clientY:l,index:f,position:g},this._focusedAnchorIndex=f,this.notifyChange("state"),this._emitThumbDragEvent({index:f,state:"start",value:_});const w=this.values[f];_!==w&&this._emitThumbDragEvent({index:f,state:"drag",value:w}),document.addEventListener("pointerup",this._onAnchorPointerUp),document.addEventListener("pointermove",this._onAnchorPointerMove)}_onTrackPointerMove(e){e.preventDefault(),this._dragged=!0}_onTrackPointerUp(e){if(e.preventDefault(),document.removeEventListener("pointermove",this._onTrackPointerMove),document.removeEventListener("pointerup",this._onTrackPointerUp),this.snapOnClickEnabled||(this._dragged=!1),!this._dragged){const t=this._getCursorPositionFromEvent(e),r=this._valueFromPosition(t);this._emitTrackClickEvent({value:r})}}_onSegmentPointerDown(e){var l,c;e.preventDefault();const t=e.target,r=t["data-segment-index"],n=t["data-min-thumb-index"],s=t["data-max-thumb-index"];if(this._isDisabled()||C(n)||C(s))return;e.stopPropagation(),this._storeTrackDimensions(),document.addEventListener("pointerup",this._onSegmentPointerUp);const a=this._getAnchorDetails(n),o=this._getAnchorDetails(s);this.syncedSegmentsEnabled?(this.segmentElements.forEach(u=>u.classList.add(Rt.segmentElementActive)),this._anchorElements.forEach(u=>u.classList.add(Rt.anchorElementActive))):(this.segmentElements.getItemAt(r).classList.add(Rt.segmentElementActive),(l=this._anchorElements[a.index])==null||l.classList.add(Rt.anchorElementActive),(c=this._anchorElements[o.index])==null||c.classList.add(Rt.anchorElementActive)),this._segmentDragStartInfo={cursorPosition:this._getCursorPositionFromEvent(e),index:r,details:this._normalizeSegmentDetails({min:a,max:o})},this.draggableSegmentsEnabled&&(document.addEventListener("pointermove",this._onSegmentPointerMove),this.notifyChange("state"),this._emitSegmentDragEvent({index:r,state:"start",thumbIndices:[n,s]}))}_onSegmentPointerMove(e){if(!this._segmentDragStartInfo)return;e.preventDefault();const{_trackHeight:t,_trackWidth:r,_segmentDragStartInfo:{index:n,cursorPosition:s,details:{min:a,max:o}}}=this,{index:l,position:c,value:u}=a,{index:d,position:m,value:f}=o;this._dragged=!0;const _=this._getCursorPositionFromEvent(e);if(_===s)return;const g=this._positionToPercent(s),w=this._positionToPercent(_)-g,v=this._positionToPercent(c)+w,b=this._positionToPercent(m)+w,{min:x}=this._getAnchorBoundsAsPercents(l),{max:T}=this._getAnchorBoundsAsPercents(d);let R=!1,E=!1;if(v<x?R=!0:b>T&&(E=!0),R){const{min:te,max:H}=this.viewModel.getBoundsForValueAtIndex(l),M=this._isPositionInverted()?H:te,U=M,L=f+(M-u),z=L-this.values[d];return void(this.syncedSegmentsEnabled?this._updateAnchorValuesByDifference(z):this._updateAnchorValues([l,d],[U,L]))}if(E){const{min:te,max:H}=this.viewModel.getBoundsForValueAtIndex(d),M=this._isPositionInverted()?te:H,U=M,L=u+(M-f),z=L-this.values[l];return void(this.syncedSegmentsEnabled?this._updateAnchorValuesByDifference(z):this._updateAnchorValues([l,d],[L,U]))}const O=this._isHorizontalLayout()?r:t,$=b/100*O,D=v/100*O,I=this.values,G=[I[l],I[d]],W=this._getValueForAnchorAtPosition(l,D),re=this._getValueForAnchorAtPosition(d,$);this.syncedSegmentsEnabled?this._updateAnchorValuesByDifference(W-G[0]):this._updateAnchorValues([l,d],[W,re]),[this.values[l],this.values[d]].every((te,H)=>te===G[H])||this._emitSegmentDragEvent({index:n,state:"drag",thumbIndices:[l,d]})}_onSegmentPointerUp(e){if(e.preventDefault(),document.removeEventListener("pointerup",this._onSegmentPointerUp),document.removeEventListener("pointermove",this._onSegmentPointerMove),!this._segmentDragStartInfo)return;const{_dragged:t,max:r,min:n,values:s}=this,{index:a,details:{min:{index:o},max:{index:l}}}=this._segmentDragStartInfo;if(this.segmentElements.forEach(c=>c.classList.remove(Rt.segmentElementActive)),this._anchorElements.forEach(c=>c.classList.remove(Rt.anchorElementActive)),this.draggableSegmentsEnabled){const c=r-n,u=s[o],d=s[l];this._lastMovedHandleIndex=u===d?u>c/2?o:l:null,this._dragged=!1,this._segmentDragStartInfo=null,this.notifyChange("state"),this._emitSegmentDragEvent({index:a,state:"stop",thumbIndices:[o,l]})}if(!t){const c=this._getCursorPositionFromEvent(e),u=this._valueFromPosition(c);this._emitSegmentClickEvent({index:a,value:u,thumbIndices:[o,l]})}}_onTickGroupClick(e){const t=e.target;if(t["data-config"]){const r=t["data-tick-config-index"],n=t["data-tick-group-index"],s=t["data-value"];this._emitTickClickEvent({configIndex:r,groupIndex:n,value:s})}}_storeTrackDimensions(){if(this.trackElement){const e=this._getDimensions(this.trackElement);this._trackHeight=e.height,this._trackWidth=e.width}}_onLabelPointerDown(){this._isDisabled()||(this._dragged=!1,document.addEventListener("pointerup",this._onAnchorPointerUp),document.addEventListener("pointermove",this._onAnchorPointerMove))}_onLabelPointerMove(){this._isDisabled()||(this._dragged=!0)}_onLabelPointerUp(e){if(this._isDisabled())return;const t=e.target["data-thumb-index"];this.labelInputsEnabled&&!this._dragged&&y(t)&&(this._activeLabelInputIndex=t),this._dragged=!1,this.notifyChange("state"),document.removeEventListener("pointerup",this._onLabelPointerUp),document.removeEventListener("pointermove",this._onLabelPointerMove)}_onLabelInputBlur(e){const{_activeLabelInputIndex:t,values:r,viewModel:n}=this,s=e.target.value;if(this._activeLabelInputIndex=null,this.notifyChange("state"),!s)return;const a=this._parseInputValue(s,"value",t),o=r[t],{min:l,max:c}=this.viewModel.getBoundsForValueAtIndex(t);if(a<l||a>c)return;n.setValue(t,a);const u=this.values[t];o!==u&&this._emitThumbChangeEvent({index:t,oldValue:o,value:u})}_onInputKeyDown(e){if(this._isDisabled())return;const{target:t}=e,r=Ol(e),{hideInput1:n,hideInput2:s,hideInput3:a}=Ga,{_activeLabelInputIndex:o,_anchorElements:l}=this,c=t;if(r===n||r===s||r===a){e.stopPropagation();const u=o;c.blur(),y(u)?l[u].focus():c.parentElement.focus()}}_onMaxLabelClick(){this._isDisabled()||(this._emitRangeLabelClickEvent({type:"max-click",value:this.max}),this.rangeLabelInputsEnabled&&(this._isMaxInputActive=!0,this.notifyChange("state")))}_onMaxLabelKeyDown(e){this._isDisabled()||Ol(e)!==Ga.showInput||(this._isMaxInputActive=!0,this.notifyChange("state"))}_onMaxInputBlur(e){const t=e.target.value;if(this._isMaxInputActive=!1,this.notifyChange("state"),!t)return;const r=this.max,n=this._parseInputValue(t,"max");n<=this.min||(this.viewModel.set("max",n),this.max!==r&&this._emitMaxChangeEvent({oldValue:r,value:this.max}))}_onMinLabelClick(){this._isDisabled()||(this._emitRangeLabelClickEvent({type:"min-click",value:this.min}),this.rangeLabelInputsEnabled&&(this._isMinInputActive=!0,this.notifyChange("state")))}_onMinLabelKeyDown(e){this._isDisabled()||Ol(e)!==Ga.showInput||(this._isMinInputActive=!0,this.notifyChange("state"))}_onMinInputBlur(e){const t=e.target.value;if(this._isMinInputActive=!1,this.notifyChange("state"),!t)return;const r=this.min,n=this._parseInputValue(t,"min");n>=this.max||(this.viewModel.set("min",n),this.min!==r&&this._emitMinChangeEvent({oldValue:r,value:this.min}))}_isDisabled(){return this.disabled||this.state==="disabled"}_positionFromValue(e){const{max:t,min:r}=this,n=t-r;if(n===0)return 0;const{_trackHeight:s,_trackWidth:a}=this,o=this._isHorizontalLayout();let l=parseFloat(o?(a*(e-r)/n).toFixed(2):(s*(t-e)/n).toFixed(2));return this._isReversedLayout()&&(l=o?a-l:s-l),l}_valueFromPosition(e){const{_trackHeight:t,_trackWidth:r,max:n,min:s,precision:a}=this,o=n-s;let l=this._isHorizontalLayout()?e*o/r+s:o*(1e3-e/t*1e3)/1e3+s;return this._isReversedLayout()&&(l=n+s-l),parseFloat(l.toFixed(a))}_positionToPercent(e){const{_trackHeight:t,_trackWidth:r}=this,n=100*e/(this._isHorizontalLayout()?r:t);return this._applyPrecisionToPosition(n)}_applyPrecisionToPosition(e){return parseFloat(e.toFixed(this._positionPrecision))}_isPositionInverted(){const{layout:e}=this;return e==="horizontal-reversed"||e==="vertical"}_isHorizontalLayout(){return this.layout.includes("horizontal")}_isReversedLayout(){return this.layout.includes("reversed")}_normalizeSegmentDetails(e){if(this._isPositionInverted()){const{min:t,max:r}=e;return{min:r,max:t}}return e}_parseInputValue(e,t,r){return this.inputParseFunction?this.inputParseFunction(e,t,r):this.viewModel.defaultInputParseFunction(e)}_formatInputValue(e,t,r){return this.inputFormatFunction?this.inputFormatFunction(e,t,r):this.viewModel.defaultInputFormatFunction(e)}_getAnchorDetails(e){const t=[...this.values].sort((n,s)=>n-s)[e],r=this.values.indexOf(t);return{index:r,position:this._getPositionOfElement(this._anchorElements[r]),value:t}}_updateAnchorStyle(e,t){const r=this._anchorElements[e];r&&(this._isHorizontalLayout()?r.style.left=`${t}`:r.style.top=`${t}`)}_getStyleForAnchor(e,t,r){const n=this._getPositionStyleForElement(e);if(this.values.length===1)return`${n}`;const s=this._zIndices[t];return`${n}; z-index: ${r?this._zIndexOffset+s:s}`}_getPositionStyleForElement(e){const t=this._positionFromValue(e),r=this._positionToPercent(t);return`${this._isHorizontalLayout()?"left":"top"}: ${r+"%"}`}_getPositionOfElement(e){const t=this._getDimensions(e.offsetParent),r=this._getDimensions(e);return this._isHorizontalLayout()?this._applyPrecisionToPosition(r.left-t.left):this._applyPrecisionToPosition(r.top-t.top)}_updateAnchorValues(e,t){e.forEach((r,n)=>this._toValue(r,t[n]))}_updateAnchorValuesByDifference(e){const{min:t,max:r,values:n}=this;n.forEach((s,a)=>this._toValue(a,Math.max(Math.min(s+e,r),t)))}_toValue(e,t){y(this.steps)&&(t=this._getStepValues()[this._getIndexOfNearestStepValue(t)]),this._updateAnchorStyle(e,this._getPositionStyleForElement(t)),this.viewModel.setValue(e,t)}_toPosition(e,t){const r=y(this.steps)?this._getStepValueForAnchorAtPosition(e,t):this._getValueForAnchorAtPosition(e,t);this._updateAnchorStyle(e,this._getPositionStyleForElement(r)),this.viewModel.setValue(e,r)}_getValueForAnchorAtPosition(e,t){const{min:r,max:n}=this._getAnchorBoundsInPixels(e),{min:s,max:a}=this.viewModel.getBoundsForValueAtIndex(e);let o,l,c=null;return this._isPositionInverted()?(o=s,l=a):(o=a,l=s),c=t>n?o:t<r?l:this._valueFromPosition(t),c>a?c=a:c<s&&(c=s),c}_getStepValueForAnchorAtPosition(e,t){const r=this._getStepValues(),n=this._calculateNearestStepPosition(t),s=this._getValueForAnchorAtPosition(e,n);return r[this._getIndexOfNearestStepValue(s)]}_getAnchorBoundsAsPercents(e){const{min:t,max:r}=this._getAnchorBoundsInPixels(e);return{min:this._positionToPercent(t),max:this._positionToPercent(r)}}_getAnchorBoundsInPixels(e){const{_anchorElements:t,_trackHeight:r,_trackWidth:n,effectiveMax:s,effectiveMin:a,thumbsConstrained:o}=this,l=t[e-1],c=t[e+1],u=this._isHorizontalLayout()?n:r;let d,m;return this._isPositionInverted()?(d=y(a)?this._positionFromValue(a):u,m=y(s)?this._positionFromValue(s):0):(d=y(s)?this._positionFromValue(s):u,m=y(a)?this._positionFromValue(a):0),o?this._isPositionInverted()?{max:l?this._getPositionOfElement(l):d,min:c?this._getPositionOfElement(c):m}:{max:c?this._getPositionOfElement(c):d,min:l?this._getPositionOfElement(l):m}:{max:d,min:m}}_getIndexOfNearestValue(e){return this.values.indexOf(this.values.reduce((t,r)=>Math.abs(r-e)<Math.abs(t-e)?r:t))}_getCursorPositionFromEvent(e){const t=this._getDimensions(this.trackElement);return this._isHorizontalLayout()?e.clientX-t.left:e.clientY-t.top}_getStepValues(){const{steps:e}=this;if(Array.isArray(e))return e;const{max:t,min:r}=this,n=Math.ceil((t-r)/e),s=[];for(let a=0;a<=n;a++){const o=r+e*a;s.push(o>t?t:o)}return s}_toStep(e,t){const{values:r,viewModel:n}=this,s=r[e],a=this._getStepValues(),o=a.indexOf(s);let l=null;if(o>-1){let c=a[o+t];isNaN(c)&&(c=a[o]);const u=this._positionFromValue(c);l=this._getStepValueForAnchorAtPosition(e,u)}else l=a[this._getIndexOfNearestStepValue(s)+t];n.setValue(e,l)}_getIndexOfNearestStepValue(e){const{steps:t}=this;if(C(t))return null;const r=this._getStepValues(),n=r.reduce((s,a)=>Math.abs(a-e)<Math.abs(s-e)?a:s);return r.indexOf(n)}_calculateNearestStepPosition(e){const t=this._valueFromPosition(e),r=this._getIndexOfNearestStepValue(t),n=this._getStepValues();return this._positionFromValue(n[r])}_getTickCounts(e,t){const{mode:r}=t;return r==="count"||r==="position"?e||0:r==="percent"&&100/e||0}_calculateTickPositions(e){return e.map(t=>this._positionFromValue(t))}_calculateEquidistantTickPositions(e){const{_trackWidth:t,_trackHeight:r}=this,n=this._isHorizontalLayout()?t:r,s=n/(e-1),a=[];if(e===1)return[n/2];for(let o=0;o<e;o++){const l=o*s;l<=n&&a.push(l)}return a}_getDimensions(e){try{return e.getBoundingClientRect()}catch(t){if(typeof t=="object"&&t!==null)return new DOMRect(0,0,0,0);throw t}}_emitTrackClickEvent(e){this.emit("track-click",{...e,type:"track-click"})}_emitTickClickEvent(e){this.emit("tick-click",{...e,type:"tick-click"})}_emitMaxChangeEvent(e){this.emit("max-change",{...e,type:"max-change"})}_emitMinChangeEvent(e){this.emit("min-change",{...e,type:"min-change"})}_emitThumbChangeEvent(e){this.emit("thumb-change",{...e,type:"thumb-change"})}_emitThumbClickEvent(e){this.emit("thumb-click",{...e,type:"thumb-click"})}_emitThumbDragEvent(e){this.emit("thumb-drag",{...e,type:"thumb-drag"})}_emitSegmentClickEvent(e){this.emit("segment-click",{...e,type:"segment-click"})}_emitSegmentDragEvent(e){this.emit("segment-drag",{...e,type:"segment-drag"})}_emitRangeLabelClickEvent(e){this.emit(e.type,{...e})}};h([p()],Gt.prototype,"disabled",void 0),h([p()],Gt.prototype,"draggableSegmentsEnabled",void 0),h([p()],Gt.prototype,"effectiveMax",null),h([p()],Gt.prototype,"effectiveMin",null),h([p({readOnly:!0})],Gt.prototype,"effectiveSegmentElements",void 0),h([p()],Gt.prototype,"extraNodes",void 0),h([p()],Gt.prototype,"inputCreatedFunction",void 0),h([p()],Gt.prototype,"inputFormatFunction",null),h([p()],Gt.prototype,"inputParseFunction",null),h([p()],Gt.prototype,"label",null),h([p({readOnly:!0})],Gt.prototype,"labelElements",void 0),h([p()],Gt.prototype,"labelInputsEnabled",void 0),h([p()],Gt.prototype,"labelFormatFunction",null),h([p({readOnly:!0})],Gt.prototype,"labels",null),h([p({value:"horizontal"})],Gt.prototype,"layout",null),h([p()],Gt.prototype,"max",null),h([p({readOnly:!0})],Gt.prototype,"maxLabelElement",void 0),h([p(),_n("esri/widgets/Slider/t9n/Slider")],Gt.prototype,"messages",void 0),h([p()],Gt.prototype,"min",null),h([p({readOnly:!0})],Gt.prototype,"minLabelElement",void 0),h([p()],Gt.prototype,"precision",null),h([p()],Gt.prototype,"rangeLabelInputsEnabled",void 0),h([p({readOnly:!0})],Gt.prototype,"segmentElements",void 0),h([p()],Gt.prototype,"snapOnClickEnabled",void 0),h([p({readOnly:!0})],Gt.prototype,"state",null),h([p()],Gt.prototype,"steps",void 0),h([p()],Gt.prototype,"syncedSegmentsEnabled",void 0),h([p()],Gt.prototype,"thumbsConstrained",null),h([p()],Gt.prototype,"thumbCreatedFunction",void 0),h([p({readOnly:!0})],Gt.prototype,"thumbElements",void 0),h([p()],Gt.prototype,"tickConfigs",null),h([p({readOnly:!0})],Gt.prototype,"tickElements",void 0),h([p({readOnly:!0})],Gt.prototype,"trackElement",void 0),h([p()],Gt.prototype,"values",null),h([p()],Gt.prototype,"viewModel",void 0),h([p()],Gt.prototype,"visibleElements",void 0),h([qr("visibleElements")],Gt.prototype,"castVisibleElements",null),Gt=h([F(I$e)],Gt);const L$e=Gt;SP.registerLanguage("javascript",AQ);function $$e(){const i=$e.useRef(null),e=$e.useRef(null),t=$e.useRef(null),[r,n]=$e.useState(null),[s,a]=$e.useState(null);$e.useEffect(()=>{o()},[]);async function o(){if(SP.highlightAll(),!(i!=null&&i.current))return;Rg.portalUrl="http://arcgis.com/";const u=new _P({basemap:{portalItem:{id:"eb303185d14e45e9be8bbbc1c0daf7ab"}}}),d=new O$e({container:i==null?void 0:i.current,map:u,center:[-80,40],constraints:{altitude:{min:2e6}}});d.ui.add([new eb({view:d,content:e==null?void 0:e.current,expanded:!0,group:"group1",expandTooltip:"MediaLayer"})],"top-left"),n(d)}async function l(){const u=new FX({video:"https://arcgis.github.io/arcgis-samples-javascript/sample-data/media-layer/videos/hurricanes_aerosol-aug.mp4",georeference:new $2({extent:new pi({xmin:-150,ymin:1,xmax:20,ymax:80,spatialReference:{wkid:4326}})})}),d=new NX({source:[u],title:"2017 Hurricanes and Aerosols Simulation",copyright:"NASA's Goddard Space Flight Center"});r.map.layers.add(d),await r.when(),await d.when(),a(d),new L$e({min:0,max:1,precision:2,values:[1],visibleElements:{labels:!0,rangeLabels:!0},container:t.current}).on("thumb-drag",f=>{const{value:_}=f;d.opacity=_})}return nd("div",{className:"App",children:[Ft("div",{id:"view",ref:i}),nd("div",{ref:e,className:"card",children:[Ft("p",{children:"MediaLayer"}),Ft("pre",{children:Ft("code",{className:"javascript",children:`
  new MediaLayer({ 
    source: [
      new VideoElement({
        video: "video url",
        georeference: new ExtentAndRotationGeoreference({
          extent: new Extent({
            xmin: -150, ymin: 1, xmax: 20, ymax: 80,
            spatialReference: { wkid: 4326 }
          }),
        }),
      })
    ] 
  });
  `})}),Ft("div",{ref:t,className:"slider"}),Ft(tb,{className:"btn","icon-start":"play",onClick:l})]})]})}async function D$e(i,e,t){e=e.clone(),i.capabilities.query.supportsMaxRecordCountFactor&&(e.maxRecordCountFactor=ite(i));const r=F$e(i),n=i.capabilities.query.supportsPagination;e.start=0,e.num=r;let s=null;for(;;){const a=await i.source.queryFeaturesJSON(e,t);if(C(s)?s=a:s.features=s.features.concat(a.features),s.exceededTransferLimit=a.exceededTransferLimit,!n||!a.exceededTransferLimit)break;e.start+=r}return s}function F$e(i){return ite(i)*N$e(i)}function N$e(i){return i.capabilities.query.maxRecordCount||2e3}function ite(i){return i.capabilities.query.supportsMaxRecordCountFactor?$b.MAX_MAX_RECORD_COUNT_FACTOR:1}async function g7(i,e){if(i==="Utility Network Layer"){const{default:t}=await j(()=>Promise.resolve().then(()=>X$e),void 0);return new t({layerUrl:e})}return null}async function k$e(i){let e="portalItem"in i?i:{portalItem:i};!e.portalItem||e.portalItem instanceof JE||(e={...e,portalItem:new JE(e.portalItem)});const t=e.portalItem;if(await t.load(),t.type!=="Feature Service")throw new J("portal:unknown-item-type","Unknown item type '${type}'",{type:t.type});const r=t.url,n=await Wh(r,{responseType:"json",query:{f:"json"}}),s="Network Layer";if(n.data.type&&n.data.type.includes(s))return g7(n.data.type,r);if(n.data.layers){const a=n.data.layers.find(o=>o.type.includes(s));if(a){const o=`${r}/${a.id}`;return g7(a.type,o)}}return null}let Hf=class extends xt{constructor(e){super(e),this.globalIds=[],this.creators=[],this.tags=[],this.names=[]}};h([p({type:[String],json:{write:!0}})],Hf.prototype,"globalIds",void 0),h([p({type:[String],json:{write:!0}})],Hf.prototype,"creators",void 0),h([p({type:[String],json:{write:!0}})],Hf.prototype,"tags",void 0),h([p({type:[String],json:{write:!0}})],Hf.prototype,"names",void 0),Hf=h([F("esri.rest.networks.support.QueryNamedTraceConfigurationsParameters")],Hf);const V$e=Hf;var Wo;(function(i){i[i.RTJunctionJunctionConnectivity=1]="RTJunctionJunctionConnectivity",i[i.RTContainment=2]="RTContainment",i[i.RTAttachment=3]="RTAttachment",i[i.RTJunctionEdgeConnectivity=4]="RTJunctionEdgeConnectivity",i[i.RTEdgeJunctionEdgeConnectivity=5]="RTEdgeJunctionEdgeConnectivity"})(Wo||(Wo={}));const _S=new Vd({connected:"connected",upstream:"upstream",downstream:"downstream",shortestPath:"shortest-path",subnetwork:"subnetwork",subnetworkController:"subnetwork-controller",loops:"loops",isolation:"isolation"});new Vd({connectivity:"connectivity",attachment:"attachment",containment:"containment",junctionEdgeFromConnectivity:"junction-edge-from-connectivity",junctionMidspanConnectivity:"junction-midspan-connectivity",junctionEdgeToConnectivity:"junction-edge-to-connectivity"});const yS=new Vd({normal:"normal",rebuild:"rebuild",forceRebuild:"force-rebuild"});let ju=class extends xt{constructor(e){super(e),this.gdbVersion=null,this.sessionID=null,this.validationType=null,this.validateArea=null,this.validationSet=null,this.returnEdits=!1}};h([p({type:String,json:{write:!0}})],ju.prototype,"gdbVersion",void 0),h([p({type:String,json:{write:!0}})],ju.prototype,"sessionID",void 0),h([p({type:yS.apiValues,json:{type:yS.jsonValues,read:yS.read,write:yS.write}})],ju.prototype,"validationType",void 0),h([p({type:pi,json:{write:!0}})],ju.prototype,"validateArea",void 0),h([p({type:[Object],json:{write:!0}})],ju.prototype,"validationSet",void 0),h([p({type:Boolean,json:{write:!0}})],ju.prototype,"returnEdits",void 0),ju=h([F("esri.rest.networks.support.ValidateNetworkTopologyParameters")],ju);const U$e=ju;let An=class extends kH(Om){constructor(i){super(i),this.id=null,this.title=null,this.layerUrl=null,this.dataElement=null,this.fullExtent=null,this.spatialReference=null,this.type=null,this.sourceJSON=null}static fromPortalItem(i){return k$e(i)}initialize(){this.when().catch(i=>{yo(i)||ee.getLogger(this.declaredClass).error("#load()",`Failed to load layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}')`,{error:i})})}get datasetName(){var i;return((i=this.dataElement)==null?void 0:i.name)??null}get owner(){var i;return((i=this.dataElement)==null?void 0:i.userIdentity)??null}get schemaGeneration(){var i;return((i=this.dataElement)==null?void 0:i.schemaGeneration)??null}get parsedUrl(){return xI(this.layerUrl)}get featureServiceUrl(){const i=this.parsedUrl&&EI(this.parsedUrl.path);return y(i)?i.url.path:null}get networkServiceUrl(){return this.featureServiceUrl?this.featureServiceUrl.replace(/\/FeatureServer/i,"/UtilityNetworkServer"):null}get layerId(){const i=this.parsedUrl&&EI(this.parsedUrl.path);return y(i)?i.sublayer:null}get networkSystemLayers(){return null}async load(i){return this.addResolvingPromise(this._fetchDataElement(this.featureServiceUrl,this.layerId.toString(),i)),this.addResolvingPromise(this._fetchLayerMetaData(this.layerUrl,i)),this}getLayerIdBySourceId(i){if(this.dataElement){const e=this.dataElement.domainNetworks;for(const t of e){for(const r of t.edgeSources?t.edgeSources:[])if(r.sourceId===i)return r.layerId;for(const r of t.junctionSources?t.junctionSources:[])if(r.sourceId===i)return r.layerId}return null}return null}async queryNamedTraceConfigurations(i,e){var s;const{queryNamedTraceConfigurations:t}=await j(()=>import("./queryNamedTraceConfigurations-e4f9e156.js"),["assets/queryNamedTraceConfigurations-e4f9e156.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/typedArrayUtil-4d7bb04c.js","assets/promiseUtils-1e54421e.js","assets/normalizeUtils-27e29a72.js","assets/Polyline-ff2d7c6b.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/jsonUtils-229211af.js","assets/geometry-b7901087.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js","assets/Graphic-f0e54e86.js","assets/PopupTemplate-40f3c9aa.js","assets/Clonable-545593ce.js","assets/Collection-910b6f71.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/fieldUtils-7f54c4b1.js","assets/arcadeOnDemand-281a01eb.js","assets/enumeration-3a03bd31.js","assets/number-27cf8195.js","assets/locale-30120714.js","assets/Identifiable-bfe1ff30.js","assets/symbols-f8232671.js","assets/CIMSymbol-539bd447.js","assets/Symbol-f93ed9fd.js","assets/Color-fb64d77d.js","assets/colorUtils-639f4d25.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/screenUtils-410d12c0.js","assets/opacityUtils-1f7f5126.js","assets/symbolLayerUtils3D-76acc268.js","assets/aaBoundingBox-657a9b82.js","assets/aaBoundingRect-193543b5.js","assets/persistableUrlUtils-5f719c3b.js","assets/Symbol3DAnchorPosition2D-5726d999.js","assets/collectionUtils-803d9ba8.js","assets/Portal-2bb189b3.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/PortalGroup-8e41557a.js","assets/PortalUser-659cc1d2.js","assets/Cyclical-151bcc41.js","assets/CollectionFlattener-8f4d518b.js","assets/reactiveUtils-4dabbb80.js","assets/workers-6e30d081.js","assets/Connection-9a1cf8da.js","assets/Queue-b7d3cd48.js","assets/assets-8d3e737a.js","assets/intl-65a3e389.js","assets/messages-2289086c.js","assets/projection-290b739f.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/zscale-89472cba.js","assets/TileInfo-b0eb8c90.js","assets/widget-fb292a2f.js","assets/uuid-73213768.js","assets/HandleOwner-9b396af1.js","assets/byteSizeEstimations-f0cab514.js","assets/executeQueryJSON-2fe748db.js","assets/query-694f7287.js","assets/pbfQueryUtils-4adda2cc.js","assets/pbf-0e99a620.js","assets/OptimizedFeature-4ab8d380.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1481fa99.js","assets/FeatureSet-d32b0eb8.js","assets/Field-61ec9870.js","assets/fieldType-f31285f7.js","assets/Query-b96bcde0.js","assets/TimeExtent-23e282b9.js","assets/RelationshipQuery-0dda77ad.js","assets/LegendOptions-010d0873.js","assets/utils-6786b611.js","assets/asyncUtils-437defc4.js","assets/parser-498c8be0.js","assets/mat4f32-77b3d8ac.js","assets/ItemCache-fd3aceaf.js","assets/MemCache-18a255ed.js","assets/jsonUtils-f5674613.js","assets/UniqueValueRenderer-08f8851c.js","assets/diffUtils-68b89c71.js","assets/colorRamps-9dac42c1.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-18d58939.js","assets/lengthUtils-fa751420.js","assets/jsonUtils-0ff4ff96.js","assets/styleUtils-22b14a8b.js","assets/DictionaryLoader-1cbfea53.js","assets/LRUCache-64ec42ee.js","assets/deprecate-035b199e.js","assets/heatmapUtils-aaea3f32.js","assets/vec4f64-e407da96.js","assets/featureConversionUtils-03a03f40.js","assets/TopFeaturesQuery-cad97c37.js","assets/FeatureLayer-041050b6.js","assets/MultiOriginJSONSupport-aae3bc0c.js","assets/LayerFloorInfo-54b916a2.js","assets/FeatureLayerBase-ad5cfa1a.js","assets/HeightModelInfo-5d01231e.js","assets/arcgisLayerUrl-c09f09b4.js","assets/OperationalLayer-97084f13.js","assets/ElevationInfo-215614d8.js","assets/Layer-5ffe0eda.js","assets/editsZScale-6a661299.js","assets/APIKeyMixin-a0a8917a.js","assets/ArcGISService-21dc1d06.js","assets/BlendLayer-20d0571b.js","assets/CustomParametersMixin-47aab0a6.js","assets/EditBusLayer-e750b15b.js","assets/FeatureReductionLayer-d69dae71.js","assets/labelingInfo-607e66b8.js","assets/labelUtils-3108e8d7.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-af7a6030.js","assets/PortalLayer-b2643f87.js","assets/PortalItem-bb7e98a6.js","assets/RefreshableLayer-7f154951.js","assets/ScaleRangeLayer-4be07229.js","assets/TemporalLayer-61549309.js","assets/TimeInfo-1d30dc7c.js","assets/FeatureTemplate-c1d0bb70.js","assets/FeatureType-34d71ade.js","assets/fieldProperties-e2eeb1d5.js","assets/FieldsIndex-f104cc5f.js","assets/versionUtils-fd91f55f.js","assets/styleUtils-a989c0af.js","assets/popupUtils-86dc6b94.js","assets/mat2d-2bbb5feb.js","assets/Scheduler-540208b6.js","assets/Basemap-af7f62f8.js","assets/loadAll-b5bfa7ab.js","assets/writeUtils-e686bd33.js","assets/layerUtils-f4d08f94.js","assets/TablesMixin-bc97d131.js","assets/GraphicsCollection-c37a9ffd.js","assets/ViewingMode-5d7d590b.js","assets/enums-0fc02184.js","assets/vec2-528adfe4.js","assets/vec2f64-30dc1443.js","assets/mat3-3fc68e72.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-a90cd1af.js","assets/TileStore-00ac650f.js","assets/TileKey-5aef17b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-302cf20d.js","assets/context-util-a4ce3a7b.js","assets/BoundsStore-b9fa27cc.js","assets/PooledRBush-3e149119.js","assets/mat3f64-c6305894.js","assets/sphere-2af0d852.js","assets/mat4f64-1e28eae0.js","assets/quatf64-7fd38d64.js","assets/lineSegment-10422ca0.js","assets/plane-b575face.js","assets/scaleUtils-93ad8d0c.js","assets/ElevationSamplerData-b87e0e50.js","assets/PhysicallyBasedRendering.glsl-d457fff5.js","assets/View.glsl-3ce196d4.js","assets/ShaderBuilder-a7d0da4e.js","assets/FloatPassUniform-68d54f51.js","assets/Float4PassUniform-d7bdbc81.js","assets/RgbaFloatEncoding.glsl-52af7fcf.js","assets/Texture2DPassUniform-753de459.js","assets/vec3f32-c9aa289f.js","assets/VertexAttribute-9c5c630d.js","assets/Texture2DDrawUniform-053796dc.js","assets/basicInterfaces-19ed850e.js","assets/PiUtils.glsl-db6418ee.js","assets/ReadLinearDepth.glsl-9c87a54a.js","assets/WaterSurface.glsl-c64cb8f1.js","assets/ForwardLinearDepth.glsl-56affafd.js","assets/Matrix3PassUniform-ad9f953b.js","assets/Slice.glsl-3b39b1f7.js","assets/Transform.glsl-6d2e2fd9.js","assets/OutputHighlight.glsl-fbac199a.js","assets/MultipassTerrainTest.glsl-bb236672.js","assets/NormalUtils.glsl-c12729bf.js","assets/AlphaCutoff-96178e0d.js","assets/TransparencyPassType-a11868d2.js","assets/EvaluateSceneLighting.glsl-189abc15.js","assets/VisualVariablePassParameters-d460182b.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/FramebufferObject-a3b9c52c.js","assets/Texture-243be4d7.js","assets/Util-a48361c6.js","assets/SSAOBlur.glsl-8bf33b65.js","assets/ScreenSpacePass-d5e48a9b.js","assets/SSAO.glsl-980b3771.js","assets/ShaderTechniqueConfiguration-9f5b4555.js","assets/HUD.glsl-d3a072ad.js","assets/VerticalOffset.glsl-87cbb2e3.js","assets/objectResourceUtils-d556a033.js","assets/devEnvironmentUtils-5002a058.js","assets/BufferView-903d1848.js","assets/vec33-e98769e8.js","assets/DefaultMaterial_COLOR_GAMMA-fe26fda8.js","assets/types-e1c0a5bf.js","assets/Version-2946cc03.js","assets/quat-3d5eec2d.js","assets/Texture-46c8c2cb.js","assets/TextureOnly.glsl-1ec9a9ef.js","assets/InterleavedLayout-984d67b2.js","assets/MixExternalColor.glsl-ab0706f7.js","assets/symbolColorUtils-b2b55883.js","assets/ObjectAndLayerIdColor.glsl-ad468647.js","assets/OutputDepth.glsl-470c8e2a.js","assets/VisualVariables.glsl-2b937327.js","assets/DiscardOrAdjustAlphaBlend.glsl-73258f38.js","assets/Normals.glsl-76f97814.js","assets/DefaultMaterial.glsl-885671b3.js","assets/VertexColor.glsl-8c022fa8.js","assets/DefaultTechniqueConfiguration-588e5ab2.js","assets/RealisticTree.glsl-b6cc03f2.js","assets/edgeProcessing-f733ce76.js","assets/deduplicate-03981d62.js","assets/projection-a69d43d0.js","assets/Octree-0a267ea2.js","assets/HUDMaterial.glsl-32cf019c.js","assets/sdfPrimitives-9858c36d.js","assets/floatRGBA-9ad35d39.js","assets/dehydratedFeatures-0557137d.js","assets/quantizationUtils-4dd81f85.js","assets/labelFormatUtils-d25d1d9e.js","assets/I3SUtil-f31a4571.js","assets/I3SBinaryReader-f4829435.js","assets/LineCallout.glsl-358ef89b.js","assets/earcut-58237617.js","assets/SnappingCandidate-970faec6.js","assets/MeshComponent-a43522cc.js","assets/MarkerSizing.glsl-566261cc.js","assets/RibbonLine.glsl-0f7c2bbc.js","assets/LineStipple.glsl-ed22a88b.js","assets/callExpressionWithFeature-55effb7b.js","assets/LineMarker.glsl-8166d610.js","assets/NativeLine.glsl-742e9e29.js","assets/Path.glsl-9f6bab44.js","assets/ColorMaterial.glsl-3a70e4a7.js","assets/Pattern.glsl-67f4595b.js","assets/DefaultVertexAttributeLayouts-2bcf3941.js","assets/LercDecoder-4c9b29b3.js","assets/config-1337d16e.js","assets/workerHelper-e756ac3a.js","assets/originUtils-1469eeaf.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/portalItemUtils-2ccd793f.js"]),r=this.networkServiceUrl,n=new V$e({...i});return((s=await t(r,n,{...e}))==null?void 0:s.namedTraceConfigurations)??null}async validateNetworkTopology(i,e){if(!i.validateArea)throw new J("network:undefined-validateArea","the network must have validateArea defined in the validate network topology parameters.");const{validateNetworkTopology:t}=await j(()=>import("./validateNetworkTopology-611f19f6.js"),["assets/validateNetworkTopology-611f19f6.js","assets/request-6fc81c4c.js","assets/preload-helper-3bce6601.js","assets/Error-ec6249b9.js","assets/string-a318751c.js","assets/typedArrayUtil-4d7bb04c.js","assets/promiseUtils-1e54421e.js","assets/normalizeUtils-27e29a72.js","assets/Polyline-ff2d7c6b.js","assets/cast-fcb46737.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/jsonUtils-229211af.js","assets/geometry-b7901087.js","assets/typeUtils-35750739.js","assets/jsonMap-7b8332c9.js"]),r=this.networkServiceUrl,n=new U$e({...i,returnEdits:!0}),s=await t(r,n,{...e});if(s!=null&&s.serviceEdits){const a={edits:null,addedFeatures:[],updatedFeatures:[],deletedFeatures:[],addedAttachments:[],updatedAttachments:[],deletedAttachments:[],editedFeatures:s.serviceEdits};doe.emit("edits",{serviceUrl:this.featureServiceUrl??"",layerId:null,event:a})}return s}async _fetchLayerMetaData(i,e){const t=await Wh(i,{responseType:"json",query:{f:"json"},...e});this.sourceJSON=t.data,this.read(t.data,{origin:"service"})}async _fetchDataElement(i,e,t){if(this.dataElement)return;const r=await Wh(`${i}/queryDataElements`,{responseType:"json",query:{layers:JSON.stringify([e]),f:"json"},...t}).then(n=>{var s;return(s=n.data.layerDataElements)==null?void 0:s[0]});r&&this.read(r,{origin:"service"})}};h([p({type:String,nonNullable:!0,json:{origins:{"web-map":{read:!0,write:{isRequired:!0}},service:{read:!0}},read:!1}})],An.prototype,"id",void 0),h([p({type:String,nonNullable:!0,json:{origins:{"web-map":{read:!0,write:{isRequired:!0}},service:{read:{source:"name"}}},read:!1}})],An.prototype,"title",void 0),h([p({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"url"},write:{target:"url",isRequired:!0}}},read:!1}})],An.prototype,"layerUrl",void 0),h([p({type:Object,json:{origins:{service:{read:!0}},read:!1}})],An.prototype,"dataElement",void 0),h([p({type:pi,json:{origins:{service:{read:{source:"extent"}}},read:!1}})],An.prototype,"fullExtent",void 0),h([p({type:Zt,json:{origins:{service:{read:{source:"extent.spatialReference"}}},read:!1}})],An.prototype,"spatialReference",void 0),h([p({type:["utility","trace"],readOnly:!0,json:{read:!1,write:!1}})],An.prototype,"type",void 0),h([p({readOnly:!0})],An.prototype,"datasetName",null),h([p({readOnly:!0})],An.prototype,"owner",null),h([p({readOnly:!0})],An.prototype,"schemaGeneration",null),h([p({readOnly:!0})],An.prototype,"parsedUrl",null),h([p({readOnly:!0})],An.prototype,"featureServiceUrl",null),h([p({readOnly:!0})],An.prototype,"networkServiceUrl",null),h([p({readOnly:!0})],An.prototype,"layerId",null),h([p()],An.prototype,"sourceJSON",void 0),h([p({readOnly:!0})],An.prototype,"networkSystemLayers",null),An=h([F("esri.networks.Network")],An);const z$e=An;let jf=class extends I7(Om){constructor(e){super(e),this.request=Wh}initialize(){}async load(e){const t=this.layer.load(e).then(()=>this._initializeRulesTable());return this.addResolvingPromise(t),this}getFeatureSQL(e,t){var c,u;const r=e.layerId.toString(),n=(c=e.fieldsIndex)==null?void 0:c.normalizeFieldName("assetGroup"),s=(u=e.fieldsIndex)==null?void 0:u.normalizeFieldName("assetType"),a=n?t.attributes[n]:null,o=s?t.attributes[s]:null,l=this.rulesHash[r];if(l){const d=l.assetGroupHash[a];if(d)return d.assetTypeHash[o]||null}return null}async _initializeRulesTable(){var n,s,a,o,l,c,u,d,m,f;const e={};let t;(function(_){_[_.from=0]="from",_[_.to=1]="to",_[_.via=2]="via"})(t||(t={}));const r=[{networkSourceId:"fromNetworkSource",assetGroupId:"fromAssetGroup",assetTypeId:"fromAssetType"},{networkSourceId:"toNetworkSource",assetGroupId:"toAssetGroup",assetTypeId:"toAssetType"},{networkSourceId:"viaNetworkSource",assetGroupId:"viaAssetGroup",assetTypeId:"viaAssetType"}];for(const _ of this.rules){if(_.ruleType!==Wo.RTJunctionJunctionConnectivity&&_.ruleType!==Wo.RTJunctionEdgeConnectivity&&_.ruleType!==Wo.RTEdgeJunctionEdgeConnectivity)continue;let g=[[t.from,t.to],[t.to,t.from]];_.ruleType===Wo.RTEdgeJunctionEdgeConnectivity&&(g=[[t.from,t.via],[t.via,t.from],[t.to,t.via],[t.via,t.to]]);for(const w of g){const v=w.shift(),b=w.shift();let x=!1;switch(_.ruleType){case Wo.RTEdgeJunctionEdgeConnectivity:x=v===t.from||v===t.to;break;case Wo.RTJunctionEdgeConnectivity:x=v===t.to}const T=r[v],R=_[T.networkSourceId].layerId.toString(),E=(s=(n=_[T.assetGroupId])==null?void 0:n.assetGroupCode)==null?void 0:s.toString(),O=(o=(a=_[T.assetTypeId])==null?void 0:a.assetTypeCode)==null?void 0:o.toString(),$=r[b],D=_[$.networkSourceId].layerId.toString(),I=(c=(l=_[$.assetGroupId])==null?void 0:l.assetGroupCode)==null?void 0:c.toString(),G=_[$.assetTypeId],W=(u=G==null?void 0:G.assetTypeCode)==null?void 0:u.toString(),re=e[R]?e[R]:{assetGroupHash:{}};if(!(E&&O&&I&&W))continue;const te=re.assetGroupHash[E]?re.assetGroupHash[E]:{assetTypeHash:{}},H=te.assetTypeHash[O]?te.assetTypeHash[O]:{};if(H[D]=H[D]?H[D]:{},x){H[R]=H[R]?H[R]:{};const U=`(assetgroup = ${E} AND assettype = ${O})`;H[R].anyVertex=H[R].anyVertex?`${H[R].anyVertex}`:`${U}`,G.connectivityPolicy==="esriNECPEndVertex"&&(H[R].endVertex=(d=H[R])!=null&&d.endVertex?`${H[R].endVertex}`:`${U}`)}const M=`(assetgroup = ${I} AND assettype = ${W})`;H[D].anyVertex=(m=H[D])!=null&&m.anyVertex?`${H[D].anyVertex} OR ${M}`:`${M}`,G.connectivityPolicy==="esriNECPEndVertex"&&(H[D].endVertex=(f=H[D])!=null&&f.endVertex?`${H[D].endVertex} OR ${M}`:`${M}`),te.assetTypeHash[O]=H,re.assetGroupHash[E]=te,e[R]=re}}this.rulesHash=e}};h([p({constructOnly:!0})],jf.prototype,"layer",void 0),h([p({constructOnly:!0})],jf.prototype,"rules",void 0),h([p()],jf.prototype,"rulesHash",void 0),h([p({constructOnly:!0})],jf.prototype,"request",void 0),jf=h([F("esri.networks.RulesTable")],jf);const B$e=jf;let yl=class extends xt{constructor(e){super(e),this.conditionBarriers=[],this.outputConditions=[],this.functions=[],this.functionBarriers=[],this.traversabilityScope=null,this.shortestPathNetworkAttributeName=null,this.includeBarriers=null,this.validateConsistency=null,this.ignoreBarriersAtStartingPoints=null}};h([p({type:[Object],json:{write:!0}})],yl.prototype,"conditionBarriers",void 0),h([p({type:[Object],json:{write:!0}})],yl.prototype,"outputConditions",void 0),h([p({type:[Object],json:{write:!0}})],yl.prototype,"functions",void 0),h([p({type:[Object],json:{write:!0}})],yl.prototype,"functionBarriers",void 0),h([p({type:["junctions","edges","junctionsAndEdges"],json:{write:!0}})],yl.prototype,"traversabilityScope",void 0),h([p({type:String,json:{write:!0}})],yl.prototype,"shortestPathNetworkAttributeName",void 0),h([p({type:Boolean,json:{write:!0}})],yl.prototype,"includeBarriers",void 0),h([p({type:Boolean,json:{write:!0}})],yl.prototype,"validateConsistency",void 0),h([p({type:Boolean,json:{write:!0}})],yl.prototype,"ignoreBarriersAtStartingPoints",void 0),yl=h([F("esri.networks.support.TraceConfiguration")],yl);const h5=yl;let Qr=class extends h5{constructor(e){super(e),this.filterBarriers=[],this.domainNetworkName=null,this.filterBitsetNetworkAttributeName=null,this.filterFunctionBarriers=[],this.filterScope=null,this.includeContainers=null,this.includeContent=null,this.includeIsolated=null,this.includeStructures=null,this.includeUpToFirstSpatialContainer=null,this.nearestNeighbor=null,this.outputFilterCategories=[],this.outputFilters=[],this.propagators=[],this.subnetworkName=null,this.targetTierName=null,this.tierName=null,this.validateLocatability=null}};h([p({type:[Object],json:{write:!0}})],Qr.prototype,"filterBarriers",void 0),h([p({type:String,json:{write:!0}})],Qr.prototype,"domainNetworkName",void 0),h([p({type:String,json:{write:!0}})],Qr.prototype,"filterBitsetNetworkAttributeName",void 0),h([p({type:[Object],json:{write:!0}})],Qr.prototype,"filterFunctionBarriers",void 0),h([p({type:["junctions","edges","junctionsAndEdges"],json:{write:!0}})],Qr.prototype,"filterScope",void 0),h([p({type:Boolean,json:{write:!0}})],Qr.prototype,"includeContainers",void 0),h([p({type:Boolean,json:{write:!0}})],Qr.prototype,"includeContent",void 0),h([p({type:Boolean,json:{write:!0}})],Qr.prototype,"includeIsolated",void 0),h([p({type:Boolean,json:{write:!0}})],Qr.prototype,"includeStructures",void 0),h([p({type:Boolean,json:{write:!0}})],Qr.prototype,"includeUpToFirstSpatialContainer",void 0),h([p({type:Object,json:{write:!0}})],Qr.prototype,"nearestNeighbor",void 0),h([p({type:[Object],json:{write:!0}})],Qr.prototype,"outputFilterCategories",void 0),h([p({type:[Object],json:{write:!0}})],Qr.prototype,"outputFilters",void 0),h([p({type:[Object],json:{write:!0}})],Qr.prototype,"propagators",void 0),h([p({type:String,json:{write:!0}})],Qr.prototype,"subnetworkName",void 0),h([p({type:String,json:{write:!0}})],Qr.prototype,"targetTierName",void 0),h([p({type:String,json:{write:!0}})],Qr.prototype,"tierName",void 0),h([p({type:Boolean,json:{write:!0}})],Qr.prototype,"validateLocatability",void 0),Qr=h([F("esri.networks.support.UNTraceConfiguration")],Qr);const G$e=Qr;let Ya=class extends VH{constructor(e){super(e),this.globalId=null,this.title=null,this.traceConfiguration=null,this.creationDate=null,this.creator=null,this.description=null,this.minStartingPoints=null,this.resultTypes=[],this.tags=[],this.traceType=null}readTraceConfiguration(e,t){return e.tierName!==void 0?G$e.fromJSON(e):h5.fromJSON(e)}};h([p({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"id"},write:{target:"id",isRequired:!0}},service:{read:{source:"globalId"},write:{target:"globalId",isRequired:!0}}},read:!1}})],Ya.prototype,"globalId",void 0),h([p({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"title"},write:{target:"title",isRequired:!0}},service:{read:{source:"name"},write:{target:"name",isRequired:!0}}},read:!1}})],Ya.prototype,"title",void 0),h([p({type:h5,json:{origins:{service:{read:!0,write:!0}},read:!1}})],Ya.prototype,"traceConfiguration",void 0),h([Dl("service","traceConfiguration")],Ya.prototype,"readTraceConfiguration",null),h([p({type:Date,json:{origins:{service:{read:!0,write:!0}},read:!1}})],Ya.prototype,"creationDate",void 0),h([p({type:String,json:{origins:{service:{read:!0,write:!0}},read:!1}})],Ya.prototype,"creator",void 0),h([p({type:String,json:{origins:{service:{read:!0,write:!0}},read:!1}})],Ya.prototype,"description",void 0),h([p({type:["none","one","many"],json:{origins:{service:{read:{source:"minNumStartingPoints"},write:{target:"minNumStartingPoints"}}},read:!1}})],Ya.prototype,"minStartingPoints",void 0),h([p({type:[Object],json:{origins:{service:{read:!0,write:!0}},read:!1}})],Ya.prototype,"resultTypes",void 0),h([p({type:[String],json:{origins:{service:{read:!0,write:!0}},read:!1}})],Ya.prototype,"tags",void 0),h([p({type:_S.apiValues,json:{type:_S.jsonValues,origins:{service:{read:_S.read,write:_S.write}},read:!1}})],Ya.prototype,"traceType",void 0),Ya=h([F("esri.networks.support.NamedTraceConfiguration")],Ya);const H$e=Ya;let qu=class extends pe{constructor(e){super(e),this.rulesTableId=null,this.rulesTableUrl=null,this.subnetworksTableId=null,this.subnetworksTableUrl=null,this.dirtyAreasLayerId=null,this.dirtyAreasLayerUrl=null}};h([p({constructOnly:!0})],qu.prototype,"rulesTableId",void 0),h([p({constructOnly:!0})],qu.prototype,"rulesTableUrl",void 0),h([p({constructOnly:!0})],qu.prototype,"subnetworksTableId",void 0),h([p({constructOnly:!0})],qu.prototype,"subnetworksTableUrl",void 0),h([p({constructOnly:!0})],qu.prototype,"dirtyAreasLayerId",void 0),h([p({constructOnly:!0})],qu.prototype,"dirtyAreasLayerUrl",void 0),qu=h([F("esri.networks.support.NetworkSystemLayers")],qu);const j$e=qu;let Ny=class extends xt{constructor(e){super(e),this.id=null,this.name=null}};h([p({type:Number,json:{read:{source:"terminalId"},write:{target:"terminalId"}}})],Ny.prototype,"id",void 0),h([p({type:String,json:{read:{source:"terminalName"},write:{target:"terminalName"}}})],Ny.prototype,"name",void 0),h([p({type:Boolean,json:{write:!0}})],Ny.prototype,"isUpstreamTerminal",void 0),Ny=h([F("esri.networks.support.Terminal")],Ny);const q$e=Ny,vS=new Vd({esriUNTMBidirectional:"bidirectional",esriUNTMDirectional:"directional"});let Dp=class extends xt{constructor(e){super(e),this.defaultConfiguration=null,this.id=null,this.name=null,this.terminals=[],this.traversabilityModel=null}};h([p({type:String,json:{write:!0}})],Dp.prototype,"defaultConfiguration",void 0),h([p({type:Number,json:{read:{source:"terminalConfigurationId"},write:{target:"terminalConfigurationId"}}})],Dp.prototype,"id",void 0),h([p({type:String,json:{read:{source:"terminalConfigurationName"},write:{target:"terminalConfigurationName"}}})],Dp.prototype,"name",void 0),h([p({type:[q$e],json:{write:!0}})],Dp.prototype,"terminals",void 0),h([p({type:vS.apiValues,json:{type:vS.jsonValues,read:vS.read,write:vS.write}})],Dp.prototype,"traversabilityModel",void 0),Dp=h([F("esri.networks.support.TerminalConfiguration")],Dp);const _7=Dp,W$e="esri.networks.UtilityNetwork",bS=ee.getLogger(W$e);let Do=class extends z$e{constructor(e){super(e),this.sharedNamedTraceConfigurations=[],this.type="utility"}get serviceTerritoryFeatureLayerId(){var e;return((e=this.dataElement)==null?void 0:e.serviceTerritoryFeatureLayerId)??null}get networkSystemLayers(){var e,t,r,n,s,a;return new j$e({rulesTableId:(e=this.sourceJSON)==null?void 0:e.systemLayers.rulesTableId,rulesTableUrl:this.sourceJSON?`${this.featureServiceUrl}/${(t=this.sourceJSON)==null?void 0:t.systemLayers.rulesTableId}`:null,subnetworksTableId:(r=this.sourceJSON)==null?void 0:r.systemLayers.subnetworksTableId,subnetworksTableUrl:this.sourceJSON?`${this.featureServiceUrl}/${(n=this.sourceJSON)==null?void 0:n.systemLayers.subnetworksTableId}`:null,dirtyAreasLayerId:(s=this.sourceJSON)==null?void 0:s.systemLayers.dirtyAreasLayerId,dirtyAreasLayerUrl:this.sourceJSON?`${this.featureServiceUrl}/${(a=this.sourceJSON)==null?void 0:a.systemLayers.dirtyAreasLayerId}`:null})}get rulesTableId(){var e;return vT(bS,"rulesTableId",{replacement:"networkSystemLayers.rulesTableId"}),(e=this.sourceJSON)==null?void 0:e.systemLayers.rulesTableId}get rulesTableUrl(){return vT(bS,"rulesTableUrl",{replacement:"networkSystemLayers.rulesTableUrl"}),this.sourceJSON?`${this.featureServiceUrl}/${this.networkSystemLayers.rulesTableId}`:null}get subnetworksTableId(){var e;return vT(bS,"subnetworksTableId",{replacement:"networkSystemLayers.subnetworksTableId"}),(e=this.sourceJSON)==null?void 0:e.systemLayers.subnetworksTableId}get subnetworksTableUrl(){return vT(bS,"subnetworksTableUrl",{replacement:"networkSystemLayers.subnetworksTableUrl"}),this.sourceJSON?`${this.featureServiceUrl}/${this.networkSystemLayers.subnetworksTableId}`:null}get terminalConfigurations(){var e;return((e=this.dataElement)==null?void 0:e.terminalConfigurations.map(t=>_7.fromJSON(t)))||[]}get domainNetworkNames(){var e;return((e=this.dataElement)==null?void 0:e.domainNetworks.map(t=>t.domainNetworkName))||[]}get _utilityLayerList(){var t,r;const e=new Set;return(r=(t=this.dataElement)==null?void 0:t.domainNetworks)==null||r.map(n=>{n.edgeSources.map(s=>{e.add(s.layerId)}),n.junctionSources.map(s=>{e.add(s.layerId)})}),e}async load(e){return this.addResolvingPromise(super.load(e)),this.addResolvingPromise(this._loadNamedTraceConfigurationsFromNetwork(e)),this}getTerminalConfiguration(e){var c,u,d,m;let t=null,r=null;const n=e.layer;let s=null;if((n==null?void 0:n.type)!=="feature"||(s=n.layerId,s===null))return null;const a=e.attributes;if(a==null)return null;for(const f of Object.keys(a))f.toUpperCase()==="ASSETGROUP"&&(t=e.getAttribute(f)),f.toUpperCase()==="ASSETTYPE"&&(r=e.getAttribute(f));if(!this.dataElement)return null;let o=null;const l=this.dataElement.domainNetworks;for(const f of l){const _=(c=f.junctionSources)==null?void 0:c.find(g=>g.layerId===s);if(_){const g=(u=_.assetGroups)==null?void 0:u.find(w=>w.assetGroupCode===t);if(g){const w=(d=g.assetTypes)==null?void 0:d.find(v=>v.assetTypeCode===r);if(w){o=w.terminalConfigurationId;break}}}}if(o!=null){const f=(m=this.dataElement.terminalConfigurations)==null?void 0:m.find(_=>_.terminalConfigurationId===o);return f?_7.fromJSON(f):null}return null}getTierNames(e){var r;const t=(r=this.dataElement)==null?void 0:r.domainNetworks.find(n=>n.domainNetworkName===e);return(t==null?void 0:t.tiers.map(n=>n.name))||[]}async getRulesTable(){return this._createRulesTable()}isUtilityLayer(e){return this._utilityLayerList.has(e.layerId)}async _loadNamedTraceConfigurationsFromNetwork(e){var n;if(((n=this.sharedNamedTraceConfigurations)==null?void 0:n.length)===0)return;const t=this.sharedNamedTraceConfigurations.map(s=>s.globalId),r=await this.queryNamedTraceConfigurations({globalIds:t},e);for(const s of this.sharedNamedTraceConfigurations){const a=r==null?void 0:r.find(o=>o.globalId===s.globalId);if(a){const o=a.write({},{origin:"service"});s.read(o,{origin:"service"})}}}async _createRulesTable(){var s;const e=new lG({url:this.rulesTableUrl});await e.load();const t=(s=this.dataElement)==null?void 0:s.domainNetworks;if(!t)return null;const r=t.flatMap(a=>[...a.edgeSources,...a.junctionSources]),n=(await this._queryRulesTable(e)).map(a=>this._hydrateRuleInfo(e,r,a));return new B$e({layer:e,rules:n})}async _queryRulesTable(e){const t=new $b({where:"1=1",outFields:["*"]});return(await D$e(e,t)).features}_hydrateRuleInfo(e,t,r){const n=e.fieldsIndex,s=n.get("RULETYPE"),a=n.get("CREATIONDATE"),o=n.get("FROMNETWORKSOURCEID"),l=n.get("FROMASSETGROUP"),c=n.get("FROMASSETTYPE"),u=n.get("FROMTERMINALID"),d=n.get("TONETWORKSOURCEID"),m=n.get("TOASSETGROUP"),f=n.get("TOASSETTYPE"),_=n.get("TOTERMINALID"),g=n.get("VIANETWORKSOURCEID"),w=n.get("VIAASSETGROUP"),v=n.get("VIAASSETTYPE"),b=n.get("VIATERMINALID"),x=r.attributes[s.name],T=new Date(r.attributes[a.name]),R=[{networkSourceId:r.attributes[o.name],assetGroupId:r.attributes[l.name],assetTypeId:r.attributes[c.name],terminalId:r.attributes[u.name]},{networkSourceId:r.attributes[d.name],assetGroupId:r.attributes[m.name],assetTypeId:r.attributes[f.name],terminalId:r.attributes[_.name]},{networkSourceId:r.attributes[g.name],assetGroupId:r.attributes[w.name],assetTypeId:r.attributes[v.name],terminalId:r.attributes[b.name]}];let E;(function($){$[$.from=0]="from",$[$.to=1]="to",$[$.via=2]="via"})(E||(E={}));const O={ruleType:x,creationDate:T};for(const $ of[E.from,E.to,E.via]){if(x!==Wo.RTEdgeJunctionEdgeConnectivity&&$===E.via)continue;const D=R[$],I=t.find(H=>H.sourceId===D.networkSourceId),G=I==null?void 0:I.assetGroups.find(H=>H.assetGroupCode===D.assetGroupId),W=G==null?void 0:G.assetTypes.find(H=>H.assetTypeCode===D.assetTypeId);let re=this._getTerminal(x,W,D);x!==Wo.RTContainment&&x!==Wo.RTAttachment||(re=null);let te="";switch($){case E.from:te="from";break;case E.to:te="to";break;case E.via:te="via"}O[`${te}NetworkSource`]=I,O[`${te}AssetGroup`]=G,O[`${te}AssetType`]=W,O[`${te}Terminal`]=re}return O}_getTerminal(e,t,r){var a,o;if(e===Wo.RTAttachment||e===Wo.RTContainment)return null;const n=t==null?void 0:t.terminalConfigurationId,s=(a=this.terminalConfigurations)==null?void 0:a.find(l=>l.id===n);return((o=s==null?void 0:s.terminals)==null?void 0:o.find(l=>l.id===r.terminalId))??null}};h([p({type:[H$e],json:{origins:{"web-map":{read:{source:"traceConfigurations"},write:{target:"traceConfigurations"}},service:{read:{source:"traceConfigurations"}}},read:!1}})],Do.prototype,"sharedNamedTraceConfigurations",void 0),h([p({type:["utility"],readOnly:!0,json:{read:!1,write:!1}})],Do.prototype,"type",void 0),h([p({readOnly:!0})],Do.prototype,"serviceTerritoryFeatureLayerId",null),h([p({readOnly:!0})],Do.prototype,"networkSystemLayers",null),h([p({readOnly:!0})],Do.prototype,"rulesTableId",null),h([p({readOnly:!0})],Do.prototype,"rulesTableUrl",null),h([p({readOnly:!0})],Do.prototype,"subnetworksTableId",null),h([p({readOnly:!0})],Do.prototype,"subnetworksTableUrl",null),h([p({readOnly:!0})],Do.prototype,"terminalConfigurations",null),h([p({readOnly:!0})],Do.prototype,"domainNetworkNames",null),Do=h([F("esri.networks.UtilityNetwork")],Do);const rte=Do,X$e=Object.freeze(Object.defineProperty({__proto__:null,default:rte},Symbol.toStringTag,{value:"Module"}));let Fp=class extends xt{constructor(e){super(e),this.facilityIdField=null,this.layerId=null,this.nameField=null,this.siteIdField=null,this.sublayerId=null}};h([p({type:String,json:{write:!0}})],Fp.prototype,"facilityIdField",void 0),h([p({type:String,json:{write:!0}})],Fp.prototype,"layerId",void 0),h([p({type:String,json:{write:!0}})],Fp.prototype,"nameField",void 0),h([p({type:String,json:{write:!0}})],Fp.prototype,"siteIdField",void 0),h([p({type:Number,json:{read:{source:"subLayerId"},write:{target:"subLayerId"},origins:{"web-scene":{read:!1,write:!1}}}})],Fp.prototype,"sublayerId",void 0),Fp=h([F("esri.layers.support.FacilityLayerInfo")],Fp);const Q$e=Fp;let cc=class extends xt{constructor(e){super(e),this.facilityIdField=null,this.layerId=null,this.levelIdField=null,this.levelNumberField=null,this.longNameField=null,this.shortNameField=null,this.sublayerId=null,this.verticalOrderField=null}};h([p({type:String,json:{write:!0}})],cc.prototype,"facilityIdField",void 0),h([p({type:String,json:{write:!0}})],cc.prototype,"layerId",void 0),h([p({type:String,json:{write:!0}})],cc.prototype,"levelIdField",void 0),h([p({type:String,json:{write:!0}})],cc.prototype,"levelNumberField",void 0),h([p({type:String,json:{write:!0}})],cc.prototype,"longNameField",void 0),h([p({type:String,json:{write:!0}})],cc.prototype,"shortNameField",void 0),h([p({type:Number,json:{read:{source:"subLayerId"},write:{target:"subLayerId"},origins:{"web-scene":{read:!1,write:!1}}}})],cc.prototype,"sublayerId",void 0),h([p({type:String,json:{write:!0}})],cc.prototype,"verticalOrderField",void 0),cc=h([F("esri.layers.support.LevelLayerInfo")],cc);const Z$e=cc;let qf=class extends xt{constructor(e){super(e),this.layerId=null,this.nameField=null,this.siteIdField=null,this.sublayerId=null}};h([p({type:String,json:{write:!0}})],qf.prototype,"layerId",void 0),h([p({type:String,json:{write:!0}})],qf.prototype,"nameField",void 0),h([p({type:String,json:{write:!0}})],qf.prototype,"siteIdField",void 0),h([p({type:Number,json:{read:{source:"subLayerId"},write:{target:"subLayerId"},origins:{"web-scene":{read:!1,write:!1}}}})],qf.prototype,"sublayerId",void 0),qf=h([F("esri.layers.support.SiteLayerInfo")],qf);const Y$e=qf;let ky=class extends xt{constructor(e){super(e),this.levelLayer=null,this.facilityLayer=null,this.siteLayer=null}};h([p({type:Z$e,json:{write:!0}})],ky.prototype,"levelLayer",void 0),h([p({type:Q$e,json:{write:!0}})],ky.prototype,"facilityLayer",void 0),h([p({type:Y$e,json:{write:!0}})],ky.prototype,"siteLayer",void 0),ky=h([F("esri.support.MapFloorInfo")],ky);const K$e=ky;let Vy=class extends au(xt){constructor(e){super(e),this.expression=null,this.returnType="string",this.title=null}};h([p({type:String,json:{write:{isRequired:!0}}})],Vy.prototype,"expression",void 0),h([p({type:["number","string"],json:{write:!0}})],Vy.prototype,"returnType",void 0),h([p({type:String,json:{write:!0}})],Vy.prototype,"title",void 0),Vy=h([F("esri.webdoc.geotriggersInfo.ExpressionInfo")],Vy);const nte=Vy,wS=new Vd({deviceLocation:"device-location"});let Rb=class extends au(xt){constructor(e){super(e),this.filterExpression=null,this.type="device-location"}};h([p({type:nte,json:{write:!0}})],Rb.prototype,"filterExpression",void 0),h([p({type:wS.apiValues,readOnly:!0,json:{type:wS.jsonValues,read:wS.read,write:wS.write}})],Rb.prototype,"type",void 0),Rb=h([F("esri.webdoc.geotriggersInfo.DeviceLocationFeed")],Rb);const J$e=Rb;let Pb=class extends au(xt){constructor(e){super(e),this.geometry=null,this.where=null}};h([p({types:H7,json:{read:NE,write:!0}})],Pb.prototype,"geometry",void 0),h([p({type:String,json:{write:!0}})],Pb.prototype,"where",void 0),Pb=h([F("esri.webdoc.geotriggersInfo.FeatureFilter")],Pb);const eDe=Pb;let Uy=class extends au(xt){constructor(e){super(e),this.layerId=null,this.layerUrl=null,this.type="feature-layer"}};h([p({type:String,json:{write:{overridePolicy(){return{isRequired:this.layerUrl===null}}}}})],Uy.prototype,"layerId",void 0),h([p({type:String,json:{write:{overridePolicy(){return{isRequired:this.layerId===null}}}}})],Uy.prototype,"layerUrl",void 0),h([Pa({featureLayer:"feature-layer"},{readOnly:!0})],Uy.prototype,"type",void 0),Uy=h([F("esri.webdoc.geotriggersInfo.FeatureLayerSource")],Uy);const tDe=Uy;let Wf=class extends au(xt){constructor(e){super(e),this.fenceSource=null,this.filter=null,this.bufferDistance=null,this.type="features"}};h([p({type:tDe,json:{write:{isRequired:!0}}})],Wf.prototype,"fenceSource",void 0),h([p({type:eDe,json:{write:!0}})],Wf.prototype,"filter",void 0),h([p({type:Number,json:{write:!0}})],Wf.prototype,"bufferDistance",void 0),h([Pa({features:"features"},{readOnly:!0})],Wf.prototype,"type",void 0),Wf=h([F("esri.webdoc.geotriggersInfo.FeatureFenceParameters")],Wf);const iDe=Wf;let OE=class extends au(xt){constructor(e){super(e),this.type="fence"}};h([Pa({fence:"fence"},{readOnly:!0})],OE.prototype,"type",void 0),OE=h([F("esri.webdoc.geotriggersInfo.Geotrigger")],OE);const ste=OE;let Ab=class extends au(xt){constructor(e){super(e),this.expressionInfo=null,this.requestedActions=null}};h([p({type:nte,json:{write:!0}})],Ab.prototype,"expressionInfo",void 0),h([p({type:[String],json:{write:!0}})],Ab.prototype,"requestedActions",void 0),Ab=h([F("esri.webdoc.geotriggersInfo.GeotriggerNotificationOptions")],Ab);const rDe=Ab,nDe=new Vd({enterContainsAndExitDoesNotContain:"enter-contains-and-exit-does-not-contain",enterContainsAndExitDoesNotIntersect:"enter-contains-and-exit-does-not-intersect",enterIntersectsAndExitDoesNotIntersect:"enter-intersects-and-exit-does-not-intersect"}),sDe=new Vd({useGeometry:"use-geometry",useGeometryWithAccuracy:"use-geometry-with-accuracy"}),xS=new Vd({enter:"enter",enterOrExit:"enter-or-exit",exit:"exit"});let hc=class extends ste{constructor(e){super(e),this.enterExitRule="enter-contains-and-exit-does-not-intersect",this.feed=null,this.feedAccuracyMode="use-geometry",this.fenceNotificationRule=null,this.fenceParameters=null,this.name=null,this.notificationOptions=null,this.type="fence"}};h([Pa(nDe)],hc.prototype,"enterExitRule",void 0),h([p({type:J$e,json:{write:{isRequired:!0}}})],hc.prototype,"feed",void 0),h([Pa(sDe)],hc.prototype,"feedAccuracyMode",void 0),h([p({type:xS.apiValues,json:{type:xS.jsonValues,read:xS.read,write:{writer:xS.write,isRequired:!0}}})],hc.prototype,"fenceNotificationRule",void 0),h([p({type:iDe,json:{write:{isRequired:!0}}})],hc.prototype,"fenceParameters",void 0),h([p({type:String,json:{write:!0}})],hc.prototype,"name",void 0),h([p({type:rDe,json:{write:!0}})],hc.prototype,"notificationOptions",void 0),h([Pa({fence:"fence"},{readOnly:!0})],hc.prototype,"type",void 0),hc=h([F("esri.webdoc.geotriggersInfo.FenceGeotrigger")],hc);const aDe=hc,oDe={base:ste,key:"type",typeMap:{fence:aDe}};let ME=class extends au(xt){constructor(e){super(e),this.geotriggers=null}};h([p({types:[oDe],json:{write:{isRequired:!0}}})],ME.prototype,"geotriggers",void 0),ME=h([F("esri.webdoc.GeotriggersInfo")],ME);const lDe=ME;var j$;let zy=j$=class extends xt{constructor(i){super(i),this.activeRange=null,this.currentRangeExtent=null,this.fullRangeExtent=null}clone(){return new j$(Pr({activeRange:this.activeRange,currentRangeExtent:this.currentRangeExtent,fullRangeExtent:this.fullRangeExtent}))}};h([p({type:String,nonNullable:!0,json:{read:{source:"activeRangeName"},write:{target:"activeRangeName",isRequired:!0}}})],zy.prototype,"activeRange",void 0),h([p({type:[Number],json:{write:!0}})],zy.prototype,"currentRangeExtent",void 0),h([p({type:[Number],json:{write:!0}})],zy.prototype,"fullRangeExtent",void 0),zy=j$=h([F("esri.webdoc.RangeInfo")],zy);const u5=zy;var q$;let Eh=q$=class extends xt{constructor(i){super(i),this.enabled=!1,this.longNames=!1,this.minimized=!1,this.pinnedLevels=!1,this.site=null,this.facility=null,this.level=null}clone(){return new q$(Pr({enabled:this.enabled,longNames:this.longNames,minimized:this.minimized,pinnedLevels:this.pinnedLevels,site:this.site,facility:this.facility,level:this.level}))}};h([p({type:Boolean,json:{read:{source:"enabled"},write:{target:"enabled"}}})],Eh.prototype,"enabled",void 0),h([p({type:Boolean,json:{read:{source:"longNames"},write:{target:"longNames"}}})],Eh.prototype,"longNames",void 0),h([p({type:Boolean,json:{read:{source:"minimized"},write:{target:"minimized"}}})],Eh.prototype,"minimized",void 0),h([p({type:Boolean,json:{read:{source:"pinnedLevels"},write:{target:"pinnedLevels"}}})],Eh.prototype,"pinnedLevels",void 0),h([p({type:String,json:{read:{source:"site"},write:{target:"site"}}})],Eh.prototype,"site",void 0),h([p({type:String,json:{read:{source:"facility"},write:{target:"facility"}}})],Eh.prototype,"facility",void 0),h([p({type:String,json:{read:{source:"level"},write:{target:"level"}}})],Eh.prototype,"level",void 0),Eh=q$=h([F("esri.webdoc.widgets.FloorFilter")],Eh);const cDe=Eh;var W$;const TS=new Vd({slider:"slider",picker:"picker"});let By=W$=class extends xt{constructor(i){super(i),this.interactionMode=null,this.numStops=null,this.stopInterval=null}clone(){return new W$({interactionMode:this.interactionMode,numStops:this.numStops,stopInterval:this.stopInterval})}};h([p({type:TS.apiValues,nonNullable:!0,json:{type:TS.jsonValues,default:null,read:{reader:TS.read},write:{isRequired:!0,writer:TS.write}}})],By.prototype,"interactionMode",void 0),h([p({type:Number,json:{read:{source:"numberOfStops"},write:{target:"numberOfStops",overridePolicy(){const i=this.stopInterval!=null;return{enabled:!i,isRequired:!i}}}}})],By.prototype,"numStops",void 0),h([p({type:Number,json:{write:{overridePolicy(){return{isRequired:this.numStops==null}}}}})],By.prototype,"stopInterval",void 0),By=W$=h([F("esri.webdoc.widgets.Range")],By);const hDe=By;var X$;let On=X$=class extends xt{constructor(i){super(i),this.currentTimeExtent=null,this.fullTimeExtent=null,this.loop=!1,this.numStops=null,this.numThumbs=null,this.stopDelay=null,this.stopInterval=null,this.stops=null}readCurrentTimeExtent(i){if(!i)return;const e=i[0]!=null?new Date(i[0]):null,t=i[1]!=null?new Date(i[1]):null;return new W0({start:e,end:t})}writeCurrentTimeExtent(i,e,t){i&&cA(t,[y(i.start)?i.start.getTime():null,y(i.end)?i.end.getTime():null],e)}readFullTimeExtent(i,e){const t=e.properties;if(!t)return;const r=t.endTime!=null?new Date(t.endTime):null,n=t.startTime!=null?new Date(t.startTime):null;return new W0({start:n,end:r})}writeFullTimeExtent(i,e){if(!i)return;const t=e.properties=e.properties||{},r=i.end,n=i.start;r&&(t.endTime=y(r)?r.getTime():null),n&&(t.startTime=y(n)?n.getTime():null)}readStopInterval(i,e,t){return i?UH.fromJSON({value:i.interval,unit:i.units},t):null}writeStopInterval(i,e,t,r){if(!i)return;const n=i.toJSON(r);cA(t,{interval:n.value,units:n.unit},e)}readStops(i){return i&&i.length?i.map(e=>new Date(e)):null}writeStops(i,e,t){i&&i.length&&cA(t,i.map(r=>r.getTime()),e)}clone(){return new X$(Pr({currentTimeExtent:this.currentTimeExtent,fullTimeExtent:this.fullTimeExtent,loop:this.loop,numStops:this.numStops,numThumbs:this.numThumbs,stopDelay:this.stopDelay,stopInterval:this.stopInterval,stops:this.stops}))}};h([p({type:W0,json:{read:{source:"properties.currentTimeExtent"},write:{target:"properties.currentTimeExtent"}}})],On.prototype,"currentTimeExtent",void 0),h([Dl("currentTimeExtent")],On.prototype,"readCurrentTimeExtent",null),h([Cs("currentTimeExtent")],On.prototype,"writeCurrentTimeExtent",null),h([p({type:W0,json:{read:{source:["properties.endTime","properties.startTime"]},write:{target:{"properties.endTime":{type:Number},"properties.startTime":{type:Number}}}}})],On.prototype,"fullTimeExtent",void 0),h([Dl("fullTimeExtent")],On.prototype,"readFullTimeExtent",null),h([Cs("fullTimeExtent")],On.prototype,"writeFullTimeExtent",null),h([p({type:Boolean,nonNullable:!0,json:{default:!1,read:{source:"properties.loop"},write:{target:"properties.loop"}}})],On.prototype,"loop",void 0),h([p({type:Number,json:{read:{source:"properties.numberOfStops"},write:{target:"properties.numberOfStops",overridePolicy(){var r;const i=!!this.stopInterval,e=!!((r=this.stops)!=null&&r.length),t=!(i||e);return{enabled:t,isRequired:t}}}}})],On.prototype,"numStops",void 0),h([p({type:[1,2],nonNullable:!0,json:{read:{source:"properties.thumbCount"},write:{target:"properties.thumbCount",isRequired:!0}}})],On.prototype,"numThumbs",void 0),h([p({type:Number,nonNullable:!0,json:{read:{source:"properties.thumbMovingRate"},write:{target:"properties.thumbMovingRate",isRequired:!0}}})],On.prototype,"stopDelay",void 0),h([p({type:UH,json:{read:{source:"properties.timeStopInterval"},write:{target:"properties.timeStopInterval",overridePolicy(){var t;const i=this.numStops!=null,e=!!((t=this.stops)!=null&&t.length);return{enabled:!e,isRequired:!(i||e)}}}}})],On.prototype,"stopInterval",void 0),h([Dl("stopInterval")],On.prototype,"readStopInterval",null),h([Cs("stopInterval")],On.prototype,"writeStopInterval",null),h([p({type:[Date],json:{read:{source:"properties.stops"},write:{target:"properties.stops",overridePolicy(){return{isRequired:this.numStops==null&&!this.stopInterval}}}}})],On.prototype,"stops",void 0),h([Dl("stops")],On.prototype,"readStops",null),h([Cs("stops")],On.prototype,"writeStops",null),On=X$=h([F("esri.webdoc.widgets.TimeSlider")],On);const uDe=On;var Q$;let Gy=Q$=class extends xt{constructor(i){super(i),this.range=null,this.timeSlider=null,this.floorFilter=null}clone(){return new Q$(Pr({range:this.range,timeSlider:this.timeSlider,floorFilter:this.floorFilter}))}};h([p({type:hDe,json:{write:!0}})],Gy.prototype,"range",void 0),h([p({type:uDe,json:{write:!0}})],Gy.prototype,"timeSlider",void 0),h([p({type:cDe,json:{write:!0}})],Gy.prototype,"floorFilter",void 0),Gy=Q$=h([F("esri.webdoc.Widgets")],Gy);const dDe=Gy,pDe={width:600,height:400},CS=1.5;function mDe(i,e){e=e||pDe;let{width:t,height:r}=e;const n=t/r;return n<CS?r=t/CS:n>CS&&(t=r*CS),t>i.width&&(r*=i.width/t,t=i.width),r>i.height&&(t*=i.height/r,r=i.height),{width:Math.round(t),height:Math.round(r)}}function y7(i){return{enabled:!!(i!=null&&i.length)}}var Z$;let Hy=Z$=class extends xt{constructor(i){super(i),this.exactMatch=!1,this.name=null,this.type=null}clone(){return new Z$({exactMatch:this.exactMatch,type:this.type,name:this.name})}};h([p({type:Boolean,json:{write:!0}})],Hy.prototype,"exactMatch",void 0),h([p({type:String,json:{write:!0}})],Hy.prototype,"name",void 0),h([Pa(zH)],Hy.prototype,"type",void 0),Hy=Z$=h([F("esri.webdoc.applicationProperties.SearchLayerField")],Hy);const fDe=Hy;var Y$;let jy=Y$=class extends xt{constructor(i){super(i),this.field=null,this.id=null,this.subLayer=null}clone(){return new Y$(Pr({field:this.field,id:this.id,subLayer:this.subLayer}))}};h([p({type:fDe,json:{write:{isRequired:!0}}})],jy.prototype,"field",void 0),h([p({type:String,json:{write:{isRequired:!0}}})],jy.prototype,"id",void 0),h([p({type:gI,json:{write:!0}})],jy.prototype,"subLayer",void 0),jy=Y$=h([F("esri.webdoc.applicationProperties.SearchLayer")],jy);const gDe=jy;var K$;let qy=K$=class extends xt{constructor(i){super(i),this.exactMatch=!1,this.name=null,this.type=null}clone(){return new K$({exactMatch:this.exactMatch,type:this.type,name:this.name})}};h([p({type:Boolean,json:{write:!0}})],qy.prototype,"exactMatch",void 0),h([p({type:String,json:{write:!0}})],qy.prototype,"name",void 0),h([Pa(zH)],qy.prototype,"type",void 0),qy=K$=h([F("esri.webdoc.applicationProperties.SearchTableField")],qy);const _De=qy;var J$;let Ob=J$=class extends xt{constructor(i){super(i),this.field=null,this.id=null}clone(){return new J$(Pr({field:this.field,id:this.id}))}};h([p({type:_De,json:{write:{isRequired:!0}}})],Ob.prototype,"field",void 0),h([p({type:String,json:{write:{isRequired:!0}}})],Ob.prototype,"id",void 0),Ob=J$=h([F("esri.webdoc.applicationProperties.SearchTable")],Ob);const yDe=Ob;var eD;const ate=wt.ofType(gDe),ote=wt.ofType(yDe);let Rh=eD=class extends xt{constructor(i){super(i),this.addressSearchEnabled=!0,this.enabled=!0,this.hintText=null,this.layers=new ate,this.tables=new ote}readAddressSearchEnabled(i){return!i}writeAddressSearchEnabled(i,e,t){e[t]=!i}clone(){return new eD(Pr({addressSearchEnabled:this.addressSearchEnabled,enabled:this.enabled,hintText:this.hintText,layers:this.layers,tables:this.tables}))}};h([p({type:Boolean,nonNullable:!0,json:{read:{source:"disablePlaceFinder"},write:{target:"disablePlaceFinder",isRequired:!0},origins:{"web-scene":{read:!1,write:!1}}}})],Rh.prototype,"addressSearchEnabled",void 0),h([Dl("addressSearchEnabled")],Rh.prototype,"readAddressSearchEnabled",null),h([Cs("addressSearchEnabled")],Rh.prototype,"writeAddressSearchEnabled",null),h([p({type:Boolean,nonNullable:!0,json:{write:!0,origins:{"web-map":{write:{isRequired:!0}},"web-scene":{default:!0,write:!0}}}})],Rh.prototype,"enabled",void 0),h([p({type:String,json:{write:!0}})],Rh.prototype,"hintText",void 0),h([p({type:ate,json:{write:{overridePolicy:y7},origins:{"web-scene":{write:{isRequired:!0}}}}})],Rh.prototype,"layers",void 0),h([p({type:ote,json:{read:!0,write:{overridePolicy:y7}}})],Rh.prototype,"tables",void 0),Rh=eD=h([F("esri.webdoc.applicationProperties.Search")],Rh);const vDe=Rh;var tD;let IE=tD=class extends xt{constructor(i){super(i),this.search=null}clone(){return new tD(Pr({search:this.search}))}};h([p({type:vDe,json:{write:!0}})],IE.prototype,"search",void 0),IE=tD=h([F("esri.webdoc.applicationProperties.Viewing")],IE);const bDe=IE;var iD;let Wy=iD=class extends xt{constructor(i){super(i),this.editing=null,this.offline=null,this.viewing=null}clone(){return new iD(Pr({editing:this.editing,offline:this.offline,viewing:this.viewing}))}};h([p({json:{write:!0}})],Wy.prototype,"editing",void 0),h([p({json:{write:!0}})],Wy.prototype,"offline",void 0),h([p({type:bDe,json:{write:!0}})],Wy.prototype,"viewing",void 0),Wy=iD=h([F("esri.webmap.ApplicationProperties")],Wy);const wDe=Wy;var rD;let Eg=rD=class extends xt{constructor(){super(...arguments),this.url=""}destroy(){this.url=""}clone(){return new rD({url:this.url})}};h([p({type:String,json:{write:{isRequired:!0}}})],Eg.prototype,"url",void 0),Eg=rD=h([F("esri.webdoc.support.SlideThumbnail")],Eg);var nD;let Ph=nD=class extends gD(xt){constructor(i){super(i),this.name=null,this.thumbnail=new Eg,this.timeExtent=null}castThumbnail(i){return typeof i=="string"?new Eg({url:i}):Nx(Eg,i)}set viewpoint(i){const{targetGeometry:e,scale:t}=i;y(e)&&e.type==="point"&&C(t)&&ee.getLogger(this.declaredClass).warn("Bookmark.viewpoint should include 'scale' when its targetGeometry is a point.",i),this._set("viewpoint",i)}readViewpoint(i,e){const{extent:t,viewpoint:r}=e;return rr.fromJSON(r||{targetGeometry:t})}writeViewpoint(i,e,t,r){if(!i)return;const{targetGeometry:n}=i;if(y(n)&&n.type!=="extent"){const s="Bookmark.viewpoint cannot be written to JSON when the viewpoint's targetGeometry is not an extent.";r!=null&&r.messages?r.messages.push(new J("property:unsupported",s)):ee.getLogger(this.declaredClass).error(s)}else y(n)&&(e.extent=n.toJSON()),e[t]=i.toJSON()}clone(){return new nD(Pr({name:this.name,thumbnail:this.thumbnail,timeExtent:this.timeExtent,viewpoint:this.viewpoint}))}};h([p({type:String,nonNullable:!0,json:{write:{isRequired:!0}}})],Ph.prototype,"name",void 0),h([p({type:Eg,json:{write:{overridePolicy:i=>({enabled:!(!i||!i.url)})}}})],Ph.prototype,"thumbnail",void 0),h([qr("thumbnail")],Ph.prototype,"castThumbnail",null),h([p({type:W0,json:{write:!0}})],Ph.prototype,"timeExtent",void 0),h([p({type:rr,nonNullable:!0,json:{write:!0}})],Ph.prototype,"viewpoint",null),h([Dl("viewpoint",["extent","viewpoint"])],Ph.prototype,"readViewpoint",null),h([Cs("viewpoint")],Ph.prototype,"writeViewpoint",null),Ph=nD=h([F("esri.webmap.Bookmark")],Ph);const xDe=Ph;var sD;let Xf=sD=class extends pe{constructor(i){super(i),this.background=null,this.rangeInfo=null,this.spatialReference=null,this.viewpoint=null}clone(){return new sD(Pr({background:this.background,rangeInfo:this.rangeInfo,spatialReference:this.spatialReference,viewpoint:this.viewpoint}))}};h([p({type:bP})],Xf.prototype,"background",void 0),h([p({type:u5})],Xf.prototype,"rangeInfo",void 0),h([p({type:Zt})],Xf.prototype,"spatialReference",void 0),h([p({type:rr})],Xf.prototype,"viewpoint",void 0),Xf=sD=h([F("esri.webmap.InitialViewProperties")],Xf);const LE=Xf;class mw extends moe{constructor(e,t){super(e,t,"webmap")}}const $E=new mw(2,26),uI="Web Map",lte=wt.ofType(xDe),TDe=wt.ofType(rte),Mb=new Map;Mb.set("image/jpeg","jpeg"),Mb.set("image/jpg","jpg"),Mb.set("image/png","png"),Mb.set("image/gif","gif");const CDe="ArcGIS Pro",v7=oF.JSAPI,b7="CollectorDisabled",w7="Collector",x7="Data Editing",T7="OfflineDisabled",C7="Offline",S7="Workforce Project",E7="Workforce Worker",R7="Workforce Dispatcher",SDe="Offline Map Areas",EDe="FieldMapsDisabled",P7=oF.DEVELOPER_BASEMAP,A7="UtilityNetwork",RDe=["NatGeo_World_Map","Ocean_Basemap","USA_Topo_Maps","World_Imagery","World_Street_Map","World_Terrain_Base","World_Topo_Map","World_Hillshade","Canvas/World_Light_Gray_Base","Canvas/World_Light_Gray_Reference","Canvas/World_Dark_Gray_Base","Canvas/World_Dark_Gray_Reference","Ocean/World_Ocean_Base","Ocean/World_Ocean_Reference","Reference/World_Boundaries_and_Places","Reference/World_Reference_Overlay","Reference/World_Transportation"].map(i=>i.toLowerCase());let Ai=class extends kH(Om.LoadableMixin(bD(_P))){constructor(i){super(i),this.applicationProperties=null,this.bookmarks=new lte,this.floorInfo=null,this.geotriggersInfo=null,this.initialViewProperties=new LE,this.portalItem=null,this.presentation=null,this.sourceVersion=null,this.widgets=null,this.utilityNetworks=null,this.authoringApp=this.authoringAppVersion=null,this._isAuthoringAppSetByUser=this._isAuthoringAppVersionSetByUser=!1}destroy(){const i=this.portalItem;this.portalItem=null,i==null||i.destroy()}initialize(){if(this.when().catch(i=>{ee.getLogger(this.declaredClass).error("#load()","Failed to load web map",i)}),this.resourceInfo){let i;try{i=this._validateJSON(this.resourceInfo)}catch(e){return void this.addResolvingPromise(Promise.reject(e))}this.read(i)}}set authoringApp(i){this._isAuthoringAppSetByUser=!0,this._set("authoringApp",i)}writeAuthoringApp(i,e){i&&this._isAuthoringAppSetByUser?e.authoringApp=i:e.authoringApp=v7}set authoringAppVersion(i){this._isAuthoringAppVersionSetByUser=!0,this._set("authoringAppVersion",i)}writeAuthoringAppVersion(i,e){i&&this._isAuthoringAppVersionSetByUser?e.authoringAppVersion=i:e.authoringAppVersion=Nie}readInitialViewProperties(i,e){var n;const t=new LE;e.background&&(t.background=bP.fromJSON(e.background));const r=(n=e.initialState)==null?void 0:n.viewpoint;return r&&(r.rotation&&mw.parse(e.version||"","webmap").lessThan(2,20)&&e.authoringApp===CDe&&(r.rotation*=-1),t.viewpoint=rr.fromJSON(r)),e.mapRangeInfo&&(t.rangeInfo=u5.fromJSON(e.mapRangeInfo)),e.spatialReference&&(t.spatialReference=Zt.fromJSON(e.spatialReference)),t}writeInitialViewProperties(i,e,t,r){if(!i)return;const n=i.background;n&&n.color&&(e.background=n.write({},r)),i.viewpoint&&(e.initialState={viewpoint:i.viewpoint.write({},r)}),i.rangeInfo&&(e.mapRangeInfo=i.rangeInfo.toJSON(r)),i.spatialReference&&(e.spatialReference=i.spatialReference.write({},r))}writeLayers(i,e,t,r){e[t]=this._writeLayers(i,r,"operational-layers")}readSourceVersion(i,e){const[t,r]=e.version.split(".");return new mw(parseInt(t,10),parseInt(r,10))}writeSourceVersion(i,e,t){e[t]=`${$E.major}.${$E.minor}`}writeTables(i,e,t,r){const n=this._writeLayers(i,r,"tables");n.length&&(e[t]=n)}get thumbnailUrl(){return this.portalItem&&this.portalItem.thumbnailUrl||null}set thumbnailUrl(i){i?(this._override("thumbnailUrl",i),this._thumbnailFilename=this._generateCustomThumbnailFilename(i)):this._clearThumbnailOverride()}load(i){return this.addResolvingPromise(this._loadFromSource()),Promise.resolve(this)}loadAll(){return pG(this,i=>{i(this.ground,this.basemap,this.layers,this.tables)})}read(i,e){e={...e,origin:"web-map"};const t=this._getAuthoringPropsState();gte(this,i,r=>super.read(i,r),e),this._restoreAuthoringPropsFromState(t)}write(i,e){if(this.loadStatus!=="loaded"){const t=new J("webmap:not-loaded","Web map must be loaded before it can be serialized");throw ee.getLogger(this.declaredClass).error("#toJSON()","Web map must be loaded before it can be serialized",this.loadError||this.loadStatus),t}return this._removeDanglingLayerRefs(),e={...e,origin:"web-map",restrictedWebMapWriting:!0,webmap:this},super.write(i,e)}async save(i){i=i||{},this._validateItem(),await this._updateFromPromise,await this.load(),await this._loadLayerContainers(),await this._beforeSave(),await this._validateMap();const e=this.portalItem,t={origin:"web-map",messages:[],writtenProperties:[],url:e.itemUrl&&xI(e.itemUrl),portal:e.portal||k1.getDefault()},r=this.write({},t);return this._validateJSONForWriting(t,i),await this._updateItemProperties(e),await this._updateItem(e,r,t),await this._updateItemThumbnail(),e}async saveAs(i,e){e=e||{};const t=this._getPortalItem(i);await this._updateFromPromise,await this.load(),await this._loadLayerContainers(),await this._beforeSave(),await this._validateMap();const r={origin:"web-map",messages:[],writtenProperties:[],url:null,portal:t.portal},n=this.write({},r);this._validateJSONForWriting(r,e),await this._updateItemPropertiesForSaveAs(t);const s=this._getThumbnailState();return await this._createItem(t,n,r,e),this._restoreThumbnailFromState(s),await this._updateItemThumbnail(),t}async updateFrom(i,e){const t=this._updateFromInternal(i,e);this._updateFromPromise=t,await t,t===this._updateFromPromise&&(this._updateFromPromise=null)}getLayerJSONFromResourceInfo(i){var t,r,n,s;const e=this.resourceInfo;return this._collectAllLayersJSON([...((t=e==null?void 0:e.baseMap)==null?void 0:t.baseMapLayers)||[],...(e==null?void 0:e.operationalLayers)||[],...((s=(n=(r=this.basemap)==null?void 0:r.resourceInfo)==null?void 0:n.data)==null?void 0:s.baseMapLayers)||[]]).find(a=>a.id===i.id)}_collectAllLayersJSON(i){return i.reduce((e,t)=>(e.push(t),t.layerType==="GroupLayer"&&(e=e.concat(this._collectAllLayersJSON(t.layers||[]))),e),[])}_writeLayers(i,e,t){return e={...e,layerContainerType:t},i.map(r=>ft(poe(r,t==="tables"?null:this.getLayerJSONFromResourceInfo(r),e))).filter(Boolean).toArray()}_loadFromSource(){return this.resourceInfo?this._loadFromJSON(this.resourceInfo,{origin:"web-map"}):this.portalItem&&this.portalItem.id?this._loadFromItem(this.portalItem):Promise.resolve(null)}_loadFromItem(i){return i.load().catch(e=>{throw new J("webmap:load-portal-item","Failed to load portal item",{error:e})}).then(()=>{if(i.type!=="Web Map")throw new J("webmap:invalid-portal-item","Invalid portal item type '${type}', expected 'Web Map'",{type:i.type})}).then(()=>i.fetchData()).then(e=>(this.resourceInfo=e,this._readAndLoadFromJSON(e,{origin:"web-map",portal:i.portal||k1.getDefault()}))).then(()=>this._computeInitialViewpoint())}_readAndLoadFromJSON(i,e){const t=this._validateJSON(i);return this.read(t,e),this._loadFromJSON(t,e)}_validateJSON(i){const e=mw.parse(i.version||"","webmap");return $E.validate(e),i.version=`${e.major}.${e.minor}`,i}_loadFromJSON(i,e){const t={context:{...e,layerContainerType:"operational-layers"}};return this.portalItem&&(t.context.portal=this.portalItem.portal||k1.getDefault()),j(()=>import("./layersCreator-af14d2eb.js"),["assets/layersCreator-af14d2eb.js","assets/Collection-910b6f71.js","assets/cast-fcb46737.js","assets/typedArrayUtil-4d7bb04c.js","assets/string-a318751c.js","assets/Error-ec6249b9.js","assets/ArrayPool-a8ee9378.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-1e54421e.js","assets/Evented-a45c8b0f.js","assets/SimpleObservable-23231131.js","assets/lazyLayerLoader-41b90a4f.js","assets/preload-helper-3bce6601.js","assets/PortalItem-bb7e98a6.js","assets/assets-8d3e737a.js","assets/request-6fc81c4c.js","assets/Loadable-268c900a.js","assets/Promise-376ab9f6.js","assets/Extent-da876e26.js","assets/Ellipsoid-89682c5e.js","assets/Portal-2bb189b3.js","assets/locale-30120714.js","assets/PortalGroup-8e41557a.js","assets/jsonMap-7b8332c9.js","assets/PortalUser-659cc1d2.js","assets/portalLayers-bc22a371.js","assets/layersLoader-89454f28.js","assets/Layer-5ffe0eda.js","assets/geometry-b7901087.js","assets/Polyline-ff2d7c6b.js","assets/typeUtils-35750739.js","assets/Identifiable-bfe1ff30.js","assets/arcgisLayerUrl-c09f09b4.js","assets/persistableUrlUtils-5f719c3b.js","assets/jsonContext-a007a25f.js","assets/portalItemUtils-2ccd793f.js","assets/projection-290b739f.js","assets/mathUtils-b4bb77e2.js","assets/vec3-e93e648f.js","assets/vec3f64-2f9cef06.js","assets/common-c186b691.js","assets/vec4-790471c0.js","assets/unitUtils-45d1147c.js","assets/mat4-44a0988f.js","assets/aaBoundingRect-193543b5.js","assets/zscale-89472cba.js","assets/styleUtils-a989c0af.js","assets/asyncUtils-437defc4.js"]).then(({populateOperationalLayers:r})=>{const n=[],s=i.operationalLayers;s&&s.length&&n.push(r(this.layers,s,t));const a={...t,context:{...t.context,layerContainerType:"tables"},defaultLayerType:"ArcGISFeatureLayer"},o=i.tables;return o&&o.length&&n.push(r(this.tables,o,a)),Yo(n).then(()=>{})})}async _computeInitialViewpoint(){var r;let i=this.initialViewProperties;if((r=i==null?void 0:i.viewpoint)==null?void 0:r.targetGeometry)return;const t=await this._getExtentFromItem();t&&(i=i?i.clone():new LE,i.viewpoint=new rr,i.viewpoint.targetGeometry=t,this.initialViewProperties=i)}async _getExtentFromItem(){var t,r;const i=(t=this.initialViewProperties)==null?void 0:t.spatialReference,e=(r=this.portalItem)==null?void 0:r.extent;return i&&e?i.isWGS84?e.clone():i.isWebMercator?ER(e):(await j(()=>Promise.resolve().then(()=>T$),void 0)).getGeometryServiceURL(this.portalItem).then(n=>{const s=new Cx;return s.geometries=[e],s.outSpatialReference=i,gR(n,s)}).then(n=>n[0]).catch(n=>(ee.getLogger(this.declaredClass).error("Error projecting item's extent:",n),null)):null}_removeDanglingLayerRefs(){const i=this.applicationProperties,e=i&&i.viewing&&i.viewing.search,t=s=>this.allLayers.some(a=>a.id===s);e&&e.layers&&(e.layers=e.layers.filter(s=>t(s.id))),e&&e.tables&&(e.tables=e.tables.filter(s=>this.tables.some(a=>a.id===s.id)));const r=i&&i.editing&&i.editing.locationTracking;r&&r.info&&!t(r.info.layerId)&&(i.editing=null);const n=this.presentation&&this.presentation.slides;n&&n.forEach(s=>{s.visibleLayers&&(s.visibleLayers=s.visibleLayers.filter(a=>t(a.id)))})}async _validateMap(){var e;if(!((e=this.basemap)!=null&&e.baseLayers.length))throw new J("webmap:save","Map does not have a valid basemap with a base layer.");let i=null;if(await Pm(()=>{const t=vpe(this.initialViewProperties,this.basemap);return i=t.spatialReference,!t.updating}),!Gm(i,this.initialViewProperties.spatialReference))throw new J("webmap:save","The spatial reference of the basemap is not compatible with the one from the map.",{expected:this.initialViewProperties.spatialReference,actual:i})}_validateItem(){if(!this.portalItem)throw ee.getLogger(this.declaredClass).error("save: requires the portalItem property to be set"),new J("webmap:portal-item-not-set","Portal item to save to has not been set on the WebMap");this._validateItemType(this.portalItem)}_validateItemType(i){if(i.type!==uI)throw new J("webmap:portal-item-wrong-type",`Portal item needs to have type "${uI}"`)}_loadLayerContainers(){const i=[];return this.basemap&&i.push(this.basemap.load()),this.ground&&i.push(this.ground.load()),Yo(i).then(()=>{})}async _beforeSave(){const i=[];for(const e of this.allLayers)if("beforeSave"in e&&typeof e.beforeSave=="function"){const t=e.beforeSave();t&&i.push(t)}await Yo(i)}_loadAllLayers(){const i=this._getAllLayersAndTables().map(e=>e.load());return Yo(i).then(()=>{})}_getAllLayersAndTables(){return this.allLayers.concat(this.allTables)}_validateJSONForWriting(i,e){let t=i.messages.filter(r=>r.type==="error").map(r=>new J(r.name,r.message,r.details));if(e.ignoreUnsupported&&(t=t.filter(r=>r.name!=="layer:unsupported"&&r.name!=="symbol:unsupported"&&r.name!=="symbol-layer:unsupported"&&r.name!=="property:unsupported"&&r.name!=="url:unsupported")),t.length>0)throw new J("webmap:save","Failed to save webmap due to unsupported or invalid content. See 'details.errors' for more detailed information",{errors:t})}async _updateItemProperties(i){i.extent=await this._getWGS84Extent(this.initialViewProperties.viewpoint.targetGeometry),await this._updateTypeKeywords(i)}async _updateItemPropertiesForSaveAs(i){xo(i,b7),xo(i,EDe),xo(i,oF.METADATA),xo(i,T7),xo(i,SDe),xo(i,R7),xo(i,S7),xo(i,E7),await this._updateItemProperties(i)}async _getWGS84Extent(i){const e=i.clone().normalize();let t;if(e.length>1)for(const r of e)t?r.width>t.width&&(t=r):t=r;else t=e[0];return this._projectToWGS84(t)}async _projectToWGS84(i){const e=i.spatialReference;if(e.isWGS84)return i.clone();if(e.isWebMercator)return Dte(i);const t=await j(()=>Promise.resolve().then(()=>T$),void 0),r=await t.getGeometryServiceURL(this.portalItem),n=new Cx;return n.geometries=[i],n.outSpatialReference=Zt.WGS84,(await gR(r,n))[0]}async _updateTypeKeywords(i){C_(i,v7),await this._loadAllLayers(),this._evalCollectorKeyword(i),this._evalDataEditingKeyword(i),this._evalOfflineKeyword(i),this._evalDeveloperBasemapKeyword(i),this._evalUtilityNetworkKeyword(i),i.typeKeywords&&(i.typeKeywords=i.typeKeywords.filter((e,t,r)=>r.indexOf(e)===t))}_evalCollectorKeyword(i){zv(i,b7)||zv(i,S7)||zv(i,E7)||zv(i,R7)||!this._hasEditableFeatureLayer()?xo(i,w7):C_(i,w7)}_evalDataEditingKeyword(i){this._hasEditableFeatureLayer()?C_(i,x7):xo(i,x7)}_evalOfflineKeyword(i){!zv(i,T7)&&this._isOfflineCapableMap()?C_(i,C7):xo(i,C7)}_evalDeveloperBasemapKeyword(i){ype(this.basemap)?C_(i,P7):xo(i,P7)}_evalUtilityNetworkKeyword(i){var e;(e=this.utilityNetworks)!=null&&e.length?C_(i,A7):xo(i,A7)}_hasEditableFeatureLayer(){return this._getAllLayersAndTables().some(i=>i.loaded&&H5(i)&&i.capabilities.operations.supportsEditing&&i.editingEnabled)}_isOfflineCapableMap(){return this._getAllLayersAndTables().filter(i=>i.type!=="group").every(i=>i.loaded&&this._isOfflineCapableLayer(i))}_isFeatureCollectionLike(i){return hne(i)||i.type==="map-notes"||i.type==="route"}_isOfflineCapableLayer(i){return H5(i)&&i.capabilities.operations.supportsSync||this._isFeatureCollectionLike(i)&&!i.portalItem||(i.type==="tile"||i.type==="vector-tile")&&(i.capabilities.operations.supportsExportTiles||this._isExportableAGOLTileLayer(i)||IW(i))&&i.spatialReference.equals(this.initialViewProperties.spatialReference)}_isExportableAGOLTileLayer(i){return i.type==="tile"&&ure(i.url)&&RDe.some(e=>i.url.toLowerCase().includes("/"+e+"/"))}async _updateItem(i,e,t){await i.update({data:e}),this._syncUpInstanceWithItem(i,e,t)}async _createItem(i,e,t,r){const n=this.portalItem,s=!!(n&&n.id&&n.portal.user),a=i.portal;if(await a._signIn(),!await this._canCopyItem(n,s,a))throw new J("webmap:save-as-copy-not-allowed","Owner of this map does not allow others to save a copy");await a.user.addItem({item:i,folder:r.folder,data:e}),this.portalItem=i,this._syncUpInstanceWithItem(i,e,t)}async _canCopyItem(i,e,t){return!(y(i)&&i.id&&i.typeKeywords&&i.typeKeywords.includes("useOnly"))||i.portal.portalHostname===t.portalHostname&&(e||await i.reload(),i.itemControl==="admin"||i.itemControl==="update")}_syncUpInstanceWithItem(i,e,t){VH.prototype.read.call(this,{version:e.version,authoringApp:e.authoringApp,authoringAppVersion:e.authoringAppVersion},{origin:"web-map",ignoreDefaults:!0,url:i.itemUrl&&xI(i.itemUrl)}),uoe(t),this.resourceInfo=e}async _updateItemThumbnail(){this.thumbnailUrl&&this._isOverridden("thumbnailUrl")&&(await this.portalItem.updateThumbnail({thumbnail:this.thumbnailUrl,filename:this._thumbnailFilename}),this._clearThumbnailOverride())}_getPortalItem(i){let e=JE.from(i);return e.id&&(e=e.clone(),e.id=null),e.type||(e.type=uI),e.portal||(e.portal=k1.getDefault()),this._validateItemType(e),e}async _updateFromInternal(i,e){if(e=e||{},await Pm(()=>i.ready),this._updateInitialViewProperties(i,e),i.map===this)for(const t of i.allLayerViews)for(const r of["visible","featureEffect"])r in t&&r in t.layer&&t._isOverridden(r)&&(t.layer[r]=t[r]);await this._updateThumbnailUrl(i,e)}_updateInitialViewProperties(i,e){var t;if(e.backgroundExcluded||(this.initialViewProperties.background=(t=i.background)==null?void 0:t.clone()),this.initialViewProperties.spatialReference=i.spatialReference.clone(),e.viewpointExcluded||(this.initialViewProperties.viewpoint=new rr({rotation:i.rotation,scale:e.scalePreserved?i.scale:null,targetGeometry:this._getViewExtent(i)})),!e.widgetsExcluded)for(const r of i.persistableViewModels)r.updateWebDocument(this)}_getViewExtent(i){const e=i.center.clone().normalize(),t=i.extent.clone(),r=t.width/2;return t.xmin=e.x-r,t.xmax=e.x+r,t}async _updateThumbnailUrl(i,e){if(e.thumbnailExcluded)return;const t=mDe(i,e.thumbnailSize),r=await i.takeScreenshot({format:"png",width:t.width,height:t.height});this._setAutoGeneratedThumbnail(r.dataUrl)}_setAutoGeneratedThumbnail(i){this.thumbnailUrl=i,this._thumbnailFilename=null}_clearThumbnailOverride(){this._clearOverride("thumbnailUrl"),this.clear("thumbnailUrl","user"),this._thumbnailFilename=null}_generateCustomThumbnailFilename(i){if(kie(i)){const e=sG(i),t=e&&e.mediaType,r=t&&Mb.get(t.toLowerCase())||null,n=`thumbnail${Date.now()}`;return r?`${n}.${r}`:n}return null}_getThumbnailState(){let i=this.thumbnailUrl;return i&&(i=this._isOverridden("thumbnailUrl")?i:Vie(i,"w","8192")),{thumbnailUrl:i,filename:this._thumbnailFilename}}_restoreThumbnailFromState(i){this.thumbnailUrl=i.thumbnailUrl,this._thumbnailFilename=i.filename}_getAuthoringPropsState(){return{authoringApp:this.authoringApp,authoringAppVersion:this.authoringAppVersion,isAuthoringAppSetByUser:this._isAuthoringAppSetByUser,isAuthoringAppVersionSetByUser:this._isAuthoringAppVersionSetByUser}}_restoreAuthoringPropsFromState(i){i.isAuthoringAppSetByUser?this.authoringApp=i.authoringApp:this._isAuthoringAppSetByUser=!1,i.isAuthoringAppVersionSetByUser?this.authoringAppVersion=i.authoringAppVersion:this._isAuthoringAppVersionSetByUser=!1}static fromJSON(i){const e=i;if(!e)throw new J("webmap:empty-resource","Expected a JSON resource but got nothing");return new this({resourceInfo:e})}};Ai.VERSION=$E,h([p({type:wDe,json:{write:!0}})],Ai.prototype,"applicationProperties",void 0),h([p({type:String,json:{write:{allowNull:!0,ignoreOrigin:!0}}})],Ai.prototype,"authoringApp",null),h([Cs("authoringApp")],Ai.prototype,"writeAuthoringApp",null),h([p({type:String,json:{write:{allowNull:!0,ignoreOrigin:!0}}})],Ai.prototype,"authoringAppVersion",null),h([Cs("authoringAppVersion")],Ai.prototype,"writeAuthoringAppVersion",null),h([p({json:{read:{source:"baseMap"},write:{target:"baseMap"}}})],Ai.prototype,"basemap",void 0),h([p({type:lte,json:{write:{overridePolicy:i=>({enabled:!!(i&&i.length>0),ignoreOrigin:!0})}}})],Ai.prototype,"bookmarks",void 0),h([p({type:K$e,json:{read:{source:"mapFloorInfo"},write:{target:"mapFloorInfo"}}})],Ai.prototype,"floorInfo",void 0),h([p({type:lDe,json:{write:!0}})],Ai.prototype,"geotriggersInfo",void 0),h([p({type:LE,nonNullable:!0,json:{read:{source:["background","initialState.viewpoint","mapRangeInfo","spatialReference"]},write:{ignoreOrigin:!0,target:{background:{type:bP},"initialState.viewpoint":{type:rr},mapRangeInfo:{type:u5},spatialReference:{type:Zt}}}}})],Ai.prototype,"initialViewProperties",void 0),h([Dl("initialViewProperties")],Ai.prototype,"readInitialViewProperties",null),h([Cs("initialViewProperties")],Ai.prototype,"writeInitialViewProperties",null),h([p({json:{read:!1,write:{target:"operationalLayers",ignoreOrigin:!0}}})],Ai.prototype,"layers",void 0),h([Cs("layers")],Ai.prototype,"writeLayers",null),h([p({type:JE})],Ai.prototype,"portalItem",void 0),h([p({json:{write:!0}})],Ai.prototype,"presentation",void 0),h([p()],Ai.prototype,"resourceInfo",void 0),h([p({readOnly:!0,type:mw,json:{read:{source:"version"},write:{allowNull:!0,ignoreOrigin:!0,target:"version",isRequired:!0}}})],Ai.prototype,"sourceVersion",void 0),h([Dl("sourceVersion")],Ai.prototype,"readSourceVersion",null),h([Cs("sourceVersion")],Ai.prototype,"writeSourceVersion",null),h([p({json:{read:!1,write:{ignoreOrigin:!0}}})],Ai.prototype,"tables",void 0),h([Cs("tables")],Ai.prototype,"writeTables",null),h([p()],Ai.prototype,"thumbnailUrl",null),h([p({type:dDe,json:{write:!0}})],Ai.prototype,"widgets",void 0),h([p({type:TDe,json:{read:!0,write:!0}})],Ai.prototype,"utilityNetworks",void 0),Ai=h([F("esri.WebMap")],Ai);const PDe=Ai;function ADe(){const i=$e.useRef(null),[e,t]=$e.useState(null);$e.useEffect(()=>{r()},[]);async function r(){if(!(i!=null&&i.current))return;Rg.portalUrl="http://devtesting.mapsdevext.arcgis.com/";const n=new PDe({portalItem:{id:"d8ec80ff66324308b4abd36edf9263e4"}}),s=new IX({container:i==null?void 0:i.current,map:n});t(s)}return Ft("div",{className:"App",children:Ft("div",{id:"view",ref:i})})}function ODe(){return Ft(Ghe,{children:nd(khe,{children:[Ft(G1,{path:"/",element:Ft(qhe,{})}),Ft(G1,{path:"/media-layer-images",element:Ft(Nye,{})}),Ft(G1,{path:"/media-layer-video",element:Ft($$e,{})}),Ft(G1,{path:"/media-layer-webmap",element:Ft(ADe,{})})]})})}/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.7
 */function O7(){const{classList:i}=document.body,e=window.matchMedia("(prefers-color-scheme: dark)").matches,t=()=>i.contains(kge)||i.contains(Nge)&&e?"dark":"light",r=a=>document.body.dispatchEvent(new CustomEvent("calciteModeChange",{bubbles:!0,detail:{mode:a}})),n=a=>{s!==a&&r(a),s=a};let s=t();r(s),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",a=>n(a.matches?"dark":"light")),new MutationObserver(()=>n(t())).observe(document.body,{attributes:!0,attributeFilter:["class"]})}function MDe(){typeof window<"u"&&typeof location<"u"&&typeof document<"u"&&window.location===location&&window.document===document&&(document.readyState==="interactive"?O7():document.addEventListener("DOMContentLoaded",()=>O7(),{once:!0}))}const IDe=MDe;IDe();Xfe(window.location.href);const LDe=XI.createRoot(document.getElementById("root"));LDe.render(Ft(Dw.StrictMode,{children:Ft(ODe,{})}));export{qpe as $,p8e as A,QBe as B,Qo as C,M4 as D,$n as E,h8e as F,KW as G,c8e as H,oK as I,jo as J,CCe as K,jRe as L,w4 as M,Gr as N,dJ as O,Yh as P,a9e as Q,L9e as R,yP as S,j3e as T,lPe as U,LPe as V,HQ as W,Yp as X,jfe as Y,jT as Z,tme as _,$0 as a,Ake as a$,Afe as a0,ku as a1,D7e as a2,U7e as a3,GM as a4,k7e as a5,N7e as a6,Npe as a7,A9e as a8,XAe as a9,oGe as aA,so as aB,Oh as aC,cO as aD,D4 as aE,Ur as aF,kY as aG,$d as aH,aT as aI,l$ as aJ,hR as aK,GBe as aL,OOe as aM,pAe as aN,mAe as aO,HVe as aP,zVe as aQ,BVe as aR,Gh as aS,Nze as aT,Bd as aU,v0 as aV,Ize as aW,g$ as aX,dP as aY,Rke as aZ,Pke as a_,q7e as aa,W4 as ab,T6e as ac,Wt as ad,Fi as ae,ki as af,pv as ag,o9e as ah,PPe as ai,HP as aj,aSe as ak,Ui as al,e4 as am,xIe as an,SW as ao,B0 as ap,a8e as aq,mHe as ar,Qc as as,l8e as at,qTe as au,Uh as av,l9e as aw,DPe as ax,F$e as ay,D$e as az,RY as b,xee as b$,Oke as b0,GVe as b1,Vye as b2,zTe as b3,CV as b4,S6e as b5,TV as b6,BY as b7,x6e as b8,w9e as b9,c_ as bA,H$e as bB,OJ as bC,ZOe as bD,Yb as bE,k0e as bF,B0e as bG,nZ as bH,rZ as bI,Q0e as bJ,XN as bK,rve as bL,dZ as bM,ZN as bN,lve as bO,yve as bP,Fve as bQ,Zg as bR,TMe as bS,AIe as bT,a5 as bU,pee as bV,UIe as bW,gee as bX,BIe as bY,vee as bZ,HIe as b_,TEe as ba,vi as bb,n8e as bc,UZ as bd,X8 as be,_z as bf,tx as bg,uv as bh,U3 as bi,iA as bj,T$e as bk,$je as bl,Fje as bm,Dje as bn,xV as bo,gh as bp,UN as bq,rwe as br,zN as bs,zd as bt,Qye as bu,Id as bv,EP as bw,E6e as bx,U6 as by,C6e as bz,PY as c,qIe as c0,oZ as c1,K0e as c2,COe as c3,TOe as c4,YP as c5,SOe as c6,TLe as c7,Pee as c8,ELe as c9,Mee as ca,PLe as cb,$ee as cc,BLe as cd,tA as ce,ZLe as cf,o3e as cg,c3e as ch,u3e as ci,HLe as cj,A3e as ck,IQ as cl,jye as cm,ws as cn,D3e as co,I9e as d,dX as e,fLe as f,PVe as g,nw as h,R8e as i,P8e as j,kTe as k,SY as l,efe as m,YW as n,Rze as o,rme as p,HRe as q,xCe as r,K3e as s,zn as t,rr as u,Od as v,m8e as w,Xl as x,g$e as y,s8e as z};
